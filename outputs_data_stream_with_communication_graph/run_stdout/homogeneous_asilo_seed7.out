[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:51903
[S3] → join 127.0.0.1:51902
[S4] → join 127.0.0.1:51902
[S5] → join 127.0.0.1:51902
[S6] → join 127.0.0.1:51902
[S7] → join 127.0.0.1:51902
[S8] → join 127.0.0.1:51902
[S9] → join 127.0.0.1:51902
[S10] → join 127.0.0.1:51902
[S11] → join 127.0.0.1:51902
[S13] → join 127.0.0.1:51902
[S14] → join 127.0.0.1:51902
[S15] → join 127.0.0.1:51902
[S16] → join 127.0.0.1:51902
[S17] → join 127.0.0.1:51902
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.202148 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.187543 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.198129 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.129302 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.154852 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.140152 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.142928 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.157907 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.216498 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.146171 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.179517 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.187096 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.241360 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.095849 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.178843 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S3] + discovered S10
[S3] + discovered S7
[S4] + discovered S2
[S3] + discovered S11
[S3] + discovered S16
[S3] + discovered S5
[S3] + discovered S14
[S3] + discovered S6
[S3] + discovered S17
[S3] + discovered S4
[S3] + discovered S9
[S3] + discovered S8
[S3] + discovered S15
[S3] + discovered S13
[S4] + discovered S3
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S7
[S4] + discovered S15
[S4] + discovered S8
[S4] + discovered S10
[S4] + discovered S11
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S17
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S4] + discovered S9
[S4] + discovered S13
[S5] + discovered S17
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S8
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S15
[S6] + discovered S5
[S6] + discovered S2
[S5] + discovered S13
[S6] + discovered S4
[S5] + discovered S10
[S5] + discovered S16
[S5] + discovered S11
[S6] + discovered S3
[S7] + discovered S3
[S7] + discovered S2
[S6] + discovered S8
[S6] + discovered S11
[S6] + discovered S9
[S6] + discovered S17
[S6] + discovered S13
[S6] + discovered S14
[S6] + discovered S10
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S16
[S8] + discovered S4
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S16
[S8] + discovered S2
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S11
[S7] + discovered S8
[S8] + discovered S7
[S7] + discovered S9
[S7] + discovered S13
[S8] + discovered S16
[S9] + discovered S4
[S9] + discovered S3
[S8] + discovered S15
[S9] + discovered S2
[S8] + discovered S14
[S8] + discovered S17
[S8] + discovered S10
[S9] + discovered S8
[S8] + discovered S13
[S8] + discovered S9
[S9] + discovered S5
[S9] + discovered S6
[S8] + discovered S11
[S9] + discovered S7
[S9] + discovered S16
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S4
[S10] + discovered S3
[S10] + discovered S7
[S9] + discovered S14
[S9] + discovered S15
[S10] + discovered S6
[S9] + discovered S11
[S10] + discovered S8
[S10] + discovered S9
[S9] + discovered S10
[S9] + discovered S17
[S9] + discovered S13
[S11] + discovered S8
[S11] + discovered S2
[S10] + discovered S11
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S5
[S11] + discovered S9
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S6
[S11] + discovered S10
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S5
[S13] + discovered S7
[S13] + discovered S4
[S13] + discovered S8
[S11] + discovered S14
[S11] + discovered S13
[S13] + discovered S10
[S11] + discovered S17
[S11] + discovered S15
[S13] + discovered S9
[S13] + discovered S2
[S11] + discovered S16
[S14] + discovered S8
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S2
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S11
[S14] + discovered S5
[S14] + discovered S4
[S13] + discovered S17
[S14] + discovered S7
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S15
[S15] + discovered S3
[S15] + discovered S10
[S14] + discovered S17
[S15] + discovered S6
[S15] + discovered S2
[S15] + discovered S5
[S15] + discovered S4
[S15] + discovered S9
[S15] + discovered S11
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S8
[S14] + discovered S16
[S15] + discovered S7
[S16] + discovered S7
[S16] + discovered S11
[S16] + discovered S13
[S16] + discovered S2
[S16] + discovered S6
[S15] + discovered S16
[S16] + discovered S10
[S16] + discovered S4
[S16] + discovered S14
[S15] + discovered S17
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S15
[S16] + discovered S8
[S16] + discovered S9
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S8
[S17] + discovered S13
[S17] + discovered S4
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S3
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S7
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S6@127.0.0.1:51907
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:51910
[S7] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S2] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S9] ⇄ pheromone p=1.000 → S2@127.0.0.1:51902
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:51908
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:51915
[S13] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:51917
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:51905
[S5] ⇄ pheromone p=1.000 → S11@127.0.0.1:51912
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:51913
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:51916
[S2] START round=1 head_norm_before_train=1.202238 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.634050493641682, 'loss_val': 1.3119757199624658, 'psi': 0.33868647748981284}-{'f1_val': 0.415765404836578, 'auprc': 0.5541412046626194, 'loss_val': 1.3483339222305597, 'psi': 0.47111572476699454}
[S3] START round=1 head_norm_before_train=1.187131 (no previous merge yet)
[S3] round=1 local utility u=0.415203 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9028024701395869, 'loss_val': 1.3292654718335268, 'psi': 0.44502502742429906}-{'f1_val': 0.13984006561410703, 'auprc': 0.6350028225928709, 'loss_val': 1.356271609389876, 'psi': 0.3379051684056126}
[S4] START round=1 head_norm_before_train=1.198717 (no previous merge yet)
[S4] round=1 local utility u=0.208028 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.5802533736633894, 'loss_val': 1.315786728969356, 'psi': 0.31623732680246625}-{'f1_val': 0.14022662889518414, 'auprc': 0.44920046013655857, 'loss_val': 1.3386845644056309, 'psi': 0.2638161613917339}
[S5] START round=1 head_norm_before_train=1.137744 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7709973178018722, 'loss_val': 1.3341645062679743, 'psi': 0.39375606997789175}-{'f1_val': 0.3714375839236931, 'auprc': 0.771220915426518, 'loss_val': 1.37173378729428, 'psi': 0.5313509165248231}
[S6] START round=1 head_norm_before_train=1.166143 (no previous merge yet)
[S6] round=1 local utility u=0.009389 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8963510219614779, 'loss_val': 1.3048050290614857, 'psi': 0.44339617801536035}-{'f1_val': 0.14142628205128205, 'auprc': 0.8979176269790784, 'loss_val': 1.3282837434302306, 'psi': 0.44402282002240057}
[S7] START round=1 head_norm_before_train=1.139841 (no previous merge yet)
[S7] round=1 local utility u=0.352627 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7851543130117048, 'loss_val': 1.3294601124312244, 'psi': 0.39929581884213694}-{'f1_val': 0.14205682272909165, 'auprc': 0.5593955448784119, 'loss_val': 1.3574369022756785, 'psi': 0.3089923115888198}
[S8] START round=1 head_norm_before_train=1.148471 (no previous merge yet)
[S8] round=1 local utility u=0.031371 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7219342792481527, 'loss_val': 1.3078915338083268, 'psi': 0.3727473011350354}-{'f1_val': 0.13995598239295717, 'auprc': 0.7099109022999035, 'loss_val': 1.3345628159732588, 'psi': 0.36793795035573573}
[S9] START round=1 head_norm_before_train=1.164845 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9921316586672215, 'loss_val': 1.3113470498550648, 'psi': 0.48169143775088624}-{'f1_val': 0.37494434473831034, 'auprc': 0.7647312320444524, 'loss_val': 1.3532824854894978, 'psi': 0.5308590996607672}
[S10] START round=1 head_norm_before_train=1.222616 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7931476241297993, 'loss_val': 1.3180801072850359, 'psi': 0.4004320321769541}-{'f1_val': 0.3846498386510482, 'auprc': 0.7297636740874337, 'loss_val': 1.3574587259959476, 'psi': 0.5226953728256024}
[S11] START round=1 head_norm_before_train=1.154920 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.422464449824724, 'auprc': 0.7973911077473206, 'loss_val': 1.3257857467455079, 'psi': 0.5724351129937626}-{'f1_val': 0.10359570269677702, 'auprc': 0.5605673327175277, 'loss_val': 1.3613793250507187, 'psi': 0.2863843547050773}
[S13] START round=1 head_norm_before_train=1.176741 (no previous merge yet)
[S13] round=1 local utility u=0.579948 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.4664967392286693, 'loss_val': 1.350631655710067, 'psi': 0.2708301532376996}-{'f1_val': 0.09037372593431484, 'auprc': 0.19092713091627445, 'loss_val': 1.3837461821866994, 'psi': 0.13059508792709867}
[S14] START round=1 head_norm_before_train=1.183542 (no previous merge yet)
[S14] round=1 local utility u=0.281667 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.529523739172179, 'loss_val': 1.3533238601485775, 'psi': 0.2960242073984939}-{'f1_val': 0.1038107752956636, 'auprc': 0.42397134606513365, 'loss_val': 1.380717270778001, 'psi': 0.23187500360345165}
[S15] START round=1 head_norm_before_train=1.242694 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.41584914540957585, 'auprc': 0.7752710445424287, 'loss_val': 1.333953689155267, 'psi': 0.559617905062717}-{'f1_val': 0.09269662921348315, 'auprc': 0.591614101840067, 'loss_val': 1.3764835255899515, 'psi': 0.29226361826411673}
[S16] START round=1 head_norm_before_train=1.104182 (no previous merge yet)
[S16] round=1 local utility u=0.753673 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.724658569694059, 'loss_val': 1.3273407611088106, 'psi': 0.37424589799714547}-{'f1_val': 0.018790575290037075, 'auprc': 0.47397983102683294, 'loss_val': 1.3515701454581608, 'psi': 0.20086627758475542}
[S17] START round=1 head_norm_before_train=1.183433 (no previous merge yet)
[S17] round=1 local utility u=0.252783 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5935102841655396, 'loss_val': 1.3315466048168068, 'psi': 0.32197349165664646}-{'f1_val': 0.14094896331738438, 'auprc': 0.4346728733525521, 'loss_val': 1.3605997133004974, 'psi': 0.25843852733145145}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S4] → sending delta(kind=head bytes=1788) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:51909
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S8] → sending delta(kind=head bytes=1786) to S4@127.0.0.1:51904
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:51912
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1778 reason=None
[S15] → sending delta(kind=head bytes=1778) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:51902
[S8] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1788 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1778 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1788) from S4
[S15] cosine check vs S4: cos=0.0357
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=-0.0331
[S8] DROPPED delta from S16 (cos=-0.0331 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1789) from S3
[S7] cosine check vs S3: cos=0.0347
[S6] RECEIVED delta(kind=head bytes=1778) from S15
[S6] cosine check vs S15: cos=-0.0641
[S6] DROPPED delta from S15 (cos=-0.0641 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S7
[S4] cosine check vs S7: cos=0.0019
[S5] RECEIVED delta(kind=head bytes=1792) from S11
[S5] cosine check vs S11: cos=0.0478
[S11] RECEIVED delta(kind=head bytes=1790) from S14
[S11] cosine check vs S14: cos=-0.0148
[S11] DROPPED delta from S14 (cos=-0.0148 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=0.1011
[S4] RECEIVED delta(kind=head bytes=1786) from S8
[S4] cosine check vs S8: cos=0.0735
[S2] RECEIVED delta(kind=head bytes=1792) from S6
[S2] cosine check vs S6: cos=-0.0242
[S2] DROPPED delta from S6 (cos=-0.0242 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:51912
[S17] sending update (kind=head size=1789 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1789) from S17
[S11] cosine check vs S17: cos=0.0608
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.154114
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.020115e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.841316 delta_norm=0.802012
[S5] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.206846
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.088000e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.745159 delta_norm=0.708800
[S4] aggregate: ACCEPT kept=['S7', 'S8'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.4158 head_norm=1.255043
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.091904e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.4160 head_norm=0.777982 delta_norm=0.709190
[S15] aggregate: ACCEPT kept=['S4', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.4225 head_norm=1.170509
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.119903e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.4068 head_norm=0.862934 delta_norm=0.811990
[S11] aggregate: ROLLBACK (f1_val pre=0.422 post=0.407 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.148905
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.151697e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.843901 delta_norm=0.815170
[S7] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.213826 (no previous merge yet)
[S2] round=2 local utility u=0.082544 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6748043953247644, 'loss_val': 1.269150399351758, 'psi': 0.3549880381630458}-{'f1_val': 0.1417771333885667, 'auprc': 0.634050493641682, 'loss_val': 1.3119757199624658, 'psi': 0.33868647748981284}
[S3] START round=2 head_norm_before_train=1.197229 (no previous merge yet)
[S3] round=2 local utility u=0.046677 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9246809922468059, 'loss_val': 1.3015474518839647, 'psi': 0.45377643626718656}-{'f1_val': 0.13984006561410703, 'auprc': 0.9028024701395869, 'loss_val': 1.3292654718335268, 'psi': 0.44502502742429906}
[S4] START round=2 head_norm_before_train=0.745159 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.165741 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.6917093684635256, 'loss_val': 1.3186726395468493, 'psi': 0.3608197247225207}-{'f1_val': 0.14022662889518414, 'auprc': 0.5802533736633894, 'loss_val': 1.315786728969356, 'psi': 0.31623732680246625}
[S5] START round=2 head_norm_before_train=0.841316 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7649702663280495, 'loss_val': 1.3201856267787495, 'psi': 0.3913452493883627}-{'f1_val': 0.14226190476190476, 'auprc': 0.7709973178018722, 'loss_val': 1.3341645062679743, 'psi': 0.39375606997789175}
[S6] START round=2 head_norm_before_train=1.180769 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8259368280340187, 'loss_val': 1.277065585768575, 'psi': 0.4152305004443767}-{'f1_val': 0.14142628205128205, 'auprc': 0.8963510219614779, 'loss_val': 1.3048050290614857, 'psi': 0.44339617801536035}
[S7] START round=2 head_norm_before_train=0.843901 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7712708725898063, 'loss_val': 1.3169339554723374, 'psi': 0.39374244267337755}-{'f1_val': 0.14205682272909165, 'auprc': 0.7851543130117048, 'loss_val': 1.3294601124312244, 'psi': 0.39929581884213694}
[S8] START round=2 head_norm_before_train=1.163079 (no previous merge yet)
[S8] round=2 local utility u=0.040255 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7392475031164913, 'loss_val': 1.2793217997032442, 'psi': 0.37967259068237086}-{'f1_val': 0.13995598239295717, 'auprc': 0.7219342792481527, 'loss_val': 1.3078915338083268, 'psi': 0.3727473011350354}
[S9] START round=2 head_norm_before_train=1.179123 (no previous merge yet)
[S9] round=2 local utility u=0.041933 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9998283306137418, 'loss_val': 1.2505705550530994, 'psi': 0.4847701065294943}-{'f1_val': 0.141397957139996, 'auprc': 0.9921316586672215, 'loss_val': 1.3113470498550648, 'psi': 0.48169143775088624}
[S10] START round=2 head_norm_before_train=1.239519 (no previous merge yet)
[S10] round=2 local utility u=0.020808 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7911438286285355, 'loss_val': 1.2704525366528279, 'psi': 0.39963051397644855}-{'f1_val': 0.13862163754172394, 'auprc': 0.7931476241297993, 'loss_val': 1.3180801072850359, 'psi': 0.4004320321769541}
[S11] START round=2 head_norm_before_train=0.862934 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7695203143348708, 'loss_val': 1.30307807400874, 'psi': 0.3920563357578147}-{'f1_val': 0.422464449824724, 'auprc': 0.7973911077473206, 'loss_val': 1.3257857467455079, 'psi': 0.5724351129937626}
[S13] START round=2 head_norm_before_train=1.186236 (no previous merge yet)
[S13] round=2 local utility u=0.073332 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5030345092171199, 'loss_val': 1.3135814725544697, 'psi': 0.28544526123307984}-{'f1_val': 0.1403857625770531, 'auprc': 0.4664967392286693, 'loss_val': 1.350631655710067, 'psi': 0.2708301532376996}
[S14] START round=2 head_norm_before_train=1.190952 (no previous merge yet)
[S14] round=2 local utility u=0.124921 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6036446642398254, 'loss_val': 1.325844425977097, 'psi': 0.32567257742555245}-{'f1_val': 0.14035785288270378, 'auprc': 0.529523739172179, 'loss_val': 1.3533238601485775, 'psi': 0.2960242073984939}
[S15] START round=2 head_norm_before_train=0.777982 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7722975571899123, 'loss_val': 1.321550533070233, 'psi': 0.39275921369289996}-{'f1_val': 0.41584914540957585, 'auprc': 0.7752710445424287, 'loss_val': 1.333953689155267, 'psi': 0.559617905062717}
[S16] START round=2 head_norm_before_train=1.119788 (no previous merge yet)
[S16] round=2 local utility u=0.111400 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7883586380793766, 'loss_val': 1.2956406660080826, 'psi': 0.3997259253512726}-{'f1_val': 0.14063745019920318, 'auprc': 0.724658569694059, 'loss_val': 1.3273407611088106, 'psi': 0.37424589799714547}
[S17] START round=2 head_norm_before_train=1.199114 (no previous merge yet)
[S17] round=2 local utility u=0.452726 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8813233270943636, 'loss_val': 1.2895334956134594, 'psi': 0.4370987088281761}-{'f1_val': 0.14094896331738438, 'auprc': 0.5935102841655396, 'loss_val': 1.3315466048168068, 'psi': 0.32197349165664646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:51913
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:51911
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:51917
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:51904
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:51904
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:51903
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S4
[S3] cosine check vs S4: cos=0.0698
[S17] RECEIVED delta(kind=head bytes=1791) from S9
[S17] cosine check vs S9: cos=-0.0203
[S17] DROPPED delta from S9 (cos=-0.0203 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S2
[S17] cosine check vs S2: cos=-0.0819
[S17] DROPPED delta from S2 (cos=-0.0819 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S16
[S10] cosine check vs S16: cos=0.0689
[S16] RECEIVED delta(kind=head bytes=1789) from S14
[S16] cosine check vs S14: cos=-0.0205
[S16] DROPPED delta from S14 (cos=-0.0205 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S8
[S4] cosine check vs S8: cos=0.4408
[S4] RECEIVED delta(kind=head bytes=1793) from S13
[S4] cosine check vs S13: cos=-0.0714
[S4] DROPPED delta from S13 (cos=-0.0714 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S10
[S5] cosine check vs S10: cos=0.0950
[S13] RECEIVED delta(kind=head bytes=1797) from S3
[S13] cosine check vs S3: cos=-0.0511
[S13] DROPPED delta from S3 (cos=-0.0511 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:51911
[S17] sending update (kind=head size=1790 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1790) from S17
[S10] cosine check vs S17: cos=0.0096
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=0.864394
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.310959e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.4472 head_norm=0.798966 delta_norm=0.731096
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.264325
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.384216e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.776237 delta_norm=0.738422
[S10] aggregate: ACCEPT kept=['S16', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=0.763897
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.450080e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.834091 delta_norm=0.545008
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=2 metric=0.1398 head_norm=1.216467
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.952595e-01
[S3] stored merged vector for next round verification (round=2)
[S3] DEBUG after merge:  round=2 metric=0.1398 head_norm=0.740459 delta_norm=0.695260
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.235124 (no previous merge yet)
[S2] round=3 local utility u=0.108308 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7306194482646181, 'loss_val': 1.2199791812109153, 'psi': 0.3773140593389873}-{'f1_val': 0.1417771333885667, 'auprc': 0.6748043953247644, 'loss_val': 1.269150399351758, 'psi': 0.3549880381630458}
[S3] START round=3 head_norm_before_train=0.740459 cos_to_last_merge=1.0000 (last merge round=2)
[S3] round=3 local utility u=0.087162 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.98370993053403, 'loss_val': 1.304309893667639, 'psi': 0.4773880115820762}-{'f1_val': 0.13984006561410703, 'auprc': 0.9246809922468059, 'loss_val': 1.3015474518839647, 'psi': 0.45377643626718656}
[S4] START round=3 head_norm_before_train=0.834091 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.061149 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7302415006397903, 'loss_val': 1.3119710800510218, 'psi': 0.37623257759302664}-{'f1_val': 0.14022662889518414, 'auprc': 0.6917093684635256, 'loss_val': 1.3186726395468493, 'psi': 0.3608197247225207}
[S5] START round=3 head_norm_before_train=0.798966 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7430453691621903, 'loss_val': 1.3133977781178054, 'psi': 0.382575290522019}-{'f1_val': 0.14226190476190476, 'auprc': 0.7649702663280495, 'loss_val': 1.3201856267787495, 'psi': 0.3913452493883627}
[S6] START round=3 head_norm_before_train=1.203592 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7655138465546332, 'loss_val': 1.244540199835365, 'psi': 0.3910613078526225}-{'f1_val': 0.14142628205128205, 'auprc': 0.8259368280340187, 'loss_val': 1.277065585768575, 'psi': 0.4152305004443767}
[S7] START round=3 head_norm_before_train=0.862652 cos_to_last_merge=0.9970 (last merge round=1)
[S7] round=3 local utility u=0.018399 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774032046948939, 'loss_val': 1.2985330202427738, 'psi': 0.39619537551541256}-{'f1_val': 0.14205682272909165, 'auprc': 0.7712708725898063, 'loss_val': 1.3169339554723374, 'psi': 0.39374244267337755}
[S8] START round=3 head_norm_before_train=1.184037 (no previous merge yet)
[S8] round=3 local utility u=0.056205 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7655727598525147, 'loss_val': 1.2458865982773182, 'psi': 0.3902026933767802}-{'f1_val': 0.13995598239295717, 'auprc': 0.7392475031164913, 'loss_val': 1.2793217997032442, 'psi': 0.37967259068237086}
[S9] START round=3 head_norm_before_train=1.205321 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9471258872803416, 'loss_val': 1.1830739411111353, 'psi': 0.4636891291961343}-{'f1_val': 0.141397957139996, 'auprc': 0.9998283306137418, 'loss_val': 1.2505705550530994, 'psi': 0.4847701065294943}
[S10] START round=3 head_norm_before_train=0.776237 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7849614147175268, 'loss_val': 1.2797606686936158, 'psi': 0.3971575484120451}-{'f1_val': 0.13862163754172394, 'auprc': 0.7911438286285355, 'loss_val': 1.2704525366528279, 'psi': 0.39963051397644855}
[S11] START round=3 head_norm_before_train=0.883815 cos_to_last_merge=0.9966 (last merge round=1)
[S11] round=3 local utility u=0.022731 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7657210257176487, 'loss_val': 1.2462174543003062, 'psi': 0.39053662031092584}-{'f1_val': 0.14041368337311058, 'auprc': 0.7695203143348708, 'loss_val': 1.30307807400874, 'psi': 0.3920563357578147}
[S13] START round=3 head_norm_before_train=1.206668 (no previous merge yet)
[S13] round=3 local utility u=0.103929 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5588152478844839, 'loss_val': 1.2730656839863455, 'psi': 0.3077575567000254}-{'f1_val': 0.1403857625770531, 'auprc': 0.5030345092171199, 'loss_val': 1.3135814725544697, 'psi': 0.28544526123307984}
[S14] START round=3 head_norm_before_train=1.206557 (no previous merge yet)
[S14] round=3 local utility u=0.249744 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7592145161868831, 'loss_val': 1.2930666711603276, 'psi': 0.3879005182043755}-{'f1_val': 0.14035785288270378, 'auprc': 0.6036446642398254, 'loss_val': 1.325844425977097, 'psi': 0.32567257742555245}
[S15] START round=3 head_norm_before_train=0.802651 cos_to_last_merge=0.9968 (last merge round=1)
[S15] round=3 local utility u=0.021017 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7740314077511966, 'loss_val': 1.284718831326492, 'psi': 0.3934527539174137}-{'f1_val': 0.13973365136155833, 'auprc': 0.7722975571899123, 'loss_val': 1.321550533070233, 'psi': 0.39275921369289996}
[S16] START round=3 head_norm_before_train=1.144319 (no previous merge yet)
[S16] round=3 local utility u=0.065842 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8210085187759837, 'loss_val': 1.2619060811432492, 'psi': 0.41278587762991537}-{'f1_val': 0.14063745019920318, 'auprc': 0.7883586380793766, 'loss_val': 1.2956406660080826, 'psi': 0.3997259253512726}
[S17] START round=3 head_norm_before_train=1.225323 (no previous merge yet)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8099245152638533, 'loss_val': 1.227808285862871, 'psi': 0.408539184095972}-{'f1_val': 0.14094896331738438, 'auprc': 0.8813233270943636, 'loss_val': 1.2895334956134594, 'psi': 0.4370987088281761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:51908
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:51917
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.0873
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] cosine check vs S11: cos=-0.0024
[S13] DROPPED delta from S11 (cos=-0.0024 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1790) from S8
[S17] cosine check vs S8: cos=0.0611
[S11] RECEIVED delta(kind=head bytes=1791) from S4
[S11] cosine check vs S4: cos=-0.0436
[S11] DROPPED delta from S4 (cos=-0.0436 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S2
[S17] cosine check vs S2: cos=-0.0804
[S17] DROPPED delta from S2 (cos=-0.0804 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.0128
[S5] RECEIVED delta(kind=head bytes=1792) from S15
[S5] cosine check vs S15: cos=-0.1684
[S5] DROPPED delta from S15 (cos=-0.1684 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S7
[S5] cosine check vs S7: cos=-0.0465
[S5] DROPPED delta from S7 (cos=-0.0465 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=-0.0723
[S9] DROPPED delta from S3 (cos=-0.0723 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1795) from S13
[S5] cosine check vs S13: cos=-0.1528
[S5] DROPPED delta from S13 (cos=-0.1528 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.880775
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.860613e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.630413 delta_norm=0.586061
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.260236
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.463856e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.899723 delta_norm=0.846386
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.263414 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6097285932978824, 'loss_val': 1.1855734838272853, 'psi': 0.328957717352293}-{'f1_val': 0.1417771333885667, 'auprc': 0.7306194482646181, 'loss_val': 1.2199791812109153, 'psi': 0.3773140593389873}
[S3] START round=4 head_norm_before_train=0.767172 cos_to_last_merge=0.9961 (last merge round=2)
[S3] round=4 local utility u=0.007109 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9737052261792576, 'loss_val': 1.260077569849503, 'psi': 0.47338612984016726}-{'f1_val': 0.13984006561410703, 'auprc': 0.98370993053403, 'loss_val': 1.304309893667639, 'psi': 0.4773880115820762}
[S4] START round=4 head_norm_before_train=0.850711 cos_to_last_merge=0.9975 (last merge round=2)
[S4] round=4 local utility u=0.094837 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7797843784932785, 'loss_val': 1.2709254562760672, 'psi': 0.3960497287344219}-{'f1_val': 0.14022662889518414, 'auprc': 0.7302415006397903, 'loss_val': 1.3119710800510218, 'psi': 0.37623257759302664}
[S5] START round=4 head_norm_before_train=0.818709 cos_to_last_merge=0.9955 (last merge round=2)
[S5] round=4 local utility u=0.014738 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7310451368581761, 'loss_val': 1.2479215279954776, 'psi': 0.3777751976004133}-{'f1_val': 0.14226190476190476, 'auprc': 0.7430453691621903, 'loss_val': 1.3133977781178054, 'psi': 0.382575290522019}
[S6] START round=4 head_norm_before_train=1.235373 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6672834414052611, 'loss_val': 1.2143927063283748, 'psi': 0.35176914579287366}-{'f1_val': 0.14142628205128205, 'auprc': 0.7655138465546332, 'loss_val': 1.244540199835365, 'psi': 0.3910613078526225}
[S7] START round=4 head_norm_before_train=0.630413 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7766676703780877, 'loss_val': 1.3031950347768342, 'psi': 0.3959011617886901}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774032046948939, 'loss_val': 1.2985330202427738, 'psi': 0.39619537551541256}
[S8] START round=4 head_norm_before_train=1.209771 (no previous merge yet)
[S8] round=4 local utility u=0.022121 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7672885863797219, 'loss_val': 1.206792387972403, 'psi': 0.39088902398766306}-{'f1_val': 0.13995598239295717, 'auprc': 0.7655727598525147, 'loss_val': 1.2458865982773182, 'psi': 0.3902026933767802}
[S9] START round=4 head_norm_before_train=1.237913 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6883870377396188, 'loss_val': 1.1082920906764557, 'psi': 0.36019358937984514}-{'f1_val': 0.141397957139996, 'auprc': 0.9471258872803416, 'loss_val': 1.1830739411111353, 'psi': 0.4636891291961343}
[S10] START round=4 head_norm_before_train=0.802826 cos_to_last_merge=0.9972 (last merge round=2)
[S10] round=4 local utility u=0.026862 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7842087226088744, 'loss_val': 1.2237783141140246, 'psi': 0.39685647156858417}-{'f1_val': 0.13862163754172394, 'auprc': 0.7849614147175268, 'loss_val': 1.2797606686936158, 'psi': 0.3971575484120451}
[S11] START round=4 head_norm_before_train=0.913340 cos_to_last_merge=0.9875 (last merge round=1)
[S11] round=4 local utility u=0.021064 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.76356508941789, 'loss_val': 1.1976220216062294, 'psi': 0.3896742457910224}-{'f1_val': 0.14041368337311058, 'auprc': 0.7657210257176487, 'loss_val': 1.2462174543003062, 'psi': 0.39053662031092584}
[S13] START round=4 head_norm_before_train=1.234927 (no previous merge yet)
[S13] round=4 local utility u=0.186426 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6743131674088128, 'loss_val': 1.2467083185185344, 'psi': 0.35395672450975696}-{'f1_val': 0.1403857625770531, 'auprc': 0.5588152478844839, 'loss_val': 1.2730656839863455, 'psi': 0.3077575567000254}
[S14] START round=4 head_norm_before_train=1.230877 (no previous merge yet)
[S14] round=4 local utility u=0.042257 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7744368928241034, 'loss_val': 1.2542202378064486, 'psi': 0.39398946885926367}-{'f1_val': 0.14035785288270378, 'auprc': 0.7592145161868831, 'loss_val': 1.2930666711603276, 'psi': 0.3879005182043755}
[S15] START round=4 head_norm_before_train=0.834935 cos_to_last_merge=0.9887 (last merge round=1)
[S15] round=4 local utility u=0.024837 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766294056831403, 'loss_val': 1.242839154792398, 'psi': 0.39449195309019114}-{'f1_val': 0.13973365136155833, 'auprc': 0.7740314077511966, 'loss_val': 1.284718831326492, 'psi': 0.3934527539174137}
[S16] START round=4 head_norm_before_train=1.173713 (no previous merge yet)
[S16] round=4 local utility u=0.097385 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8707803979150339, 'loss_val': 1.2164516263489262, 'psi': 0.4326946292855355}-{'f1_val': 0.14063745019920318, 'auprc': 0.8210085187759837, 'loss_val': 1.2619060811432492, 'psi': 0.41278587762991537}
[S17] START round=4 head_norm_before_train=0.899723 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6713961259367653, 'loss_val': 1.204582530466493, 'psi': 0.3531278283651368}-{'f1_val': 0.14094896331738438, 'auprc': 0.8099245152638533, 'loss_val': 1.227808285862871, 'psi': 0.408539184095972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:51907
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S4] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=-0.0767
[S9] DROPPED delta from S3 (cos=-0.0767 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S4
[S11] cosine check vs S4: cos=-0.0452
[S11] DROPPED delta from S4 (cos=-0.0452 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=-0.1689
[S5] DROPPED delta from S15 (cos=-0.1689 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.4391
[S11] RECEIVED delta(kind=head bytes=1797) from S5
[S11] cosine check vs S5: cos=0.3337
[S5] RECEIVED delta(kind=head bytes=1792) from S13
[S5] cosine check vs S13: cos=-0.1545
[S5] DROPPED delta from S13 (cos=-0.1545 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=0.0031
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.5296
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.6886
[S6] RECEIVED delta(kind=head bytes=1796) from S10
[S6] cosine check vs S10: cos=-0.0246
[S6] DROPPED delta from S10 (cos=-0.0246 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.652583
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.109413e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.698578 delta_norm=0.310941
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.1404 head_norm=1.256392
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.845945e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.786938 delta_norm=0.784594
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.944032
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.182621e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.731599 delta_norm=0.518262
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.930724
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.488604e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.995831 delta_norm=0.448860
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.291654 (no previous merge yet)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.4156703010573377, 'auprc': 0.7552171807546298, 'loss_val': 1.1198752849068132, 'psi': 0.5514890529362546}-{'f1_val': 0.1417771333885667, 'auprc': 0.6097285932978824, 'loss_val': 1.1855734838272853, 'psi': 0.328957717352293}
[S3] START round=5 head_norm_before_train=0.805514 cos_to_last_merge=0.9850 (last merge round=2)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9253710554108515, 'loss_val': 1.19086736818689, 'psi': 0.4540524615328049}-{'f1_val': 0.13984006561410703, 'auprc': 0.9737052261792576, 'loss_val': 1.260077569849503, 'psi': 0.47338612984016726}
[S4] START round=5 head_norm_before_train=0.880072 cos_to_last_merge=0.9895 (last merge round=2)
[S4] round=5 local utility u=0.874784 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7903356177180054, 'loss_val': 1.196821046875519, 'psi': 0.56465111323888}-{'f1_val': 0.14022662889518414, 'auprc': 0.7797843784932785, 'loss_val': 1.2709254562760672, 'psi': 0.3960497287344219}
[S5] START round=5 head_norm_before_train=0.846444 cos_to_last_merge=0.9848 (last merge round=2)
[S5] round=5 local utility u=0.025513 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.731528640521996, 'loss_val': 1.198346057908716, 'psi': 0.37796859906594127}-{'f1_val': 0.14226190476190476, 'auprc': 0.7310451368581761, 'loss_val': 1.2479215279954776, 'psi': 0.3777751976004133}
[S6] START round=5 head_norm_before_train=1.264968 (no previous merge yet)
[S6] round=5 local utility u=0.034213 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6728201230092574, 'loss_val': 1.1625761095433873, 'psi': 0.3539838184344722}-{'f1_val': 0.14142628205128205, 'auprc': 0.6672834414052611, 'loss_val': 1.2143927063283748, 'psi': 0.35176914579287366}
[S7] START round=5 head_norm_before_train=0.698578 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.006092 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775057242274215, 'loss_val': 1.293524296020759, 'psi': 0.3962363833284236}-{'f1_val': 0.14205682272909165, 'auprc': 0.7766676703780877, 'loss_val': 1.3031950347768342, 'psi': 0.3959011617886901}
[S8] START round=5 head_norm_before_train=1.232908 (no previous merge yet)
[S8] round=5 local utility u=0.710230 metrics={'f1_val': 0.36609113691915796, 'auprc': 0.7707298442640367, 'loss_val': 1.1534670660806752, 'psi': 0.5279466198571094}-{'f1_val': 0.13995598239295717, 'auprc': 0.7672885863797219, 'loss_val': 1.206792387972403, 'psi': 0.39088902398766306}
[S9] START round=5 head_norm_before_train=1.264787 (no previous merge yet)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.41556143742054374, 'auprc': 0.8028733129735095, 'loss_val': 0.9982972567715869, 'psi': 0.57048618764173}-{'f1_val': 0.141397957139996, 'auprc': 0.6883870377396188, 'loss_val': 1.1082920906764557, 'psi': 0.36019358937984514}
[S10] START round=5 head_norm_before_train=0.835569 cos_to_last_merge=0.9901 (last merge round=2)
[S10] round=5 local utility u=0.000508 metrics={'f1_val': 0.17562285195127547, 'auprc': 0.6881080350589643, 'loss_val': 1.1564681665363106, 'psi': 0.38061692519435103}-{'f1_val': 0.13862163754172394, 'auprc': 0.7842087226088744, 'loss_val': 1.2237783141140246, 'psi': 0.39685647156858417}
[S11] START round=5 head_norm_before_train=0.731599 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.026448 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7664903820875257, 'loss_val': 1.153500992036976, 'psi': 0.39084436285887664}-{'f1_val': 0.14041368337311058, 'auprc': 0.76356508941789, 'loss_val': 1.1976220216062294, 'psi': 0.3896742457910224}
[S13] START round=5 head_norm_before_train=0.786938 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.075992 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7261629405063008, 'loss_val': 1.2502727832402936, 'psi': 0.3746966337487522}-{'f1_val': 0.1403857625770531, 'auprc': 0.6743131674088128, 'loss_val': 1.2467083185185344, 'psi': 0.35395672450975696}
[S14] START round=5 head_norm_before_train=1.262868 (no previous merge yet)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6081098193019211, 'loss_val': 1.2137940400727818, 'psi': 0.3274586394503907}-{'f1_val': 0.14035785288270378, 'auprc': 0.7744368928241034, 'loss_val': 1.2542202378064486, 'psi': 0.39398946885926367}
[S15] START round=5 head_norm_before_train=0.868677 cos_to_last_merge=0.9776 (last merge round=1)
[S15] round=5 local utility u=0.023043 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7770531757048359, 'loss_val': 1.1980237468970467, 'psi': 0.3946614610988694}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766294056831403, 'loss_val': 1.242839154792398, 'psi': 0.39449195309019114}
[S16] START round=5 head_norm_before_train=1.208086 (no previous merge yet)
[S16] round=5 local utility u=0.790461 metrics={'f1_val': 0.4148762816002004, 'auprc': 0.8225955870712729, 'loss_val': 1.1364082106901718, 'psi': 0.5779640037886294}-{'f1_val': 0.14063745019920318, 'auprc': 0.8707803979150339, 'loss_val': 1.2164516263489262, 'psi': 0.4326946292855355}
[S17] START round=5 head_norm_before_train=0.995831 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6299647289496277, 'loss_val': 1.1475415639998878, 'psi': 0.33655526957028176}-{'f1_val': 0.14094896331738438, 'auprc': 0.6713961259367653, 'loss_val': 1.204582530466493, 'psi': 0.3531278283651368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:51908
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=-0.0316
[S11] DROPPED delta from S4 (cos=-0.0316 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=0.7755
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9193
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.0023
[S2] RECEIVED delta(kind=head bytes=1807) from S9
[S2] cosine check vs S9: cos=0.0040
[S7] RECEIVED delta(kind=head bytes=1799) from S16
[S7] cosine check vs S16: cos=0.5996
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=0.0703
[S5] RECEIVED delta(kind=head bytes=1796) from S7
[S5] cosine check vs S7: cos=0.0489
[S5] RECEIVED delta(kind=head bytes=1790) from S15
[S5] cosine check vs S15: cos=-0.1652
[S5] DROPPED delta from S15 (cos=-0.1652 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.4313
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=-0.0932
[S15] DROPPED delta from S6 (cos=-0.0932 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=-0.0169
[S6] DROPPED delta from S10 (cos=-0.0169 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=0.402 → S7@127.0.0.1:51908
[S3] ⇄ pheromone p=0.379 → S9@127.0.0.1:51910
[S10] ⇄ pheromone p=0.334 → S6@127.0.0.1:51907
[S6] ⇄ pheromone p=0.335 → S15@127.0.0.1:51915
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.761090
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.790059e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.770529 delta_norm=0.279006
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.421 → S13@127.0.0.1:51913
[S8] ⇄ pheromone p=0.487 → S17@127.0.0.1:51917
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.1404 head_norm=0.812620
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.201594e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.665786 delta_norm=0.420159
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.441 → S5@127.0.0.1:51905
[S4] ⇄ pheromone p=0.560 → S11@127.0.0.1:51912
[S9] ⇄ pheromone p=0.532 → S2@127.0.0.1:51902
[S15] ⇄ pheromone p=0.421 → S5@127.0.0.1:51905
[S16] ⇄ pheromone p=0.583 → S7@127.0.0.1:51908
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.4157 head_norm=1.308723
[S2] _apply_head_vector_avg (torch): Δ‖w‖=9.165704e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.4164 head_norm=0.920208 delta_norm=0.916570
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.550 → S17@127.0.0.1:51917
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.717561
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.974720e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.884397 delta_norm=0.497472
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.360 → S5@127.0.0.1:51905
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=0.873991
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.845893e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=0.524513 delta_norm=0.484589
[S5] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.335 → S11@127.0.0.1:51912
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=1.017033
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.204663e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1691 head_norm=0.875332 delta_norm=0.420466
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.395 → S16@127.0.0.1:51916
[S2] START round=6 head_norm_before_train=0.920208 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.000000 metrics={'f1_val': 0.4168984104266471, 'auprc': 0.7590617249320656, 'loss_val': 1.1410968682836313, 'psi': 0.5537637362288146}-{'f1_val': 0.4156703010573377, 'auprc': 0.7552171807546298, 'loss_val': 1.1198752849068132, 'psi': 0.5514890529362546}
[S3] START round=6 head_norm_before_train=0.850137 cos_to_last_merge=0.9699 (last merge round=2)
[S3] round=6 local utility u=0.055820 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9179099905570577, 'loss_val': 1.0568433352202495, 'psi': 0.4510680355912873}-{'f1_val': 0.13984006561410703, 'auprc': 0.9253710554108515, 'loss_val': 1.19086736818689, 'psi': 0.4540524615328049}
[S4] START round=6 head_norm_before_train=0.923499 cos_to_last_merge=0.9776 (last merge round=2)
[S4] round=6 local utility u=0.075855 metrics={'f1_val': 0.415625539257981, 'auprc': 0.7914412915834048, 'loss_val': 1.057012796489154, 'psi': 0.5659518401881505}-{'f1_val': 0.41419477691946305, 'auprc': 0.7903356177180054, 'loss_val': 1.196821046875519, 'psi': 0.56465111323888}
[S5] START round=6 head_norm_before_train=0.524513 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.067466 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701499676149676, 'loss_val': 1.1792782107160198, 'psi': 0.3934171299031299}-{'f1_val': 0.14226190476190476, 'auprc': 0.731528640521996, 'loss_val': 1.198346057908716, 'psi': 0.37796859906594127}
[S6] START round=6 head_norm_before_train=1.291667 (no previous merge yet)
[S6] round=6 local utility u=0.068306 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6844843986061322, 'loss_val': 1.0609571341619335, 'psi': 0.3586495286732221}-{'f1_val': 0.14142628205128205, 'auprc': 0.6728201230092574, 'loss_val': 1.1625761095433873, 'psi': 0.3539838184344722}
[S7] START round=6 head_norm_before_train=0.884397 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.003625 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.776934426317602, 'loss_val': 1.2845602974992305, 'psi': 0.3960078641644958}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775057242274215, 'loss_val': 1.293524296020759, 'psi': 0.3962363833284236}
[S8] START round=6 head_norm_before_train=1.257477 (no previous merge yet)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7145237961103252, 'auprc': 0.7841233010182579, 'loss_val': 1.0521441376065293, 'psi': 0.7423635980734984}-{'f1_val': 0.36609113691915796, 'auprc': 0.7707298442640367, 'loss_val': 1.1534670660806752, 'psi': 0.5279466198571094}
[S9] START round=6 head_norm_before_train=1.288802 (no previous merge yet)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.41637066856105454, 'auprc': 0.6691614892885132, 'loss_val': 0.8487963949229037, 'psi': 0.517486996852038}-{'f1_val': 0.41556143742054374, 'auprc': 0.8028733129735095, 'loss_val': 0.9982972567715869, 'psi': 0.57048618764173}
[S10] START round=6 head_norm_before_train=0.871806 cos_to_last_merge=0.9804 (last merge round=2)
[S10] round=6 local utility u=0.995613 metrics={'f1_val': 0.4170518629654155, 'auprc': 0.8301723354692077, 'loss_val': 1.0400100768073854, 'psi': 0.5823000519669324}-{'f1_val': 0.17562285195127547, 'auprc': 0.6881080350589643, 'loss_val': 1.1564681665363106, 'psi': 0.38061692519435103}
[S11] START round=6 head_norm_before_train=0.770529 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.229263 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8982050258306916, 'loss_val': 1.0901186126618538, 'psi': 0.44353022035614303}-{'f1_val': 0.14041368337311058, 'auprc': 0.7664903820875257, 'loss_val': 1.153500992036976, 'psi': 0.39084436285887664}
[S13] START round=6 head_norm_before_train=0.665786 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.002227 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7262277988213703, 'loss_val': 1.2460133368622957, 'psi': 0.37472257707478}-{'f1_val': 0.1403857625770531, 'auprc': 0.7261629405063008, 'loss_val': 1.2502727832402936, 'psi': 0.3746966337487522}
[S14] START round=6 head_norm_before_train=1.293693 (no previous merge yet)
[S14] round=6 local utility u=0.264059 metrics={'f1_val': 0.14381747810144632, 'auprc': 0.7558555854189318, 'loss_val': 1.149670104729329, 'psi': 0.3886327210284406}-{'f1_val': 0.14035785288270378, 'auprc': 0.6081098193019211, 'loss_val': 1.2137940400727818, 'psi': 0.3274586394503907}
[S15] START round=6 head_norm_before_train=0.896530 cos_to_last_merge=0.9679 (last merge round=1)
[S15] round=6 local utility u=0.393907 metrics={'f1_val': 0.2594095149061768, 'auprc': 0.7770546246263895, 'loss_val': 1.1282690318177129, 'psi': 0.46646755879426194}-{'f1_val': 0.13973365136155833, 'auprc': 0.7770531757048359, 'loss_val': 1.1980237468970467, 'psi': 0.3946614610988694}
[S16] START round=6 head_norm_before_train=1.242731 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4170320622992751, 'auprc': 0.7651583725595227, 'loss_val': 0.9932605704268089, 'psi': 0.5562825864033741}-{'f1_val': 0.4148762816002004, 'auprc': 0.8225955870712729, 'loss_val': 1.1364082106901718, 'psi': 0.5779640037886294}
[S17] START round=6 head_norm_before_train=0.875332 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.586780 metrics={'f1_val': 0.3118553261077234, 'auprc': 0.6572640206553323, 'loss_val': 1.081318493820496, 'psi': 0.45001880392676696}-{'f1_val': 0.14094896331738438, 'auprc': 0.6299647289496277, 'loss_val': 1.1475415639998878, 'psi': 0.33655526957028176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:51905
[S3] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.8833
[S11] RECEIVED delta(kind=head bytes=1802) from S5
[S11] cosine check vs S5: cos=0.8900
[S11] RECEIVED delta(kind=head bytes=1796) from S4
[S11] cosine check vs S4: cos=-0.0112
[S11] DROPPED delta from S4 (cos=-0.0112 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=-0.0095
[S6] DROPPED delta from S10 (cos=-0.0095 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S13
[S5] cosine check vs S13: cos=0.6807
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=-0.0812
[S9] DROPPED delta from S3 (cos=-0.0812 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:51913
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:51916
[S6] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S6
[S15] cosine check vs S6: cos=-0.0977
[S15] DROPPED delta from S6 (cos=-0.0977 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S7
[S5] cosine check vs S7: cos=0.3133
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=0.6871
[S17] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S17
[S16] cosine check vs S17: cos=-0.1130
[S16] DROPPED delta from S17 (cos=-0.1130 < 0.0)
[S15] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S15
[S5] cosine check vs S15: cos=-0.0173
[S5] DROPPED delta from S15 (cos=-0.0173 < 0.0)
[S14] sending update (kind=head size=1804 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.2735
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=0.555264
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.192410e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=0.505448 delta_norm=0.219241
[S5] aggregate: ACCEPT kept=['S13', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.802463
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.994846e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.660559 delta_norm=0.199485
[S11] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.1404 head_norm=0.684480
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.990016e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.683248 delta_norm=0.299002
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3119 head_norm=0.898993
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.237192e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3910 head_norm=1.061015 delta_norm=0.323719
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.897348
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.871844e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.891565 delta_norm=0.687184
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.943503 cos_to_last_merge=0.9981 (last merge round=5)
[S2] round=7 local utility u=0.000000 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.6912897195693638, 'loss_val': 1.0521179734701538, 'psi': 0.5266789289272334}-{'f1_val': 0.4168984104266471, 'auprc': 0.7590617249320656, 'loss_val': 1.1410968682836313, 'psi': 0.5537637362288146}
[S3] START round=7 head_norm_before_train=0.901707 cos_to_last_merge=0.9519 (last merge round=2)
[S3] round=7 local utility u=0.969484 metrics={'f1_val': 0.39635856801559805, 'auprc': 0.996416288007237, 'loss_val': 0.8925051748089359, 'psi': 0.6363816560122536}-{'f1_val': 0.13984006561410703, 'auprc': 0.9179099905570577, 'loss_val': 1.0568433352202495, 'psi': 0.4510680355912873}
[S4] START round=7 head_norm_before_train=0.970767 cos_to_last_merge=0.9627 (last merge round=2)
[S4] round=7 local utility u=0.078908 metrics={'f1_val': 0.4147212523141096, 'auprc': 0.7868730013983704, 'loss_val': 0.880066575425362, 'psi': 0.5635819519478139}-{'f1_val': 0.415625539257981, 'auprc': 0.7914412915834048, 'loss_val': 1.057012796489154, 'psi': 0.5659518401881505}
[S5] START round=7 head_norm_before_train=0.505448 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.858646 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7777127563003032, 'loss_val': 1.137605818749918, 'psi': 0.5617354359895645}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701499676149676, 'loss_val': 1.1792782107160198, 'psi': 0.3934171299031299}
[S6] START round=7 head_norm_before_train=1.318154 (no previous merge yet)
[S6] round=7 local utility u=1.000000 metrics={'f1_val': 0.4132133576322095, 'auprc': 0.766621435721839, 'loss_val': 0.9349995733119795, 'psi': 0.5545765888680614}-{'f1_val': 0.14142628205128205, 'auprc': 0.6844843986061322, 'loss_val': 1.0609571341619335, 'psi': 0.3586495286732221}
[S7] START round=7 head_norm_before_train=0.891565 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.011010 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778173368587006, 'loss_val': 1.2651893529834985, 'psi': 0.39636102838093523}-{'f1_val': 0.14205682272909165, 'auprc': 0.776934426317602, 'loss_val': 1.2845602974992305, 'psi': 0.3960078641644958}
[S8] START round=7 head_norm_before_train=1.285654 (no previous merge yet)
[S8] round=7 local utility u=0.106430 metrics={'f1_val': 0.7155419475775954, 'auprc': 0.7947732665760213, 'loss_val': 0.8773431194582202, 'psi': 0.7472344751769657}-{'f1_val': 0.7145237961103252, 'auprc': 0.7841233010182579, 'loss_val': 1.0521441376065293, 'psi': 0.7423635980734984}
[S9] START round=7 head_norm_before_train=1.324583 (no previous merge yet)
[S9] round=7 local utility u=0.568695 metrics={'f1_val': 0.43663482010144106, 'auprc': 0.9581895824244842, 'loss_val': 0.7000759814397419, 'psi': 0.6452567250306582}-{'f1_val': 0.41637066856105454, 'auprc': 0.6691614892885132, 'loss_val': 0.8487963949229037, 'psi': 0.517486996852038}
[S10] START round=7 head_norm_before_train=0.908870 cos_to_last_merge=0.9686 (last merge round=2)
[S10] round=7 local utility u=0.190017 metrics={'f1_val': 0.4368067227146734, 'auprc': 0.8562788229662839, 'loss_val': 0.8568248010069492, 'psi': 0.6045955628153177}-{'f1_val': 0.4170518629654155, 'auprc': 0.8301723354692077, 'loss_val': 1.0400100768073854, 'psi': 0.5823000519669324}
[S11] START round=7 head_norm_before_train=0.660559 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.818562 metrics={'f1_val': 0.41660571985799394, 'auprc': 0.8685405086459289, 'loss_val': 1.021153498968509, 'psi': 0.597379635373168}-{'f1_val': 0.14041368337311058, 'auprc': 0.8982050258306916, 'loss_val': 1.0901186126618538, 'psi': 0.44353022035614303}
[S13] START round=7 head_norm_before_train=0.683248 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5830911848072444, 'loss_val': 1.2336765699057084, 'psi': 0.31746793146912966}-{'f1_val': 0.1403857625770531, 'auprc': 0.7262277988213703, 'loss_val': 1.2460133368622957, 'psi': 0.37472257707478}
[S14] START round=7 head_norm_before_train=1.314910 (no previous merge yet)
[S14] round=7 local utility u=0.851032 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.7785095383069486, 'loss_val': 1.0318281212842777, 'psi': 0.5493203579699341}-{'f1_val': 0.14381747810144632, 'auprc': 0.7558555854189318, 'loss_val': 1.149670104729329, 'psi': 0.3886327210284406}
[S15] START round=7 head_norm_before_train=0.931287 cos_to_last_merge=0.9575 (last merge round=1)
[S15] round=7 local utility u=0.541163 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7782859944582536, 'loss_val': 0.9914353183578197, 'psi': 0.5611399014876679}-{'f1_val': 0.2594095149061768, 'auprc': 0.7770546246263895, 'loss_val': 1.1282690318177129, 'psi': 0.46646755879426194}
[S16] START round=7 head_norm_before_train=1.282998 (no previous merge yet)
[S16] round=7 local utility u=0.028811 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.7393453757855504, 'loss_val': 0.8596429395544235, 'psi': 0.5461016835001884}-{'f1_val': 0.4170320622992751, 'auprc': 0.7651583725595227, 'loss_val': 0.9932605704268089, 'psi': 0.5562825864033741}
[S17] START round=7 head_norm_before_train=1.061015 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.422477 metrics={'f1_val': 0.3912518234391188, 'auprc': 0.7537442579650063, 'loss_val': 1.002183803840385, 'psi': 0.5362487972494738}-{'f1_val': 0.3118553261077234, 'auprc': 0.6572640206553323, 'loss_val': 1.081318493820496, 'psi': 0.45001880392676696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:51915
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:51916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.8705
[S6] RECEIVED delta(kind=head bytes=1795) from S10
[S6] cosine check vs S10: cos=0.0001
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.8398
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=0.6530
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9614
[S15] RECEIVED delta(kind=head bytes=1797) from S6
[S15] cosine check vs S6: cos=-0.1000
[S15] DROPPED delta from S6 (cos=-0.1000 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=0.9242
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.0351
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=-0.0837
[S9] DROPPED delta from S3 (cos=-0.0837 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.0195
[S5] RECEIVED delta(kind=head bytes=1796) from S7
[S5] cosine check vs S7: cos=0.4068
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] cosine check vs S17: cos=-0.0921
[S16] DROPPED delta from S17 (cos=-0.0921 < 0.0)
[S16] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S16
[S7] cosine check vs S16: cos=0.4379
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.1404 head_norm=0.696875
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.361576e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.686074 delta_norm=0.136158
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4178 head_norm=0.537900
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.637959e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7153 head_norm=0.491217 delta_norm=0.363796
[S5] aggregate: ACCEPT kept=['S15', 'S7'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4132 head_norm=1.354068
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.292216e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.4150 head_norm=0.829306 delta_norm=0.829222
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=0.911225
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.648190e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=0.909690 delta_norm=0.164819
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4166 head_norm=0.702024
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.589987e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4130 head_norm=0.542594 delta_norm=0.358999
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4169 head_norm=0.979861
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.188839e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4174 head_norm=1.068985 delta_norm=0.518884
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3913 head_norm=1.085954
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.029256e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3869 head_norm=1.190899 delta_norm=0.202926
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.068985 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.094265 metrics={'f1_val': 0.4170625860640346, 'auprc': 0.7400810214312906, 'loss_val': 1.0107077995586857, 'psi': 0.5462699602109371}-{'f1_val': 0.4169384018324798, 'auprc': 0.6912897195693638, 'loss_val': 1.0521179734701538, 'psi': 0.5266789289272334}
[S3] START round=8 head_norm_before_train=0.959683 cos_to_last_merge=0.9304 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.4009668676591264, 'auprc': 0.8062801166094489, 'loss_val': 0.8654430591443345, 'psi': 0.5630921672392555}-{'f1_val': 0.39635856801559805, 'auprc': 0.996416288007237, 'loss_val': 0.8925051748089359, 'psi': 0.6363816560122536}
[S4] START round=8 head_norm_before_train=1.018328 cos_to_last_merge=0.9454 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=8 local utility u=0.724543 metrics={'f1_val': 0.6493801567287645, 'auprc': 0.7652119850544437, 'loss_val': 0.7739519150909632, 'psi': 0.6957128880590362}-{'f1_val': 0.4147212523141096, 'auprc': 0.7868730013983704, 'loss_val': 0.880066575425362, 'psi': 0.5635819519478139}
[S5] START round=8 head_norm_before_train=0.491217 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.003363 metrics={'f1_val': 0.41750764008433106, 'auprc': 0.7771401531563764, 'loss_val': 1.1277040424119813, 'psi': 0.5613606453131492}-{'f1_val': 0.4177505557824055, 'auprc': 0.7777127563003032, 'loss_val': 1.137605818749918, 'psi': 0.5617354359895645}
[S6] START round=8 head_norm_before_train=0.829306 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.011651 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.7635509353538974, 'loss_val': 0.9207209158118312, 'psi': 0.5551718755160084}-{'f1_val': 0.4132133576322095, 'auprc': 0.766621435721839, 'loss_val': 0.9349995733119795, 'psi': 0.5545765888680614}
[S7] START round=8 head_norm_before_train=0.909690 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.010770 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778767649367809, 'loss_val': 1.2438276324694661, 'psi': 0.3963847996121674}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778173368587006, 'loss_val': 1.2651893529834985, 'psi': 0.39636102838093523}
[S8] START round=8 head_norm_before_train=1.318918 (no previous merge yet)
[S8] round=8 local utility u=0.390087 metrics={'f1_val': 0.7145304389123006, 'auprc': 0.9980677395864304, 'loss_val': 0.7009825951235569, 'psi': 0.8279453591819526}-{'f1_val': 0.7155419475775954, 'auprc': 0.7947732665760213, 'loss_val': 0.8773431194582202, 'psi': 0.7472344751769657}
[S9] START round=8 head_norm_before_train=1.365215 (no previous merge yet)
[S9] round=8 local utility u=0.939699 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9997910213312287, 'loss_val': 0.5353627179048622, 'psi': 0.8208853179634286}-{'f1_val': 0.43663482010144106, 'auprc': 0.9581895824244842, 'loss_val': 0.7000759814397419, 'psi': 0.6452567250306582}
[S10] START round=8 head_norm_before_train=0.957714 cos_to_last_merge=0.9531 (last merge round=2)
[S10] round=8 local utility u=0.980470 metrics={'f1_val': 0.6991138219049687, 'auprc': 0.9310837189750423, 'loss_val': 0.6941426052702665, 'psi': 0.7919017807329982}-{'f1_val': 0.4368067227146734, 'auprc': 0.8562788229662839, 'loss_val': 0.8568248010069492, 'psi': 0.6045955628153177}
[S11] START round=8 head_norm_before_train=0.542594 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.143206 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9936476458895224, 'loss_val': 0.9897424895989477, 'psi': 0.6353903999115327}-{'f1_val': 0.41660571985799394, 'auprc': 0.8685405086459289, 'loss_val': 1.021153498968509, 'psi': 0.597379635373168}
[S13] START round=8 head_norm_before_train=0.686074 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.856256 metrics={'f1_val': 0.415486691627877, 'auprc': 0.5887094639846533, 'loss_val': 1.1886245765421737, 'psi': 0.4847758005705875}-{'f1_val': 0.1403857625770531, 'auprc': 0.5830911848072444, 'loss_val': 1.2336765699057084, 'psi': 0.31746793146912966}
[S14] START round=8 head_norm_before_train=1.352658 (no previous merge yet)
[S14] round=8 local utility u=0.121042 metrics={'f1_val': 0.39649470961585787, 'auprc': 0.8113060579618163, 'loss_val': 0.88793647185739, 'psi': 0.5624192489542412}-{'f1_val': 0.39652757107859105, 'auprc': 0.7785095383069486, 'loss_val': 1.0318281212842777, 'psi': 0.5493203579699341}
[S15] START round=8 head_norm_before_train=0.980513 cos_to_last_merge=0.9427 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=8 local utility u=0.933940 metrics={'f1_val': 0.6965447885322733, 'auprc': 0.799870620899421, 'loss_val': 0.8693219195307892, 'psi': 0.7378751214791324}-{'f1_val': 0.4163758395072774, 'auprc': 0.7782859944582536, 'loss_val': 0.9914353183578197, 'psi': 0.5611399014876679}
[S16] START round=8 head_norm_before_train=1.322693 (no previous merge yet)
[S16] round=8 local utility u=0.024601 metrics={'f1_val': 0.41715761842766974, 'auprc': 0.7391517608696935, 'loss_val': 0.8091702078918981, 'psi': 0.5459552754044792}-{'f1_val': 0.41727255530994717, 'auprc': 0.7393453757855504, 'loss_val': 0.8596429395544235, 'psi': 0.5461016835001884}
[S17] START round=8 head_norm_before_train=1.190899 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3590612648221344, 'auprc': 0.7567348398448204, 'loss_val': 0.9401848580863391, 'psi': 0.5181306948312088}-{'f1_val': 0.3912518234391188, 'auprc': 0.7537442579650063, 'loss_val': 1.002183803840385, 'psi': 0.5362487972494738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:51913
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:51902
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1797) from S7
[S5] cosine check vs S7: cos=0.6739
[S11] RECEIVED delta(kind=head bytes=1799) from S4
[S11] cosine check vs S4: cos=0.4597
[S15] RECEIVED delta(kind=head bytes=1795) from S6
[S15] cosine check vs S6: cos=-0.1342
[S15] DROPPED delta from S6 (cos=-0.1342 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S13
[S5] cosine check vs S13: cos=0.4845
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.4947
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=0.5537
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9755
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=0.8521
[S2] RECEIVED delta(kind=head bytes=1801) from S9
[S2] cosine check vs S9: cos=0.9166
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.7995
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.5936
[S7] RECEIVED delta(kind=head bytes=1801) from S16
[S7] cosine check vs S16: cos=0.5670
[S17] RECEIVED delta(kind=head bytes=1795) from S2
[S17] cosine check vs S2: cos=0.1329
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4175 head_norm=0.519004
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.385483e-02
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4175 head_norm=0.504584 delta_norm=0.073855
[S5] aggregate: ACCEPT kept=['S7', 'S13', 'S15'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.4163 head_norm=0.878160
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.513303e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4165 head_norm=0.835125 delta_norm=0.451330
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4171 head_norm=1.092860
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.000447e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.4191 head_norm=1.226920 delta_norm=0.300045
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=0.919235
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.041552e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=0.938379 delta_norm=0.104155
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.590824
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.666433e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=0.554318 delta_norm=0.266643
[S11] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.4155 head_norm=0.702293
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.838370e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.4056 head_norm=0.622373 delta_norm=0.183837
[S13] aggregate: ROLLBACK (f1_val pre=0.415 post=0.406 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3591 head_norm=1.218539
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.658740e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3588 head_norm=1.015463 delta_norm=0.365874
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.226920 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.734350 metrics={'f1_val': 0.6301823890907935, 'auprc': 0.7777420845003898, 'loss_val': 0.9337097086565364, 'psi': 0.689206267254632}-{'f1_val': 0.4170625860640346, 'auprc': 0.7400810214312906, 'loss_val': 1.0107077995586857, 'psi': 0.5462699602109371}
[S3] START round=9 head_norm_before_train=1.023213 cos_to_last_merge=0.9065 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=9 local utility u=1.000000 metrics={'f1_val': 0.6225157519961627, 'auprc': 0.9980865431921189, 'loss_val': 0.6595356196843684, 'psi': 0.7727440684745452}-{'f1_val': 0.4009668676591264, 'auprc': 0.8062801166094489, 'loss_val': 0.8654430591443345, 'psi': 0.5630921672392555}
[S4] START round=9 head_norm_before_train=1.068970 cos_to_last_merge=0.9255 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=9 local utility u=0.086445 metrics={'f1_val': 0.6659825386240481, 'auprc': 0.7558512872099061, 'loss_val': 0.6725943870495158, 'psi': 0.7019300380583913}-{'f1_val': 0.6493801567287645, 'auprc': 0.7652119850544437, 'loss_val': 0.7739519150909632, 'psi': 0.6957128880590362}
[S5] START round=9 head_norm_before_train=0.504584 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.039071 metrics={'f1_val': 0.417265626557039, 'auprc': 0.7771259941474158, 'loss_val': 1.0480677319326346, 'psi': 0.5612097735931898}-{'f1_val': 0.41750764008433106, 'auprc': 0.7771401531563764, 'loss_val': 1.1277040424119813, 'psi': 0.5613606453131492}
[S6] START round=9 head_norm_before_train=0.835125 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.678065 metrics={'f1_val': 0.6187137487315231, 'auprc': 0.7861871633117964, 'loss_val': 0.8472667159480037, 'psi': 0.6857031145636324}-{'f1_val': 0.41625250229074906, 'auprc': 0.7635509353538974, 'loss_val': 0.9207209158118312, 'psi': 0.5551718755160084}
[S7] START round=9 head_norm_before_train=0.938379 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.048914 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7952185922768725, 'loss_val': 1.1980249186203218, 'psi': 0.403321530548204}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778767649367809, 'loss_val': 1.2438276324694661, 'psi': 0.3963847996121674}
[S8] START round=9 head_norm_before_train=1.360820 (no previous merge yet)
[S8] round=9 local utility u=0.054976 metrics={'f1_val': 0.710296278797981, 'auprc': 0.9940033214323055, 'loss_val': 0.5534329087646079, 'psi': 0.8237790958517108}-{'f1_val': 0.7145304389123006, 'auprc': 0.9980677395864304, 'loss_val': 0.7009825951235569, 'psi': 0.8279453591819526}
[S9] START round=9 head_norm_before_train=1.412933 (no previous merge yet)
[S9] round=9 local utility u=0.058816 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.999567034651679, 'loss_val': 0.4155584271526462, 'psi': 0.8206456144921771}-{'f1_val': 0.7016148490515617, 'auprc': 0.9997910213312287, 'loss_val': 0.5353627179048622, 'psi': 0.8208853179634286}
[S10] START round=9 head_norm_before_train=1.015431 cos_to_last_merge=0.9346 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=9 local utility u=0.180397 metrics={'f1_val': 0.7003378746167876, 'auprc': 0.9920961734779463, 'loss_val': 0.5237295382120386, 'psi': 0.8170411941612512}-{'f1_val': 0.6991138219049687, 'auprc': 0.9310837189750423, 'loss_val': 0.6941426052702665, 'psi': 0.7919017807329982}
[S11] START round=9 head_norm_before_train=0.554318 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.015436 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9979047095249238, 'loss_val': 0.9716425150091935, 'psi': 0.6370932253656932}-{'f1_val': 0.39655223592620625, 'auprc': 0.9936476458895224, 'loss_val': 0.9897424895989477, 'psi': 0.6353903999115327}
[S13] START round=9 head_norm_before_train=0.622373 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.050069 metrics={'f1_val': 0.4160404975377924, 'auprc': 0.5964036547785431, 'loss_val': 1.1148923322898274, 'psi': 0.4881857604340927}-{'f1_val': 0.415486691627877, 'auprc': 0.5887094639846533, 'loss_val': 1.1886245765421737, 'psi': 0.4847758005705875}
[S14] START round=9 head_norm_before_train=1.399132 (no previous merge yet)
[S14] round=9 local utility u=0.060045 metrics={'f1_val': 0.4004276891952982, 'auprc': 0.8238079720917063, 'loss_val': 0.8289510155294157, 'psi': 0.5697798023538614}-{'f1_val': 0.39649470961585787, 'auprc': 0.8113060579618163, 'loss_val': 0.88793647185739, 'psi': 0.5624192489542412}
[S15] START round=9 head_norm_before_train=1.034064 cos_to_last_merge=0.9259 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=9 local utility u=0.124444 metrics={'f1_val': 0.7019146398733126, 'auprc': 0.7996713597398262, 'loss_val': 0.6520555824694542, 'psi': 0.741017327819918}-{'f1_val': 0.6965447885322733, 'auprc': 0.799870620899421, 'loss_val': 0.8693219195307892, 'psi': 0.7378751214791324}
[S16] START round=9 head_norm_before_train=1.364366 (no previous merge yet)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.3546503886269486, 'auprc': 0.7370745282222915, 'loss_val': 0.8201877505689658, 'psi': 0.5076200444650858}-{'f1_val': 0.41715761842766974, 'auprc': 0.7391517608696935, 'loss_val': 0.8091702078918981, 'psi': 0.5459552754044792}
[S17] START round=9 head_norm_before_train=1.015463 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.068622 metrics={'f1_val': 0.3539154165019336, 'auprc': 0.8188530014258026, 'loss_val': 0.9584207583469913, 'psi': 0.5398904504714812}-{'f1_val': 0.3590612648221344, 'auprc': 0.7567348398448204, 'loss_val': 0.9401848580863391, 'psi': 0.5181306948312088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:51916
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S5
[S11] cosine check vs S5: cos=0.6517
[S6] RECEIVED delta(kind=head bytes=1793) from S10
[S6] cosine check vs S10: cos=0.8604
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9324
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.7587
[S2] RECEIVED delta(kind=head bytes=1797) from S9
[S2] cosine check vs S9: cos=0.9691
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.4946
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=0.6203
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] cosine check vs S6: cos=-0.1268
[S15] DROPPED delta from S6 (cos=-0.1268 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.7780
[S17] RECEIVED delta(kind=head bytes=1797) from S2
[S17] cosine check vs S2: cos=0.3659
[S5] RECEIVED delta(kind=head bytes=1801) from S7
[S5] cosine check vs S7: cos=0.6125
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.7120
[S17] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] cosine check vs S17: cos=-0.1057
[S16] DROPPED delta from S17 (cos=-0.1057 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:51910
[S3] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=-0.0942
[S9] DROPPED delta from S3 (cos=-0.0942 < 0.0)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.3966 head_norm=0.599281
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.705630e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.3966 head_norm=0.612577 delta_norm=0.170563
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=0.949556
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.759507e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=1.125494 delta_norm=0.475951
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.6302 head_norm=1.249885
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.998435e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.6562 head_norm=1.347238 delta_norm=0.199843
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.6187 head_norm=0.875304
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.741730e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6184 head_norm=0.939374 delta_norm=0.274173
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4160 head_norm=0.647293
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.088784e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4163 head_norm=0.587735 delta_norm=0.208878
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4173 head_norm=0.541707
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.562365e-02
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4175 head_norm=0.522257 delta_norm=0.075624
[S5] aggregate: ACCEPT kept=['S15', 'S13', 'S7'] (k=3/3) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3539 head_norm=1.046823
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.385806e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3558 head_norm=0.992615 delta_norm=0.238581
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.347238 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.049680 metrics={'f1_val': 0.6341713100782771, 'auprc': 0.7770663830475246, 'loss_val': 0.8562552754606504, 'psi': 0.6913293392659761}-{'f1_val': 0.6301823890907935, 'auprc': 0.7777420845003898, 'loss_val': 0.9337097086565364, 'psi': 0.689206267254632}
[S3] START round=10 head_norm_before_train=1.085127 cos_to_last_merge=0.8842 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.884
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.45112264381172573, 'auprc': 0.8868603583512344, 'loss_val': 0.7530010262166938, 'psi': 0.6254177296275292}-{'f1_val': 0.6225157519961627, 'auprc': 0.9980865431921189, 'loss_val': 0.6595356196843684, 'psi': 0.7727440684745452}
[S4] START round=10 head_norm_before_train=1.126732 cos_to_last_merge=0.9035 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=10 local utility u=0.258641 metrics={'f1_val': 0.6547706807617475, 'auprc': 0.9179525677144249, 'loss_val': 0.5743450322857081, 'psi': 0.7600434355428185}-{'f1_val': 0.6659825386240481, 'auprc': 0.7558512872099061, 'loss_val': 0.6725943870495158, 'psi': 0.7019300380583913}
[S5] START round=10 head_norm_before_train=0.522257 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.349682 metrics={'f1_val': 0.5644230786349584, 'auprc': 0.6972120061657711, 'loss_val': 0.9919058580716792, 'psi': 0.6175386496472834}-{'f1_val': 0.417265626557039, 'auprc': 0.7771259941474158, 'loss_val': 1.0480677319326346, 'psi': 0.5612097735931898}
[S6] START round=10 head_norm_before_train=0.939374 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.41693470025384477, 'auprc': 0.7737316439995877, 'loss_val': 0.8681033385363758, 'psi': 0.559653477752142}-{'f1_val': 0.6187137487315231, 'auprc': 0.7861871633117964, 'loss_val': 0.8472667159480037, 'psi': 0.6857031145636324}
[S7] START round=10 head_norm_before_train=1.125494 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.035220 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.795021786999715, 'loss_val': 1.1269950713638754, 'psi': 0.403242808437341}-{'f1_val': 0.14205682272909165, 'auprc': 0.7952185922768725, 'loss_val': 1.1980249186203218, 'psi': 0.403321530548204}
[S8] START round=10 head_norm_before_train=1.411925 (no previous merge yet)
[S8] round=10 local utility u=0.083656 metrics={'f1_val': 0.7139807753193125, 'auprc': 0.9950947244005346, 'loss_val': 0.41150211214193727, 'psi': 0.8264263549518014}-{'f1_val': 0.710296278797981, 'auprc': 0.9940033214323055, 'loss_val': 0.5534329087646079, 'psi': 0.8237790958517108}
[S9] START round=10 head_norm_before_train=1.465525 (no previous merge yet)
[S9] round=10 local utility u=0.039165 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9975247139060353, 'loss_val': 0.33065639853632844, 'psi': 0.8197841756869522}-{'f1_val': 0.7013646677191758, 'auprc': 0.999567034651679, 'loss_val': 0.4155584271526462, 'psi': 0.8206456144921771}
[S10] START round=10 head_norm_before_train=1.071928 cos_to_last_merge=0.9173 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=10 local utility u=0.012004 metrics={'f1_val': 0.6881539807460799, 'auprc': 0.9879996656560106, 'loss_val': 0.4143287979979766, 'psi': 0.8080922547100522}-{'f1_val': 0.7003378746167876, 'auprc': 0.9920961734779463, 'loss_val': 0.5237295382120386, 'psi': 0.8170411941612512}
[S11] START round=10 head_norm_before_train=0.612577 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.420537 metrics={'f1_val': 0.530866428031198, 'auprc': 0.9885669026414069, 'loss_val': 0.9084394053194743, 'psi': 0.7139466178752816}-{'f1_val': 0.39655223592620625, 'auprc': 0.9979047095249238, 'loss_val': 0.9716425150091935, 'psi': 0.6370932253656932}
[S13] START round=10 head_norm_before_train=0.587735 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.221445 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.723470837600642, 'loss_val': 1.05180528382119, 'psi': 0.5388726962316751}-{'f1_val': 0.4160404975377924, 'auprc': 0.5964036547785431, 'loss_val': 1.1148923322898274, 'psi': 0.4881857604340927}
[S14] START round=10 head_norm_before_train=1.443910 (no previous merge yet)
[S14] round=10 local utility u=0.693196 metrics={'f1_val': 0.5226122244929365, 'auprc': 0.9828096505719275, 'loss_val': 0.6526722495404694, 'psi': 0.7066911949245329}-{'f1_val': 0.4004276891952982, 'auprc': 0.8238079720917063, 'loss_val': 0.8289510155294157, 'psi': 0.5697798023538614}
[S15] START round=10 head_norm_before_train=1.090145 cos_to_last_merge=0.9088 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=10 local utility u=0.041204 metrics={'f1_val': 0.6994771610491272, 'auprc': 0.7995348154434339, 'loss_val': 0.5546139873137724, 'psi': 0.7395002228068499}-{'f1_val': 0.7019146398733126, 'auprc': 0.7996713597398262, 'loss_val': 0.6520555824694542, 'psi': 0.741017327819918}
[S16] START round=10 head_norm_before_train=1.404211 (no previous merge yet)
[S16] round=10 local utility u=0.064694 metrics={'f1_val': 0.37191151234256525, 'auprc': 0.7374925227586437, 'loss_val': 0.795620757981897, 'psi': 0.5181439165089966}-{'f1_val': 0.3546503886269486, 'auprc': 0.7370745282222915, 'loss_val': 0.8201877505689658, 'psi': 0.5076200444650858}
[S17] START round=10 head_norm_before_train=0.992615 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.033132 metrics={'f1_val': 0.3547632377779135, 'auprc': 0.824606902329293, 'loss_val': 0.9145047275412419, 'psi': 0.5427007035984653}-{'f1_val': 0.3539154165019336, 'auprc': 0.8188530014258026, 'loss_val': 0.9584207583469913, 'psi': 0.5398904504714812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:51905
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:51916
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S13
[S5] cosine check vs S13: cos=0.7075
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.8503
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=0.9574
[S6] RECEIVED delta(kind=head bytes=1790) from S10
[S6] cosine check vs S10: cos=0.9413
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.4914
[S17] RECEIVED delta(kind=head bytes=1796) from S2
[S17] cosine check vs S2: cos=0.5248
[S5] RECEIVED delta(kind=head bytes=1791) from S7
[S5] cosine check vs S7: cos=0.5142
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.2521
[S11] RECEIVED delta(kind=head bytes=1804) from S4
[S11] cosine check vs S4: cos=0.7941
[S11] RECEIVED delta(kind=head bytes=1803) from S5
[S11] cosine check vs S5: cos=0.6613
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.8666
[S2] RECEIVED delta(kind=head bytes=1799) from S9
[S2] cosine check vs S9: cos=0.9820
[S17] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S17
[S16] cosine check vs S17: cos=-0.1057
[S16] DROPPED delta from S17 (cos=-0.1057 < 0.0)
[S3] ⇄ pheromone p=0.388 → S9@127.0.0.1:51910
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.4169 head_norm=0.972344
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.946450e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.4169 head_norm=1.033051 delta_norm=0.194645
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.328 → S15@127.0.0.1:51915
[S8] ⇄ pheromone p=0.328 → S17@127.0.0.1:51917
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.5309 head_norm=0.659098
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.406622e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7018 head_norm=0.673099 delta_norm=0.140662
[S11] aggregate: ACCEPT kept=['S4', 'S5'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.346 → S13@127.0.0.1:51913
[S14] ⇄ pheromone p=0.404 → S7@127.0.0.1:51908
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.1421 head_norm=1.141538
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.805344e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.2986 head_norm=1.050050 delta_norm=0.280534
[S7] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.136 → S5@127.0.0.1:51905
[S10] ⇄ pheromone p=0.367 → S6@127.0.0.1:51907
[S4] ⇄ pheromone p=0.356 → S11@127.0.0.1:51912
[S9] ⇄ pheromone p=0.370 → S2@127.0.0.1:51902
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.6342 head_norm=1.374810
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.548752e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6567 head_norm=1.440623 delta_norm=0.154875
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.320 → S17@127.0.0.1:51917
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.4158 head_norm=0.619533
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.759262e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.4159 head_norm=0.614951 delta_norm=0.175926
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.307 → S5@127.0.0.1:51905
[S15] ⇄ pheromone p=0.373 → S5@127.0.0.1:51905
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.5644 head_norm=0.559425
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.134652e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.5538 head_norm=0.544471 delta_norm=0.113465
[S5] aggregate: ROLLBACK (f1_val pre=0.564 post=0.554 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.280 → S11@127.0.0.1:51912
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3548 head_norm=1.026666
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.799289e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3545 head_norm=1.025993 delta_norm=0.179929
[S17] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.238 → S16@127.0.0.1:51916
[S16] ⇄ pheromone p=0.210 → S7@127.0.0.1:51908
[S2] START round=11 head_norm_before_train=1.440623 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.276746 metrics={'f1_val': 0.7030406260063238, 'auprc': 0.7751971072200421, 'loss_val': 0.7103714332188908, 'psi': 0.7319032184918111}-{'f1_val': 0.6341713100782771, 'auprc': 0.7770663830475246, 'loss_val': 0.8562552754606504, 'psi': 0.6913293392659761}
[S3] START round=11 head_norm_before_train=1.141189 cos_to_last_merge=0.8657 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.866
[S3] round=11 local utility u=1.000000 metrics={'f1_val': 0.6930047378052776, 'auprc': 0.9988083471005973, 'loss_val': 0.4677948108651553, 'psi': 0.8153261815234054}-{'f1_val': 0.45112264381172573, 'auprc': 0.8868603583512344, 'loss_val': 0.7530010262166938, 'psi': 0.6254177296275292}
[S4] START round=11 head_norm_before_train=1.189831 cos_to_last_merge=0.8827 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=11 local utility u=0.105445 metrics={'f1_val': 0.6642566761520609, 'auprc': 0.9441080794938237, 'loss_val': 0.4988373520270341, 'psi': 0.776197237488766}-{'f1_val': 0.6547706807617475, 'auprc': 0.9179525677144249, 'loss_val': 0.5743450322857081, 'psi': 0.7600434355428185}
[S5] START round=11 head_norm_before_train=0.544471 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.615499 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.7773365616339183, 'loss_val': 0.9029064097263725, 'psi': 0.7397508804030493}-{'f1_val': 0.5644230786349584, 'auprc': 0.6972120061657711, 'loss_val': 0.9919058580716792, 'psi': 0.6175386496472834}
[S6] START round=11 head_norm_before_train=1.033051 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.6949365165712451, 'auprc': 0.9529783878853364, 'loss_val': 0.6698162259919805, 'psi': 0.7981532650968817}-{'f1_val': 0.41693470025384477, 'auprc': 0.7737316439995877, 'loss_val': 0.8681033385363758, 'psi': 0.559653477752142}
[S7] START round=11 head_norm_before_train=1.050050 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=1.000000 metrics={'f1_val': 0.714298907211867, 'auprc': 0.794964433172898, 'loss_val': 1.0028834063353596, 'psi': 0.7465651175962793}-{'f1_val': 0.14205682272909165, 'auprc': 0.795021786999715, 'loss_val': 1.1269950713638754, 'psi': 0.403242808437341}
[S8] START round=11 head_norm_before_train=1.460999 (no previous merge yet)
[S8] round=11 local utility u=0.062670 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9963633553649307, 'loss_val': 0.28902056835998724, 'psi': 0.8268391091363283}-{'f1_val': 0.7139807753193125, 'auprc': 0.9950947244005346, 'loss_val': 0.41150211214193727, 'psi': 0.8264263549518014}
[S9] START round=11 head_norm_before_train=1.519426 (no previous merge yet)
[S9] round=11 local utility u=0.025465 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9971072946215057, 'loss_val': 0.278030270729078, 'psi': 0.8195728663126134}-{'f1_val': 0.7012904835408967, 'auprc': 0.9975247139060353, 'loss_val': 0.33065639853632844, 'psi': 0.8197841756869522}
[S10] START round=11 head_norm_before_train=1.124594 cos_to_last_merge=0.9024 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.902
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.7011019754182817, 'auprc': 0.8649878558274123, 'loss_val': 0.38303231739959176, 'psi': 0.766656327581934}-{'f1_val': 0.6881539807460799, 'auprc': 0.9879996656560106, 'loss_val': 0.4143287979979766, 'psi': 0.8080922547100522}
[S11] START round=11 head_norm_before_train=0.673099 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.361089 metrics={'f1_val': 0.6616784938245701, 'auprc': 0.944150567377128, 'loss_val': 0.837883976838745, 'psi': 0.7746673232455933}-{'f1_val': 0.530866428031198, 'auprc': 0.9885669026414069, 'loss_val': 0.9084394053194743, 'psi': 0.7139466178752816}
[S13] START round=11 head_norm_before_train=0.614951 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.37170506565784633, 'auprc': 0.7158079659100511, 'loss_val': 1.0056669475201423, 'psi': 0.5093462257587282}-{'f1_val': 0.41580726865236384, 'auprc': 0.723470837600642, 'loss_val': 1.05180528382119, 'psi': 0.5388726962316751}
[S14] START round=11 head_norm_before_train=1.495219 (no previous merge yet)
[S14] round=11 local utility u=0.608752 metrics={'f1_val': 0.6981978131228207, 'auprc': 0.9936981797409459, 'loss_val': 0.5213478657094264, 'psi': 0.8163979597700708}-{'f1_val': 0.5226122244929365, 'auprc': 0.9828096505719275, 'loss_val': 0.6526722495404694, 'psi': 0.7066911949245329}
[S15] START round=11 head_norm_before_train=1.144937 cos_to_last_merge=0.8929 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=11 local utility u=0.000967 metrics={'f1_val': 0.6930140897276398, 'auprc': 0.7994659760971501, 'loss_val': 0.5136959893502702, 'psi': 0.7355948442754439}-{'f1_val': 0.6994771610491272, 'auprc': 0.7995348154434339, 'loss_val': 0.5546139873137724, 'psi': 0.7395002228068499}
[S16] START round=11 head_norm_before_train=1.437693 (no previous merge yet)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3674116922558057, 'auprc': 0.7391933990851257, 'loss_val': 0.8101156338945038, 'psi': 0.5161243749875337}-{'f1_val': 0.37191151234256525, 'auprc': 0.7374925227586437, 'loss_val': 0.795620757981897, 'psi': 0.5181439165089966}
[S17] START round=11 head_norm_before_train=1.025993 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3589544825554735, 'auprc': 0.7358368112344749, 'loss_val': 0.8820206888172037, 'psi': 0.5097074140270741}-{'f1_val': 0.3547632377779135, 'auprc': 0.824606902329293, 'loss_val': 0.9145047275412419, 'psi': 0.5427007035984653}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:51912
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:51913
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:51905
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.8654
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.5066
[S2] RECEIVED delta(kind=head bytes=1800) from S9
[S2] cosine check vs S9: cos=0.9878
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=-0.1057
[S9] DROPPED delta from S3 (cos=-0.1057 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S7
[S5] cosine check vs S7: cos=0.5620
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=0.9166
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.8141
[S17] RECEIVED delta(kind=head bytes=1805) from S2
[S17] cosine check vs S2: cos=0.6135
[S11] RECEIVED delta(kind=head bytes=1796) from S5
[S11] cosine check vs S5: cos=0.7043
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=-0.1020
[S15] DROPPED delta from S6 (cos=-0.1020 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.8318
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.3717 head_norm=0.648445
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.441498e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.3725 head_norm=0.670173 delta_norm=0.144150
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.7143 head_norm=1.073862
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.092174e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.4246 head_norm=1.266618 delta_norm=0.409217
[S7] aggregate: ROLLBACK (f1_val pre=0.714 post=0.425 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7030 head_norm=1.471339
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.279639e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.6997 head_norm=1.514400 delta_norm=0.127964
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.6617 head_norm=0.720653
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.312898e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7020 head_norm=0.735433 delta_norm=0.131290
[S11] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7147 head_norm=0.585229
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.698537e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7008 head_norm=0.653568 delta_norm=0.269854
[S5] aggregate: ROLLBACK (f1_val pre=0.715 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3590 head_norm=1.060406
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.507278e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3582 head_norm=1.073193 delta_norm=0.150728
[S17] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.514400 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.058432 metrics={'f1_val': 0.6994105502762514, 'auprc': 0.7751084415152947, 'loss_val': 0.5714616008484791, 'psi': 0.7296897067718688}-{'f1_val': 0.7030406260063238, 'auprc': 0.7751971072200421, 'loss_val': 0.7103714332188908, 'psi': 0.7319032184918111}
[S3] START round=12 head_norm_before_train=1.195903 cos_to_last_merge=0.8503 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.850
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6428977324631927, 'auprc': 0.9984213253793077, 'loss_val': 0.48194568921336667, 'psi': 0.7851071696296388}-{'f1_val': 0.6930047378052776, 'auprc': 0.9988083471005973, 'loss_val': 0.4677948108651553, 'psi': 0.8153261815234054}
[S4] START round=12 head_norm_before_train=1.251445 cos_to_last_merge=0.8649 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=12 local utility u=0.004639 metrics={'f1_val': 0.6680205626038077, 'auprc': 0.9245651720819742, 'loss_val': 0.4535130914521391, 'psi': 0.7706384063950743}-{'f1_val': 0.6642566761520609, 'auprc': 0.9441080794938237, 'loss_val': 0.4988373520270341, 'psi': 0.776197237488766}
[S5] START round=12 head_norm_before_train=0.653568 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.7961872666993379, 'loss_val': 0.8881723137433177, 'psi': 0.7388163997858934}-{'f1_val': 0.7146937595824697, 'auprc': 0.7773365616339183, 'loss_val': 0.9029064097263725, 'psi': 0.7397508804030493}
[S6] START round=12 head_norm_before_train=1.063804 cos_to_last_merge=0.9945 (last merge round=10)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6976092620052203, 'auprc': 0.829616554518235, 'loss_val': 0.536656954497739, 'psi': 0.7504121790104262}-{'f1_val': 0.6949365165712451, 'auprc': 0.9529783878853364, 'loss_val': 0.6698162259919805, 'psi': 0.7981532650968817}
[S7] START round=12 head_norm_before_train=1.266618 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.044775 metrics={'f1_val': 0.7005800942997237, 'auprc': 0.79484299432097, 'loss_val': 0.8306570542951787, 'psi': 0.7382852543082222}-{'f1_val': 0.714298907211867, 'auprc': 0.794964433172898, 'loss_val': 1.0028834063353596, 'psi': 0.7465651175962793}
[S8] START round=12 head_norm_before_train=1.506926 (no previous merge yet)
[S8] round=12 local utility u=0.596113 metrics={'f1_val': 0.8983373788495596, 'auprc': 0.9967696990162018, 'loss_val': 0.20510114475440275, 'psi': 0.9377103069162165}-{'f1_val': 0.7138229449839267, 'auprc': 0.9963633553649307, 'loss_val': 0.28902056835998724, 'psi': 0.8268391091363283}
[S9] START round=12 head_norm_before_train=1.566757 (no previous merge yet)
[S9] round=12 local utility u=0.013670 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9976482532635523, 'loss_val': 0.2538135326943071, 'psi': 0.819939357683624}-{'f1_val': 0.7012165807733519, 'auprc': 0.9971072946215057, 'loss_val': 0.278030270729078, 'psi': 0.8195728663126134}
[S10] START round=12 head_norm_before_train=1.174311 cos_to_last_merge=0.8900 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=12 local utility u=0.098857 metrics={'f1_val': 0.6864546933661163, 'auprc': 0.9493571522767374, 'loss_val': 0.3505418824434483, 'psi': 0.7916156769303648}-{'f1_val': 0.7011019754182817, 'auprc': 0.8649878558274123, 'loss_val': 0.38303231739959176, 'psi': 0.766656327581934}
[S11] START round=12 head_norm_before_train=0.735433 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.161248 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9431441702003068, 'loss_val': 0.7543022564002966, 'psi': 0.7984581336476619}-{'f1_val': 0.6616784938245701, 'auprc': 0.944150567377128, 'loss_val': 0.837883976838745, 'psi': 0.7746673232455933}
[S13] START round=12 head_norm_before_train=0.670173 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.297426 metrics={'f1_val': 0.48636339243866794, 'auprc': 0.6742959132636591, 'loss_val': 0.974228378467494, 'psi': 0.5615364007686644}-{'f1_val': 0.37170506565784633, 'auprc': 0.7158079659100511, 'loss_val': 1.0056669475201423, 'psi': 0.5093462257587282}
[S14] START round=12 head_norm_before_train=1.546086 (no previous merge yet)
[S14] round=12 local utility u=0.045184 metrics={'f1_val': 0.6945759146434578, 'auprc': 0.9929531642145061, 'loss_val': 0.40701356146929973, 'psi': 0.8139268144718772}-{'f1_val': 0.6981978131228207, 'auprc': 0.9936981797409459, 'loss_val': 0.5213478657094264, 'psi': 0.8163979597700708}
[S15] START round=12 head_norm_before_train=1.198896 cos_to_last_merge=0.8791 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.879
[S15] round=12 local utility u=0.051724 metrics={'f1_val': 0.6941235346259027, 'auprc': 0.7995960313740758, 'loss_val': 0.417294080661004, 'psi': 0.7363125333251719}-{'f1_val': 0.6930140897276398, 'auprc': 0.7994659760971501, 'loss_val': 0.5136959893502702, 'psi': 0.7355948442754439}
[S16] START round=12 head_norm_before_train=1.471971 (no previous merge yet)
[S16] round=12 local utility u=0.077036 metrics={'f1_val': 0.39473178091141625, 'auprc': 0.7431545871103322, 'loss_val': 0.8318473286585945, 'psi': 0.5341009033909826}-{'f1_val': 0.3674116922558057, 'auprc': 0.7391933990851257, 'loss_val': 0.8101156338945038, 'psi': 0.5161243749875337}
[S17] START round=12 head_norm_before_train=1.073193 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.38170937922590475, 'auprc': 0.6688192452311031, 'loss_val': 0.8349593761379026, 'psi': 0.4965533256279841}-{'f1_val': 0.3589544825554735, 'auprc': 0.7358368112344749, 'loss_val': 0.8820206888172037, 'psi': 0.5097074140270741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S8] → sending delta(kind=head bytes=1810) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:51913
[S13] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1810 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1792) from S11
[S13] cosine check vs S11: cos=0.9499
[S5] RECEIVED delta(kind=head bytes=1797) from S13
[S5] cosine check vs S13: cos=0.5733
[S17] RECEIVED delta(kind=head bytes=1810) from S8
[S17] cosine check vs S8: cos=0.7802
[S11] RECEIVED delta(kind=head bytes=1807) from S4
[S11] cosine check vs S4: cos=0.8586
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:51905
[S15] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1794) from S15
[S5] cosine check vs S15: cos=0.6653
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:51902
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:51908
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:51907
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:51905
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:51917
[S7] RECEIVED delta(kind=head bytes=1800) from S16
[S7] cosine check vs S16: cos=0.1986
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S9
[S2] cosine check vs S9: cos=0.9912
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S10
[S6] cosine check vs S10: cos=0.9374
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=0.9706
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1795) from S7
[S5] cosine check vs S7: cos=0.5991
[S17] RECEIVED delta(kind=head bytes=1801) from S2
[S17] cosine check vs S2: cos=0.6603
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7020 head_norm=0.783850
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.769798e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7025 head_norm=1.012175 delta_norm=0.376980
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.4864 head_norm=0.702381
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.243083e-01
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.6489 head_norm=0.733776 delta_norm=0.124308
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=0.685153
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.418088e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=0.648734 delta_norm=0.141809
[S5] aggregate: ACCEPT kept=['S13', 'S15', 'S7'] (k=3/3) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6976 head_norm=1.107657
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.121017e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.6954 head_norm=1.143118 delta_norm=0.212102
[S6] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.6994 head_norm=1.547742
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.091526e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.6992 head_norm=1.574853 delta_norm=0.109153
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.7006 head_norm=1.292941
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.415993e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.7004 head_norm=1.143849 delta_norm=0.341599
[S7] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3817 head_norm=1.106334
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.339550e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3725 head_norm=1.118785 delta_norm=0.133955
[S17] aggregate: ROLLBACK (f1_val pre=0.382 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.574853 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.089719 metrics={'f1_val': 0.699502111172159, 'auprc': 0.7967246989045013, 'loss_val': 0.45742131101924477, 'psi': 0.7383911462650958}-{'f1_val': 0.6994105502762514, 'auprc': 0.7751084415152947, 'loss_val': 0.5714616008484791, 'psi': 0.7296897067718688}
[S3] START round=13 head_norm_before_train=1.248768 cos_to_last_merge=0.8372 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.837
[S3] round=13 local utility u=0.111084 metrics={'f1_val': 0.6718126095194024, 'auprc': 0.9929409559440313, 'loss_val': 0.41682626238443665, 'psi': 0.8002639480892539}-{'f1_val': 0.6428977324631927, 'auprc': 0.9984213253793077, 'loss_val': 0.48194568921336667, 'psi': 0.7851071696296388}
[S4] START round=13 head_norm_before_train=1.311031 cos_to_last_merge=0.8503 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.850
[S4] round=13 local utility u=0.914364 metrics={'f1_val': 0.9530209937169007, 'auprc': 0.9558533325182711, 'loss_val': 0.42865257748096286, 'psi': 0.9541539292374489}-{'f1_val': 0.6680205626038077, 'auprc': 0.9245651720819742, 'loss_val': 0.4535130914521391, 'psi': 0.7706384063950743}
[S5] START round=13 head_norm_before_train=0.648734 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.360441 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9947264357656719, 'loss_val': 0.7629083497423075, 'psi': 0.818232067412427}-{'f1_val': 0.7005691551769304, 'auprc': 0.7961872666993379, 'loss_val': 0.8881723137433177, 'psi': 0.7388163997858934}
[S6] START round=13 head_norm_before_train=1.143118 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.210880 metrics={'f1_val': 0.6964180561918126, 'auprc': 0.9545281270629223, 'loss_val': 0.4824849107386295, 'psi': 0.7996620845402566}-{'f1_val': 0.6976092620052203, 'auprc': 0.829616554518235, 'loss_val': 0.536656954497739, 'psi': 0.7504121790104262}
[S7] START round=13 head_norm_before_train=1.143849 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.38925983225397986, 'auprc': 0.7843878212237774, 'loss_val': 0.9219214791166839, 'psi': 0.5473110278418989}-{'f1_val': 0.7005800942997237, 'auprc': 0.79484299432097, 'loss_val': 0.8306570542951787, 'psi': 0.7382852543082222}
[S8] START round=13 head_norm_before_train=1.548605 (no previous merge yet)
[S8] round=13 local utility u=0.321445 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9989282407684947, 'loss_val': 0.15850272751226957, 'psi': 0.9975552208960576}-{'f1_val': 0.8983373788495596, 'auprc': 0.9967696990162018, 'loss_val': 0.20510114475440275, 'psi': 0.9377103069162165}
[S9] START round=13 head_norm_before_train=1.608928 (no previous merge yet)
[S9] round=13 local utility u=0.008679 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982168989355341, 'loss_val': 0.2366599620532479, 'psi': 0.8200167080382248}-{'f1_val': 0.7014667606303384, 'auprc': 0.9976482532635523, 'loss_val': 0.2538135326943071, 'psi': 0.819939357683624}
[S10] START round=13 head_norm_before_train=1.215116 cos_to_last_merge=0.8795 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=13 local utility u=0.121566 metrics={'f1_val': 0.6888879679487039, 'auprc': 0.9981602778760102, 'loss_val': 0.268418842632097, 'psi': 0.8125968919196265}-{'f1_val': 0.6864546933661163, 'auprc': 0.9493571522767374, 'loss_val': 0.3505418824434483, 'psi': 0.7916156769303648}
[S11] START round=13 head_norm_before_train=1.012175 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.041334 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9400889730414367, 'loss_val': 0.661018096543228, 'psi': 0.7970909522134535}-{'f1_val': 0.7020007759458987, 'auprc': 0.9431441702003068, 'loss_val': 0.7543022564002966, 'psi': 0.7984581336476619}
[S13] START round=13 head_norm_before_train=0.733776 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.066171 metrics={'f1_val': 0.5401234989345991, 'auprc': 0.6006242318926255, 'loss_val': 0.9434329454198185, 'psi': 0.5643237921178097}-{'f1_val': 0.48636339243866794, 'auprc': 0.6742959132636591, 'loss_val': 0.974228378467494, 'psi': 0.5615364007686644}
[S14] START round=13 head_norm_before_train=1.591299 (no previous merge yet)
[S14] round=13 local utility u=0.968714 metrics={'f1_val': 0.9957138394838165, 'auprc': 0.9973579187866717, 'loss_val': 0.289627565603697, 'psi': 0.9963714712049585}-{'f1_val': 0.6945759146434578, 'auprc': 0.9929531642145061, 'loss_val': 0.40701356146929973, 'psi': 0.8139268144718772}
[S15] START round=13 head_norm_before_train=1.252307 cos_to_last_merge=0.8654 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=13 local utility u=0.160180 metrics={'f1_val': 0.6933528829777282, 'auprc': 0.8867628907414706, 'loss_val': 0.35381081316314084, 'psi': 0.7707168860832252}-{'f1_val': 0.6941235346259027, 'auprc': 0.7995960313740758, 'loss_val': 0.417294080661004, 'psi': 0.7363125333251719}
[S16] START round=13 head_norm_before_train=1.505174 (no previous merge yet)
[S16] round=13 local utility u=0.140664 metrics={'f1_val': 0.4256611796021683, 'auprc': 0.7580618003808598, 'loss_val': 0.7808174533732836, 'psi': 0.5586214279136449}-{'f1_val': 0.39473178091141625, 'auprc': 0.7431545871103322, 'loss_val': 0.8318473286585945, 'psi': 0.5341009033909826}
[S17] START round=13 head_norm_before_train=1.118785 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.239504 metrics={'f1_val': 0.3943991431921192, 'auprc': 0.7809409103642235, 'loss_val': 0.7684552713059393, 'psi': 0.549015850060961}-{'f1_val': 0.38170937922590475, 'auprc': 0.6688192452311031, 'loss_val': 0.8349593761379026, 'psi': 0.4965533256279841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:51917
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:51915
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:51911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:51907
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S11
[S4] cosine check vs S11: cos=0.9605
[S15] RECEIVED delta(kind=head bytes=1793) from S5
[S15] cosine check vs S5: cos=0.6061
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] cosine check vs S16: cos=-0.0905
[S17] DROPPED delta from S16 (cos=-0.0905 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S9
[S3] cosine check vs S9: cos=-0.1114
[S3] DROPPED delta from S9 (cos=-0.1114 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S2
[S9] cosine check vs S2: cos=0.9931
[S11] RECEIVED delta(kind=head bytes=1797) from S13
[S11] cosine check vs S13: cos=0.9101
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=-0.0970
[S6] DROPPED delta from S15 (cos=-0.0970 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S6
[S10] cosine check vs S6: cos=0.9689
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:51909
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=0.7581
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9966 head_norm=1.583116
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.168555e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7166 head_norm=1.282791 delta_norm=0.516856
[S8] aggregate: ROLLBACK (f1_val pre=0.997 post=0.717 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9530 head_norm=1.365503
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.308628e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9526 head_norm=1.195528 delta_norm=0.230863
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6889 head_norm=1.250470
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.554538e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.6889 head_norm=1.206572 delta_norm=0.155454
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6934 head_norm=1.291370
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.157179e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6944 head_norm=0.897159 delta_norm=0.515718
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7018 head_norm=1.049082
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.373199e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7018 head_norm=0.886528 delta_norm=0.237320
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7012 head_norm=1.642983
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.706884e-02
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7012 head_norm=1.624044 delta_norm=0.097069
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.610741 cos_to_last_merge=0.9987 (last merge round=12)
[S2] round=14 local utility u=0.033806 metrics={'f1_val': 0.6996906525731519, 'auprc': 0.7920876551044584, 'loss_val': 0.377030030126764, 'psi': 0.7366494535856745}-{'f1_val': 0.699502111172159, 'auprc': 0.7967246989045013, 'loss_val': 0.45742131101924477, 'psi': 0.7383911462650958}
[S3] START round=14 head_norm_before_train=1.293558 cos_to_last_merge=0.8268 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.827
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.5298208528437, 'auprc': 0.881548704144441, 'loss_val': 0.6409063875347183, 'psi': 0.6705119933639964}-{'f1_val': 0.6718126095194024, 'auprc': 0.9929409559440313, 'loss_val': 0.41682626238443665, 'psi': 0.8002639480892539}
[S4] START round=14 head_norm_before_train=1.195528 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.016656 metrics={'f1_val': 0.9523563818534129, 'auprc': 0.955387837560765, 'loss_val': 0.38995555002250104, 'psi': 0.9535689641363537}-{'f1_val': 0.9530209937169007, 'auprc': 0.9558533325182711, 'loss_val': 0.42865257748096286, 'psi': 0.9541539292374489}
[S5] START round=14 head_norm_before_train=0.688536 cos_to_last_merge=0.9934 (last merge round=12)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8818290260926407, 'loss_val': 0.6496009769652102, 'psi': 0.7730966460346609}-{'f1_val': 0.7005691551769304, 'auprc': 0.9947264357656719, 'loss_val': 0.7629083497423075, 'psi': 0.818232067412427}
[S6] START round=14 head_norm_before_train=1.181647 cos_to_last_merge=0.9969 (last merge round=12)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6956927852354702, 'auprc': 0.9100772488833784, 'loss_val': 0.43171027485351965, 'psi': 0.7814465706946334}-{'f1_val': 0.6964180561918126, 'auprc': 0.9545281270629223, 'loss_val': 0.4824849107386295, 'psi': 0.7996620845402566}
[S7] START round=14 head_norm_before_train=1.171256 cos_to_last_merge=0.9988 (last merge round=12)
[S7] round=14 local utility u=1.000000 metrics={'f1_val': 0.7145263923965461, 'auprc': 0.8392492090538269, 'loss_val': 0.6574852621306707, 'psi': 0.7644155190594585}-{'f1_val': 0.38925983225397986, 'auprc': 0.7843878212237774, 'loss_val': 0.9219214791166839, 'psi': 0.5473110278418989}
[S8] START round=14 head_norm_before_train=1.282791 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9978901266533301, 'loss_val': 0.2553514233277014, 'psi': 0.8276995139000296}-{'f1_val': 0.9966398743144329, 'auprc': 0.9989282407684947, 'loss_val': 0.15850272751226957, 'psi': 0.9975552208960576}
[S9] START round=14 head_norm_before_train=1.624044 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.016669 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982190963396842, 'loss_val': 0.20482924081090972, 'psi': 0.8201676949140767}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982168989355341, 'loss_val': 0.2366599620532479, 'psi': 0.8200167080382248}
[S10] START round=14 head_norm_before_train=1.206572 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.052414 metrics={'f1_val': 0.7004031373789286, 'auprc': 0.9982155054926588, 'loss_val': 0.23284696278944889, 'psi': 0.8195280846244206}-{'f1_val': 0.6888879679487039, 'auprc': 0.9981602778760102, 'loss_val': 0.268418842632097, 'psi': 0.8125968919196265}
[S11] START round=14 head_norm_before_train=0.886528 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.066325 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9417241577254807, 'loss_val': 0.5361742395361043, 'psi': 0.7980351561297507}-{'f1_val': 0.7017589383281313, 'auprc': 0.9400889730414367, 'loss_val': 0.661018096543228, 'psi': 0.7970909522134535}
[S13] START round=14 head_norm_before_train=0.764156 cos_to_last_merge=0.9953 (last merge round=12)
[S13] round=14 local utility u=0.469682 metrics={'f1_val': 0.6413083984374551, 'auprc': 0.6754417446577864, 'loss_val': 0.8356309002874716, 'psi': 0.6549617369255876}-{'f1_val': 0.5401234989345991, 'auprc': 0.6006242318926255, 'loss_val': 0.9434329454198185, 'psi': 0.5643237921178097}
[S14] START round=14 head_norm_before_train=1.633196 (no previous merge yet)
[S14] round=14 local utility u=0.027243 metrics={'f1_val': 0.994244936874629, 'auprc': 0.9983517927073318, 'loss_val': 0.2293093864102719, 'psi': 0.9958876792077102}-{'f1_val': 0.9957138394838165, 'auprc': 0.9973579187866717, 'loss_val': 0.289627565603697, 'psi': 0.9963714712049585}
[S15] START round=14 head_norm_before_train=0.897159 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.691730151185165, 'auprc': 0.7993904251746569, 'loss_val': 0.5185590518163651, 'psi': 0.7347942607809618}-{'f1_val': 0.6933528829777282, 'auprc': 0.8867628907414706, 'loss_val': 0.35381081316314084, 'psi': 0.7707168860832252}
[S16] START round=14 head_norm_before_train=1.536061 (no previous merge yet)
[S16] round=14 local utility u=0.294920 metrics={'f1_val': 0.49994839781517, 'auprc': 0.7784543789151042, 'loss_val': 0.697878884959313, 'psi': 0.6113507902551436}-{'f1_val': 0.4256611796021683, 'auprc': 0.7580618003808598, 'loss_val': 0.7808174533732836, 'psi': 0.5586214279136449}
[S17] START round=14 head_norm_before_train=1.148533 cos_to_last_merge=0.9966 (last merge round=12)
[S17] round=14 local utility u=0.103651 metrics={'f1_val': 0.3849817251577231, 'auprc': 0.8659652957163513, 'loss_val': 0.7597224978730451, 'psi': 0.5773751533811744}-{'f1_val': 0.3943991431921192, 'auprc': 0.7809409103642235, 'loss_val': 0.7684552713059393, 'psi': 0.549015850060961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:51910
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:51912
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:51903
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:51914
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:51909
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S11
[S4] cosine check vs S11: cos=0.9249
[S11] RECEIVED delta(kind=head bytes=1792) from S13
[S11] cosine check vs S13: cos=0.9584
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=0.9945
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=-0.1118
[S3] DROPPED delta from S9 (cos=-0.1118 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] cosine check vs S7: cos=0.8762
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9024
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:51917
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=-0.0900
[S17] DROPPED delta from S16 (cos=-0.0900 < 0.0)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9524 head_norm=1.244795
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.595915e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9502 head_norm=1.071174 delta_norm=0.259592
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7142 head_norm=1.316865
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.837026e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7142 head_norm=1.217252 delta_norm=0.283703
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7022 head_norm=0.938131
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.424444e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7022 head_norm=0.861101 delta_norm=0.142444
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7015 head_norm=1.647809
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.676832e-02
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7015 head_norm=1.645049 delta_norm=0.086768
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9942 head_norm=1.673669
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.250213e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9933 head_norm=1.391978 delta_norm=0.425021
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.646862 cos_to_last_merge=0.9960 (last merge round=12)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.7667017107688374, 'loss_val': 0.3342118842929832, 'psi': 0.727036186064981}-{'f1_val': 0.6996906525731519, 'auprc': 0.7920876551044584, 'loss_val': 0.377030030126764, 'psi': 0.7366494535856745}
[S3] START round=15 head_norm_before_train=1.335495 cos_to_last_merge=0.8183 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.818
[S3] round=15 local utility u=0.805288 metrics={'f1_val': 0.6917218904864768, 'auprc': 0.9931030585593323, 'loss_val': 0.3364004613009431, 'psi': 0.8122743577156191}-{'f1_val': 0.5298208528437, 'auprc': 0.881548704144441, 'loss_val': 0.6409063875347183, 'psi': 0.6705119933639964}
[S4] START round=15 head_norm_before_train=1.071174 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.025019 metrics={'f1_val': 0.9533349201836234, 'auprc': 0.9591917279943725, 'loss_val': 0.3572014500728098, 'psi': 0.955677643307923}-{'f1_val': 0.9523563818534129, 'auprc': 0.955387837560765, 'loss_val': 0.38995555002250104, 'psi': 0.9535689641363537}
[S5] START round=15 head_norm_before_train=0.734534 cos_to_last_merge=0.9789 (last merge round=12)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7033891638173757, 'auprc': 0.8002739536709168, 'loss_val': 0.5918015228566995, 'psi': 0.7421430797587922}-{'f1_val': 0.7006083926626743, 'auprc': 0.8818290260926407, 'loss_val': 0.6496009769652102, 'psi': 0.7730966460346609}
[S6] START round=15 head_norm_before_train=1.224147 cos_to_last_merge=0.9900 (last merge round=12)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.688539705903833, 'auprc': 0.8977950413454496, 'loss_val': 0.40999619682023314, 'psi': 0.7722418400804796}-{'f1_val': 0.6956927852354702, 'auprc': 0.9100772488833784, 'loss_val': 0.43171027485351965, 'psi': 0.7814465706946334}
[S7] START round=15 head_norm_before_train=1.198050 cos_to_last_merge=0.9961 (last merge round=12)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5554298471811985, 'auprc': 0.7897672827887584, 'loss_val': 0.7646232583077847, 'psi': 0.6491648214242225}-{'f1_val': 0.7145263923965461, 'auprc': 0.8392492090538269, 'loss_val': 0.6574852621306707, 'psi': 0.7644155190594585}
[S8] START round=15 head_norm_before_train=1.217252 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.858950 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9983919900196293, 'loss_val': 0.2325445389259874, 'psi': 0.9972590893211275}-{'f1_val': 0.7142391053978291, 'auprc': 0.9978901266533301, 'loss_val': 0.2553514233277014, 'psi': 0.8276995139000296}
[S9] START round=15 head_norm_before_train=1.645049 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982344674304442, 'loss_val': 0.23283842728712387, 'psi': 0.8200237354361888}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982190963396842, 'loss_val': 0.20482924081090972, 'psi': 0.8201676949140767}
[S10] START round=15 head_norm_before_train=1.237519 cos_to_last_merge=0.9997 (last merge round=13)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.6881466509562315, 'auprc': 0.9492063760671168, 'loss_val': 0.25255244245280867, 'psi': 0.7925705410005857}-{'f1_val': 0.7004031373789286, 'auprc': 0.9982155054926588, 'loss_val': 0.23284696278944889, 'psi': 0.8195280846244206}
[S11] START round=15 head_norm_before_train=0.861101 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.034110 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9413099591003695, 'loss_val': 0.46341764488883436, 'psi': 0.7975400713923027}-{'f1_val': 0.702242488399264, 'auprc': 0.9417241577254807, 'loss_val': 0.5361742395361043, 'psi': 0.7980351561297507}
[S13] START round=15 head_norm_before_train=0.802172 cos_to_last_merge=0.9851 (last merge round=12)
[S13] round=15 local utility u=0.137778 metrics={'f1_val': 0.6793237523460514, 'auprc': 0.6797980891003205, 'loss_val': 0.8012359388830083, 'psi': 0.679513487047759}-{'f1_val': 0.6413083984374551, 'auprc': 0.6754417446577864, 'loss_val': 0.8356309002874716, 'psi': 0.6549617369255876}
[S14] START round=15 head_norm_before_train=1.391978 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9940330807218247, 'auprc': 0.9959556718234177, 'loss_val': 0.2784920336193876, 'psi': 0.9948021171624619}-{'f1_val': 0.994244936874629, 'auprc': 0.9983517927073318, 'loss_val': 0.2293093864102719, 'psi': 0.9958876792077102}
[S15] START round=15 head_norm_before_train=0.945806 cos_to_last_merge=0.9977 (last merge round=13)
[S15] round=15 local utility u=0.016785 metrics={'f1_val': 0.6994223183055246, 'auprc': 0.7989366825276208, 'loss_val': 0.529780630327987, 'psi': 0.7392280639943631}-{'f1_val': 0.691730151185165, 'auprc': 0.7993904251746569, 'loss_val': 0.5185590518163651, 'psi': 0.7347942607809618}
[S16] START round=15 head_norm_before_train=1.569542 (no previous merge yet)
[S16] round=15 local utility u=0.318464 metrics={'f1_val': 0.5730834306868956, 'auprc': 0.8263789645563315, 'loss_val': 0.6435347902686114, 'psi': 0.67440164423467}-{'f1_val': 0.49994839781517, 'auprc': 0.7784543789151042, 'loss_val': 0.697878884959313, 'psi': 0.6113507902551436}
[S17] START round=15 head_norm_before_train=1.179088 cos_to_last_merge=0.9889 (last merge round=12)
[S17] round=15 local utility u=0.403095 metrics={'f1_val': 0.49777783231310396, 'auprc': 0.8900389072714696, 'loss_val': 0.7025307725701183, 'psi': 0.6546822622964503}-{'f1_val': 0.3849817251577231, 'auprc': 0.8659652957163513, 'loss_val': 0.7597224978730451, 'psi': 0.5773751533811744}
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S14
[S5]  timeout peer S16
[S5]  timeout peer S17
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:51907
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:51912
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:51904
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:51909
[S6] ⇄ pheromone p=0.216 → S10@127.0.0.1:51911
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] ⇄ pheromone p=0.150 → S9@127.0.0.1:51910
[S15] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S9] ⇄ pheromone p=0.129 → S3@127.0.0.1:51903
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.0013
[S4] RECEIVED delta(kind=head bytes=1794) from S11
[S4] cosine check vs S11: cos=0.9295
[S11] RECEIVED delta(kind=head bytes=1795) from S13
[S11] cosine check vs S13: cos=0.9725
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9609
[S13] ⇄ pheromone p=0.242 → S11@127.0.0.1:51912
[S15] ⇄ pheromone p=0.152 → S6@127.0.0.1:51907
[S7] ⇄ pheromone p=0.291 → S14@127.0.0.1:51914
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:51917
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7017 head_norm=0.916754
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.095339e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7017 head_norm=0.873537 delta_norm=0.109534
[S11] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.182 → S4@127.0.0.1:51904
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] cosine check vs S16: cos=-0.0891
[S17] DROPPED delta from S16 (cos=-0.0891 < 0.0)
[S16] ⇄ pheromone p=0.206 → S17@127.0.0.1:51917
[S17] ⇄ pheromone p=0.206 → S8@127.0.0.1:51909
[S5] CommDone barrier timeout: have=1 need=2 — continuing
[S5] ⇄ pheromone p=0.188 → S15@127.0.0.1:51915
[S2] START round=16 head_norm_before_train=1.680515 cos_to_last_merge=0.9930 (last merge round=12)
[S2] round=16 local utility u=0.043146 metrics={'f1_val': 0.7010244887863394, 'auprc': 0.7952756063584034, 'loss_val': 0.33623442855685926, 'psi': 0.7387249358151651}-{'f1_val': 0.7005925029290768, 'auprc': 0.7667017107688374, 'loss_val': 0.3342118842929832, 'psi': 0.727036186064981}
[S3] START round=16 head_norm_before_train=1.371415 cos_to_last_merge=0.8116 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.812
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.6845098684384399, 'auprc': 0.9908676131077958, 'loss_val': 0.3297572939983815, 'psi': 0.8070529663061823}-{'f1_val': 0.6917218904864768, 'auprc': 0.9931030585593323, 'loss_val': 0.3364004613009431, 'psi': 0.8122743577156191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=1.119959 cos_to_last_merge=0.9989 (last merge round=14)
[S4] round=16 local utility u=0.030289 metrics={'f1_val': 0.9523930585853533, 'auprc': 0.9667672993211325, 'loss_val': 0.3136994263793372, 'psi': 0.958142754879665}-{'f1_val': 0.9533349201836234, 'auprc': 0.9591917279943725, 'loss_val': 0.3572014500728098, 'psi': 0.955677643307923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9524 head_norm=1.172609
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.419858e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9532 head_norm=1.024289 delta_norm=0.241986
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] START round=16 head_norm_before_train=0.782046 cos_to_last_merge=0.9625 (last merge round=12)
[S5] round=16 local utility u=0.331377 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9897459342258587, 'loss_val': 0.4790568504487414, 'psi': 0.8160911641506917}-{'f1_val': 0.7033891638173757, 'auprc': 0.8002739536709168, 'loss_val': 0.5918015228566995, 'psi': 0.7421430797587922}
[S6] START round=16 head_norm_before_train=1.260556 cos_to_last_merge=0.9829 (last merge round=12)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7074444286310667, 'auprc': 0.8275489228243683, 'loss_val': 0.41438268565800374, 'psi': 0.7554862263083874}-{'f1_val': 0.688539705903833, 'auprc': 0.8977950413454496, 'loss_val': 0.40999619682023314, 'psi': 0.7722418400804796}
[S7] START round=16 head_norm_before_train=1.224891 cos_to_last_merge=0.9925 (last merge round=12)
[S7] round=16 local utility u=0.508595 metrics={'f1_val': 0.6786850963287869, 'auprc': 0.8277883405024249, 'loss_val': 0.6010287219936744, 'psi': 0.7383263939982421}-{'f1_val': 0.5554298471811985, 'auprc': 0.7897672827887584, 'loss_val': 0.7646232583077847, 'psi': 0.6491648214242225}
[S8] START round=16 head_norm_before_train=1.246596 cos_to_last_merge=0.9991 (last merge round=14)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9971520590840306, 'loss_val': 0.23059465976223784, 'psi': 0.8274042868723097}-{'f1_val': 0.996503822188793, 'auprc': 0.9983919900196293, 'loss_val': 0.2325445389259874, 'psi': 0.9972590893211275}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.7142 head_norm=1.284915
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.974459e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.7142 head_norm=1.231066 delta_norm=0.197446
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] START round=16 head_norm_before_train=1.664808 cos_to_last_merge=0.9998 (last merge round=14)
[S9] round=16 local utility u=0.031052 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982290439300907, 'loss_val': 0.1707174125004651, 'psi': 0.8200215660360475}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982344674304442, 'loss_val': 0.23283842728712387, 'psi': 0.8200237354361888}
[S10] START round=16 head_norm_before_train=1.267626 cos_to_last_merge=0.9986 (last merge round=13)
[S10] round=16 local utility u=0.022115 metrics={'f1_val': 0.70100473150176, 'auprc': 0.9396620025351361, 'loss_val': 0.25683745905316724, 'psi': 0.7964676399151105}-{'f1_val': 0.6881466509562315, 'auprc': 0.9492063760671168, 'loss_val': 0.25255244245280867, 'psi': 0.7925705410005857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=16 head_norm_before_train=0.873537 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.030243 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9483982100878474, 'loss_val': 0.4256478413369972, 'psi': 0.800520474014131}-{'f1_val': 0.7016934795869249, 'auprc': 0.9413099591003695, 'loss_val': 0.46341764488883436, 'psi': 0.7975400713923027}
[S13] START round=16 head_norm_before_train=0.842432 cos_to_last_merge=0.9728 (last merge round=12)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6186275403077601, 'auprc': 0.6809371795823307, 'loss_val': 0.761671762757662, 'psi': 0.6435513960175884}-{'f1_val': 0.6793237523460514, 'auprc': 0.6797980891003205, 'loss_val': 0.8012359388830083, 'psi': 0.679513487047759}
[S14] START round=16 head_norm_before_train=1.427634 cos_to_last_merge=0.9995 (last merge round=14)
[S14] round=16 local utility u=0.047636 metrics={'f1_val': 0.9976985674416128, 'auprc': 0.9976073582792115, 'loss_val': 0.21016873666188243, 'psi': 0.9976620837766523}-{'f1_val': 0.9940330807218247, 'auprc': 0.9959556718234177, 'loss_val': 0.2784920336193876, 'psi': 0.9948021171624619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=16 head_norm_before_train=1.011038 cos_to_last_merge=0.9926 (last merge round=13)
[S15] round=16 local utility u=0.068675 metrics={'f1_val': 0.6965769354102238, 'auprc': 0.8085988795781818, 'loss_val': 0.4043446853324596, 'psi': 0.741385713077407}-{'f1_val': 0.6994223183055246, 'auprc': 0.7989366825276208, 'loss_val': 0.529780630327987, 'psi': 0.7392280639943631}
[S16] START round=16 head_norm_before_train=1.602937 (no previous merge yet)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.8357512791462984, 'auprc': 0.9394018888588735, 'loss_val': 0.36145181743114874, 'psi': 0.8772115230313284}-{'f1_val': 0.5730834306868956, 'auprc': 0.8263789645563315, 'loss_val': 0.6435347902686114, 'psi': 0.67440164423467}
[S17] START round=16 head_norm_before_train=1.207480 cos_to_last_merge=0.9806 (last merge round=12)
[S17] round=16 local utility u=0.018467 metrics={'f1_val': 0.549355807800376, 'auprc': 0.7869490256929547, 'loss_val': 0.6657941773088577, 'psi': 0.6443930949574075}-{'f1_val': 0.49777783231310396, 'auprc': 0.8900389072714696, 'loss_val': 0.7025307725701183, 'psi': 0.6546822622964503}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.7074 head_norm=1.290976
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.195747e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.7143 head_norm=0.820187 delta_norm=0.819575
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S9]  timeout peer S3
[S6]  timeout peer S10
[S11]  timeout peer S4
[S11]  timeout peer S5
[S5]  timeout peer S7
[S5]  timeout peer S13
[S5]  timeout peer S15
[S7]  timeout peer S14
[S7]  timeout peer S16
[S2]  timeout peer S9
[S16]  timeout peer S17
[S13]  timeout peer S11
[S15]  timeout peer S6
[S17]  timeout peer S2
[S17]  timeout peer S8
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S2] START round=17 head_norm_before_train=1.709959 cos_to_last_merge=0.9903 (last merge round=12)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.6637608599147604, 'loss_val': 0.2985611900779217, 'psi': 0.6860763361030626}-{'f1_val': 0.7010244887863394, 'auprc': 0.7952756063584034, 'loss_val': 0.33623442855685926, 'psi': 0.7387249358151651}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.402928 cos_to_last_merge=0.8060 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.806
[S3] round=17 local utility u=0.026468 metrics={'f1_val': 0.6886507686525366, 'auprc': 0.9919754012727322, 'loss_val': 0.30499027211604685, 'psi': 0.8099806217006149}-{'f1_val': 0.6845098684384399, 'auprc': 0.9908676131077958, 'loss_val': 0.3297572939983815, 'psi': 0.8070529663061823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=17 head_norm_before_train=1.024289 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9429787633634426, 'auprc': 0.9409691647815545, 'loss_val': 0.34421864436194255, 'psi': 0.9421749239306874}-{'f1_val': 0.9523930585853533, 'auprc': 0.9667672993211325, 'loss_val': 0.3136994263793372, 'psi': 0.958142754879665}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=0.830486 cos_to_last_merge=0.9467 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.946837887916063, 'loss_val': 0.4329955083106831, 'psi': 0.7989275142612406}-{'f1_val': 0.7003213174339138, 'auprc': 0.9897459342258587, 'loss_val': 0.4790568504487414, 'psi': 0.8160911641506917}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=17 head_norm_before_train=0.820187 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.848490 metrics={'f1_val': 0.9590622901872582, 'auprc': 0.9452464400391055, 'loss_val': 0.5802024944638833, 'psi': 0.9535359501279971}-{'f1_val': 0.7074444286310667, 'auprc': 0.8275489228243683, 'loss_val': 0.41438268565800374, 'psi': 0.7554862263083874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=17 head_norm_before_train=1.253624 cos_to_last_merge=0.9883 (last merge round=12)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.6049302502828204, 'auprc': 0.7988053957605122, 'loss_val': 0.6429538172848229, 'psi': 0.6824803084738972}-{'f1_val': 0.6786850963287869, 'auprc': 0.8277883405024249, 'loss_val': 0.6010287219936744, 'psi': 0.7383263939982421}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.231066 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.860790 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9980059275230337, 'loss_val': 0.20516367268390212, 'psi': 0.9971046643224892}-{'f1_val': 0.7142391053978291, 'auprc': 0.9971520590840306, 'loss_val': 0.23059465976223784, 'psi': 0.8274042868723097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=17 head_norm_before_train=1.686563 cos_to_last_merge=0.9992 (last merge round=14)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981185151419607, 'loss_val': 0.18820316611036914, 'psi': 0.8199773545207955}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982290439300907, 'loss_val': 0.1707174125004651, 'psi': 0.8200215660360475}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=1.296279 cos_to_last_merge=0.9972 (last merge round=13)
[S10] round=17 local utility u=0.886405 metrics={'f1_val': 0.9804141583930429, 'auprc': 0.9675591201823793, 'loss_val': 0.24417533748108408, 'psi': 0.9752721431087775}-{'f1_val': 0.70100473150176, 'auprc': 0.9396620025351361, 'loss_val': 0.25683745905316724, 'psi': 0.7964676399151105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=17 head_norm_before_train=0.926713 cos_to_last_merge=0.9971 (last merge round=15)
[S11] round=17 local utility u=0.071576 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9793679776270274, 'loss_val': 0.37395390494769454, 'psi': 0.812763278802966}-{'f1_val': 0.7019353166316534, 'auprc': 0.9483982100878474, 'loss_val': 0.4256478413369972, 'psi': 0.800520474014131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=17 head_norm_before_train=0.882367 cos_to_last_merge=0.9622 (last merge round=12)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5791393381002242, 'auprc': 0.6853526727326618, 'loss_val': 0.7364250695526642, 'psi': 0.6216246719531993}-{'f1_val': 0.6186275403077601, 'auprc': 0.6809371795823307, 'loss_val': 0.761671762757662, 'psi': 0.6435513960175884}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.467749 cos_to_last_merge=0.9979 (last merge round=14)
[S14] round=17 local utility u=0.018246 metrics={'f1_val': 0.997213887172758, 'auprc': 0.997559176556333, 'loss_val': 0.17062464113772302, 'psi': 0.997352002926188}-{'f1_val': 0.9976985674416128, 'auprc': 0.9976073582792115, 'loss_val': 0.21016873666188243, 'psi': 0.9976620837766523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=17 head_norm_before_train=1.068417 cos_to_last_merge=0.9873 (last merge round=13)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6929049541770893, 'auprc': 0.8137330298941816, 'loss_val': 0.4075882247088234, 'psi': 0.7412361844639263}-{'f1_val': 0.6965769354102238, 'auprc': 0.8085988795781818, 'loss_val': 0.4043446853324596, 'psi': 0.741385713077407}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=1.632464 (no previous merge yet)
[S16] round=17 local utility u=0.061680 metrics={'f1_val': 0.8642494636880226, 'auprc': 0.9672934278319408, 'loss_val': 0.49275638739319244, 'psi': 0.9054670493455899}-{'f1_val': 0.8357512791462984, 'auprc': 0.9394018888588735, 'loss_val': 0.36145181743114874, 'psi': 0.8772115230313284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=17 head_norm_before_train=1.231005 cos_to_last_merge=0.9748 (last merge round=12)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.37880314767606743, 'auprc': 0.830615226396039, 'loss_val': 0.8322434389248863, 'psi': 0.559527979164056}-{'f1_val': 0.549355807800376, 'auprc': 0.7869490256929547, 'loss_val': 0.6657941773088577, 'psi': 0.6443930949574075}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.733837 cos_to_last_merge=0.9881 (last merge round=12)
[S2] round=18 local utility u=0.029257 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.6804697303034877, 'loss_val': 0.291256187678566, 'psi': 0.6928681397928154}-{'f1_val': 0.7009533202285976, 'auprc': 0.6637608599147604, 'loss_val': 0.2985611900779217, 'psi': 0.6860763361030626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=18 head_norm_before_train=1.434095 cos_to_last_merge=0.8015 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.802
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.6405398626486463, 'auprc': 0.9681982813107506, 'loss_val': 0.38882215558013583, 'psi': 0.7716032301134881}-{'f1_val': 0.6886507686525366, 'auprc': 0.9919754012727322, 'loss_val': 0.30499027211604685, 'psi': 0.8099806217006149}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=18 head_norm_before_train=1.080184 cos_to_last_merge=0.9982 (last merge round=16)
[S4] round=18 local utility u=0.075396 metrics={'f1_val': 0.9495481889700239, 'auprc': 0.9623079136895738, 'loss_val': 0.29686021148011665, 'psi': 0.9546520788578439}-{'f1_val': 0.9429787633634426, 'auprc': 0.9409691647815545, 'loss_val': 0.34421864436194255, 'psi': 0.9421749239306874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=18 head_norm_before_train=0.881762 cos_to_last_merge=0.9311 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.931
[S5] round=18 local utility u=0.094374 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9896478858978754, 'loss_val': 0.3726771860692254, 'psi': 0.8160515134539656}-{'f1_val': 0.700320598491359, 'auprc': 0.946837887916063, 'loss_val': 0.4329955083106831, 'psi': 0.7989275142612406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=18 head_norm_before_train=0.846291 cos_to_last_merge=0.9985 (last merge round=16)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.9359254347587033, 'auprc': 0.9457836399876318, 'loss_val': 0.5081847185771342, 'psi': 0.9398687168502746}-{'f1_val': 0.9590622901872582, 'auprc': 0.9452464400391055, 'loss_val': 0.5802024944638833, 'psi': 0.9535359501279971}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.288243 cos_to_last_merge=0.9830 (last merge round=12)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5240729432420266, 'auprc': 0.7817976018418327, 'loss_val': 0.7903513569681659, 'psi': 0.627162806681949}-{'f1_val': 0.6049302502828204, 'auprc': 0.7988053957605122, 'loss_val': 0.6429538172848229, 'psi': 0.6824803084738972}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=18 head_norm_before_train=1.265855 cos_to_last_merge=0.9987 (last merge round=16)
[S8] round=18 local utility u=0.007141 metrics={'f1_val': 0.9937645507239166, 'auprc': 0.9972431383131471, 'loss_val': 0.1721583251731641, 'psi': 0.9951559857596088}-{'f1_val': 0.996503822188793, 'auprc': 0.9980059275230337, 'loss_val': 0.20516367268390212, 'psi': 0.9971046643224892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=18 head_norm_before_train=1.712600 cos_to_last_merge=0.9982 (last merge round=14)
[S9] round=18 local utility u=0.891832 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.9980965091514871, 'loss_val': 0.12665686869287318, 'psi': 0.9921870159644632}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981185151419607, 'loss_val': 0.18820316611036914, 'psi': 0.8199773545207955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=18 head_norm_before_train=1.315029 cos_to_last_merge=0.9958 (last merge round=13)
[S10] round=18 local utility u=0.000435 metrics={'f1_val': 0.9566344464462085, 'auprc': 0.9962896771696099, 'loss_val': 0.18681914990581827, 'psi': 0.9724965387355691}-{'f1_val': 0.9804141583930429, 'auprc': 0.9675591201823793, 'loss_val': 0.24417533748108408, 'psi': 0.9752721431087775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=18 head_norm_before_train=0.976521 cos_to_last_merge=0.9911 (last merge round=15)
[S11] round=18 local utility u=0.044237 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9963146236197291, 'loss_val': 0.3377708847330915, 'psi': 0.8196870394268837}-{'f1_val': 0.7016934795869249, 'auprc': 0.9793679776270274, 'loss_val': 0.37395390494769454, 'psi': 0.812763278802966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=18 head_norm_before_train=0.920773 cos_to_last_merge=0.9519 (last merge round=12)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5850473690491121, 'auprc': 0.6331090840516566, 'loss_val': 0.735404012120981, 'psi': 0.6042720550501299}-{'f1_val': 0.5791393381002242, 'auprc': 0.6853526727326618, 'loss_val': 0.7364250695526642, 'psi': 0.6216246719531993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=18 head_norm_before_train=1.503907 cos_to_last_merge=0.9959 (last merge round=14)
[S14] round=18 local utility u=0.015004 metrics={'f1_val': 0.9972882870487276, 'auprc': 0.9974877358236329, 'loss_val': 0.14084786870345867, 'psi': 0.9973680665586897}-{'f1_val': 0.997213887172758, 'auprc': 0.997559176556333, 'loss_val': 0.17062464113772302, 'psi': 0.997352002926188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=18 head_norm_before_train=1.125207 cos_to_last_merge=0.9817 (last merge round=13)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6958755159369279, 'auprc': 0.7994920682124216, 'loss_val': 0.4964616726520131, 'psi': 0.7373221368471254}-{'f1_val': 0.6929049541770893, 'auprc': 0.8137330298941816, 'loss_val': 0.4075882247088234, 'psi': 0.7412361844639263}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.662457 (no previous merge yet)
[S16] round=18 local utility u=0.169379 metrics={'f1_val': 0.8911314604545933, 'auprc': 0.9926720437280907, 'loss_val': 0.39142705557144164, 'psi': 0.9317476937639924}-{'f1_val': 0.8642494636880226, 'auprc': 0.9672934278319408, 'loss_val': 0.49275638739319244, 'psi': 0.9054670493455899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=18 head_norm_before_train=1.249422 cos_to_last_merge=0.9710 (last merge round=12)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.36784077705128615, 'auprc': 0.8052130980768613, 'loss_val': 1.0782374108684738, 'psi': 0.5427897054615162}-{'f1_val': 0.37880314767606743, 'auprc': 0.830615226396039, 'loss_val': 0.8322434389248863, 'psi': 0.559527979164056}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.753455 cos_to_last_merge=0.9863 (last merge round=12)
[S2] round=19 local utility u=0.059032 metrics={'f1_val': 0.7011164915861986, 'auprc': 0.7213835769906785, 'loss_val': 0.29583077842133476, 'psi': 0.7092233257479905}-{'f1_val': 0.7011337461190337, 'auprc': 0.6804697303034877, 'loss_val': 0.291256187678566, 'psi': 0.6928681397928154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=20 psi=0.709 u=0.0590 p_local=0.0825 f1=0.701 auprc=0.721 bytes=23366
[S3] START round=19 head_norm_before_train=1.460843 cos_to_last_merge=0.7984 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.798
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.5208577259396223, 'auprc': 0.8498564557554599, 'loss_val': 0.6862064437772956, 'psi': 0.6524572178659573}-{'f1_val': 0.6405398626486463, 'auprc': 0.9681982813107506, 'loss_val': 0.38882215558013583, 'psi': 0.7716032301134881}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.652 u=0.0000 p_local=0.1608 f1=0.521 auprc=0.850 bytes=19753
[S4] START round=19 head_norm_before_train=1.145285 cos_to_last_merge=0.9940 (last merge round=16)
[S4] round=19 local utility u=0.051022 metrics={'f1_val': 0.9556664608278345, 'auprc': 0.9754117186239838, 'loss_val': 0.2708372055439997, 'psi': 0.9635645639462942}-{'f1_val': 0.9495481889700239, 'auprc': 0.9623079136895738, 'loss_val': 0.29686021148011665, 'psi': 0.9546520788578439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=20 psi=0.964 u=0.0510 p_local=0.1280 f1=0.956 auprc=0.975 bytes=32348
[S5] START round=19 head_norm_before_train=0.925616 cos_to_last_merge=0.9180 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.918
[S5] round=19 local utility u=0.024973 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9899803125214441, 'loss_val': 0.3237282237649548, 'psi': 0.8161844841033931}-{'f1_val': 0.700320598491359, 'auprc': 0.9896478858978754, 'loss_val': 0.3726771860692254, 'psi': 0.8160515134539656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S5] r=20 psi=0.816 u=0.0250 p_local=0.1311 f1=0.700 auprc=0.990 bytes=21570
[S6] START round=19 head_norm_before_train=0.885679 cos_to_last_merge=0.9924 (last merge round=16)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.6462365415725383, 'auprc': 0.7970087313576489, 'loss_val': 0.5286638528875649, 'psi': 0.7065454174865826}-{'f1_val': 0.9359254347587033, 'auprc': 0.9457836399876318, 'loss_val': 0.5081847185771342, 'psi': 0.9398687168502746}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=20 psi=0.707 u=0.0000 p_local=0.1972 f1=0.646 auprc=0.797 bytes=16169
[S7] START round=19 head_norm_before_train=1.315293 cos_to_last_merge=0.9777 (last merge round=12)
[S7] round=19 local utility u=1.000000 metrics={'f1_val': 0.6997906003834956, 'auprc': 0.9780856284297488, 'loss_val': 0.35842325745868586, 'psi': 0.8111086116019969}-{'f1_val': 0.5240729432420266, 'auprc': 0.7817976018418327, 'loss_val': 0.7903513569681659, 'psi': 0.627162806681949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S7] r=20 psi=0.811 u=1.0000 p_local=0.3713 f1=0.700 auprc=0.978 bytes=23347
[S8] START round=19 head_norm_before_train=1.309877 cos_to_last_merge=0.9946 (last merge round=16)
[S8] round=19 local utility u=0.025629 metrics={'f1_val': 0.9942907336931865, 'auprc': 0.9983849434113632, 'loss_val': 0.12748290079909816, 'psi': 0.9959284175804572}-{'f1_val': 0.9937645507239166, 'auprc': 0.9972431383131471, 'loss_val': 0.1721583251731641, 'psi': 0.9951559857596088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=20 psi=0.996 u=0.0256 p_local=0.2748 f1=0.994 auprc=0.998 bytes=30582
[S9] START round=19 head_norm_before_train=1.733825 cos_to_last_merge=0.9971 (last merge round=14)
[S9] round=19 local utility u=0.026207 metrics={'f1_val': 0.9924766112057334, 'auprc': 0.9984720314010631, 'loss_val': 0.10074544068948418, 'psi': 0.9948747792838653}-{'f1_val': 0.9882473538397808, 'auprc': 0.9980965091514871, 'loss_val': 0.12665686869287318, 'psi': 0.9921870159644632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=20 psi=0.995 u=0.0262 p_local=0.2038 f1=0.992 auprc=0.998 bytes=23394
[S10] START round=19 head_norm_before_train=1.330787 cos_to_last_merge=0.9945 (last merge round=13)
[S10] round=19 local utility u=0.141347 metrics={'f1_val': 0.993565973606662, 'auprc': 0.9978565762707212, 'loss_val': 0.13041555353340017, 'psi': 0.9952822146722857}-{'f1_val': 0.9566344464462085, 'auprc': 0.9962896771696099, 'loss_val': 0.18681914990581827, 'psi': 0.9724965387355691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=20 psi=0.995 u=0.1413 p_local=0.2073 f1=0.994 auprc=0.998 bytes=26919
[S11] START round=19 head_norm_before_train=1.019087 cos_to_last_merge=0.9848 (last merge round=15)
[S11] round=19 local utility u=0.006080 metrics={'f1_val': 0.7021777122645716, 'auprc': 0.9967300388531988, 'loss_val': 0.32831162734942293, 'psi': 0.8199986429000226}-{'f1_val': 0.7019353166316534, 'auprc': 0.9963146236197291, 'loss_val': 0.3377708847330915, 'psi': 0.8196870394268837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=20 psi=0.820 u=0.0061 p_local=0.0951 f1=0.702 auprc=0.997 bytes=32334
[S13] START round=19 head_norm_before_train=0.957866 cos_to_last_merge=0.9417 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.942
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.577189785216832, 'auprc': 0.5430760072574878, 'loss_val': 0.7563740851210723, 'psi': 0.5635442740330943}-{'f1_val': 0.5850473690491121, 'auprc': 0.6331090840516566, 'loss_val': 0.735404012120981, 'psi': 0.6042720550501299}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.564 u=0.0000 p_local=0.0992 f1=0.577 auprc=0.543 bytes=23342
[S14] START round=19 head_norm_before_train=1.533819 cos_to_last_merge=0.9935 (last merge round=14)
[S14] round=19 local utility u=0.017934 metrics={'f1_val': 0.9976985674416128, 'auprc': 0.9991195117079075, 'loss_val': 0.11233775157962299, 'psi': 0.9982669451481307}-{'f1_val': 0.9972882870487276, 'auprc': 0.9974877358236329, 'loss_val': 0.14084786870345867, 'psi': 0.9973680665586897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S14] r=20 psi=0.998 u=0.0179 p_local=0.1424 f1=0.998 auprc=0.999 bytes=30561
[S15] START round=19 head_norm_before_train=1.172841 cos_to_last_merge=0.9771 (last merge round=13)
[S15] round=19 local utility u=0.160992 metrics={'f1_val': 0.7097823500740936, 'auprc': 0.8309645099074262, 'loss_val': 0.35233561066995567, 'psi': 0.7582552140074267}-{'f1_val': 0.6958755159369279, 'auprc': 0.7994920682124216, 'loss_val': 0.4964616726520131, 'psi': 0.7373221368471254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S15] r=20 psi=0.758 u=0.1610 p_local=0.1013 f1=0.710 auprc=0.831 bytes=26891
[S16] START round=19 head_norm_before_train=1.697023 (no previous merge yet)
[S16] round=19 local utility u=0.208354 metrics={'f1_val': 0.9365529572768301, 'auprc': 0.9924380134764643, 'loss_val': 0.2465453246757046, 'psi': 0.9589069797566837}-{'f1_val': 0.8911314604545933, 'auprc': 0.9926720437280907, 'loss_val': 0.39142705557144164, 'psi': 0.9317476937639924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S16] r=20 psi=0.959 u=0.2084 p_local=0.2633 f1=0.937 auprc=0.992 bytes=28777
[S17] START round=19 head_norm_before_train=1.266393 cos_to_last_merge=0.9679 (last merge round=12)
[S17] round=19 local utility u=0.255217 metrics={'f1_val': 0.38472379964963127, 'auprc': 0.8772456146111329, 'loss_val': 0.8851988325061586, 'psi': 0.581732525634232}-{'f1_val': 0.36784077705128615, 'auprc': 0.8052130980768613, 'loss_val': 1.0782374108684738, 'psi': 0.5427897054615162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S17] r=20 psi=0.582 u=0.2552 p_local=0.1373 f1=0.385 auprc=0.877 bytes=19760
[S2] START round=20 head_norm_before_train=1.768619 cos_to_last_merge=0.9850 (last merge round=12)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7011172105413084, 'auprc': 0.6949148574573305, 'loss_val': 0.303493799546075, 'psi': 0.6986362693077173}-{'f1_val': 0.7011164915861986, 'auprc': 0.7213835769906785, 'loss_val': 0.29583077842133476, 'psi': 0.7092233257479905}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=20 head_norm_before_train=1.485778 cos_to_last_merge=0.7958 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.796
[S3] round=20 local utility u=0.964919 metrics={'f1_val': 0.6927431640931401, 'auprc': 0.9931433498307166, 'loss_val': 0.21754256101900998, 'psi': 0.8129032383881707}-{'f1_val': 0.5208577259396223, 'auprc': 0.8498564557554599, 'loss_val': 0.6862064437772956, 'psi': 0.6524572178659573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=20 head_norm_before_train=1.200467 cos_to_last_merge=0.9895 (last merge round=16)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9414827701083552, 'auprc': 0.9662992177955069, 'loss_val': 0.28538839200184113, 'psi': 0.9514093491832158}-{'f1_val': 0.9556664608278345, 'auprc': 0.9754117186239838, 'loss_val': 0.2708372055439997, 'psi': 0.9635645639462942}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=0.968791 cos_to_last_merge=0.9062 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.906
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9896401552475527, 'loss_val': 0.3242309169146058, 'psi': 0.8160484211938365}-{'f1_val': 0.700320598491359, 'auprc': 0.9899803125214441, 'loss_val': 0.3237282237649548, 'psi': 0.8161844841033931}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=20 head_norm_before_train=0.938721 cos_to_last_merge=0.9811 (last merge round=16)
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.9073522565173842, 'auprc': 0.956031070295549, 'loss_val': 0.37686489059374373, 'psi': 0.9268237820286501}-{'f1_val': 0.6462365415725383, 'auprc': 0.7970087313576489, 'loss_val': 0.5286638528875649, 'psi': 0.7065454174865826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=20 head_norm_before_train=1.336822 cos_to_last_merge=0.9733 (last merge round=12)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.548462050500396, 'auprc': 0.784788373503305, 'loss_val': 0.7400310289332696, 'psi': 0.6429925797015597}-{'f1_val': 0.6997906003834956, 'auprc': 0.9780856284297488, 'loss_val': 0.35842325745868586, 'psi': 0.8111086116019969}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=20 head_norm_before_train=1.361190 cos_to_last_merge=0.9890 (last merge round=16)
[S8] round=20 local utility u=0.015789 metrics={'f1_val': 0.9958331535970073, 'auprc': 0.9980751372012697, 'loss_val': 0.10423020131136693, 'psi': 0.9967299470387122}-{'f1_val': 0.9942907336931865, 'auprc': 0.9983849434113632, 'loss_val': 0.12748290079909816, 'psi': 0.9959284175804572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=20 head_norm_before_train=1.754144 cos_to_last_merge=0.9955 (last merge round=14)
[S9] round=20 local utility u=0.014099 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9984748438596593, 'loss_val': 0.07763809532314868, 'psi': 0.9953841796958534}-{'f1_val': 0.9924766112057334, 'auprc': 0.9984720314010631, 'loss_val': 0.10074544068948418, 'psi': 0.9948747792838653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=20 head_norm_before_train=1.345535 cos_to_last_merge=0.9931 (last merge round=13)
[S10] round=20 local utility u=0.007901 metrics={'f1_val': 0.9950998600409554, 'auprc': 0.997450044255773, 'loss_val': 0.12259635534668191, 'psi': 0.9960399337268824}-{'f1_val': 0.993565973606662, 'auprc': 0.9978565762707212, 'loss_val': 0.13041555353340017, 'psi': 0.9952822146722857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=20 head_norm_before_train=1.058182 cos_to_last_merge=0.9787 (last merge round=15)
[S11] round=20 local utility u=0.020715 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9976234187357957, 'loss_val': 0.28626585729007475, 'psi': 0.8200263368328611}-{'f1_val': 0.7021777122645716, 'auprc': 0.9967300388531988, 'loss_val': 0.32831162734942293, 'psi': 0.8199986429000226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=20 head_norm_before_train=0.993210 cos_to_last_merge=0.9320 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.932
[S13] round=20 local utility u=0.141385 metrics={'f1_val': 0.5674653983575029, 'auprc': 0.6589560535372123, 'loss_val': 0.7628979223342045, 'psi': 0.6040616604293867}-{'f1_val': 0.577189785216832, 'auprc': 0.5430760072574878, 'loss_val': 0.7563740851210723, 'psi': 0.5635442740330943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=20 head_norm_before_train=1.568387 cos_to_last_merge=0.9908 (last merge round=14)
[S14] round=20 local utility u=0.007021 metrics={'f1_val': 0.997673454559638, 'auprc': 0.9974504770198551, 'loss_val': 0.09313816393540612, 'psi': 0.9975842635437249}-{'f1_val': 0.9976985674416128, 'auprc': 0.9991195117079075, 'loss_val': 0.11233775157962299, 'psi': 0.9982669451481307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=20 head_norm_before_train=1.215471 cos_to_last_merge=0.9715 (last merge round=13)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.6984213952418474, 'auprc': 0.8211498195596345, 'loss_val': 0.3938233769773857, 'psi': 0.7475127649689622}-{'f1_val': 0.7097823500740936, 'auprc': 0.8309645099074262, 'loss_val': 0.35233561066995567, 'psi': 0.7582552140074267}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.730297 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8688154910662835, 'auprc': 0.8923519499298962, 'loss_val': 0.5147963355515349, 'psi': 0.8782300746117286}-{'f1_val': 0.9365529572768301, 'auprc': 0.9924380134764643, 'loss_val': 0.2465453246757046, 'psi': 0.9589069797566837}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.284375 cos_to_last_merge=0.9652 (last merge round=12)
[S17] round=20 local utility u=0.464989 metrics={'f1_val': 0.5009592143171071, 'auprc': 0.8895154582900451, 'loss_val': 0.6894427709769738, 'psi': 0.6563817119062823}-{'f1_val': 0.38472379964963127, 'auprc': 0.8772456146111329, 'loss_val': 0.8851988325061586, 'psi': 0.581732525634232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=21 head_norm_before_train=1.781485 cos_to_last_merge=0.9840 (last merge round=12)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.6631583753922516, 'loss_val': 0.31273938485144004, 'psi': 0.6858353422940592}-{'f1_val': 0.7011172105413084, 'auprc': 0.6949148574573305, 'loss_val': 0.303493799546075, 'psi': 0.6986362693077173}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.511464 cos_to_last_merge=0.7937 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.794
[S3] round=21 local utility u=0.041406 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9956904248701471, 'loss_val': 0.1894015472550189, 'psi': 0.8186250075433119}-{'f1_val': 0.6927431640931401, 'auprc': 0.9931433498307166, 'loss_val': 0.21754256101900998, 'psi': 0.8129032383881707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=21 head_norm_before_train=1.239087 cos_to_last_merge=0.9859 (last merge round=16)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9407276403838105, 'auprc': 0.9378961977783079, 'loss_val': 0.287155409980569, 'psi': 0.9395950633416095}-{'f1_val': 0.9414827701083552, 'auprc': 0.9662992177955069, 'loss_val': 0.28538839200184113, 'psi': 0.9514093491832158}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=21 head_norm_before_train=1.008056 cos_to_last_merge=0.8962 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.896
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9776519216235682, 'loss_val': 0.3189313164239682, 'psi': 0.8112531277442427}-{'f1_val': 0.700320598491359, 'auprc': 0.9896401552475527, 'loss_val': 0.3242309169146058, 'psi': 0.8160484211938365}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=0.993585 cos_to_last_merge=0.9690 (last merge round=16)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6509770576549658, 'auprc': 0.809003784170973, 'loss_val': 0.5242391736131174, 'psi': 0.7141877482613687}-{'f1_val': 0.9073522565173842, 'auprc': 0.956031070295549, 'loss_val': 0.37686489059374373, 'psi': 0.9268237820286501}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=21 head_norm_before_train=1.353060 cos_to_last_merge=0.9700 (last merge round=12)
[S7] round=21 local utility u=0.231131 metrics={'f1_val': 0.5999456055164081, 'auprc': 0.796255810275002, 'loss_val': 0.6210736309832773, 'psi': 0.6784696874198457}-{'f1_val': 0.548462050500396, 'auprc': 0.784788373503305, 'loss_val': 0.7400310289332696, 'psi': 0.6429925797015597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=21 head_norm_before_train=1.401966 cos_to_last_merge=0.9841 (last merge round=16)
[S8] round=21 local utility u=0.005802 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9984987430820704, 'loss_val': 0.0889790677772702, 'psi': 0.9964076872220291}-{'f1_val': 0.9958331535970073, 'auprc': 0.9980751372012697, 'loss_val': 0.10423020131136693, 'psi': 0.9967299470387122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=21 head_norm_before_train=1.781873 cos_to_last_merge=0.9928 (last merge round=14)
[S9] round=21 local utility u=0.004987 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9984732559278078, 'loss_val': 0.06262867359745451, 'psi': 0.9948804895586549}-{'f1_val': 0.9933237369199828, 'auprc': 0.9984748438596593, 'loss_val': 0.07763809532314868, 'psi': 0.9953841796958534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=21 head_norm_before_train=1.360286 cos_to_last_merge=0.9916 (last merge round=13)
[S10] round=21 local utility u=0.001549 metrics={'f1_val': 0.99518893327964, 'auprc': 0.9966782232171141, 'loss_val': 0.11771660103591712, 'psi': 0.9957846492546296}-{'f1_val': 0.9950998600409554, 'auprc': 0.997450044255773, 'loss_val': 0.12259635534668191, 'psi': 0.9960399337268824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=21 head_norm_before_train=1.091164 cos_to_last_merge=0.9740 (last merge round=15)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.658174801297525, 'auprc': 0.9981339221924073, 'loss_val': 0.3574149091949167, 'psi': 0.7941584496554779}-{'f1_val': 0.7016282822309048, 'auprc': 0.9976234187357957, 'loss_val': 0.28626585729007475, 'psi': 0.8200263368328611}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.025219 cos_to_last_merge=0.9230 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.923
[S13] round=21 local utility u=0.112883 metrics={'f1_val': 0.5824536954676074, 'auprc': 0.6873903025737431, 'loss_val': 0.7123636323954641, 'psi': 0.6244283383100617}-{'f1_val': 0.5674653983575029, 'auprc': 0.6589560535372123, 'loss_val': 0.7628979223342045, 'psi': 0.6040616604293867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=21 head_norm_before_train=1.603713 cos_to_last_merge=0.9878 (last merge round=14)
[S14] round=21 local utility u=0.005646 metrics={'f1_val': 0.9970198446089119, 'auprc': 0.9971590731680537, 'loss_val': 0.07705103936118533, 'psi': 0.9970755360325686}-{'f1_val': 0.997673454559638, 'auprc': 0.9974504770198551, 'loss_val': 0.09313816393540612, 'psi': 0.9975842635437249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=21 head_norm_before_train=1.259143 cos_to_last_merge=0.9652 (last merge round=13)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6938022021194634, 'auprc': 0.789549866629091, 'loss_val': 0.5284137392010692, 'psi': 0.7321012679233145}-{'f1_val': 0.6984213952418474, 'auprc': 0.8211498195596345, 'loss_val': 0.3938233769773857, 'psi': 0.7475127649689622}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.760901 (no previous merge yet)
[S16] round=21 local utility u=0.279811 metrics={'f1_val': 0.8973910516086964, 'auprc': 0.9821349773895857, 'loss_val': 0.3959768275667692, 'psi': 0.9312886219210521}-{'f1_val': 0.8688154910662835, 'auprc': 0.8923519499298962, 'loss_val': 0.5147963355515349, 'psi': 0.8782300746117286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=21 head_norm_before_train=1.299517 cos_to_last_merge=0.9623 (last merge round=12)
[S17] round=21 local utility u=0.082507 metrics={'f1_val': 0.5548120772448255, 'auprc': 0.8638797740874341, 'loss_val': 0.7706383649008771, 'psi': 0.678439155981869}-{'f1_val': 0.5009592143171071, 'auprc': 0.8895154582900451, 'loss_val': 0.6894427709769738, 'psi': 0.6563817119062823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=22 head_norm_before_train=1.792307 cos_to_last_merge=0.9831 (last merge round=12)
[S2] round=22 local utility u=0.161588 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.7693415849236487, 'loss_val': 0.30811265370909063, 'psi': 0.7283086261066181}-{'f1_val': 0.7009533202285976, 'auprc': 0.6631583753922516, 'loss_val': 0.31273938485144004, 'psi': 0.6858353422940592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=22 head_norm_before_train=1.537348 cos_to_last_merge=0.7924 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=22 local utility u=0.847379 metrics={'f1_val': 0.972044775801435, 'auprc': 0.9956910834707907, 'loss_val': 0.12342660803921975, 'psi': 0.9815032988691773}-{'f1_val': 0.7005813959920884, 'auprc': 0.9956904248701471, 'loss_val': 0.1894015472550189, 'psi': 0.8186250075433119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=22 head_norm_before_train=1.272229 cos_to_last_merge=0.9822 (last merge round=16)
[S4] round=22 local utility u=0.009851 metrics={'f1_val': 0.9409351084532764, 'auprc': 0.9419393254725218, 'loss_val': 0.2808275325490007, 'psi': 0.9413367952609746}-{'f1_val': 0.9407276403838105, 'auprc': 0.9378961977783079, 'loss_val': 0.287155409980569, 'psi': 0.9395950633416095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=22 head_norm_before_train=1.042390 cos_to_last_merge=0.8872 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.887
[S5] round=22 local utility u=0.011282 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9794172614899701, 'loss_val': 0.3016638310299481, 'psi': 0.8119592636908035}-{'f1_val': 0.700320598491359, 'auprc': 0.9776519216235682, 'loss_val': 0.3189313164239682, 'psi': 0.8112531277442427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=22 head_norm_before_train=1.037768 cos_to_last_merge=0.9591 (last merge round=16)
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.9583668669337304, 'auprc': 0.9684708675808333, 'loss_val': 0.2669021582840908, 'psi': 0.9624084671925716}-{'f1_val': 0.6509770576549658, 'auprc': 0.809003784170973, 'loss_val': 0.5242391736131174, 'psi': 0.7141877482613687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=22 head_norm_before_train=1.369872 cos_to_last_merge=0.9669 (last merge round=12)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5287695685218051, 'auprc': 0.782963629075525, 'loss_val': 0.8560203803239731, 'psi': 0.6304471927432931}-{'f1_val': 0.5999456055164081, 'auprc': 0.796255810275002, 'loss_val': 0.6210736309832773, 'psi': 0.6784696874198457}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.438975 cos_to_last_merge=0.9794 (last merge round=16)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9986701489170862, 'loss_val': 0.08237535509487547, 'psi': 0.9956827042005859}-{'f1_val': 0.9950136499820015, 'auprc': 0.9984987430820704, 'loss_val': 0.0889790677772702, 'psi': 0.9964076872220291}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=22 head_norm_before_train=1.809029 cos_to_last_merge=0.9902 (last merge round=14)
[S9] round=22 local utility u=0.002463 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9984704500379183, 'loss_val': 0.055174030298734016, 'psi': 0.9946273721432033}-{'f1_val': 0.9924853119792197, 'auprc': 0.9984732559278078, 'loss_val': 0.06262867359745451, 'psi': 0.9948804895586549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=22 head_norm_before_train=1.377158 cos_to_last_merge=0.9897 (last merge round=13)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9946465997398168, 'auprc': 0.994490631111917, 'loss_val': 0.11393367132683255, 'psi': 0.994584212288657}-{'f1_val': 0.99518893327964, 'auprc': 0.9966782232171141, 'loss_val': 0.11771660103591712, 'psi': 0.9957846492546296}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=22 head_norm_before_train=1.119163 cos_to_last_merge=0.9705 (last merge round=15)
[S11] round=22 local utility u=0.181491 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9973114668389671, 'loss_val': 0.25268722236641855, 'psi': 0.8199015560741296}-{'f1_val': 0.658174801297525, 'auprc': 0.9981339221924073, 'loss_val': 0.3574149091949167, 'psi': 0.7941584496554779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=22 head_norm_before_train=1.055792 cos_to_last_merge=0.9132 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.913
[S13] round=22 local utility u=0.158122 metrics={'f1_val': 0.6263088936297343, 'auprc': 0.671223126148815, 'loss_val': 0.610749659893339, 'psi': 0.6442745866373665}-{'f1_val': 0.5824536954676074, 'auprc': 0.6873903025737431, 'loss_val': 0.7123636323954641, 'psi': 0.6244283383100617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=22 head_norm_before_train=1.638819 cos_to_last_merge=0.9846 (last merge round=14)
[S14] round=22 local utility u=0.007119 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971561154514605, 'loss_val': 0.06266950377373624, 'psi': 0.9970609510751833}-{'f1_val': 0.9970198446089119, 'auprc': 0.9971590731680537, 'loss_val': 0.07705103936118533, 'psi': 0.9970755360325686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=22 head_norm_before_train=1.303963 cos_to_last_merge=0.9592 (last merge round=13)
[S15] round=22 local utility u=0.109512 metrics={'f1_val': 0.6988541957422999, 'auprc': 0.8284196639084735, 'loss_val': 0.456311954736111, 'psi': 0.7506803830087694}-{'f1_val': 0.6938022021194634, 'auprc': 0.789549866629091, 'loss_val': 0.5284137392010692, 'psi': 0.7321012679233145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=22 head_norm_before_train=1.789479 (no previous merge yet)
[S16] round=22 local utility u=0.275807 metrics={'f1_val': 0.943027186723939, 'auprc': 0.9941941227792412, 'loss_val': 0.15435710193552354, 'psi': 0.96349396114606}-{'f1_val': 0.8973910516086964, 'auprc': 0.9821349773895857, 'loss_val': 0.3959768275667692, 'psi': 0.9312886219210521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=22 head_norm_before_train=1.311241 cos_to_last_merge=0.9599 (last merge round=12)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.39310543391934105, 'auprc': 0.7162982542136012, 'loss_val': 1.0826308180801103, 'psi': 0.5223825620370451}-{'f1_val': 0.5548120772448255, 'auprc': 0.8638797740874341, 'loss_val': 0.7706383649008771, 'psi': 0.678439155981869}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.802716 cos_to_last_merge=0.9824 (last merge round=12)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.543779836691318, 'auprc': 0.6213926194533858, 'loss_val': 0.822309470401746, 'psi': 0.5748249497961451}-{'f1_val': 0.7009533202285976, 'auprc': 0.7693415849236487, 'loss_val': 0.30811265370909063, 'psi': 0.7283086261066181}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=23 head_norm_before_train=1.563483 cos_to_last_merge=0.7918 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.792
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9988499673447485, 'loss_val': 0.10881098570798335, 'psi': 0.9761850381775716}-{'f1_val': 0.972044775801435, 'auprc': 0.9956910834707907, 'loss_val': 0.12342660803921975, 'psi': 0.9815032988691773}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.307357 cos_to_last_merge=0.9782 (last merge round=16)
[S4] round=23 local utility u=0.007663 metrics={'f1_val': 0.9407543281995463, 'auprc': 0.9478442724350942, 'loss_val': 0.2821312248091041, 'psi': 0.9435903058937654}-{'f1_val': 0.9409351084532764, 'auprc': 0.9419393254725218, 'loss_val': 0.2808275325490007, 'psi': 0.9413367952609746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=23 head_norm_before_train=1.071457 cos_to_last_merge=0.8810 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.881
[S5] round=23 local utility u=0.035793 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9897209817520728, 'loss_val': 0.2609929935923928, 'psi': 0.8160811831611774}-{'f1_val': 0.700320598491359, 'auprc': 0.9794172614899701, 'loss_val': 0.3016638310299481, 'psi': 0.8119592636908035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S5] sending update (kind=head size=1786 to 1 peers)
[S6] START round=23 head_norm_before_train=1.070793 cos_to_last_merge=0.9516 (last merge round=16)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.4226873209769175, 'auprc': 0.7559899227168702, 'loss_val': 1.2015657816999457, 'psi': 0.5560083616728986}-{'f1_val': 0.9583668669337304, 'auprc': 0.9684708675808333, 'loss_val': 0.2669021582840908, 'psi': 0.9624084671925716}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.384672 cos_to_last_merge=0.9640 (last merge round=12)
[S7] round=23 local utility u=0.798080 metrics={'f1_val': 0.6876284407669003, 'auprc': 0.8432146136190416, 'loss_val': 0.3937668352418986, 'psi': 0.7498629099077568}-{'f1_val': 0.5287695685218051, 'auprc': 0.782963629075525, 'loss_val': 0.8560203803239731, 'psi': 0.6304471927432931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=23 head_norm_before_train=1.472593 cos_to_last_merge=0.9749 (last merge round=16)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9931569338135257, 'auprc': 0.9966548951165015, 'loss_val': 0.08376778803404525, 'psi': 0.994556118334716}-{'f1_val': 0.9936910743895857, 'auprc': 0.9986701489170862, 'loss_val': 0.08237535509487547, 'psi': 0.9956827042005859}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=23 head_norm_before_train=1.834628 cos_to_last_merge=0.9878 (last merge round=14)
[S9] round=23 local utility u=0.004834 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9984682590184693, 'loss_val': 0.0465179076998681, 'psi': 0.9947282951069172}-{'f1_val': 0.9920653202133933, 'auprc': 0.9984704500379183, 'loss_val': 0.055174030298734016, 'psi': 0.9946273721432033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=23 head_norm_before_train=1.396986 cos_to_last_merge=0.9871 (last merge round=13)
[S10] round=23 local utility u=0.016217 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.996890041063164, 'loss_val': 0.09444737972435525, 'psi': 0.9961188825884475}-{'f1_val': 0.9946465997398168, 'auprc': 0.994490631111917, 'loss_val': 0.11393367132683255, 'psi': 0.994584212288657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=23 head_norm_before_train=1.142693 cos_to_last_merge=0.9679 (last merge round=15)
[S11] round=23 local utility u=0.010286 metrics={'f1_val': 0.7021777122645716, 'auprc': 0.9978122419888367, 'loss_val': 0.23691498120979443, 'psi': 0.8204315241542777}-{'f1_val': 0.7016282822309048, 'auprc': 0.9973114668389671, 'loss_val': 0.25268722236641855, 'psi': 0.8199015560741296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=23 head_norm_before_train=1.084087 cos_to_last_merge=0.9047 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.905
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5814355673483634, 'auprc': 0.680726320289226, 'loss_val': 0.7419526335298531, 'psi': 0.6211518685247084}-{'f1_val': 0.6263088936297343, 'auprc': 0.671223126148815, 'loss_val': 0.610749659893339, 'psi': 0.6442745866373665}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.678207 cos_to_last_merge=0.9810 (last merge round=14)
[S14] round=23 local utility u=0.009263 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988117484075264, 'loss_val': 0.053032403930610414, 'psi': 0.9981153701929227}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971561154514605, 'loss_val': 0.06266950377373624, 'psi': 0.9970609510751833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=23 head_norm_before_train=1.345269 cos_to_last_merge=0.9540 (last merge round=13)
[S15] round=23 local utility u=0.387612 metrics={'f1_val': 0.7625003620675392, 'auprc': 0.9070507572100335, 'loss_val': 0.2988581449805087, 'psi': 0.8203205201245369}-{'f1_val': 0.6988541957422999, 'auprc': 0.8284196639084735, 'loss_val': 0.456311954736111, 'psi': 0.7506803830087694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=23 head_norm_before_train=1.815849 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.9424000866491279, 'auprc': 0.9942305610066088, 'loss_val': 0.16605916847748772, 'psi': 0.9631322763921202}-{'f1_val': 0.943027186723939, 'auprc': 0.9941941227792412, 'loss_val': 0.15435710193552354, 'psi': 0.96349396114606}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=23 head_norm_before_train=1.319432 cos_to_last_merge=0.9582 (last merge round=12)
[S17] round=23 local utility u=0.824774 metrics={'f1_val': 0.5627663997052612, 'auprc': 0.8082748665741021, 'loss_val': 0.7269791881104705, 'psi': 0.6609697864527976}-{'f1_val': 0.39310543391934105, 'auprc': 0.7162982542136012, 'loss_val': 1.0826308180801103, 'psi': 0.5223825620370451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=24 head_norm_before_train=1.812366 cos_to_last_merge=0.9816 (last merge round=12)
[S2] round=24 local utility u=0.788617 metrics={'f1_val': 0.7009053880285318, 'auprc': 0.6788260109035004, 'loss_val': 0.3601286437217355, 'psi': 0.6920736371785192}-{'f1_val': 0.543779836691318, 'auprc': 0.6213926194533858, 'loss_val': 0.822309470401746, 'psi': 0.5748249497961451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=24 head_norm_before_train=1.587788 cos_to_last_merge=0.7913 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.791
[S3] round=24 local utility u=0.060061 metrics={'f1_val': 0.9773331375862475, 'auprc': 0.9988676279033923, 'loss_val': 0.08629042511800544, 'psi': 0.9859469337131055}-{'f1_val': 0.9610750853994537, 'auprc': 0.9988499673447485, 'loss_val': 0.10881098570798335, 'psi': 0.9761850381775716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=24 head_norm_before_train=1.339331 cos_to_last_merge=0.9747 (last merge round=16)
[S4] round=24 local utility u=0.041201 metrics={'f1_val': 0.9405082268916615, 'auprc': 0.973998861432549, 'loss_val': 0.2767170867967691, 'psi': 0.9539044807080165}-{'f1_val': 0.9407543281995463, 'auprc': 0.9478442724350942, 'loss_val': 0.2821312248091041, 'psi': 0.9435903058937654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=24 head_norm_before_train=1.097209 cos_to_last_merge=0.8759 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.876
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7003200138525959, 'auprc': 0.9803799783417577, 'loss_val': 0.2820705771054408, 'psi': 0.8123439996482607}-{'f1_val': 0.7003213174339138, 'auprc': 0.9897209817520728, 'loss_val': 0.2609929935923928, 'psi': 0.8160811831611774}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.096920 cos_to_last_merge=0.9458 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9017526703930481, 'auprc': 0.9482668254935666, 'loss_val': 0.3053537475608067, 'psi': 0.9203583324332555}-{'f1_val': 0.4226873209769175, 'auprc': 0.7559899227168702, 'loss_val': 1.2015657816999457, 'psi': 0.5560083616728986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=24 head_norm_before_train=1.395220 cos_to_last_merge=0.9619 (last merge round=12)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5504489795133855, 'auprc': 0.7862628290807931, 'loss_val': 0.7550338888293914, 'psi': 0.6447745193403486}-{'f1_val': 0.6876284407669003, 'auprc': 0.8432146136190416, 'loss_val': 0.3937668352418986, 'psi': 0.7498629099077568}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.506394 cos_to_last_merge=0.9703 (last merge round=16)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9927806433552421, 'auprc': 0.988395991684899, 'loss_val': 0.08467238826999592, 'psi': 0.9910267826871049}-{'f1_val': 0.9931569338135257, 'auprc': 0.9966548951165015, 'loss_val': 0.08376778803404525, 'psi': 0.994556118334716}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.859389 cos_to_last_merge=0.9855 (last merge round=14)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9884223813560973, 'auprc': 0.9984009982697807, 'loss_val': 0.05120100465641883, 'psi': 0.9924138281215706}-{'f1_val': 0.9922349858325491, 'auprc': 0.9984682590184693, 'loss_val': 0.0465179076998681, 'psi': 0.9947282951069172}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.415195 cos_to_last_merge=0.9845 (last merge round=13)
[S10] round=24 local utility u=0.000897 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9958439217598147, 'loss_val': 0.08697964549823611, 'psi': 0.995446974275441}-{'f1_val': 0.9956047769386365, 'auprc': 0.996890041063164, 'loss_val': 0.09444737972435525, 'psi': 0.9961188825884475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=24 head_norm_before_train=1.164701 cos_to_last_merge=0.9658 (last merge round=15)
[S11] round=24 local utility u=0.016479 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9977225954052602, 'loss_val': 0.20184312888832243, 'psi': 0.8202111093156528}-{'f1_val': 0.7021777122645716, 'auprc': 0.9978122419888367, 'loss_val': 0.23691498120979443, 'psi': 0.8204315241542777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=24 head_norm_before_train=1.105394 cos_to_last_merge=0.8986 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.899
[S13] round=24 local utility u=0.109310 metrics={'f1_val': 0.6113362770140482, 'auprc': 0.6701695763586097, 'loss_val': 0.6710663182984064, 'psi': 0.6348695967518728}-{'f1_val': 0.5814355673483634, 'auprc': 0.680726320289226, 'loss_val': 0.7419526335298531, 'psi': 0.6211518685247084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=24 head_norm_before_train=1.717004 cos_to_last_merge=0.9775 (last merge round=14)
[S14] round=24 local utility u=0.003018 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9988082389856934, 'loss_val': 0.044521561630360335, 'psi': 0.9978675096177532}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988117484075264, 'loss_val': 0.053032403930610414, 'psi': 0.9981153701929227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=24 head_norm_before_train=1.375599 cos_to_last_merge=0.9501 (last merge round=13)
[S15] round=24 local utility u=0.288169 metrics={'f1_val': 0.8054548623838248, 'auprc': 0.9863989942798042, 'loss_val': 0.21829154479768562, 'psi': 0.8778325151422166}-{'f1_val': 0.7625003620675392, 'auprc': 0.9070507572100335, 'loss_val': 0.2988581449805087, 'psi': 0.8203205201245369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=24 head_norm_before_train=1.839605 (no previous merge yet)
[S16] round=24 local utility u=0.026065 metrics={'f1_val': 0.9453278318235439, 'auprc': 0.9949401961466254, 'loss_val': 0.13362464343816574, 'psi': 0.9651727775527765}-{'f1_val': 0.9424000866491279, 'auprc': 0.9942305610066088, 'loss_val': 0.16605916847748772, 'psi': 0.9631322763921202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=24 head_norm_before_train=1.325721 cos_to_last_merge=0.9571 (last merge round=12)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.5578032921432983, 'auprc': 0.7835707977494223, 'loss_val': 0.7801345624387592, 'psi': 0.6481102943857479}-{'f1_val': 0.5627663997052612, 'auprc': 0.8082748665741021, 'loss_val': 0.7269791881104705, 'psi': 0.6609697864527976}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.820483 cos_to_last_merge=0.9811 (last merge round=12)
[S2] round=25 local utility u=0.097966 metrics={'f1_val': 0.71274568988922, 'auprc': 0.7937387422305385, 'loss_val': 0.5799757422589663, 'psi': 0.7451429108257475}-{'f1_val': 0.7009053880285318, 'auprc': 0.6788260109035004, 'loss_val': 0.3601286437217355, 'psi': 0.6920736371785192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=25 head_norm_before_train=1.611213 cos_to_last_merge=0.7907 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.791
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.973695146618933, 'auprc': 0.9986832492778562, 'loss_val': 0.10962241971508685, 'psi': 0.9836903876825023}-{'f1_val': 0.9773331375862475, 'auprc': 0.9988676279033923, 'loss_val': 0.08629042511800544, 'psi': 0.9859469337131055}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.365253 cos_to_last_merge=0.9720 (last merge round=16)
[S4] round=25 local utility u=0.010585 metrics={'f1_val': 0.9462348426488715, 'auprc': 0.9661762273454259, 'loss_val': 0.26643804122677267, 'psi': 0.9542113965274932}-{'f1_val': 0.9405082268916615, 'auprc': 0.973998861432549, 'loss_val': 0.2767170867967691, 'psi': 0.9539044807080165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=25 head_norm_before_train=1.118246 cos_to_last_merge=0.8717 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.872
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.6634814506143221, 'auprc': 0.8807000281409365, 'loss_val': 0.41253663058689743, 'psi': 0.7503688816249678}-{'f1_val': 0.7003200138525959, 'auprc': 0.9803799783417577, 'loss_val': 0.2820705771054408, 'psi': 0.8123439996482607}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.115253 cos_to_last_merge=0.9419 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.5993275637678243, 'auprc': 0.7863625156833886, 'loss_val': 0.5842056617728115, 'psi': 0.67414154453405}-{'f1_val': 0.9017526703930481, 'auprc': 0.9482668254935666, 'loss_val': 0.3053537475608067, 'psi': 0.9203583324332555}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.408242 cos_to_last_merge=0.9592 (last merge round=12)
[S7] round=25 local utility u=0.484348 metrics={'f1_val': 0.6556501105962176, 'auprc': 0.8078538250818054, 'loss_val': 0.48231749055910494, 'psi': 0.7165315963904527}-{'f1_val': 0.5504489795133855, 'auprc': 0.7862628290807931, 'loss_val': 0.7550338888293914, 'psi': 0.6447745193403486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=25 head_norm_before_train=1.539720 cos_to_last_merge=0.9665 (last merge round=16)
[S8] round=25 local utility u=0.029510 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9985254218875669, 'loss_val': 0.05517807059884161, 'psi': 0.994992263090995}-{'f1_val': 0.9927806433552421, 'auprc': 0.988395991684899, 'loss_val': 0.08467238826999592, 'psi': 0.9910267826871049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=25 head_norm_before_train=1.882750 cos_to_last_merge=0.9835 (last merge round=14)
[S9] round=25 local utility u=0.022423 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933856166980156, 'loss_val': 0.038276128504204435, 'psi': 0.9951043035467728}-{'f1_val': 0.9884223813560973, 'auprc': 0.9984009982697807, 'loss_val': 0.05120100465641883, 'psi': 0.9924138281215706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=25 head_norm_before_train=1.439688 cos_to_last_merge=0.9812 (last merge round=13)
[S10] round=25 local utility u=0.006289 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9958468998278112, 'loss_val': 0.07943719758051818, 'psi': 0.9959509158841284}-{'f1_val': 0.995182342619192, 'auprc': 0.9958439217598147, 'loss_val': 0.08697964549823611, 'psi': 0.995446974275441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=25 head_norm_before_train=1.188328 cos_to_last_merge=0.9631 (last merge round=15)
[S11] round=25 local utility u=0.760442 metrics={'f1_val': 0.9568770330867039, 'auprc': 0.9964583397093953, 'loss_val': 0.20720874212667478, 'psi': 0.9727095557357804}-{'f1_val': 0.7018701185892477, 'auprc': 0.9977225954052602, 'loss_val': 0.20184312888832243, 'psi': 0.8202111093156528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=25 head_norm_before_train=1.124557 cos_to_last_merge=0.8936 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.894
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.56535200853177, 'auprc': 0.6941722365552812, 'loss_val': 0.8347665563999144, 'psi': 0.6168800997411745}-{'f1_val': 0.6113362770140482, 'auprc': 0.6701695763586097, 'loss_val': 0.6710663182984064, 'psi': 0.6348695967518728}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.753012 cos_to_last_merge=0.9740 (last merge round=14)
[S14] round=25 local utility u=0.000274 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9988086933057072, 'loss_val': 0.040056557876459606, 'psi': 0.997475816288733}-{'f1_val': 0.997240356705793, 'auprc': 0.9988082389856934, 'loss_val': 0.044521561630360335, 'psi': 0.9978675096177532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=25 head_norm_before_train=1.408358 cos_to_last_merge=0.9454 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.6934160484968148, 'auprc': 0.8136409849223619, 'loss_val': 0.4793996413159543, 'psi': 0.7415060230670336}-{'f1_val': 0.8054548623838248, 'auprc': 0.9863989942798042, 'loss_val': 0.21829154479768562, 'psi': 0.8778325151422166}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.861159 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8715267420468567, 'auprc': 0.8887489692584823, 'loss_val': 0.5655004066768625, 'psi': 0.8784156329315069}-{'f1_val': 0.9453278318235439, 'auprc': 0.9949401961466254, 'loss_val': 0.13362464343816574, 'psi': 0.9651727775527765}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.331286 cos_to_last_merge=0.9558 (last merge round=12)
[S17] round=25 local utility u=0.037229 metrics={'f1_val': 0.5575610739048914, 'auprc': 0.7962449824966766, 'loss_val': 0.7422449564142508, 'psi': 0.6530346373416055}-{'f1_val': 0.5578032921432983, 'auprc': 0.7835707977494223, 'loss_val': 0.7801345624387592, 'psi': 0.6481102943857479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=26 head_norm_before_train=1.827657 cos_to_last_merge=0.9806 (last merge round=12)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.578190986789218, 'auprc': 0.6319168233911681, 'loss_val': 0.6105767169407806, 'psi': 0.599681321429998}-{'f1_val': 0.71274568988922, 'auprc': 0.7937387422305385, 'loss_val': 0.5799757422589663, 'psi': 0.7451429108257475}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.632804 cos_to_last_merge=0.7899 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.790
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9529716733479441, 'auprc': 0.9988642103791128, 'loss_val': 0.1454870274355638, 'psi': 0.9713286881604116}-{'f1_val': 0.973695146618933, 'auprc': 0.9986832492778562, 'loss_val': 0.10962241971508685, 'psi': 0.9836903876825023}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.385522 cos_to_last_merge=0.9703 (last merge round=16)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9424498344640115, 'auprc': 0.969258476999593, 'loss_val': 0.2759773338287496, 'psi': 0.953173291478244}-{'f1_val': 0.9462348426488715, 'auprc': 0.9661762273454259, 'loss_val': 0.26643804122677267, 'psi': 0.9542113965274932}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.137699 cos_to_last_merge=0.8686 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=26 local utility u=0.375819 metrics={'f1_val': 0.7004938661094564, 'auprc': 0.9897796380041497, 'loss_val': 0.21021275057469155, 'psi': 0.8162081748673338}-{'f1_val': 0.6634814506143221, 'auprc': 0.8807000281409365, 'loss_val': 0.41253663058689743, 'psi': 0.7503688816249678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=26 head_norm_before_train=1.133700 cos_to_last_merge=0.9377 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=26 local utility u=0.690883 metrics={'f1_val': 0.7571909601745027, 'auprc': 0.8882893830836776, 'loss_val': 0.4554011864096188, 'psi': 0.8096303293381726}-{'f1_val': 0.5993275637678243, 'auprc': 0.7863625156833886, 'loss_val': 0.5842056617728115, 'psi': 0.67414154453405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=26 head_norm_before_train=1.421988 cos_to_last_merge=0.9567 (last merge round=12)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5772510964370172, 'auprc': 0.7902334199555752, 'loss_val': 0.7075780507759188, 'psi': 0.6624440258444404}-{'f1_val': 0.6556501105962176, 'auprc': 0.8078538250818054, 'loss_val': 0.48231749055910494, 'psi': 0.7165315963904527}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.569790 cos_to_last_merge=0.9633 (last merge round=16)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.972758216132941, 'auprc': 0.9988047161014921, 'loss_val': 0.09306155202123514, 'psi': 0.9831768161203616}-{'f1_val': 0.9926368238932805, 'auprc': 0.9985254218875669, 'loss_val': 0.05517807059884161, 'psi': 0.994992263090995}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.904583 cos_to_last_merge=0.9816 (last merge round=14)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9909631199453779, 'auprc': 0.9984755463583155, 'loss_val': 0.03956933115959079, 'psi': 0.9939680905105529}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933856166980156, 'loss_val': 0.038276128504204435, 'psi': 0.9951043035467728}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.464052 cos_to_last_merge=0.9777 (last merge round=13)
[S10] round=26 local utility u=0.001195 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.995507594321488, 'loss_val': 0.0735659860270185, 'psi': 0.9955688298376071}-{'f1_val': 0.9960202599216732, 'auprc': 0.9958468998278112, 'loss_val': 0.07943719758051818, 'psi': 0.9959509158841284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=26 head_norm_before_train=1.214143 cos_to_last_merge=0.9597 (last merge round=15)
[S11] round=26 local utility u=0.036115 metrics={'f1_val': 0.9593691199673073, 'auprc': 0.9975920889065759, 'loss_val': 0.1533334187943846, 'psi': 0.9746583075430147}-{'f1_val': 0.9568770330867039, 'auprc': 0.9964583397093953, 'loss_val': 0.20720874212667478, 'psi': 0.9727095557357804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=26 head_norm_before_train=1.139951 cos_to_last_merge=0.8892 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.889
[S13] round=26 local utility u=0.066201 metrics={'f1_val': 0.5837988127942482, 'auprc': 0.6773245920420747, 'loss_val': 0.762502872350395, 'psi': 0.6212091244933788}-{'f1_val': 0.56535200853177, 'auprc': 0.6941722365552812, 'loss_val': 0.8347665563999144, 'psi': 0.6168800997411745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=26 head_norm_before_train=1.783428 cos_to_last_merge=0.9705 (last merge round=14)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9970658889668977, 'loss_val': 0.04030297901866017, 'psi': 0.9971255313854142}-{'f1_val': 0.9965872316107504, 'auprc': 0.9988086933057072, 'loss_val': 0.040056557876459606, 'psi': 0.997475816288733}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.443982 cos_to_last_merge=0.9399 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=26 local utility u=1.000000 metrics={'f1_val': 0.9570220490547129, 'auprc': 0.9888445801239106, 'loss_val': 0.11303065753074425, 'psi': 0.969751061482392}-{'f1_val': 0.6934160484968148, 'auprc': 0.8136409849223619, 'loss_val': 0.4793996413159543, 'psi': 0.7415060230670336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=26 head_norm_before_train=1.877666 (no previous merge yet)
[S16] round=26 local utility u=0.771178 metrics={'f1_val': 0.9915600175272905, 'auprc': 0.9938098900980038, 'loss_val': 0.058526782875772385, 'psi': 0.9924599665555758}-{'f1_val': 0.8715267420468567, 'auprc': 0.8887489692584823, 'loss_val': 0.5655004066768625, 'psi': 0.8784156329315069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=26 head_norm_before_train=1.335100 cos_to_last_merge=0.9548 (last merge round=12)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.37736696603939845, 'auprc': 0.7064012575395577, 'loss_val': 1.224686570828736, 'psi': 0.5089806826394622}-{'f1_val': 0.5575610739048914, 'auprc': 0.7962449824966766, 'loss_val': 0.7422449564142508, 'psi': 0.6530346373416055}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=27 head_norm_before_train=1.833441 cos_to_last_merge=0.9803 (last merge round=12)
[S2] round=27 local utility u=0.734401 metrics={'f1_val': 0.7049034213927237, 'auprc': 0.7825909372224245, 'loss_val': 0.3540717063178802, 'psi': 0.735978427724604}-{'f1_val': 0.578190986789218, 'auprc': 0.6319168233911681, 'loss_val': 0.6105767169407806, 'psi': 0.599681321429998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=27 head_norm_before_train=1.653756 cos_to_last_merge=0.7889 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.789
[S3] round=27 local utility u=0.032788 metrics={'f1_val': 0.9600026415847062, 'auprc': 0.9990156095685716, 'loss_val': 0.12255028388429538, 'psi': 0.9756078287782524}-{'f1_val': 0.9529716733479441, 'auprc': 0.9988642103791128, 'loss_val': 0.1454870274355638, 'psi': 0.9713286881604116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=27 head_norm_before_train=1.398432 cos_to_last_merge=0.9684 (last merge round=16)
[S4] round=27 local utility u=0.022820 metrics={'f1_val': 0.9438229224377471, 'auprc': 0.979804649736529, 'loss_val': 0.27021405104124635, 'psi': 0.9582156133572599}-{'f1_val': 0.9424498344640115, 'auprc': 0.969258476999593, 'loss_val': 0.2759773338287496, 'psi': 0.953173291478244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=27 head_norm_before_train=1.153872 cos_to_last_merge=0.8662 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.866
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.6772214887895774, 'auprc': 0.8837037671994294, 'loss_val': 0.4000810337898883, 'psi': 0.7598144001535183}-{'f1_val': 0.7004938661094564, 'auprc': 0.9897796380041497, 'loss_val': 0.21021275057469155, 'psi': 0.8162081748673338}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.154074 cos_to_last_merge=0.9334 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.7966592767164014, 'auprc': 0.8003773989079788, 'loss_val': 0.4535516004759627, 'psi': 0.7981465255930322}-{'f1_val': 0.7571909601745027, 'auprc': 0.8882893830836776, 'loss_val': 0.4554011864096188, 'psi': 0.8096303293381726}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.434535 cos_to_last_merge=0.9546 (last merge round=12)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.5468233653931518, 'auprc': 0.790054835301111, 'loss_val': 0.811582773242542, 'psi': 0.6441159533563354}-{'f1_val': 0.5772510964370172, 'auprc': 0.7902334199555752, 'loss_val': 0.7075780507759188, 'psi': 0.6624440258444404}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=27 head_norm_before_train=1.595157 cos_to_last_merge=0.9607 (last merge round=16)
[S8] round=27 local utility u=0.061323 metrics={'f1_val': 0.9927891582002274, 'auprc': 0.9885608976550941, 'loss_val': 0.059869858874707804, 'psi': 0.9910978539821741}-{'f1_val': 0.972758216132941, 'auprc': 0.9988047161014921, 'loss_val': 0.09306155202123514, 'psi': 0.9831768161203616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=27 head_norm_before_train=1.922846 cos_to_last_merge=0.9796 (last merge round=14)
[S9] round=27 local utility u=0.013180 metrics={'f1_val': 0.993909773892786, 'auprc': 0.998473012587684, 'loss_val': 0.03088243589873498, 'psi': 0.9957350693707452}-{'f1_val': 0.9909631199453779, 'auprc': 0.9984755463583155, 'loss_val': 0.03956933115959079, 'psi': 0.9939680905105529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=27 head_norm_before_train=1.491773 cos_to_last_merge=0.9740 (last merge round=13)
[S10] round=27 local utility u=0.001312 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948011241976781, 'loss_val': 0.06629105825846503, 'psi': 0.9950331530906961}-{'f1_val': 0.9956096535150197, 'auprc': 0.995507594321488, 'loss_val': 0.0735659860270185, 'psi': 0.9955688298376071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=27 head_norm_before_train=1.242518 cos_to_last_merge=0.9553 (last merge round=15)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9574810798704112, 'auprc': 0.9976260396629246, 'loss_val': 0.15237456820413176, 'psi': 0.9735390637874166}-{'f1_val': 0.9593691199673073, 'auprc': 0.9975920889065759, 'loss_val': 0.1533334187943846, 'psi': 0.9746583075430147}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.158443 cos_to_last_merge=0.8847 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.885
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5583321877826521, 'auprc': 0.6924051480677217, 'loss_val': 0.904983600877856, 'psi': 0.6119613718966799}-{'f1_val': 0.5837988127942482, 'auprc': 0.6773245920420747, 'loss_val': 0.762502872350395, 'psi': 0.6212091244933788}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.807343 cos_to_last_merge=0.9679 (last merge round=14)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.996333081002392, 'auprc': 0.9970994943652882, 'loss_val': 0.04511150976393083, 'psi': 0.9966396463475505}-{'f1_val': 0.9971652929977585, 'auprc': 0.9970658889668977, 'loss_val': 0.04030297901866017, 'psi': 0.9971255313854142}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=27 head_norm_before_train=1.473322 cos_to_last_merge=0.9352 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6981464523479252, 'auprc': 0.8305440643122413, 'loss_val': 0.5078612102120078, 'psi': 0.7511054971336517}-{'f1_val': 0.9570220490547129, 'auprc': 0.9888445801239106, 'loss_val': 0.11303065753074425, 'psi': 0.969751061482392}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.889940 (no previous merge yet)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8840757213914726, 'auprc': 0.9532579374367478, 'loss_val': 0.5056733753834031, 'psi': 0.9117486078095827}-{'f1_val': 0.9915600175272905, 'auprc': 0.9938098900980038, 'loss_val': 0.058526782875772385, 'psi': 0.9924599665555758}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.341616 cos_to_last_merge=0.9537 (last merge round=12)
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.6174017995740667, 'auprc': 0.817714169439061, 'loss_val': 0.5819925986318425, 'psi': 0.6975267475200644}-{'f1_val': 0.37736696603939845, 'auprc': 0.7064012575395577, 'loss_val': 1.224686570828736, 'psi': 0.5089806826394622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=28 head_norm_before_train=1.839903 cos_to_last_merge=0.9798 (last merge round=12)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.5900782215365166, 'auprc': 0.6469193522234519, 'loss_val': 0.48342774565596225, 'psi': 0.6128146738112907}-{'f1_val': 0.7049034213927237, 'auprc': 0.7825909372224245, 'loss_val': 0.3540717063178802, 'psi': 0.735978427724604}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=1.676227 cos_to_last_merge=0.7876 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.788
[S3] round=28 local utility u=0.109736 metrics={'f1_val': 0.9851925397185548, 'auprc': 0.999231818625483, 'loss_val': 0.05486604597511007, 'psi': 0.9908082512813261}-{'f1_val': 0.9600026415847062, 'auprc': 0.9990156095685716, 'loss_val': 0.12255028388429538, 'psi': 0.9756078287782524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=28 head_norm_before_train=1.410086 cos_to_last_merge=0.9666 (last merge round=16)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9395671769682669, 'auprc': 0.9594031666154579, 'loss_val': 0.2933199247320655, 'psi': 0.9475015728271432}-{'f1_val': 0.9438229224377471, 'auprc': 0.979804649736529, 'loss_val': 0.27021405104124635, 'psi': 0.9582156133572599}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.166265 cos_to_last_merge=0.8648 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=28 local utility u=0.234782 metrics={'f1_val': 0.7030017902890621, 'auprc': 0.949567816664794, 'loss_val': 0.2827919051105828, 'psi': 0.8016282008393548}-{'f1_val': 0.6772214887895774, 'auprc': 0.8837037671994294, 'loss_val': 0.4000810337898883, 'psi': 0.7598144001535183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=28 head_norm_before_train=1.181040 cos_to_last_merge=0.9281 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=28 local utility u=0.316093 metrics={'f1_val': 0.8078634480548263, 'auprc': 0.952269373044341, 'loss_val': 0.34426623994226196, 'psi': 0.8656258180506322}-{'f1_val': 0.7966592767164014, 'auprc': 0.8003773989079788, 'loss_val': 0.4535516004759627, 'psi': 0.7981465255930322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=28 head_norm_before_train=1.448702 cos_to_last_merge=0.9528 (last merge round=12)
[S7] round=28 local utility u=0.589087 metrics={'f1_val': 0.6700974434341037, 'auprc': 0.8178445001648855, 'loss_val': 0.45642253060632076, 'psi': 0.7291962661264164}-{'f1_val': 0.5468233653931518, 'auprc': 0.790054835301111, 'loss_val': 0.811582773242542, 'psi': 0.6441159533563354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=28 head_norm_before_train=1.614403 cos_to_last_merge=0.9589 (last merge round=16)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9847208361862778, 'auprc': 0.9986709728244775, 'loss_val': 0.05992663176442404, 'psi': 0.9903008908415577}-{'f1_val': 0.9927891582002274, 'auprc': 0.9885608976550941, 'loss_val': 0.059869858874707804, 'psi': 0.9910978539821741}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.938535 cos_to_last_merge=0.9781 (last merge round=14)
[S9] round=28 local utility u=0.005609 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984719491628296, 'loss_val': 0.0271951722008667, 'psi': 0.9964880834991009}-{'f1_val': 0.993909773892786, 'auprc': 0.998473012587684, 'loss_val': 0.03088243589873498, 'psi': 0.9957350693707452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=28 head_norm_before_train=1.520758 cos_to_last_merge=0.9701 (last merge round=13)
[S10] round=28 local utility u=0.004527 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955542462491814, 'loss_val': 0.05949691153539008, 'psi': 0.9953344019112974}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948011241976781, 'loss_val': 0.06629105825846503, 'psi': 0.9950331530906961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=28 head_norm_before_train=1.272096 cos_to_last_merge=0.9506 (last merge round=15)
[S11] round=28 local utility u=0.132909 metrics={'f1_val': 0.9963709580040319, 'auprc': 0.9956099747061764, 'loss_val': 0.11384826163753299, 'psi': 0.9960665646848896}-{'f1_val': 0.9574810798704112, 'auprc': 0.9976260396629246, 'loss_val': 0.15237456820413176, 'psi': 0.9735390637874166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=28 head_norm_before_train=1.179929 cos_to_last_merge=0.8789 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=28 local utility u=0.246344 metrics={'f1_val': 0.614131403946611, 'auprc': 0.6707295058502312, 'loss_val': 0.6820644956785915, 'psi': 0.6367706447080591}-{'f1_val': 0.5583321877826521, 'auprc': 0.6924051480677217, 'loss_val': 0.904983600877856, 'psi': 0.6119613718966799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=28 head_norm_before_train=1.828815 cos_to_last_merge=0.9657 (last merge round=14)
[S14] round=28 local utility u=0.011788 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9991607331580142, 'loss_val': 0.03184247497404294, 'psi': 0.9978764669369311}-{'f1_val': 0.996333081002392, 'auprc': 0.9970994943652882, 'loss_val': 0.04511150976393083, 'psi': 0.9966396463475505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=28 head_norm_before_train=1.495613 cos_to_last_merge=0.9321 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=28 local utility u=0.015124 metrics={'f1_val': 0.6982283000100235, 'auprc': 0.8308439507241665, 'loss_val': 0.47900357470196436, 'psi': 0.7512745602956807}-{'f1_val': 0.6981464523479252, 'auprc': 0.8305440643122413, 'loss_val': 0.5078612102120078, 'psi': 0.7511054971336517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=28 head_norm_before_train=1.902879 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8445486032551122, 'auprc': 0.8792505260161705, 'loss_val': 0.8904555924374874, 'psi': 0.8584293723595355}-{'f1_val': 0.8840757213914726, 'auprc': 0.9532579374367478, 'loss_val': 0.5056733753834031, 'psi': 0.9117486078095827}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.347249 cos_to_last_merge=0.9541 (last merge round=12)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.3895003781084974, 'auprc': 0.7132851724475021, 'loss_val': 1.1230121223611786, 'psi': 0.5190142958440993}-{'f1_val': 0.6174017995740667, 'auprc': 0.817714169439061, 'loss_val': 0.5819925986318425, 'psi': 0.6975267475200644}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.846482 cos_to_last_merge=0.9794 (last merge round=12)
[S2] round=29 local utility u=0.163458 metrics={'f1_val': 0.6563788487379696, 'auprc': 0.7799684118559942, 'loss_val': 0.9534626266339731, 'psi': 0.7058146739851794}-{'f1_val': 0.5900782215365166, 'auprc': 0.6469193522234519, 'loss_val': 0.48342774565596225, 'psi': 0.6128146738112907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=29 head_norm_before_train=1.698323 cos_to_last_merge=0.7863 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.786
[S3] round=29 local utility u=0.045354 metrics={'f1_val': 0.9973956967430226, 'auprc': 0.9992319723941995, 'loss_val': 0.037377470965487485, 'psi': 0.9981302070034933}-{'f1_val': 0.9851925397185548, 'auprc': 0.999231818625483, 'loss_val': 0.05486604597511007, 'psi': 0.9908082512813261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=29 head_norm_before_train=1.423978 cos_to_last_merge=0.9647 (last merge round=16)
[S4] round=29 local utility u=0.051437 metrics={'f1_val': 0.9429899494830375, 'auprc': 0.9792453755320394, 'loss_val': 0.27050926328252695, 'psi': 0.9574921199026383}-{'f1_val': 0.9395671769682669, 'auprc': 0.9594031666154579, 'loss_val': 0.2933199247320655, 'psi': 0.9475015728271432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=29 head_norm_before_train=1.177544 cos_to_last_merge=0.8635 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=29 local utility u=0.606555 metrics={'f1_val': 0.8714379151287707, 'auprc': 0.9884790347519092, 'loss_val': 0.19703188329676402, 'psi': 0.9182543629780261}-{'f1_val': 0.7030017902890621, 'auprc': 0.949567816664794, 'loss_val': 0.2827919051105828, 'psi': 0.8016282008393548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=29 head_norm_before_train=1.207912 cos_to_last_merge=0.9231 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.8072531350262538, 'auprc': 0.9366152161256547, 'loss_val': 0.4204935374109014, 'psi': 0.8589979674660142}-{'f1_val': 0.8078634480548263, 'auprc': 0.952269373044341, 'loss_val': 0.34426623994226196, 'psi': 0.8656258180506322}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.460360 cos_to_last_merge=0.9511 (last merge round=12)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5402540534577233, 'auprc': 0.7888222723661104, 'loss_val': 0.8483133378484111, 'psi': 0.6396813410210781}-{'f1_val': 0.6700974434341037, 'auprc': 0.8178445001648855, 'loss_val': 0.45642253060632076, 'psi': 0.7291962661264164}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.634468 cos_to_last_merge=0.9567 (last merge round=16)
[S8] round=29 local utility u=0.018004 metrics={'f1_val': 0.990820193592503, 'auprc': 0.9949402856369925, 'loss_val': 0.04932334378926231, 'psi': 0.9924682304102989}-{'f1_val': 0.9847208361862778, 'auprc': 0.9986709728244775, 'loss_val': 0.05992663176442404, 'psi': 0.9903008908415577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=29 head_norm_before_train=1.951712 cos_to_last_merge=0.9765 (last merge round=14)
[S9] round=29 local utility u=0.002388 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9978257198910494, 'loss_val': 0.02546257933051035, 'psi': 0.9967277612479488}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984719491628296, 'loss_val': 0.0271951722008667, 'psi': 0.9964880834991009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=29 head_norm_before_train=1.549531 cos_to_last_merge=0.9666 (last merge round=13)
[S10] round=29 local utility u=0.006062 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9958351692834069, 'loss_val': 0.05321064728013087, 'psi': 0.9959462236663666}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955542462491814, 'loss_val': 0.05949691153539008, 'psi': 0.9953344019112974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=29 head_norm_before_train=1.299152 cos_to_last_merge=0.9461 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=29 local utility u=0.004274 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9937744079402767, 'loss_val': 0.10085009373676439, 'psi': 0.9954379658842645}-{'f1_val': 0.9963709580040319, 'auprc': 0.9956099747061764, 'loss_val': 0.11384826163753299, 'psi': 0.9960665646848896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=29 head_norm_before_train=1.198706 cos_to_last_merge=0.8744 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.874
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5709655471749036, 'auprc': 0.6945604440029872, 'loss_val': 0.8590608822864649, 'psi': 0.620403505906137}-{'f1_val': 0.614131403946611, 'auprc': 0.6707295058502312, 'loss_val': 0.6820644956785915, 'psi': 0.6367706447080591}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.847107 cos_to_last_merge=0.9635 (last merge round=14)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9990450594737212, 'loss_val': 0.030108046525263176, 'psi': 0.9976844883609503}-{'f1_val': 0.9970202894562089, 'auprc': 0.9991607331580142, 'loss_val': 0.03184247497404294, 'psi': 0.9978764669369311}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=29 head_norm_before_train=1.514329 cos_to_last_merge=0.9295 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=29 local utility u=0.346498 metrics={'f1_val': 0.769391375914312, 'auprc': 0.8888545367447245, 'loss_val': 0.3870170983207114, 'psi': 0.817176640246477}-{'f1_val': 0.6982283000100235, 'auprc': 0.8308439507241665, 'loss_val': 0.47900357470196436, 'psi': 0.7512745602956807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=29 head_norm_before_train=1.916877 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8482618189421746, 'auprc': 0.8290033723414133, 'loss_val': 0.8633472107258675, 'psi': 0.8405584403018701}-{'f1_val': 0.8445486032551122, 'auprc': 0.8792505260161705, 'loss_val': 0.8904555924374874, 'psi': 0.8584293723595355}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.353119 cos_to_last_merge=0.9534 (last merge round=12)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.37745677124310284, 'auprc': 0.7089379531604135, 'loss_val': 1.1952089374549875, 'psi': 0.510049244010027}-{'f1_val': 0.3895003781084974, 'auprc': 0.7132851724475021, 'loss_val': 1.1230121223611786, 'psi': 0.5190142958440993}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.852135 cos_to_last_merge=0.9790 (last merge round=12)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.5343669116185892, 'auprc': 0.6077903101193342, 'loss_val': 1.0608643450136885, 'psi': 0.5637362710188871}-{'f1_val': 0.6563788487379696, 'auprc': 0.7799684118559942, 'loss_val': 0.9534626266339731, 'psi': 0.7058146739851794}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.718089 cos_to_last_merge=0.7850 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.785
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9872687231472141, 'auprc': 0.9992342732765445, 'loss_val': 0.04225725106573775, 'psi': 0.9920549431989463}-{'f1_val': 0.9973956967430226, 'auprc': 0.9992319723941995, 'loss_val': 0.037377470965487485, 'psi': 0.9981302070034933}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.436384 cos_to_last_merge=0.9631 (last merge round=16)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9394646919045175, 'auprc': 0.9402836307347039, 'loss_val': 0.29500818342298274, 'psi': 0.939792267436592}-{'f1_val': 0.9429899494830375, 'auprc': 0.9792453755320394, 'loss_val': 0.27050926328252695, 'psi': 0.9574921199026383}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.193967 cos_to_last_merge=0.8617 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.862
[S5] round=30 local utility u=0.379568 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9885199679882428, 'loss_val': 0.18300579609465126, 'psi': 0.9927694672199682}-{'f1_val': 0.8714379151287707, 'auprc': 0.9884790347519092, 'loss_val': 0.19703188329676402, 'psi': 0.9182543629780261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=30 head_norm_before_train=1.231214 cos_to_last_merge=0.9183 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=30 local utility u=0.567828 metrics={'f1_val': 0.9424505452573061, 'auprc': 0.968935714423793, 'loss_val': 0.19298325541878353, 'psi': 0.9530446129239009}-{'f1_val': 0.8072531350262538, 'auprc': 0.9366152161256547, 'loss_val': 0.4204935374109014, 'psi': 0.8589979674660142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=30 head_norm_before_train=1.468703 cos_to_last_merge=0.9493 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=30 local utility u=0.818607 metrics={'f1_val': 0.6886110793120197, 'auprc': 0.8618714783377543, 'loss_val': 0.320389635879544, 'psi': 0.7579152389223136}-{'f1_val': 0.5402540534577233, 'auprc': 0.7888222723661104, 'loss_val': 0.8483133378484111, 'psi': 0.6396813410210781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=30 head_norm_before_train=1.655764 cos_to_last_merge=0.9547 (last merge round=16)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9860036555248793, 'auprc': 0.9986175620531264, 'loss_val': 0.05347659818798907, 'psi': 0.9910492181361781}-{'f1_val': 0.990820193592503, 'auprc': 0.9949402856369925, 'loss_val': 0.04932334378926231, 'psi': 0.9924682304102989}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.966566 cos_to_last_merge=0.9751 (last merge round=14)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9986272056565538, 'loss_val': 0.03400020288986043, 'psi': 0.9937820054712174}-{'f1_val': 0.9959957888192151, 'auprc': 0.9978257198910494, 'loss_val': 0.02546257933051035, 'psi': 0.9967277612479488}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.572694 cos_to_last_merge=0.9638 (last merge round=13)
[S10] round=30 local utility u=0.001692 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9958257249198733, 'loss_val': 0.04979853665231992, 'psi': 0.9959424459209532}-{'f1_val': 0.9960202599216732, 'auprc': 0.9958351692834069, 'loss_val': 0.05321064728013087, 'psi': 0.9959462236663666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=30 head_norm_before_train=1.324227 cos_to_last_merge=0.9418 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=30 local utility u=0.012398 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972122497026965, 'loss_val': 0.08636742919310379, 'psi': 0.9968131025892324}-{'f1_val': 0.9965470045135896, 'auprc': 0.9937744079402767, 'loss_val': 0.10085009373676439, 'psi': 0.9954379658842645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=30 head_norm_before_train=1.214519 cos_to_last_merge=0.8707 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.871
[S13] round=30 local utility u=0.179028 metrics={'f1_val': 0.6133696374870647, 'auprc': 0.672111655020344, 'loss_val': 0.6880830408382351, 'psi': 0.6368664445003764}-{'f1_val': 0.5709655471749036, 'auprc': 0.6945604440029872, 'loss_val': 0.8590608822864649, 'psi': 0.620403505906137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=30 head_norm_before_train=1.867713 cos_to_last_merge=0.9616 (last merge round=14)
[S14] round=30 local utility u=0.001009 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9988152951438065, 'loss_val': 0.028721419076801098, 'psi': 0.9977246229521217}-{'f1_val': 0.9967774409524363, 'auprc': 0.9990450594737212, 'loss_val': 0.030108046525263176, 'psi': 0.9976844883609503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=30 head_norm_before_train=1.532917 cos_to_last_merge=0.9272 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=30 local utility u=0.955713 metrics={'f1_val': 0.9868300043685871, 'auprc': 0.9891806877305948, 'loss_val': 0.08120146017461517, 'psi': 0.9877702777133902}-{'f1_val': 0.769391375914312, 'auprc': 0.8888545367447245, 'loss_val': 0.3870170983207114, 'psi': 0.817176640246477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=30 head_norm_before_train=1.928677 (no previous merge yet)
[S16] round=30 local utility u=0.123435 metrics={'f1_val': 0.8572643404277722, 'auprc': 0.858052998488015, 'loss_val': 0.757640542072394, 'psi': 0.8575798036518694}-{'f1_val': 0.8482618189421746, 'auprc': 0.8290033723414133, 'loss_val': 0.8633472107258675, 'psi': 0.8405584403018701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.358172 cos_to_last_merge=0.9534 (last merge round=12)
[S17] round=30 local utility u=1.000000 metrics={'f1_val': 0.6625582385938297, 'auprc': 0.9306077975180937, 'loss_val': 0.4127148459130173, 'psi': 0.7697780621635353}-{'f1_val': 0.37745677124310284, 'auprc': 0.7089379531604135, 'loss_val': 1.1952089374549875, 'psi': 0.510049244010027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=31 head_norm_before_train=1.856025 cos_to_last_merge=0.9786 (last merge round=12)
[S2] round=31 local utility u=1.000000 metrics={'f1_val': 0.7004439960232219, 'auprc': 0.7852335980054925, 'loss_val': 0.3566547149969346, 'psi': 0.7343598368161302}-{'f1_val': 0.5343669116185892, 'auprc': 0.6077903101193342, 'loss_val': 1.0608643450136885, 'psi': 0.5637362710188871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=31 head_norm_before_train=1.735047 cos_to_last_merge=0.7840 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.784
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.999214925399581, 'loss_val': 0.060914187075178816, 'psi': 0.9836726392303112}-{'f1_val': 0.9872687231472141, 'auprc': 0.9992342732765445, 'loss_val': 0.04225725106573775, 'psi': 0.9920549431989463}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.444838 cos_to_last_merge=0.9615 (last merge round=16)
[S4] round=31 local utility u=0.034261 metrics={'f1_val': 0.9399664808249657, 'auprc': 0.9602579789967002, 'loss_val': 0.28941993533959787, 'psi': 0.9480830800936595}-{'f1_val': 0.9394646919045175, 'auprc': 0.9402836307347039, 'loss_val': 0.29500818342298274, 'psi': 0.939792267436592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=31 head_norm_before_train=1.208306 cos_to_last_merge=0.8603 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.860
[S5] round=31 local utility u=0.014295 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9889371655669186, 'loss_val': 0.15742383112655448, 'psi': 0.993111966363498}-{'f1_val': 0.9956024667077852, 'auprc': 0.9885199679882428, 'loss_val': 0.18300579609465126, 'psi': 0.9927694672199682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=31 head_norm_before_train=1.257249 cos_to_last_merge=0.9132 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8184463634803051, 'auprc': 0.9422667145661325, 'loss_val': 0.3903216855282345, 'psi': 0.867974503914636}-{'f1_val': 0.9424505452573061, 'auprc': 0.968935714423793, 'loss_val': 0.19298325541878353, 'psi': 0.9530446129239009}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.476887 cos_to_last_merge=0.9477 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6123435827350027, 'auprc': 0.8023784860952377, 'loss_val': 0.6365082835306102, 'psi': 0.6883575440790967}-{'f1_val': 0.6886110793120197, 'auprc': 0.8618714783377543, 'loss_val': 0.320389635879544, 'psi': 0.7579152389223136}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.671621 cos_to_last_merge=0.9531 (last merge round=16)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.7147581115208734, 'auprc': 0.9836079600297019, 'loss_val': 0.2768629440852571, 'psi': 0.8222980509244049}-{'f1_val': 0.9860036555248793, 'auprc': 0.9986175620531264, 'loss_val': 0.05347659818798907, 'psi': 0.9910492181361781}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=31 head_norm_before_train=1.979605 cos_to_last_merge=0.9742 (last merge round=14)
[S9] round=31 local utility u=0.021372 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9984745073057404, 'loss_val': 0.023461732211770538, 'psi': 0.9969872762138252}-{'f1_val': 0.9905518720143266, 'auprc': 0.9986272056565538, 'loss_val': 0.03400020288986043, 'psi': 0.9937820054712174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=31 head_norm_before_train=1.597083 cos_to_last_merge=0.9614 (last merge round=13)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943727739649666, 'loss_val': 0.04940206616232452, 'psi': 0.9948618129976114}-{'f1_val': 0.9960202599216732, 'auprc': 0.9958257249198733, 'loss_val': 0.04979853665231992, 'psi': 0.9959424459209532}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=1.349694 cos_to_last_merge=0.9376 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9940327724445256, 'auprc': 0.9976476154063028, 'loss_val': 0.08036645632702807, 'psi': 0.9954787096292366}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972122497026965, 'loss_val': 0.08636742919310379, 'psi': 0.9968131025892324}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.226897 cos_to_last_merge=0.8678 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.569142842122184, 'auprc': 0.6937495856269791, 'loss_val': 0.8761202731484331, 'psi': 0.6189855395241021}-{'f1_val': 0.6133696374870647, 'auprc': 0.672111655020344, 'loss_val': 0.6880830408382351, 'psi': 0.6368664445003764}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.888899 cos_to_last_merge=0.9596 (last merge round=14)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9706660303255216, 'auprc': 0.9970701580182862, 'loss_val': 0.05462009362515326, 'psi': 0.9812276814026275}-{'f1_val': 0.9969975081576651, 'auprc': 0.9988152951438065, 'loss_val': 0.028721419076801098, 'psi': 0.9977246229521217}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=1.549624 cos_to_last_merge=0.9252 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7009802000743424, 'auprc': 0.7800590006944375, 'loss_val': 0.5537918099395893, 'psi': 0.7326117203223803}-{'f1_val': 0.9868300043685871, 'auprc': 0.9891806877305948, 'loss_val': 0.08120146017461517, 'psi': 0.9877702777133902}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.937693 (no previous merge yet)
[S16] round=31 local utility u=0.656246 metrics={'f1_val': 0.9331603320165297, 'auprc': 0.9941704172964746, 'loss_val': 0.3088776861261814, 'psi': 0.9575643661285077}-{'f1_val': 0.8572643404277722, 'auprc': 0.858052998488015, 'loss_val': 0.757640542072394, 'psi': 0.8575798036518694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=31 head_norm_before_train=1.361686 cos_to_last_merge=0.9541 (last merge round=12)
[S17] round=31 local utility u=0.114338 metrics={'f1_val': 0.6782454638858957, 'auprc': 0.9690102472752351, 'loss_val': 0.39336987558287145, 'psi': 0.7945513772416315}-{'f1_val': 0.6625582385938297, 'auprc': 0.9306077975180937, 'loss_val': 0.4127148459130173, 'psi': 0.7697780621635353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=32 head_norm_before_train=1.859524 cos_to_last_merge=0.9783 (last merge round=12)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6632672062564595, 'auprc': 0.7560613532049838, 'loss_val': 0.670490192564006, 'psi': 0.7003848650358693}-{'f1_val': 0.7004439960232219, 'auprc': 0.7852335980054925, 'loss_val': 0.3566547149969346, 'psi': 0.7343598368161302}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=1.751206 cos_to_last_merge=0.7830 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.783
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9994309090364517, 'loss_val': 0.07413800638084232, 'psi': 0.9766954767875892}-{'f1_val': 0.9733111151174647, 'auprc': 0.999214925399581, 'loss_val': 0.060914187075178816, 'psi': 0.9836726392303112}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.454265 cos_to_last_merge=0.9595 (last merge round=16)
[S4] round=32 local utility u=0.062607 metrics={'f1_val': 0.9499281670697756, 'auprc': 0.9733694230527773, 'loss_val': 0.26331095300539387, 'psi': 0.9593046694629762}-{'f1_val': 0.9399664808249657, 'auprc': 0.9602579789967002, 'loss_val': 0.28941993533959787, 'psi': 0.9480830800936595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=32 head_norm_before_train=1.225011 cos_to_last_merge=0.8587 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.859
[S5] round=32 local utility u=0.000070 metrics={'f1_val': 0.9946528597458227, 'auprc': 0.9898177541920389, 'loss_val': 0.15247137806760622, 'psi': 0.9927188175243091}-{'f1_val': 0.995895166894551, 'auprc': 0.9889371655669186, 'loss_val': 0.15742383112655448, 'psi': 0.993111966363498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=32 head_norm_before_train=1.280889 cos_to_last_merge=0.9086 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6747106008773047, 'auprc': 0.9031185216979074, 'loss_val': 0.6400298363834397, 'psi': 0.7660737692055458}-{'f1_val': 0.8184463634803051, 'auprc': 0.9422667145661325, 'loss_val': 0.3903216855282345, 'psi': 0.867974503914636}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.486014 cos_to_last_merge=0.9468 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=32 local utility u=0.039705 metrics={'f1_val': 0.6252221584332402, 'auprc': 0.800803657720132, 'loss_val': 0.6296451848956037, 'psi': 0.695454758147997}-{'f1_val': 0.6123435827350027, 'auprc': 0.8023784860952377, 'loss_val': 0.6365082835306102, 'psi': 0.6883575440790967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=32 head_norm_before_train=1.686723 cos_to_last_merge=0.9516 (last merge round=16)
[S8] round=32 local utility u=0.964202 metrics={'f1_val': 0.989929598471134, 'auprc': 0.9982366014280963, 'loss_val': 0.043373146450967244, 'psi': 0.993252399653919}-{'f1_val': 0.7147581115208734, 'auprc': 0.9836079600297019, 'loss_val': 0.2768629440852571, 'psi': 0.8222980509244049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=32 head_norm_before_train=1.992911 cos_to_last_merge=0.9734 (last merge round=14)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9888471887074294, 'auprc': 0.9986557581368265, 'loss_val': 0.03975814721209881, 'psi': 0.9927706164791883}-{'f1_val': 0.9959957888192151, 'auprc': 0.9984745073057404, 'loss_val': 0.023461732211770538, 'psi': 0.9969872762138252}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.620855 cos_to_last_merge=0.9591 (last merge round=13)
[S10] round=32 local utility u=0.003354 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9948257711535328, 'loss_val': 0.04658369802906913, 'psi': 0.9952961005704251}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943727739649666, 'loss_val': 0.04940206616232452, 'psi': 0.9948618129976114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=32 head_norm_before_train=1.370956 cos_to_last_merge=0.9340 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9635734117238184, 'auprc': 0.9973438936610668, 'loss_val': 0.08447911226588714, 'psi': 0.9770816044987177}-{'f1_val': 0.9940327724445256, 'auprc': 0.9976476154063028, 'loss_val': 0.08036645632702807, 'psi': 0.9954787096292366}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.237988 cos_to_last_merge=0.8648 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=32 local utility u=0.210919 metrics={'f1_val': 0.6153740384717075, 'auprc': 0.6801585016166958, 'loss_val': 0.6908961347338756, 'psi': 0.6412878237297028}-{'f1_val': 0.569142842122184, 'auprc': 0.6937495856269791, 'loss_val': 0.8761202731484331, 'psi': 0.6189855395241021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=32 head_norm_before_train=1.900449 cos_to_last_merge=0.9586 (last merge round=14)
[S14] round=32 local utility u=0.097622 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9992280992655493, 'loss_val': 0.026439975675645655, 'psi': 0.9981498700105974}-{'f1_val': 0.9706660303255216, 'auprc': 0.9970701580182862, 'loss_val': 0.05462009362515326, 'psi': 0.9812276814026275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=32 head_norm_before_train=1.561560 cos_to_last_merge=0.9240 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=32 local utility u=0.615933 metrics={'f1_val': 0.779044885051222, 'auprc': 0.9602597016093962, 'loss_val': 0.33091576386330795, 'psi': 0.8515308116744917}-{'f1_val': 0.7009802000743424, 'auprc': 0.7800590006944375, 'loss_val': 0.5537918099395893, 'psi': 0.7326117203223803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=32 head_norm_before_train=1.947659 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8973261993574773, 'auprc': 0.9906938829690766, 'loss_val': 0.45825997777509053, 'psi': 0.934673272802117}-{'f1_val': 0.9331603320165297, 'auprc': 0.9941704172964746, 'loss_val': 0.3088776861261814, 'psi': 0.9575643661285077}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.367566 cos_to_last_merge=0.9535 (last merge round=12)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.40656370484815085, 'auprc': 0.7283463079675675, 'loss_val': 0.9001614319132937, 'psi': 0.5352767460959176}-{'f1_val': 0.6782454638858957, 'auprc': 0.9690102472752351, 'loss_val': 0.39336987558287145, 'psi': 0.7945513772416315}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.865411 cos_to_last_merge=0.9778 (last merge round=12)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6628345941556908, 'auprc': 0.7760481530369046, 'loss_val': 1.0309876725272706, 'psi': 0.7081200177081763}-{'f1_val': 0.6632672062564595, 'auprc': 0.7560613532049838, 'loss_val': 0.670490192564006, 'psi': 0.7003848650358693}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=1.768614 cos_to_last_merge=0.7819 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.782
[S3] round=33 local utility u=0.128086 metrics={'f1_val': 0.9967261091895924, 'auprc': 0.9996062040310406, 'loss_val': 0.029617627773134696, 'psi': 0.9978781471261717}-{'f1_val': 0.9615385219550141, 'auprc': 0.9994309090364517, 'loss_val': 0.07413800638084232, 'psi': 0.9766954767875892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=33 head_norm_before_train=1.464817 cos_to_last_merge=0.9578 (last merge round=16)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9436714063512122, 'auprc': 0.9638116063706619, 'loss_val': 0.2829885991571501, 'psi': 0.9517274863589921}-{'f1_val': 0.9499281670697756, 'auprc': 0.9733694230527773, 'loss_val': 0.26331095300539387, 'psi': 0.9593046694629762}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.242127 cos_to_last_merge=0.8572 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.702985674832947, 'auprc': 0.8922521236697943, 'loss_val': 0.36507871982654194, 'psi': 0.778692254367686}-{'f1_val': 0.9946528597458227, 'auprc': 0.9898177541920389, 'loss_val': 0.15247137806760622, 'psi': 0.9927188175243091}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.304255 cos_to_last_merge=0.9042 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9621384650656137, 'auprc': 0.9656469665647743, 'loss_val': 0.18596967056840466, 'psi': 0.963541865665278}-{'f1_val': 0.6747106008773047, 'auprc': 0.9031185216979074, 'loss_val': 0.6400298363834397, 'psi': 0.7660737692055458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=33 head_norm_before_train=1.493475 cos_to_last_merge=0.9461 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=33 local utility u=0.344416 metrics={'f1_val': 0.6906795955496007, 'auprc': 0.8295936219335587, 'loss_val': 0.4199273322452327, 'psi': 0.7462452061031839}-{'f1_val': 0.6252221584332402, 'auprc': 0.800803657720132, 'loss_val': 0.6296451848956037, 'psi': 0.695454758147997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=33 head_norm_before_train=1.700288 cos_to_last_merge=0.9504 (last merge round=16)
[S8] round=33 local utility u=0.007585 metrics={'f1_val': 0.9920088312095362, 'auprc': 0.9979922535058228, 'loss_val': 0.0399448199351952, 'psi': 0.9944022001280508}-{'f1_val': 0.989929598471134, 'auprc': 0.9982366014280963, 'loss_val': 0.043373146450967244, 'psi': 0.993252399653919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=33 head_norm_before_train=2.006062 cos_to_last_merge=0.9727 (last merge round=14)
[S9] round=33 local utility u=0.028517 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984789585262672, 'loss_val': 0.02256838607714181, 'psi': 0.9967374187410156}-{'f1_val': 0.9888471887074294, 'auprc': 0.9986557581368265, 'loss_val': 0.03975814721209881, 'psi': 0.9927706164791883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=33 head_norm_before_train=1.641470 cos_to_last_merge=0.9573 (last merge round=13)
[S10] round=33 local utility u=0.004980 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9966696162542203, 'loss_val': 0.04212534469840289, 'psi': 0.9960307126648701}-{'f1_val': 0.9956096535150197, 'auprc': 0.9948257711535328, 'loss_val': 0.04658369802906913, 'psi': 0.9952961005704251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] sending update (kind=head size=1789 to 1 peers)
[S11] START round=33 head_norm_before_train=1.392432 cos_to_last_merge=0.9304 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=33 local utility u=0.073101 metrics={'f1_val': 0.9896177416387825, 'auprc': 0.9964973375552593, 'loss_val': 0.09200253106082265, 'psi': 0.9923695800053732}-{'f1_val': 0.9635734117238184, 'auprc': 0.9973438936610668, 'loss_val': 0.08447911226588714, 'psi': 0.9770816044987177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=33 head_norm_before_train=1.246210 cos_to_last_merge=0.8623 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5706640822582103, 'auprc': 0.6936808421697014, 'loss_val': 0.909600526165917, 'psi': 0.6198707862228068}-{'f1_val': 0.6153740384717075, 'auprc': 0.6801585016166958, 'loss_val': 0.6908961347338756, 'psi': 0.6412878237297028}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.913456 cos_to_last_merge=0.9576 (last merge round=14)
[S14] round=33 local utility u=0.001320 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9992296843828025, 'loss_val': 0.02512535228440684, 'psi': 0.9982825445830331}-{'f1_val': 0.9974310505072961, 'auprc': 0.9992280992655493, 'loss_val': 0.026439975675645655, 'psi': 0.9981498700105974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=33 head_norm_before_train=1.573169 cos_to_last_merge=0.9223 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=33 local utility u=0.764111 metrics={'f1_val': 0.9836134737815774, 'auprc': 0.9885005085220263, 'loss_val': 0.11482688816012819, 'psi': 0.985568287677757}-{'f1_val': 0.779044885051222, 'auprc': 0.9602597016093962, 'loss_val': 0.33091576386330795, 'psi': 0.8515308116744917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=33 head_norm_before_train=1.958100 (no previous merge yet)
[S16] round=33 local utility u=0.119083 metrics={'f1_val': 0.9227359991230544, 'auprc': 0.9931833154748579, 'loss_val': 0.3800208803323401, 'psi': 0.9509149256637759}-{'f1_val': 0.8973261993574773, 'auprc': 0.9906938829690766, 'loss_val': 0.45825997777509053, 'psi': 0.934673272802117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=33 head_norm_before_train=1.374690 cos_to_last_merge=0.9521 (last merge round=12)
[S17] round=33 local utility u=1.000000 metrics={'f1_val': 0.6338147601960493, 'auprc': 0.9680599492590235, 'loss_val': 0.48582656813077313, 'psi': 0.7675128358212391}-{'f1_val': 0.40656370484815085, 'auprc': 0.7283463079675675, 'loss_val': 0.9001614319132937, 'psi': 0.5352767460959176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=34 head_norm_before_train=1.871648 cos_to_last_merge=0.9773 (last merge round=12)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6051379067224174, 'auprc': 0.6566405964240803, 'loss_val': 0.5194303822565433, 'psi': 0.6257389826030826}-{'f1_val': 0.6628345941556908, 'auprc': 0.7760481530369046, 'loss_val': 1.0309876725272706, 'psi': 0.7081200177081763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=1.784551 cos_to_last_merge=0.7808 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.781
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953166962312615, 'auprc': 0.9996034638164564, 'loss_val': 0.030413170894367448, 'psi': 0.9970314032653395}-{'f1_val': 0.9967261091895924, 'auprc': 0.9996062040310406, 'loss_val': 0.029617627773134696, 'psi': 0.9978781471261717}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.474708 cos_to_last_merge=0.9559 (last merge round=16)
[S4] round=34 local utility u=0.043856 metrics={'f1_val': 0.9479297661575035, 'auprc': 0.9790205286168605, 'loss_val': 0.26645347847818374, 'psi': 0.9603660711412463}-{'f1_val': 0.9436714063512122, 'auprc': 0.9638116063706619, 'loss_val': 0.2829885991571501, 'psi': 0.9517274863589921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=34 head_norm_before_train=1.254883 cos_to_last_merge=0.8560 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=34 local utility u=1.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9919600530785735, 'loss_val': 0.11817628853814954, 'psi': 0.99432112136816}-{'f1_val': 0.702985674832947, 'auprc': 0.8922521236697943, 'loss_val': 0.36507871982654194, 'psi': 0.778692254367686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=34 head_norm_before_train=1.320817 cos_to_last_merge=0.9012 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.822913642258956, 'auprc': 0.9501689990395873, 'loss_val': 0.3559957690600233, 'psi': 0.8738157849712085}-{'f1_val': 0.9621384650656137, 'auprc': 0.9656469665647743, 'loss_val': 0.18596967056840466, 'psi': 0.963541865665278}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.500148 cos_to_last_merge=0.9452 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6497184412417271, 'auprc': 0.8005308882807193, 'loss_val': 0.5722074313391625, 'psi': 0.710043420057324}-{'f1_val': 0.6906795955496007, 'auprc': 0.8295936219335587, 'loss_val': 0.4199273322452327, 'psi': 0.7462452061031839}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.714195 cos_to_last_merge=0.9494 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.949
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9846567949518252, 'auprc': 0.9986732155525659, 'loss_val': 0.05066446561588853, 'psi': 0.9902633631921215}-{'f1_val': 0.9920088312095362, 'auprc': 0.9979922535058228, 'loss_val': 0.0399448199351952, 'psi': 0.9944022001280508}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=2.016584 cos_to_last_merge=0.9720 (last merge round=14)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9985773276567609, 'loss_val': 0.0252457850848837, 'psi': 0.995776795398376}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984789585262672, 'loss_val': 0.02256838607714181, 'psi': 0.9967374187410156}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.658738 cos_to_last_merge=0.9555 (last merge round=13)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9957463167798835, 'loss_val': 0.04062395066178698, 'psi': 0.9956613928751353}-{'f1_val': 0.9956047769386365, 'auprc': 0.9966696162542203, 'loss_val': 0.04212534469840289, 'psi': 0.9960307126648701}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.410298 cos_to_last_merge=0.9274 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9629576713681793, 'auprc': 0.9963412257602267, 'loss_val': 0.13590120079351248, 'psi': 0.9763110931249982}-{'f1_val': 0.9896177416387825, 'auprc': 0.9964973375552593, 'loss_val': 0.09200253106082265, 'psi': 0.9923695800053732}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.253815 cos_to_last_merge=0.8608 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.861
[S13] round=34 local utility u=0.309150 metrics={'f1_val': 0.633838116338403, 'auprc': 0.6703413742372556, 'loss_val': 0.6003256422533347, 'psi': 0.648439419497944}-{'f1_val': 0.5706640822582103, 'auprc': 0.6936808421697014, 'loss_val': 0.909600526165917, 'psi': 0.6198707862228068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=34 head_norm_before_train=1.926715 cos_to_last_merge=0.9563 (last merge round=14)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9974395574189819, 'loss_val': 0.037063933065736764, 'psi': 0.9959224610793629}-{'f1_val': 0.9976511180498535, 'auprc': 0.9992296843828025, 'loss_val': 0.02512535228440684, 'psi': 0.9982825445830331}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.584091 cos_to_last_merge=0.9217 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9612762759122283, 'auprc': 0.9887263012927, 'loss_val': 0.09568281537600626, 'psi': 0.9722562860644169}-{'f1_val': 0.9836134737815774, 'auprc': 0.9885005085220263, 'loss_val': 0.11482688816012819, 'psi': 0.985568287677757}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.969149 (no previous merge yet)
[S16] round=34 local utility u=0.119239 metrics={'f1_val': 0.9402174666621921, 'auprc': 0.9911876107870089, 'loss_val': 0.24044524435885267, 'psi': 0.9606055243121188}-{'f1_val': 0.9227359991230544, 'auprc': 0.9931833154748579, 'loss_val': 0.3800208803323401, 'psi': 0.9509149256637759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=34 head_norm_before_train=1.383025 cos_to_last_merge=0.9507 (last merge round=12)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.4171186101077602, 'auprc': 0.7294465678728366, 'loss_val': 0.952415717850604, 'psi': 0.5420497932137908}-{'f1_val': 0.6338147601960493, 'auprc': 0.9680599492590235, 'loss_val': 0.48582656813077313, 'psi': 0.7675128358212391}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.876715 cos_to_last_merge=0.9769 (last merge round=12)
[S2] round=35 local utility u=0.468754 metrics={'f1_val': 0.7192186277538104, 'auprc': 0.7846233763015565, 'loss_val': 0.6503542822646312, 'psi': 0.7453805271729088}-{'f1_val': 0.6051379067224174, 'auprc': 0.6566405964240803, 'loss_val': 0.5194303822565433, 'psi': 0.6257389826030826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=35 head_norm_before_train=1.798206 cos_to_last_merge=0.7799 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.780
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9839014957448758, 'auprc': 0.9994307527831986, 'loss_val': 0.042938742943962584, 'psi': 0.990113198560205}-{'f1_val': 0.9953166962312615, 'auprc': 0.9996034638164564, 'loss_val': 0.030413170894367448, 'psi': 0.9970314032653395}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.486758 cos_to_last_merge=0.9542 (last merge round=16)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9401675668835747, 'auprc': 0.9437408493431491, 'loss_val': 0.28941075278468625, 'psi': 0.9415968798674044}-{'f1_val': 0.9479297661575035, 'auprc': 0.9790205286168605, 'loss_val': 0.26645347847818374, 'psi': 0.9603660711412463}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.264694 cos_to_last_merge=0.8551 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.855
[S5] round=35 local utility u=0.000469 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9908942047059534, 'loss_val': 0.11404094770069075, 'psi': 0.993894782019112}-{'f1_val': 0.995895166894551, 'auprc': 0.9919600530785735, 'loss_val': 0.11817628853814954, 'psi': 0.99432112136816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=35 head_norm_before_train=1.335610 cos_to_last_merge=0.8985 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.7701414202550825, 'auprc': 0.9214131707810196, 'loss_val': 0.5181262098013221, 'psi': 0.8306501204654573}-{'f1_val': 0.822913642258956, 'auprc': 0.9501689990395873, 'loss_val': 0.3559957690600233, 'psi': 0.8738157849712085}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.505520 cos_to_last_merge=0.9439 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=35 local utility u=0.221083 metrics={'f1_val': 0.688107513668947, 'auprc': 0.8106961187008401, 'loss_val': 0.3908710223955714, 'psi': 0.7371429556817042}-{'f1_val': 0.6497184412417271, 'auprc': 0.8005308882807193, 'loss_val': 0.5722074313391625, 'psi': 0.710043420057324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=35 head_norm_before_train=1.727674 cos_to_last_merge=0.9483 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.948
[S8] round=35 local utility u=0.025491 metrics={'f1_val': 0.9924309654389881, 'auprc': 0.996822951068337, 'loss_val': 0.040776835906381904, 'psi': 0.9941877596907276}-{'f1_val': 0.9846567949518252, 'auprc': 0.9986732155525659, 'loss_val': 0.05066446561588853, 'psi': 0.9902633631921215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=35 head_norm_before_train=2.027394 cos_to_last_merge=0.9714 (last merge round=14)
[S9] round=35 local utility u=0.009417 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9984777682945634, 'loss_val': 0.02111602352474504, 'psi': 0.9972372187181578}-{'f1_val': 0.993909773892786, 'auprc': 0.9985773276567609, 'loss_val': 0.0252457850848837, 'psi': 0.995776795398376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=35 head_norm_before_train=1.676872 cos_to_last_merge=0.9539 (last merge round=13)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.99520166128978, 'loss_val': 0.039812157589134464, 'psi': 0.9954464566249239}-{'f1_val': 0.9956047769386365, 'auprc': 0.9957463167798835, 'loss_val': 0.04062395066178698, 'psi': 0.9956613928751353}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=35 head_norm_before_train=1.424659 cos_to_last_merge=0.9251 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=35 local utility u=0.140165 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9966442437984813, 'loss_val': 0.05801552611841303, 'psi': 0.9965859002275462}-{'f1_val': 0.9629576713681793, 'auprc': 0.9963412257602267, 'loss_val': 0.13590120079351248, 'psi': 0.9763110931249982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.262205 cos_to_last_merge=0.8596 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.860
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.564056865937692, 'auprc': 0.6978349053497859, 'loss_val': 0.9249321586040332, 'psi': 0.6175680817025295}-{'f1_val': 0.633838116338403, 'auprc': 0.6703413742372556, 'loss_val': 0.6003256422533347, 'psi': 0.648439419497944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.939455 cos_to_last_merge=0.9551 (last merge round=14)
[S14] round=35 local utility u=0.009314 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9970867235710782, 'loss_val': 0.03337071400335973, 'psi': 0.9973806143063821}-{'f1_val': 0.9949110635196168, 'auprc': 0.9974395574189819, 'loss_val': 0.037063933065736764, 'psi': 0.9959224610793629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=35 head_norm_before_train=1.590933 cos_to_last_merge=0.9219 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.6977645774244519, 'auprc': 0.675233881418354, 'loss_val': 0.6397865297761592, 'psi': 0.6887522990220127}-{'f1_val': 0.9612762759122283, 'auprc': 0.9887263012927, 'loss_val': 0.09568281537600626, 'psi': 0.9722562860644169}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.973126 (no previous merge yet)
[S16] round=35 local utility u=0.246003 metrics={'f1_val': 0.9896402553934984, 'auprc': 0.9935098883764772, 'loss_val': 0.05194325412081854, 'psi': 0.9911881085866899}-{'f1_val': 0.9402174666621921, 'auprc': 0.9911876107870089, 'loss_val': 0.24044524435885267, 'psi': 0.9606055243121188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=35 head_norm_before_train=1.390042 cos_to_last_merge=0.9490 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=35 local utility u=1.000000 metrics={'f1_val': 0.6318617696692652, 'auprc': 0.8820532074884269, 'loss_val': 0.63175894230257, 'psi': 0.7319383447969299}-{'f1_val': 0.4171186101077602, 'auprc': 0.7294465678728366, 'loss_val': 0.952415717850604, 'psi': 0.5420497932137908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=36 head_norm_before_train=1.881023 cos_to_last_merge=0.9766 (last merge round=12)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7114011082288161, 'auprc': 0.7642453648987666, 'loss_val': 0.6214062677738909, 'psi': 0.7325388108967963}-{'f1_val': 0.7192186277538104, 'auprc': 0.7846233763015565, 'loss_val': 0.6503542822646312, 'psi': 0.7453805271729088}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=1.811989 cos_to_last_merge=0.7790 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.779
[S3] round=36 local utility u=0.043352 metrics={'f1_val': 0.9957334792264856, 'auprc': 0.9996035589155036, 'loss_val': 0.027745994401507008, 'psi': 0.9972815111020927}-{'f1_val': 0.9839014957448758, 'auprc': 0.9994307527831986, 'loss_val': 0.042938742943962584, 'psi': 0.990113198560205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=36 head_norm_before_train=1.497854 cos_to_last_merge=0.9526 (last merge round=16)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9412262880923826, 'auprc': 0.9377962051336192, 'loss_val': 0.2891473860147137, 'psi': 0.9398542549088772}-{'f1_val': 0.9401675668835747, 'auprc': 0.9437408493431491, 'loss_val': 0.28941075278468625, 'psi': 0.9415968798674044}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.275077 cos_to_last_merge=0.8542 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.8819524280593698, 'auprc': 0.9877795873060877, 'loss_val': 0.19103335212266914, 'psi': 0.924283291758057}-{'f1_val': 0.995895166894551, 'auprc': 0.9908942047059534, 'loss_val': 0.11404094770069075, 'psi': 0.993894782019112}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=36 head_norm_before_train=1.348582 cos_to_last_merge=0.8958 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=36 local utility u=0.140567 metrics={'f1_val': 0.8067662049355645, 'auprc': 0.9287923169645135, 'loss_val': 0.4788784344930941, 'psi': 0.8555766497471441}-{'f1_val': 0.7701414202550825, 'auprc': 0.9214131707810196, 'loss_val': 0.5181262098013221, 'psi': 0.8306501204654573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=36 head_norm_before_train=1.510172 cos_to_last_merge=0.9425 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=36 local utility u=0.312836 metrics={'f1_val': 0.7213250648765669, 'auprc': 0.9246991902026749, 'loss_val': 0.3065140329809189, 'psi': 0.8026747150070102}-{'f1_val': 0.688107513668947, 'auprc': 0.8106961187008401, 'loss_val': 0.3908710223955714, 'psi': 0.7371429556817042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=36 head_norm_before_train=1.737852 cos_to_last_merge=0.9474 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.990820193592503, 'auprc': 0.9984030488716426, 'loss_val': 0.03939471416496841, 'psi': 0.9938533357041588}-{'f1_val': 0.9924309654389881, 'auprc': 0.996822951068337, 'loss_val': 0.040776835906381904, 'psi': 0.9941877596907276}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.037733 cos_to_last_merge=0.9708 (last merge round=14)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9986071459847305, 'loss_val': 0.03317346972008153, 'psi': 0.993767461990161}-{'f1_val': 0.9964101856672208, 'auprc': 0.9984777682945634, 'loss_val': 0.02111602352474504, 'psi': 0.9972372187181578}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.694583 cos_to_last_merge=0.9525 (last merge round=13)
[S10] round=36 local utility u=0.001866 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9957981898736492, 'loss_val': 0.03783955150333297, 'psi': 0.9956821421126416}-{'f1_val': 0.9956096535150197, 'auprc': 0.99520166128978, 'loss_val': 0.039812157589134464, 'psi': 0.9954464566249239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=36 head_norm_before_train=1.440767 cos_to_last_merge=0.9227 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.923
[S11] round=36 local utility u=0.005811 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981194954317814, 'loss_val': 0.05081923432117745, 'psi': 0.9971760008808663}-{'f1_val': 0.9965470045135896, 'auprc': 0.9966442437984813, 'loss_val': 0.05801552611841303, 'psi': 0.9965859002275462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=36 head_norm_before_train=1.270015 cos_to_last_merge=0.8586 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.859
[S13] round=36 local utility u=0.186693 metrics={'f1_val': 0.6070733168977948, 'auprc': 0.6808421256360426, 'loss_val': 0.7586658344621058, 'psi': 0.6365808403930939}-{'f1_val': 0.564056865937692, 'auprc': 0.6978349053497859, 'loss_val': 0.9249321586040332, 'psi': 0.6175680817025295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=36 head_norm_before_train=1.950135 cos_to_last_merge=0.9541 (last merge round=14)
[S14] round=36 local utility u=0.004151 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971215034969403, 'loss_val': 0.026630789918817552, 'psi': 0.9975403121791071}-{'f1_val': 0.9975765414632514, 'auprc': 0.9970867235710782, 'loss_val': 0.03337071400335973, 'psi': 0.9973806143063821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=36 head_norm_before_train=1.598063 cos_to_last_merge=0.9217 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.98457620085201, 'auprc': 0.9965352153671677, 'loss_val': 0.09181021044915458, 'psi': 0.9893598066580731}-{'f1_val': 0.6977645774244519, 'auprc': 0.675233881418354, 'loss_val': 0.6397865297761592, 'psi': 0.6887522990220127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=36 head_norm_before_train=1.979947 (no previous merge yet)
[S16] round=36 local utility u=0.020708 metrics={'f1_val': 0.9927343791035232, 'auprc': 0.9951696470826525, 'loss_val': 0.034071820083761584, 'psi': 0.9937084862951749}-{'f1_val': 0.9896402553934984, 'auprc': 0.9935098883764772, 'loss_val': 0.05194325412081854, 'psi': 0.9911881085866899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=36 head_norm_before_train=1.398060 cos_to_last_merge=0.9468 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.947
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.4178281137151801, 'auprc': 0.7123989507704387, 'loss_val': 0.9597238831435904, 'psi': 0.5356564485372834}-{'f1_val': 0.6318617696692652, 'auprc': 0.8820532074884269, 'loss_val': 0.63175894230257, 'psi': 0.7319383447969299}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=37 head_norm_before_train=1.886144 cos_to_last_merge=0.9762 (last merge round=12)
[S2] round=37 local utility u=0.012007 metrics={'f1_val': 0.7119885744627701, 'auprc': 0.7779647511440424, 'loss_val': 0.6420749998932826, 'psi': 0.738379045135279}-{'f1_val': 0.7114011082288161, 'auprc': 0.7642453648987666, 'loss_val': 0.6214062677738909, 'psi': 0.7325388108967963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=37 head_norm_before_train=1.825209 cos_to_last_merge=0.7781 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.778
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9999745994587894, 'loss_val': 0.13762918522387393, 'psi': 0.976316163522984}-{'f1_val': 0.9957334792264856, 'auprc': 0.9996035589155036, 'loss_val': 0.027745994401507008, 'psi': 0.9972815111020927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.505171 cos_to_last_merge=0.9509 (last merge round=16)
[S4] round=37 local utility u=0.045631 metrics={'f1_val': 0.9466592132598587, 'auprc': 0.9532244227423494, 'loss_val': 0.2767680684488902, 'psi': 0.949285297052855}-{'f1_val': 0.9412262880923826, 'auprc': 0.9377962051336192, 'loss_val': 0.2891473860147137, 'psi': 0.9398542549088772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=37 head_norm_before_train=1.290485 cos_to_last_merge=0.8530 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.853
[S5] round=37 local utility u=0.387734 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9892896027876477, 'loss_val': 0.10375230561140225, 'psi': 0.9932529412517896}-{'f1_val': 0.8819524280593698, 'auprc': 0.9877795873060877, 'loss_val': 0.19103335212266914, 'psi': 0.924283291758057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=37 head_norm_before_train=1.364471 cos_to_last_merge=0.8926 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7423419406702487, 'auprc': 0.9379156153054089, 'loss_val': 0.5838197247603344, 'psi': 0.8205714105243128}-{'f1_val': 0.8067662049355645, 'auprc': 0.9287923169645135, 'loss_val': 0.4788784344930941, 'psi': 0.8555766497471441}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.516083 cos_to_last_merge=0.9411 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.627903274583193, 'auprc': 0.7964743773469242, 'loss_val': 0.5882361835921188, 'psi': 0.6953317156886855}-{'f1_val': 0.7213250648765669, 'auprc': 0.9246991902026749, 'loss_val': 0.3065140329809189, 'psi': 0.8026747150070102}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.745990 cos_to_last_merge=0.9468 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9902788351813033, 'loss_val': 0.04437433220748362, 'psi': 0.9920104450033334}-{'f1_val': 0.990820193592503, 'auprc': 0.9984030488716426, 'loss_val': 0.03939471416496841, 'psi': 0.9938533357041588}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=2.048502 cos_to_last_merge=0.9702 (last merge round=14)
[S9] round=37 local utility u=0.014969 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9928906548005582, 'loss_val': 0.021301819536212383, 'psi': 0.9950023733205557}-{'f1_val': 0.9905410059937811, 'auprc': 0.9986071459847305, 'loss_val': 0.03317346972008153, 'psi': 0.993767461990161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=37 head_norm_before_train=1.711532 cos_to_last_merge=0.9514 (last merge round=13)
[S10] round=37 local utility u=0.002674 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9960863463288208, 'loss_val': 0.035849062589391995, 'psi': 0.9960466944845322}-{'f1_val': 0.9956047769386365, 'auprc': 0.9957981898736492, 'loss_val': 0.03783955150333297, 'psi': 0.9956821421126416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=37 head_norm_before_train=1.458023 cos_to_last_merge=0.9200 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9846492620121161, 'auprc': 0.9980384883455506, 'loss_val': 0.05747366428602341, 'psi': 0.9900049525454899}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981194954317814, 'loss_val': 0.05081923432117745, 'psi': 0.9971760008808663}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.278074 cos_to_last_merge=0.8567 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.857
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5690788808497333, 'auprc': 0.6973196284712755, 'loss_val': 0.9143707572633784, 'psi': 0.6203751798983502}-{'f1_val': 0.6070733168977948, 'auprc': 0.6808421256360426, 'loss_val': 0.7586658344621058, 'psi': 0.6365808403930939}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.962048 cos_to_last_merge=0.9529 (last merge round=14)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9362941192668763, 'auprc': 0.9974805655331145, 'loss_val': 0.09108169493066723, 'psi': 0.9607686977733716}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971215034969403, 'loss_val': 0.026630789918817552, 'psi': 0.9975403121791071}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.608536 cos_to_last_merge=0.9210 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.6926700176597411, 'auprc': 0.7261778856528471, 'loss_val': 0.6551596681866763, 'psi': 0.7060731648569836}-{'f1_val': 0.98457620085201, 'auprc': 0.9965352153671677, 'loss_val': 0.09181021044915458, 'psi': 0.9893598066580731}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.987988 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8833529913562923, 'auprc': 0.9949994547134795, 'loss_val': 0.22477467228797754, 'psi': 0.9280115766991672}-{'f1_val': 0.9927343791035232, 'auprc': 0.9951696470826525, 'loss_val': 0.034071820083761584, 'psi': 0.9937084862951749}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.405031 cos_to_last_merge=0.9447 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=37 local utility u=1.000000 metrics={'f1_val': 0.6333493180025737, 'auprc': 0.8887829686591724, 'loss_val': 0.5738199771105402, 'psi': 0.7355227782652132}-{'f1_val': 0.4178281137151801, 'auprc': 0.7123989507704387, 'loss_val': 0.9597238831435904, 'psi': 0.5356564485372834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=38 head_norm_before_train=1.892265 cos_to_last_merge=0.9756 (last merge round=12)
[S2] round=38 local utility u=0.022572 metrics={'f1_val': 0.7106535382942606, 'auprc': 0.7881567607552193, 'loss_val': 0.6194959039884792, 'psi': 0.7416548272786441}-{'f1_val': 0.7119885744627701, 'auprc': 0.7779647511440424, 'loss_val': 0.6420749998932826, 'psi': 0.738379045135279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=38 head_norm_before_train=1.836000 cos_to_last_merge=0.7772 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.777
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9215028719502446, 'auprc': 0.9998230930153164, 'loss_val': 0.1726997658720043, 'psi': 0.9528309603762732}-{'f1_val': 0.9605438728991138, 'auprc': 0.9999745994587894, 'loss_val': 0.13762918522387393, 'psi': 0.976316163522984}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.519020 cos_to_last_merge=0.9490 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.949
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9447224382050808, 'auprc': 0.9530968114714178, 'loss_val': 0.2863282036280222, 'psi': 0.9480721875116156}-{'f1_val': 0.9466592132598587, 'auprc': 0.9532244227423494, 'loss_val': 0.2767680684488902, 'psi': 0.949285297052855}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.304114 cos_to_last_merge=0.8518 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=38 local utility u=0.011626 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9919232354588969, 'loss_val': 0.08840020845101318, 'psi': 0.9943063943202893}-{'f1_val': 0.995895166894551, 'auprc': 0.9892896027876477, 'loss_val': 0.10375230561140225, 'psi': 0.9932529412517896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=38 head_norm_before_train=1.377964 cos_to_last_merge=0.8897 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.6873877594320756, 'auprc': 0.9447253019157371, 'loss_val': 0.6382101666552374, 'psi': 0.7903227764255403}-{'f1_val': 0.7423419406702487, 'auprc': 0.9379156153054089, 'loss_val': 0.5838197247603344, 'psi': 0.8205714105243128}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=38 head_norm_before_train=1.522879 cos_to_last_merge=0.9404 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6320481407207705, 'auprc': 0.798844301637164, 'loss_val': 0.6247781751241053, 'psi': 0.698766605087328}-{'f1_val': 0.627903274583193, 'auprc': 0.7964743773469242, 'loss_val': 0.5882361835921188, 'psi': 0.6953317156886855}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.755280 cos_to_last_merge=0.9461 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.946
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9837298055796642, 'auprc': 0.9986895094076506, 'loss_val': 0.05090608444142447, 'psi': 0.9897136871108587}-{'f1_val': 0.9931648515513533, 'auprc': 0.9902788351813033, 'loss_val': 0.04437433220748362, 'psi': 0.9920104450033334}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=2.058727 cos_to_last_merge=0.9695 (last merge round=14)
[S9] round=38 local utility u=0.005978 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9967634052197938, 'loss_val': 0.02096497248546329, 'psi': 0.99655147348825}-{'f1_val': 0.9964101856672208, 'auprc': 0.9928906548005582, 'loss_val': 0.021301819536212383, 'psi': 0.9950023733205557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=38 head_norm_before_train=1.728061 cos_to_last_merge=0.9503 (last merge round=13)
[S10] round=38 local utility u=0.000065 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9957454743662659, 'loss_val': 0.034697038850929084, 'psi': 0.9959103456995102}-{'f1_val': 0.9960202599216732, 'auprc': 0.9960863463288208, 'loss_val': 0.035849062589391995, 'psi': 0.9960466944845322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=38 head_norm_before_train=1.475794 cos_to_last_merge=0.9173 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.917
[S11] round=38 local utility u=0.032023 metrics={'f1_val': 0.9940327724445256, 'auprc': 0.998044827006566, 'loss_val': 0.04974759340107027, 'psi': 0.9956375942693418}-{'f1_val': 0.9846492620121161, 'auprc': 0.9980384883455506, 'loss_val': 0.05747366428602341, 'psi': 0.9900049525454899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=38 head_norm_before_train=1.285657 cos_to_last_merge=0.8544 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=38 local utility u=0.203588 metrics={'f1_val': 0.6138354759163079, 'auprc': 0.681814770634397, 'loss_val': 0.7292202615992648, 'psi': 0.6410271938035436}-{'f1_val': 0.5690788808497333, 'auprc': 0.6973196284712755, 'loss_val': 0.9143707572633784, 'psi': 0.6203751798983502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=38 head_norm_before_train=1.975405 cos_to_last_merge=0.9518 (last merge round=14)
[S14] round=38 local utility u=0.216920 metrics={'f1_val': 0.9969916776501764, 'auprc': 0.9992116708877936, 'loss_val': 0.026619618693116853, 'psi': 0.9978796749452232}-{'f1_val': 0.9362941192668763, 'auprc': 0.9974805655331145, 'loss_val': 0.09108169493066723, 'psi': 0.9607686977733716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=38 head_norm_before_train=1.617450 cos_to_last_merge=0.9204 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=38 local utility u=0.194125 metrics={'f1_val': 0.7031524642804075, 'auprc': 0.8075736073345399, 'loss_val': 0.5739918482195794, 'psi': 0.7449209215020605}-{'f1_val': 0.6926700176597411, 'auprc': 0.7261778856528471, 'loss_val': 0.6551596681866763, 'psi': 0.7060731648569836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=38 head_norm_before_train=1.994809 (no previous merge yet)
[S16] round=38 local utility u=0.423578 metrics={'f1_val': 0.9931511287546804, 'auprc': 0.994808813724537, 'loss_val': 0.035834820838041834, 'psi': 0.993814202742623}-{'f1_val': 0.8833529913562923, 'auprc': 0.9949994547134795, 'loss_val': 0.22477467228797754, 'psi': 0.9280115766991672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=38 head_norm_before_train=1.413461 cos_to_last_merge=0.9430 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.943
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.46694392752513025, 'auprc': 0.7560143159569335, 'loss_val': 0.8257194798422457, 'psi': 0.5825720828978516}-{'f1_val': 0.6333493180025737, 'auprc': 0.8887829686591724, 'loss_val': 0.5738199771105402, 'psi': 0.7355227782652132}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.900015 cos_to_last_merge=0.9749 (last merge round=12)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6860624110609728, 'auprc': 0.7745324830638642, 'loss_val': 0.6274618830717811, 'psi': 0.7214504398621293}-{'f1_val': 0.7106535382942606, 'auprc': 0.7881567607552193, 'loss_val': 0.6194959039884792, 'psi': 0.7416548272786441}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.721 u=0.0000 p_local=0.0988 f1=0.686 auprc=0.775 bytes=39563
[S3] START round=39 head_norm_before_train=1.846548 cos_to_last_merge=0.7764 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=39 local utility u=0.092380 metrics={'f1_val': 0.941901957170469, 'auprc': 0.9997402045220838, 'loss_val': 0.11008592352886384, 'psi': 0.9650372561111149}-{'f1_val': 0.9215028719502446, 'auprc': 0.9998230930153164, 'loss_val': 0.1726997658720043, 'psi': 0.9528309603762732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=40 psi=0.965 u=0.0924 p_local=0.0420 f1=0.942 auprc=1.000 bytes=37745
[S4] START round=39 head_norm_before_train=1.532859 cos_to_last_merge=0.9474 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.947
[S4] round=39 local utility u=0.054242 metrics={'f1_val': 0.947428691621548, 'auprc': 0.9799734228932746, 'loss_val': 0.2747123542415285, 'psi': 0.9604465841302386}-{'f1_val': 0.9447224382050808, 'auprc': 0.9530968114714178, 'loss_val': 0.2863282036280222, 'psi': 0.9480721875116156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S4] r=40 psi=0.960 u=0.0542 p_local=0.0267 f1=0.947 auprc=0.980 bytes=52153
[S5] START round=39 head_norm_before_train=1.319973 cos_to_last_merge=0.8506 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.8366776400079279, 'auprc': 0.9789550692202298, 'loss_val': 0.2236001643295112, 'psi': 0.8935886116928486}-{'f1_val': 0.995895166894551, 'auprc': 0.9919232354588969, 'loss_val': 0.08840020845101318, 'psi': 0.9943063943202893}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.894 u=0.0000 p_local=0.1507 f1=0.837 auprc=0.979 bytes=43135
[S6] START round=39 head_norm_before_train=1.392054 cos_to_last_merge=0.8872 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=39 local utility u=0.626578 metrics={'f1_val': 0.8434807280081289, 'auprc': 0.9569126161932748, 'loss_val': 0.35817393519062773, 'psi': 0.8888534832821873}-{'f1_val': 0.6873877594320756, 'auprc': 0.9447253019157371, 'loss_val': 0.6382101666552374, 'psi': 0.7903227764255403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=40 psi=0.889 u=0.6266 p_local=0.2371 f1=0.843 auprc=0.957 bytes=32345
[S7] START round=39 head_norm_before_train=1.533619 cos_to_last_merge=0.9401 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=39 local utility u=0.259144 metrics={'f1_val': 0.6798155701161254, 'auprc': 0.8169306430755263, 'loss_val': 0.44735298917630567, 'psi': 0.7346615992998857}-{'f1_val': 0.6320481407207705, 'auprc': 0.798844301637164, 'loss_val': 0.6247781751241053, 'psi': 0.698766605087328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=40 psi=0.735 u=0.2591 p_local=0.1677 f1=0.680 auprc=0.817 bytes=41333
[S8] START round=39 head_norm_before_train=1.765621 cos_to_last_merge=0.9451 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.945
[S8] round=39 local utility u=0.025997 metrics={'f1_val': 0.9905756323661, 'auprc': 0.9983879888227702, 'loss_val': 0.03908297070668497, 'psi': 0.9937005749487682}-{'f1_val': 0.9837298055796642, 'auprc': 0.9986895094076506, 'loss_val': 0.05090608444142447, 'psi': 0.9897136871108587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S8] r=40 psi=0.994 u=0.0260 p_local=0.0529 f1=0.991 auprc=0.998 bytes=46754
[S9] START round=39 head_norm_before_train=2.067266 cos_to_last_merge=0.9691 (last merge round=14)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9988571570312793, 'loss_val': 0.04185224831799104, 'psi': 0.9928700024065605}-{'f1_val': 0.9964101856672208, 'auprc': 0.9967634052197938, 'loss_val': 0.02096497248546329, 'psi': 0.99655147348825}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.993 u=0.0000 p_local=0.0088 f1=0.989 auprc=0.999 bytes=46743
[S10] START round=39 head_norm_before_train=1.740246 cos_to_last_merge=0.9491 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9957634421370944, 'loss_val': 0.03464925152518367, 'psi': 0.9951687988644411}-{'f1_val': 0.9960202599216732, 'auprc': 0.9957454743662659, 'loss_val': 0.034697038850929084, 'psi': 0.9959103456995102}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0038 f1=0.995 auprc=0.996 bytes=53836
[S11] START round=39 head_norm_before_train=1.493978 cos_to_last_merge=0.9146 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966409305510397, 'loss_val': 0.06321686361146375, 'psi': 0.9963365771684015}-{'f1_val': 0.9940327724445256, 'auprc': 0.998044827006566, 'loss_val': 0.04974759340107027, 'psi': 0.9956375942693418}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=40 psi=0.996 u=0.0000 p_local=0.0330 f1=0.996 auprc=0.997 bytes=55736
[S13] START round=39 head_norm_before_train=1.294060 cos_to_last_merge=0.8532 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.5376758991576032, 'auprc': 0.7035896271477802, 'loss_val': 1.0038971780489467, 'psi': 0.604041390353674}-{'f1_val': 0.6138354759163079, 'auprc': 0.681814770634397, 'loss_val': 0.7292202615992648, 'psi': 0.6410271938035436}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.604 u=0.0000 p_local=0.0940 f1=0.538 auprc=0.704 bytes=43155
[S14] START round=39 head_norm_before_train=1.987083 cos_to_last_merge=0.9507 (last merge round=14)
[S14] round=39 local utility u=0.001274 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.999207746198725, 'loss_val': 0.022773743608685587, 'psi': 0.9977495630509517}-{'f1_val': 0.9969916776501764, 'auprc': 0.9992116708877936, 'loss_val': 0.026619618693116853, 'psi': 0.9978796749452232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] r=40 psi=0.998 u=0.0013 p_local=0.0423 f1=0.997 auprc=0.999 bytes=55761
[S15] START round=39 head_norm_before_train=1.626343 cos_to_last_merge=0.9193 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9082506882398558, 'auprc': 0.988451313662852, 'loss_val': 0.17011934388409655, 'psi': 0.9403309384090542}-{'f1_val': 0.7031524642804075, 'auprc': 0.8075736073345399, 'loss_val': 0.5739918482195794, 'psi': 0.7449209215020605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] r=40 psi=0.940 u=1.0000 p_local=0.4496 f1=0.908 auprc=0.988 bytes=48429
[S16] START round=39 head_norm_before_train=2.002668 (no previous merge yet)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9299643989255686, 'auprc': 0.9805979513759875, 'loss_val': 0.37484360560591273, 'psi': 0.9502178199057361}-{'f1_val': 0.9931511287546804, 'auprc': 0.994808813724537, 'loss_val': 0.035834820838041834, 'psi': 0.993814202742623}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.950 u=0.0000 p_local=0.1434 f1=0.930 auprc=0.981 bytes=48561
[S17] START round=39 head_norm_before_train=1.420898 cos_to_last_merge=0.9413 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.9011831546638212, 'auprc': 0.8790909279421086, 'loss_val': 0.622002879625426, 'psi': 0.8923462639751361}-{'f1_val': 0.46694392752513025, 'auprc': 0.7560143159569335, 'loss_val': 0.8257194798422457, 'psi': 0.5825720828978516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S17] sending update (kind=head size=1810 to 1 peers)
[S17] r=40 psi=0.892 u=1.0000 p_local=0.5150 f1=0.901 auprc=0.879 bytes=39624
[S2] START round=40 head_norm_before_train=1.909854 cos_to_last_merge=0.9738 (last merge round=12)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6245702110490088, 'auprc': 0.7385249218636777, 'loss_val': 0.8687497614918774, 'psi': 0.6701520953748763}-{'f1_val': 0.6860624110609728, 'auprc': 0.7745324830638642, 'loss_val': 0.6274618830717811, 'psi': 0.7214504398621293}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=1.855994 cos_to_last_merge=0.7757 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.776
[S3] round=40 local utility u=0.071786 metrics={'f1_val': 0.964380700669572, 'auprc': 0.9999781163604561, 'loss_val': 0.10210004513680365, 'psi': 0.9786196669459257}-{'f1_val': 0.941901957170469, 'auprc': 0.9997402045220838, 'loss_val': 0.11008592352886384, 'psi': 0.9650372561111149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=40 head_norm_before_train=1.546190 cos_to_last_merge=0.9459 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9444222944959865, 'auprc': 0.9794800321098012, 'loss_val': 0.28641638250908413, 'psi': 0.9584453895415124}-{'f1_val': 0.947428691621548, 'auprc': 0.9799734228932746, 'loss_val': 0.2747123542415285, 'psi': 0.9604465841302386}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.336719 cos_to_last_merge=0.8491 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=40 local utility u=0.566702 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9896810519094745, 'loss_val': 0.07768024766575854, 'psi': 0.9934095209005204}-{'f1_val': 0.8366776400079279, 'auprc': 0.9789550692202298, 'loss_val': 0.2236001643295112, 'psi': 0.8935886116928486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=40 head_norm_before_train=1.407260 cos_to_last_merge=0.8846 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=40 local utility u=0.017716 metrics={'f1_val': 0.8448610638961053, 'auprc': 0.9552953879916519, 'loss_val': 0.3261723698396746, 'psi': 0.8890347935343239}-{'f1_val': 0.8434807280081289, 'auprc': 0.9569126161932748, 'loss_val': 0.35817393519062773, 'psi': 0.8888534832821873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=40 head_norm_before_train=1.540674 cos_to_last_merge=0.9396 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5531303829845882, 'auprc': 0.7865357186049481, 'loss_val': 0.8653996863838207, 'psi': 0.6464925172327322}-{'f1_val': 0.6798155701161254, 'auprc': 0.8169306430755263, 'loss_val': 0.44735298917630567, 'psi': 0.7346615992998857}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.775157 cos_to_last_merge=0.9439 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=40 local utility u=0.005133 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9983721271330769, 'loss_val': 0.037483094212306424, 'psi': 0.994565556955182}-{'f1_val': 0.9905756323661, 'auprc': 0.9983879888227702, 'loss_val': 0.03908297070668497, 'psi': 0.9937005749487682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=40 head_norm_before_train=2.074005 cos_to_last_merge=0.9686 (last merge round=14)
[S9] round=40 local utility u=0.024845 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9927771365776054, 'loss_val': 0.020613031895233315, 'psi': 0.995107161719377}-{'f1_val': 0.9888785659900814, 'auprc': 0.9988571570312793, 'loss_val': 0.04185224831799104, 'psi': 0.9928700024065605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=40 head_norm_before_train=1.751804 cos_to_last_merge=0.9481 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=40 local utility u=0.001361 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957681074177798, 'loss_val': 0.034433520802903524, 'psi': 0.9954199463787368}-{'f1_val': 0.9947723700160056, 'auprc': 0.9957634421370944, 'loss_val': 0.03464925152518367, 'psi': 0.9951687988644411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=40 head_norm_before_train=1.510270 cos_to_last_merge=0.9122 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9967341627249648, 'loss_val': 0.08675101818382944, 'psi': 0.9965188972354364}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966409305510397, 'loss_val': 0.06321686361146375, 'psi': 0.9963365771684015}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.299947 cos_to_last_merge=0.8509 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=40 local utility u=0.137084 metrics={'f1_val': 0.5501868692671378, 'auprc': 0.69127819484035, 'loss_val': 0.7678602035251139, 'psi': 0.6066233994964226}-{'f1_val': 0.5376758991576032, 'auprc': 0.7035896271477802, 'loss_val': 1.0038971780489467, 'psi': 0.604041390353674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=1.993250 cos_to_last_merge=0.9500 (last merge round=14)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9971680177638609, 'auprc': 0.9970517459038852, 'loss_val': 0.023614992532969302, 'psi': 0.9971215090198706}-{'f1_val': 0.9967774409524363, 'auprc': 0.999207746198725, 'loss_val': 0.022773743608685587, 'psi': 0.9977495630509517}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.634987 cos_to_last_merge=0.9182 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7464273327143047, 'auprc': 0.7585239900192698, 'loss_val': 0.5306757489940914, 'psi': 0.7512659956362908}-{'f1_val': 0.9082506882398558, 'auprc': 0.988451313662852, 'loss_val': 0.17011934388409655, 'psi': 0.9403309384090542}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.008498 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8743458879383095, 'auprc': 0.928802053510805, 'loss_val': 0.6622748151089738, 'psi': 0.8961283541673077}-{'f1_val': 0.9299643989255686, 'auprc': 0.9805979513759875, 'loss_val': 0.37484360560591273, 'psi': 0.9502178199057361}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.428976 cos_to_last_merge=0.9388 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=40 local utility u=0.193598 metrics={'f1_val': 0.9324590629072501, 'auprc': 0.902458305126147, 'loss_val': 0.4925640737357141, 'psi': 0.9204587597948088}-{'f1_val': 0.9011831546638212, 'auprc': 0.8790909279421086, 'loss_val': 0.622002879625426, 'psi': 0.8923462639751361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S17] sending update (kind=head size=1807 to 1 peers)
[S2] START round=41 head_norm_before_train=1.919461 cos_to_last_merge=0.9727 (last merge round=12)
[S2] round=41 local utility u=0.324699 metrics={'f1_val': 0.6938762314866833, 'auprc': 0.7650779691729659, 'loss_val': 0.714846253971823, 'psi': 0.7223569265611963}-{'f1_val': 0.6245702110490088, 'auprc': 0.7385249218636777, 'loss_val': 0.8687497614918774, 'psi': 0.6701520953748763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=1.866269 cos_to_last_merge=0.7751 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.775
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9317164159106937, 'auprc': 0.9997764576622616, 'loss_val': 0.1928337613080929, 'psi': 0.9589404326113209}-{'f1_val': 0.964380700669572, 'auprc': 0.9999781163604561, 'loss_val': 0.10210004513680365, 'psi': 0.9786196669459257}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.556192 cos_to_last_merge=0.9448 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9407925000984088, 'auprc': 0.9682902572598511, 'loss_val': 0.2883823195290714, 'psi': 0.9517916029629857}-{'f1_val': 0.9444222944959865, 'auprc': 0.9794800321098012, 'loss_val': 0.28641638250908413, 'psi': 0.9584453895415124}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.354637 cos_to_last_merge=0.8475 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=41 local utility u=0.004687 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9916252408757226, 'loss_val': 0.07413877739015348, 'psi': 0.9941871964870196}-{'f1_val': 0.995895166894551, 'auprc': 0.9896810519094745, 'loss_val': 0.07768024766575854, 'psi': 0.9934095209005204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=41 head_norm_before_train=1.419881 cos_to_last_merge=0.8823 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=41 local utility u=0.031524 metrics={'f1_val': 0.8443950800107646, 'auprc': 0.9576968430782149, 'loss_val': 0.26753284593879084, 'psi': 0.8897157852377446}-{'f1_val': 0.8448610638961053, 'auprc': 0.9552953879916519, 'loss_val': 0.3261723698396746, 'psi': 0.8890347935343239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=41 head_norm_before_train=1.543895 cos_to_last_merge=0.9391 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=41 local utility u=0.817230 metrics={'f1_val': 0.6928776024531189, 'auprc': 0.8654559564756314, 'loss_val': 0.3061839491708294, 'psi': 0.7619089440621238}-{'f1_val': 0.5531303829845882, 'auprc': 0.7865357186049481, 'loss_val': 0.8653996863838207, 'psi': 0.6464925172327322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=41 head_norm_before_train=1.783242 cos_to_last_merge=0.9432 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9847869053219069, 'auprc': 0.9986984183833659, 'loss_val': 0.04837473151723284, 'psi': 0.9903515105464906}-{'f1_val': 0.992027843503252, 'auprc': 0.9983721271330769, 'loss_val': 0.037483094212306424, 'psi': 0.994565556955182}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.080825 cos_to_last_merge=0.9678 (last merge round=14)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9926491389884026, 'loss_val': 0.020601036057613334, 'psi': 0.9950559626836959}-{'f1_val': 0.9966605118138915, 'auprc': 0.9927771365776054, 'loss_val': 0.020613031895233315, 'psi': 0.995107161719377}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.761630 cos_to_last_merge=0.9473 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=41 local utility u=0.001399 metrics={'f1_val': 0.9956047769386365, 'auprc': 0.9954883669309281, 'loss_val': 0.03329753833386278, 'psi': 0.9955582129355531}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957681074177798, 'loss_val': 0.034433520802903524, 'psi': 0.9954199463787368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=41 head_norm_before_train=1.526040 cos_to_last_merge=0.9101 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=41 local utility u=0.025108 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996594577930909, 'loss_val': 0.037145489186662384, 'psi': 0.9965660338805173}-{'f1_val': 0.9963753869090841, 'auprc': 0.9967341627249648, 'loss_val': 0.08675101818382944, 'psi': 0.9965188972354364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=41 head_norm_before_train=1.303623 cos_to_last_merge=0.8490 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.564471009247413, 'auprc': 0.6586675793478711, 'loss_val': 0.795226977244331, 'psi': 0.6021496372875963}-{'f1_val': 0.5501868692671378, 'auprc': 0.69127819484035, 'loss_val': 0.7678602035251139, 'psi': 0.6066233994964226}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.997198 cos_to_last_merge=0.9495 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9969977298524753, 'loss_val': 0.023929150103668268, 'psi': 0.996851810933209}-{'f1_val': 0.9971680177638609, 'auprc': 0.9970517459038852, 'loss_val': 0.023614992532969302, 'psi': 0.9971215090198706}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.644811 cos_to_last_merge=0.9171 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=41 local utility u=0.632537 metrics={'f1_val': 0.813494600533067, 'auprc': 0.9674828502838891, 'loss_val': 0.29488169777349044, 'psi': 0.8750899004333959}-{'f1_val': 0.7464273327143047, 'auprc': 0.7585239900192698, 'loss_val': 0.5306757489940914, 'psi': 0.7512659956362908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=41 head_norm_before_train=2.016557 (no previous merge yet)
[S16] round=41 local utility u=0.323042 metrics={'f1_val': 0.9145632432709281, 'auprc': 0.9904248551914441, 'loss_val': 0.4423637971916145, 'psi': 0.9449078880391345}-{'f1_val': 0.8743458879383095, 'auprc': 0.928802053510805, 'loss_val': 0.6622748151089738, 'psi': 0.8961283541673077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=41 head_norm_before_train=1.438147 cos_to_last_merge=0.9361 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.8617535504270694, 'auprc': 0.8688583588422568, 'loss_val': 0.6490899086532332, 'psi': 0.8645954737931444}-{'f1_val': 0.9324590629072501, 'auprc': 0.902458305126147, 'loss_val': 0.4925640737357141, 'psi': 0.9204587597948088}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.929363 cos_to_last_merge=0.9716 (last merge round=12)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6908378351382327, 'auprc': 0.7683944683053232, 'loss_val': 0.7532739920009245, 'psi': 0.721860488405069}-{'f1_val': 0.6938762314866833, 'auprc': 0.7650779691729659, 'loss_val': 0.714846253971823, 'psi': 0.7223569265611963}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.877038 cos_to_last_merge=0.7745 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.774
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8862390875701508, 'auprc': 0.9996335016198068, 'loss_val': 0.17954749108535462, 'psi': 0.9315968531900132}-{'f1_val': 0.9317164159106937, 'auprc': 0.9997764576622616, 'loss_val': 0.1928337613080929, 'psi': 0.9589404326113209}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.563515 cos_to_last_merge=0.9437 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.944
[S4] round=42 local utility u=0.015758 metrics={'f1_val': 0.9528938455878968, 'auprc': 0.9533328608275458, 'loss_val': 0.2846026321216941, 'psi': 0.9530694516837563}-{'f1_val': 0.9407925000984088, 'auprc': 0.9682902572598511, 'loss_val': 0.2883823195290714, 'psi': 0.9517916029629857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=42 head_norm_before_train=1.370301 cos_to_last_merge=0.8461 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.989639069012023, 'loss_val': 0.075763836902417, 'psi': 0.9933927277415397}-{'f1_val': 0.995895166894551, 'auprc': 0.9916252408757226, 'loss_val': 0.07413877739015348, 'psi': 0.9941871964870196}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.433854 cos_to_last_merge=0.8798 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7195627650775214, 'auprc': 0.9058775561804638, 'loss_val': 0.6111616197020334, 'psi': 0.7940886815186983}-{'f1_val': 0.8443950800107646, 'auprc': 0.9576968430782149, 'loss_val': 0.26753284593879084, 'psi': 0.8897157852377446}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.546084 cos_to_last_merge=0.9384 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.5804615191654332, 'auprc': 0.7894997641531177, 'loss_val': 0.7708230074817876, 'psi': 0.664076817160507}-{'f1_val': 0.6928776024531189, 'auprc': 0.8654559564756314, 'loss_val': 0.3061839491708294, 'psi': 0.7619089440621238}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.792295 cos_to_last_merge=0.9426 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=42 local utility u=0.026730 metrics={'f1_val': 0.992027843503252, 'auprc': 0.9982853660746743, 'loss_val': 0.03712169977379158, 'psi': 0.9945308525318209}-{'f1_val': 0.9847869053219069, 'auprc': 0.9986984183833659, 'loss_val': 0.04837473151723284, 'psi': 0.9903515105464906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=42 head_norm_before_train=2.088140 cos_to_last_merge=0.9673 (last merge round=14)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9988076442120254, 'loss_val': 0.03220878367239967, 'psi': 0.993854180893406}-{'f1_val': 0.9966605118138915, 'auprc': 0.9926491389884026, 'loss_val': 0.020601036057613334, 'psi': 0.9950559626836959}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.769481 cos_to_last_merge=0.9467 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=42 local utility u=0.002893 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9961035301560569, 'loss_val': 0.03185028029544006, 'psi': 0.9960535680154267}-{'f1_val': 0.9956047769386365, 'auprc': 0.9954883669309281, 'loss_val': 0.03329753833386278, 'psi': 0.9955582129355531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=42 head_norm_before_train=1.541180 cos_to_last_merge=0.9082 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=42 local utility u=0.002539 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974406124711893, 'loss_val': 0.03460654972784746, 'psi': 0.9969044476966294}-{'f1_val': 0.9965470045135896, 'auprc': 0.996594577930909, 'loss_val': 0.037145489186662384, 'psi': 0.9965660338805173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=42 head_norm_before_train=1.309830 cos_to_last_merge=0.8476 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.848
[S13] round=42 local utility u=0.011106 metrics={'f1_val': 0.5592640426246572, 'auprc': 0.6998028790707248, 'loss_val': 0.8651797511081429, 'psi': 0.6154795772030843}-{'f1_val': 0.564471009247413, 'auprc': 0.6586675793478711, 'loss_val': 0.795226977244331, 'psi': 0.6021496372875963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=2.004156 cos_to_last_merge=0.9488 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.949
[S14] round=42 local utility u=0.000798 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969407686393839, 'loss_val': 0.024626885117748597, 'psi': 0.9970754832544086}-{'f1_val': 0.996754531653698, 'auprc': 0.9969977298524753, 'loss_val': 0.023929150103668268, 'psi': 0.996851810933209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=42 head_norm_before_train=1.658716 cos_to_last_merge=0.9155 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7849271932270472, 'auprc': 0.9543629250577486, 'loss_val': 0.3520114431959455, 'psi': 0.8527014859593277}-{'f1_val': 0.813494600533067, 'auprc': 0.9674828502838891, 'loss_val': 0.29488169777349044, 'psi': 0.8750899004333959}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=2.022884 (no previous merge yet)
[S16] round=42 local utility u=0.161161 metrics={'f1_val': 0.9383913566790854, 'auprc': 0.9950264146154091, 'loss_val': 0.2768154058898057, 'psi': 0.9610453798536148}-{'f1_val': 0.9145632432709281, 'auprc': 0.9904248551914441, 'loss_val': 0.4423637971916145, 'psi': 0.9449078880391345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=42 head_norm_before_train=1.452435 cos_to_last_merge=0.9337 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=42 local utility u=0.271432 metrics={'f1_val': 0.8756092945941586, 'auprc': 0.9414163002557375, 'loss_val': 0.40703401407201895, 'psi': 0.9019320968587901}-{'f1_val': 0.8617535504270694, 'auprc': 0.8688583588422568, 'loss_val': 0.6490899086532332, 'psi': 0.8645954737931444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=43 head_norm_before_train=1.939377 cos_to_last_merge=0.9706 (last merge round=12)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6891909413671964, 'auprc': 0.7486223412120063, 'loss_val': 0.8157842783870425, 'psi': 0.7129635013051203}-{'f1_val': 0.6908378351382327, 'auprc': 0.7683944683053232, 'loss_val': 0.7532739920009245, 'psi': 0.721860488405069}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.885924 cos_to_last_merge=0.7738 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.774
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.7288887174848397, 'auprc': 0.9995710370200401, 'loss_val': 0.42649138468979647, 'psi': 0.8371616452989199}-{'f1_val': 0.8862390875701508, 'auprc': 0.9996335016198068, 'loss_val': 0.17954749108535462, 'psi': 0.9315968531900132}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.570961 cos_to_last_merge=0.9428 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9435664373134677, 'auprc': 0.9441663045994839, 'loss_val': 0.29695183214849635, 'psi': 0.9438063842278741}-{'f1_val': 0.9528938455878968, 'auprc': 0.9533328608275458, 'loss_val': 0.2846026321216941, 'psi': 0.9530694516837563}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.383709 cos_to_last_merge=0.8448 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=43 local utility u=0.005018 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9904305613512213, 'loss_val': 0.06634536965414109, 'psi': 0.9935337045651595}-{'f1_val': 0.995895166894551, 'auprc': 0.989639069012023, 'loss_val': 0.075763836902417, 'psi': 0.9933927277415397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=43 head_norm_before_train=1.444504 cos_to_last_merge=0.8780 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=43 local utility u=0.889100 metrics={'f1_val': 0.933894935504479, 'auprc': 0.9472403686015323, 'loss_val': 0.24304278687493164, 'psi': 0.9392331087433003}-{'f1_val': 0.7195627650775214, 'auprc': 0.9058775561804638, 'loss_val': 0.6111616197020334, 'psi': 0.7940886815186983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=43 head_norm_before_train=1.551112 cos_to_last_merge=0.9373 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.937
[S7] round=43 local utility u=0.371135 metrics={'f1_val': 0.6501462149213059, 'auprc': 0.8052630064100199, 'loss_val': 0.49395014042254537, 'psi': 0.7121929315167914}-{'f1_val': 0.5804615191654332, 'auprc': 0.7894997641531177, 'loss_val': 0.7708230074817876, 'psi': 0.664076817160507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=43 head_norm_before_train=1.799364 cos_to_last_merge=0.9425 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.943
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9897367044659179, 'auprc': 0.9983807209520812, 'loss_val': 0.03851405199182023, 'psi': 0.9931943110603831}-{'f1_val': 0.992027843503252, 'auprc': 0.9982853660746743, 'loss_val': 0.03712169977379158, 'psi': 0.9945308525318209}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=43 head_norm_before_train=2.091173 cos_to_last_merge=0.9669 (last merge round=14)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9988076442120253, 'loss_val': 0.03644197749979855, 'psi': 0.9933401625019346}-{'f1_val': 0.9905518720143266, 'auprc': 0.9988076442120254, 'loss_val': 0.03220878367239967, 'psi': 0.993854180893406}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.779650 cos_to_last_merge=0.9459 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=43 local utility u=0.000458 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9961542605517424, 'loss_val': 0.031085775703489176, 'psi': 0.9960738601737009}-{'f1_val': 0.9960202599216732, 'auprc': 0.9961035301560569, 'loss_val': 0.03185028029544006, 'psi': 0.9960535680154267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=43 head_norm_before_train=1.555611 cos_to_last_merge=0.9064 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964671573492354, 'loss_val': 0.0338648560821425, 'psi': 0.9965150656478479}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974406124711893, 'loss_val': 0.03460654972784746, 'psi': 0.9969044476966294}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.318226 cos_to_last_merge=0.8467 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=43 local utility u=0.169270 metrics={'f1_val': 0.6021023002369866, 'auprc': 0.6933024606868206, 'loss_val': 0.7641675082947847, 'psi': 0.6385823644169202}-{'f1_val': 0.5592640426246572, 'auprc': 0.6998028790707248, 'loss_val': 0.8651797511081429, 'psi': 0.6154795772030843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=43 head_norm_before_train=2.012507 cos_to_last_merge=0.9480 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.948
[S14] round=43 local utility u=0.003381 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986781338769647, 'loss_val': 0.02207091511410484, 'psi': 0.9976697584453849}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969407686393839, 'loss_val': 0.024626885117748597, 'psi': 0.9970754832544086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=43 head_norm_before_train=1.672398 cos_to_last_merge=0.9139 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=43 local utility u=0.182745 metrics={'f1_val': 0.8174393340109817, 'auprc': 0.9815389165636489, 'loss_val': 0.2631222639216963, 'psi': 0.8830791670320486}-{'f1_val': 0.7849271932270472, 'auprc': 0.9543629250577486, 'loss_val': 0.3520114431959455, 'psi': 0.8527014859593277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=43 head_norm_before_train=2.028733 (no previous merge yet)
[S16] round=43 local utility u=0.078805 metrics={'f1_val': 0.9431948756402526, 'auprc': 0.9950638738698668, 'loss_val': 0.1481380900091682, 'psi': 0.9639424749320983}-{'f1_val': 0.9383913566790854, 'auprc': 0.9950264146154091, 'loss_val': 0.2768154058898057, 'psi': 0.9610453798536148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=43 head_norm_before_train=1.470477 cos_to_last_merge=0.9296 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=43 local utility u=0.427889 metrics={'f1_val': 0.9722062846622861, 'auprc': 0.9819527347747254, 'loss_val': 0.2524472451885307, 'psi': 0.9761048647072619}-{'f1_val': 0.8756092945941586, 'auprc': 0.9414163002557375, 'loss_val': 0.40703401407201895, 'psi': 0.9019320968587901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=44 head_norm_before_train=1.949712 cos_to_last_merge=0.9697 (last merge round=12)
[S2] round=44 local utility u=0.059054 metrics={'f1_val': 0.7102095691965535, 'auprc': 0.7447974576529471, 'loss_val': 0.8123129525323899, 'psi': 0.724044724579111}-{'f1_val': 0.6891909413671964, 'auprc': 0.7486223412120063, 'loss_val': 0.8157842783870425, 'psi': 0.7129635013051203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=44 head_norm_before_train=1.895296 cos_to_last_merge=0.7732 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=44 local utility u=0.625968 metrics={'f1_val': 0.8978916054139654, 'auprc': 0.9999647978477327, 'loss_val': 0.1897545498483751, 'psi': 0.9387208823874723}-{'f1_val': 0.7288887174848397, 'auprc': 0.9995710370200401, 'loss_val': 0.42649138468979647, 'psi': 0.8371616452989199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=44 head_norm_before_train=1.573826 cos_to_last_merge=0.9416 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.942
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9403310758688785, 'auprc': 0.9398591721509293, 'loss_val': 0.29948372436138987, 'psi': 0.9401423143816989}-{'f1_val': 0.9435664373134677, 'auprc': 0.9441663045994839, 'loss_val': 0.29695183214849635, 'psi': 0.9438063842278741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.394789 cos_to_last_merge=0.8437 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947872962357263, 'auprc': 0.9891928905972225, 'loss_val': 0.08469010050924031, 'psi': 0.9925495339803247}-{'f1_val': 0.9956024667077852, 'auprc': 0.9904305613512213, 'loss_val': 0.06634536965414109, 'psi': 0.9935337045651595}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.454393 cos_to_last_merge=0.8764 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6059319284229346, 'auprc': 0.7664419424974952, 'loss_val': 0.874334609356404, 'psi': 0.6701359340527588}-{'f1_val': 0.933894935504479, 'auprc': 0.9472403686015323, 'loss_val': 0.24304278687493164, 'psi': 0.9392331087433003}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.556658 cos_to_last_merge=0.9363 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5344117207055943, 'auprc': 0.7811275426089623, 'loss_val': 1.0080894313085516, 'psi': 0.6330980494669416}-{'f1_val': 0.6501462149213059, 'auprc': 0.8052630064100199, 'loss_val': 0.49395014042254537, 'psi': 0.7121929315167914}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.809603 cos_to_last_merge=0.9418 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.942
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9924128789852034, 'auprc': 0.9848150018715754, 'loss_val': 0.054506692786123884, 'psi': 0.9893737281397521}-{'f1_val': 0.9897367044659179, 'auprc': 0.9983807209520812, 'loss_val': 0.03851405199182023, 'psi': 0.9931943110603831}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.095582 cos_to_last_merge=0.9664 (last merge round=14)
[S9] round=44 local utility u=0.019130 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9930357705489072, 'loss_val': 0.020195208781192693, 'psi': 0.9949643650871295}-{'f1_val': 0.9896951746952075, 'auprc': 0.9988076442120253, 'loss_val': 0.03644197749979855, 'psi': 0.9933401625019346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=44 head_norm_before_train=1.791099 cos_to_last_merge=0.9450 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956965730640481, 'loss_val': 0.031355193931689805, 'psi': 0.9953913326372441}-{'f1_val': 0.9960202599216732, 'auprc': 0.9961542605517424, 'loss_val': 0.031085775703489176, 'psi': 0.9960738601737009}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.569680 cos_to_last_merge=0.9046 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=44 local utility u=0.002717 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976480462460585, 'loss_val': 0.031973673038180946, 'psi': 0.9969874212065771}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964671573492354, 'loss_val': 0.0338648560821425, 'psi': 0.9965150656478479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=44 head_norm_before_train=1.327796 cos_to_last_merge=0.8458 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5408233789550673, 'auprc': 0.7076840734085776, 'loss_val': 0.9306655292111419, 'psi': 0.6075676567364714}-{'f1_val': 0.6021023002369866, 'auprc': 0.6933024606868206, 'loss_val': 0.7641675082947847, 'psi': 0.6385823644169202}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.021999 cos_to_last_merge=0.9472 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=44 local utility u=0.002441 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9991225705203819, 'loss_val': 0.020854152451432018, 'psi': 0.9980807851969016}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986781338769647, 'loss_val': 0.02207091511410484, 'psi': 0.9976697584453849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=44 head_norm_before_train=1.684155 cos_to_last_merge=0.9127 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.913
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7748414417113076, 'auprc': 0.8608577928346619, 'loss_val': 0.4770249851095305, 'psi': 0.8092479821606493}-{'f1_val': 0.8174393340109817, 'auprc': 0.9815389165636489, 'loss_val': 0.2631222639216963, 'psi': 0.8830791670320486}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=2.035997 (no previous merge yet)
[S16] round=44 local utility u=0.148242 metrics={'f1_val': 0.9801070958705421, 'auprc': 0.9943257096361036, 'loss_val': 0.07091308474348497, 'psi': 0.9857945413767667}-{'f1_val': 0.9431948756402526, 'auprc': 0.9950638738698668, 'loss_val': 0.1481380900091682, 'psi': 0.9639424749320983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=44 head_norm_before_train=1.487901 cos_to_last_merge=0.9261 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.8494607268694702, 'auprc': 0.9346012197228298, 'loss_val': 0.3958100394475477, 'psi': 0.883516924010814}-{'f1_val': 0.9722062846622861, 'auprc': 0.9819527347747254, 'loss_val': 0.2524472451885307, 'psi': 0.9761048647072619}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.958991 cos_to_last_merge=0.9689 (last merge round=12)
[S2] round=45 local utility u=0.015171 metrics={'f1_val': 0.7080379949554196, 'auprc': 0.7512795498006646, 'loss_val': 0.7883885600271715, 'psi': 0.7253346168935176}-{'f1_val': 0.7102095691965535, 'auprc': 0.7447974576529471, 'loss_val': 0.8123129525323899, 'psi': 0.724044724579111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=45 head_norm_before_train=1.904843 cos_to_last_merge=0.7726 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.773
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8003452373115775, 'auprc': 0.9990658105649093, 'loss_val': 0.33581501368038574, 'psi': 0.8798334666129102}-{'f1_val': 0.8978916054139654, 'auprc': 0.9999647978477327, 'loss_val': 0.1897545498483751, 'psi': 0.9387208823874723}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.576010 cos_to_last_merge=0.9404 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=45 local utility u=0.014215 metrics={'f1_val': 0.9413245374664091, 'auprc': 0.9457246408196078, 'loss_val': 0.2946117317030783, 'psi': 0.9430845788076886}-{'f1_val': 0.9403310758688785, 'auprc': 0.9398591721509293, 'loss_val': 0.29948372436138987, 'psi': 0.9401423143816989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=45 head_norm_before_train=1.405104 cos_to_last_merge=0.8425 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=45 local utility u=0.015230 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9897702922289447, 'loss_val': 0.06085253678759033, 'psi': 0.9932695969162489}-{'f1_val': 0.9947872962357263, 'auprc': 0.9891928905972225, 'loss_val': 0.08469010050924031, 'psi': 0.9925495339803247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=45 head_norm_before_train=1.464449 cos_to_last_merge=0.8747 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8962461322324473, 'auprc': 0.9412255140487585, 'loss_val': 0.3057966405915394, 'psi': 0.9142378849589717}-{'f1_val': 0.6059319284229346, 'auprc': 0.7664419424974952, 'loss_val': 0.874334609356404, 'psi': 0.6701359340527588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=45 head_norm_before_train=1.562758 cos_to_last_merge=0.9354 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=45 local utility u=1.000000 metrics={'f1_val': 0.919494256707474, 'auprc': 0.9937844388433809, 'loss_val': 0.16864292999394878, 'psi': 0.9492103295618367}-{'f1_val': 0.5344117207055943, 'auprc': 0.7811275426089623, 'loss_val': 1.0080894313085516, 'psi': 0.6330980494669416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=45 head_norm_before_train=1.818775 cos_to_last_merge=0.9410 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9747509087488849, 'auprc': 0.9987519791944239, 'loss_val': 0.062044047759732115, 'psi': 0.9843513369271004}-{'f1_val': 0.9924128789852034, 'auprc': 0.9848150018715754, 'loss_val': 0.054506692786123884, 'psi': 0.9893737281397521}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.101951 cos_to_last_merge=0.9659 (last merge round=14)
[S9] round=45 local utility u=0.004788 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9982678053191065, 'loss_val': 0.02227366419621533, 'psi': 0.9966529574581514}-{'f1_val': 0.9962500947792776, 'auprc': 0.9930357705489072, 'loss_val': 0.020195208781192693, 'psi': 0.9949643650871295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=45 head_norm_before_train=1.802725 cos_to_last_merge=0.9442 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955917395941491, 'loss_val': 0.03186057180862215, 'psi': 0.9953493992492846}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956965730640481, 'loss_val': 0.031355193931689805, 'psi': 0.9953913326372441}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.582421 cos_to_last_merge=0.9028 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967166358556566, 'loss_val': 0.06177220497654699, 'psi': 0.9963668592902483}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976480462460585, 'loss_val': 0.031973673038180946, 'psi': 0.9969874212065771}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.334474 cos_to_last_merge=0.8438 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=45 local utility u=0.181955 metrics={'f1_val': 0.5747328678604181, 'auprc': 0.6946574795966489, 'loss_val': 0.7311332429898152, 'psi': 0.6227027125549105}-{'f1_val': 0.5408233789550673, 'auprc': 0.7076840734085776, 'loss_val': 0.9306655292111419, 'psi': 0.6075676567364714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=45 head_norm_before_train=2.030520 cos_to_last_merge=0.9470 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9978201519282794, 'auprc': 0.999146914947947, 'loss_val': 0.024790434208496224, 'psi': 0.9983508571361465}-{'f1_val': 0.9973862616479148, 'auprc': 0.9991225705203819, 'loss_val': 0.020854152451432018, 'psi': 0.9980807851969016}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.696368 cos_to_last_merge=0.9114 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=45 local utility u=0.675931 metrics={'f1_val': 0.8835408152322453, 'auprc': 0.990018465516665, 'loss_val': 0.16484222770117535, 'psi': 0.9261318753460132}-{'f1_val': 0.7748414417113076, 'auprc': 0.8608577928346619, 'loss_val': 0.4770249851095305, 'psi': 0.8092479821606493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=45 head_norm_before_train=2.041501 (no previous merge yet)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9503094059695899, 'auprc': 0.9887028884629154, 'loss_val': 0.12563932045546777, 'psi': 0.9656667989669201}-{'f1_val': 0.9801070958705421, 'auprc': 0.9943257096361036, 'loss_val': 0.07091308474348497, 'psi': 0.9857945413767667}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.503964 cos_to_last_merge=0.9235 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=45 local utility u=0.040592 metrics={'f1_val': 0.8524349812827252, 'auprc': 0.9468265415714742, 'loss_val': 0.3691477577964508, 'psi': 0.8901916053982248}-{'f1_val': 0.8494607268694702, 'auprc': 0.9346012197228298, 'loss_val': 0.3958100394475477, 'psi': 0.883516924010814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=46 head_norm_before_train=1.967189 cos_to_last_merge=0.9682 (last merge round=12)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6205864229200422, 'auprc': 0.7493177056313689, 'loss_val': 1.097486206877531, 'psi': 0.6720789360045729}-{'f1_val': 0.7080379949554196, 'auprc': 0.7512795498006646, 'loss_val': 0.7883885600271715, 'psi': 0.7253346168935176}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.911007 cos_to_last_merge=0.7723 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.772
[S3] round=46 local utility u=0.320553 metrics={'f1_val': 0.8840312714000024, 'auprc': 0.9994371849823015, 'loss_val': 0.19793877157035175, 'psi': 0.930193636832922}-{'f1_val': 0.8003452373115775, 'auprc': 0.9990658105649093, 'loss_val': 0.33581501368038574, 'psi': 0.8798334666129102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=46 head_norm_before_train=1.583632 cos_to_last_merge=0.9389 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.939
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9398534438654588, 'auprc': 0.9353404625490662, 'loss_val': 0.30712723525527735, 'psi': 0.9380482513389018}-{'f1_val': 0.9413245374664091, 'auprc': 0.9457246408196078, 'loss_val': 0.2946117317030783, 'psi': 0.9430845788076886}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.416951 cos_to_last_merge=0.8410 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.8292306825571956, 'auprc': 0.9855392972414356, 'loss_val': 0.23747981115896405, 'psi': 0.8917541284308916}-{'f1_val': 0.9956024667077852, 'auprc': 0.9897702922289447, 'loss_val': 0.06085253678759033, 'psi': 0.9932695969162489}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.473382 cos_to_last_merge=0.8731 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.8256995856322789, 'auprc': 0.9445020074292234, 'loss_val': 0.43808188030549505, 'psi': 0.8732205543510567}-{'f1_val': 0.8962461322324473, 'auprc': 0.9412255140487585, 'loss_val': 0.3057966405915394, 'psi': 0.9142378849589717}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.566598 cos_to_last_merge=0.9347 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.49383492593349754, 'auprc': 0.7800609138837765, 'loss_val': 1.04213592601664, 'psi': 0.6083253211136092}-{'f1_val': 0.919494256707474, 'auprc': 0.9937844388433809, 'loss_val': 0.16864292999394878, 'psi': 0.9492103295618367}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.827229 cos_to_last_merge=0.9400 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.940
[S8] round=46 local utility u=0.052974 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.9987735174927296, 'loss_val': 0.039049718388496794, 'psi': 0.9926488249644834}-{'f1_val': 0.9747509087488849, 'auprc': 0.9987519791944239, 'loss_val': 0.062044047759732115, 'psi': 0.9843513369271004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=46 head_norm_before_train=2.107848 cos_to_last_merge=0.9659 (last merge round=14)
[S9] round=46 local utility u=0.001810 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9988084799242892, 'loss_val': 0.02027610407547646, 'psi': 0.9968692273002244}-{'f1_val': 0.9955763922175147, 'auprc': 0.9982678053191065, 'loss_val': 0.02227366419621533, 'psi': 0.9966529574581514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=46 head_norm_before_train=1.812896 cos_to_last_merge=0.9435 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=46 local utility u=0.000320 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955859601186374, 'loss_val': 0.03120245963928217, 'psi': 0.9953470874590797}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955917395941491, 'loss_val': 0.03186057180862215, 'psi': 0.9953493992492846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=46 head_norm_before_train=1.594723 cos_to_last_merge=0.9011 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9565559448861061, 'auprc': 0.9966406557209104, 'loss_val': 0.09775278564060623, 'psi': 0.9725898292200279}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967166358556566, 'loss_val': 0.06177220497654699, 'psi': 0.9963668592902483}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.341730 cos_to_last_merge=0.8418 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.5720879393006157, 'auprc': 0.6881250749784253, 'loss_val': 0.7844030113095329, 'psi': 0.6185027935717395}-{'f1_val': 0.5747328678604181, 'auprc': 0.6946574795966489, 'loss_val': 0.7311332429898152, 'psi': 0.6227027125549105}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.040470 cos_to_last_merge=0.9466 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=46 local utility u=0.000052 metrics={'f1_val': 0.9978201519282794, 'auprc': 0.9991357964836051, 'loss_val': 0.024653192096679308, 'psi': 0.9983464097504097}-{'f1_val': 0.9978201519282794, 'auprc': 0.999146914947947, 'loss_val': 0.024790434208496224, 'psi': 0.9983508571361465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=46 head_norm_before_train=1.705621 cos_to_last_merge=0.9106 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.911
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.6968658138325746, 'auprc': 0.7254276089009399, 'loss_val': 0.6884606643948339, 'psi': 0.7082905318599207}-{'f1_val': 0.8835408152322453, 'auprc': 0.990018465516665, 'loss_val': 0.16484222770117535, 'psi': 0.9261318753460132}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=2.047657 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9412765010599795, 'auprc': 0.9838971604628045, 'loss_val': 0.2545896747846088, 'psi': 0.9583247648211095}-{'f1_val': 0.9503094059695899, 'auprc': 0.9887028884629154, 'loss_val': 0.12563932045546777, 'psi': 0.9656667989669201}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.519685 cos_to_last_merge=0.9213 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.7955242773732429, 'auprc': 0.8691146774073584, 'loss_val': 0.7126993623867295, 'psi': 0.8249604373868891}-{'f1_val': 0.8524349812827252, 'auprc': 0.9468265415714742, 'loss_val': 0.3691477577964508, 'psi': 0.8901916053982248}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.976372 cos_to_last_merge=0.9673 (last merge round=12)
[S2] round=47 local utility u=0.241605 metrics={'f1_val': 0.6583372009610158, 'auprc': 0.7590725016878532, 'loss_val': 0.8700461391841687, 'psi': 0.6986313212517508}-{'f1_val': 0.6205864229200422, 'auprc': 0.7493177056313689, 'loss_val': 1.097486206877531, 'psi': 0.6720789360045729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=47 head_norm_before_train=1.918607 cos_to_last_merge=0.7719 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.772
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8310907898229882, 'auprc': 0.9989505300834802, 'loss_val': 0.2883957754286242, 'psi': 0.898234685927185}-{'f1_val': 0.8840312714000024, 'auprc': 0.9994371849823015, 'loss_val': 0.19793877157035175, 'psi': 0.930193636832922}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.590470 cos_to_last_merge=0.9371 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.937
[S4] round=47 local utility u=0.015582 metrics={'f1_val': 0.9406028493373525, 'auprc': 0.9433133377985674, 'loss_val': 0.30437788654655445, 'psi': 0.9416870447218385}-{'f1_val': 0.9398534438654588, 'auprc': 0.9353404625490662, 'loss_val': 0.30712723525527735, 'psi': 0.9380482513389018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=47 head_norm_before_train=1.429036 cos_to_last_merge=0.8395 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=47 local utility u=0.596335 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9896898699928336, 'loss_val': 0.057248334176524515, 'psi': 0.993413048133864}-{'f1_val': 0.8292306825571956, 'auprc': 0.9855392972414356, 'loss_val': 0.23747981115896405, 'psi': 0.8917541284308916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=47 head_norm_before_train=1.481220 cos_to_last_merge=0.8717 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=47 local utility u=0.045149 metrics={'f1_val': 0.8274810645534317, 'auprc': 0.9489155275846181, 'loss_val': 0.37171234741693415, 'psi': 0.8760548497659062}-{'f1_val': 0.8256995856322789, 'auprc': 0.9445020074292234, 'loss_val': 0.43808188030549505, 'psi': 0.8732205543510567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=47 head_norm_before_train=1.568468 cos_to_last_merge=0.9346 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=47 local utility u=1.000000 metrics={'f1_val': 0.697826374775073, 'auprc': 0.8790728420308647, 'loss_val': 0.2852487866622411, 'psi': 0.7703249616773897}-{'f1_val': 0.49383492593349754, 'auprc': 0.7800609138837765, 'loss_val': 1.04213592601664, 'psi': 0.6083253211136092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=47 head_norm_before_train=1.834854 cos_to_last_merge=0.9390 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.939
[S8] round=47 local utility u=0.013124 metrics={'f1_val': 0.9923743275210639, 'auprc': 0.9982261054494341, 'loss_val': 0.03401115019219025, 'psi': 0.994715038692412}-{'f1_val': 0.9885656966123193, 'auprc': 0.9987735174927296, 'loss_val': 0.039049718388496794, 'psi': 0.9926488249644834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=47 head_norm_before_train=2.112831 cos_to_last_merge=0.9657 (last merge round=14)
[S9] round=47 local utility u=0.006755 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995461074770003, 'loss_val': 0.018137650505693267, 'psi': 0.9980801904980858}-{'f1_val': 0.9955763922175147, 'auprc': 0.9988084799242892, 'loss_val': 0.02027610407547646, 'psi': 0.9968692273002244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=47 head_norm_before_train=1.818685 cos_to_last_merge=0.9430 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=47 local utility u=0.002035 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9956919899199976, 'loss_val': 0.029982193156719895, 'psi': 0.995642588077011}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955859601186374, 'loss_val': 0.03120245963928217, 'psi': 0.9953470874590797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=47 head_norm_before_train=1.606959 cos_to_last_merge=0.8995 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.8680996890290862, 'auprc': 0.9966204561697503, 'loss_val': 0.1527910897182518, 'psi': 0.9195079958853518}-{'f1_val': 0.9565559448861061, 'auprc': 0.9966406557209104, 'loss_val': 0.09775278564060623, 'psi': 0.9725898292200279}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.347880 cos_to_last_merge=0.8407 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.841
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5682205054262113, 'auprc': 0.7045783444907316, 'loss_val': 0.8565516675080092, 'psi': 0.6227636410520194}-{'f1_val': 0.5720879393006157, 'auprc': 0.6881250749784253, 'loss_val': 0.7844030113095329, 'psi': 0.6185027935717395}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.051354 cos_to_last_merge=0.9460 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9842865549364627, 'auprc': 0.999012104962347, 'loss_val': 0.03907293837294452, 'psi': 0.9901767749468164}-{'f1_val': 0.9978201519282794, 'auprc': 0.9991357964836051, 'loss_val': 0.024653192096679308, 'psi': 0.9983464097504097}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.714369 cos_to_last_merge=0.9101 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=47 local utility u=1.000000 metrics={'f1_val': 0.9890915335426116, 'auprc': 0.9923902935604951, 'loss_val': 0.0688972273214911, 'psi': 0.990411037549765}-{'f1_val': 0.6968658138325746, 'auprc': 0.7254276089009399, 'loss_val': 0.6884606643948339, 'psi': 0.7082905318599207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=47 head_norm_before_train=2.055167 (no previous merge yet)
[S16] round=47 local utility u=0.055121 metrics={'f1_val': 0.9439903310926671, 'auprc': 0.9878642901050164, 'loss_val': 0.17253193469653982, 'psi': 0.9615399146976069}-{'f1_val': 0.9412765010599795, 'auprc': 0.9838971604628045, 'loss_val': 0.2545896747846088, 'psi': 0.9583247648211095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=47 head_norm_before_train=1.533122 cos_to_last_merge=0.9199 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=47 local utility u=0.144729 metrics={'f1_val': 0.8229153530541061, 'auprc': 0.8803508372398521, 'loss_val': 0.6212959476068649, 'psi': 0.8458895467284046}-{'f1_val': 0.7955242773732429, 'auprc': 0.8691146774073584, 'loss_val': 0.7126993623867295, 'psi': 0.8249604373868891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=48 head_norm_before_train=1.984088 cos_to_last_merge=0.9665 (last merge round=12)
[S2] round=48 local utility u=0.218542 metrics={'f1_val': 0.7195439638879944, 'auprc': 0.7555761164367217, 'loss_val': 0.789714461102265, 'psi': 0.7339568249074853}-{'f1_val': 0.6583372009610158, 'auprc': 0.7590725016878532, 'loss_val': 0.8700461391841687, 'psi': 0.6986313212517508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=48 head_norm_before_train=1.926675 cos_to_last_merge=0.7714 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.6469584701057274, 'auprc': 0.9984197388319663, 'loss_val': 0.8763799043302525, 'psi': 0.787542977596223}-{'f1_val': 0.8310907898229882, 'auprc': 0.9989505300834802, 'loss_val': 0.2883957754286242, 'psi': 0.898234685927185}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.601203 cos_to_last_merge=0.9354 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=48 local utility u=0.028493 metrics={'f1_val': 0.9448896709638533, 'auprc': 0.9507964012145643, 'loss_val': 0.2955619929888244, 'psi': 0.9472523630641376}-{'f1_val': 0.9406028493373525, 'auprc': 0.9433133377985674, 'loss_val': 0.30437788654655445, 'psi': 0.9416870447218385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.438080 cos_to_last_merge=0.8386 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=48 local utility u=0.002195 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9903652013856717, 'loss_val': 0.05312901068617132, 'psi': 0.9935075605789397}-{'f1_val': 0.995895166894551, 'auprc': 0.9896898699928336, 'loss_val': 0.057248334176524515, 'psi': 0.993413048133864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=48 head_norm_before_train=1.488075 cos_to_last_merge=0.8704 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=48 local utility u=0.030240 metrics={'f1_val': 0.8332182985490504, 'auprc': 0.9565852193430207, 'loss_val': 0.3686652794171653, 'psi': 0.8825650668666385}-{'f1_val': 0.8274810645534317, 'auprc': 0.9489155275846181, 'loss_val': 0.37171234741693415, 'psi': 0.8760548497659062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=48 head_norm_before_train=1.571160 cos_to_last_merge=0.9346 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.6077589436168794, 'auprc': 0.7891422986464708, 'loss_val': 0.6966036385120309, 'psi': 0.680312285628716}-{'f1_val': 0.697826374775073, 'auprc': 0.8790728420308647, 'loss_val': 0.2852487866622411, 'psi': 0.7703249616773897}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.844951 cos_to_last_merge=0.9381 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9837298055796642, 'auprc': 0.99899875894944, 'loss_val': 0.0482735063641274, 'psi': 0.9898373869275745}-{'f1_val': 0.9923743275210639, 'auprc': 0.9982261054494341, 'loss_val': 0.03401115019219025, 'psi': 0.994715038692412}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.117131 cos_to_last_merge=0.9649 (last merge round=14)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9999192668220103, 'loss_val': 0.018016636588556383, 'psi': 0.9977326411842795}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995461074770003, 'loss_val': 0.018137650505693267, 'psi': 0.9980801904980858}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.826857 cos_to_last_merge=0.9423 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=48 local utility u=0.002201 metrics={'f1_val': 0.9960202599216732, 'auprc': 0.9960980224513365, 'loss_val': 0.029262105550142727, 'psi': 0.9960513649335385}-{'f1_val': 0.9956096535150197, 'auprc': 0.9956919899199976, 'loss_val': 0.029982193156719895, 'psi': 0.995642588077011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=48 head_norm_before_train=1.618043 cos_to_last_merge=0.8981 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=48 local utility u=0.445768 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9967460213921363, 'loss_val': 0.029835930681605574, 'psi': 0.9963786135048401}-{'f1_val': 0.8680996890290862, 'auprc': 0.9966204561697503, 'loss_val': 0.1527910897182518, 'psi': 0.9195079958853518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=48 head_norm_before_train=1.356092 cos_to_last_merge=0.8391 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5517201397254372, 'auprc': 0.7109764271048935, 'loss_val': 0.9264168202472934, 'psi': 0.6154226546772197}-{'f1_val': 0.5682205054262113, 'auprc': 0.7045783444907316, 'loss_val': 0.8565516675080092, 'psi': 0.6227636410520194}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.056112 cos_to_last_merge=0.9455 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9558726245548859, 'auprc': 0.9986673185565571, 'loss_val': 0.05301851448711523, 'psi': 0.9729905021555543}-{'f1_val': 0.9842865549364627, 'auprc': 0.999012104962347, 'loss_val': 0.03907293837294452, 'psi': 0.9901767749468164}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.722179 cos_to_last_merge=0.9094 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.6996920297483622, 'auprc': 0.6647098185623184, 'loss_val': 0.7061719581135866, 'psi': 0.6856991452739447}-{'f1_val': 0.9890915335426116, 'auprc': 0.9923902935604951, 'loss_val': 0.0688972273214911, 'psi': 0.990411037549765}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.063292 (no previous merge yet)
[S16] round=48 local utility u=0.220434 metrics={'f1_val': 0.9933967616506396, 'auprc': 0.9895430574474191, 'loss_val': 0.033137871693818835, 'psi': 0.9918552799693514}-{'f1_val': 0.9439903310926671, 'auprc': 0.9878642901050164, 'loss_val': 0.17253193469653982, 'psi': 0.9615399146976069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=48 head_norm_before_train=1.546306 cos_to_last_merge=0.9182 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.7391204030428431, 'auprc': 0.8376012572429483, 'loss_val': 0.7211686844536367, 'psi': 0.7785127447228852}-{'f1_val': 0.8229153530541061, 'auprc': 0.8803508372398521, 'loss_val': 0.6212959476068649, 'psi': 0.8458895467284046}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.991893 cos_to_last_merge=0.9657 (last merge round=12)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.7174250730692133, 'auprc': 0.7627725384416907, 'loss_val': 0.9019833299239517, 'psi': 0.7355640592182042}-{'f1_val': 0.7195439638879944, 'auprc': 0.7555761164367217, 'loss_val': 0.789714461102265, 'psi': 0.7339568249074853}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.934410 cos_to_last_merge=0.7709 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=49 local utility u=1.000000 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.999919133209, 'loss_val': 0.13074952430562892, 'psi': 0.9712975916578754}-{'f1_val': 0.6469584701057274, 'auprc': 0.9984197388319663, 'loss_val': 0.8763799043302525, 'psi': 0.787542977596223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=49 head_norm_before_train=1.611102 cos_to_last_merge=0.9340 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.934
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9439116258646975, 'auprc': 0.9462856918356496, 'loss_val': 0.3024447248497984, 'psi': 0.9448612522530783}-{'f1_val': 0.9448896709638533, 'auprc': 0.9507964012145643, 'loss_val': 0.2955619929888244, 'psi': 0.9472523630641376}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.450176 cos_to_last_merge=0.8375 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9747085046789884, 'auprc': 0.989113803750906, 'loss_val': 0.08392607572148032, 'psi': 0.9804706243077554}-{'f1_val': 0.9956024667077852, 'auprc': 0.9903652013856717, 'loss_val': 0.05312901068617132, 'psi': 0.9935075605789397}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.495916 cos_to_last_merge=0.8692 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6368308963228928, 'auprc': 0.916769191526351, 'loss_val': 0.7101430631809849, 'psi': 0.748806214404276}-{'f1_val': 0.8332182985490504, 'auprc': 0.9565852193430207, 'loss_val': 0.3686652794171653, 'psi': 0.8825650668666385}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.575031 cos_to_last_merge=0.9345 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=49 local utility u=0.150608 metrics={'f1_val': 0.6277688683484265, 'auprc': 0.801100135150774, 'loss_val': 0.5513197354466741, 'psi': 0.6971013750693655}-{'f1_val': 0.6077589436168794, 'auprc': 0.7891422986464708, 'loss_val': 0.6966036385120309, 'psi': 0.680312285628716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=49 head_norm_before_train=1.855107 cos_to_last_merge=0.9371 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=49 local utility u=0.030283 metrics={'f1_val': 0.9921866555464717, 'auprc': 0.9977277075449654, 'loss_val': 0.03463503869531026, 'psi': 0.9944030763458691}-{'f1_val': 0.9837298055796642, 'auprc': 0.99899875894944, 'loss_val': 0.0482735063641274, 'psi': 0.9898373869275745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=49 head_norm_before_train=2.123986 cos_to_last_merge=0.9643 (last merge round=14)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9958557717480525, 'auprc': 0.9995569811009396, 'loss_val': 0.019895571454986816, 'psi': 0.9973362554892073}-{'f1_val': 0.9962748907591257, 'auprc': 0.9999192668220103, 'loss_val': 0.018016636588556383, 'psi': 0.9977326411842795}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.836057 cos_to_last_merge=0.9417 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9957172820644077, 'loss_val': 0.02919949269631012, 'psi': 0.995652704934775}-{'f1_val': 0.9960202599216732, 'auprc': 0.9960980224513365, 'loss_val': 0.029262105550142727, 'psi': 0.9960513649335385}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=1.627962 cos_to_last_merge=0.8970 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=49 local utility u=0.004451 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981721866833639, 'loss_val': 0.027692966819972506, 'psi': 0.9971970773814993}-{'f1_val': 0.9961336749133093, 'auprc': 0.9967460213921363, 'loss_val': 0.029835930681605574, 'psi': 0.9963786135048401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=49 head_norm_before_train=1.367169 cos_to_last_merge=0.8375 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.837
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5316173163873658, 'auprc': 0.6419964231980009, 'loss_val': 1.0422495069614885, 'psi': 0.5757689591116197}-{'f1_val': 0.5517201397254372, 'auprc': 0.7109764271048935, 'loss_val': 0.9264168202472934, 'psi': 0.6154226546772197}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=2.058520 cos_to_last_merge=0.9453 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=49 local utility u=0.079027 metrics={'f1_val': 0.9806269008294077, 'auprc': 0.9986720511087248, 'loss_val': 0.04350399313977979, 'psi': 0.9878449609411346}-{'f1_val': 0.9558726245548859, 'auprc': 0.9986673185565571, 'loss_val': 0.05301851448711523, 'psi': 0.9729905021555543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=49 head_norm_before_train=1.729962 cos_to_last_merge=0.9088 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=49 local utility u=1.000000 metrics={'f1_val': 0.9461957007264847, 'auprc': 0.9894170877448086, 'loss_val': 0.10158901776127754, 'psi': 0.9634842555338143}-{'f1_val': 0.6996920297483622, 'auprc': 0.6647098185623184, 'loss_val': 0.7061719581135866, 'psi': 0.6856991452739447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=49 head_norm_before_train=2.069629 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9933967616506396, 'auprc': 0.9885519953245716, 'loss_val': 0.036369506958124735, 'psi': 0.9914588551202124}-{'f1_val': 0.9933967616506396, 'auprc': 0.9895430574474191, 'loss_val': 0.033137871693818835, 'psi': 0.9918552799693514}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.559518 cos_to_last_merge=0.9168 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=49 local utility u=0.864043 metrics={'f1_val': 0.8783996889105756, 'auprc': 0.9851787825291868, 'loss_val': 0.2714919417391289, 'psi': 0.9211113263580201}-{'f1_val': 0.7391204030428431, 'auprc': 0.8376012572429483, 'loss_val': 0.7211686844536367, 'psi': 0.7785127447228852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=50 head_norm_before_train=2.000327 cos_to_last_merge=0.9649 (last merge round=12)
[S2] round=50 local utility u=0.005601 metrics={'f1_val': 0.720090106452135, 'auprc': 0.7545186191603896, 'loss_val': 0.8820089349401931, 'psi': 0.7338615115354369}-{'f1_val': 0.7174250730692133, 'auprc': 0.7627725384416907, 'loss_val': 0.9019833299239517, 'psi': 0.7355640592182042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=50 head_norm_before_train=1.939805 cos_to_last_merge=0.7706 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.771
[S3] round=50 local utility u=0.040690 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9999830718283838, 'loss_val': 0.10271334968401687, 'psi': 0.9766382799710258}-{'f1_val': 0.9522165639571257, 'auprc': 0.999919133209, 'loss_val': 0.13074952430562892, 'psi': 0.9712975916578754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=50 head_norm_before_train=1.615453 cos_to_last_merge=0.9321 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.932
[S4] round=50 local utility u=0.024232 metrics={'f1_val': 0.9469246556346225, 'auprc': 0.9542375928866643, 'loss_val': 0.29591394289970596, 'psi': 0.9498498305354393}-{'f1_val': 0.9439116258646975, 'auprc': 0.9462856918356496, 'loss_val': 0.3024447248497984, 'psi': 0.9448612522530783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=50 head_norm_before_train=1.464122 cos_to_last_merge=0.8362 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=50 local utility u=0.082599 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9903639807193023, 'loss_val': 0.047842896369858286, 'psi': 0.993507072312392}-{'f1_val': 0.9747085046789884, 'auprc': 0.989113803750906, 'loss_val': 0.08392607572148032, 'psi': 0.9804706243077554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=50 head_norm_before_train=1.506126 cos_to_last_merge=0.8676 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=50 local utility u=0.995829 metrics={'f1_val': 0.8744749231404976, 'auprc': 0.9586477412345111, 'loss_val': 0.2699853803739313, 'psi': 0.908144050378103}-{'f1_val': 0.6368308963228928, 'auprc': 0.916769191526351, 'loss_val': 0.7101430631809849, 'psi': 0.748806214404276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=50 head_norm_before_train=1.583270 cos_to_last_merge=0.9336 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=50 local utility u=0.155336 metrics={'f1_val': 0.6544180857652604, 'auprc': 0.8141496466532163, 'loss_val': 0.4396921406327102, 'psi': 0.7183107101204428}-{'f1_val': 0.6277688683484265, 'auprc': 0.801100135150774, 'loss_val': 0.5513197354466741, 'psi': 0.6971013750693655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=50 head_norm_before_train=1.862147 cos_to_last_merge=0.9369 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.937
[S8] round=50 local utility u=0.004438 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9982230535449904, 'loss_val': 0.032135027141367484, 'psi': 0.9950902961096686}-{'f1_val': 0.9921866555464717, 'auprc': 0.9977277075449654, 'loss_val': 0.03463503869531026, 'psi': 0.9944030763458691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=50 head_norm_before_train=2.132803 cos_to_last_merge=0.9638 (last merge round=14)
[S9] round=50 local utility u=0.005262 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995609498304326, 'loss_val': 0.016866931965865428, 'psi': 0.9980861274394588}-{'f1_val': 0.9958557717480525, 'auprc': 0.9995569811009396, 'loss_val': 0.019895571454986816, 'psi': 0.9973362554892073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=50 head_norm_before_train=1.845959 cos_to_last_merge=0.9409 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956705115858552, 'loss_val': 0.029298282025074854, 'psi': 0.9953809080459669}-{'f1_val': 0.9956096535150197, 'auprc': 0.9957172820644077, 'loss_val': 0.02919949269631012, 'psi': 0.995652704934775}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=1.637702 cos_to_last_merge=0.8959 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=50 local utility u=0.000390 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982342179636664, 'loss_val': 0.027098100823556445, 'psi': 0.9972218898936203}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981721866833639, 'loss_val': 0.027692966819972506, 'psi': 0.9971970773814993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=50 head_norm_before_train=1.377872 cos_to_last_merge=0.8359 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=50 local utility u=0.333599 metrics={'f1_val': 0.5872975546512166, 'auprc': 0.6531619082004944, 'loss_val': 0.7426286911411587, 'psi': 0.6136432960709277}-{'f1_val': 0.5316173163873658, 'auprc': 0.6419964231980009, 'loss_val': 1.0422495069614885, 'psi': 0.5757689591116197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=50 head_norm_before_train=2.062785 cos_to_last_merge=0.9452 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=50 local utility u=0.048806 metrics={'f1_val': 0.9959647244635018, 'auprc': 0.9986672442888332, 'loss_val': 0.03790508187355191, 'psi': 0.9970457323936344}-{'f1_val': 0.9806269008294077, 'auprc': 0.9986720511087248, 'loss_val': 0.04350399313977979, 'psi': 0.9878449609411346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=50 head_norm_before_train=1.737316 cos_to_last_merge=0.9082 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=50 local utility u=0.187117 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.9908703923406889, 'loss_val': 0.031773018075162585, 'psi': 0.994071396585946}-{'f1_val': 0.9461957007264847, 'auprc': 0.9894170877448086, 'loss_val': 0.10158901776127754, 'psi': 0.9634842555338143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=50 head_norm_before_train=2.066392 (no previous merge yet)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8699202734863084, 'auprc': 0.8961324476613424, 'loss_val': 0.7371862495054475, 'psi': 0.880405143156322}-{'f1_val': 0.9933967616506396, 'auprc': 0.9885519953245716, 'loss_val': 0.036369506958124735, 'psi': 0.9914588551202124}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.570930 cos_to_last_merge=0.9147 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.8486718747866514, 'auprc': 0.9587888593570172, 'loss_val': 0.3663117449290432, 'psi': 0.8927186686147977}-{'f1_val': 0.8783996889105756, 'auprc': 0.9851787825291868, 'loss_val': 0.2714919417391289, 'psi': 0.9211113263580201}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=2.007361 cos_to_last_merge=0.9643 (last merge round=12)
[S2] round=51 local utility u=0.041148 metrics={'f1_val': 0.6962214253065117, 'auprc': 0.7883713638351888, 'loss_val': 0.7580591316536442, 'psi': 0.7330814007179824}-{'f1_val': 0.720090106452135, 'auprc': 0.7545186191603896, 'loss_val': 0.8820089349401931, 'psi': 0.7338615115354369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=51 head_norm_before_train=1.943754 cos_to_last_merge=0.7704 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9996060854528747, 'loss_val': 0.13644804554658338, 'psi': 0.9764635848444161}-{'f1_val': 0.9610750853994537, 'auprc': 0.9999830718283838, 'loss_val': 0.10271334968401687, 'psi': 0.9766382799710258}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.626045 cos_to_last_merge=0.9305 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9505976270767879, 'auprc': 0.9456360492798978, 'loss_val': 0.30312156295846365, 'psi': 0.9486129959580318}-{'f1_val': 0.9469246556346225, 'auprc': 0.9542375928866643, 'loss_val': 0.29591394289970596, 'psi': 0.9498498305354393}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.479187 cos_to_last_merge=0.8349 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=51 local utility u=0.000890 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9899550232438172, 'loss_val': 0.04659214831304641, 'psi': 0.9935191094342575}-{'f1_val': 0.9956024667077852, 'auprc': 0.9903639807193023, 'loss_val': 0.047842896369858286, 'psi': 0.993507072312392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=51 head_norm_before_train=1.516399 cos_to_last_merge=0.8664 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.784207737929684, 'auprc': 0.9428195662949204, 'loss_val': 0.49540513953137527, 'psi': 0.8476524692757785}-{'f1_val': 0.8744749231404976, 'auprc': 0.9586477412345111, 'loss_val': 0.2699853803739313, 'psi': 0.908144050378103}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.590089 cos_to_last_merge=0.9328 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5776519119640974, 'auprc': 0.7968595702996916, 'loss_val': 0.6592009017292407, 'psi': 0.6653349752983351}-{'f1_val': 0.6544180857652604, 'auprc': 0.8141496466532163, 'loss_val': 0.4396921406327102, 'psi': 0.7183107101204428}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.871121 cos_to_last_merge=0.9363 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.936
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9754303607958151, 'auprc': 0.9987711291845556, 'loss_val': 0.058102181736136495, 'psi': 0.9847666681513114}-{'f1_val': 0.9930017911527874, 'auprc': 0.9982230535449904, 'loss_val': 0.032135027141367484, 'psi': 0.9950902961096686}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.141599 cos_to_last_merge=0.9634 (last merge round=14)
[S9] round=51 local utility u=0.000110 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995597623835303, 'loss_val': 0.01664281143953569, 'psi': 0.9980856524606978}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995609498304326, 'loss_val': 0.016866931965865428, 'psi': 0.9980861274394588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=51 head_norm_before_train=1.855985 cos_to_last_merge=0.9401 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=51 local utility u=0.000259 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957441828600206, 'loss_val': 0.02900159609117934, 'psi': 0.995410376555633}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956705115858552, 'loss_val': 0.029298282025074854, 'psi': 0.9953809080459669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=51 head_norm_before_train=1.646463 cos_to_last_merge=0.8948 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=51 local utility u=0.000261 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982153001595839, 'loss_val': 0.026518657150230558, 'psi': 0.9972143227719873}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982342179636664, 'loss_val': 0.027098100823556445, 'psi': 0.9972218898936203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=51 head_norm_before_train=1.386614 cos_to_last_merge=0.8347 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.5765410854811208, 'auprc': 0.6517000802328445, 'loss_val': 1.056035970937882, 'psi': 0.6066046833818104}-{'f1_val': 0.5872975546512166, 'auprc': 0.6531619082004944, 'loss_val': 0.7426286911411587, 'psi': 0.6136432960709277}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=2.064405 cos_to_last_merge=0.9451 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9764616088027154, 'auprc': 0.9990335430353271, 'loss_val': 0.04595592668650678, 'psi': 0.9854903824957602}-{'f1_val': 0.9959647244635018, 'auprc': 0.9986672442888332, 'loss_val': 0.03790508187355191, 'psi': 0.9970457323936344}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=1.743618 cos_to_last_merge=0.9079 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.7834621166536923, 'auprc': 0.9419508974032631, 'loss_val': 0.4126130435933018, 'psi': 0.8468576289535206}-{'f1_val': 0.9962053994161175, 'auprc': 0.9908703923406889, 'loss_val': 0.031773018075162585, 'psi': 0.994071396585946}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.065493 (no previous merge yet)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8425088522018039, 'auprc': 0.8961873474579458, 'loss_val': 1.124572088166652, 'psi': 0.8639802503042606}-{'f1_val': 0.8699202734863084, 'auprc': 0.8961324476613424, 'loss_val': 0.7371862495054475, 'psi': 0.880405143156322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.583546 cos_to_last_merge=0.9125 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=51 local utility u=0.555297 metrics={'f1_val': 0.9849936190644079, 'auprc': 0.9833339857391635, 'loss_val': 0.14728337769175162, 'psi': 0.9843297657343102}-{'f1_val': 0.8486718747866514, 'auprc': 0.9587888593570172, 'loss_val': 0.3663117449290432, 'psi': 0.8927186686147977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=52 head_norm_before_train=2.013886 cos_to_last_merge=0.9636 (last merge round=12)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6240480269314225, 'auprc': 0.7312492028942407, 'loss_val': 1.2685075151029286, 'psi': 0.6669284973165497}-{'f1_val': 0.6962214253065117, 'auprc': 0.7883713638351888, 'loss_val': 0.7580591316536442, 'psi': 0.7330814007179824}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.950220 cos_to_last_merge=0.7700 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=52 local utility u=0.014989 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9991528547578553, 'loss_val': 0.1051099627772186, 'psi': 0.9762822925664083}-{'f1_val': 0.9610352511054436, 'auprc': 0.9996060854528747, 'loss_val': 0.13644804554658338, 'psi': 0.9764635848444161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=52 head_norm_before_train=1.630785 cos_to_last_merge=0.9297 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.930
[S4] round=52 local utility u=0.040072 metrics={'f1_val': 0.9574442700117567, 'auprc': 0.9550195662326025, 'loss_val': 0.2922085910050709, 'psi': 0.956474388500095}-{'f1_val': 0.9505976270767879, 'auprc': 0.9456360492798978, 'loss_val': 0.30312156295846365, 'psi': 0.9486129959580318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=52 head_norm_before_train=1.493424 cos_to_last_merge=0.8336 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=52 local utility u=0.003285 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9918401397761403, 'loss_val': 0.04392147500635787, 'psi': 0.9940975359351272}-{'f1_val': 0.995895166894551, 'auprc': 0.9899550232438172, 'loss_val': 0.04659214831304641, 'psi': 0.9935191094342575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=52 head_norm_before_train=1.526150 cos_to_last_merge=0.8654 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.7406611559396562, 'auprc': 0.9182003469790956, 'loss_val': 0.5740257124450425, 'psi': 0.811676832355432}-{'f1_val': 0.784207737929684, 'auprc': 0.9428195662949204, 'loss_val': 0.49540513953137527, 'psi': 0.8476524692757785}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.595152 cos_to_last_merge=0.9322 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=52 local utility u=0.070443 metrics={'f1_val': 0.5986489662921954, 'auprc': 0.7972768012256913, 'loss_val': 0.6455482158670306, 'psi': 0.6781001002655938}-{'f1_val': 0.5776519119640974, 'auprc': 0.7968595702996916, 'loss_val': 0.6592009017292407, 'psi': 0.6653349752983351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=52 head_norm_before_train=1.880560 cos_to_last_merge=0.9353 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.7652021169269722, 'auprc': 0.9841250946892734, 'loss_val': 0.21456059160945076, 'psi': 0.8527713080318926}-{'f1_val': 0.9754303607958151, 'auprc': 0.9987711291845556, 'loss_val': 0.058102181736136495, 'psi': 0.9847666681513114}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=2.149374 cos_to_last_merge=0.9632 (last merge round=14)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9991877466720893, 'loss_val': 0.01703545290890548, 'psi': 0.9975383913956075}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995597623835303, 'loss_val': 0.01664281143953569, 'psi': 0.9980856524606978}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=1.865907 cos_to_last_merge=0.9394 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955187844554284, 'loss_val': 0.028733199168088544, 'psi': 0.9953202171937963}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957441828600206, 'loss_val': 0.02900159609117934, 'psi': 0.995410376555633}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.655360 cos_to_last_merge=0.8937 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=52 local utility u=0.000247 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982026342236376, 'loss_val': 0.025986352589547134, 'psi': 0.9972092563976088}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982153001595839, 'loss_val': 0.026518657150230558, 'psi': 0.9972143227719873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=52 head_norm_before_train=1.395826 cos_to_last_merge=0.8334 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=52 local utility u=0.140066 metrics={'f1_val': 0.5869977596547316, 'auprc': 0.6787795491001779, 'loss_val': 0.9198825263948923, 'psi': 0.6237104754329101}-{'f1_val': 0.5765410854811208, 'auprc': 0.6517000802328445, 'loss_val': 1.056035970937882, 'psi': 0.6066046833818104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=52 head_norm_before_train=2.067614 cos_to_last_merge=0.9447 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=52 local utility u=0.075270 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9990332302370235, 'loss_val': 0.023712621456640375, 'psi': 0.9983199330770772}-{'f1_val': 0.9764616088027154, 'auprc': 0.9990335430353271, 'loss_val': 0.04595592668650678, 'psi': 0.9854903824957602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=52 head_norm_before_train=1.752327 cos_to_last_merge=0.9073 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=52 local utility u=0.320659 metrics={'f1_val': 0.8427925907575171, 'auprc': 0.9862317723994838, 'loss_val': 0.26012072068353, 'psi': 0.9001682634143038}-{'f1_val': 0.7834621166536923, 'auprc': 0.9419508974032631, 'loss_val': 0.4126130435933018, 'psi': 0.8468576289535206}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=52 head_norm_before_train=2.068966 (no previous merge yet)
[S16] round=52 local utility u=0.212208 metrics={'f1_val': 0.8516928379753842, 'auprc': 0.968613269440445, 'loss_val': 0.9725380546604198, 'psi': 0.8984610105614085}-{'f1_val': 0.8425088522018039, 'auprc': 0.8961873474579458, 'loss_val': 1.124572088166652, 'psi': 0.8639802503042606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=52 head_norm_before_train=1.599264 cos_to_last_merge=0.9105 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5258203807570363, 'auprc': 0.7153716326899224, 'loss_val': 1.1153563351335027, 'psi': 0.6016408815301908}-{'f1_val': 0.9849936190644079, 'auprc': 0.9833339857391635, 'loss_val': 0.14728337769175162, 'psi': 0.9843297657343102}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=2.021107 cos_to_last_merge=0.9629 (last merge round=12)
[S2] round=53 local utility u=0.533057 metrics={'f1_val': 0.7205120403215745, 'auprc': 0.7754311588178032, 'loss_val': 0.9137227571262834, 'psi': 0.7424796877200659}-{'f1_val': 0.6240480269314225, 'auprc': 0.7312492028942407, 'loss_val': 1.2685075151029286, 'psi': 0.6669284973165497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=53 head_norm_before_train=1.958044 cos_to_last_merge=0.7695 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.770
[S3] round=53 local utility u=0.000698 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9991528547578554, 'loss_val': 0.10371421363938783, 'psi': 0.9762822925664083}-{'f1_val': 0.9610352511054436, 'auprc': 0.9991528547578553, 'loss_val': 0.1051099627772186, 'psi': 0.9762822925664083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=53 head_norm_before_train=1.633383 cos_to_last_merge=0.9284 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.928
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9431469826278992, 'auprc': 0.9644842601817736, 'loss_val': 0.2956002318647922, 'psi': 0.9516818936494489}-{'f1_val': 0.9574442700117567, 'auprc': 0.9550195662326025, 'loss_val': 0.2922085910050709, 'psi': 0.956474388500095}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.506608 cos_to_last_merge=0.8326 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.7170330005159709, 'auprc': 0.9330853036338086, 'loss_val': 0.43392524540232497, 'psi': 0.803453921763106}-{'f1_val': 0.9956024667077852, 'auprc': 0.9918401397761403, 'loss_val': 0.04392147500635787, 'psi': 0.9940975359351272}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.535649 cos_to_last_merge=0.8645 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=53 local utility u=0.045175 metrics={'f1_val': 0.7397144537357084, 'auprc': 0.9428203659112594, 'loss_val': 0.5518564741687153, 'psi': 0.8209568186059288}-{'f1_val': 0.7406611559396562, 'auprc': 0.9182003469790956, 'loss_val': 0.5740257124450425, 'psi': 0.811676832355432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=53 head_norm_before_train=1.601714 cos_to_last_merge=0.9312 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=53 local utility u=0.320750 metrics={'f1_val': 0.6604915334628778, 'auprc': 0.8153241015137502, 'loss_val': 0.4292447073469172, 'psi': 0.7224245606832267}-{'f1_val': 0.5986489662921954, 'auprc': 0.7972768012256913, 'loss_val': 0.6455482158670306, 'psi': 0.6781001002655938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=53 head_norm_before_train=1.888705 cos_to_last_merge=0.9345 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.935
[S8] round=53 local utility u=0.783401 metrics={'f1_val': 0.9894208216881261, 'auprc': 0.9986482197354075, 'loss_val': 0.036640613115155436, 'psi': 0.9931117809070387}-{'f1_val': 0.7652021169269722, 'auprc': 0.9841250946892734, 'loss_val': 0.21456059160945076, 'psi': 0.8527713080318926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=53 head_norm_before_train=2.155363 cos_to_last_merge=0.9626 (last merge round=14)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9991919566602473, 'loss_val': 0.026299632272694204, 'psi': 0.9952874677530177}-{'f1_val': 0.9964388212112862, 'auprc': 0.9991877466720893, 'loss_val': 0.01703545290890548, 'psi': 0.9975383913956075}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.870325 cos_to_last_merge=0.9387 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=53 local utility u=0.000459 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956764162653792, 'loss_val': 0.028287123029148677, 'psi': 0.9953832699177765}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955187844554284, 'loss_val': 0.028733199168088544, 'psi': 0.9953202171937963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=53 head_norm_before_train=1.664560 cos_to_last_merge=0.8927 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=53 local utility u=0.000186 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981807895375928, 'loss_val': 0.025549007352980567, 'psi': 0.9972005185231909}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982026342236376, 'loss_val': 0.025986352589547134, 'psi': 0.9972092563976088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=53 head_norm_before_train=1.403277 cos_to_last_merge=0.8321 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=53 local utility u=0.302827 metrics={'f1_val': 0.6111892611037446, 'auprc': 0.7168054057395301, 'loss_val': 0.5734542318149657, 'psi': 0.6534357189580589}-{'f1_val': 0.5869977596547316, 'auprc': 0.6787795491001779, 'loss_val': 0.9198825263948923, 'psi': 0.6237104754329101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=53 head_norm_before_train=2.074139 cos_to_last_merge=0.9441 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.997411628228889, 'auprc': 0.999080045311985, 'loss_val': 0.030914076780730836, 'psi': 0.9980789950621274}-{'f1_val': 0.997844401637113, 'auprc': 0.9990332302370235, 'loss_val': 0.023712621456640375, 'psi': 0.9983199330770772}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=1.762181 cos_to_last_merge=0.9066 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=53 local utility u=0.161274 metrics={'f1_val': 0.8798249834615199, 'auprc': 0.9906826245119097, 'loss_val': 0.1731203367350434, 'psi': 0.9241680398816758}-{'f1_val': 0.8427925907575171, 'auprc': 0.9862317723994838, 'loss_val': 0.26012072068353, 'psi': 0.9001682634143038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=53 head_norm_before_train=2.073799 (no previous merge yet)
[S16] round=53 local utility u=0.710993 metrics={'f1_val': 0.9434453329694749, 'auprc': 0.9942574545314067, 'loss_val': 0.17799861503100892, 'psi': 0.9637701815942475}-{'f1_val': 0.8516928379753842, 'auprc': 0.968613269440445, 'loss_val': 0.9725380546604198, 'psi': 0.8984610105614085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=53 head_norm_before_train=1.615185 cos_to_last_merge=0.9080 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=53 local utility u=1.000000 metrics={'f1_val': 0.9724967917832961, 'auprc': 0.987022352313047, 'loss_val': 0.12416120705947377, 'psi': 0.9783070159951965}-{'f1_val': 0.5258203807570363, 'auprc': 0.7153716326899224, 'loss_val': 1.1153563351335027, 'psi': 0.6016408815301908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=54 head_norm_before_train=2.027725 cos_to_last_merge=0.9622 (last merge round=12)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.702544712735085, 'auprc': 0.7367672986953064, 'loss_val': 0.8755973884494356, 'psi': 0.7162337471191735}-{'f1_val': 0.7205120403215745, 'auprc': 0.7754311588178032, 'loss_val': 0.9137227571262834, 'psi': 0.7424796877200659}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=1.966058 cos_to_last_merge=0.7690 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.769
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9317863896539553, 'auprc': 0.9990643968689963, 'loss_val': 0.23657158507217063, 'psi': 0.9586975925399717}-{'f1_val': 0.9610352511054436, 'auprc': 0.9991528547578554, 'loss_val': 0.10371421363938783, 'psi': 0.9762822925664083}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.635637 cos_to_last_merge=0.9275 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9439383767612408, 'auprc': 0.9284475621600177, 'loss_val': 0.2961806247639969, 'psi': 0.9377420509207516}-{'f1_val': 0.9431469826278992, 'auprc': 0.9644842601817736, 'loss_val': 0.2956002318647922, 'psi': 0.9516818936494489}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.517760 cos_to_last_merge=0.8317 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=54 local utility u=1.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9925365529415762, 'loss_val': 0.04119905059823129, 'psi': 0.9943761012013015}-{'f1_val': 0.7170330005159709, 'auprc': 0.9330853036338086, 'loss_val': 0.43392524540232497, 'psi': 0.803453921763106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=54 head_norm_before_train=1.544773 cos_to_last_merge=0.8633 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6190575393804191, 'auprc': 0.7932249018456856, 'loss_val': 0.9522559093501112, 'psi': 0.6887244843665257}-{'f1_val': 0.7397144537357084, 'auprc': 0.9428203659112594, 'loss_val': 0.5518564741687153, 'psi': 0.8209568186059288}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.608318 cos_to_last_merge=0.9299 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6376277470434457, 'auprc': 0.8046967502034387, 'loss_val': 0.5776882495732247, 'psi': 0.7044553483074429}-{'f1_val': 0.6604915334628778, 'auprc': 0.8153241015137502, 'loss_val': 0.4292447073469172, 'psi': 0.7224245606832267}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.893695 cos_to_last_merge=0.9338 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.934
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9892693350136037, 'auprc': 0.9988239761610824, 'loss_val': 0.03677244545221559, 'psi': 0.9930911914725953}-{'f1_val': 0.9894208216881261, 'auprc': 0.9986482197354075, 'loss_val': 0.036640613115155436, 'psi': 0.9931117809070387}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.160475 cos_to_last_merge=0.9621 (last merge round=14)
[S9] round=54 local utility u=0.002827 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9991921956021446, 'loss_val': 0.025670040127501362, 'psi': 0.9957898334315031}-{'f1_val': 0.992684475148198, 'auprc': 0.9991919566602473, 'loss_val': 0.026299632272694204, 'psi': 0.9952874677530177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=54 head_norm_before_train=1.875861 cos_to_last_merge=0.9382 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=54 local utility u=0.001420 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9956807229610364, 'loss_val': 0.02799190630452442, 'psi': 0.9956380812934265}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956764162653792, 'loss_val': 0.028287123029148677, 'psi': 0.9953832699177765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=54 head_norm_before_train=1.673740 cos_to_last_merge=0.8917 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=54 local utility u=0.000173 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981671639674483, 'loss_val': 0.025163085628979658, 'psi': 0.997195068295133}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981807895375928, 'loss_val': 0.025549007352980567, 'psi': 0.9972005185231909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=54 head_norm_before_train=1.409286 cos_to_last_merge=0.8313 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5816633340422444, 'auprc': 0.7412043328365813, 'loss_val': 1.052943273361098, 'psi': 0.6454797335599791}-{'f1_val': 0.6111892611037446, 'auprc': 0.7168054057395301, 'loss_val': 0.5734542318149657, 'psi': 0.6534357189580589}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.083474 cos_to_last_merge=0.9436 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.944
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.8862134256947134, 'auprc': 0.9987541136929167, 'loss_val': 0.3414152834822745, 'psi': 0.9312297008939947}-{'f1_val': 0.997411628228889, 'auprc': 0.999080045311985, 'loss_val': 0.030914076780730836, 'psi': 0.9980789950621274}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.771997 cos_to_last_merge=0.9057 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.906
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.7117633175070501, 'auprc': 0.7435616362535852, 'loss_val': 0.620720584438009, 'psi': 0.7244826450056641}-{'f1_val': 0.8798249834615199, 'auprc': 0.9906826245119097, 'loss_val': 0.1731203367350434, 'psi': 0.9241680398816758}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=2.073485 (no previous merge yet)
[S16] round=54 local utility u=0.208893 metrics={'f1_val': 0.9913679481183472, 'auprc': 0.9924960667916425, 'loss_val': 0.042463743322888964, 'psi': 0.9918191955876654}-{'f1_val': 0.9434453329694749, 'auprc': 0.9942574545314067, 'loss_val': 0.17799861503100892, 'psi': 0.9637701815942475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=54 head_norm_before_train=1.630175 cos_to_last_merge=0.9064 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.7930159409244142, 'auprc': 0.9178118148452664, 'loss_val': 0.5487379232997271, 'psi': 0.842934290492755}-{'f1_val': 0.9724967917832961, 'auprc': 0.987022352313047, 'loss_val': 0.12416120705947377, 'psi': 0.9783070159951965}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=2.032954 cos_to_last_merge=0.9617 (last merge round=12)
[S2] round=55 local utility u=0.077757 metrics={'f1_val': 0.7202049151095504, 'auprc': 0.7521667850308775, 'loss_val': 0.8722423222433034, 'psi': 0.7329896630780812}-{'f1_val': 0.702544712735085, 'auprc': 0.7367672986953064, 'loss_val': 0.8755973884494356, 'psi': 0.7162337471191735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=55 head_norm_before_train=1.971139 cos_to_last_merge=0.7686 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.769
[S3] round=55 local utility u=0.307097 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9996105150256185, 'loss_val': 0.0176861763256764, 'psi': 0.9982831474778818}-{'f1_val': 0.9317863896539553, 'auprc': 0.9990643968689963, 'loss_val': 0.23657158507217063, 'psi': 0.9586975925399717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=55 head_norm_before_train=1.635764 cos_to_last_merge=0.9261 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=55 local utility u=0.056990 metrics={'f1_val': 0.9488629844329577, 'auprc': 0.9563042337968093, 'loss_val': 0.29531855956231956, 'psi': 0.9518394841784983}-{'f1_val': 0.9439383767612408, 'auprc': 0.9284475621600177, 'loss_val': 0.2961806247639969, 'psi': 0.9377420509207516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=55 head_norm_before_train=1.523651 cos_to_last_merge=0.8311 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9902979393474678, 'loss_val': 0.04060964763273673, 'psi': 0.9934806557636582}-{'f1_val': 0.9956024667077852, 'auprc': 0.9925365529415762, 'loss_val': 0.04119905059823129, 'psi': 0.9943761012013015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.554452 cos_to_last_merge=0.8624 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=55 local utility u=1.000000 metrics={'f1_val': 0.8712751277014033, 'auprc': 0.9639869544896844, 'loss_val': 0.26482132118444873, 'psi': 0.9083598584167157}-{'f1_val': 0.6190575393804191, 'auprc': 0.7932249018456856, 'loss_val': 0.9522559093501112, 'psi': 0.6887244843665257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=55 head_norm_before_train=1.614014 cos_to_last_merge=0.9292 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=55 local utility u=0.040218 metrics={'f1_val': 0.6464493361770666, 'auprc': 0.8078131710680905, 'loss_val': 0.5595309933052968, 'psi': 0.7109948701334761}-{'f1_val': 0.6376277470434457, 'auprc': 0.8046967502034387, 'loss_val': 0.5776882495732247, 'psi': 0.7044553483074429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=55 head_norm_before_train=1.892641 cos_to_last_merge=0.9328 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.933
[S8] round=55 local utility u=0.010875 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9987020690349444, 'loss_val': 0.0342138246531827, 'psi': 0.9949982092083696}-{'f1_val': 0.9892693350136037, 'auprc': 0.9988239761610824, 'loss_val': 0.03677244545221559, 'psi': 0.9930911914725953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=55 head_norm_before_train=2.165659 cos_to_last_merge=0.9615 (last merge round=14)
[S9] round=55 local utility u=0.009925 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9960352518404264, 'loss_val': 0.017836645215951165, 'psi': 0.9966758482434562}-{'f1_val': 0.9935215919844088, 'auprc': 0.9991921956021446, 'loss_val': 0.025670040127501362, 'psi': 0.9957898334315031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=55 head_norm_before_train=1.882873 cos_to_last_merge=0.9377 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=55 local utility u=0.000199 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9956751084387327, 'loss_val': 0.027577211931960086, 'psi': 0.995635835484505}-{'f1_val': 0.9956096535150197, 'auprc': 0.9956807229610364, 'loss_val': 0.02799190630452442, 'psi': 0.9956380812934265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=55 head_norm_before_train=1.682299 cos_to_last_merge=0.8909 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=55 local utility u=0.000135 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981741195444241, 'loss_val': 0.024913887989611975, 'psi': 0.9971978505259234}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981671639674483, 'loss_val': 0.025163085628979658, 'psi': 0.997195068295133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=55 head_norm_before_train=1.414292 cos_to_last_merge=0.8303 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.5817278288035842, 'auprc': 0.6068577830123899, 'loss_val': 0.9752856437717754, 'psi': 0.5917798104871065}-{'f1_val': 0.5816633340422444, 'auprc': 0.7412043328365813, 'loss_val': 1.052943273361098, 'psi': 0.6454797335599791}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=2.093063 cos_to_last_merge=0.9432 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=55 local utility u=0.493105 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9990017462400852, 'loss_val': 0.026924143640212738, 'psi': 0.9984263416100889}-{'f1_val': 0.8862134256947134, 'auprc': 0.9987541136929167, 'loss_val': 0.3414152834822745, 'psi': 0.9312297008939947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=55 head_norm_before_train=1.782339 cos_to_last_merge=0.9048 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=55 local utility u=1.000000 metrics={'f1_val': 0.9924655689058992, 'auprc': 0.9909114818085926, 'loss_val': 0.041650357157336615, 'psi': 0.9918439340669766}-{'f1_val': 0.7117633175070501, 'auprc': 0.7435616362535852, 'loss_val': 0.620720584438009, 'psi': 0.7244826450056641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=55 head_norm_before_train=2.077345 (no previous merge yet)
[S16] round=55 local utility u=0.001784 metrics={'f1_val': 0.9914393204942562, 'auprc': 0.991613747191574, 'loss_val': 0.036676664766402405, 'psi': 0.9915090911731834}-{'f1_val': 0.9913679481183472, 'auprc': 0.9924960667916425, 'loss_val': 0.042463743322888964, 'psi': 0.9918191955876654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=55 head_norm_before_train=1.644032 cos_to_last_merge=0.9053 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=55 local utility u=0.064683 metrics={'f1_val': 0.8154045315509381, 'auprc': 0.9059174994233634, 'loss_val': 0.5180196350876259, 'psi': 0.8516097186999082}-{'f1_val': 0.7930159409244142, 'auprc': 0.9178118148452664, 'loss_val': 0.5487379232997271, 'psi': 0.842934290492755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=56 head_norm_before_train=2.037103 cos_to_last_merge=0.9614 (last merge round=12)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.7201067507473647, 'auprc': 0.7456504705248445, 'loss_val': 0.8780550079346839, 'psi': 0.7303242386583566}-{'f1_val': 0.7202049151095504, 'auprc': 0.7521667850308775, 'loss_val': 0.8722423222433034, 'psi': 0.7329896630780812}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.973001 cos_to_last_merge=0.7682 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.768
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9957042260369158, 'auprc': 0.9996101319822444, 'loss_val': 0.02115794228258764, 'psi': 0.9972665884150471}-{'f1_val': 0.9973982357793907, 'auprc': 0.9996105150256185, 'loss_val': 0.0176861763256764, 'psi': 0.9982831474778818}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.640626 cos_to_last_merge=0.9249 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9467559033779348, 'auprc': 0.9373749607654172, 'loss_val': 0.30930230381319856, 'psi': 0.9430035263329277}-{'f1_val': 0.9488629844329577, 'auprc': 0.9563042337968093, 'loss_val': 0.29531855956231956, 'psi': 0.9518394841784983}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.528257 cos_to_last_merge=0.8307 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.714634679148647, 'auprc': 0.7951593048438559, 'loss_val': 0.5921734144135791, 'psi': 0.7468445294267305}-{'f1_val': 0.9956024667077852, 'auprc': 0.9902979393474678, 'loss_val': 0.04060964763273673, 'psi': 0.9934806557636582}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.562352 cos_to_last_merge=0.8617 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.6189561305303881, 'auprc': 0.925202352889374, 'loss_val': 1.1104568714751983, 'psi': 0.7414546194739825}-{'f1_val': 0.8712751277014033, 'auprc': 0.9639869544896844, 'loss_val': 0.26482132118444873, 'psi': 0.9083598584167157}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.618929 cos_to_last_merge=0.9287 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=56 local utility u=0.007619 metrics={'f1_val': 0.6418290112626148, 'auprc': 0.8091953258928295, 'loss_val': 0.5207166763171804, 'psi': 0.7087755371147006}-{'f1_val': 0.6464493361770666, 'auprc': 0.8078131710680905, 'loss_val': 0.5595309933052968, 'psi': 0.7109948701334761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=56 head_norm_before_train=1.896703 cos_to_last_merge=0.9314 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=56 local utility u=0.001844 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9982247254458763, 'loss_val': 0.032656095508269846, 'psi': 0.9951635379678467}-{'f1_val': 0.9925289693239863, 'auprc': 0.9987020690349444, 'loss_val': 0.0342138246531827, 'psi': 0.9949982092083696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=56 head_norm_before_train=2.170974 cos_to_last_merge=0.9609 (last merge round=14)
[S9] round=56 local utility u=0.000680 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.996750570430744, 'loss_val': 0.01711989891723031, 'psi': 0.9968117794276519}-{'f1_val': 0.9971029125121428, 'auprc': 0.9960352518404264, 'loss_val': 0.017836645215951165, 'psi': 0.9966758482434562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=56 head_norm_before_train=1.890867 cos_to_last_merge=0.9371 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956122737751962, 'loss_val': 0.02775696094023757, 'psi': 0.9953576129217033}-{'f1_val': 0.9956096535150197, 'auprc': 0.9956751084387327, 'loss_val': 0.027577211931960086, 'psi': 0.995635835484505}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.689178 cos_to_last_merge=0.8901 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.890
[S11] round=56 local utility u=0.000213 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.99815943097514, 'loss_val': 0.02444368452732307, 'psi': 0.9971919750982098}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981741195444241, 'loss_val': 0.024913887989611975, 'psi': 0.9971978505259234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=56 head_norm_before_train=1.418239 cos_to_last_merge=0.8297 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=56 local utility u=0.425869 metrics={'f1_val': 0.6101766456044128, 'auprc': 0.7505919376844032, 'loss_val': 0.7254429483771755, 'psi': 0.666342762436409}-{'f1_val': 0.5817278288035842, 'auprc': 0.6068577830123899, 'loss_val': 0.9752856437717754, 'psi': 0.5917798104871065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=2.103432 cos_to_last_merge=0.9427 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9967841058104147, 'loss_val': 0.024552800931957067, 'psi': 0.9974053531044969}-{'f1_val': 0.9980427385234248, 'auprc': 0.9990017462400852, 'loss_val': 0.026924143640212738, 'psi': 0.9984263416100889}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.792490 cos_to_last_merge=0.9037 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.7543519426734007, 'auprc': 0.8524008029730338, 'loss_val': 0.5579185230597781, 'psi': 0.793571486793254}-{'f1_val': 0.9924655689058992, 'auprc': 0.9909114818085926, 'loss_val': 0.041650357157336615, 'psi': 0.9918439340669766}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=2.083261 (no previous merge yet)
[S16] round=56 local utility u=0.001762 metrics={'f1_val': 0.991856026463904, 'auprc': 0.9917628472525589, 'loss_val': 0.036099254639350854, 'psi': 0.991818754779366}-{'f1_val': 0.9914393204942562, 'auprc': 0.991613747191574, 'loss_val': 0.036676664766402405, 'psi': 0.9915090911731834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=56 head_norm_before_train=1.658790 cos_to_last_merge=0.9044 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.7421122017400332, 'auprc': 0.8785004033779195, 'loss_val': 0.703151757374504, 'psi': 0.7966674823951878}-{'f1_val': 0.8154045315509381, 'auprc': 0.9059174994233634, 'loss_val': 0.5180196350876259, 'psi': 0.8516097186999082}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=2.042434 cos_to_last_merge=0.9610 (last merge round=12)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.7207936216486811, 'auprc': 0.7359700436498133, 'loss_val': 0.9386564798266066, 'psi': 0.726864190449134}-{'f1_val': 0.7201067507473647, 'auprc': 0.7456504705248445, 'loss_val': 0.8780550079346839, 'psi': 0.7303242386583566}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=1.977795 cos_to_last_merge=0.7677 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.768
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9994398910942235, 'loss_val': 0.14566181607961948, 'psi': 0.9764210076773616}-{'f1_val': 0.9957042260369158, 'auprc': 0.9996101319822444, 'loss_val': 0.02115794228258764, 'psi': 0.9972665884150471}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.649664 cos_to_last_merge=0.9242 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.924
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9411425671762541, 'auprc': 0.934594419710669, 'loss_val': 0.31525259619687246, 'psi': 0.9385233081900202}-{'f1_val': 0.9467559033779348, 'auprc': 0.9373749607654172, 'loss_val': 0.30930230381319856, 'psi': 0.9430035263329277}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.533016 cos_to_last_merge=0.8301 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=57 local utility u=1.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9902739861846358, 'loss_val': 0.03926716083548487, 'psi': 0.9934710744985253}-{'f1_val': 0.714634679148647, 'auprc': 0.7951593048438559, 'loss_val': 0.5921734144135791, 'psi': 0.7468445294267305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=57 head_norm_before_train=1.570050 cos_to_last_merge=0.8611 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.9856152496208247, 'auprc': 0.9723184938506684, 'loss_val': 0.10152373387022672, 'psi': 0.9802965473127622}-{'f1_val': 0.6189561305303881, 'auprc': 0.925202352889374, 'loss_val': 1.1104568714751983, 'psi': 0.7414546194739825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=57 head_norm_before_train=1.622750 cos_to_last_merge=0.9281 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.6224068178706894, 'auprc': 0.8040504935084066, 'loss_val': 0.581675341322431, 'psi': 0.6950642881257763}-{'f1_val': 0.6418290112626148, 'auprc': 0.8091953258928295, 'loss_val': 0.5207166763171804, 'psi': 0.7087755371147006}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.902551 cos_to_last_merge=0.9309 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=57 local utility u=0.000317 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9984182663730272, 'loss_val': 0.03260259240160345, 'psi': 0.9952409543387071}-{'f1_val': 0.993122746315827, 'auprc': 0.9982247254458763, 'loss_val': 0.032656095508269846, 'psi': 0.9951635379678467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=57 head_norm_before_train=2.177484 cos_to_last_merge=0.9606 (last merge round=14)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9991720002756679, 'loss_val': 0.028967685767442273, 'psi': 0.9942712027824805}-{'f1_val': 0.9968525854255906, 'auprc': 0.996750570430744, 'loss_val': 0.01711989891723031, 'psi': 0.9968117794276519}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=1.899112 cos_to_last_merge=0.9365 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=57 local utility u=0.000139 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995669520512901, 'loss_val': 0.027651305513111606, 'psi': 0.9953805116167853}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956122737751962, 'loss_val': 0.02775696094023757, 'psi': 0.9953576129217033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=57 head_norm_before_train=1.696358 cos_to_last_merge=0.8893 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.889
[S11] round=57 local utility u=0.000097 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981311105354164, 'loss_val': 0.02416551855446715, 'psi': 0.9971806469223203}-{'f1_val': 0.9965470045135896, 'auprc': 0.99815943097514, 'loss_val': 0.02444368452732307, 'psi': 0.9971919750982098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=57 head_norm_before_train=1.420843 cos_to_last_merge=0.8286 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.829
[S13] round=57 local utility u=0.042308 metrics={'f1_val': 0.6284001576029292, 'auprc': 0.7540858017204457, 'loss_val': 0.7606502360450462, 'psi': 0.6786744152499358}-{'f1_val': 0.6101766456044128, 'auprc': 0.7505919376844032, 'loss_val': 0.7254429483771755, 'psi': 0.666342762436409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=57 head_norm_before_train=2.106992 cos_to_last_merge=0.9421 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9967496941086456, 'loss_val': 0.026077712323176905, 'psi': 0.9973915884237893}-{'f1_val': 0.9978195179672185, 'auprc': 0.9967841058104147, 'loss_val': 0.024552800931957067, 'psi': 0.9974053531044969}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.802667 cos_to_last_merge=0.9028 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=57 local utility u=0.449047 metrics={'f1_val': 0.8081294769872578, 'auprc': 0.9711149967823068, 'loss_val': 0.33863147033403845, 'psi': 0.8733236849052775}-{'f1_val': 0.7543519426734007, 'auprc': 0.8524008029730338, 'loss_val': 0.5579185230597781, 'psi': 0.793571486793254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=57 head_norm_before_train=2.090265 (no previous merge yet)
[S16] round=57 local utility u=0.004374 metrics={'f1_val': 0.9940575246494802, 'auprc': 0.9898302800965575, 'loss_val': 0.03476158926132115, 'psi': 0.9923666268283111}-{'f1_val': 0.991856026463904, 'auprc': 0.9917628472525589, 'loss_val': 0.036099254639350854, 'psi': 0.991818754779366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=57 head_norm_before_train=1.672238 cos_to_last_merge=0.9030 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=57 local utility u=1.000000 metrics={'f1_val': 0.974417200564576, 'auprc': 0.9874635225535631, 'loss_val': 0.15244417448688516, 'psi': 0.979635729360171}-{'f1_val': 0.7421122017400332, 'auprc': 0.8785004033779195, 'loss_val': 0.703151757374504, 'psi': 0.7966674823951878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=58 head_norm_before_train=2.047202 cos_to_last_merge=0.9608 (last merge round=12)
[S2] round=58 local utility u=0.016396 metrics={'f1_val': 0.7204604785103204, 'auprc': 0.7403674738354827, 'loss_val': 0.9170585558244431, 'psi': 0.7284232766403853}-{'f1_val': 0.7207936216486811, 'auprc': 0.7359700436498133, 'loss_val': 0.9386564798266066, 'psi': 0.726864190449134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=58 head_norm_before_train=1.983091 cos_to_last_merge=0.7671 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.767
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9996139860216116, 'loss_val': 0.14799264892078617, 'psi': 0.9764906456483169}-{'f1_val': 0.9610750853994537, 'auprc': 0.9994398910942235, 'loss_val': 0.14566181607961948, 'psi': 0.9764210076773616}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.657848 cos_to_last_merge=0.9232 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=58 local utility u=0.057830 metrics={'f1_val': 0.9517973931029075, 'auprc': 0.9463708418367165, 'loss_val': 0.29884999755951785, 'psi': 0.9496267725964311}-{'f1_val': 0.9411425671762541, 'auprc': 0.934594419710669, 'loss_val': 0.31525259619687246, 'psi': 0.9385233081900202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=58 head_norm_before_train=1.538259 cos_to_last_merge=0.8297 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=58 local utility u=0.000154 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9901902419476324, 'loss_val': 0.03870837679174748, 'psi': 0.993437576803724}-{'f1_val': 0.9956024667077852, 'auprc': 0.9902739861846358, 'loss_val': 0.03926716083548487, 'psi': 0.9934710744985253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=58 head_norm_before_train=1.573117 cos_to_last_merge=0.8607 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7929761572861507, 'auprc': 0.9514891294074422, 'loss_val': 0.49692545342349037, 'psi': 0.8563813461346673}-{'f1_val': 0.9856152496208247, 'auprc': 0.9723184938506684, 'loss_val': 0.10152373387022672, 'psi': 0.9802965473127622}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.625432 cos_to_last_merge=0.9276 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=58 local utility u=0.151237 metrics={'f1_val': 0.6495264868476314, 'auprc': 0.8145079675058637, 'loss_val': 0.47329147189602483, 'psi': 0.7155190791109243}-{'f1_val': 0.6224068178706894, 'auprc': 0.8040504935084066, 'loss_val': 0.581675341322431, 'psi': 0.6950642881257763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=58 head_norm_before_train=1.910152 cos_to_last_merge=0.9304 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9333286721554319, 'auprc': 0.9962696029798188, 'loss_val': 0.13781063103489088, 'psi': 0.9585050444851866}-{'f1_val': 0.993122746315827, 'auprc': 0.9984182663730272, 'loss_val': 0.03260259240160345, 'psi': 0.9952409543387071}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.183894 cos_to_last_merge=0.9605 (last merge round=14)
[S9] round=58 local utility u=0.001965 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9995394780471354, 'loss_val': 0.027642098294447866, 'psi': 0.9945683901429987}-{'f1_val': 0.9910040044536889, 'auprc': 0.9991720002756679, 'loss_val': 0.028967685767442273, 'psi': 0.9942712027824805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=58 head_norm_before_train=1.903836 cos_to_last_merge=0.9360 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9954663082003997, 'loss_val': 0.027800479624273386, 'psi': 0.9950499452897632}-{'f1_val': 0.9951878390193748, 'auprc': 0.995669520512901, 'loss_val': 0.027651305513111606, 'psi': 0.9953805116167853}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=1.704220 cos_to_last_merge=0.8885 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=58 local utility u=0.000029 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980740632109996, 'loss_val': 0.023936449853376188, 'psi': 0.9971578279925536}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981311105354164, 'loss_val': 0.02416551855446715, 'psi': 0.9971806469223203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=58 head_norm_before_train=1.425463 cos_to_last_merge=0.8279 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.5998627625974084, 'auprc': 0.7563198236196673, 'loss_val': 0.813698743591102, 'psi': 0.662445587006312}-{'f1_val': 0.6284001576029292, 'auprc': 0.7540858017204457, 'loss_val': 0.7606502360450462, 'psi': 0.6786744152499358}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=2.113293 cos_to_last_merge=0.9416 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.942
[S14] round=58 local utility u=0.000000 metrics={'f1_val': 0.9348085321146704, 'auprc': 0.9961822709643892, 'loss_val': 0.09988845841896332, 'psi': 0.9593580276545579}-{'f1_val': 0.9978195179672185, 'auprc': 0.9967496941086456, 'loss_val': 0.026077712323176905, 'psi': 0.9973915884237893}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=58 head_norm_before_train=1.807616 cos_to_last_merge=0.9025 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=58 local utility u=0.748512 metrics={'f1_val': 0.995555212326873, 'auprc': 0.9921268793527338, 'loss_val': 0.029197221102217362, 'psi': 0.9941838791372173}-{'f1_val': 0.8081294769872578, 'auprc': 0.9711149967823068, 'loss_val': 0.33863147033403845, 'psi': 0.8733236849052775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=58 head_norm_before_train=2.092499 (no previous merge yet)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9216111711644441, 'auprc': 0.8896139408673349, 'loss_val': 0.4023578588754179, 'psi': 0.9088122790456004}-{'f1_val': 0.9940575246494802, 'auprc': 0.9898302800965575, 'loss_val': 0.03476158926132115, 'psi': 0.9923666268283111}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.685376 cos_to_last_merge=0.9009 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6778993695746385, 'auprc': 0.7182892573440264, 'loss_val': 1.0585835266495978, 'psi': 0.6940553246823936}-{'f1_val': 0.974417200564576, 'auprc': 0.9874635225535631, 'loss_val': 0.15244417448688516, 'psi': 0.979635729360171}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.051455 cos_to_last_merge=0.9604 (last merge round=12)
[S2] round=59 local utility u=0.057484 metrics={'f1_val': 0.7199744198364846, 'auprc': 0.7563207360382324, 'loss_val': 0.8470348936866408, 'psi': 0.7345129463171837}-{'f1_val': 0.7204604785103204, 'auprc': 0.7403674738354827, 'loss_val': 0.9170585558244431, 'psi': 0.7284232766403853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=60 psi=0.735 u=0.0575 p_local=0.0599 f1=0.720 auprc=0.756 bytes=59373
[S3] START round=59 head_norm_before_train=1.988814 cos_to_last_merge=0.7665 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.767
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9999692276474941, 'loss_val': 0.15345539458994192, 'psi': 0.9763784299439628}-{'f1_val': 0.9610750853994537, 'auprc': 0.9996139860216116, 'loss_val': 0.14799264892078617, 'psi': 0.9764906456483169}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.976 u=0.0000 p_local=0.0570 f1=0.961 auprc=1.000 bytes=52125
[S4] START round=59 head_norm_before_train=1.663885 cos_to_last_merge=0.9226 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9507254586681112, 'auprc': 0.9241681292100055, 'loss_val': 0.3089220771995913, 'psi': 0.9401025268848688}-{'f1_val': 0.9517973931029075, 'auprc': 0.9463708418367165, 'loss_val': 0.29884999755951785, 'psi': 0.9496267725964311}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.940 u=0.0000 p_local=0.0175 f1=0.951 auprc=0.924 bytes=66572
[S5] START round=59 head_norm_before_train=1.545915 cos_to_last_merge=0.8292 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9213570340957737, 'auprc': 0.9874775921046477, 'loss_val': 0.1161522330696957, 'psi': 0.9478052572993233}-{'f1_val': 0.9956024667077852, 'auprc': 0.9901902419476324, 'loss_val': 0.03870837679174748, 'psi': 0.993437576803724}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.948 u=0.0000 p_local=0.2077 f1=0.921 auprc=0.987 bytes=64726
[S6] START round=59 head_norm_before_train=1.574368 cos_to_last_merge=0.8601 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6057229741219554, 'auprc': 0.9081110731856478, 'loss_val': 0.9757533291474173, 'psi': 0.7266782137474324}-{'f1_val': 0.7929761572861507, 'auprc': 0.9514891294074422, 'loss_val': 0.49692545342349037, 'psi': 0.8563813461346673}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.727 u=0.0000 p_local=0.2569 f1=0.606 auprc=0.908 bytes=50346
[S7] START round=59 head_norm_before_train=1.631217 cos_to_last_merge=0.9271 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=59 local utility u=0.022869 metrics={'f1_val': 0.654369557744367, 'auprc': 0.8163568445234576, 'loss_val': 0.46215792194781535, 'psi': 0.7191644724560032}-{'f1_val': 0.6495264868476314, 'auprc': 0.8145079675058637, 'loss_val': 0.47329147189602483, 'psi': 0.7155190791109243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=60 psi=0.719 u=0.0229 p_local=0.0895 f1=0.654 auprc=0.816 bytes=62930
[S8] START round=59 head_norm_before_train=1.913923 cos_to_last_merge=0.9303 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=59 local utility u=0.236382 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9989638073806986, 'loss_val': 0.031893881508426036, 'psi': 0.9954591707417756}-{'f1_val': 0.9333286721554319, 'auprc': 0.9962696029798188, 'loss_val': 0.13781063103489088, 'psi': 0.9585050444851866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] r=60 psi=0.995 u=0.2364 p_local=0.0917 f1=0.993 auprc=0.999 bytes=66540
[S9] START round=59 head_norm_before_train=2.190098 cos_to_last_merge=0.9604 (last merge round=14)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9995333441011562, 'loss_val': 0.039909766010862574, 'psi': 0.9935451506092656}-{'f1_val': 0.991254331540241, 'auprc': 0.9995394780471354, 'loss_val': 0.027642098294447866, 'psi': 0.9945683901429987}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.994 u=0.0000 p_local=0.0020 f1=0.990 auprc=1.000 bytes=66472
[S10] START round=59 head_norm_before_train=1.905064 cos_to_last_merge=0.9355 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=59 local utility u=0.001945 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956766361833763, 'loss_val': 0.02703394240921493, 'psi': 0.9953833578849753}-{'f1_val': 0.9947723700160056, 'auprc': 0.9954663082003997, 'loss_val': 0.027800479624273386, 'psi': 0.9950499452897632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=60 psi=0.995 u=0.0019 p_local=0.0007 f1=0.995 auprc=0.996 bytes=77187
[S11] START round=59 head_norm_before_train=1.712559 cos_to_last_merge=0.8876 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.888
[S11] round=59 local utility u=0.000016 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997989360108916, 'loss_val': 0.023649555259953176, 'psi': 0.9971239467517201}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980740632109996, 'loss_val': 0.023936449853376188, 'psi': 0.9971578279925536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0084 f1=0.997 auprc=0.998 bytes=82766
[S13] START round=59 head_norm_before_train=1.431376 cos_to_last_merge=0.8272 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.5922209462200418, 'auprc': 0.6838811841531915, 'loss_val': 1.0442505480940933, 'psi': 0.6288850413933017}-{'f1_val': 0.5998627625974084, 'auprc': 0.7563198236196673, 'loss_val': 0.813698743591102, 'psi': 0.662445587006312}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.629 u=0.0000 p_local=0.0838 f1=0.592 auprc=0.684 bytes=59382
[S14] START round=59 head_norm_before_train=2.122301 cos_to_last_merge=0.9413 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=59 local utility u=0.043020 metrics={'f1_val': 0.9438328341761253, 'auprc': 0.99860458415683, 'loss_val': 0.07526036086150839, 'psi': 0.9657415341684071}-{'f1_val': 0.9348085321146704, 'auprc': 0.9961822709643892, 'loss_val': 0.09988845841896332, 'psi': 0.9593580276545579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S14] r=60 psi=0.966 u=0.0430 p_local=0.0557 f1=0.944 auprc=0.999 bytes=71952
[S15] START round=59 head_norm_before_train=1.815234 cos_to_last_merge=0.9019 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.902
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.7748205739665084, 'auprc': 0.8564038233374973, 'loss_val': 0.5383323575472402, 'psi': 0.807453873714904}-{'f1_val': 0.995555212326873, 'auprc': 0.9921268793527338, 'loss_val': 0.029197221102217362, 'psi': 0.9941838791372173}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.807 u=0.0000 p_local=0.3357 f1=0.775 auprc=0.856 bytes=68202
[S16] START round=59 head_norm_before_train=2.095657 (no previous merge yet)
[S16] round=59 local utility u=0.264927 metrics={'f1_val': 0.9423723728185467, 'auprc': 0.9804881179549367, 'loss_val': 0.26969264930038206, 'psi': 0.9576186708731027}-{'f1_val': 0.9216111711644441, 'auprc': 0.8896139408673349, 'loss_val': 0.4023578588754179, 'psi': 0.9088122790456004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=60 psi=0.958 u=0.2649 p_local=0.1233 f1=0.942 auprc=0.980 bytes=71918
[S17] START round=59 head_norm_before_train=1.695011 cos_to_last_merge=0.8983 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=59 local utility u=0.199983 metrics={'f1_val': 0.7064030586046677, 'auprc': 0.752498603455739, 'loss_val': 0.9322672533842837, 'psi': 0.7248412765450962}-{'f1_val': 0.6778993695746385, 'auprc': 0.7182892573440264, 'loss_val': 1.0585835266495978, 'psi': 0.6940553246823936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=60 psi=0.725 u=0.2000 p_local=0.2754 f1=0.706 auprc=0.752 bytes=59450
[S2] START round=60 head_norm_before_train=2.058022 cos_to_last_merge=0.9598 (last merge round=12)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.7172460450685458, 'auprc': 0.7541091644087858, 'loss_val': 0.8398070236752989, 'psi': 0.7319912928046419}-{'f1_val': 0.7199744198364846, 'auprc': 0.7563207360382324, 'loss_val': 0.8470348936866408, 'psi': 0.7345129463171837}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=60 head_norm_before_train=1.995061 cos_to_last_merge=0.7661 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.766
[S3] round=60 local utility u=0.054688 metrics={'f1_val': 0.9695457967499945, 'auprc': 0.9992679260612604, 'loss_val': 0.09534188796488378, 'psi': 0.9814346484745009}-{'f1_val': 0.960651231474942, 'auprc': 0.9999692276474941, 'loss_val': 0.15345539458994192, 'psi': 0.9763784299439628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=60 head_norm_before_train=1.669857 cos_to_last_merge=0.9219 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=60 local utility u=0.017735 metrics={'f1_val': 0.9486734405060607, 'auprc': 0.9383895411762888, 'loss_val': 0.3038047960318113, 'psi': 0.944559880774152}-{'f1_val': 0.9507254586681112, 'auprc': 0.9241681292100055, 'loss_val': 0.3089220771995913, 'psi': 0.9401025268848688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=60 head_norm_before_train=1.555533 cos_to_last_merge=0.8284 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=60 local utility u=0.267066 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9900648261630091, 'loss_val': 0.03701095525244333, 'psi': 0.9935630306019342}-{'f1_val': 0.9213570340957737, 'auprc': 0.9874775921046477, 'loss_val': 0.1161522330696957, 'psi': 0.9478052572993233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=60 head_norm_before_train=1.576828 cos_to_last_merge=0.8594 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=60 local utility u=1.000000 metrics={'f1_val': 0.8762263325332892, 'auprc': 0.9630980416597243, 'loss_val': 0.21569474294576407, 'psi': 0.9109750161838632}-{'f1_val': 0.6057229741219554, 'auprc': 0.9081110731856478, 'loss_val': 0.9757533291474173, 'psi': 0.7266782137474324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=60 head_norm_before_train=1.637496 cos_to_last_merge=0.9263 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.5995749484269515, 'auprc': 0.7992778658498907, 'loss_val': 0.7151811174913223, 'psi': 0.6794561153961272}-{'f1_val': 0.654369557744367, 'auprc': 0.8163568445234576, 'loss_val': 0.46215792194781535, 'psi': 0.7191644724560032}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=1.917418 cos_to_last_merge=0.9304 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.98220114491264, 'auprc': 0.9990029449348009, 'loss_val': 0.051325911431403574, 'psi': 0.9889218649215044}-{'f1_val': 0.993122746315827, 'auprc': 0.9989638073806986, 'loss_val': 0.031893881508426036, 'psi': 0.9954591707417756}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.196507 cos_to_last_merge=0.9601 (last merge round=14)
[S9] round=60 local utility u=0.030648 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9995342575368988, 'loss_val': 0.01645922748203923, 'psi': 0.9973297855405527}-{'f1_val': 0.9895530216146718, 'auprc': 0.9995333441011562, 'loss_val': 0.039909766010862574, 'psi': 0.9935451506092656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=60 head_norm_before_train=1.906032 cos_to_last_merge=0.9349 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=60 local utility u=0.000354 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958272321962497, 'loss_val': 0.026777165888160138, 'psi': 0.9954435962901247}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956766361833763, 'loss_val': 0.02703394240921493, 'psi': 0.9953833578849753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=60 head_norm_before_train=1.720683 cos_to_last_merge=0.8867 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.887
[S11] round=60 local utility u=0.000137 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979207017871458, 'loss_val': 0.023170010524930815, 'psi': 0.997096483423012}-{'f1_val': 0.9965470045135896, 'auprc': 0.997989360108916, 'loss_val': 0.023649555259953176, 'psi': 0.9971239467517201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=60 head_norm_before_train=1.438693 cos_to_last_merge=0.8261 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.826
[S13] round=60 local utility u=0.305659 metrics={'f1_val': 0.6109636058483356, 'auprc': 0.7581885119112737, 'loss_val': 0.7683106265522611, 'psi': 0.6698535682735108}-{'f1_val': 0.5922209462200418, 'auprc': 0.6838811841531915, 'loss_val': 1.0442505480940933, 'psi': 0.6288850413933017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=60 head_norm_before_train=2.132108 cos_to_last_merge=0.9408 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=60 local utility u=0.183159 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9986391837567499, 'loss_val': 0.025505398776301577, 'psi': 0.9974013080065154}-{'f1_val': 0.9438328341761253, 'auprc': 0.99860458415683, 'loss_val': 0.07526036086150839, 'psi': 0.9657415341684071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=60 head_norm_before_train=1.821596 cos_to_last_merge=0.9011 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.901
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.7010691361715489, 'auprc': 0.6742243490697352, 'loss_val': 0.7629115258419393, 'psi': 0.6903312213308234}-{'f1_val': 0.7748205739665084, 'auprc': 0.8564038233374973, 'loss_val': 0.5383323575472402, 'psi': 0.807453873714904}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.099225 (no previous merge yet)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8864624108803323, 'auprc': 0.9712828483973242, 'loss_val': 0.5885824996405721, 'psi': 0.9203905858871291}-{'f1_val': 0.9423723728185467, 'auprc': 0.9804881179549367, 'loss_val': 0.26969264930038206, 'psi': 0.9576186708731027}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=1.700112 cos_to_last_merge=0.8978 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=60 local utility u=1.000000 metrics={'f1_val': 0.9589304772318918, 'auprc': 0.9469196807012774, 'loss_val': 0.15691367207595178, 'psi': 0.9541261586196461}-{'f1_val': 0.7064030586046677, 'auprc': 0.752498603455739, 'loss_val': 0.9322672533842837, 'psi': 0.7248412765450962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=61 head_norm_before_train=2.064959 cos_to_last_merge=0.9592 (last merge round=12)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7205681345935564, 'auprc': 0.7459513134861926, 'loss_val': 0.9487669976764102, 'psi': 0.7307214061506109}-{'f1_val': 0.7172460450685458, 'auprc': 0.7541091644087858, 'loss_val': 0.8398070236752989, 'psi': 0.7319912928046419}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.002141 cos_to_last_merge=0.7656 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.766
[S3] round=61 local utility u=0.117856 metrics={'f1_val': 0.9968332416810847, 'auprc': 0.9995630310966455, 'loss_val': 0.024238959543824837, 'psi': 0.997925157447309}-{'f1_val': 0.9695457967499945, 'auprc': 0.9992679260612604, 'loss_val': 0.09534188796488378, 'psi': 0.9814346484745009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=61 head_norm_before_train=1.673707 cos_to_last_merge=0.9213 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9525460174124017, 'auprc': 0.9295209851200581, 'loss_val': 0.3056617027848265, 'psi': 0.9433360044954643}-{'f1_val': 0.9486734405060607, 'auprc': 0.9383895411762888, 'loss_val': 0.3038047960318113, 'psi': 0.944559880774152}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.567266 cos_to_last_merge=0.8274 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9895653073108489, 'loss_val': 0.0388247120770843, 'psi': 0.9933632230610702}-{'f1_val': 0.995895166894551, 'auprc': 0.9900648261630091, 'loss_val': 0.03701095525244333, 'psi': 0.9935630306019342}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.580042 cos_to_last_merge=0.8588 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.830058629705465, 'auprc': 0.8771646901359761, 'loss_val': 0.5349621892568516, 'psi': 0.8489010538776693}-{'f1_val': 0.8762263325332892, 'auprc': 0.9630980416597243, 'loss_val': 0.21569474294576407, 'psi': 0.9109750161838632}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.642637 cos_to_last_merge=0.9257 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=61 local utility u=0.088137 metrics={'f1_val': 0.61745402840063, 'auprc': 0.800758308839697, 'loss_val': 0.6506228180111959, 'psi': 0.6907757405762568}-{'f1_val': 0.5995749484269515, 'auprc': 0.7992778658498907, 'loss_val': 0.7151811174913223, 'psi': 0.6794561153961272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=61 head_norm_before_train=1.921651 cos_to_last_merge=0.9305 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=61 local utility u=0.038760 metrics={'f1_val': 0.9921866555464717, 'auprc': 0.998702311485057, 'loss_val': 0.032817063272801913, 'psi': 0.9947929179219057}-{'f1_val': 0.98220114491264, 'auprc': 0.9990029449348009, 'loss_val': 0.051325911431403574, 'psi': 0.9889218649215044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=61 head_norm_before_train=2.201081 cos_to_last_merge=0.9595 (last merge round=14)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.999169765425036, 'loss_val': 0.039127207549156925, 'psi': 0.9936538714104273}-{'f1_val': 0.9958601375429889, 'auprc': 0.9995342575368988, 'loss_val': 0.01645922748203923, 'psi': 0.9973297855405527}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.910334 cos_to_last_merge=0.9344 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956545582191387, 'loss_val': 0.026422227222384246, 'psi': 0.9953745266992804}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958272321962497, 'loss_val': 0.026777165888160138, 'psi': 0.9954435962901247}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.727534 cos_to_last_merge=0.8860 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.886
[S11] round=61 local utility u=0.000085 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978982192406608, 'loss_val': 0.0229334830738249, 'psi': 0.997087490404418}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979207017871458, 'loss_val': 0.023170010524930815, 'psi': 0.997096483423012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=61 head_norm_before_train=1.445496 cos_to_last_merge=0.8249 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.825
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.608325026837633, 'auprc': 0.7110598360415549, 'loss_val': 0.9657316022281515, 'psi': 0.6494189505192017}-{'f1_val': 0.6109636058483356, 'auprc': 0.7581885119112737, 'loss_val': 0.7683106265522611, 'psi': 0.6698535682735108}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=2.139290 cos_to_last_merge=0.9403 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=61 local utility u=0.006020 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9985967155956913, 'loss_val': 0.020798869967892944, 'psi': 0.9981303970186075}-{'f1_val': 0.9965760575063591, 'auprc': 0.9986391837567499, 'loss_val': 0.025505398776301577, 'psi': 0.9974013080065154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=61 head_norm_before_train=1.828793 cos_to_last_merge=0.9004 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.900
[S15] round=61 local utility u=1.000000 metrics={'f1_val': 0.9856661698652268, 'auprc': 0.9941306886175314, 'loss_val': 0.0809547228756575, 'psi': 0.9890519773661486}-{'f1_val': 0.7010691361715489, 'auprc': 0.6742243490697352, 'loss_val': 0.7629115258419393, 'psi': 0.6903312213308234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=61 head_norm_before_train=2.102223 (no previous merge yet)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8400938730832667, 'auprc': 0.854099223043416, 'loss_val': 1.2153315731369085, 'psi': 0.8456960130673264}-{'f1_val': 0.8864624108803323, 'auprc': 0.9712828483973242, 'loss_val': 0.5885824996405721, 'psi': 0.9203905858871291}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.702703 cos_to_last_merge=0.8979 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.5177509663432224, 'auprc': 0.7311981896044975, 'loss_val': 1.0464244050618345, 'psi': 0.6031298556477325}-{'f1_val': 0.9589304772318918, 'auprc': 0.9469196807012774, 'loss_val': 0.15691367207595178, 'psi': 0.9541261586196461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.072103 cos_to_last_merge=0.9586 (last merge round=12)
[S2] round=62 local utility u=0.035786 metrics={'f1_val': 0.7202452206762625, 'auprc': 0.7528908165679895, 'loss_val': 0.8960755901516535, 'psi': 0.7333034590329532}-{'f1_val': 0.7205681345935564, 'auprc': 0.7459513134861926, 'loss_val': 0.9487669976764102, 'psi': 0.7307214061506109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=62 head_norm_before_train=2.009239 cos_to_last_merge=0.7651 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.765
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9643043145689936, 'auprc': 0.9999544815658916, 'loss_val': 0.08510473800391703, 'psi': 0.9785643813677528}-{'f1_val': 0.9968332416810847, 'auprc': 0.9995630310966455, 'loss_val': 0.024238959543824837, 'psi': 0.997925157447309}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.677813 cos_to_last_merge=0.9210 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=62 local utility u=0.003868 metrics={'f1_val': 0.9474356412447286, 'auprc': 0.9446924304250146, 'loss_val': 0.31277848707042916, 'psi': 0.9463383569168431}-{'f1_val': 0.9525460174124017, 'auprc': 0.9295209851200581, 'loss_val': 0.3056617027848265, 'psi': 0.9433360044954643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=62 head_norm_before_train=1.577809 cos_to_last_merge=0.8263 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=62 local utility u=0.001209 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9896414755166026, 'loss_val': 0.036635970388162464, 'psi': 0.9933936903433717}-{'f1_val': 0.995895166894551, 'auprc': 0.9895653073108489, 'loss_val': 0.0388247120770843, 'psi': 0.9933632230610702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=62 head_norm_before_train=1.586354 cos_to_last_merge=0.8579 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6009283044190534, 'auprc': 0.7437690288106584, 'loss_val': 1.2707918913670595, 'psi': 0.6580645941756954}-{'f1_val': 0.830058629705465, 'auprc': 0.8771646901359761, 'loss_val': 0.5349621892568516, 'psi': 0.8489010538776693}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.646139 cos_to_last_merge=0.9251 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=62 local utility u=0.438138 metrics={'f1_val': 0.6829108009678762, 'auprc': 0.8504125436514249, 'loss_val': 0.3160494401540276, 'psi': 0.7499114980412956}-{'f1_val': 0.61745402840063, 'auprc': 0.800758308839697, 'loss_val': 0.6506228180111959, 'psi': 0.6907757405762568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=62 head_norm_before_train=1.925795 cos_to_last_merge=0.9303 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9890474964285507, 'auprc': 0.9990222996266618, 'loss_val': 0.03663814671413348, 'psi': 0.9930374177077951}-{'f1_val': 0.9921866555464717, 'auprc': 0.998702311485057, 'loss_val': 0.032817063272801913, 'psi': 0.9947929179219057}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.204591 cos_to_last_merge=0.9590 (last merge round=14)
[S9] round=62 local utility u=0.026355 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962730436706048, 'loss_val': 0.017830019365034, 'psi': 0.9965055245565768}-{'f1_val': 0.9899766087340214, 'auprc': 0.999169765425036, 'loss_val': 0.039127207549156925, 'psi': 0.9936538714104273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=62 head_norm_before_train=1.916242 cos_to_last_merge=0.9339 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955742022014629, 'loss_val': 0.026456976718555764, 'psi': 0.99534238429221}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956545582191387, 'loss_val': 0.026422227222384246, 'psi': 0.9953745266992804}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.734838 cos_to_last_merge=0.8852 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=62 local utility u=0.000085 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979616068168257, 'loss_val': 0.022953574788599232, 'psi': 0.997112845434884}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978982192406608, 'loss_val': 0.0229334830738249, 'psi': 0.997087490404418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=62 head_norm_before_train=1.452600 cos_to_last_merge=0.8236 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.824
[S13] round=62 local utility u=0.154612 metrics={'f1_val': 0.7046596996445331, 'auprc': 0.6637622705305569, 'loss_val': 1.092623297155417, 'psi': 0.6883007279989426}-{'f1_val': 0.608325026837633, 'auprc': 0.7110598360415549, 'loss_val': 0.9657316022281515, 'psi': 0.6494189505192017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=62 head_norm_before_train=2.145739 cos_to_last_merge=0.9398 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951442795271934, 'auprc': 0.9985660315763567, 'loss_val': 0.03749183543726976, 'psi': 0.9965129803468588}-{'f1_val': 0.9978195179672185, 'auprc': 0.9985967155956913, 'loss_val': 0.020798869967892944, 'psi': 0.9981303970186075}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.837672 cos_to_last_merge=0.8994 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.8145815540726234, 'auprc': 0.9753078512934654, 'loss_val': 0.3438091812382961, 'psi': 0.8788720729609603}-{'f1_val': 0.9856661698652268, 'auprc': 0.9941306886175314, 'loss_val': 0.0809547228756575, 'psi': 0.9890519773661486}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=2.107767 (no previous merge yet)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.838977238038041, 'auprc': 0.8502204387903086, 'loss_val': 1.2432454242541031, 'psi': 0.843474518338948}-{'f1_val': 0.8400938730832667, 'auprc': 0.854099223043416, 'loss_val': 1.2153315731369085, 'psi': 0.8456960130673264}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.705226 cos_to_last_merge=0.8974 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=62 local utility u=1.000000 metrics={'f1_val': 0.7874399297226391, 'auprc': 0.9515843264910249, 'loss_val': 0.392878572382594, 'psi': 0.8530976884299935}-{'f1_val': 0.5177509663432224, 'auprc': 0.7311981896044975, 'loss_val': 1.0464244050618345, 'psi': 0.6031298556477325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=63 head_norm_before_train=2.078529 cos_to_last_merge=0.9580 (last merge round=12)
[S2] round=63 local utility u=0.074071 metrics={'f1_val': 0.7190565637404278, 'auprc': 0.7776235571361612, 'loss_val': 0.8149996133662998, 'psi': 0.7424833610987212}-{'f1_val': 0.7202452206762625, 'auprc': 0.7528908165679895, 'loss_val': 0.8960755901516535, 'psi': 0.7333034590329532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=63 head_norm_before_train=2.015226 cos_to_last_merge=0.7649 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.765
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9996145500644722, 'loss_val': 0.14722319536047843, 'psi': 0.9763380118872695}-{'f1_val': 0.9643043145689936, 'auprc': 0.9999544815658916, 'loss_val': 0.08510473800391703, 'psi': 0.9785643813677528}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.681480 cos_to_last_merge=0.9205 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.921
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.942955334135033, 'auprc': 0.9523884947106658, 'loss_val': 0.31262734482807236, 'psi': 0.9467285983652861}-{'f1_val': 0.9474356412447286, 'auprc': 0.9446924304250146, 'loss_val': 0.31277848707042916, 'psi': 0.9463383569168431}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.585522 cos_to_last_merge=0.8259 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9899622062926298, 'loss_val': 0.036825376637836915, 'psi': 0.9933463625417229}-{'f1_val': 0.995895166894551, 'auprc': 0.9896414755166026, 'loss_val': 0.036635970388162464, 'psi': 0.9933936903433717}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.590964 cos_to_last_merge=0.8571 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=63 local utility u=1.000000 metrics={'f1_val': 0.8702756297376266, 'auprc': 0.9614160112405326, 'loss_val': 0.24147995970908392, 'psi': 0.906731782338789}-{'f1_val': 0.6009283044190534, 'auprc': 0.7437690288106584, 'loss_val': 1.2707918913670595, 'psi': 0.6580645941756954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=63 head_norm_before_train=1.652969 cos_to_last_merge=0.9239 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.615786423660721, 'auprc': 0.7997559412415085, 'loss_val': 0.708946750372108, 'psi': 0.6893742306930359}-{'f1_val': 0.6829108009678762, 'auprc': 0.8504125436514249, 'loss_val': 0.3160494401540276, 'psi': 0.7499114980412956}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.929247 cos_to_last_merge=0.9301 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.930
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9683842777879885, 'auprc': 0.9990299936663162, 'loss_val': 0.08213196682465122, 'psi': 0.9806425641393195}-{'f1_val': 0.9890474964285507, 'auprc': 0.9990222996266618, 'loss_val': 0.03663814671413348, 'psi': 0.9930374177077951}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=2.209319 cos_to_last_merge=0.9588 (last merge round=14)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959294687851996, 'loss_val': 0.017763859117110738, 'psi': 0.9963680946024147}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962730436706048, 'loss_val': 0.017830019365034, 'psi': 0.9965055245565768}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=1.923170 cos_to_last_merge=0.9335 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=63 local utility u=0.000048 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956378600043448, 'loss_val': 0.026552165368171884, 'psi': 0.9953678474133627}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955742022014629, 'loss_val': 0.026456976718555764, 'psi': 0.99534238429221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=63 head_norm_before_train=1.740921 cos_to_last_merge=0.8846 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.885
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980835344669703, 'loss_val': 0.023107759253413115, 'psi': 0.9969136187347737}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979616068168257, 'loss_val': 0.022953574788599232, 'psi': 0.997112845434884}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.458660 cos_to_last_merge=0.8224 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.822
[S13] round=63 local utility u=0.180286 metrics={'f1_val': 0.6481150317862887, 'auprc': 0.7518335427695629, 'loss_val': 0.6569978813233722, 'psi': 0.6896024361795985}-{'f1_val': 0.7046596996445331, 'auprc': 0.6637622705305569, 'loss_val': 1.092623297155417, 'psi': 0.6883007279989426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=63 head_norm_before_train=2.148998 cos_to_last_merge=0.9395 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.940
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9154348215084414, 'auprc': 0.9986789907946839, 'loss_val': 0.16202333131774535, 'psi': 0.9487324892229383}-{'f1_val': 0.9951442795271934, 'auprc': 0.9985660315763567, 'loss_val': 0.03749183543726976, 'psi': 0.9965129803468588}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.845030 cos_to_last_merge=0.8987 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=63 local utility u=0.428037 metrics={'f1_val': 0.9169404269475154, 'auprc': 0.9890268253842014, 'loss_val': 0.1430461096782265, 'psi': 0.9457749863221898}-{'f1_val': 0.8145815540726234, 'auprc': 0.9753078512934654, 'loss_val': 0.3438091812382961, 'psi': 0.8788720729609603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=63 head_norm_before_train=2.114412 (no previous merge yet)
[S16] round=63 local utility u=1.000000 metrics={'f1_val': 0.9918037267651041, 'auprc': 0.9926414150843396, 'loss_val': 0.031220082036813812, 'psi': 0.9921388020927983}-{'f1_val': 0.838977238038041, 'auprc': 0.8502204387903086, 'loss_val': 1.2432454242541031, 'psi': 0.843474518338948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=63 head_norm_before_train=1.709915 cos_to_last_merge=0.8971 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.7014253328220141, 'auprc': 0.8985165488838527, 'loss_val': 0.6439141569745656, 'psi': 0.7802618192467495}-{'f1_val': 0.7874399297226391, 'auprc': 0.9515843264910249, 'loss_val': 0.392878572382594, 'psi': 0.8530976884299935}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.085361 cos_to_last_merge=0.9573 (last merge round=12)
[S2] round=64 local utility u=0.063675 metrics={'f1_val': 0.7191127460861273, 'auprc': 0.8120475836844863, 'loss_val': 0.7912597733008939, 'psi': 0.7562866811254709}-{'f1_val': 0.7190565637404278, 'auprc': 0.7776235571361612, 'loss_val': 0.8149996133662998, 'psi': 0.7424833610987212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=64 head_norm_before_train=2.022196 cos_to_last_merge=0.7646 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.765
[S3] round=64 local utility u=0.008910 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9999567302925645, 'loss_val': 0.13048475163562484, 'psi': 0.9764804574997639}-{'f1_val': 0.9608203197691346, 'auprc': 0.9996145500644722, 'loss_val': 0.14722319536047843, 'psi': 0.9763380118872695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=64 head_norm_before_train=1.683811 cos_to_last_merge=0.9193 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9409235411004464, 'auprc': 0.9354964224256553, 'loss_val': 0.32188643747505447, 'psi': 0.9387526936305299}-{'f1_val': 0.942955334135033, 'auprc': 0.9523884947106658, 'loss_val': 0.31262734482807236, 'psi': 0.9467285983652861}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.592561 cos_to_last_merge=0.8253 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=64 local utility u=0.000280 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9899610876226002, 'loss_val': 0.036261644392355734, 'psi': 0.9933459150737112}-{'f1_val': 0.9956024667077852, 'auprc': 0.9899622062926298, 'loss_val': 0.036825376637836915, 'psi': 0.9933463625417229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=64 head_norm_before_train=1.595101 cos_to_last_merge=0.8567 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.857
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.8695087457116479, 'auprc': 0.9607351537656836, 'loss_val': 0.3072397712020564, 'psi': 0.9059993089332623}-{'f1_val': 0.8702756297376266, 'auprc': 0.9614160112405326, 'loss_val': 0.24147995970908392, 'psi': 0.906731782338789}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.658058 cos_to_last_merge=0.9227 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=64 local utility u=0.074701 metrics={'f1_val': 0.6209579905366377, 'auprc': 0.8015389044565179, 'loss_val': 0.595923258641166, 'psi': 0.6931903561045898}-{'f1_val': 0.615786423660721, 'auprc': 0.7997559412415085, 'loss_val': 0.708946750372108, 'psi': 0.6893742306930359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=64 head_norm_before_train=1.935621 cos_to_last_merge=0.9295 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=64 local utility u=0.096735 metrics={'f1_val': 0.992392260479464, 'auprc': 0.9988057442391783, 'loss_val': 0.03203659371613906, 'psi': 0.9949576539833498}-{'f1_val': 0.9683842777879885, 'auprc': 0.9990299936663162, 'loss_val': 0.08213196682465122, 'psi': 0.9806425641393195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=64 head_norm_before_train=2.214664 cos_to_last_merge=0.9587 (last merge round=14)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9991887911334596, 'loss_val': 0.035283547126206224, 'psi': 0.993915310636141}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959294687851996, 'loss_val': 0.017763859117110738, 'psi': 0.9963680946024147}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.930325 cos_to_last_merge=0.9331 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953630494920468, 'loss_val': 0.026491595487715083, 'psi': 0.9952579232084435}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956378600043448, 'loss_val': 0.026552165368171884, 'psi': 0.9953678474133627}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.747125 cos_to_last_merge=0.8840 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.884
[S11] round=64 local utility u=0.000056 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998109291762495, 'loss_val': 0.023072861940958707, 'psi': 0.9969239216529836}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980835344669703, 'loss_val': 0.023107759253413115, 'psi': 0.9969136187347737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=64 head_norm_before_train=1.463999 cos_to_last_merge=0.8215 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.821
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6901281857665713, 'auprc': 0.6983253935210079, 'loss_val': 0.9723705812214448, 'psi': 0.693407068868346}-{'f1_val': 0.6481150317862887, 'auprc': 0.7518335427695629, 'loss_val': 0.6569978813233722, 'psi': 0.6896024361795985}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.154237 cos_to_last_merge=0.9393 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=64 local utility u=0.291759 metrics={'f1_val': 0.9933129787852376, 'auprc': 0.9988778098053147, 'loss_val': 0.04637071310599057, 'psi': 0.9955389111932684}-{'f1_val': 0.9154348215084414, 'auprc': 0.9986789907946839, 'loss_val': 0.16202333131774535, 'psi': 0.9487324892229383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=64 head_norm_before_train=1.848241 cos_to_last_merge=0.8985 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.8439670000482438, 'auprc': 0.9804676090132154, 'loss_val': 0.3028472392909131, 'psi': 0.8985672436342325}-{'f1_val': 0.9169404269475154, 'auprc': 0.9890268253842014, 'loss_val': 0.1430461096782265, 'psi': 0.9457749863221898}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.121082 (no previous merge yet)
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.9929741658008825, 'auprc': 0.9921286383303899, 'loss_val': 0.04018609862090121, 'psi': 0.9926359548126855}-{'f1_val': 0.9918037267651041, 'auprc': 0.9926414150843396, 'loss_val': 0.031220082036813812, 'psi': 0.9921388020927983}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.717247 cos_to_last_merge=0.8965 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=64 local utility u=1.000000 metrics={'f1_val': 0.9736479823555334, 'auprc': 0.988809239678832, 'loss_val': 0.1939332991870577, 'psi': 0.9797124852848529}-{'f1_val': 0.7014253328220141, 'auprc': 0.8985165488838527, 'loss_val': 0.6439141569745656, 'psi': 0.7802618192467495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=65 head_norm_before_train=2.091053 cos_to_last_merge=0.9568 (last merge round=12)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7202452206762625, 'auprc': 0.7509798003993626, 'loss_val': 0.9095340351740663, 'psi': 0.7325390525655026}-{'f1_val': 0.7191127460861273, 'auprc': 0.8120475836844863, 'loss_val': 0.7912597733008939, 'psi': 0.7562866811254709}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.028762 cos_to_last_merge=0.7642 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.764
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.7327404652761762, 'auprc': 0.998129652390147, 'loss_val': 0.5241013498785495, 'psi': 0.8388961401217645}-{'f1_val': 0.9608296089712303, 'auprc': 0.9999567302925645, 'loss_val': 0.13048475163562484, 'psi': 0.9764804574997639}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.688221 cos_to_last_merge=0.9181 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=65 local utility u=0.027716 metrics={'f1_val': 0.9422532147572249, 'auprc': 0.9489115353194175, 'loss_val': 0.3146777011201541, 'psi': 0.944916542982102}-{'f1_val': 0.9409235411004464, 'auprc': 0.9354964224256553, 'loss_val': 0.32188643747505447, 'psi': 0.9387526936305299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=65 head_norm_before_train=1.598926 cos_to_last_merge=0.8248 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=65 local utility u=0.001349 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9900698470013122, 'loss_val': 0.03388909761492855, 'psi': 0.9933894188251959}-{'f1_val': 0.9956024667077852, 'auprc': 0.9899610876226002, 'loss_val': 0.036261644392355734, 'psi': 0.9933459150737112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=65 head_norm_before_train=1.598052 cos_to_last_merge=0.8559 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.5825776985747121, 'auprc': 0.8274753986048002, 'loss_val': 0.7918615353610126, 'psi': 0.6805367785867473}-{'f1_val': 0.8695087457116479, 'auprc': 0.9607351537656836, 'loss_val': 0.3072397712020564, 'psi': 0.9059993089332623}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.662479 cos_to_last_merge=0.9219 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.6192240088528428, 'auprc': 0.7999264703268024, 'loss_val': 0.6327257590938593, 'psi': 0.6915049934424267}-{'f1_val': 0.6209579905366377, 'auprc': 0.8015389044565179, 'loss_val': 0.595923258641166, 'psi': 0.6931903561045898}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.943555 cos_to_last_merge=0.9289 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=65 local utility u=0.003278 metrics={'f1_val': 0.9933028091142196, 'auprc': 0.9985249726225347, 'loss_val': 0.03010138623813104, 'psi': 0.9953916745175457}-{'f1_val': 0.992392260479464, 'auprc': 0.9988057442391783, 'loss_val': 0.03203659371613906, 'psi': 0.9949576539833498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=65 head_norm_before_train=2.219825 cos_to_last_merge=0.9588 (last merge round=14)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9991894462222911, 'loss_val': 0.03690319274454332, 'psi': 0.9939155726716736}-{'f1_val': 0.990399656971262, 'auprc': 0.9991887911334596, 'loss_val': 0.035283547126206224, 'psi': 0.993915310636141}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=1.933378 cos_to_last_merge=0.9325 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=65 local utility u=0.000050 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953134218362296, 'loss_val': 0.02624175420132459, 'psi': 0.9952380721461167}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953630494920468, 'loss_val': 0.026491595487715083, 'psi': 0.9952579232084435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=65 head_norm_before_train=1.754002 cos_to_last_merge=0.8833 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=65 local utility u=0.000183 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980461964249677, 'loss_val': 0.022517455151213353, 'psi': 0.9968986835179727}-{'f1_val': 0.9961336749133093, 'auprc': 0.998109291762495, 'loss_val': 0.023072861940958707, 'psi': 0.9969239216529836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=65 head_norm_before_train=1.470195 cos_to_last_merge=0.8205 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.820
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.7163984599247315, 'auprc': 0.66267230863938, 'loss_val': 1.1119098285821567, 'psi': 0.6949079994105909}-{'f1_val': 0.6901281857665713, 'auprc': 0.6983253935210079, 'loss_val': 0.9723705812214448, 'psi': 0.693407068868346}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.162000 cos_to_last_merge=0.9389 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=65 local utility u=0.023857 metrics={'f1_val': 0.997411628228889, 'auprc': 0.999007962388474, 'loss_val': 0.02363932997121648, 'psi': 0.998050161892723}-{'f1_val': 0.9933129787852376, 'auprc': 0.9988778098053147, 'loss_val': 0.04637071310599057, 'psi': 0.9955389111932684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=65 head_norm_before_train=1.850611 cos_to_last_merge=0.8982 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.7722535181496275, 'auprc': 0.9275002714623481, 'loss_val': 0.5145253513940528, 'psi': 0.8343522194747157}-{'f1_val': 0.8439670000482438, 'auprc': 0.9804676090132154, 'loss_val': 0.3028472392909131, 'psi': 0.8985672436342325}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.126430 (no previous merge yet)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8974628413841983, 'auprc': 0.9001047128430468, 'loss_val': 0.5490521169254038, 'psi': 0.8985195899677376}-{'f1_val': 0.9929741658008825, 'auprc': 0.9921286383303899, 'loss_val': 0.04018609862090121, 'psi': 0.9926359548126855}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.723383 cos_to_last_merge=0.8955 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.7240452198608421, 'auprc': 0.9083963097480757, 'loss_val': 0.6910459849682358, 'psi': 0.7977856558157356}-{'f1_val': 0.9736479823555334, 'auprc': 0.988809239678832, 'loss_val': 0.1939332991870577, 'psi': 0.9797124852848529}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=2.094555 cos_to_last_merge=0.9567 (last merge round=12)
[S2] round=66 local utility u=0.007600 metrics={'f1_val': 0.7193181948658098, 'auprc': 0.7475484634153741, 'loss_val': 0.8784778789735785, 'psi': 0.7306103022856355}-{'f1_val': 0.7202452206762625, 'auprc': 0.7509798003993626, 'loss_val': 0.9095340351740663, 'psi': 0.7325390525655026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=66 head_norm_before_train=2.033921 cos_to_last_merge=0.7636 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.764
[S3] round=66 local utility u=1.000000 metrics={'f1_val': 0.9968752412829052, 'auprc': 0.9997163354488869, 'loss_val': 0.026958769194486157, 'psi': 0.9980116789492979}-{'f1_val': 0.7327404652761762, 'auprc': 0.998129652390147, 'loss_val': 0.5241013498785495, 'psi': 0.8388961401217645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=66 head_norm_before_train=1.691747 cos_to_last_merge=0.9171 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9395872839427684, 'auprc': 0.9281379275200005, 'loss_val': 0.3357529934379114, 'psi': 0.9350075413736612}-{'f1_val': 0.9422532147572249, 'auprc': 0.9489115353194175, 'loss_val': 0.3146777011201541, 'psi': 0.944916542982102}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.608715 cos_to_last_merge=0.8240 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9895755695975256, 'loss_val': 0.03623191937051254, 'psi': 0.9931917078636813}-{'f1_val': 0.9956024667077852, 'auprc': 0.9900698470013122, 'loss_val': 0.03388909761492855, 'psi': 0.9933894188251959}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.604605 cos_to_last_merge=0.8547 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.855
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.8893370693148366, 'auprc': 0.960322407195201, 'loss_val': 0.257981502904562, 'psi': 0.9177312044669823}-{'f1_val': 0.5825776985747121, 'auprc': 0.8274753986048002, 'loss_val': 0.7918615353610126, 'psi': 0.6805367785867473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=66 head_norm_before_train=1.665734 cos_to_last_merge=0.9217 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6046091860909005, 'auprc': 0.79623319004314, 'loss_val': 0.8018084350826487, 'psi': 0.6812587876717964}-{'f1_val': 0.6192240088528428, 'auprc': 0.7999264703268024, 'loss_val': 0.6327257590938593, 'psi': 0.6915049934424267}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.949758 cos_to_last_merge=0.9287 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9901293815575051, 'auprc': 0.9988864163495961, 'loss_val': 0.03573926009383939, 'psi': 0.9936321954743415}-{'f1_val': 0.9933028091142196, 'auprc': 0.9985249726225347, 'loss_val': 0.03010138623813104, 'psi': 0.9953916745175457}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.222181 cos_to_last_merge=0.9585 (last merge round=14)
[S9] round=66 local utility u=0.000477 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9991818940009931, 'loss_val': 0.03592596867466431, 'psi': 0.9939125517831544}-{'f1_val': 0.990399656971262, 'auprc': 0.9991894462222911, 'loss_val': 0.03690319274454332, 'psi': 0.9939155726716736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=66 head_norm_before_train=1.936872 cos_to_last_merge=0.9320 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=66 local utility u=0.001613 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9954046772331772, 'loss_val': 0.02581992244568159, 'psi': 0.9955276630022827}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953134218362296, 'loss_val': 0.02624175420132459, 'psi': 0.9952380721461167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=66 head_norm_before_train=1.759467 cos_to_last_merge=0.8827 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.883
[S11] round=66 local utility u=0.000102 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980753395675767, 'loss_val': 0.02240060959392351, 'psi': 0.9969103407750163}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980461964249677, 'loss_val': 0.022517455151213353, 'psi': 0.9968986835179727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=66 head_norm_before_train=1.477574 cos_to_last_merge=0.8188 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=66 local utility u=0.049645 metrics={'f1_val': 0.6597268567278293, 'auprc': 0.732670293101513, 'loss_val': 0.8825832208249401, 'psi': 0.6889042312773028}-{'f1_val': 0.7163984599247315, 'auprc': 0.66267230863938, 'loss_val': 1.1119098285821567, 'psi': 0.6949079994105909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=66 head_norm_before_train=2.165206 cos_to_last_merge=0.9385 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9485068396501819, 'auprc': 0.9985731639496388, 'loss_val': 0.12234202758607926, 'psi': 0.9685333693699647}-{'f1_val': 0.997411628228889, 'auprc': 0.999007962388474, 'loss_val': 0.02363932997121648, 'psi': 0.998050161892723}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.854727 cos_to_last_merge=0.8977 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=66 local utility u=0.879385 metrics={'f1_val': 0.9616036187125805, 'auprc': 0.9910269462010544, 'loss_val': 0.08243579433444387, 'psi': 0.97337294970797}-{'f1_val': 0.7722535181496275, 'auprc': 0.9275002714623481, 'loss_val': 0.5145253513940528, 'psi': 0.8343522194747157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=66 head_norm_before_train=2.132539 (no previous merge yet)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.8463144590813756, 'auprc': 0.8492697808859768, 'loss_val': 1.2197920381569471, 'psi': 0.8474965878032161}-{'f1_val': 0.8974628413841983, 'auprc': 0.9001047128430468, 'loss_val': 0.5490521169254038, 'psi': 0.8985195899677376}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=1.730161 cos_to_last_merge=0.8945 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=66 local utility u=0.855596 metrics={'f1_val': 0.9037160304848927, 'auprc': 0.9680132550105678, 'loss_val': 0.23672933836870683, 'psi': 0.9294349202951628}-{'f1_val': 0.7240452198608421, 'auprc': 0.9083963097480757, 'loss_val': 0.6910459849682358, 'psi': 0.7977856558157356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=67 head_norm_before_train=2.098895 cos_to_last_merge=0.9564 (last merge round=12)
[S2] round=67 local utility u=0.023773 metrics={'f1_val': 0.7201961609544548, 'auprc': 0.7735361390950524, 'loss_val': 0.9141635957489527, 'psi': 0.7415321522106939}-{'f1_val': 0.7193181948658098, 'auprc': 0.7475484634153741, 'loss_val': 0.8784778789735785, 'psi': 0.7306103022856355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=67 head_norm_before_train=2.039406 cos_to_last_merge=0.7633 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.763
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9996006432463134, 'loss_val': 0.12918021954172038, 'psi': 0.9763085489153847}-{'f1_val': 0.9968752412829052, 'auprc': 0.9997163354488869, 'loss_val': 0.026958769194486157, 'psi': 0.9980116789492979}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.695648 cos_to_last_merge=0.9159 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=67 local utility u=0.006504 metrics={'f1_val': 0.9390602826923171, 'auprc': 0.9327528150362496, 'loss_val': 0.33342747076360113, 'psi': 0.9365372956298901}-{'f1_val': 0.9395872839427684, 'auprc': 0.9281379275200005, 'loss_val': 0.3357529934379114, 'psi': 0.9350075413736612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=67 head_norm_before_train=1.620684 cos_to_last_merge=0.8229 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=67 local utility u=0.002367 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9900600354939281, 'loss_val': 0.03295039203565667, 'psi': 0.9933854942222423}-{'f1_val': 0.9956024667077852, 'auprc': 0.9895755695975256, 'loss_val': 0.03623191937051254, 'psi': 0.9931917078636813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=67 head_norm_before_train=1.608451 cos_to_last_merge=0.8542 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.8692465771564837, 'auprc': 0.952633118708742, 'loss_val': 0.262903946726468, 'psi': 0.902601193777387}-{'f1_val': 0.8893370693148366, 'auprc': 0.960322407195201, 'loss_val': 0.257981502904562, 'psi': 0.9177312044669823}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.669265 cos_to_last_merge=0.9215 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.5577326605977123, 'auprc': 0.7829438251435418, 'loss_val': 1.0849418811930192, 'psi': 0.6478171264160442}-{'f1_val': 0.6046091860909005, 'auprc': 0.79623319004314, 'loss_val': 0.8018084350826487, 'psi': 0.6812587876717964}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=1.954684 cos_to_last_merge=0.9280 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.928
[S8] round=67 local utility u=0.013672 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9984026300739541, 'loss_val': 0.030768227802606015, 'psi': 0.9958210602436606}-{'f1_val': 0.9901293815575051, 'auprc': 0.9988864163495961, 'loss_val': 0.03573926009383939, 'psi': 0.9936321954743415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=67 head_norm_before_train=2.224859 cos_to_last_merge=0.9582 (last merge round=14)
[S9] round=67 local utility u=0.028985 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9991837133725063, 'loss_val': 0.015698656832593017, 'psi': 0.9976869743277057}-{'f1_val': 0.990399656971262, 'auprc': 0.9991818940009931, 'loss_val': 0.03592596867466431, 'psi': 0.9939125517831544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=67 head_norm_before_train=1.942377 cos_to_last_merge=0.9315 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=67 local utility u=0.000449 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9956383440086554, 'loss_val': 0.025623196548111963, 'psi': 0.995621129712474}-{'f1_val': 0.9956096535150197, 'auprc': 0.9954046772331772, 'loss_val': 0.02581992244568159, 'psi': 0.9955276630022827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=67 head_norm_before_train=1.765122 cos_to_last_merge=0.8822 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981246205827566, 'loss_val': 0.024429403509539975, 'psi': 0.9969300531810883}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980753395675767, 'loss_val': 0.02240060959392351, 'psi': 0.9969103407750163}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.483117 cos_to_last_merge=0.8172 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.817
[S13] round=67 local utility u=0.067270 metrics={'f1_val': 0.6470480244313346, 'auprc': 0.7476891131130842, 'loss_val': 0.717026384562472, 'psi': 0.6873044599040343}-{'f1_val': 0.6597268567278293, 'auprc': 0.732670293101513, 'loss_val': 0.8825832208249401, 'psi': 0.6889042312773028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=67 head_norm_before_train=2.164778 cos_to_last_merge=0.9384 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9346287572495694, 'auprc': 0.9968264871151326, 'loss_val': 0.13664557503495053, 'psi': 0.9595078491957947}-{'f1_val': 0.9485068396501819, 'auprc': 0.9985731639496388, 'loss_val': 0.12234202758607926, 'psi': 0.9685333693699647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.859125 cos_to_last_merge=0.8972 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.897
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.7820882834762095, 'auprc': 0.9069854660744822, 'loss_val': 0.43447967042856245, 'psi': 0.8320471565155185}-{'f1_val': 0.9616036187125805, 'auprc': 0.9910269462010544, 'loss_val': 0.08243579433444387, 'psi': 0.97337294970797}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=2.136499 (no previous merge yet)
[S16] round=67 local utility u=0.194706 metrics={'f1_val': 0.8603367962056012, 'auprc': 0.8963000746207973, 'loss_val': 1.0556055975198038, 'psi': 0.8747221075716796}-{'f1_val': 0.8463144590813756, 'auprc': 0.8492697808859768, 'loss_val': 1.2197920381569471, 'psi': 0.8474965878032161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=67 head_norm_before_train=1.741189 cos_to_last_merge=0.8941 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=67 local utility u=0.117659 metrics={'f1_val': 0.9380515944353074, 'auprc': 0.9705134469523229, 'loss_val': 0.2149252422057523, 'psi': 0.9510363354421136}-{'f1_val': 0.9037160304848927, 'auprc': 0.9680132550105678, 'loss_val': 0.23672933836870683, 'psi': 0.9294349202951628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=68 head_norm_before_train=2.102828 cos_to_last_merge=0.9561 (last merge round=12)
[S2] round=68 local utility u=0.027221 metrics={'f1_val': 0.7121380535610202, 'auprc': 0.7744164863812371, 'loss_val': 0.8140132930626954, 'psi': 0.737049426689107}-{'f1_val': 0.7201961609544548, 'auprc': 0.7735361390950524, 'loss_val': 0.9141635957489527, 'psi': 0.7415321522106939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=68 head_norm_before_train=2.045369 cos_to_last_merge=0.7630 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.763
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.999952912937697, 'loss_val': 0.1340480928863151, 'psi': 0.9766503195157703}-{'f1_val': 0.9607804860280988, 'auprc': 0.9996006432463134, 'loss_val': 0.12918021954172038, 'psi': 0.9763085489153847}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.697754 cos_to_last_merge=0.9147 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=68 local utility u=0.052082 metrics={'f1_val': 0.943267194265079, 'auprc': 0.9518881518113071, 'loss_val': 0.3119112440472199, 'psi': 0.9467155772835703}-{'f1_val': 0.9390602826923171, 'auprc': 0.9327528150362496, 'loss_val': 0.33342747076360113, 'psi': 0.9365372956298901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=68 head_norm_before_train=1.629608 cos_to_last_merge=0.8220 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=68 local utility u=0.004152 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9914820882732964, 'loss_val': 0.03154405600180344, 'psi': 0.9942175018136417}-{'f1_val': 0.9956024667077852, 'auprc': 0.9900600354939281, 'loss_val': 0.03295039203565667, 'psi': 0.9933854942222423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=68 head_norm_before_train=1.613662 cos_to_last_merge=0.8538 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6130438132330917, 'auprc': 0.9120316801266634, 'loss_val': 0.8564443693253434, 'psi': 0.7326389599905203}-{'f1_val': 0.8692465771564837, 'auprc': 0.952633118708742, 'loss_val': 0.262903946726468, 'psi': 0.902601193777387}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.675567 cos_to_last_merge=0.9209 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=68 local utility u=1.000000 metrics={'f1_val': 0.7269131953330499, 'auprc': 0.982234477490056, 'loss_val': 0.17413206927302066, 'psi': 0.8290417081958523}-{'f1_val': 0.5577326605977123, 'auprc': 0.7829438251435418, 'loss_val': 1.0849418811930192, 'psi': 0.6478171264160442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=68 head_norm_before_train=1.960157 cos_to_last_merge=0.9274 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.927
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9832505925752337, 'auprc': 0.9989858303605924, 'loss_val': 0.052336171667818, 'psi': 0.9895446876893772}-{'f1_val': 0.9941000136901317, 'auprc': 0.9984026300739541, 'loss_val': 0.030768227802606015, 'psi': 0.9958210602436606}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.226842 cos_to_last_merge=0.9579 (last merge round=14)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9942525747016975, 'loss_val': 0.017206192056504945, 'psi': 0.9959627773879647}-{'f1_val': 0.9966891482978385, 'auprc': 0.9991837133725063, 'loss_val': 0.015698656832593017, 'psi': 0.9976869743277057}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=1.948685 cos_to_last_merge=0.9311 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9952054416103022, 'loss_val': 0.02574031429280294, 'psi': 0.9954479687531328}-{'f1_val': 0.9956096535150197, 'auprc': 0.9956383440086554, 'loss_val': 0.025623196548111963, 'psi': 0.995621129712474}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.770307 cos_to_last_merge=0.8816 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.882
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998158771033111, 'loss_val': 0.024707238909538073, 'psi': 0.99694371336123}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981246205827566, 'loss_val': 0.024429403509539975, 'psi': 0.9969300531810883}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.487749 cos_to_last_merge=0.8162 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=68 local utility u=0.117868 metrics={'f1_val': 0.722364812409521, 'auprc': 0.7322586678291128, 'loss_val': 0.886899004432968, 'psi': 0.7263223545773577}-{'f1_val': 0.6470480244313346, 'auprc': 0.7476891131130842, 'loss_val': 0.717026384562472, 'psi': 0.6873044599040343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=68 head_norm_before_train=2.167143 cos_to_last_merge=0.9381 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=68 local utility u=0.011262 metrics={'f1_val': 0.9360686471552662, 'auprc': 0.9989884740241586, 'loss_val': 0.1292470454595628, 'psi': 0.9612365779028231}-{'f1_val': 0.9346287572495694, 'auprc': 0.9968264871151326, 'loss_val': 0.13664557503495053, 'psi': 0.9595078491957947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=68 head_norm_before_train=1.863457 cos_to_last_merge=0.8965 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=68 local utility u=0.948370 metrics={'f1_val': 0.990502085927111, 'auprc': 0.992237610041773, 'loss_val': 0.04397801051537736, 'psi': 0.9911962955729758}-{'f1_val': 0.7820882834762095, 'auprc': 0.9069854660744822, 'loss_val': 0.43447967042856245, 'psi': 0.8320471565155185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=68 head_norm_before_train=2.141018 (no previous merge yet)
[S16] round=68 local utility u=0.563140 metrics={'f1_val': 0.9101772300747959, 'auprc': 0.9903752032102391, 'loss_val': 0.5105932601785077, 'psi': 0.9422564193289732}-{'f1_val': 0.8603367962056012, 'auprc': 0.8963000746207973, 'loss_val': 1.0556055975198038, 'psi': 0.8747221075716796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=68 head_norm_before_train=1.748686 cos_to_last_merge=0.8940 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.6686055148389753, 'auprc': 0.6671829903241917, 'loss_val': 1.1196031519567882, 'psi': 0.6680365050330619}-{'f1_val': 0.9380515944353074, 'auprc': 0.9705134469523229, 'loss_val': 0.2149252422057523, 'psi': 0.9510363354421136}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.106925 cos_to_last_merge=0.9557 (last merge round=12)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7205120403215745, 'auprc': 0.7760762825637125, 'loss_val': 0.9628905825167955, 'psi': 0.7427377372184296}-{'f1_val': 0.7121380535610202, 'auprc': 0.7744164863812371, 'loss_val': 0.8140132930626954, 'psi': 0.737049426689107}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.048821 cos_to_last_merge=0.7625 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.763
[S3] round=69 local utility u=0.074490 metrics={'f1_val': 0.9768003117646054, 'auprc': 0.9992256587130739, 'loss_val': 0.07699643719524228, 'psi': 0.9857704505439928}-{'f1_val': 0.9611152572344858, 'auprc': 0.999952912937697, 'loss_val': 0.1340480928863151, 'psi': 0.9766503195157703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=69 head_norm_before_train=1.699551 cos_to_last_merge=0.9140 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9394703354317401, 'auprc': 0.9394893139026115, 'loss_val': 0.3294473521597522, 'psi': 0.9394779268200886}-{'f1_val': 0.943267194265079, 'auprc': 0.9518881518113071, 'loss_val': 0.3119112440472199, 'psi': 0.9467155772835703}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.636665 cos_to_last_merge=0.8214 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9915650334555418, 'loss_val': 0.03164448594796162, 'psi': 0.9939874934068877}-{'f1_val': 0.9960411108405385, 'auprc': 0.9914820882732964, 'loss_val': 0.03154405600180344, 'psi': 0.9942175018136417}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.619568 cos_to_last_merge=0.8528 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=69 local utility u=1.000000 metrics={'f1_val': 0.8661047328285599, 'auprc': 0.9507820089961393, 'loss_val': 0.31758655573315464, 'psi': 0.8999756432955917}-{'f1_val': 0.6130438132330917, 'auprc': 0.9120316801266634, 'loss_val': 0.8564443693253434, 'psi': 0.7326389599905203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=69 head_norm_before_train=1.679518 cos_to_last_merge=0.9206 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5496860678265381, 'auprc': 0.7789588988869216, 'loss_val': 1.1357143793204332, 'psi': 0.6413952002506915}-{'f1_val': 0.7269131953330499, 'auprc': 0.982234477490056, 'loss_val': 0.17413206927302066, 'psi': 0.8290417081958523}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.963481 cos_to_last_merge=0.9265 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=69 local utility u=0.009680 metrics={'f1_val': 0.9853629043478473, 'auprc': 0.9989509619835326, 'loss_val': 0.04554573757089375, 'psi': 0.9907981274021215}-{'f1_val': 0.9832505925752337, 'auprc': 0.9989858303605924, 'loss_val': 0.052336171667818, 'psi': 0.9895446876893772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=69 head_norm_before_train=2.228375 cos_to_last_merge=0.9574 (last merge round=14)
[S9] round=69 local utility u=0.008309 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991673721093803, 'loss_val': 0.01533248062964845, 'psi': 0.9979286963510379}-{'f1_val': 0.9971029125121428, 'auprc': 0.9942525747016975, 'loss_val': 0.017206192056504945, 'psi': 0.9959627773879647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=69 head_norm_before_train=1.954005 cos_to_last_merge=0.9307 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951265201532826, 'loss_val': 0.02554834487741319, 'psi': 0.9951633114729379}-{'f1_val': 0.9956096535150197, 'auprc': 0.9952054416103022, 'loss_val': 0.02574031429280294, 'psi': 0.9954479687531328}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.776536 cos_to_last_merge=0.8809 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.881
[S11] round=69 local utility u=0.000598 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981934271978266, 'loss_val': 0.02361503220714876, 'psi': 0.9969575758271162}-{'f1_val': 0.9961336749133093, 'auprc': 0.998158771033111, 'loss_val': 0.024707238909538073, 'psi': 0.99694371336123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=69 head_norm_before_train=1.492495 cos_to_last_merge=0.8153 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6428873268119442, 'auprc': 0.6573428363790352, 'loss_val': 1.0496575193612607, 'psi': 0.6486695306387806}-{'f1_val': 0.722364812409521, 'auprc': 0.7322586678291128, 'loss_val': 0.886899004432968, 'psi': 0.7263223545773577}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.172976 cos_to_last_merge=0.9378 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=69 local utility u=0.037070 metrics={'f1_val': 0.9423871583195944, 'auprc': 0.9989869154798292, 'loss_val': 0.09301378284975027, 'psi': 0.9650270611836883}-{'f1_val': 0.9360686471552662, 'auprc': 0.9989884740241586, 'loss_val': 0.1292470454595628, 'psi': 0.9612365779028231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=69 head_norm_before_train=1.871512 cos_to_last_merge=0.8957 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=69 local utility u=0.008812 metrics={'f1_val': 0.9919628496751991, 'auprc': 0.9928451789882332, 'loss_val': 0.03694103126753351, 'psi': 0.9923157814004127}-{'f1_val': 0.990502085927111, 'auprc': 0.992237610041773, 'loss_val': 0.04397801051537736, 'psi': 0.9911962955729758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=69 head_norm_before_train=2.146729 (no previous merge yet)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.861709403214693, 'auprc': 0.891645461998066, 'loss_val': 1.0528645608341236, 'psi': 0.8736838267280422}-{'f1_val': 0.9101772300747959, 'auprc': 0.9903752032102391, 'loss_val': 0.5105932601785077, 'psi': 0.9422564193289732}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.757045 cos_to_last_merge=0.8934 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=69 local utility u=0.648379 metrics={'f1_val': 0.7218140244062087, 'auprc': 0.8991555002688807, 'loss_val': 0.8380138507443431, 'psi': 0.7927506147512775}-{'f1_val': 0.6686055148389753, 'auprc': 0.6671829903241917, 'loss_val': 1.1196031519567882, 'psi': 0.6680365050330619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=70 head_norm_before_train=2.110709 cos_to_last_merge=0.9554 (last merge round=12)
[S2] round=70 local utility u=0.070693 metrics={'f1_val': 0.7185493215844245, 'auprc': 0.7795041598113502, 'loss_val': 0.8200117052245346, 'psi': 0.7429312568751949}-{'f1_val': 0.7205120403215745, 'auprc': 0.7760762825637125, 'loss_val': 0.9628905825167955, 'psi': 0.7427377372184296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=70 head_norm_before_train=2.054122 cos_to_last_merge=0.7621 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.762
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9999374666958663, 'loss_val': 0.14004499816548732, 'psi': 0.976644141019038}-{'f1_val': 0.9768003117646054, 'auprc': 0.9992256587130739, 'loss_val': 0.07699643719524228, 'psi': 0.9857704505439928}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=1.696532 cos_to_last_merge=0.9132 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=70 local utility u=0.069883 metrics={'f1_val': 0.9445206265788757, 'auprc': 0.9693610711307351, 'loss_val': 0.3095977718129314, 'psi': 0.9544568043996194}-{'f1_val': 0.9394703354317401, 'auprc': 0.9394893139026115, 'loss_val': 0.3294473521597522, 'psi': 0.9394779268200886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=70 head_norm_before_train=1.643912 cos_to_last_merge=0.8209 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.990906343279253, 'loss_val': 0.03169755238426799, 'psi': 0.9937240173363723}-{'f1_val': 0.9956024667077852, 'auprc': 0.9915650334555418, 'loss_val': 0.03164448594796162, 'psi': 0.9939874934068877}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.623675 cos_to_last_merge=0.8523 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.7598855237001204, 'auprc': 0.9174562422122805, 'loss_val': 0.49037632848390544, 'psi': 0.8229138111049845}-{'f1_val': 0.8661047328285599, 'auprc': 0.9507820089961393, 'loss_val': 0.31758655573315464, 'psi': 0.8999756432955917}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.679483 cos_to_last_merge=0.9207 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=70 local utility u=0.828572 metrics={'f1_val': 0.6712005203913686, 'auprc': 0.8275361077950081, 'loss_val': 0.35338871865643545, 'psi': 0.7337347553528244}-{'f1_val': 0.5496860678265381, 'auprc': 0.7789588988869216, 'loss_val': 1.1357143793204332, 'psi': 0.6413952002506915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=70 head_norm_before_train=1.968623 cos_to_last_merge=0.9259 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.7557344079024478, 'auprc': 0.9895245861371856, 'loss_val': 0.2884383396294158, 'psi': 0.8492504791963429}-{'f1_val': 0.9853629043478473, 'auprc': 0.9989509619835326, 'loss_val': 0.04554573757089375, 'psi': 0.9907981274021215}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.232230 cos_to_last_merge=0.9571 (last merge round=14)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9991380629878733, 'loss_val': 0.03923945879387737, 'psi': 0.9929823647891982}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991673721093803, 'loss_val': 0.01533248062964845, 'psi': 0.9979286963510379}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=1.955918 cos_to_last_merge=0.9300 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949958416719537, 'loss_val': 0.025632175990402722, 'psi': 0.9951110400804063}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951265201532826, 'loss_val': 0.02554834487741319, 'psi': 0.9951633114729379}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=1.783055 cos_to_last_merge=0.8803 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9982068997968808, 'loss_val': 0.025295670955729536, 'psi': 0.996962964866738}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981934271978266, 'loss_val': 0.02361503220714876, 'psi': 0.9969575758271162}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.499265 cos_to_last_merge=0.8145 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=70 local utility u=0.191724 metrics={'f1_val': 0.6816265685077739, 'auprc': 0.6718836570881084, 'loss_val': 0.9422665527026285, 'psi': 0.6777294039399078}-{'f1_val': 0.6428873268119442, 'auprc': 0.6573428363790352, 'loss_val': 1.0496575193612607, 'psi': 0.6486695306387806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=70 head_norm_before_train=2.180710 cos_to_last_merge=0.9375 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.8587646841403483, 'auprc': 0.9988648536238681, 'loss_val': 0.39546499732137563, 'psi': 0.9148047519337562}-{'f1_val': 0.9423871583195944, 'auprc': 0.9989869154798292, 'loss_val': 0.09301378284975027, 'psi': 0.9650270611836883}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=1.879457 cos_to_last_merge=0.8951 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.6887006963725143, 'loss_val': 0.762890021694323, 'psi': 0.6960311268101798}-{'f1_val': 0.9919628496751991, 'auprc': 0.9928451789882332, 'loss_val': 0.03694103126753351, 'psi': 0.9923157814004127}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=2.152816 (no previous merge yet)
[S16] round=70 local utility u=0.310302 metrics={'f1_val': 0.8814934514285486, 'auprc': 0.9517350182459149, 'loss_val': 0.7312330807582472, 'psi': 0.9095900781554952}-{'f1_val': 0.861709403214693, 'auprc': 0.891645461998066, 'loss_val': 1.0528645608341236, 'psi': 0.8736838267280422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=70 head_norm_before_train=1.761931 cos_to_last_merge=0.8934 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=70 local utility u=1.000000 metrics={'f1_val': 0.9719179299683041, 'auprc': 0.9891268201758225, 'loss_val': 0.10482155509820486, 'psi': 0.9788014860513115}-{'f1_val': 0.7218140244062087, 'auprc': 0.8991555002688807, 'loss_val': 0.8380138507443431, 'psi': 0.7927506147512775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=71 head_norm_before_train=2.113811 cos_to_last_merge=0.9553 (last merge round=12)
[S2] round=71 local utility u=0.046257 metrics={'f1_val': 0.7194961097776441, 'auprc': 0.8051974352508228, 'loss_val': 0.8102579188002913, 'psi': 0.7537766399669157}-{'f1_val': 0.7185493215844245, 'auprc': 0.7795041598113502, 'loss_val': 0.8200117052245346, 'psi': 0.7429312568751949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=71 head_norm_before_train=2.059888 cos_to_last_merge=0.7618 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.762
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9999521001828842, 'loss_val': 0.15954436587153825, 'psi': 0.976625891312826}-{'f1_val': 0.9611152572344858, 'auprc': 0.9999374666958663, 'loss_val': 0.14004499816548732, 'psi': 0.976644141019038}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.696465 cos_to_last_merge=0.9125 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9407336459122059, 'auprc': 0.9409321509386572, 'loss_val': 0.3290560283144853, 'psi': 0.9408130479227864}-{'f1_val': 0.9445206265788757, 'auprc': 0.9693610711307351, 'loss_val': 0.3095977718129314, 'psi': 0.9544568043996194}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.651894 cos_to_last_merge=0.8200 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.8849601926024601, 'auprc': 0.9897619086023274, 'loss_val': 0.15067141703412695, 'psi': 0.926880879002407}-{'f1_val': 0.9956024667077852, 'auprc': 0.990906343279253, 'loss_val': 0.03169755238426799, 'psi': 0.9937240173363723}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.624798 cos_to_last_merge=0.8519 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=71 local utility u=0.475616 metrics={'f1_val': 0.8685219279796842, 'auprc': 0.9586689497051148, 'loss_val': 0.3145999062712768, 'psi': 0.9045807366698564}-{'f1_val': 0.7598855237001204, 'auprc': 0.9174562422122805, 'loss_val': 0.49037632848390544, 'psi': 0.8229138111049845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=71 head_norm_before_train=1.679890 cos_to_last_merge=0.9205 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5952683139141951, 'auprc': 0.7925496850356417, 'loss_val': 0.7029134061333125, 'psi': 0.6741808623627737}-{'f1_val': 0.6712005203913686, 'auprc': 0.8275361077950081, 'loss_val': 0.35338871865643545, 'psi': 0.7337347553528244}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.973936 cos_to_last_merge=0.9257 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=71 local utility u=0.769124 metrics={'f1_val': 0.9713804658352091, 'auprc': 0.999034298491382, 'loss_val': 0.0725964552483059, 'psi': 0.9824419988976782}-{'f1_val': 0.7557344079024478, 'auprc': 0.9895245861371856, 'loss_val': 0.2884383396294158, 'psi': 0.8492504791963429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=71 head_norm_before_train=2.237164 cos_to_last_merge=0.9570 (last merge round=14)
[S9] round=71 local utility u=0.036837 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991238929049051, 'loss_val': 0.014869643466561078, 'psi': 0.9979113046692477}-{'f1_val': 0.9888785659900814, 'auprc': 0.9991380629878733, 'loss_val': 0.03923945879387737, 'psi': 0.9929823647891982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=71 head_norm_before_train=1.960225 cos_to_last_merge=0.9295 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=71 local utility u=0.000127 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950350414062228, 'loss_val': 0.02549590082356009, 'psi': 0.995126719974114}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949958416719537, 'loss_val': 0.025632175990402722, 'psi': 0.9951110400804063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=71 head_norm_before_train=1.789046 cos_to_last_merge=0.8797 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.880
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.998116563772925, 'loss_val': 0.0378191947216472, 'psi': 0.9970718576546205}-{'f1_val': 0.9961336749133093, 'auprc': 0.9982068997968808, 'loss_val': 0.025295670955729536, 'psi': 0.996962964866738}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.506590 cos_to_last_merge=0.8131 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.813
[S13] round=71 local utility u=0.239689 metrics={'f1_val': 0.6958172399321068, 'auprc': 0.7141731399517918, 'loss_val': 0.6749009184627118, 'psi': 0.7031595999399808}-{'f1_val': 0.6816265685077739, 'auprc': 0.6718836570881084, 'loss_val': 0.9422665527026285, 'psi': 0.6777294039399078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=71 head_norm_before_train=2.185457 cos_to_last_merge=0.9372 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=71 local utility u=0.202288 metrics={'f1_val': 0.8971539993564065, 'auprc': 0.9989690990875582, 'loss_val': 0.221538444633533, 'psi': 0.9378800392488672}-{'f1_val': 0.8587646841403483, 'auprc': 0.9988648536238681, 'loss_val': 0.39546499732137563, 'psi': 0.9148047519337562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=71 head_norm_before_train=1.886353 cos_to_last_merge=0.8947 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=71 local utility u=1.000000 metrics={'f1_val': 0.9412895293166395, 'auprc': 0.9908685349471558, 'loss_val': 0.1078996602480439, 'psi': 0.9611211315688459}-{'f1_val': 0.7009180804352899, 'auprc': 0.6887006963725143, 'loss_val': 0.762890021694323, 'psi': 0.6960311268101798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=71 head_norm_before_train=2.155658 (no previous merge yet)
[S16] round=71 local utility u=0.743864 metrics={'f1_val': 0.9931208284796057, 'auprc': 0.9914076835983279, 'loss_val': 0.03228795246890948, 'psi': 0.9924355705270945}-{'f1_val': 0.8814934514285486, 'auprc': 0.9517350182459149, 'loss_val': 0.7312330807582472, 'psi': 0.9095900781554952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=71 head_norm_before_train=1.766998 cos_to_last_merge=0.8936 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.7309350437891154, 'auprc': 0.9148772873820442, 'loss_val': 0.684362979674052, 'psi': 0.804511941226287}-{'f1_val': 0.9719179299683041, 'auprc': 0.9891268201758225, 'loss_val': 0.10482155509820486, 'psi': 0.9788014860513115}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.118765 cos_to_last_merge=0.9549 (last merge round=12)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7159168928482154, 'auprc': 0.7894053443181481, 'loss_val': 0.8121407386840237, 'psi': 0.7453122734361884}-{'f1_val': 0.7194961097776441, 'auprc': 0.8051974352508228, 'loss_val': 0.8102579188002913, 'psi': 0.7537766399669157}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.066380 cos_to_last_merge=0.7615 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=72 local utility u=0.133020 metrics={'f1_val': 0.9881874584154944, 'auprc': 0.9992558127942857, 'loss_val': 0.054089024807119614, 'psi': 0.9926148001670109}-{'f1_val': 0.9610750853994537, 'auprc': 0.9999521001828842, 'loss_val': 0.15954436587153825, 'psi': 0.976625891312826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=72 head_norm_before_train=1.703460 cos_to_last_merge=0.9122 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=72 local utility u=0.092996 metrics={'f1_val': 0.9512280729736373, 'auprc': 0.9716235603920588, 'loss_val': 0.29810560497863503, 'psi': 0.9593862679410059}-{'f1_val': 0.9407336459122059, 'auprc': 0.9409321509386572, 'loss_val': 0.3290560283144853, 'psi': 0.9408130479227864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=72 head_norm_before_train=1.657089 cos_to_last_merge=0.8194 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=72 local utility u=0.399918 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9938840722382729, 'loss_val': 0.02968807202127114, 'psi': 0.9951782953996323}-{'f1_val': 0.8849601926024601, 'auprc': 0.9897619086023274, 'loss_val': 0.15067141703412695, 'psi': 0.926880879002407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=72 head_norm_before_train=1.628040 cos_to_last_merge=0.8515 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=72 local utility u=0.102390 metrics={'f1_val': 0.8889397200688474, 'auprc': 0.9636250648063203, 'loss_val': 0.24719561221136077, 'psi': 0.9188138579638365}-{'f1_val': 0.8685219279796842, 'auprc': 0.9586689497051148, 'loss_val': 0.3145999062712768, 'psi': 0.9045807366698564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=72 head_norm_before_train=1.680273 cos_to_last_merge=0.9202 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=72 local utility u=0.466948 metrics={'f1_val': 0.6732241879329259, 'auprc': 0.8252909796891146, 'loss_val': 0.3349759237536536, 'psi': 0.7340509046354013}-{'f1_val': 0.5952683139141951, 'auprc': 0.7925496850356417, 'loss_val': 0.7029134061333125, 'psi': 0.6741808623627737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=72 head_norm_before_train=1.973757 cos_to_last_merge=0.9257 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=72 local utility u=0.064057 metrics={'f1_val': 0.9885508673565224, 'auprc': 0.9954992452879006, 'loss_val': 0.036899496323798665, 'psi': 0.9913302185290738}-{'f1_val': 0.9713804658352091, 'auprc': 0.999034298491382, 'loss_val': 0.0725964552483059, 'psi': 0.9824419988976782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=72 head_norm_before_train=2.242074 cos_to_last_merge=0.9569 (last merge round=14)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991188714247887, 'loss_val': 0.015229240350552946, 'psi': 0.9979092960772011}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991238929049051, 'loss_val': 0.014869643466561078, 'psi': 0.9979113046692477}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=1.965739 cos_to_last_merge=0.9290 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=72 local utility u=0.000170 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950841889362665, 'loss_val': 0.025303796102608335, 'psi': 0.9951463789861315}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950350414062228, 'loss_val': 0.02549590082356009, 'psi': 0.995126719974114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=72 head_norm_before_train=1.793172 cos_to_last_merge=0.8793 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=72 local utility u=0.008210 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9981960297705887, 'loss_val': 0.02163856715574177, 'psi': 0.997103644053686}-{'f1_val': 0.9963753869090841, 'auprc': 0.998116563772925, 'loss_val': 0.0378191947216472, 'psi': 0.9970718576546205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=72 head_norm_before_train=1.514140 cos_to_last_merge=0.8117 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6047647016244507, 'auprc': 0.6275049449391795, 'loss_val': 1.135313188228576, 'psi': 0.6138607989503422}-{'f1_val': 0.6958172399321068, 'auprc': 0.7141731399517918, 'loss_val': 0.6749009184627118, 'psi': 0.7031595999399808}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.189006 cos_to_last_merge=0.9369 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=72 local utility u=0.371827 metrics={'f1_val': 0.99250730936658, 'auprc': 0.9989384994776508, 'loss_val': 0.049912287846732024, 'psi': 0.9950797854110083}-{'f1_val': 0.8971539993564065, 'auprc': 0.9989690990875582, 'loss_val': 0.221538444633533, 'psi': 0.9378800392488672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=72 head_norm_before_train=1.891988 cos_to_last_merge=0.8938 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.7967431870862356, 'auprc': 0.9509948208750827, 'loss_val': 0.43378275635453006, 'psi': 0.8584438406017745}-{'f1_val': 0.9412895293166395, 'auprc': 0.9908685349471558, 'loss_val': 0.1078996602480439, 'psi': 0.9611211315688459}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=2.156878 (no previous merge yet)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.993560712703446, 'auprc': 0.9908024047822177, 'loss_val': 0.035615866756457316, 'psi': 0.9924573895349548}-{'f1_val': 0.9931208284796057, 'auprc': 0.9914076835983279, 'loss_val': 0.03228795246890948, 'psi': 0.9924355705270945}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.773638 cos_to_last_merge=0.8928 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=72 local utility u=0.997568 metrics={'f1_val': 0.9431763963535609, 'auprc': 0.9889388732528609, 'loss_val': 0.18486065609044122, 'psi': 0.9614813871132809}-{'f1_val': 0.7309350437891154, 'auprc': 0.9148772873820442, 'loss_val': 0.684362979674052, 'psi': 0.804511941226287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=73 head_norm_before_train=2.122748 cos_to_last_merge=0.9547 (last merge round=12)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.7198289009434141, 'auprc': 0.757066289009129, 'loss_val': 0.8695420982749019, 'psi': 0.7347238561697}-{'f1_val': 0.7159168928482154, 'auprc': 0.7894053443181481, 'loss_val': 0.8121407386840237, 'psi': 0.7453122734361884}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.072501 cos_to_last_merge=0.7611 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.8328448641796076, 'auprc': 0.9981873971770467, 'loss_val': 0.29722019166400443, 'psi': 0.8989818773785831}-{'f1_val': 0.9881874584154944, 'auprc': 0.9992558127942857, 'loss_val': 0.054089024807119614, 'psi': 0.9926148001670109}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.708439 cos_to_last_merge=0.9120 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.944861319600849, 'auprc': 0.9416112821137766, 'loss_val': 0.33359217818843634, 'psi': 0.9435613046060201}-{'f1_val': 0.9512280729736373, 'auprc': 0.9716235603920588, 'loss_val': 0.29810560497863503, 'psi': 0.9593862679410059}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.662986 cos_to_last_merge=0.8188 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.990101000120735, 'loss_val': 0.030122093741471862, 'psi': 0.993401880072965}-{'f1_val': 0.9960411108405385, 'auprc': 0.9938840722382729, 'loss_val': 0.02968807202127114, 'psi': 0.9951782953996323}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.633473 cos_to_last_merge=0.8508 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6169637607339876, 'auprc': 0.9376450380622665, 'loss_val': 0.9805266818746535, 'psi': 0.7452362716652992}-{'f1_val': 0.8889397200688474, 'auprc': 0.9636250648063203, 'loss_val': 0.24719561221136077, 'psi': 0.9188138579638365}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.682806 cos_to_last_merge=0.9203 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6347069957553786, 'auprc': 0.7950545562008202, 'loss_val': 0.6091811074986826, 'psi': 0.6988460199335553}-{'f1_val': 0.6732241879329259, 'auprc': 0.8252909796891146, 'loss_val': 0.3349759237536536, 'psi': 0.7340509046354013}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=1.974178 cos_to_last_merge=0.9261 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=73 local utility u=0.025888 metrics={'f1_val': 0.9938130760262815, 'auprc': 0.998845450328296, 'loss_val': 0.026735229130498396, 'psi': 0.9958260257470872}-{'f1_val': 0.9885508673565224, 'auprc': 0.9954992452879006, 'loss_val': 0.036899496323798665, 'psi': 0.9913302185290738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=73 head_norm_before_train=2.246450 cos_to_last_merge=0.9569 (last merge round=14)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.998788137373027, 'loss_val': 0.021081972851885584, 'psi': 0.9960290787995504}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991188714247887, 'loss_val': 0.015229240350552946, 'psi': 0.9979092960772011}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=1.971761 cos_to_last_merge=0.9287 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=73 local utility u=0.001774 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9953309247351223, 'loss_val': 0.025026103206367806, 'psi': 0.9954981620030607}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950841889362665, 'loss_val': 0.025303796102608335, 'psi': 0.9951463789861315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=73 head_norm_before_train=1.798419 cos_to_last_merge=0.8789 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.879
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980018010688675, 'loss_val': 0.021316495833064494, 'psi': 0.9968809253755326}-{'f1_val': 0.9963753869090841, 'auprc': 0.9981960297705887, 'loss_val': 0.02163856715574177, 'psi': 0.997103644053686}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.520422 cos_to_last_merge=0.8107 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.811
[S13] round=73 local utility u=0.322320 metrics={'f1_val': 0.698025060552528, 'auprc': 0.6448969161649121, 'loss_val': 1.1024110363128232, 'psi': 0.6767738027974817}-{'f1_val': 0.6047647016244507, 'auprc': 0.6275049449391795, 'loss_val': 1.135313188228576, 'psi': 0.6138607989503422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=73 head_norm_before_train=2.194445 cos_to_last_merge=0.9366 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9477161062804406, 'auprc': 0.9984486511670166, 'loss_val': 0.07557653847400936, 'psi': 0.968009124235071}-{'f1_val': 0.99250730936658, 'auprc': 0.9989384994776508, 'loss_val': 0.049912287846732024, 'psi': 0.9950797854110083}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.899451 cos_to_last_merge=0.8931 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=73 local utility u=0.657734 metrics={'f1_val': 0.9417850996756472, 'auprc': 0.9906434416286578, 'loss_val': 0.10751139050268949, 'psi': 0.9613284364568515}-{'f1_val': 0.7967431870862356, 'auprc': 0.9509948208750827, 'loss_val': 0.43378275635453006, 'psi': 0.8584438406017745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=73 head_norm_before_train=2.160911 (no previous merge yet)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9644769682426682, 'auprc': 0.9809257273478527, 'loss_val': 0.10860763041647971, 'psi': 0.971056471884742}-{'f1_val': 0.993560712703446, 'auprc': 0.9908024047822177, 'loss_val': 0.035615866756457316, 'psi': 0.9924573895349548}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.778698 cos_to_last_merge=0.8920 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.739103332256153, 'auprc': 0.9666868868070193, 'loss_val': 0.49929507725588834, 'psi': 0.8301367540764996}-{'f1_val': 0.9431763963535609, 'auprc': 0.9889388732528609, 'loss_val': 0.18486065609044122, 'psi': 0.9614813871132809}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.126691 cos_to_last_merge=0.9545 (last merge round=12)
[S2] round=74 local utility u=0.000000 metrics={'f1_val': 0.7199600101114124, 'auprc': 0.747702514438763, 'loss_val': 0.8947379661287086, 'psi': 0.7310570118423527}-{'f1_val': 0.7198289009434141, 'auprc': 0.757066289009129, 'loss_val': 0.8695420982749019, 'psi': 0.7347238561697}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=74 head_norm_before_train=2.078788 cos_to_last_merge=0.7607 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.761
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.8249914383788136, 'auprc': 0.9983176772750432, 'loss_val': 0.35564160417291896, 'psi': 0.8943219339373054}-{'f1_val': 0.8328448641796076, 'auprc': 0.9981873971770467, 'loss_val': 0.29722019166400443, 'psi': 0.8989818773785831}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.713345 cos_to_last_merge=0.9117 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9456173663112282, 'auprc': 0.9267998001272894, 'loss_val': 0.3338021278949479, 'psi': 0.9380903398376526}-{'f1_val': 0.944861319600849, 'auprc': 0.9416112821137766, 'loss_val': 0.33359217818843634, 'psi': 0.9435613046060201}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.669440 cos_to_last_merge=0.8182 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=74 local utility u=0.002055 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.991354852542302, 'loss_val': 0.02977449345597378, 'psi': 0.9939034210415919}-{'f1_val': 0.9956024667077852, 'auprc': 0.990101000120735, 'loss_val': 0.030122093741471862, 'psi': 0.993401880072965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=74 head_norm_before_train=1.638368 cos_to_last_merge=0.8500 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=74 local utility u=0.199036 metrics={'f1_val': 0.639835741794322, 'auprc': 0.9479548892937764, 'loss_val': 0.7506158862773179, 'psi': 0.7630834007941038}-{'f1_val': 0.6169637607339876, 'auprc': 0.9376450380622665, 'loss_val': 0.9805266818746535, 'psi': 0.7452362716652992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=74 head_norm_before_train=1.686499 cos_to_last_merge=0.9200 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6106879030860698, 'auprc': 0.7894709285596163, 'loss_val': 0.7775510397434817, 'psi': 0.6822011132754884}-{'f1_val': 0.6347069957553786, 'auprc': 0.7950545562008202, 'loss_val': 0.6091811074986826, 'psi': 0.6988460199335553}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.979801 cos_to_last_merge=0.9258 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9988677400445669, 'loss_val': 0.028825834203325337, 'psi': 0.9953700167688262}-{'f1_val': 0.9938130760262815, 'auprc': 0.998845450328296, 'loss_val': 0.026735229130498396, 'psi': 0.9958260257470872}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.249026 cos_to_last_merge=0.9565 (last merge round=14)
[S9] round=74 local utility u=0.006460 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987657990864894, 'loss_val': 0.017917973773285304, 'psi': 0.997002350653107}-{'f1_val': 0.9941897064172326, 'auprc': 0.998788137373027, 'loss_val': 0.021081972851885584, 'psi': 0.9960290787995504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=74 head_norm_before_train=1.973440 cos_to_last_merge=0.9280 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951801800513671, 'loss_val': 0.0250246710828431, 'psi': 0.9951847754321717}-{'f1_val': 0.9956096535150197, 'auprc': 0.9953309247351223, 'loss_val': 0.025026103206367806, 'psi': 0.9954981620030607}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.803943 cos_to_last_merge=0.8784 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=74 local utility u=0.002380 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9978855550860389, 'loss_val': 0.020138461832154484, 'psi': 0.9972274519400341}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980018010688675, 'loss_val': 0.021316495833064494, 'psi': 0.9968809253755326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=74 head_norm_before_train=1.525826 cos_to_last_merge=0.8098 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=74 local utility u=0.516193 metrics={'f1_val': 0.7055967607638038, 'auprc': 0.7729983354246631, 'loss_val': 0.4997597070080905, 'psi': 0.7325573906281475}-{'f1_val': 0.698025060552528, 'auprc': 0.6448969161649121, 'loss_val': 1.1024110363128232, 'psi': 0.6767738027974817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=74 head_norm_before_train=2.198314 cos_to_last_merge=0.9363 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=74 local utility u=0.069060 metrics={'f1_val': 0.9670441114774083, 'auprc': 0.9989732106611618, 'loss_val': 0.05499795652596648, 'psi': 0.9798157511509098}-{'f1_val': 0.9477161062804406, 'auprc': 0.9984486511670166, 'loss_val': 0.07557653847400936, 'psi': 0.968009124235071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=74 head_norm_before_train=1.907863 cos_to_last_merge=0.8924 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.7729606016560958, 'auprc': 0.8489710834689393, 'loss_val': 0.6095638769879393, 'psi': 0.8033647943812332}-{'f1_val': 0.9417850996756472, 'auprc': 0.9906434416286578, 'loss_val': 0.10751139050268949, 'psi': 0.9613284364568515}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.167374 (no previous merge yet)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.901276667144905, 'auprc': 0.9766551497153325, 'loss_val': 0.5826381365543036, 'psi': 0.931428060173076}-{'f1_val': 0.9644769682426682, 'auprc': 0.9809257273478527, 'loss_val': 0.10860763041647971, 'psi': 0.971056471884742}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.783331 cos_to_last_merge=0.8910 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=74 local utility u=0.802730 metrics={'f1_val': 0.9456160010643371, 'auprc': 0.9833531353582944, 'loss_val': 0.18290915049863335, 'psi': 0.96071085478192}-{'f1_val': 0.739103332256153, 'auprc': 0.9666868868070193, 'loss_val': 0.49929507725588834, 'psi': 0.8301367540764996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=75 head_norm_before_train=2.131208 cos_to_last_merge=0.9542 (last merge round=12)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7206758095329626, 'auprc': 0.7454154485676556, 'loss_val': 0.9583746416562033, 'psi': 0.7305716651468398}-{'f1_val': 0.7199600101114124, 'auprc': 0.747702514438763, 'loss_val': 0.8947379661287086, 'psi': 0.7310570118423527}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.086857 cos_to_last_merge=0.7604 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=75 local utility u=0.372649 metrics={'f1_val': 0.9215028719502446, 'auprc': 0.9987948833900491, 'loss_val': 0.1908433321527048, 'psi': 0.9524196765261663}-{'f1_val': 0.8249914383788136, 'auprc': 0.9983176772750432, 'loss_val': 0.35564160417291896, 'psi': 0.8943219339373054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=75 head_norm_before_train=1.720330 cos_to_last_merge=0.9117 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=75 local utility u=0.063362 metrics={'f1_val': 0.9501039406121576, 'auprc': 0.9542159965888259, 'loss_val': 0.3162468947823727, 'psi': 0.951748763002825}-{'f1_val': 0.9456173663112282, 'auprc': 0.9267998001272894, 'loss_val': 0.3338021278949479, 'psi': 0.9380903398376526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=75 head_norm_before_train=1.675050 cos_to_last_merge=0.8178 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9911537371159979, 'loss_val': 0.03170035295734938, 'psi': 0.9939985949831297}-{'f1_val': 0.9956024667077852, 'auprc': 0.991354852542302, 'loss_val': 0.02977449345597378, 'psi': 0.9939034210415919}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.640097 cos_to_last_merge=0.8497 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.850
[S6] round=75 local utility u=1.000000 metrics={'f1_val': 0.9856152496208247, 'auprc': 0.9763579617102821, 'loss_val': 0.09492225828881685, 'psi': 0.9819123344566076}-{'f1_val': 0.639835741794322, 'auprc': 0.9479548892937764, 'loss_val': 0.7506158862773179, 'psi': 0.7630834007941038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=75 head_norm_before_train=1.689825 cos_to_last_merge=0.9196 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=75 local utility u=0.643699 metrics={'f1_val': 0.7005087568913665, 'auprc': 0.8655174667225569, 'loss_val': 0.25721870876115416, 'psi': 0.7665122408238427}-{'f1_val': 0.6106879030860698, 'auprc': 0.7894709285596163, 'loss_val': 0.7775510397434817, 'psi': 0.6822011132754884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=75 head_norm_before_train=1.985626 cos_to_last_merge=0.9256 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.926
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.8787826710951452, 'auprc': 0.995231903760226, 'loss_val': 0.245543550081546, 'psi': 0.9253623641611775}-{'f1_val': 0.9930382012516658, 'auprc': 0.9988677400445669, 'loss_val': 0.028825834203325337, 'psi': 0.9953700167688262}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.251649 cos_to_last_merge=0.9562 (last merge round=14)
[S9] round=75 local utility u=0.000369 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988225724241798, 'loss_val': 0.017350319905753486, 'psi': 0.9970250599881831}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987657990864894, 'loss_val': 0.017917973773285304, 'psi': 0.997002350653107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=75 head_norm_before_train=1.976825 cos_to_last_merge=0.9275 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=75 local utility u=0.000092 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952120800109077, 'loss_val': 0.024936471285107866, 'psi': 0.9951975354159879}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951801800513671, 'loss_val': 0.0250246710828431, 'psi': 0.9951847754321717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=75 head_norm_before_train=1.807999 cos_to_last_merge=0.8781 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=75 local utility u=0.000118 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9979814903557876, 'loss_val': 0.02018968000693818, 'psi': 0.9972658260479337}-{'f1_val': 0.9967887165093644, 'auprc': 0.9978855550860389, 'loss_val': 0.020138461832154484, 'psi': 0.9972274519400341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=75 head_norm_before_train=1.529040 cos_to_last_merge=0.8091 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.614403210183498, 'auprc': 0.6766196699444267, 'loss_val': 1.0318299153641064, 'psi': 0.6392897940878695}-{'f1_val': 0.7055967607638038, 'auprc': 0.7729983354246631, 'loss_val': 0.4997597070080905, 'psi': 0.7325573906281475}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.202363 cos_to_last_merge=0.9361 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=75 local utility u=0.089337 metrics={'f1_val': 0.9943292545381139, 'auprc': 0.99896584017325, 'loss_val': 0.040013462312758756, 'psi': 0.9961838887921683}-{'f1_val': 0.9670441114774083, 'auprc': 0.9989732106611618, 'loss_val': 0.05499795652596648, 'psi': 0.9798157511509098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=75 head_norm_before_train=1.916590 cos_to_last_merge=0.8919 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=75 local utility u=0.113831 metrics={'f1_val': 0.7775870137937975, 'auprc': 0.8926308475159128, 'loss_val': 0.5406399874076477, 'psi': 0.8236045472826437}-{'f1_val': 0.7729606016560958, 'auprc': 0.8489710834689393, 'loss_val': 0.6095638769879393, 'psi': 0.8033647943812332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=75 head_norm_before_train=2.170700 (no previous merge yet)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9025303334295496, 'auprc': 0.8925447612802659, 'loss_val': 0.5746299926211385, 'psi': 0.8985361045698361}-{'f1_val': 0.901276667144905, 'auprc': 0.9766551497153325, 'loss_val': 0.5826381365543036, 'psi': 0.931428060173076}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.789497 cos_to_last_merge=0.8906 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.891
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.8827754771703185, 'auprc': 0.9439639505527664, 'loss_val': 0.2936163040926441, 'psi': 0.9072508665232976}-{'f1_val': 0.9456160010643371, 'auprc': 0.9833531353582944, 'loss_val': 0.18290915049863335, 'psi': 0.96071085478192}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.135355 cos_to_last_merge=0.9541 (last merge round=12)
[S2] round=76 local utility u=0.025255 metrics={'f1_val': 0.7197350747200998, 'auprc': 0.7459752084853086, 'loss_val': 0.9038999662067769, 'psi': 0.7302311282261833}-{'f1_val': 0.7206758095329626, 'auprc': 0.7454154485676556, 'loss_val': 0.9583746416562033, 'psi': 0.7305716651468398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=76 head_norm_before_train=2.094847 cos_to_last_merge=0.7601 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=76 local utility u=0.133202 metrics={'f1_val': 0.9535929342147045, 'auprc': 0.9993804907743311, 'loss_val': 0.11873727916447056, 'psi': 0.9719079568385551}-{'f1_val': 0.9215028719502446, 'auprc': 0.9987948833900491, 'loss_val': 0.1908433321527048, 'psi': 0.9524196765261663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=76 head_norm_before_train=1.726979 cos_to_last_merge=0.9116 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9389514323639393, 'auprc': 0.9121727372410141, 'loss_val': 0.3478934645993963, 'psi': 0.9282399543147692}-{'f1_val': 0.9501039406121576, 'auprc': 0.9542159965888259, 'loss_val': 0.3162468947823727, 'psi': 0.951748763002825}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.680755 cos_to_last_merge=0.8172 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=76 local utility u=0.000916 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9910917457363322, 'loss_val': 0.029682268633522895, 'psi': 0.9939737984312634}-{'f1_val': 0.995895166894551, 'auprc': 0.9911537371159979, 'loss_val': 0.03170035295734938, 'psi': 0.9939985949831297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=76 head_norm_before_train=1.645364 cos_to_last_merge=0.8494 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.6140660990991095, 'auprc': 0.7370005963764806, 'loss_val': 1.1375958834960134, 'psi': 0.663239898010058}-{'f1_val': 0.9856152496208247, 'auprc': 0.9763579617102821, 'loss_val': 0.09492225828881685, 'psi': 0.9819123344566076}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.692947 cos_to_last_merge=0.9192 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6295871527030912, 'auprc': 0.7996497570590319, 'loss_val': 0.5997687065325751, 'psi': 0.6976121944454674}-{'f1_val': 0.7005087568913665, 'auprc': 0.8655174667225569, 'loss_val': 0.25721870876115416, 'psi': 0.7665122408238427}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.990351 cos_to_last_merge=0.9252 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.925
[S8] round=76 local utility u=0.455890 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9987007711524754, 'loss_val': 0.03020963775268756, 'psi': 0.9953539562504863}-{'f1_val': 0.8787826710951452, 'auprc': 0.995231903760226, 'loss_val': 0.245543550081546, 'psi': 0.9253623641611775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=76 head_norm_before_train=2.256782 cos_to_last_merge=0.9562 (last merge round=14)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.998828753712748, 'loss_val': 0.020694943087098867, 'psi': 0.9961454950027895}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988225724241798, 'loss_val': 0.017350319905753486, 'psi': 0.9970250599881831}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.981716 cos_to_last_merge=0.9271 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9950222315924325, 'loss_val': 0.025005373055417713, 'psi': 0.9951215960485978}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952120800109077, 'loss_val': 0.024936471285107866, 'psi': 0.9951975354159879}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.811526 cos_to_last_merge=0.8778 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.878
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980085914621558, 'loss_val': 0.020784692717882122, 'psi': 0.9968836415328479}-{'f1_val': 0.9967887165093644, 'auprc': 0.9979814903557876, 'loss_val': 0.02018968000693818, 'psi': 0.9972658260479337}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=1.529443 cos_to_last_merge=0.8087 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6321244273111806, 'auprc': 0.6650976752946018, 'loss_val': 1.158165377218241, 'psi': 0.645313726504549}-{'f1_val': 0.614403210183498, 'auprc': 0.6766196699444267, 'loss_val': 1.0318299153641064, 'psi': 0.6392897940878695}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.208301 cos_to_last_merge=0.9359 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9477161062804406, 'auprc': 0.9986317279955622, 'loss_val': 0.07419119792887105, 'psi': 0.9680823549664892}-{'f1_val': 0.9943292545381139, 'auprc': 0.99896584017325, 'loss_val': 0.040013462312758756, 'psi': 0.9961838887921683}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.926077 cos_to_last_merge=0.8913 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.7691468229728613, 'auprc': 0.8606617351441463, 'loss_val': 0.6117866768889194, 'psi': 0.8057527878413753}-{'f1_val': 0.7775870137937975, 'auprc': 0.8926308475159128, 'loss_val': 0.5406399874076477, 'psi': 0.8236045472826437}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.172855 (no previous merge yet)
[S16] round=76 local utility u=0.692691 metrics={'f1_val': 0.9922852347148108, 'auprc': 0.9941591362083388, 'loss_val': 0.03262119024810807, 'psi': 0.993034795312222}-{'f1_val': 0.9025303334295496, 'auprc': 0.8925447612802659, 'loss_val': 0.5746299926211385, 'psi': 0.8985361045698361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=76 head_norm_before_train=1.798459 cos_to_last_merge=0.8899 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.890
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.8298135524542928, 'auprc': 0.9327208239032951, 'loss_val': 0.39847543433302435, 'psi': 0.8709764610338937}-{'f1_val': 0.8827754771703185, 'auprc': 0.9439639505527664, 'loss_val': 0.2936163040926441, 'psi': 0.9072508665232976}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=2.141305 cos_to_last_merge=0.9536 (last merge round=12)
[S2] round=77 local utility u=0.006665 metrics={'f1_val': 0.7205120403215745, 'auprc': 0.7680750653077972, 'loss_val': 0.9615303968176481, 'psi': 0.7395372503160635}-{'f1_val': 0.7197350747200998, 'auprc': 0.7459752084853086, 'loss_val': 0.9038999662067769, 'psi': 0.7302311282261833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=77 head_norm_before_train=2.102090 cos_to_last_merge=0.7597 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.760
[S3] round=77 local utility u=0.106158 metrics={'f1_val': 0.9782563687869755, 'auprc': 0.999186193734872, 'loss_val': 0.05381894842165018, 'psi': 0.9866282987661341}-{'f1_val': 0.9535929342147045, 'auprc': 0.9993804907743311, 'loss_val': 0.11873727916447056, 'psi': 0.9719079568385551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=77 head_norm_before_train=1.732884 cos_to_last_merge=0.9107 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=77 local utility u=0.005351 metrics={'f1_val': 0.9392093341995315, 'auprc': 0.9137289771329333, 'loss_val': 0.34340787640004605, 'psi': 0.9290171913728922}-{'f1_val': 0.9389514323639393, 'auprc': 0.9121727372410141, 'loss_val': 0.3478934645993963, 'psi': 0.9282399543147692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=77 head_norm_before_train=1.683220 cos_to_last_merge=0.8167 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9913959350606065, 'loss_val': 0.029354636567790894, 'psi': 0.9939198540489137}-{'f1_val': 0.995895166894551, 'auprc': 0.9910917457363322, 'loss_val': 0.029682268633522895, 'psi': 0.9939737984312634}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.650545 cos_to_last_merge=0.8488 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=77 local utility u=0.245335 metrics={'f1_val': 0.6072835990982584, 'auprc': 0.8794330003349452, 'loss_val': 1.033527172905042, 'psi': 0.7161433595929332}-{'f1_val': 0.6140660990991095, 'auprc': 0.7370005963764806, 'loss_val': 1.1375958834960134, 'psi': 0.663239898010058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=77 head_norm_before_train=1.698713 cos_to_last_merge=0.9186 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=77 local utility u=0.344688 metrics={'f1_val': 0.6823224475542315, 'auprc': 0.8380944026283499, 'loss_val': 0.34213889590348207, 'psi': 0.7446312295838788}-{'f1_val': 0.6295871527030912, 'auprc': 0.7996497570590319, 'loss_val': 0.5997687065325751, 'psi': 0.6976121944454674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=77 head_norm_before_train=1.993531 cos_to_last_merge=0.9248 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.925
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9904910816630761, 'auprc': 0.9989381131447947, 'loss_val': 0.034291715629317106, 'psi': 0.9938698942557636}-{'f1_val': 0.993122746315827, 'auprc': 0.9987007711524754, 'loss_val': 0.03020963775268756, 'psi': 0.9953539562504863}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=2.263153 cos_to_last_merge=0.9563 (last merge round=14)
[S9] round=77 local utility u=0.007598 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9992000710180986, 'loss_val': 0.016596619332739856, 'psi': 0.9972924495935518}-{'f1_val': 0.994356655862817, 'auprc': 0.998828753712748, 'loss_val': 0.020694943087098867, 'psi': 0.9961454950027895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=77 head_norm_before_train=1.987373 cos_to_last_merge=0.9267 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=77 local utility u=0.000214 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951169240191953, 'loss_val': 0.024861530284363328, 'psi': 0.995159473019303}-{'f1_val': 0.9951878390193748, 'auprc': 0.9950222315924325, 'loss_val': 0.025005373055417713, 'psi': 0.9951215960485978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=77 head_norm_before_train=1.816615 cos_to_last_merge=0.8772 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.877
[S11] round=77 local utility u=0.001910 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9981417711989428, 'loss_val': 0.020264350661523628, 'psi': 0.9972268930392905}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980085914621558, 'loss_val': 0.020784692717882122, 'psi': 0.9968836415328479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=77 head_norm_before_train=1.530375 cos_to_last_merge=0.8082 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6073801088937044, 'auprc': 0.6651865665169973, 'loss_val': 1.1386498780929741, 'psi': 0.6305026919430216}-{'f1_val': 0.6321244273111806, 'auprc': 0.6650976752946018, 'loss_val': 1.158165377218241, 'psi': 0.645313726504549}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.211959 cos_to_last_merge=0.9357 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9373060440103239, 'auprc': 0.9982937952497897, 'loss_val': 0.12341826687902033, 'psi': 0.9617011445061102}-{'f1_val': 0.9477161062804406, 'auprc': 0.9986317279955622, 'loss_val': 0.07419119792887105, 'psi': 0.9680823549664892}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.934410 cos_to_last_merge=0.8906 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=77 local utility u=0.196717 metrics={'f1_val': 0.7874966629874985, 'auprc': 0.9210945945983565, 'loss_val': 0.5097510448877308, 'psi': 0.8409358356318417}-{'f1_val': 0.7691468229728613, 'auprc': 0.8606617351441463, 'loss_val': 0.6117866768889194, 'psi': 0.8057527878413753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=77 head_norm_before_train=2.176692 (no previous merge yet)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9928182894274072, 'auprc': 0.9880700506931426, 'loss_val': 0.0421726759786986, 'psi': 0.9909189939337013}-{'f1_val': 0.9922852347148108, 'auprc': 0.9941591362083388, 'loss_val': 0.03262119024810807, 'psi': 0.993034795312222}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.810466 cos_to_last_merge=0.8891 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=77 local utility u=0.719157 metrics={'f1_val': 0.9932924022389761, 'auprc': 0.9854461343177318, 'loss_val': 0.09921032280676347, 'psi': 0.9901538950704784}-{'f1_val': 0.8298135524542928, 'auprc': 0.9327208239032951, 'loss_val': 0.39847543433302435, 'psi': 0.8709764610338937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=78 head_norm_before_train=2.145878 cos_to_last_merge=0.9532 (last merge round=12)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7215473734999939, 'auprc': 0.7494932847328339, 'loss_val': 0.9630528665228931, 'psi': 0.7327257379931299}-{'f1_val': 0.7205120403215745, 'auprc': 0.7680750653077972, 'loss_val': 0.9615303968176481, 'psi': 0.7395372503160635}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.108719 cos_to_last_merge=0.7594 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.6794421419497254, 'auprc': 0.9939192904601435, 'loss_val': 1.0292381394543633, 'psi': 0.8052330013538926}-{'f1_val': 0.9782563687869755, 'auprc': 0.999186193734872, 'loss_val': 0.05381894842165018, 'psi': 0.9866282987661341}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.730545 cos_to_last_merge=0.9098 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.910
[S4] round=78 local utility u=0.068772 metrics={'f1_val': 0.944121239934888, 'auprc': 0.9416132977623732, 'loss_val': 0.31898875002791294, 'psi': 0.943118063065882}-{'f1_val': 0.9392093341995315, 'auprc': 0.9137289771329333, 'loss_val': 0.34340787640004605, 'psi': 0.9290171913728922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=78 head_norm_before_train=1.688303 cos_to_last_merge=0.8162 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9906450735153483, 'loss_val': 0.03011728753773317, 'psi': 0.9937951295428699}-{'f1_val': 0.9956024667077852, 'auprc': 0.9913959350606065, 'loss_val': 0.029354636567790894, 'psi': 0.9939198540489137}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.654787 cos_to_last_merge=0.8484 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.848
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.8622023496086159, 'auprc': 0.9557785586996681, 'loss_val': 0.31168908225811426, 'psi': 0.8996328332450367}-{'f1_val': 0.6072835990982584, 'auprc': 0.8794330003349452, 'loss_val': 1.033527172905042, 'psi': 0.7161433595929332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=78 head_norm_before_train=1.706421 cos_to_last_merge=0.9180 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.918
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.6119016164935975, 'auprc': 0.7964043793509292, 'loss_val': 0.7615873755600384, 'psi': 0.6857027216365302}-{'f1_val': 0.6823224475542315, 'auprc': 0.8380944026283499, 'loss_val': 0.34213889590348207, 'psi': 0.7446312295838788}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.998214 cos_to_last_merge=0.9244 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.924
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9716057901525215, 'auprc': 0.9977104960477873, 'loss_val': 0.07341064101876084, 'psi': 0.9820476725106277}-{'f1_val': 0.9904910816630761, 'auprc': 0.9989381131447947, 'loss_val': 0.034291715629317106, 'psi': 0.9938698942557636}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.269781 cos_to_last_merge=0.9563 (last merge round=14)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9933220030117622, 'loss_val': 0.01686221035441205, 'psi': 0.9954403524600592}-{'f1_val': 0.9960207019771873, 'auprc': 0.9992000710180986, 'loss_val': 0.016596619332739856, 'psi': 0.9972924495935518}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=1.993408 cos_to_last_merge=0.9264 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=78 local utility u=0.001906 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.995456693652583, 'loss_val': 0.024600243415386205, 'psi': 0.9955484695700452}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951169240191953, 'loss_val': 0.024861530284363328, 'psi': 0.995159473019303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=78 head_norm_before_train=1.819647 cos_to_last_merge=0.8769 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.877
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981632661481346, 'loss_val': 0.02378920953819735, 'psi': 0.9969455114072394}-{'f1_val': 0.9966169742661891, 'auprc': 0.9981417711989428, 'loss_val': 0.020264350661523628, 'psi': 0.9972268930392905}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.531573 cos_to_last_merge=0.8079 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=78 local utility u=0.711609 metrics={'f1_val': 0.7274072349646492, 'auprc': 0.7873858308834251, 'loss_val': 0.8021920676342581, 'psi': 0.7513986733321596}-{'f1_val': 0.6073801088937044, 'auprc': 0.6651865665169973, 'loss_val': 1.1386498780929741, 'psi': 0.6305026919430216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=78 head_norm_before_train=2.212433 cos_to_last_merge=0.9356 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.936
[S14] round=78 local utility u=0.231059 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9970762863895801, 'loss_val': 0.02320991303553211, 'psi': 0.997770321032155}-{'f1_val': 0.9373060440103239, 'auprc': 0.9982937952497897, 'loss_val': 0.12341826687902033, 'psi': 0.9617011445061102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=78 head_norm_before_train=1.941234 cos_to_last_merge=0.8900 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.729411890183984, 'auprc': 0.8391813142723915, 'loss_val': 0.6624968081099226, 'psi': 0.773319659819347}-{'f1_val': 0.7874966629874985, 'auprc': 0.9210945945983565, 'loss_val': 0.5097510448877308, 'psi': 0.8409358356318417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.181843 (no previous merge yet)
[S16] round=78 local utility u=0.010893 metrics={'f1_val': 0.992844676947359, 'auprc': 0.992703565739042, 'loss_val': 0.03444591925358767, 'psi': 0.9927882324640322}-{'f1_val': 0.9928182894274072, 'auprc': 0.9880700506931426, 'loss_val': 0.0421726759786986, 'psi': 0.9909189939337013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=78 head_norm_before_train=1.820954 cos_to_last_merge=0.8884 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.888
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.8250896346922075, 'auprc': 0.9422211712116243, 'loss_val': 0.47114432608568263, 'psi': 0.8719422492999742}-{'f1_val': 0.9932924022389761, 'auprc': 0.9854461343177318, 'loss_val': 0.09921032280676347, 'psi': 0.9901538950704784}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.150026 cos_to_last_merge=0.9528 (last merge round=12)
[S2] round=79 local utility u=0.014883 metrics={'f1_val': 0.7217629290120583, 'auprc': 0.7625589897099203, 'loss_val': 0.9737782516863147, 'psi': 0.7380813532912032}-{'f1_val': 0.7215473734999939, 'auprc': 0.7494932847328339, 'loss_val': 0.9630528665228931, 'psi': 0.7327257379931299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] r=80 psi=0.738 u=0.0149 p_local=0.0125 f1=0.722 auprc=0.763 bytes=79171
[S3] START round=79 head_norm_before_train=2.114537 cos_to_last_merge=0.7591 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=79 local utility u=0.961501 metrics={'f1_val': 0.8884135658125152, 'auprc': 0.9777855686337021, 'loss_val': 0.31166415955494553, 'psi': 0.92416236694099}-{'f1_val': 0.6794421419497254, 'auprc': 0.9939192904601435, 'loss_val': 1.0292381394543633, 'psi': 0.8052330013538926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=80 psi=0.924 u=0.9615 p_local=0.2695 f1=0.888 auprc=0.978 bytes=70105
[S4] START round=79 head_norm_before_train=1.720298 cos_to_last_merge=0.9091 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9421513081543456, 'auprc': 0.9260728745217043, 'loss_val': 0.33166323638668205, 'psi': 0.935719934701289}-{'f1_val': 0.944121239934888, 'auprc': 0.9416132977623732, 'loss_val': 0.31898875002791294, 'psi': 0.943118063065882}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.936 u=0.0000 p_local=0.0242 f1=0.942 auprc=0.926 bytes=84587
[S5] START round=79 head_norm_before_train=1.694918 cos_to_last_merge=0.8154 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=79 local utility u=0.000799 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9907322980561991, 'loss_val': 0.028780905789187305, 'psi': 0.9938300193592102}-{'f1_val': 0.995895166894551, 'auprc': 0.9906450735153483, 'loss_val': 0.03011728753773317, 'psi': 0.9937951295428699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=80 psi=0.994 u=0.0008 p_local=0.0204 f1=0.996 auprc=0.991 bytes=82707
[S6] START round=79 head_norm_before_train=1.660367 cos_to_last_merge=0.8477 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.848
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.6978222197364524, 'auprc': 0.9290826701381764, 'loss_val': 0.643421597103433, 'psi': 0.790326399897142}-{'f1_val': 0.8622023496086159, 'auprc': 0.9557785586996681, 'loss_val': 0.31168908225811426, 'psi': 0.8996328332450367}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.790 u=0.0000 p_local=0.3506 f1=0.698 auprc=0.929 bytes=68341
[S7] START round=79 head_norm_before_train=1.713213 cos_to_last_merge=0.9174 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=79 local utility u=0.036404 metrics={'f1_val': 0.618805334275704, 'auprc': 0.7962709922940748, 'loss_val': 0.7298017717829092, 'psi': 0.6897915974830524}-{'f1_val': 0.6119016164935975, 'auprc': 0.7964043793509292, 'loss_val': 0.7615873755600384, 'psi': 0.6857027216365302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=80 psi=0.690 u=0.0364 p_local=0.1670 f1=0.619 auprc=0.796 bytes=79125
[S8] START round=79 head_norm_before_train=2.004446 cos_to_last_merge=0.9239 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.924
[S8] round=79 local utility u=0.087362 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9986336423713797, 'loss_val': 0.030558127205383544, 'psi': 0.9953271047380481}-{'f1_val': 0.9716057901525215, 'auprc': 0.9977104960477873, 'loss_val': 0.07341064101876084, 'psi': 0.9820476725106277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S8] r=80 psi=0.995 u=0.0874 p_local=0.0963 f1=0.993 auprc=0.999 bytes=84523
[S9] START round=79 head_norm_before_train=2.275976 cos_to_last_merge=0.9561 (last merge round=14)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9918361843886205, 'auprc': 0.999200433084945, 'loss_val': 0.02626671534894791, 'psi': 0.9947818838671503}-{'f1_val': 0.9968525854255906, 'auprc': 0.9933220030117622, 'loss_val': 0.01686221035441205, 'psi': 0.9954403524600592}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.995 u=0.0000 p_local=0.0035 f1=0.992 auprc=0.999 bytes=82619
[S10] START round=79 head_norm_before_train=1.999544 cos_to_last_merge=0.9262 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=79 local utility u=0.000201 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9955967316717441, 'loss_val': 0.024617760247790423, 'psi': 0.9956044847777095}-{'f1_val': 0.9956096535150197, 'auprc': 0.995456693652583, 'loss_val': 0.024600243415386205, 'psi': 0.9955484695700452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S10] r=80 psi=0.996 u=0.0002 p_local=0.0005 f1=0.996 auprc=0.996 bytes=98736
[S11] START round=79 head_norm_before_train=1.823214 cos_to_last_merge=0.8765 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981632614576706, 'loss_val': 0.024480453352629283, 'psi': 0.9969455095310539}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981632661481346, 'loss_val': 0.02378920953819735, 'psi': 0.9969455114072394}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.997 u=0.0000 p_local=0.0009 f1=0.996 auprc=0.998 bytes=102583
[S13] START round=79 head_norm_before_train=1.532592 cos_to_last_merge=0.8073 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.807
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6431109407503894, 'auprc': 0.728348195198294, 'loss_val': 0.9889665373581638, 'psi': 0.6772058425295513}-{'f1_val': 0.7274072349646492, 'auprc': 0.7873858308834251, 'loss_val': 0.8021920676342581, 'psi': 0.7513986733321596}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.677 u=0.0000 p_local=0.1848 f1=0.643 auprc=0.728 bytes=79203
[S14] START round=79 head_norm_before_train=2.214184 cos_to_last_merge=0.9352 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9970674461608138, 'loss_val': 0.024998217192504224, 'psi': 0.9975186892446566}-{'f1_val': 0.9982330107938716, 'auprc': 0.9970762863895801, 'loss_val': 0.02320991303553211, 'psi': 0.997770321032155}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0756 f1=0.998 auprc=0.997 bytes=91721
[S15] START round=79 head_norm_before_train=1.945571 cos_to_last_merge=0.8890 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.889
[S15] round=79 local utility u=1.000000 metrics={'f1_val': 0.9496258124805217, 'auprc': 0.9904675407589829, 'loss_val': 0.08480104905690605, 'psi': 0.9659625037919062}-{'f1_val': 0.729411890183984, 'auprc': 0.8391813142723915, 'loss_val': 0.6624968081099226, 'psi': 0.773319659819347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=80 psi=0.966 u=1.0000 p_local=0.3386 f1=0.950 auprc=0.990 bytes=86161
[S16] START round=79 head_norm_before_train=2.186524 (no previous merge yet)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.881016810683809, 'auprc': 0.8947740778067933, 'loss_val': 0.7613758649350559, 'psi': 0.8865197175330027}-{'f1_val': 0.992844676947359, 'auprc': 0.992703565739042, 'loss_val': 0.03444591925358767, 'psi': 0.9927882324640322}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.887 u=0.0000 p_local=0.1254 f1=0.881 auprc=0.895 bytes=84511
[S17] START round=79 head_norm_before_train=1.833313 cos_to_last_merge=0.8875 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.7007462801815717, 'auprc': 0.7351291177771525, 'loss_val': 1.0115758759931497, 'psi': 0.7144994152198041}-{'f1_val': 0.8250896346922075, 'auprc': 0.9422211712116243, 'loss_val': 0.47114432608568263, 'psi': 0.8719422492999742}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.714 u=0.0000 p_local=0.2559 f1=0.701 auprc=0.735 bytes=77462
[S2] START round=80 head_norm_before_train=2.153883 cos_to_last_merge=0.9524 (last merge round=12)
[S2] round=80 local utility u=0.004216 metrics={'f1_val': 0.7204785231726085, 'auprc': 0.7712965735586407, 'loss_val': 0.9838521392322879, 'psi': 0.7408057433270214}-{'f1_val': 0.7217629290120583, 'auprc': 0.7625589897099203, 'loss_val': 0.9737782516863147, 'psi': 0.7380813532912032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=80 head_norm_before_train=2.120160 cos_to_last_merge=0.7588 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=80 local utility u=0.344885 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9998007498601278, 'loss_val': 0.12243675767094926, 'psi': 0.9764180653267893}-{'f1_val': 0.8884135658125152, 'auprc': 0.9777855686337021, 'loss_val': 0.31166415955494553, 'psi': 0.92416236694099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=80 head_norm_before_train=1.717160 cos_to_last_merge=0.9081 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=80 local utility u=0.023052 metrics={'f1_val': 0.9422625029483621, 'auprc': 0.9391526463993433, 'loss_val': 0.32546602975482514, 'psi': 0.9410185603287545}-{'f1_val': 0.9421513081543456, 'auprc': 0.9260728745217043, 'loss_val': 0.33166323638668205, 'psi': 0.935719934701289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=80 head_norm_before_train=1.701218 cos_to_last_merge=0.8150 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=80 local utility u=0.000603 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9907870180519927, 'loss_val': 0.027739496617445552, 'psi': 0.9938519073575276}-{'f1_val': 0.995895166894551, 'auprc': 0.9907322980561991, 'loss_val': 0.028780905789187305, 'psi': 0.9938300193592102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=80 head_norm_before_train=1.667622 cos_to_last_merge=0.8466 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.847
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6865508110861065, 'auprc': 0.9500449282458469, 'loss_val': 0.6391091328712539, 'psi': 0.7919484579500027}-{'f1_val': 0.6978222197364524, 'auprc': 0.9290826701381764, 'loss_val': 0.643421597103433, 'psi': 0.790326399897142}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.719624 cos_to_last_merge=0.9165 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=80 local utility u=0.558915 metrics={'f1_val': 0.6887620517513028, 'auprc': 0.8716980637585088, 'loss_val': 0.257993256223942, 'psi': 0.7619364565541852}-{'f1_val': 0.618805334275704, 'auprc': 0.7962709922940748, 'loss_val': 0.7298017717829092, 'psi': 0.6897915974830524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=80 head_norm_before_train=2.010963 cos_to_last_merge=0.9236 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.924
[S8] round=80 local utility u=0.001090 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9987118795130046, 'loss_val': 0.030079561241304897, 'psi': 0.995505138069611}-{'f1_val': 0.993122746315827, 'auprc': 0.9986336423713797, 'loss_val': 0.030558127205383544, 'psi': 0.9953271047380481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=80 head_norm_before_train=2.279466 cos_to_last_merge=0.9556 (last merge round=14)
[S9] round=80 local utility u=0.017857 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991970056702488, 'loss_val': 0.01715139849250999, 'psi': 0.9974414197063433}-{'f1_val': 0.9918361843886205, 'auprc': 0.999200433084945, 'loss_val': 0.02626671534894791, 'psi': 0.9947818838671503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=80 head_norm_before_train=2.005675 cos_to_last_merge=0.9259 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951295454637193, 'loss_val': 0.024746705142366807, 'psi': 0.9951645215971126}-{'f1_val': 0.9956096535150197, 'auprc': 0.9955967316717441, 'loss_val': 0.024617760247790423, 'psi': 0.9956044847777095}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.828050 cos_to_last_merge=0.8760 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=80 local utility u=0.000790 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981608534064581, 'loss_val': 0.022892887526442706, 'psi': 0.9969445463105688}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981632614576706, 'loss_val': 0.024480453352629283, 'psi': 0.9969455095310539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=80 head_norm_before_train=1.535726 cos_to_last_merge=0.8064 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.806
[S13] round=80 local utility u=0.068516 metrics={'f1_val': 0.6319749728411745, 'auprc': 0.7688672319625764, 'loss_val': 0.9066764192250935, 'psi': 0.6867318764897353}-{'f1_val': 0.6431109407503894, 'auprc': 0.728348195198294, 'loss_val': 0.9889665373581638, 'psi': 0.6772058425295513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=80 head_norm_before_train=2.219748 cos_to_last_merge=0.9351 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9828023824149508, 'auprc': 0.9988270920843639, 'loss_val': 0.040917406951698945, 'psi': 0.989212266282716}-{'f1_val': 0.9978195179672185, 'auprc': 0.9970674461608138, 'loss_val': 0.024998217192504224, 'psi': 0.9975186892446566}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=1.949615 cos_to_last_merge=0.8882 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=80 local utility u=0.156543 metrics={'f1_val': 0.992142892315468, 'auprc': 0.9930486362054619, 'loss_val': 0.03456125162513243, 'psi': 0.9925051898714655}-{'f1_val': 0.9496258124805217, 'auprc': 0.9904675407589829, 'loss_val': 0.08480104905690605, 'psi': 0.9659625037919062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=80 head_norm_before_train=2.192194 (no previous merge yet)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.8512658972443886, 'auprc': 0.8524598315261651, 'loss_val': 1.2304332600723915, 'psi': 0.8517434709570992}-{'f1_val': 0.881016810683809, 'auprc': 0.8947740778067933, 'loss_val': 0.7613758649350559, 'psi': 0.8865197175330027}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=1.843691 cos_to_last_merge=0.8867 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=80 local utility u=1.000000 metrics={'f1_val': 0.9674938594551853, 'auprc': 0.9854857951597755, 'loss_val': 0.12197934842132367, 'psi': 0.9746906337370214}-{'f1_val': 0.7007462801815717, 'auprc': 0.7351291177771525, 'loss_val': 1.0115758759931497, 'psi': 0.7144994152198041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=81 head_norm_before_train=2.157786 cos_to_last_merge=0.9521 (last merge round=12)
[S2] round=81 local utility u=0.048248 metrics={'f1_val': 0.7126790226700099, 'auprc': 0.7636519192266089, 'loss_val': 0.8176241743497483, 'psi': 0.7330681812926495}-{'f1_val': 0.7204785231726085, 'auprc': 0.7712965735586407, 'loss_val': 0.9838521392322879, 'psi': 0.7408057433270214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=81 head_norm_before_train=2.125290 cos_to_last_merge=0.7586 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.759
[S3] round=81 local utility u=0.159853 metrics={'f1_val': 0.996718896605481, 'auprc': 0.9997270179719893, 'loss_val': 0.017845254156193396, 'psi': 0.9979221451520843}-{'f1_val': 0.9608296089712303, 'auprc': 0.9998007498601278, 'loss_val': 0.12243675767094926, 'psi': 0.9764180653267893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=81 head_norm_before_train=1.720270 cos_to_last_merge=0.9070 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=81 local utility u=0.018861 metrics={'f1_val': 0.9433741705192489, 'auprc': 0.9480395913075723, 'loss_val': 0.32107505084520327, 'psi': 0.9452403388345783}-{'f1_val': 0.9422625029483621, 'auprc': 0.9391526463993433, 'loss_val': 0.32546602975482514, 'psi': 0.9410185603287545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=81 head_norm_before_train=1.708171 cos_to_last_merge=0.8144 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9907207381383368, 'loss_val': 0.028087055192874792, 'psi': 0.9938253953920653}-{'f1_val': 0.995895166894551, 'auprc': 0.9907870180519927, 'loss_val': 0.027739496617445552, 'psi': 0.9938519073575276}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.671995 cos_to_last_merge=0.8455 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=81 local utility u=0.257322 metrics={'f1_val': 0.7452498466161521, 'auprc': 0.9469381040806993, 'loss_val': 0.4673382237386236, 'psi': 0.825925149601971}-{'f1_val': 0.6865508110861065, 'auprc': 0.9500449282458469, 'loss_val': 0.6391091328712539, 'psi': 0.7919484579500027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=81 head_norm_before_train=1.723474 cos_to_last_merge=0.9157 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6019495863521708, 'auprc': 0.7960794827587225, 'loss_val': 0.7518163807530808, 'psi': 0.6796015449147914}-{'f1_val': 0.6887620517513028, 'auprc': 0.8716980637585088, 'loss_val': 0.257993256223942, 'psi': 0.7619364565541852}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.011782 cos_to_last_merge=0.9230 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.923
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.9988484353377417, 'loss_val': 0.031817717840138635, 'psi': 0.9950960821854113}-{'f1_val': 0.9933673104406822, 'auprc': 0.9987118795130046, 'loss_val': 0.030079561241304897, 'psi': 0.995505138069611}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=2.280856 cos_to_last_merge=0.9551 (last merge round=14)
[S9] round=81 local utility u=0.002434 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9988511943855809, 'loss_val': 0.016236410197963083, 'psi': 0.9978022252615181}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991970056702488, 'loss_val': 0.01715139849250999, 'psi': 0.9974414197063433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=81 head_norm_before_train=2.007037 cos_to_last_merge=0.9252 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948954821331348, 'loss_val': 0.025015655800935344, 'psi': 0.9950708962648788}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951295454637193, 'loss_val': 0.024746705142366807, 'psi': 0.9951645215971126}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.833644 cos_to_last_merge=0.8756 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=81 local utility u=0.000417 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981301383730934, 'loss_val': 0.02196771845644948, 'psi': 0.9969322602972229}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981608534064581, 'loss_val': 0.022892887526442706, 'psi': 0.9969445463105688}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=81 head_norm_before_train=1.540455 cos_to_last_merge=0.8055 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.805
[S13] round=81 local utility u=0.189782 metrics={'f1_val': 0.6546755498239273, 'auprc': 0.7998153147210534, 'loss_val': 0.7561605035409917, 'psi': 0.7127314557827777}-{'f1_val': 0.6319749728411745, 'auprc': 0.7688672319625764, 'loss_val': 0.9066764192250935, 'psi': 0.6867318764897353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=81 head_norm_before_train=2.227528 cos_to_last_merge=0.9349 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9296544473134981, 'auprc': 0.9989393256850843, 'loss_val': 0.13726405450116538, 'psi': 0.9573683986621325}-{'f1_val': 0.9828023824149508, 'auprc': 0.9988270920843639, 'loss_val': 0.040917406951698945, 'psi': 0.989212266282716}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.954457 cos_to_last_merge=0.8879 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.711395919197787, 'auprc': 0.8376694872995334, 'loss_val': 0.6822358719179655, 'psi': 0.7619053464384855}-{'f1_val': 0.992142892315468, 'auprc': 0.9930486362054619, 'loss_val': 0.03456125162513243, 'psi': 0.9925051898714655}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.195230 (no previous merge yet)
[S16] round=81 local utility u=1.000000 metrics={'f1_val': 0.9928963126989042, 'auprc': 0.9927003337455306, 'loss_val': 0.031299678702035136, 'psi': 0.9928179211175547}-{'f1_val': 0.8512658972443886, 'auprc': 0.8524598315261651, 'loss_val': 1.2304332600723915, 'psi': 0.8517434709570992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=81 head_norm_before_train=1.850347 cos_to_last_merge=0.8859 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.886
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.8904711258056338, 'auprc': 0.9719581351138324, 'loss_val': 0.25260135733803835, 'psi': 0.9230659295289132}-{'f1_val': 0.9674938594551853, 'auprc': 0.9854857951597755, 'loss_val': 0.12197934842132367, 'psi': 0.9746906337370214}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.161248 cos_to_last_merge=0.9518 (last merge round=12)
[S2] round=82 local utility u=0.092050 metrics={'f1_val': 0.7187761702683759, 'auprc': 0.8167551400925739, 'loss_val': 0.8294166580210688, 'psi': 0.7579677581980551}-{'f1_val': 0.7126790226700099, 'auprc': 0.7636519192266089, 'loss_val': 0.8176241743497483, 'psi': 0.7330681812926495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=82 head_norm_before_train=2.130235 cos_to_last_merge=0.7584 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9964219183221354, 'auprc': 0.9996220697954921, 'loss_val': 0.022535163157171845, 'psi': 0.9977019789114782}-{'f1_val': 0.996718896605481, 'auprc': 0.9997270179719893, 'loss_val': 0.017845254156193396, 'psi': 0.9979221451520843}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.725805 cos_to_last_merge=0.9069 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9387921843595407, 'auprc': 0.9285133172873006, 'loss_val': 0.34270464547825275, 'psi': 0.9346806375306447}-{'f1_val': 0.9433741705192489, 'auprc': 0.9480395913075723, 'loss_val': 0.32107505084520327, 'psi': 0.9452403388345783}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.714089 cos_to_last_merge=0.8137 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9898641808643743, 'loss_val': 0.029145938056038555, 'psi': 0.9934827724824803}-{'f1_val': 0.995895166894551, 'auprc': 0.9907207381383368, 'loss_val': 0.028087055192874792, 'psi': 0.9938253953920653}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.674586 cos_to_last_merge=0.8448 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.6820452406727899, 'auprc': 0.9239901218512814, 'loss_val': 0.5619243194265154, 'psi': 0.7788231931441865}-{'f1_val': 0.7452498466161521, 'auprc': 0.9469381040806993, 'loss_val': 0.4673382237386236, 'psi': 0.825925149601971}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.726057 cos_to_last_merge=0.9149 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=82 local utility u=0.945228 metrics={'f1_val': 0.8039888505201812, 'auprc': 0.8616686279430533, 'loss_val': 0.2703641265185041, 'psi': 0.82706076148933}-{'f1_val': 0.6019495863521708, 'auprc': 0.7960794827587225, 'loss_val': 0.7518163807530808, 'psi': 0.6796015449147914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=82 head_norm_before_train=2.013092 cos_to_last_merge=0.9227 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.923
[S8] round=82 local utility u=0.003253 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9988272816043344, 'loss_val': 0.028416836540001954, 'psi': 0.9954045604312299}-{'f1_val': 0.9925945134171912, 'auprc': 0.9988484353377417, 'loss_val': 0.031817717840138635, 'psi': 0.9950960821854113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=82 head_norm_before_train=2.283996 cos_to_last_merge=0.9548 (last merge round=14)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.986144618344318, 'auprc': 0.9992012464598524, 'loss_val': 0.053894628754720404, 'psi': 0.9913672695905318}-{'f1_val': 0.9971029125121428, 'auprc': 0.9988511943855809, 'loss_val': 0.016236410197963083, 'psi': 0.9978022252615181}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.009945 cos_to_last_merge=0.9247 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=82 local utility u=0.000583 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951495439130716, 'loss_val': 0.024612298567537612, 'psi': 0.9951725209768535}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948954821331348, 'loss_val': 0.025015655800935344, 'psi': 0.9950708962648788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=82 head_norm_before_train=1.839579 cos_to_last_merge=0.8750 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981838493360887, 'loss_val': 0.023565285850540144, 'psi': 0.996953744682421}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981301383730934, 'loss_val': 0.02196771845644948, 'psi': 0.9969322602972229}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.544385 cos_to_last_merge=0.8046 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.805
[S13] round=82 local utility u=0.025314 metrics={'f1_val': 0.7308223938211021, 'auprc': 0.7164918431431183, 'loss_val': 0.9124440251344217, 'psi': 0.7250901735499087}-{'f1_val': 0.6546755498239273, 'auprc': 0.7998153147210534, 'loss_val': 0.7561605035409917, 'psi': 0.7127314557827777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=82 head_norm_before_train=2.235786 cos_to_last_merge=0.9347 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=82 local utility u=0.023752 metrics={'f1_val': 0.9351801099176734, 'auprc': 0.998923572602094, 'loss_val': 0.12286625257070315, 'psi': 0.9606774949914416}-{'f1_val': 0.9296544473134981, 'auprc': 0.9989393256850843, 'loss_val': 0.13726405450116538, 'psi': 0.9573683986621325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=82 head_norm_before_train=1.960676 cos_to_last_merge=0.8875 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=82 local utility u=0.363789 metrics={'f1_val': 0.7775834742522253, 'auprc': 0.9051692446308189, 'loss_val': 0.5542823154455079, 'psi': 0.8286177824036628}-{'f1_val': 0.711395919197787, 'auprc': 0.8376694872995334, 'loss_val': 0.6822358719179655, 'psi': 0.7619053464384855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=82 head_norm_before_train=2.198467 (no previous merge yet)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.8758636632661936, 'auprc': 0.9901219319214638, 'loss_val': 0.4117013888569037, 'psi': 0.9215669707283016}-{'f1_val': 0.9928963126989042, 'auprc': 0.9927003337455306, 'loss_val': 0.031299678702035136, 'psi': 0.9928179211175547}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.857758 cos_to_last_merge=0.8847 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.885
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.726347060740685, 'auprc': 0.8717718386282689, 'loss_val': 0.8166606240554523, 'psi': 0.7845169718957186}-{'f1_val': 0.8904711258056338, 'auprc': 0.9719581351138324, 'loss_val': 0.25260135733803835, 'psi': 0.9230659295289132}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=2.164008 cos_to_last_merge=0.9515 (last merge round=12)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.6983639249147009, 'auprc': 0.7436001672075218, 'loss_val': 0.8701609320003539, 'psi': 0.7164584218318293}-{'f1_val': 0.7187761702683759, 'auprc': 0.8167551400925739, 'loss_val': 0.8294166580210688, 'psi': 0.7579677581980551}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.134633 cos_to_last_merge=0.7582 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9997482493665026, 'loss_val': 0.16184937018264334, 'psi': 0.9763970651293392}-{'f1_val': 0.9964219183221354, 'auprc': 0.9996220697954921, 'loss_val': 0.022535163157171845, 'psi': 0.9977019789114782}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=1.729025 cos_to_last_merge=0.9067 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=83 local utility u=0.022738 metrics={'f1_val': 0.9397507916767551, 'auprc': 0.9382339800670054, 'loss_val': 0.3321427745385579, 'psi': 0.9391440670328552}-{'f1_val': 0.9387921843595407, 'auprc': 0.9285133172873006, 'loss_val': 0.34270464547825275, 'psi': 0.9346806375306447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=83 head_norm_before_train=1.721703 cos_to_last_merge=0.8128 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9898709745468909, 'loss_val': 0.02949008093956382, 'psi': 0.9934854899554869}-{'f1_val': 0.995895166894551, 'auprc': 0.9898641808643743, 'loss_val': 0.029145938056038555, 'psi': 0.9934827724824803}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.680160 cos_to_last_merge=0.8442 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=83 local utility u=0.605607 metrics={'f1_val': 0.8437909437829226, 'auprc': 0.9548712936138615, 'loss_val': 0.41382855483144015, 'psi': 0.8882230837152981}-{'f1_val': 0.6820452406727899, 'auprc': 0.9239901218512814, 'loss_val': 0.5619243194265154, 'psi': 0.7788231931441865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=83 head_norm_before_train=1.729895 cos_to_last_merge=0.9141 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=83 local utility u=0.034798 metrics={'f1_val': 0.7386820090308905, 'auprc': 0.9802251701812961, 'loss_val': 0.16459629174206528, 'psi': 0.8352992734910527}-{'f1_val': 0.8039888505201812, 'auprc': 0.8616686279430533, 'loss_val': 0.2703641265185041, 'psi': 0.82706076148933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=83 head_norm_before_train=2.016246 cos_to_last_merge=0.9225 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.923
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9918662256905537, 'auprc': 0.9987764913266528, 'loss_val': 0.031773745237508415, 'psi': 0.9946303319449933}-{'f1_val': 0.993122746315827, 'auprc': 0.9988272816043344, 'loss_val': 0.028416836540001954, 'psi': 0.9954045604312299}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.285726 cos_to_last_merge=0.9543 (last merge round=14)
[S9] round=83 local utility u=0.049231 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991958672653731, 'loss_val': 0.016174627456503807, 'psi': 0.9974409643443929}-{'f1_val': 0.986144618344318, 'auprc': 0.9992012464598524, 'loss_val': 0.053894628754720404, 'psi': 0.9913672695905318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=83 head_norm_before_train=2.014267 cos_to_last_merge=0.9243 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951025695643296, 'loss_val': 0.024621969878598077, 'psi': 0.9951537312373566}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951495439130716, 'loss_val': 0.024612298567537612, 'psi': 0.9951725209768535}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.843572 cos_to_last_merge=0.8746 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.875
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9981641550874828, 'loss_val': 0.03567965591540461, 'psi': 0.9970908941804436}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981838493360887, 'loss_val': 0.023565285850540144, 'psi': 0.996953744682421}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.547061 cos_to_last_merge=0.8039 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.804
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.73088732940145, 'auprc': 0.6884434726642222, 'loss_val': 1.0454250267167005, 'psi': 0.7139097867065589}-{'f1_val': 0.7308223938211021, 'auprc': 0.7164918431431183, 'loss_val': 0.9124440251344217, 'psi': 0.7250901735499087}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.242655 cos_to_last_merge=0.9343 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9337480327093031, 'auprc': 0.9987817356342303, 'loss_val': 0.13821230209169413, 'psi': 0.959761513879274}-{'f1_val': 0.9351801099176734, 'auprc': 0.998923572602094, 'loss_val': 0.12286625257070315, 'psi': 0.9606774949914416}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=1.966580 cos_to_last_merge=0.8865 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=83 local utility u=1.000000 metrics={'f1_val': 0.995697212812159, 'auprc': 0.9940075028877638, 'loss_val': 0.028436486115217968, 'psi': 0.9950213288424008}-{'f1_val': 0.7775834742522253, 'auprc': 0.9051692446308189, 'loss_val': 0.5542823154455079, 'psi': 0.8286177824036628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=83 head_norm_before_train=2.202537 (no previous merge yet)
[S16] round=83 local utility u=0.542596 metrics={'f1_val': 0.9933408181972238, 'auprc': 0.9917925609346999, 'loss_val': 0.03638482462665413, 'psi': 0.9927215152922142}-{'f1_val': 0.8758636632661936, 'auprc': 0.9901219319214638, 'loss_val': 0.4117013888569037, 'psi': 0.9215669707283016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=83 head_norm_before_train=1.864841 cos_to_last_merge=0.8836 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.884
[S17] round=83 local utility u=1.000000 metrics={'f1_val': 0.9533237189141615, 'auprc': 0.9838613157469962, 'loss_val': 0.13780278594259138, 'psi': 0.9655387576472954}-{'f1_val': 0.726347060740685, 'auprc': 0.8717718386282689, 'loss_val': 0.8166606240554523, 'psi': 0.7845169718957186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=84 head_norm_before_train=2.167262 cos_to_last_merge=0.9513 (last merge round=12)
[S2] round=84 local utility u=0.056669 metrics={'f1_val': 0.7204118787873032, 'auprc': 0.7702007681000135, 'loss_val': 0.9689128166492939, 'psi': 0.7403274345123874}-{'f1_val': 0.6983639249147009, 'auprc': 0.7436001672075218, 'loss_val': 0.8701609320003539, 'psi': 0.7164584218318293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=84 head_norm_before_train=2.136683 cos_to_last_merge=0.7580 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.9269338057699157, 'auprc': 0.9931175743362406, 'loss_val': 0.21559428733325636, 'psi': 0.9534073131964456}-{'f1_val': 0.9608296089712303, 'auprc': 0.9997482493665026, 'loss_val': 0.16184937018264334, 'psi': 0.9763970651293392}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.730807 cos_to_last_merge=0.9064 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=84 local utility u=0.002333 metrics={'f1_val': 0.9401838245638209, 'auprc': 0.9390286715950148, 'loss_val': 0.33245955808999833, 'psi': 0.9397217633762984}-{'f1_val': 0.9397507916767551, 'auprc': 0.9382339800670054, 'loss_val': 0.3321427745385579, 'psi': 0.9391440670328552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=84 head_norm_before_train=1.728034 cos_to_last_merge=0.8121 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=84 local utility u=0.002654 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.991217273713662, 'loss_val': 0.0264640478403776, 'psi': 0.9938483895101359}-{'f1_val': 0.995895166894551, 'auprc': 0.9898709745468909, 'loss_val': 0.02949008093956382, 'psi': 0.9934854899554869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=84 head_norm_before_train=1.685087 cos_to_last_merge=0.8432 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.5950186957670345, 'auprc': 0.7735721614458946, 'loss_val': 0.9996742074498481, 'psi': 0.6664400820385785}-{'f1_val': 0.8437909437829226, 'auprc': 0.9548712936138615, 'loss_val': 0.41382855483144015, 'psi': 0.8882230837152981}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.735446 cos_to_last_merge=0.9136 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6416562196303776, 'auprc': 0.7897892010137879, 'loss_val': 0.7477422328273909, 'psi': 0.7009094121837418}-{'f1_val': 0.7386820090308905, 'auprc': 0.9802251701812961, 'loss_val': 0.16459629174206528, 'psi': 0.8352992734910527}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.021774 cos_to_last_merge=0.9221 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.922
[S8] round=84 local utility u=0.002719 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.9986179227977505, 'loss_val': 0.030230169157560834, 'psi': 0.995003877169415}-{'f1_val': 0.9918662256905537, 'auprc': 0.9987764913266528, 'loss_val': 0.031773745237508415, 'psi': 0.9946303319449933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=84 head_norm_before_train=2.289291 cos_to_last_merge=0.9538 (last merge round=14)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936011696707411, 'loss_val': 0.017569242063821783, 'psi': 0.9954559626271537}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991958672653731, 'loss_val': 0.016174627456503807, 'psi': 0.9974409643443929}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.019388 cos_to_last_merge=0.9239 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=84 local utility u=0.000201 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995133639773286, 'loss_val': 0.024313538036464136, 'psi': 0.9951661593209392}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951025695643296, 'loss_val': 0.024621969878598077, 'psi': 0.9951537312373566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=84 head_norm_before_train=1.846641 cos_to_last_merge=0.8744 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=84 local utility u=0.006420 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9982040622793502, 'loss_val': 0.022960244083748242, 'psi': 0.9971068570571906}-{'f1_val': 0.9963753869090841, 'auprc': 0.9981641550874828, 'loss_val': 0.03567965591540461, 'psi': 0.9970908941804436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=84 head_norm_before_train=1.547218 cos_to_last_merge=0.8034 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.803
[S13] round=84 local utility u=0.229412 metrics={'f1_val': 0.7114766338444415, 'auprc': 0.7693161467521652, 'loss_val': 0.7127548486897946, 'psi': 0.734612439007531}-{'f1_val': 0.73088732940145, 'auprc': 0.6884434726642222, 'loss_val': 1.0454250267167005, 'psi': 0.7139097867065589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=84 head_norm_before_train=2.247847 cos_to_last_merge=0.9340 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9317742324492458, 'auprc': 0.9985072970735458, 'loss_val': 0.1598395944284158, 'psi': 0.9584674582989658}-{'f1_val': 0.9337480327093031, 'auprc': 0.9987817356342303, 'loss_val': 0.13821230209169413, 'psi': 0.959761513879274}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=1.973637 cos_to_last_merge=0.8859 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.886
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.7953379174272475, 'auprc': 0.9436955878525254, 'loss_val': 0.48212679708481754, 'psi': 0.8546809855973587}-{'f1_val': 0.995697212812159, 'auprc': 0.9940075028877638, 'loss_val': 0.028436486115217968, 'psi': 0.9950213288424008}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.204438 (no previous merge yet)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9928790893310245, 'auprc': 0.9893129995888814, 'loss_val': 0.033638650871244555, 'psi': 0.9914526534341672}-{'f1_val': 0.9933408181972238, 'auprc': 0.9917925609346999, 'loss_val': 0.03638482462665413, 'psi': 0.9927215152922142}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.872173 cos_to_last_merge=0.8829 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.908475259906156, 'auprc': 0.9660069898218071, 'loss_val': 0.2628603965221301, 'psi': 0.9314879518724164}-{'f1_val': 0.9533237189141615, 'auprc': 0.9838613157469962, 'loss_val': 0.13780278594259138, 'psi': 0.9655387576472954}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.169070 cos_to_last_merge=0.9512 (last merge round=12)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7204708802515032, 'auprc': 0.7328231753521548, 'loss_val': 0.9788882144837885, 'psi': 0.7254117982917638}-{'f1_val': 0.7204118787873032, 'auprc': 0.7702007681000135, 'loss_val': 0.9689128166492939, 'psi': 0.7403274345123874}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.138085 cos_to_last_merge=0.7577 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.758
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.7235040150640244, 'auprc': 0.9984097903768023, 'loss_val': 0.5876230540519141, 'psi': 0.8334663251891357}-{'f1_val': 0.9269338057699157, 'auprc': 0.9931175743362406, 'loss_val': 0.21559428733325636, 'psi': 0.9534073131964456}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.734561 cos_to_last_merge=0.9054 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9394198998381807, 'auprc': 0.9321760940478074, 'loss_val': 0.34015124388610396, 'psi': 0.9365223775220314}-{'f1_val': 0.9401838245638209, 'auprc': 0.9390286715950148, 'loss_val': 0.33245955808999833, 'psi': 0.9397217633762984}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.733714 cos_to_last_merge=0.8114 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=85 local utility u=0.000944 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9912150071798987, 'loss_val': 0.02632464759230831, 'psi': 0.9940231030086901}-{'f1_val': 0.9956024667077852, 'auprc': 0.991217273713662, 'loss_val': 0.0264640478403776, 'psi': 0.9938483895101359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=85 head_norm_before_train=1.687722 cos_to_last_merge=0.8426 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=85 local utility u=1.000000 metrics={'f1_val': 0.866224217943321, 'auprc': 0.9574070277270168, 'loss_val': 0.34262962654680645, 'psi': 0.9026973418567994}-{'f1_val': 0.5950186957670345, 'auprc': 0.7735721614458946, 'loss_val': 0.9996742074498481, 'psi': 0.6664400820385785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=85 head_norm_before_train=1.738392 cos_to_last_merge=0.9136 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=85 local utility u=0.664900 metrics={'f1_val': 0.6999489174952475, 'auprc': 0.9516755856174747, 'loss_val': 0.2533579549199067, 'psi': 0.8006395847441383}-{'f1_val': 0.6416562196303776, 'auprc': 0.7897892010137879, 'loss_val': 0.7477422328273909, 'psi': 0.7009094121837418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=85 head_norm_before_train=2.028351 cos_to_last_merge=0.9216 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.922
[S8] round=85 local utility u=0.003430 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9986716511280881, 'loss_val': 0.0281675639898383, 'psi': 0.9954890467156445}-{'f1_val': 0.9925945134171912, 'auprc': 0.9986179227977505, 'loss_val': 0.030230169157560834, 'psi': 0.995003877169415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=85 head_norm_before_train=2.294189 cos_to_last_merge=0.9536 (last merge round=14)
[S9] round=85 local utility u=0.002312 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936894592445426, 'loss_val': 0.015673204708767593, 'psi': 0.9957375312051027}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936011696707411, 'loss_val': 0.017569242063821783, 'psi': 0.9954559626271537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=85 head_norm_before_train=2.024873 cos_to_last_merge=0.9237 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949950472645042, 'loss_val': 0.024435779627589565, 'psi': 0.9951107223174265}-{'f1_val': 0.9951878390193748, 'auprc': 0.995133639773286, 'loss_val': 0.024313538036464136, 'psi': 0.9951661593209392}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=1.851305 cos_to_last_merge=0.8740 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=85 local utility u=0.000322 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998474384750544, 'loss_val': 0.021677201083524028, 'psi': 0.9970699588482032}-{'f1_val': 0.9963753869090841, 'auprc': 0.9982040622793502, 'loss_val': 0.022960244083748242, 'psi': 0.9971068570571906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=85 head_norm_before_train=1.551030 cos_to_last_merge=0.8027 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.803
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6093890851097012, 'auprc': 0.6539184721342344, 'loss_val': 1.0751878023968313, 'psi': 0.6272008399195145}-{'f1_val': 0.7114766338444415, 'auprc': 0.7693161467521652, 'loss_val': 0.7127548486897946, 'psi': 0.734612439007531}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.249250 cos_to_last_merge=0.9337 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.8875178081858089, 'auprc': 0.9985651859155722, 'loss_val': 0.3571385594092257, 'psi': 0.9319367592777142}-{'f1_val': 0.9317742324492458, 'auprc': 0.9985072970735458, 'loss_val': 0.1598395944284158, 'psi': 0.9584674582989658}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.980273 cos_to_last_merge=0.8854 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.7485859104330108, 'auprc': 0.8549141889536878, 'loss_val': 0.6614051455469958, 'psi': 0.7911172218412816}-{'f1_val': 0.7953379174272475, 'auprc': 0.9436955878525254, 'loss_val': 0.48212679708481754, 'psi': 0.8546809855973587}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.207146 (no previous merge yet)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9145217588058102, 'auprc': 0.9757797739947269, 'loss_val': 0.5497597225344133, 'psi': 0.9390249648813769}-{'f1_val': 0.9928790893310245, 'auprc': 0.9893129995888814, 'loss_val': 0.033638650871244555, 'psi': 0.9914526534341672}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.879882 cos_to_last_merge=0.8823 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8672359934216631, 'auprc': 0.956614462488919, 'loss_val': 0.36119382861657534, 'psi': 0.9029873810485656}-{'f1_val': 0.908475259906156, 'auprc': 0.9660069898218071, 'loss_val': 0.2628603965221301, 'psi': 0.9314879518724164}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.168430 cos_to_last_merge=0.9515 (last merge round=12)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7209619614152681, 'auprc': 0.7400054003508262, 'loss_val': 1.0252808237380917, 'psi': 0.7285793369894913}-{'f1_val': 0.7204708802515032, 'auprc': 0.7328231753521548, 'loss_val': 0.9788882144837885, 'psi': 0.7254117982917638}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.141281 cos_to_last_merge=0.7574 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=86 local utility u=0.883578 metrics={'f1_val': 0.9424037027331338, 'auprc': 0.9987876369943921, 'loss_val': 0.1349980765456276, 'psi': 0.9649572764376371}-{'f1_val': 0.7235040150640244, 'auprc': 0.9984097903768023, 'loss_val': 0.5876230540519141, 'psi': 0.8334663251891357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=86 head_norm_before_train=1.737578 cos_to_last_merge=0.9045 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=86 local utility u=0.044489 metrics={'f1_val': 0.9421494430397785, 'auprc': 0.9516556438266093, 'loss_val': 0.3259883232902034, 'psi': 0.9459519233545108}-{'f1_val': 0.9394198998381807, 'auprc': 0.9321760940478074, 'loss_val': 0.34015124388610396, 'psi': 0.9365223775220314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=86 head_norm_before_train=1.739613 cos_to_last_merge=0.8109 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9909692593065491, 'loss_val': 0.026434557616245254, 'psi': 0.9939248038593502}-{'f1_val': 0.995895166894551, 'auprc': 0.9912150071798987, 'loss_val': 0.02632464759230831, 'psi': 0.9940231030086901}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.691678 cos_to_last_merge=0.8424 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7171325076839028, 'auprc': 0.8787586357333506, 'loss_val': 0.8122640995861592, 'psi': 0.7817829589036819}-{'f1_val': 0.866224217943321, 'auprc': 0.9574070277270168, 'loss_val': 0.34262962654680645, 'psi': 0.9026973418567994}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.738694 cos_to_last_merge=0.9135 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6622616167979335, 'auprc': 0.7964243958174315, 'loss_val': 0.5130625860236195, 'psi': 0.7159267284057327}-{'f1_val': 0.6999489174952475, 'auprc': 0.9516755856174747, 'loss_val': 0.2533579549199067, 'psi': 0.8006395847441383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.032769 cos_to_last_merge=0.9208 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.921
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9986785366909507, 'loss_val': 0.028695897499353588, 'psi': 0.9954918009407896}-{'f1_val': 0.9933673104406822, 'auprc': 0.9986716511280881, 'loss_val': 0.0281675639898383, 'psi': 0.9954890467156445}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.298543 cos_to_last_merge=0.9533 (last merge round=14)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9991653416286732, 'loss_val': 0.023919201681556854, 'psi': 0.9956783077440464}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936894592445426, 'loss_val': 0.015673204708767593, 'psi': 0.9957375312051027}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.025872 cos_to_last_merge=0.9230 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949858081987739, 'loss_val': 0.024458367073447645, 'psi': 0.9951070266911344}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949950472645042, 'loss_val': 0.024435779627589565, 'psi': 0.9951107223174265}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.856758 cos_to_last_merge=0.8735 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.874
[S11] round=86 local utility u=0.001915 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.998334347635658, 'loss_val': 0.018876647942433388, 'psi': 0.9971589711997138}-{'f1_val': 0.9961336749133093, 'auprc': 0.998474384750544, 'loss_val': 0.021677201083524028, 'psi': 0.9970699588482032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=86 head_norm_before_train=1.555207 cos_to_last_merge=0.8021 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=86 local utility u=0.192992 metrics={'f1_val': 0.6218476117276255, 'auprc': 0.7466194175986257, 'loss_val': 1.042056964687349, 'psi': 0.6717563340760255}-{'f1_val': 0.6093890851097012, 'auprc': 0.6539184721342344, 'loss_val': 1.0751878023968313, 'psi': 0.6272008399195145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=86 head_norm_before_train=2.252216 cos_to_last_merge=0.9334 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=86 local utility u=0.484198 metrics={'f1_val': 0.9961745166341707, 'auprc': 0.9988743169824748, 'loss_val': 0.04160945828704876, 'psi': 0.9972544367734923}-{'f1_val': 0.8875178081858089, 'auprc': 0.9985651859155722, 'loss_val': 0.3571385594092257, 'psi': 0.9319367592777142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=86 head_norm_before_train=1.987188 cos_to_last_merge=0.8851 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=86 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9913080324058909, 'loss_val': 0.0246928366469047, 'psi': 0.9943226594716409}-{'f1_val': 0.7485859104330108, 'auprc': 0.8549141889536878, 'loss_val': 0.6614051455469958, 'psi': 0.7911172218412816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=86 head_norm_before_train=2.211803 (no previous merge yet)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.8641293439912898, 'auprc': 0.8952916400451375, 'loss_val': 1.1123678450138592, 'psi': 0.8765942624128289}-{'f1_val': 0.9145217588058102, 'auprc': 0.9757797739947269, 'loss_val': 0.5497597225344133, 'psi': 0.9390249648813769}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.888201 cos_to_last_merge=0.8816 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.882
[S17] round=86 local utility u=0.547728 metrics={'f1_val': 0.9907542364698092, 'auprc': 0.9870499405697233, 'loss_val': 0.09815383304117824, 'psi': 0.9892725181097748}-{'f1_val': 0.8672359934216631, 'auprc': 0.956614462488919, 'loss_val': 0.36119382861657534, 'psi': 0.9029873810485656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=87 head_norm_before_train=2.169192 cos_to_last_merge=0.9516 (last merge round=12)
[S2] round=87 local utility u=0.013379 metrics={'f1_val': 0.7205450724696107, 'auprc': 0.7349174701400595, 'loss_val': 0.9807578571857484, 'psi': 0.7262940315377902}-{'f1_val': 0.7209619614152681, 'auprc': 0.7400054003508262, 'loss_val': 1.0252808237380917, 'psi': 0.7285793369894913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=87 head_norm_before_train=2.146057 cos_to_last_merge=0.7572 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=87 local utility u=0.077770 metrics={'f1_val': 0.9624632639299391, 'auprc': 0.9998589716949332, 'loss_val': 0.10303027834929282, 'psi': 0.9774215470359368}-{'f1_val': 0.9424037027331338, 'auprc': 0.9987876369943921, 'loss_val': 0.1349980765456276, 'psi': 0.9649572764376371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=87 head_norm_before_train=1.743090 cos_to_last_merge=0.9037 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=87 local utility u=0.011313 metrics={'f1_val': 0.9462347952248538, 'auprc': 0.9526383613061125, 'loss_val': 0.3308223568014446, 'psi': 0.9487962216573573}-{'f1_val': 0.9421494430397785, 'auprc': 0.9516556438266093, 'loss_val': 0.3259883232902034, 'psi': 0.9459519233545108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=87 head_norm_before_train=1.745629 cos_to_last_merge=0.8105 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9905604634095361, 'loss_val': 0.025946568046300418, 'psi': 0.993761285500545}-{'f1_val': 0.995895166894551, 'auprc': 0.9909692593065491, 'loss_val': 0.026434557616245254, 'psi': 0.9939248038593502}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=1.698233 cos_to_last_merge=0.8422 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.5709830557447064, 'auprc': 0.7049408037900178, 'loss_val': 1.2088725369780757, 'psi': 0.624566154962831}-{'f1_val': 0.7171325076839028, 'auprc': 0.8787586357333506, 'loss_val': 0.8122640995861592, 'psi': 0.7817829589036819}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.736817 cos_to_last_merge=0.9133 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=87 local utility u=0.102280 metrics={'f1_val': 0.6688908801846662, 'auprc': 0.8140312597957169, 'loss_val': 0.40109804612057176, 'psi': 0.7269470320290865}-{'f1_val': 0.6622616167979335, 'auprc': 0.7964243958174315, 'loss_val': 0.5130625860236195, 'psi': 0.7159267284057327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=87 head_norm_before_train=2.037649 cos_to_last_merge=0.9203 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.920
[S8] round=87 local utility u=0.001687 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9988142980764072, 'loss_val': 0.027925686671097835, 'psi': 0.9957657495716317}-{'f1_val': 0.9933673104406822, 'auprc': 0.9986785366909507, 'loss_val': 0.028695897499353588, 'psi': 0.9954918009407896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=87 head_norm_before_train=2.300293 cos_to_last_merge=0.9525 (last merge round=14)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.990399656971262, 'auprc': 0.9991605102675499, 'loss_val': 0.034185178290624826, 'psi': 0.9939039982897772}-{'f1_val': 0.9933536184876286, 'auprc': 0.9991653416286732, 'loss_val': 0.023919201681556854, 'psi': 0.9956783077440464}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.026363 cos_to_last_merge=0.9223 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=87 local utility u=0.000357 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951393375954025, 'loss_val': 0.02420425566541424, 'psi': 0.9951684384497859}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949858081987739, 'loss_val': 0.024458367073447645, 'psi': 0.9951070266911344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=87 head_norm_before_train=1.861129 cos_to_last_merge=0.8731 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981883404792442, 'loss_val': 0.020833216105771626, 'psi': 0.9972035388998515}-{'f1_val': 0.9963753869090841, 'auprc': 0.998334347635658, 'loss_val': 0.018876647942433388, 'psi': 0.9971589711997138}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.557824 cos_to_last_merge=0.8016 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6107780631219121, 'auprc': 0.6991096129245474, 'loss_val': 1.1528097013689356, 'psi': 0.6461106830429661}-{'f1_val': 0.6218476117276255, 'auprc': 0.7466194175986257, 'loss_val': 1.042056964687349, 'psi': 0.6717563340760255}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.252347 cos_to_last_merge=0.9329 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9808200281494859, 'auprc': 0.998767287461052, 'loss_val': 0.03986787090520756, 'psi': 0.9879989318741124}-{'f1_val': 0.9961745166341707, 'auprc': 0.9988743169824748, 'loss_val': 0.04160945828704876, 'psi': 0.9972544367734923}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=1.994056 cos_to_last_merge=0.8848 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.943524817751692, 'auprc': 0.9921070733081574, 'loss_val': 0.09602108290682532, 'psi': 0.9629577199742781}-{'f1_val': 0.9963324108488076, 'auprc': 0.9913080324058909, 'loss_val': 0.0246928366469047, 'psi': 0.9943226594716409}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=2.217311 (no previous merge yet)
[S16] round=87 local utility u=0.024461 metrics={'f1_val': 0.864735388525219, 'auprc': 0.9093590380552102, 'loss_val': 1.1092838652860026, 'psi': 0.8825848483372155}-{'f1_val': 0.8641293439912898, 'auprc': 0.8952916400451375, 'loss_val': 1.1123678450138592, 'psi': 0.8765942624128289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=87 head_norm_before_train=1.897953 cos_to_last_merge=0.8809 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7180585294556441, 'auprc': 0.8816423826733473, 'loss_val': 0.8313046053105391, 'psi': 0.7834920707427253}-{'f1_val': 0.9907542364698092, 'auprc': 0.9870499405697233, 'loss_val': 0.09815383304117824, 'psi': 0.9892725181097748}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.171308 cos_to_last_merge=0.9514 (last merge round=12)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7211908406827098, 'auprc': 0.7313873874533636, 'loss_val': 1.0008793077643683, 'psi': 0.7252694593909713}-{'f1_val': 0.7205450724696107, 'auprc': 0.7349174701400595, 'loss_val': 0.9807578571857484, 'psi': 0.7262940315377902}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.151597 cos_to_last_merge=0.7569 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9994917677092364, 'loss_val': 0.12251492602737425, 'psi': 0.9764178577469607}-{'f1_val': 0.9624632639299391, 'auprc': 0.9998589716949332, 'loss_val': 0.10303027834929282, 'psi': 0.9774215470359368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.749535 cos_to_last_merge=0.9030 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9371858690318593, 'auprc': 0.9280040007460517, 'loss_val': 0.3588236225488598, 'psi': 0.9335131217175363}-{'f1_val': 0.9462347952248538, 'auprc': 0.9526383613061125, 'loss_val': 0.3308223568014446, 'psi': 0.9487962216573573}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.751674 cos_to_last_merge=0.8099 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=88 local utility u=0.001424 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9913665035210943, 'loss_val': 0.02551703492535925, 'psi': 0.9940837015451683}-{'f1_val': 0.995895166894551, 'auprc': 0.9905604634095361, 'loss_val': 0.025946568046300418, 'psi': 0.993761285500545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=88 head_norm_before_train=1.702775 cos_to_last_merge=0.8417 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.9642411669424263, 'auprc': 0.9865751000026851, 'loss_val': 0.11339481071475963, 'psi': 0.9731747401665298}-{'f1_val': 0.5709830557447064, 'auprc': 0.7049408037900178, 'loss_val': 1.2088725369780757, 'psi': 0.624566154962831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=88 head_norm_before_train=1.738989 cos_to_last_merge=0.9129 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5908857380035953, 'auprc': 0.7803695942752406, 'loss_val': 0.983240561015301, 'psi': 0.6666792805122534}-{'f1_val': 0.6688908801846662, 'auprc': 0.8140312597957169, 'loss_val': 0.40109804612057176, 'psi': 0.7269470320290865}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.044336 cos_to_last_merge=0.9197 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.920
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.993080372776832, 'auprc': 0.9987611480828587, 'loss_val': 0.029847603207428332, 'psi': 0.9953526828992427}-{'f1_val': 0.9937333839017813, 'auprc': 0.9988142980764072, 'loss_val': 0.027925686671097835, 'psi': 0.9957657495716317}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.303159 cos_to_last_merge=0.9522 (last merge round=14)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9991501112248338, 'loss_val': 0.0463093997863304, 'psi': 0.9923719845481412}-{'f1_val': 0.990399656971262, 'auprc': 0.9991605102675499, 'loss_val': 0.034185178290624826, 'psi': 0.9939039982897772}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.026442 cos_to_last_merge=0.9215 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948330936177445, 'loss_val': 0.02449268345597964, 'psi': 0.9950459408587227}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951393375954025, 'loss_val': 0.02420425566541424, 'psi': 0.9951684384497859}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=1.864479 cos_to_last_merge=0.8728 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=88 local utility u=0.000499 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983364684646506, 'loss_val': 0.02028000294046309, 'psi': 0.997262790094014}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981883404792442, 'loss_val': 0.020833216105771626, 'psi': 0.9972035388998515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=88 head_norm_before_train=1.559849 cos_to_last_merge=0.8014 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=88 local utility u=0.196636 metrics={'f1_val': 0.6524385718464483, 'auprc': 0.7271040531643583, 'loss_val': 1.0934834531553739, 'psi': 0.6823047643736123}-{'f1_val': 0.6107780631219121, 'auprc': 0.6991096129245474, 'loss_val': 1.1528097013689356, 'psi': 0.6461106830429661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=88 head_norm_before_train=2.253273 cos_to_last_merge=0.9324 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9803840527490955, 'auprc': 0.9987833573309097, 'loss_val': 0.04143984634997364, 'psi': 0.9877437745818212}-{'f1_val': 0.9808200281494859, 'auprc': 0.998767287461052, 'loss_val': 0.03986787090520756, 'psi': 0.9879989318741124}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.000893 cos_to_last_merge=0.8846 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.8402919221674853, 'auprc': 0.981430161111201, 'loss_val': 0.34047888939484405, 'psi': 0.8967472177449716}-{'f1_val': 0.943524817751692, 'auprc': 0.9921070733081574, 'loss_val': 0.09602108290682532, 'psi': 0.9629577199742781}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=2.223206 (no previous merge yet)
[S16] round=88 local utility u=0.425323 metrics={'f1_val': 0.8934097072655929, 'auprc': 0.9876357042442743, 'loss_val': 0.6655138827856922, 'psi': 0.9311001060570654}-{'f1_val': 0.864735388525219, 'auprc': 0.9093590380552102, 'loss_val': 1.1092838652860026, 'psi': 0.8825848483372155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=88 head_norm_before_train=1.907191 cos_to_last_merge=0.8800 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=88 local utility u=1.000000 metrics={'f1_val': 0.9909236491772223, 'auprc': 0.9859647515441672, 'loss_val': 0.11526030214919296, 'psi': 0.9889400901240002}-{'f1_val': 0.7180585294556441, 'auprc': 0.8816423826733473, 'loss_val': 0.8313046053105391, 'psi': 0.7834920707427253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=89 head_norm_before_train=2.174575 cos_to_last_merge=0.9512 (last merge round=12)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.6635691057080905, 'auprc': 0.725102864899721, 'loss_val': 1.3288759267961756, 'psi': 0.6881826093847427}-{'f1_val': 0.7211908406827098, 'auprc': 0.7313873874533636, 'loss_val': 1.0008793077643683, 'psi': 0.7252694593909713}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.157215 cos_to_last_merge=0.7567 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.757
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9995045926385159, 'loss_val': 0.1332148124015788, 'psi': 0.9764229877186725}-{'f1_val': 0.9610352511054436, 'auprc': 0.9994917677092364, 'loss_val': 0.12251492602737425, 'psi': 0.9764178577469607}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.747073 cos_to_last_merge=0.9016 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9360118011434689, 'auprc': 0.9192006246212425, 'loss_val': 0.3600691964345963, 'psi': 0.9292873305345783}-{'f1_val': 0.9371858690318593, 'auprc': 0.9280040007460517, 'loss_val': 0.3588236225488598, 'psi': 0.9335131217175363}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.756945 cos_to_last_merge=0.8095 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.991297475986495, 'loss_val': 0.026333921945637547, 'psi': 0.9940560905313286}-{'f1_val': 0.995895166894551, 'auprc': 0.9913665035210943, 'loss_val': 0.02551703492535925, 'psi': 0.9940837015451683}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.705943 cos_to_last_merge=0.8415 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.9047832890604633, 'auprc': 0.971168364266555, 'loss_val': 0.2274943645238337, 'psi': 0.9313373191429}-{'f1_val': 0.9642411669424263, 'auprc': 0.9865751000026851, 'loss_val': 0.11339481071475963, 'psi': 0.9731747401665298}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.743335 cos_to_last_merge=0.9124 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=89 local utility u=1.000000 metrics={'f1_val': 0.8741125737686357, 'auprc': 0.9833886217363258, 'loss_val': 0.17572191221320424, 'psi': 0.9178229929557117}-{'f1_val': 0.5908857380035953, 'auprc': 0.7803695942752406, 'loss_val': 0.983240561015301, 'psi': 0.6666792805122534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=89 head_norm_before_train=2.051952 cos_to_last_merge=0.9191 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.919
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9132577266060836, 'auprc': 0.9990370749201787, 'loss_val': 0.1833839656936756, 'psi': 0.9475694659317216}-{'f1_val': 0.993080372776832, 'auprc': 0.9987611480828587, 'loss_val': 0.029847603207428332, 'psi': 0.9953526828992427}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.307040 cos_to_last_merge=0.9519 (last merge round=14)
[S9] round=89 local utility u=0.026558 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.9991379120783079, 'loss_val': 0.023645384140613457, 'psi': 0.9954160461721733}-{'f1_val': 0.9878532334303461, 'auprc': 0.9991501112248338, 'loss_val': 0.0463093997863304, 'psi': 0.9923719845481412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=89 head_norm_before_train=2.029468 cos_to_last_merge=0.9210 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=89 local utility u=0.001048 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995211357106246, 'loss_val': 0.02353224822649566, 'psi': 0.9951972462541232}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948330936177445, 'loss_val': 0.02449268345597964, 'psi': 0.9950459408587227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=89 head_norm_before_train=1.866920 cos_to_last_merge=0.8726 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.873
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985138604185153, 'loss_val': 0.021227688468079948, 'psi': 0.9970857491153917}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983364684646506, 'loss_val': 0.02028000294046309, 'psi': 0.997262790094014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=1.561880 cos_to_last_merge=0.8014 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6195533920001057, 'auprc': 0.7015665044344483, 'loss_val': 1.0162478105566275, 'psi': 0.6523586369738428}-{'f1_val': 0.6524385718464483, 'auprc': 0.7271040531643583, 'loss_val': 1.0934834531553739, 'psi': 0.6823047643736123}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.258047 cos_to_last_merge=0.9321 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.8873509920078335, 'auprc': 0.9985677982046185, 'loss_val': 0.3207856185491768, 'psi': 0.9318377144865475}-{'f1_val': 0.9803840527490955, 'auprc': 0.9987833573309097, 'loss_val': 0.04143984634997364, 'psi': 0.9877437745818212}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.007410 cos_to_last_merge=0.8838 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.7400713782281437, 'auprc': 0.8528955378727707, 'loss_val': 0.6867222745763775, 'psi': 0.7852010420859945}-{'f1_val': 0.8402919221674853, 'auprc': 0.981430161111201, 'loss_val': 0.34047888939484405, 'psi': 0.8967472177449716}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=2.229186 (no previous merge yet)
[S16] round=89 local utility u=0.430793 metrics={'f1_val': 0.9532102692766178, 'auprc': 0.9850278977558702, 'loss_val': 0.15490729945029647, 'psi': 0.9659373206683187}-{'f1_val': 0.8934097072655929, 'auprc': 0.9876357042442743, 'loss_val': 0.6655138827856922, 'psi': 0.9311001060570654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=89 head_norm_before_train=1.915418 cos_to_last_merge=0.8796 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.9661005504680514, 'auprc': 0.9849370191179503, 'loss_val': 0.15139696033473934, 'psi': 0.973635137928011}-{'f1_val': 0.9909236491772223, 'auprc': 0.9859647515441672, 'loss_val': 0.11526030214919296, 'psi': 0.9889400901240002}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.176660 cos_to_last_merge=0.9512 (last merge round=12)
[S2] round=90 local utility u=0.476914 metrics={'f1_val': 0.719641584369729, 'auprc': 0.7734815793343761, 'loss_val': 0.8566179753126757, 'psi': 0.741177582355588}-{'f1_val': 0.6635691057080905, 'auprc': 0.725102864899721, 'loss_val': 1.3288759267961756, 'psi': 0.6881826093847427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=90 head_norm_before_train=2.160859 cos_to_last_merge=0.7564 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.756
[S3] round=90 local utility u=0.052591 metrics={'f1_val': 0.9706621159647217, 'auprc': 0.9998422209280937, 'loss_val': 0.08680674063985926, 'psi': 0.9823341579500705}-{'f1_val': 0.9610352511054436, 'auprc': 0.9995045926385159, 'loss_val': 0.1332148124015788, 'psi': 0.9764229877186725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=90 head_norm_before_train=1.737082 cos_to_last_merge=0.9015 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=90 local utility u=0.135161 metrics={'f1_val': 0.9460328845661936, 'auprc': 0.9749388880960072, 'loss_val': 0.31708925015665107, 'psi': 0.957595285978119}-{'f1_val': 0.9360118011434689, 'auprc': 0.9192006246212425, 'loss_val': 0.3600691964345963, 'psi': 0.9292873305345783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=90 head_norm_before_train=1.761155 cos_to_last_merge=0.8093 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=90 local utility u=0.000165 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9914523725304089, 'loss_val': 0.027344317099342926, 'psi': 0.9942056155164867}-{'f1_val': 0.995895166894551, 'auprc': 0.991297475986495, 'loss_val': 0.026333921945637547, 'psi': 0.9940560905313286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=90 head_norm_before_train=1.709186 cos_to_last_merge=0.8414 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.6153364770935157, 'auprc': 0.640132688654261, 'loss_val': 1.4161455323452061, 'psi': 0.6252549617178138}-{'f1_val': 0.9047832890604633, 'auprc': 0.971168364266555, 'loss_val': 0.2274943645238337, 'psi': 0.9313373191429}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.748268 cos_to_last_merge=0.9119 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.615169279763937, 'auprc': 0.7917474955437935, 'loss_val': 0.7805557588375318, 'psi': 0.6858005660758797}-{'f1_val': 0.8741125737686357, 'auprc': 0.9833886217363258, 'loss_val': 0.17572191221320424, 'psi': 0.9178229929557117}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.054059 cos_to_last_merge=0.9185 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.919
[S8] round=90 local utility u=0.239829 metrics={'f1_val': 0.9740732627203631, 'auprc': 0.9989808495818251, 'loss_val': 0.06844990295100095, 'psi': 0.9840362974649479}-{'f1_val': 0.9132577266060836, 'auprc': 0.9990370749201787, 'loss_val': 0.1833839656936756, 'psi': 0.9475694659317216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=90 head_norm_before_train=2.311901 cos_to_last_merge=0.9517 (last merge round=14)
[S9] round=90 local utility u=0.010808 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9960427188008438, 'loss_val': 0.017753115270956275, 'psi': 0.9966788350276232}-{'f1_val': 0.9929348022347503, 'auprc': 0.9991379120783079, 'loss_val': 0.023645384140613457, 'psi': 0.9954160461721733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=90 head_norm_before_train=2.034058 cos_to_last_merge=0.9206 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=90 local utility u=0.000448 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956408956995543, 'loss_val': 0.023925662936811035, 'psi': 0.9953690616914466}-{'f1_val': 0.9951878390193748, 'auprc': 0.995211357106246, 'loss_val': 0.02353224822649566, 'psi': 0.9951972462541232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=90 head_norm_before_train=1.869023 cos_to_last_merge=0.8724 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=90 local utility u=0.001446 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9985872715581308, 'loss_val': 0.020005742964043057, 'psi': 0.9972601407687027}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985138604185153, 'loss_val': 0.021227688468079948, 'psi': 0.9970857491153917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=90 head_norm_before_train=1.564862 cos_to_last_merge=0.8010 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=90 local utility u=0.228588 metrics={'f1_val': 0.6277392780729831, 'auprc': 0.7894925603722391, 'loss_val': 0.8719643317583551, 'psi': 0.6924405909926855}-{'f1_val': 0.6195533920001057, 'auprc': 0.7015665044344483, 'loss_val': 1.0162478105566275, 'psi': 0.6523586369738428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=90 head_norm_before_train=2.263336 cos_to_last_merge=0.9320 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=90 local utility u=0.235697 metrics={'f1_val': 0.9357525594995335, 'auprc': 0.9989349801741314, 'loss_val': 0.1409033078541928, 'psi': 0.9610255277693727}-{'f1_val': 0.8873509920078335, 'auprc': 0.9985677982046185, 'loss_val': 0.3207856185491768, 'psi': 0.9318377144865475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=90 head_norm_before_train=2.013749 cos_to_last_merge=0.8829 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=90 local utility u=0.658397 metrics={'f1_val': 0.8312281297346515, 'auprc': 0.9887513203320377, 'loss_val': 0.32443628819156767, 'psi': 0.894237405973606}-{'f1_val': 0.7400713782281437, 'auprc': 0.8528955378727707, 'loss_val': 0.6867222745763775, 'psi': 0.7852010420859945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=90 head_norm_before_train=2.230523 (no previous merge yet)
[S16] round=90 local utility u=0.180391 metrics={'f1_val': 0.9925170826035197, 'auprc': 0.9869159847840541, 'loss_val': 0.03563047363830913, 'psi': 0.9902766434757334}-{'f1_val': 0.9532102692766178, 'auprc': 0.9850278977558702, 'loss_val': 0.15490729945029647, 'psi': 0.9659373206683187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=90 head_norm_before_train=1.923845 cos_to_last_merge=0.8788 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8673816066959767, 'auprc': 0.9561280561854009, 'loss_val': 0.4093373177650511, 'psi': 0.9028801864917464}-{'f1_val': 0.9661005504680514, 'auprc': 0.9849370191179503, 'loss_val': 0.15139696033473934, 'psi': 0.973635137928011}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.180441 cos_to_last_merge=0.9509 (last merge round=12)
[S2] round=91 local utility u=0.152869 metrics={'f1_val': 0.6996052131543391, 'auprc': 0.8440554146662919, 'loss_val': 0.6423827602516426, 'psi': 0.7573852937591202}-{'f1_val': 0.719641584369729, 'auprc': 0.7734815793343761, 'loss_val': 0.8566179753126757, 'psi': 0.741177582355588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=91 head_norm_before_train=2.162534 cos_to_last_merge=0.7560 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.756
[S3] round=91 local utility u=0.061197 metrics={'f1_val': 0.983867992857389, 'auprc': 0.9998264457451401, 'loss_val': 0.04360058346954817, 'psi': 0.9902513740124894}-{'f1_val': 0.9706621159647217, 'auprc': 0.9998422209280937, 'loss_val': 0.08680674063985926, 'psi': 0.9823341579500705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=91 head_norm_before_train=1.716792 cos_to_last_merge=0.9021 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9410731796768259, 'auprc': 0.9684378966273786, 'loss_val': 0.334561010556848, 'psi': 0.9520190664570469}-{'f1_val': 0.9460328845661936, 'auprc': 0.9749388880960072, 'loss_val': 0.31708925015665107, 'psi': 0.957595285978119}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.760121 cos_to_last_merge=0.8091 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9916277607555944, 'loss_val': 0.02728195607270999, 'psi': 0.9940125843269089}-{'f1_val': 0.9960411108405385, 'auprc': 0.9914523725304089, 'loss_val': 0.027344317099342926, 'psi': 0.9942056155164867}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=1.712832 cos_to_last_merge=0.8409 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6131866758187219, 'auprc': 0.6218186698335761, 'loss_val': 1.4639034088073442, 'psi': 0.6166394734246636}-{'f1_val': 0.6153364770935157, 'auprc': 0.640132688654261, 'loss_val': 1.4161455323452061, 'psi': 0.6252549617178138}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.752109 cos_to_last_merge=0.9113 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=91 local utility u=0.549979 metrics={'f1_val': 0.6864221772917437, 'auprc': 0.8529759991535922, 'loss_val': 0.29180026347218496, 'psi': 0.7530437060364832}-{'f1_val': 0.615169279763937, 'auprc': 0.7917474955437935, 'loss_val': 0.7805557588375318, 'psi': 0.6858005660758797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=91 head_norm_before_train=2.057093 cos_to_last_merge=0.9183 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.918
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.987422277706085, 'loss_val': 0.5897041129386491, 'psi': 0.8233791398667027}-{'f1_val': 0.9740732627203631, 'auprc': 0.9989808495818251, 'loss_val': 0.06844990295100095, 'psi': 0.9840362974649479}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.313634 cos_to_last_merge=0.9509 (last merge round=14)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9988272208147719, 'loss_val': 0.022467910952727432, 'psi': 0.9962950780955302}-{'f1_val': 0.9971029125121428, 'auprc': 0.9960427188008438, 'loss_val': 0.017753115270956275, 'psi': 0.9966788350276232}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.039352 cos_to_last_merge=0.9203 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952438680970405, 'loss_val': 0.023950347921416846, 'psi': 0.995210250650441}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956408956995543, 'loss_val': 0.023925662936811035, 'psi': 0.9953690616914466}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=1.871763 cos_to_last_merge=0.8722 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985897319563337, 'loss_val': 0.020184695754065916, 'psi': 0.9971160977305191}-{'f1_val': 0.9963753869090841, 'auprc': 0.9985872715581308, 'loss_val': 0.020005742964043057, 'psi': 0.9972601407687027}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.570430 cos_to_last_merge=0.8001 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.5946056786652202, 'auprc': 0.6539301283413816, 'loss_val': 1.2351242440642243, 'psi': 0.6183354585356847}-{'f1_val': 0.6277392780729831, 'auprc': 0.7894925603722391, 'loss_val': 0.8719643317583551, 'psi': 0.6924405909926855}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.268138 cos_to_last_merge=0.9318 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=91 local utility u=0.015635 metrics={'f1_val': 0.9373447330971028, 'auprc': 0.9987637554472077, 'loss_val': 0.11867243605714191, 'psi': 0.9619123420371448}-{'f1_val': 0.9357525594995335, 'auprc': 0.9989349801741314, 'loss_val': 0.1409033078541928, 'psi': 0.9610255277693727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=91 head_norm_before_train=2.019450 cos_to_last_merge=0.8817 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=91 local utility u=0.645653 metrics={'f1_val': 0.9954923965309402, 'auprc': 0.9908099921612257, 'loss_val': 0.024892588746204276, 'psi': 0.9936194347830544}-{'f1_val': 0.8312281297346515, 'auprc': 0.9887513203320377, 'loss_val': 0.32443628819156767, 'psi': 0.894237405973606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=91 head_norm_before_train=2.229698 (no previous merge yet)
[S16] round=91 local utility u=0.007713 metrics={'f1_val': 0.9931472303189723, 'auprc': 0.9900506566523466, 'loss_val': 0.03338913739610347, 'psi': 0.9919086008523221}-{'f1_val': 0.9925170826035197, 'auprc': 0.9869159847840541, 'loss_val': 0.03563047363830913, 'psi': 0.9902766434757334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=91 head_norm_before_train=1.931694 cos_to_last_merge=0.8780 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=91 local utility u=0.264689 metrics={'f1_val': 0.9222970347027096, 'auprc': 0.9705543522735913, 'loss_val': 0.2527305849191567, 'psi': 0.9415999617310624}-{'f1_val': 0.8673816066959767, 'auprc': 0.9561280561854009, 'loss_val': 0.4093373177650511, 'psi': 0.9028801864917464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=92 head_norm_before_train=2.183378 cos_to_last_merge=0.9507 (last merge round=12)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6960864795014976, 'auprc': 0.815255815005269, 'loss_val': 0.6778419205915659, 'psi': 0.7437542137030062}-{'f1_val': 0.6996052131543391, 'auprc': 0.8440554146662919, 'loss_val': 0.6423827602516426, 'psi': 0.7573852937591202}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.166136 cos_to_last_merge=0.7556 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.756
[S3] round=92 local utility u=0.035698 metrics={'f1_val': 0.99280549465069, 'auprc': 0.9997800235531811, 'loss_val': 0.025690194486692346, 'psi': 0.9955953062116865}-{'f1_val': 0.983867992857389, 'auprc': 0.9998264457451401, 'loss_val': 0.04360058346954817, 'psi': 0.9902513740124894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=92 head_norm_before_train=1.710626 cos_to_last_merge=0.9011 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=92 local utility u=0.027030 metrics={'f1_val': 0.9489040199918852, 'auprc': 0.966523720376804, 'loss_val': 0.3217429292315413, 'psi': 0.9559519001458527}-{'f1_val': 0.9410731796768259, 'auprc': 0.9684378966273786, 'loss_val': 0.334561010556848, 'psi': 0.9520190664570469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=92 head_norm_before_train=1.761159 cos_to_last_merge=0.8088 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=92 local utility u=0.001724 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9918578557456001, 'loss_val': 0.02715579051194762, 'psi': 0.9943678088025631}-{'f1_val': 0.9956024667077852, 'auprc': 0.9916277607555944, 'loss_val': 0.02728195607270999, 'psi': 0.9940125843269089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=92 head_norm_before_train=1.716924 cos_to_last_merge=0.8402 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=92 local utility u=1.000000 metrics={'f1_val': 0.9698868885522187, 'auprc': 0.9782415733525227, 'loss_val': 0.135059212993042, 'psi': 0.9732287624723404}-{'f1_val': 0.6131866758187219, 'auprc': 0.6218186698335761, 'loss_val': 1.4639034088073442, 'psi': 0.6166394734246636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=92 head_norm_before_train=1.756636 cos_to_last_merge=0.9108 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.911
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.6154047955434943, 'auprc': 0.7946352867983043, 'loss_val': 0.7834020454951838, 'psi': 0.6870969920454183}-{'f1_val': 0.6864221772917437, 'auprc': 0.8529759991535922, 'loss_val': 0.29180026347218496, 'psi': 0.7530437060364832}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.059891 cos_to_last_merge=0.9180 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.918
[S8] round=92 local utility u=1.000000 metrics={'f1_val': 0.9750904081577223, 'auprc': 0.999171206377881, 'loss_val': 0.06367771506154166, 'psi': 0.9847227274457857}-{'f1_val': 0.7140170479737811, 'auprc': 0.987422277706085, 'loss_val': 0.5897041129386491, 'psi': 0.8233791398667027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=92 head_norm_before_train=2.317241 cos_to_last_merge=0.9507 (last merge round=14)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9988297010470321, 'loss_val': 0.03309313307182862, 'psi': 0.9942783685557032}-{'f1_val': 0.9946069829493691, 'auprc': 0.9988272208147719, 'loss_val': 0.022467910952727432, 'psi': 0.9962950780955302}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.044933 cos_to_last_merge=0.9201 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951179790230422, 'loss_val': 0.024024707916766516, 'psi': 0.9951598950208418}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952438680970405, 'loss_val': 0.023950347921416846, 'psi': 0.995210250650441}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=1.874094 cos_to_last_merge=0.8720 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985447688630085, 'loss_val': 0.021355939074679593, 'psi': 0.997098112493189}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985897319563337, 'loss_val': 0.020184695754065916, 'psi': 0.9971160977305191}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.575280 cos_to_last_merge=0.7993 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.799
[S13] round=92 local utility u=0.338490 metrics={'f1_val': 0.6275495415358783, 'auprc': 0.7417288842285729, 'loss_val': 1.0192040041871155, 'psi': 0.6732212786129561}-{'f1_val': 0.5946056786652202, 'auprc': 0.6539301283413816, 'loss_val': 1.2351242440642243, 'psi': 0.6183354585356847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=92 head_norm_before_train=2.273377 cos_to_last_merge=0.9315 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=92 local utility u=0.000780 metrics={'f1_val': 0.937810628583913, 'auprc': 0.9987831860843583, 'loss_val': 0.11996611855791144, 'psi': 0.9621996515840912}-{'f1_val': 0.9373447330971028, 'auprc': 0.9987637554472077, 'loss_val': 0.11867243605714191, 'psi': 0.9619123420371448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=92 head_norm_before_train=2.023890 cos_to_last_merge=0.8812 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9576434514953645, 'auprc': 0.9916318200006099, 'loss_val': 0.07974039208948143, 'psi': 0.9712387988974627}-{'f1_val': 0.9954923965309402, 'auprc': 0.9908099921612257, 'loss_val': 0.024892588746204276, 'psi': 0.9936194347830544}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=2.232713 (no previous merge yet)
[S16] round=92 local utility u=0.002314 metrics={'f1_val': 0.9926581070670989, 'auprc': 0.992557808538227, 'loss_val': 0.033347040551113837, 'psi': 0.9926179876555501}-{'f1_val': 0.9931472303189723, 'auprc': 0.9900506566523466, 'loss_val': 0.03338913739610347, 'psi': 0.9919086008523221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=92 head_norm_before_train=1.939742 cos_to_last_merge=0.8774 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.8159052821852818, 'auprc': 0.940062361528649, 'loss_val': 0.5287490200691097, 'psi': 0.8655681139226287}-{'f1_val': 0.9222970347027096, 'auprc': 0.9705543522735913, 'loss_val': 0.2527305849191567, 'psi': 0.9415999617310624}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.184977 cos_to_last_merge=0.9504 (last merge round=12)
[S2] round=93 local utility u=0.049938 metrics={'f1_val': 0.7161345404252788, 'auprc': 0.8327318898029069, 'loss_val': 0.7506821251451858, 'psi': 0.7627734801763301}-{'f1_val': 0.6960864795014976, 'auprc': 0.815255815005269, 'loss_val': 0.6778419205915659, 'psi': 0.7437542137030062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=93 head_norm_before_train=2.170744 cos_to_last_merge=0.7553 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.755
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.9997829166912144, 'loss_val': 0.0528020974772424, 'psi': 0.9899951804195558}-{'f1_val': 0.99280549465069, 'auprc': 0.9997800235531811, 'loss_val': 0.025690194486692346, 'psi': 0.9955953062116865}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.709633 cos_to_last_merge=0.8999 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9433252797073921, 'auprc': 0.9616191351668766, 'loss_val': 0.3299515427528655, 'psi': 0.950642821891186}-{'f1_val': 0.9489040199918852, 'auprc': 0.966523720376804, 'loss_val': 0.3217429292315413, 'psi': 0.9559519001458527}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=1.761482 cos_to_last_merge=0.8089 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.844319980609634, 'auprc': 0.9905005934041052, 'loss_val': 0.18959909420818125, 'psi': 0.9027922257274225}-{'f1_val': 0.9960411108405385, 'auprc': 0.9918578557456001, 'loss_val': 0.02715579051194762, 'psi': 0.9943678088025631}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.718532 cos_to_last_merge=0.8399 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.9703060190917928, 'auprc': 0.9709270887726208, 'loss_val': 0.14712925746221203, 'psi': 0.9705544469641241}-{'f1_val': 0.9698868885522187, 'auprc': 0.9782415733525227, 'loss_val': 0.135059212993042, 'psi': 0.9732287624723404}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.761159 cos_to_last_merge=0.9104 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=93 local utility u=0.330343 metrics={'f1_val': 0.6699451247210733, 'auprc': 0.8071439340198623, 'loss_val': 0.48748311874202527, 'psi': 0.7248246484405889}-{'f1_val': 0.6154047955434943, 'auprc': 0.7946352867983043, 'loss_val': 0.7834020454951838, 'psi': 0.6870969920454183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=93 head_norm_before_train=2.057336 cos_to_last_merge=0.9178 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.918
[S8] round=93 local utility u=0.048347 metrics={'f1_val': 0.9871202403265862, 'auprc': 0.9989774321794476, 'loss_val': 0.03858071888698905, 'psi': 0.9918631170677307}-{'f1_val': 0.9750904081577223, 'auprc': 0.999171206377881, 'loss_val': 0.06367771506154166, 'psi': 0.9847227274457857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=93 head_norm_before_train=2.321808 cos_to_last_merge=0.9508 (last merge round=14)
[S9] round=93 local utility u=0.021412 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959921041567814, 'loss_val': 0.016908665191547288, 'psi': 0.9966585891699983}-{'f1_val': 0.9912441468948172, 'auprc': 0.9988297010470321, 'loss_val': 0.03309313307182862, 'psi': 0.9942783685557032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=93 head_norm_before_train=2.050617 cos_to_last_merge=0.9200 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=93 local utility u=0.000199 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995283265957173, 'loss_val': 0.024123317132498122, 'psi': 0.995226009794494}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951179790230422, 'loss_val': 0.024024707916766516, 'psi': 0.9951598950208418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=93 head_norm_before_train=1.877593 cos_to_last_merge=0.8717 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.872
[S11] round=93 local utility u=0.002635 metrics={'f1_val': 0.9966169742661891, 'auprc': 0.9985487014007135, 'loss_val': 0.01899847249271509, 'psi': 0.9973896651199988}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985447688630085, 'loss_val': 0.021355939074679593, 'psi': 0.997098112493189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=93 head_norm_before_train=1.578643 cos_to_last_merge=0.7987 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.799
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.5858934983574939, 'auprc': 0.6735144650546595, 'loss_val': 1.206219930398575, 'psi': 0.6209418850363602}-{'f1_val': 0.6275495415358783, 'auprc': 0.7417288842285729, 'loss_val': 1.0192040041871155, 'psi': 0.6732212786129561}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.276582 cos_to_last_merge=0.9314 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.8864696830268899, 'auprc': 0.9985617977252972, 'loss_val': 0.38751189161374194, 'psi': 0.9313065289062528}-{'f1_val': 0.937810628583913, 'auprc': 0.9987831860843583, 'loss_val': 0.11996611855791144, 'psi': 0.9621996515840912}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.026586 cos_to_last_merge=0.8812 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.7564610854379683, 'auprc': 0.8527957780138347, 'loss_val': 0.7206227876085991, 'psi': 0.7949949624683148}-{'f1_val': 0.9576434514953645, 'auprc': 0.9916318200006099, 'loss_val': 0.07974039208948143, 'psi': 0.9712387988974627}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.237625 (no previous merge yet)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9931208284796057, 'auprc': 0.9919435554772897, 'loss_val': 0.03577403380767234, 'psi': 0.9926499192786793}-{'f1_val': 0.9926581070670989, 'auprc': 0.992557808538227, 'loss_val': 0.033347040551113837, 'psi': 0.9926179876555501}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=1.945956 cos_to_last_merge=0.8771 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=93 local utility u=0.793603 metrics={'f1_val': 0.9895483048901561, 'auprc': 0.9861763150831581, 'loss_val': 0.1217426985527509, 'psi': 0.9881995089673569}-{'f1_val': 0.8159052821852818, 'auprc': 0.940062361528649, 'loss_val': 0.5287490200691097, 'psi': 0.8655681139226287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=94 head_norm_before_train=2.187389 cos_to_last_merge=0.9503 (last merge round=12)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7213717182872186, 'auprc': 0.7628084329682983, 'loss_val': 0.960572202321983, 'psi': 0.7379464041596504}-{'f1_val': 0.7161345404252788, 'auprc': 0.8327318898029069, 'loss_val': 0.7506821251451858, 'psi': 0.7627734801763301}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.175432 cos_to_last_merge=0.7551 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.755
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.9801415747093349, 'auprc': 0.9997531481444203, 'loss_val': 0.06423672839004715, 'psi': 0.9879862040833691}-{'f1_val': 0.9834700229051168, 'auprc': 0.9997829166912144, 'loss_val': 0.0528020974772424, 'psi': 0.9899951804195558}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.716310 cos_to_last_merge=0.8991 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9406502518870307, 'auprc': 0.9347816254377997, 'loss_val': 0.3393622639433616, 'psi': 0.9383028013073382}-{'f1_val': 0.9433252797073921, 'auprc': 0.9616191351668766, 'loss_val': 0.3299515427528655, 'psi': 0.950642821891186}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.763495 cos_to_last_merge=0.8088 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=94 local utility u=0.538631 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9918719443528127, 'loss_val': 0.02677867215151941, 'psi': 0.9943734442454482}-{'f1_val': 0.844319980609634, 'auprc': 0.9905005934041052, 'loss_val': 0.18959909420818125, 'psi': 0.9027922257274225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=94 head_norm_before_train=1.720912 cos_to_last_merge=0.8394 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.7328800605004996, 'auprc': 0.7654732331387863, 'loss_val': 0.8371361947316434, 'psi': 0.7459173295558144}-{'f1_val': 0.9703060190917928, 'auprc': 0.9709270887726208, 'loss_val': 0.14712925746221203, 'psi': 0.9705544469641241}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.765583 cos_to_last_merge=0.9102 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6384846389797096, 'auprc': 0.7963324990198299, 'loss_val': 0.6936311650382394, 'psi': 0.7016237829957578}-{'f1_val': 0.6699451247210733, 'auprc': 0.8071439340198623, 'loss_val': 0.48748311874202527, 'psi': 0.7248246484405889}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.059847 cos_to_last_merge=0.9174 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.917
[S8] round=94 local utility u=0.028406 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9992258171696766, 'loss_val': 0.02512813782028757, 'psi': 0.9962239090390931}-{'f1_val': 0.9871202403265862, 'auprc': 0.9989774321794476, 'loss_val': 0.03858071888698905, 'psi': 0.9918631170677307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=94 head_norm_before_train=2.327059 cos_to_last_merge=0.9511 (last merge round=14)
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9943371043400915, 'loss_val': 0.01606174282629339, 'psi': 0.9959965892433222}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959921041567814, 'loss_val': 0.016908665191547288, 'psi': 0.9966585891699983}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.054255 cos_to_last_merge=0.9195 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=94 local utility u=0.001464 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961534634622798, 'loss_val': 0.023806563500911634, 'psi': 0.9955740887965367}-{'f1_val': 0.9951878390193748, 'auprc': 0.995283265957173, 'loss_val': 0.024123317132498122, 'psi': 0.995226009794494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=94 head_norm_before_train=1.881390 cos_to_last_merge=0.8714 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.871
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.7993979156698651, 'auprc': 0.9951314405643084, 'loss_val': 0.4013819937403667, 'psi': 0.8776913256276424}-{'f1_val': 0.9966169742661891, 'auprc': 0.9985487014007135, 'loss_val': 0.01899847249271509, 'psi': 0.9973896651199988}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.581373 cos_to_last_merge=0.7984 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=94 local utility u=0.820672 metrics={'f1_val': 0.7448943834032447, 'auprc': 0.7763957495969311, 'loss_val': 0.8275247469758499, 'psi': 0.7574949298807192}-{'f1_val': 0.5858934983574939, 'auprc': 0.6735144650546595, 'loss_val': 1.206219930398575, 'psi': 0.6209418850363602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=94 head_norm_before_train=2.279319 cos_to_last_merge=0.9313 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.8837554374431904, 'auprc': 0.9989139772766237, 'loss_val': 0.48376087879385476, 'psi': 0.9298188533765637}-{'f1_val': 0.8864696830268899, 'auprc': 0.9985617977252972, 'loss_val': 0.38751189161374194, 'psi': 0.9313065289062528}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.030393 cos_to_last_merge=0.8811 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=94 local utility u=1.000000 metrics={'f1_val': 0.9556448196092224, 'auprc': 0.995274496838323, 'loss_val': 0.1364712397089885, 'psi': 0.9714966905008627}-{'f1_val': 0.7564610854379683, 'auprc': 0.8527957780138347, 'loss_val': 0.7206227876085991, 'psi': 0.7949949624683148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=94 head_norm_before_train=2.241003 (no previous merge yet)
[S16] round=94 local utility u=0.001290 metrics={'f1_val': 0.9931208284796057, 'auprc': 0.9922838625660955, 'loss_val': 0.03421414285057711, 'psi': 0.9927860421142016}-{'f1_val': 0.9931208284796057, 'auprc': 0.9919435554772897, 'loss_val': 0.03577403380767234, 'psi': 0.9926499192786793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=94 head_norm_before_train=1.951832 cos_to_last_merge=0.8768 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.9756035556764137, 'auprc': 0.9860572203276107, 'loss_val': 0.13679914980322985, 'psi': 0.9797850215368925}-{'f1_val': 0.9895483048901561, 'auprc': 0.9861763150831581, 'loss_val': 0.1217426985527509, 'psi': 0.9881995089673569}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.189866 cos_to_last_merge=0.9502 (last merge round=12)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7213717182872186, 'auprc': 0.7629413633679989, 'loss_val': 0.9648860103911484, 'psi': 0.7379995763195307}-{'f1_val': 0.7213717182872186, 'auprc': 0.7628084329682983, 'loss_val': 0.960572202321983, 'psi': 0.7379464041596504}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.180343 cos_to_last_merge=0.7548 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.755
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.8580644580381729, 'auprc': 0.9824573429871198, 'loss_val': 0.2724320662885608, 'psi': 0.9078216120177516}-{'f1_val': 0.9801415747093349, 'auprc': 0.9997531481444203, 'loss_val': 0.06423672839004715, 'psi': 0.9879862040833691}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=1.722427 cos_to_last_merge=0.8984 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.938084954486246, 'auprc': 0.9227987215121072, 'loss_val': 0.37547330349429237, 'psi': 0.9319704612965904}-{'f1_val': 0.9406502518870307, 'auprc': 0.9347816254377997, 'loss_val': 0.3393622639433616, 'psi': 0.9383028013073382}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.768648 cos_to_last_merge=0.8085 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9910540515041767, 'loss_val': 0.02594587926336827, 'psi': 0.9937831006263418}-{'f1_val': 0.9960411108405385, 'auprc': 0.9918719443528127, 'loss_val': 0.02677867215151941, 'psi': 0.9943734442454482}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.723892 cos_to_last_merge=0.8387 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6079781668932787, 'auprc': 0.7292511509326933, 'loss_val': 1.0660489294967763, 'psi': 0.6564873605090445}-{'f1_val': 0.7328800605004996, 'auprc': 0.7654732331387863, 'loss_val': 0.8371361947316434, 'psi': 0.7459173295558144}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.769059 cos_to_last_merge=0.9100 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=95 local utility u=0.895659 metrics={'f1_val': 0.7942128850809966, 'auprc': 0.9225803215507652, 'loss_val': 0.21542547767383935, 'psi': 0.845559859668904}-{'f1_val': 0.6384846389797096, 'auprc': 0.7963324990198299, 'loss_val': 0.6936311650382394, 'psi': 0.7016237829957578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=95 head_norm_before_train=2.063613 cos_to_last_merge=0.9169 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.917
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9858485457048224, 'auprc': 0.998934554785857, 'loss_val': 0.045044030116136176, 'psi': 0.9910829493372362}-{'f1_val': 0.9942226369520374, 'auprc': 0.9992258171696766, 'loss_val': 0.02512813782028757, 'psi': 0.9962239090390931}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.332253 cos_to_last_merge=0.9514 (last merge round=14)
[S9] round=95 local utility u=0.008260 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991585743462872, 'loss_val': 0.014006730859173063, 'psi': 0.9979251772458005}-{'f1_val': 0.9971029125121428, 'auprc': 0.9943371043400915, 'loss_val': 0.01606174282629339, 'psi': 0.9959965892433222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=95 head_norm_before_train=2.055825 cos_to_last_merge=0.9189 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957939619538821, 'loss_val': 0.023758938506311045, 'psi': 0.9954302881931777}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961534634622798, 'loss_val': 0.023806563500911634, 'psi': 0.9955740887965367}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=1.884410 cos_to_last_merge=0.8710 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.871
[S11] round=95 local utility u=0.786706 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983798403537472, 'loss_val': 0.020610075640860415, 'psi': 0.9972801388496526}-{'f1_val': 0.7993979156698651, 'auprc': 0.9951314405643084, 'loss_val': 0.4013819937403667, 'psi': 0.8776913256276424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=95 head_norm_before_train=1.583708 cos_to_last_merge=0.7982 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.7401667132422312, 'auprc': 0.7533787399699362, 'loss_val': 0.8523405854351835, 'psi': 0.7454515239333133}-{'f1_val': 0.7448943834032447, 'auprc': 0.7763957495969311, 'loss_val': 0.8275247469758499, 'psi': 0.7574949298807192}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.284099 cos_to_last_merge=0.9310 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=95 local utility u=0.568773 metrics={'f1_val': 0.9971687801929319, 'auprc': 0.9988785161613055, 'loss_val': 0.026588101132178583, 'psi': 0.9978526745802814}-{'f1_val': 0.8837554374431904, 'auprc': 0.9989139772766237, 'loss_val': 0.48376087879385476, 'psi': 0.9298188533765637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=95 head_norm_before_train=2.034002 cos_to_last_merge=0.8809 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.7016150749205642, 'auprc': 0.8663839069516234, 'loss_val': 0.7505909755925871, 'psi': 0.7675226077329879}-{'f1_val': 0.9556448196092224, 'auprc': 0.995274496838323, 'loss_val': 0.1364712397089885, 'psi': 0.9714966905008627}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.242917 (no previous merge yet)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.992681076194946, 'auprc': 0.9921341929807221, 'loss_val': 0.031904893683528994, 'psi': 0.9924623229092564}-{'f1_val': 0.9931208284796057, 'auprc': 0.9922838625660955, 'loss_val': 0.03421414285057711, 'psi': 0.9927860421142016}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=1.959085 cos_to_last_merge=0.8761 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.876
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8770552336674536, 'auprc': 0.9607949553487183, 'loss_val': 0.40868361776560413, 'psi': 0.9105511223399595}-{'f1_val': 0.9756035556764137, 'auprc': 0.9860572203276107, 'loss_val': 0.13679914980322985, 'psi': 0.9797850215368925}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.194494 cos_to_last_merge=0.9499 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.950
[S2] round=96 local utility u=0.039769 metrics={'f1_val': 0.7213717182872186, 'auprc': 0.7760593550867524, 'loss_val': 0.9247027195284827, 'psi': 0.7432467730070321}-{'f1_val': 0.7213717182872186, 'auprc': 0.7629413633679989, 'loss_val': 0.9648860103911484, 'psi': 0.7379995763195307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=96 head_norm_before_train=2.183808 cos_to_last_merge=0.7545 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.754
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.8543903227270372, 'auprc': 0.9924736345849365, 'loss_val': 0.3102919392272786, 'psi': 0.909623647470197}-{'f1_val': 0.8580644580381729, 'auprc': 0.9824573429871198, 'loss_val': 0.2724320662885608, 'psi': 0.9078216120177516}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.729242 cos_to_last_merge=0.8979 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=96 local utility u=0.035632 metrics={'f1_val': 0.940221545542358, 'auprc': 0.9311698046314729, 'loss_val': 0.3421414295715493, 'psi': 0.936600849178004}-{'f1_val': 0.938084954486246, 'auprc': 0.9227987215121072, 'loss_val': 0.37547330349429237, 'psi': 0.9319704612965904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=96 head_norm_before_train=1.775660 cos_to_last_merge=0.8081 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9893564770624999, 'loss_val': 0.03317900537840878, 'psi': 0.9932796909617305}-{'f1_val': 0.9956024667077852, 'auprc': 0.9910540515041767, 'loss_val': 0.02594587926336827, 'psi': 0.9937831006263418}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.725839 cos_to_last_merge=0.8381 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=96 local utility u=1.000000 metrics={'f1_val': 0.9642739521463478, 'auprc': 0.979592131337961, 'loss_val': 0.12594040763126174, 'psi': 0.9704012238229931}-{'f1_val': 0.6079781668932787, 'auprc': 0.7292511509326933, 'loss_val': 1.0660489294967763, 'psi': 0.6564873605090445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=96 head_norm_before_train=1.771791 cos_to_last_merge=0.9095 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.910
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5967942401391647, 'auprc': 0.7961483081842232, 'loss_val': 0.794439912072553, 'psi': 0.6765358673571882}-{'f1_val': 0.7942128850809966, 'auprc': 0.9225803215507652, 'loss_val': 0.21542547767383935, 'psi': 0.845559859668904}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.068631 cos_to_last_merge=0.9163 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.916
[S8] round=96 local utility u=0.019769 metrics={'f1_val': 0.9904910816630761, 'auprc': 0.9988886031031787, 'loss_val': 0.03322320996184045, 'psi': 0.9938500902391172}-{'f1_val': 0.9858485457048224, 'auprc': 0.998934554785857, 'loss_val': 0.045044030116136176, 'psi': 0.9910829493372362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=96 head_norm_before_train=2.337071 cos_to_last_merge=0.9515 (last merge round=14)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9991221520826535, 'loss_val': 0.01717704227653004, 'psi': 0.9969128687623567}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991585743462872, 'loss_val': 0.014006730859173063, 'psi': 0.9979251772458005}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.054974 cos_to_last_merge=0.9179 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=96 local utility u=0.000010 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957866254144586, 'loss_val': 0.023716786012257875, 'psi': 0.9954273535774083}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957939619538821, 'loss_val': 0.023758938506311045, 'psi': 0.9954302881931777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=96 head_norm_before_train=1.889174 cos_to_last_merge=0.8706 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.871
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981263376630403, 'loss_val': 0.020447095375070893, 'psi': 0.9971787377733698}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983798403537472, 'loss_val': 0.020610075640860415, 'psi': 0.9972801388496526}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.590949 cos_to_last_merge=0.7975 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.797
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.7096438149819883, 'auprc': 0.7226119868379336, 'loss_val': 0.9827559165238929, 'psi': 0.7148310837243664}-{'f1_val': 0.7401667132422312, 'auprc': 0.7533787399699362, 'loss_val': 0.8523405854351835, 'psi': 0.7454515239333133}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.289450 cos_to_last_merge=0.9305 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971625532153504, 'auprc': 0.9970833363213809, 'loss_val': 0.025137181958826547, 'psi': 0.9971308664577626}-{'f1_val': 0.9971687801929319, 'auprc': 0.9988785161613055, 'loss_val': 0.026588101132178583, 'psi': 0.9978526745802814}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.031740 cos_to_last_merge=0.8807 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=96 local utility u=0.208788 metrics={'f1_val': 0.7593167842511646, 'auprc': 0.8620568272552334, 'loss_val': 0.6662436994735574, 'psi': 0.800412801452792}-{'f1_val': 0.7016150749205642, 'auprc': 0.8663839069516234, 'loss_val': 0.7505909755925871, 'psi': 0.7675226077329879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=96 head_norm_before_train=2.246958 (no previous merge yet)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.950954026162729, 'auprc': 0.9917228610983211, 'loss_val': 0.11961847915148742, 'psi': 0.9672615601369658}-{'f1_val': 0.992681076194946, 'auprc': 0.9921341929807221, 'loss_val': 0.031904893683528994, 'psi': 0.9924623229092564}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=1.965792 cos_to_last_merge=0.8753 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=96 local utility u=0.550926 metrics={'f1_val': 0.994086644479523, 'auprc': 0.9869224418573509, 'loss_val': 0.08740191041310401, 'psi': 0.9912209634306541}-{'f1_val': 0.8770552336674536, 'auprc': 0.9607949553487183, 'loss_val': 0.40868361776560413, 'psi': 0.9105511223399595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=97 head_norm_before_train=2.199270 cos_to_last_merge=0.9495 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=97 local utility u=0.119691 metrics={'f1_val': 0.711471211968161, 'auprc': 0.8041407090341638, 'loss_val': 0.7101619864368732, 'psi': 0.7485390107945622}-{'f1_val': 0.7213717182872186, 'auprc': 0.7760593550867524, 'loss_val': 0.9247027195284827, 'psi': 0.7432467730070321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=97 head_norm_before_train=2.188907 cos_to_last_merge=0.7542 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.754
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.8221244751308042, 'auprc': 0.9958941500741759, 'loss_val': 0.35495907235000856, 'psi': 0.8916323451081529}-{'f1_val': 0.8543903227270372, 'auprc': 0.9924736345849365, 'loss_val': 0.3102919392272786, 'psi': 0.909623647470197}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.738257 cos_to_last_merge=0.8972 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9397351894989564, 'auprc': 0.9253304307943877, 'loss_val': 0.34305799642167445, 'psi': 0.9339732860171289}-{'f1_val': 0.940221545542358, 'auprc': 0.9311698046314729, 'loss_val': 0.3421414295715493, 'psi': 0.936600849178004}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.784538 cos_to_last_merge=0.8077 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.977514010409951, 'auprc': 0.9884694661127507, 'loss_val': 0.05603458610569986, 'psi': 0.9818961926910709}-{'f1_val': 0.995895166894551, 'auprc': 0.9893564770624999, 'loss_val': 0.03317900537840878, 'psi': 0.9932796909617305}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=1.728694 cos_to_last_merge=0.8383 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=97 local utility u=0.083562 metrics={'f1_val': 0.9862638656434007, 'auprc': 0.9840270974166188, 'loss_val': 0.1040600611329086, 'psi': 0.9853691583526879}-{'f1_val': 0.9642739521463478, 'auprc': 0.979592131337961, 'loss_val': 0.12594040763126174, 'psi': 0.9704012238229931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=97 head_norm_before_train=1.773867 cos_to_last_merge=0.9090 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=97 local utility u=1.000000 metrics={'f1_val': 0.9615082553508976, 'auprc': 0.9814786815513614, 'loss_val': 0.18992550436003894, 'psi': 0.9694964258310831}-{'f1_val': 0.5967942401391647, 'auprc': 0.7961483081842232, 'loss_val': 0.794439912072553, 'psi': 0.6765358673571882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=97 head_norm_before_train=2.075638 cos_to_last_merge=0.9157 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.916
[S8] round=97 local utility u=0.012676 metrics={'f1_val': 0.9934888194563342, 'auprc': 0.9990884112113301, 'loss_val': 0.026456395401391778, 'psi': 0.9957286561583325}-{'f1_val': 0.9904910816630761, 'auprc': 0.9988886031031787, 'loss_val': 0.03322320996184045, 'psi': 0.9938500902391172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=97 head_norm_before_train=2.341877 cos_to_last_merge=0.9515 (last merge round=14)
[S9] round=97 local utility u=0.000468 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959624705177927, 'loss_val': 0.01673846818339111, 'psi': 0.9966467357144028}-{'f1_val': 0.9954400132154921, 'auprc': 0.9991221520826535, 'loss_val': 0.01717704227653004, 'psi': 0.9969128687623567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=97 head_norm_before_train=2.056652 cos_to_last_merge=0.9173 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=97 local utility u=0.000322 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959285330190357, 'loss_val': 0.023499385431899934, 'psi': 0.9954841166192392}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957866254144586, 'loss_val': 0.023716786012257875, 'psi': 0.9954273535774083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=97 head_norm_before_train=1.893659 cos_to_last_merge=0.8703 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=97 local utility u=0.000299 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982134633802683, 'loss_val': 0.020110590683852292, 'psi': 0.9972135880602611}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981263376630403, 'loss_val': 0.020447095375070893, 'psi': 0.9971787377733698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=97 head_norm_before_train=1.598845 cos_to_last_merge=0.7965 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6191366511812654, 'auprc': 0.6756603125254286, 'loss_val': 1.1167942826247381, 'psi': 0.6417461157189306}-{'f1_val': 0.7096438149819883, 'auprc': 0.7226119868379336, 'loss_val': 0.9827559165238929, 'psi': 0.7148310837243664}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.291813 cos_to_last_merge=0.9300 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9398198802575692, 'auprc': 0.9987735626250082, 'loss_val': 0.10459796778969256, 'psi': 0.9634013532045448}-{'f1_val': 0.9971625532153504, 'auprc': 0.9970833363213809, 'loss_val': 0.025137181958826547, 'psi': 0.9971308664577626}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.032415 cos_to_last_merge=0.8804 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=97 local utility u=1.000000 metrics={'f1_val': 0.9901713295561531, 'auprc': 0.9968262363960203, 'loss_val': 0.045250532297030105, 'psi': 0.9928332922920999}-{'f1_val': 0.7593167842511646, 'auprc': 0.8620568272552334, 'loss_val': 0.6662436994735574, 'psi': 0.800412801452792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=97 head_norm_before_train=2.249847 (no previous merge yet)
[S16] round=97 local utility u=0.166941 metrics={'f1_val': 0.9925049475020343, 'auprc': 0.9924345345507526, 'loss_val': 0.03717624206599412, 'psi': 0.9924767823215216}-{'f1_val': 0.950954026162729, 'auprc': 0.9917228610983211, 'loss_val': 0.11961847915148742, 'psi': 0.9672615601369658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=97 head_norm_before_train=1.972575 cos_to_last_merge=0.8746 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.9931340743296964, 'auprc': 0.9861051061183012, 'loss_val': 0.1326960096832305, 'psi': 0.9903224870451383}-{'f1_val': 0.994086644479523, 'auprc': 0.9869224418573509, 'loss_val': 0.08740191041310401, 'psi': 0.9912209634306541}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=98 head_norm_before_train=2.204384 cos_to_last_merge=0.9490 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=98 local utility u=0.054650 metrics={'f1_val': 0.7147362317529575, 'auprc': 0.843840354730915, 'loss_val': 0.7395516810011188, 'psi': 0.7663778809441406}-{'f1_val': 0.711471211968161, 'auprc': 0.8041407090341638, 'loss_val': 0.7101619864368732, 'psi': 0.7485390107945622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=98 head_norm_before_train=2.195049 cos_to_last_merge=0.7540 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.754
[S3] round=98 local utility u=0.130131 metrics={'f1_val': 0.855748074801166, 'auprc': 0.9978192532279879, 'loss_val': 0.3022147410970725, 'psi': 0.9125765461718947}-{'f1_val': 0.8221244751308042, 'auprc': 0.9958941500741759, 'loss_val': 0.35495907235000856, 'psi': 0.8916323451081529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=98 head_norm_before_train=1.743236 cos_to_last_merge=0.8967 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=98 local utility u=0.015197 metrics={'f1_val': 0.9404809240909939, 'auprc': 0.9328767621629074, 'loss_val': 0.33977733510834757, 'psi': 0.9374392593197594}-{'f1_val': 0.9397351894989564, 'auprc': 0.9253304307943877, 'loss_val': 0.34305799642167445, 'psi': 0.9339732860171289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=98 head_norm_before_train=1.789893 cos_to_last_merge=0.8074 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=98 local utility u=0.074310 metrics={'f1_val': 0.9956024667077852, 'auprc': 0.9911735532446576, 'loss_val': 0.02405855395426747, 'psi': 0.9938309013225342}-{'f1_val': 0.977514010409951, 'auprc': 0.9884694661127507, 'loss_val': 0.05603458610569986, 'psi': 0.9818961926910709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=98 head_norm_before_train=1.732143 cos_to_last_merge=0.8384 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.775128570848379, 'auprc': 0.9343277416958026, 'loss_val': 0.6730180543228951, 'psi': 0.8388082391873485}-{'f1_val': 0.9862638656434007, 'auprc': 0.9840270974166188, 'loss_val': 0.1040600611329086, 'psi': 0.9853691583526879}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.775581 cos_to_last_merge=0.9092 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6292067913597476, 'auprc': 0.7972774243942143, 'loss_val': 0.675120834341561, 'psi': 0.6964350445735343}-{'f1_val': 0.9615082553508976, 'auprc': 0.9814786815513614, 'loss_val': 0.18992550436003894, 'psi': 0.9694964258310831}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.079812 cos_to_last_merge=0.9154 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9989329432173134, 'loss_val': 0.0313376261980674, 'psi': 0.9951767862724192}-{'f1_val': 0.9934888194563342, 'auprc': 0.9990884112113301, 'loss_val': 0.026456395401391778, 'psi': 0.9957286561583325}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.343300 cos_to_last_merge=0.9510 (last merge round=14)
[S9] round=98 local utility u=0.000377 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963202590228623, 'loss_val': 0.017058207716415075, 'psi': 0.9967898511164306}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959624705177927, 'loss_val': 0.01673846818339111, 'psi': 0.9966467357144028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=98 head_norm_before_train=2.060611 cos_to_last_merge=0.9169 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=98 local utility u=0.000393 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961773917827942, 'loss_val': 0.023459101602416054, 'psi': 0.9955836601247425}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959285330190357, 'loss_val': 0.023499385431899934, 'psi': 0.9954841166192392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=98 head_norm_before_train=1.897484 cos_to_last_merge=0.8700 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980844226909312, 'loss_val': 0.020387114888246148, 'psi': 0.9971619717845263}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982134633802683, 'loss_val': 0.020110590683852292, 'psi': 0.9972135880602611}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=1.610191 cos_to_last_merge=0.7951 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=98 local utility u=0.467454 metrics={'f1_val': 0.6860847730686861, 'auprc': 0.7496243765366986, 'loss_val': 0.8054665867044465, 'psi': 0.7115006144558911}-{'f1_val': 0.6191366511812654, 'auprc': 0.6756603125254286, 'loss_val': 1.1167942826247381, 'psi': 0.6417461157189306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=98 head_norm_before_train=2.295734 cos_to_last_merge=0.9298 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9362941192668763, 'auprc': 0.9985708158832016, 'loss_val': 0.1492679142278417, 'psi': 0.9612047979134064}-{'f1_val': 0.9398198802575692, 'auprc': 0.9987735626250082, 'loss_val': 0.10459796778969256, 'psi': 0.9634013532045448}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.035189 cos_to_last_merge=0.8802 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.7031613197293327, 'auprc': 0.7823029049591491, 'loss_val': 0.7487180138920476, 'psi': 0.7348179538212593}-{'f1_val': 0.9901713295561531, 'auprc': 0.9968262363960203, 'loss_val': 0.045250532297030105, 'psi': 0.9928332922920999}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.254958 (no previous merge yet)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9893955493088065, 'auprc': 0.9881625967753382, 'loss_val': 0.05211300789343666, 'psi': 0.9889023682954191}-{'f1_val': 0.9925049475020343, 'auprc': 0.9924345345507526, 'loss_val': 0.03717624206599412, 'psi': 0.9924767823215216}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=1.979021 cos_to_last_merge=0.8740 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.747364898774929, 'auprc': 0.9061299903748925, 'loss_val': 0.713475051044714, 'psi': 0.8108709354149144}-{'f1_val': 0.9931340743296964, 'auprc': 0.9861051061183012, 'loss_val': 0.1326960096832305, 'psi': 0.9903224870451383}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.208832 cos_to_last_merge=0.9486 (last merge round=12)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7214976033057443, 'auprc': 0.749490348841001, 'loss_val': 1.0546587016246693, 'psi': 0.732694701519847}-{'f1_val': 0.7147362317529575, 'auprc': 0.843840354730915, 'loss_val': 0.7395516810011188, 'psi': 0.7663778809441406}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.733 u=0.0000 p_local=0.0500 f1=0.721 auprc=0.749 bytes=98956
[S3] START round=99 head_norm_before_train=2.201091 cos_to_last_merge=0.7538 (last merge round=2)
[S3] ⚠️ Model drifted since last merge! cos=0.754
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.713841312611212, 'auprc': 0.9090165358196564, 'loss_val': 0.7394116550080622, 'psi': 0.7919114018945898}-{'f1_val': 0.855748074801166, 'auprc': 0.9978192532279879, 'loss_val': 0.3022147410970725, 'psi': 0.9125765461718947}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.792 u=0.0000 p_local=0.0412 f1=0.714 auprc=0.909 bytes=84484
[S4] START round=99 head_norm_before_train=1.747171 cos_to_last_merge=0.8966 (last merge round=16)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=99 local utility u=0.023163 metrics={'f1_val': 0.941765076035751, 'auprc': 0.9442618157196017, 'loss_val': 0.3353122338178009, 'psi': 0.9427637719092913}-{'f1_val': 0.9404809240909939, 'auprc': 0.9328767621629074, 'loss_val': 0.33977733510834757, 'psi': 0.9374392593197594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S4] r=100 psi=0.943 u=0.0232 p_local=0.0167 f1=0.942 auprc=0.944 bytes=104408
[S5] START round=99 head_norm_before_train=1.796170 cos_to_last_merge=0.8070 (last merge round=12)
[S5] ⚠️ Model drifted since last merge! cos=0.807
[S5] round=99 local utility u=0.000016 metrics={'f1_val': 0.995895166894551, 'auprc': 0.991151378823922, 'loss_val': 0.02571672051013774, 'psi': 0.9939976516662994}-{'f1_val': 0.9956024667077852, 'auprc': 0.9911735532446576, 'loss_val': 0.02405855395426747, 'psi': 0.9938309013225342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S5] r=100 psi=0.994 u=0.0000 p_local=0.0476 f1=0.996 auprc=0.991 bytes=98895
[S6] START round=99 head_norm_before_train=1.734485 cos_to_last_merge=0.8381 (last merge round=16)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.742646147179671, 'auprc': 0.8699906112226383, 'loss_val': 0.7657508433360732, 'psi': 0.7935839327968579}-{'f1_val': 0.775128570848379, 'auprc': 0.9343277416958026, 'loss_val': 0.6730180543228951, 'psi': 0.8388082391873485}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.794 u=0.0000 p_local=0.1894 f1=0.743 auprc=0.870 bytes=80946
[S7] START round=99 head_norm_before_train=1.778142 cos_to_last_merge=0.9093 (last merge round=12)
[S7] ⚠️ Model drifted since last merge! cos=0.909
[S7] round=99 local utility u=0.130756 metrics={'f1_val': 0.6426647978366489, 'auprc': 0.8076024893893926, 'loss_val': 0.5253327833803197, 'psi': 0.7086398744577465}-{'f1_val': 0.6292067913597476, 'auprc': 0.7972774243942143, 'loss_val': 0.675120834341561, 'psi': 0.6964350445735343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=100 psi=0.709 u=0.1308 p_local=0.3000 f1=0.643 auprc=0.808 bytes=98947
[S8] START round=99 head_norm_before_train=2.082333 cos_to_last_merge=0.9150 (last merge round=16)
[S8] ⚠️ Model drifted since last merge! cos=0.915
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9590053693559395, 'auprc': 0.9990090345985725, 'loss_val': 0.13708108775302408, 'psi': 0.9750068354529927}-{'f1_val': 0.9926726816424898, 'auprc': 0.9989329432173134, 'loss_val': 0.0313376261980674, 'psi': 0.9951767862724192}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.975 u=0.0000 p_local=0.0576 f1=0.959 auprc=0.999 bytes=104309
[S9] START round=99 head_norm_before_train=2.346542 cos_to_last_merge=0.9509 (last merge round=14)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9988311827921755, 'loss_val': 0.03819740109026258, 'psi': 0.9930098089628504}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963202590228623, 'loss_val': 0.017058207716415075, 'psi': 0.9967898511164306}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.993 u=0.0000 p_local=0.0032 f1=0.989 auprc=0.999 bytes=100580
[S10] START round=99 head_norm_before_train=2.065665 cos_to_last_merge=0.9167 (last merge round=13)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961541508287994, 'loss_val': 0.023540958668502237, 'psi': 0.9955743637431447}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961773917827942, 'loss_val': 0.023459101602416054, 'psi': 0.9955836601247425}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0003 f1=0.995 auprc=0.996 bytes=116703
[S11] START round=99 head_norm_before_train=1.901884 cos_to_last_merge=0.8696 (last merge round=15)
[S11] ⚠️ Model drifted since last merge! cos=0.870
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980137554932458, 'loss_val': 0.021805888287398104, 'psi': 0.9969886026786149}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980844226909312, 'loss_val': 0.020387114888246148, 'psi': 0.9971619717845263}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0648 f1=0.996 auprc=0.998 bytes=120600
[S13] START round=99 head_norm_before_train=1.618309 cos_to_last_merge=0.7941 (last merge round=12)
[S13] ⚠️ Model drifted since last merge! cos=0.794
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.7091044716059397, 'auprc': 0.7015334765701844, 'loss_val': 1.0420905952729358, 'psi': 0.7060760735916376}-{'f1_val': 0.6860847730686861, 'auprc': 0.7496243765366986, 'loss_val': 0.8054665867044465, 'psi': 0.7115006144558911}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.706 u=0.0000 p_local=0.1592 f1=0.709 auprc=0.702 bytes=97212
[S14] START round=99 head_norm_before_train=2.298034 cos_to_last_merge=0.9298 (last merge round=14)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9333742016917772, 'auprc': 0.9985634634838254, 'loss_val': 0.17129856937306692, 'psi': 0.9594499064085964}-{'f1_val': 0.9362941192668763, 'auprc': 0.9985708158832016, 'loss_val': 0.1492679142278417, 'psi': 0.9612047979134064}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.959 u=0.0000 p_local=0.0598 f1=0.933 auprc=0.999 bytes=102501
[S15] START round=99 head_norm_before_train=2.038478 cos_to_last_merge=0.8795 (last merge round=13)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=99 local utility u=0.802488 metrics={'f1_val': 0.8124732410021306, 'auprc': 0.9889171744752793, 'loss_val': 0.4194569022203106, 'psi': 0.88305081439139}-{'f1_val': 0.7031613197293327, 'auprc': 0.7823029049591491, 'loss_val': 0.7487180138920476, 'psi': 0.7348179538212593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=100 psi=0.883 u=0.8025 p_local=0.4374 f1=0.812 auprc=0.989 bytes=104129
[S16] START round=99 head_norm_before_train=2.257515 (no previous merge yet)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9454981748179986, 'auprc': 0.9800019828782588, 'loss_val': 0.310993286763744, 'psi': 0.9592996980421027}-{'f1_val': 0.9893955493088065, 'auprc': 0.9881625967753382, 'loss_val': 0.05211300789343666, 'psi': 0.9889023682954191}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.959 u=0.0000 p_local=0.0516 f1=0.945 auprc=0.980 bytes=102494
[S17] START round=99 head_norm_before_train=1.984606 cos_to_last_merge=0.8737 (last merge round=12)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=99 local utility u=1.000000 metrics={'f1_val': 0.9925390601741784, 'auprc': 0.98732171404094, 'loss_val': 0.06844142225801733, 'psi': 0.990452121720883}-{'f1_val': 0.747364898774929, 'auprc': 0.9061299903748925, 'loss_val': 0.713475051044714, 'psi': 0.8108709354149144}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=100 psi=0.990 u=1.0000 p_local=0.3416 f1=0.993 auprc=0.987 bytes=91882
[runner] rounds complete.
[runner] all agents stopped.
