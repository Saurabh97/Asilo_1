[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39403
[S3] → join 127.0.0.1:39402
[S4] → join 127.0.0.1:39402
[S5] → join 127.0.0.1:39402
[S6] → join 127.0.0.1:39402
[S7] → join 127.0.0.1:39402
[S8] → join 127.0.0.1:39402
[S9] → join 127.0.0.1:39402
[S10] → join 127.0.0.1:39402
[S11] → join 127.0.0.1:39402
[S13] → join 127.0.0.1:39402
[S14] → join 127.0.0.1:39402
[S15] → join 127.0.0.1:39402
[S16] → join 127.0.0.1:39402
[S17] → join 127.0.0.1:39402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.197164 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.121989 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.162895 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.158482 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.121391 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.153059 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.193034 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.127589 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.164663 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.202415 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.142012 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.167230 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.150068 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.146867 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.178644 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S3] + discovered S17
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S15
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S7
[S3] + discovered S11
[S3] + discovered S9
[S3] + discovered S10
[S3] + discovered S6
[S3] + discovered S16
[S4] + discovered S5
[S4] + discovered S15
[S4] + discovered S13
[S4] + discovered S14
[S4] + discovered S8
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S9
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S17
[S4] + discovered S16
[S5] + discovered S3
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S17
[S5] + discovered S16
[S6] + discovered S5
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S7
[S5] + discovered S6
[S5] + discovered S13
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S9
[S5] + discovered S10
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S16
[S6] + discovered S10
[S6] + discovered S17
[S6] + discovered S9
[S6] + discovered S8
[S6] + discovered S11
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S9
[S7] + discovered S17
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S10
[S8] + discovered S2
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S7
[S8] + discovered S3
[S9] + discovered S7
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S15
[S9] + discovered S6
[S8] + discovered S17
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S9
[S8] + discovered S11
[S9] + discovered S3
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S2
[S9] + discovered S8
[S10] + discovered S5
[S10] + discovered S2
[S10] + discovered S7
[S10] + discovered S8
[S9] + discovered S10
[S9] + discovered S13
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S14
[S9] + discovered S16
[S9] + discovered S17
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S6
[S10] + discovered S3
[S11] + discovered S5
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S3
[S11] + discovered S6
[S11] + discovered S9
[S11] + discovered S10
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S15
[S10] + discovered S11
[S10] + discovered S13
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S8
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S2
[S11] + discovered S17
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S16
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S14
[S14] + discovered S9
[S14] + discovered S10
[S14] + discovered S6
[S14] + discovered S3
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S8
[S13] + discovered S15
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S5
[S15] + discovered S6
[S14] + discovered S16
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S8
[S15] + discovered S13
[S15] + discovered S3
[S15] + discovered S2
[S15] + discovered S14
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S7
[S16] + discovered S11
[S15] + discovered S16
[S16] + discovered S6
[S16] + discovered S10
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S2
[S15] + discovered S17
[S16] + discovered S3
[S16] + discovered S15
[S16] + discovered S5
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S16
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S3
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S9
[S17] + discovered S4
[S17] + discovered S8
[S17] + discovered S5
[S17] + discovered S10
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S13] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S8] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S14] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S3] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:39407
[S7] ⇄ pheromone p=1.000 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S11] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S4] ⇄ pheromone p=1.000 → S2@127.0.0.1:39402
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:39410
[S9] ⇄ pheromone p=1.000 → S3@127.0.0.1:39403
[S2] ⇄ pheromone p=1.000 → S10@127.0.0.1:39411
[S10] ⇄ pheromone p=1.000 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39409
[S2] START round=1 head_norm_before_train=1.220682 (no previous merge yet)
[S2] round=1 local utility u=0.041769 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.646396270314219, 'loss_val': 1.2224957508294998, 'psi': 0.34362478815882763}-{'f1_val': 0.1417771333885667, 'auprc': 0.6447429909003286, 'loss_val': 1.3010744755276344, 'psi': 0.3429634763932715}
[S3] START round=1 head_norm_before_train=1.125698 (no previous merge yet)
[S3] round=1 local utility u=0.133974 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7159835994892192, 'loss_val': 1.3279600268587701, 'psi': 0.3702974791641519}-{'f1_val': 0.13984006561410703, 'auprc': 0.6367818263061874, 'loss_val': 1.358301880294231, 'psi': 0.33861676989093914}
[S4] START round=1 head_norm_before_train=1.162170 (no previous merge yet)
[S4] round=1 local utility u=0.277020 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7778182813161801, 'loss_val': 1.2736644209946115, 'psi': 0.39526328986358256}-{'f1_val': 0.14022662889518414, 'auprc': 0.614764270337784, 'loss_val': 1.3385432265267285, 'psi': 0.3300416854722241}
[S5] START round=1 head_norm_before_train=1.164466 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7324605702251141, 'loss_val': 1.315265733053841, 'psi': 0.3783413709471885}-{'f1_val': 0.417265626557039, 'auprc': 0.7692714060660876, 'loss_val': 1.3498662410621758, 'psi': 0.5580679383606585}
[S6] START round=1 head_norm_before_train=1.142389 (no previous merge yet)
[S6] round=1 local utility u=0.024560 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6309018478170196, 'loss_val': 1.2769685355725033, 'psi': 0.33721650835757705}-{'f1_val': 0.14142628205128205, 'auprc': 0.6344897328934377, 'loss_val': 1.336851264651246, 'psi': 0.3386516623881443}
[S7] START round=1 head_norm_before_train=1.153701 (no previous merge yet)
[S7] round=1 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6682670757612292, 'loss_val': 1.3415207163473895, 'psi': 0.3525409239419467}-{'f1_val': 0.37104599950494116, 'auprc': 0.39873632576517815, 'loss_val': 1.3715905037741207, 'psi': 0.38212213000903594}
[S8] START round=1 head_norm_before_train=1.196471 (no previous merge yet)
[S8] round=1 local utility u=0.429233 metrics={'f1_val': 0.24390419659579893, 'auprc': 0.7826979950649093, 'loss_val': 1.2544110372164228, 'psi': 0.45942171598344306}-{'f1_val': 0.19380545797745954, 'auprc': 0.6180077976326882, 'loss_val': 1.3182130666955143, 'psi': 0.363486393839551}
[S9] START round=1 head_norm_before_train=1.136618 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9197829248300777, 'loss_val': 1.2984264983109637, 'psi': 0.4527519442160287}-{'f1_val': 0.4158150203185748, 'auprc': 0.6651342041204416, 'loss_val': 1.3438892615811326, 'psi': 0.5155426938393215}
[S10] START round=1 head_norm_before_train=1.177512 (no previous merge yet)
[S10] round=1 local utility u=0.178428 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6109793725267209, 'loss_val': 1.274840982912164, 'psi': 0.32756473153572274}-{'f1_val': 0.10265544041450778, 'auprc': 0.5827923110075831, 'loss_val': 1.331338408315588, 'psi': 0.2947101886517379}
[S11] START round=1 head_norm_before_train=1.211568 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8369111514399385, 'loss_val': 1.3064814301455978, 'psi': 0.41901267059984176}-{'f1_val': 0.38340817242927705, 'auprc': 0.7154158861553808, 'loss_val': 1.3478545697336597, 'psi': 0.5162112579197186}
[S13] START round=1 head_norm_before_train=1.155720 (no previous merge yet)
[S13] round=1 local utility u=0.224302 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6508721242226191, 'loss_val': 1.269515037574654, 'psi': 0.3445803072352795}-{'f1_val': 0.10392028033289531, 'auprc': 0.6003238827017612, 'loss_val': 1.3476824175707254, 'psi': 0.3024817212804417}
[S14] START round=1 head_norm_before_train=1.171620 (no previous merge yet)
[S14] round=1 local utility u=0.139248 metrics={'f1_val': 0.3078233749463014, 'auprc': 0.8505239204130521, 'loss_val': 1.3328288590127886, 'psi': 0.5249035931330017}-{'f1_val': 0.32475176973703507, 'auprc': 0.7316744647587258, 'loss_val': 1.356347094079562, 'psi': 0.48752084774571136}
[S15] START round=1 head_norm_before_train=1.156730 (no previous merge yet)
[S15] round=1 local utility u=0.587877 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7752338947297901, 'loss_val': 1.2990926997290866, 'psi': 0.39393374870885106}-{'f1_val': 0.103651869669801, 'auprc': 0.4729864427747289, 'loss_val': 1.351614030197662, 'psi': 0.25138569891177215}
[S16] START round=1 head_norm_before_train=1.157059 (no previous merge yet)
[S16] round=1 local utility u=0.133435 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6920188551170491, 'loss_val': 1.3380180092871536, 'psi': 0.3611900121663415}-{'f1_val': 0.1462022794187229, 'auprc': 0.6028370081571253, 'loss_val': 1.3707314709360179, 'psi': 0.32885617091408387}
[S17] START round=1 head_norm_before_train=1.193846 (no previous merge yet)
[S17] round=1 local utility u=0.308439 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7949284244739309, 'loss_val': 1.2967399179675965, 'psi': 0.402540747780003}-{'f1_val': 0.14094896331738438, 'auprc': 0.6064324007404834, 'loss_val': 1.3481290860636579, 'psi': 0.327142338286624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:39404
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39417
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:39416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S3] → sending delta(kind=head bytes=1785) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S3] sending update (kind=head size=1785 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S2
[S16] cosine check vs S2: cos=-0.0238
[S16] DROPPED delta from S2 (cos=-0.0238 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1790) from S4
[S6] cosine check vs S4: cos=-0.0014
[S6] DROPPED delta from S4 (cos=-0.0014 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1785) from S3
[S7] cosine check vs S3: cos=-0.0757
[S7] DROPPED delta from S3 (cos=-0.0757 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=0.1119
[S4] RECEIVED delta(kind=head bytes=1796) from S16
[S4] cosine check vs S16: cos=0.0335
[S15] RECEIVED delta(kind=head bytes=1795) from S8
[S15] cosine check vs S8: cos=-0.0201
[S15] DROPPED delta from S8 (cos=-0.0201 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=-0.0394
[S17] DROPPED delta from S14 (cos=-0.0394 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S10
[S15] cosine check vs S10: cos=-0.0262
[S15] DROPPED delta from S10 (cos=-0.0262 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1795) from S13
[S17] cosine check vs S13: cos=-0.0110
[S17] DROPPED delta from S13 (cos=-0.0110 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S6
[S17] cosine check vs S6: cos=-0.0265
[S17] DROPPED delta from S6 (cos=-0.0265 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:39412
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S17
[S11] cosine check vs S17: cos=-0.0175
[S11] DROPPED delta from S17 (cos=-0.0175 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.163676
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.823203e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.3711 head_norm=0.875349 delta_norm=0.782320
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=1 metric=0.1402 head_norm=1.187667
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.218609e-01
[S4] stored merged vector for next round verification (round=1)
[S4] DEBUG after merge:  round=1 metric=0.1402 head_norm=0.849862 delta_norm=0.821861
[S4] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.270477 (no previous merge yet)
[S2] round=2 local utility u=0.186793 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7395994697015681, 'loss_val': 1.1285193631651356, 'psi': 0.3809060679137673}-{'f1_val': 0.1417771333885667, 'auprc': 0.646396270314219, 'loss_val': 1.2224957508294998, 'psi': 0.34362478815882763}
[S3] START round=2 head_norm_before_train=1.137110 (no previous merge yet)
[S3] round=2 local utility u=0.168682 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8147761312574215, 'loss_val': 1.28697305884272, 'psi': 0.4098144918714328}-{'f1_val': 0.13984006561410703, 'auprc': 0.7159835994892192, 'loss_val': 1.3279600268587701, 'psi': 0.3702974791641519}
[S4] START round=2 head_norm_before_train=0.849862 cos_to_last_merge=1.0000 (last merge round=1)
[S4] round=2 local utility u=0.021065 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7820953482331288, 'loss_val': 1.2443659653122257, 'psi': 0.39697411663036203}-{'f1_val': 0.14022662889518414, 'auprc': 0.7778182813161801, 'loss_val': 1.2736644209946115, 'psi': 0.39526328986358256}
[S5] START round=2 head_norm_before_train=1.180507 (no previous merge yet)
[S5] round=2 local utility u=0.017237 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7316582113164539, 'loss_val': 1.2783853487401686, 'psi': 0.37802042738372443}-{'f1_val': 0.14226190476190476, 'auprc': 0.7324605702251141, 'loss_val': 1.315265733053841, 'psi': 0.3783413709471885}
[S6] START round=2 head_norm_before_train=1.186334 (no previous merge yet)
[S6] round=2 local utility u=0.007087 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6116390672671487, 'loss_val': 1.205006867753788, 'psi': 0.3295113961376287}-{'f1_val': 0.14142628205128205, 'auprc': 0.6309018478170196, 'loss_val': 1.2769685355725033, 'psi': 0.33721650835757705}
[S7] START round=2 head_norm_before_train=0.875349 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.005314 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6715237418179968, 'loss_val': 1.3406631837670147, 'psi': 0.35384359036465374}-{'f1_val': 0.14205682272909165, 'auprc': 0.6682670757612292, 'loss_val': 1.3415207163473895, 'psi': 0.3525409239419467}
[S8] START round=2 head_norm_before_train=1.236466 (no previous merge yet)
[S8] round=2 local utility u=0.564078 metrics={'f1_val': 0.4162799983110498, 'auprc': 0.7710511497194489, 'loss_val': 1.125568555549471, 'psi': 0.5581884588744094}-{'f1_val': 0.24390419659579893, 'auprc': 0.7826979950649093, 'loss_val': 1.2544110372164228, 'psi': 0.45942171598344306}
[S9] START round=2 head_norm_before_train=1.156633 (no previous merge yet)
[S9] round=2 local utility u=0.063965 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9418184682347539, 'loss_val': 1.2366025421237459, 'psi': 0.4615661615778992}-{'f1_val': 0.141397957139996, 'auprc': 0.9197829248300777, 'loss_val': 1.2984264983109637, 'psi': 0.4527519442160287}
[S10] START round=2 head_norm_before_train=1.216320 (no previous merge yet)
[S10] round=2 local utility u=0.152596 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6802543495804895, 'loss_val': 1.177473824858642, 'psi': 0.3552747223572302}-{'f1_val': 0.13862163754172394, 'auprc': 0.6109793725267209, 'loss_val': 1.274840982912164, 'psi': 0.32756473153572274}
[S11] START round=2 head_norm_before_train=1.229476 (no previous merge yet)
[S11] round=2 local utility u=0.103402 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8885662441213943, 'loss_val': 1.2546436876689262, 'psi': 0.43967470767242406}-{'f1_val': 0.14041368337311058, 'auprc': 0.8369111514399385, 'loss_val': 1.3064814301455978, 'psi': 0.41901267059984176}
[S13] START round=2 head_norm_before_train=1.192874 (no previous merge yet)
[S13] round=2 local utility u=0.157075 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7264833551485923, 'loss_val': 1.182199024148653, 'psi': 0.3748247996056688}-{'f1_val': 0.1403857625770531, 'auprc': 0.6508721242226191, 'loss_val': 1.269515037574654, 'psi': 0.3445803072352795}
[S14] START round=2 head_norm_before_train=1.180046 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14449447400736798, 'auprc': 0.8354281980034348, 'loss_val': 1.3038134675228432, 'psi': 0.42086796360579476}-{'f1_val': 0.3078233749463014, 'auprc': 0.8505239204130521, 'loss_val': 1.3328288590127886, 'psi': 0.5249035931330017}
[S15] START round=2 head_norm_before_train=1.184220 (no previous merge yet)
[S15] round=2 local utility u=0.039483 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764283165215916, 'loss_val': 1.2237108162953843, 'psi': 0.3944115174255717}-{'f1_val': 0.13973365136155833, 'auprc': 0.7752338947297901, 'loss_val': 1.2990926997290866, 'psi': 0.39393374870885106}
[S16] START round=2 head_norm_before_train=1.176813 (no previous merge yet)
[S16] round=2 local utility u=0.009872 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6849442474885308, 'loss_val': 1.2970505322119186, 'psi': 0.3583601691149342}-{'f1_val': 0.14063745019920318, 'auprc': 0.6920188551170491, 'loss_val': 1.3380180092871536, 'psi': 0.3611900121663415}
[S17] START round=2 head_norm_before_train=1.229548 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7235203674591402, 'loss_val': 1.225214870121679, 'psi': 0.3739775249740867}-{'f1_val': 0.14094896331738438, 'auprc': 0.7949284244739309, 'loss_val': 1.2967399179675965, 'psi': 0.402540747780003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.355)
[S3] not sending this round → trigger blocked (psi=0.410)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S5] → sending delta(kind=head bytes=1785) to S2@127.0.0.1:39402
[S16] not sending this round → trigger blocked (psi=0.358)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39402
[S6] not sending this round → trigger blocked (psi=0.330)
[S8] not sending this round → trigger blocked (psi=0.558)
[S2] not sending this round → trigger blocked (psi=0.381)
[S4] not sending this round → trigger blocked (psi=0.397)
[S15] not sending this round → trigger blocked (psi=0.394)
[S13] not sending this round → trigger blocked (psi=0.375)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1785 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S9
[S8] cosine check vs S9: cos=0.0115
[S10] RECEIVED delta(kind=head bytes=1793) from S11
[S10] cosine check vs S11: cos=-0.0460
[S10] DROPPED delta from S11 (cos=-0.0460 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S7
[S2] cosine check vs S7: cos=0.0250
[S2] RECEIVED delta(kind=head bytes=1785) from S5
[S2] cosine check vs S5: cos=-0.0489
[S2] DROPPED delta from S5 (cos=-0.0489 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=2 metric=0.1418 head_norm=1.321672
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.874781e-01
[S2] stored merged vector for next round verification (round=2)
[S2] DEBUG after merge:  round=2 metric=0.1418 head_norm=0.805963 delta_norm=0.787478
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.4163 head_norm=1.305336
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.775995e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.4153 head_norm=0.887693 delta_norm=0.877599
[S8] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.805963 cos_to_last_merge=1.0000 (last merge round=2)
[S2] round=3 local utility u=0.808096 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.7119521265781641, 'loss_val': 1.0765547046313604, 'psi': 0.5345640336843331}-{'f1_val': 0.1417771333885667, 'auprc': 0.7395994697015681, 'loss_val': 1.1285193631651356, 'psi': 0.3809060679137673}
[S3] START round=3 head_norm_before_train=1.158589 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7952664514785268, 'loss_val': 1.2407899417177084, 'psi': 0.40201061995987497}-{'f1_val': 0.13984006561410703, 'auprc': 0.8147761312574215, 'loss_val': 1.28697305884272, 'psi': 0.4098144918714328}
[S4] START round=3 head_norm_before_train=0.884202 cos_to_last_merge=0.9945 (last merge round=1)
[S4] round=3 local utility u=0.049644 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.784062492594313, 'loss_val': 1.1509796438626678, 'psi': 0.3977609743748357}-{'f1_val': 0.14022662889518414, 'auprc': 0.7820953482331288, 'loss_val': 1.2443659653122257, 'psi': 0.39697411663036203}
[S5] START round=3 head_norm_before_train=1.205280 (no previous merge yet)
[S5] round=3 local utility u=0.021763 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7315238585259312, 'loss_val': 1.2344558365791303, 'psi': 0.37796668626751534}-{'f1_val': 0.14226190476190476, 'auprc': 0.7316582113164539, 'loss_val': 1.2783853487401686, 'psi': 0.37802042738372443}
[S6] START round=3 head_norm_before_train=1.241766 (no previous merge yet)
[S6] round=3 local utility u=0.695615 metrics={'f1_val': 0.3476358639963393, 'auprc': 0.6138078377390824, 'loss_val': 1.0575397071061985, 'psi': 0.45410465349343654}-{'f1_val': 0.14142628205128205, 'auprc': 0.6116390672671487, 'loss_val': 1.205006867753788, 'psi': 0.3295113961376287}
[S7] START round=3 head_norm_before_train=0.890269 cos_to_last_merge=0.9966 (last merge round=1)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5892624367147342, 'loss_val': 1.3104881268558628, 'psi': 0.3209390683233487}-{'f1_val': 0.14205682272909165, 'auprc': 0.6715237418179968, 'loss_val': 1.3406631837670147, 'psi': 0.35384359036465374}
[S8] START round=3 head_norm_before_train=0.887693 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=0.092453 metrics={'f1_val': 0.416130319701696, 'auprc': 0.7943613843607437, 'loss_val': 1.0096946112821266, 'psi': 0.5674227455653151}-{'f1_val': 0.4162799983110498, 'auprc': 0.7710511497194489, 'loss_val': 1.125568555549471, 'psi': 0.5581884588744094}
[S9] START round=3 head_norm_before_train=1.188469 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8685893755984584, 'loss_val': 1.1629186680357504, 'psi': 0.432274524523381}-{'f1_val': 0.141397957139996, 'auprc': 0.9418184682347539, 'loss_val': 1.2366025421237459, 'psi': 0.4615661615778992}
[S10] START round=3 head_norm_before_train=1.271569 (no previous merge yet)
[S10] round=3 local utility u=1.000000 metrics={'f1_val': 0.41676549412234565, 'auprc': 0.8652587656168587, 'loss_val': 0.9635294027093195, 'psi': 0.5961628027201509}-{'f1_val': 0.13862163754172394, 'auprc': 0.6802543495804895, 'loss_val': 1.177473824858642, 'psi': 0.3552747223572302}
[S11] START round=3 head_norm_before_train=1.256974 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8360493979386094, 'loss_val': 1.1874684602471006, 'psi': 0.41866796919931015}-{'f1_val': 0.14041368337311058, 'auprc': 0.8885662441213943, 'loss_val': 1.2546436876689262, 'psi': 0.43967470767242406}
[S13] START round=3 head_norm_before_train=1.238933 (no previous merge yet)
[S13] round=3 local utility u=0.916753 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.7384970278365003, 'loss_val': 1.041721499790443, 'psi': 0.5453290165820406}-{'f1_val': 0.1403857625770531, 'auprc': 0.7264833551485923, 'loss_val': 1.182199024148653, 'psi': 0.3748247996056688}
[S14] START round=3 head_norm_before_train=1.199143 (no previous merge yet)
[S14] round=3 local utility u=0.041121 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8581011905839138, 'loss_val': 1.2647710607160731, 'psi': 0.42745518796318777}-{'f1_val': 0.14449447400736798, 'auprc': 0.8354281980034348, 'loss_val': 1.3038134675228432, 'psi': 0.42086796360579476}
[S15] START round=3 head_norm_before_train=1.231221 (no previous merge yet)
[S15] round=3 local utility u=0.938157 metrics={'f1_val': 0.4157993423538048, 'auprc': 0.7994406183564211, 'loss_val': 1.072828211478136, 'psi': 0.5692558527548514}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764283165215916, 'loss_val': 1.2237108162953843, 'psi': 0.3944115174255717}
[S16] START round=3 head_norm_before_train=1.204697 (no previous merge yet)
[S16] round=3 local utility u=0.017219 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.679503530933866, 'loss_val': 1.2462895778695795, 'psi': 0.3561838824930683}-{'f1_val': 0.14063745019920318, 'auprc': 0.6849442474885308, 'loss_val': 1.2970505322119186, 'psi': 0.3583601691149342}
[S17] START round=3 head_norm_before_train=1.276273 (no previous merge yet)
[S17] round=3 local utility u=0.182765 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7964028676794075, 'loss_val': 1.0783324968004548, 'psi': 0.40313052506219366}-{'f1_val': 0.14094896331738438, 'auprc': 0.7235203674591402, 'loss_val': 1.225214870121679, 'psi': 0.3739775249740867}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S16] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S10
[S7] cosine check vs S10: cos=0.0109
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=-0.0049
[S3] DROPPED delta from S8 (cos=-0.0049 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=-0.0535
[S6] DROPPED delta from S16 (cos=-0.0535 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=0.0094
[S15] RECEIVED delta(kind=head bytes=1794) from S13
[S15] cosine check vs S13: cos=-0.0175
[S15] DROPPED delta from S13 (cos=-0.0175 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S4
[S2] cosine check vs S4: cos=0.0029
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] cosine check vs S2: cos=0.0122
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.0683
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=-0.0181
[S10] DROPPED delta from S15 (cos=-0.0181 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=0.1343
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.0277
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.914539
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.000786e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.3931 head_norm=0.808290 delta_norm=0.800079
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.228412
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.110407e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.928413 delta_norm=0.811041
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.4168 head_norm=1.323079
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.848712e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.4170 head_norm=0.793659 delta_norm=0.784871
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.4161 head_norm=0.960100
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.379440e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.7145 head_norm=0.683265 delta_norm=0.637944
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.3476 head_norm=1.288372
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.855196e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.893830 delta_norm=0.885520
[S6] aggregate: ROLLBACK (f1_val pre=0.348 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.4163 head_norm=0.860986
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.316134e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.4161 head_norm=0.633471 delta_norm=0.631613
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.633471 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.368839 metrics={'f1_val': 0.5113496147259236, 'auprc': 0.7347797550674626, 'loss_val': 0.9776248115417994, 'psi': 0.6007216708625391}-{'f1_val': 0.41630530508844577, 'auprc': 0.7119521265781641, 'loss_val': 1.0765547046313604, 'psi': 0.5345640336843331}
[S3] START round=4 head_norm_before_train=1.186408 (no previous merge yet)
[S3] round=4 local utility u=0.022358 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7931035379029002, 'loss_val': 1.189584835799038, 'psi': 0.40114545452962436}-{'f1_val': 0.13984006561410703, 'auprc': 0.7952664514785268, 'loss_val': 1.2407899417177084, 'psi': 0.40201061995987497}
[S4] START round=4 head_norm_before_train=0.926901 cos_to_last_merge=0.9820 (last merge round=1)
[S4] round=4 local utility u=0.656171 metrics={'f1_val': 0.3901299063021737, 'auprc': 0.6541407089391609, 'loss_val': 0.9482913758553055, 'psi': 0.49573422735696854}-{'f1_val': 0.14022662889518414, 'auprc': 0.784062492594313, 'loss_val': 1.1509796438626678, 'psi': 0.3977609743748357}
[S5] START round=4 head_norm_before_train=1.237126 (no previous merge yet)
[S5] round=4 local utility u=0.049319 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7468899446998443, 'loss_val': 1.1819158224236734, 'psi': 0.3841131207370806}-{'f1_val': 0.14226190476190476, 'auprc': 0.7315238585259312, 'loss_val': 1.2344558365791303, 'psi': 0.37796668626751534}
[S6] START round=4 head_norm_before_train=0.893830 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.407709 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.704631054025179, 'loss_val': 0.9323117222146096, 'psi': 0.5322060431843199}-{'f1_val': 0.3476358639963393, 'auprc': 0.6138078377390824, 'loss_val': 1.0575397071061985, 'psi': 0.45410465349343654}
[S7] START round=4 head_norm_before_train=0.808290 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5755446596348227, 'loss_val': 1.3017970104115428, 'psi': 0.3154519574913841}-{'f1_val': 0.14205682272909165, 'auprc': 0.5892624367147342, 'loss_val': 1.3104881268558628, 'psi': 0.3209390683233487}
[S8] START round=4 head_norm_before_train=0.683265 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.217268 metrics={'f1_val': 0.3731326739016295, 'auprc': 0.9871930595294881, 'loss_val': 0.8956677941914436, 'psi': 0.6187568281527729}-{'f1_val': 0.416130319701696, 'auprc': 0.7943613843607437, 'loss_val': 1.0096946112821266, 'psi': 0.5674227455653151}
[S9] START round=4 head_norm_before_train=0.928413 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.176678 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9812521992191224, 'loss_val': 1.147551672935101, 'psi': 0.4773396539716466}-{'f1_val': 0.141397957139996, 'auprc': 0.8685893755984584, 'loss_val': 1.1629186680357504, 'psi': 0.432274524523381}
[S10] START round=4 head_norm_before_train=0.793659 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.377491666547512, 'auprc': 0.8659842749295342, 'loss_val': 0.859310657735597, 'psi': 0.5728887099003209}-{'f1_val': 0.41676549412234565, 'auprc': 0.8652587656168587, 'loss_val': 0.9635294027093195, 'psi': 0.5961628027201509}
[S11] START round=4 head_norm_before_train=1.291730 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7732383270698968, 'loss_val': 1.145857842411936, 'psi': 0.3935435408518251}-{'f1_val': 0.14041368337311058, 'auprc': 0.8360493979386094, 'loss_val': 1.1874684602471006, 'psi': 0.41866796919931015}
[S13] START round=4 head_norm_before_train=1.281235 (no previous merge yet)
[S13] round=4 local utility u=0.142792 metrics={'f1_val': 0.4302337425298807, 'auprc': 0.747517802372212, 'loss_val': 0.8653001953948898, 'psi': 0.5571473664668132}-{'f1_val': 0.41655034241240063, 'auprc': 0.7384970278365003, 'loss_val': 1.041721499790443, 'psi': 0.5453290165820406}
[S14] START round=4 head_norm_before_train=1.227294 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8223067246955327, 'loss_val': 1.2128734796428684, 'psi': 0.41313740160783535}-{'f1_val': 0.14035785288270378, 'auprc': 0.8581011905839138, 'loss_val': 1.2647710607160731, 'psi': 0.42745518796318777}
[S15] START round=4 head_norm_before_train=1.282740 (no previous merge yet)
[S15] round=4 local utility u=0.180345 metrics={'f1_val': 0.4103449079359856, 'auprc': 0.834536895932338, 'loss_val': 0.7847004251973567, 'psi': 0.5800217031345266}-{'f1_val': 0.4157993423538048, 'auprc': 0.7994406183564211, 'loss_val': 1.072828211478136, 'psi': 0.5692558527548514}
[S16] START round=4 head_norm_before_train=1.239795 (no previous merge yet)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6474649801494037, 'loss_val': 1.193280298420166, 'psi': 0.3433684621792834}-{'f1_val': 0.14063745019920318, 'auprc': 0.679503530933866, 'loss_val': 1.2462895778695795, 'psi': 0.3561838824930683}
[S17] START round=4 head_norm_before_train=1.325225 (no previous merge yet)
[S17] round=4 local utility u=0.877759 metrics={'f1_val': 0.3807964817614078, 'auprc': 0.8469840360284071, 'loss_val': 0.9136421475087668, 'psi': 0.5672715034682075}-{'f1_val': 0.14094896331738438, 'auprc': 0.7964028676794075, 'loss_val': 1.0783324968004548, 'psi': 0.40313052506219366}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.496)
[S15] not sending this round → trigger blocked (psi=0.580)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39403
[S8] not sending this round → trigger blocked (psi=0.619)
[S5] not sending this round → trigger blocked (psi=0.384)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.557)
[S6] not sending this round → trigger blocked (psi=0.532)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.601)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S9
[S3] cosine check vs S9: cos=-0.0057
[S3] DROPPED delta from S9 (cos=-0.0057 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=-0.0586
[S15] DROPPED delta from S3 (cos=-0.0586 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.567)
[S2] START round=5 head_norm_before_train=0.705669 cos_to_last_merge=0.9830 (last merge round=3)
[S2] round=5 local utility u=0.618491 metrics={'f1_val': 0.6794709856043435, 'auprc': 0.7462899469078148, 'loss_val': 0.7839019059143357, 'psi': 0.7061985701257321}-{'f1_val': 0.5113496147259236, 'auprc': 0.7347797550674626, 'loss_val': 0.9776248115417994, 'psi': 0.6007216708625391}
[S3] START round=5 head_norm_before_train=1.215583 (no previous merge yet)
[S3] round=5 local utility u=0.056423 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7954339664989858, 'loss_val': 1.0837300376789345, 'psi': 0.4020776259680585}-{'f1_val': 0.13984006561410703, 'auprc': 0.7931035379029002, 'loss_val': 1.189584835799038, 'psi': 0.40114545452962436}
[S4] START round=5 head_norm_before_train=0.996847 cos_to_last_merge=0.9626 (last merge round=1)
[S4] round=5 local utility u=0.893153 metrics={'f1_val': 0.6664366483726909, 'auprc': 0.6518969739652603, 'loss_val': 0.8130942455318602, 'psi': 0.6606207786097187}-{'f1_val': 0.3901299063021737, 'auprc': 0.6541407089391609, 'loss_val': 0.9482913758553055, 'psi': 0.49573422735696854}
[S5] START round=5 head_norm_before_train=1.262560 (no previous merge yet)
[S5] round=5 local utility u=0.898319 metrics={'f1_val': 0.4167436894719335, 'auprc': 0.769829119574225, 'loss_val': 1.1009870216656736, 'psi': 0.5579778615128501}-{'f1_val': 0.14226190476190476, 'auprc': 0.7468899446998443, 'loss_val': 1.1819158224236734, 'psi': 0.3841131207370806}
[S6] START round=5 head_norm_before_train=0.949179 cos_to_last_merge=0.9941 (last merge round=3)
[S6] round=5 local utility u=0.767830 metrics={'f1_val': 0.5934718454802399, 'auprc': 0.7904122721906562, 'loss_val': 0.7112897157592966, 'psi': 0.6722480161644064}-{'f1_val': 0.4172560359570804, 'auprc': 0.704631054025179, 'loss_val': 0.9323117222146096, 'psi': 0.5322060431843199}
[S7] START round=5 head_norm_before_train=0.828717 cos_to_last_merge=0.9968 (last merge round=3)
[S7] round=5 local utility u=0.327929 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776126253545494, 'loss_val': 1.2521435887473216, 'psi': 0.3962791437792748}-{'f1_val': 0.14205682272909165, 'auprc': 0.5755446596348227, 'loss_val': 1.3017970104115428, 'psi': 0.3154519574913841}
[S8] START round=5 head_norm_before_train=0.761987 cos_to_last_merge=0.9824 (last merge round=3)
[S8] round=5 local utility u=0.000000 metrics={'f1_val': 0.3729316501988709, 'auprc': 0.873879125229969, 'loss_val': 0.7054537093105357, 'psi': 0.5733106402113102}-{'f1_val': 0.3731326739016295, 'auprc': 0.9871930595294881, 'loss_val': 0.8956677941914436, 'psi': 0.6187568281527729}
[S9] START round=5 head_norm_before_train=0.959797 cos_to_last_merge=0.9977 (last merge round=3)
[S9] round=5 local utility u=0.038137 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9655889499752983, 'loss_val': 1.0242875801036182, 'psi': 0.471074354274117}-{'f1_val': 0.141397957139996, 'auprc': 0.9812521992191224, 'loss_val': 1.147551672935101, 'psi': 0.4773396539716466}
[S10] START round=5 head_norm_before_train=0.869895 cos_to_last_merge=0.9895 (last merge round=3)
[S10] round=5 local utility u=0.185032 metrics={'f1_val': 0.4109868649831334, 'auprc': 0.8654572564656957, 'loss_val': 0.6886361256585694, 'psi': 0.5927750215761584}-{'f1_val': 0.377491666547512, 'auprc': 0.8659842749295342, 'loss_val': 0.859310657735597, 'psi': 0.5728887099003209}
[S11] START round=5 head_norm_before_train=1.327925 (no previous merge yet)
[S11] round=5 local utility u=0.202488 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8717925693578472, 'loss_val': 1.0365452949852418, 'psi': 0.43296523776700524}-{'f1_val': 0.14041368337311058, 'auprc': 0.7732383270698968, 'loss_val': 1.145857842411936, 'psi': 0.3935435408518251}
[S13] START round=5 head_norm_before_train=1.331072 (no previous merge yet)
[S13] round=5 local utility u=0.261414 metrics={'f1_val': 0.5141918890804354, 'auprc': 0.7148821018245433, 'loss_val': 0.7483136424377348, 'psi': 0.5944679741780785}-{'f1_val': 0.4302337425298807, 'auprc': 0.747517802372212, 'loss_val': 0.8653001953948898, 'psi': 0.5571473664668132}
[S14] START round=5 head_norm_before_train=1.260968 (no previous merge yet)
[S14] round=5 local utility u=0.030258 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8167145590792465, 'loss_val': 1.1355812286028006, 'psi': 0.4109005353613209}-{'f1_val': 0.14035785288270378, 'auprc': 0.8223067246955327, 'loss_val': 1.2128734796428684, 'psi': 0.41313740160783535}
[S15] START round=5 head_norm_before_train=1.341164 (no previous merge yet)
[S15] round=5 local utility u=1.000000 metrics={'f1_val': 0.7045106534523125, 'auprc': 0.9948254255253971, 'loss_val': 0.5726525081992069, 'psi': 0.8206365622815464}-{'f1_val': 0.4103449079359856, 'auprc': 0.834536895932338, 'loss_val': 0.7847004251973567, 'psi': 0.5800217031345266}
[S16] START round=5 head_norm_before_train=1.277845 (no previous merge yet)
[S16] round=5 local utility u=0.567186 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.4476312704464535, 'loss_val': 1.106020354233473, 'psi': 0.42809639408776795}-{'f1_val': 0.14063745019920318, 'auprc': 0.6474649801494037, 'loss_val': 1.193280298420166, 'psi': 0.3433684621792834}
[S17] START round=5 head_norm_before_train=1.386460 (no previous merge yet)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35350322639276865, 'auprc': 0.7990003623625204, 'loss_val': 0.8572287286386225, 'psi': 0.5317020807806694}-{'f1_val': 0.3807964817614078, 'auprc': 0.8469840360284071, 'loss_val': 0.9136421475087668, 'psi': 0.5672715034682075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[S3] not sending this round → trigger blocked (psi=0.402)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39408
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S5] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S9] not sending this round → trigger blocked (psi=0.471)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S11] → sending delta(kind=head bytes=1783) to S7@127.0.0.1:39408
[S11] sending update (kind=head size=1783 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1789 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1789) from S5
[S9] cosine check vs S5: cos=0.7084
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.4165
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.3596
[S15] RECEIVED delta(kind=head bytes=1793) from S13
[S15] cosine check vs S13: cos=-0.0159
[S15] DROPPED delta from S13 (cos=-0.0159 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.6149
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=0.8259
[S7] RECEIVED delta(kind=head bytes=1783) from S11
[S7] cosine check vs S11: cos=-0.0579
[S7] DROPPED delta from S11 (cos=-0.0579 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1792) from S14
[S6] cosine check vs S14: cos=0.5916
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] cosine check vs S2: cos=0.3134
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0241
[S6] DROPPED delta from S16 (cos=-0.0241 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1801) from S15
[S10] cosine check vs S15: cos=0.1345
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.995512
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.550584e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1428 head_norm=1.054648 delta_norm=0.455058
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.370 → S3@127.0.0.1:39403
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.3729 head_norm=0.851249
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.116203e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.3728 head_norm=0.790450 delta_norm=0.511620
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.467 → S3@127.0.0.1:39403
[S3] ⇄ pheromone p=0.371 → S15@127.0.0.1:39415
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.5935 head_norm=1.023968
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.400052e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.6055 head_norm=1.039459 delta_norm=0.540005
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.638 → S8@127.0.0.1:39409
[S4] ⇄ pheromone p=0.643 → S2@127.0.0.1:39402
[S14] ⇄ pheromone p=0.350 → S6@127.0.0.1:39407
[S11] ⇄ pheromone p=0.379 → S7@127.0.0.1:39408
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.7045 head_norm=1.398167
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.760228e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.5328 head_norm=0.942501 delta_norm=0.676023
[S15] aggregate: ROLLBACK (f1_val pre=0.705 post=0.533 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.729 → S10@127.0.0.1:39411
[S13] ⇄ pheromone p=0.555 → S15@127.0.0.1:39415
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=5 metric=0.6795 head_norm=0.808564
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.342774e-01
[S2] stored merged vector for next round verification (round=5)
[S2] DEBUG after merge:  round=5 metric=0.7141 head_norm=0.853776 delta_norm=0.434277
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.636 → S10@127.0.0.1:39411
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.4110 head_norm=0.961300
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.576875e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.4108 head_norm=0.723306 delta_norm=0.557687
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.523 → S7@127.0.0.1:39408
[S5] ⇄ pheromone p=0.520 → S9@127.0.0.1:39410
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.857765
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.729009e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.869169 delta_norm=0.272901
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.394 → S15@127.0.0.1:39415
[S16] ⇄ pheromone p=0.455 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.517 → S8@127.0.0.1:39409
[S2] START round=6 head_norm_before_train=0.853776 cos_to_last_merge=1.0000 (last merge round=5)
[S2] round=6 local utility u=0.105963 metrics={'f1_val': 0.7012900746650139, 'auprc': 0.7247456390665237, 'loss_val': 0.6382567160167486, 'psi': 0.7106723004256178}-{'f1_val': 0.6794709856043435, 'auprc': 0.7462899469078148, 'loss_val': 0.7839019059143357, 'psi': 0.7061985701257321}
[S3] START round=6 head_norm_before_train=1.246597 (no previous merge yet)
[S3] round=6 local utility u=0.834920 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.7977315156803133, 'loss_val': 0.9604554603340708, 'psi': 0.5569639621613978}-{'f1_val': 0.13984006561410703, 'auprc': 0.7954339664989858, 'loss_val': 1.0837300376789345, 'psi': 0.4020776259680585}
[S4] START round=6 head_norm_before_train=1.086868 cos_to_last_merge=0.9378 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=6 local utility u=0.153786 metrics={'f1_val': 0.6649758596173116, 'auprc': 0.7157658349287404, 'loss_val': 0.6883631856738196, 'psi': 0.6852918497418832}-{'f1_val': 0.6664366483726909, 'auprc': 0.6518969739652603, 'loss_val': 0.8130942455318602, 'psi': 0.6606207786097187}
[S5] START round=6 head_norm_before_train=1.283618 (no previous merge yet)
[S5] round=6 local utility u=0.072666 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7735046696956765, 'loss_val': 0.9739273052239625, 'psi': 0.5601726824569224}-{'f1_val': 0.4167436894719335, 'auprc': 0.769829119574225, 'loss_val': 1.1009870216656736, 'psi': 0.5579778615128501}
[S6] START round=6 head_norm_before_train=1.039459 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.532224 metrics={'f1_val': 0.7099011045070378, 'auprc': 0.8847734025974989, 'loss_val': 0.6285011729972366, 'psi': 0.7798500237432222}-{'f1_val': 0.5934718454802399, 'auprc': 0.7904122721906562, 'loss_val': 0.7112897157592966, 'psi': 0.6722480161644064}
[S7] START round=6 head_norm_before_train=0.869169 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6971215619204342, 'loss_val': 1.2311536821335214, 'psi': 0.36408271840562867}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776126253545494, 'loss_val': 1.2521435887473216, 'psi': 0.3962791437792748}
[S8] START round=6 head_norm_before_train=0.790450 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.235414 metrics={'f1_val': 0.3742069754117464, 'auprc': 0.9919638179606255, 'loss_val': 0.5965308063487402, 'psi': 0.6213097124312981}-{'f1_val': 0.3729316501988709, 'auprc': 0.873879125229969, 'loss_val': 0.7054537093105357, 'psi': 0.5733106402113102}
[S9] START round=6 head_norm_before_train=1.054648 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.7002591994055513, 'auprc': 0.999998335901247, 'loss_val': 0.9604129683952926, 'psi': 0.8201548540038296}-{'f1_val': 0.141397957139996, 'auprc': 0.9655889499752983, 'loss_val': 1.0242875801036182, 'psi': 0.471074354274117}
[S10] START round=6 head_norm_before_train=0.723306 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=1.000000 metrics={'f1_val': 0.7013704343360756, 'auprc': 0.9983022193365362, 'loss_val': 0.6514303434893726, 'psi': 0.8201431483362598}-{'f1_val': 0.4109868649831334, 'auprc': 0.8654572564656957, 'loss_val': 0.6886361256585694, 'psi': 0.5927750215761584}
[S11] START round=6 head_norm_before_train=1.352896 (no previous merge yet)
[S11] round=6 local utility u=0.971305 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9713058297646056, 'loss_val': 0.9291034209022381, 'psi': 0.6264334645513419}-{'f1_val': 0.14041368337311058, 'auprc': 0.8717925693578472, 'loss_val': 1.0365452949852418, 'psi': 0.43296523776700524}
[S13] START round=6 head_norm_before_train=1.384161 (no previous merge yet)
[S13] round=6 local utility u=0.779005 metrics={'f1_val': 0.7112130502895552, 'auprc': 0.7691792827978863, 'loss_val': 0.5353212224354245, 'psi': 0.7343995432928876}-{'f1_val': 0.5141918890804354, 'auprc': 0.7148821018245433, 'loss_val': 0.7483136424377348, 'psi': 0.5944679741780785}
[S14] START round=6 head_norm_before_train=1.302173 (no previous merge yet)
[S14] round=6 local utility u=0.596660 metrics={'f1_val': 0.26477994188318604, 'auprc': 0.9173517668928052, 'loss_val': 0.9907052190134369, 'psi': 0.5258086718870337}-{'f1_val': 0.14035785288270378, 'auprc': 0.8167145590792465, 'loss_val': 1.1355812286028006, 'psi': 0.4109005353613209}
[S15] START round=6 head_norm_before_train=0.942501 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6990202764071468, 'auprc': 0.9878568983341389, 'loss_val': 0.5299628114711232, 'psi': 0.8145549251779437}-{'f1_val': 0.7045106534523125, 'auprc': 0.9948254255253971, 'loss_val': 0.5726525081992069, 'psi': 0.8206365622815464}
[S16] START round=6 head_norm_before_train=1.315314 (no previous merge yet)
[S16] round=6 local utility u=0.336317 metrics={'f1_val': 0.4169255670501281, 'auprc': 0.6404212609383034, 'loss_val': 1.0228717059921315, 'psi': 0.5063238446053983}-{'f1_val': 0.4150731431819776, 'auprc': 0.4476312704464535, 'loss_val': 1.106020354233473, 'psi': 0.42809639408776795}
[S17] START round=6 head_norm_before_train=1.452992 (no previous merge yet)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.3544817054002317, 'auprc': 0.7381011223622977, 'loss_val': 0.9331529686437274, 'psi': 0.5079294721850581}-{'f1_val': 0.35350322639276865, 'auprc': 0.7990003623625204, 'loss_val': 0.8572287286386225, 'psi': 0.5317020807806694}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.820)
[S11] not sending this round → trigger blocked (psi=0.626)
[S4] not sending this round → trigger blocked (psi=0.685)
[S13] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[S16] not sending this round → trigger blocked (psi=0.506)
[S14] not sending this round → trigger blocked (psi=0.526)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:39415
[S5] not sending this round → trigger blocked (psi=0.560)
[S2] not sending this round → trigger blocked (psi=0.711)
[S6] not sending this round → trigger blocked (psi=0.780)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S3] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0422
[S3] DROPPED delta from S8 (cos=-0.0422 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=-0.0096
[S3] DROPPED delta from S9 (cos=-0.0096 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S3
[S15] cosine check vs S3: cos=-0.0611
[S15] DROPPED delta from S3 (cos=-0.0611 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=7 head_norm_before_train=0.943097 cos_to_last_merge=0.9869 (last merge round=5)
[S2] round=7 local utility u=0.074753 metrics={'f1_val': 0.7009533202285976, 'auprc': 0.7086453203913674, 'loss_val': 0.4384286090232481, 'psi': 0.7040301202937055}-{'f1_val': 0.7012900746650139, 'auprc': 0.7247456390665237, 'loss_val': 0.6382567160167486, 'psi': 0.7106723004256178}
[S3] START round=7 head_norm_before_train=1.280840 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6698831352342798, 'auprc': 0.9352303371738991, 'loss_val': 0.7759406815004103, 'psi': 0.7760220160101275}-{'f1_val': 0.39645225981545407, 'auprc': 0.7977315156803133, 'loss_val': 0.9604554603340708, 'psi': 0.5569639621613978}
[S4] START round=7 head_norm_before_train=1.183084 cos_to_last_merge=0.9131 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.6661722722592556, 'auprc': 0.6509299488289751, 'loss_val': 0.5831729656793071, 'psi': 0.6600753428871434}-{'f1_val': 0.6649758596173116, 'auprc': 0.7157658349287404, 'loss_val': 0.6883631856738196, 'psi': 0.6852918497418832}
[S5] START round=7 head_norm_before_train=1.308779 (no previous merge yet)
[S5] round=7 local utility u=0.089267 metrics={'f1_val': 0.41778804395810054, 'auprc': 0.794530722633966, 'loss_val': 0.8574917297820147, 'psi': 0.5684851154284467}-{'f1_val': 0.41795135763108626, 'auprc': 0.7735046696956765, 'loss_val': 0.9739273052239625, 'psi': 0.5601726824569224}
[S6] START round=7 head_norm_before_train=1.093453 cos_to_last_merge=0.9912 (last merge round=5)
[S6] round=7 local utility u=0.178561 metrics={'f1_val': 0.7099929224303602, 'auprc': 0.9507503725225388, 'loss_val': 0.4698608778953373, 'psi': 0.8062959024672316}-{'f1_val': 0.7099011045070378, 'auprc': 0.8847734025974989, 'loss_val': 0.6285011729972366, 'psi': 0.7798500237432222}
[S7] START round=7 head_norm_before_train=0.890635 cos_to_last_merge=0.9981 (last merge round=5)
[S7] round=7 local utility u=0.554967 metrics={'f1_val': 0.3788750435444971, 'auprc': 0.5755711437132146, 'loss_val': 1.177477762118336, 'psi': 0.4575534836119841}-{'f1_val': 0.14205682272909165, 'auprc': 0.6971215619204342, 'loss_val': 1.2311536821335214, 'psi': 0.36408271840562867}
[S8] START round=7 head_norm_before_train=0.873041 cos_to_last_merge=0.9895 (last merge round=5)
[S8] round=7 local utility u=0.993557 metrics={'f1_val': 0.7009086045093338, 'auprc': 0.948873319140533, 'loss_val': 0.4403559802502845, 'psi': 0.8000944903618135}-{'f1_val': 0.3742069754117464, 'auprc': 0.9919638179606255, 'loss_val': 0.5965308063487402, 'psi': 0.6213097124312981}
[S9] START round=7 head_norm_before_train=1.078869 cos_to_last_merge=0.9971 (last merge round=5)
[S9] round=7 local utility u=0.097338 metrics={'f1_val': 0.7010097212455122, 'auprc': 0.9995301720217479, 'loss_val': 0.7688354314980262, 'psi': 0.8204179015560065}-{'f1_val': 0.7002591994055513, 'auprc': 0.999998335901247, 'loss_val': 0.9604129683952926, 'psi': 0.8201548540038296}
[S10] START round=7 head_norm_before_train=0.825524 cos_to_last_merge=0.9827 (last merge round=5)
[S10] round=7 local utility u=0.000000 metrics={'f1_val': 0.670411507395161, 'auprc': 0.9729393744642143, 'loss_val': 0.48132344699448565, 'psi': 0.7914226542227824}-{'f1_val': 0.7013704343360756, 'auprc': 0.9983022193365362, 'loss_val': 0.6514303434893726, 'psi': 0.8201431483362598}
[S11] START round=7 head_norm_before_train=1.384939 (no previous merge yet)
[S11] round=7 local utility u=0.126003 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.998197874607154, 'loss_val': 0.7577738666093012, 'psi': 0.6371902824883613}-{'f1_val': 0.39651855440916606, 'auprc': 0.9713058297646056, 'loss_val': 0.9291034209022381, 'psi': 0.6264334645513419}
[S13] START round=7 head_norm_before_train=1.440043 (no previous merge yet)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.7025588474559712, 'auprc': 0.7495956170675426, 'loss_val': 0.47798728075384356, 'psi': 0.7213735553005998}-{'f1_val': 0.7112130502895552, 'auprc': 0.7691792827978863, 'loss_val': 0.5353212224354245, 'psi': 0.7343995432928876}
[S14] START round=7 head_norm_before_train=1.347441 (no previous merge yet)
[S14] round=7 local utility u=1.000000 metrics={'f1_val': 0.7015809605310499, 'auprc': 0.9947792174564547, 'loss_val': 0.8064875192201958, 'psi': 0.8188602633012119}-{'f1_val': 0.26477994188318604, 'auprc': 0.9173517668928052, 'loss_val': 0.9907052190134369, 'psi': 0.5258086718870337}
[S15] START round=7 head_norm_before_train=1.024099 cos_to_last_merge=0.9915 (last merge round=5)
[S15] round=7 local utility u=0.082721 metrics={'f1_val': 0.6998351254702585, 'auprc': 0.9908101100230167, 'loss_val': 0.37827037782998796, 'psi': 0.8162251192913618}-{'f1_val': 0.6990202764071468, 'auprc': 0.9878568983341389, 'loss_val': 0.5299628114711232, 'psi': 0.8145549251779437}
[S16] START round=7 head_norm_before_train=1.345677 (no previous merge yet)
[S16] round=7 local utility u=0.090561 metrics={'f1_val': 0.4170794120322684, 'auprc': 0.6705657750604376, 'loss_val': 0.9331057060758098, 'psi': 0.5184739572435361}-{'f1_val': 0.4169255670501281, 'auprc': 0.6404212609383034, 'loss_val': 1.0228717059921315, 'psi': 0.5063238446053983}
[S17] START round=7 head_norm_before_train=1.507308 (no previous merge yet)
[S17] round=7 local utility u=0.353387 metrics={'f1_val': 0.42016000959236266, 'auprc': 0.8216333659078261, 'loss_val': 0.8710448812582277, 'psi': 0.5807493521185481}-{'f1_val': 0.3544817054002317, 'auprc': 0.7381011223622977, 'loss_val': 0.9331529686437274, 'psi': 0.5079294721850581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39410
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S9] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S6
[S8] cosine check vs S6: cos=0.6867
[S3] RECEIVED delta(kind=head bytes=1793) from S9
[S3] cosine check vs S9: cos=-0.0114
[S3] DROPPED delta from S9 (cos=-0.0114 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=-0.0429
[S3] DROPPED delta from S8 (cos=-0.0429 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S2
[S10] cosine check vs S2: cos=0.3562
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=0.6586
[S7] RECEIVED delta(kind=head bytes=1793) from S11
[S7] cosine check vs S11: cos=-0.0338
[S7] DROPPED delta from S11 (cos=-0.0338 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.8922
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=-0.0004
[S6] DROPPED delta from S16 (cos=-0.0004 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1796) from S14
[S6] cosine check vs S14: cos=0.8217
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.5449
[S15] RECEIVED delta(kind=head bytes=1795) from S3
[S15] cosine check vs S3: cos=-0.0468
[S15] DROPPED delta from S3 (cos=-0.0468 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1793) from S17
[S8] cosine check vs S17: cos=0.1754
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.6704 head_norm=0.948223
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.446436e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.6868 head_norm=0.804934 delta_norm=0.344644
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.7100 head_norm=1.163450
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.996574e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.9240 head_norm=1.224826 delta_norm=0.399657
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7010 head_norm=1.117679
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.051229e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7017 head_norm=1.195589 delta_norm=0.305123
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.7009 head_norm=0.960684
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.319083e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.7021 head_norm=0.836633 delta_norm=0.431908
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.6998 head_norm=1.127573
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.952020e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7024 head_norm=0.896550 delta_norm=0.495202
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.048667 cos_to_last_merge=0.9611 (last merge round=5)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7011337461190337, 'auprc': 0.6640776551090632, 'loss_val': 0.35223071572972253, 'psi': 0.6863113097150455}-{'f1_val': 0.7009533202285976, 'auprc': 0.7086453203913674, 'loss_val': 0.4384286090232481, 'psi': 0.7040301202937055}
[S3] START round=8 head_norm_before_train=1.329648 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.45747987562169706, 'auprc': 0.999153990967937, 'loss_val': 0.71991959451694, 'psi': 0.674149521760193}-{'f1_val': 0.6698831352342798, 'auprc': 0.9352303371738991, 'loss_val': 0.7759406815004103, 'psi': 0.7760220160101275}
[S4] START round=8 head_norm_before_train=1.266408 cos_to_last_merge=0.8949 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.895
[S4] round=8 local utility u=0.250352 metrics={'f1_val': 0.6653653905885374, 'auprc': 0.8066112464197939, 'loss_val': 0.5446706441334973, 'psi': 0.72186373292104}-{'f1_val': 0.6661722722592556, 'auprc': 0.6509299488289751, 'loss_val': 0.5831729656793071, 'psi': 0.6600753428871434}
[S5] START round=8 head_norm_before_train=1.340097 (no previous merge yet)
[S5] round=8 local utility u=0.098158 metrics={'f1_val': 0.4175465518408786, 'auprc': 0.8355857513479528, 'loss_val': 0.7828921196807626, 'psi': 0.5847622316437082}-{'f1_val': 0.41778804395810054, 'auprc': 0.794530722633966, 'loss_val': 0.8574917297820147, 'psi': 0.5684851154284467}
[S6] START round=8 head_norm_before_train=1.224826 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.016465 metrics={'f1_val': 0.709965291213394, 'auprc': 0.9451958185761283, 'loss_val': 0.4201019897897326, 'psi': 0.8040575021584877}-{'f1_val': 0.7099929224303602, 'auprc': 0.9507503725225388, 'loss_val': 0.4698608778953373, 'psi': 0.8062959024672316}
[S7] START round=8 head_norm_before_train=0.909194 cos_to_last_merge=0.9945 (last merge round=5)
[S7] round=8 local utility u=0.164487 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.5754156104456951, 'loss_val': 1.0760350320566001, 'psi': 0.4802910839110536}-{'f1_val': 0.3788750435444971, 'auprc': 0.5755711437132146, 'loss_val': 1.177477762118336, 'psi': 0.4575534836119841}
[S8] START round=8 head_norm_before_train=0.836633 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.969844 metrics={'f1_val': 0.9960878102233311, 'auprc': 0.9980910026502796, 'loss_val': 0.41939608834495096, 'psi': 0.9968890871941105}-{'f1_val': 0.7009086045093338, 'auprc': 0.948873319140533, 'loss_val': 0.4403559802502845, 'psi': 0.8000944903618135}
[S9] START round=8 head_norm_before_train=1.195589 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.063328 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9992575748735947, 'loss_val': 0.6439376846643013, 'psi': 0.8205665101184108}-{'f1_val': 0.7010097212455122, 'auprc': 0.9995301720217479, 'loss_val': 0.7688354314980262, 'psi': 0.8204179015560065}
[S10] START round=8 head_norm_before_train=0.804934 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.046848 metrics={'f1_val': 0.6877978052808956, 'auprc': 0.9546749708810475, 'loss_val': 0.43715188447507203, 'psi': 0.7945486715209564}-{'f1_val': 0.670411507395161, 'auprc': 0.9729393744642143, 'loss_val': 0.48132344699448565, 'psi': 0.7914226542227824}
[S11] START round=8 head_norm_before_train=1.429795 (no previous merge yet)
[S11] round=8 local utility u=0.705919 metrics={'f1_val': 0.6196426922130315, 'auprc': 0.9930849679410989, 'loss_val': 0.6693412834973901, 'psi': 0.7690196025042585}-{'f1_val': 0.39651855440916606, 'auprc': 0.998197874607154, 'loss_val': 0.7577738666093012, 'psi': 0.6371902824883613}
[S13] START round=8 head_norm_before_train=1.480132 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6835619918256923, 'auprc': 0.697285525418246, 'loss_val': 0.4999320804680951, 'psi': 0.6890514052627138}-{'f1_val': 0.7025588474559712, 'auprc': 0.7495956170675426, 'loss_val': 0.47798728075384356, 'psi': 0.7213735553005998}
[S14] START round=8 head_norm_before_train=1.402225 (no previous merge yet)
[S14] round=8 local utility u=0.235902 metrics={'f1_val': 0.733144225093461, 'auprc': 0.9961088182544662, 'loss_val': 0.5280522651584372, 'psi': 0.8383300623578631}-{'f1_val': 0.7015809605310499, 'auprc': 0.9947792174564547, 'loss_val': 0.8064875192201958, 'psi': 0.8188602633012119}
[S15] START round=8 head_norm_before_train=0.896550 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.603678 metrics={'f1_val': 0.8985904354248678, 'auprc': 0.9987314869139265, 'loss_val': 0.3872099416067159, 'psi': 0.9386468560204914}-{'f1_val': 0.6998351254702585, 'auprc': 0.9908101100230167, 'loss_val': 0.37827037782998796, 'psi': 0.8162251192913618}
[S16] START round=8 head_norm_before_train=1.380301 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.31676941994551433, 'auprc': 0.6905121513209435, 'loss_val': 0.9420000708804379, 'psi': 0.46626651249568596}-{'f1_val': 0.4170794120322684, 'auprc': 0.6705657750604376, 'loss_val': 0.9331057060758098, 'psi': 0.5184739572435361}
[S17] START round=8 head_norm_before_train=1.538972 (no previous merge yet)
[S17] round=8 local utility u=0.222424 metrics={'f1_val': 0.39984761886176, 'auprc': 0.9255655935212791, 'loss_val': 0.6161189688437817, 'psi': 0.6101348087255677}-{'f1_val': 0.42016000959236266, 'auprc': 0.8216333659078261, 'loss_val': 0.8710448812582277, 'psi': 0.5807493521185481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S7@127.0.0.1:39408
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S7@127.0.0.1:39408
[S9] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S6
[S8] cosine check vs S6: cos=0.6052
[S2] RECEIVED delta(kind=head bytes=1801) from S4
[S2] cosine check vs S4: cos=0.7762
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.8177
[S7] RECEIVED delta(kind=head bytes=1790) from S10
[S7] cosine check vs S10: cos=0.7602
[S9] RECEIVED delta(kind=head bytes=1796) from S5
[S9] cosine check vs S5: cos=0.9556
[S6] RECEIVED delta(kind=head bytes=1789) from S14
[S6] cosine check vs S14: cos=0.9321
[S7] RECEIVED delta(kind=head bytes=1789) from S11
[S7] cosine check vs S11: cos=-0.0381
[S7] DROPPED delta from S11 (cos=-0.0381 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1795) from S9
[S3] cosine check vs S9: cos=-0.0189
[S3] DROPPED delta from S9 (cos=-0.0189 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.0182
[S15] RECEIVED delta(kind=head bytes=1799) from S7
[S15] cosine check vs S7: cos=0.7984
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.5008
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.7011 head_norm=1.138337
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.218692e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.7010 head_norm=1.162083 delta_norm=0.421869
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.4575 head_norm=1.386077
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.214855e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.4890 head_norm=0.835328 delta_norm=0.821486
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7014 head_norm=1.230046
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.057743e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7017 head_norm=1.285665 delta_norm=0.205774
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.8986 head_norm=0.986748
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.065996e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.9249 head_norm=0.913442 delta_norm=0.306600
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.7100 head_norm=1.279902
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.689862e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.9584 head_norm=1.349564 delta_norm=0.268986
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4169 head_norm=0.939727
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.212437e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4172 head_norm=0.869859 delta_norm=0.321244
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.9961 head_norm=0.907752
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.891861e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.9965 head_norm=0.888576 delta_norm=0.289186
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.6878 head_norm=0.914668
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.890913e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.6878 head_norm=0.906405 delta_norm=0.289091
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.162083 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7010529594768992, 'auprc': 0.6616203180421357, 'loss_val': 0.3644336295420182, 'psi': 0.6852799029029938}-{'f1_val': 0.7011337461190337, 'auprc': 0.6640776551090632, 'loss_val': 0.35223071572972253, 'psi': 0.6863113097150455}
[S3] START round=9 head_norm_before_train=0.835328 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.684754 metrics={'f1_val': 0.6837194175032544, 'auprc': 0.9988747579624627, 'loss_val': 0.7070104725705518, 'psi': 0.8097815536869377}-{'f1_val': 0.45747987562169706, 'auprc': 0.999153990967937, 'loss_val': 0.71991959451694, 'psi': 0.674149521760193}
[S4] START round=9 head_norm_before_train=1.327031 cos_to_last_merge=0.8819 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=9 local utility u=1.000000 metrics={'f1_val': 0.955139625103363, 'auprc': 0.9375348484248471, 'loss_val': 0.530946128685989, 'psi': 0.9480977144319567}-{'f1_val': 0.6653653905885374, 'auprc': 0.8066112464197939, 'loss_val': 0.5446706441334973, 'psi': 0.72186373292104}
[S5] START round=9 head_norm_before_train=1.370233 (no previous merge yet)
[S5] round=9 local utility u=0.062802 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.876147187637904, 'loss_val': 0.7796970252203922, 'psi': 0.6010591864350088}-{'f1_val': 0.4175465518408786, 'auprc': 0.8355857513479528, 'loss_val': 0.7828921196807626, 'psi': 0.5847622316437082}
[S6] START round=9 head_norm_before_train=1.349564 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.090881 metrics={'f1_val': 0.7099929224303602, 'auprc': 0.9844410754796113, 'loss_val': 0.3562415886843198, 'psi': 0.8197721836500607}-{'f1_val': 0.709965291213394, 'auprc': 0.9451958185761283, 'loss_val': 0.4201019897897326, 'psi': 0.8040575021584877}
[S7] START round=9 head_norm_before_train=0.869859 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.051922 metrics={'f1_val': 0.41711588266717814, 'auprc': 0.5842362550000293, 'loss_val': 1.0001001639418365, 'psi': 0.4839640316003186}-{'f1_val': 0.4168747328879592, 'auprc': 0.5754156104456951, 'loss_val': 1.0760350320566001, 'psi': 0.4802910839110536}
[S8] START round=9 head_norm_before_train=0.888576 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.016040 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9979446118497832, 'loss_val': 0.39018585159433256, 'psi': 0.9971614930039105}-{'f1_val': 0.9960878102233311, 'auprc': 0.9980910026502796, 'loss_val': 0.41939608834495096, 'psi': 0.9968890871941105}
[S9] START round=9 head_norm_before_train=1.285665 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.062708 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9992287601472696, 'loss_val': 0.5179877542508664, 'psi': 0.8205103046904134}-{'f1_val': 0.7014391336149548, 'auprc': 0.9992575748735947, 'loss_val': 0.6439376846643013, 'psi': 0.8205665101184108}
[S10] START round=9 head_norm_before_train=0.906405 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.083202 metrics={'f1_val': 0.6888443325515965, 'auprc': 0.9823505811010804, 'loss_val': 0.3600537010072026, 'psi': 0.80624683197139}-{'f1_val': 0.6877978052808956, 'auprc': 0.9546749708810475, 'loss_val': 0.43715188447507203, 'psi': 0.7945486715209564}
[S11] START round=9 head_norm_before_train=1.476728 (no previous merge yet)
[S11] round=9 local utility u=0.352797 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9970854425213944, 'loss_val': 0.4688405629919377, 'psi': 0.8199289722292972}-{'f1_val': 0.6196426922130315, 'auprc': 0.9930849679410989, 'loss_val': 0.6693412834973901, 'psi': 0.7690196025042585}
[S13] START round=9 head_norm_before_train=1.505690 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6208247372444146, 'auprc': 0.6848335288696846, 'loss_val': 0.568152267095113, 'psi': 0.6464282538945225}-{'f1_val': 0.6835619918256923, 'auprc': 0.697285525418246, 'loss_val': 0.4999320804680951, 'psi': 0.6890514052627138}
[S14] START round=9 head_norm_before_train=1.466017 (no previous merge yet)
[S14] round=9 local utility u=0.847323 metrics={'f1_val': 0.9959421937071512, 'auprc': 0.9960706934344657, 'loss_val': 0.4100793265484313, 'psi': 0.995993593598077}-{'f1_val': 0.733144225093461, 'auprc': 0.9961088182544662, 'loss_val': 0.5280522651584372, 'psi': 0.8383300623578631}
[S15] START round=9 head_norm_before_train=0.913442 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.315724 metrics={'f1_val': 0.9970335003214698, 'auprc': 0.9986154213076458, 'loss_val': 0.3460720663780975, 'psi': 0.9976662687159402}-{'f1_val': 0.8985904354248678, 'auprc': 0.9987314869139265, 'loss_val': 0.3872099416067159, 'psi': 0.9386468560204914}
[S16] START round=9 head_norm_before_train=1.413081 (no previous merge yet)
[S16] round=9 local utility u=0.340583 metrics={'f1_val': 0.39145135319207186, 'auprc': 0.7351825806545553, 'loss_val': 0.84293644337331, 'psi': 0.5289438441770653}-{'f1_val': 0.31676941994551433, 'auprc': 0.6905121513209435, 'loss_val': 0.9420000708804379, 'psi': 0.46626651249568596}
[S17] START round=9 head_norm_before_train=1.559181 (no previous merge yet)
[S17] round=9 local utility u=1.000000 metrics={'f1_val': 0.8378732149110496, 'auprc': 0.9714918924301226, 'loss_val': 0.43666234391663816, 'psi': 0.8913206859186789}-{'f1_val': 0.39984761886176, 'auprc': 0.9255655935212791, 'loss_val': 0.6161189688437817, 'psi': 0.6101348087255677}
[S14] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → trigger blocked (psi=0.601)
[S7] not sending this round → trigger blocked (psi=0.484)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S4] not sending this round → trigger blocked (psi=0.948)
[S8] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → trigger blocked (psi=0.821)
[S10] not sending this round → trigger blocked (psi=0.806)
[S6] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[S3] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1795) from S3
[S15] cosine check vs S3: cos=-0.0372
[S15] DROPPED delta from S3 (cos=-0.0372 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.0179
[S17] not sending this round → trigger blocked (psi=0.891)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.7100 head_norm=1.400147
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.967723e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.9619 head_norm=1.014775 delta_norm=0.996772
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.228733 cos_to_last_merge=0.9964 (last merge round=8)
[S2] round=10 local utility u=0.013690 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.6632467040891854, 'loss_val': 0.34348733334189974, 'psi': 0.686085932570048}-{'f1_val': 0.7010529594768992, 'auprc': 0.6616203180421357, 'loss_val': 0.3644336295420182, 'psi': 0.6852799029029938}
[S3] START round=10 head_norm_before_train=0.896157 cos_to_last_merge=0.9957 (last merge round=8)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.649866648584018, 'auprc': 0.9988763423228453, 'loss_val': 0.6354950606276758, 'psi': 0.7894705260795489}-{'f1_val': 0.6837194175032544, 'auprc': 0.9988747579624627, 'loss_val': 0.7070104725705518, 'psi': 0.8097815536869377}
[S4] START round=10 head_norm_before_train=1.376299 cos_to_last_merge=0.8721 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.872
[S4] round=10 local utility u=0.021418 metrics={'f1_val': 0.9555670887400955, 'auprc': 0.9381098536441819, 'loss_val': 0.49239993305453766, 'psi': 0.9485841947017302}-{'f1_val': 0.955139625103363, 'auprc': 0.9375348484248471, 'loss_val': 0.530946128685989, 'psi': 0.9480977144319567}
[S5] START round=10 head_norm_before_train=1.397905 (no previous merge yet)
[S5] round=10 local utility u=0.016902 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.8695142059480946, 'loss_val': 0.7262311173061947, 'psi': 0.5984297049390552}-{'f1_val': 0.4176671856330787, 'auprc': 0.876147187637904, 'loss_val': 0.7796970252203922, 'psi': 0.6010591864350088}
[S6] START round=10 head_norm_before_train=1.014775 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.7094983302739498, 'auprc': 0.9663862712445175, 'loss_val': 0.5738935225638154, 'psi': 0.812253506662177}-{'f1_val': 0.7099929224303602, 'auprc': 0.9844410754796113, 'loss_val': 0.3562415886843198, 'psi': 0.8197721836500607}
[S7] START round=10 head_norm_before_train=0.906252 cos_to_last_merge=0.9979 (last merge round=8)
[S7] round=10 local utility u=0.348387 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7769633560967601, 'loss_val': 0.8802908310309644, 'psi': 0.5609332007001787}-{'f1_val': 0.41711588266717814, 'auprc': 0.5842362550000293, 'loss_val': 1.0001001639418365, 'psi': 0.4839640316003186}
[S8] START round=10 head_norm_before_train=0.952227 cos_to_last_merge=0.9944 (last merge round=8)
[S8] round=10 local utility u=0.067977 metrics={'f1_val': 0.9967904835007894, 'auprc': 0.9971536865897341, 'loss_val': 0.25276478557612786, 'psi': 0.9969357647363672}-{'f1_val': 0.9966394137733288, 'auprc': 0.9979446118497832, 'loss_val': 0.39018585159433256, 'psi': 0.9971614930039105}
[S9] START round=10 head_norm_before_train=1.322455 cos_to_last_merge=0.9966 (last merge round=8)
[S9] round=10 local utility u=0.069582 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9992324288736185, 'loss_val': 0.38033676540644, 'psi': 0.8206618809803845}-{'f1_val': 0.7013646677191758, 'auprc': 0.9992287601472696, 'loss_val': 0.5179877542508664, 'psi': 0.8205103046904134}
[S10] START round=10 head_norm_before_train=1.002873 cos_to_last_merge=0.9917 (last merge round=8)
[S10] round=10 local utility u=0.863039 metrics={'f1_val': 0.954805024081664, 'auprc': 0.9941706930531482, 'loss_val': 0.2651992797918758, 'psi': 0.9705512916702577}-{'f1_val': 0.6888443325515965, 'auprc': 0.9823505811010804, 'loss_val': 0.3600537010072026, 'psi': 0.80624683197139}
[S11] START round=10 head_norm_before_train=1.523535 (no previous merge yet)
[S11] round=10 local utility u=0.052528 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9964960573629662, 'loss_val': 0.3634669287741644, 'psi': 0.8198383210121505}-{'f1_val': 0.7018246587012323, 'auprc': 0.9970854425213944, 'loss_val': 0.4688405629919377, 'psi': 0.8199289722292972}
[S13] START round=10 head_norm_before_train=1.534808 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6295082866949345, 'auprc': 0.6411688057126741, 'loss_val': 0.5731723834936748, 'psi': 0.6341724943020304}-{'f1_val': 0.6208247372444146, 'auprc': 0.6848335288696846, 'loss_val': 0.568152267095113, 'psi': 0.6464282538945225}
[S14] START round=10 head_norm_before_train=1.529337 (no previous merge yet)
[S14] round=10 local utility u=0.041994 metrics={'f1_val': 0.9984980569824138, 'auprc': 0.9956456178521379, 'loss_val': 0.34015028191064367, 'psi': 0.9973570813303034}-{'f1_val': 0.9959421937071512, 'auprc': 0.9960706934344657, 'loss_val': 0.4100793265484313, 'psi': 0.995993593598077}
[S15] START round=10 head_norm_before_train=1.011439 cos_to_last_merge=0.9893 (last merge round=8)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.9588590053815489, 'auprc': 0.9985547943542978, 'loss_val': 0.2205599232395031, 'psi': 0.9747373209706485}-{'f1_val': 0.9970335003214698, 'auprc': 0.9986154213076458, 'loss_val': 0.3460720663780975, 'psi': 0.9976662687159402}
[S16] START round=10 head_norm_before_train=1.444381 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3660163591247196, 'auprc': 0.7406665600055236, 'loss_val': 0.8158059483152371, 'psi': 0.5158764394770412}-{'f1_val': 0.39145135319207186, 'auprc': 0.7351825806545553, 'loss_val': 0.84293644337331, 'psi': 0.5289438441770653}
[S17] START round=10 head_norm_before_train=1.596549 (no previous merge yet)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.6631547299112712, 'auprc': 0.9736994004286954, 'loss_val': 0.5051584670004321, 'psi': 0.7873725981182409}-{'f1_val': 0.8378732149110496, 'auprc': 0.9714918924301226, 'loss_val': 0.43666234391663816, 'psi': 0.8913206859186789}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S2
[S10] cosine check vs S2: cos=0.2842
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0328
[S7] DROPPED delta from S11 (cos=-0.0328 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9401
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.5085
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9557
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.0224
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=0.8861
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9026
[S6] RECEIVED delta(kind=head bytes=1798) from S14
[S6] cosine check vs S14: cos=0.7004
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7095 head_norm=1.061480
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.679066e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.9591 head_norm=1.226498 delta_norm=0.567907
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.288 → S8@127.0.0.1:39409
[S13] ⇄ pheromone p=0.246 → S15@127.0.0.1:39415
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6499 head_norm=0.964214
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.439088e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6988 head_norm=0.753116 delta_norm=0.543909
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.402 → S15@127.0.0.1:39415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.9589 head_norm=1.124705
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.616247e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.9647 head_norm=1.008459 delta_norm=0.261625
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.375 → S10@127.0.0.1:39411
[S4] ⇄ pheromone p=0.419 → S2@127.0.0.1:39402
[S11] ⇄ pheromone p=0.374 → S7@127.0.0.1:39408
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7013 head_norm=1.297350
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.052900e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.7025 head_norm=1.324325 delta_norm=0.305290
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.228 → S10@127.0.0.1:39411
[S5] ⇄ pheromone p=0.211 → S9@127.0.0.1:39410
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4169 head_norm=0.951796
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.880886e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4169 head_norm=1.003101 delta_norm=0.188089
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.285 → S15@127.0.0.1:39415
[S8] ⇄ pheromone p=0.414 → S3@127.0.0.1:39403
[S14] ⇄ pheromone p=0.440 → S6@127.0.0.1:39407
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=10 metric=0.9548 head_norm=1.085018
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.177029e-01
[S10] stored merged vector for next round verification (round=10)
[S10] DEBUG after merge:  round=10 metric=0.9906 head_norm=0.956605 delta_norm=0.717703
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.445 → S7@127.0.0.1:39408
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7016 head_norm=1.369873
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.089301e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7019 head_norm=1.378704 delta_norm=0.208930
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.245 → S3@127.0.0.1:39403
[S16] ⇄ pheromone p=0.240 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.394 → S8@127.0.0.1:39409
[S2] START round=11 head_norm_before_train=1.324325 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7025501480691084, 'auprc': 0.6635267951807843, 'loss_val': 0.35747791561892, 'psi': 0.6869408069137788}-{'f1_val': 0.7013120848906231, 'auprc': 0.6632467040891854, 'loss_val': 0.34348733334189974, 'psi': 0.686085932570048}
[S3] START round=11 head_norm_before_train=0.753116 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.146422 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9984503628281688, 'loss_val': 0.6456620175115855, 'psi': 0.8197289827265205}-{'f1_val': 0.649866648584018, 'auprc': 0.9988763423228453, 'loss_val': 0.6354950606276758, 'psi': 0.7894705260795489}
[S4] START round=11 head_norm_before_train=1.418083 cos_to_last_merge=0.8651 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.865
[S4] round=11 local utility u=0.058988 metrics={'f1_val': 0.9528250104055427, 'auprc': 0.9477593625051322, 'loss_val': 0.38692037982921934, 'psi': 0.9507987512453785}-{'f1_val': 0.9555670887400955, 'auprc': 0.9381098536441819, 'loss_val': 0.49239993305453766, 'psi': 0.9485841947017302}
[S5] START round=11 head_norm_before_train=1.418591 (no previous merge yet)
[S5] round=11 local utility u=0.043283 metrics={'f1_val': 0.4177857972322012, 'auprc': 0.8771114989687554, 'loss_val': 0.6629319591675924, 'psi': 0.6015160779268229}-{'f1_val': 0.41770670426636225, 'auprc': 0.8695142059480946, 'loss_val': 0.7262311173061947, 'psi': 0.5984297049390552}
[S6] START round=11 head_norm_before_train=1.226498 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6207887346065022, 'auprc': 0.92370494511067, 'loss_val': 0.4959303713808412, 'psi': 0.7419552188081693}-{'f1_val': 0.7094983302739498, 'auprc': 0.9663862712445175, 'loss_val': 0.5738935225638154, 'psi': 0.812253506662177}
[S7] START round=11 head_norm_before_train=1.003101 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.029884 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7829493774115425, 'loss_val': 0.8372633913068563, 'psi': 0.563205821831231}-{'f1_val': 0.4169130971024577, 'auprc': 0.7769633560967601, 'loss_val': 0.8802908310309644, 'psi': 0.5609332007001787}
[S8] START round=11 head_norm_before_train=1.046573 cos_to_last_merge=0.9772 (last merge round=8)
[S8] round=11 local utility u=0.042426 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9970392217270028, 'loss_val': 0.16666587843228717, 'psi': 0.9967996132794608}-{'f1_val': 0.9967904835007894, 'auprc': 0.9971536865897341, 'loss_val': 0.25276478557612786, 'psi': 0.9969357647363672}
[S9] START round=11 head_norm_before_train=1.378704 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.011302 metrics={'f1_val': 0.7002981155571382, 'auprc': 0.9988473024519844, 'loss_val': 0.34867604853287304, 'psi': 0.8197177903150767}-{'f1_val': 0.7016148490515617, 'auprc': 0.9992324288736185, 'loss_val': 0.38033676540644, 'psi': 0.8206618809803845}
[S10] START round=11 head_norm_before_train=0.956605 cos_to_last_merge=1.0000 (last merge round=10)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.9592308480421906, 'auprc': 0.9873858544294134, 'loss_val': 0.403167001774149, 'psi': 0.9704928505970797}-{'f1_val': 0.954805024081664, 'auprc': 0.9941706930531482, 'loss_val': 0.2651992797918758, 'psi': 0.9705512916702577}
[S11] START round=11 head_norm_before_train=1.572142 (no previous merge yet)
[S11] round=11 local utility u=0.036200 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.996425295550816, 'loss_val': 0.2908552553307672, 'psi': 0.8198100162872904}-{'f1_val': 0.7020664967782734, 'auprc': 0.9964960573629662, 'loss_val': 0.3634669287741644, 'psi': 0.8198383210121505}
[S13] START round=11 head_norm_before_train=1.563390 (no previous merge yet)
[S13] round=11 local utility u=0.065550 metrics={'f1_val': 0.6155179706005197, 'auprc': 0.6937615729586728, 'loss_val': 0.5159080905614976, 'psi': 0.646815411543781}-{'f1_val': 0.6295082866949345, 'auprc': 0.6411688057126741, 'loss_val': 0.5731723834936748, 'psi': 0.6341724943020304}
[S14] START round=11 head_norm_before_train=1.589620 (no previous merge yet)
[S14] round=11 local utility u=0.037956 metrics={'f1_val': 0.9974992264159193, 'auprc': 0.9956375380501836, 'loss_val': 0.2582214262985517, 'psi': 0.996754551069625}-{'f1_val': 0.9984980569824138, 'auprc': 0.9956456178521379, 'loss_val': 0.34015028191064367, 'psi': 0.9973570813303034}
[S15] START round=11 head_norm_before_train=1.008459 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.8985584915380771, 'auprc': 0.9980644142092068, 'loss_val': 0.28577947484635324, 'psi': 0.938360860606529}-{'f1_val': 0.9588590053815489, 'auprc': 0.9985547943542978, 'loss_val': 0.2205599232395031, 'psi': 0.9747373209706485}
[S16] START round=11 head_norm_before_train=1.480980 (no previous merge yet)
[S16] round=11 local utility u=0.130096 metrics={'f1_val': 0.40369576269349483, 'auprc': 0.7595368505437424, 'loss_val': 0.8383015512618568, 'psi': 0.5460321978335939}-{'f1_val': 0.3660163591247196, 'auprc': 0.7406665600055236, 'loss_val': 0.8158059483152371, 'psi': 0.5158764394770412}
[S17] START round=11 head_norm_before_train=1.632242 (no previous merge yet)
[S17] round=11 local utility u=0.023019 metrics={'f1_val': 0.6661598192133522, 'auprc': 0.9793152235652424, 'loss_val': 0.493998436649504, 'psi': 0.7914219809541083}-{'f1_val': 0.6631547299112712, 'auprc': 0.9736994004286954, 'loss_val': 0.5051584670004321, 'psi': 0.7873725981182409}
[S9] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S8] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → trigger blocked (psi=0.602)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S4] not sending this round → trigger blocked (psi=0.951)
[S7] not sending this round → trigger blocked (psi=0.563)
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S16
[S6] cosine check vs S16: cos=0.2965
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=-0.0152
[S15] DROPPED delta from S3 (cos=-0.0152 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=-0.0908
[S15] DROPPED delta from S13 (cos=-0.0908 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.5625
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6208 head_norm=1.294632
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.402385e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.8462 head_norm=1.135878 delta_norm=0.840239
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.9966 head_norm=1.145236
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.946892e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.9964 head_norm=1.245975 delta_norm=0.694689
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.378615 cos_to_last_merge=0.9983 (last merge round=10)
[S2] round=12 local utility u=0.052920 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.700083248130859, 'loss_val': 0.35387833030099447, 'psi': 0.7008205501867175}-{'f1_val': 0.7025501480691084, 'auprc': 0.6635267951807843, 'loss_val': 0.35747791561892, 'psi': 0.6869408069137788}
[S3] START round=12 head_norm_before_train=0.815359 cos_to_last_merge=0.9925 (last merge round=10)
[S3] round=12 local utility u=0.063130 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.998451376309912, 'loss_val': 0.5193778708650895, 'psi': 0.8197267319117343}-{'f1_val': 0.7005813959920884, 'auprc': 0.9984503628281688, 'loss_val': 0.6456620175115855, 'psi': 0.8197289827265205}
[S4] START round=12 head_norm_before_train=1.461402 cos_to_last_merge=0.8585 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.858
[S4] round=12 local utility u=0.018082 metrics={'f1_val': 0.9487892510340579, 'auprc': 0.9470180590143991, 'loss_val': 0.3243179453475898, 'psi': 0.9480807742261943}-{'f1_val': 0.9528250104055427, 'auprc': 0.9477593625051322, 'loss_val': 0.38692037982921934, 'psi': 0.9507987512453785}
[S5] START round=12 head_norm_before_train=1.437081 (no previous merge yet)
[S5] round=12 local utility u=0.069887 metrics={'f1_val': 0.440196730451659, 'auprc': 0.8607827815926451, 'loss_val': 0.6086383850149719, 'psi': 0.6084311509080534}-{'f1_val': 0.4177857972322012, 'auprc': 0.8771114989687554, 'loss_val': 0.6629319591675924, 'psi': 0.6015160779268229}
[S6] START round=12 head_norm_before_train=1.135878 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6246025779536656, 'auprc': 0.8662229586899743, 'loss_val': 0.5893186893078161, 'psi': 0.7212507302481892}-{'f1_val': 0.6207887346065022, 'auprc': 0.92370494511067, 'loss_val': 0.4959303713808412, 'psi': 0.7419552188081693}
[S7] START round=12 head_norm_before_train=1.044472 cos_to_last_merge=0.9981 (last merge round=10)
[S7] round=12 local utility u=0.049144 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.806756545910845, 'loss_val': 0.8103978142173085, 'psi': 0.572728689230952}-{'f1_val': 0.41671011811102343, 'auprc': 0.7829493774115425, 'loss_val': 0.8372633913068563, 'psi': 0.563205821831231}
[S8] START round=12 head_norm_before_train=1.245975 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9933232950536411, 'loss_val': 0.17930529269699333, 'psi': 0.9953132426101161}-{'f1_val': 0.9966398743144329, 'auprc': 0.9970392217270028, 'loss_val': 0.16666587843228717, 'psi': 0.9967996132794608}
[S9] START round=12 head_norm_before_train=1.422526 cos_to_last_merge=0.9980 (last merge round=10)
[S9] round=12 local utility u=0.039079 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.99884514433319, 'loss_val': 0.27796749383945324, 'psi': 0.8204624562544393}-{'f1_val': 0.7002981155571382, 'auprc': 0.9988473024519844, 'loss_val': 0.34867604853287304, 'psi': 0.8197177903150767}
[S10] START round=12 head_norm_before_train=1.016733 cos_to_last_merge=0.9969 (last merge round=10)
[S10] round=12 local utility u=0.183613 metrics={'f1_val': 0.9939338690605257, 'auprc': 0.9967396469561716, 'loss_val': 0.2722213020992767, 'psi': 0.9950561802187841}-{'f1_val': 0.9592308480421906, 'auprc': 0.9873858544294134, 'loss_val': 0.403167001774149, 'psi': 0.9704928505970797}
[S11] START round=12 head_norm_before_train=1.618260 (no previous merge yet)
[S11] round=12 local utility u=0.258998 metrics={'f1_val': 0.7810972944898256, 'auprc': 0.9964100091652377, 'loss_val': 0.24699862825035906, 'psi': 0.8672223803599904}-{'f1_val': 0.7020664967782734, 'auprc': 0.996425295550816, 'loss_val': 0.2908552553307672, 'psi': 0.8198100162872904}
[S13] START round=12 head_norm_before_train=1.580297 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.5650747319332821, 'auprc': 0.6915989884748113, 'loss_val': 0.8282973124229462, 'psi': 0.6156844345498937}-{'f1_val': 0.6155179706005197, 'auprc': 0.6937615729586728, 'loss_val': 0.5159080905614976, 'psi': 0.646815411543781}
[S14] START round=12 head_norm_before_train=1.642630 (no previous merge yet)
[S14] round=12 local utility u=0.029682 metrics={'f1_val': 0.9979135742335156, 'auprc': 0.9956358469666149, 'loss_val': 0.2013379057067299, 'psi': 0.9970024833267552}-{'f1_val': 0.9974992264159193, 'auprc': 0.9956375380501836, 'loss_val': 0.2582214262985517, 'psi': 0.996754551069625}
[S15] START round=12 head_norm_before_train=1.104629 cos_to_last_merge=0.9951 (last merge round=10)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.852774600112389, 'auprc': 0.9976806719257886, 'loss_val': 0.22965979795062852, 'psi': 0.9107370288377489}-{'f1_val': 0.8985584915380771, 'auprc': 0.9980644142092068, 'loss_val': 0.28577947484635324, 'psi': 0.938360860606529}
[S16] START round=12 head_norm_before_train=1.521962 (no previous merge yet)
[S16] round=12 local utility u=0.408150 metrics={'f1_val': 0.5354519587498605, 'auprc': 0.7609951449555861, 'loss_val': 0.816913532662551, 'psi': 0.6256692332321507}-{'f1_val': 0.40369576269349483, 'auprc': 0.7595368505437424, 'loss_val': 0.8383015512618568, 'psi': 0.5460321978335939}
[S17] START round=12 head_norm_before_train=1.660881 (no previous merge yet)
[S17] round=12 local utility u=0.190866 metrics={'f1_val': 0.7110988298093349, 'auprc': 0.9812769994629942, 'loss_val': 0.3877854172359827, 'psi': 0.8191700976707986}-{'f1_val': 0.6661598192133522, 'auprc': 0.9793152235652424, 'loss_val': 0.493998436649504, 'psi': 0.7914219809541083}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39402
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:39407
[S9] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S4
[S2] cosine check vs S4: cos=0.9478
[S6] RECEIVED delta(kind=head bytes=1792) from S14
[S6] cosine check vs S14: cos=0.5866
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.7943
[S10] RECEIVED delta(kind=head bytes=1796) from S2
[S10] cosine check vs S2: cos=0.7603
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.7886
[S3] RECEIVED delta(kind=head bytes=1806) from S9
[S3] cosine check vs S9: cos=0.4222
[S7] RECEIVED delta(kind=head bytes=1796) from S11
[S7] cosine check vs S11: cos=-0.0376
[S7] DROPPED delta from S11 (cos=-0.0376 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9652
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=0.9291
[S15] RECEIVED delta(kind=head bytes=1793) from S3
[S15] cosine check vs S3: cos=-0.0235
[S15] DROPPED delta from S3 (cos=-0.0235 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.8907
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=12 metric=0.6246 head_norm=1.193656
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.883857e-01
[S6] stored merged vector for next round verification (round=12)
[S6] DEBUG after merge:  round=12 metric=0.7984 head_norm=1.167705 delta_norm=0.188386
[S6] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.9966 head_norm=1.322518
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.932563e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.9965 head_norm=1.462771 delta_norm=0.393256
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7015 head_norm=1.465130
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.930284e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7015 head_norm=1.451029 delta_norm=0.193028
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7013 head_norm=1.431829
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.397489e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7025 head_norm=1.448452 delta_norm=0.239749
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.7006 head_norm=0.887602
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.775624e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.7003 head_norm=1.004057 delta_norm=0.677562
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.9939 head_norm=1.075359
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.650679e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.9937 head_norm=1.177700 delta_norm=0.465068
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.4167 head_norm=1.078801
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.502080e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.3741 head_norm=1.018557 delta_norm=0.350208
[S7] aggregate: ROLLBACK (f1_val pre=0.417 post=0.374 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.8528 head_norm=1.200265
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.226702e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.8407 head_norm=1.119215 delta_norm=0.222670
[S15] aggregate: ROLLBACK (f1_val pre=0.853 post=0.841 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.448452 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.6420312481335787, 'auprc': 0.6487543697486364, 'loss_val': 0.5681348297898678, 'psi': 0.6447204967796019}-{'f1_val': 0.7013120848906231, 'auprc': 0.700083248130859, 'loss_val': 0.35387833030099447, 'psi': 0.7008205501867175}
[S3] START round=13 head_norm_before_train=1.004057 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6995786553134029, 'auprc': 0.7890880888730809, 'loss_val': 0.6501635132449781, 'psi': 0.7353824287372741}-{'f1_val': 0.7005769689796157, 'auprc': 0.998451376309912, 'loss_val': 0.5193778708650895, 'psi': 0.8197267319117343}
[S4] START round=13 head_norm_before_train=1.503612 cos_to_last_merge=0.8517 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.852
[S4] round=13 local utility u=0.027716 metrics={'f1_val': 0.9516053128468718, 'auprc': 0.9507811379253941, 'loss_val': 0.2970713605015075, 'psi': 0.9512756428782807}-{'f1_val': 0.9487892510340579, 'auprc': 0.9470180590143991, 'loss_val': 0.3243179453475898, 'psi': 0.9480807742261943}
[S5] START round=13 head_norm_before_train=1.462492 (no previous merge yet)
[S5] round=13 local utility u=0.691780 metrics={'f1_val': 0.6831269136642419, 'auprc': 0.8074455550795021, 'loss_val': 0.5226474579466305, 'psi': 0.732854370230346}-{'f1_val': 0.440196730451659, 'auprc': 0.8607827815926451, 'loss_val': 0.6086383850149719, 'psi': 0.6084311509080534}
[S6] START round=13 head_norm_before_train=1.167705 cos_to_last_merge=1.0000 (last merge round=12)
[S6] round=13 local utility u=0.848718 metrics={'f1_val': 0.8591337929941834, 'auprc': 0.9417799456474241, 'loss_val': 0.5257418199466966, 'psi': 0.8921922540554796}-{'f1_val': 0.6246025779536656, 'auprc': 0.8662229586899743, 'loss_val': 0.5893186893078161, 'psi': 0.7212507302481892}
[S7] START round=13 head_norm_before_train=1.018557 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.416587999573199, 'auprc': 0.7755356404438084, 'loss_val': 0.8071027143712185, 'psi': 0.5601670559214428}-{'f1_val': 0.41671011811102343, 'auprc': 0.806756545910845, 'loss_val': 0.8103978142173085, 'psi': 0.572728689230952}
[S8] START round=13 head_norm_before_train=1.462771 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.013837 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9938732936803121, 'loss_val': 0.15328126966852282, 'psi': 0.9955332420607845}-{'f1_val': 0.9966398743144329, 'auprc': 0.9933232950536411, 'loss_val': 0.17930529269699333, 'psi': 0.9953132426101161}
[S9] START round=13 head_norm_before_train=1.451029 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.004810 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987291138383223, 'loss_val': 0.2679986789271249, 'psi': 0.8204160440564922}-{'f1_val': 0.7015406642019387, 'auprc': 0.99884514433319, 'loss_val': 0.27796749383945324, 'psi': 0.8204624562544393}
[S10] START round=13 head_norm_before_train=1.177700 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.9935760440666346, 'auprc': 0.9923902866048361, 'loss_val': 0.32586100673985263, 'psi': 0.9931017410819152}-{'f1_val': 0.9939338690605257, 'auprc': 0.9967396469561716, 'loss_val': 0.2722213020992767, 'psi': 0.9950561802187841}
[S11] START round=13 head_norm_before_train=1.658612 (no previous merge yet)
[S11] round=13 local utility u=0.549261 metrics={'f1_val': 0.9574176418412194, 'auprc': 0.9963742972159977, 'loss_val': 0.20629125979733726, 'psi': 0.9730003039911307}-{'f1_val': 0.7810972944898256, 'auprc': 0.9964100091652377, 'loss_val': 0.24699862825035906, 'psi': 0.8672223803599904}
[S13] START round=13 head_norm_before_train=1.598097 (no previous merge yet)
[S13] round=13 local utility u=0.323918 metrics={'f1_val': 0.6227796877301415, 'auprc': 0.7236621663524145, 'loss_val': 0.6228802255809976, 'psi': 0.6631326791790506}-{'f1_val': 0.5650747319332821, 'auprc': 0.6915989884748113, 'loss_val': 0.8282973124229462, 'psi': 0.6156844345498937}
[S14] START round=13 head_norm_before_train=1.683576 (no previous merge yet)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.9974331919232962, 'auprc': 0.9956353474417463, 'loss_val': 0.20009107766121284, 'psi': 0.9967140541306763}-{'f1_val': 0.9979135742335156, 'auprc': 0.9956358469666149, 'loss_val': 0.2013379057067299, 'psi': 0.9970024833267552}
[S15] START round=13 head_norm_before_train=1.119215 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.487554 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9987948059065418, 'loss_val': 0.12431071822026861, 'psi': 0.9978243255693887}-{'f1_val': 0.852774600112389, 'auprc': 0.9976806719257886, 'loss_val': 0.22965979795062852, 'psi': 0.9107370288377489}
[S16] START round=13 head_norm_before_train=1.558151 (no previous merge yet)
[S16] round=13 local utility u=0.043561 metrics={'f1_val': 0.5479079884399206, 'auprc': 0.7624520634489109, 'loss_val': 0.808899049525325, 'psi': 0.6337256184435167}-{'f1_val': 0.5354519587498605, 'auprc': 0.7609951449555861, 'loss_val': 0.816913532662551, 'psi': 0.6256692332321507}
[S17] START round=13 head_norm_before_train=1.685124 (no previous merge yet)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.7096674572029895, 'auprc': 0.9809637961787248, 'loss_val': 0.43920874351445466, 'psi': 0.8181859927932836}-{'f1_val': 0.7110988298093349, 'auprc': 0.9812769994629942, 'loss_val': 0.3877854172359827, 'psi': 0.8191700976707986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S5] not sending this round → trigger blocked (psi=0.733)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.634)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S11] not sending this round → trigger blocked (psi=0.973)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=0.2276
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=0.4768
[S8] RECEIVED delta(kind=head bytes=1799) from S6
[S8] cosine check vs S6: cos=0.0103
[S15] RECEIVED delta(kind=head bytes=1802) from S13
[S15] cosine check vs S13: cos=-0.1005
[S15] DROPPED delta from S13 (cos=-0.1005 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.6996 head_norm=1.037324
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.212990e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.7008 head_norm=1.017849 delta_norm=0.821299
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9936 head_norm=1.236065
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.241443e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9953 head_norm=1.048403 delta_norm=0.624144
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.9966 head_norm=1.531358
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.762974e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.9965 head_norm=0.986116 delta_norm=0.976297
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.492831 cos_to_last_merge=0.9989 (last merge round=12)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.5663232360162258, 'auprc': 0.6195275741598517, 'loss_val': 0.8920085385950925, 'psi': 0.5876049712736762}-{'f1_val': 0.6420312481335787, 'auprc': 0.6487543697486364, 'loss_val': 0.5681348297898678, 'psi': 0.6447204967796019}
[S3] START round=14 head_norm_before_train=1.017849 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.306725 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9725315224587079, 'loss_val': 0.5930342965082656, 'psi': 0.8093587903712526}-{'f1_val': 0.6995786553134029, 'auprc': 0.7890880888730809, 'loss_val': 0.6501635132449781, 'psi': 0.7353824287372741}
[S4] START round=14 head_norm_before_train=1.544456 cos_to_last_merge=0.8449 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.845
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9411375476777901, 'auprc': 0.9231295560176312, 'loss_val': 0.31628072000103424, 'psi': 0.9339343510137266}-{'f1_val': 0.9516053128468718, 'auprc': 0.9507811379253941, 'loss_val': 0.2970713605015075, 'psi': 0.9512756428782807}
[S5] START round=14 head_norm_before_train=1.490705 (no previous merge yet)
[S5] round=14 local utility u=0.096968 metrics={'f1_val': 0.7011046720655897, 'auprc': 0.8010990153006254, 'loss_val': 0.4175383286888576, 'psi': 0.7411024093596039}-{'f1_val': 0.6831269136642419, 'auprc': 0.8074455550795021, 'loss_val': 0.5226474579466305, 'psi': 0.732854370230346}
[S6] START round=14 head_norm_before_train=1.227235 cos_to_last_merge=0.9944 (last merge round=12)
[S6] round=14 local utility u=0.456930 metrics={'f1_val': 0.9578113747937254, 'auprc': 0.97307058065306, 'loss_val': 0.2978200888785994, 'psi': 0.9639150571374593}-{'f1_val': 0.8591337929941834, 'auprc': 0.9417799456474241, 'loss_val': 0.5257418199466966, 'psi': 0.8921922540554796}
[S7] START round=14 head_norm_before_train=1.050543 cos_to_last_merge=0.9986 (last merge round=12)
[S7] round=14 local utility u=0.810897 metrics={'f1_val': 0.6746077499379175, 'auprc': 0.7843693781057689, 'loss_val': 0.7599281575296564, 'psi': 0.7185124012050581}-{'f1_val': 0.416587999573199, 'auprc': 0.7755356404438084, 'loss_val': 0.8071027143712185, 'psi': 0.5601670559214428}
[S8] START round=14 head_norm_before_train=0.986116 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.992340909331483, 'loss_val': 0.2706097169182566, 'psi': 0.9948303883709949}-{'f1_val': 0.9966398743144329, 'auprc': 0.9938732936803121, 'loss_val': 0.15328126966852282, 'psi': 0.9955332420607845}
[S9] START round=14 head_norm_before_train=1.484708 cos_to_last_merge=0.9985 (last merge round=12)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9912613852739514, 'loss_val': 0.2824287835244587, 'psi': 0.8174289526307438}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987291138383223, 'loss_val': 0.2679986789271249, 'psi': 0.8204160440564922}
[S10] START round=14 head_norm_before_train=1.048403 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.073861 metrics={'f1_val': 0.9938179510906369, 'auprc': 0.9932866831860593, 'loss_val': 0.18227891851572875, 'psi': 0.9936054439288058}-{'f1_val': 0.9935760440666346, 'auprc': 0.9923902866048361, 'loss_val': 0.32586100673985263, 'psi': 0.9931017410819152}
[S11] START round=14 head_norm_before_train=1.694885 (no previous merge yet)
[S11] round=14 local utility u=0.029706 metrics={'f1_val': 0.9588070359710429, 'auprc': 0.9965380779013165, 'loss_val': 0.15570659654412933, 'psi': 0.9738994527431524}-{'f1_val': 0.9574176418412194, 'auprc': 0.9963742972159977, 'loss_val': 0.20629125979733726, 'psi': 0.9730003039911307}
[S13] START round=14 head_norm_before_train=1.616552 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5710088423672365, 'auprc': 0.7610587225987269, 'loss_val': 0.8251917051895666, 'psi': 0.6470287944598327}-{'f1_val': 0.6227796877301415, 'auprc': 0.7236621663524145, 'loss_val': 0.6228802255809976, 'psi': 0.6631326791790506}
[S14] START round=14 head_norm_before_train=1.717667 (no previous merge yet)
[S14] round=14 local utility u=0.047768 metrics={'f1_val': 0.997476613247938, 'auprc': 0.9969764831508644, 'loss_val': 0.10883953518038947, 'psi': 0.9972765612091086}-{'f1_val': 0.9974331919232962, 'auprc': 0.9956353474417463, 'loss_val': 0.20009107766121284, 'psi': 0.9967140541306763}
[S15] START round=14 head_norm_before_train=1.203973 cos_to_last_merge=0.9974 (last merge round=12)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.90006571279142, 'auprc': 0.9974154099652882, 'loss_val': 0.24565868680380007, 'psi': 0.9390055916609673}-{'f1_val': 0.9971773386779533, 'auprc': 0.9987948059065418, 'loss_val': 0.12431071822026861, 'psi': 0.9978243255693887}
[S16] START round=14 head_norm_before_train=1.592676 (no previous merge yet)
[S16] round=14 local utility u=0.866951 metrics={'f1_val': 0.8212592491716975, 'auprc': 0.773767380932956, 'loss_val': 0.7490510620446588, 'psi': 0.8022625018762009}-{'f1_val': 0.5479079884399206, 'auprc': 0.7624520634489109, 'loss_val': 0.808899049525325, 'psi': 0.6337256184435167}
[S17] START round=14 head_norm_before_train=1.721081 (no previous merge yet)
[S17] round=14 local utility u=0.795588 metrics={'f1_val': 0.9347172834040814, 'auprc': 0.9814238380449116, 'loss_val': 0.19971174340586847, 'psi': 0.9533999052604135}-{'f1_val': 0.7096674572029895, 'auprc': 0.9809637961787248, 'loss_val': 0.43920874351445466, 'psi': 0.8181859927932836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.964)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39410
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1796) from S7
[S15] cosine check vs S7: cos=0.8835
[S15] RECEIVED delta(kind=head bytes=1797) from S3
[S15] cosine check vs S3: cos=0.0504
[S7] RECEIVED delta(kind=head bytes=1798) from S10
[S7] cosine check vs S10: cos=0.9732
[S7] RECEIVED delta(kind=head bytes=1805) from S11
[S7] cosine check vs S11: cos=-0.0184
[S7] DROPPED delta from S11 (cos=-0.0184 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=0.9744
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.6883
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=0.6928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S17
[S8] cosine check vs S17: cos=0.6921
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7015 head_norm=1.518002
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.715908e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7015 head_norm=1.506836 delta_norm=0.171591
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.9578 head_norm=1.299294
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.951965e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.9577 head_norm=1.245477 delta_norm=0.195196
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.9965 head_norm=1.071882
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.374946e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.9962 head_norm=1.307053 delta_norm=0.637495
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6746 head_norm=1.083568
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.322958e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.7134 head_norm=1.106014 delta_norm=0.132296
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.9001 head_norm=1.275445
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.829397e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.9001 head_norm=0.936759 delta_norm=0.482940
[S15] aggregate: ACCEPT kept=['S7', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.529927 cos_to_last_merge=0.9970 (last merge round=12)
[S2] round=15 local utility u=0.853050 metrics={'f1_val': 0.7012605470706996, 'auprc': 0.7544291579639315, 'loss_val': 0.40023731245371, 'psi': 0.7225279914279924}-{'f1_val': 0.5663232360162258, 'auprc': 0.6195275741598517, 'loss_val': 0.8920085385950925, 'psi': 0.5876049712736762}
[S3] START round=15 head_norm_before_train=1.050429 cos_to_last_merge=0.9961 (last merge round=13)
[S3] round=15 local utility u=0.085209 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9951770179202182, 'loss_val': 0.4905785596655413, 'psi': 0.8184196447633403}-{'f1_val': 0.7005769689796157, 'auprc': 0.9725315224587079, 'loss_val': 0.5930342965082656, 'psi': 0.8093587903712526}
[S4] START round=15 head_norm_before_train=1.584744 cos_to_last_merge=0.8388 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.839
[S4] round=15 local utility u=0.037071 metrics={'f1_val': 0.9439720369351092, 'auprc': 0.9369444061009219, 'loss_val': 0.3005903886768334, 'psi': 0.9411609846014343}-{'f1_val': 0.9411375476777901, 'auprc': 0.9231295560176312, 'loss_val': 0.31628072000103424, 'psi': 0.9339343510137266}
[S5] START round=15 head_norm_before_train=1.515145 (no previous merge yet)
[S5] round=15 local utility u=0.007023 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7953035572782627, 'loss_val': 0.3846204404943522, 'psi': 0.7386355930008244}-{'f1_val': 0.7011046720655897, 'auprc': 0.8010990153006254, 'loss_val': 0.4175383286888576, 'psi': 0.7411024093596039}
[S6] START round=15 head_norm_before_train=1.245477 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.584430727895235, 'auprc': 0.7783633011662889, 'loss_val': 0.8238963526078698, 'psi': 0.6620037572036566}-{'f1_val': 0.9578113747937254, 'auprc': 0.97307058065306, 'loss_val': 0.2978200888785994, 'psi': 0.9639150571374593}
[S7] START round=15 head_norm_before_train=1.106014 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.139590 metrics={'f1_val': 0.7068715797417956, 'auprc': 0.7809458312764574, 'loss_val': 0.6640599580848425, 'psi': 0.7365012803556603}-{'f1_val': 0.6746077499379175, 'auprc': 0.7843693781057689, 'loss_val': 0.7599281575296564, 'psi': 0.7185124012050581}
[S8] START round=15 head_norm_before_train=1.307053 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.066333 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9962358535416108, 'loss_val': 0.14790707714490722, 'psi': 0.9962162034567361}-{'f1_val': 0.9964900410640029, 'auprc': 0.992340909331483, 'loss_val': 0.2706097169182566, 'psi': 0.9948303883709949}
[S9] START round=15 head_norm_before_train=1.506836 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.051263 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984821239089778, 'loss_val': 0.20156486431990336, 'psi': 0.8203172480847544}-{'f1_val': 0.7015406642019387, 'auprc': 0.9912613852739514, 'loss_val': 0.2824287835244587, 'psi': 0.8174289526307438}
[S10] START round=15 head_norm_before_train=1.143424 cos_to_last_merge=0.9966 (last merge round=13)
[S10] round=15 local utility u=0.035640 metrics={'f1_val': 0.9937469452882055, 'auprc': 0.9965617481144662, 'loss_val': 0.12039713472788668, 'psi': 0.9948728664187098}-{'f1_val': 0.9938179510906369, 'auprc': 0.9932866831860593, 'loss_val': 0.18227891851572875, 'psi': 0.9936054439288058}
[S11] START round=15 head_norm_before_train=1.729040 (no previous merge yet)
[S11] round=15 local utility u=0.129431 metrics={'f1_val': 0.9972197021476874, 'auprc': 0.9966907863427465, 'loss_val': 0.12777861243990682, 'psi': 0.997008135825711}-{'f1_val': 0.9588070359710429, 'auprc': 0.9965380779013165, 'loss_val': 0.15570659654412933, 'psi': 0.9738994527431524}
[S13] START round=15 head_norm_before_train=1.633498 (no previous merge yet)
[S13] round=15 local utility u=0.015796 metrics={'f1_val': 0.5831289379741228, 'auprc': 0.7324274481549373, 'loss_val': 0.7804267928651563, 'psi': 0.6428483420464486}-{'f1_val': 0.5710088423672365, 'auprc': 0.7610587225987269, 'loss_val': 0.8251917051895666, 'psi': 0.6470287944598327}
[S14] START round=15 head_norm_before_train=1.750960 (no previous merge yet)
[S14] round=15 local utility u=0.012451 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.995634190571614, 'loss_val': 0.0786269917953671, 'psi': 0.9966112923337761}-{'f1_val': 0.997476613247938, 'auprc': 0.9969764831508644, 'loss_val': 0.10883953518038947, 'psi': 0.9972765612091086}
[S15] START round=15 head_norm_before_train=0.936759 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.142676 metrics={'f1_val': 0.9410904005965401, 'auprc': 0.9984140250763354, 'loss_val': 0.20945015218734708, 'psi': 0.9640198503884583}-{'f1_val': 0.90006571279142, 'auprc': 0.9974154099652882, 'loss_val': 0.24565868680380007, 'psi': 0.9390055916609673}
[S16] START round=15 head_norm_before_train=1.621419 (no previous merge yet)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.7459471748798062, 'auprc': 0.7988847366750843, 'loss_val': 0.643002009189494, 'psi': 0.7671221995979175}-{'f1_val': 0.8212592491716975, 'auprc': 0.773767380932956, 'loss_val': 0.7490510620446588, 'psi': 0.8022625018762009}
[S17] START round=15 head_norm_before_train=1.755176 (no previous merge yet)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.6814282109663383, 'auprc': 0.9621184433845035, 'loss_val': 0.6678454498502285, 'psi': 0.7937043039336045}-{'f1_val': 0.9347172834040814, 'auprc': 0.9814238380449116, 'loss_val': 0.19971174340586847, 'psi': 0.9533999052604135}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.737)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39403
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39411
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39415
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39402
[S5] not sending this round → trigger blocked (psi=0.739)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:39403
[S3] not sending this round → trigger blocked (psi=0.818)
[S8] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1792) from S8
[S3] cosine check vs S8: cos=0.8021
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.4245
[S10] RECEIVED delta(kind=head bytes=1797) from S2
[S10] cosine check vs S2: cos=0.5907
[S10] RECEIVED delta(kind=head bytes=1797) from S15
[S10] cosine check vs S15: cos=0.8609
[S15] RECEIVED delta(kind=head bytes=1797) from S13
[S15] cosine check vs S13: cos=-0.0902
[S15] DROPPED delta from S13 (cos=-0.0902 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1800) from S4
[S2] cosine check vs S4: cos=0.9626
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9937 head_norm=1.217203
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.862275e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9937 head_norm=1.085503 delta_norm=0.286227
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.184 → S7@127.0.0.1:39408
[S7] ⇄ pheromone p=0.259 → S15@127.0.0.1:39415
[S5] ⇄ pheromone p=0.185 → S9@127.0.0.1:39410
[S6] ⇄ pheromone p=0.276 → S8@127.0.0.1:39409
[S14] ⇄ pheromone p=0.161 → S6@127.0.0.1:39407
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.7006 head_norm=1.096409
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.828695e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.7008 head_norm=1.023799 delta_norm=0.282869
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.216 → S15@127.0.0.1:39415
[S11] ⇄ pheromone p=0.253 → S7@127.0.0.1:39408
[S4] ⇄ pheromone p=0.155 → S2@127.0.0.1:39402
[S9] ⇄ pheromone p=0.096 → S3@127.0.0.1:39403
[S8] ⇄ pheromone p=0.154 → S3@127.0.0.1:39403
[S13] ⇄ pheromone p=0.130 → S15@127.0.0.1:39415
[S15] ⇄ pheromone p=0.214 → S10@127.0.0.1:39411
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7013 head_norm=1.555601
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.195700e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7075 head_norm=1.572771 delta_norm=0.219570
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.251 → S10@127.0.0.1:39411
[S17] ⇄ pheromone p=0.278 → S8@127.0.0.1:39409
[S16] ⇄ pheromone p=0.276 → S6@127.0.0.1:39407
[S2] START round=16 head_norm_before_train=1.572771 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7086548316459532, 'auprc': 0.7463149004612135, 'loss_val': 0.45038418140308123, 'psi': 0.7237188591720574}-{'f1_val': 0.7012605470706996, 'auprc': 0.7544291579639315, 'loss_val': 0.40023731245371, 'psi': 0.7225279914279924}
[S3] START round=16 head_norm_before_train=1.023799 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9966179071294936, 'loss_val': 0.519883067702645, 'psi': 0.8189960004470505}-{'f1_val': 0.7005813959920884, 'auprc': 0.9951770179202182, 'loss_val': 0.4905785596655413, 'psi': 0.8184196447633403}
[S4] START round=16 head_norm_before_train=1.619797 cos_to_last_merge=0.8344 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.834
[S4] round=16 local utility u=0.024233 metrics={'f1_val': 0.9479255957707406, 'auprc': 0.9452146819873604, 'loss_val': 0.30065634495284405, 'psi': 0.9468412302573885}-{'f1_val': 0.9439720369351092, 'auprc': 0.9369444061009219, 'loss_val': 0.3005903886768334, 'psi': 0.9411609846014343}
[S5] START round=16 head_norm_before_train=1.534925 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7008563225598777, 'auprc': 0.7930237742674797, 'loss_val': 0.39033952764920443, 'psi': 0.7377233032429185}-{'f1_val': 0.7008569501491988, 'auprc': 0.7953035572782627, 'loss_val': 0.3846204404943522, 'psi': 0.7386355930008244}
[S6] START round=16 head_norm_before_train=1.304402 cos_to_last_merge=0.9974 (last merge round=14)
[S6] round=16 local utility u=0.649533 metrics={'f1_val': 0.6976225454179952, 'auprc': 0.8463478046808164, 'loss_val': 0.4079349790977425, 'psi': 0.7571126491231237}-{'f1_val': 0.584430727895235, 'auprc': 0.7783633011662889, 'loss_val': 0.8238963526078698, 'psi': 0.6620037572036566}
[S7] START round=16 head_norm_before_train=1.139317 cos_to_last_merge=0.9990 (last merge round=14)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.3778853612367726, 'auprc': 0.861413709282411, 'loss_val': 0.8896328883365457, 'psi': 0.571296700455028}-{'f1_val': 0.7068715797417956, 'auprc': 0.7809458312764574, 'loss_val': 0.6640599580848425, 'psi': 0.7365012803556603}
[S8] START round=16 head_norm_before_train=1.389759 cos_to_last_merge=0.9939 (last merge round=14)
[S8] round=16 local utility u=0.027673 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9985295677372217, 'loss_val': 0.10206309695862145, 'psi': 0.9973957516835483}-{'f1_val': 0.9962031034001528, 'auprc': 0.9962358535416108, 'loss_val': 0.14790707714490722, 'psi': 0.9962162034567361}
[S9] START round=16 head_norm_before_train=1.534482 cos_to_last_merge=0.9995 (last merge round=14)
[S9] round=16 local utility u=0.909888 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984971544058922, 'loss_val': 0.157673441599777, 'psi': 0.9979071522164034}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984821239089778, 'loss_val': 0.20156486431990336, 'psi': 0.8203172480847544}
[S10] START round=16 head_norm_before_train=1.085503 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9935523847669312, 'auprc': 0.996460648228261, 'loss_val': 0.16104806082388484, 'psi': 0.9947156901514631}-{'f1_val': 0.9937469452882055, 'auprc': 0.9965617481144662, 'loss_val': 0.12039713472788668, 'psi': 0.9948728664187098}
[S11] START round=16 head_norm_before_train=1.760630 (no previous merge yet)
[S11] round=16 local utility u=0.005988 metrics={'f1_val': 0.9968299761244085, 'auprc': 0.9978893809346432, 'loss_val': 0.11705940312455414, 'psi': 0.9972537380485025}-{'f1_val': 0.9972197021476874, 'auprc': 0.9966907863427465, 'loss_val': 0.12777861243990682, 'psi': 0.997008135825711}
[S13] START round=16 head_norm_before_train=1.654308 (no previous merge yet)
[S13] round=16 local utility u=0.218356 metrics={'f1_val': 0.6109482800575055, 'auprc': 0.7757005601718545, 'loss_val': 0.6404508405039714, 'psi': 0.6768491921032451}-{'f1_val': 0.5831289379741228, 'auprc': 0.7324274481549373, 'loss_val': 0.7804267928651563, 'psi': 0.6428483420464486}
[S14] START round=16 head_norm_before_train=1.784849 (no previous merge yet)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9920419053970886, 'auprc': 0.9969764468609633, 'loss_val': 0.06922973441990596, 'psi': 0.9940157219826384}-{'f1_val': 0.9972626935085508, 'auprc': 0.995634190571614, 'loss_val': 0.0786269917953671, 'psi': 0.9966112923337761}
[S15] START round=16 head_norm_before_train=1.025186 cos_to_last_merge=0.9960 (last merge round=14)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.8928410123055742, 'auprc': 0.9972084161354219, 'loss_val': 0.1950810320115036, 'psi': 0.9345879738375132}-{'f1_val': 0.9410904005965401, 'auprc': 0.9984140250763354, 'loss_val': 0.20945015218734708, 'psi': 0.9640198503884583}
[S16] START round=16 head_norm_before_train=1.650595 (no previous merge yet)
[S16] round=16 local utility u=0.273917 metrics={'f1_val': 0.8398992890540691, 'auprc': 0.811725225741321, 'loss_val': 0.6974021326528587, 'psi': 0.8286296637289698}-{'f1_val': 0.7459471748798062, 'auprc': 0.7988847366750843, 'loss_val': 0.643002009189494, 'psi': 0.7671221995979175}
[S17] START round=16 head_norm_before_train=1.770497 (no previous merge yet)
[S17] round=16 local utility u=0.101701 metrics={'f1_val': 0.6917875125372651, 'auprc': 0.98476210071159, 'loss_val': 0.5945302547042102, 'psi': 0.808977347806995}-{'f1_val': 0.6814282109663383, 'auprc': 0.9621184433845035, 'loss_val': 0.6678454498502285, 'psi': 0.7937043039336045}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.677)
[S4] not sending this round → trigger blocked (psi=0.947)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.998)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39409
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39408
[S11] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S11
[S7] cosine check vs S11: cos=-0.0299
[S7] DROPPED delta from S11 (cos=-0.0299 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1806) from S16
[S6] cosine check vs S16: cos=0.6634
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] cosine check vs S6: cos=0.1922
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.9179
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=16 metric=0.9966 head_norm=1.453001
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.651273e-01
[S8] stored merged vector for next round verification (round=16)
[S8] DEBUG after merge:  round=16 metric=0.9966 head_norm=1.228421 delta_norm=0.365127
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=16 metric=0.6976 head_norm=1.351122
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.404322e-01
[S6] stored merged vector for next round verification (round=16)
[S6] DEBUG after merge:  round=16 metric=0.8408 head_norm=1.385099 delta_norm=0.640432
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.598840 cos_to_last_merge=0.9997 (last merge round=15)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6277394015505052, 'auprc': 0.7098942240447121, 'loss_val': 0.7173057211337801, 'psi': 0.6606013305481879}-{'f1_val': 0.7086548316459532, 'auprc': 0.7463149004612135, 'loss_val': 0.45038418140308123, 'psi': 0.7237188591720574}
[S3] START round=17 head_norm_before_train=1.062788 cos_to_last_merge=0.9958 (last merge round=15)
[S3] round=17 local utility u=0.053882 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9958112157105591, 'loss_val': 0.41074756896576203, 'psi': 0.8187782085254034}-{'f1_val': 0.7005813959920884, 'auprc': 0.9966179071294936, 'loss_val': 0.519883067702645, 'psi': 0.8189960004470505}
[S4] START round=17 head_norm_before_train=1.647051 cos_to_last_merge=0.8320 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=17 local utility u=0.029822 metrics={'f1_val': 0.950491103897307, 'auprc': 0.9579227005887706, 'loss_val': 0.29452991770613624, 'psi': 0.9534637425738923}-{'f1_val': 0.9479255957707406, 'auprc': 0.9452146819873604, 'loss_val': 0.30065634495284405, 'psi': 0.9468412302573885}
[S5] START round=17 head_norm_before_train=1.552472 (no previous merge yet)
[S5] round=17 local utility u=0.306376 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9748420788536605, 'loss_val': 0.3230460590254161, 'psi': 0.8104510016309834}-{'f1_val': 0.7008563225598777, 'auprc': 0.7930237742674797, 'loss_val': 0.39033952764920443, 'psi': 0.7377233032429185}
[S6] START round=17 head_norm_before_train=1.385099 cos_to_last_merge=1.0000 (last merge round=16)
[S6] round=17 local utility u=0.159663 metrics={'f1_val': 0.7948202248335384, 'auprc': 0.8102667291870578, 'loss_val': 0.5635514503642446, 'psi': 0.8009988265749461}-{'f1_val': 0.6976225454179952, 'auprc': 0.8463478046808164, 'loss_val': 0.4079349790977425, 'psi': 0.7571126491231237}
[S7] START round=17 head_norm_before_train=1.171827 cos_to_last_merge=0.9964 (last merge round=14)
[S7] round=17 local utility u=0.621472 metrics={'f1_val': 0.5827456981740103, 'auprc': 0.8112316791215998, 'loss_val': 0.7253055397569824, 'psi': 0.6741400905530461}-{'f1_val': 0.3778853612367726, 'auprc': 0.861413709282411, 'loss_val': 0.8896328883365457, 'psi': 0.571296700455028}
[S8] START round=17 head_norm_before_train=1.228421 cos_to_last_merge=1.0000 (last merge round=16)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9980172740972776, 'loss_val': 0.14659393918919522, 'psi': 0.9971908342275707}-{'f1_val': 0.9966398743144329, 'auprc': 0.9985295677372217, 'loss_val': 0.10206309695862145, 'psi': 0.9973957516835483}
[S9] START round=17 head_norm_before_train=1.562820 cos_to_last_merge=0.9981 (last merge round=14)
[S9] round=17 local utility u=0.013314 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9984967037668127, 'loss_val': 0.12856095438749182, 'psi': 0.9976587112302631}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984971544058922, 'loss_val': 0.157673441599777, 'psi': 0.9979071522164034}
[S10] START round=17 head_norm_before_train=1.132292 cos_to_last_merge=0.9990 (last merge round=15)
[S10] round=17 local utility u=0.005936 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9916689133209837, 'loss_val': 0.13489472019178694, 'psi': 0.9928083591475502}-{'f1_val': 0.9935523847669312, 'auprc': 0.996460648228261, 'loss_val': 0.16104806082388484, 'psi': 0.9947156901514631}
[S11] START round=17 head_norm_before_train=1.788857 (no previous merge yet)
[S11] round=17 local utility u=0.010900 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9969537992856891, 'loss_val': 0.09087674761105036, 'psi': 0.9967220020980039}-{'f1_val': 0.9968299761244085, 'auprc': 0.9978893809346432, 'loss_val': 0.11705940312455414, 'psi': 0.9972537380485025}
[S13] START round=17 head_norm_before_train=1.669522 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5741026201385052, 'auprc': 0.7921985304748933, 'loss_val': 0.8557070480826364, 'psi': 0.6613409842730604}-{'f1_val': 0.6109482800575055, 'auprc': 0.7757005601718545, 'loss_val': 0.6404508405039714, 'psi': 0.6768491921032451}
[S14] START round=17 head_norm_before_train=1.815692 (no previous merge yet)
[S14] round=17 local utility u=0.007755 metrics={'f1_val': 0.9936582147731836, 'auprc': 0.9986739886438645, 'loss_val': 0.06850969097777303, 'psi': 0.9956645243214559}-{'f1_val': 0.9920419053970886, 'auprc': 0.9969764468609633, 'loss_val': 0.06922973441990596, 'psi': 0.9940157219826384}
[S15] START round=17 head_norm_before_train=1.131519 cos_to_last_merge=0.9852 (last merge round=14)
[S15] round=17 local utility u=0.254303 metrics={'f1_val': 0.9638410027745292, 'auprc': 0.9988255415751226, 'loss_val': 0.11732618645393936, 'psi': 0.9778348182947666}-{'f1_val': 0.8928410123055742, 'auprc': 0.9972084161354219, 'loss_val': 0.1950810320115036, 'psi': 0.9345879738375132}
[S16] START round=17 head_norm_before_train=1.682787 (no previous merge yet)
[S16] round=17 local utility u=0.413674 metrics={'f1_val': 0.9038479982721637, 'auprc': 0.8832228517271132, 'loss_val': 0.46823842445015346, 'psi': 0.8955979396541436}-{'f1_val': 0.8398992890540691, 'auprc': 0.811725225741321, 'loss_val': 0.6974021326528587, 'psi': 0.8286296637289698}
[S17] START round=17 head_norm_before_train=1.780073 (no previous merge yet)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.6908050825825505, 'auprc': 0.9770653253557745, 'loss_val': 0.6931901644039992, 'psi': 0.8053091796918401}-{'f1_val': 0.6917875125372651, 'auprc': 0.98476210071159, 'loss_val': 0.5945302547042102, 'psi': 0.808977347806995}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:39402
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[S6] not sending this round → trigger blocked (psi=0.801)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S16] not sending this round → trigger blocked (psi=0.896)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39403
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1794) from S3
[S15] cosine check vs S3: cos=0.2363
[S10] RECEIVED delta(kind=head bytes=1802) from S15
[S10] cosine check vs S15: cos=0.7738
[S2] RECEIVED delta(kind=head bytes=1805) from S4
[S2] cosine check vs S4: cos=0.9843
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.9795
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.9476
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.5748
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.8531
[S6] RECEIVED delta(kind=head bytes=1797) from S14
[S6] cosine check vs S14: cos=0.4053
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=17 metric=0.7948 head_norm=1.429095
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.085649e-01
[S6] stored merged vector for next round verification (round=17)
[S6] DEBUG after merge:  round=17 metric=0.8139 head_norm=1.375703 delta_norm=0.908565
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.6277 head_norm=1.627612
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.469449e-01
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.6244 head_norm=1.639079 delta_norm=0.146945
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9638 head_norm=1.218086
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.912966e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.9643 head_norm=0.966740 delta_norm=0.391297
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9936 head_norm=1.183392
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.041294e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9947 head_norm=1.130820 delta_norm=0.404129
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5827 head_norm=1.196655
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.928118e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.4922 head_norm=1.174318 delta_norm=0.192812
[S7] aggregate: ROLLBACK (f1_val pre=0.583 post=0.492 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9971 head_norm=1.593051
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.605018e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9967 head_norm=1.573532 delta_norm=0.160502
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=1.109732
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.589519e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7005 head_norm=1.204342 delta_norm=0.658952
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.639079 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.005970 metrics={'f1_val': 0.6369511325301009, 'auprc': 0.7130447959921387, 'loss_val': 0.7700872699208886, 'psi': 0.667388597914916}-{'f1_val': 0.6277394015505052, 'auprc': 0.7098942240447121, 'loss_val': 0.7173057211337801, 'psi': 0.6606013305481879}
[S3] START round=18 head_norm_before_train=1.204342 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9958625138571036, 'loss_val': 0.4656425580791886, 'psi': 0.8187987277840212}-{'f1_val': 0.7007562037352997, 'auprc': 0.9958112157105591, 'loss_val': 0.41074756896576203, 'psi': 0.8187782085254034}
[S4] START round=18 head_norm_before_train=1.663499 cos_to_last_merge=0.8309 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9480125140988614, 'auprc': 0.9443944159769487, 'loss_val': 0.3043269501545773, 'psi': 0.9465652748500963}-{'f1_val': 0.950491103897307, 'auprc': 0.9579227005887706, 'loss_val': 0.29452991770613624, 'psi': 0.9534637425738923}
[S5] START round=18 head_norm_before_train=1.570260 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7035343687672289, 'auprc': 0.7912874415040323, 'loss_val': 0.4568518036715554, 'psi': 0.7386355978619502}-{'f1_val': 0.7008569501491988, 'auprc': 0.9748420788536605, 'loss_val': 0.3230460590254161, 'psi': 0.8104510016309834}
[S6] START round=18 head_norm_before_train=1.375703 cos_to_last_merge=1.0000 (last merge round=17)
[S6] round=18 local utility u=0.681254 metrics={'f1_val': 0.915840473086174, 'auprc': 0.9470034377816201, 'loss_val': 0.3373758067894911, 'psi': 0.9283056589643524}-{'f1_val': 0.7948202248335384, 'auprc': 0.8102667291870578, 'loss_val': 0.5635514503642446, 'psi': 0.8009988265749461}
[S7] START round=18 head_norm_before_train=1.174318 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.547632 metrics={'f1_val': 0.6821449902267028, 'auprc': 0.8983467377648199, 'loss_val': 0.4877831049793754, 'psi': 0.7686256892419496}-{'f1_val': 0.5827456981740103, 'auprc': 0.8112316791215998, 'loss_val': 0.7253055397569824, 'psi': 0.6741400905530461}
[S8] START round=18 head_norm_before_train=1.297997 cos_to_last_merge=0.9968 (last merge round=16)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9877339397021321, 'auprc': 0.9963425791007563, 'loss_val': 0.13538043444199796, 'psi': 0.9911773954615818}-{'f1_val': 0.9966398743144329, 'auprc': 0.9980172740972776, 'loss_val': 0.14659393918919522, 'psi': 0.9971908342275707}
[S9] START round=18 head_norm_before_train=1.573532 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.003727 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9988613585498427, 'loss_val': 0.12468388360042418, 'psi': 0.9980528338739836}-{'f1_val': 0.9971000495392299, 'auprc': 0.9984967037668127, 'loss_val': 0.12856095438749182, 'psi': 0.9976587112302631}
[S10] START round=18 head_norm_before_train=1.130820 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.016264 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9953115615861612, 'loss_val': 0.10935210008757418, 'psi': 0.9938712433062423}-{'f1_val': 0.9935679896985945, 'auprc': 0.9916689133209837, 'loss_val': 0.13489472019178694, 'psi': 0.9928083591475502}
[S11] START round=18 head_norm_before_train=1.816905 (no previous merge yet)
[S11] round=18 local utility u=0.008479 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967591676444217, 'loss_val': 0.07478576022033989, 'psi': 0.996789176913516}-{'f1_val': 0.996567470639547, 'auprc': 0.9969537992856891, 'loss_val': 0.09087674761105036, 'psi': 0.9967220020980039}
[S13] START round=18 head_norm_before_train=1.689509 (no previous merge yet)
[S13] round=18 local utility u=0.400244 metrics={'f1_val': 0.62392996841436, 'auprc': 0.8622851853421278, 'loss_val': 0.5644421073274818, 'psi': 0.7192720551854672}-{'f1_val': 0.5741026201385052, 'auprc': 0.7921985304748933, 'loss_val': 0.8557070480826364, 'psi': 0.6613409842730604}
[S14] START round=18 head_norm_before_train=1.842223 (no previous merge yet)
[S14] round=18 local utility u=0.026552 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.996978848635083, 'loss_val': 0.038201590418933895, 'psi': 0.9977745919696579}-{'f1_val': 0.9936582147731836, 'auprc': 0.9986739886438645, 'loss_val': 0.06850969097777303, 'psi': 0.9956645243214559}
[S15] START round=18 head_norm_before_train=0.966740 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7055495947197614, 'auprc': 0.9360702487745821, 'loss_val': 0.4254331533588125, 'psi': 0.7977578563416897}-{'f1_val': 0.9638410027745292, 'auprc': 0.9988255415751226, 'loss_val': 0.11732618645393936, 'psi': 0.9778348182947666}
[S16] START round=18 head_norm_before_train=1.716571 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8328654483842862, 'auprc': 0.8328553262294617, 'loss_val': 0.8138185619856111, 'psi': 0.8328613995223564}-{'f1_val': 0.9038479982721637, 'auprc': 0.8832228517271132, 'loss_val': 0.46823842445015346, 'psi': 0.8955979396541436}
[S17] START round=18 head_norm_before_train=1.791908 (no previous merge yet)
[S17] round=18 local utility u=0.368524 metrics={'f1_val': 0.7583546593043424, 'auprc': 0.9880756583664435, 'loss_val': 0.39447054000843507, 'psi': 0.8502430589291828}-{'f1_val': 0.6908050825825505, 'auprc': 0.9770653253557745, 'loss_val': 0.6931901644039992, 'psi': 0.8053091796918401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S6
[S8] cosine check vs S6: cos=0.3253
[S6] RECEIVED delta(kind=head bytes=1793) from S14
[S6] cosine check vs S14: cos=0.8759
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0350
[S7] DROPPED delta from S11 (cos=-0.0350 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=0.4433
[S7] RECEIVED delta(kind=head bytes=1799) from S10
[S7] cosine check vs S10: cos=0.9618
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.9018
[S15] RECEIVED delta(kind=head bytes=1798) from S7
[S15] cosine check vs S7: cos=0.8375
[S15] RECEIVED delta(kind=head bytes=1799) from S13
[S15] cosine check vs S13: cos=-0.0788
[S15] DROPPED delta from S13 (cos=-0.0788 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=0.8606
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=18 metric=0.7008 head_norm=1.236409
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.623711e-01
[S3] stored merged vector for next round verification (round=18)
[S3] DEBUG after merge:  round=18 metric=0.7008 head_norm=1.385916 delta_norm=0.362371
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7055 head_norm=1.047394
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.271196e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.7029 head_norm=1.074420 delta_norm=0.327120
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9877 head_norm=1.368977
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.885110e-01
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9920 head_norm=1.209244 delta_norm=0.288511
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.6821 head_norm=1.194043
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.656053e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.6825 head_norm=1.185869 delta_norm=0.165605
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.9158 head_norm=1.425992
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.602788e-01
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.8449 head_norm=1.592465 delta_norm=0.460279
[S6] aggregate: ROLLBACK (f1_val pre=0.916 post=0.845 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9929 head_norm=1.200701
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.809617e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9927 head_norm=1.223027 delta_norm=0.780962
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.664245 cos_to_last_merge=0.9998 (last merge round=17)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6349598499022555, 'auprc': 0.721730035527039, 'loss_val': 0.8633767122929132, 'psi': 0.6696679241521688}-{'f1_val': 0.6369511325301009, 'auprc': 0.7130447959921387, 'loss_val': 0.7700872699208886, 'psi': 0.667388597914916}
[S3] START round=19 head_norm_before_train=1.385916 cos_to_last_merge=1.0000 (last merge round=18)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.791492201364031, 'loss_val': 0.47858554831777034, 'psi': 0.7370506027867922}-{'f1_val': 0.7007562037352997, 'auprc': 0.9958625138571036, 'loss_val': 0.4656425580791886, 'psi': 0.8187987277840212}
[S4] START round=19 head_norm_before_train=1.685055 cos_to_last_merge=0.8293 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=19 local utility u=0.060921 metrics={'f1_val': 0.9559057963090142, 'auprc': 0.963277107942232, 'loss_val': 0.28649295181736706, 'psi': 0.9588543209623013}-{'f1_val': 0.9480125140988614, 'auprc': 0.9443944159769487, 'loss_val': 0.3043269501545773, 'psi': 0.9465652748500963}
[S5] START round=19 head_norm_before_train=1.582608 (no previous merge yet)
[S5] round=19 local utility u=0.234929 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9110321118682126, 'loss_val': 0.3286769151050642, 'psi': 0.7847783011507535}-{'f1_val': 0.7035343687672289, 'auprc': 0.7912874415040323, 'loss_val': 0.4568518036715554, 'psi': 0.7386355978619502}
[S6] START round=19 head_norm_before_train=1.592465 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.8461436570730193, 'auprc': 0.9341830870893936, 'loss_val': 0.3515250388891442, 'psi': 0.881359429079569}-{'f1_val': 0.915840473086174, 'auprc': 0.9470034377816201, 'loss_val': 0.3373758067894911, 'psi': 0.9283056589643524}
[S7] START round=19 head_norm_before_train=1.185869 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3808476779811094, 'auprc': 0.7738204430620674, 'loss_val': 1.0016256587306493, 'psi': 0.5380367840134926}-{'f1_val': 0.6821449902267028, 'auprc': 0.8983467377648199, 'loss_val': 0.4877831049793754, 'psi': 0.7686256892419496}
[S8] START round=19 head_norm_before_train=1.209244 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.024862 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9975072190931176, 'loss_val': 0.14168729703166663, 'psi': 0.9968969122756488}-{'f1_val': 0.9877339397021321, 'auprc': 0.9963425791007563, 'loss_val': 0.13538043444199796, 'psi': 0.9911773954615818}
[S9] START round=19 head_norm_before_train=1.604819 cos_to_last_merge=0.9995 (last merge round=17)
[S9] round=19 local utility u=0.013841 metrics={'f1_val': 0.9979557977304231, 'auprc': 0.9988195504972962, 'loss_val': 0.09952820505610586, 'psi': 0.9983012988371723}-{'f1_val': 0.9975138174234109, 'auprc': 0.9988613585498427, 'loss_val': 0.12468388360042418, 'psi': 0.9980528338739836}
[S10] START round=19 head_norm_before_train=1.223027 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.992807899267653, 'loss_val': 0.14861856905600274, 'psi': 0.9930011264584119}-{'f1_val': 0.9929110311196298, 'auprc': 0.9953115615861612, 'loss_val': 0.10935210008757418, 'psi': 0.9938712433062423}
[S11] START round=19 head_norm_before_train=1.847727 (no previous merge yet)
[S11] round=19 local utility u=0.004126 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967505585807921, 'loss_val': 0.06650731031674707, 'psi': 0.9967857332880641}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967591676444217, 'loss_val': 0.07478576022033989, 'psi': 0.996789176913516}
[S13] START round=19 head_norm_before_train=1.703246 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5746152294458308, 'auprc': 0.8764920540614769, 'loss_val': 0.7564924089365332, 'psi': 0.6953659592920892}-{'f1_val': 0.62392996841436, 'auprc': 0.8622851853421278, 'loss_val': 0.5644421073274818, 'psi': 0.7192720551854672}
[S14] START round=19 head_norm_before_train=1.860685 (no previous merge yet)
[S14] round=19 local utility u=0.003850 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9986728496456152, 'loss_val': 0.035583799331744846, 'psi': 0.9984521923738707}-{'f1_val': 0.9983050875260411, 'auprc': 0.996978848635083, 'loss_val': 0.038201590418933895, 'psi': 0.9977745919696579}
[S15] START round=19 head_norm_before_train=1.074420 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980879776901572, 'loss_val': 0.10951956430744474, 'psi': 0.9972831921085752}-{'f1_val': 0.7055495947197614, 'auprc': 0.9360702487745821, 'loss_val': 0.4254331533588125, 'psi': 0.7977578563416897}
[S16] START round=19 head_norm_before_train=1.748573 (no previous merge yet)
[S16] round=19 local utility u=0.450617 metrics={'f1_val': 0.8396978408776266, 'auprc': 0.960062684800139, 'loss_val': 0.33520177916426114, 'psi': 0.8878437784466315}-{'f1_val': 0.8328654483842862, 'auprc': 0.8328553262294617, 'loss_val': 0.8138185619856111, 'psi': 0.8328613995223564}
[S17] START round=19 head_norm_before_train=1.802127 (no previous merge yet)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6819634399532675, 'auprc': 0.8853596729122547, 'loss_val': 0.7459896654651252, 'psi': 0.7633219331368624}-{'f1_val': 0.7583546593043424, 'auprc': 0.9880756583664435, 'loss_val': 0.39447054000843507, 'psi': 0.8502430589291828}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39410
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39411
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] → sending delta(kind=head bytes=1808) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39403
[S9] not sending this round → trigger blocked (psi=0.998)
[S11] not sending this round → trigger blocked (psi=0.997)
[S8] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1808 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1808) from S4
[S2] cosine check vs S4: cos=0.9914
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=0.2588
[S10] RECEIVED delta(kind=head bytes=1796) from S15
[S10] cosine check vs S15: cos=0.7934
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.1318
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9879
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.998 u=0.0038 p_local=0.0718 f1=0.998 auprc=0.999 bytes=17939
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9931 head_norm=1.304949
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.022317e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9931 head_norm=1.168834 delta_norm=0.402232
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.993 u=0.0000 p_local=0.0786 f1=0.993 auprc=0.993 bytes=16168
[S11] r=20 psi=0.997 u=0.0041 p_local=0.1078 f1=0.997 auprc=0.997 bytes=16153
[S7] r=20 psi=0.538 u=0.0000 p_local=0.2731 f1=0.381 auprc=0.774 bytes=16177
[S13] r=20 psi=0.695 u=0.0000 p_local=0.1398 f1=0.575 auprc=0.876 bytes=12582
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7008 head_norm=1.410997
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.860597e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7008 head_norm=1.011004 delta_norm=0.886060
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.737 u=0.0000 p_local=0.0955 f1=0.701 auprc=0.791 bytes=16144
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.8461 head_norm=1.627432
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.039673e+00
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.9279 head_norm=1.353315 delta_norm=1.039673
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=20 psi=0.881 u=0.0000 p_local=0.3090 f1=0.846 auprc=0.934 bytes=14398
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=19 metric=0.6350 head_norm=1.696010
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.114293e-01
[S2] stored merged vector for next round verification (round=19)
[S2] DEBUG after merge:  round=19 metric=0.6301 head_norm=1.694318 delta_norm=0.111429
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] r=20 psi=0.670 u=0.0000 p_local=0.1036 f1=0.635 auprc=0.722 bytes=14367
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9980 head_norm=1.637027
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.277733e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9975 head_norm=1.609451 delta_norm=0.127773
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.998 u=0.0138 p_local=0.1376 f1=0.998 auprc=0.999 bytes=17988
[S5] r=20 psi=0.785 u=0.2349 p_local=0.1622 f1=0.701 auprc=0.911 bytes=17951
[S4] r=20 psi=0.959 u=0.0609 p_local=0.0820 f1=0.956 auprc=0.963 bytes=16202
[S8] r=20 psi=0.997 u=0.0249 p_local=0.0710 f1=0.996 auprc=0.998 bytes=16164
[S16] r=20 psi=0.888 u=0.4506 p_local=0.2840 f1=0.840 auprc=0.960 bytes=17993
[S15] r=20 psi=0.997 u=1.0000 p_local=0.3201 f1=0.997 auprc=0.998 bytes=16184
[S17] r=20 psi=0.763 u=0.0000 p_local=0.1832 f1=0.682 auprc=0.885 bytes=16163
[S2] START round=20 head_norm_before_train=1.694318 cos_to_last_merge=1.0000 (last merge round=19)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.6032901205440286, 'auprc': 0.6978833538386561, 'loss_val': 1.0810486475790024, 'psi': 0.6411274138618797}-{'f1_val': 0.6349598499022555, 'auprc': 0.721730035527039, 'loss_val': 0.8633767122929132, 'psi': 0.6696679241521688}
[S3] START round=20 head_norm_before_train=1.011004 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.309745 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9952154000388147, 'loss_val': 0.4698142027763746, 'psi': 0.8184947358147268}-{'f1_val': 0.7007562037352997, 'auprc': 0.791492201364031, 'loss_val': 0.47858554831777034, 'psi': 0.7370506027867922}
[S4] START round=20 head_norm_before_train=1.699944 cos_to_last_merge=0.8291 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9498042047837578, 'auprc': 0.9478629068921474, 'loss_val': 0.3088705117994642, 'psi': 0.9490276856271136}-{'f1_val': 0.9559057963090142, 'auprc': 0.963277107942232, 'loss_val': 0.28649295181736706, 'psi': 0.9588543209623013}
[S5] START round=20 head_norm_before_train=1.591684 (no previous merge yet)
[S5] round=20 local utility u=0.136412 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9897799861068428, 'loss_val': 0.2920957731758256, 'psi': 0.8162774508462056}-{'f1_val': 0.7006090940057808, 'auprc': 0.9110321118682126, 'loss_val': 0.3286769151050642, 'psi': 0.7847783011507535}
[S6] START round=20 head_norm_before_train=1.353315 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.362643 metrics={'f1_val': 0.9564297626766309, 'auprc': 0.9539146358681965, 'loss_val': 0.3471505799853542, 'psi': 0.9554237119532571}-{'f1_val': 0.8461436570730193, 'auprc': 0.9341830870893936, 'loss_val': 0.3515250388891442, 'psi': 0.881359429079569}
[S7] START round=20 head_norm_before_train=1.201119 cos_to_last_merge=0.9997 (last merge round=18)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6395271087073436, 'auprc': 0.8079015107568509, 'loss_val': 0.6199067720925403, 'psi': 0.7068768695271466}-{'f1_val': 0.3808476779811094, 'auprc': 0.7738204430620674, 'loss_val': 1.0016256587306493, 'psi': 0.5380367840134926}
[S8] START round=20 head_norm_before_train=1.274186 cos_to_last_merge=0.9977 (last merge round=18)
[S8] round=20 local utility u=0.020178 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9975122489678399, 'loss_val': 0.10224444211880575, 'psi': 0.9969888241757956}-{'f1_val': 0.9964900410640029, 'auprc': 0.9975072190931176, 'loss_val': 0.14168729703166663, 'psi': 0.9968969122756488}
[S9] START round=20 head_norm_before_train=1.609451 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988685619423152, 'loss_val': 0.10296849169827119, 'psi': 0.9971598459632385}-{'f1_val': 0.9979557977304231, 'auprc': 0.9988195504972962, 'loss_val': 0.09952820505610586, 'psi': 0.9983012988371723}
[S10] START round=20 head_norm_before_train=1.168834 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.029167 metrics={'f1_val': 0.992254723717119, 'auprc': 0.9963159707413658, 'loss_val': 0.09555729714235454, 'psi': 0.9938792225268178}-{'f1_val': 0.9931299445855843, 'auprc': 0.992807899267653, 'loss_val': 0.14861856905600274, 'psi': 0.9930011264584119}
[S11] START round=20 head_norm_before_train=1.878649 (no previous merge yet)
[S11] round=20 local utility u=0.004864 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966548281096268, 'loss_val': 0.055042361194085045, 'psi': 0.996602413627579}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967505585807921, 'loss_val': 0.06650731031674707, 'psi': 0.9967857332880641}
[S13] START round=20 head_norm_before_train=1.712616 (no previous merge yet)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5676157287516423, 'auprc': 0.7970960082755314, 'loss_val': 0.9051671483043722, 'psi': 0.6594078405611979}-{'f1_val': 0.5746152294458308, 'auprc': 0.8764920540614769, 'loss_val': 0.7564924089365332, 'psi': 0.6953659592920892}
[S14] START round=20 head_norm_before_train=1.877811 (no previous merge yet)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9985798393510139, 'loss_val': 0.03331739217748611, 'psi': 0.9980242414299791}-{'f1_val': 0.9983050875260411, 'auprc': 0.9986728496456152, 'loss_val': 0.035583799331744846, 'psi': 0.9984521923738707}
[S15] START round=20 head_norm_before_train=1.163200 cos_to_last_merge=0.9966 (last merge round=18)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.90061531369377, 'auprc': 0.9968767565052783, 'loss_val': 0.2608976626022718, 'psi': 0.9391198908183733}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980879776901572, 'loss_val': 0.10951956430744474, 'psi': 0.9972831921085752}
[S16] START round=20 head_norm_before_train=1.782197 (no previous merge yet)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8224140809562178, 'auprc': 0.8073213982167494, 'loss_val': 0.9968414131803395, 'psi': 0.8163770078604304}-{'f1_val': 0.8396978408776266, 'auprc': 0.960062684800139, 'loss_val': 0.33520177916426114, 'psi': 0.8878437784466315}
[S17] START round=20 head_norm_before_train=1.817054 (no previous merge yet)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.668516282865691, 'auprc': 0.8757314868244309, 'loss_val': 0.7606488057447546, 'psi': 0.751402364449187}-{'f1_val': 0.6819634399532675, 'auprc': 0.8853596729122547, 'loss_val': 0.7459896654651252, 'psi': 0.7633219331368624}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39408
[S8] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[S5] not sending this round → trigger blocked (psi=0.816)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.3878
[S7] RECEIVED delta(kind=head bytes=1797) from S10
[S7] cosine check vs S10: cos=0.9757
[S7] RECEIVED delta(kind=head bytes=1796) from S11
[S7] cosine check vs S11: cos=-0.0510
[S7] DROPPED delta from S11 (cos=-0.0510 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S3
[S15] cosine check vs S3: cos=0.2334
[S15] RECEIVED delta(kind=head bytes=1800) from S7
[S15] cosine check vs S7: cos=0.9702
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.110 → S3@127.0.0.1:39403
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=20 metric=0.9006 head_norm=1.245942
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.619223e-01
[S15] stored merged vector for next round verification (round=20)
[S15] DEBUG after merge:  round=20 metric=0.8971 head_norm=1.008421 delta_norm=0.361922
[S15] aggregate: ACCEPT kept=['S3', 'S7'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.256 → S10@127.0.0.1:39411
[S5] ⇄ pheromone p=0.157 → S9@127.0.0.1:39410
[S2] ⇄ pheromone p=0.083 → S10@127.0.0.1:39411
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=20 metric=0.9966 head_norm=1.335114
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.543690e-01
[S8] stored merged vector for next round verification (round=20)
[S8] DEBUG after merge:  round=20 metric=0.9965 head_norm=1.135395 delta_norm=0.754369
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.061 → S3@127.0.0.1:39403
[S14] ⇄ pheromone p=0.057 → S6@127.0.0.1:39407
[S13] ⇄ pheromone p=0.112 → S15@127.0.0.1:39415
[S4] ⇄ pheromone p=0.066 → S2@127.0.0.1:39402
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.6395 head_norm=1.213565
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.387904e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.6345 head_norm=1.231385 delta_norm=0.138790
[S7] aggregate: ROLLBACK (f1_val pre=0.640 post=0.634 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.418 → S15@127.0.0.1:39415
[S3] ⇄ pheromone p=0.138 → S15@127.0.0.1:39415
[S10] ⇄ pheromone p=0.069 → S7@127.0.0.1:39408
[S11] ⇄ pheromone p=0.087 → S7@127.0.0.1:39408
[S6] ⇄ pheromone p=0.320 → S8@127.0.0.1:39409
[S16] ⇄ pheromone p=0.227 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.147 → S8@127.0.0.1:39409
[S2] START round=21 head_norm_before_train=1.722580 cos_to_last_merge=0.9997 (last merge round=19)
[S2] round=21 local utility u=0.404177 metrics={'f1_val': 0.6675270794831325, 'auprc': 0.7338076167303278, 'loss_val': 0.7658892697096873, 'psi': 0.6940392943820106}-{'f1_val': 0.6032901205440286, 'auprc': 0.6978833538386561, 'loss_val': 1.0810486475790024, 'psi': 0.6411274138618797}
[S3] START round=21 head_norm_before_train=1.048531 cos_to_last_merge=0.9957 (last merge round=19)
[S3] round=21 local utility u=0.038501 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.995873137916225, 'loss_val': 0.3947859746917017, 'psi': 0.8187578309656909}-{'f1_val': 0.7006809596653347, 'auprc': 0.9952154000388147, 'loss_val': 0.4698142027763746, 'psi': 0.8184947358147268}
[S4] START round=21 head_norm_before_train=1.704479 cos_to_last_merge=0.8298 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9486169864584276, 'auprc': 0.9429035164400392, 'loss_val': 0.3049167798052993, 'psi': 0.9463315984510723}-{'f1_val': 0.9498042047837578, 'auprc': 0.9478629068921474, 'loss_val': 0.3088705117994642, 'psi': 0.9490276856271136}
[S5] START round=21 head_norm_before_train=1.602625 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9097637085823324, 'loss_val': 0.35774540689997864, 'psi': 0.7842705190305375}-{'f1_val': 0.7006090940057808, 'auprc': 0.9897799861068428, 'loss_val': 0.2920957731758256, 'psi': 0.8162774508462056}
[S6] START round=21 head_norm_before_train=1.390633 cos_to_last_merge=0.9986 (last merge round=19)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.7734560528216929, 'auprc': 0.8867514277557617, 'loss_val': 0.5455558358177163, 'psi': 0.8187742027953204}-{'f1_val': 0.9564297626766309, 'auprc': 0.9539146358681965, 'loss_val': 0.3471505799853542, 'psi': 0.9554237119532571}
[S7] START round=21 head_norm_before_train=1.231385 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.349727 metrics={'f1_val': 0.684757809111938, 'auprc': 0.8916590358861386, 'loss_val': 0.4431101600690459, 'psi': 0.7675182998216182}-{'f1_val': 0.6395271087073436, 'auprc': 0.8079015107568509, 'loss_val': 0.6199067720925403, 'psi': 0.7068768695271466}
[S8] START round=21 head_norm_before_train=1.135395 cos_to_last_merge=1.0000 (last merge round=20)
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9968956588759448, 'loss_val': 0.27180352420426185, 'psi': 0.9967421881390376}-{'f1_val': 0.9966398743144329, 'auprc': 0.9975122489678399, 'loss_val': 0.10224444211880575, 'psi': 0.9969888241757956}
[S9] START round=21 head_norm_before_train=1.638138 cos_to_last_merge=0.9996 (last merge round=19)
[S9] round=21 local utility u=0.009691 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9963177635167252, 'loss_val': 0.08507852146594883, 'psi': 0.9970540394130764}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988685619423152, 'loss_val': 0.10296849169827119, 'psi': 0.9971598459632385}
[S10] START round=21 head_norm_before_train=1.264279 cos_to_last_merge=0.9977 (last merge round=19)
[S10] round=21 local utility u=0.011450 metrics={'f1_val': 0.9933090639542883, 'auprc': 0.9966654963513086, 'loss_val': 0.08003134409555465, 'psi': 0.9946516369130964}-{'f1_val': 0.992254723717119, 'auprc': 0.9963159707413658, 'loss_val': 0.09555729714235454, 'psi': 0.9938792225268178}
[S11] START round=21 head_norm_before_train=1.908440 (no previous merge yet)
[S11] round=21 local utility u=0.004230 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967426217667585, 'loss_val': 0.048296521007114776, 'psi': 0.9967825585624507}-{'f1_val': 0.996567470639547, 'auprc': 0.9966548281096268, 'loss_val': 0.055042361194085045, 'psi': 0.996602413627579}
[S13] START round=21 head_norm_before_train=1.727791 (no previous merge yet)
[S13] round=21 local utility u=0.148337 metrics={'f1_val': 0.607456140050119, 'auprc': 0.7943374621382786, 'loss_val': 0.8392609294295769, 'psi': 0.6822086688853829}-{'f1_val': 0.5676157287516423, 'auprc': 0.7970960082755314, 'loss_val': 0.9051671483043722, 'psi': 0.6594078405611979}
[S14] START round=21 head_norm_before_train=1.896539 (no previous merge yet)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969778369139299, 'loss_val': 0.028960868170974673, 'psi': 0.9972809813954646}-{'f1_val': 0.9976538428159559, 'auprc': 0.9985798393510139, 'loss_val': 0.03331739217748611, 'psi': 0.9980242414299791}
[S15] START round=21 head_norm_before_train=1.008421 cos_to_last_merge=1.0000 (last merge round=20)
[S15] round=21 local utility u=0.052534 metrics={'f1_val': 0.9099578108985171, 'auprc': 0.9975879200385152, 'loss_val': 0.21401874875950244, 'psi': 0.9450098545545164}-{'f1_val': 0.90061531369377, 'auprc': 0.9968767565052783, 'loss_val': 0.2608976626022718, 'psi': 0.9391198908183733}
[S16] START round=21 head_norm_before_train=1.813208 (no previous merge yet)
[S16] round=21 local utility u=0.581221 metrics={'f1_val': 0.8360137948855175, 'auprc': 0.9810916776655454, 'loss_val': 0.4373091728439425, 'psi': 0.8940449479975286}-{'f1_val': 0.8224140809562178, 'auprc': 0.8073213982167494, 'loss_val': 0.9968414131803395, 'psi': 0.8163770078604304}
[S17] START round=21 head_norm_before_train=1.827329 (no previous merge yet)
[S17] round=21 local utility u=0.072154 metrics={'f1_val': 0.672261692104764, 'auprc': 0.8851818618768958, 'loss_val': 0.6671638007050528, 'psi': 0.7574297600136168}-{'f1_val': 0.668516282865691, 'auprc': 0.8757314868244309, 'loss_val': 0.7606488057447546, 'psi': 0.751402364449187}
[S7] not sending this round → trigger blocked (psi=0.768)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39411
[S16] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S2
[S10] cosine check vs S2: cos=0.6471
[S3] RECEIVED delta(kind=head bytes=1807) from S9
[S3] cosine check vs S9: cos=0.6351
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=-0.0978
[S15] DROPPED delta from S13 (cos=-0.0978 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.7914
[S10] RECEIVED delta(kind=head bytes=1792) from S15
[S10] cosine check vs S15: cos=0.9156
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.4765
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=21 metric=0.7735 head_norm=1.437309
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.617654e-01
[S6] stored merged vector for next round verification (round=21)
[S6] DEBUG after merge:  round=21 metric=0.7769 head_norm=1.551132 delta_norm=0.561765
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9933 head_norm=1.323634
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.978725e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9931 head_norm=1.226658 delta_norm=0.297872
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9966 head_norm=1.198999
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.243601e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9966 head_norm=1.315333 delta_norm=0.824360
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=21 metric=0.7007 head_norm=1.095611
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.437877e-01
[S3] stored merged vector for next round verification (round=21)
[S3] DEBUG after merge:  round=21 metric=0.7007 head_norm=1.254501 delta_norm=0.643788
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.751024 cos_to_last_merge=0.9990 (last merge round=19)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6143137088863075, 'auprc': 0.7326901303950324, 'loss_val': 1.0638239762320358, 'psi': 0.6616642774897975}-{'f1_val': 0.6675270794831325, 'auprc': 0.7338076167303278, 'loss_val': 0.7658892697096873, 'psi': 0.6940392943820106}
[S3] START round=22 head_norm_before_train=1.254501 cos_to_last_merge=1.0000 (last merge round=21)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9939835241919144, 'loss_val': 0.4014243261775997, 'psi': 0.8180019854759666}-{'f1_val': 0.7006809596653347, 'auprc': 0.995873137916225, 'loss_val': 0.3947859746917017, 'psi': 0.8187578309656909}
[S4] START round=22 head_norm_before_train=1.710733 cos_to_last_merge=0.8306 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9430110846606035, 'auprc': 0.9317009924576183, 'loss_val': 0.3164560971882683, 'psi': 0.9384870477794094}-{'f1_val': 0.9486169864584276, 'auprc': 0.9429035164400392, 'loss_val': 0.3049167798052993, 'psi': 0.9463315984510723}
[S5] START round=22 head_norm_before_train=1.615926 (no previous merge yet)
[S5] round=22 local utility u=0.105670 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9632650248953982, 'loss_val': 0.30690985925977415, 'psi': 0.8056710455557639}-{'f1_val': 0.7006083926626743, 'auprc': 0.9097637085823324, 'loss_val': 0.35774540689997864, 'psi': 0.7842705190305375}
[S6] START round=22 head_norm_before_train=1.551132 cos_to_last_merge=1.0000 (last merge round=21)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7080831430091306, 'auprc': 0.8483174389693486, 'loss_val': 0.47383315732312775, 'psi': 0.7641768613932178}-{'f1_val': 0.7734560528216929, 'auprc': 0.8867514277557617, 'loss_val': 0.5455558358177163, 'psi': 0.8187742027953204}
[S7] START round=22 head_norm_before_train=1.248770 cos_to_last_merge=0.9997 (last merge round=20)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6114569066891662, 'auprc': 0.7791753811236362, 'loss_val': 0.703205551865437, 'psi': 0.6785442964629542}-{'f1_val': 0.684757809111938, 'auprc': 0.8916590358861386, 'loss_val': 0.4431101600690459, 'psi': 0.7675182998216182}
[S8] START round=22 head_norm_before_train=1.315333 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.083262 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9976834319324166, 'loss_val': 0.10502256098171062, 'psi': 0.9967952348130584}-{'f1_val': 0.9966398743144329, 'auprc': 0.9968956588759448, 'loss_val': 0.27180352420426185, 'psi': 0.9967421881390376}
[S9] START round=22 head_norm_before_train=1.666165 cos_to_last_merge=0.9986 (last merge round=19)
[S9] round=22 local utility u=0.004711 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9988683108700245, 'loss_val': 0.06917750135875027, 'psi': 0.9966611360253739}-{'f1_val': 0.9975448900106438, 'auprc': 0.9963177635167252, 'loss_val': 0.08507852146594883, 'psi': 0.9970540394130764}
[S10] START round=22 head_norm_before_train=1.226658 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9933334713009766, 'auprc': 0.9954571478835792, 'loss_val': 0.10891891950265142, 'psi': 0.9941829419340176}-{'f1_val': 0.9933090639542883, 'auprc': 0.9966654963513086, 'loss_val': 0.08003134409555465, 'psi': 0.9946516369130964}
[S11] START round=22 head_norm_before_train=1.934932 (no previous merge yet)
[S11] round=22 local utility u=0.000722 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966484382258513, 'loss_val': 0.045120102533397974, 'psi': 0.9965998576740687}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967426217667585, 'loss_val': 0.048296521007114776, 'psi': 0.9967825585624507}
[S13] START round=22 head_norm_before_train=1.747654 (no previous merge yet)
[S13] round=22 local utility u=0.151876 metrics={'f1_val': 0.6315197840979607, 'auprc': 0.8106795956261843, 'loss_val': 0.7289178918969913, 'psi': 0.7031837087092502}-{'f1_val': 0.607456140050119, 'auprc': 0.7943374621382786, 'loss_val': 0.8392609294295769, 'psi': 0.6822086688853829}
[S14] START round=22 head_norm_before_train=1.914135 (no previous merge yet)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9969257349834932, 'auprc': 0.9977200082180908, 'loss_val': 0.033438056044858715, 'psi': 0.9972434442773322}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969778369139299, 'loss_val': 0.028960868170974673, 'psi': 0.9972809813954646}
[S15] START round=22 head_norm_before_train=1.099189 cos_to_last_merge=0.9966 (last merge round=20)
[S15] round=22 local utility u=0.013959 metrics={'f1_val': 0.9076957713190877, 'auprc': 0.9981668043898915, 'loss_val': 0.17426544666990443, 'psi': 0.9438841845474093}-{'f1_val': 0.9099578108985171, 'auprc': 0.9975879200385152, 'loss_val': 0.21401874875950244, 'psi': 0.9450098545545164}
[S16] START round=22 head_norm_before_train=1.837750 (no previous merge yet)
[S16] round=22 local utility u=0.631098 metrics={'f1_val': 0.984658140820619, 'auprc': 0.9884428957561924, 'loss_val': 0.08903375940208934, 'psi': 0.9861720427948484}-{'f1_val': 0.8360137948855175, 'auprc': 0.9810916776655454, 'loss_val': 0.4373091728439425, 'psi': 0.8940449479975286}
[S17] START round=22 head_norm_before_train=1.838951 (no previous merge yet)
[S17] round=22 local utility u=0.384379 metrics={'f1_val': 0.7590949963051996, 'auprc': 0.9169327560808382, 'loss_val': 0.514657323957321, 'psi': 0.8222301002154551}-{'f1_val': 0.672261692104764, 'auprc': 0.8851818618768958, 'loss_val': 0.6671638007050528, 'psi': 0.7574297600136168}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39403
[S15] not sending this round → trigger blocked (psi=0.944)
[S13] not sending this round → trigger blocked (psi=0.703)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.986)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39408
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S8
[S3] cosine check vs S8: cos=0.2713
[S7] RECEIVED delta(kind=head bytes=1799) from S11
[S7] cosine check vs S11: cos=-0.0523
[S7] DROPPED delta from S11 (cos=-0.0523 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9867
[S17] not sending this round → trigger blocked (psi=0.822)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7007 head_norm=1.293943
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.153755e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7007 head_norm=1.075985 delta_norm=0.815376
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9952 head_norm=1.693729
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.394854e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9948 head_norm=1.655735 delta_norm=0.139485
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.773791 cos_to_last_merge=0.9982 (last merge round=19)
[S2] round=23 local utility u=0.228674 metrics={'f1_val': 0.6606380785198032, 'auprc': 0.733564834655518, 'loss_val': 0.8870471933388283, 'psi': 0.6898087809740892}-{'f1_val': 0.6143137088863075, 'auprc': 0.7326901303950324, 'loss_val': 1.0638239762320358, 'psi': 0.6616642774897975}
[S3] START round=23 head_norm_before_train=1.075985 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.996177098562179, 'loss_val': 0.40895549501134065, 'psi': 0.8188794152240724}-{'f1_val': 0.7006809596653347, 'auprc': 0.9939835241919144, 'loss_val': 0.4014243261775997, 'psi': 0.8180019854759666}
[S4] START round=23 head_norm_before_train=1.716206 cos_to_last_merge=0.8310 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=23 local utility u=0.052249 metrics={'f1_val': 0.9483446658001009, 'auprc': 0.9537158747746541, 'loss_val': 0.3100043865107178, 'psi': 0.9504931493899222}-{'f1_val': 0.9430110846606035, 'auprc': 0.9317009924576183, 'loss_val': 0.3164560971882683, 'psi': 0.9384870477794094}
[S5] START round=23 head_norm_before_train=1.628837 (no previous merge yet)
[S5] round=23 local utility u=0.049553 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9859551729922376, 'loss_val': 0.2758786323293757, 'psi': 0.8147475256003636}-{'f1_val': 0.7006083926626743, 'auprc': 0.9632650248953982, 'loss_val': 0.30690985925977415, 'psi': 0.8056710455557639}
[S6] START round=23 head_norm_before_train=1.594895 cos_to_last_merge=0.9982 (last merge round=21)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.5542905142518337, 'auprc': 0.6054124527232652, 'loss_val': 0.9746573550311284, 'psi': 0.5747392896404062}-{'f1_val': 0.7080831430091306, 'auprc': 0.8483174389693486, 'loss_val': 0.47383315732312775, 'psi': 0.7641768613932178}
[S7] START round=23 head_norm_before_train=1.270540 cos_to_last_merge=0.9988 (last merge round=20)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.6043504002364373, 'auprc': 0.7771439011805255, 'loss_val': 0.7170199323719327, 'psi': 0.6734678006140725}-{'f1_val': 0.6114569066891662, 'auprc': 0.7791753811236362, 'loss_val': 0.703205551865437, 'psi': 0.6785442964629542}
[S8] START round=23 head_norm_before_train=1.403878 cos_to_last_merge=0.9958 (last merge round=21)
[S8] round=23 local utility u=0.018785 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9986823078570655, 'loss_val': 0.0713490456134563, 'psi': 0.997284768104201}-{'f1_val': 0.9962031034001528, 'auprc': 0.9976834319324166, 'loss_val': 0.10502256098171062, 'psi': 0.9967952348130584}
[S9] START round=23 head_norm_before_train=1.655735 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972530425947174, 'loss_val': 0.07632074093011547, 'psi': 0.9971629645451726}-{'f1_val': 0.99518968612894, 'auprc': 0.9988683108700245, 'loss_val': 0.06917750135875027, 'psi': 0.9966611360253739}
[S10] START round=23 head_norm_before_train=1.272126 cos_to_last_merge=0.9994 (last merge round=21)
[S10] round=23 local utility u=0.009790 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9950333052157081, 'loss_val': 0.08553289920742055, 'psi': 0.9937599407580611}-{'f1_val': 0.9933334713009766, 'auprc': 0.9954571478835792, 'loss_val': 0.10891891950265142, 'psi': 0.9941829419340176}
[S11] START round=23 head_norm_before_train=1.958011 (no previous merge yet)
[S11] round=23 local utility u=0.001317 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965506245139852, 'loss_val': 0.04364361956777448, 'psi': 0.9967057596613413}-{'f1_val': 0.996567470639547, 'auprc': 0.9966484382258513, 'loss_val': 0.045120102533397974, 'psi': 0.9965998576740687}
[S13] START round=23 head_norm_before_train=1.767772 (no previous merge yet)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6237740256952433, 'auprc': 0.8183394852757826, 'loss_val': 0.7664078749008197, 'psi': 0.701600209527459}-{'f1_val': 0.6315197840979607, 'auprc': 0.8106795956261843, 'loss_val': 0.7289178918969913, 'psi': 0.7031837087092502}
[S14] START round=23 head_norm_before_train=1.926229 (no previous merge yet)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9380925589464411, 'auprc': 0.996978100028402, 'loss_val': 0.08797173873539112, 'psi': 0.9616467753792255}-{'f1_val': 0.9969257349834932, 'auprc': 0.9977200082180908, 'loss_val': 0.033438056044858715, 'psi': 0.9972434442773322}
[S15] START round=23 head_norm_before_train=1.188516 cos_to_last_merge=0.9893 (last merge round=20)
[S15] round=23 local utility u=0.209852 metrics={'f1_val': 0.9647221118858005, 'auprc': 0.9980648752609287, 'loss_val': 0.09641424134853357, 'psi': 0.9780592172358518}-{'f1_val': 0.9076957713190877, 'auprc': 0.9981668043898915, 'loss_val': 0.17426544666990443, 'psi': 0.9438841845474093}
[S16] START round=23 head_norm_before_train=1.853654 (no previous merge yet)
[S16] round=23 local utility u=0.000000 metrics={'f1_val': 0.8406354141442854, 'auprc': 0.8768559438241863, 'loss_val': 0.8844987043378642, 'psi': 0.8551236260162458}-{'f1_val': 0.984658140820619, 'auprc': 0.9884428957561924, 'loss_val': 0.08903375940208934, 'psi': 0.9861720427948484}
[S17] START round=23 head_norm_before_train=1.859272 (no previous merge yet)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.6641269159148224, 'auprc': 0.8027784317404258, 'loss_val': 1.0063290029835188, 'psi': 0.7195875222450638}-{'f1_val': 0.7590949963051996, 'auprc': 0.9169327560808382, 'loss_val': 0.514657323957321, 'psi': 0.8222301002154551}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39402
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S15
[S10] cosine check vs S15: cos=0.8396
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.9581
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9942
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0538
[S7] DROPPED delta from S11 (cos=-0.0538 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S8
[S3] cosine check vs S8: cos=0.8026
[S10] RECEIVED delta(kind=head bytes=1800) from S2
[S10] cosine check vs S2: cos=0.7616
[S2] RECEIVED delta(kind=head bytes=1796) from S4
[S2] cosine check vs S4: cos=0.9908
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.6044 head_norm=1.288765
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.912871e-01
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.5757 head_norm=1.297934 delta_norm=0.191287
[S7] aggregate: ROLLBACK (f1_val pre=0.604 post=0.576 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7007 head_norm=1.118643
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.411690e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.7007 head_norm=1.232403 delta_norm=0.441169
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9971 head_norm=1.681983
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.145075e-02
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9971 head_norm=1.660932 delta_norm=0.091451
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9929 head_norm=1.334741
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.812678e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9929 head_norm=1.283511 delta_norm=0.181268
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=23 metric=0.6606 head_norm=1.789153
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.228684e-01
[S2] stored merged vector for next round verification (round=23)
[S2] DEBUG after merge:  round=23 metric=0.6618 head_norm=1.756791 delta_norm=0.122868
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.756791 cos_to_last_merge=1.0000 (last merge round=23)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.6360032979789181, 'auprc': 0.7291729744545872, 'loss_val': 0.9710346580549035, 'psi': 0.6732711685691857}-{'f1_val': 0.6606380785198032, 'auprc': 0.733564834655518, 'loss_val': 0.8870471933388283, 'psi': 0.6898087809740892}
[S3] START round=24 head_norm_before_train=1.232403 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.003315 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9963549123879688, 'loss_val': 0.40285948374619457, 'psi': 0.8189505407543884}-{'f1_val': 0.7006809596653347, 'auprc': 0.996177098562179, 'loss_val': 0.40895549501134065, 'psi': 0.8188794152240724}
[S4] START round=24 head_norm_before_train=1.732559 cos_to_last_merge=0.8298 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=24 local utility u=0.027213 metrics={'f1_val': 0.9532970760098224, 'auprc': 0.95879575117228, 'loss_val': 0.300533232107097, 'psi': 0.9554965460748054}-{'f1_val': 0.9483446658001009, 'auprc': 0.9537158747746541, 'loss_val': 0.3100043865107178, 'psi': 0.9504931493899222}
[S5] START round=24 head_norm_before_train=1.644703 (no previous merge yet)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8947498915967993, 'loss_val': 0.31069029390305225, 'psi': 0.7782649922363243}-{'f1_val': 0.7006090940057808, 'auprc': 0.9859551729922376, 'loss_val': 0.2758786323293757, 'psi': 0.8147475256003636}
[S6] START round=24 head_norm_before_train=1.643468 cos_to_last_merge=0.9934 (last merge round=21)
[S6] round=24 local utility u=1.000000 metrics={'f1_val': 0.9587055192700664, 'auprc': 0.976061637504164, 'loss_val': 0.1965910531892141, 'psi': 0.9656479665637054}-{'f1_val': 0.5542905142518337, 'auprc': 0.6054124527232652, 'loss_val': 0.9746573550311284, 'psi': 0.5747392896404062}
[S7] START round=24 head_norm_before_train=1.297934 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.5978598295422795, 'auprc': 0.7792136818638327, 'loss_val': 0.7400153516953724, 'psi': 0.6704013704709008}-{'f1_val': 0.6043504002364373, 'auprc': 0.7771439011805255, 'loss_val': 0.7170199323719327, 'psi': 0.6734678006140725}
[S8] START round=24 head_norm_before_train=1.474969 cos_to_last_merge=0.9891 (last merge round=21)
[S8] round=24 local utility u=0.008963 metrics={'f1_val': 0.9966398743144329, 'auprc': 0.9988585558124822, 'loss_val': 0.05567341121546642, 'psi': 0.9975273469136525}-{'f1_val': 0.9963530749356245, 'auprc': 0.9986823078570655, 'loss_val': 0.0713490456134563, 'psi': 0.997284768104201}
[S9] START round=24 head_norm_before_train=1.660932 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.002386 metrics={'f1_val': 0.9972634903368587, 'auprc': 0.9987765664529953, 'loss_val': 0.07708353659713847, 'psi': 0.9978687207833132}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972530425947174, 'loss_val': 0.07632074093011547, 'psi': 0.9971629645451726}
[S10] START round=24 head_norm_before_train=1.283511 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.992254723717119, 'auprc': 0.9960444559206513, 'loss_val': 0.096002507669596, 'psi': 0.9937706165985319}-{'f1_val': 0.9929110311196298, 'auprc': 0.9950333052157081, 'loss_val': 0.08553289920742055, 'psi': 0.9937599407580611}
[S11] START round=24 head_norm_before_train=1.978123 (no previous merge yet)
[S11] round=24 local utility u=0.001832 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966349442471487, 'loss_val': 0.038782825962382535, 'psi': 0.9965944600825878}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965506245139852, 'loss_val': 0.04364361956777448, 'psi': 0.9967057596613413}
[S13] START round=24 head_norm_before_train=1.778666 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6087864449101501, 'auprc': 0.803552496497963, 'loss_val': 0.9353093756803218, 'psi': 0.6866928655452753}-{'f1_val': 0.6237740256952433, 'auprc': 0.8183394852757826, 'loss_val': 0.7664078749008197, 'psi': 0.701600209527459}
[S14] START round=24 head_norm_before_train=1.938626 (no previous merge yet)
[S14] round=24 local utility u=0.214341 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9986736205657624, 'loss_val': 0.025651154245984888, 'psi': 0.9984525007419296}-{'f1_val': 0.9380925589464411, 'auprc': 0.996978100028402, 'loss_val': 0.08797173873539112, 'psi': 0.9616467753792255}
[S15] START round=24 head_norm_before_train=1.258577 cos_to_last_merge=0.9826 (last merge round=20)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.9073002469420491, 'auprc': 0.9976788778520215, 'loss_val': 0.17581598064266404, 'psi': 0.9434516993060381}-{'f1_val': 0.9647221118858005, 'auprc': 0.9980648752609287, 'loss_val': 0.09641424134853357, 'psi': 0.9780592172358518}
[S16] START round=24 head_norm_before_train=1.869995 (no previous merge yet)
[S16] round=24 local utility u=0.664155 metrics={'f1_val': 0.9196501033274617, 'auprc': 0.9886241949005262, 'loss_val': 0.36558076670530615, 'psi': 0.9472397399566874}-{'f1_val': 0.8406354141442854, 'auprc': 0.8768559438241863, 'loss_val': 0.8844987043378642, 'psi': 0.8551236260162458}
[S17] START round=24 head_norm_before_train=1.879847 (no previous merge yet)
[S17] round=24 local utility u=0.220846 metrics={'f1_val': 0.6747527399510976, 'auprc': 0.8846839894692035, 'loss_val': 0.874109078259733, 'psi': 0.7587252397583399}-{'f1_val': 0.6641269159148224, 'auprc': 0.8027784317404258, 'loss_val': 1.0063290029835188, 'psi': 0.7195875222450638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S8] not sending this round → trigger blocked (psi=0.998)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.955)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S9
[S3] cosine check vs S9: cos=0.2235
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9213
[S6] RECEIVED delta(kind=head bytes=1793) from S14
[S6] cosine check vs S14: cos=0.3701
[S15] RECEIVED delta(kind=head bytes=1796) from S3
[S15] cosine check vs S3: cos=0.3548
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.2870
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.8848
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9966 head_norm=1.525573
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.900781e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9966 head_norm=1.343466 delta_norm=0.390078
[S8] aggregate: ACCEPT kept=['S6', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=24 metric=0.9587 head_norm=1.688573
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.986389e-01
[S6] stored merged vector for next round verification (round=24)
[S6] DEBUG after merge:  round=24 metric=0.9595 head_norm=1.495494 delta_norm=0.398639
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.7007 head_norm=1.268484
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.356964e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.7006 head_norm=1.163694 delta_norm=0.935696
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9073 head_norm=1.315252
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.340102e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9080 head_norm=1.063343 delta_norm=0.734010
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.772773 cos_to_last_merge=0.9999 (last merge round=23)
[S2] round=25 local utility u=0.244329 metrics={'f1_val': 0.6839561206715592, 'auprc': 0.7301968296502123, 'loss_val': 0.7731654648777733, 'psi': 0.7024524042630205}-{'f1_val': 0.6360032979789181, 'auprc': 0.7291729744545872, 'loss_val': 0.9710346580549035, 'psi': 0.6732711685691857}
[S3] START round=25 head_norm_before_train=1.163694 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.007979 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.996479936760166, 'loss_val': 0.38727679635675194, 'psi': 0.8190005505032673}-{'f1_val': 0.7006809596653347, 'auprc': 0.9963549123879688, 'loss_val': 0.40285948374619457, 'psi': 0.8189505407543884}
[S4] START round=25 head_norm_before_train=1.738003 cos_to_last_merge=0.8304 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.949877339640792, 'auprc': 0.961871644701461, 'loss_val': 0.30428588177929344, 'psi': 0.9546750616650597}-{'f1_val': 0.9532970760098224, 'auprc': 0.95879575117228, 'loss_val': 0.300533232107097, 'psi': 0.9554965460748054}
[S5] START round=25 head_norm_before_train=1.660524 (no previous merge yet)
[S5] round=25 local utility u=0.139478 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9707199816894261, 'loss_val': 0.2596437930420775, 'psi': 0.808653028273375}-{'f1_val': 0.7006083926626743, 'auprc': 0.8947498915967993, 'loss_val': 0.31069029390305225, 'psi': 0.7782649922363243}
[S6] START round=25 head_norm_before_train=1.495494 cos_to_last_merge=1.0000 (last merge round=24)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7143737156679519, 'auprc': 0.9076655634938711, 'loss_val': 0.634455440743524, 'psi': 0.7916904547983197}-{'f1_val': 0.9587055192700664, 'auprc': 0.976061637504164, 'loss_val': 0.1965910531892141, 'psi': 0.9656479665637054}
[S7] START round=25 head_norm_before_train=1.313517 cos_to_last_merge=0.9998 (last merge round=23)
[S7] round=25 local utility u=0.140486 metrics={'f1_val': 0.6233934307564047, 'auprc': 0.7909393072218098, 'loss_val': 0.6474217687355988, 'psi': 0.6904117813425668}-{'f1_val': 0.5978598295422795, 'auprc': 0.7792136818638327, 'loss_val': 0.7400153516953724, 'psi': 0.6704013704709008}
[S8] START round=25 head_norm_before_train=1.343466 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9983513714239025, 'loss_val': 0.10494134101710609, 'psi': 0.9972345732079627}-{'f1_val': 0.9966398743144329, 'auprc': 0.9988585558124822, 'loss_val': 0.05567341121546642, 'psi': 0.9975273469136525}
[S9] START round=25 head_norm_before_train=1.688304 cos_to_last_merge=0.9996 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9987829730421949, 'loss_val': 0.06678346184263902, 'psi': 0.9966270008942419}-{'f1_val': 0.9972634903368587, 'auprc': 0.9987765664529953, 'loss_val': 0.07708353659713847, 'psi': 0.9978687207833132}
[S10] START round=25 head_norm_before_train=1.348184 cos_to_last_merge=0.9987 (last merge round=23)
[S10] round=25 local utility u=0.008460 metrics={'f1_val': 0.9926921900063811, 'auprc': 0.9935906282156065, 'loss_val': 0.07434488453382265, 'psi': 0.9930515652900712}-{'f1_val': 0.992254723717119, 'auprc': 0.9960444559206513, 'loss_val': 0.096002507669596, 'psi': 0.9937706165985319}
[S11] START round=25 head_norm_before_train=1.993600 (no previous merge yet)
[S11] round=25 local utility u=0.002504 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967105865904315, 'loss_val': 0.03545137879802023, 'psi': 0.9967697444919199}-{'f1_val': 0.996567470639547, 'auprc': 0.9966349442471487, 'loss_val': 0.038782825962382535, 'psi': 0.9965944600825878}
[S13] START round=25 head_norm_before_train=1.786102 (no previous merge yet)
[S13] round=25 local utility u=0.455170 metrics={'f1_val': 0.727628275125355, 'auprc': 0.8444513360247493, 'loss_val': 0.8607170100773817, 'psi': 0.7743574994851128}-{'f1_val': 0.6087864449101501, 'auprc': 0.803552496497963, 'loss_val': 0.9353093756803218, 'psi': 0.6866928655452753}
[S14] START round=25 head_norm_before_train=1.951862 (no previous merge yet)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969778014869274, 'loss_val': 0.024668847975438266, 'psi': 0.9972809672246635}-{'f1_val': 0.9983050875260411, 'auprc': 0.9986736205657624, 'loss_val': 0.025651154245984888, 'psi': 0.9984525007419296}
[S15] START round=25 head_norm_before_train=1.063343 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.273678 metrics={'f1_val': 0.9966587743411154, 'auprc': 0.9973993955866423, 'loss_val': 0.1637719312460654, 'psi': 0.9969550228393261}-{'f1_val': 0.9073002469420491, 'auprc': 0.9976788778520215, 'loss_val': 0.17581598064266404, 'psi': 0.9434516993060381}
[S16] START round=25 head_norm_before_train=1.886837 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8719163305104858, 'auprc': 0.890013709919241, 'loss_val': 0.6292414309042308, 'psi': 0.8791552822739879}-{'f1_val': 0.9196501033274617, 'auprc': 0.9886241949005262, 'loss_val': 0.36558076670530615, 'psi': 0.9472397399566874}
[S17] START round=25 head_norm_before_train=1.901261 (no previous merge yet)
[S17] round=25 local utility u=0.055322 metrics={'f1_val': 0.6839386238426415, 'auprc': 0.8803579745990816, 'loss_val': 0.8056018545373554, 'psi': 0.7625063641452176}-{'f1_val': 0.6747527399510976, 'auprc': 0.8846839894692035, 'loss_val': 0.874109078259733, 'psi': 0.7587252397583399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39410
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.6712
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=0.7873
[S7] RECEIVED delta(kind=head bytes=1803) from S10
[S7] cosine check vs S10: cos=0.9764
[S7] RECEIVED delta(kind=head bytes=1801) from S11
[S7] cosine check vs S11: cos=-0.0537
[S7] DROPPED delta from S11 (cos=-0.0537 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.9943
[S15] RECEIVED delta(kind=head bytes=1795) from S7
[S15] cosine check vs S7: cos=0.7097
[S15] RECEIVED delta(kind=head bytes=1796) from S13
[S15] cosine check vs S13: cos=-0.0678
[S15] DROPPED delta from S13 (cos=-0.0678 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.763)
[S4] ⇄ pheromone p=0.033 → S2@127.0.0.1:39402
[S3] ⇄ pheromone p=0.051 → S15@127.0.0.1:39415
[S6] ⇄ pheromone p=0.265 → S8@127.0.0.1:39409
[S14] ⇄ pheromone p=0.053 → S6@127.0.0.1:39407
[S8] ⇄ pheromone p=0.032 → S3@127.0.0.1:39403
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9952 head_norm=1.713572
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.281636e-02
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9948 head_norm=1.691019 delta_norm=0.092816
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.038 → S3@127.0.0.1:39403
[S11] ⇄ pheromone p=0.030 → S7@127.0.0.1:39408
[S5] ⇄ pheromone p=0.097 → S9@127.0.0.1:39410
[S2] ⇄ pheromone p=0.138 → S10@127.0.0.1:39411
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9927 head_norm=1.413549
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.804852e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9927 head_norm=1.269785 delta_norm=0.280485
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.026 → S7@127.0.0.1:39408
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=25 metric=0.6234 head_norm=1.328432
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.547197e-01
[S7] stored merged vector for next round verification (round=25)
[S7] DEBUG after merge:  round=25 metric=0.6201 head_norm=1.362897 delta_norm=0.154720
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.194 → S15@127.0.0.1:39415
[S13] ⇄ pheromone p=0.155 → S15@127.0.0.1:39415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=25 metric=0.9967 head_norm=1.132824
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.775091e-01
[S15] stored merged vector for next round verification (round=25)
[S15] DEBUG after merge:  round=25 metric=0.9904 head_norm=1.138418 delta_norm=0.477509
[S15] aggregate: ROLLBACK (f1_val pre=0.997 post=0.990 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.171 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=0.293 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.140 → S8@127.0.0.1:39409
[S2] START round=26 head_norm_before_train=1.790391 cos_to_last_merge=0.9997 (last merge round=23)
[S2] round=26 local utility u=0.113295 metrics={'f1_val': 0.7088256240113165, 'auprc': 0.7383253072194108, 'loss_val': 0.7201770846014204, 'psi': 0.7206254972945543}-{'f1_val': 0.6839561206715592, 'auprc': 0.7301968296502123, 'loss_val': 0.7731654648777733, 'psi': 0.7024524042630205}
[S3] START round=26 head_norm_before_train=1.205666 cos_to_last_merge=0.9969 (last merge round=24)
[S3] round=26 local utility u=0.019449 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9956983103751009, 'loss_val': 0.34603426716049307, 'psi': 0.8186878999492413}-{'f1_val': 0.7006809596653347, 'auprc': 0.996479936760166, 'loss_val': 0.38727679635675194, 'psi': 0.8190005505032673}
[S4] START round=26 head_norm_before_train=1.750265 cos_to_last_merge=0.8293 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.829
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9160643463028665, 'auprc': 0.9234204586460159, 'loss_val': 0.4099362204738336, 'psi': 0.9190067912401263}-{'f1_val': 0.949877339640792, 'auprc': 0.961871644701461, 'loss_val': 0.30428588177929344, 'psi': 0.9546750616650597}
[S5] START round=26 head_norm_before_train=1.673318 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6372057776392247, 'auprc': 0.8840359818842821, 'loss_val': 0.3496539968798887, 'psi': 0.7359378593372476}-{'f1_val': 0.7006083926626743, 'auprc': 0.9707199816894261, 'loss_val': 0.2596437930420775, 'psi': 0.808653028273375}
[S6] START round=26 head_norm_before_train=1.531814 cos_to_last_merge=0.9994 (last merge round=24)
[S6] round=26 local utility u=0.362412 metrics={'f1_val': 0.7994509039295336, 'auprc': 0.9079995680009132, 'loss_val': 0.4210969605618743, 'psi': 0.8428703695580855}-{'f1_val': 0.7143737156679519, 'auprc': 0.9076655634938711, 'loss_val': 0.634455440743524, 'psi': 0.7916904547983197}
[S7] START round=26 head_norm_before_train=1.362897 cos_to_last_merge=1.0000 (last merge round=25)
[S7] round=26 local utility u=0.525253 metrics={'f1_val': 0.6929841459890713, 'auprc': 0.907098136410327, 'loss_val': 0.3629362654476249, 'psi': 0.7786297421575736}-{'f1_val': 0.6233934307564047, 'auprc': 0.7909393072218098, 'loss_val': 0.6474217687355988, 'psi': 0.6904117813425668}
[S8] START round=26 head_norm_before_train=1.392586 cos_to_last_merge=0.9989 (last merge round=24)
[S8] round=26 local utility u=0.012443 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9988097442154931, 'loss_val': 0.07970850530854014, 'psi': 0.9972457597262889}-{'f1_val': 0.9964900410640029, 'auprc': 0.9983513714239025, 'loss_val': 0.10494134101710609, 'psi': 0.9972345732079627}
[S9] START round=26 head_norm_before_train=1.691019 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9949321389169683, 'loss_val': 0.06958631142087084, 'psi': 0.9964997895731735}-{'f1_val': 0.99518968612894, 'auprc': 0.9987829730421949, 'loss_val': 0.06678346184263902, 'psi': 0.9966270008942419}
[S10] START round=26 head_norm_before_train=1.269785 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9929110311196298, 'auprc': 0.9954074993107263, 'loss_val': 0.0978385943493854, 'psi': 0.9939096183960683}-{'f1_val': 0.9926921900063811, 'auprc': 0.9935906282156065, 'loss_val': 0.07434488453382265, 'psi': 0.9930515652900712}
[S11] START round=26 head_norm_before_train=2.008240 (no previous merge yet)
[S11] round=26 local utility u=0.000662 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966730805444561, 'loss_val': 0.03256360953174726, 'psi': 0.9966097146015107}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967105865904315, 'loss_val': 0.03545137879802023, 'psi': 0.9967697444919199}
[S13] START round=26 head_norm_before_train=1.793091 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.6347130620832537, 'auprc': 0.8561304216179841, 'loss_val': 0.8820200756242509, 'psi': 0.7232800058971459}-{'f1_val': 0.727628275125355, 'auprc': 0.8444513360247493, 'loss_val': 0.8607170100773817, 'psi': 0.7743574994851128}
[S14] START round=26 head_norm_before_train=1.961848 (no previous merge yet)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9969780160779282, 'loss_val': 0.025167961527534723, 'psi': 0.9971357240853747}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969778014869274, 'loss_val': 0.024668847975438266, 'psi': 0.9972809672246635}
[S15] START round=26 head_norm_before_train=1.138418 cos_to_last_merge=1.0000 (last merge round=25)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.9639503738637326, 'auprc': 0.9980987187612165, 'loss_val': 0.13067813670520953, 'psi': 0.9776097118227263}-{'f1_val': 0.9966587743411154, 'auprc': 0.9973993955866423, 'loss_val': 0.1637719312460654, 'psi': 0.9969550228393261}
[S16] START round=26 head_norm_before_train=1.899279 (no previous merge yet)
[S16] round=26 local utility u=0.459557 metrics={'f1_val': 0.9287699747190021, 'auprc': 0.9847213440961596, 'loss_val': 0.3353720373163772, 'psi': 0.9511505224698651}-{'f1_val': 0.8719163305104858, 'auprc': 0.890013709919241, 'loss_val': 0.6292414309042308, 'psi': 0.8791552822739879}
[S17] START round=26 head_norm_before_train=1.914895 (no previous merge yet)
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6760394089647377, 'auprc': 0.807535313441316, 'loss_val': 0.8869678416824184, 'psi': 0.7286377707553691}-{'f1_val': 0.6839386238426415, 'auprc': 0.8803579745990816, 'loss_val': 0.8056018545373554, 'psi': 0.7625063641452176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39407
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.779)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.721)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:39409
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S6
[S8] cosine check vs S6: cos=0.4412
[S3] RECEIVED delta(kind=head bytes=1795) from S8
[S3] cosine check vs S8: cos=0.4584
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=0.8368
[S15] RECEIVED delta(kind=head bytes=1803) from S3
[S15] cosine check vs S3: cos=0.4013
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=26 metric=0.7995 head_norm=1.567217
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.233614e-01
[S6] stored merged vector for next round verification (round=26)
[S6] DEBUG after merge:  round=26 metric=0.8220 head_norm=1.667423 delta_norm=0.523361
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.7007 head_norm=1.246656
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.059679e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.7007 head_norm=1.151147 delta_norm=0.705968
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9962 head_norm=1.446690
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.981631e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9961 head_norm=1.279639 delta_norm=0.798163
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=26 metric=0.9640 head_norm=1.209987
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.722158e-01
[S15] stored merged vector for next round verification (round=26)
[S15] DEBUG after merge:  round=26 metric=0.9658 head_norm=1.028220 delta_norm=0.672216
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.810186 cos_to_last_merge=0.9994 (last merge round=23)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.6633541686731632, 'auprc': 0.7415457422046534, 'loss_val': 0.9304955425931762, 'psi': 0.6946307980857593}-{'f1_val': 0.7088256240113165, 'auprc': 0.7383253072194108, 'loss_val': 0.7201770846014204, 'psi': 0.7206254972945543}
[S3] START round=27 head_norm_before_train=1.151147 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9955768257299803, 'loss_val': 0.34998546056525176, 'psi': 0.8185943317921155}-{'f1_val': 0.7006809596653347, 'auprc': 0.9956983103751009, 'loss_val': 0.34603426716049307, 'psi': 0.8186878999492413}
[S4] START round=27 head_norm_before_train=1.764791 cos_to_last_merge=0.8281 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=27 local utility u=0.126935 metrics={'f1_val': 0.9420899334061354, 'auprc': 0.9311403927014953, 'loss_val': 0.33537946040003025, 'psi': 0.9377101171242794}-{'f1_val': 0.9160643463028665, 'auprc': 0.9234204586460159, 'loss_val': 0.4099362204738336, 'psi': 0.9190067912401263}
[S5] START round=27 head_norm_before_train=1.688577 (no previous merge yet)
[S5] round=27 local utility u=0.296257 metrics={'f1_val': 0.6835101726341298, 'auprc': 0.9601102159505146, 'loss_val': 0.2631893755703918, 'psi': 0.7941501899606838}-{'f1_val': 0.6372057776392247, 'auprc': 0.8840359818842821, 'loss_val': 0.3496539968798887, 'psi': 0.7359378593372476}
[S6] START round=27 head_norm_before_train=1.667423 cos_to_last_merge=1.0000 (last merge round=26)
[S6] round=27 local utility u=0.551682 metrics={'f1_val': 0.9460410338148744, 'auprc': 0.9471414549356304, 'loss_val': 0.31469937493440886, 'psi': 0.9464812022631768}-{'f1_val': 0.7994509039295336, 'auprc': 0.9079995680009132, 'loss_val': 0.4210969605618743, 'psi': 0.8428703695580855}
[S7] START round=27 head_norm_before_train=1.377564 cos_to_last_merge=0.9998 (last merge round=25)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.39206521534464506, 'auprc': 0.7648768017836751, 'loss_val': 1.2991558797386116, 'psi': 0.5411898499202571}-{'f1_val': 0.6929841459890713, 'auprc': 0.907098136410327, 'loss_val': 0.3629362654476249, 'psi': 0.7786297421575736}
[S8] START round=27 head_norm_before_train=1.279639 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9975028001186252, 'loss_val': 0.18166072909033273, 'psi': 0.9968951446858518}-{'f1_val': 0.9962031034001528, 'auprc': 0.9988097442154931, 'loss_val': 0.07970850530854014, 'psi': 0.9972457597262889}
[S9] START round=27 head_norm_before_train=1.714998 cos_to_last_merge=0.9998 (last merge round=25)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9987857280271615, 'loss_val': 0.06780540191995074, 'psi': 0.9938573962705997}-{'f1_val': 0.9975448900106438, 'auprc': 0.9949321389169683, 'loss_val': 0.06958631142087084, 'psi': 0.9964997895731735}
[S10] START round=27 head_norm_before_train=1.337945 cos_to_last_merge=0.9983 (last merge round=25)
[S10] round=27 local utility u=0.009939 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9935780993307826, 'loss_val': 0.07378531275732607, 'psi': 0.9933092064836637}-{'f1_val': 0.9929110311196298, 'auprc': 0.9954074993107263, 'loss_val': 0.0978385943493854, 'psi': 0.9939096183960683}
[S11] START round=27 head_norm_before_train=2.025287 (no previous merge yet)
[S11] round=27 local utility u=0.000692 metrics={'f1_val': 0.996567470639547, 'auprc': 0.996504182762238, 'loss_val': 0.030672937560450194, 'psi': 0.9965421554886233}-{'f1_val': 0.996567470639547, 'auprc': 0.9966730805444561, 'loss_val': 0.03256360953174726, 'psi': 0.9966097146015107}
[S13] START round=27 head_norm_before_train=1.799021 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6215926404682679, 'auprc': 0.7610706740337736, 'loss_val': 0.8625446574297874, 'psi': 0.6773838538944701}-{'f1_val': 0.6347130620832537, 'auprc': 0.8561304216179841, 'loss_val': 0.8820200756242509, 'psi': 0.7232800058971459}
[S14] START round=27 head_norm_before_train=1.970358 (no previous merge yet)
[S14] round=27 local utility u=0.001061 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9986731049117668, 'loss_val': 0.02813070164057285, 'psi': 0.9978137596189101}-{'f1_val': 0.9972408627570057, 'auprc': 0.9969780160779282, 'loss_val': 0.025167961527534723, 'psi': 0.9971357240853747}
[S15] START round=27 head_norm_before_train=1.028220 cos_to_last_merge=1.0000 (last merge round=26)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8891393662455023, 'auprc': 0.9951788987718146, 'loss_val': 0.3429875022797133, 'psi': 0.9315551792560272}-{'f1_val': 0.9639503738637326, 'auprc': 0.9980987187612165, 'loss_val': 0.13067813670520953, 'psi': 0.9776097118227263}
[S16] START round=27 head_norm_before_train=1.911085 (no previous merge yet)
[S16] round=27 local utility u=0.120476 metrics={'f1_val': 0.9406470196689609, 'auprc': 0.9881804637796496, 'loss_val': 0.17605899145167572, 'psi': 0.9596603973132365}-{'f1_val': 0.9287699747190021, 'auprc': 0.9847213440961596, 'loss_val': 0.3353720373163772, 'psi': 0.9511505224698651}
[S17] START round=27 head_norm_before_train=1.929189 (no previous merge yet)
[S17] round=27 local utility u=0.738037 metrics={'f1_val': 0.7489330192604802, 'auprc': 0.9890708917662343, 'loss_val': 0.3928615896148501, 'psi': 0.8449881682627818}-{'f1_val': 0.6760394089647377, 'auprc': 0.807535313441316, 'loss_val': 0.8869678416824184, 'psi': 0.7286377707553691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:39410
[S6] not sending this round → trigger blocked (psi=0.946)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39407
[S16] not sending this round → trigger blocked (psi=0.960)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=0.3032
[S7] RECEIVED delta(kind=head bytes=1795) from S11
[S7] cosine check vs S11: cos=-0.0540
[S7] DROPPED delta from S11 (cos=-0.0540 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] cosine check vs S4: cos=0.9924
[S7] RECEIVED delta(kind=head bytes=1802) from S10
[S7] cosine check vs S10: cos=0.9763
[S9] RECEIVED delta(kind=head bytes=1804) from S5
[S9] cosine check vs S5: cos=0.9947
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.4748
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.6634 head_norm=1.834319
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.152659e-01
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.6643 head_norm=1.801719 delta_norm=0.115266
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=27 metric=0.9906 head_norm=1.738924
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.989186e-02
[S9] stored merged vector for next round verification (round=27)
[S9] DEBUG after merge:  round=27 metric=0.9906 head_norm=1.719670 delta_norm=0.089892
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9965 head_norm=1.349045
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.824002e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.423160 delta_norm=0.882400
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.9460 head_norm=1.695253
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.090955e+00
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.9365 head_norm=1.486021 delta_norm=1.090955
[S6] aggregate: ROLLBACK (f1_val pre=0.946 post=0.936 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.3921 head_norm=1.394842
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.524349e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.3917 head_norm=1.392127 delta_norm=0.152435
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.801719 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.127416 metrics={'f1_val': 0.6802237217323491, 'auprc': 0.7370032397992767, 'loss_val': 0.7632536869142709, 'psi': 0.7029355289591201}-{'f1_val': 0.6633541686731632, 'auprc': 0.7415457422046534, 'loss_val': 0.9304955425931762, 'psi': 0.6946307980857593}
[S3] START round=28 head_norm_before_train=1.188839 cos_to_last_merge=0.9978 (last merge round=26)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9912615155082678, 'loss_val': 0.34533261150997246, 'psi': 0.8168682077034305}-{'f1_val': 0.7006060025002057, 'auprc': 0.9955768257299803, 'loss_val': 0.34998546056525176, 'psi': 0.8185943317921155}
[S4] START round=28 head_norm_before_train=1.776014 cos_to_last_merge=0.8273 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.8227031389345786, 'auprc': 0.9169915742990837, 'loss_val': 0.46789068775836085, 'psi': 0.8604185130803806}-{'f1_val': 0.9420899334061354, 'auprc': 0.9311403927014953, 'loss_val': 0.33537946040003025, 'psi': 0.9377101171242794}
[S5] START round=28 head_norm_before_train=1.704944 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.6312473292520987, 'auprc': 0.85389375112823, 'loss_val': 0.47399567918297425, 'psi': 0.7203058980025512}-{'f1_val': 0.6835101726341298, 'auprc': 0.9601102159505146, 'loss_val': 0.2631893755703918, 'psi': 0.7941501899606838}
[S6] START round=28 head_norm_before_train=1.486021 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.8205210983709117, 'auprc': 0.9227905250583235, 'loss_val': 0.4004180172865311, 'psi': 0.8614288690458765}-{'f1_val': 0.9460410338148744, 'auprc': 0.9471414549356304, 'loss_val': 0.31469937493440886, 'psi': 0.9464812022631768}
[S7] START round=28 head_norm_before_train=1.392127 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=1.000000 metrics={'f1_val': 0.6717316783784377, 'auprc': 0.830748175623756, 'loss_val': 0.493336022423478, 'psi': 0.7353382772765651}-{'f1_val': 0.39206521534464506, 'auprc': 0.7648768017836751, 'loss_val': 1.2991558797386116, 'psi': 0.5411898499202571}
[S8] START round=28 head_norm_before_train=1.423160 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9790443240359732, 'auprc': 0.9967732638383638, 'loss_val': 0.11969637904857118, 'psi': 0.9861358999569294}-{'f1_val': 0.9964900410640029, 'auprc': 0.9975028001186252, 'loss_val': 0.18166072909033273, 'psi': 0.9968951446858518}
[S9] START round=28 head_norm_before_train=1.719670 cos_to_last_merge=1.0000 (last merge round=27)
[S9] round=28 local utility u=0.017573 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9950726884593093, 'loss_val': 0.06335951416145526, 'psi': 0.99655600939011}-{'f1_val': 0.9905718417662249, 'auprc': 0.9987857280271615, 'loss_val': 0.06780540191995074, 'psi': 0.9938573962705997}
[S10] START round=28 head_norm_before_train=1.406031 cos_to_last_merge=0.9943 (last merge round=25)
[S10] round=28 local utility u=0.008277 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9947641809031216, 'loss_val': 0.06079016863532902, 'psi': 0.9937836391125993}-{'f1_val': 0.9931299445855843, 'auprc': 0.9935780993307826, 'loss_val': 0.07378531275732607, 'psi': 0.9933092064836637}
[S11] START round=28 head_norm_before_train=2.043369 (no previous merge yet)
[S11] round=28 local utility u=0.002060 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966418665140712, 'loss_val': 0.02841609955674054, 'psi': 0.9967422564613757}-{'f1_val': 0.996567470639547, 'auprc': 0.996504182762238, 'loss_val': 0.030672937560450194, 'psi': 0.9965421554886233}
[S13] START round=28 head_norm_before_train=1.803603 (no previous merge yet)
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.6233593720875495, 'auprc': 0.7476502336254687, 'loss_val': 0.927171217454146, 'psi': 0.6730757167027173}-{'f1_val': 0.6215926404682679, 'auprc': 0.7610706740337736, 'loss_val': 0.8625446574297874, 'psi': 0.6773838538944701}
[S14] START round=28 head_norm_before_train=1.980657 (no previous merge yet)
[S14] round=28 local utility u=0.003125 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9986732302152517, 'loss_val': 0.023333558493072754, 'psi': 0.9979591387159933}-{'f1_val': 0.9972408627570057, 'auprc': 0.9986731049117668, 'loss_val': 0.02813070164057285, 'psi': 0.9978137596189101}
[S15] START round=28 head_norm_before_train=1.077892 cos_to_last_merge=0.9964 (last merge round=26)
[S15] round=28 local utility u=0.285793 metrics={'f1_val': 0.9541346142835002, 'auprc': 0.9985077171475842, 'loss_val': 0.17135957466646182, 'psi': 0.9718838554291338}-{'f1_val': 0.8891393662455023, 'auprc': 0.9951788987718146, 'loss_val': 0.3429875022797133, 'psi': 0.9315551792560272}
[S16] START round=28 head_norm_before_train=1.919412 (no previous merge yet)
[S16] round=28 local utility u=0.221413 metrics={'f1_val': 0.9924481309051538, 'auprc': 0.990777267389854, 'loss_val': 0.0518302808603442, 'psi': 0.9917797854990339}-{'f1_val': 0.9406470196689609, 'auprc': 0.9881804637796496, 'loss_val': 0.17605899145167572, 'psi': 0.9596603973132365}
[S17] START round=28 head_norm_before_train=1.946306 (no previous merge yet)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6664010517307386, 'auprc': 0.8849918640386973, 'loss_val': 0.9985761427320297, 'psi': 0.7538373766539221}-{'f1_val': 0.7489330192604802, 'auprc': 0.9890708917662343, 'loss_val': 0.3928615896148501, 'psi': 0.8449881682627818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39407
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39407
[S2] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1805) from S2
[S10] cosine check vs S2: cos=0.7927
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.7160
[S7] RECEIVED delta(kind=head bytes=1797) from S11
[S7] cosine check vs S11: cos=-0.0537
[S7] DROPPED delta from S11 (cos=-0.0537 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.9940
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.4157
[S15] RECEIVED delta(kind=head bytes=1803) from S7
[S15] cosine check vs S7: cos=0.7203
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.5837
[S6] RECEIVED delta(kind=head bytes=1794) from S14
[S6] cosine check vs S14: cos=0.8365
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.8205 head_norm=1.517465
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.526648e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.8198 head_norm=1.463493 delta_norm=0.152665
[S6] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.7006 head_norm=1.229727
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.306534e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.7006 head_norm=1.256644 delta_norm=0.830653
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9931 head_norm=1.462709
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.768598e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9931 head_norm=1.318572 delta_norm=0.276860
[S10] aggregate: ACCEPT kept=['S2', 'S15'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.9541 head_norm=1.159273
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.925853e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.9459 head_norm=1.189563 delta_norm=0.492585
[S15] aggregate: ROLLBACK (f1_val pre=0.954 post=0.946 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6717 head_norm=1.404097
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.360884e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6722 head_norm=1.431263 delta_norm=0.083609
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.819608 cos_to_last_merge=0.9999 (last merge round=27)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.625141079993754, 'auprc': 0.7302470850816993, 'loss_val': 1.1088484097741982, 'psi': 0.6671834820289322}-{'f1_val': 0.6802237217323491, 'auprc': 0.7370032397992767, 'loss_val': 0.7632536869142709, 'psi': 0.7029355289591201}
[S3] START round=29 head_norm_before_train=1.256644 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.017399 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9960140786917207, 'loss_val': 0.3247917630646284, 'psi': 0.8187692329768117}-{'f1_val': 0.7006060025002057, 'auprc': 0.9912615155082678, 'loss_val': 0.34533261150997246, 'psi': 0.8168682077034305}
[S4] START round=29 head_norm_before_train=1.783538 cos_to_last_merge=0.8266 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=29 local utility u=0.545041 metrics={'f1_val': 0.9544026136155431, 'auprc': 0.9628973226470228, 'loss_val': 0.30572208186635064, 'psi': 0.957800497228135}-{'f1_val': 0.8227031389345786, 'auprc': 0.9169915742990837, 'loss_val': 0.46789068775836085, 'psi': 0.8604185130803806}
[S5] START round=29 head_norm_before_train=1.721842 (no previous merge yet)
[S5] round=29 local utility u=0.556357 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9887235079363512, 'loss_val': 0.18194193779992204, 'psi': 0.815854859578009}-{'f1_val': 0.6312473292520987, 'auprc': 0.85389375112823, 'loss_val': 0.47399567918297425, 'psi': 0.7203058980025512}
[S6] START round=29 head_norm_before_train=1.463493 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7386313926999611, 'auprc': 0.7892058653556085, 'loss_val': 0.6927428128581136, 'psi': 0.7588611817622202}-{'f1_val': 0.8205210983709117, 'auprc': 0.9227905250583235, 'loss_val': 0.4004180172865311, 'psi': 0.8614288690458765}
[S7] START round=29 head_norm_before_train=1.431263 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5787363209477848, 'auprc': 0.7807082539272201, 'loss_val': 0.8106114272926345, 'psi': 0.659525094139559}-{'f1_val': 0.6717316783784377, 'auprc': 0.830748175623756, 'loss_val': 0.493336022423478, 'psi': 0.7353382772765651}
[S8] START round=29 head_norm_before_train=1.502430 cos_to_last_merge=0.9973 (last merge round=27)
[S8] round=29 local utility u=0.071299 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9989812080960627, 'loss_val': 0.06992595277667833, 'psi': 0.9956394883292526}-{'f1_val': 0.9790443240359732, 'auprc': 0.9967732638383638, 'loss_val': 0.11969637904857118, 'psi': 0.9861358999569294}
[S9] START round=29 head_norm_before_train=1.739554 cos_to_last_merge=0.9998 (last merge round=27)
[S9] round=29 local utility u=0.010832 metrics={'f1_val': 0.9977054698366968, 'auprc': 0.9988652554781468, 'loss_val': 0.05403627547256295, 'psi': 0.9981693840932768}-{'f1_val': 0.9975448900106438, 'auprc': 0.9950726884593093, 'loss_val': 0.06335951416145526, 'psi': 0.99655600939011}
[S10] START round=29 head_norm_before_train=1.318572 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9917564263803667, 'loss_val': 0.08438007056980859, 'psi': 0.9932379347769282}-{'f1_val': 0.9931299445855843, 'auprc': 0.9947641809031216, 'loss_val': 0.06079016863532902, 'psi': 0.9937836391125993}
[S11] START round=29 head_norm_before_train=2.061733 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9946473456433758, 'loss_val': 0.03989674325037439, 'psi': 0.9957089266617548}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966418665140712, 'loss_val': 0.02841609955674054, 'psi': 0.9967422564613757}
[S13] START round=29 head_norm_before_train=1.812070 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6035234115062518, 'auprc': 0.7284840005384485, 'loss_val': 1.0970933581538667, 'psi': 0.6535076471191305}-{'f1_val': 0.6233593720875495, 'auprc': 0.7476502336254687, 'loss_val': 0.927171217454146, 'psi': 0.6730757167027173}
[S14] START round=29 head_norm_before_train=1.990891 (no previous merge yet)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9508998127114459, 'auprc': 0.9969782193994399, 'loss_val': 0.0689906959946881, 'psi': 0.9693311753866434}-{'f1_val': 0.9974830777164877, 'auprc': 0.9986732302152517, 'loss_val': 0.023333558493072754, 'psi': 0.9979591387159933}
[S15] START round=29 head_norm_before_train=1.189563 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.906567976608854, 'auprc': 0.997589444873554, 'loss_val': 0.2199158295372417, 'psi': 0.9429765639147341}-{'f1_val': 0.9541346142835002, 'auprc': 0.9985077171475842, 'loss_val': 0.17135957466646182, 'psi': 0.9718838554291338}
[S16] START round=29 head_norm_before_train=1.930348 (no previous merge yet)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.883128247209233, 'auprc': 0.9876074871687208, 'loss_val': 0.527395562175522, 'psi': 0.9249199431930282}-{'f1_val': 0.9924481309051538, 'auprc': 0.990777267389854, 'loss_val': 0.0518302808603442, 'psi': 0.9917797854990339}
[S17] START round=29 head_norm_before_train=1.961156 (no previous merge yet)
[S17] round=29 local utility u=1.000000 metrics={'f1_val': 0.9066501124490105, 'auprc': 0.9880381603156855, 'loss_val': 0.20574615480002872, 'psi': 0.9392053315956805}-{'f1_val': 0.6664010517307386, 'auprc': 0.8849918640386973, 'loss_val': 0.9985761427320297, 'psi': 0.7538373766539221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:39410
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39402
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S8
[S3] cosine check vs S8: cos=0.3739
[S9] RECEIVED delta(kind=head bytes=1806) from S5
[S9] cosine check vs S5: cos=0.9959
[S2] RECEIVED delta(kind=head bytes=1803) from S4
[S2] cosine check vs S4: cos=0.9960
[S15] RECEIVED delta(kind=head bytes=1802) from S3
[S15] cosine check vs S3: cos=0.4830
[S3] RECEIVED delta(kind=head bytes=1801) from S9
[S3] cosine check vs S9: cos=0.8866
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=0.8947
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.6251 head_norm=1.835844
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.472544e-02
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.6263 head_norm=1.808740 delta_norm=0.084725
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=29 metric=0.9066 head_norm=1.267906
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.504914e-01
[S15] stored merged vector for next round verification (round=29)
[S15] DEBUG after merge:  round=29 metric=0.9066 head_norm=1.101553 delta_norm=0.650491
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9977 head_norm=1.760133
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.034031e-02
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9977 head_norm=1.744551 delta_norm=0.080340
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=29 metric=0.7006 head_norm=1.290553
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.228903e-01
[S3] stored merged vector for next round verification (round=29)
[S3] DEBUG after merge:  round=29 metric=0.7006 head_norm=1.196344 delta_norm=0.222890
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9934 head_norm=1.552444
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.529971e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9934 head_norm=1.716041 delta_norm=0.452997
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.808740 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.346524 metrics={'f1_val': 0.6777587854594418, 'auprc': 0.7328294940438652, 'loss_val': 0.7392529651049681, 'psi': 0.6997870688932112}-{'f1_val': 0.625141079993754, 'auprc': 0.7302470850816993, 'loss_val': 1.1088484097741982, 'psi': 0.6671834820289322}
[S3] START round=30 head_norm_before_train=1.196344 cos_to_last_merge=1.0000 (last merge round=29)
[S3] round=30 local utility u=0.006943 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9965402696009897, 'loss_val': 0.3124846552832393, 'psi': 0.8189797093405193}-{'f1_val': 0.7006060025002057, 'auprc': 0.9960140786917207, 'loss_val': 0.3247917630646284, 'psi': 0.8187692329768117}
[S4] START round=30 head_norm_before_train=1.785249 cos_to_last_merge=0.8272 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9535743827962103, 'auprc': 0.9494849950029927, 'loss_val': 0.3034666682121411, 'psi': 0.9519386276789232}-{'f1_val': 0.9544026136155431, 'auprc': 0.9628973226470228, 'loss_val': 0.30572208186635064, 'psi': 0.957800497228135}
[S5] START round=30 head_norm_before_train=1.732558 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.43410833684294303, 'auprc': 0.8528481915694427, 'loss_val': 0.834525192955481, 'psi': 0.6016042787335429}-{'f1_val': 0.7006090940057808, 'auprc': 0.9887235079363512, 'loss_val': 0.18194193779992204, 'psi': 0.815854859578009}
[S6] START round=30 head_norm_before_train=1.498391 cos_to_last_merge=0.9994 (last merge round=28)
[S6] round=30 local utility u=0.998301 metrics={'f1_val': 0.9330667548784877, 'auprc': 0.9291939065866749, 'loss_val': 0.2827166436519669, 'psi': 0.9315176155617626}-{'f1_val': 0.7386313926999611, 'auprc': 0.7892058653556085, 'loss_val': 0.6927428128581136, 'psi': 0.7588611817622202}
[S7] START round=30 head_norm_before_train=1.450221 cos_to_last_merge=0.9997 (last merge round=28)
[S7] round=30 local utility u=0.679717 metrics={'f1_val': 0.6922140280096721, 'auprc': 0.8619032206253194, 'loss_val': 0.37562903981308066, 'psi': 0.7600897050559311}-{'f1_val': 0.5787363209477848, 'auprc': 0.7807082539272201, 'loss_val': 0.8106114272926345, 'psi': 0.659525094139559}
[S8] START round=30 head_norm_before_train=1.716041 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.018091 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9994732097889554, 'loss_val': 0.05369024950279547, 'psi': 0.9976833085539838}-{'f1_val': 0.9934116751513793, 'auprc': 0.9989812080960627, 'loss_val': 0.06992595277667833, 'psi': 0.9956394883292526}
[S9] START round=30 head_norm_before_train=1.744551 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9964645815439231, 'auprc': 0.9987906500160888, 'loss_val': 0.05901372868361785, 'psi': 0.9973950089327894}-{'f1_val': 0.9977054698366968, 'auprc': 0.9988652554781468, 'loss_val': 0.05403627547256295, 'psi': 0.9981693840932768}
[S10] START round=30 head_norm_before_train=1.376701 cos_to_last_merge=0.9989 (last merge round=28)
[S10] round=30 local utility u=0.007059 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.993220735626271, 'loss_val': 0.06808080704795963, 'psi': 0.993166261001859}-{'f1_val': 0.9942256070413027, 'auprc': 0.9917564263803667, 'loss_val': 0.08438007056980859, 'psi': 0.9932379347769282}
[S11] START round=30 head_norm_before_train=2.078726 (no previous merge yet)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.8295489960359813, 'auprc': 0.9942355622584443, 'loss_val': 0.23468843722505542, 'psi': 0.8954236225249665}-{'f1_val': 0.9964166473406741, 'auprc': 0.9946473456433758, 'loss_val': 0.03989674325037439, 'psi': 0.9957089266617548}
[S13] START round=30 head_norm_before_train=1.822559 (no previous merge yet)
[S13] round=30 local utility u=0.074033 metrics={'f1_val': 0.6166688517733973, 'auprc': 0.737218500769031, 'loss_val': 1.0541025440940175, 'psi': 0.6648887113716507}-{'f1_val': 0.6035234115062518, 'auprc': 0.7284840005384485, 'loss_val': 1.0970933581538667, 'psi': 0.6535076471191305}
[S14] START round=30 head_norm_before_train=2.000384 (no previous merge yet)
[S14] round=30 local utility u=0.160610 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9986734057098156, 'loss_val': 0.025878656271579856, 'psi': 0.9973114126877272}-{'f1_val': 0.9508998127114459, 'auprc': 0.9969782193994399, 'loss_val': 0.0689906959946881, 'psi': 0.9693311753866434}
[S15] START round=30 head_norm_before_train=1.101553 cos_to_last_merge=1.0000 (last merge round=29)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.8105455660277054, 'auprc': 0.9939357348382121, 'loss_val': 0.35329437666718677, 'psi': 0.8839016335519081}-{'f1_val': 0.906567976608854, 'auprc': 0.997589444873554, 'loss_val': 0.2199158295372417, 'psi': 0.9429765639147341}
[S16] START round=30 head_norm_before_train=1.942545 (no previous merge yet)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8474213505723032, 'auprc': 0.9072060224102634, 'loss_val': 0.8790832154698055, 'psi': 0.8713352193074873}-{'f1_val': 0.883128247209233, 'auprc': 0.9876074871687208, 'loss_val': 0.527395562175522, 'psi': 0.9249199431930282}
[S17] START round=30 head_norm_before_train=1.972290 (no previous merge yet)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6910587008991155, 'auprc': 0.8932604072268556, 'loss_val': 1.0097837253160462, 'psi': 0.7719393834302115}-{'f1_val': 0.9066501124490105, 'auprc': 0.9880381603156855, 'loss_val': 0.20574615480002872, 'psi': 0.9392053315956805}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39411
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.998)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:39415
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[S14] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S2
[S10] cosine check vs S2: cos=0.8192
[S7] RECEIVED delta(kind=head bytes=1801) from S10
[S7] cosine check vs S10: cos=0.9869
[S15] RECEIVED delta(kind=head bytes=1798) from S13
[S15] cosine check vs S13: cos=-0.0438
[S15] DROPPED delta from S13 (cos=-0.0438 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1805) from S7
[S15] cosine check vs S7: cos=0.7112
[S6] RECEIVED delta(kind=head bytes=1799) from S14
[S6] cosine check vs S14: cos=0.7862
[S8] RECEIVED delta(kind=head bytes=1800) from S6
[S8] cosine check vs S6: cos=0.1052
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] ⇄ pheromone p=0.016 → S3@127.0.0.1:39403
[S4] ⇄ pheromone p=0.111 → S2@127.0.0.1:39402
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9965 head_norm=1.743990
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.099049e+00
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9965 head_norm=1.220384 delta_norm=1.099049
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.027 → S3@127.0.0.1:39403
[S3] ⇄ pheromone p=0.022 → S15@127.0.0.1:39415
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.8105 head_norm=1.182318
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.204015e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.8064 head_norm=1.226617 delta_norm=0.520401
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.093 → S10@127.0.0.1:39411
[S11] ⇄ pheromone p=0.010 → S7@127.0.0.1:39408
[S5] ⇄ pheromone p=0.151 → S9@127.0.0.1:39410
[S14] ⇄ pheromone p=0.050 → S6@127.0.0.1:39407
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=30 metric=0.6922 head_norm=1.467289
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.183459e-01
[S7] stored merged vector for next round verification (round=30)
[S7] DEBUG after merge:  round=30 metric=0.6971 head_norm=1.448932 delta_norm=0.118346
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.370 → S15@127.0.0.1:39415
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.9331 head_norm=1.533947
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.218160e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.9323 head_norm=1.676954 delta_norm=0.621816
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.373 → S8@127.0.0.1:39409
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9931 head_norm=1.440097
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.236143e-01
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9931 head_norm=1.557293 delta_norm=0.523614
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.012 → S7@127.0.0.1:39408
[S13] ⇄ pheromone p=0.066 → S15@127.0.0.1:39415
[S2] ⇄ pheromone p=0.140 → S10@127.0.0.1:39411
[S16] ⇄ pheromone p=0.174 → S6@127.0.0.1:39407
[S17] ⇄ pheromone p=0.281 → S8@127.0.0.1:39409
[S2] START round=31 head_norm_before_train=1.823400 cos_to_last_merge=0.9999 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.673190754018453, 'auprc': 0.74347881468072, 'loss_val': 0.798807271922138, 'psi': 0.7013059782833597}-{'f1_val': 0.6777587854594418, 'auprc': 0.7328294940438652, 'loss_val': 0.7392529651049681, 'psi': 0.6997870688932112}
[S3] START round=31 head_norm_before_train=1.230415 cos_to_last_merge=0.9984 (last merge round=29)
[S3] round=31 local utility u=0.018139 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9958669216647893, 'loss_val': 0.2741871915613598, 'psi': 0.8187103701660391}-{'f1_val': 0.7006060025002057, 'auprc': 0.9965402696009897, 'loss_val': 0.3124846552832393, 'psi': 0.8189797093405193}
[S4] START round=31 head_norm_before_train=1.785814 cos_to_last_merge=0.8273 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9491072653002424, 'auprc': 0.9558968511432597, 'loss_val': 0.3077505761590696, 'psi': 0.9518230996374493}-{'f1_val': 0.9535743827962103, 'auprc': 0.9494849950029927, 'loss_val': 0.3034666682121411, 'psi': 0.9519386276789232}
[S5] START round=31 head_norm_before_train=1.739593 (no previous merge yet)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.9468869957237024, 'auprc': 0.9960708213188149, 'loss_val': 0.1439602484935722, 'psi': 0.9665605259617474}-{'f1_val': 0.43410833684294303, 'auprc': 0.8528481915694427, 'loss_val': 0.834525192955481, 'psi': 0.6016042787335429}
[S6] START round=31 head_norm_before_train=1.676954 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8264152443041586, 'auprc': 0.9187996164459313, 'loss_val': 0.3558814556744624, 'psi': 0.8633689931608677}-{'f1_val': 0.9330667548784877, 'auprc': 0.9291939065866749, 'loss_val': 0.2827166436519669, 'psi': 0.9315176155617626}
[S7] START round=31 head_norm_before_train=1.448932 cos_to_last_merge=1.0000 (last merge round=30)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.5985570226991275, 'auprc': 0.782207650274468, 'loss_val': 0.7690519072371527, 'psi': 0.6720172737292637}-{'f1_val': 0.6922140280096721, 'auprc': 0.8619032206253194, 'loss_val': 0.37562903981308066, 'psi': 0.7600897050559311}
[S8] START round=31 head_norm_before_train=1.220384 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9961200912608575, 'auprc': 0.9979513692078541, 'loss_val': 0.14368580482067742, 'psi': 0.9968526024396562}-{'f1_val': 0.9964900410640029, 'auprc': 0.9994732097889554, 'loss_val': 0.05369024950279547, 'psi': 0.9976833085539838}
[S9] START round=31 head_norm_before_train=1.764621 cos_to_last_merge=0.9998 (last merge round=29)
[S9] round=31 local utility u=0.005961 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.997558509969168, 'loss_val': 0.049876431908960545, 'psi': 0.9975503379940535}-{'f1_val': 0.9964645815439231, 'auprc': 0.9987906500160888, 'loss_val': 0.05901372868361785, 'psi': 0.9973950089327894}
[S10] START round=31 head_norm_before_train=1.557293 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.991435334955502, 'loss_val': 0.09122670157823362, 'psi': 0.9925834923931425}-{'f1_val': 0.9931299445855843, 'auprc': 0.993220735626271, 'loss_val': 0.06808080704795963, 'psi': 0.993166261001859}
[S11] START round=31 head_norm_before_train=2.092942 (no previous merge yet)
[S11] round=31 local utility u=0.606198 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9958952968829761, 'loss_val': 0.028476942400498768, 'psi': 0.996208107157595}-{'f1_val': 0.8295489960359813, 'auprc': 0.9942355622584443, 'loss_val': 0.23468843722505542, 'psi': 0.8954236225249665}
[S13] START round=31 head_norm_before_train=1.831805 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6124176422760569, 'auprc': 0.6926720659381496, 'loss_val': 1.041620498989556, 'psi': 0.6445194117408939}-{'f1_val': 0.6166688517733973, 'auprc': 0.737218500769031, 'loss_val': 1.0541025440940175, 'psi': 0.6648887113716507}
[S14] START round=31 head_norm_before_train=2.011135 (no previous merge yet)
[S14] round=31 local utility u=0.003754 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9986722125397974, 'loss_val': 0.02390764606923915, 'psi': 0.997865077807309}-{'f1_val': 0.9964034173396682, 'auprc': 0.9986734057098156, 'loss_val': 0.025878656271579856, 'psi': 0.9973114126877272}
[S15] START round=31 head_norm_before_train=1.226617 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=0.706918 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984181704420163, 'loss_val': 0.07011241517817027, 'psi': 0.9974152692093189}-{'f1_val': 0.8105455660277054, 'auprc': 0.9939357348382121, 'loss_val': 0.35329437666718677, 'psi': 0.8839016335519081}
[S16] START round=31 head_norm_before_train=1.954909 (no previous merge yet)
[S16] round=31 local utility u=0.755486 metrics={'f1_val': 0.9408911085901697, 'auprc': 0.9909116446961143, 'loss_val': 0.18004603597419103, 'psi': 0.9608993230325475}-{'f1_val': 0.8474213505723032, 'auprc': 0.9072060224102634, 'loss_val': 0.8790832154698055, 'psi': 0.8713352193074873}
[S17] START round=31 head_norm_before_train=1.986043 (no previous merge yet)
[S17] round=31 local utility u=1.000000 metrics={'f1_val': 0.8933519820939533, 'auprc': 0.9709840626139703, 'loss_val': 0.2365382987784898, 'psi': 0.9244048143019601}-{'f1_val': 0.6910587008991155, 'auprc': 0.8932604072268556, 'loss_val': 1.0097837253160462, 'psi': 0.7719393834302115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39408
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39403
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39411
[S9] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.9963
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=0.3347
[S10] RECEIVED delta(kind=head bytes=1799) from S15
[S10] cosine check vs S15: cos=0.7970
[S7] RECEIVED delta(kind=head bytes=1794) from S11
[S7] cosine check vs S11: cos=-0.0575
[S7] DROPPED delta from S11 (cos=-0.0575 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1804) from S9
[S3] cosine check vs S9: cos=0.8059
[S15] RECEIVED delta(kind=head bytes=1801) from S3
[S15] cosine check vs S3: cos=0.5435
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=0.6572
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9933 head_norm=1.614098
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.878020e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9936 head_norm=1.393979 delta_norm=0.487802
[S10] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9961 head_norm=1.274790
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.516546e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9951 head_norm=1.495237 delta_norm=0.751655
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8264 head_norm=1.704219
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.063958e+00
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.9302 head_norm=1.501173 delta_norm=1.063958
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9975 head_norm=1.786048
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.847520e-02
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9975 head_norm=1.763088 delta_norm=0.078475
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9967 head_norm=1.325499
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.201792e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.139481 delta_norm=0.620179
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.7006 head_norm=1.268516
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.355537e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.7006 head_norm=1.453524 delta_norm=0.535554
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.841201 cos_to_last_merge=0.9997 (last merge round=29)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6189778219938271, 'auprc': 0.7234284507817904, 'loss_val': 1.2220613987944453, 'psi': 0.6607580735090124}-{'f1_val': 0.673190754018453, 'auprc': 0.74347881468072, 'loss_val': 0.798807271922138, 'psi': 0.7013059782833597}
[S3] START round=32 head_norm_before_train=1.453524 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.541289 metrics={'f1_val': 0.8825079778928928, 'auprc': 0.996932900917158, 'loss_val': 0.2862194769459739, 'psi': 0.9282779471025988}-{'f1_val': 0.7006060025002057, 'auprc': 0.9958669216647893, 'loss_val': 0.2741871915613598, 'psi': 0.8187103701660391}
[S4] START round=32 head_norm_before_train=1.799286 cos_to_last_merge=0.8263 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=32 local utility u=0.018419 metrics={'f1_val': 0.9530962533369762, 'auprc': 0.9601269575394897, 'loss_val': 0.3075377873333085, 'psi': 0.9559085350179817}-{'f1_val': 0.9491072653002424, 'auprc': 0.9558968511432597, 'loss_val': 0.3077505761590696, 'psi': 0.9518230996374493}
[S5] START round=32 head_norm_before_train=1.743362 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.6306814464485847, 'auprc': 0.8539103249664052, 'loss_val': 0.47006055244533607, 'psi': 0.7199729978557129}-{'f1_val': 0.9468869957237024, 'auprc': 0.9960708213188149, 'loss_val': 0.1439602484935722, 'psi': 0.9665605259617474}
[S6] START round=32 head_norm_before_train=1.501173 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.030345 metrics={'f1_val': 0.826733069771749, 'auprc': 0.9323902631609023, 'loss_val': 0.3378698594344658, 'psi': 0.8689959471274104}-{'f1_val': 0.8264152443041586, 'auprc': 0.9187996164459313, 'loss_val': 0.3558814556744624, 'psi': 0.8633689931608677}
[S7] START round=32 head_norm_before_train=1.462800 cos_to_last_merge=0.9998 (last merge round=30)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5832541798334736, 'auprc': 0.7813793837246288, 'loss_val': 0.8020610762301097, 'psi': 0.6625042613899357}-{'f1_val': 0.5985570226991275, 'auprc': 0.782207650274468, 'loss_val': 0.7690519072371527, 'psi': 0.6720172737292637}
[S8] START round=32 head_norm_before_train=1.495237 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.030408 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9989309000820391, 'loss_val': 0.07171234454021867, 'psi': 0.995834903077168}-{'f1_val': 0.9961200912608575, 'auprc': 0.9979513692078541, 'loss_val': 0.14368580482067742, 'psi': 0.9968526024396562}
[S9] START round=32 head_norm_before_train=1.763088 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9975973454259731, 'loss_val': 0.052954998351417905, 'psi': 0.9975658721767755}-{'f1_val': 0.9975448900106438, 'auprc': 0.997558509969168, 'loss_val': 0.049876431908960545, 'psi': 0.9975503379940535}
[S10] START round=32 head_norm_before_train=1.393979 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.017783 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9922801243314909, 'loss_val': 0.06345602501471845, 'psi': 0.993447413957378}-{'f1_val': 0.9933489306849028, 'auprc': 0.991435334955502, 'loss_val': 0.09122670157823362, 'psi': 0.9925834923931425}
[S11] START round=32 head_norm_before_train=2.106313 (no previous merge yet)
[S11] round=32 local utility u=0.005492 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979226318825287, 'loss_val': 0.024480327982696844, 'psi': 0.9971095351367397}-{'f1_val': 0.9964166473406741, 'auprc': 0.9958952968829761, 'loss_val': 0.028476942400498768, 'psi': 0.996208107157595}
[S13] START round=32 head_norm_before_train=1.840696 (no previous merge yet)
[S13] round=32 local utility u=0.059993 metrics={'f1_val': 0.6174956613192348, 'auprc': 0.7261139635476049, 'loss_val': 1.0524277283080012, 'psi': 0.6609429822105828}-{'f1_val': 0.6124176422760569, 'auprc': 0.6926720659381496, 'loss_val': 1.041620498989556, 'psi': 0.6445194117408939}
[S14] START round=32 head_norm_before_train=2.021856 (no previous merge yet)
[S14] round=32 local utility u=0.001359 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.996977843696373, 'loss_val': 0.019507225986847603, 'psi': 0.9975274409148781}-{'f1_val': 0.9973269879856502, 'auprc': 0.9986722125397974, 'loss_val': 0.02390764606923915, 'psi': 0.997865077807309}
[S15] START round=32 head_norm_before_train=1.139481 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.9034867020634832, 'auprc': 0.9952018040673646, 'loss_val': 0.24197985429105337, 'psi': 0.9401727428650358}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984181704420163, 'loss_val': 0.07011241517817027, 'psi': 0.9974152692093189}
[S16] START round=32 head_norm_before_train=1.966391 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9291174984014358, 'auprc': 0.963090976478348, 'loss_val': 0.37118512965852674, 'psi': 0.9427068896322006}-{'f1_val': 0.9408911085901697, 'auprc': 0.9909116446961143, 'loss_val': 0.18004603597419103, 'psi': 0.9608993230325475}
[S17] START round=32 head_norm_before_train=1.994078 (no previous merge yet)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.8190312205675744, 'auprc': 0.9819089585971482, 'loss_val': 0.2765677036112546, 'psi': 0.884182315779404}-{'f1_val': 0.8933519820939533, 'auprc': 0.9709840626139703, 'loss_val': 0.2365382987784898, 'psi': 0.9244048143019601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39407
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S3@127.0.0.1:39403
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.928)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S2@127.0.0.1:39402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39408
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S6
[S8] cosine check vs S6: cos=0.2555
[S6] RECEIVED delta(kind=head bytes=1793) from S14
[S6] cosine check vs S14: cos=0.5824
[S7] RECEIVED delta(kind=head bytes=1793) from S10
[S7] cosine check vs S10: cos=0.9911
[S15] RECEIVED delta(kind=head bytes=1801) from S13
[S15] cosine check vs S13: cos=-0.0471
[S15] DROPPED delta from S13 (cos=-0.0471 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1793) from S8
[S3] cosine check vs S8: cos=0.1847
[S2] RECEIVED delta(kind=head bytes=1807) from S4
[S2] cosine check vs S4: cos=0.9968
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.6190 head_norm=1.854889
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.664502e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.6182 head_norm=1.832586 delta_norm=0.076645
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.5833 head_norm=1.476878
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.850071e-02
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.5839 head_norm=1.465222 delta_norm=0.098501
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.8825 head_norm=1.480818
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.693953e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.8969 head_norm=1.168239 delta_norm=0.969395
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9938 head_norm=1.554412
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.450661e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9940 head_norm=1.227254 delta_norm=0.945066
[S8] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.8267 head_norm=1.543506
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.455259e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.8293 head_norm=1.594452 delta_norm=0.845526
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.832586 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.423295 metrics={'f1_val': 0.6779976440213498, 'auprc': 0.7419756926631909, 'loss_val': 0.7852323456107173, 'psi': 0.7035888634780862}-{'f1_val': 0.6189778219938271, 'auprc': 0.7234284507817904, 'loss_val': 1.2220613987944453, 'psi': 0.6607580735090124}
[S3] START round=33 head_norm_before_train=1.168239 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9978464064844461, 'loss_val': 0.2780549792747813, 'psi': 0.8195021640939018}-{'f1_val': 0.8825079778928928, 'auprc': 0.996932900917158, 'loss_val': 0.2862194769459739, 'psi': 0.9282779471025988}
[S4] START round=33 head_norm_before_train=1.813251 cos_to_last_merge=0.8251 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9417798103038068, 'auprc': 0.9358899090539549, 'loss_val': 0.3425744503901202, 'psi': 0.939423849803866}-{'f1_val': 0.9530962533369762, 'auprc': 0.9601269575394897, 'loss_val': 0.3075377873333085, 'psi': 0.9559085350179817}
[S5] START round=33 head_norm_before_train=1.747558 (no previous merge yet)
[S5] round=33 local utility u=0.515786 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9870621376564745, 'loss_val': 0.25751075487089997, 'psi': 0.8151903114660584}-{'f1_val': 0.6306814464485847, 'auprc': 0.8539103249664052, 'loss_val': 0.47006055244533607, 'psi': 0.7199729978557129}
[S6] START round=33 head_norm_before_train=1.594452 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.577998 metrics={'f1_val': 0.9830110401911976, 'auprc': 0.9577455023301306, 'loss_val': 0.19560739809140065, 'psi': 0.9729048250467708}-{'f1_val': 0.826733069771749, 'auprc': 0.9323902631609023, 'loss_val': 0.3378698594344658, 'psi': 0.8689959471274104}
[S7] START round=33 head_norm_before_train=1.465222 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=1.000000 metrics={'f1_val': 0.8183156850659671, 'auprc': 0.9909772452374837, 'loss_val': 0.26478844414706215, 'psi': 0.8873803091345738}-{'f1_val': 0.5832541798334736, 'auprc': 0.7813793837246288, 'loss_val': 0.8020610762301097, 'psi': 0.6625042613899357}
[S8] START round=33 head_norm_before_train=1.227254 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.7237362952545652, 'auprc': 0.985916241068219, 'loss_val': 0.331041217692069, 'psi': 0.8286082735800266}-{'f1_val': 0.9937709050739206, 'auprc': 0.9989309000820391, 'loss_val': 0.07171234454021867, 'psi': 0.995834903077168}
[S9] START round=33 head_norm_before_train=1.784991 cos_to_last_merge=0.9998 (last merge round=31)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9952192229505256, 'auprc': 0.9995847083846024, 'loss_val': 0.04926853667015313, 'psi': 0.9969654171241564}-{'f1_val': 0.9975448900106438, 'auprc': 0.9975973454259731, 'loss_val': 0.052954998351417905, 'psi': 0.9975658721767755}
[S10] START round=33 head_norm_before_train=1.460133 cos_to_last_merge=0.9988 (last merge round=31)
[S10] round=33 local utility u=0.001868 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9917828930286121, 'loss_val': 0.054281790091898, 'psi': 0.9928539510306015}-{'f1_val': 0.9942256070413027, 'auprc': 0.9922801243314909, 'loss_val': 0.06345602501471845, 'psi': 0.993447413957378}
[S11] START round=33 head_norm_before_train=2.118564 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9972407448558471, 'loss_val': 0.02442030430019478, 'psi': 0.9968367803260672}-{'f1_val': 0.996567470639547, 'auprc': 0.9979226318825287, 'loss_val': 0.024480327982696844, 'psi': 0.9971095351367397}
[S13] START round=33 head_norm_before_train=1.849806 (no previous merge yet)
[S13] round=33 local utility u=0.123909 metrics={'f1_val': 0.6590021322456731, 'auprc': 0.717163286067679, 'loss_val': 1.026796422763913, 'psi': 0.6822665937744754}-{'f1_val': 0.6174956613192348, 'auprc': 0.7261139635476049, 'loss_val': 1.0524277283080012, 'psi': 0.6609429822105828}
[S14] START round=33 head_norm_before_train=2.032725 (no previous merge yet)
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.9971648326949886, 'auprc': 0.9986742031258807, 'loss_val': 0.02456197393424294, 'psi': 0.9977685808673454}-{'f1_val': 0.9978938390605482, 'auprc': 0.996977843696373, 'loss_val': 0.019507225986847603, 'psi': 0.9975274409148781}
[S15] START round=33 head_norm_before_train=1.232982 cos_to_last_merge=0.9934 (last merge round=31)
[S15] round=33 local utility u=0.363913 metrics={'f1_val': 0.9960807359013557, 'auprc': 0.9988988465635767, 'loss_val': 0.08080899933809074, 'psi': 0.9972079801662441}-{'f1_val': 0.9034867020634832, 'auprc': 0.9952018040673646, 'loss_val': 0.24197985429105337, 'psi': 0.9401727428650358}
[S16] START round=33 head_norm_before_train=1.976115 (no previous merge yet)
[S16] round=33 local utility u=0.229121 metrics={'f1_val': 0.9527977639883506, 'auprc': 0.9870862095239645, 'loss_val': 0.1270094953799946, 'psi': 0.9665131422025962}-{'f1_val': 0.9291174984014358, 'auprc': 0.963090976478348, 'loss_val': 0.37118512965852674, 'psi': 0.9427068896322006}
[S17] START round=33 head_norm_before_train=2.004949 (no previous merge yet)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.7375813093061733, 'auprc': 0.9364505043009721, 'loss_val': 0.507188441611697, 'psi': 0.8171289873040928}-{'f1_val': 0.8190312205675744, 'auprc': 0.9819089585971482, 'loss_val': 0.2765677036112546, 'psi': 0.884182315779404}
[S13] not sending this round → trigger blocked (psi=0.682)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:39411
[S10] not sending this round → trigger blocked (psi=0.993)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:39407
[S6] not sending this round → trigger blocked (psi=0.973)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39411
[S2] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1806 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.9969
[S15] RECEIVED delta(kind=head bytes=1804) from S7
[S15] cosine check vs S7: cos=0.7669
[S6] RECEIVED delta(kind=head bytes=1806) from S16
[S6] cosine check vs S16: cos=0.4445
[S10] RECEIVED delta(kind=head bytes=1805) from S15
[S10] cosine check vs S15: cos=0.7781
[S10] RECEIVED delta(kind=head bytes=1801) from S2
[S10] cosine check vs S2: cos=0.8048
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=33 metric=0.9830 head_norm=1.633741
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.649851e-01
[S6] stored merged vector for next round verification (round=33)
[S6] DEBUG after merge:  round=33 metric=0.9845 head_norm=1.540253 delta_norm=0.964985
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9936 head_norm=1.511729
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.429136e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9936 head_norm=1.402600 delta_norm=0.242914
[S10] aggregate: ACCEPT kept=['S15', 'S2'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9952 head_norm=1.807773
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.480076e-02
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9952 head_norm=1.780566 delta_norm=0.074801
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.9961 head_norm=1.328949
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.839343e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.9961 head_norm=1.318771 delta_norm=0.483934
[S15] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.852108 cos_to_last_merge=0.9999 (last merge round=32)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6466601066873126, 'auprc': 0.7373959709009461, 'loss_val': 1.0148779455607253, 'psi': 0.682954452372766}-{'f1_val': 0.6779976440213498, 'auprc': 0.7419756926631909, 'loss_val': 0.7852323456107173, 'psi': 0.7035888634780862}
[S3] START round=34 head_norm_before_train=1.202877 cos_to_last_merge=0.9983 (last merge round=32)
[S3] round=34 local utility u=0.819123 metrics={'f1_val': 0.961498813606586, 'auprc': 0.99792700108462, 'loss_val': 0.20540675932938687, 'psi': 0.9760700885977995}-{'f1_val': 0.7006060025002057, 'auprc': 0.9978464064844461, 'loss_val': 0.2780549792747813, 'psi': 0.8195021640939018}
[S4] START round=34 head_norm_before_train=1.812032 cos_to_last_merge=0.8255 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.6297081773709134, 'auprc': 0.8932251351132929, 'loss_val': 0.6569010634406527, 'psi': 0.7351149604678653}-{'f1_val': 0.9417798103038068, 'auprc': 0.9358899090539549, 'loss_val': 0.3425744503901202, 'psi': 0.939423849803866}
[S5] START round=34 head_norm_before_train=1.756126 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.6887425746419971, 'auprc': 0.8541074535719131, 'loss_val': 0.44745206181867964, 'psi': 0.7548885262139635}-{'f1_val': 0.7006090940057808, 'auprc': 0.9870621376564745, 'loss_val': 0.25751075487089997, 'psi': 0.8151903114660584}
[S6] START round=34 head_norm_before_train=1.540253 cos_to_last_merge=1.0000 (last merge round=33)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.9804384300823344, 'auprc': 0.9571689113844097, 'loss_val': 0.19886296436513348, 'psi': 0.9711306226031645}-{'f1_val': 0.9830110401911976, 'auprc': 0.9577455023301306, 'loss_val': 0.19560739809140065, 'psi': 0.9729048250467708}
[S7] START round=34 head_norm_before_train=1.476682 cos_to_last_merge=0.9999 (last merge round=32)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6160089273824972, 'auprc': 0.7922548238989074, 'loss_val': 0.6851408411989506, 'psi': 0.6865072859890613}-{'f1_val': 0.8183156850659671, 'auprc': 0.9909772452374837, 'loss_val': 0.26478844414706215, 'psi': 0.8873803091345738}
[S8] START round=34 head_norm_before_train=1.287794 cos_to_last_merge=0.9970 (last merge round=32)
[S8] round=34 local utility u=0.928180 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9955496665902993, 'loss_val': 0.12291578428306822, 'psi': 0.9943950689048177}-{'f1_val': 0.7237362952545652, 'auprc': 0.985916241068219, 'loss_val': 0.331041217692069, 'psi': 0.8286082735800266}
[S9] START round=34 head_norm_before_train=1.780566 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.006552 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.9995907518050448, 'loss_val': 0.04863477269788656, 'psi': 0.9982130379921684}-{'f1_val': 0.9952192229505256, 'auprc': 0.9995847083846024, 'loss_val': 0.04926853667015313, 'psi': 0.9969654171241564}
[S10] START round=34 head_norm_before_train=1.402600 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9926921900063811, 'auprc': 0.9947576850579345, 'loss_val': 0.07687888728550495, 'psi': 0.9935183880270024}-{'f1_val': 0.9935679896985945, 'auprc': 0.9917828930286121, 'loss_val': 0.054281790091898, 'psi': 0.9928539510306015}
[S11] START round=34 head_norm_before_train=2.128084 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9963837548637469, 'loss_val': 0.023928442596783697, 'psi': 0.996493984329227}-{'f1_val': 0.996567470639547, 'auprc': 0.9972407448558471, 'loss_val': 0.02442030430019478, 'psi': 0.9968367803260672}
[S13] START round=34 head_norm_before_train=1.861430 (no previous merge yet)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6052315863348785, 'auprc': 0.6672025465009536, 'loss_val': 1.3021272564744966, 'psi': 0.6300199704013085}-{'f1_val': 0.6590021322456731, 'auprc': 0.717163286067679, 'loss_val': 1.026796422763913, 'psi': 0.6822665937744754}
[S14] START round=34 head_norm_before_train=2.039937 (no previous merge yet)
[S14] round=34 local utility u=0.003831 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9986732400823084, 'loss_val': 0.020073146845980768, 'psi': 0.9980858959052212}-{'f1_val': 0.9971648326949886, 'auprc': 0.9986742031258807, 'loss_val': 0.02456197393424294, 'psi': 0.9977685808673454}
[S15] START round=34 head_norm_before_train=1.318771 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=0.004422 metrics={'f1_val': 0.9962297102239042, 'auprc': 0.9981592776602807, 'loss_val': 0.07063921705979044, 'psi': 0.9970015371984547}-{'f1_val': 0.9960807359013557, 'auprc': 0.9988988465635767, 'loss_val': 0.08080899933809074, 'psi': 0.9972079801662441}
[S16] START round=34 head_norm_before_train=1.984450 (no previous merge yet)
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9366752074222964, 'auprc': 0.9896728098259122, 'loss_val': 0.2903760564764467, 'psi': 0.9578742483837427}-{'f1_val': 0.9527977639883506, 'auprc': 0.9870862095239645, 'loss_val': 0.1270094953799946, 'psi': 0.9665131422025962}
[S17] START round=34 head_norm_before_train=2.019186 (no previous merge yet)
[S17] round=34 local utility u=0.003869 metrics={'f1_val': 0.739787373569664, 'auprc': 0.9386245269698964, 'loss_val': 0.5192097365634512, 'psi': 0.8193222349297569}-{'f1_val': 0.7375813093061733, 'auprc': 0.9364505043009721, 'loss_val': 0.507188441611697, 'psi': 0.8171289873040928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.997)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39407
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:39403
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39403
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S8
[S3] cosine check vs S8: cos=0.6424
[S3] RECEIVED delta(kind=head bytes=1802) from S9
[S3] cosine check vs S9: cos=0.5555
[S6] RECEIVED delta(kind=head bytes=1795) from S14
[S6] cosine check vs S14: cos=0.5239
[S15] RECEIVED delta(kind=head bytes=1800) from S3
[S15] cosine check vs S3: cos=0.5659
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39409
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=0.5922
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.9804 head_norm=1.565886
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.059537e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.9800 head_norm=1.581110 delta_norm=0.905954
[S6] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9962 head_norm=1.390646
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.167500e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9968 head_norm=1.165295 delta_norm=0.616750
[S15] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9936 head_norm=1.345979
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.235272e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9925 head_norm=1.517076 delta_norm=0.823527
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9615 head_norm=1.242051
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.236881e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9724 head_norm=1.123831 delta_norm=0.323688
[S3] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.868719 cos_to_last_merge=0.9996 (last merge round=32)
[S2] round=35 local utility u=0.117838 metrics={'f1_val': 0.6629926162393733, 'auprc': 0.7411609799604306, 'loss_val': 0.8884914165073444, 'psi': 0.6942599617277962}-{'f1_val': 0.6466601066873126, 'auprc': 0.7373959709009461, 'loss_val': 1.0148779455607253, 'psi': 0.682954452372766}
[S3] START round=35 head_norm_before_train=1.123831 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9981893489682513, 'loss_val': 0.24838397067617607, 'psi': 0.9758731920670022}-{'f1_val': 0.961498813606586, 'auprc': 0.99792700108462, 'loss_val': 0.20540675932938687, 'psi': 0.9760700885977995}
[S4] START round=35 head_norm_before_train=1.815419 cos_to_last_merge=0.8249 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=35 local utility u=1.000000 metrics={'f1_val': 0.9510728652131715, 'auprc': 0.9553374089339757, 'loss_val': 0.3143589086717479, 'psi': 0.9527786827014932}-{'f1_val': 0.6297081773709134, 'auprc': 0.8932251351132929, 'loss_val': 0.6569010634406527, 'psi': 0.7351149604678653}
[S5] START round=35 head_norm_before_train=1.763747 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.4446321390837479, 'auprc': 0.8527355160674048, 'loss_val': 0.8328583925212596, 'psi': 0.6078734898772107}-{'f1_val': 0.6887425746419971, 'auprc': 0.8541074535719131, 'loss_val': 0.44745206181867964, 'psi': 0.7548885262139635}
[S6] START round=35 head_norm_before_train=1.581110 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.4057512295131134, 'auprc': 0.621612314249727, 'loss_val': 1.4917713832948767, 'psi': 0.4920956634077588}-{'f1_val': 0.9804384300823344, 'auprc': 0.9571689113844097, 'loss_val': 0.19886296436513348, 'psi': 0.9711306226031645}
[S7] START round=35 head_norm_before_train=1.484664 cos_to_last_merge=0.9996 (last merge round=32)
[S7] round=35 local utility u=0.016278 metrics={'f1_val': 0.6191045476938047, 'auprc': 0.79247428419627, 'loss_val': 0.6718170627655752, 'psi': 0.6884524422947909}-{'f1_val': 0.6160089273824972, 'auprc': 0.7922548238989074, 'loss_val': 0.6851408411989506, 'psi': 0.6865072859890613}
[S8] START round=35 head_norm_before_train=1.517076 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.038584 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9990032401665008, 'loss_val': 0.060510476137635466, 'psi': 0.9962167124259163}-{'f1_val': 0.9936253371144965, 'auprc': 0.9955496665902993, 'loss_val': 0.12291578428306822, 'psi': 0.9943950689048177}
[S9] START round=35 head_norm_before_train=1.800942 cos_to_last_merge=0.9998 (last merge round=33)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9954102837855445, 'loss_val': 0.04383716180546936, 'psi': 0.9964447926728528}-{'f1_val': 0.9972945621169176, 'auprc': 0.9995907518050448, 'loss_val': 0.04863477269788656, 'psi': 0.9982130379921684}
[S10] START round=35 head_norm_before_train=1.454621 cos_to_last_merge=0.9992 (last merge round=33)
[S10] round=35 local utility u=0.006189 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9929056756374024, 'loss_val': 0.06157044344279665, 'psi': 0.9930402370063116}-{'f1_val': 0.9926921900063811, 'auprc': 0.9947576850579345, 'loss_val': 0.07687888728550495, 'psi': 0.9935183880270024}
[S11] START round=35 head_norm_before_train=2.139669 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.996081557124167, 'loss_val': 0.02308288442452768, 'psi': 0.9963731052333951}-{'f1_val': 0.996567470639547, 'auprc': 0.9963837548637469, 'loss_val': 0.023928442596783697, 'psi': 0.996493984329227}
[S13] START round=35 head_norm_before_train=1.868206 (no previous merge yet)
[S13] round=35 local utility u=0.723669 metrics={'f1_val': 0.7260237695033895, 'auprc': 0.7382012268895649, 'loss_val': 0.7925393283289052, 'psi': 0.7308947524578597}-{'f1_val': 0.6052315863348785, 'auprc': 0.6672025465009536, 'loss_val': 1.3021272564744966, 'psi': 0.6300199704013085}
[S14] START round=35 head_norm_before_train=2.046784 (no previous merge yet)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.998950590543805, 'loss_val': 0.020384261677678116, 'psi': 0.9980268327782189}-{'f1_val': 0.9976943331204965, 'auprc': 0.9986732400823084, 'loss_val': 0.020073146845980768, 'psi': 0.9980858959052212}
[S15] START round=35 head_norm_before_train=1.165295 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9966272657695407, 'auprc': 0.9975524805849053, 'loss_val': 0.1301948769528281, 'psi': 0.9969973516956866}-{'f1_val': 0.9962297102239042, 'auprc': 0.9981592776602807, 'loss_val': 0.07063921705979044, 'psi': 0.9970015371984547}
[S16] START round=35 head_norm_before_train=1.990260 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8549789868990808, 'auprc': 0.954547406756162, 'loss_val': 0.8400073682645354, 'psi': 0.8948063548419133}-{'f1_val': 0.9366752074222964, 'auprc': 0.9896728098259122, 'loss_val': 0.2903760564764467, 'psi': 0.9578742483837427}
[S17] START round=35 head_norm_before_train=2.036608 (no previous merge yet)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6300175919028186, 'auprc': 0.8309749200129615, 'loss_val': 1.0799128573394037, 'psi': 0.7104005231468757}-{'f1_val': 0.739787373569664, 'auprc': 0.9386245269698964, 'loss_val': 0.5192097365634512, 'psi': 0.8193222349297569}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:39411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39402
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39415
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39408
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1804) from S4
[S2] cosine check vs S4: cos=0.9965
[S15] RECEIVED delta(kind=head bytes=1801) from S7
[S15] cosine check vs S7: cos=0.7557
[S15] RECEIVED delta(kind=head bytes=1800) from S13
[S15] cosine check vs S13: cos=-0.0574
[S15] DROPPED delta from S13 (cos=-0.0574 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S8
[S3] cosine check vs S8: cos=0.6437
[S10] RECEIVED delta(kind=head bytes=1794) from S2
[S10] cosine check vs S2: cos=0.8322
[S7] RECEIVED delta(kind=head bytes=1800) from S10
[S7] cosine check vs S10: cos=0.9881
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=35 metric=0.9610 head_norm=1.164524
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.064718e-01
[S3] stored merged vector for next round verification (round=35)
[S3] DEBUG after merge:  round=35 metric=0.9610 head_norm=1.243645 delta_norm=0.606472
[S3] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.195 → S15@127.0.0.1:39415
[S9] ⇄ pheromone p=0.007 → S3@127.0.0.1:39403
[S5] ⇄ pheromone p=0.197 → S9@127.0.0.1:39410
[S6] ⇄ pheromone p=0.199 → S8@127.0.0.1:39409
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=35 metric=0.6630 head_norm=1.884473
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.395372e-02
[S2] stored merged vector for next round verification (round=35)
[S2] DEBUG after merge:  round=35 metric=0.6609 head_norm=1.851424 delta_norm=0.083954
[S2] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.124 → S10@127.0.0.1:39411
[S13] ⇄ pheromone p=0.188 → S15@127.0.0.1:39415
[S8] ⇄ pheromone p=0.168 → S3@127.0.0.1:39403
[S4] ⇄ pheromone p=0.238 → S2@127.0.0.1:39402
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6191 head_norm=1.492829
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.160116e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6189 head_norm=1.496978 delta_norm=0.116012
[S7] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.253 → S15@127.0.0.1:39415
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9931 head_norm=1.510054
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.233236e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9931 head_norm=1.625387 delta_norm=0.523324
[S10] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.007 → S7@127.0.0.1:39408
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9966 head_norm=1.230926
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.915518e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9848 head_norm=1.276807 delta_norm=0.491552
[S15] aggregate: ROLLBACK (f1_val pre=0.997 post=0.985 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.136 → S10@127.0.0.1:39411
[S14] ⇄ pheromone p=0.017 → S6@127.0.0.1:39407
[S11] ⇄ pheromone p=0.054 → S7@127.0.0.1:39408
[S17] ⇄ pheromone p=0.175 → S8@127.0.0.1:39409
[S16] ⇄ pheromone p=0.148 → S6@127.0.0.1:39407
[S2] START round=36 head_norm_before_train=1.851424 cos_to_last_merge=1.0000 (last merge round=35)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6504190469528874, 'auprc': 0.7373413030251122, 'loss_val': 0.9789595672253878, 'psi': 0.6851879493817774}-{'f1_val': 0.6629926162393733, 'auprc': 0.7411609799604306, 'loss_val': 0.8884914165073444, 'psi': 0.6942599617277962}
[S3] START round=36 head_norm_before_train=1.243645 cos_to_last_merge=1.0000 (last merge round=35)
[S3] round=36 local utility u=0.116624 metrics={'f1_val': 0.9930955342843487, 'auprc': 0.9972237040332267, 'loss_val': 0.2048375492371427, 'psi': 0.9947468021838999}-{'f1_val': 0.960995754132836, 'auprc': 0.9981893489682513, 'loss_val': 0.24838397067617607, 'psi': 0.9758731920670022}
[S4] START round=36 head_norm_before_train=1.821648 cos_to_last_merge=0.8250 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9450090373572679, 'auprc': 0.9328062133001627, 'loss_val': 0.32829084586687973, 'psi': 0.9401279077344258}-{'f1_val': 0.9510728652131715, 'auprc': 0.9553374089339757, 'loss_val': 0.3143589086717479, 'psi': 0.9527786827014932}
[S5] START round=36 head_norm_before_train=1.769285 (no previous merge yet)
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9815124929556531, 'loss_val': 0.21471284672855112, 'psi': 0.8129700327798659}-{'f1_val': 0.4446321390837479, 'auprc': 0.8527355160674048, 'loss_val': 0.8328583925212596, 'psi': 0.6078734898772107}
[S6] START round=36 head_norm_before_train=1.600064 cos_to_last_merge=0.9997 (last merge round=34)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.7853414260002363, 'auprc': 0.799474506946734, 'loss_val': 0.6488943044444971, 'psi': 0.7909946583788354}-{'f1_val': 0.4057512295131134, 'auprc': 0.621612314249727, 'loss_val': 1.4917713832948767, 'psi': 0.4920956634077588}
[S7] START round=36 head_norm_before_train=1.496978 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.287315 metrics={'f1_val': 0.6686569327049651, 'auprc': 0.8225761447298661, 'loss_val': 0.48480690965480655, 'psi': 0.7302246175149255}-{'f1_val': 0.6191045476938047, 'auprc': 0.79247428419627, 'loss_val': 0.6718170627655752, 'psi': 0.6884524422947909}
[S8] START round=36 head_norm_before_train=1.572516 cos_to_last_merge=0.9991 (last merge round=34)
[S8] round=36 local utility u=0.004664 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9987990897290555, 'loss_val': 0.050570861520503066, 'psi': 0.9961350522509381}-{'f1_val': 0.9943590272655265, 'auprc': 0.9990032401665008, 'loss_val': 0.060510476137635466, 'psi': 0.9962167124259163}
[S9] START round=36 head_norm_before_train=1.819566 cos_to_last_merge=0.9995 (last merge round=33)
[S9] round=36 local utility u=0.005874 metrics={'f1_val': 0.9964645815439231, 'auprc': 0.9993256981410651, 'loss_val': 0.03981687387241108, 'psi': 0.9976090281827799}-{'f1_val': 0.9971344652643916, 'auprc': 0.9954102837855445, 'loss_val': 0.04383716180546936, 'psi': 0.9964447926728528}
[S10] START round=36 head_norm_before_train=1.625387 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9908891618851816, 'loss_val': 0.07847179018806374, 'psi': 0.9923650231650144}-{'f1_val': 0.9931299445855843, 'auprc': 0.9929056756374024, 'loss_val': 0.06157044344279665, 'psi': 0.9930402370063116}
[S11] START round=36 head_norm_before_train=2.151316 (no previous merge yet)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9954129743554118, 'loss_val': 0.02547281165586802, 'psi': 0.995857674588612}-{'f1_val': 0.996567470639547, 'auprc': 0.996081557124167, 'loss_val': 0.02308288442452768, 'psi': 0.9963731052333951}
[S13] START round=36 head_norm_before_train=1.875747 (no previous merge yet)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.6343389463340724, 'auprc': 0.6934799158757581, 'loss_val': 1.1515556841167356, 'psi': 0.6579953341507466}-{'f1_val': 0.7260237695033895, 'auprc': 0.7382012268895649, 'loss_val': 0.7925393283289052, 'psi': 0.7308947524578597}
[S14] START round=36 head_norm_before_train=2.054864 (no previous merge yet)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9969791610323038, 'loss_val': 0.02024014294941714, 'psi': 0.9976290843221294}-{'f1_val': 0.9974109942678281, 'auprc': 0.998950590543805, 'loss_val': 0.020384261677678116, 'psi': 0.9980268327782189}
[S15] START round=36 head_norm_before_train=1.276807 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.029365 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9984491879572865, 'loss_val': 0.0774548258084224, 'psi': 0.9976860783896866}-{'f1_val': 0.9966272657695407, 'auprc': 0.9975524805849053, 'loss_val': 0.1301948769528281, 'psi': 0.9969973516956866}
[S16] START round=36 head_norm_before_train=1.997969 (no previous merge yet)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.838633571182096, 'auprc': 0.8864085812952889, 'loss_val': 1.052941226709401, 'psi': 0.8577435752273732}-{'f1_val': 0.8549789868990808, 'auprc': 0.954547406756162, 'loss_val': 0.8400073682645354, 'psi': 0.8948063548419133}
[S17] START round=36 head_norm_before_train=2.056573 (no previous merge yet)
[S17] round=36 local utility u=1.000000 metrics={'f1_val': 0.9414072168250449, 'auprc': 0.9798843717801321, 'loss_val': 0.18377242445317302, 'psi': 0.9567980788070798}-{'f1_val': 0.6300175919028186, 'auprc': 0.8309749200129615, 'loss_val': 1.0799128573394037, 'psi': 0.7104005231468757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S16@127.0.0.1:39416
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39407
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39409
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1794) from S6
[S16] cosine check vs S6: cos=0.4715
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=0.9253
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.2446
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39405
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:39412
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1801) from S15
[S7] cosine check vs S15: cos=0.9469
[S9] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9963
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S7
[S11] cosine check vs S7: cos=-0.0604
[S11] DROPPED delta from S7 (cos=-0.0604 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=36 metric=0.7006 head_norm=1.773839
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.359793e-02
[S5] stored merged vector for next round verification (round=36)
[S5] DEBUG after merge:  round=36 metric=0.7006 head_norm=1.804150 delta_norm=0.083598
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.7853 head_norm=1.618363
[S6] _apply_head_vector_avg (torch): Δ‖w‖=9.928794e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.7893 head_norm=1.274438 delta_norm=0.992879
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9944 head_norm=1.612731
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.227807e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9944 head_norm=1.422433 delta_norm=0.322781
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6687 head_norm=1.502994
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.444198e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6709 head_norm=1.407570 delta_norm=0.244420
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8386 head_norm=2.006779
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.465106e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8405 head_norm=1.557963 delta_norm=0.946511
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.872717 cos_to_last_merge=0.9999 (last merge round=35)
[S2] round=37 local utility u=0.164297 metrics={'f1_val': 0.6798778406381734, 'auprc': 0.7359044342501797, 'loss_val': 0.822807222035978, 'psi': 0.7022884780829759}-{'f1_val': 0.6504190469528874, 'auprc': 0.7373413030251122, 'loss_val': 0.9789595672253878, 'psi': 0.6851879493817774}
[S3] START round=37 head_norm_before_train=1.286120 cos_to_last_merge=0.9981 (last merge round=35)
[S3] round=37 local utility u=0.020468 metrics={'f1_val': 0.992490592609234, 'auprc': 0.9954734443847107, 'loss_val': 0.1550217382089636, 'psi': 0.9936837333194247}-{'f1_val': 0.9930955342843487, 'auprc': 0.9972237040332267, 'loss_val': 0.2048375492371427, 'psi': 0.9947468021838999}
[S4] START round=37 head_norm_before_train=1.832201 cos_to_last_merge=0.8245 (last merge round=1)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=37 local utility u=0.012382 metrics={'f1_val': 0.9454652391588235, 'auprc': 0.9383898085051304, 'loss_val': 0.3230154871356326, 'psi': 0.9426350668973462}-{'f1_val': 0.9450090373572679, 'auprc': 0.9328062133001627, 'loss_val': 0.32829084586687973, 'psi': 0.9401279077344258}
[S5] START round=37 head_norm_before_train=1.804150 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9349531806349805, 'loss_val': 0.2953238562751156, 'psi': 0.7943463078515968}-{'f1_val': 0.7006083926626743, 'auprc': 0.9815124929556531, 'loss_val': 0.21471284672855112, 'psi': 0.8129700327798659}
[S6] START round=37 head_norm_before_train=1.274438 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=0.450919 metrics={'f1_val': 0.8382600654635851, 'auprc': 0.9237226211008934, 'loss_val': 0.4373122221767517, 'psi': 0.8724450877185084}-{'f1_val': 0.7853414260002363, 'auprc': 0.799474506946734, 'loss_val': 0.6488943044444971, 'psi': 0.7909946583788354}
[S7] START round=37 head_norm_before_train=1.407570 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6557657602723569, 'auprc': 0.81056880423381, 'loss_val': 0.5394022750736491, 'psi': 0.7176869778569381}-{'f1_val': 0.6686569327049651, 'auprc': 0.8225761447298661, 'loss_val': 0.48480690965480655, 'psi': 0.7302246175149255}
[S8] START round=37 head_norm_before_train=1.422433 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9979964770728869, 'loss_val': 0.06472078427278163, 'psi': 0.9947159724235465}-{'f1_val': 0.9943590272655265, 'auprc': 0.9987990897290555, 'loss_val': 0.050570861520503066, 'psi': 0.9961350522509381}
[S9] START round=37 head_norm_before_train=1.837766 cos_to_last_merge=0.9989 (last merge round=33)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9939693299157782, 'auprc': 0.9992755605693151, 'loss_val': 0.040782629946632815, 'psi': 0.9960918221771929}-{'f1_val': 0.9964645815439231, 'auprc': 0.9993256981410651, 'loss_val': 0.03981687387241108, 'psi': 0.9976090281827799}
[S10] START round=37 head_norm_before_train=1.676597 cos_to_last_merge=0.9990 (last merge round=35)
[S10] round=37 local utility u=0.009904 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.992520189192824, 'loss_val': 0.0622429561056406, 'psi': 0.9928860424284802}-{'f1_val': 0.9933489306849028, 'auprc': 0.9908891618851816, 'loss_val': 0.07847179018806374, 'psi': 0.9923650231650144}
[S11] START round=37 head_norm_before_train=2.163328 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9947225192837028, 'loss_val': 0.030655283485780855, 'psi': 0.9955814925599283}-{'f1_val': 0.9961541414107454, 'auprc': 0.9954129743554118, 'loss_val': 0.02547281165586802, 'psi': 0.995857674588612}
[S13] START round=37 head_norm_before_train=1.883113 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5914640599210103, 'auprc': 0.6298273021227687, 'loss_val': 1.1699661514477588, 'psi': 0.6068093568017137}-{'f1_val': 0.6343389463340724, 'auprc': 0.6934799158757581, 'loss_val': 1.1515556841167356, 'psi': 0.6579953341507466}
[S14] START round=37 head_norm_before_train=2.059523 (no previous merge yet)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9947785013638276, 'auprc': 0.9986765600953427, 'loss_val': 0.03002095652703933, 'psi': 0.9963377248564336}-{'f1_val': 0.9980623665153463, 'auprc': 0.9969791610323038, 'loss_val': 0.02024014294941714, 'psi': 0.9976290843221294}
[S15] START round=37 head_norm_before_train=1.350184 cos_to_last_merge=0.9978 (last merge round=35)
[S15] round=37 local utility u=0.008771 metrics={'f1_val': 0.9968724968140973, 'auprc': 0.9984732185757662, 'loss_val': 0.05815601766806284, 'psi': 0.9975127855187649}-{'f1_val': 0.9971773386779533, 'auprc': 0.9984491879572865, 'loss_val': 0.0774548258084224, 'psi': 0.9976860783896866}
[S16] START round=37 head_norm_before_train=1.557963 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.617457 metrics={'f1_val': 0.8874285947179666, 'auprc': 0.9868585632040496, 'loss_val': 0.41214799095873833, 'psi': 0.9272005821123999}-{'f1_val': 0.838633571182096, 'auprc': 0.8864085812952889, 'loss_val': 1.052941226709401, 'psi': 0.8577435752273732}
[S17] START round=37 head_norm_before_train=2.072173 (no previous merge yet)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6701392217545001, 'auprc': 0.8136331535491644, 'loss_val': 1.1783867170069375, 'psi': 0.7275367944723659}-{'f1_val': 0.9414072168250449, 'auprc': 0.9798843717801321, 'loss_val': 0.18377242445317302, 'psi': 0.9567980788070798}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S15@127.0.0.1:39415
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:39409
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1806) from S10
[S15] cosine check vs S10: cos=0.8131
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.9976
[S7] RECEIVED delta(kind=head bytes=1802) from S15
[S7] cosine check vs S15: cos=0.9806
[S8] RECEIVED delta(kind=head bytes=1793) from S3
[S8] cosine check vs S3: cos=0.9690
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:39416
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S6
[S16] cosine check vs S6: cos=0.7149
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9455 head_norm=1.834354
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.020637e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9453 head_norm=1.860299 delta_norm=0.070206
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9925 head_norm=1.462478
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.858031e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9925 head_norm=1.385756 delta_norm=0.185803
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6558 head_norm=1.414348
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.394064e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6589 head_norm=1.407631 delta_norm=0.139406
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9969 head_norm=1.414687
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.030754e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9961 head_norm=1.497160 delta_norm=0.503075
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8874 head_norm=1.578957
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.586417e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8891 head_norm=1.334219 delta_norm=0.558642
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.888500 cos_to_last_merge=0.9997 (last merge round=35)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6008956069269187, 'auprc': 0.6689632896091229, 'loss_val': 1.8308985920274508, 'psi': 0.6281226799998003}-{'f1_val': 0.6798778406381734, 'auprc': 0.7359044342501797, 'loss_val': 0.822807222035978, 'psi': 0.7022884780829759}
[S3] START round=38 head_norm_before_train=1.330730 cos_to_last_merge=0.9937 (last merge round=35)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9979187230857138, 'loss_val': 0.14240596224981367, 'psi': 0.9758902962660327}-{'f1_val': 0.992490592609234, 'auprc': 0.9954734443847107, 'loss_val': 0.1550217382089636, 'psi': 0.9936837333194247}
[S4] START round=38 head_norm_before_train=1.860299 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.064452 metrics={'f1_val': 0.9550901354605397, 'auprc': 0.959057929815228, 'loss_val': 0.3138654027392881, 'psi': 0.9566772532024149}-{'f1_val': 0.9454652391588235, 'auprc': 0.9383898085051304, 'loss_val': 0.3230154871356326, 'psi': 0.9426350668973462}
[S5] START round=38 head_norm_before_train=1.806254 cos_to_last_merge=1.0000 (last merge round=36)
[S5] round=38 local utility u=0.128652 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9903342283013818, 'loss_val': 0.20416789680363343, 'psi': 0.8164991477240212}-{'f1_val': 0.7006083926626743, 'auprc': 0.9349531806349805, 'loss_val': 0.2953238562751156, 'psi': 0.7943463078515968}
[S6] START round=38 head_norm_before_train=1.300515 cos_to_last_merge=0.9995 (last merge round=36)
[S6] round=38 local utility u=0.000000 metrics={'f1_val': 0.7792729184723031, 'auprc': 0.8088250294726145, 'loss_val': 0.585762673197357, 'psi': 0.7910937628724277}-{'f1_val': 0.8382600654635851, 'auprc': 0.9237226211008934, 'loss_val': 0.4373122221767517, 'psi': 0.8724450877185084}
[S7] START round=38 head_norm_before_train=1.407631 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5998341229776462, 'auprc': 0.7868260458504324, 'loss_val': 0.7206188130192891, 'psi': 0.6746308921267606}-{'f1_val': 0.6557657602723569, 'auprc': 0.81056880423381, 'loss_val': 0.5394022750736491, 'psi': 0.7176869778569381}
[S8] START round=38 head_norm_before_train=1.385756 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9896293645032173, 'auprc': 0.998908668014796, 'loss_val': 0.07452722559708955, 'psi': 0.9933410859078489}-{'f1_val': 0.9925289693239863, 'auprc': 0.9979964770728869, 'loss_val': 0.06472078427278163, 'psi': 0.9947159724235465}
[S9] START round=38 head_norm_before_train=1.856071 cos_to_last_merge=0.9982 (last merge round=33)
[S9] round=38 local utility u=0.010618 metrics={'f1_val': 0.9963002897586258, 'auprc': 0.9994918295262945, 'loss_val': 0.03418148670533904, 'psi': 0.9975769056656932}-{'f1_val': 0.9939693299157782, 'auprc': 0.9992755605693151, 'loss_val': 0.040782629946632815, 'psi': 0.9960918221771929}
[S10] START round=38 head_norm_before_train=1.728528 cos_to_last_merge=0.9962 (last merge round=35)
[S10] round=38 local utility u=0.005783 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9920806463324316, 'loss_val': 0.051985838115682935, 'psi': 0.9929730523521293}-{'f1_val': 0.9931299445855843, 'auprc': 0.992520189192824, 'loss_val': 0.0622429561056406, 'psi': 0.9928860424284802}
[S11] START round=38 head_norm_before_train=2.175658 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8122557181830076, 'auprc': 0.9931334626179975, 'loss_val': 0.43467148973065295, 'psi': 0.8846068159570035}-{'f1_val': 0.9961541414107454, 'auprc': 0.9947225192837028, 'loss_val': 0.030655283485780855, 'psi': 0.9955814925599283}
[S13] START round=38 head_norm_before_train=1.890660 (no previous merge yet)
[S13] round=38 local utility u=0.291812 metrics={'f1_val': 0.6220038479439501, 'auprc': 0.7363643005332423, 'loss_val': 1.0891914442983202, 'psi': 0.667748028979667}-{'f1_val': 0.5914640599210103, 'auprc': 0.6298273021227687, 'loss_val': 1.1699661514477588, 'psi': 0.6068093568017137}
[S14] START round=38 head_norm_before_train=2.064586 (no previous merge yet)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.956149735191273, 'auprc': 0.9986769378632481, 'loss_val': 0.049638469109405475, 'psi': 0.973160616260063}-{'f1_val': 0.9947785013638276, 'auprc': 0.9986765600953427, 'loss_val': 0.03002095652703933, 'psi': 0.9963377248564336}
[S15] START round=38 head_norm_before_train=1.497160 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9037273598699466, 'auprc': 0.9670231543888621, 'loss_val': 0.2324017468166857, 'psi': 0.9290456776775128}-{'f1_val': 0.9968724968140973, 'auprc': 0.9984732185757662, 'loss_val': 0.05815601766806284, 'psi': 0.9975127855187649}
[S16] START round=38 head_norm_before_train=1.334219 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.060427 metrics={'f1_val': 0.9043500169251916, 'auprc': 0.9790043841618271, 'loss_val': 0.3692603704597803, 'psi': 0.9342117638198457}-{'f1_val': 0.8874285947179666, 'auprc': 0.9868585632040496, 'loss_val': 0.41214799095873833, 'psi': 0.9272005821123999}
[S17] START round=38 head_norm_before_train=2.082937 (no previous merge yet)
[S17] round=38 local utility u=1.000000 metrics={'f1_val': 0.8624357103361486, 'auprc': 0.9945059961157179, 'loss_val': 0.2709856325719714, 'psi': 0.9152638246479763}-{'f1_val': 0.6701392217545001, 'auprc': 0.8136331535491644, 'loss_val': 1.1783867170069375, 'psi': 0.7275367944723659}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39405
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S9
[S5] cosine check vs S9: cos=0.9978
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] cosine check vs S10: cos=0.9531
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.7006 head_norm=1.809126
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.828462e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.7006 head_norm=1.839370 delta_norm=0.068285
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9037 head_norm=1.546846
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.771677e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9034 head_norm=1.639483 delta_norm=0.277168
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.902627 cos_to_last_merge=0.9995 (last merge round=35)
[S2] round=39 local utility u=1.000000 metrics={'f1_val': 0.7193003422035558, 'auprc': 0.7550223065663668, 'loss_val': 0.6877985242631204, 'psi': 0.7335891279486801}-{'f1_val': 0.6008956069269187, 'auprc': 0.6689632896091229, 'loss_val': 1.8308985920274508, 'psi': 0.6281226799998003}
[S3] START round=39 head_norm_before_train=1.371278 cos_to_last_merge=0.9884 (last merge round=35)
[S3] round=39 local utility u=0.119953 metrics={'f1_val': 0.9944917838629344, 'auprc': 0.9983672393896696, 'loss_val': 0.10356725027709, 'psi': 0.9960419660736285}-{'f1_val': 0.9612046783862453, 'auprc': 0.9979187230857138, 'loss_val': 0.14240596224981367, 'psi': 0.9758902962660327}
[S4] START round=39 head_norm_before_train=1.859965 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.944411163872058, 'auprc': 0.919236809346176, 'loss_val': 0.34420936572352695, 'psi': 0.9343414220617052}-{'f1_val': 0.9550901354605397, 'auprc': 0.959057929815228, 'loss_val': 0.3138654027392881, 'psi': 0.9566772532024149}
[S5] START round=39 head_norm_before_train=1.839370 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.5356355472933232, 'auprc': 0.8535925199528895, 'loss_val': 0.7959804094770976, 'psi': 0.6628183363571498}-{'f1_val': 0.7006090940057808, 'auprc': 0.9903342283013818, 'loss_val': 0.20416789680363343, 'psi': 0.8164991477240212}
[S6] START round=39 head_norm_before_train=1.361411 cos_to_last_merge=0.9957 (last merge round=36)
[S6] round=39 local utility u=0.104024 metrics={'f1_val': 0.7760399153429429, 'auprc': 0.8754203928752189, 'loss_val': 0.5581036612163183, 'psi': 0.8157921063558533}-{'f1_val': 0.7792729184723031, 'auprc': 0.8088250294726145, 'loss_val': 0.585762673197357, 'psi': 0.7910937628724277}
[S7] START round=39 head_norm_before_train=1.418859 cos_to_last_merge=0.9999 (last merge round=37)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.552204441603244, 'auprc': 0.7790612670998603, 'loss_val': 0.8486237805763781, 'psi': 0.6429471718018905}-{'f1_val': 0.5998341229776462, 'auprc': 0.7868260458504324, 'loss_val': 0.7206188130192891, 'psi': 0.6746308921267606}
[S8] START round=39 head_norm_before_train=1.430986 cos_to_last_merge=0.9995 (last merge round=37)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9479139746443948, 'auprc': 0.9986688645707402, 'loss_val': 0.1385164656413674, 'psi': 0.9682159306149329}-{'f1_val': 0.9896293645032173, 'auprc': 0.998908668014796, 'loss_val': 0.07452722559708955, 'psi': 0.9933410859078489}
[S9] START round=39 head_norm_before_train=1.871617 cos_to_last_merge=0.9975 (last merge round=33)
[S9] round=39 local utility u=0.004638 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995806247937573, 'loss_val': 0.02997110457342944, 'psi': 0.998092279641041}-{'f1_val': 0.9963002897586258, 'auprc': 0.9994918295262945, 'loss_val': 0.03418148670533904, 'psi': 0.9975769056656932}
[S10] START round=39 head_norm_before_train=1.771079 cos_to_last_merge=0.9933 (last merge round=35)
[S10] round=39 local utility u=0.002892 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9931422799879064, 'loss_val': 0.04807299173899726, 'psi': 0.9932662704061043}-{'f1_val': 0.9935679896985945, 'auprc': 0.9920806463324316, 'loss_val': 0.051985838115682935, 'psi': 0.9929730523521293}
[S11] START round=39 head_norm_before_train=2.183991 (no previous merge yet)
[S11] round=39 local utility u=0.762650 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9959913554543272, 'loss_val': 0.02278637610813352, 'psi': 0.9962340545001973}-{'f1_val': 0.8122557181830076, 'auprc': 0.9931334626179975, 'loss_val': 0.43467148973065295, 'psi': 0.8846068159570035}
[S13] START round=39 head_norm_before_train=1.892964 (no previous merge yet)
[S13] round=39 local utility u=0.040933 metrics={'f1_val': 0.6271457595242614, 'auprc': 0.7407678541761673, 'loss_val': 1.051387688340959, 'psi': 0.6725945973850238}-{'f1_val': 0.6220038479439501, 'auprc': 0.7363643005332423, 'loss_val': 1.0891914442983202, 'psi': 0.667748028979667}
[S14] START round=39 head_norm_before_train=2.073510 (no previous merge yet)
[S14] round=39 local utility u=0.141241 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.998675434761398, 'loss_val': 0.01862783233740356, 'psi': 0.998307593813767}-{'f1_val': 0.956149735191273, 'auprc': 0.9986769378632481, 'loss_val': 0.049638469109405475, 'psi': 0.973160616260063}
[S15] START round=39 head_norm_before_train=1.639483 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.231091 metrics={'f1_val': 0.9512293545925962, 'auprc': 0.995695052064253, 'loss_val': 0.14124675564823902, 'psi': 0.969015633581259}-{'f1_val': 0.9037273598699466, 'auprc': 0.9670231543888621, 'loss_val': 0.2324017468166857, 'psi': 0.9290456776775128}
[S16] START round=39 head_norm_before_train=1.380852 cos_to_last_merge=0.9986 (last merge round=37)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8946410238809749, 'auprc': 0.9835922434056262, 'loss_val': 0.41514079797139886, 'psi': 0.9302215116908354}-{'f1_val': 0.9043500169251916, 'auprc': 0.9790043841618271, 'loss_val': 0.3692603704597803, 'psi': 0.9342117638198457}
[S17] START round=39 head_norm_before_train=2.094857 (no previous merge yet)
[S17] round=39 local utility u=0.201944 metrics={'f1_val': 0.9146323969543536, 'auprc': 0.9967809384140305, 'loss_val': 0.18710325018034019, 'psi': 0.9474918135382243}-{'f1_val': 0.8624357103361486, 'auprc': 0.9945059961157179, 'loss_val': 0.2709856325719714, 'psi': 0.9152638246479763}
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S15
[S6]  timeout peer S17
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S16
[S10]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S15]  timeout peer S2
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S13] r=40 psi=0.673 u=0.0409 p_local=0.1320 f1=0.627 auprc=0.741 bytes=25181
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S14] r=40 psi=0.998 u=0.1412 p_local=0.0354 f1=0.998 auprc=0.999 bytes=30502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39405
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:39409
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=40 psi=0.996 u=0.7626 p_local=0.1745 f1=0.996 auprc=0.996 bytes=30530
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.930 u=0.0000 p_local=0.1495 f1=0.895 auprc=0.984 bytes=32405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39408
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] sending update (kind=head size=1789 to 1 peers)
[S17] r=40 psi=0.947 u=0.2019 p_local=0.3744 f1=0.915 auprc=0.997 bytes=32325
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39404
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.934 u=0.0000 p_local=0.1095 f1=0.944 auprc=0.919 bytes=28817
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S15
[S7] cosine check vs S15: cos=0.9396
[S5] RECEIVED delta(kind=head bytes=1802) from S9
[S5] cosine check vs S9: cos=0.9991
[S15] RECEIVED delta(kind=head bytes=1803) from S10
[S15] cosine check vs S10: cos=0.9828
[S8] RECEIVED delta(kind=head bytes=1794) from S3
[S8] cosine check vs S3: cos=0.9802
[S9] r=40 psi=0.998 u=0.0046 p_local=0.0061 f1=0.997 auprc=1.000 bytes=34210
[S10] r=40 psi=0.993 u=0.0029 p_local=0.0058 f1=0.993 auprc=0.993 bytes=35975
[S3] r=40 psi=0.996 u=0.1200 p_local=0.1185 f1=0.994 auprc=0.998 bytes=32330
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9479 head_norm=1.468947
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.464666e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9295 head_norm=1.430489 delta_norm=0.146467
[S8] aggregate: ROLLBACK (f1_val pre=0.948 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S8] r=40 psi=0.968 u=0.0000 p_local=0.0693 f1=0.948 auprc=0.999 bytes=30538
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.5522 head_norm=1.430523
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.986370e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.5372 head_norm=1.534977 delta_norm=0.298637
[S7] aggregate: ROLLBACK (f1_val pre=0.552 post=0.537 tol_abs=0.005 tol_rel=0.0)
[S7] r=40 psi=0.643 u=0.0000 p_local=0.1329 f1=0.552 auprc=0.779 bytes=28786
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.5356 head_norm=1.841460
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.465193e-02
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.5260 head_norm=1.863549 delta_norm=0.044652
[S5] aggregate: ROLLBACK (f1_val pre=0.536 post=0.526 tol_abs=0.005 tol_rel=0.0)
[S5] r=40 psi=0.663 u=0.0000 p_local=0.2038 f1=0.536 auprc=0.854 bytes=34184
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:39416
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.8930
[S6] r=40 psi=0.816 u=0.1040 p_local=0.2625 f1=0.776 auprc=0.875 bytes=28803
[S2] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S2
[S4] cosine check vs S2: cos=0.9986
[S2] r=40 psi=0.734 u=1.0000 p_local=0.2717 f1=0.719 auprc=0.755 bytes=30576
[S15] CommDone barrier timeout: have=1 need=2 — continuing
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9512 head_norm=1.686500
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.727151e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9428 head_norm=1.738921 delta_norm=0.172715
[S15] aggregate: ROLLBACK (f1_val pre=0.951 post=0.943 tol_abs=0.005 tol_rel=0.0)
[S15] r=40 psi=0.969 u=0.2311 p_local=0.1059 f1=0.951 auprc=0.996 bytes=32394
[S2] START round=40 head_norm_before_train=1.915531 cos_to_last_merge=0.9993 (last merge round=35)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6726144082420756, 'auprc': 0.7472567673406216, 'loss_val': 0.9259379773162297, 'psi': 0.702471351881494}-{'f1_val': 0.7193003422035558, 'auprc': 0.7550223065663668, 'loss_val': 0.6877985242631204, 'psi': 0.7335891279486801}
[S3] START round=40 head_norm_before_train=1.406307 cos_to_last_merge=0.9834 (last merge round=35)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9812714658169968, 'auprc': 0.9979469057676, 'loss_val': 0.09790743736855304, 'psi': 0.987941641797238}-{'f1_val': 0.9944917838629344, 'auprc': 0.9983672393896696, 'loss_val': 0.10356725027709, 'psi': 0.9960419660736285}
[S4] START round=40 head_norm_before_train=1.864573 cos_to_last_merge=0.9999 (last merge round=37)
[S4] round=40 local utility u=0.087557 metrics={'f1_val': 0.9506347429111878, 'auprc': 0.9572472950844028, 'loss_val': 0.32046865227315185, 'psi': 0.9532797637804737}-{'f1_val': 0.944411163872058, 'auprc': 0.919236809346176, 'loss_val': 0.34420936572352695, 'psi': 0.9343414220617052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=40 metric=0.9506 head_norm=1.868910
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.775639e-02
[S4] stored merged vector for next round verification (round=40)
[S4] DEBUG after merge:  round=40 metric=0.9506 head_norm=1.891482 delta_norm=0.057756
[S4] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S5] START round=40 head_norm_before_train=1.863549 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.991328 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.989908147777361, 'loss_val': 0.21211223504928672, 'psi': 0.8163287155144129}-{'f1_val': 0.5356355472933232, 'auprc': 0.8535925199528895, 'loss_val': 0.7959804094770976, 'psi': 0.6628183363571498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=40 head_norm_before_train=1.406809 cos_to_last_merge=0.9916 (last merge round=36)
[S6] round=40 local utility u=0.101275 metrics={'f1_val': 0.785609595864617, 'auprc': 0.9010313997876374, 'loss_val': 0.4898042940435171, 'psi': 0.8317783174338251}-{'f1_val': 0.7760399153429429, 'auprc': 0.8754203928752189, 'loss_val': 0.5581036612163183, 'psi': 0.8157921063558533}
[S7] START round=40 head_norm_before_train=1.534977 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=1.000000 metrics={'f1_val': 0.7225017339414262, 'auprc': 0.9805945093628669, 'loss_val': 0.27921232889116504, 'psi': 0.8257388441100025}-{'f1_val': 0.552204441603244, 'auprc': 0.7790612670998603, 'loss_val': 0.8486237805763781, 'psi': 0.6429471718018905}
[S8] START round=40 head_norm_before_train=1.430489 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.176049 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9986785846329403, 'loss_val': 0.058568735020742904, 'psi': 0.9954318357741001}-{'f1_val': 0.9479139746443948, 'auprc': 0.9986688645707402, 'loss_val': 0.1385164656413674, 'psi': 0.9682159306149329}
[S9] START round=40 head_norm_before_train=1.886436 cos_to_last_merge=0.9968 (last merge round=33)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9979935965369087, 'loss_val': 0.02818975391051136, 'psi': 0.9977243726211498}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995806247937573, 'loss_val': 0.02997110457342944, 'psi': 0.998092279641041}
[S10] START round=40 head_norm_before_train=1.806397 cos_to_last_merge=0.9906 (last merge round=35)
[S10] round=40 local utility u=0.000209 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9932089263459085, 'loss_val': 0.046540068227986855, 'psi': 0.993161537289714}-{'f1_val': 0.9933489306849028, 'auprc': 0.9931422799879064, 'loss_val': 0.04807299173899726, 'psi': 0.9932662704061043}
[S11] START round=40 head_norm_before_train=2.193893 (no previous merge yet)
[S11] round=40 local utility u=0.001402 metrics={'f1_val': 0.996567470639547, 'auprc': 0.99629208119436, 'loss_val': 0.021914415162309978, 'psi': 0.9964573148614722}-{'f1_val': 0.9963958538641108, 'auprc': 0.9959913554543272, 'loss_val': 0.02278637610813352, 'psi': 0.9962340545001973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=40 head_norm_before_train=1.898452 (no previous merge yet)
[S13] round=40 local utility u=0.399829 metrics={'f1_val': 0.7126156217479717, 'auprc': 0.7809304282437319, 'loss_val': 0.8850367653338465, 'psi': 0.7399415443462758}-{'f1_val': 0.6271457595242614, 'auprc': 0.7407678541761673, 'loss_val': 1.051387688340959, 'psi': 0.6725945973850238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=40 head_norm_before_train=2.084248 (no previous merge yet)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9990501057820642, 'loss_val': 0.018246500570598324, 'psi': 0.9982123480023992}-{'f1_val': 0.9980623665153463, 'auprc': 0.998675434761398, 'loss_val': 0.01862783233740356, 'psi': 0.998307593813767}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.738921 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.182946 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9982196730847781, 'loss_val': 0.05861663456913002, 'psi': 0.9975942724406832}-{'f1_val': 0.9512293545925962, 'auprc': 0.995695052064253, 'loss_val': 0.14124675564823902, 'psi': 0.969015633581259}
[S16] START round=40 head_norm_before_train=1.445843 cos_to_last_merge=0.9938 (last merge round=37)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8918764616558744, 'auprc': 0.9872898119032538, 'loss_val': 0.44525196655037436, 'psi': 0.9300418017548262}-{'f1_val': 0.8946410238809749, 'auprc': 0.9835922434056262, 'loss_val': 0.41514079797139886, 'psi': 0.9302215116908354}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=40 metric=0.8919 head_norm=1.510853
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.631744e-01
[S16] stored merged vector for next round verification (round=40)
[S16] DEBUG after merge:  round=40 metric=0.8931 head_norm=1.413859 delta_norm=0.363174
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] START round=40 head_norm_before_train=2.108368 (no previous merge yet)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6472497843857546, 'auprc': 0.9217181918163505, 'loss_val': 0.9443731735629766, 'psi': 0.757037147357993}-{'f1_val': 0.9146323969543536, 'auprc': 0.9967809384140305, 'loss_val': 0.18710325018034019, 'psi': 0.9474918135382243}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.217 → S4@127.0.0.1:39404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:39415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:39416
[S9] ⇄ pheromone p=0.005 → S5@127.0.0.1:39405
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S8
[S6] cosine check vs S8: cos=0.7336
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=0.9673
[S15] RECEIVED delta(kind=head bytes=1801) from S10
[S15] cosine check vs S10: cos=0.9905
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.7856 head_norm=1.438436
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.289515e-01
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.7869 head_norm=1.349085 delta_norm=0.528952
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.230 → S16@127.0.0.1:39416
[S8] ⇄ pheromone p=0.091 → S6@127.0.0.1:39407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:39412
[S7] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S7
[S11] cosine check vs S7: cos=-0.0613
[S11] DROPPED delta from S7 (cos=-0.0613 < 0.0)
[S10] ⇄ pheromone p=0.005 → S15@127.0.0.1:39415
[S8]  timeout peer S6
[S8]  timeout peer S17
[S6]  timeout peer S14
[S6]  timeout peer S16
[S3]  timeout peer S8
[S3]  timeout peer S9
[S9]  timeout peer S5
[S15]  timeout peer S3
[S15]  timeout peer S7
[S15]  timeout peer S13
[S2]  timeout peer S4
[S7]  timeout peer S10
[S7]  timeout peer S11
[S10]  timeout peer S2
[S10]  timeout peer S15
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9972 head_norm=1.784361
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.272532e-01
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9967 head_norm=1.805726 delta_norm=0.127253
[S15] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=1.932482 cos_to_last_merge=0.9989 (last merge round=35)
[S2] round=41 local utility u=0.232185 metrics={'f1_val': 0.7227651905621677, 'auprc': 0.7434420599137459, 'loss_val': 0.7510286287562582, 'psi': 0.7310359383027989}-{'f1_val': 0.6726144082420756, 'auprc': 0.7472567673406216, 'loss_val': 0.9259379773162297, 'psi': 0.702471351881494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=41 head_norm_before_train=1.437686 cos_to_last_merge=0.9788 (last merge round=35)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9739108982765348, 'auprc': 0.9978180072236171, 'loss_val': 0.09808243830478333, 'psi': 0.9834737418553676}-{'f1_val': 0.9812714658169968, 'auprc': 0.9979469057676, 'loss_val': 0.09790743736855304, 'psi': 0.987941641797238}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.891482 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9550618269370731, 'auprc': 0.9555781992744763, 'loss_val': 0.35284606122471807, 'psi': 0.9552683758720344}-{'f1_val': 0.9506347429111878, 'auprc': 0.9572472950844028, 'loss_val': 0.32046865227315185, 'psi': 0.9532797637804737}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.864838 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.5777812028603635, 'auprc': 0.8537101139628143, 'loss_val': 0.657073330378902, 'psi': 0.6881527673013439}-{'f1_val': 0.7006090940057808, 'auprc': 0.989908147777361, 'loss_val': 0.21211223504928672, 'psi': 0.8163287155144129}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.349085 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.6542189832060914, 'auprc': 0.8002258365617695, 'loss_val': 0.5918064180868391, 'psi': 0.7126217245483626}-{'f1_val': 0.785609595864617, 'auprc': 0.9010313997876374, 'loss_val': 0.4898042940435171, 'psi': 0.8317783174338251}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.543606 cos_to_last_merge=0.9999 (last merge round=39)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.39739888009020663, 'auprc': 0.7574317194991802, 'loss_val': 1.315241360365222, 'psi': 0.5414120158537961}-{'f1_val': 0.7225017339414262, 'auprc': 0.9805945093628669, 'loss_val': 0.27921232889116504, 'psi': 0.8257388441100025}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=1.459639 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=41 local utility u=0.007583 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.998493492070448, 'loss_val': 0.04939776768859764, 'psi': 0.9960128131874951}-{'f1_val': 0.9932673365348732, 'auprc': 0.9986785846329403, 'loss_val': 0.058568735020742904, 'psi': 0.9954318357741001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=41 head_norm_before_train=1.901263 cos_to_last_merge=0.9961 (last merge round=33)
[S9] round=41 local utility u=0.001851 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995778518129127, 'loss_val': 0.02657077127300955, 'psi': 0.9980911704487031}-{'f1_val': 0.9975448900106438, 'auprc': 0.9979935965369087, 'loss_val': 0.02818975391051136, 'psi': 0.9977243726211498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=41 head_norm_before_train=1.835684 cos_to_last_merge=0.9881 (last merge round=35)
[S10] round=41 local utility u=0.000986 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9932253034301548, 'loss_val': 0.04461754692455222, 'psi': 0.9931680881234126}-{'f1_val': 0.9931299445855843, 'auprc': 0.9932089263459085, 'loss_val': 0.046540068227986855, 'psi': 0.993161537289714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=41 head_norm_before_train=2.204130 (no previous merge yet)
[S11] round=41 local utility u=0.000531 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965656015685502, 'loss_val': 0.021673240285828156, 'psi': 0.9965667230111483}-{'f1_val': 0.996567470639547, 'auprc': 0.99629208119436, 'loss_val': 0.021914415162309978, 'psi': 0.9964573148614722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=41 head_norm_before_train=1.910087 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6735343386449248, 'auprc': 0.7301137492692776, 'loss_val': 1.10995032211106, 'psi': 0.696166102894666}-{'f1_val': 0.7126156217479717, 'auprc': 0.7809304282437319, 'loss_val': 0.8850367653338465, 'psi': 0.7399415443462758}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.094735 (no previous merge yet)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9986732187501733, 'loss_val': 0.01903070210174164, 'psi': 0.9978654802914595}-{'f1_val': 0.9976538428159559, 'auprc': 0.9990501057820642, 'loss_val': 0.018246500570598324, 'psi': 0.9982123480023992}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.805726 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9057616218809603, 'auprc': 0.9960714777515692, 'loss_val': 0.18380595033748132, 'psi': 0.9418855642292039}-{'f1_val': 0.9971773386779533, 'auprc': 0.9982196730847781, 'loss_val': 0.05861663456913002, 'psi': 0.9975942724406832}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.413859 cos_to_last_merge=1.0000 (last merge round=40)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8702350602547935, 'auprc': 0.9800962845623643, 'loss_val': 0.5080846993568522, 'psi': 0.9141795499778218}-{'f1_val': 0.8918764616558744, 'auprc': 0.9872898119032538, 'loss_val': 0.44525196655037436, 'psi': 0.9300418017548262}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.8702 head_norm=1.474508
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.191745e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.8709 head_norm=1.440000 delta_norm=0.219175
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] START round=41 head_norm_before_train=2.118834 (no previous merge yet)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.910855635417305, 'auprc': 0.9927761065236719, 'loss_val': 0.18427598091182001, 'psi': 0.9436238238598518}-{'f1_val': 0.6472497843857546, 'auprc': 0.9217181918163505, 'loss_val': 0.9443731735629766, 'psi': 0.757037147357993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=42 head_norm_before_train=1.950432 cos_to_last_merge=0.9985 (last merge round=35)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7111004676998388, 'auprc': 0.7393344332404497, 'loss_val': 0.8034763386067274, 'psi': 0.7223940539160831}-{'f1_val': 0.7227651905621677, 'auprc': 0.7434420599137459, 'loss_val': 0.7510286287562582, 'psi': 0.7310359383027989}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.465773 cos_to_last_merge=0.9746 (last merge round=35)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9976400468305089, 'loss_val': 0.11910981191168504, 'psi': 0.9757788257639508}-{'f1_val': 0.9739108982765348, 'auprc': 0.9978180072236171, 'loss_val': 0.09808243830478333, 'psi': 0.9834737418553676}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.894810 cos_to_last_merge=1.0000 (last merge round=40)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.8455307623852106, 'auprc': 0.9325446667229687, 'loss_val': 0.4622857247043224, 'psi': 0.8803363241203138}-{'f1_val': 0.9550618269370731, 'auprc': 0.9555781992744763, 'loss_val': 0.35284606122471807, 'psi': 0.9552683758720344}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.866302 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=42 local utility u=0.350027 metrics={'f1_val': 0.6472167969972222, 'auprc': 0.8654699720693445, 'loss_val': 0.4089120919702645, 'psi': 0.7345180670260711}-{'f1_val': 0.5777812028603635, 'auprc': 0.8537101139628143, 'loss_val': 0.657073330378902, 'psi': 0.6881527673013439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=42 head_norm_before_train=1.373352 cos_to_last_merge=0.9996 (last merge round=40)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6351669812983594, 'auprc': 0.74547993309405, 'loss_val': 0.7335885053968348, 'psi': 0.6792921620166357}-{'f1_val': 0.6542189832060914, 'auprc': 0.8002258365617695, 'loss_val': 0.5918064180868391, 'psi': 0.7126217245483626}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.549297 cos_to_last_merge=0.9997 (last merge round=39)
[S7] round=42 local utility u=1.000000 metrics={'f1_val': 0.6976287511880506, 'auprc': 0.918595426255252, 'loss_val': 0.32829474672116843, 'psi': 0.7860154212149311}-{'f1_val': 0.39739888009020663, 'auprc': 0.7574317194991802, 'loss_val': 1.315241360365222, 'psi': 0.5414120158537961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=42 head_norm_before_train=1.493171 cos_to_last_merge=0.9992 (last merge round=39)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9889098366469105, 'auprc': 0.9929369446193301, 'loss_val': 0.051740487833435156, 'psi': 0.9905206798358783}-{'f1_val': 0.9943590272655265, 'auprc': 0.998493492070448, 'loss_val': 0.04939776768859764, 'psi': 0.9960128131874951}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.915614 cos_to_last_merge=0.9953 (last merge round=33)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9992012932468504, 'loss_val': 0.030267705633514892, 'psi': 0.9961943411490797}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995778518129127, 'loss_val': 0.02657077127300955, 'psi': 0.9980911704487031}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.860541 cos_to_last_merge=0.9861 (last merge round=35)
[S10] round=42 local utility u=0.001706 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9931038775389351, 'loss_val': 0.042155696249591826, 'psi': 0.9932509094265158}-{'f1_val': 0.9931299445855843, 'auprc': 0.9932253034301548, 'loss_val': 0.04461754692455222, 'psi': 0.9931680881234126}
[S10] not sending this round → trigger blocked (psi=0.993)
[S11] START round=42 head_norm_before_train=2.214345 (no previous merge yet)
[S11] round=42 local utility u=0.001804 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965650438323533, 'loss_val': 0.01951475025828499, 'psi': 0.9967115273886886}-{'f1_val': 0.996567470639547, 'auprc': 0.9965656015685502, 'loss_val': 0.021673240285828156, 'psi': 0.9965667230111483}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.918236 (no previous merge yet)
[S13] round=42 local utility u=0.551382 metrics={'f1_val': 0.7455419864227207, 'auprc': 0.8052127404617444, 'loss_val': 0.6645296845852507, 'psi': 0.7694102880383302}-{'f1_val': 0.6735343386449248, 'auprc': 0.7301137492692776, 'loss_val': 1.10995032211106, 'psi': 0.696166102894666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=42 head_norm_before_train=2.102719 (no previous merge yet)
[S14] round=42 local utility u=0.002695 metrics={'f1_val': 0.9978965638266506, 'auprc': 0.9986747589896332, 'loss_val': 0.01706303203869394, 'psi': 0.9982078418918436}-{'f1_val': 0.9973269879856502, 'auprc': 0.9986732187501733, 'loss_val': 0.01903070210174164, 'psi': 0.9978654802914595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=42 head_norm_before_train=1.844557 cos_to_last_merge=0.9991 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.8941862152412484, 'auprc': 0.9710282217759624, 'loss_val': 0.2616017744758411, 'psi': 0.924923017855134}-{'f1_val': 0.9057616218809603, 'auprc': 0.9960714777515692, 'loss_val': 0.18380595033748132, 'psi': 0.9418855642292039}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.440000 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.108382 metrics={'f1_val': 0.8897556685474615, 'auprc': 0.983795453753697, 'loss_val': 0.41954229786897673, 'psi': 0.9273715826299558}-{'f1_val': 0.8702350602547935, 'auprc': 0.9800962845623643, 'loss_val': 0.5080846993568522, 'psi': 0.9141795499778218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=42 head_norm_before_train=2.126425 (no previous merge yet)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5224429284042049, 'auprc': 0.9068367614242553, 'loss_val': 0.9839592645307945, 'psi': 0.676200461612225}-{'f1_val': 0.910855635417305, 'auprc': 0.9927761065236719, 'loss_val': 0.18427598091182001, 'psi': 0.9436238238598518}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.968565 cos_to_last_merge=0.9980 (last merge round=35)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.6467576525597685, 'auprc': 0.7335151419486118, 'loss_val': 1.2274414013488915, 'psi': 0.6814606483153058}-{'f1_val': 0.7111004676998388, 'auprc': 0.7393344332404497, 'loss_val': 0.8034763386067274, 'psi': 0.7223940539160831}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=1.490065 cos_to_last_merge=0.9710 (last merge round=35)
[S3] round=43 local utility u=0.085716 metrics={'f1_val': 0.9840969561841303, 'auprc': 0.9976423250369544, 'loss_val': 0.08503921778401258, 'psi': 0.9895151037252599}-{'f1_val': 0.9612046783862453, 'auprc': 0.9976400468305089, 'loss_val': 0.11910981191168504, 'psi': 0.9757788257639508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=43 head_norm_before_train=1.893978 cos_to_last_merge=0.9999 (last merge round=40)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.6202340616803674, 'auprc': 0.9043512520453493, 'loss_val': 0.828849742877851, 'psi': 0.7338809378263602}-{'f1_val': 0.8455307623852106, 'auprc': 0.9325446667229687, 'loss_val': 0.4622857247043224, 'psi': 0.8803363241203138}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.869699 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.5497746098510319, 'auprc': 0.8536503580992981, 'loss_val': 0.7799522246399492, 'psi': 0.6713249091503384}-{'f1_val': 0.6472167969972222, 'auprc': 0.8654699720693445, 'loss_val': 0.4089120919702645, 'psi': 0.7345180670260711}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.403171 cos_to_last_merge=0.9983 (last merge round=40)
[S6] round=43 local utility u=0.566200 metrics={'f1_val': 0.7604948215767247, 'auprc': 0.8109342258031449, 'loss_val': 0.5495177407777267, 'psi': 0.7806705832672927}-{'f1_val': 0.6351669812983594, 'auprc': 0.74547993309405, 'loss_val': 0.7335885053968348, 'psi': 0.6792921620166357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=43 head_norm_before_train=1.554218 cos_to_last_merge=0.9995 (last merge round=39)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5802895885093781, 'auprc': 0.7798288153739564, 'loss_val': 0.7446256644390827, 'psi': 0.6601052792552093}-{'f1_val': 0.6976287511880506, 'auprc': 0.918595426255252, 'loss_val': 0.32829474672116843, 'psi': 0.7860154212149311}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.525916 cos_to_last_merge=0.9984 (last merge round=39)
[S8] round=43 local utility u=0.031179 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.998775704468852, 'loss_val': 0.04131494312153261, 'psi': 0.9962978607451667}-{'f1_val': 0.9889098366469105, 'auprc': 0.9929369446193301, 'loss_val': 0.051740487833435156, 'psi': 0.9905206798358783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=43 head_norm_before_train=1.928049 cos_to_last_merge=0.9947 (last merge round=33)
[S9] round=43 local utility u=0.013804 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9995810490916412, 'loss_val': 0.02374317231079775, 'psi': 0.998340710090703}-{'f1_val': 0.9941897064172326, 'auprc': 0.9992012932468504, 'loss_val': 0.030267705633514892, 'psi': 0.9961943411490797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=43 head_norm_before_train=1.881790 cos_to_last_merge=0.9843 (last merge round=35)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9932492790534072, 'loss_val': 0.04217534128883848, 'psi': 0.9931776783727135}-{'f1_val': 0.9933489306849028, 'auprc': 0.9931038775389351, 'loss_val': 0.042155696249591826, 'psi': 0.9932509094265158}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.222829 (no previous merge yet)
[S11] round=43 local utility u=0.000068 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965608088349835, 'loss_val': 0.019365880060760326, 'psi': 0.9967098333897407}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965650438323533, 'loss_val': 0.01951475025828499, 'psi': 0.9967115273886886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.925745 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.622699245072555, 'auprc': 0.8043505174334552, 'loss_val': 1.224829191466621, 'psi': 0.6953597540169152}-{'f1_val': 0.7455419864227207, 'auprc': 0.8052127404617444, 'loss_val': 0.6645296845852507, 'psi': 0.7694102880383302}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.111311 (no previous merge yet)
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9978427420196455, 'auprc': 0.9986295076486581, 'loss_val': 0.019213648459417393, 'psi': 0.9981574482712505}-{'f1_val': 0.9978965638266506, 'auprc': 0.9986747589896332, 'loss_val': 0.01706303203869394, 'psi': 0.9982078418918436}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.877351 cos_to_last_merge=0.9976 (last merge round=40)
[S15] round=43 local utility u=0.442030 metrics={'f1_val': 0.9920290959448979, 'auprc': 0.9989018950438566, 'loss_val': 0.04822098335089754, 'psi': 0.9947782155844813}-{'f1_val': 0.8941862152412484, 'auprc': 0.9710282217759624, 'loss_val': 0.2616017744758411, 'psi': 0.924923017855134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=43 head_norm_before_train=1.507260 cos_to_last_merge=0.9979 (last merge round=41)
[S16] round=43 local utility u=0.243436 metrics={'f1_val': 0.9389726383193182, 'auprc': 0.9887416852134973, 'loss_val': 0.24281129128886839, 'psi': 0.9588802570769898}-{'f1_val': 0.8897556685474615, 'auprc': 0.983795453753697, 'loss_val': 0.41954229786897673, 'psi': 0.9273715826299558}
[S16] not sending this round → trigger blocked (psi=0.959)
[S17] START round=43 head_norm_before_train=2.137498 (no previous merge yet)
[S17] round=43 local utility u=0.716454 metrics={'f1_val': 0.6800164165997837, 'auprc': 0.9822092393263062, 'loss_val': 0.7226093543535215, 'psi': 0.8008935456903927}-{'f1_val': 0.5224429284042049, 'auprc': 0.9068367614242553, 'loss_val': 0.9839592645307945, 'psi': 0.676200461612225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=44 head_norm_before_train=1.987582 cos_to_last_merge=0.9974 (last merge round=35)
[S2] round=44 local utility u=0.378384 metrics={'f1_val': 0.705833987644934, 'auprc': 0.7382386145269617, 'loss_val': 0.8393025599826542, 'psi': 0.7187958383977451}-{'f1_val': 0.6467576525597685, 'auprc': 0.7335151419486118, 'loss_val': 1.2274414013488915, 'psi': 0.6814606483153058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=1.509866 cos_to_last_merge=0.9680 (last merge round=35)
[S3] round=44 local utility u=0.054496 metrics={'f1_val': 0.9970867503541486, 'auprc': 0.9975339143786751, 'loss_val': 0.05365981746190819, 'psi': 0.9972656159639592}-{'f1_val': 0.9840969561841303, 'auprc': 0.9976423250369544, 'loss_val': 0.08503921778401258, 'psi': 0.9895151037252599}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=44 head_norm_before_train=1.896290 cos_to_last_merge=0.9998 (last merge round=40)
[S4] round=44 local utility u=1.000000 metrics={'f1_val': 0.9474648387320839, 'auprc': 0.9385921380057715, 'loss_val': 0.3310037180786956, 'psi': 0.943915758441559}-{'f1_val': 0.6202340616803674, 'auprc': 0.9043512520453493, 'loss_val': 0.828849742877851, 'psi': 0.7338809378263602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=44 head_norm_before_train=1.873917 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=44 local utility u=1.000000 metrics={'f1_val': 0.7852410569034006, 'auprc': 0.9962852760574921, 'loss_val': 0.1436921456656499, 'psi': 0.8696587445650372}-{'f1_val': 0.5497746098510319, 'auprc': 0.8536503580992981, 'loss_val': 0.7799522246399492, 'psi': 0.6713249091503384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=44 head_norm_before_train=1.442876 cos_to_last_merge=0.9955 (last merge round=40)
[S6] round=44 local utility u=0.794985 metrics={'f1_val': 0.9091613309434543, 'auprc': 0.9575633452477862, 'loss_val': 0.2914349864213537, 'psi': 0.928522136665187}-{'f1_val': 0.7604948215767247, 'auprc': 0.8109342258031449, 'loss_val': 0.5495177407777267, 'psi': 0.7806705832672927}
[S6] not sending this round → trigger blocked (psi=0.929)
[S7] START round=44 head_norm_before_train=1.558493 cos_to_last_merge=0.9993 (last merge round=39)
[S7] round=44 local utility u=0.557614 metrics={'f1_val': 0.6855686592902976, 'auprc': 0.8339672277302026, 'loss_val': 0.42348709514972127, 'psi': 0.7449280866662596}-{'f1_val': 0.5802895885093781, 'auprc': 0.7798288153739564, 'loss_val': 0.7446256644390827, 'psi': 0.6601052792552093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=44 head_norm_before_train=1.554491 cos_to_last_merge=0.9974 (last merge round=39)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9989117176854474, 'loss_val': 0.03817183358441055, 'psi': 0.9953876078251784}-{'f1_val': 0.9946459649293765, 'auprc': 0.998775704468852, 'loss_val': 0.04131494312153261, 'psi': 0.9962978607451667}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.939835 cos_to_last_merge=0.9940 (last merge round=33)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9973964142004023, 'loss_val': 0.0233485168085381, 'psi': 0.9974854996865472}-{'f1_val': 0.9975138174234109, 'auprc': 0.9995810490916412, 'loss_val': 0.02374317231079775, 'psi': 0.998340710090703}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.898979 cos_to_last_merge=0.9828 (last merge round=35)
[S10] round=44 local utility u=0.000607 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9935666939319554, 'loss_val': 0.04191278931184812, 'psi': 0.9933046443241328}-{'f1_val': 0.9931299445855843, 'auprc': 0.9932492790534072, 'loss_val': 0.04217534128883848, 'psi': 0.9931776783727135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=44 head_norm_before_train=2.227954 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965767380264257, 'loss_val': 0.021242156354519873, 'psi': 0.9965711775942985}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965608088349835, 'loss_val': 0.019365880060760326, 'psi': 0.9967098333897407}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.931686 (no previous merge yet)
[S13] round=44 local utility u=0.192993 metrics={'f1_val': 0.6828758893448661, 'auprc': 0.7279497710044488, 'loss_val': 0.9707008882677349, 'psi': 0.7009054420086992}-{'f1_val': 0.622699245072555, 'auprc': 0.8043505174334552, 'loss_val': 1.224829191466621, 'psi': 0.6953597540169152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=44 head_norm_before_train=2.118068 (no previous merge yet)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9976914548345881, 'auprc': 0.998676623321082, 'loss_val': 0.020243334975120805, 'psi': 0.9980855222291857}-{'f1_val': 0.9978427420196455, 'auprc': 0.9986295076486581, 'loss_val': 0.019213648459417393, 'psi': 0.9981574482712505}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.905086 cos_to_last_merge=0.9962 (last merge round=40)
[S15] round=44 local utility u=0.022854 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9978394250032099, 'loss_val': 0.030215908730617767, 'psi': 0.997442173208056}-{'f1_val': 0.9920290959448979, 'auprc': 0.9989018950438566, 'loss_val': 0.04822098335089754, 'psi': 0.9947782155844813}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=44 head_norm_before_train=1.576756 cos_to_last_merge=0.9928 (last merge round=41)
[S16] round=44 local utility u=0.029555 metrics={'f1_val': 0.9408494936449847, 'auprc': 0.9867802313994453, 'loss_val': 0.18907824070617224, 'psi': 0.9592217887467689}-{'f1_val': 0.9389726383193182, 'auprc': 0.9887416852134973, 'loss_val': 0.24281129128886839, 'psi': 0.9588802570769898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=44 head_norm_before_train=2.150760 (no previous merge yet)
[S17] round=44 local utility u=0.429847 metrics={'f1_val': 0.7776239476410078, 'auprc': 0.9950516863076426, 'loss_val': 0.48708813335744244, 'psi': 0.8645950431076617}-{'f1_val': 0.6800164165997837, 'auprc': 0.9822092393263062, 'loss_val': 0.7226093543535215, 'psi': 0.8008935456903927}
[S17] not sending this round → trigger blocked (psi=0.865)
[S2] START round=45 head_norm_before_train=2.005388 cos_to_last_merge=0.9968 (last merge round=35)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6972670057861452, 'auprc': 0.7289034871883744, 'loss_val': 1.0216025277393714, 'psi': 0.7099215983470368}-{'f1_val': 0.705833987644934, 'auprc': 0.7382386145269617, 'loss_val': 0.8393025599826542, 'psi': 0.7187958383977451}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.526661 cos_to_last_merge=0.9656 (last merge round=35)
[S3] round=45 local utility u=0.001586 metrics={'f1_val': 0.9970867503541486, 'auprc': 0.9975151686355235, 'loss_val': 0.05043177972633476, 'psi': 0.9972581176666986}-{'f1_val': 0.9970867503541486, 'auprc': 0.9975339143786751, 'loss_val': 0.05365981746190819, 'psi': 0.9972656159639592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=1.898254 cos_to_last_merge=0.9996 (last merge round=40)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9442075841252427, 'auprc': 0.9172690213931166, 'loss_val': 0.32641580405371723, 'psi': 0.9334321590323923}-{'f1_val': 0.9474648387320839, 'auprc': 0.9385921380057715, 'loss_val': 0.3310037180786956, 'psi': 0.943915758441559}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.877110 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.5279102115698368, 'auprc': 0.8535905949742629, 'loss_val': 0.8337081735884102, 'psi': 0.6581823649316072}-{'f1_val': 0.7852410569034006, 'auprc': 0.9962852760574921, 'loss_val': 0.1436921456656499, 'psi': 0.8696587445650372}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.497907 cos_to_last_merge=0.9903 (last merge round=40)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.46370461876664726, 'auprc': 0.7796715309616777, 'loss_val': 1.27471201174455, 'psi': 0.5900913836446595}-{'f1_val': 0.9091613309434543, 'auprc': 0.9575633452477862, 'loss_val': 0.2914349864213537, 'psi': 0.928522136665187}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.563735 cos_to_last_merge=0.9991 (last merge round=39)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6337124600909616, 'auprc': 0.7867261076205758, 'loss_val': 0.6233744617019068, 'psi': 0.6949179191028073}-{'f1_val': 0.6855686592902976, 'auprc': 0.8339672277302026, 'loss_val': 0.42348709514972127, 'psi': 0.7449280866662596}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.581111 cos_to_last_merge=0.9964 (last merge round=39)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9916044936271314, 'auprc': 0.998183332126105, 'loss_val': 0.04252377878375614, 'psi': 0.9942360290267209}-{'f1_val': 0.9930382012516658, 'auprc': 0.9989117176854474, 'loss_val': 0.03817183358441055, 'psi': 0.9953876078251784}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.949914 cos_to_last_merge=0.9934 (last merge round=33)
[S9] round=45 local utility u=0.001381 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9980210103478482, 'loss_val': 0.022460034883112153, 'psi': 0.9977353381455255}-{'f1_val': 0.9975448900106438, 'auprc': 0.9973964142004023, 'loss_val': 0.0233485168085381, 'psi': 0.9974854996865472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=45 head_norm_before_train=1.915716 cos_to_last_merge=0.9813 (last merge round=35)
[S10] round=45 local utility u=0.001115 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9931319577791335, 'loss_val': 0.03969263629770308, 'psi': 0.9932621415225952}-{'f1_val': 0.9931299445855843, 'auprc': 0.9935666939319554, 'loss_val': 0.04191278931184812, 'psi': 0.9933046443241328}
[S10] not sending this round → trigger blocked (psi=0.993)
[S11] START round=45 head_norm_before_train=2.234647 (no previous merge yet)
[S11] round=45 local utility u=0.000020 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965855032158483, 'loss_val': 0.021229298313319003, 'psi': 0.9965746836700675}-{'f1_val': 0.996567470639547, 'auprc': 0.9965767380264257, 'loss_val': 0.021242156354519873, 'psi': 0.9965711775942985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=45 head_norm_before_train=1.936752 (no previous merge yet)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6268016895055522, 'auprc': 0.8820481808606945, 'loss_val': 1.1775893733074747, 'psi': 0.728900286047609}-{'f1_val': 0.6828758893448661, 'auprc': 0.7279497710044488, 'loss_val': 0.9707008882677349, 'psi': 0.7009054420086992}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=2.121939 (no previous merge yet)
[S14] round=45 local utility u=0.002385 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9988121809813344, 'loss_val': 0.018105365798896884, 'psi': 0.9983622923017416}-{'f1_val': 0.9976914548345881, 'auprc': 0.998676623321082, 'loss_val': 0.020243334975120805, 'psi': 0.9980855222291857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=45 head_norm_before_train=1.928374 cos_to_last_merge=0.9949 (last merge round=40)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.9071324719064706, 'auprc': 0.9972781351746303, 'loss_val': 0.1970750425576587, 'psi': 0.9431907372137345}-{'f1_val': 0.9971773386779533, 'auprc': 0.9978394250032099, 'loss_val': 0.030215908730617767, 'psi': 0.997442173208056}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.637685 cos_to_last_merge=0.9874 (last merge round=41)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.939778384324921, 'auprc': 0.9862262354424062, 'loss_val': 0.24291955584008162, 'psi': 0.958357524771915}-{'f1_val': 0.9408494936449847, 'auprc': 0.9867802313994453, 'loss_val': 0.18907824070617224, 'psi': 0.9592217887467689}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=2.162028 (no previous merge yet)
[S17] round=45 local utility u=0.526376 metrics={'f1_val': 0.9106022099371772, 'auprc': 0.9944741143641617, 'loss_val': 0.23047306627434055, 'psi': 0.944150971707971}-{'f1_val': 0.7776239476410078, 'auprc': 0.9950516863076426, 'loss_val': 0.48708813335744244, 'psi': 0.8645950431076617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=46 head_norm_before_train=2.021888 cos_to_last_merge=0.9962 (last merge round=35)
[S2] round=46 local utility u=0.129979 metrics={'f1_val': 0.7093603325518614, 'auprc': 0.7398373645516658, 'loss_val': 0.867005690684113, 'psi': 0.7215511453517831}-{'f1_val': 0.6972670057861452, 'auprc': 0.7289034871883744, 'loss_val': 1.0216025277393714, 'psi': 0.7099215983470368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=46 head_norm_before_train=1.543875 cos_to_last_merge=0.9631 (last merge round=35)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9606844270113373, 'auprc': 0.9975216118263729, 'loss_val': 0.11822254006513891, 'psi': 0.9754193009373515}-{'f1_val': 0.9970867503541486, 'auprc': 0.9975151686355235, 'loss_val': 0.05043177972633476, 'psi': 0.9972581176666986}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.905262 cos_to_last_merge=0.9993 (last merge round=40)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9342396009340794, 'auprc': 0.9109205499988162, 'loss_val': 0.38783920566454855, 'psi': 0.9249119805599741}-{'f1_val': 0.9442075841252427, 'auprc': 0.9172690213931166, 'loss_val': 0.32641580405371723, 'psi': 0.9334321590323923}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.881345 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=46 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9867597498070488, 'loss_val': 0.2340643087934408, 'psi': 0.8150693563262881}-{'f1_val': 0.5279102115698368, 'auprc': 0.8535905949742629, 'loss_val': 0.8337081735884102, 'psi': 0.6581823649316072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=46 head_norm_before_train=1.544736 cos_to_last_merge=0.9851 (last merge round=40)
[S6] round=46 local utility u=1.000000 metrics={'f1_val': 0.9094480228370739, 'auprc': 0.9261228303158255, 'loss_val': 0.32558583914711636, 'psi': 0.9161179458285745}-{'f1_val': 0.46370461876664726, 'auprc': 0.7796715309616777, 'loss_val': 1.27471201174455, 'psi': 0.5900913836446595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=46 head_norm_before_train=1.570767 cos_to_last_merge=0.9987 (last merge round=39)
[S7] round=46 local utility u=0.065530 metrics={'f1_val': 0.6443821301693498, 'auprc': 0.7949608197529416, 'loss_val': 0.5810363188330894, 'psi': 0.7046136060027866}-{'f1_val': 0.6337124600909616, 'auprc': 0.7867261076205758, 'loss_val': 0.6233744617019068, 'psi': 0.6949179191028073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=46 head_norm_before_train=1.600211 cos_to_last_merge=0.9956 (last merge round=39)
[S8] round=46 local utility u=0.006000 metrics={'f1_val': 0.9923077140383828, 'auprc': 0.9988723823604931, 'loss_val': 0.036810092470144204, 'psi': 0.9949335813672269}-{'f1_val': 0.9916044936271314, 'auprc': 0.998183332126105, 'loss_val': 0.04252377878375614, 'psi': 0.9942360290267209}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=46 head_norm_before_train=1.960115 cos_to_last_merge=0.9928 (last merge round=33)
[S9] round=46 local utility u=0.001917 metrics={'f1_val': 0.9972923331772335, 'auprc': 0.9995832076033311, 'loss_val': 0.021797897860980672, 'psi': 0.9982086829476726}-{'f1_val': 0.9975448900106438, 'auprc': 0.9980210103478482, 'loss_val': 0.022460034883112153, 'psi': 0.9977353381455255}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=46 head_norm_before_train=1.929910 cos_to_last_merge=0.9801 (last merge round=35)
[S10] round=46 local utility u=0.000173 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9932360304849387, 'loss_val': 0.03965871930736506, 'psi': 0.9933037706049173}-{'f1_val': 0.9933489306849028, 'auprc': 0.9931319577791335, 'loss_val': 0.03969263629770308, 'psi': 0.9932621415225952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=46 head_norm_before_train=2.242239 (no previous merge yet)
[S11] round=46 local utility u=0.002619 metrics={'f1_val': 0.997050770792581, 'auprc': 0.9965553774724959, 'loss_val': 0.018800560489705246, 'psi': 0.996852613464547}-{'f1_val': 0.996567470639547, 'auprc': 0.9965855032158483, 'loss_val': 0.021229298313319003, 'psi': 0.9965746836700675}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=46 head_norm_before_train=1.940274 (no previous merge yet)
[S13] round=46 local utility u=0.071540 metrics={'f1_val': 0.6474330108165317, 'auprc': 0.8417737754058695, 'loss_val': 1.0374741505580256, 'psi': 0.7251693166522668}-{'f1_val': 0.6268016895055522, 'auprc': 0.8820481808606945, 'loss_val': 1.1775893733074747, 'psi': 0.728900286047609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=46 head_norm_before_train=2.128943 (no previous merge yet)
[S14] round=46 local utility u=0.000193 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9986760396368879, 'loss_val': 0.017325090135364398, 'psi': 0.9983091805962874}-{'f1_val': 0.9980623665153463, 'auprc': 0.9988121809813344, 'loss_val': 0.018105365798896884, 'psi': 0.9983622923017416}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=46 head_norm_before_train=1.949557 cos_to_last_merge=0.9937 (last merge round=40)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9060022796874235, 'auprc': 0.9972594026769057, 'loss_val': 0.2154625325651413, 'psi': 0.9425051288832164}-{'f1_val': 0.9071324719064706, 'auprc': 0.9972781351746303, 'loss_val': 0.1970750425576587, 'psi': 0.9431907372137345}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=46 head_norm_before_train=1.687898 cos_to_last_merge=0.9824 (last merge round=41)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.9310244504436282, 'auprc': 0.9859276244066029, 'loss_val': 0.32558880611235996, 'psi': 0.9529857200288181}-{'f1_val': 0.939778384324921, 'auprc': 0.9862262354424062, 'loss_val': 0.24291955584008162, 'psi': 0.958357524771915}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.173510 (no previous merge yet)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.8451169463427911, 'auprc': 0.9937793193852956, 'loss_val': 0.4150702475965164, 'psi': 0.9045818955597928}-{'f1_val': 0.9106022099371772, 'auprc': 0.9944741143641617, 'loss_val': 0.23047306627434055, 'psi': 0.944150971707971}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.034453 cos_to_last_merge=0.9957 (last merge round=35)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6731329918433899, 'auprc': 0.7342368134470817, 'loss_val': 1.0452991028951966, 'psi': 0.6975745204848667}-{'f1_val': 0.7093603325518614, 'auprc': 0.7398373645516658, 'loss_val': 0.867005690684113, 'psi': 0.7215511453517831}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.557865 cos_to_last_merge=0.9610 (last merge round=35)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9978091415160315, 'loss_val': 0.1255354878021549, 'psi': 0.9755682504536287}-{'f1_val': 0.9606844270113373, 'auprc': 0.9975216118263729, 'loss_val': 0.11822254006513891, 'psi': 0.9754193009373515}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.910592 cos_to_last_merge=0.9990 (last merge round=40)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.734657423050204, 'auprc': 0.925222382869834, 'loss_val': 0.5347398677824975, 'psi': 0.810883406978056}-{'f1_val': 0.9342396009340794, 'auprc': 0.9109205499988162, 'loss_val': 0.38783920566454855, 'psi': 0.9249119805599741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.883898 cos_to_last_merge=0.9999 (last merge round=39)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.4409345704728501, 'auprc': 0.853563288447718, 'loss_val': 0.8448804496211463, 'psi': 0.6059860576627973}-{'f1_val': 0.7006090940057808, 'auprc': 0.9867597498070488, 'loss_val': 0.2340643087934408, 'psi': 0.8150693563262881}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.572284 cos_to_last_merge=0.9820 (last merge round=40)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.5736273105557534, 'auprc': 0.631378713067886, 'loss_val': 1.1448243834131355, 'psi': 0.5967278715606064}-{'f1_val': 0.9094480228370739, 'auprc': 0.9261228303158255, 'loss_val': 0.32558583914711636, 'psi': 0.9161179458285745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.583255 cos_to_last_merge=0.9981 (last merge round=39)
[S7] round=47 local utility u=0.269332 metrics={'f1_val': 0.6791780836822224, 'auprc': 0.838402409371054, 'loss_val': 0.38147183096813264, 'psi': 0.7428678139577551}-{'f1_val': 0.6443821301693498, 'auprc': 0.7949608197529416, 'loss_val': 0.5810363188330894, 'psi': 0.7046136060027866}
[S7] not sending this round → trigger blocked (psi=0.743)
[S8] START round=47 head_norm_before_train=1.617449 cos_to_last_merge=0.9949 (last merge round=39)
[S8] round=47 local utility u=0.008895 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9985221429938005, 'loss_val': 0.031998251969180484, 'psi': 0.9961964361551461}-{'f1_val': 0.9923077140383828, 'auprc': 0.9988723823604931, 'loss_val': 0.036810092470144204, 'psi': 0.9949335813672269}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=47 head_norm_before_train=1.970483 cos_to_last_merge=0.9922 (last merge round=33)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.9980831019761914, 'loss_val': 0.021234777707469687, 'psi': 0.9976099780606271}-{'f1_val': 0.9972923331772335, 'auprc': 0.9995832076033311, 'loss_val': 0.021797897860980672, 'psi': 0.9982086829476726}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.943945 cos_to_last_merge=0.9789 (last merge round=35)
[S10] round=47 local utility u=0.000334 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.993169799575354, 'loss_val': 0.03879108748920877, 'psi': 0.9932772782410834}-{'f1_val': 0.9933489306849028, 'auprc': 0.9932360304849387, 'loss_val': 0.03965871930736506, 'psi': 0.9933037706049173}
[S10] not sending this round → trigger blocked (psi=0.993)
[S11] START round=47 head_norm_before_train=2.249692 (no previous merge yet)
[S11] round=47 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965680292118378, 'loss_val': 0.019802556678305265, 'psi': 0.9965676940684634}-{'f1_val': 0.997050770792581, 'auprc': 0.9965553774724959, 'loss_val': 0.018800560489705246, 'psi': 0.996852613464547}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=47 head_norm_before_train=1.942435 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6261692193974691, 'auprc': 0.699663440419318, 'loss_val': 1.2182384962624673, 'psi': 0.6555669078062086}-{'f1_val': 0.6474330108165317, 'auprc': 0.8417737754058695, 'loss_val': 1.0374741505580256, 'psi': 0.7251693166522668}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=2.134617 (no previous merge yet)
[S14] round=47 local utility u=0.000647 metrics={'f1_val': 0.9981079619156942, 'auprc': 0.9990514863697956, 'loss_val': 0.017418435233795986, 'psi': 0.9984853716973348}-{'f1_val': 0.9980646079025537, 'auprc': 0.9986760396368879, 'loss_val': 0.017325090135364398, 'psi': 0.9983091805962874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=47 head_norm_before_train=1.968393 cos_to_last_merge=0.9926 (last merge round=40)
[S15] round=47 local utility u=0.197044 metrics={'f1_val': 0.9527049762969282, 'auprc': 0.9976611025414809, 'loss_val': 0.10279608854790129, 'psi': 0.9706874267947492}-{'f1_val': 0.9060022796874235, 'auprc': 0.9972594026769057, 'loss_val': 0.2154625325651413, 'psi': 0.9425051288832164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=47 head_norm_before_train=1.728411 cos_to_last_merge=0.9784 (last merge round=41)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9164554295202212, 'auprc': 0.9858411358319679, 'loss_val': 0.4033516858435875, 'psi': 0.9442097120449199}-{'f1_val': 0.9310244504436282, 'auprc': 0.9859276244066029, 'loss_val': 0.32558880611235996, 'psi': 0.9529857200288181}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.185148 (no previous merge yet)
[S17] round=47 local utility u=0.170243 metrics={'f1_val': 0.8856887278027074, 'auprc': 0.996624061510504, 'loss_val': 0.326548433079201, 'psi': 0.930062861285826}-{'f1_val': 0.8451169463427911, 'auprc': 0.9937793193852956, 'loss_val': 0.4150702475965164, 'psi': 0.9045818955597928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=48 head_norm_before_train=2.045195 cos_to_last_merge=0.9953 (last merge round=35)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.63421425036359, 'auprc': 0.7335667050230192, 'loss_val': 1.3884661411277592, 'psi': 0.6739552322273616}-{'f1_val': 0.6731329918433899, 'auprc': 0.7342368134470817, 'loss_val': 1.0452991028951966, 'psi': 0.6975745204848667}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.569102 cos_to_last_merge=0.9594 (last merge round=35)
[S3] round=48 local utility u=0.148421 metrics={'f1_val': 0.9966754250663681, 'auprc': 0.9974804066649923, 'loss_val': 0.04331487742651657, 'psi': 0.9969974177058177}-{'f1_val': 0.9607409897453603, 'auprc': 0.9978091415160315, 'loss_val': 0.1255354878021549, 'psi': 0.9755682504536287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=48 head_norm_before_train=1.916867 cos_to_last_merge=0.9988 (last merge round=40)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.6594688707411493, 'auprc': 0.9160595559214159, 'loss_val': 0.6049455628864727, 'psi': 0.762105144813256}-{'f1_val': 0.734657423050204, 'auprc': 0.925222382869834, 'loss_val': 0.5347398677824975, 'psi': 0.810883406978056}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.889027 cos_to_last_merge=0.9998 (last merge round=39)
[S5] round=48 local utility u=1.000000 metrics={'f1_val': 0.7620443220925672, 'auprc': 0.9721212369189208, 'loss_val': 0.2483424745290386, 'psi': 0.8460750880231087}-{'f1_val': 0.4409345704728501, 'auprc': 0.853563288447718, 'loss_val': 0.8448804496211463, 'psi': 0.6059860576627973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=48 head_norm_before_train=1.595046 cos_to_last_merge=0.9794 (last merge round=40)
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9857016879820175, 'auprc': 0.9573253686535776, 'loss_val': 0.09762116567508382, 'psi': 0.9743511602506415}-{'f1_val': 0.5736273105557534, 'auprc': 0.631378713067886, 'loss_val': 1.1448243834131355, 'psi': 0.5967278715606064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=48 head_norm_before_train=1.593867 cos_to_last_merge=0.9974 (last merge round=39)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5735573845677845, 'auprc': 0.7830131820437671, 'loss_val': 0.8140016643515909, 'psi': 0.6573397035581776}-{'f1_val': 0.6791780836822224, 'auprc': 0.838402409371054, 'loss_val': 0.38147183096813264, 'psi': 0.7428678139577551}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.633425 cos_to_last_merge=0.9942 (last merge round=39)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.991074834927764, 'auprc': 0.9960430975938773, 'loss_val': 0.03820678861347, 'psi': 0.9930621399942094}-{'f1_val': 0.9946459649293765, 'auprc': 0.9985221429938005, 'loss_val': 0.031998251969180484, 'psi': 0.9961964361551461}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.978292 cos_to_last_merge=0.9917 (last merge round=33)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.997849059664768, 'loss_val': 0.020717444888861368, 'psi': 0.9975163611360578}-{'f1_val': 0.9972945621169176, 'auprc': 0.9980831019761914, 'loss_val': 0.021234777707469687, 'psi': 0.9976099780606271}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.957901 cos_to_last_merge=0.9777 (last merge round=35)
[S10] round=48 local utility u=0.000590 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9936074919105611, 'loss_val': 0.03892363443472534, 'psi': 0.9934523551751662}-{'f1_val': 0.9933489306849028, 'auprc': 0.993169799575354, 'loss_val': 0.03879108748920877, 'psi': 0.9932772782410834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=48 head_norm_before_train=2.257975 (no previous merge yet)
[S11] round=48 local utility u=0.001190 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965655785218592, 'loss_val': 0.018864832387919, 'psi': 0.996711741264491}-{'f1_val': 0.996567470639547, 'auprc': 0.9965680292118378, 'loss_val': 0.019802556678305265, 'psi': 0.9965676940684634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=48 head_norm_before_train=1.946470 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.5983527199010642, 'auprc': 0.6515621768094081, 'loss_val': 1.429672222694352, 'psi': 0.6196365026644017}-{'f1_val': 0.6261692193974691, 'auprc': 0.699663440419318, 'loss_val': 1.2182384962624673, 'psi': 0.6555669078062086}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.140102 (no previous merge yet)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9862487646523502, 'auprc': 0.998676623321082, 'loss_val': 0.03654156822329339, 'psi': 0.991219908119843}-{'f1_val': 0.9981079619156942, 'auprc': 0.9990514863697956, 'loss_val': 0.017418435233795986, 'psi': 0.9984853716973348}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.985287 cos_to_last_merge=0.9916 (last merge round=40)
[S15] round=48 local utility u=0.068430 metrics={'f1_val': 0.9689650461318318, 'auprc': 0.9976442289213971, 'loss_val': 0.06344538058980437, 'psi': 0.9804367192476579}-{'f1_val': 0.9527049762969282, 'auprc': 0.9976611025414809, 'loss_val': 0.10279608854790129, 'psi': 0.9706874267947492}
[S15] not sending this round → trigger blocked (psi=0.980)
[S16] START round=48 head_norm_before_train=1.761147 cos_to_last_merge=0.9753 (last merge round=41)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9149935676846943, 'auprc': 0.9845076137322925, 'loss_val': 0.42011255917299245, 'psi': 0.9427991861037336}-{'f1_val': 0.9164554295202212, 'auprc': 0.9858411358319679, 'loss_val': 0.4033516858435875, 'psi': 0.9442097120449199}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.193531 (no previous merge yet)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.8431840438098692, 'auprc': 0.9995335475755536, 'loss_val': 0.4760330628544139, 'psi': 0.9057238453161429}-{'f1_val': 0.8856887278027074, 'auprc': 0.996624061510504, 'loss_val': 0.326548433079201, 'psi': 0.930062861285826}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.056860 cos_to_last_merge=0.9948 (last merge round=35)
[S2] round=49 local utility u=0.540140 metrics={'f1_val': 0.7174769691470624, 'auprc': 0.7456047093374701, 'loss_val': 0.8438766991799128, 'psi': 0.7287280652232255}-{'f1_val': 0.63421425036359, 'auprc': 0.7335667050230192, 'loss_val': 1.3884661411277592, 'psi': 0.6739552322273616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=49 head_norm_before_train=1.582137 cos_to_last_merge=0.9575 (last merge round=35)
[S3] round=49 local utility u=0.003037 metrics={'f1_val': 0.9970867503541486, 'auprc': 0.9977855524094039, 'loss_val': 0.04062344528013546, 'psi': 0.9973662711762508}-{'f1_val': 0.9966754250663681, 'auprc': 0.9974804066649923, 'loss_val': 0.04331487742651657, 'psi': 0.9969974177058177}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=49 head_norm_before_train=1.923059 cos_to_last_merge=0.9985 (last merge round=40)
[S4] round=49 local utility u=0.979684 metrics={'f1_val': 0.9418148894368374, 'auprc': 0.921263086584392, 'loss_val': 0.3552634888182145, 'psi': 0.9335941682958593}-{'f1_val': 0.6594688707411493, 'auprc': 0.9160595559214159, 'loss_val': 0.6049455628864727, 'psi': 0.762105144813256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=49 head_norm_before_train=1.893110 cos_to_last_merge=0.9996 (last merge round=39)
[S5] round=49 local utility u=0.463931 metrics={'f1_val': 0.8849848844112986, 'auprc': 0.995932546564277, 'loss_val': 0.12955762348694388, 'psi': 0.92936394927249}-{'f1_val': 0.7620443220925672, 'auprc': 0.9721212369189208, 'loss_val': 0.2483424745290386, 'psi': 0.8460750880231087}
[S5] not sending this round → trigger blocked (psi=0.929)
[S6] START round=49 head_norm_before_train=1.616632 cos_to_last_merge=0.9771 (last merge round=40)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5423113471685224, 'auprc': 0.6749953883412505, 'loss_val': 1.035100662851826, 'psi': 0.5953849636376136}-{'f1_val': 0.9857016879820175, 'auprc': 0.9573253686535776, 'loss_val': 0.09762116567508382, 'psi': 0.9743511602506415}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.602711 cos_to_last_merge=0.9969 (last merge round=39)
[S7] round=49 local utility u=0.454287 metrics={'f1_val': 0.6606990319046084, 'auprc': 0.8085988006732971, 'loss_val': 0.5050338184890201, 'psi': 0.719858939412084}-{'f1_val': 0.5735573845677845, 'auprc': 0.7830131820437671, 'loss_val': 0.8140016643515909, 'psi': 0.6573397035581776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=49 head_norm_before_train=1.644028 cos_to_last_merge=0.9937 (last merge round=39)
[S8] round=49 local utility u=0.013302 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.998292630271406, 'loss_val': 0.033653982759286036, 'psi': 0.9954922543772604}-{'f1_val': 0.991074834927764, 'auprc': 0.9960430975938773, 'loss_val': 0.03820678861347, 'psi': 0.9930621399942094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=49 head_norm_before_train=1.986097 cos_to_last_merge=0.9912 (last merge round=33)
[S9] round=49 local utility u=0.001614 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9982825014457322, 'loss_val': 0.020292279632929813, 'psi': 0.9978399345846791}-{'f1_val': 0.9972945621169176, 'auprc': 0.997849059664768, 'loss_val': 0.020717444888861368, 'psi': 0.9975163611360578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=49 head_norm_before_train=1.969674 cos_to_last_merge=0.9767 (last merge round=35)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.993668630660441, 'loss_val': 0.03918834400976196, 'psi': 0.9933454190155271}-{'f1_val': 0.9933489306849028, 'auprc': 0.9936074919105611, 'loss_val': 0.03892363443472534, 'psi': 0.9934523551751662}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.265918 (no previous merge yet)
[S11] round=49 local utility u=0.000239 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965471124809794, 'loss_val': 0.018330901185795972, 'psi': 0.996704354848139}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965655785218592, 'loss_val': 0.018864832387919, 'psi': 0.996711741264491}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=49 head_norm_before_train=1.946339 (no previous merge yet)
[S13] round=49 local utility u=0.847418 metrics={'f1_val': 0.6893821826266544, 'auprc': 0.8100262978426211, 'loss_val': 0.7564044411868351, 'psi': 0.7376398287130411}-{'f1_val': 0.5983527199010642, 'auprc': 0.6515621768094081, 'loss_val': 1.429672222694352, 'psi': 0.6196365026644017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=49 head_norm_before_train=2.143678 (no previous merge yet)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9410998535203575, 'auprc': 0.998676623321082, 'loss_val': 0.07090959741745098, 'psi': 0.9641305614406472}-{'f1_val': 0.9862487646523502, 'auprc': 0.998676623321082, 'loss_val': 0.03654156822329339, 'psi': 0.991219908119843}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=2.000551 cos_to_last_merge=0.9906 (last merge round=40)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.9118981317940381, 'auprc': 0.9974865597373639, 'loss_val': 0.19166413576289318, 'psi': 0.9461335029713684}-{'f1_val': 0.9689650461318318, 'auprc': 0.9976442289213971, 'loss_val': 0.06344538058980437, 'psi': 0.9804367192476579}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.783099 cos_to_last_merge=0.9735 (last merge round=41)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.8983769177661298, 'auprc': 0.9736800915036192, 'loss_val': 0.47933081027040586, 'psi': 0.9284981872611255}-{'f1_val': 0.9149935676846943, 'auprc': 0.9845076137322925, 'loss_val': 0.42011255917299245, 'psi': 0.9427991861037336}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=2.203456 (no previous merge yet)
[S17] round=49 local utility u=0.358789 metrics={'f1_val': 0.9121913859205333, 'auprc': 0.9992097714795845, 'loss_val': 0.17152735971532984, 'psi': 0.9469987401441538}-{'f1_val': 0.8431840438098692, 'auprc': 0.9995335475755536, 'loss_val': 0.4760330628544139, 'psi': 0.9057238453161429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=50 head_norm_before_train=2.067500 cos_to_last_merge=0.9944 (last merge round=35)
[S2] round=50 local utility u=0.043779 metrics={'f1_val': 0.7205107901382015, 'auprc': 0.7598062353194109, 'loss_val': 0.817125677588158, 'psi': 0.7362289682106853}-{'f1_val': 0.7174769691470624, 'auprc': 0.7456047093374701, 'loss_val': 0.8438766991799128, 'psi': 0.7287280652232255}
[S2] not sending this round → trigger blocked (psi=0.736)
[S3] START round=50 head_norm_before_train=1.595492 cos_to_last_merge=0.9556 (last merge round=35)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9825046855023224, 'auprc': 0.9978009706539104, 'loss_val': 0.06471370461937916, 'psi': 0.9886231995629575}-{'f1_val': 0.9970867503541486, 'auprc': 0.9977855524094039, 'loss_val': 0.04062344528013546, 'psi': 0.9973662711762508}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.928544 cos_to_last_merge=0.9981 (last merge round=40)
[S4] round=50 local utility u=0.063264 metrics={'f1_val': 0.9514164742697373, 'auprc': 0.9339935835490484, 'loss_val': 0.32453715943035344, 'psi': 0.9444473179814618}-{'f1_val': 0.9418148894368374, 'auprc': 0.921263086584392, 'loss_val': 0.3552634888182145, 'psi': 0.9335941682958593}
[S4] not sending this round → trigger blocked (psi=0.944)
[S5] START round=50 head_norm_before_train=1.896940 cos_to_last_merge=0.9996 (last merge round=39)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.6456479911359476, 'auprc': 0.8340480729246038, 'loss_val': 0.6220272442644076, 'psi': 0.72100802385141}-{'f1_val': 0.8849848844112986, 'auprc': 0.995932546564277, 'loss_val': 0.12955762348694388, 'psi': 0.92936394927249}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=1.639357 cos_to_last_merge=0.9746 (last merge round=40)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.7462548849031896, 'auprc': 0.8588590994849953, 'loss_val': 0.675995173754508, 'psi': 0.7912965707359119}-{'f1_val': 0.5423113471685224, 'auprc': 0.6749953883412505, 'loss_val': 1.035100662851826, 'psi': 0.5953849636376136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=50 head_norm_before_train=1.614194 cos_to_last_merge=0.9961 (last merge round=39)
[S7] round=50 local utility u=0.012101 metrics={'f1_val': 0.6560244275071059, 'auprc': 0.8137800520992596, 'loss_val': 0.46832753675223904, 'psi': 0.7191266773439674}-{'f1_val': 0.6606990319046084, 'auprc': 0.8085988006732971, 'loss_val': 0.5050338184890201, 'psi': 0.719858939412084}
[S7] not sending this round → trigger blocked (psi=0.719)
[S8] START round=50 head_norm_before_train=1.655033 cos_to_last_merge=0.9931 (last merge round=39)
[S8] round=50 local utility u=0.001958 metrics={'f1_val': 0.994792642153961, 'auprc': 0.997249420041965, 'loss_val': 0.03361124644627879, 'psi': 0.9957753533091627}-{'f1_val': 0.9936253371144965, 'auprc': 0.998292630271406, 'loss_val': 0.033653982759286036, 'psi': 0.9954922543772604}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=50 head_norm_before_train=1.993286 cos_to_last_merge=0.9908 (last merge round=33)
[S9] round=50 local utility u=0.002251 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9995812144463561, 'loss_val': 0.019500876033388532, 'psi': 0.998340776232589}-{'f1_val': 0.9975448900106438, 'auprc': 0.9982825014457322, 'loss_val': 0.020292279632929813, 'psi': 0.9978399345846791}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=50 head_norm_before_train=1.981328 cos_to_last_merge=0.9757 (last merge round=35)
[S10] round=50 local utility u=0.001711 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9928394383432542, 'loss_val': 0.03590793655459466, 'psi': 0.9932765691564583}-{'f1_val': 0.9931299445855843, 'auprc': 0.993668630660441, 'loss_val': 0.03918834400976196, 'psi': 0.9933454190155271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=50 head_norm_before_train=2.270527 (no previous merge yet)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9964154281422654, 'loss_val': 0.018298142608961912, 'psi': 0.9966516811126535}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965471124809794, 'loss_val': 0.018330901185795972, 'psi': 0.996704354848139}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.946415 (no previous merge yet)
[S13] round=50 local utility u=0.068947 metrics={'f1_val': 0.735516789122475, 'auprc': 0.8357854276404214, 'loss_val': 0.9725964415586518, 'psi': 0.7756242445296535}-{'f1_val': 0.6893821826266544, 'auprc': 0.8100262978426211, 'loss_val': 0.7564044411868351, 'psi': 0.7376398287130411}
[S13] not sending this round → trigger blocked (psi=0.776)
[S14] START round=50 head_norm_before_train=2.150151 (no previous merge yet)
[S14] round=50 local utility u=0.193068 metrics={'f1_val': 0.9972768303733199, 'auprc': 0.9990522591706902, 'loss_val': 0.022962741984035476, 'psi': 0.997987001892268}-{'f1_val': 0.9410998535203575, 'auprc': 0.998676623321082, 'loss_val': 0.07090959741745098, 'psi': 0.9641305614406472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=50 head_norm_before_train=2.014580 cos_to_last_merge=0.9898 (last merge round=40)
[S15] round=50 local utility u=0.185809 metrics={'f1_val': 0.9574432395621089, 'auprc': 0.9976643685010216, 'loss_val': 0.09385032767702071, 'psi': 0.973531691137674}-{'f1_val': 0.9118981317940381, 'auprc': 0.9974865597373639, 'loss_val': 0.19166413576289318, 'psi': 0.9461335029713684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=50 head_norm_before_train=1.801963 cos_to_last_merge=0.9720 (last merge round=41)
[S16] round=50 local utility u=0.056189 metrics={'f1_val': 0.9090948338533206, 'auprc': 0.980798270373757, 'loss_val': 0.45261465526396755, 'psi': 0.9377762084614951}-{'f1_val': 0.8983769177661298, 'auprc': 0.9736800915036192, 'loss_val': 0.47933081027040586, 'psi': 0.9284981872611255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=50 head_norm_before_train=2.212698 (no previous merge yet)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.7386816692585425, 'auprc': 0.9988464199658972, 'loss_val': 0.7605367090702426, 'psi': 0.8427475695414843}-{'f1_val': 0.9121913859205333, 'auprc': 0.9992097714795845, 'loss_val': 0.17152735971532984, 'psi': 0.9469987401441538}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=2.075141 cos_to_last_merge=0.9940 (last merge round=35)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.714161646478764, 'auprc': 0.7447576190889587, 'loss_val': 0.8919961709096748, 'psi': 0.7264000355228418}-{'f1_val': 0.7205107901382015, 'auprc': 0.7598062353194109, 'loss_val': 0.817125677588158, 'psi': 0.7362289682106853}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.609331 cos_to_last_merge=0.9536 (last merge round=35)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9591813008630663, 'auprc': 0.9978379800783665, 'loss_val': 0.11303318770342337, 'psi': 0.9746439725491863}-{'f1_val': 0.9825046855023224, 'auprc': 0.9978009706539104, 'loss_val': 0.06471370461937916, 'psi': 0.9886231995629575}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.928310 cos_to_last_merge=0.9974 (last merge round=40)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9527945715477499, 'auprc': 0.9247769145150406, 'loss_val': 0.3272598765615695, 'psi': 0.9415875087346661}-{'f1_val': 0.9514164742697373, 'auprc': 0.9339935835490484, 'loss_val': 0.32453715943035344, 'psi': 0.9444473179814618}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.900307 cos_to_last_merge=0.9994 (last merge round=39)
[S5] round=51 local utility u=0.811912 metrics={'f1_val': 0.7651761910487733, 'auprc': 0.9927119248063089, 'loss_val': 0.19136471021606485, 'psi': 0.8561904845517876}-{'f1_val': 0.6456479911359476, 'auprc': 0.8340480729246038, 'loss_val': 0.6220272442644076, 'psi': 0.72100802385141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=51 head_norm_before_train=1.661280 cos_to_last_merge=0.9720 (last merge round=40)
[S6] round=51 local utility u=0.101377 metrics={'f1_val': 0.8000257065298719, 'auprc': 0.7928591447714421, 'loss_val': 0.5978667813646669, 'psi': 0.7971590818265}-{'f1_val': 0.7462548849031896, 'auprc': 0.8588590994849953, 'loss_val': 0.675995173754508, 'psi': 0.7912965707359119}
[S6] not sending this round → trigger blocked (psi=0.797)
[S7] START round=51 head_norm_before_train=1.628561 cos_to_last_merge=0.9953 (last merge round=39)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6259773431009925, 'auprc': 0.799934457965062, 'loss_val': 0.5841100039949942, 'psi': 0.6955601890466203}-{'f1_val': 0.6560244275071059, 'auprc': 0.8137800520992596, 'loss_val': 0.46832753675223904, 'psi': 0.7191266773439674}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.669768 cos_to_last_merge=0.9923 (last merge round=39)
[S8] round=51 local utility u=0.001929 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9987551795631808, 'loss_val': 0.02986128601113108, 'psi': 0.9959366944969097}-{'f1_val': 0.994792642153961, 'auprc': 0.997249420041965, 'loss_val': 0.03361124644627879, 'psi': 0.9957753533091627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=51 head_norm_before_train=2.001148 cos_to_last_merge=0.9904 (last merge round=33)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9933536184876286, 'auprc': 0.9995788648074277, 'loss_val': 0.02602440669124112, 'psi': 0.9958437170155482}-{'f1_val': 0.9975138174234109, 'auprc': 0.9995812144463561, 'loss_val': 0.019500876033388532, 'psi': 0.998340776232589}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.993207 cos_to_last_merge=0.9746 (last merge round=35)
[S10] round=51 local utility u=0.000118 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9931086892669669, 'loss_val': 0.03647982896126667, 'psi': 0.9933842695259434}-{'f1_val': 0.9935679896985945, 'auprc': 0.9928394383432542, 'loss_val': 0.03590793655459466, 'psi': 0.9932765691564583}
[S10] not sending this round → trigger blocked (psi=0.993)
[S11] START round=51 head_norm_before_train=2.276445 (no previous merge yet)
[S11] round=51 local utility u=0.000047 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963686683980222, 'loss_val': 0.018062960918738553, 'psi': 0.9966329772149561}-{'f1_val': 0.9968091830929121, 'auprc': 0.9964154281422654, 'loss_val': 0.018298142608961912, 'psi': 0.9966516811126535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=51 head_norm_before_train=1.954816 (no previous merge yet)
[S13] round=51 local utility u=0.000592 metrics={'f1_val': 0.7407787046292514, 'auprc': 0.8028432584691779, 'loss_val': 0.9041564486769098, 'psi': 0.765604526165222}-{'f1_val': 0.735516789122475, 'auprc': 0.8357854276404214, 'loss_val': 0.9725964415586518, 'psi': 0.7756242445296535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=51 head_norm_before_train=2.157700 (no previous merge yet)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9970616270651818, 'auprc': 0.9986764529955903, 'loss_val': 0.023438962153407364, 'psi': 0.9977075574373451}-{'f1_val': 0.9972768303733199, 'auprc': 0.9990522591706902, 'loss_val': 0.022962741984035476, 'psi': 0.997987001892268}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=2.026640 cos_to_last_merge=0.9890 (last merge round=40)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.9170943024009506, 'auprc': 0.9980186855167915, 'loss_val': 0.14175462826503463, 'psi': 0.949464055647287}-{'f1_val': 0.9574432395621089, 'auprc': 0.9976643685010216, 'loss_val': 0.09385032767702071, 'psi': 0.973531691137674}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.819744 cos_to_last_merge=0.9704 (last merge round=41)
[S16] round=51 local utility u=0.142835 metrics={'f1_val': 0.9364705355632207, 'auprc': 0.9726273043275596, 'loss_val': 0.30668552052913794, 'psi': 0.9509332430689562}-{'f1_val': 0.9090948338533206, 'auprc': 0.980798270373757, 'loss_val': 0.45261465526396755, 'psi': 0.9377762084614951}
[S16] not sending this round → trigger blocked (psi=0.951)
[S17] START round=51 head_norm_before_train=2.223110 (no previous merge yet)
[S17] round=51 local utility u=0.783816 metrics={'f1_val': 0.9116823169577151, 'auprc': 0.9987977703183665, 'loss_val': 0.23076324223102082, 'psi': 0.9465284983019756}-{'f1_val': 0.7386816692585425, 'auprc': 0.9988464199658972, 'loss_val': 0.7605367090702426, 'psi': 0.8427475695414843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=52 head_norm_before_train=2.083326 cos_to_last_merge=0.9937 (last merge round=35)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6859618820657494, 'auprc': 0.7462048569207178, 'loss_val': 0.9807703995853947, 'psi': 0.7100590720077368}-{'f1_val': 0.714161646478764, 'auprc': 0.7447576190889587, 'loss_val': 0.8919961709096748, 'psi': 0.7264000355228418}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.623425 cos_to_last_merge=0.9517 (last merge round=35)
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.9576688385490855, 'auprc': 0.9978289587225786, 'loss_val': 0.11777480262032938, 'psi': 0.9737328866184827}-{'f1_val': 0.9591813008630663, 'auprc': 0.9978379800783665, 'loss_val': 0.11303318770342337, 'psi': 0.9746439725491863}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=1.929138 cos_to_last_merge=0.9969 (last merge round=40)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9477553406347827, 'auprc': 0.9306138639132213, 'loss_val': 0.32946096342727743, 'psi': 0.9408987499461582}-{'f1_val': 0.9527945715477499, 'auprc': 0.9247769145150406, 'loss_val': 0.3272598765615695, 'psi': 0.9415875087346661}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.901362 cos_to_last_merge=0.9993 (last merge round=39)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.7006947214685414, 'auprc': 0.9361170116246555, 'loss_val': 0.4397795977525792, 'psi': 0.794863637530987}-{'f1_val': 0.7651761910487733, 'auprc': 0.9927119248063089, 'loss_val': 0.19136471021606485, 'psi': 0.8561904845517876}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.685402 cos_to_last_merge=0.9692 (last merge round=40)
[S6] round=52 local utility u=0.389234 metrics={'f1_val': 0.8146530637940184, 'auprc': 0.9374294319615664, 'loss_val': 0.3408744499741452, 'psi': 0.8637636110610376}-{'f1_val': 0.8000257065298719, 'auprc': 0.7928591447714421, 'loss_val': 0.5978667813646669, 'psi': 0.7971590818265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=52 head_norm_before_train=1.645628 cos_to_last_merge=0.9942 (last merge round=39)
[S7] round=52 local utility u=0.694940 metrics={'f1_val': 0.7690148487023183, 'auprc': 0.8720933808427322, 'loss_val': 0.2689321383598922, 'psi': 0.8102462615584838}-{'f1_val': 0.6259773431009925, 'auprc': 0.799934457965062, 'loss_val': 0.5841100039949942, 'psi': 0.6955601890466203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=52 head_norm_before_train=1.685214 cos_to_last_merge=0.9916 (last merge round=39)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9883436617281106, 'auprc': 0.9990000277929674, 'loss_val': 0.04055893046644575, 'psi': 0.9926062081540532}-{'f1_val': 0.994057704452729, 'auprc': 0.9987551795631808, 'loss_val': 0.02986128601113108, 'psi': 0.9959366944969097}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=2.008198 cos_to_last_merge=0.9899 (last merge round=33)
[S9] round=52 local utility u=0.014494 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993057270579845, 'loss_val': 0.018712027141910146, 'psi': 0.9979840383304794}-{'f1_val': 0.9933536184876286, 'auprc': 0.9995788648074277, 'loss_val': 0.02602440669124112, 'psi': 0.9958437170155482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=52 head_norm_before_train=2.001463 cos_to_last_merge=0.9739 (last merge round=35)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9937305387482391, 'loss_val': 0.03804216515066644, 'psi': 0.9935015739102374}-{'f1_val': 0.9935679896985945, 'auprc': 0.9931086892669669, 'loss_val': 0.03647982896126667, 'psi': 0.9933842695259434}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=2.282150 (no previous merge yet)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965408743982567, 'loss_val': 0.019810860773822575, 'psi': 0.9965568321430309}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963686683980222, 'loss_val': 0.018062960918738553, 'psi': 0.9966329772149561}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.966632 (no previous merge yet)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6565772785779382, 'auprc': 0.8307629219563823, 'loss_val': 0.9483868527718018, 'psi': 0.7262515359293159}-{'f1_val': 0.7407787046292514, 'auprc': 0.8028432584691779, 'loss_val': 0.9041564486769098, 'psi': 0.765604526165222}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=2.164116 (no previous merge yet)
[S14] round=52 local utility u=0.005033 metrics={'f1_val': 0.9978910992781401, 'auprc': 0.9986769875466048, 'loss_val': 0.01835122713052189, 'psi': 0.9982054545855261}-{'f1_val': 0.9970616270651818, 'auprc': 0.9986764529955903, 'loss_val': 0.023438962153407364, 'psi': 0.9977075574373451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=52 head_norm_before_train=2.037765 cos_to_last_merge=0.9882 (last merge round=40)
[S15] round=52 local utility u=0.215598 metrics={'f1_val': 0.9738980544416027, 'auprc': 0.9976775546996862, 'loss_val': 0.05035870594941693, 'psi': 0.9834098545448361}-{'f1_val': 0.9170943024009506, 'auprc': 0.9980186855167915, 'loss_val': 0.14175462826503463, 'psi': 0.949464055647287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=52 head_norm_before_train=1.834474 cos_to_last_merge=0.9693 (last merge round=41)
[S16] round=52 local utility u=0.177256 metrics={'f1_val': 0.9590670768023595, 'auprc': 0.9831090179815608, 'loss_val': 0.11919843572162615, 'psi': 0.96868385327404}-{'f1_val': 0.9364705355632207, 'auprc': 0.9726273043275596, 'loss_val': 0.30668552052913794, 'psi': 0.9509332430689562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=52 head_norm_before_train=2.234502 (no previous merge yet)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6367969568334879, 'auprc': 0.9938259919969231, 'loss_val': 1.174225594567204, 'psi': 0.779608570898862}-{'f1_val': 0.9116823169577151, 'auprc': 0.9987977703183665, 'loss_val': 0.23076324223102082, 'psi': 0.9465284983019756}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=2.096118 cos_to_last_merge=0.9933 (last merge round=35)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.6491494231397907, 'auprc': 0.7428649373220082, 'loss_val': 1.2999300432693721, 'psi': 0.6866356288126777}-{'f1_val': 0.6859618820657494, 'auprc': 0.7462048569207178, 'loss_val': 0.9807703995853947, 'psi': 0.7100590720077368}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=1.636347 cos_to_last_merge=0.9497 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.950
[S3] round=53 local utility u=0.103053 metrics={'f1_val': 0.9817027836098922, 'auprc': 0.9981152766589426, 'loss_val': 0.0567318819338282, 'psi': 0.9882677808295124}-{'f1_val': 0.9576688385490855, 'auprc': 0.9978289587225786, 'loss_val': 0.11777480262032938, 'psi': 0.9737328866184827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=53 head_norm_before_train=1.929786 cos_to_last_merge=0.9969 (last merge round=40)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.8705405376747978, 'auprc': 0.917652276761743, 'loss_val': 0.46447949735807237, 'psi': 0.8893852333095758}-{'f1_val': 0.9477553406347827, 'auprc': 0.9306138639132213, 'loss_val': 0.32946096342727743, 'psi': 0.9408987499461582}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.901386 cos_to_last_merge=0.9993 (last merge round=39)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.67078822283629, 'auprc': 0.8538497748896058, 'loss_val': 0.4981479933221208, 'psi': 0.7440128436576163}-{'f1_val': 0.7006947214685414, 'auprc': 0.9361170116246555, 'loss_val': 0.4397795977525792, 'psi': 0.794863637530987}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.715433 cos_to_last_merge=0.9658 (last merge round=40)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5455505512145638, 'auprc': 0.7621055835481292, 'loss_val': 1.3048629525675801, 'psi': 0.63217256414799}-{'f1_val': 0.8146530637940184, 'auprc': 0.9374294319615664, 'loss_val': 0.3408744499741452, 'psi': 0.8637636110610376}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.657979 cos_to_last_merge=0.9932 (last merge round=39)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.6316688771455644, 'auprc': 0.7964377673348164, 'loss_val': 0.597668890227803, 'psi': 0.6975764332212653}-{'f1_val': 0.7690148487023183, 'auprc': 0.8720933808427322, 'loss_val': 0.2689321383598922, 'psi': 0.8102462615584838}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.700523 cos_to_last_merge=0.9910 (last merge round=39)
[S8] round=53 local utility u=0.028368 metrics={'f1_val': 0.9955298311535434, 'auprc': 0.9988080696983747, 'loss_val': 0.026364709328296935, 'psi': 0.9968411265714759}-{'f1_val': 0.9883436617281106, 'auprc': 0.9990000277929674, 'loss_val': 0.04055893046644575, 'psi': 0.9926062081540532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=53 head_norm_before_train=2.014011 cos_to_last_merge=0.9895 (last merge round=33)
[S9] round=53 local utility u=0.001723 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995935225870725, 'loss_val': 0.018781460527109984, 'psi': 0.9983643430412152}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993057270579845, 'loss_val': 0.018712027141910146, 'psi': 0.9979840383304794}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=53 head_norm_before_train=2.009963 cos_to_last_merge=0.9731 (last merge round=35)
[S10] round=53 local utility u=0.001069 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9937436091873376, 'loss_val': 0.037257362180068344, 'psi': 0.9936382374940917}-{'f1_val': 0.9933489306849028, 'auprc': 0.9937305387482391, 'loss_val': 0.03804216515066644, 'psi': 0.9935015739102374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=53 head_norm_before_train=2.288802 (no previous merge yet)
[S11] round=53 local utility u=0.001242 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963379858010438, 'loss_val': 0.018169024753390363, 'psi': 0.9966207041761648}-{'f1_val': 0.996567470639547, 'auprc': 0.9965408743982567, 'loss_val': 0.019810860773822575, 'psi': 0.9965568321430309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=53 head_norm_before_train=1.975021 (no previous merge yet)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6772671442157634, 'auprc': 0.7686891213625051, 'loss_val': 1.149537384593826, 'psi': 0.7138359350744601}-{'f1_val': 0.6565772785779382, 'auprc': 0.8307629219563823, 'loss_val': 0.9483868527718018, 'psi': 0.7262515359293159}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=2.170669 (no previous merge yet)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.997476613247938, 'auprc': 0.998623481003625, 'loss_val': 0.021251011758524656, 'psi': 0.9979353603502128}-{'f1_val': 0.9978910992781401, 'auprc': 0.9986769875466048, 'loss_val': 0.01835122713052189, 'psi': 0.9982054545855261}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=2.048133 cos_to_last_merge=0.9876 (last merge round=40)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.9042979213139479, 'auprc': 0.9970318832977639, 'loss_val': 0.22759799458648095, 'psi': 0.9413915061074744}-{'f1_val': 0.9738980544416027, 'auprc': 0.9976775546996862, 'loss_val': 0.05035870594941693, 'psi': 0.9834098545448361}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.845706 cos_to_last_merge=0.9683 (last merge round=41)
[S16] round=53 local utility u=0.013828 metrics={'f1_val': 0.961411953480662, 'auprc': 0.9859749548056447, 'loss_val': 0.1142098539239463, 'psi': 0.971237154010655}-{'f1_val': 0.9590670768023595, 'auprc': 0.9831090179815608, 'loss_val': 0.11919843572162615, 'psi': 0.96868385327404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=53 head_norm_before_train=2.243498 (no previous merge yet)
[S17] round=53 local utility u=1.000000 metrics={'f1_val': 0.911124982362971, 'auprc': 0.9983713197671453, 'loss_val': 0.25746927298187133, 'psi': 0.9460235173246407}-{'f1_val': 0.6367969568334879, 'auprc': 0.9938259919969231, 'loss_val': 1.174225594567204, 'psi': 0.779608570898862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=54 head_norm_before_train=2.104267 cos_to_last_merge=0.9929 (last merge round=35)
[S2] round=54 local utility u=0.200909 metrics={'f1_val': 0.6545328630389448, 'auprc': 0.7708723131203795, 'loss_val': 1.0144341499332414, 'psi': 0.7010686430715187}-{'f1_val': 0.6491494231397907, 'auprc': 0.7428649373220082, 'loss_val': 1.2999300432693721, 'psi': 0.6866356288126777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=54 head_norm_before_train=1.649221 cos_to_last_merge=0.9479 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=54 local utility u=0.045619 metrics={'f1_val': 0.994167868969008, 'auprc': 0.997523630648917, 'loss_val': 0.03850936049619157, 'psi': 0.9955101736409716}-{'f1_val': 0.9817027836098922, 'auprc': 0.9981152766589426, 'loss_val': 0.0567318819338282, 'psi': 0.9882677808295124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=54 head_norm_before_train=1.934646 cos_to_last_merge=0.9968 (last merge round=40)
[S4] round=54 local utility u=0.353323 metrics={'f1_val': 0.9527996984819705, 'auprc': 0.9423913742771165, 'loss_val': 0.3256055032066586, 'psi': 0.948636368800029}-{'f1_val': 0.8705405376747978, 'auprc': 0.917652276761743, 'loss_val': 0.46447949735807237, 'psi': 0.8893852333095758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=54 head_norm_before_train=1.900863 cos_to_last_merge=0.9992 (last merge round=39)
[S5] round=54 local utility u=0.245032 metrics={'f1_val': 0.7009427252141673, 'auprc': 0.9150415138118849, 'loss_val': 0.37258684227132205, 'psi': 0.7865822406532543}-{'f1_val': 0.67078822283629, 'auprc': 0.8538497748896058, 'loss_val': 0.4981479933221208, 'psi': 0.7440128436576163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=54 head_norm_before_train=1.741188 cos_to_last_merge=0.9629 (last merge round=40)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.8079300324984284, 'auprc': 0.922339342422202, 'loss_val': 0.5046497823355411, 'psi': 0.8536937564679379}-{'f1_val': 0.5455505512145638, 'auprc': 0.7621055835481292, 'loss_val': 1.3048629525675801, 'psi': 0.63217256414799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=54 head_norm_before_train=1.665362 cos_to_last_merge=0.9924 (last merge round=39)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5677839351701622, 'auprc': 0.779462634626648, 'loss_val': 0.9349728685981621, 'psi': 0.6524554149527566}-{'f1_val': 0.6316688771455644, 'auprc': 0.7964377673348164, 'loss_val': 0.597668890227803, 'psi': 0.6975764332212653}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.713513 cos_to_last_merge=0.9904 (last merge round=39)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.999124547635816, 'loss_val': 0.02934170842761238, 'psi': 0.9957381358957009}-{'f1_val': 0.9955298311535434, 'auprc': 0.9988080696983747, 'loss_val': 0.026364709328296935, 'psi': 0.9968411265714759}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.019046 cos_to_last_merge=0.9891 (last merge round=33)
[S9] round=54 local utility u=0.000283 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.999591417252316, 'loss_val': 0.01820867893814462, 'psi': 0.9983635009073126}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995935225870725, 'loss_val': 0.018781460527109984, 'psi': 0.9983643430412152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=54 head_norm_before_train=2.020001 cos_to_last_merge=0.9722 (last merge round=35)
[S10] round=54 local utility u=0.000204 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9936656344434898, 'loss_val': 0.03661518284292178, 'psi': 0.9936070475965526}-{'f1_val': 0.9935679896985945, 'auprc': 0.9937436091873376, 'loss_val': 0.037257362180068344, 'psi': 0.9936382374940917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=54 head_norm_before_train=2.291519 (no previous merge yet)
[S11] round=54 local utility u=0.000245 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963089705056181, 'loss_val': 0.017592415620426773, 'psi': 0.9966090980579945}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963379858010438, 'loss_val': 0.018169024753390363, 'psi': 0.9966207041761648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=54 head_norm_before_train=1.980661 (no previous merge yet)
[S13] round=54 local utility u=0.124796 metrics={'f1_val': 0.6650874119359673, 'auprc': 0.8145633265373653, 'loss_val': 0.9644893940550515, 'psi': 0.7248777777765265}-{'f1_val': 0.6772671442157634, 'auprc': 0.7686891213625051, 'loss_val': 1.149537384593826, 'psi': 0.7138359350744601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=54 head_norm_before_train=2.175364 (no previous merge yet)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9933038488375803, 'auprc': 0.9986242877002497, 'loss_val': 0.027586292502030468, 'psi': 0.995432024382648}-{'f1_val': 0.997476613247938, 'auprc': 0.998623481003625, 'loss_val': 0.021251011758524656, 'psi': 0.9979353603502128}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.057868 cos_to_last_merge=0.9869 (last merge round=40)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9040377249221725, 'auprc': 0.9975899782624932, 'loss_val': 0.2409337930299659, 'psi': 0.9414586262583007}-{'f1_val': 0.9042979213139479, 'auprc': 0.9970318832977639, 'loss_val': 0.22759799458648095, 'psi': 0.9413915061074744}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.858458 cos_to_last_merge=0.9672 (last merge round=41)
[S16] round=54 local utility u=0.034066 metrics={'f1_val': 0.9707424412419973, 'auprc': 0.9852393211651339, 'loss_val': 0.09985350449935862, 'psi': 0.9765411932112519}-{'f1_val': 0.961411953480662, 'auprc': 0.9859749548056447, 'loss_val': 0.1142098539239463, 'psi': 0.971237154010655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] sending update (kind=head size=1809 to 1 peers)
[S17] START round=54 head_norm_before_train=2.246627 (no previous merge yet)
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.8636768245157664, 'auprc': 0.9922336364970866, 'loss_val': 0.4189010406418232, 'psi': 0.9150995493082945}-{'f1_val': 0.911124982362971, 'auprc': 0.9983713197671453, 'loss_val': 0.25746927298187133, 'psi': 0.9460235173246407}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=2.109772 cos_to_last_merge=0.9927 (last merge round=35)
[S2] round=55 local utility u=0.099460 metrics={'f1_val': 0.6699146181215258, 'auprc': 0.7789512094708451, 'loss_val': 0.9320422024890735, 'psi': 0.7135292546612535}-{'f1_val': 0.6545328630389448, 'auprc': 0.7708723131203795, 'loss_val': 1.0144341499332414, 'psi': 0.7010686430715187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=55 head_norm_before_train=1.661348 cos_to_last_merge=0.9462 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=55 local utility u=0.004038 metrics={'f1_val': 0.9945859307742341, 'auprc': 0.9980881743540518, 'loss_val': 0.034635844569127744, 'psi': 0.9959868282061612}-{'f1_val': 0.994167868969008, 'auprc': 0.997523630648917, 'loss_val': 0.03850936049619157, 'psi': 0.9955101736409716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=55 head_norm_before_train=1.930917 cos_to_last_merge=0.9964 (last merge round=40)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9415230934216304, 'auprc': 0.9513946710980052, 'loss_val': 0.34362878912943756, 'psi': 0.9454717244921804}-{'f1_val': 0.9527996984819705, 'auprc': 0.9423913742771165, 'loss_val': 0.3256055032066586, 'psi': 0.948636368800029}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.903382 cos_to_last_merge=0.9992 (last merge round=39)
[S5] round=55 local utility u=0.824105 metrics={'f1_val': 0.8948544122069126, 'auprc': 0.9968246974178372, 'loss_val': 0.13319588592655737, 'psi': 0.9356425262912824}-{'f1_val': 0.7009427252141673, 'auprc': 0.9150415138118849, 'loss_val': 0.37258684227132205, 'psi': 0.7865822406532543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=55 head_norm_before_train=1.754417 cos_to_last_merge=0.9615 (last merge round=40)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7273105451358304, 'auprc': 0.7470061450063792, 'loss_val': 0.8300967966214523, 'psi': 0.73518878508405}-{'f1_val': 0.8079300324984284, 'auprc': 0.922339342422202, 'loss_val': 0.5046497823355411, 'psi': 0.8536937564679379}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.670888 cos_to_last_merge=0.9919 (last merge round=39)
[S7] round=55 local utility u=0.787414 metrics={'f1_val': 0.6873116670222186, 'auprc': 0.853377731544334, 'loss_val': 0.29905643602417087, 'psi': 0.7537380928310649}-{'f1_val': 0.5677839351701622, 'auprc': 0.779462634626648, 'loss_val': 0.9349728685981621, 'psi': 0.6524554149527566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=55 head_norm_before_train=1.726050 cos_to_last_merge=0.9897 (last merge round=39)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9764139482771571, 'auprc': 0.9988161705177955, 'loss_val': 0.052390393939776736, 'psi': 0.9853748371734125}-{'f1_val': 0.9934805280689575, 'auprc': 0.999124547635816, 'loss_val': 0.02934170842761238, 'psi': 0.9957381358957009}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.025599 cos_to_last_merge=0.9887 (last merge round=33)
[S9] round=55 local utility u=0.000081 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995887134057249, 'loss_val': 0.01803760753380567, 'psi': 0.9983624193686762}-{'f1_val': 0.9975448900106438, 'auprc': 0.999591417252316, 'loss_val': 0.01820867893814462, 'psi': 0.9983635009073126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=55 head_norm_before_train=2.030488 cos_to_last_merge=0.9713 (last merge round=35)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9931721713955317, 'loss_val': 0.03594869091616516, 'psi': 0.9934096623773694}-{'f1_val': 0.9935679896985945, 'auprc': 0.9936656344434898, 'loss_val': 0.03661518284292178, 'psi': 0.9936070475965526}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=2.294711 (no previous merge yet)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9960701775469563, 'loss_val': 0.018152949540262996, 'psi': 0.996265583337249}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963089705056181, 'loss_val': 0.017592415620426773, 'psi': 0.9966090980579945}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.994787 (no previous merge yet)
[S13] round=55 local utility u=0.301813 metrics={'f1_val': 0.7395217929299487, 'auprc': 0.8506903311087989, 'loss_val': 0.9158515004581567, 'psi': 0.7839892082014888}-{'f1_val': 0.6650874119359673, 'auprc': 0.8145633265373653, 'loss_val': 0.9644893940550515, 'psi': 0.7248777777765265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=55 head_norm_before_train=2.179363 (no previous merge yet)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9917991843863939, 'auprc': 0.9986238182195452, 'loss_val': 0.03156827564196699, 'psi': 0.9945290379196543}-{'f1_val': 0.9933038488375803, 'auprc': 0.9986242877002497, 'loss_val': 0.027586292502030468, 'psi': 0.995432024382648}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=2.067204 cos_to_last_merge=0.9863 (last merge round=40)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9020082669767713, 'auprc': 0.9970607473169308, 'loss_val': 0.2737902788656566, 'psi': 0.9400292591128352}-{'f1_val': 0.9040377249221725, 'auprc': 0.9975899782624932, 'loss_val': 0.2409337930299659, 'psi': 0.9414586262583007}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.869716 cos_to_last_merge=0.9663 (last merge round=41)
[S16] round=55 local utility u=0.013673 metrics={'f1_val': 0.9749906165676762, 'auprc': 0.9823915488885872, 'loss_val': 0.08945268897312418, 'psi': 0.9779509894960405}-{'f1_val': 0.9707424412419973, 'auprc': 0.9852393211651339, 'loss_val': 0.09985350449935862, 'psi': 0.9765411932112519}
[S16] not sending this round → trigger blocked (psi=0.978)
[S17] START round=55 head_norm_before_train=2.245854 (no previous merge yet)
[S17] round=55 local utility u=0.189358 metrics={'f1_val': 0.9103150153523645, 'auprc': 0.9967883629883971, 'loss_val': 0.33367876389699036, 'psi': 0.9449043544067776}-{'f1_val': 0.8636768245157664, 'auprc': 0.9922336364970866, 'loss_val': 0.4189010406418232, 'psi': 0.9150995493082945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=56 head_norm_before_train=2.117796 cos_to_last_merge=0.9924 (last merge round=35)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.6528151861452018, 'auprc': 0.7583902242198867, 'loss_val': 1.1893613084464076, 'psi': 0.6950452013750759}-{'f1_val': 0.6699146181215258, 'auprc': 0.7789512094708451, 'loss_val': 0.9320422024890735, 'psi': 0.7135292546612535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.672505 cos_to_last_merge=0.9446 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.945
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9936017785124474, 'auprc': 0.9981237910609889, 'loss_val': 0.03656822428758333, 'psi': 0.9954105835318641}-{'f1_val': 0.9945859307742341, 'auprc': 0.9980881743540518, 'loss_val': 0.034635844569127744, 'psi': 0.9959868282061612}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.934218 cos_to_last_merge=0.9961 (last merge round=40)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9224981551071753, 'auprc': 0.9356401543964817, 'loss_val': 0.4224573882039361, 'psi': 0.9277549548228978}-{'f1_val': 0.9415230934216304, 'auprc': 0.9513946710980052, 'loss_val': 0.34362878912943756, 'psi': 0.9454717244921804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.905709 cos_to_last_merge=0.9991 (last merge round=39)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.621138743181665, 'auprc': 0.8537582216465511, 'loss_val': 0.6166061448241993, 'psi': 0.7141865345676195}-{'f1_val': 0.8948544122069126, 'auprc': 0.9968246974178372, 'loss_val': 0.13319588592655737, 'psi': 0.9356425262912824}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.762262 cos_to_last_merge=0.9601 (last merge round=40)
[S6] round=56 local utility u=1.000000 metrics={'f1_val': 0.984595698811065, 'auprc': 0.9782148632962413, 'loss_val': 0.10474359550004772, 'psi': 0.9820433646051354}-{'f1_val': 0.7273105451358304, 'auprc': 0.7470061450063792, 'loss_val': 0.8300967966214523, 'psi': 0.73518878508405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=56 head_norm_before_train=1.677123 cos_to_last_merge=0.9913 (last merge round=39)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.6198485166993831, 'auprc': 0.7891383466605202, 'loss_val': 0.635804759053935, 'psi': 0.6875644486838379}-{'f1_val': 0.6873116670222186, 'auprc': 0.853377731544334, 'loss_val': 0.29905643602417087, 'psi': 0.7537380928310649}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.733641 cos_to_last_merge=0.9894 (last merge round=39)
[S8] round=56 local utility u=0.060818 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.999059499521181, 'loss_val': 0.030363808027533152, 'psi': 0.9953601232874416}-{'f1_val': 0.9764139482771571, 'auprc': 0.9988161705177955, 'loss_val': 0.052390393939776736, 'psi': 0.9853748371734125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=56 head_norm_before_train=2.031581 cos_to_last_merge=0.9882 (last merge round=33)
[S9] round=56 local utility u=0.000117 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995912701364532, 'loss_val': 0.017811826530411034, 'psi': 0.9983634420609675}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995887134057249, 'loss_val': 0.01803760753380567, 'psi': 0.9983624193686762}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=56 head_norm_before_train=2.039845 cos_to_last_merge=0.9704 (last merge round=35)
[S10] round=56 local utility u=0.000161 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9934713353803558, 'loss_val': 0.03652319863174343, 'psi': 0.993529327971299}-{'f1_val': 0.9935679896985945, 'auprc': 0.9931721713955317, 'loss_val': 0.03594869091616516, 'psi': 0.9934096623773694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=56 head_norm_before_train=2.298701 (no previous merge yet)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9956938703802036, 'auprc': 0.9948316225681764, 'loss_val': 0.02181443513797907, 'psi': 0.9953489712553927}-{'f1_val': 0.9963958538641108, 'auprc': 0.9960701775469563, 'loss_val': 0.018152949540262996, 'psi': 0.996265583337249}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=2.003735 (no previous merge yet)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6840130063902077, 'auprc': 0.7895182500303677, 'loss_val': 0.9710339741958249, 'psi': 0.7262151038462716}-{'f1_val': 0.7395217929299487, 'auprc': 0.8506903311087989, 'loss_val': 0.9158515004581567, 'psi': 0.7839892082014888}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=2.185240 (no previous merge yet)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9762624812766177, 'auprc': 0.998623286873954, 'loss_val': 0.03937347923654464, 'psi': 0.9852068035155523}-{'f1_val': 0.9917991843863939, 'auprc': 0.9986238182195452, 'loss_val': 0.03156827564196699, 'psi': 0.9945290379196543}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=2.075898 cos_to_last_merge=0.9857 (last merge round=40)
[S15] round=56 local utility u=0.412312 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998203167918032, 'loss_val': 0.02102479854968606, 'psi': 0.9973292681997251}-{'f1_val': 0.9020082669767713, 'auprc': 0.9970607473169308, 'loss_val': 0.2737902788656566, 'psi': 0.9400292591128352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=56 head_norm_before_train=1.880468 cos_to_last_merge=0.9655 (last merge round=41)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.942314484761103, 'auprc': 0.9825492366979824, 'loss_val': 0.1840982773290145, 'psi': 0.9584083855358547}-{'f1_val': 0.9749906165676762, 'auprc': 0.9823915488885872, 'loss_val': 0.08945268897312418, 'psi': 0.9779509894960405}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=2.252977 (no previous merge yet)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.8299554006498803, 'auprc': 0.9994727223069004, 'loss_val': 0.5399055700924648, 'psi': 0.8977623293126884}-{'f1_val': 0.9103150153523645, 'auprc': 0.9967883629883971, 'loss_val': 0.33367876389699036, 'psi': 0.9449043544067776}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=2.127059 cos_to_last_merge=0.9920 (last merge round=35)
[S2] round=57 local utility u=0.389903 metrics={'f1_val': 0.7167040671795256, 'auprc': 0.7766443710116613, 'loss_val': 0.847651764879072, 'psi': 0.74068018871238}-{'f1_val': 0.6528151861452018, 'auprc': 0.7583902242198867, 'loss_val': 1.1893613084464076, 'psi': 0.6950452013750759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=57 head_norm_before_train=1.683961 cos_to_last_merge=0.9430 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.943
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9472974626176389, 'auprc': 0.9977330068484653, 'loss_val': 0.15503387169415964, 'psi': 0.9674716803099694}-{'f1_val': 0.9936017785124474, 'auprc': 0.9981237910609889, 'loss_val': 0.03656822428758333, 'psi': 0.9954105835318641}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.934107 cos_to_last_merge=0.9955 (last merge round=40)
[S4] round=57 local utility u=0.157041 metrics={'f1_val': 0.9531086336467449, 'auprc': 0.9498307051410191, 'loss_val': 0.33461012332150697, 'psi': 0.9517974622444545}-{'f1_val': 0.9224981551071753, 'auprc': 0.9356401543964817, 'loss_val': 0.4224573882039361, 'psi': 0.9277549548228978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=57 head_norm_before_train=1.908914 cos_to_last_merge=0.9991 (last merge round=39)
[S5] round=57 local utility u=1.000000 metrics={'f1_val': 0.9849640747483558, 'auprc': 0.9981143933542558, 'loss_val': 0.1097065135036638, 'psi': 0.9902242021907157}-{'f1_val': 0.621138743181665, 'auprc': 0.8537582216465511, 'loss_val': 0.6166061448241993, 'psi': 0.7141865345676195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=57 head_norm_before_train=1.773507 cos_to_last_merge=0.9589 (last merge round=40)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.790874822922161, 'auprc': 0.7542004659355123, 'loss_val': 0.7127379249752495, 'psi': 0.7762050801275016}-{'f1_val': 0.984595698811065, 'auprc': 0.9782148632962413, 'loss_val': 0.10474359550004772, 'psi': 0.9820433646051354}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.682874 cos_to_last_merge=0.9908 (last merge round=39)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.5711814088456413, 'auprc': 0.779043835225162, 'loss_val': 0.8796282496660898, 'psi': 0.6543263793974496}-{'f1_val': 0.6198485166993831, 'auprc': 0.7891383466605202, 'loss_val': 0.635804759053935, 'psi': 0.6875644486838379}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.743023 cos_to_last_merge=0.9889 (last merge round=39)
[S8] round=57 local utility u=0.005882 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9993121694813631, 'loss_val': 0.027667718791618112, 'psi': 0.9962921721439633}-{'f1_val': 0.9928938724649488, 'auprc': 0.999059499521181, 'loss_val': 0.030363808027533152, 'psi': 0.9953601232874416}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=57 head_norm_before_train=2.038062 cos_to_last_merge=0.9878 (last merge round=33)
[S9] round=57 local utility u=0.000214 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995884412885883, 'loss_val': 0.0173760997236598, 'psi': 0.9983623105218216}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995912701364532, 'loss_val': 0.017811826530411034, 'psi': 0.9983634420609675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=57 head_norm_before_train=2.047691 cos_to_last_merge=0.9697 (last merge round=35)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9934255636704253, 'loss_val': 0.03677532882186742, 'psi': 0.9935110192873268}-{'f1_val': 0.9935679896985945, 'auprc': 0.9934713353803558, 'loss_val': 0.03652319863174343, 'psi': 0.993529327971299}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=2.303797 (no previous merge yet)
[S11] round=57 local utility u=0.004992 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9963183818165735, 'loss_val': 0.0190519947869391, 'psi': 0.9962198375730766}-{'f1_val': 0.9956938703802036, 'auprc': 0.9948316225681764, 'loss_val': 0.02181443513797907, 'psi': 0.9953489712553927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=57 head_norm_before_train=2.008321 (no previous merge yet)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6385518784535414, 'auprc': 0.75268533480766, 'loss_val': 1.0942312411323578, 'psi': 0.684205260995189}-{'f1_val': 0.6840130063902077, 'auprc': 0.7895182500303677, 'loss_val': 0.9710339741958249, 'psi': 0.7262151038462716}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=2.192367 (no previous merge yet)
[S14] round=57 local utility u=0.074630 metrics={'f1_val': 0.9976724637413676, 'auprc': 0.9984439515044876, 'loss_val': 0.018034598545836514, 'psi': 0.9979810588466156}-{'f1_val': 0.9762624812766177, 'auprc': 0.998623286873954, 'loss_val': 0.03937347923654464, 'psi': 0.9852068035155523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=57 head_norm_before_train=2.084564 cos_to_last_merge=0.9852 (last merge round=40)
[S15] round=57 local utility u=0.003883 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9987271926822318, 'loss_val': 0.017414122636256555, 'psi': 0.9977972802796646}-{'f1_val': 0.9967466683875206, 'auprc': 0.998203167918032, 'loss_val': 0.02102479854968606, 'psi': 0.9973292681997251}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=57 head_norm_before_train=1.890737 cos_to_last_merge=0.9646 (last merge round=41)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.93521989485735, 'auprc': 0.9829929000688309, 'loss_val': 0.35482705227006966, 'psi': 0.9543290969419423}-{'f1_val': 0.942314484761103, 'auprc': 0.9825492366979824, 'loss_val': 0.1840982773290145, 'psi': 0.9584083855358547}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=2.263036 (no previous merge yet)
[S17] round=57 local utility u=0.093115 metrics={'f1_val': 0.8556074653699259, 'auprc': 0.9994591850196549, 'loss_val': 0.50754762954317, 'psi': 0.9131481532298175}-{'f1_val': 0.8299554006498803, 'auprc': 0.9994727223069004, 'loss_val': 0.5399055700924648, 'psi': 0.8977623293126884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=58 head_norm_before_train=2.135942 cos_to_last_merge=0.9916 (last merge round=35)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.6629458749219103, 'auprc': 0.7451988084898301, 'loss_val': 1.2987977320523154, 'psi': 0.6958470483490782}-{'f1_val': 0.7167040671795256, 'auprc': 0.7766443710116613, 'loss_val': 0.847651764879072, 'psi': 0.74068018871238}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=1.694902 cos_to_last_merge=0.9415 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=58 local utility u=0.201940 metrics={'f1_val': 0.9944519596863347, 'auprc': 0.998065323724232, 'loss_val': 0.03507767950213612, 'psi': 0.9958973053014937}-{'f1_val': 0.9472974626176389, 'auprc': 0.9977330068484653, 'loss_val': 0.15503387169415964, 'psi': 0.9674716803099694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=58 head_norm_before_train=1.938698 cos_to_last_merge=0.9950 (last merge round=40)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9526789853211611, 'auprc': 0.9306789340626842, 'loss_val': 0.3293028384410919, 'psi': 0.9438789648177703}-{'f1_val': 0.9531086336467449, 'auprc': 0.9498307051410191, 'loss_val': 0.33461012332150697, 'psi': 0.9517974622444545}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.911260 cos_to_last_merge=0.9991 (last merge round=39)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.6624198047009269, 'auprc': 0.8538921689008029, 'loss_val': 0.5255632855519152, 'psi': 0.7390087503808773}-{'f1_val': 0.9849640747483558, 'auprc': 0.9981143933542558, 'loss_val': 0.1097065135036638, 'psi': 0.9902242021907157}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.785918 cos_to_last_merge=0.9574 (last merge round=40)
[S6] round=58 local utility u=0.617666 metrics={'f1_val': 0.8463738468195783, 'auprc': 0.9535019078960751, 'loss_val': 0.4083039900329495, 'psi': 0.889225071250177}-{'f1_val': 0.790874822922161, 'auprc': 0.7542004659355123, 'loss_val': 0.7127379249752495, 'psi': 0.7762050801275016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=58 head_norm_before_train=1.687998 cos_to_last_merge=0.9904 (last merge round=39)
[S7] round=58 local utility u=0.562538 metrics={'f1_val': 0.6632068599083029, 'auprc': 0.8130600842253513, 'loss_val': 0.4087546774722592, 'psi': 0.7231481496351222}-{'f1_val': 0.5711814088456413, 'auprc': 0.779043835225162, 'loss_val': 0.8796282496660898, 'psi': 0.6543263793974496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=58 head_norm_before_train=1.753776 cos_to_last_merge=0.9883 (last merge round=39)
[S8] round=58 local utility u=0.003521 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9997728564778716, 'loss_val': 0.026415660842468824, 'psi': 0.9969173325803495}-{'f1_val': 0.9942788405856967, 'auprc': 0.9993121694813631, 'loss_val': 0.027667718791618112, 'psi': 0.9962921721439633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=58 head_norm_before_train=2.043888 cos_to_last_merge=0.9874 (last merge round=33)
[S9] round=58 local utility u=0.000131 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995904601430751, 'loss_val': 0.017119602165551237, 'psi': 0.9983631180636163}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995884412885883, 'loss_val': 0.0173760997236598, 'psi': 0.9983623105218216}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=58 head_norm_before_train=2.056670 cos_to_last_merge=0.9689 (last merge round=35)
[S10] round=58 local utility u=0.000493 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9933762606712716, 'loss_val': 0.03564171098596855, 'psi': 0.9934912980876653}-{'f1_val': 0.9935679896985945, 'auprc': 0.9934255636704253, 'loss_val': 0.03677532882186742, 'psi': 0.9935110192873268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=58 head_norm_before_train=2.309914 (no previous merge yet)
[S11] round=58 local utility u=0.000717 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9963422492324081, 'loss_val': 0.02017048275260495, 'psi': 0.9964773820766915}-{'f1_val': 0.9961541414107454, 'auprc': 0.9963183818165735, 'loss_val': 0.0190519947869391, 'psi': 0.9962198375730766}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=58 head_norm_before_train=2.019151 (no previous merge yet)
[S13] round=58 local utility u=0.222335 metrics={'f1_val': 0.6637516825032805, 'auprc': 0.7909591085015616, 'loss_val': 0.9155823166939622, 'psi': 0.7146346529025929}-{'f1_val': 0.6385518784535414, 'auprc': 0.75268533480766, 'loss_val': 1.0942312411323578, 'psi': 0.684205260995189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=58 head_norm_before_train=2.197887 (no previous merge yet)
[S14] round=58 local utility u=0.003620 metrics={'f1_val': 0.9983073289132482, 'auprc': 0.998677330844725, 'loss_val': 0.01530357997417984, 'psi': 0.9984553296858389}-{'f1_val': 0.9976724637413676, 'auprc': 0.9984439515044876, 'loss_val': 0.018034598545836514, 'psi': 0.9979810588466156}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=58 head_norm_before_train=2.092779 cos_to_last_merge=0.9846 (last merge round=40)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.967784951676476, 'auprc': 0.9983161356879909, 'loss_val': 0.0610484793396732, 'psi': 0.979997425281082}-{'f1_val': 0.9971773386779533, 'auprc': 0.9987271926822318, 'loss_val': 0.017414122636256555, 'psi': 0.9977972802796646}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.899597 cos_to_last_merge=0.9637 (last merge round=41)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.8939932930931975, 'auprc': 0.9824944275079751, 'loss_val': 0.542869208485124, 'psi': 0.9293937468591085}-{'f1_val': 0.93521989485735, 'auprc': 0.9829929000688309, 'loss_val': 0.35482705227006966, 'psi': 0.9543290969419423}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=2.271963 (no previous merge yet)
[S17] round=58 local utility u=0.275899 metrics={'f1_val': 0.9111248149406215, 'auprc': 0.9964197949628708, 'loss_val': 0.27973614308771394, 'psi': 0.9452428069495212}-{'f1_val': 0.8556074653699259, 'auprc': 0.9994591850196549, 'loss_val': 0.50754762954317, 'psi': 0.9131481532298175}
[S17] not sending this round → trigger blocked (psi=0.945)
[S2] START round=59 head_norm_before_train=2.144079 cos_to_last_merge=0.9913 (last merge round=35)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6441082758926715, 'auprc': 0.7285253712524035, 'loss_val': 1.6407951052835992, 'psi': 0.6778751140365643}-{'f1_val': 0.6629458749219103, 'auprc': 0.7451988084898301, 'loss_val': 1.2987977320523154, 'psi': 0.6958470483490782}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.678 u=0.0000 p_local=0.0921 f1=0.644 auprc=0.729 bytes=43180
[S3] START round=59 head_norm_before_train=1.702852 cos_to_last_merge=0.9404 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.940
[S3] round=59 local utility u=0.011351 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9980512709121481, 'loss_val': 0.02831152903709491, 'psi': 0.9974894679135047}-{'f1_val': 0.9944519596863347, 'auprc': 0.998065323724232, 'loss_val': 0.03507767950213612, 'psi': 0.9958973053014937}
[S3] not sending this round → trigger blocked (psi=0.997)
[S3] r=60 psi=0.997 u=0.0114 p_local=0.0482 f1=0.997 auprc=0.998 bytes=44925
[S4] START round=59 head_norm_before_train=1.941750 cos_to_last_merge=0.9945 (last merge round=40)
[S4] round=59 local utility u=0.049372 metrics={'f1_val': 0.9534153985394229, 'auprc': 0.9575870770069065, 'loss_val': 0.31570088450587125, 'psi': 0.9550840699264163}-{'f1_val': 0.9526789853211611, 'auprc': 0.9306789340626842, 'loss_val': 0.3293028384410919, 'psi': 0.9438789648177703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=60 psi=0.955 u=0.0494 p_local=0.0844 f1=0.953 auprc=0.958 bytes=39639
[S5] START round=59 head_norm_before_train=1.912882 cos_to_last_merge=0.9991 (last merge round=39)
[S5] round=59 local utility u=1.000000 metrics={'f1_val': 0.892024261024346, 'auprc': 0.98479052056827, 'loss_val': 0.18361687035072116, 'psi': 0.9291307648419156}-{'f1_val': 0.6624198047009269, 'auprc': 0.8538921689008029, 'loss_val': 0.5255632855519152, 'psi': 0.7390087503808773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=60 psi=0.929 u=1.0000 p_local=0.4908 f1=0.892 auprc=0.985 bytes=52203
[S6] START round=59 head_norm_before_train=1.801291 cos_to_last_merge=0.9559 (last merge round=40)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.8451766018589284, 'auprc': 0.9287671192918713, 'loss_val': 0.5044411384966055, 'psi': 0.8786128088321055}-{'f1_val': 0.8463738468195783, 'auprc': 0.9535019078960751, 'loss_val': 0.4083039900329495, 'psi': 0.889225071250177}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.879 u=0.0000 p_local=0.3536 f1=0.845 auprc=0.929 bytes=45002
[S7] START round=59 head_norm_before_train=1.691766 cos_to_last_merge=0.9900 (last merge round=39)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.6304174294478497, 'auprc': 0.7915039654331677, 'loss_val': 0.5906455797521364, 'psi': 0.694852043841977}-{'f1_val': 0.6632068599083029, 'auprc': 0.8130600842253513, 'loss_val': 0.4087546774722592, 'psi': 0.7231481496351222}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=60 psi=0.695 u=0.0000 p_local=0.2110 f1=0.630 auprc=0.792 bytes=43196
[S8] START round=59 head_norm_before_train=1.764069 cos_to_last_merge=0.9878 (last merge round=39)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9995937150808525, 'loss_val': 0.025060049475081985, 'psi': 0.9967130713247176}-{'f1_val': 0.9950136499820015, 'auprc': 0.9997728564778716, 'loss_val': 0.026415660842468824, 'psi': 0.9969173325803495}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.997 u=0.0000 p_local=0.0111 f1=0.995 auprc=1.000 bytes=46708
[S9] START round=59 head_norm_before_train=2.050296 cos_to_last_merge=0.9870 (last merge round=33)
[S9] round=59 local utility u=0.000738 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9999699047616859, 'loss_val': 0.016782698817714527, 'psi': 0.9985148959110606}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995904601430751, 'loss_val': 0.017119602165551237, 'psi': 0.9983631180636163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] r=60 psi=0.999 u=0.0007 p_local=0.0012 f1=0.998 auprc=1.000 bytes=50426
[S10] START round=59 head_norm_before_train=2.063228 cos_to_last_merge=0.9683 (last merge round=35)
[S10] round=59 local utility u=0.000922 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940258927183893, 'loss_val': 0.03574561784233026, 'psi': 0.9937511509065123}-{'f1_val': 0.9935679896985945, 'auprc': 0.9933762606712716, 'loss_val': 0.03564171098596855, 'psi': 0.9934912980876653}
[S10] not sending this round → trigger blocked (psi=0.994)
[S10] r=60 psi=0.994 u=0.0009 p_local=0.0005 f1=0.994 auprc=0.994 bytes=53976
[S11] START round=59 head_norm_before_train=2.316749 (no previous merge yet)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9966582352691382, 'auprc': 0.9948793292239525, 'loss_val': 0.017982575033332115, 'psi': 0.995946672851064}-{'f1_val': 0.996567470639547, 'auprc': 0.9963422492324081, 'loss_val': 0.02017048275260495, 'psi': 0.9964773820766915}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.996 u=0.0000 p_local=0.0029 f1=0.997 auprc=0.995 bytes=46714
[S13] START round=59 head_norm_before_train=2.030485 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6158860740098826, 'auprc': 0.6902147196352507, 'loss_val': 1.4006642835048475, 'psi': 0.6456175322600299}-{'f1_val': 0.6637516825032805, 'auprc': 0.7909591085015616, 'loss_val': 0.9155823166939622, 'psi': 0.7146346529025929}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.646 u=0.0000 p_local=0.0958 f1=0.616 auprc=0.690 bytes=41381
[S14] START round=59 head_norm_before_train=2.202928 (no previous merge yet)
[S14] round=59 local utility u=0.000055 metrics={'f1_val': 0.9983073289132482, 'auprc': 0.9986767102463996, 'loss_val': 0.015191683002106516, 'psi': 0.9984550814465087}-{'f1_val': 0.9983073289132482, 'auprc': 0.998677330844725, 'loss_val': 0.01530357997417984, 'psi': 0.9984553296858389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S14] r=60 psi=0.998 u=0.0001 p_local=0.0160 f1=0.998 auprc=0.999 bytes=43070
[S15] START round=59 head_norm_before_train=2.100700 cos_to_last_merge=0.9841 (last merge round=40)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9046266000522465, 'auprc': 0.9974805296168694, 'loss_val': 0.22579326890552606, 'psi': 0.9417681718780957}-{'f1_val': 0.967784951676476, 'auprc': 0.9983161356879909, 'loss_val': 0.0610484793396732, 'psi': 0.979997425281082}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.942 u=0.0000 p_local=0.0650 f1=0.905 auprc=0.997 bytes=43195
[S16] START round=59 head_norm_before_train=1.908935 cos_to_last_merge=0.9628 (last merge round=41)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8713195929703135, 'auprc': 0.9811095789643449, 'loss_val': 0.7435144247394946, 'psi': 0.9152355873679261}-{'f1_val': 0.8939932930931975, 'auprc': 0.9824944275079751, 'loss_val': 0.542869208485124, 'psi': 0.9293937468591085}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.915 u=0.0000 p_local=0.0216 f1=0.871 auprc=0.981 bytes=43217
[S17] START round=59 head_norm_before_train=2.276779 (no previous merge yet)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.9082738391940932, 'auprc': 0.9891851141926125, 'loss_val': 0.3024861712989439, 'psi': 0.9406383491935009}-{'f1_val': 0.9111248149406215, 'auprc': 0.9964197949628708, 'loss_val': 0.27973614308771394, 'psi': 0.9452428069495212}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.941 u=0.0000 p_local=0.1800 f1=0.908 auprc=0.989 bytes=48449
[S2] START round=60 head_norm_before_train=2.151768 cos_to_last_merge=0.9908 (last merge round=35)
[S2] round=60 local utility u=0.619537 metrics={'f1_val': 0.7106659237488921, 'auprc': 0.767844065648166, 'loss_val': 0.9190239569059877, 'psi': 0.7335371805086017}-{'f1_val': 0.6441082758926715, 'auprc': 0.7285253712524035, 'loss_val': 1.6407951052835992, 'psi': 0.6778751140365643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=60 head_norm_before_train=1.710753 cos_to_last_merge=0.9393 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.996700455243286, 'auprc': 0.9980463496078222, 'loss_val': 0.028541602666875655, 'psi': 0.9972388129891006}-{'f1_val': 0.9971149325810758, 'auprc': 0.9980512709121481, 'loss_val': 0.02831152903709491, 'psi': 0.9974894679135047}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.948797 cos_to_last_merge=0.9943 (last merge round=40)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9402392576057113, 'auprc': 0.9352557728777358, 'loss_val': 0.3384475858481503, 'psi': 0.938245863714521}-{'f1_val': 0.9534153985394229, 'auprc': 0.9575870770069065, 'loss_val': 0.31570088450587125, 'psi': 0.9550840699264163}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.912639 cos_to_last_merge=0.9991 (last merge round=39)
[S5] round=60 local utility u=0.183092 metrics={'f1_val': 0.9549962568841516, 'auprc': 0.9835719729217096, 'loss_val': 0.19161009803536616, 'psi': 0.9664265432991748}-{'f1_val': 0.892024261024346, 'auprc': 0.98479052056827, 'loss_val': 0.18361687035072116, 'psi': 0.9291307648419156}
[S5] not sending this round → trigger blocked (psi=0.966)
[S6] START round=60 head_norm_before_train=1.819779 cos_to_last_merge=0.9542 (last merge round=40)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.7458530386245906, 'auprc': 0.8289190114333741, 'loss_val': 0.7705475767155543, 'psi': 0.779079427748104}-{'f1_val': 0.8451766018589284, 'auprc': 0.9287671192918713, 'loss_val': 0.5044411384966055, 'psi': 0.8786128088321055}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.696512 cos_to_last_merge=0.9895 (last merge round=39)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.6189263071600553, 'auprc': 0.7892940823443069, 'loss_val': 0.6138847560319488, 'psi': 0.6870734172337559}-{'f1_val': 0.6304174294478497, 'auprc': 0.7915039654331677, 'loss_val': 0.5906455797521364, 'psi': 0.694852043841977}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=1.775147 cos_to_last_merge=0.9873 (last merge round=39)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9991941102823624, 'loss_val': 0.027572828383328283, 'psi': 0.9960250089799529}-{'f1_val': 0.994792642153961, 'auprc': 0.9995937150808525, 'loss_val': 0.025060049475081985, 'psi': 0.9967130713247176}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.057249 cos_to_last_merge=0.9865 (last merge round=33)
[S9] round=60 local utility u=0.000106 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9999714468081982, 'loss_val': 0.01657613347556182, 'psi': 0.9985155127296655}-{'f1_val': 0.9975448900106438, 'auprc': 0.9999699047616859, 'loss_val': 0.016782698817714527, 'psi': 0.9985148959110606}
[S9] not sending this round → trigger blocked (psi=0.999)
[S10] START round=60 head_norm_before_train=2.071483 cos_to_last_merge=0.9675 (last merge round=35)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9936538653879169, 'loss_val': 0.036415307858953756, 'psi': 0.9936023399743235}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940258927183893, 'loss_val': 0.03574561784233026, 'psi': 0.9937511509065123}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=2.317091 (no previous merge yet)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9948837501246224, 'loss_val': 0.01869302715476128, 'psi': 0.9957910123683155}-{'f1_val': 0.9966582352691382, 'auprc': 0.9948793292239525, 'loss_val': 0.017982575033332115, 'psi': 0.995946672851064}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=2.041341 (no previous merge yet)
[S13] round=60 local utility u=0.783824 metrics={'f1_val': 0.7278629983540543, 'auprc': 0.8260739359121465, 'loss_val': 0.9124560796579934, 'psi': 0.7671473733772912}-{'f1_val': 0.6158860740098826, 'auprc': 0.6902147196352507, 'loss_val': 1.4006642835048475, 'psi': 0.6456175322600299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] sending update (kind=head size=1793 to 1 peers)
[S14] START round=60 head_norm_before_train=2.210043 (no previous merge yet)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9986765441045419, 'loss_val': 0.014732152902337778, 'psi': 0.998309382383349}-{'f1_val': 0.9983073289132482, 'auprc': 0.9986767102463996, 'loss_val': 0.015191683002106516, 'psi': 0.9984550814465087}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.108836 cos_to_last_merge=0.9835 (last merge round=40)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8700187672736126, 'auprc': 0.9223750265606924, 'loss_val': 0.4083770412897348, 'psi': 0.8909612709884445}-{'f1_val': 0.9046266000522465, 'auprc': 0.9974805296168694, 'loss_val': 0.22579326890552606, 'psi': 0.9417681718780957}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.916209 cos_to_last_merge=0.9621 (last merge round=41)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8609798708105797, 'auprc': 0.8926658931916841, 'loss_val': 0.8603694654889883, 'psi': 0.8736542797630215}-{'f1_val': 0.8713195929703135, 'auprc': 0.9811095789643449, 'loss_val': 0.7435144247394946, 'psi': 0.9152355873679261}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=2.282263 (no previous merge yet)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.9057162081150247, 'auprc': 0.997419971081481, 'loss_val': 0.36327952980849965, 'psi': 0.9423977133016073}-{'f1_val': 0.9082738391940932, 'auprc': 0.9891851141926125, 'loss_val': 0.3024861712989439, 'psi': 0.9406383491935009}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=2.160130 cos_to_last_merge=0.9904 (last merge round=35)
[S2] round=61 local utility u=0.007315 metrics={'f1_val': 0.721554098697651, 'auprc': 0.7512484192774916, 'loss_val': 0.9199365835479285, 'psi': 0.7334318269295872}-{'f1_val': 0.7106659237488921, 'auprc': 0.767844065648166, 'loss_val': 0.9190239569059877, 'psi': 0.7335371805086017}
[S2] not sending this round → trigger blocked (psi=0.733)
[S3] START round=61 head_norm_before_train=1.719813 cos_to_last_merge=0.9380 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9806881499266307, 'auprc': 0.998109749284845, 'loss_val': 0.07616422234475746, 'psi': 0.9876567896699164}-{'f1_val': 0.996700455243286, 'auprc': 0.9980463496078222, 'loss_val': 0.028541602666875655, 'psi': 0.9972388129891006}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.960454 cos_to_last_merge=0.9942 (last merge round=40)
[S4] round=61 local utility u=0.003446 metrics={'f1_val': 0.9410841260052651, 'auprc': 0.9352529717620082, 'loss_val': 0.3366168867764768, 'psi': 0.9387516643079623}-{'f1_val': 0.9402392576057113, 'auprc': 0.9352557728777358, 'loss_val': 0.3384475858481503, 'psi': 0.938245863714521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=61 head_norm_before_train=1.913293 cos_to_last_merge=0.9990 (last merge round=39)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.7357212913971596, 'auprc': 0.9885256609009406, 'loss_val': 0.23704626821514044, 'psi': 0.8368430391986721}-{'f1_val': 0.9549962568841516, 'auprc': 0.9835719729217096, 'loss_val': 0.19161009803536616, 'psi': 0.9664265432991748}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.836182 cos_to_last_merge=0.9525 (last merge round=40)
[S6] round=61 local utility u=0.044124 metrics={'f1_val': 0.745174572970726, 'auprc': 0.8249029552492835, 'loss_val': 0.6661812337315045, 'psi': 0.7770659258821491}-{'f1_val': 0.7458530386245906, 'auprc': 0.8289190114333741, 'loss_val': 0.7705475767155543, 'psi': 0.779079427748104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=61 head_norm_before_train=1.700542 cos_to_last_merge=0.9891 (last merge round=39)
[S7] round=61 local utility u=0.406810 metrics={'f1_val': 0.6842370148944192, 'auprc': 0.8363683395721198, 'loss_val': 0.3333523156491289, 'psi': 0.7450895447654995}-{'f1_val': 0.6189263071600553, 'auprc': 0.7892940823443069, 'loss_val': 0.6138847560319488, 'psi': 0.6870734172337559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=61 head_norm_before_train=1.785749 cos_to_last_merge=0.9866 (last merge round=39)
[S8] round=61 local utility u=0.001677 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9993932310534723, 'loss_val': 0.025689190921793472, 'psi': 0.9961919150930263}-{'f1_val': 0.9939122747783468, 'auprc': 0.9991941102823624, 'loss_val': 0.027572828383328283, 'psi': 0.9960250089799529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=61 head_norm_before_train=2.063869 cos_to_last_merge=0.9860 (last merge round=33)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9954400132154921, 'auprc': 0.9995829364592498, 'loss_val': 0.0199848310537146, 'psi': 0.9970971825129952}-{'f1_val': 0.9975448900106438, 'auprc': 0.9999714468081982, 'loss_val': 0.01657613347556182, 'psi': 0.9985155127296655}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.080200 cos_to_last_merge=0.9668 (last merge round=35)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9931506758460698, 'loss_val': 0.03525585371921921, 'psi': 0.9934010641575846}-{'f1_val': 0.9935679896985945, 'auprc': 0.9936538653879169, 'loss_val': 0.036415307858953756, 'psi': 0.9936023399743235}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=2.320153 (no previous merge yet)
[S11] round=61 local utility u=0.000094 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9955827750379517, 'loss_val': 0.019151454538021667, 'psi': 0.9959255948616279}-{'f1_val': 0.9963958538641108, 'auprc': 0.9948837501246224, 'loss_val': 0.01869302715476128, 'psi': 0.9957910123683155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=61 head_norm_before_train=2.051291 (no previous merge yet)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6236690441400587, 'auprc': 0.9814394906080508, 'loss_val': 1.232851356106888, 'psi': 0.7667772227272556}-{'f1_val': 0.7278629983540543, 'auprc': 0.8260739359121465, 'loss_val': 0.9124560796579934, 'psi': 0.7671473733772912}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=2.218551 (no previous merge yet)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9973269879856502, 'auprc': 0.9987799825672088, 'loss_val': 0.018777339791273755, 'psi': 0.9979081858182737}-{'f1_val': 0.9980646079025537, 'auprc': 0.9986765441045419, 'loss_val': 0.014732152902337778, 'psi': 0.998309382383349}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=2.116473 cos_to_last_merge=0.9830 (last merge round=40)
[S15] round=61 local utility u=0.357383 metrics={'f1_val': 0.9138147466105381, 'auprc': 0.997988252838137, 'loss_val': 0.1832266667827711, 'psi': 0.9474841491015776}-{'f1_val': 0.8700187672736126, 'auprc': 0.9223750265606924, 'loss_val': 0.4083770412897348, 'psi': 0.8909612709884445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=61 head_norm_before_train=1.923609 cos_to_last_merge=0.9614 (last merge round=41)
[S16] round=61 local utility u=0.696344 metrics={'f1_val': 0.9418967727628859, 'auprc': 0.984841858955217, 'loss_val': 0.2297100866156202, 'psi': 0.9590748072398183}-{'f1_val': 0.8609798708105797, 'auprc': 0.8926658931916841, 'loss_val': 0.8603694654889883, 'psi': 0.8736542797630215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=61 head_norm_before_train=2.284793 (no previous merge yet)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.9041605595377107, 'auprc': 0.9977167496338498, 'loss_val': 0.3561560559670595, 'psi': 0.9415830355761663}-{'f1_val': 0.9057162081150247, 'auprc': 0.997419971081481, 'loss_val': 0.36327952980849965, 'psi': 0.9423977133016073}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.166418 cos_to_last_merge=0.9901 (last merge round=35)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.6848875585799927, 'auprc': 0.7391833194441623, 'loss_val': 1.0318459458101374, 'psi': 0.7066058629256605}-{'f1_val': 0.721554098697651, 'auprc': 0.7512484192774916, 'loss_val': 0.9199365835479285, 'psi': 0.7334318269295872}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.729097 cos_to_last_merge=0.9367 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9597287040135783, 'auprc': 0.9977067038341191, 'loss_val': 0.14177629570118036, 'psi': 0.9749199039417946}-{'f1_val': 0.9806881499266307, 'auprc': 0.998109749284845, 'loss_val': 0.07616422234475746, 'psi': 0.9876567896699164}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.960856 cos_to_last_merge=0.9934 (last merge round=40)
[S4] round=62 local utility u=0.014630 metrics={'f1_val': 0.9415039268997979, 'auprc': 0.9445475385818827, 'loss_val': 0.3377595320171555, 'psi': 0.9427213715726318}-{'f1_val': 0.9410841260052651, 'auprc': 0.9352529717620082, 'loss_val': 0.3366168867764768, 'psi': 0.9387516643079623}
[S4] not sending this round → trigger blocked (psi=0.943)
[S5] START round=62 head_norm_before_train=1.919182 cos_to_last_merge=0.9987 (last merge round=39)
[S5] round=62 local utility u=0.199276 metrics={'f1_val': 0.7939301626671406, 'auprc': 0.9921386973227926, 'loss_val': 0.19858633145090743, 'psi': 0.8732135765294013}-{'f1_val': 0.7357212913971596, 'auprc': 0.9885256609009406, 'loss_val': 0.23704626821514044, 'psi': 0.8368430391986721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=62 head_norm_before_train=1.852006 cos_to_last_merge=0.9510 (last merge round=40)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.7130685997836131, 'auprc': 0.7996426789602505, 'loss_val': 0.980236576601567, 'psi': 0.7476982314542682}-{'f1_val': 0.745174572970726, 'auprc': 0.8249029552492835, 'loss_val': 0.6661812337315045, 'psi': 0.7770659258821491}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.705900 cos_to_last_merge=0.9886 (last merge round=39)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.6513227226715183, 'auprc': 0.7967043378720243, 'loss_val': 0.5244026491377543, 'psi': 0.7094753687517207}-{'f1_val': 0.6842370148944192, 'auprc': 0.8363683395721198, 'loss_val': 0.3333523156491289, 'psi': 0.7450895447654995}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=1.798105 cos_to_last_merge=0.9860 (last merge round=39)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.978166507611403, 'auprc': 0.9989697981502608, 'loss_val': 0.05230380807425765, 'psi': 0.9864878238269461}-{'f1_val': 0.994057704452729, 'auprc': 0.9993932310534723, 'loss_val': 0.025689190921793472, 'psi': 0.9961919150930263}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.068082 cos_to_last_merge=0.9858 (last merge round=33)
[S9] round=62 local utility u=0.007846 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.999592511661619, 'loss_val': 0.016951257019865294, 'psi': 0.9983639386710339}-{'f1_val': 0.9954400132154921, 'auprc': 0.9995829364592498, 'loss_val': 0.0199848310537146, 'psi': 0.9970971825129952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=62 head_norm_before_train=2.088027 cos_to_last_merge=0.9660 (last merge round=35)
[S10] round=62 local utility u=0.001069 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939902702466652, 'loss_val': 0.03563577631479792, 'psi': 0.9937369019178227}-{'f1_val': 0.9935679896985945, 'auprc': 0.9931506758460698, 'loss_val': 0.03525585371921921, 'psi': 0.9934010641575846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=62 head_norm_before_train=2.325294 (no previous merge yet)
[S11] round=62 local utility u=0.000687 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9949137626028401, 'loss_val': 0.01734624822199564, 'psi': 0.9958154934455405}-{'f1_val': 0.9961541414107454, 'auprc': 0.9955827750379517, 'loss_val': 0.019151454538021667, 'psi': 0.9959255948616279}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=62 head_norm_before_train=2.055370 (no previous merge yet)
[S13] round=62 local utility u=0.156230 metrics={'f1_val': 0.7340658859849305, 'auprc': 0.8298276908728224, 'loss_val': 1.1279362024555126, 'psi': 0.7723706079400873}-{'f1_val': 0.6236690441400587, 'auprc': 0.9814394906080508, 'loss_val': 1.232851356106888, 'psi': 0.7667772227272556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=62 head_norm_before_train=2.221111 (no previous merge yet)
[S14] round=62 local utility u=0.000222 metrics={'f1_val': 0.9978910992781401, 'auprc': 0.9969376670645547, 'loss_val': 0.01619116210071849, 'psi': 0.997509726392706}-{'f1_val': 0.9973269879856502, 'auprc': 0.9987799825672088, 'loss_val': 0.018777339791273755, 'psi': 0.9979081858182737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=62 head_norm_before_train=2.123756 cos_to_last_merge=0.9825 (last merge round=40)
[S15] round=62 local utility u=0.328488 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979851145645015, 'loss_val': 0.023831943123530475, 'psi': 0.997242046858313}-{'f1_val': 0.9138147466105381, 'auprc': 0.997988252838137, 'loss_val': 0.1832266667827711, 'psi': 0.9474841491015776}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=62 head_norm_before_train=1.930356 cos_to_last_merge=0.9610 (last merge round=41)
[S16] round=62 local utility u=0.246180 metrics={'f1_val': 0.9918738959243687, 'auprc': 0.9868771180822735, 'loss_val': 0.04331849655277694, 'psi': 0.9898751847875307}-{'f1_val': 0.9418967727628859, 'auprc': 0.984841858955217, 'loss_val': 0.2297100866156202, 'psi': 0.9590748072398183}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=62 head_norm_before_train=2.292317 (no previous merge yet)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.8837682367962152, 'auprc': 0.9931297498538028, 'loss_val': 0.45066729667790295, 'psi': 0.9275128420192502}-{'f1_val': 0.9041605595377107, 'auprc': 0.9977167496338498, 'loss_val': 0.3561560559670595, 'psi': 0.9415830355761663}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.166946 cos_to_last_merge=0.9898 (last merge round=35)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.6840393357664868, 'auprc': 0.7360533261495812, 'loss_val': 1.0380041543440655, 'psi': 0.7048449319197245}-{'f1_val': 0.6848875585799927, 'auprc': 0.7391833194441623, 'loss_val': 1.0318459458101374, 'psi': 0.7066058629256605}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=1.737074 cos_to_last_merge=0.9356 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=63 local utility u=0.045660 metrics={'f1_val': 0.9658029912444237, 'auprc': 0.9975860778882012, 'loss_val': 0.08653987343930779, 'psi': 0.9785162259019347}-{'f1_val': 0.9597287040135783, 'auprc': 0.9977067038341191, 'loss_val': 0.14177629570118036, 'psi': 0.9749199039417946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=63 head_norm_before_train=1.960501 cos_to_last_merge=0.9929 (last merge round=40)
[S4] round=63 local utility u=0.015517 metrics={'f1_val': 0.9428415438699727, 'auprc': 0.950795271258102, 'loss_val': 0.333493764191143, 'psi': 0.9460230348252243}-{'f1_val': 0.9415039268997979, 'auprc': 0.9445475385818827, 'loss_val': 0.3377595320171555, 'psi': 0.9427213715726318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=63 head_norm_before_train=1.927590 cos_to_last_merge=0.9984 (last merge round=39)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.6850991669177079, 'auprc': 0.9547530418619063, 'loss_val': 0.3816908852725986, 'psi': 0.7929607168953873}-{'f1_val': 0.7939301626671406, 'auprc': 0.9921386973227926, 'loss_val': 0.19858633145090743, 'psi': 0.8732135765294013}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.870100 cos_to_last_merge=0.9493 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=63 local utility u=0.520237 metrics={'f1_val': 0.7960037988507312, 'auprc': 0.8993839319951367, 'loss_val': 0.7365982274646657, 'psi': 0.8373558521084934}-{'f1_val': 0.7130685997836131, 'auprc': 0.7996426789602505, 'loss_val': 0.980236576601567, 'psi': 0.7476982314542682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=63 head_norm_before_train=1.710949 cos_to_last_merge=0.9882 (last merge round=39)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6209791009975587, 'auprc': 0.7936791783504413, 'loss_val': 0.5939163297837617, 'psi': 0.6900591319387117}-{'f1_val': 0.6513227226715183, 'auprc': 0.7967043378720243, 'loss_val': 0.5244026491377543, 'psi': 0.7094753687517207}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.808797 cos_to_last_merge=0.9854 (last merge round=39)
[S8] round=63 local utility u=0.063391 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9993497904204989, 'loss_val': 0.025537570677763043, 'psi': 0.9965274951258255}-{'f1_val': 0.978166507611403, 'auprc': 0.9989697981502608, 'loss_val': 0.05230380807425765, 'psi': 0.9864878238269461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=63 head_norm_before_train=2.072145 cos_to_last_merge=0.9856 (last merge round=33)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9995824912490808, 'loss_val': 0.01698864877716188, 'psi': 0.9981136756582673}-{'f1_val': 0.9975448900106438, 'auprc': 0.999592511661619, 'loss_val': 0.016951257019865294, 'psi': 0.9983639386710339}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.094265 cos_to_last_merge=0.9654 (last merge round=35)
[S10] round=63 local utility u=0.000620 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9944344687022658, 'loss_val': 0.03572934189865272, 'psi': 0.9939145813000629}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939902702466652, 'loss_val': 0.03563577631479792, 'psi': 0.9937369019178227}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=63 head_norm_before_train=2.331114 (no previous merge yet)
[S11] round=63 local utility u=0.001254 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.995732520446037, 'loss_val': 0.017169507785863077, 'psi': 0.9961305204968813}-{'f1_val': 0.9964166473406741, 'auprc': 0.9949137626028401, 'loss_val': 0.01734624822199564, 'psi': 0.9958154934455405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=63 head_norm_before_train=2.054235 (no previous merge yet)
[S13] round=63 local utility u=0.036614 metrics={'f1_val': 0.7102247786019831, 'auprc': 0.817955577543084, 'loss_val': 0.8760443770367673, 'psi': 0.7533170981784234}-{'f1_val': 0.7340658859849305, 'auprc': 0.8298276908728224, 'loss_val': 1.1279362024555126, 'psi': 0.7723706079400873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=63 head_norm_before_train=2.222080 (no previous merge yet)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9309444101570085, 'auprc': 0.9986231519596729, 'loss_val': 0.15868902526029943, 'psi': 0.9580159068780743}-{'f1_val': 0.9978910992781401, 'auprc': 0.9969376670645547, 'loss_val': 0.01619116210071849, 'psi': 0.997509726392706}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.131142 cos_to_last_merge=0.9820 (last merge round=40)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.9807871175095977, 'auprc': 0.9983213372381319, 'loss_val': 0.034610929081365475, 'psi': 0.9878008054010113}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979851145645015, 'loss_val': 0.023831943123530475, 'psi': 0.997242046858313}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.938715 cos_to_last_merge=0.9603 (last merge round=41)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.8337079362467456, 'auprc': 0.8448874325371291, 'loss_val': 1.2067667421236346, 'psi': 0.838179734762899}-{'f1_val': 0.9918738959243687, 'auprc': 0.9868771180822735, 'loss_val': 0.04331849655277694, 'psi': 0.9898751847875307}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=2.300658 (no previous merge yet)
[S17] round=63 local utility u=0.025959 metrics={'f1_val': 0.8859645045202302, 'auprc': 0.9899471465933697, 'loss_val': 0.4023784676493809, 'psi': 0.927557561349486}-{'f1_val': 0.8837682367962152, 'auprc': 0.9931297498538028, 'loss_val': 0.45066729667790295, 'psi': 0.9275128420192502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=64 head_norm_before_train=2.171643 cos_to_last_merge=0.9895 (last merge round=35)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6772216342547035, 'auprc': 0.7301668348233014, 'loss_val': 1.3678812613135407, 'psi': 0.6983997144821426}-{'f1_val': 0.6840393357664868, 'auprc': 0.7360533261495812, 'loss_val': 1.0380041543440655, 'psi': 0.7048449319197245}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=1.742250 cos_to_last_merge=0.9348 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=64 local utility u=0.124907 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9980818088838518, 'loss_val': 0.02608538106344328, 'psi': 0.9975016831021861}-{'f1_val': 0.9658029912444237, 'auprc': 0.9975860778882012, 'loss_val': 0.08653987343930779, 'psi': 0.9785162259019347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=64 head_norm_before_train=1.957710 cos_to_last_merge=0.9915 (last merge round=40)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9453000062496292, 'auprc': 0.9394922005723658, 'loss_val': 0.3323469206256775, 'psi': 0.9429768839787238}-{'f1_val': 0.9428415438699727, 'auprc': 0.950795271258102, 'loss_val': 0.333493764191143, 'psi': 0.9460230348252243}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.933260 cos_to_last_merge=0.9981 (last merge round=39)
[S5] round=64 local utility u=0.050854 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9807786216707846, 'loss_val': 0.45111508063911493, 'psi': 0.8126764842659184}-{'f1_val': 0.6850991669177079, 'auprc': 0.9547530418619063, 'loss_val': 0.3816908852725986, 'psi': 0.7929607168953873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=64 head_norm_before_train=1.882773 cos_to_last_merge=0.9478 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=64 local utility u=0.243238 metrics={'f1_val': 0.788116557928853, 'auprc': 0.93578745908494, 'loss_val': 0.312008594239701, 'psi': 0.8471849183912878}-{'f1_val': 0.7960037988507312, 'auprc': 0.8993839319951367, 'loss_val': 0.7365982274646657, 'psi': 0.8373558521084934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=64 head_norm_before_train=1.716873 cos_to_last_merge=0.9878 (last merge round=39)
[S7] round=64 local utility u=1.000000 metrics={'f1_val': 0.8990272819552321, 'auprc': 0.9441975604910579, 'loss_val': 0.2573561879175961, 'psi': 0.9170953933695624}-{'f1_val': 0.6209791009975587, 'auprc': 0.7936791783504413, 'loss_val': 0.5939163297837617, 'psi': 0.6900591319387117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=64 head_norm_before_train=1.815303 cos_to_last_merge=0.9850 (last merge round=39)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9791869675759299, 'auprc': 0.9988222096873067, 'loss_val': 0.04333588278490579, 'psi': 0.9870410644204807}-{'f1_val': 0.9946459649293765, 'auprc': 0.9993497904204989, 'loss_val': 0.025537570677763043, 'psi': 0.9965274951258255}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.077150 cos_to_last_merge=0.9853 (last merge round=33)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9604836003781977, 'auprc': 0.9958378859049757, 'loss_val': 0.09801494695079886, 'psi': 0.9746253145889089}-{'f1_val': 0.9971344652643916, 'auprc': 0.9995824912490808, 'loss_val': 0.01698864877716188, 'psi': 0.9981136756582673}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.101863 cos_to_last_merge=0.9648 (last merge round=35)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939485285343495, 'loss_val': 0.035210449545554384, 'psi': 0.9937202052328964}-{'f1_val': 0.9935679896985945, 'auprc': 0.9944344687022658, 'loss_val': 0.03572934189865272, 'psi': 0.9939145813000629}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=2.338033 (no previous merge yet)
[S11] round=64 local utility u=0.001533 metrics={'f1_val': 0.9966582352691382, 'auprc': 0.9961093075808647, 'loss_val': 0.016808501147651818, 'psi': 0.9964386641938288}-{'f1_val': 0.9963958538641108, 'auprc': 0.995732520446037, 'loss_val': 0.017169507785863077, 'psi': 0.9961305204968813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=64 head_norm_before_train=2.056209 (no previous merge yet)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7127280126848803, 'auprc': 0.8325324725177262, 'loss_val': 1.1768077458906427, 'psi': 0.7606497966180187}-{'f1_val': 0.7102247786019831, 'auprc': 0.817955577543084, 'loss_val': 0.8760443770367673, 'psi': 0.7533170981784234}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.221455 (no previous merge yet)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9309294494128463, 'auprc': 0.9986175963433708, 'loss_val': 0.16657580041785272, 'psi': 0.958004708185056}-{'f1_val': 0.9309444101570085, 'auprc': 0.9986231519596729, 'loss_val': 0.15868902526029943, 'psi': 0.9580159068780743}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=2.138420 cos_to_last_merge=0.9815 (last merge round=40)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9581097437343942, 'auprc': 0.9978486525876041, 'loss_val': 0.09587875926276401, 'psi': 0.9740053072756782}-{'f1_val': 0.9807871175095977, 'auprc': 0.9983213372381319, 'loss_val': 0.034610929081365475, 'psi': 0.9878008054010113}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.947396 cos_to_last_merge=0.9596 (last merge round=41)
[S16] round=64 local utility u=0.822911 metrics={'f1_val': 0.9295923107427978, 'auprc': 0.9309416484425262, 'loss_val': 0.39441322145052893, 'psi': 0.9301320458226892}-{'f1_val': 0.8337079362467456, 'auprc': 0.8448874325371291, 'loss_val': 1.2067667421236346, 'psi': 0.838179734762899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=64 head_norm_before_train=2.305592 (no previous merge yet)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.826321568588247, 'auprc': 0.9883352274851698, 'loss_val': 0.6479819018169268, 'psi': 0.8911270321470162}-{'f1_val': 0.8859645045202302, 'auprc': 0.9899471465933697, 'loss_val': 0.4023784676493809, 'psi': 0.927557561349486}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.180017 cos_to_last_merge=0.9892 (last merge round=35)
[S2] round=65 local utility u=0.265031 metrics={'f1_val': 0.708699715891921, 'auprc': 0.7369037771904676, 'loss_val': 1.0468987138882133, 'psi': 0.7199813404113398}-{'f1_val': 0.6772216342547035, 'auprc': 0.7301668348233014, 'loss_val': 1.3678812613135407, 'psi': 0.6983997144821426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=65 head_norm_before_train=1.749025 cos_to_last_merge=0.9338 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.934
[S3] round=65 local utility u=0.001525 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9982356452966259, 'loss_val': 0.02502577114626747, 'psi': 0.9977160767137027}-{'f1_val': 0.9971149325810758, 'auprc': 0.9980818088838518, 'loss_val': 0.02608538106344328, 'psi': 0.9975016831021861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=65 head_norm_before_train=1.961598 cos_to_last_merge=0.9905 (last merge round=40)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9416834924362529, 'auprc': 0.9301716758272999, 'loss_val': 0.36313777968767075, 'psi': 0.9370787657926717}-{'f1_val': 0.9453000062496292, 'auprc': 0.9394922005723658, 'loss_val': 0.3323469206256775, 'psi': 0.9429768839787238}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.938326 cos_to_last_merge=0.9980 (last merge round=39)
[S5] round=65 local utility u=0.695412 metrics={'f1_val': 0.8923532060165187, 'auprc': 0.9991959706836064, 'loss_val': 0.2660129394958774, 'psi': 0.9350903118833538}-{'f1_val': 0.7006083926626743, 'auprc': 0.9807786216707846, 'loss_val': 0.45111508063911493, 'psi': 0.8126764842659184}
[S5] not sending this round → trigger blocked (psi=0.935)
[S6] START round=65 head_norm_before_train=1.891781 cos_to_last_merge=0.9469 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.947
[S6] round=65 local utility u=0.013414 metrics={'f1_val': 0.842065007644129, 'auprc': 0.9402921847900306, 'loss_val': 0.6223845065810867, 'psi': 0.8813558785024895}-{'f1_val': 0.788116557928853, 'auprc': 0.93578745908494, 'loss_val': 0.312008594239701, 'psi': 0.8471849183912878}
[S6] not sending this round → trigger blocked (psi=0.881)
[S7] START round=65 head_norm_before_train=1.723822 cos_to_last_merge=0.9873 (last merge round=39)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.506787033391991, 'auprc': 0.7784902461270727, 'loss_val': 1.0150843942376913, 'psi': 0.6154683184860237}-{'f1_val': 0.8990272819552321, 'auprc': 0.9441975604910579, 'loss_val': 0.2573561879175961, 'psi': 0.9170953933695624}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.822200 cos_to_last_merge=0.9847 (last merge round=39)
[S8] round=65 local utility u=0.054951 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9989382601409589, 'loss_val': 0.02653596288725832, 'psi': 0.9963628830140094}-{'f1_val': 0.9791869675759299, 'auprc': 0.9988222096873067, 'loss_val': 0.04333588278490579, 'psi': 0.9870410644204807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=65 head_norm_before_train=2.081789 cos_to_last_merge=0.9850 (last merge round=33)
[S9] round=65 local utility u=0.155516 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9991613863525202, 'loss_val': 0.01685794704107649, 'psi': 0.997945233699643}-{'f1_val': 0.9604836003781977, 'auprc': 0.9958378859049757, 'loss_val': 0.09801494695079886, 'psi': 0.9746253145889089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=65 head_norm_before_train=2.108314 cos_to_last_merge=0.9642 (last merge round=35)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.994053944539478, 'loss_val': 0.03599214551999362, 'psi': 0.9937623716349478}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939485285343495, 'loss_val': 0.035210449545554384, 'psi': 0.9937202052328964}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.344558 (no previous merge yet)
[S11] round=65 local utility u=0.000493 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963939731869458, 'loss_val': 0.01758207597209967, 'psi': 0.9966430991305256}-{'f1_val': 0.9966582352691382, 'auprc': 0.9961093075808647, 'loss_val': 0.016808501147651818, 'psi': 0.9964386641938288}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=65 head_norm_before_train=2.062759 (no previous merge yet)
[S13] round=65 local utility u=0.265098 metrics={'f1_val': 0.736725588932269, 'auprc': 0.8838059187544067, 'loss_val': 0.9444182817078798, 'psi': 0.7955577208611241}-{'f1_val': 0.7127280126848803, 'auprc': 0.8325324725177262, 'loss_val': 1.1768077458906427, 'psi': 0.7606497966180187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=65 head_norm_before_train=2.224695 (no previous merge yet)
[S14] round=65 local utility u=0.131847 metrics={'f1_val': 0.9563892114357913, 'auprc': 0.9985918712400743, 'loss_val': 0.05556355457405188, 'psi': 0.9732702753575044}-{'f1_val': 0.9309294494128463, 'auprc': 0.9986175963433708, 'loss_val': 0.16657580041785272, 'psi': 0.958004708185056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=65 head_norm_before_train=2.145441 cos_to_last_merge=0.9810 (last merge round=40)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9119191353019463, 'auprc': 0.9976355654561375, 'loss_val': 0.202039911708681, 'psi': 0.9462057073636227}-{'f1_val': 0.9581097437343942, 'auprc': 0.9978486525876041, 'loss_val': 0.09587875926276401, 'psi': 0.9740053072756782}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.954418 cos_to_last_merge=0.9592 (last merge round=41)
[S16] round=65 local utility u=0.429719 metrics={'f1_val': 0.9902845926562035, 'auprc': 0.9824657910051195, 'loss_val': 0.0537017425995001, 'psi': 0.98715707199577}-{'f1_val': 0.9295923107427978, 'auprc': 0.9309416484425262, 'loss_val': 0.39441322145052893, 'psi': 0.9301320458226892}
[S16] not sending this round → trigger blocked (psi=0.987)
[S17] START round=65 head_norm_before_train=2.309639 (no previous merge yet)
[S17] round=65 local utility u=0.378050 metrics={'f1_val': 0.8960045228180988, 'auprc': 0.9989662167546627, 'loss_val': 0.34187313768416167, 'psi': 0.9371892003927245}-{'f1_val': 0.826321568588247, 'auprc': 0.9883352274851698, 'loss_val': 0.6479819018169268, 'psi': 0.8911270321470162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=66 head_norm_before_train=2.186064 cos_to_last_merge=0.9888 (last merge round=35)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.6831440650227965, 'auprc': 0.7383364475797001, 'loss_val': 1.0451279071825177, 'psi': 0.7052210180455579}-{'f1_val': 0.708699715891921, 'auprc': 0.7369037771904676, 'loss_val': 1.0468987138882133, 'psi': 0.7199813404113398}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=1.755763 cos_to_last_merge=0.9328 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.9592609060422019, 'auprc': 0.9981034393857371, 'loss_val': 0.1410388962859666, 'psi': 0.974797919379616}-{'f1_val': 0.9973696976584205, 'auprc': 0.9982356452966259, 'loss_val': 0.02502577114626747, 'psi': 0.9977160767137027}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=1.971023 cos_to_last_merge=0.9901 (last merge round=40)
[S4] round=66 local utility u=0.055123 metrics={'f1_val': 0.9501888057060626, 'auprc': 0.9408029733872338, 'loss_val': 0.33581769179056525, 'psi': 0.9464344727785311}-{'f1_val': 0.9416834924362529, 'auprc': 0.9301716758272999, 'loss_val': 0.36313777968767075, 'psi': 0.9370787657926717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=66 head_norm_before_train=1.940144 cos_to_last_merge=0.9978 (last merge round=39)
[S5] round=66 local utility u=0.410269 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.9980785456351886, 'loss_val': 0.06837069822311466, 'psi': 0.9972682409176281}-{'f1_val': 0.8923532060165187, 'auprc': 0.9991959706836064, 'loss_val': 0.2660129394958774, 'psi': 0.9350903118833538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=66 head_norm_before_train=1.899687 cos_to_last_merge=0.9460 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=66 local utility u=0.042984 metrics={'f1_val': 0.8208739639129906, 'auprc': 0.9353524755247833, 'loss_val': 0.3944514621811475, 'psi': 0.8666653685577077}-{'f1_val': 0.842065007644129, 'auprc': 0.9402921847900306, 'loss_val': 0.6223845065810867, 'psi': 0.8813558785024895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=66 head_norm_before_train=1.728721 cos_to_last_merge=0.9867 (last merge round=39)
[S7] round=66 local utility u=0.196016 metrics={'f1_val': 0.5480060617120223, 'auprc': 0.7817038194117343, 'loss_val': 0.880006850309548, 'psi': 0.6414851647919071}-{'f1_val': 0.506787033391991, 'auprc': 0.7784902461270727, 'loss_val': 1.0150843942376913, 'psi': 0.6154683184860237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=66 head_norm_before_train=1.829199 cos_to_last_merge=0.9843 (last merge round=39)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9989798713858591, 'loss_val': 0.02651014597270993, 'psi': 0.9959393134213517}-{'f1_val': 0.9946459649293765, 'auprc': 0.9989382601409589, 'loss_val': 0.02653596288725832, 'psi': 0.9963628830140094}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.085598 cos_to_last_merge=0.9847 (last merge round=33)
[S9] round=66 local utility u=0.002699 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9998535887770242, 'loss_val': 0.015998302121483243, 'psi': 0.998468369517196}-{'f1_val': 0.9971344652643916, 'auprc': 0.9991613863525202, 'loss_val': 0.01685794704107649, 'psi': 0.997945233699643}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=66 head_norm_before_train=2.113834 cos_to_last_merge=0.9636 (last merge round=35)
[S10] round=66 local utility u=0.000235 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939973239081236, 'loss_val': 0.035351621395791184, 'psi': 0.9937397233824061}-{'f1_val': 0.9935679896985945, 'auprc': 0.994053944539478, 'loss_val': 0.03599214551999362, 'psi': 0.9937623716349478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=66 head_norm_before_train=2.350557 (no previous merge yet)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.996168635434777, 'loss_val': 0.018817117662692343, 'psi': 0.996159939020358}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963939731869458, 'loss_val': 0.01758207597209967, 'psi': 0.9966430991305256}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=2.072532 (no previous merge yet)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6486204824278425, 'auprc': 0.7744064158846315, 'loss_val': 1.1402773032351377, 'psi': 0.6989348558105581}-{'f1_val': 0.736725588932269, 'auprc': 0.8838059187544067, 'loss_val': 0.9444182817078798, 'psi': 0.7955577208611241}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.228153 (no previous merge yet)
[S14] round=66 local utility u=0.130789 metrics={'f1_val': 0.9955944032944112, 'auprc': 0.9969312066048168, 'loss_val': 0.024234725689832735, 'psi': 0.9961291246185735}-{'f1_val': 0.9563892114357913, 'auprc': 0.9985918712400743, 'loss_val': 0.05556355457405188, 'psi': 0.9732702753575044}
[S14] not sending this round → trigger blocked (psi=0.996)
[S15] START round=66 head_norm_before_train=2.152269 cos_to_last_merge=0.9806 (last merge round=40)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9034867020634832, 'auprc': 0.997569954953602, 'loss_val': 0.2684132433612442, 'psi': 0.9411200032195308}-{'f1_val': 0.9119191353019463, 'auprc': 0.9976355654561375, 'loss_val': 0.202039911708681, 'psi': 0.9462057073636227}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.962642 cos_to_last_merge=0.9586 (last merge round=41)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.9283417493291903, 'auprc': 0.8985930253245039, 'loss_val': 0.4141629664328845, 'psi': 0.9164422597273157}-{'f1_val': 0.9902845926562035, 'auprc': 0.9824657910051195, 'loss_val': 0.0537017425995001, 'psi': 0.98715707199577}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=2.311351 (no previous merge yet)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8787330220470296, 'auprc': 0.9872839244100688, 'loss_val': 0.45314906920193987, 'psi': 0.9221533829922454}-{'f1_val': 0.8960045228180988, 'auprc': 0.9989662167546627, 'loss_val': 0.34187313768416167, 'psi': 0.9371892003927245}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.190578 cos_to_last_merge=0.9885 (last merge round=35)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.668708576760327, 'auprc': 0.7228665380281986, 'loss_val': 1.5843518340021574, 'psi': 0.6903717612674756}-{'f1_val': 0.6831440650227965, 'auprc': 0.7383364475797001, 'loss_val': 1.0451279071825177, 'psi': 0.7052210180455579}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=1.762132 cos_to_last_merge=0.9319 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=67 local utility u=0.158692 metrics={'f1_val': 0.9935759716794261, 'auprc': 0.9986921565171816, 'loss_val': 0.03131211699820443, 'psi': 0.9956224456145283}-{'f1_val': 0.9592609060422019, 'auprc': 0.9981034393857371, 'loss_val': 0.1410388962859666, 'psi': 0.974797919379616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=67 head_norm_before_train=1.981090 cos_to_last_merge=0.9895 (last merge round=40)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9500062735413439, 'auprc': 0.9269360860906184, 'loss_val': 0.3351917262389147, 'psi': 0.9407781985610537}-{'f1_val': 0.9501888057060626, 'auprc': 0.9408029733872338, 'loss_val': 0.33581769179056525, 'psi': 0.9464344727785311}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.939020 cos_to_last_merge=0.9978 (last merge round=39)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.6398776395114245, 'auprc': 0.8139749692487579, 'loss_val': 0.7972309577827872, 'psi': 0.7095165714063578}-{'f1_val': 0.9967280377725878, 'auprc': 0.9980785456351886, 'loss_val': 0.06837069822311466, 'psi': 0.9972682409176281}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.904484 cos_to_last_merge=0.9455 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.8459618715697963, 'auprc': 0.9309540077048175, 'loss_val': 0.5921724123715691, 'psi': 0.8799587260238048}-{'f1_val': 0.8208739639129906, 'auprc': 0.9353524755247833, 'loss_val': 0.3944514621811475, 'psi': 0.8666653685577077}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.733302 cos_to_last_merge=0.9860 (last merge round=39)
[S7] round=67 local utility u=0.564434 metrics={'f1_val': 0.6512094328893209, 'auprc': 0.812626607484202, 'loss_val': 0.4631274258276715, 'psi': 0.7157763027272733}-{'f1_val': 0.5480060617120223, 'auprc': 0.7817038194117343, 'loss_val': 0.880006850309548, 'psi': 0.6414851647919071}
[S7] not sending this round → trigger blocked (psi=0.716)
[S8] START round=67 head_norm_before_train=1.838670 cos_to_last_merge=0.9838 (last merge round=39)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9233153455603019, 'auprc': 0.998583110755926, 'loss_val': 0.16382103852386945, 'psi': 0.9534224516385517}-{'f1_val': 0.9939122747783468, 'auprc': 0.9989798713858591, 'loss_val': 0.02651014597270993, 'psi': 0.9959393134213517}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.090316 cos_to_last_merge=0.9844 (last merge round=33)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9994671313558631, 'loss_val': 0.044883968677615245, 'psi': 0.9920928044778067}-{'f1_val': 0.9975448900106438, 'auprc': 0.9998535887770242, 'loss_val': 0.015998302121483243, 'psi': 0.998468369517196}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.118076 cos_to_last_merge=0.9631 (last merge round=35)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940349582707465, 'loss_val': 0.035600371896949916, 'psi': 0.9937547771274553}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939973239081236, 'loss_val': 0.035351621395791184, 'psi': 0.9937397233824061}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=67 head_norm_before_train=2.352660 (no previous merge yet)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9960602022417346, 'loss_val': 0.01971788281898748, 'psi': 0.9961165657431411}-{'f1_val': 0.9961541414107454, 'auprc': 0.996168635434777, 'loss_val': 0.018817117662692343, 'psi': 0.996159939020358}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=2.081797 (no previous merge yet)
[S13] round=67 local utility u=0.261454 metrics={'f1_val': 0.7402302065802917, 'auprc': 0.7978916351911971, 'loss_val': 1.237483671250425, 'psi': 0.763294778024654}-{'f1_val': 0.6486204824278425, 'auprc': 0.7744064158846315, 'loss_val': 1.1402773032351377, 'psi': 0.6989348558105581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=67 head_norm_before_train=2.233691 (no previous merge yet)
[S14] round=67 local utility u=0.014899 metrics={'f1_val': 0.9984763653932122, 'auprc': 0.9986191695525687, 'loss_val': 0.01679323027627588, 'psi': 0.9985334870569548}-{'f1_val': 0.9955944032944112, 'auprc': 0.9969312066048168, 'loss_val': 0.024234725689832735, 'psi': 0.9961291246185735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=67 head_norm_before_train=2.158920 cos_to_last_merge=0.9801 (last merge round=40)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9951747831564944, 'loss_val': 0.302375169995594, 'psi': 0.9398188591547018}-{'f1_val': 0.9034867020634832, 'auprc': 0.997569954953602, 'loss_val': 0.2684132433612442, 'psi': 0.9411200032195308}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.967244 cos_to_last_merge=0.9581 (last merge round=41)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.8506374466930152, 'auprc': 0.827064901351711, 'loss_val': 1.0588576646302357, 'psi': 0.8412084285564936}-{'f1_val': 0.9283417493291903, 'auprc': 0.8985930253245039, 'loss_val': 0.4141629664328845, 'psi': 0.9164422597273157}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.317200 (no previous merge yet)
[S17] round=67 local utility u=0.103736 metrics={'f1_val': 0.8942759369745258, 'auprc': 0.9826238062110515, 'loss_val': 0.324953577423988, 'psi': 0.929615084669136}-{'f1_val': 0.8787330220470296, 'auprc': 0.9872839244100688, 'loss_val': 0.45314906920193987, 'psi': 0.9221533829922454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=68 head_norm_before_train=2.197472 cos_to_last_merge=0.9882 (last merge round=35)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.664424852272351, 'auprc': 0.720026117012796, 'loss_val': 1.6463528627127577, 'psi': 0.686665358168529}-{'f1_val': 0.668708576760327, 'auprc': 0.7228665380281986, 'loss_val': 1.5843518340021574, 'psi': 0.6903717612674756}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=1.769154 cos_to_last_merge=0.9309 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9902448231078568, 'auprc': 0.9981352415749517, 'loss_val': 0.03296680806132135, 'psi': 0.9934009904946948}-{'f1_val': 0.9935759716794261, 'auprc': 0.9986921565171816, 'loss_val': 0.03131211699820443, 'psi': 0.9956224456145283}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.994658 cos_to_last_merge=0.9889 (last merge round=40)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9420442224380221, 'auprc': 0.9299987100955491, 'loss_val': 0.35185574716336426, 'psi': 0.937226017501033}-{'f1_val': 0.9500062735413439, 'auprc': 0.9269360860906184, 'loss_val': 0.3351917262389147, 'psi': 0.9407781985610537}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.936926 cos_to_last_merge=0.9979 (last merge round=39)
[S5] round=68 local utility u=1.000000 metrics={'f1_val': 0.9509199138352589, 'auprc': 0.9981426169720293, 'loss_val': 0.11358983252928447, 'psi': 0.9698089950899671}-{'f1_val': 0.6398776395114245, 'auprc': 0.8139749692487579, 'loss_val': 0.7972309577827872, 'psi': 0.7095165714063578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=68 head_norm_before_train=1.914995 cos_to_last_merge=0.9445 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6415475423579712, 'auprc': 0.8976089488418494, 'loss_val': 1.1055971839560337, 'psi': 0.7439721049515224}-{'f1_val': 0.8459618715697963, 'auprc': 0.9309540077048175, 'loss_val': 0.5921724123715691, 'psi': 0.8799587260238048}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.738546 cos_to_last_merge=0.9855 (last merge round=39)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.6344766736123039, 'auprc': 0.8007350619392568, 'loss_val': 0.5454345807015558, 'psi': 0.700980028943085}-{'f1_val': 0.6512094328893209, 'auprc': 0.812626607484202, 'loss_val': 0.4631274258276715, 'psi': 0.7157763027272733}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.846537 cos_to_last_merge=0.9834 (last merge round=39)
[S8] round=68 local utility u=0.280091 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9992818098683156, 'loss_val': 0.029316730972690584, 'psi': 0.9960600888143343}-{'f1_val': 0.9233153455603019, 'auprc': 0.998583110755926, 'loss_val': 0.16382103852386945, 'psi': 0.9534224516385517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=68 head_norm_before_train=2.093944 cos_to_last_merge=0.9842 (last merge round=33)
[S9] round=68 local utility u=0.046134 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9999329531037588, 'loss_val': 0.01622409755811544, 'psi': 0.9985001152478898}-{'f1_val': 0.9871765865591023, 'auprc': 0.9994671313558631, 'loss_val': 0.044883968677615245, 'psi': 0.9920928044778067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=68 head_norm_before_train=2.124673 cos_to_last_merge=0.9625 (last merge round=35)
[S10] round=68 local utility u=0.000170 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940518432569732, 'loss_val': 0.035310188814862975, 'psi': 0.9937615311219459}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940349582707465, 'loss_val': 0.035600371896949916, 'psi': 0.9937547771274553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=68 head_norm_before_train=2.356985 (no previous merge yet)
[S11] round=68 local utility u=0.000011 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9949391734793631, 'loss_val': 0.01790800557552386, 'psi': 0.9958256577961497}-{'f1_val': 0.9961541414107454, 'auprc': 0.9960602022417346, 'loss_val': 0.01971788281898748, 'psi': 0.9961165657431411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=68 head_norm_before_train=2.088347 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6335688357571327, 'auprc': 0.770485015208391, 'loss_val': 1.2186642506209395, 'psi': 0.688335307537636}-{'f1_val': 0.7402302065802917, 'auprc': 0.7978916351911971, 'loss_val': 1.237483671250425, 'psi': 0.763294778024654}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.240898 (no previous merge yet)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9979710100677842, 'auprc': 0.9985886452801467, 'loss_val': 0.02043758520804147, 'psi': 0.9982180641527292}-{'f1_val': 0.9984763653932122, 'auprc': 0.9986191695525687, 'loss_val': 0.01679323027627588, 'psi': 0.9985334870569548}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=2.165342 cos_to_last_merge=0.9796 (last merge round=40)
[S15] round=68 local utility u=0.009864 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.997463666886364, 'loss_val': 0.28951354826932935, 'psi': 0.9407344126466496}-{'f1_val': 0.9029149098201734, 'auprc': 0.9951747831564944, 'loss_val': 0.302375169995594, 'psi': 0.9398188591547018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=68 head_norm_before_train=1.973681 cos_to_last_merge=0.9575 (last merge round=41)
[S16] round=68 local utility u=0.078038 metrics={'f1_val': 0.8496617668852595, 'auprc': 0.8797455934950381, 'loss_val': 1.054969404663504, 'psi': 0.861695297529171}-{'f1_val': 0.8506374466930152, 'auprc': 0.827064901351711, 'loss_val': 1.0588576646302357, 'psi': 0.8412084285564936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=68 head_norm_before_train=2.325232 (no previous merge yet)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.8624066983288071, 'auprc': 0.9906195730837276, 'loss_val': 0.5614978753406326, 'psi': 0.9136918482307752}-{'f1_val': 0.8942759369745258, 'auprc': 0.9826238062110515, 'loss_val': 0.324953577423988, 'psi': 0.929615084669136}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.200680 cos_to_last_merge=0.9878 (last merge round=35)
[S2] round=69 local utility u=0.205776 metrics={'f1_val': 0.6611012565417416, 'auprc': 0.7381410325878641, 'loss_val': 1.2692049052562149, 'psi': 0.6919171669601906}-{'f1_val': 0.664424852272351, 'auprc': 0.720026117012796, 'loss_val': 1.6463528627127577, 'psi': 0.686665358168529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=69 head_norm_before_train=1.776423 cos_to_last_merge=0.9300 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9976458614881846, 'loss_val': 0.12000522058033299, 'psi': 0.975781151627021}-{'f1_val': 0.9902448231078568, 'auprc': 0.9981352415749517, 'loss_val': 0.03296680806132135, 'psi': 0.9934009904946948}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=2.000659 cos_to_last_merge=0.9881 (last merge round=40)
[S4] round=69 local utility u=0.029439 metrics={'f1_val': 0.9483569789744093, 'auprc': 0.9305506883377098, 'loss_val': 0.33251053782443274, 'psi': 0.9412344627197295}-{'f1_val': 0.9420442224380221, 'auprc': 0.9299987100955491, 'loss_val': 0.35185574716336426, 'psi': 0.937226017501033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=69 head_norm_before_train=1.934203 cos_to_last_merge=0.9979 (last merge round=39)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.8425149132943606, 'auprc': 0.9947721128813894, 'loss_val': 0.1470064801813883, 'psi': 0.903417793129172}-{'f1_val': 0.9509199138352589, 'auprc': 0.9981426169720293, 'loss_val': 0.11358983252928447, 'psi': 0.9698089950899671}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.925937 cos_to_last_merge=0.9435 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=69 local utility u=1.000000 metrics={'f1_val': 0.9270012185666271, 'auprc': 0.9140143386930379, 'loss_val': 0.2708556374164026, 'psi': 0.9218064666171915}-{'f1_val': 0.6415475423579712, 'auprc': 0.8976089488418494, 'loss_val': 1.1055971839560337, 'psi': 0.7439721049515224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=69 head_norm_before_train=1.743466 cos_to_last_merge=0.9851 (last merge round=39)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5396704957739051, 'auprc': 0.7799572888132502, 'loss_val': 0.9237069250857103, 'psi': 0.6357852129896432}-{'f1_val': 0.6344766736123039, 'auprc': 0.8007350619392568, 'loss_val': 0.5454345807015558, 'psi': 0.700980028943085}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.854809 cos_to_last_merge=0.9829 (last merge round=39)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9933329447925694, 'auprc': 0.9992737877633324, 'loss_val': 0.031869021453561144, 'psi': 0.9957092819808746}-{'f1_val': 0.9939122747783468, 'auprc': 0.9992818098683156, 'loss_val': 0.029316730972690584, 'psi': 0.9960600888143343}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=2.097205 cos_to_last_merge=0.9839 (last merge round=33)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9998386752903969, 'loss_val': 0.016029768732706087, 'psi': 0.9982161492747937}-{'f1_val': 0.9975448900106438, 'auprc': 0.9999329531037588, 'loss_val': 0.01622409755811544, 'psi': 0.9985001152478898}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.129503 cos_to_last_merge=0.9620 (last merge round=35)
[S10] round=69 local utility u=0.000125 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940141979491408, 'loss_val': 0.03494697981537817, 'psi': 0.993746472998813}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940518432569732, 'loss_val': 0.035310188814862975, 'psi': 0.9937615311219459}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=69 head_norm_before_train=2.359497 (no previous merge yet)
[S11] round=69 local utility u=0.000045 metrics={'f1_val': 0.9966582352691382, 'auprc': 0.9959057732808014, 'loss_val': 0.022168240400573552, 'psi': 0.9963572504738034}-{'f1_val': 0.9964166473406741, 'auprc': 0.9949391734793631, 'loss_val': 0.01790800557552386, 'psi': 0.9958256577961497}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=69 head_norm_before_train=2.097570 (no previous merge yet)
[S13] round=69 local utility u=0.411230 metrics={'f1_val': 0.7171335774604342, 'auprc': 0.8083813873254295, 'loss_val': 1.0112815389315402, 'psi': 0.7536327014064323}-{'f1_val': 0.6335688357571327, 'auprc': 0.770485015208391, 'loss_val': 1.2186642506209395, 'psi': 0.688335307537636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=69 head_norm_before_train=2.246723 (no previous merge yet)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9976724637413676, 'auprc': 0.9985841457028232, 'loss_val': 0.026164367798804752, 'psi': 0.9980371365259498}-{'f1_val': 0.9979710100677842, 'auprc': 0.9985886452801467, 'loss_val': 0.02043758520804147, 'psi': 0.9982180641527292}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=2.171592 cos_to_last_merge=0.9792 (last merge round=40)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9974102838643645, 'loss_val': 0.3002370001252994, 'psi': 0.9407130594378498}-{'f1_val': 0.9029149098201734, 'auprc': 0.997463666886364, 'loss_val': 0.28951354826932935, 'psi': 0.9407344126466496}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=1.981345 cos_to_last_merge=0.9567 (last merge round=41)
[S16] round=69 local utility u=0.074264 metrics={'f1_val': 0.8565575239675813, 'auprc': 0.893594118946792, 'loss_val': 0.9893618258684832, 'psi': 0.8713721619592656}-{'f1_val': 0.8496617668852595, 'auprc': 0.8797455934950381, 'loss_val': 1.054969404663504, 'psi': 0.861695297529171}
[S16] not sending this round → trigger blocked (psi=0.871)
[S17] START round=69 head_norm_before_train=2.333192 (no previous merge yet)
[S17] round=69 local utility u=0.012701 metrics={'f1_val': 0.8657263881030486, 'auprc': 0.9934934398151332, 'loss_val': 0.5646348294830567, 'psi': 0.9168332087878824}-{'f1_val': 0.8624066983288071, 'auprc': 0.9906195730837276, 'loss_val': 0.5614978753406326, 'psi': 0.9136918482307752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=70 head_norm_before_train=2.205477 cos_to_last_merge=0.9875 (last merge round=35)
[S2] round=70 local utility u=0.361526 metrics={'f1_val': 0.7210277198887878, 'auprc': 0.7475597333510404, 'loss_val': 0.9339683859195763, 'psi': 0.7316405252736888}-{'f1_val': 0.6611012565417416, 'auprc': 0.7381410325878641, 'loss_val': 1.2692049052562149, 'psi': 0.6919171669601906}
[S2] not sending this round → trigger blocked (psi=0.732)
[S3] START round=70 head_norm_before_train=1.784380 cos_to_last_merge=0.9290 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=70 local utility u=0.091245 metrics={'f1_val': 0.980472293141653, 'auprc': 0.9982265842656529, 'loss_val': 0.05486328155118184, 'psi': 0.987574009591253}-{'f1_val': 0.9612046783862453, 'auprc': 0.9976458614881846, 'loss_val': 0.12000522058033299, 'psi': 0.975781151627021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=70 head_norm_before_train=2.007843 cos_to_last_merge=0.9875 (last merge round=40)
[S4] round=70 local utility u=0.009567 metrics={'f1_val': 0.9533135045771524, 'auprc': 0.927524463168204, 'loss_val': 0.33403722504113725, 'psi': 0.942997888013573}-{'f1_val': 0.9483569789744093, 'auprc': 0.9305506883377098, 'loss_val': 0.33251053782443274, 'psi': 0.9412344627197295}
[S4] not sending this round → trigger blocked (psi=0.943)
[S5] START round=70 head_norm_before_train=1.933558 cos_to_last_merge=0.9977 (last merge round=39)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.6702023330278597, 'auprc': 0.9529681817362192, 'loss_val': 0.42527447122654854, 'psi': 0.7833086725112035}-{'f1_val': 0.8425149132943606, 'auprc': 0.9947721128813894, 'loss_val': 0.1470064801813883, 'psi': 0.903417793129172}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.933918 cos_to_last_merge=0.9430 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.6306275098830006, 'auprc': 0.7528765218158079, 'loss_val': 1.239569091209295, 'psi': 0.6795271146561235}-{'f1_val': 0.9270012185666271, 'auprc': 0.9140143386930379, 'loss_val': 0.2708556374164026, 'psi': 0.9218064666171915}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.747487 cos_to_last_merge=0.9849 (last merge round=39)
[S7] round=70 local utility u=0.527679 metrics={'f1_val': 0.6345106568545755, 'auprc': 0.8005086131733924, 'loss_val': 0.49904404189152296, 'psi': 0.7009098393821023}-{'f1_val': 0.5396704957739051, 'auprc': 0.7799572888132502, 'loss_val': 0.9237069250857103, 'psi': 0.6357852129896432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=70 head_norm_before_train=1.863646 cos_to_last_merge=0.9825 (last merge round=39)
[S8] round=70 local utility u=0.006687 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9994957834925993, 'loss_val': 0.02483693667668843, 'psi': 0.9963656177484578}-{'f1_val': 0.9933329447925694, 'auprc': 0.9992737877633324, 'loss_val': 0.031869021453561144, 'psi': 0.9957092819808746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=70 head_norm_before_train=2.101595 cos_to_last_merge=0.9836 (last merge round=33)
[S9] round=70 local utility u=0.001826 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9999731309282469, 'loss_val': 0.015243064390459644, 'psi': 0.998516186377685}-{'f1_val': 0.9971344652643916, 'auprc': 0.9998386752903969, 'loss_val': 0.016029768732706087, 'psi': 0.9982161492747937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=70 head_norm_before_train=2.135966 cos_to_last_merge=0.9614 (last merge round=35)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9941292231662143, 'loss_val': 0.036251749307731895, 'psi': 0.9937924830856424}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940141979491408, 'loss_val': 0.03494697981537817, 'psi': 0.993746472998813}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=2.359295 (no previous merge yet)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9957503797294349, 'loss_val': 0.024225839462487797, 'psi': 0.9961501402961785}-{'f1_val': 0.9966582352691382, 'auprc': 0.9959057732808014, 'loss_val': 0.022168240400573552, 'psi': 0.9963572504738034}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=2.107556 (no previous merge yet)
[S13] round=70 local utility u=0.295911 metrics={'f1_val': 0.7534054253836697, 'auprc': 0.8814186129118112, 'loss_val': 0.8562029082446756, 'psi': 0.8046107003949263}-{'f1_val': 0.7171335774604342, 'auprc': 0.8083813873254295, 'loss_val': 1.0112815389315402, 'psi': 0.7536327014064323}
[S13] not sending this round → trigger blocked (psi=0.805)
[S14] START round=70 head_norm_before_train=2.249515 (no previous merge yet)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.975376639747537, 'auprc': 0.9967049276275086, 'loss_val': 0.041113572830444665, 'psi': 0.9839079548995256}-{'f1_val': 0.9976724637413676, 'auprc': 0.9985841457028232, 'loss_val': 0.026164367798804752, 'psi': 0.9980371365259498}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.177691 cos_to_last_merge=0.9788 (last merge round=40)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9844679174250393, 'loss_val': 0.31980922148241603, 'psi': 0.9351922954767309}-{'f1_val': 0.9029149098201734, 'auprc': 0.9974102838643645, 'loss_val': 0.3002370001252994, 'psi': 0.9407130594378498}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.988673 cos_to_last_merge=0.9561 (last merge round=41)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.8618270573307836, 'auprc': 0.8610177937404152, 'loss_val': 0.9449822845607179, 'psi': 0.8615033518946362}-{'f1_val': 0.8565575239675813, 'auprc': 0.893594118946792, 'loss_val': 0.9893618258684832, 'psi': 0.8713721619592656}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=2.336808 (no previous merge yet)
[S17] round=70 local utility u=0.023143 metrics={'f1_val': 0.8734600826460613, 'auprc': 0.9949042922883642, 'loss_val': 0.5689840572178343, 'psi': 0.9220377665029824}-{'f1_val': 0.8657263881030486, 'auprc': 0.9934934398151332, 'loss_val': 0.5646348294830567, 'psi': 0.9168332087878824}
[S17] not sending this round → trigger blocked (psi=0.922)
[S2] START round=71 head_norm_before_train=2.213257 cos_to_last_merge=0.9873 (last merge round=35)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.6814705034183006, 'auprc': 0.7696552754286424, 'loss_val': 0.9981418535674714, 'psi': 0.7167444122224373}-{'f1_val': 0.7210277198887878, 'auprc': 0.7475597333510404, 'loss_val': 0.9339683859195763, 'psi': 0.7316405252736888}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=1.791572 cos_to_last_merge=0.9280 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=71 local utility u=0.065309 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9984477532524585, 'loss_val': 0.02399747340001622, 'psi': 0.9975712479209475}-{'f1_val': 0.980472293141653, 'auprc': 0.9982265842656529, 'loss_val': 0.05486328155118184, 'psi': 0.987574009591253}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=71 head_norm_before_train=2.017797 cos_to_last_merge=0.9874 (last merge round=40)
[S4] round=71 local utility u=0.007117 metrics={'f1_val': 0.9546873916458383, 'auprc': 0.9284020434407664, 'loss_val': 0.33067907120040646, 'psi': 0.9441732523638094}-{'f1_val': 0.9533135045771524, 'auprc': 0.927524463168204, 'loss_val': 0.33403722504113725, 'psi': 0.942997888013573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=71 head_norm_before_train=1.934867 cos_to_last_merge=0.9976 (last merge round=39)
[S5] round=71 local utility u=1.000000 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.9981357521074234, 'loss_val': 0.06690301815936732, 'psi': 0.997291123506522}-{'f1_val': 0.6702023330278597, 'auprc': 0.9529681817362192, 'loss_val': 0.42527447122654854, 'psi': 0.7833086725112035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=71 head_norm_before_train=1.943795 cos_to_last_merge=0.9422 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=71 local utility u=1.000000 metrics={'f1_val': 0.8550956097324613, 'auprc': 0.9452058437000841, 'loss_val': 0.2185656532109837, 'psi': 0.8911397033195105}-{'f1_val': 0.6306275098830006, 'auprc': 0.7528765218158079, 'loss_val': 1.239569091209295, 'psi': 0.6795271146561235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=71 head_norm_before_train=1.750486 cos_to_last_merge=0.9847 (last merge round=39)
[S7] round=71 local utility u=1.000000 metrics={'f1_val': 0.846155486604311, 'auprc': 0.982814883455619, 'loss_val': 0.22108496184497037, 'psi': 0.900819245344834}-{'f1_val': 0.6345106568545755, 'auprc': 0.8005086131733924, 'loss_val': 0.49904404189152296, 'psi': 0.7009098393821023}
[S7] not sending this round → trigger blocked (psi=0.901)
[S8] START round=71 head_norm_before_train=1.868918 cos_to_last_merge=0.9821 (last merge round=39)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9995030379307369, 'loss_val': 0.023583547244485754, 'psi': 0.9962358378439322}-{'f1_val': 0.9942788405856967, 'auprc': 0.9994957834925993, 'loss_val': 0.02483693667668843, 'psi': 0.9963656177484578}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.107044 cos_to_last_merge=0.9832 (last merge round=33)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995845057768467, 'loss_val': 0.014741442330064046, 'psi': 0.998360736317125}-{'f1_val': 0.9975448900106438, 'auprc': 0.9999731309282469, 'loss_val': 0.015243064390459644, 'psi': 0.998516186377685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.143186 cos_to_last_merge=0.9608 (last merge round=35)
[S10] round=71 local utility u=0.000862 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939104485212368, 'loss_val': 0.03387059060262649, 'psi': 0.9937049732276514}-{'f1_val': 0.9935679896985945, 'auprc': 0.9941292231662143, 'loss_val': 0.036251749307731895, 'psi': 0.9937924830856424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=71 head_norm_before_train=2.362780 (no previous merge yet)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.995212993879158, 'loss_val': 0.02107055835625748, 'psi': 0.9957776823981104}-{'f1_val': 0.9964166473406741, 'auprc': 0.9957503797294349, 'loss_val': 0.024225839462487797, 'psi': 0.9961501402961785}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=2.113450 (no previous merge yet)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.7444671988972005, 'auprc': 0.8923760864387031, 'loss_val': 0.9537033181913084, 'psi': 0.8036307539138015}-{'f1_val': 0.7534054253836697, 'auprc': 0.8814186129118112, 'loss_val': 0.8562029082446756, 'psi': 0.8046107003949263}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=2.253867 (no previous merge yet)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9307424542361078, 'auprc': 0.9967993007804834, 'loss_val': 0.14988867208801834, 'psi': 0.957165192853858}-{'f1_val': 0.975376639747537, 'auprc': 0.9967049276275086, 'loss_val': 0.041113572830444665, 'psi': 0.9839079548995256}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=2.183638 cos_to_last_merge=0.9784 (last merge round=40)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.901767609170308, 'auprc': 0.9789732254200963, 'loss_val': 0.33354179029379494, 'psi': 0.9326498556702233}-{'f1_val': 0.9023418808445254, 'auprc': 0.9844679174250393, 'loss_val': 0.31980922148241603, 'psi': 0.9351922954767309}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.994011 cos_to_last_merge=0.9558 (last merge round=41)
[S16] round=71 local utility u=0.963442 metrics={'f1_val': 0.9783868477887947, 'auprc': 0.9825648252907477, 'loss_val': 0.08209854886720558, 'psi': 0.9800580387895759}-{'f1_val': 0.8618270573307836, 'auprc': 0.8610177937404152, 'loss_val': 0.9449822845607179, 'psi': 0.8615033518946362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=71 head_norm_before_train=2.339854 (no previous merge yet)
[S17] round=71 local utility u=0.245331 metrics={'f1_val': 0.911142991739144, 'auprc': 0.9898039966043586, 'loss_val': 0.289118648053072, 'psi': 0.9426073936852298}-{'f1_val': 0.8734600826460613, 'auprc': 0.9949042922883642, 'loss_val': 0.5689840572178343, 'psi': 0.9220377665029824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=72 head_norm_before_train=2.219014 cos_to_last_merge=0.9869 (last merge round=35)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.6629650041311169, 'auprc': 0.7585464810710284, 'loss_val': 1.3146103280782593, 'psi': 0.7011975949070816}-{'f1_val': 0.6814705034183006, 'auprc': 0.7696552754286424, 'loss_val': 0.9981418535674714, 'psi': 0.7167444122224373}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=1.798428 cos_to_last_merge=0.9271 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9373314124327115, 'auprc': 0.9982397508151013, 'loss_val': 0.17178056735272138, 'psi': 0.9616947477856674}-{'f1_val': 0.9969869110332736, 'auprc': 0.9984477532524585, 'loss_val': 0.02399747340001622, 'psi': 0.9975712479209475}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.018569 cos_to_last_merge=0.9865 (last merge round=40)
[S4] round=72 local utility u=0.013517 metrics={'f1_val': 0.9432070208347938, 'auprc': 0.9615615552218433, 'loss_val': 0.3342414642008002, 'psi': 0.9505488345896136}-{'f1_val': 0.9546873916458383, 'auprc': 0.9284020434407664, 'loss_val': 0.33067907120040646, 'psi': 0.9441732523638094}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=72 head_norm_before_train=1.937248 cos_to_last_merge=0.9973 (last merge round=39)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.701052712312935, 'auprc': 0.9728548851376251, 'loss_val': 0.4214011953841385, 'psi': 0.8097735814428111}-{'f1_val': 0.9967280377725878, 'auprc': 0.9981357521074234, 'loss_val': 0.06690301815936732, 'psi': 0.997291123506522}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.952577 cos_to_last_merge=0.9417 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=72 local utility u=0.000000 metrics={'f1_val': 0.7890769987160264, 'auprc': 0.9139004560199036, 'loss_val': 0.7881292033082063, 'psi': 0.8390063816375772}-{'f1_val': 0.8550956097324613, 'auprc': 0.9452058437000841, 'loss_val': 0.2185656532109837, 'psi': 0.8911397033195105}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=72 head_norm_before_train=1.753980 cos_to_last_merge=0.9844 (last merge round=39)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5443908109709419, 'auprc': 0.779324096678176, 'loss_val': 0.9051303164809269, 'psi': 0.6383641252538356}-{'f1_val': 0.846155486604311, 'auprc': 0.982814883455619, 'loss_val': 0.22108496184497037, 'psi': 0.900819245344834}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.875480 cos_to_last_merge=0.9817 (last merge round=39)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9902768648348889, 'auprc': 0.9989547997907186, 'loss_val': 0.037516746524007764, 'psi': 0.9937480388172207}-{'f1_val': 0.994057704452729, 'auprc': 0.9995030379307369, 'loss_val': 0.023583547244485754, 'psi': 0.9962358378439322}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.112578 cos_to_last_merge=0.9828 (last merge round=33)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995925515625335, 'loss_val': 0.015303433194608378, 'psi': 0.9983639546313996}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995845057768467, 'loss_val': 0.014741442330064046, 'psi': 0.998360736317125}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=2.148222 cos_to_last_merge=0.9603 (last merge round=35)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939728456151818, 'loss_val': 0.03429161249741413, 'psi': 0.9937299320652294}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939104485212368, 'loss_val': 0.03387059060262649, 'psi': 0.9937049732276514}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.368151 (no previous merge yet)
[S11] round=72 local utility u=0.002870 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.995498716998439, 'loss_val': 0.017762796676282142, 'psi': 0.9960494752037801}-{'f1_val': 0.9961541414107454, 'auprc': 0.995212993879158, 'loss_val': 0.02107055835625748, 'psi': 0.9957776823981104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=72 head_norm_before_train=2.116108 (no previous merge yet)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.7373276323249163, 'auprc': 0.8408005316445246, 'loss_val': 1.0504192163607116, 'psi': 0.7787167920527596}-{'f1_val': 0.7444671988972005, 'auprc': 0.8923760864387031, 'loss_val': 0.9537033181913084, 'psi': 0.8036307539138015}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.259757 (no previous merge yet)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9311469831622596, 'auprc': 0.9985872227639727, 'loss_val': 0.17002889468571525, 'psi': 0.9581230790029449}-{'f1_val': 0.9307424542361078, 'auprc': 0.9967993007804834, 'loss_val': 0.14988867208801834, 'psi': 0.957165192853858}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.189399 cos_to_last_merge=0.9780 (last merge round=40)
[S15] round=72 local utility u=0.008323 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9812655439287618, 'loss_val': 0.32721899742936833, 'psi': 0.9339113460782199}-{'f1_val': 0.901767609170308, 'auprc': 0.9789732254200963, 'loss_val': 0.33354179029379494, 'psi': 0.9326498556702233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=72 head_norm_before_train=1.996931 cos_to_last_merge=0.9555 (last merge round=41)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.8003590187852944, 'auprc': 0.9780460810391157, 'loss_val': 0.9705610689658699, 'psi': 0.871433843686823}-{'f1_val': 0.9783868477887947, 'auprc': 0.9825648252907477, 'loss_val': 0.08209854886720558, 'psi': 0.9800580387895759}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.346550 (no previous merge yet)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.837911384487449, 'auprc': 0.987784912528667, 'loss_val': 0.6018581700716102, 'psi': 0.8978607957039362}-{'f1_val': 0.911142991739144, 'auprc': 0.9898039966043586, 'loss_val': 0.289118648053072, 'psi': 0.9426073936852298}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.226730 cos_to_last_merge=0.9867 (last merge round=35)
[S2] round=73 local utility u=0.216436 metrics={'f1_val': 0.684341378104246, 'auprc': 0.764641658685557, 'loss_val': 1.028281213810475, 'psi': 0.7164614903367703}-{'f1_val': 0.6629650041311169, 'auprc': 0.7585464810710284, 'loss_val': 1.3146103280782593, 'psi': 0.7011975949070816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=73 head_norm_before_train=1.803643 cos_to_last_merge=0.9264 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=73 local utility u=0.079697 metrics={'f1_val': 0.960527581452528, 'auprc': 0.9980712922826852, 'loss_val': 0.1510589049964282, 'psi': 0.975545065784591}-{'f1_val': 0.9373314124327115, 'auprc': 0.9982397508151013, 'loss_val': 0.17178056735272138, 'psi': 0.9616947477856674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=73 head_norm_before_train=2.030208 cos_to_last_merge=0.9864 (last merge round=40)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9423364077196656, 'auprc': 0.9511119625976809, 'loss_val': 0.34375910280594446, 'psi': 0.9458466296708717}-{'f1_val': 0.9432070208347938, 'auprc': 0.9615615552218433, 'loss_val': 0.3342414642008002, 'psi': 0.9505488345896136}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.942289 cos_to_last_merge=0.9968 (last merge round=39)
[S5] round=73 local utility u=1.000000 metrics={'f1_val': 0.9972873218889189, 'auprc': 0.9981157454121415, 'loss_val': 0.050008153139388604, 'psi': 0.9976186912982079}-{'f1_val': 0.701052712312935, 'auprc': 0.9728548851376251, 'loss_val': 0.4214011953841385, 'psi': 0.8097735814428111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=73 head_norm_before_train=1.961631 cos_to_last_merge=0.9410 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=73 local utility u=0.709688 metrics={'f1_val': 0.9090421178568441, 'auprc': 0.9434533767774813, 'loss_val': 0.17720201222703008, 'psi': 0.922806621425099}-{'f1_val': 0.7890769987160264, 'auprc': 0.9139004560199036, 'loss_val': 0.7881292033082063, 'psi': 0.8390063816375772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=73 head_norm_before_train=1.758474 cos_to_last_merge=0.9839 (last merge round=39)
[S7] round=73 local utility u=1.000000 metrics={'f1_val': 0.6991367074145473, 'auprc': 0.9833820382431565, 'loss_val': 0.21946565321003403, 'psi': 0.812834839745991}-{'f1_val': 0.5443908109709419, 'auprc': 0.779324096678176, 'loss_val': 0.9051303164809269, 'psi': 0.6383641252538356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=73 head_norm_before_train=1.879513 cos_to_last_merge=0.9815 (last merge round=39)
[S8] round=73 local utility u=0.003933 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9989898013940981, 'loss_val': 0.04717855734341202, 'psi': 0.9955044066349186}-{'f1_val': 0.9902768648348889, 'auprc': 0.9989547997907186, 'loss_val': 0.037516746524007764, 'psi': 0.9937480388172207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=73 head_norm_before_train=2.118176 cos_to_last_merge=0.9825 (last merge round=33)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999585012677124, 'loss_val': 0.015231711374445579, 'psi': 0.9980957525781353}-{'f1_val': 0.9975448900106438, 'auprc': 0.9995925515625335, 'loss_val': 0.015303433194608378, 'psi': 0.9983639546313996}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.154079 cos_to_last_merge=0.9598 (last merge round=35)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.994102736351619, 'loss_val': 0.035918160223050145, 'psi': 0.9937818883598043}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939728456151818, 'loss_val': 0.03429161249741413, 'psi': 0.9937299320652294}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.373868 (no previous merge yet)
[S11] round=73 local utility u=0.000462 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.996101897838114, 'loss_val': 0.01852274647652458, 'psi': 0.9962782714537122}-{'f1_val': 0.9964166473406741, 'auprc': 0.995498716998439, 'loss_val': 0.017762796676282142, 'psi': 0.9960494752037801}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=73 head_norm_before_train=2.122428 (no previous merge yet)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.655008181407971, 'auprc': 0.6980463648743567, 'loss_val': 1.305432934928865, 'psi': 0.6722234547945253}-{'f1_val': 0.7373276323249163, 'auprc': 0.8408005316445246, 'loss_val': 1.0504192163607116, 'psi': 0.7787167920527596}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=2.265845 (no previous merge yet)
[S14] round=73 local utility u=0.029470 metrics={'f1_val': 0.9345019753943689, 'auprc': 0.9985926568642938, 'loss_val': 0.1312358256778038, 'psi': 0.9601382479823388}-{'f1_val': 0.9311469831622596, 'auprc': 0.9985872227639727, 'loss_val': 0.17002889468571525, 'psi': 0.9581230790029449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=73 head_norm_before_train=2.195038 cos_to_last_merge=0.9776 (last merge round=40)
[S15] round=73 local utility u=0.004659 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9837783561651959, 'loss_val': 0.3254402489052064, 'psi': 0.9349164709727935}-{'f1_val': 0.9023418808445254, 'auprc': 0.9812655439287618, 'loss_val': 0.32721899742936833, 'psi': 0.9339113460782199}
[S15] not sending this round → trigger blocked (psi=0.935)
[S16] START round=73 head_norm_before_train=1.997033 cos_to_last_merge=0.9553 (last merge round=41)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.8276804831892115, 'auprc': 0.7944562994893682, 'loss_val': 1.3304202809800891, 'psi': 0.8143908097092742}-{'f1_val': 0.8003590187852944, 'auprc': 0.9780460810391157, 'loss_val': 0.9705610689658699, 'psi': 0.871433843686823}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.345772 (no previous merge yet)
[S17] round=73 local utility u=0.343243 metrics={'f1_val': 0.9095068831514816, 'auprc': 0.9958261741398582, 'loss_val': 0.36906893162365445, 'psi': 0.9440345995468323}-{'f1_val': 0.837911384487449, 'auprc': 0.987784912528667, 'loss_val': 0.6018581700716102, 'psi': 0.8978607957039362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=74 head_norm_before_train=2.233441 cos_to_last_merge=0.9862 (last merge round=35)
[S2] round=74 local utility u=0.212608 metrics={'f1_val': 0.7117541013978991, 'auprc': 0.7982398299124815, 'loss_val': 0.8683354372350901, 'psi': 0.746348392803732}-{'f1_val': 0.684341378104246, 'auprc': 0.764641658685557, 'loss_val': 1.028281213810475, 'psi': 0.7164614903367703}
[S2] not sending this round → trigger blocked (psi=0.746)
[S3] START round=74 head_norm_before_train=1.808566 cos_to_last_merge=0.9258 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=74 local utility u=0.172412 metrics={'f1_val': 0.9964507029500795, 'auprc': 0.99876393187095, 'loss_val': 0.023851729349917396, 'psi': 0.9973759945184277}-{'f1_val': 0.960527581452528, 'auprc': 0.9980712922826852, 'loss_val': 0.1510589049964282, 'psi': 0.975545065784591}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=74 head_norm_before_train=2.034011 cos_to_last_merge=0.9849 (last merge round=40)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9413681451762824, 'auprc': 0.9410081698926807, 'loss_val': 0.3618400096832376, 'psi': 0.9412241550628417}-{'f1_val': 0.9423364077196656, 'auprc': 0.9511119625976809, 'loss_val': 0.34375910280594446, 'psi': 0.9458466296708717}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.945694 cos_to_last_merge=0.9964 (last merge round=39)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.7010029842591188, 'auprc': 0.9861975425262943, 'loss_val': 0.36985357714187567, 'psi': 0.815080807565989}-{'f1_val': 0.9972873218889189, 'auprc': 0.9981157454121415, 'loss_val': 0.050008153139388604, 'psi': 0.9976186912982079}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.973389 cos_to_last_merge=0.9402 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.7798877311315561, 'auprc': 0.8543774416837461, 'loss_val': 0.7796848611100066, 'psi': 0.809683615352432}-{'f1_val': 0.9090421178568441, 'auprc': 0.9434533767774813, 'loss_val': 0.17720201222703008, 'psi': 0.922806621425099}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.762078 cos_to_last_merge=0.9835 (last merge round=39)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5578320708739077, 'auprc': 0.7801022574569529, 'loss_val': 0.8302957989474838, 'psi': 0.6467401455071258}-{'f1_val': 0.6991367074145473, 'auprc': 0.9833820382431565, 'loss_val': 0.21946565321003403, 'psi': 0.812834839745991}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.885359 cos_to_last_merge=0.9811 (last merge round=39)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9641031100935495, 'auprc': 0.9949176032252198, 'loss_val': 0.07460850170147197, 'psi': 0.9764289073462177}-{'f1_val': 0.9931808101287989, 'auprc': 0.9989898013940981, 'loss_val': 0.04717855734341202, 'psi': 0.9955044066349186}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=2.124202 cos_to_last_merge=0.9820 (last merge round=33)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9991915281320622, 'loss_val': 0.04256178371325402, 'psi': 0.9931539470988051}-{'f1_val': 0.9971029125121428, 'auprc': 0.999585012677124, 'loss_val': 0.015231711374445579, 'psi': 0.9980957525781353}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.160693 cos_to_last_merge=0.9592 (last merge round=35)
[S10] round=74 local utility u=0.000215 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940117657891926, 'loss_val': 0.035216124824437534, 'psi': 0.9937455001348336}-{'f1_val': 0.9935679896985945, 'auprc': 0.994102736351619, 'loss_val': 0.035918160223050145, 'psi': 0.9937818883598043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=74 head_norm_before_train=2.379039 (no previous merge yet)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.996415238974586, 'loss_val': 0.020647967223216147, 'psi': 0.9962585804362816}-{'f1_val': 0.9963958538641108, 'auprc': 0.996101897838114, 'loss_val': 0.01852274647652458, 'psi': 0.9962782714537122}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=2.133002 (no previous merge yet)
[S13] round=74 local utility u=0.254392 metrics={'f1_val': 0.6857979683032905, 'auprc': 0.7558409019384768, 'loss_val': 1.154771048665774, 'psi': 0.713815141757365}-{'f1_val': 0.655008181407971, 'auprc': 0.6980463648743567, 'loss_val': 1.305432934928865, 'psi': 0.6722234547945253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=74 head_norm_before_train=2.271205 (no previous merge yet)
[S14] round=74 local utility u=0.073461 metrics={'f1_val': 0.9482969734079387, 'auprc': 0.998170148414433, 'loss_val': 0.06581661480177257, 'psi': 0.9682462434105363}-{'f1_val': 0.9345019753943689, 'auprc': 0.9985926568642938, 'loss_val': 0.1312358256778038, 'psi': 0.9601382479823388}
[S14] not sending this round → trigger blocked (psi=0.968)
[S15] START round=74 head_norm_before_train=2.200550 cos_to_last_merge=0.9772 (last merge round=40)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9806691358341072, 'loss_val': 0.3314962713141788, 'psi': 0.9336727828403582}-{'f1_val': 0.9023418808445254, 'auprc': 0.9837783561651959, 'loss_val': 0.3254402489052064, 'psi': 0.9349164709727935}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=1.999141 cos_to_last_merge=0.9550 (last merge round=41)
[S16] round=74 local utility u=0.900987 metrics={'f1_val': 0.9268829518893762, 'auprc': 0.8934494455417359, 'loss_val': 0.420640521868708, 'psi': 0.91350954935032}-{'f1_val': 0.8276804831892115, 'auprc': 0.7944562994893682, 'loss_val': 1.3304202809800891, 'psi': 0.8143908097092742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=74 head_norm_before_train=2.347139 (no previous merge yet)
[S17] round=74 local utility u=0.002851 metrics={'f1_val': 0.9092200244521413, 'auprc': 0.9956724056659392, 'loss_val': 0.36118526028516196, 'psi': 0.9438009769376605}-{'f1_val': 0.9095068831514816, 'auprc': 0.9958261741398582, 'loss_val': 0.36906893162365445, 'psi': 0.9440345995468323}
[S17] not sending this round → trigger blocked (psi=0.944)
[S2] START round=75 head_norm_before_train=2.242335 cos_to_last_merge=0.9860 (last merge round=35)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.7000088792049641, 'auprc': 0.7623722705356727, 'loss_val': 0.9874329922083587, 'psi': 0.7249542357372476}-{'f1_val': 0.7117541013978991, 'auprc': 0.7982398299124815, 'loss_val': 0.8683354372350901, 'psi': 0.746348392803732}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=1.814132 cos_to_last_merge=0.9251 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=75 local utility u=0.001856 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9987645925342545, 'loss_val': 0.02318862481893862, 'psi': 0.997680860575499}-{'f1_val': 0.9964507029500795, 'auprc': 0.99876393187095, 'loss_val': 0.023851729349917396, 'psi': 0.9973759945184277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=75 head_norm_before_train=2.040168 cos_to_last_merge=0.9840 (last merge round=40)
[S4] round=75 local utility u=0.053500 metrics={'f1_val': 0.9512025451558244, 'auprc': 0.9489151317028167, 'loss_val': 0.33756686027185373, 'psi': 0.9502875797746213}-{'f1_val': 0.9413681451762824, 'auprc': 0.9410081698926807, 'loss_val': 0.3618400096832376, 'psi': 0.9412241550628417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=75 head_norm_before_train=1.947017 cos_to_last_merge=0.9960 (last merge round=39)
[S5] round=75 local utility u=1.000000 metrics={'f1_val': 0.9968744665834274, 'auprc': 0.9980420907404356, 'loss_val': 0.050909685452345546, 'psi': 0.9973415162462307}-{'f1_val': 0.7010029842591188, 'auprc': 0.9861975425262943, 'loss_val': 0.36985357714187567, 'psi': 0.815080807565989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=75 head_norm_before_train=1.985816 cos_to_last_merge=0.9393 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=75 local utility u=0.362205 metrics={'f1_val': 0.8498925808719331, 'auprc': 0.8422838706438223, 'loss_val': 0.43902245132382656, 'psi': 0.8468490967806888}-{'f1_val': 0.7798877311315561, 'auprc': 0.8543774416837461, 'loss_val': 0.7796848611100066, 'psi': 0.809683615352432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=75 head_norm_before_train=1.765566 cos_to_last_merge=0.9831 (last merge round=39)
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.8045794150147764, 'auprc': 0.9736998002866173, 'loss_val': 0.2208133622189686, 'psi': 0.8722275691235127}-{'f1_val': 0.5578320708739077, 'auprc': 0.7801022574569529, 'loss_val': 0.8302957989474838, 'psi': 0.6467401455071258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=75 head_norm_before_train=1.893957 cos_to_last_merge=0.9807 (last merge round=39)
[S8] round=75 local utility u=0.124605 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9997368979915644, 'loss_val': 0.02531964289352192, 'psi': 0.9969029491858267}-{'f1_val': 0.9641031100935495, 'auprc': 0.9949176032252198, 'loss_val': 0.07460850170147197, 'psi': 0.9764289073462177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=75 head_norm_before_train=2.128998 cos_to_last_merge=0.9818 (last merge round=33)
[S9] round=75 local utility u=0.034140 metrics={'f1_val': 0.9960499618648996, 'auprc': 0.9995810070390173, 'loss_val': 0.016976942336301686, 'psi': 0.9974623799345467}-{'f1_val': 0.9891288930766337, 'auprc': 0.9991915281320622, 'loss_val': 0.04256178371325402, 'psi': 0.9931539470988051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=75 head_norm_before_train=2.165177 cos_to_last_merge=0.9587 (last merge round=35)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940742106431961, 'loss_val': 0.03542177833915782, 'psi': 0.9937704780764351}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940117657891926, 'loss_val': 0.035216124824437534, 'psi': 0.9937455001348336}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.382769 (no previous merge yet)
[S11] round=75 local utility u=0.000914 metrics={'f1_val': 0.9964166473406741, 'auprc': 0.9956400239843293, 'loss_val': 0.018068640954143844, 'psi': 0.9961059979981363}-{'f1_val': 0.9961541414107454, 'auprc': 0.996415238974586, 'loss_val': 0.020647967223216147, 'psi': 0.9962585804362816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=75 head_norm_before_train=2.147405 (no previous merge yet)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6265478683398298, 'auprc': 0.9742406792211822, 'loss_val': 1.463711074009368, 'psi': 0.7656249926923707}-{'f1_val': 0.6857979683032905, 'auprc': 0.7558409019384768, 'loss_val': 1.154771048665774, 'psi': 0.713815141757365}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.276033 (no previous merge yet)
[S14] round=75 local utility u=0.155926 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9964380539688907, 'loss_val': 0.025948028906730564, 'psi': 0.9952713460041902}-{'f1_val': 0.9482969734079387, 'auprc': 0.998170148414433, 'loss_val': 0.06581661480177257, 'psi': 0.9682462434105363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=75 head_norm_before_train=2.205950 cos_to_last_merge=0.9768 (last merge round=40)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.980503907084872, 'loss_val': 0.3333504246570381, 'psi': 0.933606691340664}-{'f1_val': 0.9023418808445254, 'auprc': 0.9806691358341072, 'loss_val': 0.3314962713141788, 'psi': 0.9336727828403582}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.003222 cos_to_last_merge=0.9546 (last merge round=41)
[S16] round=75 local utility u=0.228580 metrics={'f1_val': 0.9215306631463644, 'auprc': 0.981750315682957, 'loss_val': 0.19626909564925094, 'psi': 0.9456185241610015}-{'f1_val': 0.9268829518893762, 'auprc': 0.8934494455417359, 'loss_val': 0.420640521868708, 'psi': 0.91350954935032}
[S16] not sending this round → trigger blocked (psi=0.946)
[S17] START round=75 head_norm_before_train=2.352873 (no previous merge yet)
[S17] round=75 local utility u=0.021466 metrics={'f1_val': 0.9108379562412812, 'auprc': 0.9936986760197264, 'loss_val': 0.3220390866058373, 'psi': 0.9439822441526592}-{'f1_val': 0.9092200244521413, 'auprc': 0.9956724056659392, 'loss_val': 0.36118526028516196, 'psi': 0.9438009769376605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=76 head_norm_before_train=2.251191 cos_to_last_merge=0.9857 (last merge round=35)
[S2] round=76 local utility u=0.056471 metrics={'f1_val': 0.7176448250049332, 'auprc': 0.7586017678332784, 'loss_val': 0.9689960237676803, 'psi': 0.7340276021362713}-{'f1_val': 0.7000088792049641, 'auprc': 0.7623722705356727, 'loss_val': 0.9874329922083587, 'psi': 0.7249542357372476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=76 head_norm_before_train=1.820655 cos_to_last_merge=0.9243 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9739108982765348, 'auprc': 0.9975342493912884, 'loss_val': 0.07282209622635775, 'psi': 0.9833602387224363}-{'f1_val': 0.9969583726029951, 'auprc': 0.9987645925342545, 'loss_val': 0.02318862481893862, 'psi': 0.997680860575499}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=2.047040 cos_to_last_merge=0.9840 (last merge round=40)
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9481187019772317, 'auprc': 0.9305399777024963, 'loss_val': 0.3360829810015129, 'psi': 0.9410872122673376}-{'f1_val': 0.9512025451558244, 'auprc': 0.9489151317028167, 'loss_val': 0.33756686027185373, 'psi': 0.9502875797746213}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.951369 cos_to_last_merge=0.9956 (last merge round=39)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.7851944742742318, 'auprc': 0.9909272342205919, 'loss_val': 0.22123641193822452, 'psi': 0.8674875782527759}-{'f1_val': 0.9968744665834274, 'auprc': 0.9980420907404356, 'loss_val': 0.050909685452345546, 'psi': 0.9973415162462307}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.995023 cos_to_last_merge=0.9387 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=76 local utility u=0.169271 metrics={'f1_val': 0.8448932468095344, 'auprc': 0.9453406457424518, 'loss_val': 0.37965569400517113, 'psi': 0.8850722063827013}-{'f1_val': 0.8498925808719331, 'auprc': 0.8422838706438223, 'loss_val': 0.43902245132382656, 'psi': 0.8468490967806888}
[S6] not sending this round → trigger blocked (psi=0.885)
[S7] START round=76 head_norm_before_train=1.772319 cos_to_last_merge=0.9826 (last merge round=39)
[S7] round=76 local utility u=0.537851 metrics={'f1_val': 0.9654593342644058, 'auprc': 0.9895412085949816, 'loss_val': 0.15791569122188498, 'psi': 0.9750920839966362}-{'f1_val': 0.8045794150147764, 'auprc': 0.9736998002866173, 'loss_val': 0.2208133622189686, 'psi': 0.8722275691235127}
[S7] not sending this round → trigger blocked (psi=0.975)
[S8] START round=76 head_norm_before_train=1.901525 cos_to_last_merge=0.9804 (last merge round=39)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9991027548545286, 'loss_val': 0.033801295105203674, 'psi': 0.9946757951620134}-{'f1_val': 0.9950136499820015, 'auprc': 0.9997368979915644, 'loss_val': 0.02531964289352192, 'psi': 0.9969029491858267}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.131694 cos_to_last_merge=0.9816 (last merge round=33)
[S9] round=76 local utility u=0.004125 metrics={'f1_val': 0.9972945621169176, 'auprc': 0.999593273348149, 'loss_val': 0.016231151140367068, 'psi': 0.99821404660941}-{'f1_val': 0.9960499618648996, 'auprc': 0.9995810070390173, 'loss_val': 0.016976942336301686, 'psi': 0.9974623799345467}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=76 head_norm_before_train=2.170760 cos_to_last_merge=0.9582 (last merge round=35)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.99402832753957, 'loss_val': 0.035378665112164094, 'psi': 0.9937521248349847}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940742106431961, 'loss_val': 0.03542177833915782, 'psi': 0.9937704780764351}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.384948 (no previous merge yet)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9961758060005763, 'auprc': 0.9958923374093107, 'loss_val': 0.024289282405758884, 'psi': 0.9960624185640701}-{'f1_val': 0.9964166473406741, 'auprc': 0.9956400239843293, 'loss_val': 0.018068640954143844, 'psi': 0.9961059979981363}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=2.150030 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6226908705356338, 'auprc': 0.7251676254196338, 'loss_val': 1.387885023550101, 'psi': 0.6636815724892338}-{'f1_val': 0.6265478683398298, 'auprc': 0.9742406792211822, 'loss_val': 1.463711074009368, 'psi': 0.7656249926923707}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.280455 (no previous merge yet)
[S14] round=76 local utility u=0.014337 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9964197639933148, 'loss_val': 0.017189248279987576, 'psi': 0.9972609612099813}-{'f1_val': 0.9944935406943898, 'auprc': 0.9964380539688907, 'loss_val': 0.025948028906730564, 'psi': 0.9952713460041902}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=76 head_norm_before_train=2.211171 cos_to_last_merge=0.9764 (last merge round=40)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9802524454210649, 'loss_val': 0.3369676662634811, 'psi': 0.9335061066751411}-{'f1_val': 0.9023418808445254, 'auprc': 0.980503907084872, 'loss_val': 0.3333504246570381, 'psi': 0.933606691340664}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.007451 cos_to_last_merge=0.9542 (last merge round=41)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.8232115588671605, 'auprc': 0.8343018064397862, 'loss_val': 1.3762379252942247, 'psi': 0.8276476578962108}-{'f1_val': 0.9215306631463644, 'auprc': 0.981750315682957, 'loss_val': 0.19626909564925094, 'psi': 0.9456185241610015}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.358979 (no previous merge yet)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.8266710071920715, 'auprc': 0.9871436227982752, 'loss_val': 0.7177819225148478, 'psi': 0.890860053434553}-{'f1_val': 0.9108379562412812, 'auprc': 0.9936986760197264, 'loss_val': 0.3220390866058373, 'psi': 0.9439822441526592}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=2.257964 cos_to_last_merge=0.9853 (last merge round=35)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7083065830697315, 'auprc': 0.7503260276537578, 'loss_val': 1.0422535344507293, 'psi': 0.725114360903342}-{'f1_val': 0.7176448250049332, 'auprc': 0.7586017678332784, 'loss_val': 0.9689960237676803, 'psi': 0.7340276021362713}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=1.827320 cos_to_last_merge=0.9235 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9975691591897168, 'loss_val': 0.13614841990259638, 'psi': 0.9754722575231028}-{'f1_val': 0.9739108982765348, 'auprc': 0.9975342493912884, 'loss_val': 0.07282209622635775, 'psi': 0.9833602387224363}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.049190 cos_to_last_merge=0.9833 (last merge round=40)
[S4] round=77 local utility u=0.022692 metrics={'f1_val': 0.951757904663754, 'auprc': 0.9351313403309799, 'loss_val': 0.3263080569565046, 'psi': 0.9451072789306444}-{'f1_val': 0.9481187019772317, 'auprc': 0.9305399777024963, 'loss_val': 0.3360829810015129, 'psi': 0.9410872122673376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=77 head_norm_before_train=1.960833 cos_to_last_merge=0.9950 (last merge round=39)
[S5] round=77 local utility u=0.728391 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9967939053011318, 'loss_val': 0.04976541395874727, 'psi': 0.9966052502920908}-{'f1_val': 0.7851944742742318, 'auprc': 0.9909272342205919, 'loss_val': 0.22123641193822452, 'psi': 0.8674875782527759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=77 head_norm_before_train=2.004186 cos_to_last_merge=0.9380 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=77 local utility u=0.174162 metrics={'f1_val': 0.8680495370180905, 'auprc': 0.9553547381723605, 'loss_val': 0.20031181873023418, 'psi': 0.9029716174797986}-{'f1_val': 0.8448932468095344, 'auprc': 0.9453406457424518, 'loss_val': 0.37965569400517113, 'psi': 0.8850722063827013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=77 head_norm_before_train=1.781196 cos_to_last_merge=0.9821 (last merge round=39)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.6563093464714327, 'auprc': 0.8059713867166423, 'loss_val': 0.5135555061669465, 'psi': 0.7161741625695166}-{'f1_val': 0.9654593342644058, 'auprc': 0.9895412085949816, 'loss_val': 0.15791569122188498, 'psi': 0.9750920839966362}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.907562 cos_to_last_merge=0.9800 (last merge round=39)
[S8] round=77 local utility u=0.014989 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9996418772229382, 'loss_val': 0.022970050233762737, 'psi': 0.9966443298468012}-{'f1_val': 0.9917244887003366, 'auprc': 0.9991027548545286, 'loss_val': 0.033801295105203674, 'psi': 0.9946757951620134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=77 head_norm_before_train=2.135556 cos_to_last_merge=0.9814 (last merge round=33)
[S9] round=77 local utility u=0.001201 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9996007363183838, 'loss_val': 0.01535421548744391, 'psi': 0.9983672285337397}-{'f1_val': 0.9972945621169176, 'auprc': 0.999593273348149, 'loss_val': 0.016231151140367068, 'psi': 0.99821404660941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=77 head_norm_before_train=2.177056 cos_to_last_merge=0.9577 (last merge round=35)
[S10] round=77 local utility u=0.000507 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.993955303553038, 'loss_val': 0.034145853575282596, 'psi': 0.9937229152403718}-{'f1_val': 0.9935679896985945, 'auprc': 0.99402832753957, 'loss_val': 0.035378665112164094, 'psi': 0.9937521248349847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=77 head_norm_before_train=2.388567 (no previous merge yet)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9786863170774129, 'auprc': 0.9956165451445798, 'loss_val': 0.0732181891323017, 'psi': 0.9854584083042797}-{'f1_val': 0.9961758060005763, 'auprc': 0.9958923374093107, 'loss_val': 0.024289282405758884, 'psi': 0.9960624185640701}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=2.152313 (no previous merge yet)
[S13] round=77 local utility u=0.588695 metrics={'f1_val': 0.7408512307879943, 'auprc': 0.8101381962850756, 'loss_val': 1.17436942369638, 'psi': 0.7685660169868269}-{'f1_val': 0.6226908705356338, 'auprc': 0.7251676254196338, 'loss_val': 1.387885023550101, 'psi': 0.6636815724892338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=77 head_norm_before_train=2.283169 (no previous merge yet)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9987729934033844, 'loss_val': 0.02303051656034069, 'psi': 0.9979557939220507}-{'f1_val': 0.9978217593544257, 'auprc': 0.9964197639933148, 'loss_val': 0.017189248279987576, 'psi': 0.9972609612099813}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.216232 cos_to_last_merge=0.9761 (last merge round=40)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9796943234630989, 'loss_val': 0.33940889649290773, 'psi': 0.9332828578919548}-{'f1_val': 0.9023418808445254, 'auprc': 0.9802524454210649, 'loss_val': 0.3369676662634811, 'psi': 0.9335061066751411}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.012111 cos_to_last_merge=0.9538 (last merge round=41)
[S16] round=77 local utility u=0.660153 metrics={'f1_val': 0.8393520643187825, 'auprc': 0.9827721939569434, 'loss_val': 0.5981860384903263, 'psi': 0.8967201161740468}-{'f1_val': 0.8232115588671605, 'auprc': 0.8343018064397862, 'loss_val': 1.3762379252942247, 'psi': 0.8276476578962108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=77 head_norm_before_train=2.365184 (no previous merge yet)
[S17] round=77 local utility u=0.263933 metrics={'f1_val': 0.879481835079678, 'auprc': 0.9909909954958659, 'loss_val': 0.5183232756127086, 'psi': 0.9240854992461531}-{'f1_val': 0.8266710071920715, 'auprc': 0.9871436227982752, 'loss_val': 0.7177819225148478, 'psi': 0.890860053434553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] sending update (kind=head size=1789 to 1 peers)
[S2] START round=78 head_norm_before_train=2.262597 cos_to_last_merge=0.9850 (last merge round=35)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6648931090468294, 'auprc': 0.7401700424918817, 'loss_val': 1.4929138493996428, 'psi': 0.6950038824248503}-{'f1_val': 0.7083065830697315, 'auprc': 0.7503260276537578, 'loss_val': 1.0422535344507293, 'psi': 0.725114360903342}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=1.831891 cos_to_last_merge=0.9228 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9477350038468819, 'auprc': 0.9959673540964424, 'loss_val': 0.16855179220467378, 'psi': 0.9670279439467061}-{'f1_val': 0.9607409897453603, 'auprc': 0.9975691591897168, 'loss_val': 0.13614841990259638, 'psi': 0.9754722575231028}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.041840 cos_to_last_merge=0.9821 (last merge round=40)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9497718041413454, 'auprc': 0.9270002477823832, 'loss_val': 0.333009356304506, 'psi': 0.9406631815977605}-{'f1_val': 0.951757904663754, 'auprc': 0.9351313403309799, 'loss_val': 0.3263080569565046, 'psi': 0.9451072789306444}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.973654 cos_to_last_merge=0.9940 (last merge round=39)
[S5] round=78 local utility u=0.005898 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9969238837233684, 'loss_val': 0.04012055721581058, 'psi': 0.9968332742704292}-{'f1_val': 0.9964794802860635, 'auprc': 0.9967939053011318, 'loss_val': 0.04976541395874727, 'psi': 0.9966052502920908}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=78 head_norm_before_train=2.012347 cos_to_last_merge=0.9373 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.8437463432106773, 'auprc': 0.9378453240511524, 'loss_val': 0.3718268485178235, 'psi': 0.8813859355468674}-{'f1_val': 0.8680495370180905, 'auprc': 0.9553547381723605, 'loss_val': 0.20031181873023418, 'psi': 0.9029716174797986}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.786323 cos_to_last_merge=0.9814 (last merge round=39)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.6530671355860556, 'auprc': 0.7938628051499217, 'loss_val': 0.6564209120543351, 'psi': 0.7093854034116021}-{'f1_val': 0.6563093464714327, 'auprc': 0.8059713867166423, 'loss_val': 0.5135555061669465, 'psi': 0.7161741625695166}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.912229 cos_to_last_merge=0.9797 (last merge round=39)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9992234812870288, 'loss_val': 0.02631194740293046, 'psi': 0.9958171517212394}-{'f1_val': 0.9946459649293765, 'auprc': 0.9996418772229382, 'loss_val': 0.022970050233762737, 'psi': 0.9966443298468012}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.137845 cos_to_last_merge=0.9813 (last merge round=33)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9995975073704486, 'loss_val': 0.016186478912112126, 'psi': 0.9978544977070367}-{'f1_val': 0.9975448900106438, 'auprc': 0.9996007363183838, 'loss_val': 0.01535421548744391, 'psi': 0.9983672285337397}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.181444 cos_to_last_merge=0.9572 (last merge round=35)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940753677707765, 'loss_val': 0.0354521633402864, 'psi': 0.9937709409274673}-{'f1_val': 0.9935679896985945, 'auprc': 0.993955303553038, 'loss_val': 0.034145853575282596, 'psi': 0.9937229152403718}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.391824 (no previous merge yet)
[S11] round=78 local utility u=0.079411 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9962355742947457, 'loss_val': 0.021060329358465257, 'psi': 0.9961867145643455}-{'f1_val': 0.9786863170774129, 'auprc': 0.9956165451445798, 'loss_val': 0.0732181891323017, 'psi': 0.9854584083042797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=78 head_norm_before_train=2.159787 (no previous merge yet)
[S13] round=78 local utility u=0.156868 metrics={'f1_val': 0.7449545339484357, 'auprc': 0.866632688782009, 'loss_val': 1.0547376523413543, 'psi': 0.7936257958818651}-{'f1_val': 0.7408512307879943, 'auprc': 0.8101381962850756, 'loss_val': 1.17436942369638, 'psi': 0.7685660169868269}
[S13] not sending this round → trigger blocked (psi=0.794)
[S14] START round=78 head_norm_before_train=2.285928 (no previous merge yet)
[S14] round=78 local utility u=0.002833 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9983731182157014, 'loss_val': 0.017491682927852262, 'psi': 0.9979284312602064}-{'f1_val': 0.9974109942678281, 'auprc': 0.9987729934033844, 'loss_val': 0.02303051656034069, 'psi': 0.9979557939220507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=78 head_norm_before_train=2.221225 cos_to_last_merge=0.9757 (last merge round=40)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.901767609170308, 'auprc': 0.9769669664366795, 'loss_val': 0.3457375140945046, 'psi': 0.9318473520768565}-{'f1_val': 0.9023418808445254, 'auprc': 0.9796943234630989, 'loss_val': 0.33940889649290773, 'psi': 0.9332828578919548}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.016270 cos_to_last_merge=0.9535 (last merge round=41)
[S16] round=78 local utility u=0.751675 metrics={'f1_val': 0.9923620186822695, 'auprc': 0.9903901324101283, 'loss_val': 0.035748741736368224, 'psi': 0.991573264173413}-{'f1_val': 0.8393520643187825, 'auprc': 0.9827721939569434, 'loss_val': 0.5981860384903263, 'psi': 0.8967201161740468}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=78 head_norm_before_train=2.370820 (no previous merge yet)
[S17] round=78 local utility u=0.098352 metrics={'f1_val': 0.8900418989492733, 'auprc': 0.989335651924955, 'loss_val': 0.3800143707756064, 'psi': 0.9297594001395459}-{'f1_val': 0.879481835079678, 'auprc': 0.9909909954958659, 'loss_val': 0.5183232756127086, 'psi': 0.9240854992461531}
[S17] not sending this round → trigger blocked (psi=0.930)
[S2] START round=79 head_norm_before_train=2.264989 cos_to_last_merge=0.9846 (last merge round=35)
[S2] round=79 local utility u=0.234319 metrics={'f1_val': 0.6957595586332866, 'auprc': 0.7347907648069695, 'loss_val': 1.193336316711032, 'psi': 0.7113720411027598}-{'f1_val': 0.6648931090468294, 'auprc': 0.7401700424918817, 'loss_val': 1.4929138493996428, 'psi': 0.6950038824248503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=80 psi=0.711 u=0.2343 p_local=0.0973 f1=0.696 auprc=0.735 bytes=53960
[S3] START round=79 head_norm_before_train=1.835656 cos_to_last_merge=0.9222 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=79 local utility u=0.162264 metrics={'f1_val': 0.9821044489856237, 'auprc': 0.9982997222788251, 'loss_val': 0.05723771097142419, 'psi': 0.9885825583029042}-{'f1_val': 0.9477350038468819, 'auprc': 0.9959673540964424, 'loss_val': 0.16855179220467378, 'psi': 0.9670279439467061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] r=80 psi=0.989 u=0.1623 p_local=0.0566 f1=0.982 auprc=0.998 bytes=59334
[S4] START round=79 head_norm_before_train=2.041993 cos_to_last_merge=0.9818 (last merge round=40)
[S4] round=79 local utility u=0.069816 metrics={'f1_val': 0.9541482593130242, 'auprc': 0.9632223703208525, 'loss_val': 0.3283025656985366, 'psi': 0.9577779037161555}-{'f1_val': 0.9497718041413454, 'auprc': 0.9270002477823832, 'loss_val': 0.333009356304506, 'psi': 0.9406631815977605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] r=80 psi=0.958 u=0.0698 p_local=0.0247 f1=0.954 auprc=0.963 bytes=54061
[S5] START round=79 head_norm_before_train=1.986705 cos_to_last_merge=0.9929 (last merge round=39)
[S5] round=79 local utility u=0.005311 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9977779695722359, 'loss_val': 0.032061749137784874, 'psi': 0.9971749086099762}-{'f1_val': 0.9967728679684698, 'auprc': 0.9969238837233684, 'loss_val': 0.04012055721581058, 'psi': 0.9968332742704292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S5] r=80 psi=0.997 u=0.0053 p_local=0.2984 f1=0.997 auprc=0.998 bytes=68428
[S6] START round=79 head_norm_before_train=2.019350 cos_to_last_merge=0.9366 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.8730744668987845, 'auprc': 0.8256738121987037, 'loss_val': 0.522831794388091, 'psi': 0.8541142050187522}-{'f1_val': 0.8437463432106773, 'auprc': 0.9378453240511524, 'loss_val': 0.3718268485178235, 'psi': 0.8813859355468674}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.854 u=0.0000 p_local=0.1710 f1=0.873 auprc=0.826 bytes=61179
[S7] START round=79 head_norm_before_train=1.792257 cos_to_last_merge=0.9807 (last merge round=39)
[S7] round=79 local utility u=0.147911 metrics={'f1_val': 0.6642465265066974, 'auprc': 0.8085618176101086, 'loss_val': 0.47177227637867336, 'psi': 0.7219726429480618}-{'f1_val': 0.6530671355860556, 'auprc': 0.7938628051499217, 'loss_val': 0.6564209120543351, 'psi': 0.7093854034116021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=80 psi=0.722 u=0.1479 p_local=0.2876 f1=0.664 auprc=0.809 bytes=55797
[S8] START round=79 head_norm_before_train=1.919424 cos_to_last_merge=0.9793 (last merge round=39)
[S8] round=79 local utility u=0.008703 metrics={'f1_val': 0.995381897925576, 'auprc': 0.999646784339659, 'loss_val': 0.02118914749689679, 'psi': 0.9970878524912092}-{'f1_val': 0.9935462653440466, 'auprc': 0.9992234812870288, 'loss_val': 0.02631194740293046, 'psi': 0.9958171517212394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=80 psi=0.997 u=0.0087 p_local=0.0200 f1=0.995 auprc=1.000 bytes=62876
[S9] START round=79 head_norm_before_train=2.139257 cos_to_last_merge=0.9813 (last merge round=33)
[S9] round=79 local utility u=0.000761 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992197681606179, 'loss_val': 0.01599380560942313, 'psi': 0.9979496547715329}-{'f1_val': 0.9966924912647621, 'auprc': 0.9995975073704486, 'loss_val': 0.016186478912112126, 'psi': 0.9978544977070367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=80 psi=0.998 u=0.0008 p_local=0.0058 f1=0.997 auprc=0.999 bytes=63023
[S10] START round=79 head_norm_before_train=2.186527 cos_to_last_merge=0.9567 (last merge round=35)
[S10] round=79 local utility u=0.000409 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939967093472385, 'loss_val': 0.034398347614924336, 'psi': 0.993739477558052}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940753677707765, 'loss_val': 0.0354521633402864, 'psi': 0.9937709409274673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=80 psi=0.994 u=0.0004 p_local=0.0002 f1=0.994 auprc=0.994 bytes=66561
[S11] START round=79 head_norm_before_train=2.397436 (no previous merge yet)
[S11] round=79 local utility u=0.002805 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965743103315904, 'loss_val': 0.01894560113373931, 'psi': 0.9965702065163644}-{'f1_val': 0.9961541414107454, 'auprc': 0.9962355742947457, 'loss_val': 0.021060329358465257, 'psi': 0.9961867145643455}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] r=80 psi=0.997 u=0.0028 p_local=0.0135 f1=0.997 auprc=0.997 bytes=59281
[S13] START round=79 head_norm_before_train=2.168060 (no previous merge yet)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6179435209461985, 'auprc': 0.6688863354566135, 'loss_val': 1.56544944786983, 'psi': 0.6383206467503646}-{'f1_val': 0.7449545339484357, 'auprc': 0.866632688782009, 'loss_val': 1.0547376523413543, 'psi': 0.7936257958818651}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.638 u=0.0000 p_local=0.1441 f1=0.618 auprc=0.669 bytes=55772
[S14] START round=79 head_norm_before_train=2.291398 (no previous merge yet)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9922208667565442, 'auprc': 0.9986180526972873, 'loss_val': 0.032205779348299005, 'psi': 0.9947797411328414}-{'f1_val': 0.9976319732898762, 'auprc': 0.9983731182157014, 'loss_val': 0.017491682927852262, 'psi': 0.9979284312602064}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.995 u=0.0000 p_local=0.0240 f1=0.992 auprc=0.999 bytes=53838
[S15] START round=79 head_norm_before_train=2.226175 cos_to_last_merge=0.9754 (last merge round=40)
[S15] round=79 local utility u=0.011399 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9804918251373198, 'loss_val': 0.336960357452278, 'psi': 0.9336018585616431}-{'f1_val': 0.901767609170308, 'auprc': 0.9769669664366795, 'loss_val': 0.3457375140945046, 'psi': 0.9318473520768565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=80 psi=0.934 u=0.0114 p_local=0.0066 f1=0.902 auprc=0.980 bytes=50390
[S16] START round=79 head_norm_before_train=2.021111 cos_to_last_merge=0.9531 (last merge round=41)
[S16] round=79 local utility u=0.000000 metrics={'f1_val': 0.8675482163042344, 'auprc': 0.9850550770565295, 'loss_val': 0.8100164842127671, 'psi': 0.9145509606051525}-{'f1_val': 0.9923620186822695, 'auprc': 0.9903901324101283, 'loss_val': 0.035748741736368224, 'psi': 0.991573264173413}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=80 psi=0.915 u=0.0000 p_local=0.3312 f1=0.868 auprc=0.985 bytes=54034
[S17] START round=79 head_norm_before_train=2.376047 (no previous merge yet)
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.7697251763830152, 'auprc': 0.9829831222559987, 'loss_val': 0.9756649232342821, 'psi': 0.8550283547322086}-{'f1_val': 0.8900418989492733, 'auprc': 0.989335651924955, 'loss_val': 0.3800143707756064, 'psi': 0.9297594001395459}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.855 u=0.0000 p_local=0.0856 f1=0.770 auprc=0.983 bytes=62774
[S2] START round=80 head_norm_before_train=2.267942 cos_to_last_merge=0.9841 (last merge round=35)
[S2] round=80 local utility u=0.132056 metrics={'f1_val': 0.7115650175151202, 'auprc': 0.7453854189481547, 'loss_val': 1.055841498075441, 'psi': 0.7250931780883341}-{'f1_val': 0.6957595586332866, 'auprc': 0.7347907648069695, 'loss_val': 1.193336316711032, 'psi': 0.7113720411027598}
[S2] not sending this round → trigger blocked (psi=0.725)
[S3] START round=80 head_norm_before_train=1.840149 cos_to_last_merge=0.9216 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9977369897576543, 'loss_val': 0.13980546314133477, 'psi': 0.9755393897502779}-{'f1_val': 0.9821044489856237, 'auprc': 0.9982997222788251, 'loss_val': 0.05723771097142419, 'psi': 0.9885825583029042}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=2.043889 cos_to_last_merge=0.9807 (last merge round=40)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9500177074915365, 'auprc': 0.9476476467019495, 'loss_val': 0.32944091203440173, 'psi': 0.9490696831757017}-{'f1_val': 0.9541482593130242, 'auprc': 0.9632223703208525, 'loss_val': 0.3283025656985366, 'psi': 0.9577779037161555}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=2.000457 cos_to_last_merge=0.9919 (last merge round=39)
[S5] round=80 local utility u=0.002355 metrics={'f1_val': 0.9967728679684698, 'auprc': 0.9980731926448838, 'loss_val': 0.028237556027371623, 'psi': 0.9972929978390354}-{'f1_val': 0.9967728679684698, 'auprc': 0.9977779695722359, 'loss_val': 0.032061749137784874, 'psi': 0.9971749086099762}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=80 head_norm_before_train=2.027153 cos_to_last_merge=0.9360 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.7545070592799797, 'auprc': 0.8320327432891662, 'loss_val': 0.5570074270218041, 'psi': 0.7855173328836543}-{'f1_val': 0.8730744668987845, 'auprc': 0.8256738121987037, 'loss_val': 0.522831794388091, 'psi': 0.8541142050187522}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.799775 cos_to_last_merge=0.9802 (last merge round=39)
[S7] round=80 local utility u=0.937420 metrics={'f1_val': 0.9104363364011947, 'auprc': 0.874858106838205, 'loss_val': 0.27295953945722623, 'psi': 0.8962050445759988}-{'f1_val': 0.6642465265066974, 'auprc': 0.8085618176101086, 'loss_val': 0.47177227637867336, 'psi': 0.7219726429480618}
[S7] not sending this round → trigger blocked (psi=0.896)
[S8] START round=80 head_norm_before_train=1.925897 cos_to_last_merge=0.9790 (last merge round=39)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9498025599597937, 'auprc': 0.9983920330683076, 'loss_val': 0.08333616313857017, 'psi': 0.9692383492031993}-{'f1_val': 0.995381897925576, 'auprc': 0.999646784339659, 'loss_val': 0.02118914749689679, 'psi': 0.9970878524912092}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.142307 cos_to_last_merge=0.9812 (last merge round=33)
[S9] round=80 local utility u=0.000051 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992164233864546, 'loss_val': 0.015881047823099827, 'psi': 0.9979483168618675}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992197681606179, 'loss_val': 0.01599380560942313, 'psi': 0.9979496547715329}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=80 head_norm_before_train=2.190067 cos_to_last_merge=0.9563 (last merge round=35)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940343980853716, 'loss_val': 0.03503787595039695, 'psi': 0.9937545530533053}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939967093472385, 'loss_val': 0.034398347614924336, 'psi': 0.993739477558052}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.400868 (no previous merge yet)
[S11] round=80 local utility u=0.001176 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.996588539337624, 'loss_val': 0.018085599558697117, 'psi': 0.996720925590797}-{'f1_val': 0.996567470639547, 'auprc': 0.9965743103315904, 'loss_val': 0.01894560113373931, 'psi': 0.9965702065163644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=80 head_norm_before_train=2.171920 (no previous merge yet)
[S13] round=80 local utility u=0.909416 metrics={'f1_val': 0.7454358127760156, 'auprc': 0.8665912533975137, 'loss_val': 1.1046850066079181, 'psi': 0.7938979890246148}-{'f1_val': 0.6179435209461985, 'auprc': 0.6688863354566135, 'loss_val': 1.56544944786983, 'psi': 0.6383206467503646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=80 head_norm_before_train=2.292511 (no previous merge yet)
[S14] round=80 local utility u=0.009096 metrics={'f1_val': 0.9947555272200395, 'auprc': 0.998580839865399, 'loss_val': 0.029110312740220492, 'psi': 0.9962856522781833}-{'f1_val': 0.9922208667565442, 'auprc': 0.9986180526972873, 'loss_val': 0.032205779348299005, 'psi': 0.9947797411328414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=80 head_norm_before_train=2.231040 cos_to_last_merge=0.9751 (last merge round=40)
[S15] round=80 local utility u=0.024433 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9910433055280354, 'loss_val': 0.3231868751300381, 'psi': 0.9381662681033182}-{'f1_val': 0.9023418808445254, 'auprc': 0.9804918251373198, 'loss_val': 0.336960357452278, 'psi': 0.9336018585616431}
[S15] not sending this round → trigger blocked (psi=0.938)
[S16] START round=80 head_norm_before_train=2.026774 cos_to_last_merge=0.9526 (last merge round=41)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.8614259928059058, 'auprc': 0.9851669106443168, 'loss_val': 0.9119046486360738, 'psi': 0.9109223599412701}-{'f1_val': 0.8675482163042344, 'auprc': 0.9850550770565295, 'loss_val': 0.8100164842127671, 'psi': 0.9145509606051525}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.382149 (no previous merge yet)
[S17] round=80 local utility u=0.615319 metrics={'f1_val': 0.8857146984157127, 'auprc': 0.995691850508971, 'loss_val': 0.47908950343113393, 'psi': 0.9297055592530161}-{'f1_val': 0.7697251763830152, 'auprc': 0.9829831222559987, 'loss_val': 0.9756649232342821, 'psi': 0.8550283547322086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=81 head_norm_before_train=2.276947 cos_to_last_merge=0.9840 (last merge round=35)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7048716156063927, 'auprc': 0.739828412916233, 'loss_val': 1.1247677750382954, 'psi': 0.7188543345303289}-{'f1_val': 0.7115650175151202, 'auprc': 0.7453854189481547, 'loss_val': 1.055841498075441, 'psi': 0.7250931780883341}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=1.845327 cos_to_last_merge=0.9209 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=81 local utility u=0.170494 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9984190587413768, 'loss_val': 0.02063518833618295, 'psi': 0.997789442091603}-{'f1_val': 0.9607409897453603, 'auprc': 0.9977369897576543, 'loss_val': 0.13980546314133477, 'psi': 0.9755393897502779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=81 head_norm_before_train=2.046459 cos_to_last_merge=0.9790 (last merge round=40)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9455653797490364, 'auprc': 0.9532771131087967, 'loss_val': 0.33062247039591075, 'psi': 0.9486500730929406}-{'f1_val': 0.9500177074915365, 'auprc': 0.9476476467019495, 'loss_val': 0.32944091203440173, 'psi': 0.9490696831757017}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.009860 cos_to_last_merge=0.9905 (last merge round=39)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9946622026764661, 'loss_val': 0.04322672283173131, 'psi': 0.9956651682487205}-{'f1_val': 0.9967728679684698, 'auprc': 0.9980731926448838, 'loss_val': 0.028237556027371623, 'psi': 0.9972929978390354}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.038441 cos_to_last_merge=0.9351 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.7808677120946682, 'auprc': 0.844636567557522, 'loss_val': 0.7533011196679724, 'psi': 0.8063752542798097}-{'f1_val': 0.7545070592799797, 'auprc': 0.8320327432891662, 'loss_val': 0.5570074270218041, 'psi': 0.7855173328836543}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.808433 cos_to_last_merge=0.9796 (last merge round=39)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6229713125634866, 'auprc': 0.8037062941146769, 'loss_val': 0.6419921863269225, 'psi': 0.6952653051839628}-{'f1_val': 0.9104363364011947, 'auprc': 0.874858106838205, 'loss_val': 0.27295953945722623, 'psi': 0.8962050445759988}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.930806 cos_to_last_merge=0.9787 (last merge round=39)
[S8] round=81 local utility u=0.077409 metrics={'f1_val': 0.9773611464556267, 'auprc': 0.9957701032265622, 'loss_val': 0.08600395262307822, 'psi': 0.9847247291640009}-{'f1_val': 0.9498025599597937, 'auprc': 0.9983920330683076, 'loss_val': 0.08333616313857017, 'psi': 0.9692383492031993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=81 head_norm_before_train=2.146845 cos_to_last_merge=0.9810 (last merge round=33)
[S9] round=81 local utility u=0.001665 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9992096978421049, 'loss_val': 0.014996497595075682, 'psi': 0.9981921695908885}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992164233864546, 'loss_val': 0.015881047823099827, 'psi': 0.9979483168618675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=81 head_norm_before_train=2.195235 cos_to_last_merge=0.9558 (last merge round=35)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9941307091373706, 'loss_val': 0.03576193831363198, 'psi': 0.9937930774741048}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940343980853716, 'loss_val': 0.03503787595039695, 'psi': 0.9937545530533053}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.403610 (no previous merge yet)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965047075564408, 'loss_val': 0.0179593771468786, 'psi': 0.9966873928783236}-{'f1_val': 0.9968091830929121, 'auprc': 0.996588539337624, 'loss_val': 0.018085599558697117, 'psi': 0.996720925590797}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=2.174176 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6263528674551543, 'auprc': 0.6792690262093132, 'loss_val': 1.4843899238974951, 'psi': 0.6475193309568179}-{'f1_val': 0.7454358127760156, 'auprc': 0.8665912533975137, 'loss_val': 1.1046850066079181, 'psi': 0.7938979890246148}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=2.293309 (no previous merge yet)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9378492043471004, 'auprc': 0.9983611319470462, 'loss_val': 0.09186658587822932, 'psi': 0.9620539753870787}-{'f1_val': 0.9947555272200395, 'auprc': 0.998580839865399, 'loss_val': 0.029110312740220492, 'psi': 0.9962856522781833}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.235762 cos_to_last_merge=0.9747 (last merge round=40)
[S15] round=81 local utility u=0.010243 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9964529086078873, 'loss_val': 0.3189304302828633, 'psi': 0.940330109335259}-{'f1_val': 0.9029149098201734, 'auprc': 0.9910433055280354, 'loss_val': 0.3231868751300381, 'psi': 0.9381662681033182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=81 head_norm_before_train=2.031071 cos_to_last_merge=0.9521 (last merge round=41)
[S16] round=81 local utility u=0.321741 metrics={'f1_val': 0.8958534343776815, 'auprc': 0.9884604223921876, 'loss_val': 0.48486781354696046, 'psi': 0.932896229583484}-{'f1_val': 0.8614259928059058, 'auprc': 0.9851669106443168, 'loss_val': 0.9119046486360738, 'psi': 0.9109223599412701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=81 head_norm_before_train=2.388572 (no previous merge yet)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.8529923538354484, 'auprc': 0.9958654154202438, 'loss_val': 0.6281426422964923, 'psi': 0.9101415784693665}-{'f1_val': 0.8857146984157127, 'auprc': 0.995691850508971, 'loss_val': 0.47908950343113393, 'psi': 0.9297055592530161}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.283424 cos_to_last_merge=0.9838 (last merge round=35)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.7012533226167608, 'auprc': 0.7451851789000167, 'loss_val': 1.1276102108509667, 'psi': 0.7188260651300631}-{'f1_val': 0.7048716156063927, 'auprc': 0.739828412916233, 'loss_val': 1.1247677750382954, 'psi': 0.7188543345303289}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=1.849569 cos_to_last_merge=0.9204 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9987949287399966, 'loss_val': 0.021417172253672387, 'psi': 0.9976929950577957}-{'f1_val': 0.9973696976584205, 'auprc': 0.9984190587413768, 'loss_val': 0.02063518833618295, 'psi': 0.997789442091603}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.053707 cos_to_last_merge=0.9785 (last merge round=40)
[S4] round=82 local utility u=0.014390 metrics={'f1_val': 0.9461864228924565, 'auprc': 0.9607503343458499, 'loss_val': 0.327987854207224, 'psi': 0.9520119874738138}-{'f1_val': 0.9455653797490364, 'auprc': 0.9532771131087967, 'loss_val': 0.33062247039591075, 'psi': 0.9486500730929406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=82 head_norm_before_train=2.017488 cos_to_last_merge=0.9891 (last merge round=39)
[S5] round=82 local utility u=0.017092 metrics={'f1_val': 0.996847640985552, 'auprc': 0.9992664391656757, 'loss_val': 0.02593923418365392, 'psi': 0.9978151602576015}-{'f1_val': 0.9963338119635569, 'auprc': 0.9946622026764661, 'loss_val': 0.04322672283173131, 'psi': 0.9956651682487205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=82 head_norm_before_train=2.050067 cos_to_last_merge=0.9341 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=82 local utility u=0.384901 metrics={'f1_val': 0.8408450192120341, 'auprc': 0.9213320189502829, 'loss_val': 0.573449642085182, 'psi': 0.8730398191073336}-{'f1_val': 0.7808677120946682, 'auprc': 0.844636567557522, 'loss_val': 0.7533011196679724, 'psi': 0.8063752542798097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=82 head_norm_before_train=1.813505 cos_to_last_merge=0.9790 (last merge round=39)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.5911557856185901, 'auprc': 0.7981764661885196, 'loss_val': 0.640212245685246, 'psi': 0.6739640578465619}-{'f1_val': 0.6229713125634866, 'auprc': 0.8037062941146769, 'loss_val': 0.6419921863269225, 'psi': 0.6952653051839628}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.933520 cos_to_last_merge=0.9785 (last merge round=39)
[S8] round=82 local utility u=0.086705 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9989360335573282, 'loss_val': 0.025800975119207786, 'psi': 0.9963619923805572}-{'f1_val': 0.9773611464556267, 'auprc': 0.9957701032265622, 'loss_val': 0.08600395262307822, 'psi': 0.9847247291640009}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=82 head_norm_before_train=2.151812 cos_to_last_merge=0.9806 (last merge round=33)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9992058509685828, 'loss_val': 0.0373440720435171, 'psi': 0.9934141533562362}-{'f1_val': 0.9975138174234109, 'auprc': 0.9992096978421049, 'loss_val': 0.014996497595075682, 'psi': 0.9981921695908885}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.201274 cos_to_last_merge=0.9553 (last merge round=35)
[S10] round=82 local utility u=0.000375 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940335870021911, 'loss_val': 0.03471991949506206, 'psi': 0.9937542286200332}-{'f1_val': 0.9935679896985945, 'auprc': 0.9941307091373706, 'loss_val': 0.03576193831363198, 'psi': 0.9937930774741048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=82 head_norm_before_train=2.407846 (no previous merge yet)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963773772920163, 'loss_val': 0.01800201040849993, 'psi': 0.9966364607725537}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965047075564408, 'loss_val': 0.0179593771468786, 'psi': 0.9966873928783236}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.174671 (no previous merge yet)
[S13] round=82 local utility u=0.183345 metrics={'f1_val': 0.6540196655537692, 'auprc': 0.7120148477881839, 'loss_val': 1.3819372580623996, 'psi': 0.6772177384475351}-{'f1_val': 0.6263528674551543, 'auprc': 0.6792690262093132, 'loss_val': 1.4843899238974951, 'psi': 0.6475193309568179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=82 head_norm_before_train=2.297320 (no previous merge yet)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9307015616088806, 'auprc': 0.9965052196579778, 'loss_val': 0.13323425293091332, 'psi': 0.9570230248285194}-{'f1_val': 0.9378492043471004, 'auprc': 0.9983611319470462, 'loss_val': 0.09186658587822932, 'psi': 0.9620539753870787}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.240421 cos_to_last_merge=0.9744 (last merge round=40)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9871496320505817, 'loss_val': 0.3304134538227998, 'psi': 0.9366087987123367}-{'f1_val': 0.9029149098201734, 'auprc': 0.9964529086078873, 'loss_val': 0.3189304302828633, 'psi': 0.940330109335259}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.035143 cos_to_last_merge=0.9515 (last merge round=41)
[S16] round=82 local utility u=0.245670 metrics={'f1_val': 0.9462291969454828, 'auprc': 0.9774295564371677, 'loss_val': 0.2626891283270228, 'psi': 0.9587093407421567}-{'f1_val': 0.8958534343776815, 'auprc': 0.9884604223921876, 'loss_val': 0.48486781354696046, 'psi': 0.932896229583484}
[S16] not sending this round → trigger blocked (psi=0.959)
[S17] START round=82 head_norm_before_train=2.389411 (no previous merge yet)
[S17] round=82 local utility u=0.317081 metrics={'f1_val': 0.9105330286513509, 'auprc': 0.9988960249836505, 'loss_val': 0.3483172882689228, 'psi': 0.9458782271842707}-{'f1_val': 0.8529923538354484, 'auprc': 0.9958654154202438, 'loss_val': 0.6281426422964923, 'psi': 0.9101415784693665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=83 head_norm_before_train=2.292182 cos_to_last_merge=0.9836 (last merge round=35)
[S2] round=83 local utility u=0.090704 metrics={'f1_val': 0.7135750364873399, 'auprc': 0.7480959345147113, 'loss_val': 1.0288655728465321, 'psi': 0.7273833956982885}-{'f1_val': 0.7012533226167608, 'auprc': 0.7451851789000167, 'loss_val': 1.1276102108509667, 'psi': 0.7188260651300631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=83 head_norm_before_train=1.854389 cos_to_last_merge=0.9198 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9980101252546512, 'loss_val': 0.14941587384012464, 'psi': 0.9758015025815621}-{'f1_val': 0.9969583726029951, 'auprc': 0.9987949287399966, 'loss_val': 0.021417172253672387, 'psi': 0.9976929950577957}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.061398 cos_to_last_merge=0.9771 (last merge round=40)
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9433045310147348, 'auprc': 0.9537061272689235, 'loss_val': 0.3356368648766225, 'psi': 0.9474651695164102}-{'f1_val': 0.9461864228924565, 'auprc': 0.9607503343458499, 'loss_val': 0.327987854207224, 'psi': 0.9520119874738138}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=2.027060 cos_to_last_merge=0.9882 (last merge round=39)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.993157346399713, 'loss_val': 0.035554303120601614, 'psi': 0.9950632257380192}-{'f1_val': 0.996847640985552, 'auprc': 0.9992664391656757, 'loss_val': 0.02593923418365392, 'psi': 0.9978151602576015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.060669 cos_to_last_merge=0.9333 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=83 local utility u=0.719565 metrics={'f1_val': 0.9845262086475067, 'auprc': 0.9499286666412139, 'loss_val': 0.08219768670033321, 'psi': 0.9706871918449895}-{'f1_val': 0.8408450192120341, 'auprc': 0.9213320189502829, 'loss_val': 0.573449642085182, 'psi': 0.8730398191073336}
[S6] not sending this round → trigger blocked (psi=0.971)
[S7] START round=83 head_norm_before_train=1.816736 cos_to_last_merge=0.9785 (last merge round=39)
[S7] round=83 local utility u=0.538836 metrics={'f1_val': 0.6727399533464143, 'auprc': 0.8919154128546933, 'loss_val': 0.3332621962132116, 'psi': 0.7604101371497259}-{'f1_val': 0.5911557856185901, 'auprc': 0.7981764661885196, 'loss_val': 0.640212245685246, 'psi': 0.6739640578465619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=83 head_norm_before_train=1.938967 cos_to_last_merge=0.9781 (last merge round=39)
[S8] round=83 local utility u=0.001088 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9995550516672869, 'loss_val': 0.023280093994614743, 'psi': 0.9963893250183328}-{'f1_val': 0.9946459649293765, 'auprc': 0.9989360335573282, 'loss_val': 0.025800975119207786, 'psi': 0.9963619923805572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=83 head_norm_before_train=2.156657 cos_to_last_merge=0.9803 (last merge round=33)
[S9] round=83 local utility u=0.034322 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995934573230814, 'loss_val': 0.015163117730356147, 'psi': 0.9980991304365182}-{'f1_val': 0.9895530216146718, 'auprc': 0.9992058509685828, 'loss_val': 0.0373440720435171, 'psi': 0.9934141533562362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=83 head_norm_before_train=2.205420 cos_to_last_merge=0.9549 (last merge round=35)
[S10] round=83 local utility u=0.000984 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9939595347385297, 'loss_val': 0.03384474520153875, 'psi': 0.9938560870402249}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940335870021911, 'loss_val': 0.03471991949506206, 'psi': 0.9937542286200332}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=83 head_norm_before_train=2.412961 (no previous merge yet)
[S11] round=83 local utility u=0.000137 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965025433349596, 'loss_val': 0.018103975053417005, 'psi': 0.9966865271897312}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963773772920163, 'loss_val': 0.01800201040849993, 'psi': 0.9966364607725537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=83 head_norm_before_train=2.178661 (no previous merge yet)
[S13] round=83 local utility u=0.635127 metrics={'f1_val': 0.7303668541003655, 'auprc': 0.9028071078721246, 'loss_val': 1.1421434106337365, 'psi': 0.7993429556090692}-{'f1_val': 0.6540196655537692, 'auprc': 0.7120148477881839, 'loss_val': 1.3819372580623996, 'psi': 0.6772177384475351}
[S13] not sending this round → trigger blocked (psi=0.799)
[S14] START round=83 head_norm_before_train=2.298124 (no previous merge yet)
[S14] round=83 local utility u=0.032306 metrics={'f1_val': 0.9378759140714694, 'auprc': 0.9974024862980534, 'loss_val': 0.11435942211574462, 'psi': 0.961686542962103}-{'f1_val': 0.9307015616088806, 'auprc': 0.9965052196579778, 'loss_val': 0.13323425293091332, 'psi': 0.9570230248285194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=83 head_norm_before_train=2.244999 cos_to_last_merge=0.9741 (last merge round=40)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.901767609170308, 'auprc': 0.9769026601095305, 'loss_val': 0.35341722521234686, 'psi': 0.9318216295459969}-{'f1_val': 0.9029149098201734, 'auprc': 0.9871496320505817, 'loss_val': 0.3304134538227998, 'psi': 0.9366087987123367}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.037892 cos_to_last_merge=0.9514 (last merge round=41)
[S16] round=83 local utility u=0.269165 metrics={'f1_val': 0.9927306099290307, 'auprc': 0.9881419235368007, 'loss_val': 0.035504274644060106, 'psi': 0.9908951353721387}-{'f1_val': 0.9462291969454828, 'auprc': 0.9774295564371677, 'loss_val': 0.2626891283270228, 'psi': 0.9587093407421567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=83 head_norm_before_train=2.395703 (no previous merge yet)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.9001634059846897, 'auprc': 0.9971198641883765, 'loss_val': 0.41915911146456536, 'psi': 0.9389459892661645}-{'f1_val': 0.9105330286513509, 'auprc': 0.9988960249836505, 'loss_val': 0.3483172882689228, 'psi': 0.9458782271842707}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.296064 cos_to_last_merge=0.9833 (last merge round=35)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.6985205724824917, 'auprc': 0.740169672191026, 'loss_val': 1.1642875644996307, 'psi': 0.7151802123659055}-{'f1_val': 0.7135750364873399, 'auprc': 0.7480959345147113, 'loss_val': 1.0288655728465321, 'psi': 0.7273833956982885}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=1.859450 cos_to_last_merge=0.9192 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=84 local utility u=0.163180 metrics={'f1_val': 0.9945859307742341, 'auprc': 0.9982884824026863, 'loss_val': 0.02543236213868385, 'psi': 0.996066951425615}-{'f1_val': 0.960995754132836, 'auprc': 0.9980101252546512, 'loss_val': 0.14941587384012464, 'psi': 0.9758015025815621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=84 head_norm_before_train=2.071980 cos_to_last_merge=0.9766 (last merge round=40)
[S4] round=84 local utility u=0.032932 metrics={'f1_val': 0.9515505672959393, 'auprc': 0.9574517058411769, 'loss_val': 0.33048628049751577, 'psi': 0.9539110227140344}-{'f1_val': 0.9433045310147348, 'auprc': 0.9537061272689235, 'loss_val': 0.3356368648766225, 'psi': 0.9474651695164102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=84 head_norm_before_train=2.037215 cos_to_last_merge=0.9874 (last merge round=39)
[S5] round=84 local utility u=0.015413 metrics={'f1_val': 0.996847640985552, 'auprc': 0.9987327086116639, 'loss_val': 0.024537773383132042, 'psi': 0.9976016680359967}-{'f1_val': 0.9963338119635569, 'auprc': 0.993157346399713, 'loss_val': 0.035554303120601614, 'psi': 0.9950632257380192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=84 head_norm_before_train=2.072166 cos_to_last_merge=0.9325 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.7826976038390446, 'auprc': 0.8421417245267364, 'loss_val': 0.8560620527434066, 'psi': 0.8064752521141214}-{'f1_val': 0.9845262086475067, 'auprc': 0.9499286666412139, 'loss_val': 0.08219768670033321, 'psi': 0.9706871918449895}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.820058 cos_to_last_merge=0.9782 (last merge round=39)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6563204888672286, 'auprc': 0.8635500502089991, 'loss_val': 0.3670773380922905, 'psi': 0.7392123134039368}-{'f1_val': 0.6727399533464143, 'auprc': 0.8919154128546933, 'loss_val': 0.3332621962132116, 'psi': 0.7604101371497259}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.947102 cos_to_last_merge=0.9777 (last merge round=39)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.972612076975693, 'auprc': 0.9989831436473062, 'loss_val': 0.07248546240230717, 'psi': 0.9831605036443383}-{'f1_val': 0.9942788405856967, 'auprc': 0.9995550516672869, 'loss_val': 0.023280093994614743, 'psi': 0.9963893250183328}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=2.161664 cos_to_last_merge=0.9799 (last merge round=33)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9995930394867986, 'loss_val': 0.015385026572600023, 'psi': 0.9981178949533543}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995934573230814, 'loss_val': 0.015163117730356147, 'psi': 0.9980991304365182}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.210073 cos_to_last_merge=0.9545 (last merge round=35)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940345738622258, 'loss_val': 0.035376796994235016, 'psi': 0.993754623364047}-{'f1_val': 0.9937871219080217, 'auprc': 0.9939595347385297, 'loss_val': 0.03384474520153875, 'psi': 0.9938560870402249}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.413790 (no previous merge yet)
[S11] round=84 local utility u=0.000029 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965274532497608, 'loss_val': 0.01812014658262707, 'psi': 0.9966964911556516}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965025433349596, 'loss_val': 0.018103975053417005, 'psi': 0.9966865271897312}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=84 head_norm_before_train=2.181063 (no previous merge yet)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.7132465988786643, 'auprc': 0.8176872831022151, 'loss_val': 1.0664182205496955, 'psi': 0.7550228725680845}-{'f1_val': 0.7303668541003655, 'auprc': 0.9028071078721246, 'loss_val': 1.1421434106337365, 'psi': 0.7993429556090692}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=2.299770 (no previous merge yet)
[S14] round=84 local utility u=0.015672 metrics={'f1_val': 0.9390599114177984, 'auprc': 0.9985867802581176, 'loss_val': 0.09367172498819791, 'psi': 0.9628706589539261}-{'f1_val': 0.9378759140714694, 'auprc': 0.9974024862980534, 'loss_val': 0.11435942211574462, 'psi': 0.961686542962103}
[S14] not sending this round → trigger blocked (psi=0.963)
[S15] START round=84 head_norm_before_train=2.249482 cos_to_last_merge=0.9738 (last merge round=40)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9011920887978451, 'auprc': 0.9722986228564489, 'loss_val': 0.36615251970326046, 'psi': 0.9296347024212867}-{'f1_val': 0.901767609170308, 'auprc': 0.9769026601095305, 'loss_val': 0.35341722521234686, 'psi': 0.9318216295459969}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.040671 cos_to_last_merge=0.9512 (last merge round=41)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.993119053659016, 'auprc': 0.985943778330202, 'loss_val': 0.03950896502352475, 'psi': 0.9902489435274904}-{'f1_val': 0.9927306099290307, 'auprc': 0.9881419235368007, 'loss_val': 0.035504274644060106, 'psi': 0.9908951353721387}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=2.402697 (no previous merge yet)
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.880200872621141, 'auprc': 0.9964400140739864, 'loss_val': 0.5549062195901773, 'psi': 0.9266965292022792}-{'f1_val': 0.9001634059846897, 'auprc': 0.9971198641883765, 'loss_val': 0.41915911146456536, 'psi': 0.9389459892661645}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.300401 cos_to_last_merge=0.9830 (last merge round=35)
[S2] round=85 local utility u=0.058451 metrics={'f1_val': 0.7065885047631691, 'auprc': 0.7429646151149754, 'loss_val': 1.1041776941268109, 'psi': 0.7211389489038916}-{'f1_val': 0.6985205724824917, 'auprc': 0.740169672191026, 'loss_val': 1.1642875644996307, 'psi': 0.7151802123659055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=85 head_norm_before_train=1.864534 cos_to_last_merge=0.9185 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=85 local utility u=0.009745 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.998546553659597, 'loss_val': 0.020950239365059006, 'psi': 0.997593645025636}-{'f1_val': 0.9945859307742341, 'auprc': 0.9982884824026863, 'loss_val': 0.02543236213868385, 'psi': 0.996066951425615}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=85 head_norm_before_train=2.077892 cos_to_last_merge=0.9764 (last merge round=40)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9523862882170782, 'auprc': 0.9299009607791647, 'loss_val': 0.3406327267991122, 'psi': 0.9433921572419127}-{'f1_val': 0.9515505672959393, 'auprc': 0.9574517058411769, 'loss_val': 0.33048628049751577, 'psi': 0.9539110227140344}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=2.047306 cos_to_last_merge=0.9865 (last merge round=39)
[S5] round=85 local utility u=0.002236 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9993958873213907, 'loss_val': 0.023815730958205217, 'psi': 0.9980429721293314}-{'f1_val': 0.996847640985552, 'auprc': 0.9987327086116639, 'loss_val': 0.024537773383132042, 'psi': 0.9976016680359967}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=85 head_norm_before_train=2.085566 cos_to_last_merge=0.9315 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=85 local utility u=0.665019 metrics={'f1_val': 0.9156799847607567, 'auprc': 0.8599310895945953, 'loss_val': 0.3772867905721837, 'psi': 0.8933804266942922}-{'f1_val': 0.7826976038390446, 'auprc': 0.8421417245267364, 'loss_val': 0.8560620527434066, 'psi': 0.8064752521141214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=85 head_norm_before_train=1.823643 cos_to_last_merge=0.9780 (last merge round=39)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.6262493533351153, 'auprc': 0.8067334056744385, 'loss_val': 0.5540609697471576, 'psi': 0.6984429742708447}-{'f1_val': 0.6563204888672286, 'auprc': 0.8635500502089991, 'loss_val': 0.3670773380922905, 'psi': 0.7392123134039368}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=1.955154 cos_to_last_merge=0.9773 (last merge round=39)
[S8] round=85 local utility u=0.092231 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9995936498370089, 'loss_val': 0.022058593291384154, 'psi': 0.9966250388924295}-{'f1_val': 0.972612076975693, 'auprc': 0.9989831436473062, 'loss_val': 0.07248546240230717, 'psi': 0.9831605036443383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=85 head_norm_before_train=2.164258 cos_to_last_merge=0.9797 (last merge round=33)
[S9] round=85 local utility u=0.000025 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995899014549161, 'loss_val': 0.015137056278995944, 'psi': 0.9980977080892521}-{'f1_val': 0.9971344652643916, 'auprc': 0.9995930394867986, 'loss_val': 0.015385026572600023, 'psi': 0.9981178949533543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=85 head_norm_before_train=2.215727 cos_to_last_merge=0.9540 (last merge round=35)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9941159076005655, 'loss_val': 0.035880983424206314, 'psi': 0.9937871568593828}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940345738622258, 'loss_val': 0.035376796994235016, 'psi': 0.993754623364047}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.416993 (no previous merge yet)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9958465516992466, 'auprc': 0.9965112502785294, 'loss_val': 0.020416440346274888, 'psi': 0.9961124311309597}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965274532497608, 'loss_val': 0.01812014658262707, 'psi': 0.9966964911556516}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.182451 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.656083058912315, 'auprc': 0.9495446676806913, 'loss_val': 1.2935113316438678, 'psi': 0.7734677024196656}-{'f1_val': 0.7132465988786643, 'auprc': 0.8176872831022151, 'loss_val': 1.0664182205496955, 'psi': 0.7550228725680845}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.301013 (no previous merge yet)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9375875816452307, 'auprc': 0.9986191527891254, 'loss_val': 0.09751138348419706, 'psi': 0.9620002101027885}-{'f1_val': 0.9390599114177984, 'auprc': 0.9985867802581176, 'loss_val': 0.09367172498819791, 'psi': 0.9628706589539261}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.253863 cos_to_last_merge=0.9735 (last merge round=40)
[S15] round=85 local utility u=0.005872 metrics={'f1_val': 0.9011920887978451, 'auprc': 0.9747148363828462, 'loss_val': 0.3616568946908045, 'psi': 0.9306011878318455}-{'f1_val': 0.9011920887978451, 'auprc': 0.9722986228564489, 'loss_val': 0.36615251970326046, 'psi': 0.9296347024212867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=85 head_norm_before_train=2.043318 cos_to_last_merge=0.9507 (last merge round=41)
[S16] round=85 local utility u=0.006546 metrics={'f1_val': 0.9928762148967827, 'auprc': 0.989451334456517, 'loss_val': 0.035483000303962564, 'psi': 0.9915062627206764}-{'f1_val': 0.993119053659016, 'auprc': 0.985943778330202, 'loss_val': 0.03950896502352475, 'psi': 0.9902489435274904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=85 head_norm_before_train=2.404304 (no previous merge yet)
[S17] round=85 local utility u=0.200926 metrics={'f1_val': 0.9105330286513509, 'auprc': 0.9965915900600391, 'loss_val': 0.3355026607645743, 'psi': 0.9449564532148261}-{'f1_val': 0.880200872621141, 'auprc': 0.9964400140739864, 'loss_val': 0.5549062195901773, 'psi': 0.9266965292022792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=86 head_norm_before_train=2.303524 cos_to_last_merge=0.9827 (last merge round=35)
[S2] round=86 local utility u=0.007348 metrics={'f1_val': 0.7078399488025764, 'auprc': 0.7418582234943483, 'loss_val': 1.0936714827952632, 'psi': 0.721447258679285}-{'f1_val': 0.7065885047631691, 'auprc': 0.7429646151149754, 'loss_val': 1.1041776941268109, 'psi': 0.7211389489038916}
[S2] not sending this round → trigger blocked (psi=0.721)
[S3] START round=86 head_norm_before_train=1.868353 cos_to_last_merge=0.9180 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.993522284594175, 'auprc': 0.9980461894161781, 'loss_val': 0.030446233673230818, 'psi': 0.9953318465229761}-{'f1_val': 0.9969583726029951, 'auprc': 0.998546553659597, 'loss_val': 0.020950239365059006, 'psi': 0.997593645025636}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=2.085068 cos_to_last_merge=0.9766 (last merge round=40)
[S4] round=86 local utility u=0.045910 metrics={'f1_val': 0.9546143604691215, 'auprc': 0.953423977734326, 'loss_val': 0.3327501167898714, 'psi': 0.9541382073752034}-{'f1_val': 0.9523862882170782, 'auprc': 0.9299009607791647, 'loss_val': 0.3406327267991122, 'psi': 0.9433921572419127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=86 head_norm_before_train=2.055677 cos_to_last_merge=0.9855 (last merge round=39)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.996847640985552, 'auprc': 0.9983428993324344, 'loss_val': 0.026352561631764485, 'psi': 0.997445744324305}-{'f1_val': 0.9971410286679584, 'auprc': 0.9993958873213907, 'loss_val': 0.023815730958205217, 'psi': 0.9980429721293314}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.097421 cos_to_last_merge=0.9306 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=86 local utility u=0.364602 metrics={'f1_val': 0.9573883241789067, 'auprc': 0.9415466394221901, 'loss_val': 0.1431801215564036, 'psi': 0.9510516502762201}-{'f1_val': 0.9156799847607567, 'auprc': 0.8599310895945953, 'loss_val': 0.3772867905721837, 'psi': 0.8933804266942922}
[S6] not sending this round → trigger blocked (psi=0.951)
[S7] START round=86 head_norm_before_train=1.827808 cos_to_last_merge=0.9777 (last merge round=39)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6100825715793935, 'auprc': 0.7999086959489398, 'loss_val': 0.5756886803234172, 'psi': 0.686013021327212}-{'f1_val': 0.6262493533351153, 'auprc': 0.8067334056744385, 'loss_val': 0.5540609697471576, 'psi': 0.6984429742708447}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.962701 cos_to_last_merge=0.9768 (last merge round=39)
[S8] round=86 local utility u=0.002143 metrics={'f1_val': 0.9955298311535434, 'auprc': 0.9986002072694885, 'loss_val': 0.020094999439542485, 'psi': 0.9967579815999215}-{'f1_val': 0.9946459649293765, 'auprc': 0.9995936498370089, 'loss_val': 0.022058593291384154, 'psi': 0.9966250388924295}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=86 head_norm_before_train=2.167318 cos_to_last_merge=0.9795 (last merge round=33)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.9991978169741871, 'loss_val': 0.04857161339869652, 'psi': 0.9921352749770675}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995899014549161, 'loss_val': 0.015137056278995944, 'psi': 0.9980977080892521}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.219241 cos_to_last_merge=0.9536 (last merge round=35)
[S10] round=86 local utility u=0.000442 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940226044644958, 'loss_val': 0.03471609884366734, 'psi': 0.993749835604955}-{'f1_val': 0.9935679896985945, 'auprc': 0.9941159076005655, 'loss_val': 0.035880983424206314, 'psi': 0.9937871568593828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=86 head_norm_before_train=2.419682 (no previous merge yet)
[S11] round=86 local utility u=0.002265 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964727171773388, 'loss_val': 0.019973381776537992, 'psi': 0.9965172895790892}-{'f1_val': 0.9958465516992466, 'auprc': 0.9965112502785294, 'loss_val': 0.020416440346274888, 'psi': 0.9961124311309597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=86 head_norm_before_train=2.187532 (no previous merge yet)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.5878204962125567, 'auprc': 0.6299646555294367, 'loss_val': 1.584600216078317, 'psi': 0.6046781599393087}-{'f1_val': 0.656083058912315, 'auprc': 0.9495446676806913, 'loss_val': 1.2935113316438678, 'psi': 0.7734677024196656}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.306161 (no previous merge yet)
[S14] round=86 local utility u=0.002853 metrics={'f1_val': 0.9378885278627557, 'auprc': 0.9986193336867533, 'loss_val': 0.0936117028705567, 'psi': 0.9621808501923547}-{'f1_val': 0.9375875816452307, 'auprc': 0.9986191527891254, 'loss_val': 0.09751138348419706, 'psi': 0.9620002101027885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=86 head_norm_before_train=2.258206 cos_to_last_merge=0.9732 (last merge round=40)
[S15] round=86 local utility u=0.000533 metrics={'f1_val': 0.9011920887978451, 'auprc': 0.9749847604276975, 'loss_val': 0.3614011883174498, 'psi': 0.9307091574497861}-{'f1_val': 0.9011920887978451, 'auprc': 0.9747148363828462, 'loss_val': 0.3616568946908045, 'psi': 0.9306011878318455}
[S15] not sending this round → trigger blocked (psi=0.931)
[S16] START round=86 head_norm_before_train=2.048402 cos_to_last_merge=0.9502 (last merge round=41)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9917058863313349, 'auprc': 0.9797698122914111, 'loss_val': 0.051081061165018864, 'psi': 0.9869314567153654}-{'f1_val': 0.9928762148967827, 'auprc': 0.989451334456517, 'loss_val': 0.035483000303962564, 'psi': 0.9915062627206764}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.406912 (no previous merge yet)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8856829110248492, 'auprc': 0.9857933468845897, 'loss_val': 0.46352763518278034, 'psi': 0.9257270853687454}-{'f1_val': 0.9105330286513509, 'auprc': 0.9965915900600391, 'loss_val': 0.3355026607645743, 'psi': 0.9449564532148261}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.305839 cos_to_last_merge=0.9823 (last merge round=35)
[S2] round=87 local utility u=0.079872 metrics={'f1_val': 0.7194452634848689, 'auprc': 0.7478818106291568, 'loss_val': 1.0216306252291285, 'psi': 0.730819882342584}-{'f1_val': 0.7078399488025764, 'auprc': 0.7418582234943483, 'loss_val': 1.0936714827952632, 'psi': 0.721447258679285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=87 head_norm_before_train=1.871558 cos_to_last_merge=0.9176 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9983987797868925, 'loss_val': 0.10735802497273872, 'psi': 0.9760823189465042}-{'f1_val': 0.993522284594175, 'auprc': 0.9980461894161781, 'loss_val': 0.030446233673230818, 'psi': 0.9953318465229761}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.081790 cos_to_last_merge=0.9754 (last merge round=40)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9429043933493808, 'auprc': 0.9668265910598581, 'loss_val': 0.3425986674498665, 'psi': 0.9524732724335718}-{'f1_val': 0.9546143604691215, 'auprc': 0.953423977734326, 'loss_val': 0.3327501167898714, 'psi': 0.9541382073752034}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=2.059881 cos_to_last_merge=0.9844 (last merge round=39)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9989753501653765, 'loss_val': 0.03134106191217973, 'psi': 0.9976113211532252}-{'f1_val': 0.996847640985552, 'auprc': 0.9983428993324344, 'loss_val': 0.026352561631764485, 'psi': 0.997445744324305}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.107166 cos_to_last_merge=0.9299 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.7606810122167031, 'auprc': 0.8690466515176112, 'loss_val': 0.980485844655982, 'psi': 0.8040272679370664}-{'f1_val': 0.9573883241789067, 'auprc': 0.9415466394221901, 'loss_val': 0.1431801215564036, 'psi': 0.9510516502762201}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.831931 cos_to_last_merge=0.9772 (last merge round=39)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.587471420643438, 'auprc': 0.7957821483641674, 'loss_val': 0.7160969366818488, 'psi': 0.6707957117317298}-{'f1_val': 0.6100825715793935, 'auprc': 0.7999086959489398, 'loss_val': 0.5756886803234172, 'psi': 0.686013021327212}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=1.967605 cos_to_last_merge=0.9765 (last merge round=39)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9997325469108423, 'loss_val': 0.023198434374202683, 'psi': 0.9963276414359743}-{'f1_val': 0.9955298311535434, 'auprc': 0.9986002072694885, 'loss_val': 0.020094999439542485, 'psi': 0.9967579815999215}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.168007 cos_to_last_merge=0.9797 (last merge round=33)
[S9] round=87 local utility u=0.046664 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999596964564828, 'loss_val': 0.014497473836291306, 'psi': 0.9981005333332169}-{'f1_val': 0.9874269136456545, 'auprc': 0.9991978169741871, 'loss_val': 0.04857161339869652, 'psi': 0.9921352749770675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=87 head_norm_before_train=2.223918 cos_to_last_merge=0.9532 (last merge round=35)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940162605045133, 'loss_val': 0.03486883399075429, 'psi': 0.993747298020962}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940226044644958, 'loss_val': 0.03471609884366734, 'psi': 0.993749835604955}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.423622 (no previous merge yet)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964195913322019, 'loss_val': 0.020523940400573492, 'psi': 0.9964960392410345}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964727171773388, 'loss_val': 0.019973381776537992, 'psi': 0.9965172895790892}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=2.190922 (no previous merge yet)
[S13] round=87 local utility u=0.131304 metrics={'f1_val': 0.6130903177711612, 'auprc': 0.6648304333251632, 'loss_val': 1.57820921203596, 'psi': 0.633786363992762}-{'f1_val': 0.5878204962125567, 'auprc': 0.6299646555294367, 'loss_val': 1.584600216078317, 'psi': 0.6046781599393087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=87 head_norm_before_train=2.307971 (no previous merge yet)
[S14] round=87 local utility u=0.106225 metrics={'f1_val': 0.9672896407833405, 'auprc': 0.9983387568560107, 'loss_val': 0.056726753336996255, 'psi': 0.9797092872124085}-{'f1_val': 0.9378885278627557, 'auprc': 0.9986193336867533, 'loss_val': 0.0936117028705567, 'psi': 0.9621808501923547}
[S14] not sending this round → trigger blocked (psi=0.980)
[S15] START round=87 head_norm_before_train=2.262514 cos_to_last_merge=0.9729 (last merge round=40)
[S15] round=87 local utility u=0.007878 metrics={'f1_val': 0.901767609170308, 'auprc': 0.9776669855271476, 'loss_val': 0.3571454943557875, 'psi': 0.9321273597130437}-{'f1_val': 0.9011920887978451, 'auprc': 0.9749847604276975, 'loss_val': 0.3614011883174498, 'psi': 0.9307091574497861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=87 head_norm_before_train=2.053984 cos_to_last_merge=0.9497 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=87 local utility u=0.017688 metrics={'f1_val': 0.992338677963146, 'auprc': 0.9857818024323833, 'loss_val': 0.03753688612931525, 'psi': 0.9897159277508409}-{'f1_val': 0.9917058863313349, 'auprc': 0.9797698122914111, 'loss_val': 0.051081061165018864, 'psi': 0.9869314567153654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=87 head_norm_before_train=2.413064 (no previous merge yet)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.844790527426331, 'auprc': 0.9816823552683791, 'loss_val': 0.6092962869512132, 'psi': 0.8995472585631503}-{'f1_val': 0.8856829110248492, 'auprc': 0.9857933468845897, 'loss_val': 0.46352763518278034, 'psi': 0.9257270853687454}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.310544 cos_to_last_merge=0.9820 (last merge round=35)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7078799423039853, 'auprc': 0.745849441254634, 'loss_val': 1.1052351584110556, 'psi': 0.7230677418842448}-{'f1_val': 0.7194452634848689, 'auprc': 0.7478818106291568, 'loss_val': 1.0216306252291285, 'psi': 0.730819882342584}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=1.875946 cos_to_last_merge=0.9170 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9227526302703265, 'auprc': 0.9828245755049043, 'loss_val': 0.22039819999706411, 'psi': 0.9467814083641577}-{'f1_val': 0.9612046783862453, 'auprc': 0.9983987797868925, 'loss_val': 0.10735802497273872, 'psi': 0.9760823189465042}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.088190 cos_to_last_merge=0.9751 (last merge round=40)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.6349656405026154, 'auprc': 0.9456072809309684, 'loss_val': 0.6445944011869401, 'psi': 0.7592222966739566}-{'f1_val': 0.9429043933493808, 'auprc': 0.9668265910598581, 'loss_val': 0.3425986674498665, 'psi': 0.9524732724335718}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=2.067826 cos_to_last_merge=0.9838 (last merge round=39)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9980553773156362, 'loss_val': 0.032391289180972435, 'psi': 0.9971098390978925}-{'f1_val': 0.9967019684784577, 'auprc': 0.9989753501653765, 'loss_val': 0.03134106191217973, 'psi': 0.9976113211532252}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.114315 cos_to_last_merge=0.9293 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=88 local utility u=0.586692 metrics={'f1_val': 0.8431919908694466, 'auprc': 0.9321339572620513, 'loss_val': 0.491430560062348, 'psi': 0.8787687774264885}-{'f1_val': 0.7606810122167031, 'auprc': 0.8690466515176112, 'loss_val': 0.980485844655982, 'psi': 0.8040272679370664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] sending update (kind=head size=1790 to 1 peers)
[S7] START round=88 head_norm_before_train=1.836377 cos_to_last_merge=0.9769 (last merge round=39)
[S7] round=88 local utility u=1.000000 metrics={'f1_val': 0.8778359792312445, 'auprc': 0.8797212018221077, 'loss_val': 0.26218692476711597, 'psi': 0.8785900682675898}-{'f1_val': 0.587471420643438, 'auprc': 0.7957821483641674, 'loss_val': 0.7160969366818488, 'psi': 0.6707957117317298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=88 head_norm_before_train=1.975289 cos_to_last_merge=0.9760 (last merge round=39)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9997438766303007, 'loss_val': 0.026921715770085813, 'psi': 0.9963321733237577}-{'f1_val': 0.994057704452729, 'auprc': 0.9997325469108423, 'loss_val': 0.023198434374202683, 'psi': 0.9963276414359743}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.168612 cos_to_last_merge=0.9797 (last merge round=33)
[S9] round=88 local utility u=0.000166 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9995969645648282, 'loss_val': 0.014354746885663624, 'psi': 0.9981194649845662}-{'f1_val': 0.9971029125121428, 'auprc': 0.999596964564828, 'loss_val': 0.014497473836291306, 'psi': 0.9981005333332169}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=88 head_norm_before_train=2.229481 cos_to_last_merge=0.9527 (last merge round=35)
[S10] round=88 local utility u=0.000141 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940335018582024, 'loss_val': 0.034637701665222655, 'psi': 0.9937541945624376}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940162605045133, 'loss_val': 0.03486883399075429, 'psi': 0.993747298020962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=88 head_norm_before_train=2.428323 (no previous merge yet)
[S11] round=88 local utility u=0.000160 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9964154262805156, 'loss_val': 0.020190952167217745, 'psi': 0.9964943732203599}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964195913322019, 'loss_val': 0.020523940400573492, 'psi': 0.9964960392410345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=88 head_norm_before_train=2.191189 (no previous merge yet)
[S13] round=88 local utility u=0.044350 metrics={'f1_val': 0.616035111636396, 'auprc': 0.6710819138667892, 'loss_val': 1.5259333298678999, 'psi': 0.6380538325285533}-{'f1_val': 0.6130903177711612, 'auprc': 0.6648304333251632, 'loss_val': 1.57820921203596, 'psi': 0.633786363992762}
[S13] not sending this round → trigger blocked (psi=0.638)
[S14] START round=88 head_norm_before_train=2.308147 (no previous merge yet)
[S14] round=88 local utility u=0.081964 metrics={'f1_val': 0.9911757130856568, 'auprc': 0.9983701880129332, 'loss_val': 0.0362097864391814, 'psi': 0.9940535030565674}-{'f1_val': 0.9672896407833405, 'auprc': 0.9983387568560107, 'loss_val': 0.056726753336996255, 'psi': 0.9797092872124085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=88 head_norm_before_train=2.266804 cos_to_last_merge=0.9726 (last merge round=40)
[S15] round=88 local utility u=0.004947 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9788731031404008, 'loss_val': 0.35431524458507047, 'psi': 0.9329543697628755}-{'f1_val': 0.901767609170308, 'auprc': 0.9776669855271476, 'loss_val': 0.3571454943557875, 'psi': 0.9321273597130437}
[S15] not sending this round → trigger blocked (psi=0.933)
[S16] START round=88 head_norm_before_train=2.058898 cos_to_last_merge=0.9493 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=88 local utility u=0.003512 metrics={'f1_val': 0.9934354295572134, 'auprc': 0.9846434015244361, 'loss_val': 0.03367876440433653, 'psi': 0.9899186183441024}-{'f1_val': 0.992338677963146, 'auprc': 0.9857818024323833, 'loss_val': 0.03753688612931525, 'psi': 0.9897159277508409}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=88 head_norm_before_train=2.419745 (no previous merge yet)
[S17] round=88 local utility u=0.014940 metrics={'f1_val': 0.8537469847640275, 'auprc': 0.9849237925237497, 'loss_val': 0.6428793996283263, 'psi': 0.9062177078679164}-{'f1_val': 0.844790527426331, 'auprc': 0.9816823552683791, 'loss_val': 0.6092962869512132, 'psi': 0.8995472585631503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S17] sending update (kind=head size=1785 to 1 peers)
[S2] START round=89 head_norm_before_train=2.314919 cos_to_last_merge=0.9818 (last merge round=35)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.6755979181748522, 'auprc': 0.7348076002857719, 'loss_val': 1.435756480878651, 'psi': 0.6992817910192201}-{'f1_val': 0.7078799423039853, 'auprc': 0.745849441254634, 'loss_val': 1.1052351584110556, 'psi': 0.7230677418842448}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=1.881181 cos_to_last_merge=0.9164 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=89 local utility u=0.261877 metrics={'f1_val': 0.9781920940903774, 'auprc': 0.9986483251034302, 'loss_val': 0.0767524564311839, 'psi': 0.9863745864955986}-{'f1_val': 0.9227526302703265, 'auprc': 0.9828245755049043, 'loss_val': 0.22039819999706411, 'psi': 0.9467814083641577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=89 head_norm_before_train=2.091571 cos_to_last_merge=0.9744 (last merge round=40)
[S4] round=89 local utility u=1.000000 metrics={'f1_val': 0.9543730620173625, 'auprc': 0.963271585925794, 'loss_val': 0.3312499921794529, 'psi': 0.957932471580735}-{'f1_val': 0.6349656405026154, 'auprc': 0.9456072809309684, 'loss_val': 0.6445944011869401, 'psi': 0.7592222966739566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=89 head_norm_before_train=2.075028 cos_to_last_merge=0.9834 (last merge round=39)
[S5] round=89 local utility u=0.008608 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9994530141403345, 'loss_val': 0.023338445579694188, 'psi': 0.9980658228569088}-{'f1_val': 0.9964794802860635, 'auprc': 0.9980553773156362, 'loss_val': 0.032391289180972435, 'psi': 0.9971098390978925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=89 head_norm_before_train=2.119945 cos_to_last_merge=0.9288 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.7585202119586654, 'auprc': 0.840085246306717, 'loss_val': 0.9409332636922911, 'psi': 0.7911462256978861}-{'f1_val': 0.8431919908694466, 'auprc': 0.9321339572620513, 'loss_val': 0.491430560062348, 'psi': 0.8787687774264885}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.844067 cos_to_last_merge=0.9764 (last merge round=39)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.6230575349434007, 'auprc': 0.8006460955887711, 'loss_val': 0.6865586152612079, 'psi': 0.6940929592015488}-{'f1_val': 0.8778359792312445, 'auprc': 0.8797212018221077, 'loss_val': 0.26218692476711597, 'psi': 0.8785900682675898}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.980519 cos_to_last_merge=0.9756 (last merge round=39)
[S8] round=89 local utility u=0.004445 metrics={'f1_val': 0.9946459649293765, 'auprc': 0.9995528798123999, 'loss_val': 0.02098827696764252, 'psi': 0.996608730882586}-{'f1_val': 0.994057704452729, 'auprc': 0.9997438766303007, 'loss_val': 0.026921715770085813, 'psi': 0.9963321733237577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=89 head_norm_before_train=2.171330 cos_to_last_merge=0.9796 (last merge round=33)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995946461370859, 'loss_val': 0.014724271450538172, 'psi': 0.9980996059621201}-{'f1_val': 0.9971344652643916, 'auprc': 0.9995969645648282, 'loss_val': 0.014354746885663624, 'psi': 0.9981194649845662}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.232434 cos_to_last_merge=0.9523 (last merge round=35)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940529189038215, 'loss_val': 0.035153003554317386, 'psi': 0.9937619613806853}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940335018582024, 'loss_val': 0.034637701665222655, 'psi': 0.9937541945624376}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.430628 (no previous merge yet)
[S11] round=89 local utility u=0.002445 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965860585675718, 'loss_val': 0.017385993214289262, 'psi': 0.996719933282776}-{'f1_val': 0.9965470045135896, 'auprc': 0.9964154262805156, 'loss_val': 0.020190952167217745, 'psi': 0.9964943732203599}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=89 head_norm_before_train=2.196444 (no previous merge yet)
[S13] round=89 local utility u=0.583927 metrics={'f1_val': 0.728011146559665, 'auprc': 0.7678237330595284, 'loss_val': 1.3201616724520886, 'psi': 0.7439361811596104}-{'f1_val': 0.616035111636396, 'auprc': 0.6710819138667892, 'loss_val': 1.5259333298678999, 'psi': 0.6380538325285533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=89 head_norm_before_train=2.312704 (no previous merge yet)
[S14] round=89 local utility u=0.006011 metrics={'f1_val': 0.9932378750416818, 'auprc': 0.9966871925980159, 'loss_val': 0.03151257965086115, 'psi': 0.9946176020642155}-{'f1_val': 0.9911757130856568, 'auprc': 0.9983701880129332, 'loss_val': 0.0362097864391814, 'psi': 0.9940535030565674}
[S14] not sending this round → trigger blocked (psi=0.995)
[S15] START round=89 head_norm_before_train=2.270943 cos_to_last_merge=0.9723 (last merge round=40)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.901767609170308, 'auprc': 0.9780285759984795, 'loss_val': 0.35965184493545344, 'psi': 0.9322719959015766}-{'f1_val': 0.9023418808445254, 'auprc': 0.9788731031404008, 'loss_val': 0.35431524458507047, 'psi': 0.9329543697628755}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=2.061040 cos_to_last_merge=0.9490 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=89 local utility u=0.000548 metrics={'f1_val': 0.993148273899568, 'auprc': 0.9857149636663477, 'loss_val': 0.034075122226894725, 'psi': 0.9901749498062797}-{'f1_val': 0.9934354295572134, 'auprc': 0.9846434015244361, 'loss_val': 0.03367876440433653, 'psi': 0.9899186183441024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=89 head_norm_before_train=2.422687 (no previous merge yet)
[S17] round=89 local utility u=0.218955 metrics={'f1_val': 0.8892418159706605, 'auprc': 0.9905105878949403, 'loss_val': 0.43469808754892464, 'psi': 0.9297493247403725}-{'f1_val': 0.8537469847640275, 'auprc': 0.9849237925237497, 'loss_val': 0.6428793996283263, 'psi': 0.9062177078679164}
[S17] not sending this round → trigger blocked (psi=0.930)
[S2] START round=90 head_norm_before_train=2.321054 cos_to_last_merge=0.9817 (last merge round=35)
[S2] round=90 local utility u=0.133109 metrics={'f1_val': 0.6885427735283605, 'auprc': 0.739320364403604, 'loss_val': 1.260746186535937, 'psi': 0.7088538098784579}-{'f1_val': 0.6755979181748522, 'auprc': 0.7348076002857719, 'loss_val': 1.435756480878651, 'psi': 0.6992817910192201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=90 head_norm_before_train=1.885790 cos_to_last_merge=0.9159 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=90 local utility u=0.085441 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998841723162663, 'loss_val': 0.02151666259344944, 'psi': 0.9979585078601174}-{'f1_val': 0.9781920940903774, 'auprc': 0.9986483251034302, 'loss_val': 0.0767524564311839, 'psi': 0.9863745864955986}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=90 head_norm_before_train=2.094493 cos_to_last_merge=0.9740 (last merge round=40)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.956812729188123, 'auprc': 0.9585198589929842, 'loss_val': 0.3422629564236592, 'psi': 0.9574955811100674}-{'f1_val': 0.9543730620173625, 'auprc': 0.963271585925794, 'loss_val': 0.3312499921794529, 'psi': 0.957932471580735}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=2.079292 cos_to_last_merge=0.9831 (last merge round=39)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.994560611613297, 'loss_val': 0.03248360968562405, 'psi': 0.9956245318234529}-{'f1_val': 0.9971410286679584, 'auprc': 0.9994530141403345, 'loss_val': 0.023338445579694188, 'psi': 0.9980658228569088}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=2.123960 cos_to_last_merge=0.9283 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=90 local utility u=0.408825 metrics={'f1_val': 0.8295824891215919, 'auprc': 0.8329042243705393, 'loss_val': 0.5281142097929938, 'psi': 0.8309111832211709}-{'f1_val': 0.7585202119586654, 'auprc': 0.840085246306717, 'loss_val': 0.9409332636922911, 'psi': 0.7911462256978861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=90 head_norm_before_train=1.850499 cos_to_last_merge=0.9760 (last merge round=39)
[S7] round=90 local utility u=0.561830 metrics={'f1_val': 0.7051399893623893, 'auprc': 0.8760583515269309, 'loss_val': 0.2816308759996547, 'psi': 0.773507334228206}-{'f1_val': 0.6230575349434007, 'auprc': 0.8006460955887711, 'loss_val': 0.6865586152612079, 'psi': 0.6940929592015488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=90 head_norm_before_train=1.985392 cos_to_last_merge=0.9755 (last merge round=39)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9992708329592076, 'loss_val': 0.02470261917265348, 'psi': 0.9961034749367911}-{'f1_val': 0.9946459649293765, 'auprc': 0.9995528798123999, 'loss_val': 0.02098827696764252, 'psi': 0.996608730882586}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=2.175014 cos_to_last_merge=0.9793 (last merge round=33)
[S9] round=90 local utility u=0.000166 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995875106181973, 'loss_val': 0.014370621647043717, 'psi': 0.9980967517545646}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995946461370859, 'loss_val': 0.014724271450538172, 'psi': 0.9980996059621201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=90 head_norm_before_train=2.237124 cos_to_last_merge=0.9519 (last merge round=35)
[S10] round=90 local utility u=0.000208 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939857810681334, 'loss_val': 0.03453569729690269, 'psi': 0.99373510624641}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940529189038215, 'loss_val': 0.035153003554317386, 'psi': 0.9937619613806853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=90 head_norm_before_train=2.427492 (no previous merge yet)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9965866213451, 'loss_val': 0.018049986428206644, 'psi': 0.9967201583937872}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965860585675718, 'loss_val': 0.017385993214289262, 'psi': 0.996719933282776}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=2.198767 (no previous merge yet)
[S13] round=90 local utility u=0.089893 metrics={'f1_val': 0.6990024974986017, 'auprc': 0.7982362972486582, 'loss_val': 1.0575618596162168, 'psi': 0.7386960173986243}-{'f1_val': 0.728011146559665, 'auprc': 0.7678237330595284, 'loss_val': 1.3201616724520886, 'psi': 0.7439361811596104}
[S13] not sending this round → trigger blocked (psi=0.739)
[S14] START round=90 head_norm_before_train=2.319144 (no previous merge yet)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9928182792787577, 'auprc': 0.996687131540891, 'loss_val': 0.032027586078482904, 'psi': 0.994365820183611}-{'f1_val': 0.9932378750416818, 'auprc': 0.9966871925980159, 'loss_val': 0.03151257965086115, 'psi': 0.9946176020642155}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.275007 cos_to_last_merge=0.9720 (last merge round=40)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9011920887978451, 'auprc': 0.9754877314294665, 'loss_val': 0.36665957078269595, 'psi': 0.9309103458504937}-{'f1_val': 0.901767609170308, 'auprc': 0.9780285759984795, 'loss_val': 0.35965184493545344, 'psi': 0.9322719959015766}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.065710 cos_to_last_merge=0.9486 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=90 local utility u=0.000414 metrics={'f1_val': 0.9927306099290307, 'auprc': 0.9871394641625767, 'loss_val': 0.035014724535860714, 'psi': 0.990494151622449}-{'f1_val': 0.993148273899568, 'auprc': 0.9857149636663477, 'loss_val': 0.034075122226894725, 'psi': 0.9901749498062797}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=90 head_norm_before_train=2.427407 (no previous merge yet)
[S17] round=90 local utility u=0.020801 metrics={'f1_val': 0.893635491333242, 'auprc': 0.9900670974344324, 'loss_val': 0.41812711461418556, 'psi': 0.9322081337737183}-{'f1_val': 0.8892418159706605, 'auprc': 0.9905105878949403, 'loss_val': 0.43469808754892464, 'psi': 0.9297493247403725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=91 head_norm_before_train=2.328072 cos_to_last_merge=0.9816 (last merge round=35)
[S2] round=91 local utility u=0.152871 metrics={'f1_val': 0.7070039882709611, 'auprc': 0.7453866321962794, 'loss_val': 1.0839697634106156, 'psi': 0.7223570458410884}-{'f1_val': 0.6885427735283605, 'auprc': 0.739320364403604, 'loss_val': 1.260746186535937, 'psi': 0.7088538098784579}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=91 head_norm_before_train=1.887199 cos_to_last_merge=0.9157 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9848719357422869, 'auprc': 0.9988833116743233, 'loss_val': 0.038760897803136345, 'psi': 0.9904764861151015}-{'f1_val': 0.9973696976584205, 'auprc': 0.998841723162663, 'loss_val': 0.02151666259344944, 'psi': 0.9979585078601174}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.100172 cos_to_last_merge=0.9738 (last merge round=40)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9415680310379724, 'auprc': 0.9666525075514889, 'loss_val': 0.3555419498975872, 'psi': 0.951601821643379}-{'f1_val': 0.956812729188123, 'auprc': 0.9585198589929842, 'loss_val': 0.3422629564236592, 'psi': 0.9574955811100674}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=2.081786 cos_to_last_merge=0.9829 (last merge round=39)
[S5] round=91 local utility u=0.013556 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9989502773632915, 'loss_val': 0.02338426122257236, 'psi': 0.9978647281460915}-{'f1_val': 0.9963338119635569, 'auprc': 0.994560611613297, 'loss_val': 0.03248360968562405, 'psi': 0.9956245318234529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=91 head_norm_before_train=2.132071 cos_to_last_merge=0.9276 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=91 local utility u=0.496694 metrics={'f1_val': 0.9179196531942406, 'auprc': 0.9113609191475344, 'loss_val': 0.30011986452406997, 'psi': 0.9152961595755581}-{'f1_val': 0.8295824891215919, 'auprc': 0.8329042243705393, 'loss_val': 0.5281142097929938, 'psi': 0.8309111832211709}
[S6] not sending this round → trigger blocked (psi=0.915)
[S7] START round=91 head_norm_before_train=1.855894 cos_to_last_merge=0.9756 (last merge round=39)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.5602067176924703, 'auprc': 0.7908157251933443, 'loss_val': 1.0181081398988094, 'psi': 0.6524503206928199}-{'f1_val': 0.7051399893623893, 'auprc': 0.8760583515269309, 'loss_val': 0.2816308759996547, 'psi': 0.773507334228206}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=1.992473 cos_to_last_merge=0.9751 (last merge round=39)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9994226748684671, 'loss_val': 0.03040331653960061, 'psi': 0.995505393426356}-{'f1_val': 0.9939919029218467, 'auprc': 0.9992708329592076, 'loss_val': 0.02470261917265348, 'psi': 0.9961034749367911}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.179323 cos_to_last_merge=0.9790 (last merge round=33)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995903301167964, 'loss_val': 0.01458322524616584, 'psi': 0.9980978795540043}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995875106181973, 'loss_val': 0.014370621647043717, 'psi': 0.9980967517545646}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.240702 cos_to_last_merge=0.9515 (last merge round=35)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939816631511813, 'loss_val': 0.034578059428374, 'psi': 0.9937334590796292}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939857810681334, 'loss_val': 0.03453569729690269, 'psi': 0.99373510624641}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.428375 (no previous merge yet)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9963963516024382, 'auprc': 0.9970810863219781, 'loss_val': 0.01991383337071099, 'psi': 0.9966702454902542}-{'f1_val': 0.9968091830929121, 'auprc': 0.9965866213451, 'loss_val': 0.018049986428206644, 'psi': 0.9967201583937872}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=2.195274 (no previous merge yet)
[S13] round=91 local utility u=0.094717 metrics={'f1_val': 0.6799497293289638, 'auprc': 0.9482701153433621, 'loss_val': 1.203912653236814, 'psi': 0.7872778837347232}-{'f1_val': 0.6990024974986017, 'auprc': 0.7982362972486582, 'loss_val': 1.0575618596162168, 'psi': 0.7386960173986243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=91 head_norm_before_train=2.322288 (no previous merge yet)
[S14] round=91 local utility u=0.019174 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9978143114148719, 'loss_val': 0.024584876949829713, 'psi': 0.9975690423975393}-{'f1_val': 0.9928182792787577, 'auprc': 0.996687131540891, 'loss_val': 0.032027586078482904, 'psi': 0.994365820183611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=91 head_norm_before_train=2.278991 cos_to_last_merge=0.9717 (last merge round=40)
[S15] round=91 local utility u=0.006604 metrics={'f1_val': 0.901767609170308, 'auprc': 0.977394186422656, 'loss_val': 0.3626240562903665, 'psi': 0.9320182400712471}-{'f1_val': 0.9011920887978451, 'auprc': 0.9754877314294665, 'loss_val': 0.36665957078269595, 'psi': 0.9309103458504937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=91 head_norm_before_train=2.071563 cos_to_last_merge=0.9481 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=91 local utility u=0.007089 metrics={'f1_val': 0.9927306099290307, 'auprc': 0.9922426341470791, 'loss_val': 0.03614555679677331, 'psi': 0.99253541961625}-{'f1_val': 0.9927306099290307, 'auprc': 0.9871394641625767, 'loss_val': 0.035014724535860714, 'psi': 0.990494151622449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=91 head_norm_before_train=2.430018 (no previous merge yet)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.8764521222971424, 'auprc': 0.9868302826960513, 'loss_val': 0.5667441514326286, 'psi': 0.920603386456706}-{'f1_val': 0.893635491333242, 'auprc': 0.9900670974344324, 'loss_val': 0.41812711461418556, 'psi': 0.9322081337737183}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.333320 cos_to_last_merge=0.9814 (last merge round=35)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.7084618900011195, 'auprc': 0.7354584794978205, 'loss_val': 1.1535809469516118, 'psi': 0.7192605257997999}-{'f1_val': 0.7070039882709611, 'auprc': 0.7453866321962794, 'loss_val': 1.0839697634106156, 'psi': 0.7223570458410884}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=1.890290 cos_to_last_merge=0.9153 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9988369758852914, 'loss_val': 0.15459883042600864, 'psi': 0.976003081970976}-{'f1_val': 0.9848719357422869, 'auprc': 0.9988833116743233, 'loss_val': 0.038760897803136345, 'psi': 0.9904764861151015}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.106066 cos_to_last_merge=0.9737 (last merge round=40)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.8707284996618052, 'auprc': 0.9474083236448497, 'loss_val': 0.4642700708739951, 'psi': 0.9014004292550231}-{'f1_val': 0.9415680310379724, 'auprc': 0.9666525075514889, 'loss_val': 0.3555419498975872, 'psi': 0.951601821643379}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=2.082927 cos_to_last_merge=0.9825 (last merge round=39)
[S5] round=92 local utility u=0.000164 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.998947559298386, 'loss_val': 0.02304903975947105, 'psi': 0.9978636409201294}-{'f1_val': 0.9971410286679584, 'auprc': 0.9989502773632915, 'loss_val': 0.02338426122257236, 'psi': 0.9978647281460915}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=92 head_norm_before_train=2.141593 cos_to_last_merge=0.9269 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=92 local utility u=0.222620 metrics={'f1_val': 0.9524288917929109, 'auprc': 0.9416509034103739, 'loss_val': 0.15280624783085003, 'psi': 0.9481176964398961}-{'f1_val': 0.9179196531942406, 'auprc': 0.9113609191475344, 'loss_val': 0.30011986452406997, 'psi': 0.9152961595755581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=92 head_norm_before_train=1.859588 cos_to_last_merge=0.9754 (last merge round=39)
[S7] round=92 local utility u=0.688665 metrics={'f1_val': 0.6774968671582622, 'auprc': 0.8158520620478003, 'loss_val': 0.4196279603432691, 'psi': 0.7328389451140774}-{'f1_val': 0.5602067176924703, 'auprc': 0.7908157251933443, 'loss_val': 1.0181081398988094, 'psi': 0.6524503206928199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=92 head_norm_before_train=1.997138 cos_to_last_merge=0.9748 (last merge round=39)
[S8] round=92 local utility u=0.014036 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9985089151851504, 'loss_val': 0.021166589696563636, 'psi': 0.9972975907124619}-{'f1_val': 0.9928938724649488, 'auprc': 0.9994226748684671, 'loss_val': 0.03040331653960061, 'psi': 0.995505393426356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=92 head_norm_before_train=2.184011 cos_to_last_merge=0.9786 (last merge round=33)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9992069435738603, 'loss_val': 0.019553331815264023, 'psi': 0.9964469671991656}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995903301167964, 'loss_val': 0.01458322524616584, 'psi': 0.9980978795540043}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.244601 cos_to_last_merge=0.9511 (last merge round=35)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940554319554056, 'loss_val': 0.035054365642160974, 'psi': 0.9937629666013189}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939816631511813, 'loss_val': 0.034578059428374, 'psi': 0.9937334590796292}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.425631 (no previous merge yet)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9966919572999005, 'loss_val': 0.019181308310302323, 'psi': 0.9965142952384267}-{'f1_val': 0.9963963516024382, 'auprc': 0.9970810863219781, 'loss_val': 0.01991383337071099, 'psi': 0.9966702454902542}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.199808 (no previous merge yet)
[S13] round=92 local utility u=0.039109 metrics={'f1_val': 0.7193574318779701, 'auprc': 0.8293458069393064, 'loss_val': 1.005368263012628, 'psi': 0.7633527819025046}-{'f1_val': 0.6799497293289638, 'auprc': 0.9482701153433621, 'loss_val': 1.203912653236814, 'psi': 0.7872778837347232}
[S13] not sending this round → trigger blocked (psi=0.763)
[S14] START round=92 head_norm_before_train=2.323123 (no previous merge yet)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9960073863923677, 'auprc': 0.9983885959305261, 'loss_val': 0.027389945956118194, 'psi': 0.9969598702076311}-{'f1_val': 0.9974055297193176, 'auprc': 0.9978143114148719, 'loss_val': 0.024584876949829713, 'psi': 0.9975690423975393}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.282939 cos_to_last_merge=0.9714 (last merge round=40)
[S15] round=92 local utility u=0.023118 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.9850152821960546, 'loss_val': 0.3461350837170063, 'psi': 0.9357550587705259}-{'f1_val': 0.901767609170308, 'auprc': 0.977394186422656, 'loss_val': 0.3626240562903665, 'psi': 0.9320182400712471}
[S15] not sending this round → trigger blocked (psi=0.936)
[S16] START round=92 head_norm_before_train=2.077920 cos_to_last_merge=0.9476 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9930997745669108, 'auprc': 0.990462761932539, 'loss_val': 0.03571171166532169, 'psi': 0.992044969513162}-{'f1_val': 0.9927306099290307, 'auprc': 0.9922426341470791, 'loss_val': 0.03614555679677331, 'psi': 0.99253541961625}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.434703 (no previous merge yet)
[S17] round=92 local utility u=0.051775 metrics={'f1_val': 0.8834212941940052, 'auprc': 0.9855888604246755, 'loss_val': 0.5012849915791255, 'psi': 0.9242883206862733}-{'f1_val': 0.8764521222971424, 'auprc': 0.9868302826960513, 'loss_val': 0.5667441514326286, 'psi': 0.920603386456706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S17] sending update (kind=head size=1788 to 1 peers)
[S2] START round=93 head_norm_before_train=2.338847 cos_to_last_merge=0.9813 (last merge round=35)
[S2] round=93 local utility u=0.130350 metrics={'f1_val': 0.7191507928369559, 'auprc': 0.7558327014241295, 'loss_val': 1.0181368648466669, 'psi': 0.7338235562718254}-{'f1_val': 0.7084618900011195, 'auprc': 0.7354584794978205, 'loss_val': 1.1535809469516118, 'psi': 0.7192605257997999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=93 head_norm_before_train=1.894603 cos_to_last_merge=0.9148 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=93 local utility u=0.061726 metrics={'f1_val': 0.9724536847841172, 'auprc': 0.9984645243047201, 'loss_val': 0.10006788772248976, 'psi': 0.9828580205923584}-{'f1_val': 0.9607804860280988, 'auprc': 0.9988369758852914, 'loss_val': 0.15459883042600864, 'psi': 0.976003081970976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=93 head_norm_before_train=2.112535 cos_to_last_merge=0.9732 (last merge round=40)
[S4] round=93 local utility u=0.062840 metrics={'f1_val': 0.8812414258195487, 'auprc': 0.9660274192548055, 'loss_val': 0.4575246476954262, 'psi': 0.9151558231936514}-{'f1_val': 0.8707284996618052, 'auprc': 0.9474083236448497, 'loss_val': 0.4642700708739951, 'psi': 0.9014004292550231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=93 head_norm_before_train=2.085012 cos_to_last_merge=0.9823 (last merge round=39)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.998548194935237, 'loss_val': 0.02368574921401229, 'psi': 0.9977038951748698}-{'f1_val': 0.9971410286679584, 'auprc': 0.998947559298386, 'loss_val': 0.02304903975947105, 'psi': 0.9978636409201294}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.149603 cos_to_last_merge=0.9263 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.9470738473860274, 'auprc': 0.9302173236866073, 'loss_val': 0.19154773650526596, 'psi': 0.9403312379062594}-{'f1_val': 0.9524288917929109, 'auprc': 0.9416509034103739, 'loss_val': 0.15280624783085003, 'psi': 0.9481176964398961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.861848 cos_to_last_merge=0.9752 (last merge round=39)
[S7] round=93 local utility u=0.594380 metrics={'f1_val': 0.798747796716024, 'auprc': 0.912445146696186, 'loss_val': 0.24815275760403327, 'psi': 0.8442267367080889}-{'f1_val': 0.6774968671582622, 'auprc': 0.8158520620478003, 'loss_val': 0.4196279603432691, 'psi': 0.7328389451140774}
[S7] not sending this round → trigger blocked (psi=0.844)
[S8] START round=93 head_norm_before_train=2.002327 cos_to_last_merge=0.9745 (last merge round=39)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9994365006475437, 'loss_val': 0.029718658950610887, 'psi': 0.9953782092445114}-{'f1_val': 0.9964900410640029, 'auprc': 0.9985089151851504, 'loss_val': 0.021166589696563636, 'psi': 0.9972975907124619}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.186004 cos_to_last_merge=0.9785 (last merge round=33)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9920865114751727, 'auprc': 0.9992014402694069, 'loss_val': 0.026022859757946697, 'psi': 0.9949324829928663}-{'f1_val': 0.9946069829493691, 'auprc': 0.9992069435738603, 'loss_val': 0.019553331815264023, 'psi': 0.9964469671991656}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.249787 cos_to_last_merge=0.9507 (last merge round=35)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9940241595587898, 'loss_val': 0.035019044661328845, 'psi': 0.9937504576426726}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940554319554056, 'loss_val': 0.035054365642160974, 'psi': 0.9937629666013189}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.427251 (no previous merge yet)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.996575933794016, 'loss_val': 0.02010613599910885, 'psi': 0.9963228583640537}-{'f1_val': 0.9963958538641108, 'auprc': 0.9966919572999005, 'loss_val': 0.019181308310302323, 'psi': 0.9965142952384267}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=2.202008 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6438006778228373, 'auprc': 0.7511082897802598, 'loss_val': 1.2521364003396147, 'psi': 0.6867237226058063}-{'f1_val': 0.7193574318779701, 'auprc': 0.8293458069393064, 'loss_val': 1.005368263012628, 'psi': 0.7633527819025046}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.327585 (no previous merge yet)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9771179493884415, 'auprc': 0.998586068160884, 'loss_val': 0.04759047975199469, 'psi': 0.9857051968974185}-{'f1_val': 0.9960073863923677, 'auprc': 0.9983885959305261, 'loss_val': 0.027389945956118194, 'psi': 0.9969598702076311}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.286845 cos_to_last_merge=0.9712 (last merge round=40)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9029149098201734, 'auprc': 0.985107617076208, 'loss_val': 0.3469008954289399, 'psi': 0.9357919927225872}-{'f1_val': 0.9029149098201734, 'auprc': 0.9850152821960546, 'loss_val': 0.3461350837170063, 'psi': 0.9357550587705259}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.081724 cos_to_last_merge=0.9471 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9943195754228054, 'auprc': 0.9851544686942949, 'loss_val': 0.032822596886708084, 'psi': 0.9906535327314012}-{'f1_val': 0.9930997745669108, 'auprc': 0.990462761932539, 'loss_val': 0.03571171166532169, 'psi': 0.992044969513162}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=2.440726 (no previous merge yet)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8763428129505648, 'auprc': 0.9858525218650673, 'loss_val': 0.5627338281291616, 'psi': 0.9201466965163658}-{'f1_val': 0.8834212941940052, 'auprc': 0.9855888604246755, 'loss_val': 0.5012849915791255, 'psi': 0.9242883206862733}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.345166 cos_to_last_merge=0.9811 (last merge round=35)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7189350744112737, 'auprc': 0.7525401246848684, 'loss_val': 1.0146544622382236, 'psi': 0.7323770945207115}-{'f1_val': 0.7191507928369559, 'auprc': 0.7558327014241295, 'loss_val': 1.0181368648466669, 'psi': 0.7338235562718254}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=1.899109 cos_to_last_merge=0.9142 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=94 local utility u=0.063768 metrics={'f1_val': 0.9862967035706485, 'auprc': 0.9989812511232755, 'loss_val': 0.05714113713265534, 'psi': 0.9913705225916993}-{'f1_val': 0.9724536847841172, 'auprc': 0.9984645243047201, 'loss_val': 0.10006788772248976, 'psi': 0.9828580205923584}
[S3] not sending this round → trigger blocked (psi=0.991)
[S4] START round=94 head_norm_before_train=2.123018 cos_to_last_merge=0.9736 (last merge round=40)
[S4] round=94 local utility u=0.222801 metrics={'f1_val': 0.9433046179992597, 'auprc': 0.955648852398234, 'loss_val': 0.35316603716904243, 'psi': 0.9482423117588494}-{'f1_val': 0.8812414258195487, 'auprc': 0.9660274192548055, 'loss_val': 0.4575246476954262, 'psi': 0.9151558231936514}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=94 head_norm_before_train=2.091232 cos_to_last_merge=0.9821 (last merge round=39)
[S5] round=94 local utility u=0.000883 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9989846576193577, 'loss_val': 0.02322951693602117, 'psi': 0.9978784802485181}-{'f1_val': 0.9971410286679584, 'auprc': 0.998548194935237, 'loss_val': 0.02368574921401229, 'psi': 0.9977038951748698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=94 head_norm_before_train=2.157751 cos_to_last_merge=0.9257 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.793696809354298, 'auprc': 0.8879574750932727, 'loss_val': 0.4498777995400027, 'psi': 0.831401075649888}-{'f1_val': 0.9470738473860274, 'auprc': 0.9302173236866073, 'loss_val': 0.19154773650526596, 'psi': 0.9403312379062594}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.868227 cos_to_last_merge=0.9747 (last merge round=39)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5626623323247271, 'auprc': 0.79356788958364, 'loss_val': 0.8463778304302492, 'psi': 0.6550245552282923}-{'f1_val': 0.798747796716024, 'auprc': 0.912445146696186, 'loss_val': 0.24815275760403327, 'psi': 0.8442267367080889}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.008296 cos_to_last_merge=0.9742 (last merge round=39)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9786489449626778, 'auprc': 0.9991027489629101, 'loss_val': 0.047086342410985915, 'psi': 0.9868304665627707}-{'f1_val': 0.9926726816424898, 'auprc': 0.9994365006475437, 'loss_val': 0.029718658950610887, 'psi': 0.9953782092445114}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=2.189576 cos_to_last_merge=0.9782 (last merge round=33)
[S9] round=94 local utility u=0.020614 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9992086451487319, 'loss_val': 0.014898529465136054, 'psi': 0.9979434877830308}-{'f1_val': 0.9920865114751727, 'auprc': 0.9992014402694069, 'loss_val': 0.026022859757946697, 'psi': 0.9949324829928663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=94 head_norm_before_train=2.253457 cos_to_last_merge=0.9503 (last merge round=35)
[S10] round=94 local utility u=0.000571 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9935573417945305, 'loss_val': 0.03379163102474519, 'psi': 0.9936952098626253}-{'f1_val': 0.9935679896985945, 'auprc': 0.9940241595587898, 'loss_val': 0.035019044661328845, 'psi': 0.9937504576426726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=94 head_norm_before_train=2.431184 (no previous merge yet)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9964055928626651, 'loss_val': 0.02083730861460589, 'psi': 0.9962547219915132}-{'f1_val': 0.9961541414107454, 'auprc': 0.996575933794016, 'loss_val': 0.02010613599910885, 'psi': 0.9963228583640537}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.200152 (no previous merge yet)
[S13] round=94 local utility u=0.148218 metrics={'f1_val': 0.6947402947721518, 'auprc': 0.753212564999026, 'loss_val': 1.2676506874911002, 'psi': 0.7181292028629015}-{'f1_val': 0.6438006778228373, 'auprc': 0.7511082897802598, 'loss_val': 1.2521364003396147, 'psi': 0.6867237226058063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=94 head_norm_before_train=2.334003 (no previous merge yet)
[S14] round=94 local utility u=0.073143 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9985867802581176, 'loss_val': 0.026841324498359024, 'psi': 0.9982589271073712}-{'f1_val': 0.9771179493884415, 'auprc': 0.998586068160884, 'loss_val': 0.04759047975199469, 'psi': 0.9857051968974185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=94 head_norm_before_train=2.290673 cos_to_last_merge=0.9709 (last merge round=40)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9803099013962813, 'loss_val': 0.35972235586636686, 'psi': 0.9335290890652277}-{'f1_val': 0.9029149098201734, 'auprc': 0.985107617076208, 'loss_val': 0.3469008954289399, 'psi': 0.9357919927225872}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.083753 cos_to_last_merge=0.9469 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.947
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9943454058682003, 'auprc': 0.9849721921499617, 'loss_val': 0.034118987812354167, 'psi': 0.9905961203809048}-{'f1_val': 0.9943195754228054, 'auprc': 0.9851544686942949, 'loss_val': 0.032822596886708084, 'psi': 0.9906535327314012}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.444694 (no previous merge yet)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.4969943991048118, 'auprc': 0.9211720566538677, 'loss_val': 2.003077116738542, 'psi': 0.6666654621244341}-{'f1_val': 0.8763428129505648, 'auprc': 0.9858525218650673, 'loss_val': 0.5627338281291616, 'psi': 0.9201466965163658}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.348056 cos_to_last_merge=0.9809 (last merge round=35)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.6701473666081512, 'auprc': 0.7312990149292571, 'loss_val': 1.5858995046591042, 'psi': 0.6946080259365935}-{'f1_val': 0.7189350744112737, 'auprc': 0.7525401246848684, 'loss_val': 1.0146544622382236, 'psi': 0.7323770945207115}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=1.904046 cos_to_last_merge=0.9136 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=95 local utility u=0.049935 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9985251520991247, 'loss_val': 0.020812725319441464, 'psi': 0.9976790203882954}-{'f1_val': 0.9862967035706485, 'auprc': 0.9989812511232755, 'loss_val': 0.05714113713265534, 'psi': 0.9913705225916993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=95 head_norm_before_train=2.128027 cos_to_last_merge=0.9733 (last merge round=40)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9418178524399385, 'auprc': 0.9524309318796866, 'loss_val': 0.3644300825819772, 'psi': 0.9460630842158377}-{'f1_val': 0.9433046179992597, 'auprc': 0.955648852398234, 'loss_val': 0.35316603716904243, 'psi': 0.9482423117588494}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.097877 cos_to_last_merge=0.9817 (last merge round=39)
[S5] round=95 local utility u=0.000334 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9986664257180856, 'loss_val': 0.021605968512782056, 'psi': 0.9977511874880092}-{'f1_val': 0.9971410286679584, 'auprc': 0.9989846576193577, 'loss_val': 0.02322951693602117, 'psi': 0.9978784802485181}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=95 head_norm_before_train=2.166173 cos_to_last_merge=0.9251 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.8131925491517733, 'auprc': 0.9245968182398516, 'loss_val': 0.6834798797687587, 'psi': 0.8577542567870047}-{'f1_val': 0.793696809354298, 'auprc': 0.8879574750932727, 'loss_val': 0.4498777995400027, 'psi': 0.831401075649888}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.872524 cos_to_last_merge=0.9744 (last merge round=39)
[S7] round=95 local utility u=1.000000 metrics={'f1_val': 0.7216891923750381, 'auprc': 0.9888715235788854, 'loss_val': 0.24586626853717097, 'psi': 0.8285621248565771}-{'f1_val': 0.5626623323247271, 'auprc': 0.79356788958364, 'loss_val': 0.8463778304302492, 'psi': 0.6550245552282923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=95 head_norm_before_train=2.015848 cos_to_last_merge=0.9738 (last merge round=39)
[S8] round=95 local utility u=0.060173 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9995146169125665, 'loss_val': 0.021755077657598317, 'psi': 0.9963731511164446}-{'f1_val': 0.9786489449626778, 'auprc': 0.9991027489629101, 'loss_val': 0.047086342410985915, 'psi': 0.9868304665627707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=95 head_norm_before_train=2.193994 cos_to_last_merge=0.9779 (last merge round=33)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999205418097557, 'loss_val': 0.015069607843584073, 'psi': 0.9979439147463085}-{'f1_val': 0.9971000495392299, 'auprc': 0.9992086451487319, 'loss_val': 0.014898529465136054, 'psi': 0.9979434877830308}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.255373 cos_to_last_merge=0.9500 (last merge round=35)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=95 local utility u=0.000098 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9934965976229366, 'loss_val': 0.03341267471975052, 'psi': 0.9936709121939877}-{'f1_val': 0.9937871219080217, 'auprc': 0.9935573417945305, 'loss_val': 0.03379163102474519, 'psi': 0.9936952098626253}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=95 head_norm_before_train=2.436210 (no previous merge yet)
[S11] round=95 local utility u=0.003002 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9970950899017786, 'loss_val': 0.018351293952062347, 'psi': 0.996675548279178}-{'f1_val': 0.9961541414107454, 'auprc': 0.9964055928626651, 'loss_val': 0.02083730861460589, 'psi': 0.9962547219915132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=95 head_norm_before_train=2.199782 (no previous merge yet)
[S13] round=95 local utility u=0.449675 metrics={'f1_val': 0.7446073944972552, 'auprc': 0.8733812364544199, 'loss_val': 1.0280097362252196, 'psi': 0.7961169312801211}-{'f1_val': 0.6947402947721518, 'auprc': 0.753212564999026, 'loss_val': 1.2676506874911002, 'psi': 0.7181292028629015}
[S13] not sending this round → trigger blocked (psi=0.796)
[S14] START round=95 head_norm_before_train=2.340369 (no previous merge yet)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9964572739747554, 'loss_val': 0.01849210221009892, 'psi': 0.9971288344678529}-{'f1_val': 0.9980403583402068, 'auprc': 0.9985867802581176, 'loss_val': 0.026841324498359024, 'psi': 0.9982589271073712}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.294497 cos_to_last_merge=0.9706 (last merge round=40)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9787479804038154, 'loss_val': 0.36488493154673435, 'psi': 0.9329043206682414}-{'f1_val': 0.9023418808445254, 'auprc': 0.9803099013962813, 'loss_val': 0.35972235586636686, 'psi': 0.9335290890652277}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.088234 cos_to_last_merge=0.9465 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.8786298164900794, 'auprc': 0.9823591438223525, 'loss_val': 0.35093109345868206, 'psi': 0.9201215474229887}-{'f1_val': 0.9943454058682003, 'auprc': 0.9849721921499617, 'loss_val': 0.034118987812354167, 'psi': 0.9905961203809048}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.446275 (no previous merge yet)
[S17] round=95 local utility u=1.000000 metrics={'f1_val': 0.8876965079978979, 'auprc': 0.9879268636026461, 'loss_val': 0.46123857516458183, 'psi': 0.9277886502397972}-{'f1_val': 0.4969943991048118, 'auprc': 0.9211720566538677, 'loss_val': 2.003077116738542, 'psi': 0.6666654621244341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=96 head_norm_before_train=2.349579 cos_to_last_merge=0.9806 (last merge round=35)
[S2] round=96 local utility u=0.422523 metrics={'f1_val': 0.7175977527204798, 'auprc': 0.7486159828289369, 'loss_val': 1.077506907446423, 'psi': 0.7300050447638626}-{'f1_val': 0.6701473666081512, 'auprc': 0.7312990149292571, 'loss_val': 1.5858995046591042, 'psi': 0.6946080259365935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=96 head_norm_before_train=1.909117 cos_to_last_merge=0.9130 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.9472714413457395, 'auprc': 0.9947895304666157, 'loss_val': 0.20586383339482148, 'psi': 0.96627867699409}-{'f1_val': 0.9971149325810758, 'auprc': 0.9985251520991247, 'loss_val': 0.020812725319441464, 'psi': 0.9976790203882954}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.132645 cos_to_last_merge=0.9724 (last merge round=40)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9445375313911528, 'auprc': 0.9322936158249611, 'loss_val': 0.3506821778288869, 'psi': 0.9396399651646762}-{'f1_val': 0.9418178524399385, 'auprc': 0.9524309318796866, 'loss_val': 0.3644300825819772, 'psi': 0.9460630842158377}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.099508 cos_to_last_merge=0.9814 (last merge round=39)
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9958316182057017, 'loss_val': 0.021936857286076344, 'psi': 0.9966172644830557}-{'f1_val': 0.9971410286679584, 'auprc': 0.9986664257180856, 'loss_val': 0.021605968512782056, 'psi': 0.9977511874880092}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.173976 cos_to_last_merge=0.9246 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=96 local utility u=0.751699 metrics={'f1_val': 0.9569866773808706, 'auprc': 0.9571836617902785, 'loss_val': 0.14060723183677418, 'psi': 0.9570654711446337}-{'f1_val': 0.8131925491517733, 'auprc': 0.9245968182398516, 'loss_val': 0.6834798797687587, 'psi': 0.8577542567870047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=96 head_norm_before_train=1.875627 cos_to_last_merge=0.9741 (last merge round=39)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5622839417109119, 'auprc': 0.7908985227577031, 'loss_val': 0.7492423314538474, 'psi': 0.6537297741296284}-{'f1_val': 0.7216891923750381, 'auprc': 0.9888715235788854, 'loss_val': 0.24586626853717097, 'psi': 0.8285621248565771}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.021637 cos_to_last_merge=0.9734 (last merge round=39)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.999467937562354, 'loss_val': 0.024921062186039362, 'psi': 0.9959149342313696}-{'f1_val': 0.9942788405856967, 'auprc': 0.9995146169125665, 'loss_val': 0.021755077657598317, 'psi': 0.9963731511164446}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.197006 cos_to_last_merge=0.9777 (last merge round=33)
[S9] round=96 local utility u=0.000616 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995710111028936, 'loss_val': 0.014935285457466373, 'psi': 0.9980901519484431}-{'f1_val': 0.9971029125121428, 'auprc': 0.999205418097557, 'loss_val': 0.015069607843584073, 'psi': 0.9979439147463085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=96 head_norm_before_train=2.258736 cos_to_last_merge=0.9496 (last merge round=35)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9936712689029641, 'loss_val': 0.03506611715158112, 'psi': 0.9936093013803423}-{'f1_val': 0.9937871219080217, 'auprc': 0.9934965976229366, 'loss_val': 0.03341267471975052, 'psi': 0.9936709121939877}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.441865 (no previous merge yet)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9965866565924717, 'loss_val': 0.01858026809915693, 'psi': 0.9964721749554553}-{'f1_val': 0.9963958538641108, 'auprc': 0.9970950899017786, 'loss_val': 0.018351293952062347, 'psi': 0.996675548279178}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.200516 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.7304221006409697, 'auprc': 0.8047550043840974, 'loss_val': 1.1410241984768315, 'psi': 0.7601552621382208}-{'f1_val': 0.7446073944972552, 'auprc': 0.8733812364544199, 'loss_val': 1.0280097362252196, 'psi': 0.7961169312801211}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.346524 (no previous merge yet)
[S14] round=96 local utility u=0.004758 metrics={'f1_val': 0.9979900342899044, 'auprc': 0.9984465241870335, 'loss_val': 0.017424657722121675, 'psi': 0.998172630248756}-{'f1_val': 0.9975765414632514, 'auprc': 0.9964572739747554, 'loss_val': 0.01849210221009892, 'psi': 0.9971288344678529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=96 head_norm_before_train=2.298250 cos_to_last_merge=0.9704 (last merge round=40)
[S15] round=96 local utility u=0.007562 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9811687601658062, 'loss_val': 0.3570227945574702, 'psi': 0.9338726325730378}-{'f1_val': 0.9023418808445254, 'auprc': 0.9787479804038154, 'loss_val': 0.36488493154673435, 'psi': 0.9329043206682414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=96 head_norm_before_train=2.090149 cos_to_last_merge=0.9461 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=96 local utility u=0.205609 metrics={'f1_val': 0.9261489594237167, 'auprc': 0.9854046330792232, 'loss_val': 0.23396378862446615, 'psi': 0.9498512288859192}-{'f1_val': 0.8786298164900794, 'auprc': 0.9823591438223525, 'loss_val': 0.35093109345868206, 'psi': 0.9201215474229887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=96 head_norm_before_train=2.449420 (no previous merge yet)
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.7101881915799153, 'auprc': 0.9377166106350039, 'loss_val': 1.0173019842803066, 'psi': 0.8011995592019507}-{'f1_val': 0.8876965079978979, 'auprc': 0.9879268636026461, 'loss_val': 0.46123857516458183, 'psi': 0.9277886502397972}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.355593 cos_to_last_merge=0.9804 (last merge round=35)
[S2] round=97 local utility u=0.004474 metrics={'f1_val': 0.7182026994138608, 'auprc': 0.7466634310977027, 'loss_val': 1.066330640897708, 'psi': 0.7295869920873976}-{'f1_val': 0.7175977527204798, 'auprc': 0.7486159828289369, 'loss_val': 1.077506907446423, 'psi': 0.7300050447638626}
[S2] not sending this round → trigger blocked (psi=0.730)
[S3] START round=97 head_norm_before_train=1.913410 cos_to_last_merge=0.9125 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=97 local utility u=0.167526 metrics={'f1_val': 0.9824878465021035, 'auprc': 0.9987266114519646, 'loss_val': 0.09392156077925053, 'psi': 0.9889833524820479}-{'f1_val': 0.9472714413457395, 'auprc': 0.9947895304666157, 'loss_val': 0.20586383339482148, 'psi': 0.96627867699409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=97 head_norm_before_train=2.136483 cos_to_last_merge=0.9710 (last merge round=40)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9432365577476775, 'auprc': 0.9261981450978746, 'loss_val': 0.3544421598865853, 'psi': 0.9364211926877563}-{'f1_val': 0.9445375313911528, 'auprc': 0.9322936158249611, 'loss_val': 0.3506821778288869, 'psi': 0.9396399651646762}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.106801 cos_to_last_merge=0.9809 (last merge round=39)
[S5] round=97 local utility u=0.002310 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9970679724602175, 'loss_val': 0.021025410309316164, 'psi': 0.9971118061848621}-{'f1_val': 0.9971410286679584, 'auprc': 0.9958316182057017, 'loss_val': 0.021936857286076344, 'psi': 0.9966172644830557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=97 head_norm_before_train=2.180732 cos_to_last_merge=0.9241 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=97 local utility u=0.025758 metrics={'f1_val': 0.9760630705997638, 'auprc': 0.9346674885238158, 'loss_val': 0.1360020585683964, 'psi': 0.9595048377693847}-{'f1_val': 0.9569866773808706, 'auprc': 0.9571836617902785, 'loss_val': 0.14060723183677418, 'psi': 0.9570654711446337}
[S6] not sending this round → trigger blocked (psi=0.960)
[S7] START round=97 head_norm_before_train=1.878256 cos_to_last_merge=0.9738 (last merge round=39)
[S7] round=97 local utility u=0.576925 metrics={'f1_val': 0.6599617461133772, 'auprc': 0.8641151030207455, 'loss_val': 0.4011090105383415, 'psi': 0.7416230888763246}-{'f1_val': 0.5622839417109119, 'auprc': 0.7908985227577031, 'loss_val': 0.7492423314538474, 'psi': 0.6537297741296284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=97 head_norm_before_train=2.026241 cos_to_last_merge=0.9731 (last merge round=39)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9342056526951095, 'auprc': 0.9987608437529392, 'loss_val': 0.14486383524704147, 'psi': 0.9600277291182413}-{'f1_val': 0.9935462653440466, 'auprc': 0.999467937562354, 'loss_val': 0.024921062186039362, 'psi': 0.9959149342313696}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.200376 cos_to_last_merge=0.9775 (last merge round=33)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995812611922432, 'loss_val': 0.015329508102339066, 'psi': 0.997595121915141}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995710111028936, 'loss_val': 0.014935285457466373, 'psi': 0.9980901519484431}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.263761 cos_to_last_merge=0.9492 (last merge round=35)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=97 local utility u=0.000107 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939825058581444, 'loss_val': 0.035785206991634566, 'psi': 0.9937337961624144}-{'f1_val': 0.9935679896985945, 'auprc': 0.9936712689029641, 'loss_val': 0.03506611715158112, 'psi': 0.9936093013803423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=97 head_norm_before_train=2.446278 (no previous merge yet)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965767314303046, 'loss_val': 0.02023030970161833, 'psi': 0.9965711749558501}-{'f1_val': 0.9963958538641108, 'auprc': 0.9965866565924717, 'loss_val': 0.01858026809915693, 'psi': 0.9964721749554553}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.201649 (no previous merge yet)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.56307031064849, 'auprc': 0.5644636382682617, 'loss_val': 1.8097346602766038, 'psi': 0.5636276416963987}-{'f1_val': 0.7304221006409697, 'auprc': 0.8047550043840974, 'loss_val': 1.1410241984768315, 'psi': 0.7601552621382208}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.350031 (no previous merge yet)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9976914548345881, 'auprc': 0.9983894875838508, 'loss_val': 0.022416218202591043, 'psi': 0.9979706679342932}-{'f1_val': 0.9979900342899044, 'auprc': 0.9984465241870335, 'loss_val': 0.017424657722121675, 'psi': 0.998172630248756}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.301976 cos_to_last_merge=0.9701 (last merge round=40)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9803015267007522, 'loss_val': 0.3626946531822127, 'psi': 0.9335257391870161}-{'f1_val': 0.9023418808445254, 'auprc': 0.9811687601658062, 'loss_val': 0.3570227945574702, 'psi': 0.9338726325730378}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.093545 cos_to_last_merge=0.9456 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=97 local utility u=0.311390 metrics={'f1_val': 0.9924625634886286, 'auprc': 0.9954173651900939, 'loss_val': 0.0391036695952736, 'psi': 0.9936444841692147}-{'f1_val': 0.9261489594237167, 'auprc': 0.9854046330792232, 'loss_val': 0.23396378862446615, 'psi': 0.9498512288859192}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=97 head_norm_before_train=2.454168 (no previous merge yet)
[S17] round=97 local utility u=0.784954 metrics={'f1_val': 0.8747094486601167, 'auprc': 0.9779593100498293, 'loss_val': 0.5552493495965295, 'psi': 0.9160093932160017}-{'f1_val': 0.7101881915799153, 'auprc': 0.9377166106350039, 'loss_val': 1.0173019842803066, 'psi': 0.8011995592019507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=98 head_norm_before_train=2.360820 cos_to_last_merge=0.9802 (last merge round=35)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.662946485280164, 'auprc': 0.7565532090235958, 'loss_val': 1.411181104365245, 'psi': 0.7003891747775367}-{'f1_val': 0.7182026994138608, 'auprc': 0.7466634310977027, 'loss_val': 1.066330640897708, 'psi': 0.7295869920873976}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=1.917806 cos_to_last_merge=0.9120 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9709396572038869, 'auprc': 0.9981171147129619, 'loss_val': 0.11294113833217385, 'psi': 0.9818106402075168}-{'f1_val': 0.9824878465021035, 'auprc': 0.9987266114519646, 'loss_val': 0.09392156077925053, 'psi': 0.9889833524820479}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.142536 cos_to_last_merge=0.9707 (last merge round=40)
[S4] round=98 local utility u=0.072643 metrics={'f1_val': 0.9549221365359442, 'auprc': 0.9490851598325569, 'loss_val': 0.3479312843688166, 'psi': 0.9525873458545893}-{'f1_val': 0.9432365577476775, 'auprc': 0.9261981450978746, 'loss_val': 0.3544421598865853, 'psi': 0.9364211926877563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=98 head_norm_before_train=2.114061 cos_to_last_merge=0.9802 (last merge round=39)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9759861961303176, 'auprc': 0.9932569010150933, 'loss_val': 0.052794437269268565, 'psi': 0.9828944780842279}-{'f1_val': 0.9971410286679584, 'auprc': 0.9970679724602175, 'loss_val': 0.021025410309316164, 'psi': 0.9971118061848621}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.186351 cos_to_last_merge=0.9236 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.6482946262571773, 'auprc': 0.7459604167478602, 'loss_val': 1.1147501449681747, 'psi': 0.6873609424534504}-{'f1_val': 0.9760630705997638, 'auprc': 0.9346674885238158, 'loss_val': 0.1360020585683964, 'psi': 0.9595048377693847}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.882698 cos_to_last_merge=0.9735 (last merge round=39)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6326100033375377, 'auprc': 0.8086530157217771, 'loss_val': 0.5048802446171674, 'psi': 0.7030272082912334}-{'f1_val': 0.6599617461133772, 'auprc': 0.8641151030207455, 'loss_val': 0.4011090105383415, 'psi': 0.7416230888763246}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.029140 cos_to_last_merge=0.9730 (last merge round=39)
[S8] round=98 local utility u=0.250516 metrics={'f1_val': 0.9964900410640029, 'auprc': 0.9989003478260706, 'loss_val': 0.017956263665736914, 'psi': 0.9974541637688299}-{'f1_val': 0.9342056526951095, 'auprc': 0.9987608437529392, 'loss_val': 0.14486383524704147, 'psi': 0.9600277291182413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=98 head_norm_before_train=2.202474 cos_to_last_merge=0.9775 (last merge round=33)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.9995849320537441, 'loss_val': 0.024432913286306788, 'psi': 0.9948333289836337}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995812611922432, 'loss_val': 0.015329508102339066, 'psi': 0.997595121915141}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.269259 cos_to_last_merge=0.9488 (last merge round=35)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=98 local utility u=0.000117 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9939676443367513, 'loss_val': 0.035507086389378065, 'psi': 0.9937278515538572}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939825058581444, 'loss_val': 0.035785206991634566, 'psi': 0.9937337961624144}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=98 head_norm_before_train=2.450193 (no previous merge yet)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9539608397698958, 'auprc': 0.9958693302916988, 'loss_val': 0.15037135067333318, 'psi': 0.9707242359786169}-{'f1_val': 0.996567470639547, 'auprc': 0.9965767314303046, 'loss_val': 0.02023030970161833, 'psi': 0.9965711749558501}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.203137 (no previous merge yet)
[S13] round=98 local utility u=0.251706 metrics={'f1_val': 0.5893397249152867, 'auprc': 0.6522054218606911, 'loss_val': 1.7271647263116259, 'psi': 0.6144860036934485}-{'f1_val': 0.56307031064849, 'auprc': 0.5644636382682617, 'loss_val': 1.8097346602766038, 'psi': 0.5636276416963987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=98 head_norm_before_train=2.351424 (no previous merge yet)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9928599346709277, 'auprc': 0.9985876028643497, 'loss_val': 0.03838244654256635, 'psi': 0.9951510019482965}-{'f1_val': 0.9976914548345881, 'auprc': 0.9983894875838508, 'loss_val': 0.022416218202591043, 'psi': 0.9979706679342932}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.305634 cos_to_last_merge=0.9699 (last merge round=40)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.9791881272250548, 'loss_val': 0.3658366725526119, 'psi': 0.933080379396737}-{'f1_val': 0.9023418808445254, 'auprc': 0.9803015267007522, 'loss_val': 0.3626946531822127, 'psi': 0.9335257391870161}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.098809 cos_to_last_merge=0.9451 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9866220044270666, 'auprc': 0.990151315151447, 'loss_val': 0.06621489689485487, 'psi': 0.9880337287168188}-{'f1_val': 0.9924625634886286, 'auprc': 0.9954173651900939, 'loss_val': 0.0391036695952736, 'psi': 0.9936444841692147}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.453717 (no previous merge yet)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8606179542354311, 'auprc': 0.9895251023825922, 'loss_val': 0.6341642773146637, 'psi': 0.9121808134942955}-{'f1_val': 0.8747094486601167, 'auprc': 0.9779593100498293, 'loss_val': 0.5552493495965295, 'psi': 0.9160093932160017}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.364892 cos_to_last_merge=0.9801 (last merge round=35)
[S2] round=99 local utility u=0.429421 metrics={'f1_val': 0.7186520553956071, 'auprc': 0.7785576816518275, 'loss_val': 0.9525865899281838, 'psi': 0.7426143058980952}-{'f1_val': 0.662946485280164, 'auprc': 0.7565532090235958, 'loss_val': 1.411181104365245, 'psi': 0.7003891747775367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=100 psi=0.743 u=0.4294 p_local=0.1490 f1=0.719 auprc=0.779 bytes=66549
[S3] START round=99 head_norm_before_train=1.921087 cos_to_last_merge=0.9115 (last merge round=35)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.9640495489386744, 'auprc': 0.9988960578573238, 'loss_val': 0.09458205644682195, 'psi': 0.9779881525061342}-{'f1_val': 0.9709396572038869, 'auprc': 0.9981171147129619, 'loss_val': 0.11294113833217385, 'psi': 0.9818106402075168}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.978 u=0.0000 p_local=0.0434 f1=0.964 auprc=0.999 bytes=70129
[S4] START round=99 head_norm_before_train=2.149581 cos_to_last_merge=0.9714 (last merge round=40)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9407695310522123, 'auprc': 0.9315737783019933, 'loss_val': 0.40744524198731774, 'psi': 0.9370912299521247}-{'f1_val': 0.9549221365359442, 'auprc': 0.9490851598325569, 'loss_val': 0.3479312843688166, 'psi': 0.9525873458545893}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.937 u=0.0000 p_local=0.0521 f1=0.941 auprc=0.932 bytes=64885
[S5] START round=99 head_norm_before_train=2.121008 cos_to_last_merge=0.9796 (last merge round=39)
[S5] round=99 local utility u=0.086447 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9977203922416207, 'loss_val': 0.020220284093000213, 'psi': 0.9973727740974232}-{'f1_val': 0.9759861961303176, 'auprc': 0.9932569010150933, 'loss_val': 0.052794437269268565, 'psi': 0.9828944780842279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=100 psi=0.997 u=0.0864 p_local=0.0220 f1=0.997 auprc=0.998 bytes=81044
[S6] START round=99 head_norm_before_train=2.193926 cos_to_last_merge=0.9230 (last merge round=40)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=99 local utility u=1.000000 metrics={'f1_val': 0.9806005382537517, 'auprc': 0.946010283151499, 'loss_val': 0.10954661691788245, 'psi': 0.9667644362128507}-{'f1_val': 0.6482946262571773, 'auprc': 0.7459604167478602, 'loss_val': 1.1147501449681747, 'psi': 0.6873609424534504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S6] r=100 psi=0.967 u=1.0000 p_local=0.3449 f1=0.981 auprc=0.946 bytes=73743
[S7] START round=99 head_norm_before_train=1.888221 cos_to_last_merge=0.9731 (last merge round=39)
[S7] round=99 local utility u=0.589374 metrics={'f1_val': 0.7359809374004416, 'auprc': 0.9336440043855557, 'loss_val': 0.3213308808513512, 'psi': 0.8150461641944873}-{'f1_val': 0.6326100033375377, 'auprc': 0.8086530157217771, 'loss_val': 0.5048802446171674, 'psi': 0.7030272082912334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=100 psi=0.815 u=0.5894 p_local=0.3750 f1=0.736 auprc=0.934 bytes=68406
[S8] START round=99 head_norm_before_train=2.033725 cos_to_last_merge=0.9727 (last merge round=39)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9810068570578822, 'auprc': 0.9990106845644342, 'loss_val': 0.04970552827997171, 'psi': 0.9882083880605029}-{'f1_val': 0.9964900410640029, 'auprc': 0.9989003478260706, 'loss_val': 0.017956263665736914, 'psi': 0.9974541637688299}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.988 u=0.0000 p_local=0.0474 f1=0.981 auprc=0.999 bytes=75444
[S9] START round=99 head_norm_before_train=2.205946 cos_to_last_merge=0.9773 (last merge round=33)
[S9] round=99 local utility u=0.023041 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9995987255614363, 'loss_val': 0.01366740306529948, 'psi': 0.9983664242309608}-{'f1_val': 0.9916655936035601, 'auprc': 0.9995849320537441, 'loss_val': 0.024432913286306788, 'psi': 0.9948333289836337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] r=100 psi=0.998 u=0.0230 p_local=0.0069 f1=0.998 auprc=1.000 bytes=77418
[S10] START round=99 head_norm_before_train=2.273824 cos_to_last_merge=0.9484 (last merge round=35)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=99 local utility u=0.000691 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9936125098398865, 'loss_val': 0.034374897857649224, 'psi': 0.9937172770807676}-{'f1_val': 0.9935679896985945, 'auprc': 0.9939676443367513, 'loss_val': 0.035507086389378065, 'psi': 0.9937278515538572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=100 psi=0.994 u=0.0007 p_local=0.0002 f1=0.994 auprc=0.994 bytes=79168
[S11] START round=99 head_norm_before_train=2.449831 (no previous merge yet)
[S11] round=99 local utility u=0.189438 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9956705762398862, 'loss_val': 0.02405898498199002, 'psi': 0.9959607153424017}-{'f1_val': 0.9539608397698958, 'auprc': 0.9958693302916988, 'loss_val': 0.15037135067333318, 'psi': 0.9707242359786169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] r=100 psi=0.996 u=0.1894 p_local=0.0384 f1=0.996 auprc=0.996 bytes=70058
[S13] START round=99 head_norm_before_train=2.205161 (no previous merge yet)
[S13] round=99 local utility u=0.599503 metrics={'f1_val': 0.6691965678579999, 'auprc': 0.7393985854875218, 'loss_val': 1.2688791473780594, 'psi': 0.6972773749098087}-{'f1_val': 0.5893397249152867, 'auprc': 0.6522054218606911, 'loss_val': 1.7271647263116259, 'psi': 0.6144860036934485}
[S13] not sending this round → trigger blocked (psi=0.697)
[S13] r=100 psi=0.697 u=0.5995 p_local=0.2377 f1=0.669 auprc=0.739 bytes=68357
[S14] START round=99 head_norm_before_train=2.355416 (no previous merge yet)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9582443892196928, 'auprc': 0.9982439528229232, 'loss_val': 0.07375656096642008, 'psi': 0.9742442146609849}-{'f1_val': 0.9928599346709277, 'auprc': 0.9985876028643497, 'loss_val': 0.03838244654256635, 'psi': 0.9951510019482965}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.974 u=0.0000 p_local=0.0095 f1=0.958 auprc=0.998 bytes=66404
[S15] START round=99 head_norm_before_train=2.309210 cos_to_last_merge=0.9696 (last merge round=40)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9023418808445254, 'auprc': 0.979498516277598, 'loss_val': 0.3667894856460652, 'psi': 0.9332045350177545}-{'f1_val': 0.9023418808445254, 'auprc': 0.9791881272250548, 'loss_val': 0.3658366725526119, 'psi': 0.933080379396737}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.933 u=0.0000 p_local=0.0024 f1=0.902 auprc=0.979 bytes=59377
[S16] START round=99 head_norm_before_train=2.104672 cos_to_last_merge=0.9446 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9360386205244926, 'auprc': 0.9882498405259259, 'loss_val': 0.3879549802028267, 'psi': 0.9569231085250659}-{'f1_val': 0.9866220044270666, 'auprc': 0.990151315151447, 'loss_val': 0.06621489689485487, 'psi': 0.9880337287168188}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.957 u=0.0000 p_local=0.0691 f1=0.936 auprc=0.988 bytes=66627
[S17] START round=99 head_norm_before_train=2.452796 (no previous merge yet)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.6899969603126919, 'auprc': 0.9599557368939048, 'loss_val': 1.2084919350896017, 'psi': 0.797980470945177}-{'f1_val': 0.8606179542354311, 'auprc': 0.9895251023825922, 'loss_val': 0.6341642773146637, 'psi': 0.9121808134942955}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.798 u=0.0000 p_local=0.1960 f1=0.690 auprc=0.960 bytes=77106
[runner] rounds complete.
[runner] all agents stopped.
