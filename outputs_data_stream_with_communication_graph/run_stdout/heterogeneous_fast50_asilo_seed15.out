[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:33203
[S3] → join 127.0.0.1:33202
[S4] → join 127.0.0.1:33202
[S5] → join 127.0.0.1:33202
[S6] → join 127.0.0.1:33202
[S7] → join 127.0.0.1:33202
[S8] → join 127.0.0.1:33202
[S9] → join 127.0.0.1:33202
[S10] → join 127.0.0.1:33202
[S11] → join 127.0.0.1:33202
[S13] → join 127.0.0.1:33202
[S14] → join 127.0.0.1:33202
[S15] → join 127.0.0.1:33202
[S16] → join 127.0.0.1:33202
[S17] → join 127.0.0.1:33202
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.160856 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.153941 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.181306 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.194832 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.160204 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.178894 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.129255 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.102973 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.122242 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.154619 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.128083 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.190319 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.135102 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.195764 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.218785 (no previous merge yet)
[S16]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S6
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S11
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S13
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S17
[S4] + discovered S10
[S4] + discovered S15
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S8
[S4] + discovered S11
[S5] + discovered S2
[S5] + discovered S3
[S5] + discovered S4
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S11
[S5] + discovered S8
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S15
[S5] + discovered S17
[S5] + discovered S13
[S6] + discovered S2
[S6] + discovered S4
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S13
[S6] + discovered S17
[S6] + discovered S11
[S6] + discovered S7
[S6] + discovered S15
[S6] + discovered S16
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S10
[S6] + discovered S14
[S7] + discovered S6
[S7] + discovered S5
[S7] + discovered S4
[S7] + discovered S3
[S7] + discovered S2
[S8] + discovered S2
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S7
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S11
[S7] + discovered S13
[S8] + discovered S16
[S8] + discovered S9
[S9] + discovered S6
[S9] + discovered S3
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S11
[S8] + discovered S15
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S14
[S8] + discovered S17
[S10] + discovered S5
[S10] + discovered S4
[S9] + discovered S13
[S10] + discovered S3
[S10] + discovered S2
[S9] + discovered S11
[S10] + discovered S8
[S10] + discovered S6
[S9] + discovered S14
[S9] + discovered S17
[S10] + discovered S9
[S10] + discovered S7
[S9] + discovered S10
[S9] + discovered S16
[S9] + discovered S15
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S16
[S10] + discovered S14
[S11] + discovered S2
[S11] + discovered S8
[S11] + discovered S6
[S11] + discovered S3
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S5
[S10] + discovered S17
[S10] + discovered S11
[S11] + discovered S17
[S13] + discovered S9
[S11] + discovered S13
[S13] + discovered S10
[S13] + discovered S5
[S11] + discovered S15
[S13] + discovered S4
[S11] + discovered S16
[S13] + discovered S7
[S11] + discovered S14
[S13] + discovered S3
[S13] + discovered S6
[S13] + discovered S8
[S13] + discovered S11
[S13] + discovered S2
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S13] + discovered S14
[S14] + discovered S7
[S14] + discovered S13
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S11
[S14] + discovered S2
[S14] + discovered S9
[S14] + discovered S5
[S14] + discovered S10
[S14] + discovered S4
[S14] + discovered S8
[S15] + discovered S2
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S14
[S15] + discovered S13
[S15] + discovered S10
[S15] + discovered S7
[S14] + discovered S16
[S15] + discovered S5
[S15] + discovered S8
[S14] + discovered S17
[S14] + discovered S15
[S15] + discovered S9
[S15] + discovered S16
[S16] + discovered S7
[S16] + discovered S15
[S16] + discovered S10
[S16] + discovered S8
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S5
[S16] + discovered S6
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S10
[S17] + discovered S15
[S16] + discovered S17
[S17] + discovered S11
[S17] + discovered S5
[S17] + discovered S4
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S7
[S17] + discovered S14
[S17] + discovered S9
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:33210
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:33215
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:33217
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:33214
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:33204
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:33209
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:33212
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:33213
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:33216
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:33203
[S2] START round=1 head_norm_before_train=1.170461 (no previous merge yet)
[S2] round=1 local utility u=0.097350 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.775732589836789, 'loss_val': 1.259769457873014, 'psi': 0.3953593159678557}-{'f1_val': 0.1417771333885667, 'auprc': 0.7344048355293762, 'loss_val': 1.3304862331605316, 'psi': 0.37882821424489055}
[S3] START round=1 head_norm_before_train=1.164575 (no previous merge yet)
[S3] round=1 local utility u=0.306837 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7995352520046483, 'loss_val': 1.303616706199118, 'psi': 0.4037181401703236}-{'f1_val': 0.13984006561410703, 'auprc': 0.6070337361015516, 'loss_val': 1.3397854052007045, 'psi': 0.32671753380908486}
[S4] START round=1 head_norm_before_train=1.211169 (no previous merge yet)
[S4] round=1 local utility u=0.044699 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7662811552219737, 'loss_val': 1.243941968709325, 'psi': 0.3906484394259}-{'f1_val': 0.14022662889518414, 'auprc': 0.7585386362149409, 'loss_val': 1.3101131329009996, 'psi': 0.3875514318230869}
[S5] START round=1 head_norm_before_train=1.191844 (no previous merge yet)
[S5] round=1 local utility u=0.969461 metrics={'f1_val': 0.408511410584528, 'auprc': 0.7700717381403281, 'loss_val': 1.3279074575306609, 'psi': 0.5531355416068481}-{'f1_val': 0.0885440438156093, 'auprc': 0.7764211461368157, 'loss_val': 1.3660737458593424, 'psi': 0.3636948847440919}
[S6] START round=1 head_norm_before_train=1.176485 (no previous merge yet)
[S6] round=1 local utility u=0.184647 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7907151148416403, 'loss_val': 1.2793112428710096, 'psi': 0.4011418151674253}-{'f1_val': 0.14142628205128205, 'auprc': 0.6883147816809099, 'loss_val': 1.3414039152533863, 'psi': 0.36018168190313316}
[S7] START round=1 head_norm_before_train=1.183499 (no previous merge yet)
[S7] round=1 local utility u=0.347835 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.48135786378135526, 'loss_val': 1.323786414079902, 'psi': 0.2777772391499971}-{'f1_val': 0.14205682272909165, 'auprc': 0.25745990308476524, 'loss_val': 1.3477626752622303, 'psi': 0.1882180548713611}
[S8] START round=1 head_norm_before_train=1.132698 (no previous merge yet)
[S8] round=1 local utility u=1.000000 metrics={'f1_val': 0.41549694000722615, 'auprc': 0.770744444524726, 'loss_val': 1.3003575711953583, 'psi': 0.5575959418142261}-{'f1_val': 0.13178548070634402, 'auprc': 0.6459400370690326, 'loss_val': 1.3705372338780435, 'psi': 0.3374473032514194}
[S9] START round=1 head_norm_before_train=1.109145 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8657989621935869, 'loss_val': 1.2982321698207588, 'psi': 0.43115835916143236}-{'f1_val': 0.141397957139996, 'auprc': 0.9700426988940027, 'loss_val': 1.342670710369303, 'psi': 0.47285585384159873}
[S10] START round=1 head_norm_before_train=1.132762 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7346291373724374, 'loss_val': 1.2817160831471914, 'psi': 0.3770246374740093}-{'f1_val': 0.3940578631013538, 'auprc': 0.5683093800601409, 'loss_val': 1.341145484261305, 'psi': 0.46375846988486863}
[S11] START round=1 head_norm_before_train=1.163590 (no previous merge yet)
[S11] round=1 local utility u=0.029258 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7756203265833888, 'loss_val': 1.3154455560447944, 'psi': 0.3944963406572219}-{'f1_val': 0.14444474553960077, 'auprc': 0.7596660168696964, 'loss_val': 1.3502841283663434, 'psi': 0.390533254071639}
[S13] START round=1 head_norm_before_train=1.134976 (no previous merge yet)
[S13] round=1 local utility u=0.091030 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7058439781741832, 'loss_val': 1.2848478474249, 'psi': 0.36656904881590513}-{'f1_val': 0.1403857625770531, 'auprc': 0.6645676295015241, 'loss_val': 1.343078296854823, 'psi': 0.3500585093468415}
[S14] START round=1 head_norm_before_train=1.197128 (no previous merge yet)
[S14] round=1 local utility u=0.022844 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6016658623703721, 'loss_val': 1.334328090918525, 'psi': 0.3248810566777711}-{'f1_val': 0.14035785288270378, 'auprc': 0.5948340591323231, 'loss_val': 1.3595211728653085, 'psi': 0.3221483353825515}
[S15] START round=1 head_norm_before_train=1.155880 (no previous merge yet)
[S15] round=1 local utility u=0.053614 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7725879721001364, 'loss_val': 1.2812607386909949, 'psi': 0.3928753796569896}-{'f1_val': 0.13973365136155833, 'auprc': 0.7539832774984196, 'loss_val': 1.332675531896686, 'psi': 0.38543350181630287}
[S16] START round=1 head_norm_before_train=1.198753 (no previous merge yet)
[S16] round=1 local utility u=0.455380 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.5720074968934781, 'loss_val': 1.3295317883260906, 'psi': 0.3131854688769131}-{'f1_val': 0.09198542805100182, 'auprc': 0.3760628599714224, 'loss_val': 1.360546482802628, 'psi': 0.20561640081917007}
[S17] START round=1 head_norm_before_train=1.228534 (no previous merge yet)
[S17] round=1 local utility u=0.260451 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.525138328576377, 'loss_val': 1.2931924564832948, 'psi': 0.2946247094209814}-{'f1_val': 0.09718183851487364, 'auprc': 0.4583422731736, 'loss_val': 1.3511044832008385, 'psi': 0.2416460123783642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:33210
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:33207
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:33209
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:33204
[S3] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1791 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1791) from S11
[S2] cosine check vs S11: cos=0.0205
[S4] RECEIVED delta(kind=head bytes=1789) from S7
[S4] cosine check vs S7: cos=-0.0217
[S4] DROPPED delta from S7 (cos=-0.0217 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S3
[S10] cosine check vs S3: cos=-0.0329
[S10] DROPPED delta from S3 (cos=-0.0329 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S2
[S8] cosine check vs S2: cos=-0.0735
[S8] DROPPED delta from S2 (cos=-0.0735 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S4
[S6] cosine check vs S4: cos=0.0123
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=-0.0258
[S11] DROPPED delta from S6 (cos=-0.0258 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S14
[S7] cosine check vs S14: cos=-0.0048
[S7] DROPPED delta from S14 (cos=-0.0048 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=-0.0435
[S11] DROPPED delta from S15 (cos=-0.0435 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=0.0543
[S9] RECEIVED delta(kind=head bytes=1788) from S16
[S9] cosine check vs S16: cos=0.0707
[S2] RECEIVED delta(kind=head bytes=1799) from S8
[S2] cosine check vs S8: cos=-0.0735
[S2] DROPPED delta from S8 (cos=-0.0735 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S13
[S9] cosine check vs S13: cos=0.0059
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:33202
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1790) from S17
[S2] cosine check vs S17: cos=0.0300
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.127418
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.349773e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.679731 delta_norm=0.634977
[S9] aggregate: ACCEPT kept=['S5', 'S16', 'S13'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.207717
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.375453e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.762564 delta_norm=0.737545
[S2] aggregate: ACCEPT kept=['S11', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.212269
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.680924e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.878845 delta_norm=0.868092
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.762564 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6181063309504525, 'loss_val': 1.225646431143327, 'psi': 0.33230881241332105}-{'f1_val': 0.1417771333885667, 'auprc': 0.775732589836789, 'loss_val': 1.259769457873014, 'psi': 0.3953593159678557}
[S3] START round=2 head_norm_before_train=1.182979 (no previous merge yet)
[S3] round=2 local utility u=0.022080 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7995260301749769, 'loss_val': 1.2594287469089938, 'psi': 0.40371445143845497}-{'f1_val': 0.13984006561410703, 'auprc': 0.7995352520046483, 'loss_val': 1.303616706199118, 'psi': 0.4037181401703236}
[S4] START round=2 head_norm_before_train=1.257899 (no previous merge yet)
[S4] round=2 local utility u=0.799265 metrics={'f1_val': 0.3956638442408296, 'auprc': 0.7462595401965717, 'loss_val': 1.1179696585491183, 'psi': 0.5359021226231264}-{'f1_val': 0.14022662889518414, 'auprc': 0.7662811552219737, 'loss_val': 1.243941968709325, 'psi': 0.3906484394259}
[S5] START round=2 head_norm_before_train=1.199092 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700640299252021, 'loss_val': 1.2830423075920812, 'psi': 0.3933827548272237}-{'f1_val': 0.408511410584528, 'auprc': 0.7700717381403281, 'loss_val': 1.3279074575306609, 'psi': 0.5531355416068481}
[S6] START round=2 head_norm_before_train=0.878845 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6038678795491698, 'loss_val': 1.24778100036074, 'psi': 0.3264029210504371}-{'f1_val': 0.14142628205128205, 'auprc': 0.7907151148416403, 'loss_val': 1.2793112428710096, 'psi': 0.4011418151674253}
[S7] START round=2 head_norm_before_train=1.196054 (no previous merge yet)
[S7] round=2 local utility u=0.308903 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6782288765030032, 'loss_val': 1.2965938327341004, 'psi': 0.3565256442386563}-{'f1_val': 0.14205682272909165, 'auprc': 0.48135786378135526, 'loss_val': 1.323786414079902, 'psi': 0.2777772391499971}
[S8] START round=2 head_norm_before_train=1.156871 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.18134376720864853, 'auprc': 0.7660301966130574, 'loss_val': 1.1853158256557803, 'psi': 0.41521833897041205}-{'f1_val': 0.41549694000722615, 'auprc': 0.770744444524726, 'loss_val': 1.3003575711953583, 'psi': 0.5575959418142261}
[S9] START round=2 head_norm_before_train=0.679731 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.142944 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9592885957151601, 'loss_val': 1.2928131791741364, 'psi': 0.4685542125700617}-{'f1_val': 0.141397957139996, 'auprc': 0.8657989621935869, 'loss_val': 1.2982321698207588, 'psi': 0.43115835916143236}
[S10] START round=2 head_norm_before_train=1.164029 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6820746930561813, 'loss_val': 1.1951945073079333, 'psi': 0.3560028597475069}-{'f1_val': 0.13862163754172394, 'auprc': 0.7346291373724374, 'loss_val': 1.2817160831471914, 'psi': 0.3770246374740093}
[S11] START round=2 head_norm_before_train=1.181161 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7408184540919865, 'loss_val': 1.273062855391939, 'psi': 0.38057559166066096}-{'f1_val': 0.14041368337311058, 'auprc': 0.7756203265833888, 'loss_val': 1.3154455560447944, 'psi': 0.3944963406572219}
[S13] START round=2 head_norm_before_train=1.167091 (no previous merge yet)
[S13] round=2 local utility u=0.011796 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6961653921594484, 'loss_val': 1.232220133493608, 'psi': 0.3626976144100112}-{'f1_val': 0.1403857625770531, 'auprc': 0.7058439781741832, 'loss_val': 1.2848478474249, 'psi': 0.36656904881590513}
[S14] START round=2 head_norm_before_train=1.211992 (no previous merge yet)
[S14] round=2 local utility u=0.109181 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6655128530825574, 'loss_val': 1.3075077806337632, 'psi': 0.3504198529626452}-{'f1_val': 0.14035785288270378, 'auprc': 0.6016658623703721, 'loss_val': 1.334328090918525, 'psi': 0.3248810566777711}
[S15] START round=2 head_norm_before_train=1.198031 (no previous merge yet)
[S15] round=2 local utility u=0.056538 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7872615933338617, 'loss_val': 1.212204818180686, 'psi': 0.3987448281504797}-{'f1_val': 0.13973365136155833, 'auprc': 0.7725879721001364, 'loss_val': 1.2812607386909949, 'psi': 0.3928753796569896}
[S16] START round=2 head_norm_before_train=1.210825 (no previous merge yet)
[S16] round=2 local utility u=0.170313 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.673952303287024, 'loss_val': 1.294741013928278, 'psi': 0.35396339143433153}-{'f1_val': 0.14063745019920318, 'auprc': 0.5720074968934781, 'loss_val': 1.3295317883260906, 'psi': 0.3131854688769131}
[S17] START round=2 head_norm_before_train=1.266264 (no previous merge yet)
[S17] round=2 local utility u=0.340889 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7180382965873745, 'loss_val': 1.1901140904315675, 'psi': 0.37178469662538044}-{'f1_val': 0.14094896331738438, 'auprc': 0.525138328576377, 'loss_val': 1.2931924564832948, 'psi': 0.2946247094209814}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.536)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.357)
[S16] not sending this round → trigger blocked (psi=0.354)
[S15] not sending this round → trigger blocked (psi=0.399)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:33205
[S3] not sending this round → trigger blocked (psi=0.404)
[S13] not sending this round → trigger blocked (psi=0.363)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.350)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S9
[S5] cosine check vs S9: cos=0.3232
[S17] not sending this round → trigger blocked (psi=0.372)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.214976
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.960201e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.795614 delta_norm=0.596020
[S5] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.813317 cos_to_last_merge=0.9902 (last merge round=1)
[S2] round=3 local utility u=0.257165 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7622798255659748, 'loss_val': 1.1438362095164312, 'psi': 0.38997821025953}-{'f1_val': 0.1417771333885667, 'auprc': 0.6181063309504525, 'loss_val': 1.225646431143327, 'psi': 0.33230881241332105}
[S3] START round=3 head_norm_before_train=1.208267 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.6372614453054926, 'loss_val': 1.212969811183798, 'psi': 0.33880861749066127}-{'f1_val': 0.13984006561410703, 'auprc': 0.7995260301749769, 'loss_val': 1.2594287469089938, 'psi': 0.40371445143845497}
[S4] START round=3 head_norm_before_train=1.322464 (no previous merge yet)
[S4] round=3 local utility u=0.883010 metrics={'f1_val': 0.6957908463328356, 'auprc': 0.6397978500775326, 'loss_val': 0.833327182774295, 'psi': 0.6733936478307144}-{'f1_val': 0.3956638442408296, 'auprc': 0.7462595401965717, 'loss_val': 1.1179696585491183, 'psi': 0.5359021226231264}
[S5] START round=3 head_norm_before_train=0.795614 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.005370 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700373998746107, 'loss_val': 1.272222566864798, 'psi': 0.39337210280698715}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700640299252021, 'loss_val': 1.2830423075920812, 'psi': 0.3933827548272237}
[S6] START round=3 head_norm_before_train=0.919828 cos_to_last_merge=0.9948 (last merge round=1)
[S6] round=3 local utility u=0.099766 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.643070565526584, 'loss_val': 1.1658562889222481, 'psi': 0.34208399544140283}-{'f1_val': 0.14142628205128205, 'auprc': 0.6038678795491698, 'loss_val': 1.24778100036074, 'psi': 0.3264029210504371}
[S7] START round=3 head_norm_before_train=1.217673 (no previous merge yet)
[S7] round=3 local utility u=0.171612 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7835843268176873, 'loss_val': 1.2694353731006298, 'psi': 0.3986678243645299}-{'f1_val': 0.14205682272909165, 'auprc': 0.6782288765030032, 'loss_val': 1.2965938327341004, 'psi': 0.3565256442386563}
[S8] START round=3 head_norm_before_train=1.202646 (no previous merge yet)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.6342815958130769, 'auprc': 0.7769050314368939, 'loss_val': 1.0088835443815793, 'psi': 0.6913309700626037}-{'f1_val': 0.18134376720864853, 'auprc': 0.7660301966130574, 'loss_val': 1.1853158256557803, 'psi': 0.41521833897041205}
[S9] START round=3 head_norm_before_train=0.707329 cos_to_last_merge=0.9954 (last merge round=1)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8659434602461772, 'loss_val': 1.2311222432604323, 'psi': 0.4312161583824685}-{'f1_val': 0.141397957139996, 'auprc': 0.9592885957151601, 'loss_val': 1.2928131791741364, 'psi': 0.4685542125700617}
[S10] START round=3 head_norm_before_train=1.213021 (no previous merge yet)
[S10] round=3 local utility u=0.869265 metrics={'f1_val': 0.41597454042981274, 'auprc': 0.6617997185160298, 'loss_val': 1.0599575204353142, 'psi': 0.5143046116642995}-{'f1_val': 0.13862163754172394, 'auprc': 0.6820746930561813, 'loss_val': 1.1951945073079333, 'psi': 0.3560028597475069}
[S11] START round=3 head_norm_before_train=1.207845 (no previous merge yet)
[S11] round=3 local utility u=0.001508 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7248232256560008, 'loss_val': 1.2220603630274924, 'psi': 0.3741775002862667}-{'f1_val': 0.14041368337311058, 'auprc': 0.7408184540919865, 'loss_val': 1.273062855391939, 'psi': 0.38057559166066096}
[S13] START round=3 head_norm_before_train=1.208809 (no previous merge yet)
[S13] round=3 local utility u=0.075437 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7147560438338967, 'loss_val': 1.137117315709906, 'psi': 0.3701338750797905}-{'f1_val': 0.1403857625770531, 'auprc': 0.6961653921594484, 'loss_val': 1.232220133493608, 'psi': 0.3626976144100112}
[S14] START round=3 head_norm_before_train=1.235160 (no previous merge yet)
[S14] round=3 local utility u=0.210020 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7959483077405372, 'loss_val': 1.2787734197213585, 'psi': 0.4025940348258371}-{'f1_val': 0.14035785288270378, 'auprc': 0.6655128530825574, 'loss_val': 1.3075077806337632, 'psi': 0.3504198529626452}
[S15] START round=3 head_norm_before_train=1.247803 (no previous merge yet)
[S15] round=3 local utility u=0.922024 metrics={'f1_val': 0.4180722019523599, 'auprc': 0.7770182695365657, 'loss_val': 1.0074591224187397, 'psi': 0.5616506289860422}-{'f1_val': 0.13973365136155833, 'auprc': 0.7872615933338617, 'loss_val': 1.212204818180686, 'psi': 0.3987448281504797}
[S16] START round=3 head_norm_before_train=1.231250 (no previous merge yet)
[S16] round=3 local utility u=0.022688 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6750378425334821, 'loss_val': 1.2526216380141932, 'psi': 0.3543976071329148}-{'f1_val': 0.14063745019920318, 'auprc': 0.673952303287024, 'loss_val': 1.294741013928278, 'psi': 0.35396339143433153}
[S17] START round=3 head_norm_before_train=1.323915 (no previous merge yet)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.4160871497351339, 'auprc': 0.7692227574847291, 'loss_val': 0.9706776484651412, 'psi': 0.557341392834972}-{'f1_val': 0.14094896331738438, 'auprc': 0.7180382965873745, 'loss_val': 1.1901140904315675, 'psi': 0.37178469662538044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:33217
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S5] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S11] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=-0.0314
[S4] DROPPED delta from S13 (cos=-0.0314 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1790) from S14
[S15] cosine check vs S14: cos=-0.0982
[S15] DROPPED delta from S14 (cos=-0.0982 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.0042
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0303
[S17] DROPPED delta from S8 (cos=-0.0303 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1788) from S5
[S16] cosine check vs S5: cos=0.1505
[S17] RECEIVED delta(kind=head bytes=1789) from S16
[S17] cosine check vs S16: cos=-0.0983
[S17] DROPPED delta from S16 (cos=-0.0983 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0340
[S10] DROPPED delta from S4 (cos=-0.0340 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=-0.0292
[S11] DROPPED delta from S15 (cos=-0.0292 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.0647
[S13] RECEIVED delta(kind=head bytes=1804) from S11
[S13] cosine check vs S11: cos=-0.0646
[S13] DROPPED delta from S11 (cos=-0.0646 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] cosine check vs S10: cos=-0.0352
[S3] DROPPED delta from S10 (cos=-0.0352 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S2
[S13] cosine check vs S2: cos=-0.0330
[S13] DROPPED delta from S2 (cos=-0.0330 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=0.0199
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=3 metric=0.1398 head_norm=1.238419
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.178678e-01
[S3] stored merged vector for next round verification (round=3)
[S3] DEBUG after merge:  round=3 metric=0.1398 head_norm=0.936166 delta_norm=0.917868
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.255962
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.959935e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.799403 delta_norm=0.695994
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.262607
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.844242e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.888143 delta_norm=0.884424
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.241859
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.592822e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.808382 delta_norm=0.759282
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.856405 cos_to_last_merge=0.9768 (last merge round=1)
[S2] round=4 local utility u=0.910881 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7658398419022163, 'loss_val': 0.9824576384181845, 'psi': 0.556372485177213}-{'f1_val': 0.1417771333885667, 'auprc': 0.7622798255659748, 'loss_val': 1.1438362095164312, 'psi': 0.38997821025953}
[S3] START round=4 head_norm_before_train=0.936166 cos_to_last_merge=1.0000 (last merge round=3)
[S3] round=4 local utility u=0.230578 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7957278530521559, 'loss_val': 1.2272124384671268, 'psi': 0.4021951805893266}-{'f1_val': 0.13984006561410703, 'auprc': 0.6372614453054926, 'loss_val': 1.212969811183798, 'psi': 0.33880861749066127}
[S4] START round=4 head_norm_before_train=1.409537 (no previous merge yet)
[S4] round=4 local utility u=0.194449 metrics={'f1_val': 0.6708717709222465, 'auprc': 0.7483224900894472, 'loss_val': 0.6204892661329118, 'psi': 0.7018520585891268}-{'f1_val': 0.6957908463328356, 'auprc': 0.6397978500775326, 'loss_val': 0.833327182774295, 'psi': 0.6733936478307144}
[S5] START round=4 head_norm_before_train=0.818209 cos_to_last_merge=0.9967 (last merge round=2)
[S5] round=4 local utility u=0.025794 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7697662333784004, 'loss_val': 1.219821233639961, 'psi': 0.3932636362085031}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700373998746107, 'loss_val': 1.272222566864798, 'psi': 0.39337210280698715}
[S6] START round=4 head_norm_before_train=0.958001 cos_to_last_merge=0.9848 (last merge round=1)
[S6] round=4 local utility u=0.929399 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.6474140962266471, 'loss_val': 0.9762689543103894, 'psi': 0.5094393468119007}-{'f1_val': 0.14142628205128205, 'auprc': 0.643070565526584, 'loss_val': 1.1658562889222481, 'psi': 0.34208399544140283}
[S7] START round=4 head_norm_before_train=1.244119 (no previous merge yet)
[S7] round=4 local utility u=0.018930 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7881471054943798, 'loss_val': 1.2452645300630616, 'psi': 0.40049293583520695}-{'f1_val': 0.14205682272909165, 'auprc': 0.7835843268176873, 'loss_val': 1.2694353731006298, 'psi': 0.3986678243645299}
[S8] START round=4 head_norm_before_train=1.253878 (no previous merge yet)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.79240628374441, 'loss_val': 0.8119151210037094, 'psi': 0.5408021496076288}-{'f1_val': 0.6342815958130769, 'auprc': 0.7769050314368939, 'loss_val': 1.0088835443815793, 'psi': 0.6913309700626037}
[S9] START round=4 head_norm_before_train=0.747387 cos_to_last_merge=0.9836 (last merge round=1)
[S9] round=4 local utility u=0.025623 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656110390808189, 'loss_val': 1.17887925644349, 'psi': 0.4310831899163252}-{'f1_val': 0.141397957139996, 'auprc': 0.8659434602461772, 'loss_val': 1.2311222432604323, 'psi': 0.4312161583824685}
[S10] START round=4 head_norm_before_train=1.262693 (no previous merge yet)
[S10] round=4 local utility u=0.427207 metrics={'f1_val': 0.41145576934582695, 'auprc': 0.8634697064255353, 'loss_val': 0.7834401551867817, 'psi': 0.5922613441777103}-{'f1_val': 0.41597454042981274, 'auprc': 0.6617997185160298, 'loss_val': 1.0599575204353142, 'psi': 0.5143046116642995}
[S11] START round=4 head_norm_before_train=0.808382 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7129420883417892, 'loss_val': 1.2144879835504154, 'psi': 0.369425045360582}-{'f1_val': 0.14041368337311058, 'auprc': 0.7248232256560008, 'loss_val': 1.2220603630274924, 'psi': 0.3741775002862667}
[S13] START round=4 head_norm_before_train=1.236261 (no previous merge yet)
[S13] round=4 local utility u=0.898640 metrics={'f1_val': 0.38752096306513895, 'auprc': 0.7615885749092229, 'loss_val': 0.9631455502261017, 'psi': 0.5371480078027726}-{'f1_val': 0.1403857625770531, 'auprc': 0.7147560438338967, 'loss_val': 1.137117315709906, 'psi': 0.3701338750797905}
[S14] START round=4 head_norm_before_train=0.888143 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.776207056160551, 'loss_val': 1.2875440425959024, 'psi': 0.3946975341938427}-{'f1_val': 0.14035785288270378, 'auprc': 0.7959483077405372, 'loss_val': 1.2787734197213585, 'psi': 0.4025940348258371}
[S15] START round=4 head_norm_before_train=1.316311 (no previous merge yet)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.7029598297059133, 'auprc': 0.9035146752392281, 'loss_val': 0.6367101587388792, 'psi': 0.7831817679192392}-{'f1_val': 0.4180722019523599, 'auprc': 0.7770182695365657, 'loss_val': 1.0074591224187397, 'psi': 0.5616506289860422}
[S16] START round=4 head_norm_before_train=0.799403 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.46154253067057804, 'loss_val': 1.2382345308304068, 'psi': 0.2689994823877532}-{'f1_val': 0.14063745019920318, 'auprc': 0.6750378425334821, 'loss_val': 1.2526216380141932, 'psi': 0.3543976071329148}
[S17] START round=4 head_norm_before_train=1.379889 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.35303726790928325, 'auprc': 0.7730668689423009, 'loss_val': 0.876781729633058, 'psi': 0.5210491083224903}-{'f1_val': 0.4160871497351339, 'auprc': 0.7692227574847291, 'loss_val': 0.9706776484651412, 'psi': 0.557341392834972}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.592)
[S4] not sending this round → trigger blocked (psi=0.702)
[S2] not sending this round → trigger blocked (psi=0.556)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.537)
[S5] not sending this round → trigger blocked (psi=0.393)
[S7] not sending this round → trigger blocked (psi=0.400)
[S6] not sending this round → trigger blocked (psi=0.509)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.783)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33210
[S3] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.0509
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=0.0524
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.794700
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.052471e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.637297 delta_norm=0.605247
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.3530 head_norm=1.444877
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.065885e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.3515 head_norm=0.842036 delta_norm=0.806588
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.923776 cos_to_last_merge=0.9555 (last merge round=1)
[S2] round=5 local utility u=0.786500 metrics={'f1_val': 0.6401137769695862, 'auprc': 0.779080086493827, 'loss_val': 0.7894952543700227, 'psi': 0.6957003007792825}-{'f1_val': 0.4167275806938775, 'auprc': 0.7658398419022163, 'loss_val': 0.9824576384181845, 'psi': 0.556372485177213}
[S3] START round=5 head_norm_before_train=0.955717 cos_to_last_merge=0.9977 (last merge round=3)
[S3] round=5 local utility u=0.039827 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7961307789371239, 'loss_val': 1.1487671617632103, 'psi': 0.4023563509433138}-{'f1_val': 0.13984006561410703, 'auprc': 0.7957278530521559, 'loss_val': 1.2272124384671268, 'psi': 0.4021951805893266}
[S4] START round=5 head_norm_before_train=1.494426 (no previous merge yet)
[S4] round=5 local utility u=0.377117 metrics={'f1_val': 0.687983860984759, 'auprc': 0.9009677296471682, 'loss_val': 0.4268630502212356, 'psi': 0.7731774084497227}-{'f1_val': 0.6708717709222465, 'auprc': 0.7483224900894472, 'loss_val': 0.6204892661329118, 'psi': 0.7018520585891268}
[S5] START round=5 head_norm_before_train=0.849590 cos_to_last_merge=0.9879 (last merge round=2)
[S5] round=5 local utility u=0.032572 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.771245663739825, 'loss_val': 1.1591149718123142, 'psi': 0.39385540835307287}-{'f1_val': 0.14226190476190476, 'auprc': 0.7697662333784004, 'loss_val': 1.219821233639961, 'psi': 0.3932636362085031}
[S6] START round=5 head_norm_before_train=1.014626 cos_to_last_merge=0.9690 (last merge round=1)
[S6] round=5 local utility u=0.286661 metrics={'f1_val': 0.4171358730402079, 'auprc': 0.7916216598813964, 'loss_val': 0.8336474726030714, 'psi': 0.5669301877766832}-{'f1_val': 0.41745618053540323, 'auprc': 0.6474140962266471, 'loss_val': 0.9762689543103894, 'psi': 0.5094393468119007}
[S7] START round=5 head_norm_before_train=1.270419 (no previous merge yet)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7590704817936709, 'loss_val': 1.2137563042769406, 'psi': 0.38886228635492337}-{'f1_val': 0.14205682272909165, 'auprc': 0.7881471054943798, 'loss_val': 1.2452645300630616, 'psi': 0.40049293583520695}
[S8] START round=5 head_norm_before_train=1.321083 (no previous merge yet)
[S8] round=5 local utility u=0.349187 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9935159826707161, 'loss_val': 0.7152647542402639, 'psi': 0.6210854220460185}-{'f1_val': 0.37306606018310795, 'auprc': 0.79240628374441, 'loss_val': 0.8119151210037094, 'psi': 0.5408021496076288}
[S9] START round=5 head_norm_before_train=0.637297 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8125143280675908, 'loss_val': 1.1634267243891714, 'psi': 0.40984450551103396}-{'f1_val': 0.141397957139996, 'auprc': 0.8656110390808189, 'loss_val': 1.17887925644349, 'psi': 0.4310831899163252}
[S10] START round=5 head_norm_before_train=1.329637 (no previous merge yet)
[S10] round=5 local utility u=0.991732 metrics={'f1_val': 0.699492212063004, 'auprc': 0.8643568880111606, 'loss_val': 0.5308567257587273, 'psi': 0.7654380824422666}-{'f1_val': 0.41145576934582695, 'auprc': 0.8634697064255353, 'loss_val': 0.7834401551867817, 'psi': 0.5922613441777103}
[S11] START round=5 head_norm_before_train=0.841743 cos_to_last_merge=0.9973 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6519245583756188, 'loss_val': 1.1173924694521662, 'psi': 0.34501803337411385}-{'f1_val': 0.14041368337311058, 'auprc': 0.7129420883417892, 'loss_val': 1.2144879835504154, 'psi': 0.369425045360582}
[S13] START round=5 head_norm_before_train=1.273313 (no previous merge yet)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.37169029467602305, 'auprc': 0.7168848072809122, 'loss_val': 0.8435692779494895, 'psi': 0.5097680997179788}-{'f1_val': 0.38752096306513895, 'auprc': 0.7615885749092229, 'loss_val': 0.9631455502261017, 'psi': 0.5371480078027726}
[S14] START round=5 head_norm_before_train=0.912492 cos_to_last_merge=0.9982 (last merge round=3)
[S14] round=5 local utility u=0.044462 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7936700199525442, 'loss_val': 1.251008325105789, 'psi': 0.40168271971063996}-{'f1_val': 0.14035785288270378, 'auprc': 0.776207056160551, 'loss_val': 1.2875440425959024, 'psi': 0.3946975341938427}
[S15] START round=5 head_norm_before_train=1.391642 (no previous merge yet)
[S15] round=5 local utility u=0.224167 metrics={'f1_val': 0.6987247968657844, 'auprc': 0.9942846122857321, 'loss_val': 0.4352766535541606, 'psi': 0.8169487230337635}-{'f1_val': 0.7029598297059133, 'auprc': 0.9035146752392281, 'loss_val': 0.6367101587388792, 'psi': 0.7831817679192392}
[S16] START round=5 head_norm_before_train=0.830846 cos_to_last_merge=0.9974 (last merge round=3)
[S16] round=5 local utility u=0.018991 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.4497446667624958, 'loss_val': 1.164858498437955, 'psi': 0.26428033682452023}-{'f1_val': 0.14063745019920318, 'auprc': 0.46154253067057804, 'loss_val': 1.2382345308304068, 'psi': 0.2689994823877532}
[S17] START round=5 head_norm_before_train=0.842036 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.35178769764069184, 'auprc': 0.7796022017504187, 'loss_val': 0.9019180007169239, 'psi': 0.5229134992845826}-{'f1_val': 0.35303726790928325, 'auprc': 0.7730668689423009, 'loss_val': 0.876781729633058, 'psi': 0.5210491083224903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:33212
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:33215
[S5] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.5984
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=0.0353
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.7396
[S11] RECEIVED delta(kind=head bytes=1797) from S15
[S11] cosine check vs S15: cos=0.0725
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] cosine check vs S4: cos=-0.0748
[S10] DROPPED delta from S4 (cos=-0.0748 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] cosine check vs S16: cos=0.2283
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=-0.0292
[S13] DROPPED delta from S2 (cos=-0.0292 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1803) from S6
[S11] cosine check vs S6: cos=0.5934
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.0171
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.0141
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.490 → S4@127.0.0.1:33204
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.885744
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.169501e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.771526 delta_norm=0.516950
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.330 → S13@127.0.0.1:33213
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.675186
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.309565e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.774140 delta_norm=0.330957
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.346 → S17@127.0.0.1:33217
[S7] ⇄ pheromone p=0.413 → S14@127.0.0.1:33214
[S8] ⇄ pheromone p=0.607 → S17@127.0.0.1:33217
[S4] ⇄ pheromone p=0.633 → S10@127.0.0.1:33211
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.867602
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.896697e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.777394 delta_norm=0.389670
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.389 → S17@127.0.0.1:33217
[S2] ⇄ pheromone p=0.672 → S13@127.0.0.1:33213
[S10] ⇄ pheromone p=0.706 → S3@127.0.0.1:33203
[S6] ⇄ pheromone p=0.562 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.418 → S16@127.0.0.1:33216
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.6987 head_norm=1.469759
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.592774e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.6999 head_norm=0.887296 delta_norm=0.859277
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.661 → S11@127.0.0.1:33212
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=5 metric=0.1398 head_norm=0.980701
[S3] _apply_head_vector_avg (torch): Δ‖w‖=8.501220e-01
[S3] stored merged vector for next round verification (round=5)
[S3] DEBUG after merge:  round=5 metric=0.1398 head_norm=0.863851 delta_norm=0.850122
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.400 → S9@127.0.0.1:33210
[S14] ⇄ pheromone p=0.377 → S15@127.0.0.1:33215
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.3518 head_norm=0.923345
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.823907e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.3522 head_norm=0.663110 delta_norm=0.582391
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.512 → S3@127.0.0.1:33203
[S2] START round=6 head_norm_before_train=0.999075 cos_to_last_merge=0.9314 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.931
[S2] round=6 local utility u=0.226679 metrics={'f1_val': 0.700928966771822, 'auprc': 0.7395900289858242, 'loss_val': 0.5825586496718879, 'psi': 0.7163933916574229}-{'f1_val': 0.6401137769695862, 'auprc': 0.779080086493827, 'loss_val': 0.7894952543700227, 'psi': 0.6957003007792825}
[S3] START round=6 head_norm_before_train=0.863851 cos_to_last_merge=1.0000 (last merge round=5)
[S3] round=6 local utility u=0.012025 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7955650180566717, 'loss_val': 1.123019697611907, 'psi': 0.40213004659113294}-{'f1_val': 0.13984006561410703, 'auprc': 0.7961307789371239, 'loss_val': 1.1487671617632103, 'psi': 0.4023563509433138}
[S4] START round=6 head_norm_before_train=1.576875 (no previous merge yet)
[S4] round=6 local utility u=0.063054 metrics={'f1_val': 0.680569567499379, 'auprc': 0.9284619605110791, 'loss_val': 0.33875155166101006, 'psi': 0.779726524704059}-{'f1_val': 0.687983860984759, 'auprc': 0.9009677296471682, 'loss_val': 0.4268630502212356, 'psi': 0.7731774084497227}
[S5] START round=6 head_norm_before_train=0.871571 cos_to_last_merge=0.9813 (last merge round=2)
[S5] round=6 local utility u=0.871819 metrics={'f1_val': 0.41734838192522206, 'auprc': 0.7777885030976041, 'loss_val': 1.0856238775532494, 'psi': 0.5615244303941749}-{'f1_val': 0.14226190476190476, 'auprc': 0.771245663739825, 'loss_val': 1.1591149718123142, 'psi': 0.39385540835307287}
[S6] START round=6 head_norm_before_train=1.068572 cos_to_last_merge=0.9505 (last merge round=1)
[S6] round=6 local utility u=1.000000 metrics={'f1_val': 0.7095840975307757, 'auprc': 0.8468115961036992, 'loss_val': 0.6908624139501607, 'psi': 0.7644750969599451}-{'f1_val': 0.4171358730402079, 'auprc': 0.7916216598813964, 'loss_val': 0.8336474726030714, 'psi': 0.5669301877766832}
[S7] START round=6 head_norm_before_train=1.288599 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6951440682295644, 'loss_val': 1.1423677777542085, 'psi': 0.36329172092928075}-{'f1_val': 0.14205682272909165, 'auprc': 0.7590704817936709, 'loss_val': 1.2137563042769406, 'psi': 0.38886228635492337}
[S8] START round=6 head_norm_before_train=1.393991 (no previous merge yet)
[S8] round=6 local utility u=0.082877 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.9949564394393182, 'loss_val': 0.5530276012107915, 'psi': 0.6215812070816514}-{'f1_val': 0.3727983816295533, 'auprc': 0.9935159826707161, 'loss_val': 0.7152647542402639, 'psi': 0.6210854220460185}
[S9] START round=6 head_norm_before_train=0.774140 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.863045 metrics={'f1_val': 0.41685404846439245, 'auprc': 0.811331798093164, 'loss_val': 1.0865265995126288, 'psi': 0.5746451483159011}-{'f1_val': 0.141397957139996, 'auprc': 0.8125143280675908, 'loss_val': 1.1634267243891714, 'psi': 0.40984450551103396}
[S10] START round=6 head_norm_before_train=1.405744 (no previous merge yet)
[S10] round=6 local utility u=0.299124 metrics={'f1_val': 0.6991805522776858, 'auprc': 0.9983178095603351, 'loss_val': 0.3326212059259749, 'psi': 0.8188354551907455}-{'f1_val': 0.699492212063004, 'auprc': 0.8643568880111606, 'loss_val': 0.5308567257587273, 'psi': 0.7654380824422666}
[S11] START round=6 head_norm_before_train=0.771526 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.4154457801152016, 'auprc': 0.8189607430739807, 'loss_val': 1.036510228004103, 'psi': 0.5768517652987133}-{'f1_val': 0.14041368337311058, 'auprc': 0.6519245583756188, 'loss_val': 1.1173924694521662, 'psi': 0.34501803337411385}
[S13] START round=6 head_norm_before_train=1.325503 (no previous merge yet)
[S13] round=6 local utility u=0.714364 metrics={'f1_val': 0.5644474918254492, 'auprc': 0.7668495637634415, 'loss_val': 0.7212796169527637, 'psi': 0.645408320600646}-{'f1_val': 0.37169029467602305, 'auprc': 0.7168848072809122, 'loss_val': 0.8435692779494895, 'psi': 0.5097680997179788}
[S14] START round=6 head_norm_before_train=0.943989 cos_to_last_merge=0.9926 (last merge round=3)
[S14] round=6 local utility u=0.181312 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8934253772138017, 'loss_val': 1.1876509909811424, 'psi': 0.44158486261514296}-{'f1_val': 0.14035785288270378, 'auprc': 0.7936700199525442, 'loss_val': 1.251008325105789, 'psi': 0.40168271971063996}
[S15] START round=6 head_norm_before_train=0.887296 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.7013484921390984, 'auprc': 0.7993577509676905, 'loss_val': 0.47427986069885403, 'psi': 0.7405521956705352}-{'f1_val': 0.6987247968657844, 'auprc': 0.9942846122857321, 'loss_val': 0.4352766535541606, 'psi': 0.8169487230337635}
[S16] START round=6 head_norm_before_train=0.777394 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.850895 metrics={'f1_val': 0.41605479710452475, 'auprc': 0.4458707099495083, 'loss_val': 1.103950485572949, 'psi': 0.42798116224251814}-{'f1_val': 0.14063745019920318, 'auprc': 0.4497446667624958, 'loss_val': 1.164858498437955, 'psi': 0.26428033682452023}
[S17] START round=6 head_norm_before_train=0.663110 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35362440232110137, 'auprc': 0.6967450946366149, 'loss_val': 0.9325307094905668, 'psi': 0.4908726792473068}-{'f1_val': 0.35178769764069184, 'auprc': 0.7796022017504187, 'loss_val': 0.9019180007169239, 'psi': 0.5229134992845826}
[S10] not sending this round → trigger blocked (psi=0.819)
[S2] not sending this round → trigger blocked (psi=0.716)
[S3] not sending this round → trigger blocked (psi=0.402)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S4] not sending this round → trigger blocked (psi=0.780)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[S6] not sending this round → trigger blocked (psi=0.764)
[S16] not sending this round → trigger blocked (psi=0.428)
[S8] not sending this round → trigger blocked (psi=0.622)
[S14] not sending this round → trigger blocked (psi=0.442)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:33204
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.5652
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=-0.0228
[S4] DROPPED delta from S13 (cos=-0.0228 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S11
[S13] cosine check vs S11: cos=-0.0214
[S13] DROPPED delta from S11 (cos=-0.0214 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3536 head_norm=0.756169
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.634033e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3533 head_norm=0.688568 delta_norm=0.363403
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.095598 cos_to_last_merge=0.9055 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=7 local utility u=0.123949 metrics={'f1_val': 0.7005925029290768, 'auprc': 0.7704287096447673, 'loss_val': 0.42515841452043024, 'psi': 0.728526985615353}-{'f1_val': 0.700928966771822, 'auprc': 0.7395900289858242, 'loss_val': 0.5825586496718879, 'psi': 0.7163933916574229}
[S3] START round=7 head_norm_before_train=0.884968 cos_to_last_merge=0.9952 (last merge round=5)
[S3] round=7 local utility u=0.845391 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.7961464905848659, 'loss_val': 0.9736543182087746, 'psi': 0.5563299521232188}-{'f1_val': 0.13984006561410703, 'auprc': 0.7955650180566717, 'loss_val': 1.123019697611907, 'psi': 0.40213004659113294}
[S4] START round=7 head_norm_before_train=1.639858 (no previous merge yet)
[S4] round=7 local utility u=0.999779 metrics={'f1_val': 0.9820979281135531, 'auprc': 0.9677932620402627, 'loss_val': 0.2663569660705029, 'psi': 0.976376061684237}-{'f1_val': 0.680569567499379, 'auprc': 0.9284619605110791, 'loss_val': 0.33875155166101006, 'psi': 0.779726524704059}
[S5] START round=7 head_norm_before_train=0.894723 cos_to_last_merge=0.9735 (last merge round=2)
[S5] round=7 local utility u=0.063692 metrics={'f1_val': 0.41762898496828804, 'auprc': 0.7777221821473066, 'loss_val': 0.9597253374048277, 'psi': 0.5616662638398955}-{'f1_val': 0.41734838192522206, 'auprc': 0.7777885030976041, 'loss_val': 1.0856238775532494, 'psi': 0.5615244303941749}
[S6] START round=7 head_norm_before_train=1.122000 cos_to_last_merge=0.9280 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.6210418508411758, 'auprc': 0.8117594789955318, 'loss_val': 0.5719616021188735, 'psi': 0.6973289021029182}-{'f1_val': 0.7095840975307757, 'auprc': 0.8468115961036992, 'loss_val': 0.6908624139501607, 'psi': 0.7644750969599451}
[S7] START round=7 head_norm_before_train=1.308415 (no previous merge yet)
[S7] round=7 local utility u=0.823649 metrics={'f1_val': 0.4170778520170104, 'auprc': 0.6492547100476287, 'loss_val': 1.0075286728867923, 'psi': 0.5099485952292577}-{'f1_val': 0.14205682272909165, 'auprc': 0.6951440682295644, 'loss_val': 1.1423677777542085, 'psi': 0.36329172092928075}
[S8] START round=7 head_norm_before_train=1.460502 (no previous merge yet)
[S8] round=7 local utility u=0.057698 metrics={'f1_val': 0.37273099922839503, 'auprc': 0.9947859007688389, 'loss_val': 0.4375200307327213, 'psi': 0.6215529598445726}-{'f1_val': 0.37266438550987346, 'auprc': 0.9949564394393182, 'loss_val': 0.5530276012107915, 'psi': 0.6215812070816514}
[S9] START round=7 head_norm_before_train=0.800364 cos_to_last_merge=0.9948 (last merge round=5)
[S9] round=7 local utility u=0.180833 metrics={'f1_val': 0.4351303338157462, 'auprc': 0.8341495511874163, 'loss_val': 0.9029720870557254, 'psi': 0.5947380207644142}-{'f1_val': 0.41685404846439245, 'auprc': 0.811331798093164, 'loss_val': 1.0865265995126288, 'psi': 0.5746451483159011}
[S10] START round=7 head_norm_before_train=1.484067 (no previous merge yet)
[S10] round=7 local utility u=0.042592 metrics={'f1_val': 0.697165229688599, 'auprc': 0.9980940606445883, 'loss_val': 0.23467443859018017, 'psi': 0.8175367620709947}-{'f1_val': 0.6991805522776858, 'auprc': 0.9983178095603351, 'loss_val': 0.3326212059259749, 'psi': 0.8188354551907455}
[S11] START round=7 head_norm_before_train=0.813369 cos_to_last_merge=0.9953 (last merge round=5)
[S11] round=7 local utility u=0.288989 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9976260787527379, 'loss_val': 0.8809655936590495, 'psi': 0.6369615641465949}-{'f1_val': 0.4154457801152016, 'auprc': 0.8189607430739807, 'loss_val': 1.036510228004103, 'psi': 0.5768517652987133}
[S13] START round=7 head_norm_before_train=1.385544 (no previous merge yet)
[S13] round=7 local utility u=0.455814 metrics={'f1_val': 0.7036712951366998, 'auprc': 0.7495409857672777, 'loss_val': 0.5930680303636947, 'psi': 0.722019171388931}-{'f1_val': 0.5644474918254492, 'auprc': 0.7668495637634415, 'loss_val': 0.7212796169527637, 'psi': 0.645408320600646}
[S14] START round=7 head_norm_before_train=0.978636 cos_to_last_merge=0.9859 (last merge round=3)
[S14] round=7 local utility u=0.822682 metrics={'f1_val': 0.3915311964828873, 'auprc': 0.8985981545767946, 'loss_val': 1.0648458800589469, 'psi': 0.5943579797204502}-{'f1_val': 0.14035785288270378, 'auprc': 0.8934253772138017, 'loss_val': 1.1876509909811424, 'psi': 0.44158486261514296}
[S15] START round=7 head_norm_before_train=0.996279 cos_to_last_merge=0.9904 (last merge round=5)
[S15] round=7 local utility u=0.295846 metrics={'f1_val': 0.700411219449732, 'auprc': 0.9719821324770078, 'loss_val': 0.3948382040048913, 'psi': 0.8090395846606423}-{'f1_val': 0.7013484921390984, 'auprc': 0.7993577509676905, 'loss_val': 0.47427986069885403, 'psi': 0.7405521956705352}
[S16] START round=7 head_norm_before_train=0.812555 cos_to_last_merge=0.9962 (last merge round=5)
[S16] round=7 local utility u=0.044240 metrics={'f1_val': 0.4166929047986758, 'auprc': 0.4503560484439036, 'loss_val': 1.0327559047141428, 'psi': 0.43015816225676695}-{'f1_val': 0.41605479710452475, 'auprc': 0.4458707099495083, 'loss_val': 1.103950485572949, 'psi': 0.42798116224251814}
[S17] START round=7 head_norm_before_train=0.688568 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.023658 metrics={'f1_val': 0.3535765548385824, 'auprc': 0.7103303588266369, 'loss_val': 0.9256841019612917, 'psi': 0.49627807643380417}-{'f1_val': 0.35362440232110137, 'auprc': 0.6967450946366149, 'loss_val': 0.9325307094905668, 'psi': 0.4908726792473068}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:33216
[S11] not sending this round → trigger blocked (psi=0.637)
[S13] not sending this round → trigger blocked (psi=0.722)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:33213
[S9] not sending this round → trigger blocked (psi=0.595)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S2] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.2114
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] cosine check vs S16: cos=0.3348
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.4446
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.6200
[S9] RECEIVED delta(kind=head bytes=1794) from S3
[S9] cosine check vs S3: cos=0.5430
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.7672
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0980
[S10] DROPPED delta from S4 (cos=-0.0980 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1791) from S5
[S16] cosine check vs S5: cos=0.8379
[S11] RECEIVED delta(kind=head bytes=1794) from S15
[S11] cosine check vs S15: cos=0.4669
[S13] RECEIVED delta(kind=head bytes=1791) from S2
[S13] cosine check vs S2: cos=-0.0200
[S13] DROPPED delta from S2 (cos=-0.0200 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S17
[S3] cosine check vs S17: cos=0.4498
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=0.869263
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.192404e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.5660 head_norm=0.847209 delta_norm=0.519240
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.4351 head_norm=0.837677
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.216154e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.4368 head_norm=0.772129 delta_norm=0.421615
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4167 head_norm=0.856078
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.576565e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4169 head_norm=0.858443 delta_norm=0.257657
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3915 head_norm=1.019238
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.334802e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1447 head_norm=1.063178 delta_norm=0.533480
[S14] aggregate: ROLLBACK (f1_val pre=0.392 post=0.145 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.7004 head_norm=1.104141
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.606579e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.7006 head_norm=0.902580 delta_norm=0.560658
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=7 metric=0.3965 head_norm=0.919882
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.283557e-01
[S3] stored merged vector for next round verification (round=7)
[S3] DEBUG after merge:  round=7 metric=0.3964 head_norm=0.872750 delta_norm=0.228356
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3536 head_norm=0.791857
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.855863e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3574 head_norm=0.690765 delta_norm=0.485586
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.191169 cos_to_last_merge=0.8852 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.6645967780322881, 'loss_val': 0.3314655860784503, 'psi': 0.6866272214564018}-{'f1_val': 0.7005925029290768, 'auprc': 0.7704287096447673, 'loss_val': 0.42515841452043024, 'psi': 0.728526985615353}
[S3] START round=8 head_norm_before_train=0.872750 cos_to_last_merge=1.0000 (last merge round=7)
[S3] round=8 local utility u=0.020665 metrics={'f1_val': 0.39629664251078706, 'auprc': 0.7955635183168183, 'loss_val': 0.9296408316781707, 'psi': 0.5560033928331996}-{'f1_val': 0.39645225981545407, 'auprc': 0.7961464905848659, 'loss_val': 0.9736543182087746, 'psi': 0.5563299521232188}
[S4] START round=8 head_norm_before_train=1.685687 (no previous merge yet)
[S4] round=8 local utility u=0.027647 metrics={'f1_val': 0.9787108709530118, 'auprc': 0.9772152211249424, 'loss_val': 0.21900742904848136, 'psi': 0.978112611021784}-{'f1_val': 0.9820979281135531, 'auprc': 0.9677932620402627, 'loss_val': 0.2663569660705029, 'psi': 0.976376061684237}
[S5] START round=8 head_norm_before_train=0.934748 cos_to_last_merge=0.9589 (last merge round=2)
[S5] round=8 local utility u=0.050293 metrics={'f1_val': 0.4181926743009027, 'auprc': 0.777292450642744, 'loss_val': 0.8612324470357249, 'psi': 0.5618325848376392}-{'f1_val': 0.41762898496828804, 'auprc': 0.7777221821473066, 'loss_val': 0.9597253374048277, 'psi': 0.5616662638398955}
[S6] START round=8 head_norm_before_train=1.180687 cos_to_last_merge=0.9090 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=8 local utility u=0.459059 metrics={'f1_val': 0.7081235386535294, 'auprc': 0.9167058611204326, 'loss_val': 0.49117247975006495, 'psi': 0.7915564676402906}-{'f1_val': 0.6210418508411758, 'auprc': 0.8117594789955318, 'loss_val': 0.5719616021188735, 'psi': 0.6973289021029182}
[S7] START round=8 head_norm_before_train=1.338301 (no previous merge yet)
[S7] round=8 local utility u=0.150749 metrics={'f1_val': 0.4172381946317165, 'auprc': 0.703414516172701, 'loss_val': 0.8694714792047191, 'psi': 0.5317087232481104}-{'f1_val': 0.4170778520170104, 'auprc': 0.6492547100476287, 'loss_val': 1.0075286728867923, 'psi': 0.5099485952292577}
[S8] START round=8 head_norm_before_train=1.528239 (no previous merge yet)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.968348612397939, 'auprc': 0.9960514354157124, 'loss_val': 0.26409770414637584, 'psi': 0.9794297416050484}-{'f1_val': 0.37273099922839503, 'auprc': 0.9947859007688389, 'loss_val': 0.4375200307327213, 'psi': 0.6215529598445726}
[S9] START round=8 head_norm_before_train=0.772129 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.047622 metrics={'f1_val': 0.43794225785967045, 'auprc': 0.8459063793762055, 'loss_val': 0.8598707606054372, 'psi': 0.6011279064662844}-{'f1_val': 0.4351303338157462, 'auprc': 0.8341495511874163, 'loss_val': 0.9029720870557254, 'psi': 0.5947380207644142}
[S10] START round=8 head_norm_before_train=1.546564 (no previous merge yet)
[S10] round=8 local utility u=0.040219 metrics={'f1_val': 0.699260083987036, 'auprc': 0.998096350437983, 'loss_val': 0.16681253812402477, 'psi': 0.8187945905674148}-{'f1_val': 0.697165229688599, 'auprc': 0.9980940606445883, 'loss_val': 0.23467443859018017, 'psi': 0.8175367620709947}
[S11] START round=8 head_norm_before_train=0.847209 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.000000 metrics={'f1_val': 0.396639232794319, 'auprc': 0.9431302045052439, 'loss_val': 0.8558969113319226, 'psi': 0.6152356214786889}-{'f1_val': 0.39651855440916606, 'auprc': 0.9976260787527379, 'loss_val': 0.8809655936590495, 'psi': 0.6369615641465949}
[S13] START round=8 head_norm_before_train=1.445432 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6795518867961562, 'auprc': 0.7423642480077393, 'loss_val': 0.5379814152741758, 'psi': 0.7046768312807894}-{'f1_val': 0.7036712951366998, 'auprc': 0.7495409857672777, 'loss_val': 0.5930680303636947, 'psi': 0.722019171388931}
[S14] START round=8 head_norm_before_train=1.063178 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.570126 metrics={'f1_val': 0.5199421049531059, 'auprc': 0.9836842894478296, 'loss_val': 0.9503183128678335, 'psi': 0.7054389787509954}-{'f1_val': 0.3915311964828873, 'auprc': 0.8985981545767946, 'loss_val': 1.0648458800589469, 'psi': 0.5943579797204502}
[S15] START round=8 head_norm_before_train=0.902580 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.044719 metrics={'f1_val': 0.7026377738984759, 'auprc': 0.9894980115767676, 'loss_val': 0.37130780379929923, 'psi': 0.8173818689697926}-{'f1_val': 0.700411219449732, 'auprc': 0.9719821324770078, 'loss_val': 0.3948382040048913, 'psi': 0.8090395846606423}
[S16] START round=8 head_norm_before_train=0.858443 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.042379 metrics={'f1_val': 0.4171583814486223, 'auprc': 0.44842089949336517, 'loss_val': 0.9449849430456392, 'psi': 0.42966338866651943}-{'f1_val': 0.4166929047986758, 'auprc': 0.4503560484439036, 'loss_val': 1.0327559047141428, 'psi': 0.43015816225676695}
[S17] START round=8 head_norm_before_train=0.690765 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3523878946191771, 'auprc': 0.6947942547188153, 'loss_val': 0.9428727409047278, 'psi': 0.4893504386590324}-{'f1_val': 0.3535765548385824, 'auprc': 0.7103303588266369, 'loss_val': 0.9256841019612917, 'psi': 0.49627807643380417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[S14] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=-0.1033
[S10] DROPPED delta from S4 (cos=-0.1033 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.4392
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] cosine check vs S15: cos=0.7290
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.7465
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=0.8330
[S3] RECEIVED delta(kind=head bytes=1804) from S10
[S3] cosine check vs S10: cos=0.8292
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.6152
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.4852
[S17] RECEIVED delta(kind=head bytes=1797) from S16
[S17] cosine check vs S16: cos=0.4622
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9051
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.9358
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=0.894718
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.958693e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4625 head_norm=0.808286 delta_norm=0.295869
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=8 metric=0.3963 head_norm=0.907133
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.919426e-01
[S3] stored merged vector for next round verification (round=8)
[S3] DEBUG after merge:  round=8 metric=0.6920 head_norm=1.200798 delta_norm=0.491943
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.7026 head_norm=0.991435
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.748742e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.7509 head_norm=0.975767 delta_norm=0.374874
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5199 head_norm=1.096522
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.999353e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.5223 head_norm=1.203968 delta_norm=0.299935
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4172 head_norm=0.898778
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.736735e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4172 head_norm=0.925855 delta_norm=0.173673
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.4379 head_norm=0.809410
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.523461e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4814 head_norm=0.821790 delta_norm=0.252346
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3524 head_norm=0.772394
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.153532e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3524 head_norm=0.663722 delta_norm=0.215353
[S17] aggregate: ACCEPT kept=['S8', 'S9', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.271577 cos_to_last_merge=0.8668 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.867
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7012347841865968, 'auprc': 0.6601909080942726, 'loss_val': 0.32884083831926586, 'psi': 0.6848172337496672}-{'f1_val': 0.7013141837391442, 'auprc': 0.6645967780322881, 'loss_val': 0.3314655860784503, 'psi': 0.6866272214564018}
[S3] START round=9 head_norm_before_train=1.200798 cos_to_last_merge=1.0000 (last merge round=8)
[S3] round=9 local utility u=0.851255 metrics={'f1_val': 0.6826750210169588, 'auprc': 0.7728121047528987, 'loss_val': 0.8771475276471663, 'psi': 0.7187298545113348}-{'f1_val': 0.39629664251078706, 'auprc': 0.7955635183168183, 'loss_val': 0.9296408316781707, 'psi': 0.5560033928331996}
[S4] START round=9 head_norm_before_train=1.730549 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.968634151792229, 'auprc': 0.9786566805173709, 'loss_val': 0.19251135126107338, 'psi': 0.9726431632822858}-{'f1_val': 0.9787108709530118, 'auprc': 0.9772152211249424, 'loss_val': 0.21900742904848136, 'psi': 0.978112611021784}
[S5] START round=9 head_norm_before_train=0.983331 cos_to_last_merge=0.9414 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.941
[S5] round=9 local utility u=0.864349 metrics={'f1_val': 0.6898297138535447, 'auprc': 0.7771372364403039, 'loss_val': 0.7618911969874208, 'psi': 0.7247527228882484}-{'f1_val': 0.4181926743009027, 'auprc': 0.777292450642744, 'loss_val': 0.8612324470357249, 'psi': 0.5618325848376392}
[S6] START round=9 head_norm_before_train=1.233968 cos_to_last_merge=0.8945 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=9 local utility u=0.113958 metrics={'f1_val': 0.7097914796873478, 'auprc': 0.9639266485701334, 'loss_val': 0.4149255625110546, 'psi': 0.811445547240462}-{'f1_val': 0.7081235386535294, 'auprc': 0.9167058611204326, 'loss_val': 0.49117247975006495, 'psi': 0.7915564676402906}
[S7] START round=9 head_norm_before_train=1.369905 (no previous merge yet)
[S7] round=9 local utility u=0.972825 metrics={'f1_val': 0.6908059479083615, 'auprc': 0.7824298638636005, 'loss_val': 0.8022733187433749, 'psi': 0.7274555142904571}-{'f1_val': 0.4172381946317165, 'auprc': 0.703414516172701, 'loss_val': 0.8694714792047191, 'psi': 0.5317087232481104}
[S8] START round=9 head_norm_before_train=1.587334 (no previous merge yet)
[S8] round=9 local utility u=0.135569 metrics={'f1_val': 0.996503822188793, 'auprc': 0.9959116949456551, 'loss_val': 0.16147084309610804, 'psi': 0.9962669712915377}-{'f1_val': 0.968348612397939, 'auprc': 0.9960514354157124, 'loss_val': 0.26409770414637584, 'psi': 0.9794297416050484}
[S9] START round=9 head_norm_before_train=0.821790 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.7012922684064005, 'auprc': 0.9994710442868724, 'loss_val': 0.7332189293438672, 'psi': 0.8205637787585893}-{'f1_val': 0.43794225785967045, 'auprc': 0.8459063793762055, 'loss_val': 0.8598707606054372, 'psi': 0.6011279064662844}
[S10] START round=9 head_norm_before_train=1.595291 (no previous merge yet)
[S10] round=9 local utility u=0.809629 metrics={'f1_val': 0.9633192065093334, 'auprc': 0.9977861993531965, 'loss_val': 0.13097897339600156, 'psi': 0.9771060036468786}-{'f1_val': 0.699260083987036, 'auprc': 0.998096350437983, 'loss_val': 0.16681253812402477, 'psi': 0.8187945905674148}
[S11] START round=9 head_norm_before_train=0.808286 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.540842 metrics={'f1_val': 0.5659180966460111, 'auprc': 0.9411094016962762, 'loss_val': 0.7838236971344452, 'psi': 0.7159946186661171}-{'f1_val': 0.396639232794319, 'auprc': 0.9431302045052439, 'loss_val': 0.8558969113319226, 'psi': 0.6152356214786889}
[S13] START round=9 head_norm_before_train=1.487668 (no previous merge yet)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6311003306040269, 'auprc': 0.6474329608285443, 'loss_val': 0.5961708586584178, 'psi': 0.6376333826938339}-{'f1_val': 0.6795518867961562, 'auprc': 0.7423642480077393, 'loss_val': 0.5379814152741758, 'psi': 0.7046768312807894}
[S14] START round=9 head_norm_before_train=1.203968 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.568437 metrics={'f1_val': 0.6765678482565354, 'auprc': 0.9939760644959029, 'loss_val': 0.7840734129318077, 'psi': 0.8035311347522824}-{'f1_val': 0.5199421049531059, 'auprc': 0.9836842894478296, 'loss_val': 0.9503183128678335, 'psi': 0.7054389787509954}
[S15] START round=9 head_norm_before_train=0.975767 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.7193972458562081, 'auprc': 0.8807234437134559, 'loss_val': 0.4229345278301019, 'psi': 0.7839277249991072}-{'f1_val': 0.7026377738984759, 'auprc': 0.9894980115767676, 'loss_val': 0.37130780379929923, 'psi': 0.8173818689697926}
[S16] START round=9 head_norm_before_train=0.925855 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.199216 metrics={'f1_val': 0.3847767668765187, 'auprc': 0.6435481539521347, 'loss_val': 0.9376444190754665, 'psi': 0.4882853217067651}-{'f1_val': 0.4171583814486223, 'auprc': 0.44842089949336517, 'loss_val': 0.9449849430456392, 'psi': 0.42966338866651943}
[S17] START round=9 head_norm_before_train=0.663722 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.005660 metrics={'f1_val': 0.3523878946191771, 'auprc': 0.6985044547550701, 'loss_val': 0.942684177883635, 'psi': 0.4908345186735342}-{'f1_val': 0.3523878946191771, 'auprc': 0.6947942547188153, 'loss_val': 0.9428727409047278, 'psi': 0.4893504386590324}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.725)
[S3] not sending this round → trigger blocked (psi=0.719)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.488)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.804)
[S10] not sending this round → trigger blocked (psi=0.977)
[S8] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → trigger blocked (psi=0.727)
[S6] not sending this round → trigger blocked (psi=0.811)
[S9] not sending this round → trigger blocked (psi=0.821)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.0016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.2698
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.6311 head_norm=1.513165
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.691048e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.6313 head_norm=0.870321 delta_norm=0.869105
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=9 metric=0.6827 head_norm=1.228554
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.279616e-01
[S3] stored merged vector for next round verification (round=9)
[S3] DEBUG after merge:  round=9 metric=0.6837 head_norm=0.802500 delta_norm=0.627962
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.341620 cos_to_last_merge=0.8533 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.853
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.6773316776655045, 'auprc': 0.6550494354913976, 'loss_val': 0.437459207578597, 'psi': 0.6684187807958617}-{'f1_val': 0.7012347841865968, 'auprc': 0.6601909080942726, 'loss_val': 0.32884083831926586, 'psi': 0.6848172337496672}
[S3] START round=10 head_norm_before_train=0.802500 cos_to_last_merge=1.0000 (last merge round=9)
[S3] round=10 local utility u=0.000000 metrics={'f1_val': 0.6535461978207507, 'auprc': 0.772910985649865, 'loss_val': 0.8687846347418378, 'psi': 0.7012921129523965}-{'f1_val': 0.6826750210169588, 'auprc': 0.7728121047528987, 'loss_val': 0.8771475276471663, 'psi': 0.7187298545113348}
[S4] START round=10 head_norm_before_train=1.768656 (no previous merge yet)
[S4] round=10 local utility u=0.035336 metrics={'f1_val': 0.9724031906461083, 'auprc': 0.9814113616989157, 'loss_val': 0.1527185414709691, 'psi': 0.9760064590672313}-{'f1_val': 0.968634151792229, 'auprc': 0.9786566805173709, 'loss_val': 0.19251135126107338, 'psi': 0.9726431632822858}
[S5] START round=10 head_norm_before_train=1.032299 cos_to_last_merge=0.9248 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.925
[S5] round=10 local utility u=0.115107 metrics={'f1_val': 0.7010644289311239, 'auprc': 0.7879928502572996, 'loss_val': 0.631653087447817, 'psi': 0.7358357974615941}-{'f1_val': 0.6898297138535447, 'auprc': 0.7771372364403039, 'loss_val': 0.7618911969874208, 'psi': 0.7247527228882484}
[S6] START round=10 head_norm_before_train=1.278991 cos_to_last_merge=0.8834 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=10 local utility u=0.009174 metrics={'f1_val': 0.6990050588985097, 'auprc': 0.9672369144585232, 'loss_val': 0.3417889761837385, 'psi': 0.8062978011225151}-{'f1_val': 0.7097914796873478, 'auprc': 0.9639266485701334, 'loss_val': 0.4149255625110546, 'psi': 0.811445547240462}
[S7] START round=10 head_norm_before_train=1.404404 (no previous merge yet)
[S7] round=10 local utility u=0.034191 metrics={'f1_val': 0.6886097286051533, 'auprc': 0.7836852283734083, 'loss_val': 0.7244804787076801, 'psi': 0.7266399285124554}-{'f1_val': 0.6908059479083615, 'auprc': 0.7824298638636005, 'loss_val': 0.8022733187433749, 'psi': 0.7274555142904571}
[S8] START round=10 head_norm_before_train=1.636190 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.9891428626710904, 'auprc': 0.9974335721477016, 'loss_val': 0.14083711135259175, 'psi': 0.9924591464617349}-{'f1_val': 0.996503822188793, 'auprc': 0.9959116949456551, 'loss_val': 0.16147084309610804, 'psi': 0.9962669712915377}
[S9] START round=10 head_norm_before_train=0.863552 cos_to_last_merge=0.9928 (last merge round=8)
[S9] round=10 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9437943112112679, 'loss_val': 0.6229334412417469, 'psi': 0.7982920146090452}-{'f1_val': 0.7012922684064005, 'auprc': 0.9994710442868724, 'loss_val': 0.7332189293438672, 'psi': 0.8205637787585893}
[S10] START round=10 head_norm_before_train=1.636348 (no previous merge yet)
[S10] round=10 local utility u=0.084346 metrics={'f1_val': 0.9929535466990002, 'auprc': 0.9942153014328379, 'loss_val': 0.12938041102564304, 'psi': 0.9934582485925352}-{'f1_val': 0.9633192065093334, 'auprc': 0.9977861993531965, 'loss_val': 0.13097897339600156, 'psi': 0.9771060036468786}
[S11] START round=10 head_norm_before_train=0.857866 cos_to_last_merge=0.9935 (last merge round=8)
[S11] round=10 local utility u=0.116111 metrics={'f1_val': 0.5839590263713859, 'auprc': 0.9393276532880268, 'loss_val': 0.6545021609906547, 'psi': 0.7261064771380422}-{'f1_val': 0.5659180966460111, 'auprc': 0.9411094016962762, 'loss_val': 0.7838236971344452, 'psi': 0.7159946186661171}
[S13] START round=10 head_norm_before_train=0.870321 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6100103691812508, 'auprc': 0.6920817585969318, 'loss_val': 0.6799902442309296, 'psi': 0.6428389249475233}-{'f1_val': 0.6311003306040269, 'auprc': 0.6474329608285443, 'loss_val': 0.5961708586584178, 'psi': 0.6376333826938339}
[S14] START round=10 head_norm_before_train=1.236874 cos_to_last_merge=0.9971 (last merge round=8)
[S14] round=10 local utility u=0.000000 metrics={'f1_val': 0.6273363298726375, 'auprc': 0.9734820162980474, 'loss_val': 0.6526303374038555, 'psi': 0.7657946044428015}-{'f1_val': 0.6765678482565354, 'auprc': 0.9939760644959029, 'loss_val': 0.7840734129318077, 'psi': 0.8035311347522824}
[S15] START round=10 head_norm_before_train=1.076165 cos_to_last_merge=0.9863 (last merge round=8)
[S15] round=10 local utility u=1.000000 metrics={'f1_val': 0.9883361382778922, 'auprc': 0.9956159889582691, 'loss_val': 0.20233463259770806, 'psi': 0.9912480785500429}-{'f1_val': 0.7193972458562081, 'auprc': 0.8807234437134559, 'loss_val': 0.4229345278301019, 'psi': 0.7839277249991072}
[S16] START round=10 head_norm_before_train=0.969435 cos_to_last_merge=0.9950 (last merge round=8)
[S16] round=10 local utility u=0.059624 metrics={'f1_val': 0.3845573009821096, 'auprc': 0.6728483945888674, 'loss_val': 0.9049801478094882, 'psi': 0.4998737384248127}-{'f1_val': 0.3847767668765187, 'auprc': 0.6435481539521347, 'loss_val': 0.9376444190754665, 'psi': 0.4882853217067651}
[S17] START round=10 head_norm_before_train=0.753219 cos_to_last_merge=0.9787 (last merge round=8)
[S17] round=10 local utility u=0.029712 metrics={'f1_val': 0.35362895134290206, 'auprc': 0.7171969893320471, 'loss_val': 0.9467834401156138, 'psi': 0.4990561665385601}-{'f1_val': 0.3523878946191771, 'auprc': 0.6985044547550701, 'loss_val': 0.942684177883635, 'psi': 0.4908345186735342}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:33214
[S11] not sending this round → trigger blocked (psi=0.726)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:33212
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:33217
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:33203
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S15
[S11] cosine check vs S15: cos=0.6223
[S3] RECEIVED delta(kind=head bytes=1794) from S10
[S3] cosine check vs S10: cos=0.7817
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.6256
[S17] RECEIVED delta(kind=head bytes=1793) from S16
[S17] cosine check vs S16: cos=0.4814
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.9441
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.1065
[S10] DROPPED delta from S4 (cos=-0.1065 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9371
[S17] not sending this round → trigger blocked (psi=0.499)
[S9] ⇄ pheromone p=0.369 → S17@127.0.0.1:33217
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.6535 head_norm=0.844625
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.703589e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.6455 head_norm=1.195482 delta_norm=0.570359
[S3] aggregate: ROLLBACK (f1_val pre=0.654 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.357 → S9@127.0.0.1:33210
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6273 head_norm=1.278169
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.398861e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6216 head_norm=1.338309 delta_norm=0.239886
[S14] aggregate: ROLLBACK (f1_val pre=0.627 post=0.622 tol_abs=0.005 tol_rel=0.0)
[S14] ⇄ pheromone p=0.386 → S15@127.0.0.1:33215
[S8] ⇄ pheromone p=0.361 → S17@127.0.0.1:33217
[S13] ⇄ pheromone p=0.266 → S4@127.0.0.1:33204
[S2] ⇄ pheromone p=0.251 → S13@127.0.0.1:33213
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.5840 head_norm=0.917771
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.325239e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6635 head_norm=0.879276 delta_norm=0.232524
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.329 → S13@127.0.0.1:33213
[S7] ⇄ pheromone p=0.401 → S14@127.0.0.1:33214
[S4] ⇄ pheromone p=0.325 → S10@127.0.0.1:33211
[S10] ⇄ pheromone p=0.412 → S3@127.0.0.1:33203
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.3846 head_norm=1.018576
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.888374e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3844 head_norm=1.033526 delta_norm=0.188837
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.251 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=0.345 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.383 → S16@127.0.0.1:33216
[S15] ⇄ pheromone p=0.453 → S11@127.0.0.1:33212
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3536 head_norm=0.839533
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.792989e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3525 head_norm=0.800892 delta_norm=0.479299
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.177 → S3@127.0.0.1:33203
[S2] START round=11 head_norm_before_train=1.393769 cos_to_last_merge=0.8449 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.845
[S2] round=11 local utility u=0.141947 metrics={'f1_val': 0.701055136928628, 'auprc': 0.6604149320003974, 'loss_val': 0.3120020302142084, 'psi': 0.6847990549573357}-{'f1_val': 0.6773316776655045, 'auprc': 0.6550494354913976, 'loss_val': 0.437459207578597, 'psi': 0.6684187807958617}
[S3] START round=11 head_norm_before_train=1.195482 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4910451475673217, 'auprc': 0.7592404203247185, 'loss_val': 0.8668034669466061, 'psi': 0.5983232566702804}-{'f1_val': 0.6535461978207507, 'auprc': 0.772910985649865, 'loss_val': 0.8687846347418378, 'psi': 0.7012921129523965}
[S4] START round=11 head_norm_before_train=1.802949 (no previous merge yet)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.958875829071185, 'auprc': 0.9803855240565331, 'loss_val': 0.15746966652439398, 'psi': 0.9674797070653243}-{'f1_val': 0.9724031906461083, 'auprc': 0.9814113616989157, 'loss_val': 0.1527185414709691, 'psi': 0.9760064590672313}
[S5] START round=11 head_norm_before_train=1.081746 cos_to_last_merge=0.9093 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.6521426134103705, 'auprc': 0.7903806518271295, 'loss_val': 0.64282979294036, 'psi': 0.7074378287770741}-{'f1_val': 0.7010644289311239, 'auprc': 0.7879928502572996, 'loss_val': 0.631653087447817, 'psi': 0.7358357974615941}
[S6] START round=11 head_norm_before_train=1.310636 cos_to_last_merge=0.8765 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.687052832103433, 'auprc': 0.8173405442234244, 'loss_val': 0.43676423353346355, 'psi': 0.7391679169514296}-{'f1_val': 0.6990050588985097, 'auprc': 0.9672369144585232, 'loss_val': 0.3417889761837385, 'psi': 0.8062978011225151}
[S7] START round=11 head_norm_before_train=1.436495 (no previous merge yet)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.6217495448007468, 'auprc': 0.8091687253881327, 'loss_val': 0.7270905719761968, 'psi': 0.6967172170357012}-{'f1_val': 0.6886097286051533, 'auprc': 0.7836852283734083, 'loss_val': 0.7244804787076801, 'psi': 0.7266399285124554}
[S8] START round=11 head_norm_before_train=1.680274 (no previous merge yet)
[S8] round=11 local utility u=0.047168 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9982248297685494, 'loss_val': 0.09213636899584086, 'psi': 0.9971017768687945}-{'f1_val': 0.9891428626710904, 'auprc': 0.9974335721477016, 'loss_val': 0.14083711135259175, 'psi': 0.9924591464617349}
[S9] START round=11 head_norm_before_train=0.920851 cos_to_last_merge=0.9766 (last merge round=8)
[S9] round=11 local utility u=0.164195 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9993570960686016, 'loss_val': 0.4612309707841057, 'psi': 0.8205171285519787}-{'f1_val': 0.7012904835408967, 'auprc': 0.9437943112112679, 'loss_val': 0.6229334412417469, 'psi': 0.7982920146090452}
[S10] START round=11 head_norm_before_train=1.671998 (no previous merge yet)
[S10] round=11 local utility u=0.026464 metrics={'f1_val': 0.9938009906554108, 'auprc': 0.9959419509139997, 'loss_val': 0.0867166327149373, 'psi': 0.9946573747588463}-{'f1_val': 0.9929535466990002, 'auprc': 0.9942153014328379, 'loss_val': 0.12938041102564304, 'psi': 0.9934582485925352}
[S11] START round=11 head_norm_before_train=0.879276 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.411363 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9439845254942589, 'loss_val': 0.5536042265735864, 'psi': 0.7987550001766957}-{'f1_val': 0.5839590263713859, 'auprc': 0.9393276532880268, 'loss_val': 0.6545021609906547, 'psi': 0.7261064771380422}
[S13] START round=11 head_norm_before_train=0.930566 cos_to_last_merge=0.9966 (last merge round=9)
[S13] round=11 local utility u=0.104112 metrics={'f1_val': 0.6486277575889634, 'auprc': 0.6477554753482411, 'loss_val': 0.5704919776967682, 'psi': 0.6482788446926744}-{'f1_val': 0.6100103691812508, 'auprc': 0.6920817585969318, 'loss_val': 0.6799902442309296, 'psi': 0.6428389249475233}
[S14] START round=11 head_norm_before_train=1.338309 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=1.000000 metrics={'f1_val': 0.9257391028929165, 'auprc': 0.9950667732014041, 'loss_val': 0.49235706077025443, 'psi': 0.9534701710163116}-{'f1_val': 0.6273363298726375, 'auprc': 0.9734820162980474, 'loss_val': 0.6526303374038555, 'psi': 0.7657946044428015}
[S15] START round=11 head_norm_before_train=1.200324 cos_to_last_merge=0.9599 (last merge round=8)
[S15] round=11 local utility u=0.030095 metrics={'f1_val': 0.9889061115496456, 'auprc': 0.9955129732632079, 'loss_val': 0.1452560498183078, 'psi': 0.9915488562350705}-{'f1_val': 0.9883361382778922, 'auprc': 0.9956159889582691, 'loss_val': 0.20233463259770806, 'psi': 0.9912480785500429}
[S16] START round=11 head_norm_before_train=1.033526 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.3033600157531823, 'auprc': 0.6918667267026306, 'loss_val': 0.8992852873128393, 'psi': 0.4587627001329616}-{'f1_val': 0.3845573009821096, 'auprc': 0.6728483945888674, 'loss_val': 0.9049801478094882, 'psi': 0.4998737384248127}
[S17] START round=11 head_norm_before_train=0.800892 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.074168 metrics={'f1_val': 0.35228328818124377, 'auprc': 0.7749612770055158, 'loss_val': 0.963666952725494, 'psi': 0.5213544837109526}-{'f1_val': 0.35362895134290206, 'auprc': 0.7171969893320471, 'loss_val': 0.9467834401156138, 'psi': 0.4990561665385601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:33215
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:33213
[S15] not sending this round → trigger blocked (psi=0.992)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=0.1255
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.7576
[S13] RECEIVED delta(kind=head bytes=1795) from S2
[S13] cosine check vs S2: cos=0.0412
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.4231
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.2605
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.4440
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.2396
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.9889 head_norm=1.288598
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.655667e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.9885 head_norm=1.248925 delta_norm=0.465567
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9589 head_norm=1.826787
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.880350e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.9603 head_norm=1.099746 delta_norm=0.988035
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.4910 head_norm=1.230541
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.614627e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.5342 head_norm=0.831814 delta_norm=0.661463
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6486 head_norm=1.016936
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.873444e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6486 head_norm=0.759206 delta_norm=0.587344
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3523 head_norm=0.862940
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.950669e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3536 head_norm=0.790973 delta_norm=0.495067
[S17] aggregate: ACCEPT kept=['S8', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.430748 cos_to_last_merge=0.8376 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=12 local utility u=0.060656 metrics={'f1_val': 0.7082149827424536, 'auprc': 0.7813271568416424, 'loss_val': 0.5963851702246242, 'psi': 0.7374598523821292}-{'f1_val': 0.701055136928628, 'auprc': 0.6604149320003974, 'loss_val': 0.3120020302142084, 'psi': 0.6847990549573357}
[S3] START round=12 head_norm_before_train=0.831814 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.680298 metrics={'f1_val': 0.6842405692382443, 'auprc': 0.7907743300248499, 'loss_val': 0.7599807375943644, 'psi': 0.7268540735528866}-{'f1_val': 0.4910451475673217, 'auprc': 0.7592404203247185, 'loss_val': 0.8668034669466061, 'psi': 0.5983232566702804}
[S4] START round=12 head_norm_before_train=1.099746 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.9513095001585166, 'auprc': 0.9800050395209972, 'loss_val': 0.27493599998127993, 'psi': 0.9627877159035088}-{'f1_val': 0.958875829071185, 'auprc': 0.9803855240565331, 'loss_val': 0.15746966652439398, 'psi': 0.9674797070653243}
[S5] START round=12 head_norm_before_train=1.128890 cos_to_last_merge=0.8958 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.896
[S5] round=12 local utility u=0.012947 metrics={'f1_val': 0.7008184048127608, 'auprc': 0.6613723267258409, 'loss_val': 0.5219658405286955, 'psi': 0.6850399735779928}-{'f1_val': 0.6521426134103705, 'auprc': 0.7903806518271295, 'loss_val': 0.64282979294036, 'psi': 0.7074378287770741}
[S6] START round=12 head_norm_before_train=1.338596 cos_to_last_merge=0.8713 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6030595233960524, 'auprc': 0.7949615192168161, 'loss_val': 0.5518823053492172, 'psi': 0.6798203217243579}-{'f1_val': 0.687052832103433, 'auprc': 0.8173405442234244, 'loss_val': 0.43676423353346355, 'psi': 0.7391679169514296}
[S7] START round=12 head_norm_before_train=1.467457 (no previous merge yet)
[S7] round=12 local utility u=0.019344 metrics={'f1_val': 0.6366732758343154, 'auprc': 0.780924560954993, 'loss_val': 0.6932131317970436, 'psi': 0.6943737898825865}-{'f1_val': 0.6217495448007468, 'auprc': 0.8091687253881327, 'loss_val': 0.7270905719761968, 'psi': 0.6967172170357012}
[S8] START round=12 head_norm_before_train=1.715675 (no previous merge yet)
[S8] round=12 local utility u=0.001192 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.994005414592068, 'loss_val': 0.07619415478234305, 'psi': 0.9953240278769189}-{'f1_val': 0.9963530749356245, 'auprc': 0.9982248297685494, 'loss_val': 0.09213636899584086, 'psi': 0.9971017768687945}
[S9] START round=12 head_norm_before_train=0.979915 cos_to_last_merge=0.9594 (last merge round=8)
[S9] round=12 local utility u=0.053288 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9993411522398228, 'loss_val': 0.35416279331784206, 'psi': 0.8204664093599403}-{'f1_val': 0.7012904835408967, 'auprc': 0.9993570960686016, 'loss_val': 0.4612309707841057, 'psi': 0.8205171285519787}
[S10] START round=12 head_norm_before_train=1.700164 (no previous merge yet)
[S10] round=12 local utility u=0.006526 metrics={'f1_val': 0.9947663626183323, 'auprc': 0.9937461588160934, 'loss_val': 0.07286997766119402, 'psi': 0.9943582810974367}-{'f1_val': 0.9938009906554108, 'auprc': 0.9959419509139997, 'loss_val': 0.0867166327149373, 'psi': 0.9946573747588463}
[S11] START round=12 head_norm_before_train=0.936538 cos_to_last_merge=0.9953 (last merge round=10)
[S11] round=12 local utility u=0.122102 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9894425349735079, 'loss_val': 0.4443242042336908, 'psi': 0.8167931017415581}-{'f1_val': 0.7019353166316534, 'auprc': 0.9439845254942589, 'loss_val': 0.5536042265735864, 'psi': 0.7987550001766957}
[S13] START round=12 head_norm_before_train=0.759206 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.085207 metrics={'f1_val': 0.6670601058243776, 'auprc': 0.6774175498552816, 'loss_val': 0.599657957611683, 'psi': 0.6712030834367392}-{'f1_val': 0.6486277575889634, 'auprc': 0.6477554753482411, 'loss_val': 0.5704919776967682, 'psi': 0.6482788446926744}
[S14] START round=12 head_norm_before_train=1.375735 cos_to_last_merge=0.9979 (last merge round=10)
[S14] round=12 local utility u=0.166010 metrics={'f1_val': 0.9730273791463124, 'auprc': 0.9891242670424881, 'loss_val': 0.42623923625589694, 'psi': 0.9794661343047827}-{'f1_val': 0.9257391028929165, 'auprc': 0.9950667732014041, 'loss_val': 0.49235706077025443, 'psi': 0.9534701710163116}
[S15] START round=12 head_norm_before_train=1.248925 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7707611664329039, 'auprc': 0.9104545435271871, 'loss_val': 0.37956319049485404, 'psi': 0.8266385172706172}-{'f1_val': 0.9889061115496456, 'auprc': 0.9955129732632079, 'loss_val': 0.1452560498183078, 'psi': 0.9915488562350705}
[S16] START round=12 head_norm_before_train=1.071403 cos_to_last_merge=0.9977 (last merge round=10)
[S16] round=12 local utility u=0.271855 metrics={'f1_val': 0.3660163591247196, 'auprc': 0.7299423442624934, 'loss_val': 0.8457407648804237, 'psi': 0.5115867531798292}-{'f1_val': 0.3033600157531823, 'auprc': 0.6918667267026306, 'loss_val': 0.8992852873128393, 'psi': 0.4587627001329616}
[S17] START round=12 head_norm_before_train=0.790973 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3488582912299756, 'auprc': 0.5606860246603681, 'loss_val': 0.9854548186824706, 'psi': 0.4335893846021326}-{'f1_val': 0.35228328818124377, 'auprc': 0.7749612770055158, 'loss_val': 0.963666952725494, 'psi': 0.5213544837109526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[S11] not sending this round → trigger blocked (psi=0.817)
[S8] not sending this round → trigger blocked (psi=0.995)
[S2] not sending this round → trigger blocked (psi=0.737)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:33216
[S14] not sending this round → trigger blocked (psi=0.979)
[S13] not sending this round → trigger blocked (psi=0.671)
[S9] not sending this round → trigger blocked (psi=0.820)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.4905
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.7440
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9607
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9528
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.7878
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7012 head_norm=1.038094
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.208044e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7012 head_norm=0.903130 delta_norm=0.320804
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9730 head_norm=1.419165
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.072751e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9770 head_norm=1.441741 delta_norm=0.207275
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3660 head_norm=1.114553
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.763158e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.3964 head_norm=1.124338 delta_norm=0.176316
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.6842 head_norm=0.871482
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.159250e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6726 head_norm=1.226214 delta_norm=0.615925
[S3] aggregate: ROLLBACK (f1_val pre=0.684 post=0.673 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3489 head_norm=0.858225
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.099865e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3460 head_norm=0.853992 delta_norm=0.509987
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.461750 cos_to_last_merge=0.8329 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=13 local utility u=0.041043 metrics={'f1_val': 0.7069163961126439, 'auprc': 0.7845244433009887, 'loss_val': 0.5160999777460864, 'psi': 0.7379596149879819}-{'f1_val': 0.7082149827424536, 'auprc': 0.7813271568416424, 'loss_val': 0.5963851702246242, 'psi': 0.7374598523821292}
[S3] START round=13 head_norm_before_train=1.226214 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5497734709584504, 'auprc': 0.9595574766544906, 'loss_val': 0.7330973168332909, 'psi': 0.7136870732368665}-{'f1_val': 0.6842405692382443, 'auprc': 0.7907743300248499, 'loss_val': 0.7599807375943644, 'psi': 0.7268540735528866}
[S4] START round=13 head_norm_before_train=1.176944 cos_to_last_merge=0.9979 (last merge round=11)
[S4] round=13 local utility u=0.017053 metrics={'f1_val': 0.952029181629974, 'auprc': 0.9721707680804976, 'loss_val': 0.22164451977314767, 'psi': 0.9600858162101835}-{'f1_val': 0.9513095001585166, 'auprc': 0.9800050395209972, 'loss_val': 0.27493599998127993, 'psi': 0.9627877159035088}
[S5] START round=13 head_norm_before_train=1.161128 cos_to_last_merge=0.8855 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=13 local utility u=0.228760 metrics={'f1_val': 0.714400588689728, 'auprc': 0.7904999750693478, 'loss_val': 0.533322316570902, 'psi': 0.744840343241576}-{'f1_val': 0.7008184048127608, 'auprc': 0.6613723267258409, 'loss_val': 0.5219658405286955, 'psi': 0.6850399735779928}
[S6] START round=13 head_norm_before_train=1.364356 cos_to_last_merge=0.8673 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=13 local utility u=0.748405 metrics={'f1_val': 0.7323668108950124, 'auprc': 0.9663192320810563, 'loss_val': 0.3449882382113767, 'psi': 0.82594777936943}-{'f1_val': 0.6030595233960524, 'auprc': 0.7949615192168161, 'loss_val': 0.5518823053492172, 'psi': 0.6798203217243579}
[S7] START round=13 head_norm_before_train=1.493028 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6190101252437793, 'auprc': 0.7799508342348933, 'loss_val': 0.6930190384335109, 'psi': 0.6833864088402248}-{'f1_val': 0.6366732758343154, 'auprc': 0.780924560954993, 'loss_val': 0.6932131317970436, 'psi': 0.6943737898825865}
[S8] START round=13 head_norm_before_train=1.749606 (no previous merge yet)
[S8] round=13 local utility u=0.012672 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9983879452030346, 'loss_val': 0.06489811035242145, 'psi': 0.9971670230425886}-{'f1_val': 0.9962031034001528, 'auprc': 0.994005414592068, 'loss_val': 0.07619415478234305, 'psi': 0.9953240278769189}
[S9] START round=13 head_norm_before_train=0.903130 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000804 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9990830486109001, 'loss_val': 0.3517811653553716, 'psi': 0.8203631679083712}-{'f1_val': 0.7012165807733519, 'auprc': 0.9993411522398228, 'loss_val': 0.35416279331784206, 'psi': 0.8204664093599403}
[S10] START round=13 head_norm_before_train=1.733911 (no previous merge yet)
[S10] round=13 local utility u=0.006895 metrics={'f1_val': 0.9944867328096639, 'auprc': 0.9951435287509177, 'loss_val': 0.06159376868135156, 'psi': 0.9947494511861654}-{'f1_val': 0.9947663626183323, 'auprc': 0.9937461588160934, 'loss_val': 0.07286997766119402, 'psi': 0.9943582810974367}
[S11] START round=13 head_norm_before_train=0.992248 cos_to_last_merge=0.9859 (last merge round=10)
[S11] round=13 local utility u=0.041913 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9959338861651895, 'loss_val': 0.3799718442378907, 'psi': 0.8193896422182307}-{'f1_val': 0.7016934795869249, 'auprc': 0.9894425349735079, 'loss_val': 0.4443242042336908, 'psi': 0.8167931017415581}
[S13] START round=13 head_norm_before_train=0.853294 cos_to_last_merge=0.9875 (last merge round=11)
[S13] round=13 local utility u=0.052545 metrics={'f1_val': 0.6751770795536721, 'auprc': 0.6685744652954229, 'loss_val': 0.5167398207002137, 'psi': 0.6725360338503724}-{'f1_val': 0.6670601058243776, 'auprc': 0.6774175498552816, 'loss_val': 0.599657957611683, 'psi': 0.6712030834367392}
[S14] START round=13 head_norm_before_train=1.441741 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.022170 metrics={'f1_val': 0.9754257184568865, 'auprc': 0.9868528192815276, 'loss_val': 0.38947398280117224, 'psi': 0.979996558786743}-{'f1_val': 0.9730273791463124, 'auprc': 0.9891242670424881, 'loss_val': 0.42623923625589694, 'psi': 0.9794661343047827}
[S15] START round=13 head_norm_before_train=1.323005 cos_to_last_merge=0.9974 (last merge round=11)
[S15] round=13 local utility u=0.558783 metrics={'f1_val': 0.8859566278917503, 'auprc': 0.9925654569694589, 'loss_val': 0.19950190837872114, 'psi': 0.9286001595228337}-{'f1_val': 0.7707611664329039, 'auprc': 0.9104545435271871, 'loss_val': 0.37956319049485404, 'psi': 0.8266385172706172}
[S16] START round=13 head_norm_before_train=1.124338 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.34767699490337906, 'auprc': 0.7585304925125064, 'loss_val': 0.848326809120426, 'psi': 0.51201839394703}-{'f1_val': 0.3660163591247196, 'auprc': 0.7299423442624934, 'loss_val': 0.8457407648804237, 'psi': 0.5115867531798292}
[S17] START round=13 head_norm_before_train=0.853992 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.080286 metrics={'f1_val': 0.3518456193796448, 'auprc': 0.608602904750984, 'loss_val': 0.9865572454904451, 'psi': 0.4545485335281805}-{'f1_val': 0.3488582912299756, 'auprc': 0.5606860246603681, 'loss_val': 0.9854548186824706, 'psi': 0.4335893846021326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S5] not sending this round → trigger blocked (psi=0.745)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:33213
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=0.5842
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.3387
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.5314
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.8864
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=-0.0265
[S10] DROPPED delta from S4 (cos=-0.0265 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.6745
[S13] RECEIVED delta(kind=head bytes=1805) from S2
[S13] cosine check vs S2: cos=0.4338
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.5412
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.5378
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.3263
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=13 metric=0.5498 head_norm=1.263734
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.469985e-01
[S3] stored merged vector for next round verification (round=13)
[S3] DEBUG after merge:  round=13 metric=0.5755 head_norm=0.890907 delta_norm=0.646998
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.8860 head_norm=1.402884
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.457532e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.8961 head_norm=1.400263 delta_norm=0.345753
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.6752 head_norm=0.944963
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.081570e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.6737 head_norm=0.858964 delta_norm=0.408157
[S13] aggregate: ACCEPT kept=['S2', 'S11'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9520 head_norm=1.270242
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.546739e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.9532 head_norm=0.972405 delta_norm=0.554674
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.039923
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.623819e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7019 head_norm=0.974504 delta_norm=0.262382
[S11] aggregate: ACCEPT kept=['S6', 'S15'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3518 head_norm=0.909736
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.715451e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3523 head_norm=0.867139 delta_norm=0.471545
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.489392 cos_to_last_merge=0.8303 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7085742138177114, 'auprc': 0.6674266194665388, 'loss_val': 0.376424880275865, 'psi': 0.6921151760772424}-{'f1_val': 0.7069163961126439, 'auprc': 0.7845244433009887, 'loss_val': 0.5160999777460864, 'psi': 0.7379596149879819}
[S3] START round=14 head_norm_before_train=0.890907 cos_to_last_merge=1.0000 (last merge round=13)
[S3] round=14 local utility u=0.443198 metrics={'f1_val': 0.6940226410609599, 'auprc': 0.9356168354973672, 'loss_val': 0.6403748336878431, 'psi': 0.7906603188355228}-{'f1_val': 0.5497734709584504, 'auprc': 0.9595574766544906, 'loss_val': 0.7330973168332909, 'psi': 0.7136870732368665}
[S4] START round=14 head_norm_before_train=0.972405 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9507581865427455, 'auprc': 0.97039197799123, 'loss_val': 0.2985670415202498, 'psi': 0.9586117031221393}-{'f1_val': 0.952029181629974, 'auprc': 0.9721707680804976, 'loss_val': 0.22164451977314767, 'psi': 0.9600858162101835}
[S5] START round=14 head_norm_before_train=1.183130 cos_to_last_merge=0.8768 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.877
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.6615051537203929, 'loss_val': 0.4162188555496122, 'psi': 0.6849440223179228}-{'f1_val': 0.714400588689728, 'auprc': 0.7904999750693478, 'loss_val': 0.533322316570902, 'psi': 0.744840343241576}
[S6] START round=14 head_norm_before_train=1.392807 cos_to_last_merge=0.8638 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=14 local utility u=0.748706 metrics={'f1_val': 0.9619481193252866, 'auprc': 0.9733325397773387, 'loss_val': 0.2461038723463753, 'psi': 0.9665018875061074}-{'f1_val': 0.7323668108950124, 'auprc': 0.9663192320810563, 'loss_val': 0.3449882382113767, 'psi': 0.82594777936943}
[S7] START round=14 head_norm_before_train=1.515890 (no previous merge yet)
[S7] round=14 local utility u=0.116692 metrics={'f1_val': 0.645821151633388, 'auprc': 0.7858585906461342, 'loss_val': 0.6382248985954894, 'psi': 0.7018361272384865}-{'f1_val': 0.6190101252437793, 'auprc': 0.7799508342348933, 'loss_val': 0.6930190384335109, 'psi': 0.6833864088402248}
[S8] START round=14 head_norm_before_train=1.784830 (no previous merge yet)
[S8] round=14 local utility u=0.007616 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989828959117302, 'loss_val': 0.05145024937154687, 'psi': 0.9974050033260669}-{'f1_val': 0.9963530749356245, 'auprc': 0.9983879452030346, 'loss_val': 0.06489811035242145, 'psi': 0.9971670230425886}
[S9] START round=14 head_norm_before_train=0.958112 cos_to_last_merge=0.9975 (last merge round=12)
[S9] round=14 local utility u=0.024838 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9989190185938797, 'loss_val': 0.30161345698355896, 'psi': 0.8202975559015631}-{'f1_val': 0.7012165807733519, 'auprc': 0.9990830486109001, 'loss_val': 0.3517811653553716, 'psi': 0.8203631679083712}
[S10] START round=14 head_norm_before_train=1.764370 (no previous merge yet)
[S10] round=14 local utility u=0.000244 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.995943064209123, 'loss_val': 0.0564288974990955, 'psi': 0.9943616509161921}-{'f1_val': 0.9944867328096639, 'auprc': 0.9951435287509177, 'loss_val': 0.06159376868135156, 'psi': 0.9947494511861654}
[S11] START round=14 head_norm_before_train=0.974504 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.997559761959268, 'loss_val': 0.41415882299962503, 'psi': 0.8200399925358621}-{'f1_val': 0.7016934795869249, 'auprc': 0.9959338861651895, 'loss_val': 0.3799718442378907, 'psi': 0.8193896422182307}
[S13] START round=14 head_norm_before_train=0.858964 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6319678992905043, 'auprc': 0.6097265926119477, 'loss_val': 0.6884548672616164, 'psi': 0.6230713766190816}-{'f1_val': 0.6751770795536721, 'auprc': 0.6685744652954229, 'loss_val': 0.5167398207002137, 'psi': 0.6725360338503724}
[S14] START round=14 head_norm_before_train=1.480702 cos_to_last_merge=0.9988 (last merge round=12)
[S14] round=14 local utility u=0.110794 metrics={'f1_val': 0.9972114391202196, 'auprc': 0.9958445212389386, 'loss_val': 0.3255745468069004, 'psi': 0.9966646719677072}-{'f1_val': 0.9754257184568865, 'auprc': 0.9868528192815276, 'loss_val': 0.38947398280117224, 'psi': 0.979996558786743}
[S15] START round=14 head_norm_before_train=1.400263 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.353176 metrics={'f1_val': 0.9912110630593476, 'auprc': 0.9978498083266213, 'loss_val': 0.14052985102923748, 'psi': 0.993866561166257}-{'f1_val': 0.8859566278917503, 'auprc': 0.9925654569694589, 'loss_val': 0.19950190837872114, 'psi': 0.9286001595228337}
[S16] START round=14 head_norm_before_train=1.167981 cos_to_last_merge=0.9983 (last merge round=12)
[S16] round=14 local utility u=0.133739 metrics={'f1_val': 0.4043911663337166, 'auprc': 0.7395102606618205, 'loss_val': 0.8640728498443809, 'psi': 0.5384388040649581}-{'f1_val': 0.34767699490337906, 'auprc': 0.7585304925125064, 'loss_val': 0.848326809120426, 'psi': 0.51201839394703}
[S17] START round=14 head_norm_before_train=0.867139 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.036068 metrics={'f1_val': 0.36355183555010195, 'auprc': 0.6047391703470221, 'loss_val': 0.9730671107925025, 'psi': 0.46002676946887}-{'f1_val': 0.3518456193796448, 'auprc': 0.608602904750984, 'loss_val': 0.9865572454904451, 'psi': 0.4545485335281805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.994)
[S6] not sending this round → trigger blocked (psi=0.967)
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[S9] not sending this round → trigger blocked (psi=0.820)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33210
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S3] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.5259
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9743
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.8794
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.7396
[S17] not sending this round → trigger blocked (psi=0.460)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9972 head_norm=1.520723
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.740077e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9975 head_norm=1.521288 delta_norm=0.174008
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7012 head_norm=1.012244
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.418004e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7012 head_norm=0.941653 delta_norm=0.241800
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.6940 head_norm=0.930438
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.377697e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.6927 head_norm=1.282578 delta_norm=0.637770
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3636 head_norm=0.931739
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.365799e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3518 head_norm=0.939510 delta_norm=0.536580
[S17] aggregate: ROLLBACK (f1_val pre=0.364 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S2] START round=15 head_norm_before_train=1.512875 cos_to_last_merge=0.8286 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.829
[S2] round=15 local utility u=0.272885 metrics={'f1_val': 0.7085712684782008, 'auprc': 0.8439996238361047, 'loss_val': 0.36035591123135174, 'psi': 0.7627426106213624}-{'f1_val': 0.7085742138177114, 'auprc': 0.6674266194665388, 'loss_val': 0.376424880275865, 'psi': 0.6921151760772424}
[S3] START round=15 head_norm_before_train=1.282578 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.6466916482429609, 'auprc': 0.9969874731331109, 'loss_val': 0.5525239759959863, 'psi': 0.7868099781990209}-{'f1_val': 0.6940226410609599, 'auprc': 0.9356168354973672, 'loss_val': 0.6403748336878431, 'psi': 0.7906603188355228}
[S4] START round=15 head_norm_before_train=1.078582 cos_to_last_merge=0.9935 (last merge round=13)
[S4] round=15 local utility u=0.012194 metrics={'f1_val': 0.9520242054645935, 'auprc': 0.9656109539456867, 'loss_val': 0.2674315182224566, 'psi': 0.9574589048570308}-{'f1_val': 0.9507581865427455, 'auprc': 0.97039197799123, 'loss_val': 0.2985670415202498, 'psi': 0.9586117031221393}
[S5] START round=15 head_norm_before_train=1.204527 cos_to_last_merge=0.8685 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=15 local utility u=0.212593 metrics={'f1_val': 0.7073218054782953, 'auprc': 0.7921788658904423, 'loss_val': 0.42356535797560446, 'psi': 0.7412646296431541}-{'f1_val': 0.7005699347162762, 'auprc': 0.6615051537203929, 'loss_val': 0.4162188555496122, 'psi': 0.6849440223179228}
[S6] START round=15 head_norm_before_train=1.414479 cos_to_last_merge=0.8614 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.823492428002237, 'auprc': 0.9629912451893521, 'loss_val': 0.4015460229260835, 'psi': 0.879291954877083}-{'f1_val': 0.9619481193252866, 'auprc': 0.9733325397773387, 'loss_val': 0.2461038723463753, 'psi': 0.9665018875061074}
[S7] START round=15 head_norm_before_train=1.541620 (no previous merge yet)
[S7] round=15 local utility u=0.060757 metrics={'f1_val': 0.6534591298058334, 'auprc': 0.7945634900748425, 'loss_val': 0.5886530790772543, 'psi': 0.7099008739134371}-{'f1_val': 0.645821151633388, 'auprc': 0.7858585906461342, 'loss_val': 0.6382248985954894, 'psi': 0.7018361272384865}
[S8] START round=15 head_norm_before_train=1.820843 (no previous merge yet)
[S8] round=15 local utility u=0.002164 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9989713109637017, 'loss_val': 0.04708830850989562, 'psi': 0.9974003693468554}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989828959117302, 'loss_val': 0.05145024937154687, 'psi': 0.9974050033260669}
[S9] START round=15 head_norm_before_train=0.941653 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.013943 metrics={'f1_val': 0.7083606164647697, 'auprc': 0.9979600036011708, 'loss_val': 0.31371529570191137, 'psi': 0.8242003713193301}-{'f1_val': 0.7012165807733519, 'auprc': 0.9989190185938797, 'loss_val': 0.30161345698355896, 'psi': 0.8202975559015631}
[S10] START round=15 head_norm_before_train=1.799388 (no previous merge yet)
[S10] round=15 local utility u=0.010528 metrics={'f1_val': 0.995182342619192, 'auprc': 0.9959051431775053, 'loss_val': 0.04650895315278898, 'psi': 0.9954714628425173}-{'f1_val': 0.9933073753875716, 'auprc': 0.995943064209123, 'loss_val': 0.0564288974990955, 'psi': 0.9943616509161921}
[S11] START round=15 head_norm_before_train=1.016190 cos_to_last_merge=0.9983 (last merge round=13)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.6900335366395351, 'auprc': 0.9962454633659517, 'loss_val': 0.4057004993047122, 'psi': 0.8125183073301018}-{'f1_val': 0.7016934795869249, 'auprc': 0.997559761959268, 'loss_val': 0.41415882299962503, 'psi': 0.8200399925358621}
[S13] START round=15 head_norm_before_train=0.928840 cos_to_last_merge=0.9916 (last merge round=13)
[S13] round=15 local utility u=0.064643 metrics={'f1_val': 0.6171184188540156, 'auprc': 0.679664372990028, 'loss_val': 0.6798858334765377, 'psi': 0.6421368005084206}-{'f1_val': 0.6319678992905043, 'auprc': 0.6097265926119477, 'loss_val': 0.6884548672616164, 'psi': 0.6230713766190816}
[S14] START round=15 head_norm_before_train=1.521288 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.000000 metrics={'f1_val': 0.9526231667816862, 'auprc': 0.9973887747233419, 'loss_val': 0.2821108327612014, 'psi': 0.9705294099583486}-{'f1_val': 0.9972114391202196, 'auprc': 0.9958445212389386, 'loss_val': 0.3255745468069004, 'psi': 0.9966646719677072}
[S15] START round=15 head_norm_before_train=1.461339 cos_to_last_merge=0.9982 (last merge round=13)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.9836632781139562, 'auprc': 0.997193775334859, 'loss_val': 0.10351327880584561, 'psi': 0.9890754770023173}-{'f1_val': 0.9912110630593476, 'auprc': 0.9978498083266213, 'loss_val': 0.14052985102923748, 'psi': 0.993866561166257}
[S16] START round=15 head_norm_before_train=1.213696 cos_to_last_merge=0.9942 (last merge round=12)
[S16] round=15 local utility u=0.651989 metrics={'f1_val': 0.5956396856309556, 'auprc': 0.7661735661103416, 'loss_val': 0.7875764881593351, 'psi': 0.66385323782271}-{'f1_val': 0.4043911663337166, 'auprc': 0.7395102606618205, 'loss_val': 0.8640728498443809, 'psi': 0.5384388040649581}
[S17] START round=15 head_norm_before_train=0.939510 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.243590 metrics={'f1_val': 0.44536679351609415, 'auprc': 0.6064172297698512, 'loss_val': 0.9818107564401718, 'psi': 0.509786968017597}-{'f1_val': 0.36355183555010195, 'auprc': 0.6047391703470221, 'loss_val': 0.9730671107925025, 'psi': 0.46002676946887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.664)
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:33211
[S7] not sending this round → trigger blocked (psi=0.710)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.6416
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.3462
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.7014
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.0296
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=0.6155
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9548
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.3356
[S15] ⇄ pheromone p=0.279 → S11@127.0.0.1:33212
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=15 metric=0.6467 head_norm=1.320998
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.811963e-01
[S3] stored merged vector for next round verification (round=15)
[S3] DEBUG after merge:  round=15 metric=0.6710 head_norm=0.952080 delta_norm=0.681196
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.258 → S9@127.0.0.1:33210
[S14] ⇄ pheromone p=0.246 → S15@127.0.0.1:33215
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9952 head_norm=1.827101
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.076564e+00
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9947 head_norm=1.106177 delta_norm=1.076564
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.141 → S3@127.0.0.1:33203
[S6] ⇄ pheromone p=0.329 → S11@127.0.0.1:33212
[S11] ⇄ pheromone p=0.160 → S13@127.0.0.1:33213
[S7] ⇄ pheromone p=0.164 → S14@127.0.0.1:33214
[S9] ⇄ pheromone p=0.147 → S17@127.0.0.1:33217
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9520 head_norm=1.194543
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.330508e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.9524 head_norm=1.011065 delta_norm=0.433051
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.111 → S10@127.0.0.1:33211
[S2] ⇄ pheromone p=0.160 → S13@127.0.0.1:33213
[S5] ⇄ pheromone p=0.199 → S16@127.0.0.1:33216
[S8] ⇄ pheromone p=0.126 → S17@127.0.0.1:33217
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6171 head_norm=0.996312
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.054178e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6167 head_norm=1.143566 delta_norm=0.605418
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.124 → S4@127.0.0.1:33204
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.5956 head_norm=1.254247
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.870333e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.5264 head_norm=1.227089 delta_norm=0.187033
[S16] aggregate: ROLLBACK (f1_val pre=0.596 post=0.526 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.262 → S17@127.0.0.1:33217
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.4454 head_norm=0.997964
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.944699e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3546 head_norm=0.938559 delta_norm=0.494470
[S17] aggregate: ROLLBACK (f1_val pre=0.445 post=0.355 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.129 → S3@127.0.0.1:33203
[S2] START round=16 head_norm_before_train=1.534897 cos_to_last_merge=0.8268 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.827
[S2] round=16 local utility u=0.007974 metrics={'f1_val': 0.7097410826493046, 'auprc': 0.8718029449551883, 'loss_val': 0.434837374826964, 'psi': 0.774565827571658}-{'f1_val': 0.7085712684782008, 'auprc': 0.8439996238361047, 'loss_val': 0.36035591123135174, 'psi': 0.7627426106213624}
[S3] START round=16 head_norm_before_train=0.952080 cos_to_last_merge=1.0000 (last merge round=15)
[S3] round=16 local utility u=0.138452 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9813229776115148, 'loss_val': 0.5519640065671136, 'psi': 0.8128780286398589}-{'f1_val': 0.6466916482429609, 'auprc': 0.9969874731331109, 'loss_val': 0.5525239759959863, 'psi': 0.7868099781990209}
[S4] START round=16 head_norm_before_train=1.011065 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9507920100809018, 'auprc': 0.9611636210496949, 'loss_val': 0.297466638981867, 'psi': 0.954940654468419}-{'f1_val': 0.9520242054645935, 'auprc': 0.9656109539456867, 'loss_val': 0.2674315182224566, 'psi': 0.9574589048570308}
[S5] START round=16 head_norm_before_train=1.228138 cos_to_last_merge=0.8603 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.860
[S5] round=16 local utility u=0.011315 metrics={'f1_val': 0.7071857876657849, 'auprc': 0.7924503528004088, 'loss_val': 0.40093289588317976, 'psi': 0.7412916137196345}-{'f1_val': 0.7073218054782953, 'auprc': 0.7921788658904423, 'loss_val': 0.42356535797560446, 'psi': 0.7412646296431541}
[S6] START round=16 head_norm_before_train=1.428381 cos_to_last_merge=0.8600 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.462110908856894, 'auprc': 0.7747702103796277, 'loss_val': 0.7475409476435546, 'psi': 0.5871746294659874}-{'f1_val': 0.823492428002237, 'auprc': 0.9629912451893521, 'loss_val': 0.4015460229260835, 'psi': 0.879291954877083}
[S7] START round=16 head_norm_before_train=1.565225 (no previous merge yet)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.39464474244828973, 'auprc': 0.7797544798395, 'loss_val': 1.176967513301625, 'psi': 0.5486886374047739}-{'f1_val': 0.6534591298058334, 'auprc': 0.7945634900748425, 'loss_val': 0.5886530790772543, 'psi': 0.7099008739134371}
[S8] START round=16 head_norm_before_train=1.852982 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9948741547680577, 'auprc': 0.9988817754697542, 'loss_val': 0.04946624065757899, 'psi': 0.9964772030487363}-{'f1_val': 0.9963530749356245, 'auprc': 0.9989713109637017, 'loss_val': 0.04708830850989562, 'psi': 0.9974003693468554}
[S9] START round=16 head_norm_before_train=0.987840 cos_to_last_merge=0.9983 (last merge round=14)
[S9] round=16 local utility u=0.880263 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9984373022008288, 'loss_val': 0.239042470773696, 'psi': 0.9928334297927915}-{'f1_val': 0.7083606164647697, 'auprc': 0.9979600036011708, 'loss_val': 0.31371529570191137, 'psi': 0.8242003713193301}
[S10] START round=16 head_norm_before_train=1.106177 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9949255377402499, 'auprc': 0.9959967724672582, 'loss_val': 0.1565112782054369, 'psi': 0.9953540316310532}-{'f1_val': 0.995182342619192, 'auprc': 0.9959051431775053, 'loss_val': 0.04650895315278898, 'psi': 0.9954714628425173}
[S11] START round=16 head_norm_before_train=1.060802 cos_to_last_merge=0.9939 (last merge round=13)
[S11] round=16 local utility u=0.085565 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9975168049065313, 'loss_val': 0.30834413091777924, 'psi': 0.8200228097147675}-{'f1_val': 0.6900335366395351, 'auprc': 0.9962454633659517, 'loss_val': 0.4057004993047122, 'psi': 0.8125183073301018}
[S13] START round=16 head_norm_before_train=1.143566 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6132636518810615, 'auprc': 0.6803096597678912, 'loss_val': 0.7397406845992593, 'psi': 0.6400820550357933}-{'f1_val': 0.6171184188540156, 'auprc': 0.679664372990028, 'loss_val': 0.6798858334765377, 'psi': 0.6421368005084206}
[S14] START round=16 head_norm_before_train=1.546236 cos_to_last_merge=0.9996 (last merge round=14)
[S14] round=16 local utility u=0.172220 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9955833068174593, 'loss_val': 0.2040123854976321, 'psi': 0.996983028209528}-{'f1_val': 0.9526231667816862, 'auprc': 0.9973887747233419, 'loss_val': 0.2821108327612014, 'psi': 0.9705294099583486}
[S15] START round=16 head_norm_before_train=1.535773 cos_to_last_merge=0.9926 (last merge round=13)
[S15] round=16 local utility u=0.053614 metrics={'f1_val': 0.9958913191068413, 'auprc': 0.996756261316852, 'loss_val': 0.06834002743710085, 'psi': 0.9962372959908455}-{'f1_val': 0.9836632781139562, 'auprc': 0.997193775334859, 'loss_val': 0.10351327880584561, 'psi': 0.9890754770023173}
[S16] START round=16 head_norm_before_train=1.227089 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.133045 metrics={'f1_val': 0.6389887357798594, 'auprc': 0.767062333466442, 'loss_val': 0.7842477067421109, 'psi': 0.6902181748544924}-{'f1_val': 0.5956396856309556, 'auprc': 0.7661735661103416, 'loss_val': 0.7875764881593351, 'psi': 0.66385323782271}
[S17] START round=16 head_norm_before_train=0.938559 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.35676763718817783, 'auprc': 0.7429244953813603, 'loss_val': 0.9748989921729484, 'psi': 0.5112303804654508}-{'f1_val': 0.44536679351609415, 'auprc': 0.6064172297698512, 'loss_val': 0.9818107564401718, 'psi': 0.509786968017597}
[S5] not sending this round → trigger blocked (psi=0.741)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:33210
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:33215
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.775)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.5605
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.3146
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=0.9204
[S11] RECEIVED delta(kind=head bytes=1804) from S15
[S11] cosine check vs S15: cos=0.5545
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=0.9236
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=16 metric=0.6133 head_norm=1.199124
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.744778e-01
[S13] stored merged vector for next round verification (round=16)
[S13] DEBUG after merge:  round=16 metric=0.6141 head_norm=0.932961 delta_norm=0.674478
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9891 head_norm=1.041990
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.001922e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9874 head_norm=0.996219 delta_norm=0.200192
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.9959 head_norm=1.597661
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.161525e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.9959 head_norm=1.551580 delta_norm=0.316153
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.7017 head_norm=1.101260
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.734157e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.7019 head_norm=1.195474 delta_norm=0.673416
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3568 head_norm=1.002820
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.437196e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3997 head_norm=1.003104 delta_norm=0.543720
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.556931 cos_to_last_merge=0.8247 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7146424967158749, 'auprc': 0.8601921631649895, 'loss_val': 0.532734135564241, 'psi': 0.7728623632955207}-{'f1_val': 0.7097410826493046, 'auprc': 0.8718029449551883, 'loss_val': 0.434837374826964, 'psi': 0.774565827571658}
[S3] START round=17 head_norm_before_train=0.989604 cos_to_last_merge=0.9974 (last merge round=15)
[S3] round=17 local utility u=0.075117 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971205216363128, 'loss_val': 0.4501716386932406, 'psi': 0.8193019308957049}-{'f1_val': 0.7005813959920884, 'auprc': 0.9813229776115148, 'loss_val': 0.5519640065671136, 'psi': 0.8128780286398589}
[S4] START round=17 head_norm_before_train=1.131442 cos_to_last_merge=0.9914 (last merge round=15)
[S4] round=17 local utility u=0.020473 metrics={'f1_val': 0.9494259377790534, 'auprc': 0.9682558728086195, 'loss_val': 0.26960103736032975, 'psi': 0.9569579117908797}-{'f1_val': 0.9507920100809018, 'auprc': 0.9611636210496949, 'loss_val': 0.297466638981867, 'psi': 0.954940654468419}
[S5] START round=17 head_norm_before_train=1.252322 cos_to_last_merge=0.8530 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.853
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6662709107454138, 'loss_val': 0.33465893414063064, 'psi': 0.6867011547585138}-{'f1_val': 0.7071857876657849, 'auprc': 0.7924503528004088, 'loss_val': 0.40093289588317976, 'psi': 0.7412916137196345}
[S6] START round=17 head_norm_before_train=1.449670 cos_to_last_merge=0.8582 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.858
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.8232302109797304, 'auprc': 0.898044380973124, 'loss_val': 0.4370492947678589, 'psi': 0.8531558789770879}-{'f1_val': 0.462110908856894, 'auprc': 0.7747702103796277, 'loss_val': 0.7475409476435546, 'psi': 0.5871746294659874}
[S7] START round=17 head_norm_before_train=1.582119 (no previous merge yet)
[S7] round=17 local utility u=1.000000 metrics={'f1_val': 0.6607255559238803, 'auprc': 0.8072410826637052, 'loss_val': 0.5241573254126508, 'psi': 0.7193317666198102}-{'f1_val': 0.39464474244828973, 'auprc': 0.7797544798395, 'loss_val': 1.176967513301625, 'psi': 0.5486886374047739}
[S8] START round=17 head_norm_before_train=1.879900 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9989522600688243, 'loss_val': 0.047302657334120146, 'psi': 0.9958434470718821}-{'f1_val': 0.9948741547680577, 'auprc': 0.9988817754697542, 'loss_val': 0.04946624065757899, 'psi': 0.9964772030487363}
[S9] START round=17 head_norm_before_train=0.996219 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.003559 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9984666913609498, 'loss_val': 0.23970734249362882, 'psi': 0.9936147367162596}-{'f1_val': 0.9890975148541, 'auprc': 0.9984373022008288, 'loss_val': 0.239042470773696, 'psi': 0.9928334297927915}
[S10] START round=17 head_norm_before_train=1.191322 cos_to_last_merge=0.9965 (last merge round=15)
[S10] round=17 local utility u=0.028838 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9948249819282915, 'loss_val': 0.09440093444073076, 'psi': 0.9947934147809199}-{'f1_val': 0.9949255377402499, 'auprc': 0.9959967724672582, 'loss_val': 0.1565112782054369, 'psi': 0.9953540316310532}
[S11] START round=17 head_norm_before_train=1.195474 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.612585177985465, 'auprc': 0.9862903825766962, 'loss_val': 0.6061456853433612, 'psi': 0.7620672598219574}-{'f1_val': 0.7016934795869249, 'auprc': 0.9975168049065313, 'loss_val': 0.30834413091777924, 'psi': 0.8200228097147675}
[S13] START round=17 head_norm_before_train=0.932961 cos_to_last_merge=1.0000 (last merge round=16)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6163503009849763, 'auprc': 0.6634129991601863, 'loss_val': 0.7272897320200267, 'psi': 0.6351753802550604}-{'f1_val': 0.6132636518810615, 'auprc': 0.6803096597678912, 'loss_val': 0.7397406845992593, 'psi': 0.6400820550357933}
[S14] START round=17 head_norm_before_train=1.569134 cos_to_last_merge=0.9987 (last merge round=14)
[S14] round=17 local utility u=0.012841 metrics={'f1_val': 0.9975280800653981, 'auprc': 0.9956400634651282, 'loss_val': 0.17617134408501814, 'psi': 0.9967728734252901}-{'f1_val': 0.9979161758042404, 'auprc': 0.9955833068174593, 'loss_val': 0.2040123854976321, 'psi': 0.996983028209528}
[S15] START round=17 head_norm_before_train=1.551580 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.7651486366548327, 'auprc': 0.9894861378651971, 'loss_val': 0.35509084759335735, 'psi': 0.8548836371389785}-{'f1_val': 0.9958913191068413, 'auprc': 0.996756261316852, 'loss_val': 0.06834002743710085, 'psi': 0.9962372959908455}
[S16] START round=17 head_norm_before_train=1.264140 cos_to_last_merge=0.9992 (last merge round=15)
[S16] round=17 local utility u=0.601459 metrics={'f1_val': 0.8230909712798744, 'auprc': 0.7894349898158304, 'loss_val': 0.7530611727379455, 'psi': 0.8096285786942568}-{'f1_val': 0.6389887357798594, 'auprc': 0.767062333466442, 'loss_val': 0.7842477067421109, 'psi': 0.6902181748544924}
[S17] START round=17 head_norm_before_train=1.003104 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.288630 metrics={'f1_val': 0.4656921134920403, 'auprc': 0.6952100113716129, 'loss_val': 0.9080416386155407, 'psi': 0.5574992726438693}-{'f1_val': 0.35676763718817783, 'auprc': 0.7429244953813603, 'loss_val': 0.9748989921729484, 'psi': 0.5112303804654508}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.810)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:33214
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.9698
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.6590
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9817
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.3056
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.4790
[S17] RECEIVED delta(kind=head bytes=1794) from S9
[S17] cosine check vs S9: cos=0.6723
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9698
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.7129
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.7651 head_norm=1.605438
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.966581e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.7661 head_norm=1.587011 delta_norm=0.196658
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.6126 head_norm=1.224629
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.993802e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.6135 head_norm=1.090183 delta_norm=0.799380
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.9904 head_norm=1.050556
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.283077e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.9888 head_norm=1.033802 delta_norm=0.128308
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9975 head_norm=1.592836
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.523495e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9975 head_norm=1.586073 delta_norm=0.152350
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9948 head_norm=1.315635
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.532357e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9948 head_norm=1.099453 delta_norm=0.653236
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.7008 head_norm=1.032837
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.181479e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.7008 head_norm=0.940623 delta_norm=0.218148
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=17 metric=0.4657 head_norm=1.057896
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.267731e-01
[S17] stored merged vector for next round verification (round=17)
[S17] DEBUG after merge:  round=17 metric=0.4010 head_norm=0.963987 delta_norm=0.426773
[S17] aggregate: ROLLBACK (f1_val pre=0.466 post=0.401 tol_abs=0.005 tol_rel=0.0)
[S2] START round=18 head_norm_before_train=1.575427 cos_to_last_merge=0.8228 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=18 local utility u=0.039075 metrics={'f1_val': 0.709773168894499, 'auprc': 0.8607650561141018, 'loss_val': 0.4270865708625995, 'psi': 0.7701699237823402}-{'f1_val': 0.7146424967158749, 'auprc': 0.8601921631649895, 'loss_val': 0.532734135564241, 'psi': 0.7728623632955207}
[S3] START round=18 head_norm_before_train=0.940623 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9985667340053291, 'loss_val': 0.5033037929960809, 'psi': 0.8196252450140489}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971205216363128, 'loss_val': 0.4501716386932406, 'psi': 0.8193019308957049}
[S4] START round=18 head_norm_before_train=1.241021 cos_to_last_merge=0.9775 (last merge round=15)
[S4] round=18 local utility u=0.022539 metrics={'f1_val': 0.9534654845844271, 'auprc': 0.969461914291361, 'loss_val': 0.2523788184938545, 'psi': 0.9598640564672006}-{'f1_val': 0.9494259377790534, 'auprc': 0.9682558728086195, 'loss_val': 0.26960103736032975, 'psi': 0.9569579117908797}
[S5] START round=18 head_norm_before_train=1.275021 cos_to_last_merge=0.8475 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=18 local utility u=0.252742 metrics={'f1_val': 0.7006154562276292, 'auprc': 0.8342555711826528, 'loss_val': 0.33489302999389803, 'psi': 0.7540715022096387}-{'f1_val': 0.7003213174339138, 'auprc': 0.6662709107454138, 'loss_val': 0.33465893414063064, 'psi': 0.6867011547585138}
[S6] START round=18 head_norm_before_train=1.468094 cos_to_last_merge=0.8564 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=18 local utility u=0.109543 metrics={'f1_val': 0.8233830649515526, 'auprc': 0.9598682376863698, 'loss_val': 0.4043527156523056, 'psi': 0.8779771340454794}-{'f1_val': 0.8232302109797304, 'auprc': 0.898044380973124, 'loss_val': 0.4370492947678589, 'psi': 0.8531558789770879}
[S7] START round=18 head_norm_before_train=1.593910 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.47381272783318107, 'auprc': 0.7815884692209694, 'loss_val': 0.9413366350038757, 'psi': 0.5969230243882964}-{'f1_val': 0.6607255559238803, 'auprc': 0.8072410826637052, 'loss_val': 0.5241573254126508, 'psi': 0.7193317666198102}
[S8] START round=18 head_norm_before_train=1.906760 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9845421638582629, 'loss_val': 0.4506952634382425, 'psi': 0.8221881661836926}-{'f1_val': 0.9937709050739206, 'auprc': 0.9989522600688243, 'loss_val': 0.047302657334120146, 'psi': 0.9958434470718821}
[S9] START round=18 head_norm_before_train=1.033802 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.005836 metrics={'f1_val': 0.9892304409695105, 'auprc': 0.9984629862562171, 'loss_val': 0.22112580824157463, 'psi': 0.9929234590841932}-{'f1_val': 0.9903801002864661, 'auprc': 0.9984666913609498, 'loss_val': 0.23970734249362882, 'psi': 0.9936147367162596}
[S10] START round=18 head_norm_before_train=1.099453 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948851320139169, 'loss_val': 0.18244336889167598, 'psi': 0.9950667562171915}-{'f1_val': 0.9947723700160056, 'auprc': 0.9948249819282915, 'loss_val': 0.09440093444073076, 'psi': 0.9947934147809199}
[S11] START round=18 head_norm_before_train=1.090183 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=1.000000 metrics={'f1_val': 0.9603878758780172, 'auprc': 0.9968957284527055, 'loss_val': 0.34153164741080927, 'psi': 0.9749910169078925}-{'f1_val': 0.612585177985465, 'auprc': 0.9862903825766962, 'loss_val': 0.6061456853433612, 'psi': 0.7620672598219574}
[S13] START round=18 head_norm_before_train=1.015920 cos_to_last_merge=0.9893 (last merge round=16)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6034963538397196, 'auprc': 0.6844253306069196, 'loss_val': 0.765674429875927, 'psi': 0.6358679445465996}-{'f1_val': 0.6163503009849763, 'auprc': 0.6634129991601863, 'loss_val': 0.7272897320200267, 'psi': 0.6351753802550604}
[S14] START round=18 head_norm_before_train=1.586073 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9928517195355279, 'auprc': 0.9969824620877079, 'loss_val': 0.19062497589278363, 'psi': 0.9945040165563999}-{'f1_val': 0.9975280800653981, 'auprc': 0.9956400634651282, 'loss_val': 0.17617134408501814, 'psi': 0.9967728734252901}
[S15] START round=18 head_norm_before_train=1.587011 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7033204863594102, 'auprc': 0.868104909911315, 'loss_val': 0.45936537693275964, 'psi': 0.7692342557801721}-{'f1_val': 0.7651486366548327, 'auprc': 0.9894861378651971, 'loss_val': 0.35509084759335735, 'psi': 0.8548836371389785}
[S16] START round=18 head_norm_before_train=1.307916 cos_to_last_merge=0.9967 (last merge round=15)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.7841189665765153, 'auprc': 0.821299301918643, 'loss_val': 0.6768906868020841, 'psi': 0.7989911007133663}-{'f1_val': 0.8230909712798744, 'auprc': 0.7894349898158304, 'loss_val': 0.7530611727379455, 'psi': 0.8096285786942568}
[S17] START round=18 head_norm_before_train=0.963987 cos_to_last_merge=1.0000 (last merge round=17)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.39829024843413074, 'auprc': 0.7328714364952473, 'loss_val': 0.7028624298474144, 'psi': 0.5321227236585774}-{'f1_val': 0.4656921134920403, 'auprc': 0.6952100113716129, 'loss_val': 0.9080416386155407, 'psi': 0.5574992726438693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:33213
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.7751
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9646
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.8405
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.6757
[S13] RECEIVED delta(kind=head bytes=1794) from S2
[S13] cosine check vs S2: cos=0.5673
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.9106
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9952 head_norm=1.206638
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.257606e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9950 head_norm=1.187800 delta_norm=0.425761
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.6035 head_norm=1.101325
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.102949e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6043 head_norm=1.006498 delta_norm=0.310295
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.7841 head_norm=1.356691
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.791329e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.7927 head_norm=1.311010 delta_norm=0.179133
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=18 metric=0.9604 head_norm=1.125149
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.092602e-01
[S11] stored merged vector for next round verification (round=18)
[S11] DEBUG after merge:  round=18 metric=0.9967 head_norm=1.256275 delta_norm=0.409260
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3983 head_norm=1.027345
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.258096e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3971 head_norm=1.034388 delta_norm=0.225810
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.594494 cos_to_last_merge=0.8207 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.7009188800547392, 'auprc': 0.8075012010383659, 'loss_val': 0.4982827359024362, 'psi': 0.7435518084481898}-{'f1_val': 0.709773168894499, 'auprc': 0.8607650561141018, 'loss_val': 0.4270865708625995, 'psi': 0.7701699237823402}
[S3] START round=19 head_norm_before_train=0.975021 cos_to_last_merge=0.9986 (last merge round=17)
[S3] round=19 local utility u=0.048368 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9981593032793319, 'loss_val': 0.40744616985442356, 'psi': 0.8196722971109336}-{'f1_val': 0.700330919019862, 'auprc': 0.9985667340053291, 'loss_val': 0.5033037929960809, 'psi': 0.8196252450140489}
[S4] START round=19 head_norm_before_train=1.314650 cos_to_last_merge=0.9678 (last merge round=15)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9491171792095097, 'auprc': 0.9458844043707627, 'loss_val': 0.2616409885253541, 'psi': 0.947824069274011}-{'f1_val': 0.9534654845844271, 'auprc': 0.969461914291361, 'loss_val': 0.2523788184938545, 'psi': 0.9598640564672006}
[S5] START round=19 head_norm_before_train=1.288820 cos_to_last_merge=0.8422 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=19 local utility u=0.149211 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9283442471698868, 'loss_val': 0.31869490757790775, 'psi': 0.7917027344655594}-{'f1_val': 0.7006154562276292, 'auprc': 0.8342555711826528, 'loss_val': 0.33489302999389803, 'psi': 0.7540715022096387}
[S6] START round=19 head_norm_before_train=1.491804 cos_to_last_merge=0.8545 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=19 local utility u=0.000000 metrics={'f1_val': 0.42423306557825136, 'auprc': 0.845053338793626, 'loss_val': 0.7331811401914538, 'psi': 0.5925611748644012}-{'f1_val': 0.8233830649515526, 'auprc': 0.9598682376863698, 'loss_val': 0.4043527156523056, 'psi': 0.8779771340454794}
[S7] START round=19 head_norm_before_train=1.608521 (no previous merge yet)
[S7] round=19 local utility u=0.324696 metrics={'f1_val': 0.5587778679584406, 'auprc': 0.7827179514495544, 'loss_val': 0.8051246660442798, 'psi': 0.6483539013548861}-{'f1_val': 0.47381272783318107, 'auprc': 0.7815884692209694, 'loss_val': 0.9413366350038757, 'psi': 0.5969230243882964}
[S8] START round=19 head_norm_before_train=1.928124 (no previous merge yet)
[S8] round=19 local utility u=1.000000 metrics={'f1_val': 0.994352627176911, 'auprc': 0.9985991852609213, 'loss_val': 0.044759851881892125, 'psi': 0.9960512504105151}-{'f1_val': 0.7139521677339791, 'auprc': 0.9845421638582629, 'loss_val': 0.4506952634382425, 'psi': 0.8221881661836926}
[S9] START round=19 head_norm_before_train=1.089248 cos_to_last_merge=0.9977 (last merge round=17)
[S9] round=19 local utility u=0.033211 metrics={'f1_val': 0.9909317508950798, 'auprc': 0.9984524767061403, 'loss_val': 0.16488073577015902, 'psi': 0.993940041219504}-{'f1_val': 0.9892304409695105, 'auprc': 0.9984629862562171, 'loss_val': 0.22112580824157463, 'psi': 0.9929234590841932}
[S10] START round=19 head_norm_before_train=1.187800 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9925082799078279, 'loss_val': 0.2017980779470823, 'psi': 0.9938667339727345}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948851320139169, 'loss_val': 0.18244336889167598, 'psi': 0.9950667562171915}
[S11] START round=19 head_norm_before_train=1.256275 cos_to_last_merge=1.0000 (last merge round=18)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.8995336553602036, 'auprc': 0.9855205370212895, 'loss_val': 0.5479154668835532, 'psi': 0.933928408024638}-{'f1_val': 0.9603878758780172, 'auprc': 0.9968957284527055, 'loss_val': 0.34153164741080927, 'psi': 0.9749910169078925}
[S13] START round=19 head_norm_before_train=1.006498 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.117678 metrics={'f1_val': 0.6311406286720285, 'auprc': 0.6725391027578861, 'loss_val': 0.6605258585966014, 'psi': 0.6477000183063715}-{'f1_val': 0.6034963538397196, 'auprc': 0.6844253306069196, 'loss_val': 0.765674429875927, 'psi': 0.6358679445465996}
[S14] START round=19 head_norm_before_train=1.611913 cos_to_last_merge=0.9996 (last merge round=17)
[S14] round=19 local utility u=0.033513 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9955837126614683, 'loss_val': 0.14586924958533237, 'psi': 0.9965911011697178}-{'f1_val': 0.9928517195355279, 'auprc': 0.9969824620877079, 'loss_val': 0.19062497589278363, 'psi': 0.9945040165563999}
[S15] START round=19 head_norm_before_train=1.643297 cos_to_last_merge=0.9981 (last merge round=17)
[S15] round=19 local utility u=1.000000 metrics={'f1_val': 0.9562347437343942, 'auprc': 0.9971475026759409, 'loss_val': 0.10957717180331152, 'psi': 0.9725998473110129}-{'f1_val': 0.7033204863594102, 'auprc': 0.868104909911315, 'loss_val': 0.45936537693275964, 'psi': 0.7692342557801721}
[S16] START round=19 head_norm_before_train=1.311010 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.207478 metrics={'f1_val': 0.8369937958082363, 'auprc': 0.8514488585423289, 'loss_val': 0.6696324868502492, 'psi': 0.8427758209018734}-{'f1_val': 0.7841189665765153, 'auprc': 0.821299301918643, 'loss_val': 0.6768906868020841, 'psi': 0.7989911007133663}
[S17] START round=19 head_norm_before_train=1.034388 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.032551 metrics={'f1_val': 0.407191343518189, 'auprc': 0.7299876557664229, 'loss_val': 0.6825154535984231, 'psi': 0.5363098684174825}-{'f1_val': 0.39829024843413074, 'auprc': 0.7328714364952473, 'loss_val': 0.7028624298474144, 'psi': 0.5321227236585774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.994)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33210
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:33214
[S5] not sending this round → trigger blocked (psi=0.792)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9683
[S14] RECEIVED delta(kind=head bytes=1794) from S7
[S14] cosine check vs S7: cos=0.9880
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.1683
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.6074
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.2625
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.9566
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.7333
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.9397
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9909 head_norm=1.146294
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.719279e-01
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9914 head_norm=1.068662 delta_norm=0.171928
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] r=20 psi=0.994 u=0.0332 p_local=0.1582 f1=0.991 auprc=0.998 bytes=16174
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9491 head_norm=1.361837
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.646180e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9495 head_norm=1.136857 delta_norm=0.464618
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.948 u=0.0000 p_local=0.0518 f1=0.949 auprc=0.946 bytes=17980
[S6] r=20 psi=0.593 u=0.0000 p_local=0.2801 f1=0.424 auprc=0.845 bytes=14398
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.8995 head_norm=1.295428
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.802639e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.8619 head_norm=1.154431 delta_norm=0.980264
[S11] aggregate: ROLLBACK (f1_val pre=0.900 post=0.862 tol_abs=0.005 tol_rel=0.0)
[S11] r=20 psi=0.934 u=0.0000 p_local=0.2341 f1=0.900 auprc=0.986 bytes=14377
[S5] r=20 psi=0.792 u=0.1492 p_local=0.1528 f1=0.701 auprc=0.928 bytes=16151
[S2] r=20 psi=0.744 u=0.0000 p_local=0.0726 f1=0.701 auprc=0.808 bytes=14371
[S10] r=20 psi=0.994 u=0.0000 p_local=0.0613 f1=0.995 auprc=0.993 bytes=14400
[S13] r=20 psi=0.648 u=0.1177 p_local=0.0743 f1=0.631 auprc=0.673 bytes=12581
[S16] r=20 psi=0.843 u=0.2075 p_local=0.2394 f1=0.837 auprc=0.851 bytes=17972
[S8] r=20 psi=0.996 u=1.0000 p_local=0.2515 f1=0.994 auprc=0.999 bytes=16196
[S7] r=20 psi=0.648 u=0.3247 p_local=0.2602 f1=0.559 auprc=0.783 bytes=16182
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7007 head_norm=1.014499
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.854584e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7007 head_norm=1.033696 delta_norm=0.185458
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] r=20 psi=0.820 u=0.0484 p_local=0.1390 f1=0.701 auprc=0.998 bytes=17969
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9973 head_norm=1.641746
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.265510e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9970 head_norm=1.627604 delta_norm=0.126551
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0335 p_local=0.1268 f1=0.997 auprc=0.996 bytes=17971
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.9562 head_norm=1.705616
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.131691e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.9543 head_norm=1.660357 delta_norm=0.213169
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.973 u=1.0000 p_local=0.3197 f1=0.956 auprc=0.997 bytes=16183
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.4072 head_norm=1.084729
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.372269e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.4050 head_norm=1.005734 delta_norm=0.537227
[S17] aggregate: ACCEPT kept=['S16', 'S8'] (k=2/2) mode=median trim_p=0.1
[S17] r=20 psi=0.536 u=0.0326 p_local=0.0962 f1=0.407 auprc=0.730 bytes=16175
[S2] START round=20 head_norm_before_train=1.616495 cos_to_last_merge=0.8187 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=20 local utility u=0.010136 metrics={'f1_val': 0.702878410742521, 'auprc': 0.8095701614455453, 'loss_val': 0.49597571630569004, 'psi': 0.7455551110237306}-{'f1_val': 0.7009188800547392, 'auprc': 0.8075012010383659, 'loss_val': 0.4982827359024362, 'psi': 0.7435518084481898}
[S3] START round=20 head_norm_before_train=1.033696 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.017860 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9977258755408105, 'loss_val': 0.3704255671339187, 'psi': 0.819498926015525}-{'f1_val': 0.7006809596653347, 'auprc': 0.9981593032793319, 'loss_val': 0.40744616985442356, 'psi': 0.8196722971109336}
[S4] START round=20 head_norm_before_train=1.136857 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.029325 metrics={'f1_val': 0.9531103982785457, 'auprc': 0.9651048819405039, 'loss_val': 0.2846110806130085, 'psi': 0.957908191743329}-{'f1_val': 0.9491171792095097, 'auprc': 0.9458844043707627, 'loss_val': 0.2616409885253541, 'psi': 0.947824069274011}
[S5] START round=20 head_norm_before_train=1.303334 cos_to_last_merge=0.8368 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.7010112171399492, 'auprc': 0.8273313370527337, 'loss_val': 0.32476822848628334, 'psi': 0.751539265105063}-{'f1_val': 0.7006083926626743, 'auprc': 0.9283442471698868, 'loss_val': 0.31869490757790775, 'psi': 0.7917027344655594}
[S6] START round=20 head_norm_before_train=1.514035 cos_to_last_merge=0.8530 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.853
[S6] round=20 local utility u=1.000000 metrics={'f1_val': 0.867843715314487, 'auprc': 0.9613398642893033, 'loss_val': 0.3775833151219589, 'psi': 0.9052421749044135}-{'f1_val': 0.42423306557825136, 'auprc': 0.845053338793626, 'loss_val': 0.7331811401914538, 'psi': 0.5925611748644012}
[S7] START round=20 head_norm_before_train=1.623234 (no previous merge yet)
[S7] round=20 local utility u=0.040459 metrics={'f1_val': 0.5675083667537314, 'auprc': 0.7828672533686122, 'loss_val': 0.7770384311264117, 'psi': 0.6536519213996836}-{'f1_val': 0.5587778679584406, 'auprc': 0.7827179514495544, 'loss_val': 0.8051246660442798, 'psi': 0.6483539013548861}
[S8] START round=20 head_norm_before_train=1.937135 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9913681421646898, 'auprc': 0.9972436268490505, 'loss_val': 0.048434152626144075, 'psi': 0.9937183360384341}-{'f1_val': 0.994352627176911, 'auprc': 0.9985991852609213, 'loss_val': 0.044759851881892125, 'psi': 0.9960512504105151}
[S9] START round=20 head_norm_before_train=1.068662 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9984474861404774, 'loss_val': 0.1793863878283569, 'psi': 0.9934568589400682}-{'f1_val': 0.9909317508950798, 'auprc': 0.9984524767061403, 'loss_val': 0.16488073577015902, 'psi': 0.993940041219504}
[S10] START round=20 head_norm_before_train=1.292292 cos_to_last_merge=0.9834 (last merge round=18)
[S10] round=20 local utility u=0.061692 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956626516556204, 'loss_val': 0.09037038179796458, 'psi': 0.995377764073873}-{'f1_val': 0.9947723700160056, 'auprc': 0.9925082799078279, 'loss_val': 0.2017980779470823, 'psi': 0.9938667339727345}
[S11] START round=20 head_norm_before_train=1.154431 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.293404 metrics={'f1_val': 0.959976774839181, 'auprc': 0.9972252117637179, 'loss_val': 0.35888086842283373, 'psi': 0.9748761496089957}-{'f1_val': 0.8995336553602036, 'auprc': 0.9855205370212895, 'loss_val': 0.5479154668835532, 'psi': 0.933928408024638}
[S13] START round=20 head_norm_before_train=1.077972 cos_to_last_merge=0.9945 (last merge round=18)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6238466640881593, 'auprc': 0.6763994504731535, 'loss_val': 0.7037616384972731, 'psi': 0.6448677786421569}-{'f1_val': 0.6311406286720285, 'auprc': 0.6725391027578861, 'loss_val': 0.6605258585966014, 'psi': 0.6477000183063715}
[S14] START round=20 head_norm_before_train=1.627604 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.000000 metrics={'f1_val': 0.9958518104876337, 'auprc': 0.9969747688693675, 'loss_val': 0.14980366975890166, 'psi': 0.9963009938403272}-{'f1_val': 0.9972626935085508, 'auprc': 0.9955837126614683, 'loss_val': 0.14586924958533237, 'psi': 0.9965911011697178}
[S15] START round=20 head_norm_before_train=1.660357 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.8253811194686372, 'auprc': 0.9939177436253157, 'loss_val': 0.2788184764999556, 'psi': 0.8927957691313086}-{'f1_val': 0.9562347437343942, 'auprc': 0.9971475026759409, 'loss_val': 0.10957717180331152, 'psi': 0.9725998473110129}
[S16] START round=20 head_norm_before_train=1.357125 cos_to_last_merge=0.9991 (last merge round=18)
[S16] round=20 local utility u=0.109278 metrics={'f1_val': 0.8481320212338088, 'auprc': 0.8774625612672153, 'loss_val': 0.595946958239281, 'psi': 0.8598642372471714}-{'f1_val': 0.8369937958082363, 'auprc': 0.8514488585423289, 'loss_val': 0.6696324868502492, 'psi': 0.8427758209018734}
[S17] START round=20 head_norm_before_train=1.005734 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.262047 metrics={'f1_val': 0.46905603897359704, 'auprc': 0.7846924117602965, 'loss_val': 0.6937230361600731, 'psi': 0.5953105880882769}-{'f1_val': 0.407191343518189, 'auprc': 0.7299876557664229, 'loss_val': 0.6825154535984231, 'psi': 0.5363098684174825}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:33213
[S16] not sending this round → trigger blocked (psi=0.860)
[S7] not sending this round → trigger blocked (psi=0.654)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.7708
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.5094
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.4591
[S13] RECEIVED delta(kind=head bytes=1797) from S11
[S13] cosine check vs S11: cos=0.5222
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.6660
[S17] not sending this round → trigger blocked (psi=0.595)
[S15] ⇄ pheromone p=0.256 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.216 → S14@127.0.0.1:33214
[S14] ⇄ pheromone p=0.101 → S15@127.0.0.1:33215
[S9] ⇄ pheromone p=0.127 → S17@127.0.0.1:33217
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6238 head_norm=1.156710
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.019134e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6251 head_norm=1.040952 delta_norm=0.301913
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.059 → S4@127.0.0.1:33204
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.7007 head_norm=1.074963
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.707340e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.7007 head_norm=1.076238 delta_norm=0.670734
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.115 → S9@127.0.0.1:33210
[S5] ⇄ pheromone p=0.122 → S16@127.0.0.1:33216
[S8] ⇄ pheromone p=0.201 → S17@127.0.0.1:33217
[S6] ⇄ pheromone p=0.424 → S11@127.0.0.1:33212
[S4] ⇄ pheromone p=0.047 → S10@127.0.0.1:33211
[S2] ⇄ pheromone p=0.060 → S13@127.0.0.1:33213
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9952 head_norm=1.435548
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.589584e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9950 head_norm=1.233813 delta_norm=0.458958
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.061 → S3@127.0.0.1:33203
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9600 head_norm=1.183874
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.876950e-01
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9954 head_norm=1.180592 delta_norm=0.687695
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.246 → S13@127.0.0.1:33213
[S16] ⇄ pheromone p=0.213 → S17@127.0.0.1:33217
[S17] ⇄ pheromone p=0.129 → S3@127.0.0.1:33203
[S2] START round=21 head_norm_before_train=1.648361 cos_to_last_merge=0.8155 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.815
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7078882522249298, 'auprc': 0.8064577100802827, 'loss_val': 0.5291352817204291, 'psi': 0.7473160353670709}-{'f1_val': 0.702878410742521, 'auprc': 0.8095701614455453, 'loss_val': 0.49597571630569004, 'psi': 0.7455551110237306}
[S3] START round=21 head_norm_before_train=1.076238 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9975922231256867, 'loss_val': 0.39284591229392374, 'psi': 0.8194906114914544}-{'f1_val': 0.7006809596653347, 'auprc': 0.9977258755408105, 'loss_val': 0.3704255671339187, 'psi': 0.819498926015525}
[S4] START round=21 head_norm_before_train=1.185359 cos_to_last_merge=0.9990 (last merge round=19)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9484453873807268, 'auprc': 0.9552865186877142, 'loss_val': 0.267654034765547, 'psi': 0.9511818399035217}-{'f1_val': 0.9531103982785457, 'auprc': 0.9651048819405039, 'loss_val': 0.2846110806130085, 'psi': 0.957908191743329}
[S5] START round=21 head_norm_before_train=1.325967 cos_to_last_merge=0.8319 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=21 local utility u=0.262241 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9924818649251619, 'loss_val': 0.2933217455410153, 'psi': 0.8173577815676694}-{'f1_val': 0.7010112171399492, 'auprc': 0.8273313370527337, 'loss_val': 0.32476822848628334, 'psi': 0.751539265105063}
[S6] START round=21 head_norm_before_train=1.527051 cos_to_last_merge=0.8520 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.852
[S6] round=21 local utility u=0.125603 metrics={'f1_val': 0.8924023520141707, 'auprc': 0.9691294332185251, 'loss_val': 0.29709847813133977, 'psi': 0.9230931844959125}-{'f1_val': 0.867843715314487, 'auprc': 0.9613398642893033, 'loss_val': 0.3775833151219589, 'psi': 0.9052421749044135}
[S7] START round=21 head_norm_before_train=1.631735 (no previous merge yet)
[S7] round=21 local utility u=0.216274 metrics={'f1_val': 0.6122536170760657, 'auprc': 0.7907741581979624, 'loss_val': 0.63668267377854, 'psi': 0.6836618335248243}-{'f1_val': 0.5675083667537314, 'auprc': 0.7828672533686122, 'loss_val': 0.7770384311264117, 'psi': 0.6536519213996836}
[S8] START round=21 head_norm_before_train=1.947716 (no previous merge yet)
[S8] round=21 local utility u=0.014286 metrics={'f1_val': 0.9939849501843234, 'auprc': 0.9987949682148887, 'loss_val': 0.04021792128654039, 'psi': 0.9959089573965496}-{'f1_val': 0.9913681421646898, 'auprc': 0.9972436268490505, 'loss_val': 0.048434152626144075, 'psi': 0.9937183360384341}
[S9] START round=21 head_norm_before_train=1.117859 cos_to_last_merge=0.9986 (last merge round=19)
[S9] round=21 local utility u=0.021893 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9983953016925649, 'loss_val': 0.14050495339593702, 'psi': 0.9939421844576031}-{'f1_val': 0.9901297741397954, 'auprc': 0.9984474861404774, 'loss_val': 0.1793863878283569, 'psi': 0.9934568589400682}
[S10] START round=21 head_norm_before_train=1.233813 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929641142813151, 'loss_val': 0.13073135241250314, 'psi': 0.9942983491241508}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956626516556204, 'loss_val': 0.09037038179796458, 'psi': 0.995377764073873}
[S11] START round=21 head_norm_before_train=1.180592 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.029910 metrics={'f1_val': 0.9665950359737364, 'auprc': 0.995806172041076, 'loss_val': 0.33451249956783285, 'psi': 0.9782794904006722}-{'f1_val': 0.959976774839181, 'auprc': 0.9972252117637179, 'loss_val': 0.35888086842283373, 'psi': 0.9748761496089957}
[S13] START round=21 head_norm_before_train=1.040952 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6039653400704504, 'auprc': 0.6586487224433786, 'loss_val': 0.7676483224608307, 'psi': 0.6258386930196217}-{'f1_val': 0.6238466640881593, 'auprc': 0.6763994504731535, 'loss_val': 0.7037616384972731, 'psi': 0.6448677786421569}
[S14] START round=21 head_norm_before_train=1.663449 cos_to_last_merge=0.9992 (last merge round=19)
[S14] round=21 local utility u=0.021300 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9955840330067797, 'loss_val': 0.11264306582443212, 'psi': 0.9967058810059064}-{'f1_val': 0.9958518104876337, 'auprc': 0.9969747688693675, 'loss_val': 0.14980366975890166, 'psi': 0.9963009938403272}
[S15] START round=21 head_norm_before_train=1.719929 cos_to_last_merge=0.9980 (last merge round=19)
[S15] round=21 local utility u=0.624617 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9959830799986056, 'loss_val': 0.06148753716873092, 'psi': 0.9961926785087267}-{'f1_val': 0.8253811194686372, 'auprc': 0.9939177436253157, 'loss_val': 0.2788184764999556, 'psi': 0.8927957691313086}
[S16] START round=21 head_norm_before_train=1.400962 cos_to_last_merge=0.9969 (last merge round=18)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8415429734746067, 'auprc': 0.9089678543925646, 'loss_val': 0.6941859225112889, 'psi': 0.8685129258417899}-{'f1_val': 0.8481320212338088, 'auprc': 0.8774625612672153, 'loss_val': 0.595946958239281, 'psi': 0.8598642372471714}
[S17] START round=21 head_norm_before_train=1.059316 cos_to_last_merge=0.9971 (last merge round=19)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.46366417848568864, 'auprc': 0.7419390205764874, 'loss_val': 0.7499268225814306, 'psi': 0.5749741153220082}-{'f1_val': 0.46905603897359704, 'auprc': 0.7846924117602965, 'loss_val': 0.6937230361600731, 'psi': 0.5953105880882769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.978)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:33216
[S6] not sending this round → trigger blocked (psi=0.923)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=0.7850
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.6035
[S15] RECEIVED delta(kind=head bytes=1804) from S14
[S15] cosine check vs S14: cos=0.9704
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9896
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9707
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.3717
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9666 head_norm=1.214115
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.698223e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9238 head_norm=1.248317 delta_norm=0.869822
[S11] aggregate: ROLLBACK (f1_val pre=0.967 post=0.924 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=21 metric=0.9963 head_norm=1.776428
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.149495e-01
[S15] stored merged vector for next round verification (round=21)
[S15] DEBUG after merge:  round=21 metric=0.9963 head_norm=1.723273 delta_norm=0.214949
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9975 head_norm=1.695892
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.237265e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9975 head_norm=1.662664 delta_norm=0.123727
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.8415 head_norm=1.442754
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.751317e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.8413 head_norm=1.385567 delta_norm=0.175132
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.4637 head_norm=1.117471
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.358670e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.4510 head_norm=1.133355 delta_norm=0.335867
[S17] aggregate: ROLLBACK (f1_val pre=0.464 post=0.451 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.683193 cos_to_last_merge=0.8118 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=22 local utility u=0.161553 metrics={'f1_val': 0.7105916374701955, 'auprc': 0.9228297454860473, 'loss_val': 0.5713665949786473, 'psi': 0.7954868806765363}-{'f1_val': 0.7078882522249298, 'auprc': 0.8064577100802827, 'loss_val': 0.5291352817204291, 'psi': 0.7473160353670709}
[S3] START round=22 head_norm_before_train=1.115106 cos_to_last_merge=0.9983 (last merge round=20)
[S3] round=22 local utility u=0.028293 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983245145593805, 'loss_val': 0.33755616242630987, 'psi': 0.8196934073238755}-{'f1_val': 0.7007562037352997, 'auprc': 0.9975922231256867, 'loss_val': 0.39284591229392374, 'psi': 0.8194906114914544}
[S4] START round=22 head_norm_before_train=1.269623 cos_to_last_merge=0.9944 (last merge round=19)
[S4] round=22 local utility u=0.010516 metrics={'f1_val': 0.9514717028313375, 'auprc': 0.9527496023640654, 'loss_val': 0.25716974170309875, 'psi': 0.9519828626444287}-{'f1_val': 0.9484453873807268, 'auprc': 0.9552865186877142, 'loss_val': 0.267654034765547, 'psi': 0.9511818399035217}
[S5] START round=22 head_norm_before_train=1.348849 cos_to_last_merge=0.8272 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7015103804256321, 'auprc': 0.7950697643080678, 'loss_val': 0.3292760060519195, 'psi': 0.7389341339786064}-{'f1_val': 0.7006083926626743, 'auprc': 0.9924818649251619, 'loss_val': 0.2933217455410153, 'psi': 0.8173577815676694}
[S6] START round=22 head_norm_before_train=1.541665 cos_to_last_merge=0.8506 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7752941529938734, 'auprc': 0.9217846240754384, 'loss_val': 0.49151563883932453, 'psi': 0.8338903414264994}-{'f1_val': 0.8924023520141707, 'auprc': 0.9691294332185251, 'loss_val': 0.29709847813133977, 'psi': 0.9230931844959125}
[S7] START round=22 head_norm_before_train=1.638129 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5782489990839957, 'auprc': 0.7837378569570499, 'loss_val': 0.7463287725376895, 'psi': 0.6604445422332175}-{'f1_val': 0.6122536170760657, 'auprc': 0.7907741581979624, 'loss_val': 0.63668267377854, 'psi': 0.6836618335248243}
[S8] START round=22 head_norm_before_train=1.955898 (no previous merge yet)
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.9928592358880375, 'auprc': 0.9985070677292701, 'loss_val': 0.053486072889311, 'psi': 0.9951183686245305}-{'f1_val': 0.9939849501843234, 'auprc': 0.9987949682148887, 'loss_val': 0.04021792128654039, 'psi': 0.9959089573965496}
[S9] START round=22 head_norm_before_train=1.167831 cos_to_last_merge=0.9952 (last merge round=19)
[S9] round=22 local utility u=0.022436 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.995523905365759, 'loss_val': 0.11217198727861258, 'psi': 0.9953088659802727}-{'f1_val': 0.9909734396342953, 'auprc': 0.9983953016925649, 'loss_val': 0.14050495339593702, 'psi': 0.9939421844576031}
[S10] START round=22 head_norm_before_train=1.347568 cos_to_last_merge=0.9899 (last merge round=20)
[S10] round=22 local utility u=0.030568 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949005521914003, 'loss_val': 0.07540542617791637, 'psi': 0.995072924288185}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929641142813151, 'loss_val': 0.13073135241250314, 'psi': 0.9942983491241508}
[S11] START round=22 head_norm_before_train=1.248317 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.074942 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997418293398235, 'loss_val': 0.3691775267376148, 'psi': 0.9968955200674477}-{'f1_val': 0.9665950359737364, 'auprc': 0.995806172041076, 'loss_val': 0.33451249956783285, 'psi': 0.9782794904006722}
[S13] START round=22 head_norm_before_train=1.091930 cos_to_last_merge=0.9971 (last merge round=20)
[S13] round=22 local utility u=0.080460 metrics={'f1_val': 0.6210477917795519, 'auprc': 0.6612359860393102, 'loss_val': 0.7169850103411137, 'psi': 0.6371230694834553}-{'f1_val': 0.6039653400704504, 'auprc': 0.6586487224433786, 'loss_val': 0.7676483224608307, 'psi': 0.6258386930196217}
[S14] START round=22 head_norm_before_train=1.662664 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9968527342645841, 'auprc': 0.9969715728496464, 'loss_val': 0.12035947239270965, 'psi': 0.996900269698609}-{'f1_val': 0.9974537796719909, 'auprc': 0.9955840330067797, 'loss_val': 0.11264306582443212, 'psi': 0.9967058810059064}
[S15] START round=22 head_norm_before_train=1.723273 cos_to_last_merge=1.0000 (last merge round=21)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.9154389259277564, 'auprc': 0.9969736173244826, 'loss_val': 0.15750521297175898, 'psi': 0.948052802486447}-{'f1_val': 0.9963324108488076, 'auprc': 0.9959830799986056, 'loss_val': 0.06148753716873092, 'psi': 0.9961926785087267}
[S16] START round=22 head_norm_before_train=1.385567 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.102043 metrics={'f1_val': 0.8530392072801054, 'auprc': 0.9170249134088897, 'loss_val': 0.583248781843604, 'psi': 0.8786334897316191}-{'f1_val': 0.8415429734746067, 'auprc': 0.9089678543925646, 'loss_val': 0.6941859225112889, 'psi': 0.8685129258417899}
[S17] START round=22 head_norm_before_train=1.133355 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.46873410547173217, 'auprc': 0.5982214101260985, 'loss_val': 0.9184808316702842, 'psi': 0.5205290273334787}-{'f1_val': 0.46366417848568864, 'auprc': 0.7419390205764874, 'loss_val': 0.7499268225814306, 'psi': 0.5749741153220082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:33204
[S9] not sending this round → trigger blocked (psi=0.995)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] → sending delta(kind=head bytes=1808) to S13@127.0.0.1:33213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:33210
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:33217
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1808 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1808) from S11
[S13] cosine check vs S11: cos=0.5051
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=0.7149
[S17] RECEIVED delta(kind=head bytes=1798) from S16
[S17] cosine check vs S16: cos=0.4538
[S4] RECEIVED delta(kind=head bytes=1792) from S13
[S4] cosine check vs S13: cos=0.8186
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.8311
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=0.8265
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.8429
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9952 head_norm=1.211791
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.497426e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9956 head_norm=1.131453 delta_norm=0.349743
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.7006 head_norm=1.156103
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.966932e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.7006 head_norm=1.259771 delta_norm=0.396693
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6210 head_norm=1.157691
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.609695e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6225 head_norm=1.071705 delta_norm=0.260969
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9952 head_norm=1.467039
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.137877e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9950 head_norm=1.351388 delta_norm=0.413788
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=22 metric=0.9515 head_norm=1.357473
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.905231e-01
[S4] stored merged vector for next round verification (round=22)
[S4] DEBUG after merge:  round=22 metric=0.9514 head_norm=1.199576 delta_norm=0.390523
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.4687 head_norm=1.181606
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.885971e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.5151 head_norm=1.112552 delta_norm=0.688597
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.711727 cos_to_last_merge=0.8086 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7083865570881562, 'auprc': 0.9259293476673878, 'loss_val': 0.5957731686894956, 'psi': 0.7954036733198488}-{'f1_val': 0.7105916374701955, 'auprc': 0.9228297454860473, 'loss_val': 0.5713665949786473, 'psi': 0.7954868806765363}
[S3] START round=23 head_norm_before_train=1.259771 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9986467875318562, 'loss_val': 0.3643030511149139, 'psi': 0.8199577560280289}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983245145593805, 'loss_val': 0.33755616242630987, 'psi': 0.8196934073238755}
[S4] START round=23 head_norm_before_train=1.199576 cos_to_last_merge=1.0000 (last merge round=22)
[S4] round=23 local utility u=0.012893 metrics={'f1_val': 0.9538920649417142, 'auprc': 0.9612298702403003, 'loss_val': 0.27134602617621917, 'psi': 0.9568271870611487}-{'f1_val': 0.9514717028313375, 'auprc': 0.9527496023640654, 'loss_val': 0.25716974170309875, 'psi': 0.9519828626444287}
[S5] START round=23 head_norm_before_train=1.369606 cos_to_last_merge=0.8213 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7035922806116597, 'auprc': 0.7962695561442419, 'loss_val': 0.35716278444409927, 'psi': 0.7406631908246926}-{'f1_val': 0.7015103804256321, 'auprc': 0.7950697643080678, 'loss_val': 0.3292760060519195, 'psi': 0.7389341339786064}
[S6] START round=23 head_norm_before_train=1.556309 cos_to_last_merge=0.8487 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=23 local utility u=0.222221 metrics={'f1_val': 0.8221218186282564, 'auprc': 0.9609909565328587, 'loss_val': 0.44565849556271575, 'psi': 0.8776694737900974}-{'f1_val': 0.7752941529938734, 'auprc': 0.9217846240754384, 'loss_val': 0.49151563883932453, 'psi': 0.8338903414264994}
[S7] START round=23 head_norm_before_train=1.644560 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.4887185895368381, 'auprc': 0.7813679611521227, 'loss_val': 0.9034060194847765, 'psi': 0.605778338182952}-{'f1_val': 0.5782489990839957, 'auprc': 0.7837378569570499, 'loss_val': 0.7463287725376895, 'psi': 0.6604445422332175}
[S8] START round=23 head_norm_before_train=1.965792 (no previous merge yet)
[S8] round=23 local utility u=0.011756 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9988484564524711, 'loss_val': 0.03426787074264219, 'psi': 0.9955819475874548}-{'f1_val': 0.9928592358880375, 'auprc': 0.9985070677292701, 'loss_val': 0.053486072889311, 'psi': 0.9951183686245305}
[S9] START round=23 head_norm_before_train=1.131453 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9972049276314826, 'loss_val': 0.14624596734610865, 'psi': 0.9942229625521225}-{'f1_val': 0.9951655063899485, 'auprc': 0.995523905365759, 'loss_val': 0.11217198727861258, 'psi': 0.9953088659802727}
[S10] START round=23 head_norm_before_train=1.351388 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9919689524818935, 'loss_val': 0.10586056480660261, 'psi': 0.9934014200198102}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949005521914003, 'loss_val': 0.07540542617791637, 'psi': 0.995072924288185}
[S11] START round=23 head_norm_before_train=1.272533 cos_to_last_merge=0.9990 (last merge round=21)
[S11] round=23 local utility u=0.025499 metrics={'f1_val': 0.9904985957321562, 'auprc': 0.9976142232119918, 'loss_val': 0.28247606810449066, 'psi': 0.9933448467240904}-{'f1_val': 0.9965470045135896, 'auprc': 0.997418293398235, 'loss_val': 0.3691775267376148, 'psi': 0.9968955200674477}
[S13] START round=23 head_norm_before_train=1.071705 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6098470355966751, 'auprc': 0.6201332908934151, 'loss_val': 0.7531233862859714, 'psi': 0.6139615377153711}-{'f1_val': 0.6210477917795519, 'auprc': 0.6612359860393102, 'loss_val': 0.7169850103411137, 'psi': 0.6371230694834553}
[S14] START round=23 head_norm_before_train=1.691629 cos_to_last_merge=0.9996 (last merge round=21)
[S14] round=23 local utility u=0.000000 metrics={'f1_val': 0.9792186525477491, 'auprc': 0.9969741605454743, 'loss_val': 0.13177460669370386, 'psi': 0.9863208557468391}-{'f1_val': 0.9968527342645841, 'auprc': 0.9969715728496464, 'loss_val': 0.12035947239270965, 'psi': 0.996900269698609}
[S15] START round=23 head_norm_before_train=1.773164 cos_to_last_merge=0.9989 (last merge round=21)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.8719434936270161, 'auprc': 0.9905990685301829, 'loss_val': 0.24810276968503273, 'psi': 0.9194057235882828}-{'f1_val': 0.9154389259277564, 'auprc': 0.9969736173244826, 'loss_val': 0.15750521297175898, 'psi': 0.948052802486447}
[S16] START round=23 head_norm_before_train=1.423968 cos_to_last_merge=0.9995 (last merge round=21)
[S16] round=23 local utility u=0.003015 metrics={'f1_val': 0.8343432880638141, 'auprc': 0.9161397466542469, 'loss_val': 0.46238752343510564, 'psi': 0.8670618714999873}-{'f1_val': 0.8530392072801054, 'auprc': 0.9170249134088897, 'loss_val': 0.583248781843604, 'psi': 0.8786334897316191}
[S17] START round=23 head_norm_before_train=1.112552 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=1.000000 metrics={'f1_val': 0.6409047432219157, 'auprc': 0.9178752293829802, 'loss_val': 0.7344989046819584, 'psi': 0.7516929376863415}-{'f1_val': 0.46873410547173217, 'auprc': 0.5982214101260985, 'loss_val': 0.9184808316702842, 'psi': 0.5205290273334787}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:33213
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:33211
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.4242
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.8696
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.8893
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.4253
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=0.5459
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.3034
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6098 head_norm=1.129118
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.857434e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6125 head_norm=1.071928 delta_norm=0.585743
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9944 head_norm=1.452189
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.321059e-01
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9944 head_norm=1.327312 delta_norm=0.332106
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=23 metric=0.7008 head_norm=1.292415
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.235016e-01
[S3] stored merged vector for next round verification (round=23)
[S3] DEBUG after merge:  round=23 metric=0.7008 head_norm=0.987441 delta_norm=0.723502
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9905 head_norm=1.307419
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.774899e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9898 head_norm=1.214394 delta_norm=0.777490
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6409 head_norm=1.151804
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.297698e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6376 head_norm=1.150881 delta_norm=0.329770
[S17] aggregate: ACCEPT kept=['S8', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.729525 cos_to_last_merge=0.8066 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7085700149376501, 'auprc': 0.9271976266847488, 'loss_val': 0.6137514794236304, 'psi': 0.7960210596364896}-{'f1_val': 0.7083865570881562, 'auprc': 0.9259293476673878, 'loss_val': 0.5957731686894956, 'psi': 0.7954036733198488}
[S3] START round=24 head_norm_before_train=0.987441 cos_to_last_merge=1.0000 (last merge round=23)
[S3] round=24 local utility u=0.000422 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9988855603203003, 'loss_val': 0.3632708641167654, 'psi': 0.8199627999273209}-{'f1_val': 0.7008317350254774, 'auprc': 0.9986467875318562, 'loss_val': 0.3643030511149139, 'psi': 0.8199577560280289}
[S4] START round=24 head_norm_before_train=1.278769 cos_to_last_merge=0.9974 (last merge round=22)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9458242066754035, 'auprc': 0.941894044867443, 'loss_val': 0.27268939596451436, 'psi': 0.9442521419522192}-{'f1_val': 0.9538920649417142, 'auprc': 0.9612298702403003, 'loss_val': 0.27134602617621917, 'psi': 0.9568271870611487}
[S5] START round=24 head_norm_before_train=1.389260 cos_to_last_merge=0.8146 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=24 local utility u=0.323716 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9921454258040799, 'loss_val': 0.27945509531103674, 'psi': 0.8172232059192366}-{'f1_val': 0.7035922806116597, 'auprc': 0.7962695561442419, 'loss_val': 0.35716278444409927, 'psi': 0.7406631908246926}
[S6] START round=24 head_norm_before_train=1.564973 cos_to_last_merge=0.8475 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.848
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.6272410991301597, 'auprc': 0.857374554280944, 'loss_val': 0.8121708315147241, 'psi': 0.7192944811904735}-{'f1_val': 0.8221218186282564, 'auprc': 0.9609909565328587, 'loss_val': 0.44565849556271575, 'psi': 0.8776694737900974}
[S7] START round=24 head_norm_before_train=1.649824 (no previous merge yet)
[S7] round=24 local utility u=0.897715 metrics={'f1_val': 0.6734809577363217, 'auprc': 0.8368448474684158, 'loss_val': 0.3829816589512318, 'psi': 0.7388265136291594}-{'f1_val': 0.4887185895368381, 'auprc': 0.7813679611521227, 'loss_val': 0.9034060194847765, 'psi': 0.605778338182952}
[S8] START round=24 head_norm_before_train=1.979586 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9920954910302123, 'auprc': 0.9988539781204495, 'loss_val': 0.03606946165572747, 'psi': 0.9947988858663073}-{'f1_val': 0.9934042750107773, 'auprc': 0.9988484564524711, 'loss_val': 0.03426787074264219, 'psi': 0.9955819475874548}
[S9] START round=24 head_norm_before_train=1.170216 cos_to_last_merge=0.9992 (last merge round=22)
[S9] round=24 local utility u=0.023978 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9970728892802474, 'loss_val': 0.11547657827704613, 'psi': 0.995928459546068}-{'f1_val': 0.9922349858325491, 'auprc': 0.9972049276314826, 'loss_val': 0.14624596734610865, 'psi': 0.9942229625521225}
[S10] START round=24 head_norm_before_train=1.327312 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9937474742150991, 'loss_val': 0.1294845520257872, 'psi': 0.9942164537650763}-{'f1_val': 0.9943563983784213, 'auprc': 0.9919689524818935, 'loss_val': 0.10586056480660261, 'psi': 0.9934014200198102}
[S11] START round=24 head_norm_before_train=1.214394 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.066147 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976680126481828, 'loss_val': 0.18663448509403818, 'psi': 0.9969954077674269}-{'f1_val': 0.9904985957321562, 'auprc': 0.9976142232119918, 'loss_val': 0.28247606810449066, 'psi': 0.9933448467240904}
[S13] START round=24 head_norm_before_train=1.071928 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6037130956878688, 'auprc': 0.6231757766809696, 'loss_val': 0.7572308856730978, 'psi': 0.6114981680851092}-{'f1_val': 0.6098470355966751, 'auprc': 0.6201332908934151, 'loss_val': 0.7531233862859714, 'psi': 0.6139615377153711}
[S14] START round=24 head_norm_before_train=1.722398 cos_to_last_merge=0.9986 (last merge round=21)
[S14] round=24 local utility u=0.083775 metrics={'f1_val': 0.9976708529889131, 'auprc': 0.997065124775407, 'loss_val': 0.07521014274182931, 'psi': 0.9974285617035107}-{'f1_val': 0.9792186525477491, 'auprc': 0.9969741605454743, 'loss_val': 0.13177460669370386, 'psi': 0.9863208557468391}
[S15] START round=24 head_norm_before_train=1.821213 cos_to_last_merge=0.9963 (last merge round=21)
[S15] round=24 local utility u=0.476096 metrics={'f1_val': 0.9950363297052942, 'auprc': 0.9967325799632539, 'loss_val': 0.05286780644598893, 'psi': 0.9957148298084781}-{'f1_val': 0.8719434936270161, 'auprc': 0.9905990685301829, 'loss_val': 0.24810276968503273, 'psi': 0.9194057235882828}
[S16] START round=24 head_norm_before_train=1.461999 cos_to_last_merge=0.9980 (last merge round=21)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8402240065908304, 'auprc': 0.9397926836603377, 'loss_val': 0.7428456655896033, 'psi': 0.8800514774186334}-{'f1_val': 0.8343432880638141, 'auprc': 0.9161397466542469, 'loss_val': 0.46238752343510564, 'psi': 0.8670618714999873}
[S17] START round=24 head_norm_before_train=1.150881 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6563062030494863, 'auprc': 0.7169495014215902, 'loss_val': 0.8185310022834786, 'psi': 0.6805635223983278}-{'f1_val': 0.6409047432219157, 'auprc': 0.9178752293829802, 'loss_val': 0.7344989046819584, 'psi': 0.7516929376863415}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:33210
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:33217
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9752
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=0.4268
[S17] RECEIVED delta(kind=head bytes=1795) from S9
[S17] cosine check vs S9: cos=0.5307
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.9109
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9900
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=0.9718
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9965 head_norm=1.258754
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.733900e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9965 head_norm=1.327815 delta_norm=0.873390
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=24 metric=0.9950 head_norm=1.862081
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.215870e-01
[S15] stored merged vector for next round verification (round=24)
[S15] DEBUG after merge:  round=24 metric=0.9950 head_norm=1.791880 delta_norm=0.221587
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9977 head_norm=1.747147
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.288618e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9973 head_norm=1.697007 delta_norm=0.128862
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9952 head_norm=1.212832
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.527340e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9952 head_norm=1.098042 delta_norm=0.252734
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.8402 head_norm=1.498150
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.680837e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.8398 head_norm=1.443393 delta_norm=0.168084
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6563 head_norm=1.190108
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.820716e-01
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6486 head_norm=1.051119 delta_norm=0.582072
[S17] aggregate: ROLLBACK (f1_val pre=0.656 post=0.649 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.744487 cos_to_last_merge=0.8049 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6983713491554666, 'auprc': 0.794863687939502, 'loss_val': 0.6794958906097723, 'psi': 0.7369682846690808}-{'f1_val': 0.7085700149376501, 'auprc': 0.9271976266847488, 'loss_val': 0.6137514794236304, 'psi': 0.7960210596364896}
[S3] START round=25 head_norm_before_train=1.033529 cos_to_last_merge=0.9976 (last merge round=23)
[S3] round=25 local utility u=0.020501 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9985146250553132, 'loss_val': 0.3207059232223816, 'psi': 0.8197694515222487}-{'f1_val': 0.7006809596653347, 'auprc': 0.9988855603203003, 'loss_val': 0.3632708641167654, 'psi': 0.8199627999273209}
[S4] START round=25 head_norm_before_train=1.347393 cos_to_last_merge=0.9925 (last merge round=22)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9434629069348892, 'auprc': 0.9347289496059658, 'loss_val': 0.27395070162137414, 'psi': 0.9399693240033198}-{'f1_val': 0.9458242066754035, 'auprc': 0.941894044867443, 'loss_val': 0.27268939596451436, 'psi': 0.9442521419522192}
[S5] START round=25 head_norm_before_train=1.406703 cos_to_last_merge=0.8112 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7081250416304588, 'auprc': 0.795400038384212, 'loss_val': 0.43051062763022363, 'psi': 0.7430350403319601}-{'f1_val': 0.7006083926626743, 'auprc': 0.9921454258040799, 'loss_val': 0.27945509531103674, 'psi': 0.8172232059192366}
[S6] START round=25 head_norm_before_train=1.578259 cos_to_last_merge=0.8460 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=25 local utility u=0.974830 metrics={'f1_val': 0.8480474169484239, 'auprc': 0.9618364081722316, 'loss_val': 0.5007350786849343, 'psi': 0.893563013437947}-{'f1_val': 0.6272410991301597, 'auprc': 0.857374554280944, 'loss_val': 0.8121708315147241, 'psi': 0.7192944811904735}
[S7] START round=25 head_norm_before_train=1.655402 (no previous merge yet)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.43210230253931853, 'auprc': 0.7800124757126927, 'loss_val': 1.001189320275387, 'psi': 0.5712663718086682}-{'f1_val': 0.6734809577363217, 'auprc': 0.8368448474684158, 'loss_val': 0.3829816589512318, 'psi': 0.7388265136291594}
[S8] START round=25 head_norm_before_train=1.995891 (no previous merge yet)
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9345633840741012, 'auprc': 0.9921397027188388, 'loss_val': 0.10257383347243487, 'psi': 0.9575939115319962}-{'f1_val': 0.9920954910302123, 'auprc': 0.9988539781204495, 'loss_val': 0.03606946165572747, 'psi': 0.9947988858663073}
[S9] START round=25 head_norm_before_train=1.098042 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9939163253356635, 'auprc': 0.9977034940133025, 'loss_val': 0.14602298750128348, 'psi': 0.9954311928067191}-{'f1_val': 0.9951655063899485, 'auprc': 0.9970728892802474, 'loss_val': 0.11547657827704613, 'psi': 0.995928459546068}
[S10] START round=25 head_norm_before_train=1.419760 cos_to_last_merge=0.9937 (last merge round=23)
[S10] round=25 local utility u=0.029462 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995618852517278, 'loss_val': 0.08012699730076671, 'psi': 0.9953602444185361}-{'f1_val': 0.9945291067983943, 'auprc': 0.9937474742150991, 'loss_val': 0.1294845520257872, 'psi': 0.9942164537650763}
[S11] START round=25 head_norm_before_train=1.327815 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9969157281103778, 'loss_val': 0.23147843815709365, 'psi': 0.9965493917254677}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976680126481828, 'loss_val': 0.18663448509403818, 'psi': 0.9969954077674269}
[S13] START round=25 head_norm_before_train=1.134317 cos_to_last_merge=0.9941 (last merge round=23)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6043533380398853, 'auprc': 0.6069414231143753, 'loss_val': 0.7530750704747581, 'psi': 0.6053885720696813}-{'f1_val': 0.6037130956878688, 'auprc': 0.6231757766809696, 'loss_val': 0.7572308856730978, 'psi': 0.6114981680851092}
[S14] START round=25 head_norm_before_train=1.697007 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9979161758042404, 'auprc': 0.9969731508257975, 'loss_val': 0.08513090993600235, 'psi': 0.9975389658128633}-{'f1_val': 0.9976708529889131, 'auprc': 0.997065124775407, 'loss_val': 0.07521014274182931, 'psi': 0.9974285617035107}
[S15] START round=25 head_norm_before_train=1.791880 cos_to_last_merge=1.0000 (last merge round=24)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7901918615377905, 'auprc': 0.967578532357211, 'loss_val': 0.3432390888317222, 'psi': 0.8611465298655587}-{'f1_val': 0.9950363297052942, 'auprc': 0.9967325799632539, 'loss_val': 0.05286780644598893, 'psi': 0.9957148298084781}
[S16] START round=25 head_norm_before_train=1.443393 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.140389 metrics={'f1_val': 0.8570287875493499, 'auprc': 0.9409068681826345, 'loss_val': 0.5662391230031613, 'psi': 0.8905800198026637}-{'f1_val': 0.8402240065908304, 'auprc': 0.9397926836603377, 'loss_val': 0.7428456655896033, 'psi': 0.8800514774186334}
[S17] START round=25 head_norm_before_train=1.051119 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.5429300390555551, 'auprc': 0.5677866275804533, 'loss_val': 0.9660756240227255, 'psi': 0.5528726744655144}-{'f1_val': 0.6563062030494863, 'auprc': 0.7169495014215902, 'loss_val': 0.8185310022834786, 'psi': 0.6805635223983278}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:33210
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.6356
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.3941
[S9] RECEIVED delta(kind=head bytes=1791) from S3
[S9] cosine check vs S3: cos=0.9717
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.6380
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.069 → S17@127.0.0.1:33217
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9963 head_norm=1.366475
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.204980e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9963 head_norm=1.237808 delta_norm=0.820498
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.105 → S13@127.0.0.1:33213
[S5] ⇄ pheromone p=0.113 → S16@127.0.0.1:33216
[S13] ⇄ pheromone p=0.028 → S4@127.0.0.1:33204
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9939 head_norm=1.139731
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.353172e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9939 head_norm=1.102260 delta_norm=0.135317
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.049 → S17@127.0.0.1:33217
[S7] ⇄ pheromone p=0.232 → S14@127.0.0.1:33214
[S4] ⇄ pheromone p=0.018 → S10@127.0.0.1:33211
[S2] ⇄ pheromone p=0.036 → S13@127.0.0.1:33213
[S14] ⇄ pheromone p=0.048 → S15@127.0.0.1:33215
[S6] ⇄ pheromone p=0.373 → S11@127.0.0.1:33212
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.7006 head_norm=1.080549
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.837648e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.7006 head_norm=1.174960 delta_norm=0.583765
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.045 → S9@127.0.0.1:33210
[S10] ⇄ pheromone p=0.029 → S3@127.0.0.1:33203
[S16] ⇄ pheromone p=0.109 → S17@127.0.0.1:33217
[S15] ⇄ pheromone p=0.211 → S11@127.0.0.1:33212
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.5429 head_norm=1.091377
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.751944e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.5433 head_norm=1.164149 delta_norm=0.575194
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.170 → S3@127.0.0.1:33203
[S2] START round=26 head_norm_before_train=1.759781 cos_to_last_merge=0.8033 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=26 local utility u=0.309190 metrics={'f1_val': 0.7549328409280666, 'auprc': 0.8329071141113118, 'loss_val': 0.5146141877078196, 'psi': 0.7861225502013647}-{'f1_val': 0.6983713491554666, 'auprc': 0.794863687939502, 'loss_val': 0.6794958906097723, 'psi': 0.7369682846690808}
[S3] START round=26 head_norm_before_train=1.174960 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.999382172732774, 'loss_val': 0.34796733366589866, 'psi': 0.8201017066883626}-{'f1_val': 0.7006060025002057, 'auprc': 0.9985146250553132, 'loss_val': 0.3207059232223816, 'psi': 0.8197694515222487}
[S4] START round=26 head_norm_before_train=1.408694 cos_to_last_merge=0.9876 (last merge round=22)
[S4] round=26 local utility u=0.041566 metrics={'f1_val': 0.9471355397504394, 'auprc': 0.9516181083628489, 'loss_val': 0.2635213945439043, 'psi': 0.9489285671954032}-{'f1_val': 0.9434629069348892, 'auprc': 0.9347289496059658, 'loss_val': 0.27395070162137414, 'psi': 0.9399693240033198}
[S5] START round=26 head_norm_before_train=1.426923 cos_to_last_merge=0.8091 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=26 local utility u=0.354629 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9923310577859132, 'loss_val': 0.26522399910556915, 'psi': 0.8171252135747136}-{'f1_val': 0.7081250416304588, 'auprc': 0.795400038384212, 'loss_val': 0.43051062763022363, 'psi': 0.7430350403319601}
[S6] START round=26 head_norm_before_train=1.594841 cos_to_last_merge=0.8442 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=26 local utility u=0.015946 metrics={'f1_val': 0.8228216627206095, 'auprc': 0.9672084332683683, 'loss_val': 0.33360470549116206, 'psi': 0.880576370939713}-{'f1_val': 0.8480474169484239, 'auprc': 0.9618364081722316, 'loss_val': 0.5007350786849343, 'psi': 0.893563013437947}
[S7] START round=26 head_norm_before_train=1.658944 (no previous merge yet)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.9772418313466952, 'auprc': 0.9929334963030468, 'loss_val': 0.21348724618678874, 'psi': 0.9835184973292359}-{'f1_val': 0.43210230253931853, 'auprc': 0.7800124757126927, 'loss_val': 1.001189320275387, 'psi': 0.5712663718086682}
[S8] START round=26 head_norm_before_train=2.013222 (no previous merge yet)
[S8] round=26 local utility u=0.213894 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9988437005235704, 'loss_val': 0.03620612261330647, 'psi': 0.9944064231352643}-{'f1_val': 0.9345633840741012, 'auprc': 0.9921397027188388, 'loss_val': 0.10257383347243487, 'psi': 0.9575939115319962}
[S9] START round=26 head_norm_before_train=1.102260 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9964669506178767, 'loss_val': 0.1499539070415828, 'psi': 0.9939277717466801}-{'f1_val': 0.9939163253356635, 'auprc': 0.9977034940133025, 'loss_val': 0.14602298750128348, 'psi': 0.9954311928067191}
[S10] START round=26 head_norm_before_train=1.508322 cos_to_last_merge=0.9824 (last merge round=23)
[S10] round=26 local utility u=0.009954 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951853936188165, 'loss_val': 0.0589178422466141, 'psi': 0.9951868608591514}-{'f1_val': 0.9951878390193748, 'auprc': 0.995618852517278, 'loss_val': 0.08012699730076671, 'psi': 0.9953602444185361}
[S11] START round=26 head_norm_before_train=1.237808 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.018889 metrics={'f1_val': 0.9917519384520287, 'auprc': 0.997840805542048, 'loss_val': 0.1691561953570855, 'psi': 0.9941874852880364}-{'f1_val': 0.996305167468861, 'auprc': 0.9969157281103778, 'loss_val': 0.23147843815709365, 'psi': 0.9965493917254677}
[S13] START round=26 head_norm_before_train=1.193822 cos_to_last_merge=0.9827 (last merge round=23)
[S13] round=26 local utility u=0.156358 metrics={'f1_val': 0.6094319775952639, 'auprc': 0.6934385257660791, 'loss_val': 0.7303215749247634, 'psi': 0.64303459686359}-{'f1_val': 0.6043533380398853, 'auprc': 0.6069414231143753, 'loss_val': 0.7530750704747581, 'psi': 0.6053885720696813}
[S14] START round=26 head_norm_before_train=1.725046 cos_to_last_merge=0.9997 (last merge round=24)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9964424345629549, 'auprc': 0.9969876018675559, 'loss_val': 0.08017677009069012, 'psi': 0.9966605014847953}-{'f1_val': 0.9979161758042404, 'auprc': 0.9969731508257975, 'loss_val': 0.08513090993600235, 'psi': 0.9975389658128633}
[S15] START round=26 head_norm_before_train=1.823577 cos_to_last_merge=0.9996 (last merge round=24)
[S15] round=26 local utility u=0.801589 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9935872773720478, 'loss_val': 0.052348605448762825, 'psi': 0.9949762221570099}-{'f1_val': 0.7901918615377905, 'auprc': 0.967578532357211, 'loss_val': 0.3432390888317222, 'psi': 0.8611465298655587}
[S16] START round=26 head_norm_before_train=1.476849 cos_to_last_merge=0.9996 (last merge round=24)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.856144420344195, 'auprc': 0.9464999896038904, 'loss_val': 0.5924557255702331, 'psi': 0.8922866480480731}-{'f1_val': 0.8570287875493499, 'auprc': 0.9409068681826345, 'loss_val': 0.5662391230031613, 'psi': 0.8905800198026637}
[S17] START round=26 head_norm_before_train=1.164149 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.781697 metrics={'f1_val': 0.6213836840603266, 'auprc': 0.8874980060163229, 'loss_val': 0.8325378996071574, 'psi': 0.7278294128427252}-{'f1_val': 0.5429300390555551, 'auprc': 0.5677866275804533, 'loss_val': 0.9660756240227255, 'psi': 0.5528726744655144}
[S6] not sending this round → trigger blocked (psi=0.881)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:33204
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.7479
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.2499
[S10] RECEIVED delta(kind=head bytes=1804) from S4
[S10] cosine check vs S4: cos=0.8979
[S16] RECEIVED delta(kind=head bytes=1805) from S5
[S16] cosine check vs S5: cos=0.9853
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.7709
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.3923
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9933
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=0.4447
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.4837
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9964 head_norm=1.753083
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.087985e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9962 head_norm=1.705267 delta_norm=0.108799
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.7006 head_norm=1.210477
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.148737e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.7008 head_norm=1.042271 delta_norm=0.614874
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9952 head_norm=1.585581
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.494542e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9952 head_norm=1.482418 delta_norm=0.349454
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.6094 head_norm=1.248862
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.245324e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.6096 head_norm=1.102722 delta_norm=0.424532
[S13] aggregate: ACCEPT kept=['S11', 'S2'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9471 head_norm=1.457840
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.684964e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9473 head_norm=1.273965 delta_norm=0.468496
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9918 head_norm=1.289180
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.608834e-01
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9889 head_norm=1.342351 delta_norm=0.860883
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.8561 head_norm=1.512282
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.311445e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.8553 head_norm=1.472870 delta_norm=0.131144
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6214 head_norm=1.209771
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.040471e+00
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6196 head_norm=1.301538 delta_norm=1.040471
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.770472 cos_to_last_merge=0.8021 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.802
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7095923551611278, 'auprc': 0.880275742976028, 'loss_val': 0.5455958755777427, 'psi': 0.7778657102870878}-{'f1_val': 0.7549328409280666, 'auprc': 0.8329071141113118, 'loss_val': 0.5146141877078196, 'psi': 0.7861225502013647}
[S3] START round=27 head_norm_before_train=1.042271 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.6007004521553635, 'auprc': 0.9123820025655184, 'loss_val': 0.5246353898978455, 'psi': 0.7253730723194254}-{'f1_val': 0.7005813959920884, 'auprc': 0.999382172732774, 'loss_val': 0.34796733366589866, 'psi': 0.8201017066883626}
[S4] START round=27 head_norm_before_train=1.273965 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9426310056585969, 'auprc': 0.9187651677896553, 'loss_val': 0.2882289335748737, 'psi': 0.9330846705110203}-{'f1_val': 0.9471355397504394, 'auprc': 0.9516181083628489, 'loss_val': 0.2635213945439043, 'psi': 0.9489285671954032}
[S5] START round=27 head_norm_before_train=1.444330 cos_to_last_merge=0.8092 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.7006095478931456, 'auprc': 0.8026365278442533, 'loss_val': 0.33495201659215745, 'psi': 0.7414203398735887}-{'f1_val': 0.7003213174339138, 'auprc': 0.9923310577859132, 'loss_val': 0.26522399910556915, 'psi': 0.8171252135747136}
[S6] START round=27 head_norm_before_train=1.610336 cos_to_last_merge=0.8426 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.843
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.8218387301249372, 'auprc': 0.9554745558013756, 'loss_val': 0.42875535421640554, 'psi': 0.8752930603955126}-{'f1_val': 0.8228216627206095, 'auprc': 0.9672084332683683, 'loss_val': 0.33360470549116206, 'psi': 0.880576370939713}
[S7] START round=27 head_norm_before_train=1.663204 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.40300746723032105, 'auprc': 0.7794337569948981, 'loss_val': 1.16312475284101, 'psi': 0.5535779831361519}-{'f1_val': 0.9772418313466952, 'auprc': 0.9929334963030468, 'loss_val': 0.21348724618678874, 'psi': 0.9835184973292359}
[S8] START round=27 head_norm_before_train=2.022280 (no previous merge yet)
[S8] round=27 local utility u=0.009859 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9989301554086603, 'loss_val': 0.03068249345255773, 'psi': 0.9958346052078164}-{'f1_val': 0.9914482382097267, 'auprc': 0.9988437005235704, 'loss_val': 0.03620612261330647, 'psi': 0.9944064231352643}
[S9] START round=27 head_norm_before_train=1.146349 cos_to_last_merge=0.9987 (last merge round=25)
[S9] round=27 local utility u=0.027936 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9971124514098957, 'loss_val': 0.11360114607692812, 'psi': 0.9959442843979274}-{'f1_val': 0.9922349858325491, 'auprc': 0.9964669506178767, 'loss_val': 0.1499539070415828, 'psi': 0.9939277717466801}
[S10] START round=27 head_norm_before_train=1.482418 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951695443684092, 'loss_val': 0.09106214332567229, 'psi': 0.9951805211589886}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951853936188165, 'loss_val': 0.0589178422466141, 'psi': 0.9951868608591514}
[S11] START round=27 head_norm_before_train=1.342351 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.001831 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976161764712174, 'loss_val': 0.1935909970115017, 'psi': 0.9969746732966407}-{'f1_val': 0.9917519384520287, 'auprc': 0.997840805542048, 'loss_val': 0.1691561953570855, 'psi': 0.9941874852880364}
[S13] START round=27 head_norm_before_train=1.102722 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6200102783754847, 'auprc': 0.5769414916771851, 'loss_val': 0.738724914178582, 'psi': 0.6027827636961649}-{'f1_val': 0.6094319775952639, 'auprc': 0.6934385257660791, 'loss_val': 0.7303215749247634, 'psi': 0.64303459686359}
[S14] START round=27 head_norm_before_train=1.705267 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000327 metrics={'f1_val': 0.9967785811702936, 'auprc': 0.9970190152147481, 'loss_val': 0.08163367669967551, 'psi': 0.9968747547880754}-{'f1_val': 0.9964424345629549, 'auprc': 0.9969876018675559, 'loss_val': 0.08017677009069012, 'psi': 0.9966605014847953}
[S15] START round=27 head_norm_before_train=1.850424 cos_to_last_merge=0.9986 (last merge round=24)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8889121435054024, 'auprc': 0.9947092633243546, 'loss_val': 0.22703826471501742, 'psi': 0.9312309914329833}-{'f1_val': 0.9959021853469847, 'auprc': 0.9935872773720478, 'loss_val': 0.052348605448762825, 'psi': 0.9949762221570099}
[S16] START round=27 head_norm_before_train=1.472870 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.039868 metrics={'f1_val': 0.8627478925894565, 'auprc': 0.9450529570976605, 'loss_val': 0.5479985490590359, 'psi': 0.8956699183927381}-{'f1_val': 0.856144420344195, 'auprc': 0.9464999896038904, 'loss_val': 0.5924557255702331, 'psi': 0.8922866480480731}
[S17] START round=27 head_norm_before_train=1.301538 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6051527567042994, 'auprc': 0.7290465821778593, 'loss_val': 0.8840189081367041, 'psi': 0.6547102868937233}-{'f1_val': 0.6213836840603266, 'auprc': 0.8874980060163229, 'loss_val': 0.8325378996071574, 'psi': 0.7278294128427252}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:33215
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:33217
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:33213
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9775
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=0.6540
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.4511
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.8777
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=0.5887
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.6200 head_norm=1.156467
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.382400e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.6236 head_norm=1.155903 delta_norm=0.538240
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.6052 head_norm=1.361898
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.005583e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5965 head_norm=1.155900 delta_norm=0.400558
[S17] aggregate: ROLLBACK (f1_val pre=0.605 post=0.596 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=27 metric=0.8889 head_norm=1.878502
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.053394e-01
[S15] stored merged vector for next round verification (round=27)
[S15] DEBUG after merge:  round=27 metric=0.8883 head_norm=1.793229 delta_norm=0.205339
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.780816 cos_to_last_merge=0.8006 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6906091156664497, 'auprc': 0.7705621749321648, 'loss_val': 0.7313712220058413, 'psi': 0.7225903393727358}-{'f1_val': 0.7095923551611278, 'auprc': 0.880275742976028, 'loss_val': 0.5455958755777427, 'psi': 0.7778657102870878}
[S3] START round=28 head_norm_before_train=1.086809 cos_to_last_merge=0.9984 (last merge round=26)
[S3] round=28 local utility u=0.504125 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9994097560901263, 'loss_val': 0.32976517922931997, 'psi': 0.8154138297254869}-{'f1_val': 0.6007004521553635, 'auprc': 0.9123820025655184, 'loss_val': 0.5246353898978455, 'psi': 0.7253730723194254}
[S4] START round=28 head_norm_before_train=1.328889 cos_to_last_merge=0.9987 (last merge round=26)
[S4] round=28 local utility u=0.056341 metrics={'f1_val': 0.949179743410042, 'auprc': 0.93846821707002, 'loss_val': 0.2739491394922146, 'psi': 0.9448951328740332}-{'f1_val': 0.9426310056585969, 'auprc': 0.9187651677896553, 'loss_val': 0.2882289335748737, 'psi': 0.9330846705110203}
[S5] START round=28 head_norm_before_train=1.460674 cos_to_last_merge=0.8119 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=28 local utility u=0.305551 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9895962351808848, 'loss_val': 0.28299509091307024, 'psi': 0.8160308531671694}-{'f1_val': 0.7006095478931456, 'auprc': 0.8026365278442533, 'loss_val': 0.33495201659215745, 'psi': 0.7414203398735887}
[S6] START round=28 head_norm_before_train=1.625393 cos_to_last_merge=0.8413 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7676342530554554, 'auprc': 0.9530518991341178, 'loss_val': 0.6132140147455435, 'psi': 0.8418013114869204}-{'f1_val': 0.8218387301249372, 'auprc': 0.9554745558013756, 'loss_val': 0.42875535421640554, 'psi': 0.8752930603955126}
[S7] START round=28 head_norm_before_train=1.665181 (no previous merge yet)
[S7] round=28 local utility u=1.000000 metrics={'f1_val': 0.6733480984045737, 'auprc': 0.815824710526076, 'loss_val': 0.42755103335884614, 'psi': 0.7303387432531746}-{'f1_val': 0.40300746723032105, 'auprc': 0.7794337569948981, 'loss_val': 1.16312475284101, 'psi': 0.5535779831361519}
[S8] START round=28 head_norm_before_train=2.032514 (no previous merge yet)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9890612406825224, 'auprc': 0.998768132892311, 'loss_val': 0.039355348753736696, 'psi': 0.9929439975664378}-{'f1_val': 0.9937709050739206, 'auprc': 0.9989301554086603, 'loss_val': 0.03068249345255773, 'psi': 0.9958346052078164}
[S9] START round=28 head_norm_before_train=1.191571 cos_to_last_merge=0.9953 (last merge round=25)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9913944794912241, 'auprc': 0.9973350563758809, 'loss_val': 0.09539554224569355, 'psi': 0.9937707102450868}-{'f1_val': 0.9951655063899485, 'auprc': 0.9971124514098957, 'loss_val': 0.11360114607692812, 'psi': 0.9959442843979274}
[S10] START round=28 head_norm_before_train=1.554727 cos_to_last_merge=0.9980 (last merge round=26)
[S10] round=28 local utility u=0.013907 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948419052974605, 'loss_val': 0.062265376238092085, 'psi': 0.995049465530609}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951695443684092, 'loss_val': 0.09106214332567229, 'psi': 0.9951805211589886}
[S11] START round=28 head_norm_before_train=1.383551 cos_to_last_merge=0.9981 (last merge round=26)
[S11] round=28 local utility u=0.027507 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979720225913309, 'loss_val': 0.1396441004433671, 'psi': 0.9971170117446861}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976161764712174, 'loss_val': 0.1935909970115017, 'psi': 0.9969746732966407}
[S13] START round=28 head_norm_before_train=1.155903 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.370783 metrics={'f1_val': 0.6581326271285691, 'auprc': 0.7010784279047617, 'loss_val': 0.5983044342784462, 'psi': 0.6753109474390462}-{'f1_val': 0.6200102783754847, 'auprc': 0.5769414916771851, 'loss_val': 0.738724914178582, 'psi': 0.6027827636961649}
[S14] START round=28 head_norm_before_train=1.728266 cos_to_last_merge=0.9997 (last merge round=26)
[S14] round=28 local utility u=0.011728 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9973560091902615, 'loss_val': 0.06442725975357758, 'psi': 0.9975333781367444}-{'f1_val': 0.9967785811702936, 'auprc': 0.9970190152147481, 'loss_val': 0.08163367669967551, 'psi': 0.9968747547880754}
[S15] START round=28 head_norm_before_train=1.793229 cos_to_last_merge=1.0000 (last merge round=27)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.8793118545046096, 'auprc': 0.9962610669938913, 'loss_val': 0.2290816471036196, 'psi': 0.9260915395003222}-{'f1_val': 0.8889121435054024, 'auprc': 0.9947092633243546, 'loss_val': 0.22703826471501742, 'psi': 0.9312309914329833}
[S16] START round=28 head_norm_before_train=1.507473 cos_to_last_merge=0.9994 (last merge round=26)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.839354557733637, 'auprc': 0.9343979670819555, 'loss_val': 0.8499158099243564, 'psi': 0.8773719214729645}-{'f1_val': 0.8627478925894565, 'auprc': 0.9450529570976605, 'loss_val': 0.5479985490590359, 'psi': 0.8956699183927381}
[S17] START round=28 head_norm_before_train=1.155900 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5907503556423548, 'auprc': 0.7589352413528353, 'loss_val': 0.8988566545131157, 'psi': 0.658024309926547}-{'f1_val': 0.6051527567042994, 'auprc': 0.7290465821778593, 'loss_val': 0.8840189081367041, 'psi': 0.6547102868937233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:33216
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:33203
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:33210
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:33213
[S11] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.9892
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.9093
[S9] RECEIVED delta(kind=head bytes=1793) from S3
[S9] cosine check vs S3: cos=0.9428
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=0.9084
[S3] RECEIVED delta(kind=head bytes=1795) from S10
[S3] cosine check vs S10: cos=0.6145
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.8349
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9911
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9943
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9914 head_norm=1.236180
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.066882e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9918 head_norm=1.166946 delta_norm=0.206688
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=28 metric=0.8793 head_norm=1.825777
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.241122e-01
[S15] stored merged vector for next round verification (round=28)
[S15] DEBUG after merge:  round=28 metric=0.8799 head_norm=1.787767 delta_norm=0.124112
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9952 head_norm=1.631622
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.421522e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9950 head_norm=1.480840 delta_norm=0.342152
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.6581 head_norm=1.203220
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.023260e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.6616 head_norm=1.285657 delta_norm=0.302326
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9977 head_norm=1.757718
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.018541e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9977 head_norm=1.709625 delta_norm=0.101854
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.6927 head_norm=1.131736
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.468357e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9350 head_norm=1.246239 delta_norm=0.646836
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9492 head_norm=1.399184
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.854685e-01
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9493 head_norm=1.246652 delta_norm=0.385469
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.8394 head_norm=1.542026
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.159810e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.8389 head_norm=1.503515 delta_norm=0.115981
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.797759 cos_to_last_merge=0.7988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.6593169774489015, 'auprc': 0.7812242319326231, 'loss_val': 0.8682774024514245, 'psi': 0.7080798792423901}-{'f1_val': 0.6906091156664497, 'auprc': 0.7705621749321648, 'loss_val': 0.7313712220058413, 'psi': 0.7225903393727358}
[S3] START round=29 head_norm_before_train=1.246239 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.6054094242862555, 'auprc': 0.9895893476343782, 'loss_val': 0.4429063835891804, 'psi': 0.7590813936255046}-{'f1_val': 0.6927498788157274, 'auprc': 0.9994097560901263, 'loss_val': 0.32976517922931997, 'psi': 0.8154138297254869}
[S4] START round=29 head_norm_before_train=1.246652 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.051068 metrics={'f1_val': 0.9535692748074959, 'auprc': 0.9680165927915193, 'loss_val': 0.28679520653249096, 'psi': 0.9593482020011053}-{'f1_val': 0.949179743410042, 'auprc': 0.93846821707002, 'loss_val': 0.2739491394922146, 'psi': 0.9448951328740332}
[S5] START round=29 head_norm_before_train=1.473151 cos_to_last_merge=0.8095 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=29 local utility u=0.020786 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9941180033855563, 'loss_val': 0.25498754957322867, 'psi': 0.8178395604490379}-{'f1_val': 0.700320598491359, 'auprc': 0.9895962351808848, 'loss_val': 0.28299509091307024, 'psi': 0.8160308531671694}
[S6] START round=29 head_norm_before_train=1.640914 cos_to_last_merge=0.8397 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=29 local utility u=0.285450 metrics={'f1_val': 0.8230451709199044, 'auprc': 0.9639846068456801, 'loss_val': 0.4075776486073423, 'psi': 0.8794209452902146}-{'f1_val': 0.7676342530554554, 'auprc': 0.9530518991341178, 'loss_val': 0.6132140147455435, 'psi': 0.8418013114869204}
[S7] START round=29 head_norm_before_train=1.666378 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5847570123469855, 'auprc': 0.7817410693981635, 'loss_val': 0.7236673594276828, 'psi': 0.6635506351674567}-{'f1_val': 0.6733480984045737, 'auprc': 0.815824710526076, 'loss_val': 0.42755103335884614, 'psi': 0.7303387432531746}
[S8] START round=29 head_norm_before_train=2.040181 (no previous merge yet)
[S8] round=29 local utility u=0.017102 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9989713438357438, 'loss_val': 0.03181855780058656, 'psi': 0.9956311025407639}-{'f1_val': 0.9890612406825224, 'auprc': 0.998768132892311, 'loss_val': 0.039355348753736696, 'psi': 0.9929439975664378}
[S9] START round=29 head_norm_before_train=1.166946 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9943332231862974, 'auprc': 0.9959719673942642, 'loss_val': 0.10974445878468451, 'psi': 0.9949887208694841}-{'f1_val': 0.9913944794912241, 'auprc': 0.9973350563758809, 'loss_val': 0.09539554224569355, 'psi': 0.9937707102450868}
[S10] START round=29 head_norm_before_train=1.480840 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957700182119127, 'loss_val': 0.09126093464137583, 'psi': 0.9954207106963899}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948419052974605, 'loss_val': 0.062265376238092085, 'psi': 0.995049465530609}
[S11] START round=29 head_norm_before_train=1.428598 cos_to_last_merge=0.9928 (last merge round=26)
[S11] round=29 local utility u=0.013812 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979216100904382, 'loss_val': 0.10938913037072084, 'psi': 0.9968488489841609}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979720225913309, 'loss_val': 0.1396441004433671, 'psi': 0.9971170117446861}
[S13] START round=29 head_norm_before_train=1.285657 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5910728565648238, 'auprc': 0.5722822737762879, 'loss_val': 0.7867538558507661, 'psi': 0.5835566234494094}-{'f1_val': 0.6581326271285691, 'auprc': 0.7010784279047617, 'loss_val': 0.5983044342784462, 'psi': 0.6753109474390462}
[S14] START round=29 head_norm_before_train=1.709625 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9277710834304889, 'auprc': 0.9986029330813714, 'loss_val': 0.1680983750275439, 'psi': 0.9561038232908419}-{'f1_val': 0.9976516241010662, 'auprc': 0.9973560091902615, 'loss_val': 0.06442725975357758, 'psi': 0.9975333781367444}
[S15] START round=29 head_norm_before_train=1.787767 cos_to_last_merge=1.0000 (last merge round=28)
[S15] round=29 local utility u=0.431281 metrics={'f1_val': 0.9955024063769649, 'auprc': 0.9971247624406929, 'loss_val': 0.06625369302736424, 'psi': 0.996151348802456}-{'f1_val': 0.8793118545046096, 'auprc': 0.9962610669938913, 'loss_val': 0.2290816471036196, 'psi': 0.9260915395003222}
[S16] START round=29 head_norm_before_train=1.503515 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.199613 metrics={'f1_val': 0.8575231630507709, 'auprc': 0.9539613241179135, 'loss_val': 0.6183912502244904, 'psi': 0.8960984274776279}-{'f1_val': 0.839354557733637, 'auprc': 0.9343979670819555, 'loss_val': 0.8499158099243564, 'psi': 0.8773719214729645}
[S17] START round=29 head_norm_before_train=1.225800 cos_to_last_merge=0.9971 (last merge round=27)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.5359597083471077, 'auprc': 0.6337712038585508, 'loss_val': 1.2613078900784411, 'psi': 0.5750843065516849}-{'f1_val': 0.5907503556423548, 'auprc': 0.7589352413528353, 'loss_val': 0.8988566545131157, 'psi': 0.658024309926547}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.959)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:33217
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:33212
[S5] not sending this round → trigger blocked (psi=0.818)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:33212
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.7089
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.5814
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=0.8471
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.4176
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9961 head_norm=1.473874
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.716628e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9961 head_norm=1.314342 delta_norm=0.271663
[S11] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5360 head_norm=1.295040
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.800179e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.4999 head_norm=1.263850 delta_norm=0.280018
[S17] aggregate: ROLLBACK (f1_val pre=0.536 post=0.500 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.814915 cos_to_last_merge=0.7971 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=30 local utility u=0.606734 metrics={'f1_val': 0.7095907114552598, 'auprc': 0.9908603048695868, 'loss_val': 0.5853593212557907, 'psi': 0.8220985488209906}-{'f1_val': 0.6593169774489015, 'auprc': 0.7812242319326231, 'loss_val': 0.8682774024514245, 'psi': 0.7080798792423901}
[S3] START round=30 head_norm_before_train=1.283265 cos_to_last_merge=0.9989 (last merge round=28)
[S3] round=30 local utility u=0.387341 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9997223144193481, 'loss_val': 0.266649288480683, 'psi': 0.8199371079238902}-{'f1_val': 0.6054094242862555, 'auprc': 0.9895893476343782, 'loss_val': 0.4429063835891804, 'psi': 0.7590813936255046}
[S4] START round=30 head_norm_before_train=1.329360 cos_to_last_merge=0.9961 (last merge round=28)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9402856687522473, 'auprc': 0.927765615799882, 'loss_val': 0.2777546435762286, 'psi': 0.9352776475713012}-{'f1_val': 0.9535692748074959, 'auprc': 0.9680165927915193, 'loss_val': 0.28679520653249096, 'psi': 0.9593482020011053}
[S5] START round=30 head_norm_before_train=1.478027 cos_to_last_merge=0.8004 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.704240553447048, 'auprc': 0.8148256843060884, 'loss_val': 0.3807513660548039, 'psi': 0.7484746057906642}-{'f1_val': 0.700320598491359, 'auprc': 0.9941180033855563, 'loss_val': 0.25498754957322867, 'psi': 0.8178395604490379}
[S6] START round=30 head_norm_before_train=1.657479 cos_to_last_merge=0.8380 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=30 local utility u=0.507261 metrics={'f1_val': 0.9607880292888071, 'auprc': 0.9682414963347576, 'loss_val': 0.23228299002475758, 'psi': 0.9637694161071874}-{'f1_val': 0.8230451709199044, 'auprc': 0.9639846068456801, 'loss_val': 0.4075776486073423, 'psi': 0.8794209452902146}
[S7] START round=30 head_norm_before_train=1.667414 (no previous merge yet)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.43501795611295063, 'auprc': 0.7799172403721999, 'loss_val': 1.0277675031784534, 'psi': 0.5729776698166503}-{'f1_val': 0.5847570123469855, 'auprc': 0.7817410693981635, 'loss_val': 0.7236673594276828, 'psi': 0.6635506351674567}
[S8] START round=30 head_norm_before_train=2.051253 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9919528555747477, 'auprc': 0.9987619444891026, 'loss_val': 0.03303748245968002, 'psi': 0.9946764911404896}-{'f1_val': 0.9934042750107773, 'auprc': 0.9989713438357438, 'loss_val': 0.03181855780058656, 'psi': 0.9956311025407639}
[S9] START round=30 head_norm_before_train=1.207481 cos_to_last_merge=0.9992 (last merge round=28)
[S9] round=30 local utility u=0.016490 metrics={'f1_val': 0.9955808965143278, 'auprc': 0.9967603736114815, 'loss_val': 0.08661519689578685, 'psi': 0.9960526873531893}-{'f1_val': 0.9943332231862974, 'auprc': 0.9959719673942642, 'loss_val': 0.10974445878468451, 'psi': 0.9949887208694841}
[S10] START round=30 head_norm_before_train=1.557675 cos_to_last_merge=0.9974 (last merge round=28)
[S10] round=30 local utility u=0.014025 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995364051552834, 'loss_val': 0.06199254591119567, 'psi': 0.9952583240327584}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957700182119127, 'loss_val': 0.09126093464137583, 'psi': 0.9954207106963899}
[S11] START round=30 head_norm_before_train=1.314342 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.99792272806252, 'loss_val': 0.1229783976630493, 'psi': 0.9968492961729936}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979216100904382, 'loss_val': 0.10938913037072084, 'psi': 0.9968488489841609}
[S13] START round=30 head_norm_before_train=1.328853 cos_to_last_merge=0.9970 (last merge round=28)
[S13] round=30 local utility u=0.286470 metrics={'f1_val': 0.6255043213006948, 'auprc': 0.6569680072471249, 'loss_val': 0.6744595071846109, 'psi': 0.6380897956792668}-{'f1_val': 0.5910728565648238, 'auprc': 0.5722822737762879, 'loss_val': 0.7867538558507661, 'psi': 0.5835566234494094}
[S14] START round=30 head_norm_before_train=1.734919 cos_to_last_merge=0.9998 (last merge round=28)
[S14] round=30 local utility u=0.259889 metrics={'f1_val': 0.9972626935085508, 'auprc': 0.9973838428481092, 'loss_val': 0.06161231296221107, 'psi': 0.9973111532443741}-{'f1_val': 0.9277710834304889, 'auprc': 0.9986029330813714, 'loss_val': 0.1680983750275439, 'psi': 0.9561038232908419}
[S15] START round=30 head_norm_before_train=1.831999 cos_to_last_merge=0.9988 (last merge round=28)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7031449995368507, 'auprc': 0.9285022237625251, 'loss_val': 0.5102774766447422, 'psi': 0.7932878892271205}-{'f1_val': 0.9955024063769649, 'auprc': 0.9971247624406929, 'loss_val': 0.06625369302736424, 'psi': 0.996151348802456}
[S16] START round=30 head_norm_before_train=1.533717 cos_to_last_merge=0.9996 (last merge round=28)
[S16] round=30 local utility u=0.304295 metrics={'f1_val': 0.9100200718504077, 'auprc': 0.9470791304791095, 'loss_val': 0.3041360428213068, 'psi': 0.9248436953018884}-{'f1_val': 0.8575231630507709, 'auprc': 0.9539613241179135, 'loss_val': 0.6183912502244904, 'psi': 0.8960984274776279}
[S17] START round=30 head_norm_before_train=1.263850 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.528902 metrics={'f1_val': 0.6066347152375928, 'auprc': 0.7875800035154796, 'loss_val': 1.0889812389099718, 'psi': 0.6790128305487475}-{'f1_val': 0.5359597083471077, 'auprc': 0.6337712038585508, 'loss_val': 1.2613078900784411, 'psi': 0.5750843065516849}
[S6] not sending this round → trigger blocked (psi=0.964)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.925)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:33215
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:33210
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33204
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:33213
[S2] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=0.8594
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.8436
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9879
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=0.9005
[S17] RECEIVED delta(kind=head bytes=1799) from S9
[S17] cosine check vs S9: cos=0.6889
[S13] RECEIVED delta(kind=head bytes=1796) from S2
[S13] cosine check vs S2: cos=0.1525
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.4525
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9403 head_norm=1.418339
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.720084e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9405 head_norm=1.351582 delta_norm=0.372008
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.025 → S10@127.0.0.1:33211
[S8] ⇄ pheromone p=0.044 → S17@127.0.0.1:33217
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=30 metric=0.7031 head_norm=1.877102
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.533568e-01
[S15] stored merged vector for next round verification (round=30)
[S15] DEBUG after merge:  round=30 metric=0.7031 head_norm=1.812408 delta_norm=0.153357
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.204 → S11@127.0.0.1:33212
[S11] ⇄ pheromone p=0.042 → S13@127.0.0.1:33213
[S6] ⇄ pheromone p=0.271 → S11@127.0.0.1:33212
[S5] ⇄ pheromone p=0.109 → S16@127.0.0.1:33216
[S7] ⇄ pheromone p=0.286 → S14@127.0.0.1:33214
[S14] ⇄ pheromone p=0.069 → S15@127.0.0.1:33215
[S10] ⇄ pheromone p=0.015 → S3@127.0.0.1:33203
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9956 head_norm=1.248940
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.604353e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9960 head_norm=1.232312 delta_norm=0.360435
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.022 → S17@127.0.0.1:33217
[S2] ⇄ pheromone p=0.159 → S13@127.0.0.1:33213
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.6255 head_norm=1.385150
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.060907e+00
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.6247 head_norm=1.229922 delta_norm=1.060907
[S13] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.127 → S4@127.0.0.1:33204
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.7001 head_norm=1.318016
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.795359e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.6998 head_norm=1.199996 delta_norm=0.279536
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.157 → S9@127.0.0.1:33210
[S16] ⇄ pheromone p=0.133 → S17@127.0.0.1:33217
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6066 head_norm=1.314164
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.063647e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6041 head_norm=1.177724 delta_norm=0.506365
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.226 → S3@127.0.0.1:33203
[S2] START round=31 head_norm_before_train=1.832435 cos_to_last_merge=0.7954 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=31 local utility u=0.011269 metrics={'f1_val': 0.7096022605347694, 'auprc': 0.9812154129088511, 'loss_val': 0.53395557844961, 'psi': 0.818247521484402}-{'f1_val': 0.7095907114552598, 'auprc': 0.9908603048695868, 'loss_val': 0.5853593212557907, 'psi': 0.8220985488209906}
[S3] START round=31 head_norm_before_train=1.199996 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.599956 metrics={'f1_val': 0.9151488107020789, 'auprc': 0.9997396678801881, 'loss_val': 0.35719993700162433, 'psi': 0.9489851535733226}-{'f1_val': 0.7000803035935849, 'auprc': 0.9997223144193481, 'loss_val': 0.266649288480683, 'psi': 0.8199371079238902}
[S4] START round=31 head_norm_before_train=1.351582 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.050146 metrics={'f1_val': 0.9472519929858464, 'auprc': 0.947650052596283, 'loss_val': 0.2789129952832693, 'psi': 0.947411216830021}-{'f1_val': 0.9402856687522473, 'auprc': 0.927765615799882, 'loss_val': 0.2777546435762286, 'psi': 0.9352776475713012}
[S5] START round=31 head_norm_before_train=1.486071 cos_to_last_merge=0.7974 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=31 local utility u=0.315873 metrics={'f1_val': 0.700320598491359, 'auprc': 0.991917085198191, 'loss_val': 0.25675886104066015, 'psi': 0.8169591931740918}-{'f1_val': 0.704240553447048, 'auprc': 0.8148256843060884, 'loss_val': 0.3807513660548039, 'psi': 0.7484746057906642}
[S6] START round=31 head_norm_before_train=1.673900 cos_to_last_merge=0.8363 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7235314529794754, 'auprc': 0.9439507057228479, 'loss_val': 0.6713697169296787, 'psi': 0.8116991540768244}-{'f1_val': 0.9607880292888071, 'auprc': 0.9682414963347576, 'loss_val': 0.23228299002475758, 'psi': 0.9637694161071874}
[S7] START round=31 head_norm_before_train=1.670059 (no previous merge yet)
[S7] round=31 local utility u=0.787021 metrics={'f1_val': 0.6259238669254944, 'auprc': 0.7860265441088532, 'loss_val': 0.6174879819125423, 'psi': 0.6899649377988379}-{'f1_val': 0.43501795611295063, 'auprc': 0.7799172403721999, 'loss_val': 1.0277675031784534, 'psi': 0.5729776698166503}
[S8] START round=31 head_norm_before_train=2.066711 (no previous merge yet)
[S8] round=31 local utility u=0.008315 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9989081256694768, 'loss_val': 0.02995659384765815, 'psi': 0.9960461064304755}-{'f1_val': 0.9919528555747477, 'auprc': 0.9987619444891026, 'loss_val': 0.03303748245968002, 'psi': 0.9946764911404896}
[S9] START round=31 head_norm_before_train=1.232312 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9943332231862974, 'auprc': 0.9967378050112038, 'loss_val': 0.11334618234072903, 'psi': 0.9952950559162599}-{'f1_val': 0.9955808965143278, 'auprc': 0.9967603736114815, 'loss_val': 0.08661519689578685, 'psi': 0.9960526873531893}
[S10] START round=31 head_norm_before_train=1.634382 cos_to_last_merge=0.9916 (last merge round=28)
[S10] round=31 local utility u=0.002150 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9925996409269174, 'loss_val': 0.04939883411465579, 'psi': 0.9941525597823918}-{'f1_val': 0.9951878390193748, 'auprc': 0.995364051552834, 'loss_val': 0.06199254591119567, 'psi': 0.9952583240327584}
[S11] START round=31 head_norm_before_train=1.357878 cos_to_last_merge=0.9991 (last merge round=29)
[S11] round=31 local utility u=0.015660 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980168562333889, 'loss_val': 0.09442074107171482, 'psi': 0.9971349452015092}-{'f1_val': 0.9961336749133093, 'auprc': 0.99792272806252, 'loss_val': 0.1229783976630493, 'psi': 0.9968492961729936}
[S13] START round=31 head_norm_before_train=1.229922 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.016820 metrics={'f1_val': 0.6056303564920141, 'auprc': 0.727776451553837, 'loss_val': 0.7340010681802183, 'psi': 0.6544887945167432}-{'f1_val': 0.6255043213006948, 'auprc': 0.6569680072471249, 'loss_val': 0.6744595071846109, 'psi': 0.6380897956792668}
[S14] START round=31 head_norm_before_train=1.758741 cos_to_last_merge=0.9992 (last merge round=28)
[S14] round=31 local utility u=0.002798 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9969218853530113, 'loss_val': 0.05349027996278144, 'psi': 0.9970124348429483}-{'f1_val': 0.9972626935085508, 'auprc': 0.9973838428481092, 'loss_val': 0.06161231296221107, 'psi': 0.9973111532443741}
[S15] START round=31 head_norm_before_train=1.812408 cos_to_last_merge=1.0000 (last merge round=30)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9982577172465209, 'loss_val': 0.05401654147559646, 'psi': 0.9971025334078929}-{'f1_val': 0.7031449995368507, 'auprc': 0.9285022237625251, 'loss_val': 0.5102774766447422, 'psi': 0.7932878892271205}
[S16] START round=31 head_norm_before_train=1.565839 cos_to_last_merge=0.9985 (last merge round=28)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8551674453528775, 'auprc': 0.965130192904932, 'loss_val': 0.6661826652687767, 'psi': 0.8991525443736992}-{'f1_val': 0.9100200718504077, 'auprc': 0.9470791304791095, 'loss_val': 0.3041360428213068, 'psi': 0.9248436953018884}
[S17] START round=31 head_norm_before_train=1.177724 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.046090 metrics={'f1_val': 0.610216651208041, 'auprc': 0.778664909018372, 'loss_val': 0.9915471778608276, 'psi': 0.6775959543321735}-{'f1_val': 0.6066347152375928, 'auprc': 0.7875800035154796, 'loss_val': 1.0889812389099718, 'psi': 0.6790128305487475}
[S3] not sending this round → trigger blocked (psi=0.949)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:33211
[S13] not sending this round → trigger blocked (psi=0.654)
[S14] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → trigger blocked (psi=0.818)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:33212
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=0.5121
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=0.9937
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.8287
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9859
[S11] RECEIVED delta(kind=head bytes=1803) from S15
[S11] cosine check vs S15: cos=0.7784
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.5610
[S17] not sending this round → trigger blocked (psi=0.678)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9952 head_norm=1.697346
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.751038e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9952 head_norm=1.496341 delta_norm=0.475104
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.6056 head_norm=1.279619
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.644194e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.6542 head_norm=1.166249 delta_norm=0.664419
[S13] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9971 head_norm=1.785856
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.114934e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9971 head_norm=1.728841 delta_norm=0.111493
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9965 head_norm=1.402055
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.806463e-01
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9965 head_norm=1.534571 delta_norm=0.580646
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.6102 head_norm=1.223633
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.608795e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.6097 head_norm=1.472492 delta_norm=0.860880
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.8552 head_norm=1.598145
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.396794e-01
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.8549 head_norm=1.540797 delta_norm=0.139679
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.843198 cos_to_last_merge=0.7935 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.6195067746139001, 'auprc': 0.780453150182453, 'loss_val': 1.074724175727805, 'psi': 0.6838853248413213}-{'f1_val': 0.7096022605347694, 'auprc': 0.9812154129088511, 'loss_val': 0.53395557844961, 'psi': 0.818247521484402}
[S3] START round=32 head_norm_before_train=1.233392 cos_to_last_merge=0.9990 (last merge round=30)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.8813905750454651, 'auprc': 0.9992978712677211, 'loss_val': 0.38711475787580973, 'psi': 0.9285534935343676}-{'f1_val': 0.9151488107020789, 'auprc': 0.9997396678801881, 'loss_val': 0.35719993700162433, 'psi': 0.9489851535733226}
[S4] START round=32 head_norm_before_train=1.431270 cos_to_last_merge=0.9960 (last merge round=30)
[S4] round=32 local utility u=0.025284 metrics={'f1_val': 0.9514564409341251, 'auprc': 0.950507126936627, 'loss_val': 0.26214288187358403, 'psi': 0.9510767153351258}-{'f1_val': 0.9472519929858464, 'auprc': 0.947650052596283, 'loss_val': 0.2789129952832693, 'psi': 0.947411216830021}
[S5] START round=32 head_norm_before_train=1.494343 cos_to_last_merge=0.7970 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9789203964437185, 'loss_val': 0.2715605497209201, 'psi': 0.8117605176723028}-{'f1_val': 0.700320598491359, 'auprc': 0.991917085198191, 'loss_val': 0.25675886104066015, 'psi': 0.8169591931740918}
[S6] START round=32 head_norm_before_train=1.680747 cos_to_last_merge=0.8352 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6194127586008823, 'auprc': 0.9354218810041892, 'loss_val': 0.76556038215183, 'psi': 0.7458164075622051}-{'f1_val': 0.7235314529794754, 'auprc': 0.9439507057228479, 'loss_val': 0.6713697169296787, 'psi': 0.8116991540768244}
[S7] START round=32 head_norm_before_train=1.677308 (no previous merge yet)
[S7] round=32 local utility u=0.082481 metrics={'f1_val': 0.6396548181251847, 'auprc': 0.7951561808768814, 'loss_val': 0.5623007288034689, 'psi': 0.7018553632258633}-{'f1_val': 0.6259238669254944, 'auprc': 0.7860265441088532, 'loss_val': 0.6174879819125423, 'psi': 0.6899649377988379}
[S8] START round=32 head_norm_before_train=2.078802 (no previous merge yet)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9988377561277645, 'loss_val': 0.031159176555399685, 'psi': 0.9957976454954581}-{'f1_val': 0.9941380936044745, 'auprc': 0.9989081256694768, 'loss_val': 0.02995659384765815, 'psi': 0.9960461064304755}
[S9] START round=32 head_norm_before_train=1.268275 cos_to_last_merge=0.9993 (last merge round=30)
[S9] round=32 local utility u=0.014147 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9971416246670536, 'loss_val': 0.08876263808623731, 'psi': 0.9957064195113912}-{'f1_val': 0.9943332231862974, 'auprc': 0.9967378050112038, 'loss_val': 0.11334618234072903, 'psi': 0.9952950559162599}
[S10] START round=32 head_norm_before_train=1.496341 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993889060742892, 'loss_val': 0.08873524474490208, 'psi': 0.9946683277087816}-{'f1_val': 0.9951878390193748, 'auprc': 0.9925996409269174, 'loss_val': 0.04939883411465579, 'psi': 0.9941525597823918}
[S11] START round=32 head_norm_before_train=1.534571 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9898470589560546, 'auprc': 0.9978022488935486, 'loss_val': 0.16930817064451426, 'psi': 0.9930291349310523}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980168562333889, 'loss_val': 0.09442074107171482, 'psi': 0.9971349452015092}
[S13] START round=32 head_norm_before_train=1.166249 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5831726916350994, 'auprc': 0.5842591851030638, 'loss_val': 0.8410567486038013, 'psi': 0.5836072890222852}-{'f1_val': 0.6056303564920141, 'auprc': 0.727776451553837, 'loss_val': 0.7340010681802183, 'psi': 0.6544887945167432}
[S14] START round=32 head_norm_before_train=1.728841 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9929021805400287, 'auprc': 0.9977456176326456, 'loss_val': 0.0740175377930984, 'psi': 0.9948395553770755}-{'f1_val': 0.9970728011695729, 'auprc': 0.9969218853530113, 'loss_val': 0.05349027996278144, 'psi': 0.9970124348429483}
[S15] START round=32 head_norm_before_train=1.848881 cos_to_last_merge=0.9994 (last merge round=30)
[S15] round=32 local utility u=0.003213 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9953004587734962, 'loss_val': 0.04120488336566665, 'psi': 0.9961681845419108}-{'f1_val': 0.9963324108488076, 'auprc': 0.9982577172465209, 'loss_val': 0.05401654147559646, 'psi': 0.9971025334078929}
[S16] START round=32 head_norm_before_train=1.540797 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.8411586470422971, 'auprc': 0.9573479915823326, 'loss_val': 0.833883011442571, 'psi': 0.8876343848583114}-{'f1_val': 0.8551674453528775, 'auprc': 0.965130192904932, 'loss_val': 0.6661826652687767, 'psi': 0.8991525443736992}
[S17] START round=32 head_norm_before_train=1.472492 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.072326 metrics={'f1_val': 0.6155003187827186, 'auprc': 0.7720303011078375, 'loss_val': 0.858693495343741, 'psi': 0.6781123117127662}-{'f1_val': 0.610216651208041, 'auprc': 0.778664909018372, 'loss_val': 0.9915471778608276, 'psi': 0.6775959543321735}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:33211
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:33214
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:33217
[S9] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.5167
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.9971
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=0.9425
[S11] RECEIVED delta(kind=head bytes=1804) from S15
[S11] cosine check vs S15: cos=0.9502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.5701
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.8814 head_norm=1.269780
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.548584e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.5857 head_norm=1.235341 delta_norm=0.654858
[S3] aggregate: ROLLBACK (f1_val pre=0.881 post=0.586 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9898 head_norm=1.570294
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.137961e-01
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9861 head_norm=1.706392 delta_norm=0.313796
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9952 head_norm=1.564337
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.619757e-01
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9952 head_norm=1.513003 delta_norm=0.261976
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9929 head_norm=1.754205
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.352045e-02
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9927 head_norm=1.719134 delta_norm=0.073520
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6155 head_norm=1.515741
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.994523e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.5984 head_norm=1.229493 delta_norm=0.699452
[S17] aggregate: ROLLBACK (f1_val pre=0.616 post=0.598 tol_abs=0.005 tol_rel=0.0)
[S2] START round=33 head_norm_before_train=1.853463 cos_to_last_merge=0.7921 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=33 local utility u=0.777472 metrics={'f1_val': 0.7095933961666887, 'auprc': 0.9527660377410125, 'loss_val': 0.5772386763810818, 'psi': 0.8068624527964182}-{'f1_val': 0.6195067746139001, 'auprc': 0.780453150182453, 'loss_val': 1.074724175727805, 'psi': 0.6838853248413213}
[S3] START round=33 head_norm_before_train=1.235341 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.5244790156855073, 'auprc': 0.9659245885215499, 'loss_val': 0.6050471942550827, 'psi': 0.7010572448199244}-{'f1_val': 0.8813905750454651, 'auprc': 0.9992978712677211, 'loss_val': 0.38711475787580973, 'psi': 0.9285534935343676}
[S4] START round=33 head_norm_before_train=1.506144 cos_to_last_merge=0.9884 (last merge round=30)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.947727403903514, 'auprc': 0.93934011413697, 'loss_val': 0.26652252098478857, 'psi': 0.9443724879968963}-{'f1_val': 0.9514564409341251, 'auprc': 0.950507126936627, 'loss_val': 0.26214288187358403, 'psi': 0.9510767153351258}
[S5] START round=33 head_norm_before_train=1.503285 cos_to_last_merge=0.7974 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=33 local utility u=0.031631 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9922222760144666, 'loss_val': 0.24820935734666255, 'psi': 0.8170817008661349}-{'f1_val': 0.700320598491359, 'auprc': 0.9789203964437185, 'loss_val': 0.2715605497209201, 'psi': 0.8117605176723028}
[S6] START round=33 head_norm_before_train=1.688108 cos_to_last_merge=0.8341 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=33 local utility u=0.603626 metrics={'f1_val': 0.780767694427277, 'auprc': 0.961542926879648, 'loss_val': 0.604800354080387, 'psi': 0.8530777874082254}-{'f1_val': 0.6194127586008823, 'auprc': 0.9354218810041892, 'loss_val': 0.76556038215183, 'psi': 0.7458164075622051}
[S7] START round=33 head_norm_before_train=1.686541 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5593442601767068, 'auprc': 0.7824851512602726, 'loss_val': 0.7990219273088611, 'psi': 0.6486006166101331}-{'f1_val': 0.6396548181251847, 'auprc': 0.7951561808768814, 'loss_val': 0.5623007288034689, 'psi': 0.7018553632258633}
[S8] START round=33 head_norm_before_train=2.081229 (no previous merge yet)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9923077140383828, 'auprc': 0.9988294700134777, 'loss_val': 0.031116829811587088, 'psi': 0.9949164164284208}-{'f1_val': 0.9937709050739206, 'auprc': 0.9988377561277645, 'loss_val': 0.031159176555399685, 'psi': 0.9957976454954581}
[S9] START round=33 head_norm_before_train=1.305488 cos_to_last_merge=0.9972 (last merge round=30)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9975186750741101, 'loss_val': 0.07681784334993493, 'psi': 0.9943484615291736}-{'f1_val': 0.9947496160742828, 'auprc': 0.9971416246670536, 'loss_val': 0.08876263808623731, 'psi': 0.9957064195113912}
[S10] START round=33 head_norm_before_train=1.513003 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9901888796308745, 'loss_val': 0.10554923850717227, 'psi': 0.9931882552639746}-{'f1_val': 0.9951878390193748, 'auprc': 0.993889060742892, 'loss_val': 0.08873524474490208, 'psi': 0.9946683277087816}
[S11] START round=33 head_norm_before_train=1.706392 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.029175 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997887353877355, 'loss_val': 0.1499623401621444, 'psi': 0.9969380420322587}-{'f1_val': 0.9898470589560546, 'auprc': 0.9978022488935486, 'loss_val': 0.16930817064451426, 'psi': 0.9930291349310523}
[S13] START round=33 head_norm_before_train=1.209945 cos_to_last_merge=0.9981 (last merge round=31)
[S13] round=33 local utility u=0.286920 metrics={'f1_val': 0.6070560082324667, 'auprc': 0.7047904397410937, 'loss_val': 0.7721100378626359, 'psi': 0.6461497808359176}-{'f1_val': 0.5831726916350994, 'auprc': 0.5842591851030638, 'loss_val': 0.8410567486038013, 'psi': 0.5836072890222852}
[S14] START round=33 head_norm_before_train=1.719134 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.019546 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9983913653574261, 'loss_val': 0.06289276898473543, 'psi': 0.9977007601664463}-{'f1_val': 0.9929021805400287, 'auprc': 0.9977456176326456, 'loss_val': 0.0740175377930984, 'psi': 0.9948395553770755}
[S15] START round=33 head_norm_before_train=1.885381 cos_to_last_merge=0.9981 (last merge round=30)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.700833884979711, 'auprc': 0.9441497039535042, 'loss_val': 0.5766644153955586, 'psi': 0.7981602125692282}-{'f1_val': 0.9967466683875206, 'auprc': 0.9953004587734962, 'loss_val': 0.04120488336566665, 'psi': 0.9961681845419108}
[S16] START round=33 head_norm_before_train=1.570848 cos_to_last_merge=0.9996 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8251963846134704, 'auprc': 0.9049191583231406, 'loss_val': 1.0056732646515445, 'psi': 0.8570854940973385}-{'f1_val': 0.8411586470422971, 'auprc': 0.9573479915823326, 'loss_val': 0.833883011442571, 'psi': 0.8876343848583114}
[S17] START round=33 head_norm_before_train=1.229493 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5480199864468791, 'auprc': 0.5555825167971788, 'loss_val': 1.163764948172616, 'psi': 0.551044998586999}-{'f1_val': 0.6155003187827186, 'auprc': 0.7720303011078375, 'loss_val': 0.858693495343741, 'psi': 0.6781123117127662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:33213
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.9233
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=0.7343
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=0.4326
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9850
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.0930
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9909
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=33 metric=0.7008 head_norm=1.919122
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.812159e-01
[S15] stored merged vector for next round verification (round=33)
[S15] DEBUG after merge:  round=33 metric=0.7008 head_norm=1.824519 delta_norm=0.181216
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9477 head_norm=1.563993
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.143595e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9477 head_norm=1.384092 delta_norm=0.314359
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9963 head_norm=1.739686
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.158507e+00
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9963 head_norm=1.271770 delta_norm=1.158507
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.6071 head_norm=1.258169
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.332475e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5993 head_norm=1.192854 delta_norm=0.333247
[S13] aggregate: ROLLBACK (f1_val pre=0.607 post=0.599 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8252 head_norm=1.598960
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.135851e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8248 head_norm=1.551725 delta_norm=0.113585
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.867389 cos_to_last_merge=0.7903 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7081135419808036, 'auprc': 0.8252509340904546, 'loss_val': 0.6176036784884859, 'psi': 0.7549684988246639}-{'f1_val': 0.7095933961666887, 'auprc': 0.9527660377410125, 'loss_val': 0.5772386763810818, 'psi': 0.8068624527964182}
[S3] START round=34 head_norm_before_train=1.270754 cos_to_last_merge=0.9991 (last merge round=32)
[S3] round=34 local utility u=1.000000 metrics={'f1_val': 0.9890040571642709, 'auprc': 0.9994399316077662, 'loss_val': 0.21572270558688872, 'psi': 0.993178406941669}-{'f1_val': 0.5244790156855073, 'auprc': 0.9659245885215499, 'loss_val': 0.6050471942550827, 'psi': 0.7010572448199244}
[S4] START round=34 head_norm_before_train=1.384092 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.001081 metrics={'f1_val': 0.9412803575714803, 'auprc': 0.9556987107222159, 'loss_val': 0.2747543031369798, 'psi': 0.9470476988317745}-{'f1_val': 0.947727403903514, 'auprc': 0.93934011413697, 'loss_val': 0.26652252098478857, 'psi': 0.9443724879968963}
[S5] START round=34 head_norm_before_train=1.511566 cos_to_last_merge=0.7977 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.7029901120354398, 'auprc': 0.8672592202426944, 'loss_val': 0.37616195914061573, 'psi': 0.7686977553183416}-{'f1_val': 0.7003213174339138, 'auprc': 0.9922222760144666, 'loss_val': 0.24820935734666255, 'psi': 0.8170817008661349}
[S6] START round=34 head_norm_before_train=1.700754 cos_to_last_merge=0.8327 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6241328904288574, 'auprc': 0.9252198546398767, 'loss_val': 0.7201429733099619, 'psi': 0.7445676761132651}-{'f1_val': 0.780767694427277, 'auprc': 0.961542926879648, 'loss_val': 0.604800354080387, 'psi': 0.8530777874082254}
[S7] START round=34 head_norm_before_train=1.694463 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.554350374461527, 'auprc': 0.78333439429414, 'loss_val': 0.7927592070053806, 'psi': 0.6459439823945723}-{'f1_val': 0.5593442601767068, 'auprc': 0.7824851512602726, 'loss_val': 0.7990219273088611, 'psi': 0.6486006166101331}
[S8] START round=34 head_norm_before_train=2.088735 (no previous merge yet)
[S8] round=34 local utility u=0.006593 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9989390137203655, 'loss_val': 0.02924178620507011, 'psi': 0.996058461650831}-{'f1_val': 0.9923077140383828, 'auprc': 0.9988294700134777, 'loss_val': 0.031116829811587088, 'psi': 0.9949164164284208}
[S9] START round=34 head_norm_before_train=1.339227 cos_to_last_merge=0.9947 (last merge round=30)
[S9] round=34 local utility u=0.016615 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9946797801274816, 'loss_val': 0.061624212664830126, 'psi': 0.9958682191393275}-{'f1_val': 0.9922349858325491, 'auprc': 0.9975186750741101, 'loss_val': 0.07681784334993493, 'psi': 0.9943484615291736}
[S10] START round=34 head_norm_before_train=1.595163 cos_to_last_merge=0.9968 (last merge round=32)
[S10] round=34 local utility u=0.022738 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9911557679223997, 'loss_val': 0.06297370343234424, 'psi': 0.9935750105805847}-{'f1_val': 0.9951878390193748, 'auprc': 0.9901888796308745, 'loss_val': 0.10554923850717227, 'psi': 0.9931882552639746}
[S11] START round=34 head_norm_before_train=1.271770 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.019200 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975778533140498, 'loss_val': 0.11208552488249887, 'psi': 0.9969593440337736}-{'f1_val': 0.996305167468861, 'auprc': 0.997887353877355, 'loss_val': 0.1499623401621444, 'psi': 0.9969380420322587}
[S13] START round=34 head_norm_before_train=1.192854 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.159590 metrics={'f1_val': 0.6635352845171155, 'auprc': 0.6576888585711013, 'loss_val': 0.6505002569143603, 'psi': 0.6611967141387098}-{'f1_val': 0.6070560082324667, 'auprc': 0.7047904397410937, 'loss_val': 0.7721100378626359, 'psi': 0.6461497808359176}
[S14] START round=34 head_norm_before_train=1.743672 cos_to_last_merge=0.9998 (last merge round=32)
[S14] round=34 local utility u=0.002352 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9969260610738936, 'loss_val': 0.0552489046689946, 'psi': 0.99726027105945}-{'f1_val': 0.997240356705793, 'auprc': 0.9983913653574261, 'loss_val': 0.06289276898473543, 'psi': 0.9977007601664463}
[S15] START round=34 head_norm_before_train=1.824519 cos_to_last_merge=1.0000 (last merge round=33)
[S15] round=34 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9969645380233081, 'loss_val': 0.04516574425138375, 'psi': 0.9968338162418355}-{'f1_val': 0.700833884979711, 'auprc': 0.9441497039535042, 'loss_val': 0.5766644153955586, 'psi': 0.7981602125692282}
[S16] START round=34 head_norm_before_train=1.551725 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.821889 metrics={'f1_val': 0.9390255064036115, 'auprc': 0.968013978574767, 'loss_val': 0.2341538884309815, 'psi': 0.9506208952720737}-{'f1_val': 0.8251963846134704, 'auprc': 0.9049191583231406, 'loss_val': 1.0056732646515445, 'psi': 0.8570854940973385}
[S17] START round=34 head_norm_before_train=1.279141 cos_to_last_merge=0.9987 (last merge round=32)
[S17] round=34 local utility u=0.601543 metrics={'f1_val': 0.617816562106547, 'auprc': 0.7889252848446773, 'loss_val': 1.0794858851818583, 'psi': 0.6862600512017991}-{'f1_val': 0.5480199864468791, 'auprc': 0.5555825167971788, 'loss_val': 1.163764948172616, 'psi': 0.551044998586999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:33203
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:33210
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:33211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:33217
[S14] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → trigger blocked (psi=0.661)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:33212
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S4
[S10] cosine check vs S4: cos=0.9468
[S11] RECEIVED delta(kind=head bytes=1803) from S15
[S11] cosine check vs S15: cos=0.6246
[S9] RECEIVED delta(kind=head bytes=1799) from S3
[S9] cosine check vs S3: cos=0.8207
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.4242
[S3] RECEIVED delta(kind=head bytes=1796) from S10
[S3] cosine check vs S10: cos=0.5805
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.6778
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.8390
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:33203
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.9799
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9965 head_norm=1.319415
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.286209e-01
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9965 head_norm=1.435063 delta_norm=0.728621
[S11] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9952 head_norm=1.678521
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.791686e-01
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9952 head_norm=1.542057 delta_norm=0.279169
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9890 head_norm=1.308171
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.273748e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9953 head_norm=1.264640 delta_norm=0.327375
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9967 head_norm=1.368627
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.017961e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9967 head_norm=1.277022 delta_norm=0.401796
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.6178 head_norm=1.333577
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.540254e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.6183 head_norm=1.212994 delta_norm=0.254025
[S17] aggregate: ACCEPT kept=['S16', 'S8', 'S9'] (k=3/3) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.880015 cos_to_last_merge=0.7888 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6929420662337866, 'auprc': 0.7967630900325238, 'loss_val': 0.6918050580498343, 'psi': 0.7344704757532815}-{'f1_val': 0.7081135419808036, 'auprc': 0.8252509340904546, 'loss_val': 0.6176036784884859, 'psi': 0.7549684988246639}
[S3] START round=35 head_norm_before_train=1.264640 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.8393474755128641, 'auprc': 0.9952640822656927, 'loss_val': 0.3914963532186211, 'psi': 0.9017141182139956}-{'f1_val': 0.9890040571642709, 'auprc': 0.9994399316077662, 'loss_val': 0.21572270558688872, 'psi': 0.993178406941669}
[S4] START round=35 head_norm_before_train=1.447177 cos_to_last_merge=0.9985 (last merge round=33)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9392515803451688, 'auprc': 0.9194731475149904, 'loss_val': 0.27772935489987727, 'psi': 0.9313402072130974}-{'f1_val': 0.9412803575714803, 'auprc': 0.9556987107222159, 'loss_val': 0.2747543031369798, 'psi': 0.9470476988317745}
[S5] START round=35 head_norm_before_train=1.518892 cos_to_last_merge=0.7966 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=35 local utility u=0.263787 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9947308842077678, 'loss_val': 0.216472703277273, 'psi': 0.8182334596858982}-{'f1_val': 0.7029901120354398, 'auprc': 0.8672592202426944, 'loss_val': 0.37616195914061573, 'psi': 0.7686977553183416}
[S6] START round=35 head_norm_before_train=1.711851 cos_to_last_merge=0.8314 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=35 local utility u=0.436084 metrics={'f1_val': 0.7534482859766436, 'auprc': 0.9450407386653193, 'loss_val': 0.683329230588911, 'psi': 0.8300852670521139}-{'f1_val': 0.6241328904288574, 'auprc': 0.9252198546398767, 'loss_val': 0.7201429733099619, 'psi': 0.7445676761132651}
[S7] START round=35 head_norm_before_train=1.700467 (no previous merge yet)
[S7] round=35 local utility u=0.215511 metrics={'f1_val': 0.5995399459840681, 'auprc': 0.7895933057578222, 'loss_val': 0.6516521776630253, 'psi': 0.6755612898935697}-{'f1_val': 0.554350374461527, 'auprc': 0.78333439429414, 'loss_val': 0.7927592070053806, 'psi': 0.6459439823945723}
[S8] START round=35 head_norm_before_train=2.101802 (no previous merge yet)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9934042750107773, 'auprc': 0.9989005110922855, 'loss_val': 0.02890749715619066, 'psi': 0.9956027694433806}-{'f1_val': 0.9941380936044745, 'auprc': 0.9989390137203655, 'loss_val': 0.02924178620507011, 'psi': 0.996058461650831}
[S9] START round=35 head_norm_before_train=1.277022 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9909317508950798, 'auprc': 0.9978739229506292, 'loss_val': 0.09236814378788664, 'psi': 0.9937086197172995}-{'f1_val': 0.9966605118138915, 'auprc': 0.9946797801274816, 'loss_val': 0.061624212664830126, 'psi': 0.9958682191393275}
[S10] START round=35 head_norm_before_train=1.542057 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955625052096363, 'loss_val': 0.0834925502497515, 'psi': 0.9953377054954793}-{'f1_val': 0.9951878390193748, 'auprc': 0.9911557679223997, 'loss_val': 0.06297370343234424, 'psi': 0.9935750105805847}
[S11] START round=35 head_norm_before_train=1.435063 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975160210457654, 'loss_val': 0.13303570732142583, 'psi': 0.9969346111264599}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975778533140498, 'loss_val': 0.11208552488249887, 'psi': 0.9969593440337736}
[S13] START round=35 head_norm_before_train=1.248762 cos_to_last_merge=0.9978 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.6397641469196024, 'auprc': 0.7905568472331049, 'loss_val': 0.997099689136745, 'psi': 0.7000812270450034}-{'f1_val': 0.6635352845171155, 'auprc': 0.6576888585711013, 'loss_val': 0.6505002569143603, 'psi': 0.6611967141387098}
[S14] START round=35 head_norm_before_train=1.769721 cos_to_last_merge=0.9990 (last merge round=32)
[S14] round=35 local utility u=0.004004 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9986684234372107, 'loss_val': 0.04956237868809557, 'psi': 0.9976666337955051}-{'f1_val': 0.9974830777164877, 'auprc': 0.9969260610738936, 'loss_val': 0.0552489046689946, 'psi': 0.99726027105945}
[S15] START round=35 head_norm_before_train=1.854651 cos_to_last_merge=0.9997 (last merge round=33)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9176105571326671, 'auprc': 0.9982615363722074, 'loss_val': 0.13601460837055313, 'psi': 0.9498709488284832}-{'f1_val': 0.9967466683875206, 'auprc': 0.9969645380233081, 'loss_val': 0.04516574425138375, 'psi': 0.9968338162418355}
[S16] START round=35 head_norm_before_train=1.577215 cos_to_last_merge=0.9997 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9171696432340196, 'auprc': 0.9830110331213728, 'loss_val': 0.38595523773179824, 'psi': 0.943506199188961}-{'f1_val': 0.9390255064036115, 'auprc': 0.968013978574767, 'loss_val': 0.2341538884309815, 'psi': 0.9506208952720737}
[S17] START round=35 head_norm_before_train=1.212994 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5475432982254871, 'auprc': 0.7069628318696255, 'loss_val': 1.21215052469553, 'psi': 0.6113111116831424}-{'f1_val': 0.617816562106547, 'auprc': 0.7889252848446773, 'loss_val': 1.0794858851818583, 'psi': 0.6862600512017991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:33216
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:33212
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:33214
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=0.9916
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9948
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9931
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.3111
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.016 → S17@127.0.0.1:33217
[S2] ⇄ pheromone p=0.152 → S13@127.0.0.1:33213
[S3] ⇄ pheromone p=0.260 → S9@127.0.0.1:33210
[S13] ⇄ pheromone p=0.105 → S4@127.0.0.1:33204
[S4] ⇄ pheromone p=0.015 → S10@127.0.0.1:33211
[S9] ⇄ pheromone p=0.011 → S17@127.0.0.1:33217
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=35 metric=0.9176 head_norm=1.884037
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.275715e-01
[S15] stored merged vector for next round verification (round=35)
[S15] DEBUG after merge:  round=35 metric=0.9182 head_norm=1.835223 delta_norm=0.127571
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.309 → S11@127.0.0.1:33212
[S10] ⇄ pheromone p=0.009 → S3@127.0.0.1:33203
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9965 head_norm=1.472530
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.422427e-01
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9965 head_norm=1.294599 delta_norm=0.942243
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.022 → S13@127.0.0.1:33213
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9970 head_norm=1.794168
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.978899e-02
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9970 head_norm=1.747334 delta_norm=0.099789
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.027 → S15@127.0.0.1:33215
[S6] ⇄ pheromone p=0.253 → S11@127.0.0.1:33212
[S7] ⇄ pheromone p=0.210 → S14@127.0.0.1:33214
[S5] ⇄ pheromone p=0.118 → S16@127.0.0.1:33216
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=35 metric=0.9172 head_norm=1.604046
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.966151e-02
[S16] stored merged vector for next round verification (round=35)
[S16] DEBUG after merge:  round=35 metric=0.9176 head_norm=1.563173 delta_norm=0.099662
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.175 → S17@127.0.0.1:33217
[S17] ⇄ pheromone p=0.181 → S3@127.0.0.1:33203
[S2] START round=36 head_norm_before_train=1.896048 cos_to_last_merge=0.7874 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=36 local utility u=0.109712 metrics={'f1_val': 0.7054748212828525, 'auprc': 0.8122178583386634, 'loss_val': 0.5939420942561118, 'psi': 0.7481720361051769}-{'f1_val': 0.6929420662337866, 'auprc': 0.7967630900325238, 'loss_val': 0.6918050580498343, 'psi': 0.7344704757532815}
[S3] START round=36 head_norm_before_train=1.302526 cos_to_last_merge=0.9991 (last merge round=34)
[S3] round=36 local utility u=0.476818 metrics={'f1_val': 0.9681088552492275, 'auprc': 0.9997586954630576, 'loss_val': 0.22391162384120017, 'psi': 0.9807687913347596}-{'f1_val': 0.8393474755128641, 'auprc': 0.9952640822656927, 'loss_val': 0.3914963532186211, 'psi': 0.9017141182139956}
[S4] START round=36 head_norm_before_train=1.496064 cos_to_last_merge=0.9957 (last merge round=33)
[S4] round=36 local utility u=0.029876 metrics={'f1_val': 0.9421623856959196, 'auprc': 0.9309238284938317, 'loss_val': 0.2697933221430969, 'psi': 0.9376669628150844}-{'f1_val': 0.9392515803451688, 'auprc': 0.9194731475149904, 'loss_val': 0.27772935489987727, 'psi': 0.9313402072130974}
[S5] START round=36 head_norm_before_train=1.527718 cos_to_last_merge=0.7944 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.5709886854585927, 'auprc': 0.7899577206006261, 'loss_val': 0.8954240101095803, 'psi': 0.6585762995154061}-{'f1_val': 0.7005685100046517, 'auprc': 0.9947308842077678, 'loss_val': 0.216472703277273, 'psi': 0.8182334596858982}
[S6] START round=36 head_norm_before_train=1.720254 cos_to_last_merge=0.8302 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=36 local utility u=0.735148 metrics={'f1_val': 0.9057519182026792, 'auprc': 0.9726324963534863, 'loss_val': 0.20963031811739521, 'psi': 0.932504149463002}-{'f1_val': 0.7534482859766436, 'auprc': 0.9450407386653193, 'loss_val': 0.683329230588911, 'psi': 0.8300852670521139}
[S7] START round=36 head_norm_before_train=1.705060 (no previous merge yet)
[S7] round=36 local utility u=0.239410 metrics={'f1_val': 0.6427605806031218, 'auprc': 0.8043609234578394, 'loss_val': 0.4764584687047981, 'psi': 0.7074007177450088}-{'f1_val': 0.5995399459840681, 'auprc': 0.7895933057578222, 'loss_val': 0.6516521776630253, 'psi': 0.6755612898935697}
[S8] START round=36 head_norm_before_train=2.113280 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986149446392547, 'loss_val': 0.030041690976693503, 'psi': 0.9956211801243998}-{'f1_val': 0.9934042750107773, 'auprc': 0.9989005110922855, 'loss_val': 0.02890749715619066, 'psi': 0.9956027694433806}
[S9] START round=36 head_norm_before_train=1.305420 cos_to_last_merge=0.9997 (last merge round=34)
[S9] round=36 local utility u=0.027948 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9976738092401292, 'loss_val': 0.0702447971911477, 'psi': 0.9970658307843865}-{'f1_val': 0.9909317508950798, 'auprc': 0.9978739229506292, 'loss_val': 0.09236814378788664, 'psi': 0.9937086197172995}
[S10] START round=36 head_norm_before_train=1.619316 cos_to_last_merge=0.9977 (last merge round=34)
[S10] round=36 local utility u=0.002604 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9921018416656004, 'loss_val': 0.06537368396377818, 'psi': 0.9937006268917575}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955625052096363, 'loss_val': 0.0834925502497515, 'psi': 0.9953377054954793}
[S11] START round=36 head_norm_before_train=1.294599 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.013177 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976700334532533, 'loss_val': 0.10714363913257298, 'psi': 0.9969962160894551}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975160210457654, 'loss_val': 0.13303570732142583, 'psi': 0.9969346111264599}
[S13] START round=36 head_norm_before_train=1.286855 cos_to_last_merge=0.9946 (last merge round=33)
[S13] round=36 local utility u=0.342727 metrics={'f1_val': 0.7060011503863849, 'auprc': 0.7373973566308851, 'loss_val': 0.549589413305045, 'psi': 0.718559632884185}-{'f1_val': 0.6397641469196024, 'auprc': 0.7905568472331049, 'loss_val': 0.997099689136745, 'psi': 0.7000812270450034}
[S14] START round=36 head_norm_before_train=1.747334 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9972408627570057, 'auprc': 0.9986637657482522, 'loss_val': 0.053465038954332814, 'psi': 0.9978100239535043}-{'f1_val': 0.9969987740343681, 'auprc': 0.9986684234372107, 'loss_val': 0.04956237868809557, 'psi': 0.9976666337955051}
[S15] START round=36 head_norm_before_train=1.835223 cos_to_last_merge=1.0000 (last merge round=35)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8898509057939352, 'auprc': 0.9953932988970375, 'loss_val': 0.2313223820852966, 'psi': 0.9320678630351762}-{'f1_val': 0.9176105571326671, 'auprc': 0.9982615363722074, 'loss_val': 0.13601460837055313, 'psi': 0.9498709488284832}
[S16] START round=36 head_norm_before_train=1.563173 cos_to_last_merge=1.0000 (last merge round=35)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8221351897642769, 'auprc': 0.8456565941605364, 'loss_val': 1.0480623439178867, 'psi': 0.8315437515227807}-{'f1_val': 0.9171696432340196, 'auprc': 0.9830110331213728, 'loss_val': 0.38595523773179824, 'psi': 0.943506199188961}
[S17] START round=36 head_norm_before_train=1.266039 cos_to_last_merge=0.9987 (last merge round=34)
[S17] round=36 local utility u=0.013630 metrics={'f1_val': 0.5472513626161705, 'auprc': 0.6857743746711534, 'loss_val': 1.1195732520895767, 'psi': 0.6026605674381637}-{'f1_val': 0.5475432982254871, 'auprc': 0.7069628318696255, 'loss_val': 1.21215052469553, 'psi': 0.6113111116831424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:33215
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.9081
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.5781
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9628
[S15] RECEIVED delta(kind=head bytes=1801) from S11
[S15] cosine check vs S11: cos=0.4875
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9550
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] cosine check vs S4: cos=0.9035
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S17
[S16] cosine check vs S17: cos=0.5551
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=36 metric=0.7055 head_norm=1.907993
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.852906e-01
[S2] stored merged vector for next round verification (round=36)
[S2] DEBUG after merge:  round=36 metric=0.7046 head_norm=1.436158 delta_norm=0.785291
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.8899 head_norm=1.871093
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.441390e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.8899 head_norm=1.390199 delta_norm=0.844139
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=36 metric=0.7060 head_norm=1.310734
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.295836e-01
[S13] stored merged vector for next round verification (round=36)
[S13] DEBUG after merge:  round=36 metric=0.7075 head_norm=1.385433 delta_norm=0.329584
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=36 metric=0.9681 head_norm=1.341418
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.007721e-01
[S3] stored merged vector for next round verification (round=36)
[S3] DEBUG after merge:  round=36 metric=0.9647 head_norm=1.323742 delta_norm=0.200772
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9422 head_norm=1.529077
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.333571e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9422 head_norm=1.594462 delta_norm=0.233357
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.8221 head_norm=1.588962
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.952365e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.8226 head_norm=1.281536 delta_norm=0.695237
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.5473 head_norm=1.313992
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.849734e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.5499 head_norm=1.296834 delta_norm=0.284973
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.436158 cos_to_last_merge=1.0000 (last merge round=36)
[S2] round=37 local utility u=0.102588 metrics={'f1_val': 0.7094148470195966, 'auprc': 0.8408385363646365, 'loss_val': 0.49826895996873083, 'psi': 0.7619843227576125}-{'f1_val': 0.7054748212828525, 'auprc': 0.8122178583386634, 'loss_val': 0.5939420942561118, 'psi': 0.7481720361051769}
[S3] START round=37 head_norm_before_train=1.323742 cos_to_last_merge=1.0000 (last merge round=36)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8868697533001353, 'auprc': 0.9995132826916638, 'loss_val': 0.28823542112179007, 'psi': 0.9319271650567467}-{'f1_val': 0.9681088552492275, 'auprc': 0.9997586954630576, 'loss_val': 0.22391162384120017, 'psi': 0.9807687913347596}
[S4] START round=37 head_norm_before_train=1.594462 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9173268125442643, 'auprc': 0.917695271953361, 'loss_val': 0.4101799894230605, 'psi': 0.917474196307903}-{'f1_val': 0.9421623856959196, 'auprc': 0.9309238284938317, 'loss_val': 0.2697933221430969, 'psi': 0.9376669628150844}
[S5] START round=37 head_norm_before_train=1.539055 cos_to_last_merge=0.7934 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9896058562138497, 'loss_val': 0.23880437357155734, 'psi': 0.8160347015803553}-{'f1_val': 0.5709886854585927, 'auprc': 0.7899577206006261, 'loss_val': 0.8954240101095803, 'psi': 0.6585762995154061}
[S6] START round=37 head_norm_before_train=1.731461 cos_to_last_merge=0.8290 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.829
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.6221091102181806, 'auprc': 0.9385600128852836, 'loss_val': 0.8802987786623965, 'psi': 0.7486894712850218}-{'f1_val': 0.9057519182026792, 'auprc': 0.9726324963534863, 'loss_val': 0.20963031811739521, 'psi': 0.932504149463002}
[S7] START round=37 head_norm_before_train=1.708643 (no previous merge yet)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.5559129969976175, 'auprc': 0.7833479620629227, 'loss_val': 0.7602501497207135, 'psi': 0.6468869830237396}-{'f1_val': 0.6427605806031218, 'auprc': 0.8043609234578394, 'loss_val': 0.4764584687047981, 'psi': 0.7074007177450088}
[S8] START round=37 head_norm_before_train=2.120599 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9923077140383828, 'auprc': 0.9987625845107793, 'loss_val': 0.029408856979406733, 'psi': 0.9948896622273413}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986149446392547, 'loss_val': 0.030041690976693503, 'psi': 0.9956211801243998}
[S9] START round=37 head_norm_before_train=1.336339 cos_to_last_merge=0.9987 (last merge round=34)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9946201834797136, 'loss_val': 0.06079228234383977, 'psi': 0.995598130259452}-{'f1_val': 0.9966605118138915, 'auprc': 0.9976738092401292, 'loss_val': 0.0702447971911477, 'psi': 0.9970658307843865}
[S10] START round=37 head_norm_before_train=1.689809 cos_to_last_merge=0.9929 (last merge round=34)
[S10] round=37 local utility u=0.009747 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9932341662028401, 'loss_val': 0.05048785088225317, 'psi': 0.9942745784001817}-{'f1_val': 0.9947664837091956, 'auprc': 0.9921018416656004, 'loss_val': 0.06537368396377818, 'psi': 0.9937006268917575}
[S11] START round=37 head_norm_before_train=1.337705 cos_to_last_merge=0.9987 (last merge round=35)
[S11] round=37 local utility u=0.009306 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974693752491314, 'loss_val': 0.08792881443949707, 'psi': 0.9969159528078063}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976700334532533, 'loss_val': 0.10714363913257298, 'psi': 0.9969962160894551}
[S13] START round=37 head_norm_before_train=1.385433 cos_to_last_merge=1.0000 (last merge round=36)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.599522356929581, 'auprc': 0.7543829402258736, 'loss_val': 1.0724875375586183, 'psi': 0.6614665902480981}-{'f1_val': 0.7060011503863849, 'auprc': 0.7373973566308851, 'loss_val': 0.549589413305045, 'psi': 0.718559632884185}
[S14] START round=37 head_norm_before_train=1.768741 cos_to_last_merge=0.9998 (last merge round=35)
[S14] round=37 local utility u=0.004781 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9985065707529005, 'loss_val': 0.0458930744091193, 'psi': 0.9979932991310724}-{'f1_val': 0.9972408627570057, 'auprc': 0.9986637657482522, 'loss_val': 0.053465038954332814, 'psi': 0.9978100239535043}
[S15] START round=37 head_norm_before_train=1.390199 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.403835 metrics={'f1_val': 0.9967036286230888, 'auprc': 0.9986235799914106, 'loss_val': 0.0744594392662293, 'psi': 0.9974716091704176}-{'f1_val': 0.8898509057939352, 'auprc': 0.9953932988970375, 'loss_val': 0.2313223820852966, 'psi': 0.9320678630351762}
[S16] START round=37 head_norm_before_train=1.281536 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.587980 metrics={'f1_val': 0.8693185465713181, 'auprc': 0.9784870439486528, 'loss_val': 0.5536933629911851, 'psi': 0.912985945522252}-{'f1_val': 0.8221351897642769, 'auprc': 0.8456565941605364, 'loss_val': 1.0480623439178867, 'psi': 0.8315437515227807}
[S17] START round=37 head_norm_before_train=1.296834 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.003844 metrics={'f1_val': 0.5920422105410444, 'auprc': 0.6220051095172434, 'loss_val': 1.1893219192707294, 'psi': 0.6040273701315241}-{'f1_val': 0.5472513626161705, 'auprc': 0.6857743746711534, 'loss_val': 1.1195732520895767, 'psi': 0.6026605674381637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:33204
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:33205
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S10
[S4] cosine check vs S10: cos=0.9868
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.8017
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.8958
[S5] RECEIVED delta(kind=head bytes=1805) from S16
[S5] cosine check vs S16: cos=0.8979
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S17
[S16] cosine check vs S17: cos=0.7649
[S14] sending update (kind=head size=1806 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1806) from S14
[S7] cosine check vs S14: cos=0.9962
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.5559 head_norm=1.712428
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.637313e-02
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.5607 head_norm=1.750698 delta_norm=0.086373
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9173 head_norm=1.621121
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.500375e-01
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9147 head_norm=1.677122 delta_norm=0.150037
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=37 metric=0.9967 head_norm=1.458483
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.483431e-01
[S15] stored merged vector for next round verification (round=37)
[S15] DEBUG after merge:  round=37 metric=0.9967 head_norm=1.346723 delta_norm=0.448343
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=37 metric=0.7003 head_norm=1.546951
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.427306e-01
[S5] stored merged vector for next round verification (round=37)
[S5] DEBUG after merge:  round=37 metric=0.7003 head_norm=1.392299 delta_norm=0.342731
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.8693 head_norm=1.311054
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.522709e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.8704 head_norm=1.239080 delta_norm=0.452271
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9977 head_norm=1.792316
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.050944e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9977 head_norm=1.582935 delta_norm=0.405094
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.475740 cos_to_last_merge=0.9996 (last merge round=36)
[S2] round=38 local utility u=0.020302 metrics={'f1_val': 0.7095959163164629, 'auprc': 0.8593212161772628, 'loss_val': 0.5141984892499321, 'psi': 0.7694860362607829}-{'f1_val': 0.7094148470195966, 'auprc': 0.8408385363646365, 'loss_val': 0.49826895996873083, 'psi': 0.7619843227576125}
[S3] START round=38 head_norm_before_train=1.360487 cos_to_last_merge=0.9995 (last merge round=36)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.7015651383420595, 'auprc': 0.9674993973063901, 'loss_val': 0.6750351384786758, 'psi': 0.8079388419277918}-{'f1_val': 0.8868697533001353, 'auprc': 0.9995132826916638, 'loss_val': 0.28823542112179007, 'psi': 0.9319271650567467}
[S4] START round=38 head_norm_before_train=1.677122 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.033436 metrics={'f1_val': 0.9231158851565383, 'auprc': 0.9200332974359935, 'loss_val': 0.38505604581227276, 'psi': 0.9218828500683205}-{'f1_val': 0.9173268125442643, 'auprc': 0.917695271953361, 'loss_val': 0.4101799894230605, 'psi': 0.917474196307903}
[S5] START round=38 head_norm_before_train=1.392299 cos_to_last_merge=1.0000 (last merge round=37)
[S5] round=38 local utility u=0.019942 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9919193511205453, 'loss_val': 0.2058610580981738, 'psi': 0.8169600995430335}-{'f1_val': 0.700320598491359, 'auprc': 0.9896058562138497, 'loss_val': 0.23880437357155734, 'psi': 0.8160347015803553}
[S6] START round=38 head_norm_before_train=1.739964 cos_to_last_merge=0.8278 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=38 local utility u=0.753204 metrics={'f1_val': 0.8132107103262975, 'auprc': 0.9638007162472373, 'loss_val': 0.5962219955271213, 'psi': 0.8734467126946734}-{'f1_val': 0.6221091102181806, 'auprc': 0.9385600128852836, 'loss_val': 0.8802987786623965, 'psi': 0.7486894712850218}
[S7] START round=38 head_norm_before_train=1.750698 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5541819702638505, 'auprc': 0.7832800524477797, 'loss_val': 0.7783448020523995, 'psi': 0.6458212031374222}-{'f1_val': 0.5559129969976175, 'auprc': 0.7833479620629227, 'loss_val': 0.7602501497207135, 'psi': 0.6468869830237396}
[S8] START round=38 head_norm_before_train=2.129055 (no previous merge yet)
[S8] round=38 local utility u=0.005364 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9989607927806385, 'loss_val': 0.028053979537980025, 'psi': 0.9958468601566077}-{'f1_val': 0.9923077140383828, 'auprc': 0.9987625845107793, 'loss_val': 0.029408856979406733, 'psi': 0.9948896622273413}
[S9] START round=38 head_norm_before_train=1.364491 cos_to_last_merge=0.9973 (last merge round=34)
[S9] round=38 local utility u=0.010751 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983146745395233, 'loss_val': 0.05283651517954922, 'psi': 0.9973221769041442}-{'f1_val': 0.9962500947792776, 'auprc': 0.9946201834797136, 'loss_val': 0.06079228234383977, 'psi': 0.995598130259452}
[S10] START round=38 head_norm_before_train=1.744267 cos_to_last_merge=0.9887 (last merge round=34)
[S10] round=38 local utility u=0.002308 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9931830871437117, 'loss_val': 0.04440093283123922, 'psi': 0.9941224003891083}-{'f1_val': 0.9949681865317428, 'auprc': 0.9932341662028401, 'loss_val': 0.05048785088225317, 'psi': 0.9942745784001817}
[S11] START round=38 head_norm_before_train=1.379195 cos_to_last_merge=0.9961 (last merge round=35)
[S11] round=38 local utility u=0.007328 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997603663367899, 'loss_val': 0.07367552915744267, 'psi': 0.9969696680553133}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974693752491314, 'loss_val': 0.08792881443949707, 'psi': 0.9969159528078063}
[S13] START round=38 head_norm_before_train=1.399937 cos_to_last_merge=0.9999 (last merge round=36)
[S13] round=38 local utility u=0.563148 metrics={'f1_val': 0.7411283117031806, 'auprc': 0.704223323081301, 'loss_val': 0.6453475241317228, 'psi': 0.7263663162544287}-{'f1_val': 0.599522356929581, 'auprc': 0.7543829402258736, 'loss_val': 1.0724875375586183, 'psi': 0.6614665902480981}
[S14] START round=38 head_norm_before_train=1.582935 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.981960164297736, 'auprc': 0.9986655655042432, 'loss_val': 0.0787772602881373, 'psi': 0.9886423247803389}-{'f1_val': 0.9976511180498535, 'auprc': 0.9985065707529005, 'loss_val': 0.0458930744091193, 'psi': 0.9979932991310724}
[S15] START round=38 head_norm_before_train=1.346723 cos_to_last_merge=1.0000 (last merge round=37)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.9110423648777821, 'auprc': 0.9973826430988674, 'loss_val': 0.18389731867808584, 'psi': 0.9455784761662163}-{'f1_val': 0.9967036286230888, 'auprc': 0.9986235799914106, 'loss_val': 0.0744594392662293, 'psi': 0.9974716091704176}
[S16] START round=38 head_norm_before_train=1.239080 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.358809 metrics={'f1_val': 0.9382033082904144, 'auprc': 0.9858386226016709, 'loss_val': 0.2714394245649483, 'psi': 0.9572574340149169}-{'f1_val': 0.8693185465713181, 'auprc': 0.9784870439486528, 'loss_val': 0.5536933629911851, 'psi': 0.912985945522252}
[S17] START round=38 head_norm_before_train=1.326980 cos_to_last_merge=0.9997 (last merge round=36)
[S17] round=38 local utility u=0.220283 metrics={'f1_val': 0.5983427866845262, 'auprc': 0.7535159922818622, 'loss_val': 1.1810919031154539, 'psi': 0.6604120689234606}-{'f1_val': 0.5920422105410444, 'auprc': 0.6220051095172434, 'loss_val': 1.1893219192707294, 'psi': 0.6040273701315241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:33202
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:33205
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S9] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=0.7454
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9946
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9283
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] cosine check vs S4: cos=0.9471
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9833
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S17
[S16] cosine check vs S17: cos=0.9298
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S16
[S5] cosine check vs S16: cos=0.8444
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=38 metric=0.7096 head_norm=1.522945
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.257544e-01
[S2] stored merged vector for next round verification (round=38)
[S2] DEBUG after merge:  round=38 metric=0.7096 head_norm=1.369824 delta_norm=0.525754
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9231 head_norm=1.704228
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.977643e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9216 head_norm=1.743843 delta_norm=0.099776
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.7411 head_norm=1.409364
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.920012e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.7986 head_norm=1.536257 delta_norm=0.292001
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9382 head_norm=1.282811
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.493418e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9288 head_norm=1.294971 delta_norm=0.249342
[S16] aggregate: ROLLBACK (f1_val pre=0.938 post=0.929 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.7003 head_norm=1.401300
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.786493e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.7003 head_norm=1.288894 delta_norm=0.378649
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.7016 head_norm=1.390502
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.269598e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.6802 head_norm=1.384354 delta_norm=0.126960
[S3] aggregate: ROLLBACK (f1_val pre=0.702 post=0.680 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=38 metric=0.9110 head_norm=1.442285
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.711236e-01
[S15] stored merged vector for next round verification (round=38)
[S15] DEBUG after merge:  round=38 metric=0.9116 head_norm=1.404174 delta_norm=0.271124
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.369824 cos_to_last_merge=1.0000 (last merge round=38)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.6755816590285583, 'auprc': 0.7799379361231871, 'loss_val': 0.6861516264160832, 'psi': 0.7173241698664098}-{'f1_val': 0.7095959163164629, 'auprc': 0.8593212161772628, 'loss_val': 0.5141984892499321, 'psi': 0.7694860362607829}
[S3] START round=39 head_norm_before_train=1.384354 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.790289 metrics={'f1_val': 0.8854684041839203, 'auprc': 0.9956743930203722, 'loss_val': 0.2824024128350061, 'psi': 0.9295507997185011}-{'f1_val': 0.7015651383420595, 'auprc': 0.9674993973063901, 'loss_val': 0.6750351384786758, 'psi': 0.8079388419277918}
[S4] START round=39 head_norm_before_train=1.743843 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.162132 metrics={'f1_val': 0.939966727830748, 'auprc': 0.9662076029064851, 'loss_val': 0.3004195376268195, 'psi': 0.9504630778610428}-{'f1_val': 0.9231158851565383, 'auprc': 0.9200332974359935, 'loss_val': 0.38505604581227276, 'psi': 0.9218828500683205}
[S5] START round=39 head_norm_before_train=1.288894 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6952524479502127, 'auprc': 0.8731536178118474, 'loss_val': 0.44466450976979865, 'psi': 0.7664129158948666}-{'f1_val': 0.700320598491359, 'auprc': 0.9919193511205453, 'loss_val': 0.2058610580981738, 'psi': 0.8169600995430335}
[S6] START round=39 head_norm_before_train=1.755141 cos_to_last_merge=0.8259 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.826
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.712987524032772, 'auprc': 0.937204255415325, 'loss_val': 0.7068292969117769, 'psi': 0.8026742165857932}-{'f1_val': 0.8132107103262975, 'auprc': 0.9638007162472373, 'loss_val': 0.5962219955271213, 'psi': 0.8734467126946734}
[S7] START round=39 head_norm_before_train=1.756209 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5270000958356763, 'auprc': 0.7819156490849495, 'loss_val': 0.9457509510935074, 'psi': 0.6289663171353856}-{'f1_val': 0.5541819702638505, 'auprc': 0.7832800524477797, 'loss_val': 0.7783448020523995, 'psi': 0.6458212031374222}
[S8] START round=39 head_norm_before_train=2.141413 (no previous merge yet)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9892831449862951, 'auprc': 0.9962830093928096, 'loss_val': 0.03633730300482205, 'psi': 0.9920830907489009}-{'f1_val': 0.9937709050739206, 'auprc': 0.9989607927806385, 'loss_val': 0.028053979537980025, 'psi': 0.9958468601566077}
[S9] START round=39 head_norm_before_train=1.389826 cos_to_last_merge=0.9958 (last merge round=34)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9875711251504857, 'auprc': 0.9956954587131657, 'loss_val': 0.07060046517905837, 'psi': 0.9908208585755578}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983146745395233, 'loss_val': 0.05283651517954922, 'psi': 0.9973221769041442}
[S10] START round=39 head_norm_before_train=1.788155 cos_to_last_merge=0.9850 (last merge round=34)
[S10] round=39 local utility u=0.003886 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9930815623342992, 'loss_val': 0.03895950374217272, 'psi': 0.9943453283453445}-{'f1_val': 0.9947486092193725, 'auprc': 0.9931830871437117, 'loss_val': 0.04440093283123922, 'psi': 0.9941224003891083}
[S11] START round=39 head_norm_before_train=1.417828 cos_to_last_merge=0.9932 (last merge round=35)
[S11] round=39 local utility u=0.006542 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976833848320107, 'loss_val': 0.06083148604548408, 'psi': 0.997001556640958}-{'f1_val': 0.9965470045135896, 'auprc': 0.997603663367899, 'loss_val': 0.07367552915744267, 'psi': 0.9969696680553133}
[S13] START round=39 head_norm_before_train=1.536257 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6399021567768243, 'auprc': 0.6439819332984315, 'loss_val': 0.9864942992846651, 'psi': 0.6415340673854671}-{'f1_val': 0.7411283117031806, 'auprc': 0.704223323081301, 'loss_val': 0.6453475241317228, 'psi': 0.7263663162544287}
[S14] START round=39 head_norm_before_train=1.611573 cos_to_last_merge=0.9998 (last merge round=37)
[S14] round=39 local utility u=0.060796 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.998683684424773, 'loss_val': 0.050376704662474195, 'psi': 0.9979633203998017}-{'f1_val': 0.981960164297736, 'auprc': 0.9986655655042432, 'loss_val': 0.0787772602881373, 'psi': 0.9886423247803389}
[S15] START round=39 head_norm_before_train=1.404174 cos_to_last_merge=1.0000 (last merge round=38)
[S15] round=39 local utility u=0.313968 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9982872008025996, 'loss_val': 0.07290117820656654, 'psi': 0.9973628813535522}-{'f1_val': 0.9110423648777821, 'auprc': 0.9973826430988674, 'loss_val': 0.18389731867808584, 'psi': 0.9455784761662163}
[S16] START round=39 head_norm_before_train=1.294971 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9323036339007902, 'auprc': 0.9878645147693974, 'loss_val': 0.3588742145270954, 'psi': 0.954527986248233}-{'f1_val': 0.9382033082904144, 'auprc': 0.9858386226016709, 'loss_val': 0.2714394245649483, 'psi': 0.9572574340149169}
[S17] START round=39 head_norm_before_train=1.353749 cos_to_last_merge=0.9989 (last merge round=36)
[S17] round=39 local utility u=0.152920 metrics={'f1_val': 0.6240850940363654, 'auprc': 0.7031588254511179, 'loss_val': 0.878635195144339, 'psi': 0.6557145866022663}-{'f1_val': 0.5983427866845262, 'auprc': 0.7535159922818622, 'loss_val': 1.1810919031154539, 'psi': 0.6604120689234606}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:33215
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:33213
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:33217
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:33204
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:33214
[S15] sending update (kind=head size=1805 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1804) from S14
[S7] cosine check vs S14: cos=0.9755
[S15] RECEIVED delta(kind=head bytes=1793) from S11
[S15] cosine check vs S11: cos=0.9634
[S13] RECEIVED delta(kind=head bytes=1801) from S4
[S13] cosine check vs S4: cos=0.9822
[S4] RECEIVED delta(kind=head bytes=1804) from S10
[S4] cosine check vs S10: cos=0.9976
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=0.7889
[S17] RECEIVED delta(kind=head bytes=1800) from S3
[S17] cosine check vs S3: cos=0.9688
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1805 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1805) from S17
[S16] cosine check vs S17: cos=0.9722
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.6399 head_norm=1.544230
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.921745e-01
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.6843 head_norm=1.649079 delta_norm=0.192174
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.642 u=0.0000 p_local=0.1683 f1=0.640 auprc=0.644 bytes=25171
[S5] r=40 psi=0.766 u=0.0000 p_local=0.1796 f1=0.695 auprc=0.873 bytes=32359
[S9] r=40 psi=0.991 u=0.0000 p_local=0.0093 f1=0.988 auprc=0.996 bytes=30566
[S8] r=40 psi=0.992 u=0.0000 p_local=0.0074 f1=0.989 auprc=0.996 bytes=30591
[S2] r=40 psi=0.717 u=0.0000 p_local=0.0900 f1=0.676 auprc=0.780 bytes=28771
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.5270 head_norm=1.765396
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.985211e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.5329 head_norm=1.692417 delta_norm=0.198521
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.629 u=0.0000 p_local=0.1104 f1=0.527 auprc=0.782 bytes=30602
[S6] r=40 psi=0.803 u=0.0000 p_local=0.2995 f1=0.713 auprc=0.937 bytes=28797
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=39 metric=0.9975 head_norm=1.640350
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.153306e-01
[S14] stored merged vector for next round verification (round=39)
[S14] DEBUG after merge:  round=39 metric=0.9972 head_norm=1.489507 delta_norm=0.515331
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] r=40 psi=0.998 u=0.0608 p_local=0.0237 f1=0.997 auprc=0.999 bytes=34183
[S11] r=40 psi=0.997 u=0.0065 p_local=0.0139 f1=0.997 auprc=0.998 bytes=35976
[S10] r=40 psi=0.994 u=0.0039 p_local=0.0062 f1=0.995 auprc=0.993 bytes=32402
[S3] r=40 psi=0.930 u=0.7903 p_local=0.3136 f1=0.885 auprc=0.996 bytes=32344
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9967 head_norm=1.509186
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.023520e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9967 head_norm=1.466269 delta_norm=0.202352
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.997 u=0.3140 p_local=0.2411 f1=0.997 auprc=0.998 bytes=32400
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9400 head_norm=1.768654
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.817416e-02
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9400 head_norm=1.794315 delta_norm=0.068174
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.950 u=0.1621 p_local=0.0470 f1=0.940 auprc=0.966 bytes=37798
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9323 head_norm=1.348865
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.627147e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9327 head_norm=1.359816 delta_norm=0.162715
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.955 u=0.0000 p_local=0.2043 f1=0.932 auprc=0.988 bytes=32379
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6241 head_norm=1.389861
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.750375e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6218 head_norm=1.387821 delta_norm=0.175037
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.656 u=0.1529 p_local=0.1420 f1=0.624 auprc=0.703 bytes=32386
[S2] START round=40 head_norm_before_train=1.440199 cos_to_last_merge=0.9978 (last merge round=38)
[S2] round=40 local utility u=0.447362 metrics={'f1_val': 0.7095923551611278, 'auprc': 0.9622826939391941, 'loss_val': 0.5425267660970685, 'psi': 0.8106684906723544}-{'f1_val': 0.6755816590285583, 'auprc': 0.7799379361231871, 'loss_val': 0.6861516264160832, 'psi': 0.7173241698664098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=40 head_norm_before_train=1.407712 cos_to_last_merge=0.9997 (last merge round=38)
[S3] round=40 local utility u=0.332765 metrics={'f1_val': 0.971904400169636, 'auprc': 0.9997496413789823, 'loss_val': 0.14771399885943934, 'psi': 0.9830424966533744}-{'f1_val': 0.8854684041839203, 'auprc': 0.9956743930203722, 'loss_val': 0.2824024128350061, 'psi': 0.9295507997185011}
[S4] START round=40 head_norm_before_train=1.794315 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9389437956811002, 'auprc': 0.9702695650582787, 'loss_val': 0.3090080974259084, 'psi': 0.9514741034319716}-{'f1_val': 0.939966727830748, 'auprc': 0.9662076029064851, 'loss_val': 0.3004195376268195, 'psi': 0.9504630778610428}
[S5] START round=40 head_norm_before_train=1.310492 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=40 local utility u=0.309251 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9922065274306942, 'loss_val': 0.21521738105679206, 'psi': 0.8172237169750687}-{'f1_val': 0.6952524479502127, 'auprc': 0.8731536178118474, 'loss_val': 0.44466450976979865, 'psi': 0.7664129158948666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=40 head_norm_before_train=1.768342 cos_to_last_merge=0.8246 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.6987563573209299, 'auprc': 0.87461521945058, 'loss_val': 0.8872226431252176, 'psi': 0.76909990217279}-{'f1_val': 0.712987524032772, 'auprc': 0.937204255415325, 'loss_val': 0.7068292969117769, 'psi': 0.8026742165857932}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.692417 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.341952 metrics={'f1_val': 0.6001530798873114, 'auprc': 0.7909567727330579, 'loss_val': 0.7278875253828629, 'psi': 0.67647455702561}-{'f1_val': 0.5270000958356763, 'auprc': 0.7819156490849495, 'loss_val': 0.9457509510935074, 'psi': 0.6289663171353856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=40 head_norm_before_train=2.152734 (no previous merge yet)
[S8] round=40 local utility u=0.020839 metrics={'f1_val': 0.9942850471809125, 'auprc': 0.9987704654936915, 'loss_val': 0.032133586449001134, 'psi': 0.9960792145060241}-{'f1_val': 0.9892831449862951, 'auprc': 0.9962830093928096, 'loss_val': 0.03633730300482205, 'psi': 0.9920830907489009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=40 head_norm_before_train=1.414067 cos_to_last_merge=0.9942 (last merge round=34)
[S9] round=40 local utility u=0.034039 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.992422361114191, 'loss_val': 0.04477798825984044, 'psi': 0.994719001313243}-{'f1_val': 0.9875711251504857, 'auprc': 0.9956954587131657, 'loss_val': 0.07060046517905837, 'psi': 0.9908208585755578}
[S10] START round=40 head_norm_before_train=1.822168 cos_to_last_merge=0.9823 (last merge round=34)
[S10] round=40 local utility u=0.001194 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9935748191736676, 'loss_val': 0.03673323420949159, 'psi': 0.9944108395885127}-{'f1_val': 0.9951878390193748, 'auprc': 0.9930815623342992, 'loss_val': 0.03895950374217272, 'psi': 0.9943453283453445}
[S11] START round=40 head_norm_before_train=1.450565 cos_to_last_merge=0.9906 (last merge round=35)
[S11] round=40 local utility u=0.002519 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976069493069507, 'loss_val': 0.05411349228217767, 'psi': 0.9968258802040968}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976833848320107, 'loss_val': 0.06083148604548408, 'psi': 0.997001556640958}
[S13] START round=40 head_norm_before_train=1.649079 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.523827 metrics={'f1_val': 0.7028987711434591, 'auprc': 0.7294830911705291, 'loss_val': 0.5733235866778779, 'psi': 0.7135324991542871}-{'f1_val': 0.6399021567768243, 'auprc': 0.6439819332984315, 'loss_val': 0.9864942992846651, 'psi': 0.6415340673854671}
[S14] START round=40 head_norm_before_train=1.489507 cos_to_last_merge=1.0000 (last merge round=39)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9969717986407778, 'loss_val': 0.08685611071604306, 'psi': 0.996886767551638}-{'f1_val': 0.9974830777164877, 'auprc': 0.998683684424773, 'loss_val': 0.050376704662474195, 'psi': 0.9979633203998017}
[S15] START round=40 head_norm_before_train=1.466269 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976774589779859, 'loss_val': 0.07489371286280741, 'psi': 0.9971189846237067}-{'f1_val': 0.9967466683875206, 'auprc': 0.9982872008025996, 'loss_val': 0.07290117820656654, 'psi': 0.9973628813535522}
[S16] START round=40 head_norm_before_train=1.359816 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8431681797439315, 'auprc': 0.947796743775899, 'loss_val': 0.7758155693024777, 'psi': 0.8850196053567185}-{'f1_val': 0.9323036339007902, 'auprc': 0.9878645147693974, 'loss_val': 0.3588742145270954, 'psi': 0.954527986248233}
[S17] START round=40 head_norm_before_train=1.387821 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.027427 metrics={'f1_val': 0.6433535255755631, 'auprc': 0.7097705427607132, 'loss_val': 0.9592272799459829, 'psi': 0.6699203324496231}-{'f1_val': 0.6240850940363654, 'auprc': 0.7031588254511179, 'loss_val': 0.878635195144339, 'psi': 0.6557145866022663}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:33203
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:33204
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] ⇄ pheromone p=0.193 → S14@127.0.0.1:33214
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:33202
[S4] ⇄ pheromone p=0.038 → S13@127.0.0.1:33213
[S10] sending update (kind=head size=1801 to 1 peers)
[S16] ⇄ pheromone p=0.163 → S5@127.0.0.1:33205
[S14] ⇄ pheromone p=0.019 → S7@127.0.0.1:33208
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:33217
[S3] RECEIVED delta(kind=head bytes=1800) from S9
[S3] cosine check vs S9: cos=0.9913
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9988
[S3] sending update (kind=head size=1799 to 1 peers)
[S9] ⇄ pheromone p=0.014 → S3@127.0.0.1:33203
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] ⇄ pheromone p=0.005 → S4@127.0.0.1:33204
[S17] RECEIVED delta(kind=head bytes=1799) from S3
[S17] cosine check vs S3: cos=0.9889
[S2] RECEIVED delta(kind=head bytes=1802) from S13
[S2] cosine check vs S13: cos=0.8177
[S13] ⇄ pheromone p=0.239 → S2@127.0.0.1:33202
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9719 head_norm=1.427643
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.457192e-02
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9403 head_norm=1.428732 delta_norm=0.094572
[S3] aggregate: ROLLBACK (f1_val pre=0.972 post=0.940 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.317 → S17@127.0.0.1:33217
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:33215
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S11
[S15] cosine check vs S11: cos=0.9760
[S11] ⇄ pheromone p=0.012 → S15@127.0.0.1:33215
[S17] RoundReady barrier timeout: have=1 need=2 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:33216
[S17] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S17
[S16] cosine check vs S17: cos=0.9749
[S10]  timeout peer S4
[S16]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S15
[S15]  timeout peer S14
[S14]  timeout peer S7
[S3]  timeout peer S10
[S3]  timeout peer S17
[S9]  timeout peer S3
[S13]  timeout peer S2
[S13]  timeout peer S11
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S16
[S4]  timeout peer S13
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.6434 head_norm=1.420715
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.062095e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.6429 head_norm=1.420217 delta_norm=0.106210
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=1.524784 cos_to_last_merge=0.9920 (last merge round=38)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7090563249095028, 'auprc': 0.8359321507037661, 'loss_val': 0.5882761233822889, 'psi': 0.7598066552272081}-{'f1_val': 0.7095923551611278, 'auprc': 0.9622826939391941, 'loss_val': 0.5425267660970685, 'psi': 0.8106684906723544}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=41 metric=0.7091 head_norm=1.594434
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.145460e-01
[S2] stored merged vector for next round verification (round=41)
[S2] DEBUG after merge:  round=41 metric=0.7097 head_norm=1.542716 delta_norm=0.514546
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] START round=41 head_norm_before_train=1.428732 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.647665263289122, 'auprc': 0.9309762336523195, 'loss_val': 0.8762883691619586, 'psi': 0.760989651434401}-{'f1_val': 0.971904400169636, 'auprc': 0.9997496413789823, 'loss_val': 0.14771399885943934, 'psi': 0.9830424966533744}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.805863 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=41 local utility u=0.025196 metrics={'f1_val': 0.9425810668947696, 'auprc': 0.977466964533156, 'loss_val': 0.3020322231818973, 'psi': 0.9565354259501242}-{'f1_val': 0.9389437956811002, 'auprc': 0.9702695650582787, 'loss_val': 0.3090080974259084, 'psi': 0.9514741034319716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9426 head_norm=1.811491
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.215080e-02
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9426 head_norm=1.830194 delta_norm=0.052151
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] START round=41 head_norm_before_train=1.334298 cos_to_last_merge=0.9993 (last merge round=38)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.7041087448064193, 'auprc': 0.9584677772313057, 'loss_val': 0.32047090955571883, 'psi': 0.8058523577763739}-{'f1_val': 0.7005685100046517, 'auprc': 0.9922065274306942, 'loss_val': 0.21521738105679206, 'psi': 0.8172237169750687}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.784642 cos_to_last_merge=0.8226 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.823
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.9594410255991247, 'auprc': 0.971321394683013, 'loss_val': 0.22587802644910485, 'psi': 0.9641931732326801}-{'f1_val': 0.6987563573209299, 'auprc': 0.87461521945058, 'loss_val': 0.8872226431252176, 'psi': 0.76909990217279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=41 head_norm_before_train=1.701407 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5866543488022096, 'auprc': 0.7896966965928671, 'loss_val': 0.7743993077299965, 'psi': 0.6678712879184726}-{'f1_val': 0.6001530798873114, 'auprc': 0.7909567727330579, 'loss_val': 0.7278875253828629, 'psi': 0.67647455702561}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=41 head_norm_before_train=2.158113 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9946534232918708, 'auprc': 0.9983206659169195, 'loss_val': 0.03680405766236502, 'psi': 0.9961203203418902}-{'f1_val': 0.9942850471809125, 'auprc': 0.9987704654936915, 'loss_val': 0.032133586449001134, 'psi': 0.9960792145060241}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=1.436063 cos_to_last_merge=0.9927 (last merge round=34)
[S9] round=41 local utility u=0.007099 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9981145215039842, 'loss_val': 0.04114796045220831, 'psi': 0.9963451124355627}-{'f1_val': 0.9962500947792776, 'auprc': 0.992422361114191, 'loss_val': 0.04477798825984044, 'psi': 0.994719001313243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=41 head_norm_before_train=1.850178 cos_to_last_merge=0.9802 (last merge round=34)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9936867395978708, 'loss_val': 0.03567924064567793, 'psi': 0.9941921599181849}-{'f1_val': 0.9949681865317428, 'auprc': 0.9935748191736676, 'loss_val': 0.03673323420949159, 'psi': 0.9944108395885127}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.477315 cos_to_last_merge=0.9884 (last merge round=35)
[S11] round=41 local utility u=0.003130 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978721476206196, 'loss_val': 0.05010076924147891, 'psi': 0.9970770617564015}-{'f1_val': 0.996305167468861, 'auprc': 0.9976069493069507, 'loss_val': 0.05411349228217767, 'psi': 0.9968258802040968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=41 head_norm_before_train=1.657479 cos_to_last_merge=0.9999 (last merge round=39)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6138307827537074, 'auprc': 0.6445940200271829, 'loss_val': 1.074398854967709, 'psi': 0.6261360776630975}-{'f1_val': 0.7028987711434591, 'auprc': 0.7294830911705291, 'loss_val': 0.5733235866778779, 'psi': 0.7135324991542871}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.521260 cos_to_last_merge=0.9997 (last merge round=39)
[S14] round=41 local utility u=0.014230 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986684195380031, 'loss_val': 0.0659466477275035, 'psi': 0.997811581838677}-{'f1_val': 0.9968300801588782, 'auprc': 0.9969717986407778, 'loss_val': 0.08685611071604306, 'psi': 0.996886767551638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=41 head_norm_before_train=1.563952 cos_to_last_merge=0.9961 (last merge round=39)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9632120722874211, 'auprc': 0.9979879233032426, 'loss_val': 0.08964513909986273, 'psi': 0.9771224126937497}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976774589779859, 'loss_val': 0.07489371286280741, 'psi': 0.9971189846237067}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=41 metric=0.9632 head_norm=1.646974
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.307258e-01
[S15] stored merged vector for next round verification (round=41)
[S15] DEBUG after merge:  round=41 metric=0.9637 head_norm=1.547339 delta_norm=0.230726
[S15] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] START round=41 head_norm_before_train=1.417485 cos_to_last_merge=0.9975 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.8340721797392338, 'auprc': 0.9678563084234011, 'loss_val': 0.849225180576004, 'psi': 0.8875858312129006}-{'f1_val': 0.8431681797439315, 'auprc': 0.947796743775899, 'loss_val': 0.7758155693024777, 'psi': 0.8850196053567185}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.8341 head_norm=1.477971
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.008419e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.8343 head_norm=1.435646 delta_norm=0.200842
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] START round=41 head_norm_before_train=1.420217 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6032743495201804, 'auprc': 0.7018756249295991, 'loss_val': 1.2265775126712626, 'psi': 0.6427148596839479}-{'f1_val': 0.6433535255755631, 'auprc': 0.7097705427607132, 'loss_val': 0.9592272799459829, 'psi': 0.6699203324496231}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.542716 cos_to_last_merge=1.0000 (last merge round=41)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.6080495199467852, 'auprc': 0.7676500409109588, 'loss_val': 0.9887141898882887, 'psi': 0.6718897283324546}-{'f1_val': 0.7090563249095028, 'auprc': 0.8359321507037661, 'loss_val': 0.5882761233822889, 'psi': 0.7598066552272081}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=1.444565 cos_to_last_merge=0.9998 (last merge round=40)
[S3] round=42 local utility u=0.646265 metrics={'f1_val': 0.7824535575720358, 'auprc': 0.9744574055798181, 'loss_val': 0.5229319864906756, 'psi': 0.8592550967751487}-{'f1_val': 0.647665263289122, 'auprc': 0.9309762336523195, 'loss_val': 0.8762883691619586, 'psi': 0.760989651434401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=42 head_norm_before_train=1.830194 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9444736696145417, 'auprc': 0.9706938188781042, 'loss_val': 0.3033828337640478, 'psi': 0.9549617293199668}-{'f1_val': 0.9425810668947696, 'auprc': 0.977466964533156, 'loss_val': 0.3020322231818973, 'psi': 0.9565354259501242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.364161 cos_to_last_merge=0.9981 (last merge round=38)
[S5] round=42 local utility u=0.087888 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.991440285453042, 'loss_val': 0.22340863279567488, 'psi': 0.8170209266653699}-{'f1_val': 0.7041087448064193, 'auprc': 0.9584677772313057, 'loss_val': 0.32047090955571883, 'psi': 0.8058523577763739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=42 head_norm_before_train=1.800875 cos_to_last_merge=0.8207 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.821
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6044691668033482, 'auprc': 0.7590905919443853, 'loss_val': 1.1831376209287932, 'psi': 0.666317736859763}-{'f1_val': 0.9594410255991247, 'auprc': 0.971321394683013, 'loss_val': 0.22587802644910485, 'psi': 0.9641931732326801}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.709009 cos_to_last_merge=0.9999 (last merge round=39)
[S7] round=42 local utility u=0.019447 metrics={'f1_val': 0.5896510562999894, 'auprc': 0.7911116683851639, 'loss_val': 0.757731263176177, 'psi': 0.6702353011340592}-{'f1_val': 0.5866543488022096, 'auprc': 0.7896966965928671, 'loss_val': 0.7743993077299965, 'psi': 0.6678712879184726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=42 head_norm_before_train=2.164203 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9354479247725416, 'auprc': 0.9982725947050916, 'loss_val': 0.1093667574456315, 'psi': 0.9605777927455615}-{'f1_val': 0.9946534232918708, 'auprc': 0.9983206659169195, 'loss_val': 0.03680405766236502, 'psi': 0.9961203203418902}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.456239 cos_to_last_merge=0.9913 (last merge round=34)
[S9] round=42 local utility u=0.000639 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9980522609441247, 'loss_val': 0.039683106021803506, 'psi': 0.9963202082116189}-{'f1_val': 0.9951655063899485, 'auprc': 0.9981145215039842, 'loss_val': 0.04114796045220831, 'psi': 0.9963451124355627}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=42 head_norm_before_train=1.874147 cos_to_last_merge=0.9783 (last merge round=34)
[S10] round=42 local utility u=0.000533 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9919064899218368, 'loss_val': 0.03322581893247668, 'psi': 0.9938752993803596}-{'f1_val': 0.9945291067983943, 'auprc': 0.9936867395978708, 'loss_val': 0.03567924064567793, 'psi': 0.9941921599181849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=42 head_norm_before_train=1.499517 cos_to_last_merge=0.9866 (last merge round=35)
[S11] round=42 local utility u=0.001367 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977362304598938, 'loss_val': 0.046959153811426346, 'psi': 0.9970226948921113}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978721476206196, 'loss_val': 0.05010076924147891, 'psi': 0.9970770617564015}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.666278 cos_to_last_merge=0.9996 (last merge round=39)
[S13] round=42 local utility u=0.264349 metrics={'f1_val': 0.6606648066880456, 'auprc': 0.6493238846353702, 'loss_val': 0.8408955238112855, 'psi': 0.6561284378669754}-{'f1_val': 0.6138307827537074, 'auprc': 0.6445940200271829, 'loss_val': 1.074398854967709, 'psi': 0.6261360776630975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=42 head_norm_before_train=1.560599 cos_to_last_merge=0.9986 (last merge round=39)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966461383503629, 'auprc': 0.9990458283802136, 'loss_val': 0.0655952814987561, 'psi': 0.9976060143623031}-{'f1_val': 0.997240356705793, 'auprc': 0.9986684195380031, 'loss_val': 0.0659466477275035, 'psi': 0.997811581838677}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.547339 cos_to_last_merge=1.0000 (last merge round=41)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7755016187789763, 'auprc': 0.9921632663405541, 'loss_val': 0.376148696147387, 'psi': 0.8621662778036074}-{'f1_val': 0.9632120722874211, 'auprc': 0.9979879233032426, 'loss_val': 0.08964513909986273, 'psi': 0.9771224126937497}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.435646 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.598395 metrics={'f1_val': 0.9354417243666058, 'auprc': 0.9845122176145242, 'loss_val': 0.3106208572554448, 'psi': 0.9550699216657732}-{'f1_val': 0.8340721797392338, 'auprc': 0.9678563084234011, 'loss_val': 0.849225180576004, 'psi': 0.8875858312129006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=42 head_norm_before_train=1.451841 cos_to_last_merge=0.9996 (last merge round=40)
[S17] round=42 local utility u=0.266759 metrics={'f1_val': 0.6282942437869667, 'auprc': 0.8108052033961263, 'loss_val': 1.1699673023851769, 'psi': 0.7012986276306306}-{'f1_val': 0.6032743495201804, 'auprc': 0.7018756249295991, 'loss_val': 1.2265775126712626, 'psi': 0.6427148596839479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=43 head_norm_before_train=1.601989 cos_to_last_merge=0.9985 (last merge round=41)
[S2] round=43 local utility u=0.718701 metrics={'f1_val': 0.709590108822474, 'auprc': 0.8852005106183156, 'loss_val': 0.5132073308250104, 'psi': 0.7798342695408107}-{'f1_val': 0.6080495199467852, 'auprc': 0.7676500409109588, 'loss_val': 0.9887141898882887, 'psi': 0.6718897283324546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=43 head_norm_before_train=1.459185 cos_to_last_merge=0.9993 (last merge round=40)
[S3] round=43 local utility u=0.706093 metrics={'f1_val': 0.9425299670070943, 'auprc': 0.9982300865955731, 'loss_val': 0.14252225178154837, 'psi': 0.9648100148424859}-{'f1_val': 0.7824535575720358, 'auprc': 0.9744574055798181, 'loss_val': 0.5229319864906756, 'psi': 0.8592550967751487}
[S3] not sending this round → trigger blocked (psi=0.965)
[S4] START round=43 head_norm_before_train=1.838616 cos_to_last_merge=0.9999 (last merge round=41)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9391538160673891, 'auprc': 0.9744770424708078, 'loss_val': 0.3126598711880975, 'psi': 0.9532831066287566}-{'f1_val': 0.9444736696145417, 'auprc': 0.9706938188781042, 'loss_val': 0.3033828337640478, 'psi': 0.9549617293199668}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.387767 cos_to_last_merge=0.9968 (last merge round=38)
[S5] round=43 local utility u=0.001967 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.9916760664297634, 'loss_val': 0.22018204220169613, 'psi': 0.8171152390560585}-{'f1_val': 0.7007413541402552, 'auprc': 0.991440285453042, 'loss_val': 0.22340863279567488, 'psi': 0.8170209266653699}
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] START round=43 head_norm_before_train=1.808294 cos_to_last_merge=0.8194 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.8216057142302344, 'auprc': 0.957016720933977, 'loss_val': 0.39750487062786866, 'psi': 0.8757701169117315}-{'f1_val': 0.6044691668033482, 'auprc': 0.7590905919443853, 'loss_val': 1.1831376209287932, 'psi': 0.666317736859763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=43 head_norm_before_train=1.716457 cos_to_last_merge=0.9999 (last merge round=39)
[S7] round=43 local utility u=0.144786 metrics={'f1_val': 0.6120196520976825, 'auprc': 0.7950681073696222, 'loss_val': 0.6142407953044915, 'psi': 0.6852390342064584}-{'f1_val': 0.5896510562999894, 'auprc': 0.7911116683851639, 'loss_val': 0.757731263176177, 'psi': 0.6702353011340592}
[S7] not sending this round → trigger blocked (psi=0.685)
[S8] START round=43 head_norm_before_train=2.170543 (no previous merge yet)
[S8] round=43 local utility u=0.218483 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9990693132780031, 'loss_val': 0.02693196222230086, 'psi': 0.996110581473886}-{'f1_val': 0.9354479247725416, 'auprc': 0.9982725947050916, 'loss_val': 0.1093667574456315, 'psi': 0.9605777927455615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=43 head_norm_before_train=1.474896 cos_to_last_merge=0.9900 (last merge round=34)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9977491103477895, 'loss_val': 0.04213461348540781, 'psi': 0.9946923184895168}-{'f1_val': 0.9951655063899485, 'auprc': 0.9980522609441247, 'loss_val': 0.039683106021803506, 'psi': 0.9963202082116189}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.896368 cos_to_last_merge=0.9765 (last merge round=34)
[S10] round=43 local utility u=0.002754 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993461114566649, 'loss_val': 0.03238215249435643, 'psi': 0.9944971492382844}-{'f1_val': 0.9951878390193748, 'auprc': 0.9919064899218368, 'loss_val': 0.03322581893247668, 'psi': 0.9938752993803596}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=43 head_norm_before_train=1.520887 cos_to_last_merge=0.9848 (last merge round=35)
[S11] round=43 local utility u=0.001736 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977743428866169, 'loss_val': 0.043601020543426516, 'psi': 0.9970379398628005}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977362304598938, 'loss_val': 0.046959153811426346, 'psi': 0.9970226948921113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=43 head_norm_before_train=1.675195 cos_to_last_merge=0.9993 (last merge round=39)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6223937450804562, 'auprc': 0.6304664020646453, 'loss_val': 1.038297358267408, 'psi': 0.6256228078741319}-{'f1_val': 0.6606648066880456, 'auprc': 0.6493238846353702, 'loss_val': 0.8408955238112855, 'psi': 0.6561284378669754}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=1.596313 cos_to_last_merge=0.9971 (last merge round=39)
[S14] round=43 local utility u=0.011946 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986582811364828, 'loss_val': 0.04657085224392463, 'psi': 0.9980539832845052}-{'f1_val': 0.9966461383503629, 'auprc': 0.9990458283802136, 'loss_val': 0.0655952814987561, 'psi': 0.9976060143623031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=43 head_norm_before_train=1.617319 cos_to_last_merge=0.9984 (last merge round=41)
[S15] round=43 local utility u=0.824087 metrics={'f1_val': 0.9940529030369569, 'auprc': 0.9989998130711769, 'loss_val': 0.059791620275704095, 'psi': 0.9960316670506449}-{'f1_val': 0.7755016187789763, 'auprc': 0.9921632663405541, 'loss_val': 0.376148696147387, 'psi': 0.8621662778036074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=43 head_norm_before_train=1.488042 cos_to_last_merge=0.9984 (last merge round=41)
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9013484360559012, 'auprc': 0.9898569108441404, 'loss_val': 0.4136713745031237, 'psi': 0.9367518259711969}-{'f1_val': 0.9354417243666058, 'auprc': 0.9845122176145242, 'loss_val': 0.3106208572554448, 'psi': 0.9550699216657732}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.474602 cos_to_last_merge=0.9990 (last merge round=40)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.30482492182178056, 'auprc': 0.5810971297872902, 'loss_val': 2.204561526968869, 'psi': 0.41533380500798445}-{'f1_val': 0.6282942437869667, 'auprc': 0.8108052033961263, 'loss_val': 1.1699673023851769, 'psi': 0.7012986276306306}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.673890 cos_to_last_merge=0.9944 (last merge round=41)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.7095933961666887, 'auprc': 0.855882111130767, 'loss_val': 0.5671798418454898, 'psi': 0.76810888215232}-{'f1_val': 0.709590108822474, 'auprc': 0.8852005106183156, 'loss_val': 0.5132073308250104, 'psi': 0.7798342695408107}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.471104 cos_to_last_merge=0.9987 (last merge round=40)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8633119101254929, 'auprc': 0.9771067710511337, 'loss_val': 0.329010675034137, 'psi': 0.9088298544957493}-{'f1_val': 0.9425299670070943, 'auprc': 0.9982300865955731, 'loss_val': 0.14252225178154837, 'psi': 0.9648100148424859}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.848394 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=44 local utility u=0.008038 metrics={'f1_val': 0.9340902596672346, 'auprc': 0.9789422689180977, 'loss_val': 0.2795990570918996, 'psi': 0.9520310633675798}-{'f1_val': 0.9391538160673891, 'auprc': 0.9744770424708078, 'loss_val': 0.3126598711880975, 'psi': 0.9532831066287566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=44 head_norm_before_train=1.405340 cos_to_last_merge=0.9958 (last merge round=38)
[S5] round=44 local utility u=0.027658 metrics={'f1_val': 0.7054932181760125, 'auprc': 0.9918593789748635, 'loss_val': 0.1939275202326908, 'psi': 0.8200396824955529}-{'f1_val': 0.7007413541402552, 'auprc': 0.9916760664297634, 'loss_val': 0.22018204220169613, 'psi': 0.8171152390560585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=44 head_norm_before_train=1.809923 cos_to_last_merge=0.8191 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.819
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6017963292275337, 'auprc': 0.9314477903660494, 'loss_val': 0.9004090403852774, 'psi': 0.7336569136829401}-{'f1_val': 0.8216057142302344, 'auprc': 0.957016720933977, 'loss_val': 0.39750487062786866, 'psi': 0.8757701169117315}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.723639 cos_to_last_merge=0.9998 (last merge round=39)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.582291443579189, 'auprc': 0.785922617916337, 'loss_val': 0.6910289690863245, 'psi': 0.6637439133140481}-{'f1_val': 0.6120196520976825, 'auprc': 0.7950681073696222, 'loss_val': 0.6142407953044915, 'psi': 0.6852390342064584}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=2.180826 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9987296171158047, 'loss_val': 0.028475866256914627, 'psi': 0.9956670491150198}-{'f1_val': 0.9941380936044745, 'auprc': 0.9990693132780031, 'loss_val': 0.02693196222230086, 'psi': 0.996110581473886}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.491660 cos_to_last_merge=0.9888 (last merge round=34)
[S9] round=44 local utility u=0.010998 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9947597879985008, 'loss_val': 0.03370484622466836, 'psi': 0.9957500265997329}-{'f1_val': 0.9926544572506684, 'auprc': 0.9977491103477895, 'loss_val': 0.04213461348540781, 'psi': 0.9946923184895168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=44 head_norm_before_train=1.915245 cos_to_last_merge=0.9749 (last merge round=34)
[S10] round=44 local utility u=0.000575 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993597488093861, 'loss_val': 0.03164124263693864, 'psi': 0.9945516986491691}-{'f1_val': 0.9951878390193748, 'auprc': 0.993461114566649, 'loss_val': 0.03238215249435643, 'psi': 0.9944971492382844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=44 head_norm_before_train=1.540915 cos_to_last_merge=0.9831 (last merge round=35)
[S11] round=44 local utility u=0.001992 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978446066219689, 'loss_val': 0.03982686419651134, 'psi': 0.9970660453569413}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977743428866169, 'loss_val': 0.043601020543426516, 'psi': 0.9970379398628005}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=44 head_norm_before_train=1.687454 cos_to_last_merge=0.9989 (last merge round=39)
[S13] round=44 local utility u=0.259049 metrics={'f1_val': 0.6682918394546423, 'auprc': 0.6663600603211826, 'loss_val': 0.903269795968521, 'psi': 0.6675191278012584}-{'f1_val': 0.6223937450804562, 'auprc': 0.6304664020646453, 'loss_val': 1.038297358267408, 'psi': 0.6256228078741319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=44 head_norm_before_train=1.631960 cos_to_last_merge=0.9953 (last merge round=39)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.99827597994294, 'loss_val': 0.04055795166969752, 'psi': 0.997408440072503}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986582811364828, 'loss_val': 0.04657085224392463, 'psi': 0.9980539832845052}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.677595 cos_to_last_merge=0.9952 (last merge round=41)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.8825570589368259, 'auprc': 0.9950079581972375, 'loss_val': 0.2360248067498829, 'psi': 0.9275374186409906}-{'f1_val': 0.9940529030369569, 'auprc': 0.9989998130711769, 'loss_val': 0.059791620275704095, 'psi': 0.9960316670506449}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.537700 cos_to_last_merge=0.9950 (last merge round=41)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8730607836238665, 'auprc': 0.9908413646936197, 'loss_val': 0.5176514669893033, 'psi': 0.9201730160517678}-{'f1_val': 0.9013484360559012, 'auprc': 0.9898569108441404, 'loss_val': 0.4136713745031237, 'psi': 0.9367518259711969}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.497214 cos_to_last_merge=0.9982 (last merge round=40)
[S17] round=44 local utility u=1.000000 metrics={'f1_val': 0.632304952102892, 'auprc': 0.8933648305291673, 'loss_val': 1.1463607310950314, 'psi': 0.7367289034734021}-{'f1_val': 0.30482492182178056, 'auprc': 0.5810971297872902, 'loss_val': 2.204561526968869, 'psi': 0.41533380500798445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=45 head_norm_before_train=1.731964 cos_to_last_merge=0.9904 (last merge round=41)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7085742138177114, 'auprc': 0.8076702694584188, 'loss_val': 0.5877329039381142, 'psi': 0.7482126360739944}-{'f1_val': 0.7095933961666887, 'auprc': 0.855882111130767, 'loss_val': 0.5671798418454898, 'psi': 0.76810888215232}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=1.483572 cos_to_last_merge=0.9981 (last merge round=40)
[S3] round=45 local utility u=0.079880 metrics={'f1_val': 0.8827159378388301, 'auprc': 0.9786742387404046, 'loss_val': 0.2903768374421184, 'psi': 0.9210992581994598}-{'f1_val': 0.8633119101254929, 'auprc': 0.9771067710511337, 'loss_val': 0.329010675034137, 'psi': 0.9088298544957493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=1.849660 cos_to_last_merge=0.9993 (last merge round=41)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9402214749485627, 'auprc': 0.970279041331401, 'loss_val': 0.2916884397643268, 'psi': 0.952244501501698}-{'f1_val': 0.9340902596672346, 'auprc': 0.9789422689180977, 'loss_val': 0.2795990570918996, 'psi': 0.9520310633675798}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.420892 cos_to_last_merge=0.9950 (last merge round=38)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7007411975400595, 'auprc': 0.991394064777066, 'loss_val': 0.2490501561474757, 'psi': 0.8170023444348622}-{'f1_val': 0.7054932181760125, 'auprc': 0.9918593789748635, 'loss_val': 0.1939275202326908, 'psi': 0.8200396824955529}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.817617 cos_to_last_merge=0.8180 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9408883833144361, 'auprc': 0.9683001472740549, 'loss_val': 0.2571717019421757, 'psi': 0.9518530888982836}-{'f1_val': 0.6017963292275337, 'auprc': 0.9314477903660494, 'loss_val': 0.9004090403852774, 'psi': 0.7336569136829401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=45 head_norm_before_train=1.730863 cos_to_last_merge=0.9996 (last merge round=39)
[S7] round=45 local utility u=0.174807 metrics={'f1_val': 0.6179029776041863, 'auprc': 0.7952516448741411, 'loss_val': 0.5830714199835738, 'psi': 0.6888424445121683}-{'f1_val': 0.582291443579189, 'auprc': 0.785922617916337, 'loss_val': 0.6910289690863245, 'psi': 0.6637439133140481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=45 head_norm_before_train=2.185000 (no previous merge yet)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9926726816424898, 'auprc': 0.9990526638002578, 'loss_val': 0.028452065638020302, 'psi': 0.9952246745055969}-{'f1_val': 0.9936253371144965, 'auprc': 0.9987296171158047, 'loss_val': 0.028475866256914627, 'psi': 0.9956670491150198}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.507197 cos_to_last_merge=0.9876 (last merge round=34)
[S9] round=45 local utility u=0.000806 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9978126674613365, 'loss_val': 0.03378289514128304, 'psi': 0.9962243708185037}-{'f1_val': 0.9964101856672208, 'auprc': 0.9947597879985008, 'loss_val': 0.03370484622466836, 'psi': 0.9957500265997329}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=45 head_norm_before_train=1.932399 cos_to_last_merge=0.9736 (last merge round=34)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9930824202570637, 'loss_val': 0.03089097666583061, 'psi': 0.9943456715144503}-{'f1_val': 0.9951878390193748, 'auprc': 0.993597488093861, 'loss_val': 0.03164124263693864, 'psi': 0.9945516986491691}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=45 head_norm_before_train=1.559804 cos_to_last_merge=0.9815 (last merge round=35)
[S11] round=45 local utility u=0.001256 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978108278992911, 'loss_val': 0.03721342071104138, 'psi': 0.9970525338678702}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978446066219689, 'loss_val': 0.03982686419651134, 'psi': 0.9970660453569413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=45 head_norm_before_train=1.702295 cos_to_last_merge=0.9985 (last merge round=39)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.6920236418243286, 'auprc': 0.6568711028116152, 'loss_val': 1.0375532258092195, 'psi': 0.6779626262192433}-{'f1_val': 0.6682918394546423, 'auprc': 0.6663600603211826, 'loss_val': 0.903269795968521, 'psi': 0.6675191278012584}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.663423 cos_to_last_merge=0.9935 (last merge round=39)
[S14] round=45 local utility u=0.002530 metrics={'f1_val': 0.9969987740343681, 'auprc': 0.9990466889860841, 'loss_val': 0.03882184690630595, 'psi': 0.9978179400150545}-{'f1_val': 0.9968300801588782, 'auprc': 0.99827597994294, 'loss_val': 0.04055795166969752, 'psi': 0.997408440072503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=45 head_norm_before_train=1.726522 cos_to_last_merge=0.9920 (last merge round=41)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.836011963344442, 'auprc': 0.9959559085950533, 'loss_val': 0.3307823230761909, 'psi': 0.8999895414446866}-{'f1_val': 0.8825570589368259, 'auprc': 0.9950079581972375, 'loss_val': 0.2360248067498829, 'psi': 0.9275374186409906}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.580618 cos_to_last_merge=0.9912 (last merge round=41)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8514948703717736, 'auprc': 0.9361414658266891, 'loss_val': 0.5363498433531833, 'psi': 0.8853535085537398}-{'f1_val': 0.8730607836238665, 'auprc': 0.9908413646936197, 'loss_val': 0.5176514669893033, 'psi': 0.9201730160517678}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.510052 cos_to_last_merge=0.9976 (last merge round=40)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5968356154112722, 'auprc': 0.6688612893097091, 'loss_val': 1.2545257324362094, 'psi': 0.625645884970647}-{'f1_val': 0.632304952102892, 'auprc': 0.8933648305291673, 'loss_val': 1.1463607310950314, 'psi': 0.7367289034734021}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.767142 cos_to_last_merge=0.9881 (last merge round=41)
[S2] round=46 local utility u=0.176456 metrics={'f1_val': 0.7084912635885892, 'auprc': 0.9264429838068842, 'loss_val': 0.5906408280970268, 'psi': 0.7956719516759072}-{'f1_val': 0.7085742138177114, 'auprc': 0.8076702694584188, 'loss_val': 0.5877329039381142, 'psi': 0.7482126360739944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=46 head_norm_before_train=1.495575 cos_to_last_merge=0.9974 (last merge round=40)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.695901158420616, 'auprc': 0.9513883951610167, 'loss_val': 0.7674925111584269, 'psi': 0.7980960531167762}-{'f1_val': 0.8827159378388301, 'auprc': 0.9786742387404046, 'loss_val': 0.2903768374421184, 'psi': 0.9210992581994598}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.848316 cos_to_last_merge=0.9966 (last merge round=41)
[S4] round=46 local utility u=0.015886 metrics={'f1_val': 0.9378299852223067, 'auprc': 0.9734440996013227, 'loss_val': 0.25506170628668173, 'psi': 0.952075630973913}-{'f1_val': 0.9402214749485627, 'auprc': 0.970279041331401, 'loss_val': 0.2916884397643268, 'psi': 0.952244501501698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.434319 cos_to_last_merge=0.9942 (last merge round=38)
[S5] round=46 local utility u=0.019645 metrics={'f1_val': 0.7007413541402552, 'auprc': 0.9917475264882951, 'loss_val': 0.21082213443626974, 'psi': 0.8171438230794712}-{'f1_val': 0.7007411975400595, 'auprc': 0.991394064777066, 'loss_val': 0.2490501561474757, 'psi': 0.8170023444348622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=46 head_norm_before_train=1.830208 cos_to_last_merge=0.8166 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.817
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7536068436221361, 'auprc': 0.9111088121008353, 'loss_val': 0.7994307679306847, 'psi': 0.8166076310136159}-{'f1_val': 0.9408883833144361, 'auprc': 0.9683001472740549, 'loss_val': 0.2571717019421757, 'psi': 0.9518530888982836}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.738425 cos_to_last_merge=0.9996 (last merge round=39)
[S7] round=46 local utility u=0.213051 metrics={'f1_val': 0.6609706964573184, 'auprc': 0.8073755475386084, 'loss_val': 0.45174697488305515, 'psi': 0.7195326368898345}-{'f1_val': 0.6179029776041863, 'auprc': 0.7952516448741411, 'loss_val': 0.5830714199835738, 'psi': 0.6888424445121683}
[S7] not sending this round → trigger blocked (psi=0.720)
[S8] START round=46 head_norm_before_train=2.188972 (no previous merge yet)
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9887021880404929, 'auprc': 0.9988155771855702, 'loss_val': 0.03610859243717361, 'psi': 0.9927475436985238}-{'f1_val': 0.9926726816424898, 'auprc': 0.9990526638002578, 'loss_val': 0.028452065638020302, 'psi': 0.9952246745055969}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=46 head_norm_before_train=1.520207 cos_to_last_merge=0.9867 (last merge round=34)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.997731816303547, 'loss_val': 0.03802984571190072, 'psi': 0.9946854008718198}-{'f1_val': 0.9951655063899485, 'auprc': 0.9978126674613365, 'loss_val': 0.03378289514128304, 'psi': 0.9962243708185037}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.949715 cos_to_last_merge=0.9721 (last merge round=34)
[S10] round=46 local utility u=0.000487 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932167344269152, 'loss_val': 0.03032059441483117, 'psi': 0.9943993971823909}-{'f1_val': 0.9951878390193748, 'auprc': 0.9930824202570637, 'loss_val': 0.03089097666583061, 'psi': 0.9943456715144503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=46 head_norm_before_train=1.577489 cos_to_last_merge=0.9799 (last merge round=35)
[S11] round=46 local utility u=0.000984 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997840306679135, 'loss_val': 0.03533476952110537, 'psi': 0.9970643253798077}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978108278992911, 'loss_val': 0.03721342071104138, 'psi': 0.9970525338678702}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=46 head_norm_before_train=1.714215 cos_to_last_merge=0.9980 (last merge round=39)
[S13] round=46 local utility u=0.108705 metrics={'f1_val': 0.6555347840713432, 'auprc': 0.7180282550187382, 'loss_val': 0.7846809334251431, 'psi': 0.6805321724503013}-{'f1_val': 0.6920236418243286, 'auprc': 0.6568711028116152, 'loss_val': 1.0375532258092195, 'psi': 0.6779626262192433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=46 head_norm_before_train=1.690800 cos_to_last_merge=0.9918 (last merge round=39)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9898092267167313, 'auprc': 0.9990438759333762, 'loss_val': 0.05278944318074607, 'psi': 0.9935030864033894}-{'f1_val': 0.9969987740343681, 'auprc': 0.9990466889860841, 'loss_val': 0.03882184690630595, 'psi': 0.9978179400150545}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.765743 cos_to_last_merge=0.9892 (last merge round=41)
[S15] round=46 local utility u=0.634790 metrics={'f1_val': 0.9960421039080725, 'auprc': 0.9984633375648984, 'loss_val': 0.028905724833427297, 'psi': 0.9970105973708028}-{'f1_val': 0.836011963344442, 'auprc': 0.9959559085950533, 'loss_val': 0.3307823230761909, 'psi': 0.8999895414446866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=46 head_norm_before_train=1.617948 cos_to_last_merge=0.9874 (last merge round=41)
[S16] round=46 local utility u=0.632011 metrics={'f1_val': 0.9700125628752397, 'auprc': 0.9844392448190393, 'loss_val': 0.12832739031952645, 'psi': 0.9757832356527596}-{'f1_val': 0.8514948703717736, 'auprc': 0.9361414658266891, 'loss_val': 0.5363498433531833, 'psi': 0.8853535085537398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=46 head_norm_before_train=1.521871 cos_to_last_merge=0.9971 (last merge round=40)
[S17] round=46 local utility u=0.174832 metrics={'f1_val': 0.6248608503469706, 'auprc': 0.7441503363102817, 'loss_val': 1.298880505303004, 'psi': 0.6725766447322951}-{'f1_val': 0.5968356154112722, 'auprc': 0.6688612893097091, 'loss_val': 1.2545257324362094, 'psi': 0.625645884970647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=47 head_norm_before_train=1.793883 cos_to_last_merge=0.9863 (last merge round=41)
[S2] round=47 local utility u=0.070984 metrics={'f1_val': 0.7112476084732751, 'auprc': 0.9571190344280663, 'loss_val': 0.5572387253565443, 'psi': 0.8095961788551915}-{'f1_val': 0.7084912635885892, 'auprc': 0.9264429838068842, 'loss_val': 0.5906408280970268, 'psi': 0.7956719516759072}
[S2] not sending this round → trigger blocked (psi=0.810)
[S3] START round=47 head_norm_before_train=1.506588 cos_to_last_merge=0.9967 (last merge round=40)
[S3] round=47 local utility u=0.971304 metrics={'f1_val': 0.9023332851300312, 'auprc': 0.9996933894207812, 'loss_val': 0.20839262468825587, 'psi': 0.9412773268463313}-{'f1_val': 0.695901158420616, 'auprc': 0.9513883951610167, 'loss_val': 0.7674925111584269, 'psi': 0.7980960531167762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=47 head_norm_before_train=1.855978 cos_to_last_merge=0.9955 (last merge round=41)
[S4] round=47 local utility u=0.011437 metrics={'f1_val': 0.9446305560867962, 'auprc': 0.9763596949196982, 'loss_val': 0.2817379667916266, 'psi': 0.9573222116199571}-{'f1_val': 0.9378299852223067, 'auprc': 0.9734440996013227, 'loss_val': 0.25506170628668173, 'psi': 0.952075630973913}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=47 head_norm_before_train=1.445583 cos_to_last_merge=0.9934 (last merge round=38)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.7077857933121091, 'auprc': 0.94993442608573, 'loss_val': 0.32730341672570634, 'psi': 0.8046452464215574}-{'f1_val': 0.7007413541402552, 'auprc': 0.9917475264882951, 'loss_val': 0.21082213443626974, 'psi': 0.8171438230794712}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.840068 cos_to_last_merge=0.8146 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6875644533372267, 'auprc': 0.8505243772335169, 'loss_val': 0.9870702147337405, 'psi': 0.7527484228957428}-{'f1_val': 0.7536068436221361, 'auprc': 0.9111088121008353, 'loss_val': 0.7994307679306847, 'psi': 0.8166076310136159}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.744603 cos_to_last_merge=0.9995 (last merge round=39)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.46148975824766575, 'auprc': 0.7813920687835362, 'loss_val': 1.075367642379782, 'psi': 0.5894506824620139}-{'f1_val': 0.6609706964573184, 'auprc': 0.8073755475386084, 'loss_val': 0.45174697488305515, 'psi': 0.7195326368898345}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.197098 (no previous merge yet)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.7007031375116063, 'auprc': 0.9470926580021073, 'loss_val': 0.6729257615258621, 'psi': 0.7992589457078068}-{'f1_val': 0.9887021880404929, 'auprc': 0.9988155771855702, 'loss_val': 0.03610859243717361, 'psi': 0.9927475436985238}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.531246 cos_to_last_merge=0.9859 (last merge round=34)
[S9] round=47 local utility u=0.009816 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948291409241432, 'loss_val': 0.03126327181701309, 'psi': 0.9956817132372239}-{'f1_val': 0.9926544572506684, 'auprc': 0.997731816303547, 'loss_val': 0.03802984571190072, 'psi': 0.9946854008718198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=47 head_norm_before_train=1.966264 cos_to_last_merge=0.9707 (last merge round=34)
[S10] round=47 local utility u=0.000495 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933584015473157, 'loss_val': 0.029755111541107, 'psi': 0.9944560640305511}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932167344269152, 'loss_val': 0.03032059441483117, 'psi': 0.9943993971823909}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=47 head_norm_before_train=1.593640 cos_to_last_merge=0.9785 (last merge round=35)
[S11] round=47 local utility u=0.000637 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978391581897349, 'loss_val': 0.03405710268604959, 'psi': 0.9970638659840477}-{'f1_val': 0.9965470045135896, 'auprc': 0.997840306679135, 'loss_val': 0.03533476952110537, 'psi': 0.9970643253798077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=47 head_norm_before_train=1.721399 cos_to_last_merge=0.9976 (last merge round=39)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6396080964380002, 'auprc': 0.7111273011866448, 'loss_val': 1.0779775879777593, 'psi': 0.668215778337458}-{'f1_val': 0.6555347840713432, 'auprc': 0.7180282550187382, 'loss_val': 0.7846809334251431, 'psi': 0.6805321724503013}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.713561 cos_to_last_merge=0.9904 (last merge round=39)
[S14] round=47 local utility u=0.033738 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990438870324714, 'loss_val': 0.02990099959256065, 'psi': 0.9979617688364644}-{'f1_val': 0.9898092267167313, 'auprc': 0.9990438759333762, 'loss_val': 0.05278944318074607, 'psi': 0.9935030864033894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=47 head_norm_before_train=1.796485 cos_to_last_merge=0.9869 (last merge round=41)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9955024063769649, 'auprc': 0.9964696757677954, 'loss_val': 0.03479361469016848, 'psi': 0.9958893141332971}-{'f1_val': 0.9960421039080725, 'auprc': 0.9984633375648984, 'loss_val': 0.028905724833427297, 'psi': 0.9970105973708028}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.648246 cos_to_last_merge=0.9843 (last merge round=41)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8472099316008674, 'auprc': 0.9600423201533947, 'loss_val': 0.8837600462614981, 'psi': 0.8923428870218784}-{'f1_val': 0.9700125628752397, 'auprc': 0.9844392448190393, 'loss_val': 0.12832739031952645, 'psi': 0.9757832356527596}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=1.538370 cos_to_last_merge=0.9962 (last merge round=40)
[S17] round=47 local utility u=0.306052 metrics={'f1_val': 0.6456495185024653, 'auprc': 0.7790020544332017, 'loss_val': 0.9160646684530738, 'psi': 0.6989905328747599}-{'f1_val': 0.6248608503469706, 'auprc': 0.7441503363102817, 'loss_val': 1.298880505303004, 'psi': 0.6725766447322951}
[S17] not sending this round → trigger blocked (psi=0.699)
[S2] START round=48 head_norm_before_train=1.816120 cos_to_last_merge=0.9848 (last merge round=41)
[S2] round=48 local utility u=0.015934 metrics={'f1_val': 0.7095895642811121, 'auprc': 0.979859703335326, 'loss_val': 0.5836442614262528, 'psi': 0.8176976199027977}-{'f1_val': 0.7112476084732751, 'auprc': 0.9571190344280663, 'loss_val': 0.5572387253565443, 'psi': 0.8095961788551915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=48 head_norm_before_train=1.517428 cos_to_last_merge=0.9960 (last merge round=40)
[S3] round=48 local utility u=0.238654 metrics={'f1_val': 0.9619616648309319, 'auprc': 0.999408233807638, 'loss_val': 0.08799996780579263, 'psi': 0.9769402924216144}-{'f1_val': 0.9023332851300312, 'auprc': 0.9996933894207812, 'loss_val': 0.20839262468825587, 'psi': 0.9412773268463313}
[S3] not sending this round → trigger blocked (psi=0.977)
[S4] START round=48 head_norm_before_train=1.869001 cos_to_last_merge=0.9943 (last merge round=41)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.943486588213788, 'auprc': 0.9640981435889436, 'loss_val': 0.2902596279213352, 'psi': 0.9517312103638502}-{'f1_val': 0.9446305560867962, 'auprc': 0.9763596949196982, 'loss_val': 0.2817379667916266, 'psi': 0.9573222116199571}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.458088 cos_to_last_merge=0.9924 (last merge round=38)
[S5] round=48 local utility u=1.000000 metrics={'f1_val': 0.9968483267439869, 'auprc': 0.9940145142911936, 'loss_val': 0.09598773112343824, 'psi': 0.9957148017628696}-{'f1_val': 0.7077857933121091, 'auprc': 0.94993442608573, 'loss_val': 0.32730341672570634, 'psi': 0.8046452464215574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=48 head_norm_before_train=1.855813 cos_to_last_merge=0.8128 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6689811324717484, 'auprc': 0.839640249806333, 'loss_val': 1.0504345177847048, 'psi': 0.7372447794055823}-{'f1_val': 0.6875644533372267, 'auprc': 0.8505243772335169, 'loss_val': 0.9870702147337405, 'psi': 0.7527484228957428}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.748084 cos_to_last_merge=0.9995 (last merge round=39)
[S7] round=48 local utility u=0.753523 metrics={'f1_val': 0.6199826407890267, 'auprc': 0.7952573448986855, 'loss_val': 0.5608754303076043, 'psi': 0.6900925224328902}-{'f1_val': 0.46148975824766575, 'auprc': 0.7813920687835362, 'loss_val': 1.075367642379782, 'psi': 0.5894506824620139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=48 head_norm_before_train=2.198613 (no previous merge yet)
[S8] round=48 local utility u=1.000000 metrics={'f1_val': 0.9846567949518252, 'auprc': 0.9987105417827348, 'loss_val': 0.04461924250289947, 'psi': 0.990278293684189}-{'f1_val': 0.7007031375116063, 'auprc': 0.9470926580021073, 'loss_val': 0.6729257615258621, 'psi': 0.7992589457078068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=48 head_norm_before_train=1.540557 cos_to_last_merge=0.9853 (last merge round=34)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9892714523047061, 'auprc': 0.9980414273161006, 'loss_val': 0.04656114127212151, 'psi': 0.992779442309264}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948291409241432, 'loss_val': 0.03126327181701309, 'psi': 0.9956817132372239}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.981885 cos_to_last_merge=0.9694 (last merge round=34)
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931668851403869, 'loss_val': 0.029446107458105428, 'psi': 0.9943794574677796}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933584015473157, 'loss_val': 0.029755111541107, 'psi': 0.9944560640305511}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.608317 cos_to_last_merge=0.9773 (last merge round=35)
[S11] round=48 local utility u=0.000643 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978509152694189, 'loss_val': 0.03280571923496802, 'psi': 0.9970685688159213}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978391581897349, 'loss_val': 0.03405710268604959, 'psi': 0.9970638659840477}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=48 head_norm_before_train=1.727491 cos_to_last_merge=0.9973 (last merge round=39)
[S13] round=48 local utility u=0.666156 metrics={'f1_val': 0.7506120680116845, 'auprc': 0.7907042370388788, 'loss_val': 0.6504193750098, 'psi': 0.7666489356225622}-{'f1_val': 0.6396080964380002, 'auprc': 0.7111273011866448, 'loss_val': 1.0779775879777593, 'psi': 0.668215778337458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=48 head_norm_before_train=1.732659 cos_to_last_merge=0.9892 (last merge round=39)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9980569533886897, 'loss_val': 0.02955469944454515, 'psi': 0.9974212862500749}-{'f1_val': 0.997240356705793, 'auprc': 0.9990438870324714, 'loss_val': 0.02990099959256065, 'psi': 0.9979617688364644}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.821644 cos_to_last_merge=0.9849 (last merge round=41)
[S15] round=48 local utility u=0.007146 metrics={'f1_val': 0.9953812545551983, 'auprc': 0.9989696455609606, 'loss_val': 0.02727444309899288, 'psi': 0.9968166109575032}-{'f1_val': 0.9955024063769649, 'auprc': 0.9964696757677954, 'loss_val': 0.03479361469016848, 'psi': 0.9958893141332971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=48 head_norm_before_train=1.671948 cos_to_last_merge=0.9818 (last merge round=41)
[S16] round=48 local utility u=0.019050 metrics={'f1_val': 0.8510225145702015, 'auprc': 0.9613378777457553, 'loss_val': 0.8724217837518058, 'psi': 0.895148659840423}-{'f1_val': 0.8472099316008674, 'auprc': 0.9600423201533947, 'loss_val': 0.8837600462614981, 'psi': 0.8923428870218784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=48 head_norm_before_train=1.553733 cos_to_last_merge=0.9954 (last merge round=40)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.4309553169775908, 'auprc': 0.644982690499392, 'loss_val': 1.80412631257411, 'psi': 0.5165662663863113}-{'f1_val': 0.6456495185024653, 'auprc': 0.7790020544332017, 'loss_val': 0.9160646684530738, 'psi': 0.6989905328747599}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=1.838780 cos_to_last_merge=0.9830 (last merge round=41)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.70856593985258, 'auprc': 0.9782426590736942, 'loss_val': 0.6235638652576021, 'psi': 0.8164366275410258}-{'f1_val': 0.7095895642811121, 'auprc': 0.979859703335326, 'loss_val': 0.5836442614262528, 'psi': 0.8176976199027977}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.525173 cos_to_last_merge=0.9955 (last merge round=40)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9585710950569251, 'auprc': 0.9961343892029069, 'loss_val': 0.10773565165649672, 'psi': 0.9735964127153178}-{'f1_val': 0.9619616648309319, 'auprc': 0.999408233807638, 'loss_val': 0.08799996780579263, 'psi': 0.9769402924216144}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.876837 cos_to_last_merge=0.9936 (last merge round=41)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9380095117165708, 'auprc': 0.9422146634503725, 'loss_val': 0.28584631120226667, 'psi': 0.9396915724100915}-{'f1_val': 0.943486588213788, 'auprc': 0.9640981435889436, 'loss_val': 0.2902596279213352, 'psi': 0.9517312103638502}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.471738 cos_to_last_merge=0.9913 (last merge round=38)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.8417594419630182, 'auprc': 0.9812900187293903, 'loss_val': 0.25080726910726714, 'psi': 0.8975716726695671}-{'f1_val': 0.9968483267439869, 'auprc': 0.9940145142911936, 'loss_val': 0.09598773112343824, 'psi': 0.9957148017628696}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.867458 cos_to_last_merge=0.8115 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.812
[S6] round=49 local utility u=0.955917 metrics={'f1_val': 0.8219247653795787, 'auprc': 0.9626592648896259, 'loss_val': 0.4253203152106448, 'psi': 0.8782185651835976}-{'f1_val': 0.6689811324717484, 'auprc': 0.839640249806333, 'loss_val': 1.0504345177847048, 'psi': 0.7372447794055823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=49 head_norm_before_train=1.750493 cos_to_last_merge=0.9994 (last merge round=39)
[S7] round=49 local utility u=0.055233 metrics={'f1_val': 0.6304809286529646, 'auprc': 0.7989432622657393, 'loss_val': 0.5244559792686425, 'psi': 0.6978658620980744}-{'f1_val': 0.6199826407890267, 'auprc': 0.7952573448986855, 'loss_val': 0.5608754303076043, 'psi': 0.6900925224328902}
[S7] not sending this round → trigger blocked (psi=0.698)
[S8] START round=49 head_norm_before_train=2.199935 (no previous merge yet)
[S8] round=49 local utility u=0.031069 metrics={'f1_val': 0.9924599848944748, 'auprc': 0.9990758318121887, 'loss_val': 0.030396880740380716, 'psi': 0.9951063236615605}-{'f1_val': 0.9846567949518252, 'auprc': 0.9987105417827348, 'loss_val': 0.04461924250289947, 'psi': 0.990278293684189}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=49 head_norm_before_train=1.550318 cos_to_last_merge=0.9846 (last merge round=34)
[S9] round=49 local utility u=0.001810 metrics={'f1_val': 0.9892428323638103, 'auprc': 0.9983024463239204, 'loss_val': 0.04355298601550399, 'psi': 0.9928666779478543}-{'f1_val': 0.9892714523047061, 'auprc': 0.9980414273161006, 'loss_val': 0.04656114127212151, 'psi': 0.992779442309264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=49 head_norm_before_train=1.993960 cos_to_last_merge=0.9684 (last merge round=34)
[S10] round=49 local utility u=0.000421 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933662835817325, 'loss_val': 0.02920223385864885, 'psi': 0.9944592168443178}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931668851403869, 'loss_val': 0.029446107458105428, 'psi': 0.9943794574677796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=1.622250 cos_to_last_merge=0.9761 (last merge round=35)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963148928902795, 'loss_val': 0.03444396488193878, 'psi': 0.9962061621040974}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978509152694189, 'loss_val': 0.03280571923496802, 'psi': 0.9970685688159213}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.730797 cos_to_last_merge=0.9971 (last merge round=39)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.7371395915747858, 'auprc': 0.7786235155007177, 'loss_val': 0.613511046398023, 'psi': 0.7537331611451585}-{'f1_val': 0.7506120680116845, 'auprc': 0.7907042370388788, 'loss_val': 0.6504193750098, 'psi': 0.7666489356225622}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.752504 cos_to_last_merge=0.9880 (last merge round=39)
[S14] round=49 local utility u=0.004108 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9986655946724734, 'loss_val': 0.027086707359483788, 'psi': 0.9980569086989015}-{'f1_val': 0.9969975081576651, 'auprc': 0.9980569533886897, 'loss_val': 0.02955469944454515, 'psi': 0.9974212862500749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=49 head_norm_before_train=1.843261 cos_to_last_merge=0.9833 (last merge round=41)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8862214325986406, 'auprc': 0.9964578421014187, 'loss_val': 0.2994098789964628, 'psi': 0.9303159963997518}-{'f1_val': 0.9953812545551983, 'auprc': 0.9989696455609606, 'loss_val': 0.02727444309899288, 'psi': 0.9968166109575032}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.692448 cos_to_last_merge=0.9796 (last merge round=41)
[S16] round=49 local utility u=0.314986 metrics={'f1_val': 0.8851179131798459, 'auprc': 0.9842834580811242, 'loss_val': 0.5158590015441633, 'psi': 0.9247841311403573}-{'f1_val': 0.8510225145702015, 'auprc': 0.9613378777457553, 'loss_val': 0.8724217837518058, 'psi': 0.895148659840423}
[S16] not sending this round → trigger blocked (psi=0.925)
[S17] START round=49 head_norm_before_train=1.568172 cos_to_last_merge=0.9945 (last merge round=40)
[S17] round=49 local utility u=1.000000 metrics={'f1_val': 0.8126371385018423, 'auprc': 0.8107404033961068, 'loss_val': 0.5575373467518099, 'psi': 0.8118784444595482}-{'f1_val': 0.4309553169775908, 'auprc': 0.644982690499392, 'loss_val': 1.80412631257411, 'psi': 0.5165662663863113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=50 head_norm_before_train=1.857715 cos_to_last_merge=0.9812 (last merge round=41)
[S2] round=50 local utility u=0.019573 metrics={'f1_val': 0.7097739039748207, 'auprc': 0.9863897061296036, 'loss_val': 0.6161066443331942, 'psi': 0.8204202248367338}-{'f1_val': 0.70856593985258, 'auprc': 0.9782426590736942, 'loss_val': 0.6235638652576021, 'psi': 0.8164366275410258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=50 head_norm_before_train=1.532172 cos_to_last_merge=0.9949 (last merge round=40)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.7759482367175962, 'auprc': 0.9571402374808311, 'loss_val': 0.5766180140715718, 'psi': 0.8484250370228901}-{'f1_val': 0.9585710950569251, 'auprc': 0.9961343892029069, 'loss_val': 0.10773565165649672, 'psi': 0.9735964127153178}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.886574 cos_to_last_merge=0.9944 (last merge round=41)
[S4] round=50 local utility u=0.021729 metrics={'f1_val': 0.9417792879191322, 'auprc': 0.954010986666491, 'loss_val': 0.3003953012032862, 'psi': 0.9466719674180757}-{'f1_val': 0.9380095117165708, 'auprc': 0.9422146634503725, 'loss_val': 0.28584631120226667, 'psi': 0.9396915724100915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=50 head_norm_before_train=1.482162 cos_to_last_merge=0.9901 (last merge round=38)
[S5] round=50 local utility u=0.567098 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9924714291904468, 'loss_val': 0.08244570591131857, 'psi': 0.9952731888769537}-{'f1_val': 0.8417594419630182, 'auprc': 0.9812900187293903, 'loss_val': 0.25080726910726714, 'psi': 0.8975716726695671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S5] sending update (kind=head size=1809 to 1 peers)
[S6] START round=50 head_norm_before_train=1.878823 cos_to_last_merge=0.8102 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.7779825986972871, 'auprc': 0.929666533826609, 'loss_val': 0.7907067745127845, 'psi': 0.8386561727490159}-{'f1_val': 0.8219247653795787, 'auprc': 0.9626592648896259, 'loss_val': 0.4253203152106448, 'psi': 0.8782185651835976}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.755268 cos_to_last_merge=0.9994 (last merge round=39)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.5549347855301402, 'auprc': 0.783166372184145, 'loss_val': 0.873491123776563, 'psi': 0.6462274201917422}-{'f1_val': 0.6304809286529646, 'auprc': 0.7989432622657393, 'loss_val': 0.5244559792686425, 'psi': 0.6978658620980744}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=2.209765 (no previous merge yet)
[S8] round=50 local utility u=0.007928 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9989694279838292, 'loss_val': 0.026496884311584968, 'psi': 0.9962912768586232}-{'f1_val': 0.9924599848944748, 'auprc': 0.9990758318121887, 'loss_val': 0.030396880740380716, 'psi': 0.9951063236615605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=50 head_norm_before_train=1.561274 cos_to_last_merge=0.9837 (last merge round=34)
[S9] round=50 local utility u=0.020661 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.995197261105713, 'loss_val': 0.029953160032871316, 'psi': 0.9953284039642567}-{'f1_val': 0.9892428323638103, 'auprc': 0.9983024463239204, 'loss_val': 0.04355298601550399, 'psi': 0.9928666779478543}
[S9] not sending this round → trigger blocked (psi=0.995)
[S10] START round=50 head_norm_before_train=2.002783 cos_to_last_merge=0.9679 (last merge round=34)
[S10] round=50 local utility u=0.000319 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935075228117979, 'loss_val': 0.028988305962976014, 'psi': 0.994515712536344}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933662835817325, 'loss_val': 0.02920223385864885, 'psi': 0.9944592168443178}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=50 head_norm_before_train=1.632555 cos_to_last_merge=0.9751 (last merge round=35)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9962688154807691, 'loss_val': 0.04585656867219655, 'psi': 0.9962000110387549}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963148928902795, 'loss_val': 0.03444396488193878, 'psi': 0.9962061621040974}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.733099 cos_to_last_merge=0.9970 (last merge round=39)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6736596246092758, 'auprc': 0.7006514524249753, 'loss_val': 1.009234649821205, 'psi': 0.6844563557355556}-{'f1_val': 0.7371395915747858, 'auprc': 0.7786235155007177, 'loss_val': 0.613511046398023, 'psi': 0.7537331611451585}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.770471 cos_to_last_merge=0.9868 (last merge round=39)
[S14] round=50 local utility u=0.000987 metrics={'f1_val': 0.997871830388708, 'auprc': 0.9986672235020577, 'loss_val': 0.026441359372290935, 'psi': 0.9981899876340479}-{'f1_val': 0.9976511180498535, 'auprc': 0.9986655946724734, 'loss_val': 0.027086707359483788, 'psi': 0.9980569086989015}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=50 head_norm_before_train=1.861782 cos_to_last_merge=0.9818 (last merge round=41)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.8252848807740566, 'auprc': 0.9950699018864537, 'loss_val': 0.3803536018598985, 'psi': 0.8931988892190155}-{'f1_val': 0.8862214325986406, 'auprc': 0.9964578421014187, 'loss_val': 0.2994098789964628, 'psi': 0.9303159963997518}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.711385 cos_to_last_merge=0.9777 (last merge round=41)
[S16] round=50 local utility u=0.259097 metrics={'f1_val': 0.934656634822368, 'auprc': 0.9876805207274524, 'loss_val': 0.30508869313787296, 'psi': 0.9558661891844018}-{'f1_val': 0.8851179131798459, 'auprc': 0.9842834580811242, 'loss_val': 0.5158590015441633, 'psi': 0.9247841311403573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=50 head_norm_before_train=1.578786 cos_to_last_merge=0.9937 (last merge round=40)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.5410495863310845, 'auprc': 0.7012747513651707, 'loss_val': 1.5034148344046439, 'psi': 0.605139652344719}-{'f1_val': 0.8126371385018423, 'auprc': 0.8107404033961068, 'loss_val': 0.5575373467518099, 'psi': 0.8118784444595482}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.874334 cos_to_last_merge=0.9799 (last merge round=41)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7122500700962116, 'auprc': 0.9222883636396059, 'loss_val': 0.532441438076069, 'psi': 0.7962653875135692}-{'f1_val': 0.7097739039748207, 'auprc': 0.9863897061296036, 'loss_val': 0.6161066443331942, 'psi': 0.8204202248367338}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.538274 cos_to_last_merge=0.9943 (last merge round=40)
[S3] round=51 local utility u=0.805779 metrics={'f1_val': 0.9489392259431744, 'auprc': 0.9937699837441368, 'loss_val': 0.11289596821745079, 'psi': 0.9668715290635593}-{'f1_val': 0.7759482367175962, 'auprc': 0.9571402374808311, 'loss_val': 0.5766180140715718, 'psi': 0.8484250370228901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=51 head_norm_before_train=1.895583 cos_to_last_merge=0.9952 (last merge round=41)
[S4] round=51 local utility u=0.001298 metrics={'f1_val': 0.942393595650728, 'auprc': 0.9547790798050121, 'loss_val': 0.30378848581913614, 'psi': 0.9473477893124416}-{'f1_val': 0.9417792879191322, 'auprc': 0.954010986666491, 'loss_val': 0.3003953012032862, 'psi': 0.9466719674180757}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=51 head_norm_before_train=1.493164 cos_to_last_merge=0.9888 (last merge round=38)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9922161094407045, 'loss_val': 0.08498977712469007, 'psi': 0.9946867309544158}-{'f1_val': 0.9971410286679584, 'auprc': 0.9924714291904468, 'loss_val': 0.08244570591131857, 'psi': 0.9952731888769537}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.882686 cos_to_last_merge=0.8088 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7419334704543152, 'auprc': 0.9010362470629261, 'loss_val': 0.7469940606026133, 'psi': 0.8055745810977596}-{'f1_val': 0.7779825986972871, 'auprc': 0.929666533826609, 'loss_val': 0.7907067745127845, 'psi': 0.8386561727490159}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.761569 cos_to_last_merge=0.9993 (last merge round=39)
[S7] round=51 local utility u=0.485795 metrics={'f1_val': 0.6470183208259666, 'auprc': 0.8028886883710326, 'loss_val': 0.5135701485927137, 'psi': 0.709366467843993}-{'f1_val': 0.5549347855301402, 'auprc': 0.783166372184145, 'loss_val': 0.873491123776563, 'psi': 0.6462274201917422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=51 head_norm_before_train=2.218538 (no previous merge yet)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9697500154541285, 'auprc': 0.9987193999364375, 'loss_val': 0.07588723325194416, 'psi': 0.9813377692470522}-{'f1_val': 0.9945058427751525, 'auprc': 0.9989694279838292, 'loss_val': 0.026496884311584968, 'psi': 0.9962912768586232}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.570662 cos_to_last_merge=0.9830 (last merge round=34)
[S9] round=51 local utility u=0.002299 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9952177145234754, 'loss_val': 0.027908472539053295, 'psi': 0.9955858194059892}-{'f1_val': 0.9954158325366191, 'auprc': 0.995197261105713, 'loss_val': 0.029953160032871316, 'psi': 0.9953284039642567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=51 head_norm_before_train=2.014466 cos_to_last_merge=0.9669 (last merge round=34)
[S10] round=51 local utility u=0.000099 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934870373351142, 'loss_val': 0.028727996772149555, 'psi': 0.9945075183456705}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935075228117979, 'loss_val': 0.028988305962976014, 'psi': 0.994515712536344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=51 head_norm_before_train=1.642502 cos_to_last_merge=0.9741 (last merge round=35)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.8811851487798028, 'auprc': 0.9961597208802804, 'loss_val': 0.16264625211114864, 'psi': 0.9271749776199938}-{'f1_val': 0.9961541414107454, 'auprc': 0.9962688154807691, 'loss_val': 0.04585656867219655, 'psi': 0.9962000110387549}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.738638 cos_to_last_merge=0.9968 (last merge round=39)
[S13] round=51 local utility u=0.629684 metrics={'f1_val': 0.7707924899517063, 'auprc': 0.7927378824234363, 'loss_val': 0.6089239168565557, 'psi': 0.7795706469403983}-{'f1_val': 0.6736596246092758, 'auprc': 0.7006514524249753, 'loss_val': 1.009234649821205, 'psi': 0.6844563557355556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=51 head_norm_before_train=1.787324 cos_to_last_merge=0.9857 (last merge round=39)
[S14] round=51 local utility u=0.001138 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9989625482791935, 'loss_val': 0.023727549798254127, 'psi': 0.9981756901415896}-{'f1_val': 0.997871830388708, 'auprc': 0.9986672235020577, 'loss_val': 0.026441359372290935, 'psi': 0.9981899876340479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=51 head_norm_before_train=1.879503 cos_to_last_merge=0.9804 (last merge round=41)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8216091246569885, 'auprc': 0.996031808844188, 'loss_val': 0.39129336768624295, 'psi': 0.8913781983318683}-{'f1_val': 0.8252848807740566, 'auprc': 0.9950699018864537, 'loss_val': 0.3803536018598985, 'psi': 0.8931988892190155}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.728834 cos_to_last_merge=0.9759 (last merge round=41)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8626155541101482, 'auprc': 0.981946396345865, 'loss_val': 0.7539068362506991, 'psi': 0.9103478910044349}-{'f1_val': 0.934656634822368, 'auprc': 0.9876805207274524, 'loss_val': 0.30508869313787296, 'psi': 0.9558661891844018}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.592894 cos_to_last_merge=0.9928 (last merge round=40)
[S17] round=51 local utility u=0.958938 metrics={'f1_val': 0.7273043980555717, 'auprc': 0.7673719836017543, 'loss_val': 0.9013592210707425, 'psi': 0.7433314322740447}-{'f1_val': 0.5410495863310845, 'auprc': 0.7012747513651707, 'loss_val': 1.5034148344046439, 'psi': 0.605139652344719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=52 head_norm_before_train=1.891306 cos_to_last_merge=0.9788 (last merge round=41)
[S2] round=52 local utility u=0.052612 metrics={'f1_val': 0.7097739039748207, 'auprc': 0.9831292388392037, 'loss_val': 0.5948830389803746, 'psi': 0.819116037920574}-{'f1_val': 0.7122500700962116, 'auprc': 0.9222883636396059, 'loss_val': 0.532441438076069, 'psi': 0.7962653875135692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=52 head_norm_before_train=1.546455 cos_to_last_merge=0.9938 (last merge round=40)
[S3] round=52 local utility u=0.084349 metrics={'f1_val': 0.9717893715706358, 'auprc': 0.999730782321521, 'loss_val': 0.09918087585014479, 'psi': 0.9829659358709899}-{'f1_val': 0.9489392259431744, 'auprc': 0.9937699837441368, 'loss_val': 0.11289596821745079, 'psi': 0.9668715290635593}
[S3] not sending this round → trigger blocked (psi=0.983)
[S4] START round=52 head_norm_before_train=1.908175 cos_to_last_merge=0.9956 (last merge round=41)
[S4] round=52 local utility u=0.002814 metrics={'f1_val': 0.9381166447012119, 'auprc': 0.9409245545270732, 'loss_val': 0.23093445532710163, 'psi': 0.9392398086315564}-{'f1_val': 0.942393595650728, 'auprc': 0.9547790798050121, 'loss_val': 0.30378848581913614, 'psi': 0.9473477893124416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S4] sending update (kind=head size=1809 to 1 peers)
[S5] START round=52 head_norm_before_train=1.509803 cos_to_last_merge=0.9873 (last merge round=38)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.8947341009258087, 'auprc': 0.9910833799466949, 'loss_val': 0.1329924084287224, 'psi': 0.9332738125341632}-{'f1_val': 0.9963338119635569, 'auprc': 0.9922161094407045, 'loss_val': 0.08498977712469007, 'psi': 0.9946867309544158}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.895868 cos_to_last_merge=0.8073 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6523580125698685, 'auprc': 0.8516323114023735, 'loss_val': 1.1309022904739665, 'psi': 0.7320677321028706}-{'f1_val': 0.7419334704543152, 'auprc': 0.9010362470629261, 'loss_val': 0.7469940606026133, 'psi': 0.8055745810977596}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.766563 cos_to_last_merge=0.9992 (last merge round=39)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6243347197765503, 'auprc': 0.8006848367013264, 'loss_val': 0.5136622587656692, 'psi': 0.6948747665464607}-{'f1_val': 0.6470183208259666, 'auprc': 0.8028886883710326, 'loss_val': 0.5135701485927137, 'psi': 0.709366467843993}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=2.227960 (no previous merge yet)
[S8] round=52 local utility u=0.020366 metrics={'f1_val': 0.9765245049040738, 'auprc': 0.9981383314303993, 'loss_val': 0.0740597411271424, 'psi': 0.985170035514604}-{'f1_val': 0.9697500154541285, 'auprc': 0.9987193999364375, 'loss_val': 0.07588723325194416, 'psi': 0.9813377692470522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=52 head_norm_before_train=1.579212 cos_to_last_merge=0.9824 (last merge round=34)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933810768175657, 'loss_val': 0.02747887447617689, 'psi': 0.9951024875945929}-{'f1_val': 0.9958312226609984, 'auprc': 0.9952177145234754, 'loss_val': 0.027908472539053295, 'psi': 0.9955858194059892}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=2.026750 cos_to_last_merge=0.9659 (last merge round=34)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933840075009351, 'loss_val': 0.028579782219539322, 'psi': 0.994466306411999}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934870373351142, 'loss_val': 0.028727996772149555, 'psi': 0.9945075183456705}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.651882 cos_to_last_merge=0.9733 (last merge round=35)
[S11] round=52 local utility u=0.410332 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963397567373471, 'loss_val': 0.03221442257141903, 'psi': 0.9962161076429245}-{'f1_val': 0.8811851487798028, 'auprc': 0.9961597208802804, 'loss_val': 0.16264625211114864, 'psi': 0.9271749776199938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=52 head_norm_before_train=1.747455 cos_to_last_merge=0.9964 (last merge round=39)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6482654523455781, 'auprc': 0.7798521993020583, 'loss_val': 0.8448850115041904, 'psi': 0.7009001511281702}-{'f1_val': 0.7707924899517063, 'auprc': 0.7927378824234363, 'loss_val': 0.6089239168565557, 'psi': 0.7795706469403983}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.798906 cos_to_last_merge=0.9850 (last merge round=39)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990423461276092, 'loss_val': 0.023002186959158517, 'psi': 0.9979611524745196}-{'f1_val': 0.9976511180498535, 'auprc': 0.9989625482791935, 'loss_val': 0.023727549798254127, 'psi': 0.9981756901415896}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.896410 cos_to_last_merge=0.9791 (last merge round=41)
[S15] round=52 local utility u=0.534263 metrics={'f1_val': 0.9492129263771055, 'auprc': 0.9978451334876168, 'loss_val': 0.09383026289677814, 'psi': 0.9686658092213101}-{'f1_val': 0.8216091246569885, 'auprc': 0.996031808844188, 'loss_val': 0.39129336768624295, 'psi': 0.8913781983318683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=52 head_norm_before_train=1.742637 cos_to_last_merge=0.9745 (last merge round=41)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8442597085468174, 'auprc': 0.9115117349368422, 'loss_val': 1.00203100784728, 'psi': 0.8711605191028273}-{'f1_val': 0.8626155541101482, 'auprc': 0.981946396345865, 'loss_val': 0.7539068362506991, 'psi': 0.9103478910044349}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.603867 cos_to_last_merge=0.9922 (last merge round=40)
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6782706677416263, 'auprc': 0.7653414502358543, 'loss_val': 1.0385364963123864, 'psi': 0.7130989807393175}-{'f1_val': 0.7273043980555717, 'auprc': 0.7673719836017543, 'loss_val': 0.9013592210707425, 'psi': 0.7433314322740447}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.901049 cos_to_last_merge=0.9777 (last merge round=41)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.7085689075270323, 'auprc': 0.9874091227719595, 'loss_val': 0.6126256186929737, 'psi': 0.8201049936250031}-{'f1_val': 0.7097739039748207, 'auprc': 0.9831292388392037, 'loss_val': 0.5948830389803746, 'psi': 0.819116037920574}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=1.555233 cos_to_last_merge=0.9931 (last merge round=40)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.7600421914196913, 'auprc': 0.9435966200408499, 'loss_val': 0.6894113983029893, 'psi': 0.8334639628681547}-{'f1_val': 0.9717893715706358, 'auprc': 0.999730782321521, 'loss_val': 0.09918087585014479, 'psi': 0.9829659358709899}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.917751 cos_to_last_merge=0.9961 (last merge round=41)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9372231045479529, 'auprc': 0.9443885659839742, 'loss_val': 0.2723902522328942, 'psi': 0.9400892891223614}-{'f1_val': 0.9381166447012119, 'auprc': 0.9409245545270732, 'loss_val': 0.23093445532710163, 'psi': 0.9392398086315564}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.526510 cos_to_last_merge=0.9857 (last merge round=38)
[S5] round=53 local utility u=0.289109 metrics={'f1_val': 0.9846278149500954, 'auprc': 0.9905339882748209, 'loss_val': 0.09248917827000129, 'psi': 0.9869902842799856}-{'f1_val': 0.8947341009258087, 'auprc': 0.9910833799466949, 'loss_val': 0.1329924084287224, 'psi': 0.9332738125341632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=53 head_norm_before_train=1.907964 cos_to_last_merge=0.8061 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.9095715279997699, 'auprc': 0.9664600120333764, 'loss_val': 0.24957272666944397, 'psi': 0.9323269216132126}-{'f1_val': 0.6523580125698685, 'auprc': 0.8516323114023735, 'loss_val': 1.1309022904739665, 'psi': 0.7320677321028706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=53 head_norm_before_train=1.771823 cos_to_last_merge=0.9991 (last merge round=39)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.481736299811144, 'auprc': 0.781362221697743, 'loss_val': 0.9929921110914482, 'psi': 0.6015866685657836}-{'f1_val': 0.6243347197765503, 'auprc': 0.8006848367013264, 'loss_val': 0.5136622587656692, 'psi': 0.6948747665464607}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=2.235387 (no previous merge yet)
[S8] round=53 local utility u=0.058609 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9973599796113267, 'loss_val': 0.033214999147883596, 'psi': 0.9927295883289011}-{'f1_val': 0.9765245049040738, 'auprc': 0.9981383314303993, 'loss_val': 0.0740597411271424, 'psi': 0.985170035514604}
[S8] not sending this round → trigger blocked (psi=0.993)
[S9] START round=53 head_norm_before_train=1.589058 cos_to_last_merge=0.9817 (last merge round=34)
[S9] round=53 local utility u=0.008302 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9983570510721949, 'loss_val': 0.025779257004182092, 'psi': 0.9970904894084094}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933810768175657, 'loss_val': 0.02747887447617689, 'psi': 0.9951024875945929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=53 head_norm_before_train=2.038883 cos_to_last_merge=0.9648 (last merge round=34)
[S10] round=53 local utility u=0.000346 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935025634956038, 'loss_val': 0.028242623391492864, 'psi': 0.9945137288098664}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933840075009351, 'loss_val': 0.028579782219539322, 'psi': 0.994466306411999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=53 head_norm_before_train=1.661553 cos_to_last_merge=0.9725 (last merge round=35)
[S11] round=53 local utility u=0.004602 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977920725825236, 'loss_val': 0.029847562782639864, 'psi': 0.9970450317411632}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963397567373471, 'loss_val': 0.03221442257141903, 'psi': 0.9962161076429245}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=53 head_norm_before_train=1.754257 cos_to_last_merge=0.9961 (last merge round=39)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6372758109825014, 'auprc': 0.683847520134846, 'loss_val': 1.0889318518473186, 'psi': 0.6559044946434391}-{'f1_val': 0.6482654523455781, 'auprc': 0.7798521993020583, 'loss_val': 0.8448850115041904, 'psi': 0.7009001511281702}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.809407 cos_to_last_merge=0.9843 (last merge round=39)
[S14] round=53 local utility u=0.000454 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990455388576127, 'loss_val': 0.02210376079228048, 'psi': 0.9979624295665209}-{'f1_val': 0.997240356705793, 'auprc': 0.9990423461276092, 'loss_val': 0.023002186959158517, 'psi': 0.9979611524745196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=53 head_norm_before_train=1.912202 cos_to_last_merge=0.9778 (last merge round=41)
[S15] round=53 local utility u=0.090664 metrics={'f1_val': 0.9721105134282231, 'auprc': 0.9985512826439817, 'loss_val': 0.05200594705064482, 'psi': 0.9826868211145265}-{'f1_val': 0.9492129263771055, 'auprc': 0.9978451334876168, 'loss_val': 0.09383026289677814, 'psi': 0.9686658092213101}
[S15] not sending this round → trigger blocked (psi=0.983)
[S16] START round=53 head_norm_before_train=1.754866 cos_to_last_merge=0.9732 (last merge round=41)
[S16] round=53 local utility u=0.078062 metrics={'f1_val': 0.8485444772753824, 'auprc': 0.9416658678141577, 'loss_val': 0.9620785687324512, 'psi': 0.8857930334908926}-{'f1_val': 0.8442597085468174, 'auprc': 0.9115117349368422, 'loss_val': 1.00203100784728, 'psi': 0.8711605191028273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=53 head_norm_before_train=1.616166 cos_to_last_merge=0.9914 (last merge round=40)
[S17] round=53 local utility u=0.047508 metrics={'f1_val': 0.6715929829788323, 'auprc': 0.7958513867870427, 'loss_val': 0.994984274508859, 'psi': 0.7212963445021164}-{'f1_val': 0.6782706677416263, 'auprc': 0.7653414502358543, 'loss_val': 1.0385364963123864, 'psi': 0.7130989807393175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=54 head_norm_before_train=1.911409 cos_to_last_merge=0.9768 (last merge round=41)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.709775813010622, 'auprc': 0.9502329364841925, 'loss_val': 0.595095642536187, 'psi': 0.8059586624000502}-{'f1_val': 0.7085689075270323, 'auprc': 0.9874091227719595, 'loss_val': 0.6126256186929737, 'psi': 0.8201049936250031}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=1.564080 cos_to_last_merge=0.9924 (last merge round=40)
[S3] round=54 local utility u=0.546029 metrics={'f1_val': 0.8667248991333039, 'auprc': 0.9751467177118439, 'loss_val': 0.33209999312896243, 'psi': 0.9100936265647198}-{'f1_val': 0.7600421914196913, 'auprc': 0.9435966200408499, 'loss_val': 0.6894113983029893, 'psi': 0.8334639628681547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=54 head_norm_before_train=1.920709 cos_to_last_merge=0.9942 (last merge round=41)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9384796160321633, 'auprc': 0.9385003761940421, 'loss_val': 0.29827197304046454, 'psi': 0.9384879200969148}-{'f1_val': 0.9372231045479529, 'auprc': 0.9443885659839742, 'loss_val': 0.2723902522328942, 'psi': 0.9400892891223614}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.539402 cos_to_last_merge=0.9844 (last merge round=38)
[S5] round=54 local utility u=0.069218 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9983978390509848, 'loss_val': 0.052294789394683704, 'psi': 0.9976008707870325}-{'f1_val': 0.9846278149500954, 'auprc': 0.9905339882748209, 'loss_val': 0.09248917827000129, 'psi': 0.9869902842799856}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=54 head_norm_before_train=1.917561 cos_to_last_merge=0.8049 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.6433240958280636, 'auprc': 0.7089788900717757, 'loss_val': 1.162251407161033, 'psi': 0.6695860135255485}-{'f1_val': 0.9095715279997699, 'auprc': 0.9664600120333764, 'loss_val': 0.24957272666944397, 'psi': 0.9323269216132126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.779074 cos_to_last_merge=0.9989 (last merge round=39)
[S7] round=54 local utility u=0.726184 metrics={'f1_val': 0.6326191473386267, 'auprc': 0.8026666104314266, 'loss_val': 0.509834557744267, 'psi': 0.7006381325757467}-{'f1_val': 0.481736299811144, 'auprc': 0.781362221697743, 'loss_val': 0.9929921110914482, 'psi': 0.6015866685657836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=54 head_norm_before_train=2.239100 (no previous merge yet)
[S8] round=54 local utility u=0.007915 metrics={'f1_val': 0.9919847577438384, 'auprc': 0.9984689440065287, 'loss_val': 0.03476457087042123, 'psi': 0.9945784322489146}-{'f1_val': 0.9896426608072839, 'auprc': 0.9973599796113267, 'loss_val': 0.033214999147883596, 'psi': 0.9927295883289011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=54 head_norm_before_train=1.598847 cos_to_last_merge=0.9809 (last merge round=34)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9983085818450399, 'loss_val': 0.02645185873422575, 'psi': 0.996422736571985}-{'f1_val': 0.9962461149658858, 'auprc': 0.9983570510721949, 'loss_val': 0.025779257004182092, 'psi': 0.9970904894084094}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.048533 cos_to_last_merge=0.9641 (last merge round=34)
[S10] round=54 local utility u=0.000381 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993662680155849, 'loss_val': 0.027960058378994224, 'psi': 0.9945777754739644}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935025634956038, 'loss_val': 0.028242623391492864, 'psi': 0.9945137288098664}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=54 head_norm_before_train=1.671135 cos_to_last_merge=0.9717 (last merge round=35)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9898470589560546, 'auprc': 0.9977929039081753, 'loss_val': 0.04969302135860509, 'psi': 0.993025396936903}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977920725825236, 'loss_val': 0.029847562782639864, 'psi': 0.9970450317411632}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.758459 cos_to_last_merge=0.9959 (last merge round=39)
[S13] round=54 local utility u=0.451980 metrics={'f1_val': 0.7539440541114419, 'auprc': 0.6925970201985963, 'loss_val': 0.9112291977150815, 'psi': 0.7294052405463036}-{'f1_val': 0.6372758109825014, 'auprc': 0.683847520134846, 'loss_val': 1.0889318518473186, 'psi': 0.6559044946434391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=54 head_norm_before_train=1.819502 cos_to_last_merge=0.9837 (last merge round=39)
[S14] round=54 local utility u=0.000067 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9989027885901656, 'loss_val': 0.022686648775841686, 'psi': 0.9980197457404438}-{'f1_val': 0.997240356705793, 'auprc': 0.9990455388576127, 'loss_val': 0.02210376079228048, 'psi': 0.9979624295665209}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=54 head_norm_before_train=1.927963 cos_to_last_merge=0.9765 (last merge round=41)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.8856116121774232, 'auprc': 0.9963433560893156, 'loss_val': 0.32756574538795274, 'psi': 0.9299043097421802}-{'f1_val': 0.9721105134282231, 'auprc': 0.9985512826439817, 'loss_val': 0.05200594705064482, 'psi': 0.9826868211145265}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.766259 cos_to_last_merge=0.9720 (last merge round=41)
[S16] round=54 local utility u=0.110224 metrics={'f1_val': 0.8532536855220553, 'auprc': 0.9779961472563863, 'loss_val': 0.8788773982399303, 'psi': 0.9031506702157877}-{'f1_val': 0.8485444772753824, 'auprc': 0.9416658678141577, 'loss_val': 0.9620785687324512, 'psi': 0.8857930334908926}
[S16] not sending this round → trigger blocked (psi=0.903)
[S17] START round=54 head_norm_before_train=1.626194 cos_to_last_merge=0.9906 (last merge round=40)
[S17] round=54 local utility u=0.394629 metrics={'f1_val': 0.7562873059687872, 'auprc': 0.8255461255095523, 'loss_val': 0.8029761011951242, 'psi': 0.7839908337850933}-{'f1_val': 0.6715929829788323, 'auprc': 0.7958513867870427, 'loss_val': 0.994984274508859, 'psi': 0.7212963445021164}
[S17] not sending this round → trigger blocked (psi=0.784)
[S2] START round=55 head_norm_before_train=1.924261 cos_to_last_merge=0.9759 (last merge round=41)
[S2] round=55 local utility u=0.011538 metrics={'f1_val': 0.7098533133664822, 'auprc': 0.95877168849182, 'loss_val': 0.5981007510291947, 'psi': 0.8094206634166173}-{'f1_val': 0.709775813010622, 'auprc': 0.9502329364841925, 'loss_val': 0.595095642536187, 'psi': 0.8059586624000502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=55 head_norm_before_train=1.572634 cos_to_last_merge=0.9918 (last merge round=40)
[S3] round=55 local utility u=0.576224 metrics={'f1_val': 0.9976332263435914, 'auprc': 0.9998559200818309, 'loss_val': 0.0392300725677711, 'psi': 0.9985223038388873}-{'f1_val': 0.8667248991333039, 'auprc': 0.9751467177118439, 'loss_val': 0.33209999312896243, 'psi': 0.9100936265647198}
[S3] not sending this round → trigger blocked (psi=0.999)
[S4] START round=55 head_norm_before_train=1.928154 cos_to_last_merge=0.9926 (last merge round=41)
[S4] round=55 local utility u=0.013464 metrics={'f1_val': 0.9400972684666257, 'auprc': 0.9435724100456927, 'loss_val': 0.29626584822034746, 'psi': 0.9414873250982525}-{'f1_val': 0.9384796160321633, 'auprc': 0.9385003761940421, 'loss_val': 0.29827197304046454, 'psi': 0.9384879200969148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=55 head_norm_before_train=1.549332 cos_to_last_merge=0.9834 (last merge round=38)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.7712380768001906, 'auprc': 0.9897034214322872, 'loss_val': 0.23425481489161212, 'psi': 0.8586242146530292}-{'f1_val': 0.9970695586110643, 'auprc': 0.9983978390509848, 'loss_val': 0.052294789394683704, 'psi': 0.9976008707870325}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.928466 cos_to_last_merge=0.8037 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.804
[S6] round=55 local utility u=0.525479 metrics={'f1_val': 0.7130552532956581, 'auprc': 0.8459196510678655, 'loss_val': 0.9405026301946104, 'psi': 0.7662010124045411}-{'f1_val': 0.6433240958280636, 'auprc': 0.7089788900717757, 'loss_val': 1.162251407161033, 'psi': 0.6695860135255485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=55 head_norm_before_train=1.784084 cos_to_last_merge=0.9988 (last merge round=39)
[S7] round=55 local utility u=0.523162 metrics={'f1_val': 0.6960778499844626, 'auprc': 0.9247884591961073, 'loss_val': 0.2106289456350498, 'psi': 0.7875620936691206}-{'f1_val': 0.6326191473386267, 'auprc': 0.8026666104314266, 'loss_val': 0.509834557744267, 'psi': 0.7006381325757467}
[S7] not sending this round → trigger blocked (psi=0.788)
[S8] START round=55 head_norm_before_train=2.238901 (no previous merge yet)
[S8] round=55 local utility u=0.011432 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9988323678833647, 'loss_val': 0.025911211205210612, 'psi': 0.9960158033160307}-{'f1_val': 0.9919847577438384, 'auprc': 0.9984689440065287, 'loss_val': 0.03476457087042123, 'psi': 0.9945784322489146}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=55 head_norm_before_train=1.607864 cos_to_last_merge=0.9802 (last merge round=34)
[S9] round=55 local utility u=0.002890 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9982788354356711, 'loss_val': 0.0255641342868223, 'psi': 0.9969090074657975}-{'f1_val': 0.9951655063899485, 'auprc': 0.9983085818450399, 'loss_val': 0.02645185873422575, 'psi': 0.996422736571985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=55 head_norm_before_train=2.057893 cos_to_last_merge=0.9633 (last merge round=34)
[S10] round=55 local utility u=0.000153 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937253793514073, 'loss_val': 0.02784296320928692, 'psi': 0.9946028551521877}-{'f1_val': 0.9951878390193748, 'auprc': 0.993662680155849, 'loss_val': 0.027960058378994224, 'psi': 0.9945777754739644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=55 head_norm_before_train=1.679481 cos_to_last_merge=0.9711 (last merge round=35)
[S11] round=55 local utility u=0.030123 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980845878211796, 'loss_val': 0.029069910287170913, 'psi': 0.9970169356097884}-{'f1_val': 0.9898470589560546, 'auprc': 0.9977929039081753, 'loss_val': 0.04969302135860509, 'psi': 0.993025396936903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=55 head_norm_before_train=1.759981 cos_to_last_merge=0.9958 (last merge round=39)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.7447201979837594, 'auprc': 0.6970085129985641, 'loss_val': 0.9532042858167514, 'psi': 0.7256355239896812}-{'f1_val': 0.7539440541114419, 'auprc': 0.6925970201985963, 'loss_val': 0.9112291977150815, 'psi': 0.7294052405463036}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.831548 cos_to_last_merge=0.9829 (last merge round=39)
[S14] round=55 local utility u=0.000688 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9987609149017764, 'loss_val': 0.02088553081967636, 'psi': 0.9979629962650882}-{'f1_val': 0.9974310505072961, 'auprc': 0.9989027885901656, 'loss_val': 0.022686648775841686, 'psi': 0.9980197457404438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=55 head_norm_before_train=1.943086 cos_to_last_merge=0.9753 (last merge round=41)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.8794340911204584, 'auprc': 0.9961439127025189, 'loss_val': 0.33883257599365846, 'psi': 0.9261180197532827}-{'f1_val': 0.8856116121774232, 'auprc': 0.9963433560893156, 'loss_val': 0.32756574538795274, 'psi': 0.9299043097421802}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.776330 cos_to_last_merge=0.9710 (last merge round=41)
[S16] round=55 local utility u=0.831349 metrics={'f1_val': 0.9894279697398181, 'auprc': 0.9870970647392413, 'loss_val': 0.060527463702653425, 'psi': 0.9884956077395873}-{'f1_val': 0.8532536855220553, 'auprc': 0.9779961472563863, 'loss_val': 0.8788773982399303, 'psi': 0.9031506702157877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=55 head_norm_before_train=1.641477 cos_to_last_merge=0.9895 (last merge round=40)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6378978610584833, 'auprc': 0.8803042802371721, 'loss_val': 1.2850428444988464, 'psi': 0.7348604287299589}-{'f1_val': 0.7562873059687872, 'auprc': 0.8255461255095523, 'loss_val': 0.8029761011951242, 'psi': 0.7839908337850933}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=1.940057 cos_to_last_merge=0.9747 (last merge round=41)
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.709670557531711, 'auprc': 0.9085019330950592, 'loss_val': 0.6014672816415073, 'psi': 0.7892031077570503}-{'f1_val': 0.7098533133664822, 'auprc': 0.95877168849182, 'loss_val': 0.5981007510291947, 'psi': 0.8094206634166173}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.581993 cos_to_last_merge=0.9911 (last merge round=40)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9003032360428889, 'auprc': 0.9737980218373841, 'loss_val': 0.2884605010433797, 'psi': 0.9297011503606869}-{'f1_val': 0.9976332263435914, 'auprc': 0.9998559200818309, 'loss_val': 0.0392300725677711, 'psi': 0.9985223038388873}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.940031 cos_to_last_merge=0.9921 (last merge round=41)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.937132646643735, 'auprc': 0.9291603625804633, 'loss_val': 0.3190128857211132, 'psi': 0.9339437330184264}-{'f1_val': 0.9400972684666257, 'auprc': 0.9435724100456927, 'loss_val': 0.29626584822034746, 'psi': 0.9414873250982525}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.556574 cos_to_last_merge=0.9825 (last merge round=38)
[S5] round=56 local utility u=0.777533 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9953302633932124, 'loss_val': 0.048853645841168476, 'psi': 0.9961532864443596}-{'f1_val': 0.7712380768001906, 'auprc': 0.9897034214322872, 'loss_val': 0.23425481489161212, 'psi': 0.8586242146530292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=56 head_norm_before_train=1.936566 cos_to_last_merge=0.8031 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=56 local utility u=0.073368 metrics={'f1_val': 0.712767500482845, 'auprc': 0.8680036863056683, 'loss_val': 0.8582919202489903, 'psi': 0.7748619748119743}-{'f1_val': 0.7130552532956581, 'auprc': 0.8459196510678655, 'loss_val': 0.9405026301946104, 'psi': 0.7662010124045411}
[S6] not sending this round → trigger blocked (psi=0.775)
[S7] START round=56 head_norm_before_train=1.786714 cos_to_last_merge=0.9988 (last merge round=39)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.42394414806480374, 'auprc': 0.7790356844622016, 'loss_val': 1.257937057455001, 'psi': 0.565980762623763}-{'f1_val': 0.6960778499844626, 'auprc': 0.9247884591961073, 'loss_val': 0.2106289456350498, 'psi': 0.7875620936691206}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=2.236370 (no previous merge yet)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.937572580917264, 'auprc': 0.9986224213248025, 'loss_val': 0.109521398468084, 'psi': 0.9619925170802794}-{'f1_val': 0.9941380936044745, 'auprc': 0.9988323678833647, 'loss_val': 0.025911211205210612, 'psi': 0.9960158033160307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.616427 cos_to_last_merge=0.9795 (last merge round=34)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9982928252506491, 'loss_val': 0.025813265400409468, 'psi': 0.9964164339342287}-{'f1_val': 0.9959957888192151, 'auprc': 0.9982788354356711, 'loss_val': 0.0255641342868223, 'psi': 0.9969090074657975}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.068197 cos_to_last_merge=0.9625 (last merge round=34)
[S10] round=56 local utility u=0.000381 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9939847893935696, 'loss_val': 0.027858636940096465, 'psi': 0.9947066191690527}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937253793514073, 'loss_val': 0.02784296320928692, 'psi': 0.9946028551521877}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=56 head_norm_before_train=1.687847 cos_to_last_merge=0.9704 (last merge round=35)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9903852553649821, 'auprc': 0.9978847683115789, 'loss_val': 0.04054878456011403, 'psi': 0.9933850605436207}-{'f1_val': 0.996305167468861, 'auprc': 0.9980845878211796, 'loss_val': 0.029069910287170913, 'psi': 0.9970169356097884}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.762743 cos_to_last_merge=0.9957 (last merge round=39)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6345698488032361, 'auprc': 0.6886939830377934, 'loss_val': 1.1095239534148837, 'psi': 0.656219502497059}-{'f1_val': 0.7447201979837594, 'auprc': 0.6970085129985641, 'loss_val': 0.9532042858167514, 'psi': 0.7256355239896812}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.842652 cos_to_last_merge=0.9822 (last merge round=39)
[S14] round=56 local utility u=0.000237 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990457302450644, 'loss_val': 0.020122502982107368, 'psi': 0.9979625061215016}-{'f1_val': 0.9974310505072961, 'auprc': 0.9987609149017764, 'loss_val': 0.02088553081967636, 'psi': 0.9979629962650882}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=56 head_norm_before_train=1.957361 cos_to_last_merge=0.9741 (last merge round=41)
[S15] round=56 local utility u=0.513993 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979843963085056, 'loss_val': 0.0202444606796931, 'psi': 0.9972417595559145}-{'f1_val': 0.8794340911204584, 'auprc': 0.9961439127025189, 'loss_val': 0.33883257599365846, 'psi': 0.9261180197532827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=56 head_norm_before_train=1.785746 cos_to_last_merge=0.9701 (last merge round=41)
[S16] round=56 local utility u=0.003771 metrics={'f1_val': 0.9896487978717503, 'auprc': 0.9881984876157889, 'loss_val': 0.05761529815266334, 'psi': 0.9890686737693658}-{'f1_val': 0.9894279697398181, 'auprc': 0.9870970647392413, 'loss_val': 0.060527463702653425, 'psi': 0.9884956077395873}
[S16] not sending this round → trigger blocked (psi=0.989)
[S17] START round=56 head_norm_before_train=1.655332 cos_to_last_merge=0.9885 (last merge round=40)
[S17] round=56 local utility u=0.188310 metrics={'f1_val': 0.6907032110225407, 'auprc': 0.8120796382026139, 'loss_val': 1.0205817184520114, 'psi': 0.73925378189457}-{'f1_val': 0.6378978610584833, 'auprc': 0.8803042802371721, 'loss_val': 1.2850428444988464, 'psi': 0.7348604287299589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=57 head_norm_before_train=1.943554 cos_to_last_merge=0.9741 (last merge round=41)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.6181338148467197, 'auprc': 0.7806694174755441, 'loss_val': 1.2778005450647032, 'psi': 0.6831480558982495}-{'f1_val': 0.709670557531711, 'auprc': 0.9085019330950592, 'loss_val': 0.6014672816415073, 'psi': 0.7892031077570503}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=1.591254 cos_to_last_merge=0.9905 (last merge round=40)
[S3] round=57 local utility u=0.414404 metrics={'f1_val': 0.9860240940432446, 'auprc': 0.999832801739337, 'loss_val': 0.052082932663747264, 'psi': 0.9915475771216816}-{'f1_val': 0.9003032360428889, 'auprc': 0.9737980218373841, 'loss_val': 0.2884605010433797, 'psi': 0.9297011503606869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=57 head_norm_before_train=1.951701 cos_to_last_merge=0.9925 (last merge round=41)
[S4] round=57 local utility u=0.033179 metrics={'f1_val': 0.9403510159988078, 'auprc': 0.9450540852082288, 'loss_val': 0.3196457605952411, 'psi': 0.9422322436825761}-{'f1_val': 0.937132646643735, 'auprc': 0.9291603625804633, 'loss_val': 0.3190128857211132, 'psi': 0.9339437330184264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=57 head_norm_before_train=1.562781 cos_to_last_merge=0.9816 (last merge round=38)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.995652436857004, 'loss_val': 0.05297579183733476, 'psi': 0.9965027099094402}-{'f1_val': 0.9967019684784577, 'auprc': 0.9953302633932124, 'loss_val': 0.048853645841168476, 'psi': 0.9961532864443596}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.950050 cos_to_last_merge=0.8021 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.802
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.6792096760150357, 'auprc': 0.8525504178146268, 'loss_val': 1.1134911242365293, 'psi': 0.7485459727348722}-{'f1_val': 0.712767500482845, 'auprc': 0.8680036863056683, 'loss_val': 0.8582919202489903, 'psi': 0.7748619748119743}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.785585 cos_to_last_merge=0.9987 (last merge round=39)
[S7] round=57 local utility u=1.000000 metrics={'f1_val': 0.6933900308858841, 'auprc': 0.8655341683586224, 'loss_val': 0.252897733434653, 'psi': 0.7622476858749795}-{'f1_val': 0.42394414806480374, 'auprc': 0.7790356844622016, 'loss_val': 1.257937057455001, 'psi': 0.565980762623763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=57 head_norm_before_train=2.240482 (no previous merge yet)
[S8] round=57 local utility u=0.207573 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9991523855865666, 'loss_val': 0.02789368655196717, 'psi': 0.9953972777135959}-{'f1_val': 0.937572580917264, 'auprc': 0.9986224213248025, 'loss_val': 0.109521398468084, 'psi': 0.9619925170802794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=57 head_norm_before_train=1.623429 cos_to_last_merge=0.9790 (last merge round=34)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9982773103283882, 'loss_val': 0.029612564184052354, 'psi': 0.9956567884670269}-{'f1_val': 0.9951655063899485, 'auprc': 0.9982928252506491, 'loss_val': 0.025813265400409468, 'psi': 0.9964164339342287}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.074012 cos_to_last_merge=0.9621 (last merge round=34)
[S10] round=57 local utility u=0.000176 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941173202647713, 'loss_val': 0.027903812309321943, 'psi': 0.9947596315175333}-{'f1_val': 0.9951878390193748, 'auprc': 0.9939847893935696, 'loss_val': 0.027858636940096465, 'psi': 0.9947066191690527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=57 head_norm_before_train=1.695454 cos_to_last_merge=0.9698 (last merge round=35)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9942288708308418, 'auprc': 0.9963365892153156, 'loss_val': 0.06457983509547353, 'psi': 0.9950719581846312}-{'f1_val': 0.9903852553649821, 'auprc': 0.9978847683115789, 'loss_val': 0.04054878456011403, 'psi': 0.9933850605436207}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.769230 cos_to_last_merge=0.9955 (last merge round=39)
[S13] round=57 local utility u=0.555006 metrics={'f1_val': 0.774084375922244, 'auprc': 0.7111283639932677, 'loss_val': 0.9039016703942208, 'psi': 0.7489019711506535}-{'f1_val': 0.6345698488032361, 'auprc': 0.6886939830377934, 'loss_val': 1.1095239534148837, 'psi': 0.656219502497059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=57 head_norm_before_train=1.853843 cos_to_last_merge=0.9815 (last merge round=39)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.997240356705793, 'auprc': 0.999046961144602, 'loss_val': 0.020135397356911267, 'psi': 0.9979629984813166}-{'f1_val': 0.997240356705793, 'auprc': 0.9990457302450644, 'loss_val': 0.020122502982107368, 'psi': 0.9979625061215016}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.970838 cos_to_last_merge=0.9730 (last merge round=41)
[S15] round=57 local utility u=0.000410 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998210810665107, 'loss_val': 0.02010459687940535, 'psi': 0.9973323252985551}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979843963085056, 'loss_val': 0.0202444606796931, 'psi': 0.9972417595559145}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=57 head_norm_before_train=1.795923 cos_to_last_merge=0.9690 (last merge round=41)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9381732676932465, 'auprc': 0.9876932991609143, 'loss_val': 0.277853415381112, 'psi': 0.9579812802803136}-{'f1_val': 0.9896487978717503, 'auprc': 0.9881984876157889, 'loss_val': 0.05761529815266334, 'psi': 0.9890686737693658}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.667326 cos_to_last_merge=0.9876 (last merge round=40)
[S17] round=57 local utility u=0.129657 metrics={'f1_val': 0.7291590627411804, 'auprc': 0.7834612202060854, 'loss_val': 0.9061467502112119, 'psi': 0.7508799257271423}-{'f1_val': 0.6907032110225407, 'auprc': 0.8120796382026139, 'loss_val': 1.0205817184520114, 'psi': 0.73925378189457}
[S17] not sending this round → trigger blocked (psi=0.751)
[S2] START round=58 head_norm_before_train=1.953087 cos_to_last_merge=0.9731 (last merge round=41)
[S2] round=58 local utility u=0.696970 metrics={'f1_val': 0.7061810228832489, 'auprc': 0.8493152587625317, 'loss_val': 0.6180819061688547, 'psi': 0.763434717234962}-{'f1_val': 0.6181338148467197, 'auprc': 0.7806694174755441, 'loss_val': 1.2778005450647032, 'psi': 0.6831480558982495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=58 head_norm_before_train=1.600400 cos_to_last_merge=0.9899 (last merge round=40)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9008696076649018, 'auprc': 0.9790748882591203, 'loss_val': 0.2459779466484842, 'psi': 0.9321517199025893}-{'f1_val': 0.9860240940432446, 'auprc': 0.999832801739337, 'loss_val': 0.052082932663747264, 'psi': 0.9915475771216816}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.962543 cos_to_last_merge=0.9927 (last merge round=41)
[S4] round=58 local utility u=0.001599 metrics={'f1_val': 0.9402426221049902, 'auprc': 0.9368133555504992, 'loss_val': 0.29107532506690403, 'psi': 0.9388709154831938}-{'f1_val': 0.9403510159988078, 'auprc': 0.9450540852082288, 'loss_val': 0.3196457605952411, 'psi': 0.9422322436825761}
[S4] not sending this round → trigger blocked (psi=0.939)
[S5] START round=58 head_norm_before_train=1.568021 cos_to_last_merge=0.9809 (last merge round=38)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9912727587926763, 'loss_val': 0.06699316986018351, 'psi': 0.9943093906952045}-{'f1_val': 0.9970695586110643, 'auprc': 0.995652436857004, 'loss_val': 0.05297579183733476, 'psi': 0.9965027099094402}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.966073 cos_to_last_merge=0.8009 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.801
[S6] round=58 local utility u=0.272696 metrics={'f1_val': 0.7241612933606099, 'auprc': 0.9075830359871415, 'loss_val': 1.0029060587870555, 'psi': 0.7975299904112225}-{'f1_val': 0.6792096760150357, 'auprc': 0.8525504178146268, 'loss_val': 1.1134911242365293, 'psi': 0.7485459727348722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=58 head_norm_before_train=1.785154 cos_to_last_merge=0.9987 (last merge round=39)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5097760920594971, 'auprc': 0.7798180189033159, 'loss_val': 0.8716735848890348, 'psi': 0.6177928627970246}-{'f1_val': 0.6933900308858841, 'auprc': 0.8655341683586224, 'loss_val': 0.252897733434653, 'psi': 0.7622476858749795}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=2.241060 (no previous merge yet)
[S8] round=58 local utility u=0.001081 metrics={'f1_val': 0.9931832866490584, 'auprc': 0.9989515094496939, 'loss_val': 0.026866377810485495, 'psi': 0.9954905757693127}-{'f1_val': 0.9928938724649488, 'auprc': 0.9991523855865666, 'loss_val': 0.02789368655196717, 'psi': 0.9953972777135959}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=58 head_norm_before_train=1.630530 cos_to_last_merge=0.9784 (last merge round=34)
[S9] round=58 local utility u=0.005364 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9950493364503165, 'loss_val': 0.024203202520078234, 'psi': 0.9958658459804591}-{'f1_val': 0.993909773892786, 'auprc': 0.9982773103283882, 'loss_val': 0.029612564184052354, 'psi': 0.9956567884670269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=58 head_norm_before_train=2.080596 cos_to_last_merge=0.9616 (last merge round=34)
[S10] round=58 local utility u=0.000102 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940744355012286, 'loss_val': 0.027571978147464545, 'psi': 0.9947424776121163}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941173202647713, 'loss_val': 0.027903812309321943, 'psi': 0.9947596315175333}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=58 head_norm_before_train=1.702562 cos_to_last_merge=0.9691 (last merge round=35)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9091692346918955, 'auprc': 0.9961171722001652, 'loss_val': 0.11764736458709668, 'psi': 0.9439484096952033}-{'f1_val': 0.9942288708308418, 'auprc': 0.9963365892153156, 'loss_val': 0.06457983509547353, 'psi': 0.9950719581846312}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.776412 cos_to_last_merge=0.9952 (last merge round=39)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6638622171306825, 'auprc': 0.7244624572983368, 'loss_val': 0.9514225235053907, 'psi': 0.6881023131977442}-{'f1_val': 0.774084375922244, 'auprc': 0.7111283639932677, 'loss_val': 0.9039016703942208, 'psi': 0.7489019711506535}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.860516 cos_to_last_merge=0.9810 (last merge round=39)
[S14] round=58 local utility u=0.000637 metrics={'f1_val': 0.997871830388708, 'auprc': 0.9986667394505779, 'loss_val': 0.02150874187284356, 'psi': 0.998189794013456}-{'f1_val': 0.997240356705793, 'auprc': 0.999046961144602, 'loss_val': 0.020135397356911267, 'psi': 0.9979629984813166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=58 head_norm_before_train=1.983370 cos_to_last_merge=0.9720 (last merge round=41)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7044340721055128, 'auprc': 0.9157921642337494, 'loss_val': 0.6847392698688837, 'psi': 0.7889773089568075}-{'f1_val': 0.9967466683875206, 'auprc': 0.998210810665107, 'loss_val': 0.02010459687940535, 'psi': 0.9973323252985551}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.806552 cos_to_last_merge=0.9680 (last merge round=41)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.898056356649869, 'auprc': 0.9862148147718034, 'loss_val': 0.5021319313274843, 'psi': 0.9333197398986428}-{'f1_val': 0.9381732676932465, 'auprc': 0.9876932991609143, 'loss_val': 0.277853415381112, 'psi': 0.9579812802803136}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.681515 cos_to_last_merge=0.9867 (last merge round=40)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.7254768990643331, 'auprc': 0.7599099928012674, 'loss_val': 1.005340759666386, 'psi': 0.7392501365591069}-{'f1_val': 0.7291590627411804, 'auprc': 0.7834612202060854, 'loss_val': 0.9061467502112119, 'psi': 0.7508799257271423}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.965782 cos_to_last_merge=0.9720 (last merge round=41)
[S2] round=59 local utility u=0.226887 metrics={'f1_val': 0.709594583229476, 'auprc': 0.9919455057951623, 'loss_val': 0.6126804864679034, 'psi': 0.8225349522557506}-{'f1_val': 0.7061810228832489, 'auprc': 0.8493152587625317, 'loss_val': 0.6180819061688547, 'psi': 0.763434717234962}
[S2] not sending this round → trigger blocked (psi=0.823)
[S2] r=60 psi=0.823 u=0.2269 p_local=0.1701 f1=0.710 auprc=0.992 bytes=43181
[S3] START round=59 head_norm_before_train=1.610292 cos_to_last_merge=0.9894 (last merge round=40)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.6759675009310304, 'auprc': 0.8563001208589323, 'loss_val': 1.0967195607303284, 'psi': 0.7481005489021911}-{'f1_val': 0.9008696076649018, 'auprc': 0.9790748882591203, 'loss_val': 0.2459779466484842, 'psi': 0.9321517199025893}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.748 u=0.0000 p_local=0.1962 f1=0.676 auprc=0.856 bytes=44949
[S4] START round=59 head_norm_before_train=1.972705 cos_to_last_merge=0.9929 (last merge round=41)
[S4] round=59 local utility u=0.041325 metrics={'f1_val': 0.9410575172586546, 'auprc': 0.9689720672887063, 'loss_val': 0.3097905717357973, 'psi': 0.9522233372706753}-{'f1_val': 0.9402426221049902, 'auprc': 0.9368133555504992, 'loss_val': 0.29107532506690403, 'psi': 0.9388709154831938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S4] r=60 psi=0.952 u=0.0413 p_local=0.0156 f1=0.941 auprc=0.969 bytes=52225
[S5] START round=59 head_norm_before_train=1.574580 cos_to_last_merge=0.9801 (last merge round=38)
[S5] round=59 local utility u=0.017647 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9950949441949499, 'loss_val': 0.04537421050646389, 'psi': 0.9960591587650546}-{'f1_val': 0.9963338119635569, 'auprc': 0.9912727587926763, 'loss_val': 0.06699316986018351, 'psi': 0.9943093906952045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S5] r=60 psi=0.996 u=0.0176 p_local=0.1390 f1=0.997 auprc=0.995 bytes=48603
[S6] START round=59 head_norm_before_train=1.976003 cos_to_last_merge=0.7993 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.799
[S6] round=59 local utility u=0.369381 metrics={'f1_val': 0.787022456099821, 'auprc': 0.9210741455906446, 'loss_val': 0.6817839613580428, 'psi': 0.8406431318961505}-{'f1_val': 0.7241612933606099, 'auprc': 0.9075830359871415, 'loss_val': 1.0029060587870555, 'psi': 0.7975299904112225}
[S6] not sending this round → trigger blocked (psi=0.841)
[S6] r=60 psi=0.841 u=0.3694 p_local=0.2625 f1=0.787 auprc=0.921 bytes=41391
[S7] START round=59 head_norm_before_train=1.785672 cos_to_last_merge=0.9987 (last merge round=39)
[S7] round=59 local utility u=0.924910 metrics={'f1_val': 0.6862570230008466, 'auprc': 0.8462733745051731, 'loss_val': 0.2801051684108101, 'psi': 0.7502635636025772}-{'f1_val': 0.5097760920594971, 'auprc': 0.7798180189033159, 'loss_val': 0.8716735848890348, 'psi': 0.6177928627970246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=60 psi=0.750 u=0.9249 p_local=0.4409 f1=0.686 auprc=0.846 bytes=45023
[S8] START round=59 head_norm_before_train=2.247743 (no previous merge yet)
[S8] round=59 local utility u=0.005122 metrics={'f1_val': 0.9955298311535434, 'auprc': 0.9987290034219664, 'loss_val': 0.03003328466605846, 'psi': 0.9968095000609126}-{'f1_val': 0.9931832866490584, 'auprc': 0.9989515094496939, 'loss_val': 0.026866377810485495, 'psi': 0.9954905757693127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=60 psi=0.997 u=0.0051 p_local=0.0526 f1=0.996 auprc=0.999 bytes=44976
[S9] START round=59 head_norm_before_train=1.638407 cos_to_last_merge=0.9778 (last merge round=34)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9982998963925018, 'loss_val': 0.028699843446739703, 'psi': 0.9956658228926724}-{'f1_val': 0.9964101856672208, 'auprc': 0.9950493364503165, 'loss_val': 0.024203202520078234, 'psi': 0.9958658459804591}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.996 u=0.0000 p_local=0.0027 f1=0.994 auprc=0.998 bytes=46763
[S10] START round=59 head_norm_before_train=2.089497 cos_to_last_merge=0.9609 (last merge round=34)
[S10] round=59 local utility u=0.000112 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941526558290804, 'loss_val': 0.027583419780029532, 'psi': 0.9947737657432569}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940744355012286, 'loss_val': 0.027571978147464545, 'psi': 0.9947424776121163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] r=60 psi=0.995 u=0.0001 p_local=0.0003 f1=0.995 auprc=0.994 bytes=50397
[S11] START round=59 head_norm_before_train=1.710913 cos_to_last_merge=0.9684 (last merge round=35)
[S11] round=59 local utility u=0.304764 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9963942918343913, 'loss_val': 0.030737326254890143, 'psi': 0.9962379216817421}-{'f1_val': 0.9091692346918955, 'auprc': 0.9961171722001652, 'loss_val': 0.11764736458709668, 'psi': 0.9439484096952033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=60 psi=0.996 u=0.3048 p_local=0.0811 f1=0.996 auprc=0.996 bytes=50375
[S13] START round=59 head_norm_before_train=1.782094 cos_to_last_merge=0.9949 (last merge round=39)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6124908206572884, 'auprc': 0.6344409174414454, 'loss_val': 1.3915910694163107, 'psi': 0.6212708593709513}-{'f1_val': 0.6638622171306825, 'auprc': 0.7244624572983368, 'loss_val': 0.9514225235053907, 'psi': 0.6881023131977442}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.621 u=0.0000 p_local=0.1409 f1=0.612 auprc=0.634 bytes=39592
[S14] START round=59 head_norm_before_train=1.868619 cos_to_last_merge=0.9805 (last merge round=39)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9953293400777716, 'auprc': 0.9985813255487761, 'loss_val': 0.03083816466394398, 'psi': 0.9966301342661734}-{'f1_val': 0.997871830388708, 'auprc': 0.9986667394505779, 'loss_val': 0.02150874187284356, 'psi': 0.998189794013456}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0012 f1=0.995 auprc=0.999 bytes=50382
[S15] START round=59 head_norm_before_train=1.993466 cos_to_last_merge=0.9711 (last merge round=41)
[S15] round=59 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9983582044421029, 'loss_val': 0.018571587967145246, 'psi': 0.9973912828093535}-{'f1_val': 0.7044340721055128, 'auprc': 0.9157921642337494, 'loss_val': 0.6847392698688837, 'psi': 0.7889773089568075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S15] r=60 psi=0.997 u=1.0000 p_local=0.2944 f1=0.997 auprc=0.998 bytes=43214
[S16] START round=59 head_norm_before_train=1.817123 cos_to_last_merge=0.9669 (last merge round=41)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8713340949896013, 'auprc': 0.9854955580291987, 'loss_val': 0.6550626630469926, 'psi': 0.9169986802054403}-{'f1_val': 0.898056356649869, 'auprc': 0.9862148147718034, 'loss_val': 0.5021319313274843, 'psi': 0.9333197398986428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.917 u=0.0000 p_local=0.1059 f1=0.871 auprc=0.985 bytes=43193
[S17] START round=59 head_norm_before_train=1.694673 cos_to_last_merge=0.9859 (last merge round=40)
[S17] round=59 local utility u=0.298155 metrics={'f1_val': 0.7805930837229446, 'auprc': 0.7869293653232502, 'loss_val': 0.8207862113103365, 'psi': 0.7831275963630668}-{'f1_val': 0.7254768990643331, 'auprc': 0.7599099928012674, 'loss_val': 1.005340759666386, 'psi': 0.7392501365591069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S17] r=60 psi=0.783 u=0.2982 p_local=0.1936 f1=0.781 auprc=0.787 bytes=48579
[S2] START round=60 head_norm_before_train=1.974821 cos_to_last_merge=0.9713 (last merge round=41)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.595303889385403, 'auprc': 0.768926549821944, 'loss_val': 1.5994990405843197, 'psi': 0.6647529535600194}-{'f1_val': 0.709594583229476, 'auprc': 0.9919455057951623, 'loss_val': 0.6126804864679034, 'psi': 0.8225349522557506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=60 head_norm_before_train=1.618284 cos_to_last_merge=0.9890 (last merge round=40)
[S3] round=60 local utility u=1.000000 metrics={'f1_val': 0.9891220499295077, 'auprc': 0.9996474316991621, 'loss_val': 0.04872413051428414, 'psi': 0.9933322026373694}-{'f1_val': 0.6759675009310304, 'auprc': 0.8563001208589323, 'loss_val': 1.0967195607303284, 'psi': 0.7481005489021911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=60 head_norm_before_train=1.981673 cos_to_last_merge=0.9929 (last merge round=41)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9357005668731437, 'auprc': 0.9634699957969777, 'loss_val': 0.2933292213291549, 'psi': 0.9468083384426773}-{'f1_val': 0.9410575172586546, 'auprc': 0.9689720672887063, 'loss_val': 0.3097905717357973, 'psi': 0.9522233372706753}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.580641 cos_to_last_merge=0.9794 (last merge round=38)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.9600953893320666, 'auprc': 0.9903951435645657, 'loss_val': 0.09785641189459286, 'psi': 0.9722152910250663}-{'f1_val': 0.9967019684784577, 'auprc': 0.9950949441949499, 'loss_val': 0.04537421050646389, 'psi': 0.9960591587650546}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.987785 cos_to_last_merge=0.7978 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.6575768538045713, 'auprc': 0.8944944919678001, 'loss_val': 0.8552174673752683, 'psi': 0.7523439090698628}-{'f1_val': 0.787022456099821, 'auprc': 0.9210741455906446, 'loss_val': 0.6817839613580428, 'psi': 0.8406431318961505}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.787876 cos_to_last_merge=0.9986 (last merge round=39)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.569540082585246, 'auprc': 0.7823969997112789, 'loss_val': 0.809691693102891, 'psi': 0.6546828494356591}-{'f1_val': 0.6862570230008466, 'auprc': 0.8462733745051731, 'loss_val': 0.2801051684108101, 'psi': 0.7502635636025772}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=2.257140 (no previous merge yet)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9986830718350346, 'loss_val': 0.02639499582561565, 'psi': 0.9956484310027118}-{'f1_val': 0.9955298311535434, 'auprc': 0.9987290034219664, 'loss_val': 0.03003328466605846, 'psi': 0.9968095000609126}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=1.644919 cos_to_last_merge=0.9774 (last merge round=34)
[S9] round=60 local utility u=0.008669 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9983145185293134, 'loss_val': 0.023922007221454038, 'psi': 0.9969232807032544}-{'f1_val': 0.993909773892786, 'auprc': 0.9982998963925018, 'loss_val': 0.028699843446739703, 'psi': 0.9956658228926724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=60 head_norm_before_train=2.098117 cos_to_last_merge=0.9602 (last merge round=34)
[S10] round=60 local utility u=0.000062 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941339178037594, 'loss_val': 0.0274029284687401, 'psi': 0.9947662705331286}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941526558290804, 'loss_val': 0.027583419780029532, 'psi': 0.9947737657432569}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=60 head_norm_before_train=1.719888 cos_to_last_merge=0.9676 (last merge round=35)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.8705349954679498, 'auprc': 0.9960705106845283, 'loss_val': 0.16158976454312662, 'psi': 0.9207492015545813}-{'f1_val': 0.9961336749133093, 'auprc': 0.9963942918343913, 'loss_val': 0.030737326254890143, 'psi': 0.9962379216817421}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=1.782910 cos_to_last_merge=0.9948 (last merge round=39)
[S13] round=60 local utility u=0.764237 metrics={'f1_val': 0.7069289877279978, 'auprc': 0.7586349270787562, 'loss_val': 0.8023283246948659, 'psi': 0.7276113634683012}-{'f1_val': 0.6124908206572884, 'auprc': 0.6344409174414454, 'loss_val': 1.3915910694163107, 'psi': 0.6212708593709513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=60 head_norm_before_train=1.878294 cos_to_last_merge=0.9799 (last merge round=39)
[S14] round=60 local utility u=0.002520 metrics={'f1_val': 0.9953516823059178, 'auprc': 0.9990488074845103, 'loss_val': 0.027334574046889798, 'psi': 0.9968305323773547}-{'f1_val': 0.9953293400777716, 'auprc': 0.9985813255487761, 'loss_val': 0.03083816466394398, 'psi': 0.9966301342661734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=60 head_norm_before_train=2.003524 cos_to_last_merge=0.9703 (last merge round=41)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9983098471228193, 'loss_val': 0.018579677534345928, 'psi': 0.9973719398816401}-{'f1_val': 0.9967466683875206, 'auprc': 0.9983582044421029, 'loss_val': 0.018571587967145246, 'psi': 0.9973912828093535}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.827381 cos_to_last_merge=0.9659 (last merge round=41)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8678580114469535, 'auprc': 0.9871946562779499, 'loss_val': 0.6967910066831227, 'psi': 0.915592669379352}-{'f1_val': 0.8713340949896013, 'auprc': 0.9854955580291987, 'loss_val': 0.6550626630469926, 'psi': 0.9169986802054403}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=1.705472 cos_to_last_merge=0.9852 (last merge round=40)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.7693539517931356, 'auprc': 0.7853347472871061, 'loss_val': 0.856841010920676, 'psi': 0.7757462699907238}-{'f1_val': 0.7805930837229446, 'auprc': 0.7869293653232502, 'loss_val': 0.8207862113103365, 'psi': 0.7831275963630668}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=1.985139 cos_to_last_merge=0.9704 (last merge round=41)
[S2] round=61 local utility u=1.000000 metrics={'f1_val': 0.7095933961666887, 'auprc': 0.9912886977712767, 'loss_val': 0.6087193874150294, 'psi': 0.822271516808524}-{'f1_val': 0.595303889385403, 'auprc': 0.768926549821944, 'loss_val': 1.5994990405843197, 'psi': 0.6647529535600194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=61 head_norm_before_train=1.626372 cos_to_last_merge=0.9886 (last merge round=40)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.8916343892745636, 'auprc': 0.9905265592795061, 'loss_val': 0.2935941330153638, 'psi': 0.9311912572765406}-{'f1_val': 0.9891220499295077, 'auprc': 0.9996474316991621, 'loss_val': 0.04872413051428414, 'psi': 0.9933322026373694}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.987079 cos_to_last_merge=0.9927 (last merge round=41)
[S4] round=61 local utility u=0.017918 metrics={'f1_val': 0.9427417713405952, 'auprc': 0.9690907449828354, 'loss_val': 0.31660239151763864, 'psi': 0.9532813607974913}-{'f1_val': 0.9357005668731437, 'auprc': 0.9634699957969777, 'loss_val': 0.2933292213291549, 'psi': 0.9468083384426773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=61 head_norm_before_train=1.589889 cos_to_last_merge=0.9785 (last merge round=38)
[S5] round=61 local utility u=0.144697 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9954372292502583, 'loss_val': 0.04322801859939765, 'psi': 0.9961960727871779}-{'f1_val': 0.9600953893320666, 'auprc': 0.9903951435645657, 'loss_val': 0.09785641189459286, 'psi': 0.9722152910250663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] sending update (kind=head size=1810 to 1 peers)
[S6] START round=61 head_norm_before_train=1.997574 cos_to_last_merge=0.7968 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.797
[S6] round=61 local utility u=0.268516 metrics={'f1_val': 0.7547498598487928, 'auprc': 0.8793559374797746, 'loss_val': 0.8558070943027166, 'psi': 0.8045922909011856}-{'f1_val': 0.6575768538045713, 'auprc': 0.8944944919678001, 'loss_val': 0.8552174673752683, 'psi': 0.7523439090698628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=61 head_norm_before_train=1.791883 cos_to_last_merge=0.9985 (last merge round=39)
[S7] round=61 local utility u=0.721271 metrics={'f1_val': 0.6884938550320465, 'auprc': 0.8485720590803114, 'loss_val': 0.2793973817422033, 'psi': 0.7525251366513525}-{'f1_val': 0.569540082585246, 'auprc': 0.7823969997112789, 'loss_val': 0.809691693102891, 'psi': 0.6546828494356591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=61 head_norm_before_train=2.261592 (no previous merge yet)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9921646161217188, 'auprc': 0.9979876026319285, 'loss_val': 0.031027532166546582, 'psi': 0.9944938107258028}-{'f1_val': 0.9936253371144965, 'auprc': 0.9986830718350346, 'loss_val': 0.02639499582561565, 'psi': 0.9956484310027118}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=1.651901 cos_to_last_merge=0.9768 (last merge round=34)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9951617089319369, 'loss_val': 0.023744515853361722, 'psi': 0.9959107949731073}-{'f1_val': 0.9959957888192151, 'auprc': 0.9983145185293134, 'loss_val': 0.023922007221454038, 'psi': 0.9969232807032544}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.104966 cos_to_last_merge=0.9596 (last merge round=34)
[S10] round=61 local utility u=0.000083 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941768932231076, 'loss_val': 0.027365087975577337, 'psi': 0.9947834607008679}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941339178037594, 'loss_val': 0.0274029284687401, 'psi': 0.9947662705331286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=61 head_norm_before_train=1.727157 cos_to_last_merge=0.9669 (last merge round=35)
[S11] round=61 local utility u=0.089255 metrics={'f1_val': 0.9205502140152719, 'auprc': 0.9958133936067244, 'loss_val': 0.28239966497151137, 'psi': 0.950655485851853}-{'f1_val': 0.8705349954679498, 'auprc': 0.9960705106845283, 'loss_val': 0.16158976454312662, 'psi': 0.9207492015545813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=61 head_norm_before_train=1.784249 cos_to_last_merge=0.9947 (last merge round=39)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6826533767064109, 'auprc': 0.7013357780842066, 'loss_val': 1.023096105991022, 'psi': 0.6901263372575291}-{'f1_val': 0.7069289877279978, 'auprc': 0.7586349270787562, 'loss_val': 0.8023283246948659, 'psi': 0.7276113634683012}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.887034 cos_to_last_merge=0.9794 (last merge round=39)
[S14] round=61 local utility u=0.009875 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990483861994194, 'loss_val': 0.018916173125572824, 'psi': 0.9979635685032435}-{'f1_val': 0.9953516823059178, 'auprc': 0.9990488074845103, 'loss_val': 0.027334574046889798, 'psi': 0.9968305323773547}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=61 head_norm_before_train=2.014206 cos_to_last_merge=0.9695 (last merge round=41)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7020388558666628, 'auprc': 0.9058841456146549, 'loss_val': 0.734170968301845, 'psi': 0.7835769717658596}-{'f1_val': 0.9967466683875206, 'auprc': 0.9983098471228193, 'loss_val': 0.018579677534345928, 'psi': 0.9973719398816401}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.837525 cos_to_last_merge=0.9648 (last merge round=41)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8678580114469535, 'auprc': 0.9872784871843021, 'loss_val': 0.7029593867588014, 'psi': 0.9156262017418929}-{'f1_val': 0.8678580114469535, 'auprc': 0.9871946562779499, 'loss_val': 0.6967910066831227, 'psi': 0.915592669379352}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.713746 cos_to_last_merge=0.9848 (last merge round=40)
[S17] round=61 local utility u=0.386322 metrics={'f1_val': 0.8466246686437012, 'auprc': 0.8058871007779518, 'loss_val': 0.6094781469549022, 'psi': 0.8303296414974015}-{'f1_val': 0.7693539517931356, 'auprc': 0.7853347472871061, 'loss_val': 0.856841010920676, 'psi': 0.7757462699907238}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=62 head_norm_before_train=1.996067 cos_to_last_merge=0.9696 (last merge round=41)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7093156867579709, 'auprc': 0.9632391397889698, 'loss_val': 0.5734838035591924, 'psi': 0.8108850679703705}-{'f1_val': 0.7095933961666887, 'auprc': 0.9912886977712767, 'loss_val': 0.6087193874150294, 'psi': 0.822271516808524}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.634901 cos_to_last_merge=0.9881 (last merge round=40)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.843530066515462, 'auprc': 0.9659059396819343, 'loss_val': 0.4621300909505705, 'psi': 0.892480415782051}-{'f1_val': 0.8916343892745636, 'auprc': 0.9905265592795061, 'loss_val': 0.2935941330153638, 'psi': 0.9311912572765406}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.995104 cos_to_last_merge=0.9926 (last merge round=41)
[S4] round=62 local utility u=0.009373 metrics={'f1_val': 0.9432047996670938, 'auprc': 0.9618082113251195, 'loss_val': 0.27878691971564834, 'psi': 0.9506461643303041}-{'f1_val': 0.9427417713405952, 'auprc': 0.9690907449828354, 'loss_val': 0.31660239151763864, 'psi': 0.9532813607974913}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=62 head_norm_before_train=1.599044 cos_to_last_merge=0.9777 (last merge round=38)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9933764126988744, 'loss_val': 0.04275737661271208, 'psi': 0.9953717461666244}-{'f1_val': 0.9967019684784577, 'auprc': 0.9954372292502583, 'loss_val': 0.04322801859939765, 'psi': 0.9961960727871779}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=2.006452 cos_to_last_merge=0.7959 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.796
[S6] round=62 local utility u=0.496444 metrics={'f1_val': 0.8210507222309124, 'auprc': 0.9549238213087786, 'loss_val': 0.4874274672019688, 'psi': 0.8745999618620588}-{'f1_val': 0.7547498598487928, 'auprc': 0.8793559374797746, 'loss_val': 0.8558070943027166, 'psi': 0.8045922909011856}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=62 head_norm_before_train=1.797357 cos_to_last_merge=0.9984 (last merge round=39)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.5573334535833472, 'auprc': 0.7828038469181636, 'loss_val': 0.8871787648963635, 'psi': 0.6475216109172737}-{'f1_val': 0.6884938550320465, 'auprc': 0.8485720590803114, 'loss_val': 0.2793973817422033, 'psi': 0.7525251366513525}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=2.265754 (no previous merge yet)
[S8] round=62 local utility u=0.011685 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9990425175903603, 'loss_val': 0.02487040176605597, 'psi': 0.9963205127012356}-{'f1_val': 0.9921646161217188, 'auprc': 0.9979876026319285, 'loss_val': 0.031027532166546582, 'psi': 0.9944938107258028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=62 head_norm_before_train=1.658531 cos_to_last_merge=0.9763 (last merge round=34)
[S9] round=62 local utility u=0.001077 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9982671550919722, 'loss_val': 0.02590451054482921, 'psi': 0.9966526973672977}-{'f1_val': 0.9964101856672208, 'auprc': 0.9951617089319369, 'loss_val': 0.023744515853361722, 'psi': 0.9959107949731073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=62 head_norm_before_train=2.113411 cos_to_last_merge=0.9589 (last merge round=34)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9938996336195696, 'loss_val': 0.027135155296585365, 'psi': 0.9946725568594527}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941768932231076, 'loss_val': 0.027365087975577337, 'psi': 0.9947834607008679}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.733817 cos_to_last_merge=0.9663 (last merge round=35)
[S11] round=62 local utility u=0.356319 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978936147761237, 'loss_val': 0.02805130437644605, 'psi': 0.9966925486315978}-{'f1_val': 0.9205502140152719, 'auprc': 0.9958133936067244, 'loss_val': 0.28239966497151137, 'psi': 0.950655485851853}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=62 head_norm_before_train=1.788449 cos_to_last_merge=0.9945 (last merge round=39)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.6428126116931454, 'auprc': 0.7043264403631303, 'loss_val': 1.0891493095645397, 'psi': 0.6674181431611395}-{'f1_val': 0.6826533767064109, 'auprc': 0.7013357780842066, 'loss_val': 1.023096105991022, 'psi': 0.6901263372575291}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.893373 cos_to_last_merge=0.9790 (last merge round=39)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9990204158323803, 'loss_val': 0.019395237178707787, 'psi': 0.9979543033903755}-{'f1_val': 0.997240356705793, 'auprc': 0.9990483861994194, 'loss_val': 0.018916173125572824, 'psi': 0.9979635685032435}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=2.022866 cos_to_last_merge=0.9687 (last merge round=41)
[S15] round=62 local utility u=1.000000 metrics={'f1_val': 0.9810700326853032, 'auprc': 0.9977770963855269, 'loss_val': 0.03684674251898227, 'psi': 0.9877528581653927}-{'f1_val': 0.7020388558666628, 'auprc': 0.9058841456146549, 'loss_val': 0.734170968301845, 'psi': 0.7835769717658596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=62 head_norm_before_train=1.846026 cos_to_last_merge=0.9640 (last merge round=41)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.831666842406326, 'auprc': 0.838685001577549, 'loss_val': 1.2310944106010815, 'psi': 0.8344741060748152}-{'f1_val': 0.8678580114469535, 'auprc': 0.9872784871843021, 'loss_val': 0.7029593867588014, 'psi': 0.9156262017418929}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.725272 cos_to_last_merge=0.9840 (last merge round=40)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.7681099554796113, 'auprc': 0.8601786757518407, 'loss_val': 0.8993108650640603, 'psi': 0.804937443588503}-{'f1_val': 0.8466246686437012, 'auprc': 0.8058871007779518, 'loss_val': 0.6094781469549022, 'psi': 0.8303296414974015}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.996492 cos_to_last_merge=0.9692 (last merge round=41)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.707924348733867, 'auprc': 0.9306659361703469, 'loss_val': 0.5825627790212801, 'psi': 0.797020983708459}-{'f1_val': 0.7093156867579709, 'auprc': 0.9632391397889698, 'loss_val': 0.5734838035591924, 'psi': 0.8108850679703705}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=1.642923 cos_to_last_merge=0.9876 (last merge round=40)
[S3] round=63 local utility u=0.086558 metrics={'f1_val': 0.8653182816744706, 'auprc': 0.9644744457713563, 'loss_val': 0.415448474366891, 'psi': 0.9049807473132249}-{'f1_val': 0.843530066515462, 'auprc': 0.9659059396819343, 'loss_val': 0.4621300909505705, 'psi': 0.892480415782051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=63 head_norm_before_train=1.996279 cos_to_last_merge=0.9923 (last merge round=41)
[S4] round=63 local utility u=0.047619 metrics={'f1_val': 0.9497997557652702, 'auprc': 0.9768538998505676, 'loss_val': 0.2682556962705346, 'psi': 0.9606214133993892}-{'f1_val': 0.9432047996670938, 'auprc': 0.9618082113251195, 'loss_val': 0.27878691971564834, 'psi': 0.9506461643303041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=63 head_norm_before_train=1.617120 cos_to_last_merge=0.9762 (last merge round=38)
[S5] round=63 local utility u=0.004356 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9944641838239591, 'loss_val': 0.037308830903013936, 'psi': 0.9958068546166583}-{'f1_val': 0.9967019684784577, 'auprc': 0.9933764126988744, 'loss_val': 0.04275737661271208, 'psi': 0.9953717461666244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=63 head_norm_before_train=2.019907 cos_to_last_merge=0.7950 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.795
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.5895997373373363, 'auprc': 0.7747561680858084, 'loss_val': 1.5151598090800293, 'psi': 0.6636623096367251}-{'f1_val': 0.8210507222309124, 'auprc': 0.9549238213087786, 'loss_val': 0.4874274672019688, 'psi': 0.8745999618620588}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.802869 cos_to_last_merge=0.9983 (last merge round=39)
[S7] round=63 local utility u=1.000000 metrics={'f1_val': 0.7161327164170993, 'auprc': 0.914964131449497, 'loss_val': 0.21362425439726315, 'psi': 0.7956652824300584}-{'f1_val': 0.5573334535833472, 'auprc': 0.7828038469181636, 'loss_val': 0.8871787648963635, 'psi': 0.6475216109172737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=63 head_norm_before_train=2.274817 (no previous merge yet)
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9992222138413366, 'loss_val': 0.024708685348981213, 'psi': 0.9963043018958506}-{'f1_val': 0.9945058427751525, 'auprc': 0.9990425175903603, 'loss_val': 0.02487040176605597, 'psi': 0.9963205127012356}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=1.664997 cos_to_last_merge=0.9759 (last merge round=34)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9909734396342953, 'auprc': 0.9982290991120852, 'loss_val': 0.034105020276734066, 'psi': 0.9938757034254113}-{'f1_val': 0.9955763922175147, 'auprc': 0.9982671550919722, 'loss_val': 0.02590451054482921, 'psi': 0.9966526973672977}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.120278 cos_to_last_merge=0.9584 (last merge round=34)
[S10] round=63 local utility u=0.000455 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942012852611665, 'loss_val': 0.02712995284609296, 'psi': 0.9947932175160914}-{'f1_val': 0.9951878390193748, 'auprc': 0.9938996336195696, 'loss_val': 0.027135155296585365, 'psi': 0.9946725568594527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=63 head_norm_before_train=1.740096 cos_to_last_merge=0.9658 (last merge round=35)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9730662362410483, 'auprc': 0.9981516478122477, 'loss_val': 0.1033873876614589, 'psi': 0.9831004008695281}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978936147761237, 'loss_val': 0.02805130437644605, 'psi': 0.9966925486315978}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.795890 cos_to_last_merge=0.9941 (last merge round=39)
[S13] round=63 local utility u=0.389465 metrics={'f1_val': 0.7423044138601779, 'auprc': 0.7133720137347459, 'loss_val': 0.9343063334703557, 'psi': 0.730731453810005}-{'f1_val': 0.6428126116931454, 'auprc': 0.7043264403631303, 'loss_val': 1.0891493095645397, 'psi': 0.6674181431611395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=63 head_norm_before_train=1.901076 cos_to_last_merge=0.9784 (last merge round=39)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9986466281018356, 'loss_val': 0.020213643645397232, 'psi': 0.9974246592063887}-{'f1_val': 0.9972435617623723, 'auprc': 0.9990204158323803, 'loss_val': 0.019395237178707787, 'psi': 0.9979543033903755}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.032465 cos_to_last_merge=0.9679 (last merge round=41)
[S15] round=63 local utility u=0.058204 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.998220575952997, 'loss_val': 0.01805343021299478, 'psi': 0.9975585824980588}-{'f1_val': 0.9810700326853032, 'auprc': 0.9977770963855269, 'loss_val': 0.03684674251898227, 'psi': 0.9877528581653927}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=63 head_norm_before_train=1.853309 cos_to_last_merge=0.9632 (last merge round=41)
[S16] round=63 local utility u=0.451736 metrics={'f1_val': 0.8405275010378666, 'auprc': 0.9518670777055507, 'loss_val': 0.7203332014298465, 'psi': 0.8850633317049402}-{'f1_val': 0.831666842406326, 'auprc': 0.838685001577549, 'loss_val': 1.2310944106010815, 'psi': 0.8344741060748152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=63 head_norm_before_train=1.737557 cos_to_last_merge=0.9832 (last merge round=40)
[S17] round=63 local utility u=0.458088 metrics={'f1_val': 0.8692177608283468, 'auprc': 0.8403286706116042, 'loss_val': 0.5302306990336247, 'psi': 0.8576621247416497}-{'f1_val': 0.7681099554796113, 'auprc': 0.8601786757518407, 'loss_val': 0.8993108650640603, 'psi': 0.804937443588503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=64 head_norm_before_train=2.003331 cos_to_last_merge=0.9684 (last merge round=41)
[S2] round=64 local utility u=0.012208 metrics={'f1_val': 0.7095957586148102, 'auprc': 0.9381122601823668, 'loss_val': 0.5905146120905064, 'psi': 0.8010023592418328}-{'f1_val': 0.707924348733867, 'auprc': 0.9306659361703469, 'loss_val': 0.5825627790212801, 'psi': 0.797020983708459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=64 head_norm_before_train=1.652479 cos_to_last_merge=0.9870 (last merge round=40)
[S3] round=64 local utility u=0.271020 metrics={'f1_val': 0.9122156640616241, 'auprc': 0.9917917502542736, 'loss_val': 0.23674488550270814, 'psi': 0.9440460985386839}-{'f1_val': 0.8653182816744706, 'auprc': 0.9644744457713563, 'loss_val': 0.415448474366891, 'psi': 0.9049807473132249}
[S3] not sending this round → trigger blocked (psi=0.944)
[S4] START round=64 head_norm_before_train=2.000747 cos_to_last_merge=0.9922 (last merge round=41)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9420284581970033, 'auprc': 0.9591185559993373, 'loss_val': 0.22299119865111183, 'psi': 0.9488644973179369}-{'f1_val': 0.9497997557652702, 'auprc': 0.9768538998505676, 'loss_val': 0.2682556962705346, 'psi': 0.9606214133993892}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.637750 cos_to_last_merge=0.9744 (last merge round=38)
[S5] round=64 local utility u=0.000094 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938414657530872, 'loss_val': 0.03525270069571678, 'psi': 0.9955577673883095}-{'f1_val': 0.9967019684784577, 'auprc': 0.9944641838239591, 'loss_val': 0.037308830903013936, 'psi': 0.9958068546166583}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=64 head_norm_before_train=2.031643 cos_to_last_merge=0.7942 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.794
[S6] round=64 local utility u=1.000000 metrics={'f1_val': 0.7973466830144917, 'auprc': 0.9172941029370761, 'loss_val': 0.7570681217478881, 'psi': 0.8453256509835255}-{'f1_val': 0.5895997373373363, 'auprc': 0.7747561680858084, 'loss_val': 1.5151598090800293, 'psi': 0.6636623096367251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=64 head_norm_before_train=1.806927 cos_to_last_merge=0.9982 (last merge round=39)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5360693768681697, 'auprc': 0.7817165219578147, 'loss_val': 0.9908670973734447, 'psi': 0.6343282349040278}-{'f1_val': 0.7161327164170993, 'auprc': 0.914964131449497, 'loss_val': 0.21362425439726315, 'psi': 0.7956652824300584}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=2.280297 (no previous merge yet)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9990553121311958, 'loss_val': 0.02892181724581489, 'psi': 0.9953584483314475}-{'f1_val': 0.9943590272655265, 'auprc': 0.9992222138413366, 'loss_val': 0.024708685348981213, 'psi': 0.9963043018958506}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=1.670442 cos_to_last_merge=0.9756 (last merge round=34)
[S9] round=64 local utility u=0.013051 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9924837429768598, 'loss_val': 0.023387258299350795, 'psi': 0.9948396085910765}-{'f1_val': 0.9909734396342953, 'auprc': 0.9982290991120852, 'loss_val': 0.034105020276734066, 'psi': 0.9938757034254113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=64 head_norm_before_train=2.127371 cos_to_last_merge=0.9578 (last merge round=34)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9941695741757588, 'loss_val': 0.027186952858172065, 'psi': 0.9945277198958209}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942012852611665, 'loss_val': 0.02712995284609296, 'psi': 0.9947932175160914}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.746677 cos_to_last_merge=0.9653 (last merge round=35)
[S11] round=64 local utility u=0.104780 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9972798158486542, 'loss_val': 0.0297393986277073, 'psi': 0.9966044111859089}-{'f1_val': 0.9730662362410483, 'auprc': 0.9981516478122477, 'loss_val': 0.1033873876614589, 'psi': 0.9831004008695281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=64 head_norm_before_train=1.801669 cos_to_last_merge=0.9938 (last merge round=39)
[S13] round=64 local utility u=0.063433 metrics={'f1_val': 0.7638044458704855, 'auprc': 0.728364928241294, 'loss_val': 0.9814188057691486, 'psi': 0.7496286388188088}-{'f1_val': 0.7423044138601779, 'auprc': 0.7133720137347459, 'loss_val': 0.9343063334703557, 'psi': 0.730731453810005}
[S13] not sending this round → trigger blocked (psi=0.750)
[S14] START round=64 head_norm_before_train=1.909869 cos_to_last_merge=0.9779 (last merge round=39)
[S14] round=64 local utility u=0.002714 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9989867959986556, 'loss_val': 0.019608360720438568, 'psi': 0.9979408554568856}-{'f1_val': 0.9966100132760906, 'auprc': 0.9986466281018356, 'loss_val': 0.020213643645397232, 'psi': 0.9974246592063887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=64 head_norm_before_train=2.042123 cos_to_last_merge=0.9671 (last merge round=41)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980594773804811, 'loss_val': 0.018672763451208132, 'psi': 0.9972717919847047}-{'f1_val': 0.9971172535281002, 'auprc': 0.998220575952997, 'loss_val': 0.01805343021299478, 'psi': 0.9975585824980588}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.860166 cos_to_last_merge=0.9625 (last merge round=41)
[S16] round=64 local utility u=0.838943 metrics={'f1_val': 0.9906413694449457, 'auprc': 0.9870324889874088, 'loss_val': 0.04862595132894465, 'psi': 0.9891978172619309}-{'f1_val': 0.8405275010378666, 'auprc': 0.9518670777055507, 'loss_val': 0.7203332014298465, 'psi': 0.8850633317049402}
[S16] not sending this round → trigger blocked (psi=0.989)
[S17] START round=64 head_norm_before_train=1.746862 cos_to_last_merge=0.9825 (last merge round=40)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.662005797300677, 'auprc': 0.919586472154236, 'loss_val': 1.280863535273539, 'psi': 0.7650380672421007}-{'f1_val': 0.8692177608283468, 'auprc': 0.8403286706116042, 'loss_val': 0.5302306990336247, 'psi': 0.8576621247416497}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.014485 cos_to_last_merge=0.9677 (last merge round=41)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7104189073494033, 'auprc': 0.8459628548526148, 'loss_val': 0.5612711910481097, 'psi': 0.7646364863506879}-{'f1_val': 0.7095957586148102, 'auprc': 0.9381122601823668, 'loss_val': 0.5905146120905064, 'psi': 0.8010023592418328}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=1.662462 cos_to_last_merge=0.9864 (last merge round=40)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.8410831213820484, 'auprc': 0.9953964888240014, 'loss_val': 0.39540921521757005, 'psi': 0.9028084683588296}-{'f1_val': 0.9122156640616241, 'auprc': 0.9917917502542736, 'loss_val': 0.23674488550270814, 'psi': 0.9440460985386839}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=2.004245 cos_to_last_merge=0.9920 (last merge round=41)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9404517232077035, 'auprc': 0.9387893896760479, 'loss_val': 0.23878835564270165, 'psi': 0.9397867897950413}-{'f1_val': 0.9420284581970033, 'auprc': 0.9591185559993373, 'loss_val': 0.22299119865111183, 'psi': 0.9488644973179369}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.652668 cos_to_last_merge=0.9729 (last merge round=38)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.9896076266093914, 'auprc': 0.9905124810680824, 'loss_val': 0.05826475499116062, 'psi': 0.9899695683928678}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938414657530872, 'loss_val': 0.03525270069571678, 'psi': 0.9955577673883095}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.042022 cos_to_last_merge=0.7934 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.6920771129607067, 'auprc': 0.8326314376293271, 'loss_val': 1.1123334658567745, 'psi': 0.748298842828155}-{'f1_val': 0.7973466830144917, 'auprc': 0.9172941029370761, 'loss_val': 0.7570681217478881, 'psi': 0.8453256509835255}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.809397 cos_to_last_merge=0.9981 (last merge round=39)
[S7] round=65 local utility u=0.300723 metrics={'f1_val': 0.5962068623818291, 'auprc': 0.7856728708981501, 'loss_val': 0.7621146957351084, 'psi': 0.6719932657883575}-{'f1_val': 0.5360693768681697, 'auprc': 0.7817165219578147, 'loss_val': 0.9908670973734447, 'psi': 0.6343282349040278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=65 head_norm_before_train=2.283999 (no previous merge yet)
[S8] round=65 local utility u=0.002978 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990798675185404, 'loss_val': 0.02742784190379669, 'psi': 0.995807149276114}-{'f1_val': 0.9928938724649488, 'auprc': 0.9990553121311958, 'loss_val': 0.02892181724581489, 'psi': 0.9953584483314475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=65 head_norm_before_train=1.676124 cos_to_last_merge=0.9753 (last merge round=34)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.9982192961500967, 'loss_val': 0.0379819278487949, 'psi': 0.9931120045655625}-{'f1_val': 0.9964101856672208, 'auprc': 0.9924837429768598, 'loss_val': 0.023387258299350795, 'psi': 0.9948396085910765}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.135582 cos_to_last_merge=0.9571 (last merge round=34)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9941747300467824, 'loss_val': 0.027227995553701062, 'psi': 0.9945297822442303}-{'f1_val': 0.9947664837091956, 'auprc': 0.9941695741757588, 'loss_val': 0.027186952858172065, 'psi': 0.9945277198958209}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=1.751546 cos_to_last_merge=0.9648 (last merge round=35)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9976444183587203, 'loss_val': 0.04452000167687671, 'psi': 0.9967502521899354}-{'f1_val': 0.9961541414107454, 'auprc': 0.9972798158486542, 'loss_val': 0.0297393986277073, 'psi': 0.9966044111859089}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.809350 cos_to_last_merge=0.9933 (last merge round=39)
[S13] round=65 local utility u=0.241983 metrics={'f1_val': 0.7780964455325919, 'auprc': 0.7757475410496592, 'loss_val': 0.7253526204529768, 'psi': 0.7771568837394188}-{'f1_val': 0.7638044458704855, 'auprc': 0.728364928241294, 'loss_val': 0.9814188057691486, 'psi': 0.7496286388188088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=65 head_norm_before_train=1.915076 cos_to_last_merge=0.9774 (last merge round=39)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9974610688245696, 'auprc': 0.9990468554134915, 'loss_val': 0.02128624797661973, 'psi': 0.9980953834601384}-{'f1_val': 0.9972435617623723, 'auprc': 0.9989867959986556, 'loss_val': 0.019608360720438568, 'psi': 0.9979408554568856}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=2.051754 cos_to_last_merge=0.9664 (last merge round=41)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976083834288245, 'loss_val': 0.022051035736161982, 'psi': 0.9970913544040422}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980594773804811, 'loss_val': 0.018672763451208132, 'psi': 0.9972717919847047}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=1.863005 cos_to_last_merge=0.9622 (last merge round=41)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.8284283645012628, 'auprc': 0.9148718145708246, 'loss_val': 1.2580728855302667, 'psi': 0.8630057445290875}-{'f1_val': 0.9906413694449457, 'auprc': 0.9870324889874088, 'loss_val': 0.04862595132894465, 'psi': 0.9891978172619309}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.755480 cos_to_last_merge=0.9818 (last merge round=40)
[S17] round=65 local utility u=0.999202 metrics={'f1_val': 0.8868136058293918, 'auprc': 0.8756326291069998, 'loss_val': 0.4994442719636795, 'psi': 0.8823412151404351}-{'f1_val': 0.662005797300677, 'auprc': 0.919586472154236, 'loss_val': 1.280863535273539, 'psi': 0.7650380672421007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=66 head_norm_before_train=2.025028 cos_to_last_merge=0.9671 (last merge round=41)
[S2] round=66 local utility u=0.102479 metrics={'f1_val': 0.709558569402552, 'auprc': 0.9310267935143031, 'loss_val': 0.606343969303069, 'psi': 0.7981458590472524}-{'f1_val': 0.7104189073494033, 'auprc': 0.8459628548526148, 'loss_val': 0.5612711910481097, 'psi': 0.7646364863506879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=66 head_norm_before_train=1.671098 cos_to_last_merge=0.9858 (last merge round=40)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.7262036459145993, 'auprc': 0.88714760813953, 'loss_val': 0.9082310866159146, 'psi': 0.7905812308045717}-{'f1_val': 0.8410831213820484, 'auprc': 0.9953964888240014, 'loss_val': 0.39540921521757005, 'psi': 0.9028084683588296}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.009213 cos_to_last_merge=0.9917 (last merge round=41)
[S4] round=66 local utility u=0.003279 metrics={'f1_val': 0.9403513068244833, 'auprc': 0.9416104868654125, 'loss_val': 0.2400901870774182, 'psi': 0.9408549788408549}-{'f1_val': 0.9404517232077035, 'auprc': 0.9387893896760479, 'loss_val': 0.23878835564270165, 'psi': 0.9397867897950413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=66 head_norm_before_train=1.664389 cos_to_last_merge=0.9714 (last merge round=38)
[S5] round=66 local utility u=0.035371 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9938129855766595, 'loss_val': 0.04219594342961819, 'psi': 0.9957669293973024}-{'f1_val': 0.9896076266093914, 'auprc': 0.9905124810680824, 'loss_val': 0.05826475499116062, 'psi': 0.9899695683928678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=66 head_norm_before_train=2.052268 cos_to_last_merge=0.7927 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6816136201932329, 'auprc': 0.8178932448192707, 'loss_val': 1.214511937482455, 'psi': 0.736125470043648}-{'f1_val': 0.6920771129607067, 'auprc': 0.8326314376293271, 'loss_val': 1.1123334658567745, 'psi': 0.748298842828155}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.811939 cos_to_last_merge=0.9980 (last merge round=39)
[S7] round=66 local utility u=0.356520 metrics={'f1_val': 0.6600289549359345, 'auprc': 0.8025784550238271, 'loss_val': 0.48272427348477476, 'psi': 0.7170487549710916}-{'f1_val': 0.5962068623818291, 'auprc': 0.7856728708981501, 'loss_val': 0.7621146957351084, 'psi': 0.6719932657883575}
[S7] not sending this round → trigger blocked (psi=0.717)
[S8] START round=66 head_norm_before_train=2.282254 (no previous merge yet)
[S8] round=66 local utility u=0.000716 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9993037372351389, 'loss_val': 0.027540395687864278, 'psi': 0.995984037938408}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990798675185404, 'loss_val': 0.02742784190379669, 'psi': 0.995807149276114}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=66 head_norm_before_train=1.682585 cos_to_last_merge=0.9748 (last merge round=34)
[S9] round=66 local utility u=0.021627 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9971945318408237, 'loss_val': 0.02440444209221375, 'psi': 0.9959771165702985}-{'f1_val': 0.9897071435092063, 'auprc': 0.9982192961500967, 'loss_val': 0.0379819278487949, 'psi': 0.9931120045655625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=66 head_norm_before_train=2.144125 cos_to_last_merge=0.9564 (last merge round=34)
[S10] round=66 local utility u=0.000045 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9941625920562098, 'loss_val': 0.027102008641949064, 'psi': 0.9945249270480012}-{'f1_val': 0.9947664837091956, 'auprc': 0.9941747300467824, 'loss_val': 0.027227995553701062, 'psi': 0.9945297822442303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=66 head_norm_before_train=1.757600 cos_to_last_merge=0.9643 (last merge round=35)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9273513451862104, 'auprc': 0.9972612564846, 'loss_val': 0.23838400485818567, 'psi': 0.9553153097055662}-{'f1_val': 0.9961541414107454, 'auprc': 0.9976444183587203, 'loss_val': 0.04452000167687671, 'psi': 0.9967502521899354}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.816884 cos_to_last_merge=0.9928 (last merge round=39)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.749416174092638, 'auprc': 0.7040142802660171, 'loss_val': 1.108791249422854, 'psi': 0.7312554165619897}-{'f1_val': 0.7780964455325919, 'auprc': 0.7757475410496592, 'loss_val': 0.7253526204529768, 'psi': 0.7771568837394188}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=1.921774 cos_to_last_merge=0.9769 (last merge round=39)
[S14] round=66 local utility u=0.001668 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9990466252502064, 'loss_val': 0.021556451082813323, 'psi': 0.9984560700092904}-{'f1_val': 0.9974610688245696, 'auprc': 0.9990468554134915, 'loss_val': 0.02128624797661973, 'psi': 0.9980953834601384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=66 head_norm_before_train=2.061011 cos_to_last_merge=0.9656 (last merge round=41)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9587334151367083, 'auprc': 0.9972559966092108, 'loss_val': 0.09454350155885632, 'psi': 0.9741424477257093}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976083834288245, 'loss_val': 0.022051035736161982, 'psi': 0.9970913544040422}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.867838 cos_to_last_merge=0.9617 (last merge round=41)
[S16] round=66 local utility u=0.650071 metrics={'f1_val': 0.8918750021673161, 'auprc': 0.9856511903763763, 'loss_val': 0.5509491153048449, 'psi': 0.9293854774509402}-{'f1_val': 0.8284283645012628, 'auprc': 0.9148718145708246, 'loss_val': 1.2580728855302667, 'psi': 0.8630057445290875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=66 head_norm_before_train=1.763024 cos_to_last_merge=0.9812 (last merge round=40)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8178176383169979, 'auprc': 0.9013041977137055, 'loss_val': 0.7744022548833819, 'psi': 0.851212262075681}-{'f1_val': 0.8868136058293918, 'auprc': 0.8756326291069998, 'loss_val': 0.4994442719636795, 'psi': 0.8823412151404351}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.032662 cos_to_last_merge=0.9667 (last merge round=41)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7115590124444158, 'auprc': 0.8709069878868165, 'loss_val': 0.6254482635442988, 'psi': 0.775298202621376}-{'f1_val': 0.709558569402552, 'auprc': 0.9310267935143031, 'loss_val': 0.606343969303069, 'psi': 0.7981458590472524}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=1.680097 cos_to_last_merge=0.9853 (last merge round=40)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.7139918699002638, 'auprc': 0.8881840556415252, 'loss_val': 0.9768125109022194, 'psi': 0.7836687441967684}-{'f1_val': 0.7262036459145993, 'auprc': 0.88714760813953, 'loss_val': 0.9082310866159146, 'psi': 0.7905812308045717}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.015456 cos_to_last_merge=0.9915 (last merge round=41)
[S4] round=67 local utility u=0.024096 metrics={'f1_val': 0.9408757948770794, 'auprc': 0.9607186338526081, 'loss_val': 0.2523705076201567, 'psi': 0.948812930467291}-{'f1_val': 0.9403513068244833, 'auprc': 0.9416104868654125, 'loss_val': 0.2400901870774182, 'psi': 0.9408549788408549}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=67 head_norm_before_train=1.675785 cos_to_last_merge=0.9701 (last merge round=38)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.8975889944050325, 'auprc': 0.9900928030283056, 'loss_val': 0.1572610968006495, 'psi': 0.9345905178543418}-{'f1_val': 0.9970695586110643, 'auprc': 0.9938129855766595, 'loss_val': 0.04219594342961819, 'psi': 0.9957669293973024}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=2.058012 cos_to_last_merge=0.7923 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=67 local utility u=0.784559 metrics={'f1_val': 0.8003593161579481, 'auprc': 0.9278267773931352, 'loss_val': 0.6876679008062581, 'psi': 0.851346300652023}-{'f1_val': 0.6816136201932329, 'auprc': 0.8178932448192707, 'loss_val': 1.214511937482455, 'psi': 0.736125470043648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=67 head_norm_before_train=1.813356 cos_to_last_merge=0.9979 (last merge round=39)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.4622401876392078, 'auprc': 0.7787556844338814, 'loss_val': 1.2210061390050504, 'psi': 0.5888463863570773}-{'f1_val': 0.6600289549359345, 'auprc': 0.8025784550238271, 'loss_val': 0.48272427348477476, 'psi': 0.7170487549710916}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.288732 (no previous merge yet)
[S8] round=67 local utility u=0.003407 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9990725251463543, 'loss_val': 0.024441434750014812, 'psi': 0.9963325157236331}-{'f1_val': 0.9937709050739206, 'auprc': 0.9993037372351389, 'loss_val': 0.027540395687864278, 'psi': 0.995984037938408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=67 head_norm_before_train=1.688877 cos_to_last_merge=0.9744 (last merge round=34)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9924236221380777, 'loss_val': 0.022628415029327935, 'psi': 0.9947195057227977}-{'f1_val': 0.9951655063899485, 'auprc': 0.9971945318408237, 'loss_val': 0.02440444209221375, 'psi': 0.9959771165702985}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.149654 cos_to_last_merge=0.9559 (last merge round=34)
[S10] round=67 local utility u=0.000102 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9942293119876451, 'loss_val': 0.027099024901347527, 'psi': 0.9945516150205753}-{'f1_val': 0.9947664837091956, 'auprc': 0.9941625920562098, 'loss_val': 0.027102008641949064, 'psi': 0.9945249270480012}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=67 head_norm_before_train=1.764245 cos_to_last_merge=0.9637 (last merge round=35)
[S11] round=67 local utility u=0.313931 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978741397090796, 'loss_val': 0.025176486138897346, 'psi': 0.996842140730079}-{'f1_val': 0.9273513451862104, 'auprc': 0.9972612564846, 'loss_val': 0.23838400485818567, 'psi': 0.9553153097055662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=67 head_norm_before_train=1.822822 cos_to_last_merge=0.9925 (last merge round=39)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6411997203722848, 'auprc': 0.6859487404935258, 'loss_val': 1.116944054062355, 'psi': 0.6590993284207812}-{'f1_val': 0.749416174092638, 'auprc': 0.7040142802660171, 'loss_val': 1.108791249422854, 'psi': 0.7312554165619897}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.927296 cos_to_last_merge=0.9766 (last merge round=39)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990449059209788, 'loss_val': 0.018173497327818155, 'psi': 0.9978164672629906}-{'f1_val': 0.9980623665153463, 'auprc': 0.9990466252502064, 'loss_val': 0.021556451082813323, 'psi': 0.9984560700092904}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=2.070001 cos_to_last_merge=0.9649 (last merge round=41)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9192278940482226, 'auprc': 0.9970321818857641, 'loss_val': 0.173303504712271, 'psi': 0.9503496091832392}-{'f1_val': 0.9587334151367083, 'auprc': 0.9972559966092108, 'loss_val': 0.09454350155885632, 'psi': 0.9741424477257093}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.874028 cos_to_last_merge=0.9611 (last merge round=41)
[S16] round=67 local utility u=0.554872 metrics={'f1_val': 0.9916617119128658, 'auprc': 0.9871424337848467, 'loss_val': 0.04439887397386412, 'psi': 0.9898540006616581}-{'f1_val': 0.8918750021673161, 'auprc': 0.9856511903763763, 'loss_val': 0.5509491153048449, 'psi': 0.9293854774509402}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=67 head_norm_before_train=1.768387 cos_to_last_merge=0.9807 (last merge round=40)
[S17] round=67 local utility u=0.311300 metrics={'f1_val': 0.8901735026120046, 'auprc': 0.8724130083060304, 'loss_val': 0.4992631734214904, 'psi': 0.8830693048896149}-{'f1_val': 0.8178176383169979, 'auprc': 0.9013041977137055, 'loss_val': 0.7744022548833819, 'psi': 0.851212262075681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=68 head_norm_before_train=2.037834 cos_to_last_merge=0.9664 (last merge round=41)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.5994003752028372, 'auprc': 0.7878094402122326, 'loss_val': 1.5263680617166717, 'psi': 0.6747640012065954}-{'f1_val': 0.7115590124444158, 'auprc': 0.8709069878868165, 'loss_val': 0.6254482635442988, 'psi': 0.775298202621376}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=1.688794 cos_to_last_merge=0.9847 (last merge round=40)
[S3] round=68 local utility u=0.606670 metrics={'f1_val': 0.8103007301381134, 'auprc': 0.9758314282990522, 'loss_val': 0.6042675358098597, 'psi': 0.8765130094024889}-{'f1_val': 0.7139918699002638, 'auprc': 0.8881840556415252, 'loss_val': 0.9768125109022194, 'psi': 0.7836687441967684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=68 head_norm_before_train=2.024021 cos_to_last_merge=0.9913 (last merge round=41)
[S4] round=68 local utility u=0.029341 metrics={'f1_val': 0.944409815351, 'auprc': 0.9830222655787475, 'loss_val': 0.2818039290786366, 'psi': 0.9598547954420991}-{'f1_val': 0.9408757948770794, 'auprc': 0.9607186338526081, 'loss_val': 0.2523705076201567, 'psi': 0.948812930467291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=68 head_norm_before_train=1.687320 cos_to_last_merge=0.9688 (last merge round=38)
[S5] round=68 local utility u=0.363379 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9937357174667422, 'loss_val': 0.038315780876692476, 'psi': 0.9957360221533355}-{'f1_val': 0.8975889944050325, 'auprc': 0.9900928030283056, 'loss_val': 0.1572610968006495, 'psi': 0.9345905178543418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=68 head_norm_before_train=2.064986 cos_to_last_merge=0.7908 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6274028150338877, 'auprc': 0.7822773778788423, 'loss_val': 1.3947057738255495, 'psi': 0.6893526401718696}-{'f1_val': 0.8003593161579481, 'auprc': 0.9278267773931352, 'loss_val': 0.6876679008062581, 'psi': 0.851346300652023}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.815541 cos_to_last_merge=0.9979 (last merge round=39)
[S7] round=68 local utility u=1.000000 metrics={'f1_val': 0.7510697530106225, 'auprc': 0.9608718213855538, 'loss_val': 0.19857010684637075, 'psi': 0.834990580360595}-{'f1_val': 0.4622401876392078, 'auprc': 0.7787556844338814, 'loss_val': 1.2210061390050504, 'psi': 0.5888463863570773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=68 head_norm_before_train=2.300308 (no previous merge yet)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9930382012516658, 'auprc': 0.9992237130001627, 'loss_val': 0.028286083218175294, 'psi': 0.9955124059510645}-{'f1_val': 0.9945058427751525, 'auprc': 0.9990725251463543, 'loss_val': 0.024441434750014812, 'psi': 0.9963325157236331}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.695406 cos_to_last_merge=0.9739 (last merge round=34)
[S9] round=68 local utility u=0.002748 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9982813770052821, 'loss_val': 0.025668892196743294, 'psi': 0.9961590075719435}-{'f1_val': 0.9962500947792776, 'auprc': 0.9924236221380777, 'loss_val': 0.022628415029327935, 'psi': 0.9947195057227977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=68 head_norm_before_train=2.156286 cos_to_last_merge=0.9554 (last merge round=34)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9942260334288335, 'loss_val': 0.027214208209982254, 'psi': 0.9945503035970508}-{'f1_val': 0.9947664837091956, 'auprc': 0.9942293119876451, 'loss_val': 0.027099024901347527, 'psi': 0.9945516150205753}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.771232 cos_to_last_merge=0.9631 (last merge round=35)
[S11] round=68 local utility u=0.000763 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981099769118258, 'loss_val': 0.024234886724850208, 'psi': 0.996924195712716}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978741397090796, 'loss_val': 0.025176486138897346, 'psi': 0.996842140730079}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=68 head_norm_before_train=1.827726 cos_to_last_merge=0.9922 (last merge round=39)
[S13] round=68 local utility u=0.066624 metrics={'f1_val': 0.6651581491277312, 'auprc': 0.7008552680494158, 'loss_val': 1.1721664183531557, 'psi': 0.679436996696405}-{'f1_val': 0.6411997203722848, 'auprc': 0.6859487404935258, 'loss_val': 1.116944054062355, 'psi': 0.6590993284207812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=68 head_norm_before_train=1.933405 cos_to_last_merge=0.9762 (last merge round=39)
[S14] round=68 local utility u=0.000635 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990492197042562, 'loss_val': 0.01691737764266526, 'psi': 0.9978181927763015}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990449059209788, 'loss_val': 0.018173497327818155, 'psi': 0.9978164672629906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=68 head_norm_before_train=2.078625 cos_to_last_merge=0.9642 (last merge round=41)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9148932727677044, 'auprc': 0.9970174866135618, 'loss_val': 0.1905547099140103, 'psi': 0.9477429583060473}-{'f1_val': 0.9192278940482226, 'auprc': 0.9970321818857641, 'loss_val': 0.173303504712271, 'psi': 0.9503496091832392}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.881174 cos_to_last_merge=0.9604 (last merge round=41)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.8946585552187857, 'auprc': 0.9838078108889385, 'loss_val': 0.3145621497377704, 'psi': 0.9303182574868468}-{'f1_val': 0.9916617119128658, 'auprc': 0.9871424337848467, 'loss_val': 0.04439887397386412, 'psi': 0.9898540006616581}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=1.778899 cos_to_last_merge=0.9800 (last merge round=40)
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.8033216294595841, 'auprc': 0.9394384497915726, 'loss_val': 0.8151242392357689, 'psi': 0.8577683575923796}-{'f1_val': 0.8901735026120046, 'auprc': 0.8724130083060304, 'loss_val': 0.4992631734214904, 'psi': 0.8830693048896149}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.042841 cos_to_last_merge=0.9655 (last merge round=41)
[S2] round=69 local utility u=0.705311 metrics={'f1_val': 0.6888985047680225, 'auprc': 0.8245980846512683, 'loss_val': 0.7631017043055355, 'psi': 0.7431783367213208}-{'f1_val': 0.5994003752028372, 'auprc': 0.7878094402122326, 'loss_val': 1.5263680617166717, 'psi': 0.6747640012065954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=69 head_norm_before_train=1.697849 cos_to_last_merge=0.9841 (last merge round=40)
[S3] round=69 local utility u=0.291822 metrics={'f1_val': 0.870473963617997, 'auprc': 0.9809680979934272, 'loss_val': 0.39707346671629273, 'psi': 0.914671617368169}-{'f1_val': 0.8103007301381134, 'auprc': 0.9758314282990522, 'loss_val': 0.6042675358098597, 'psi': 0.8765130094024889}
[S3] not sending this round → trigger blocked (psi=0.915)
[S4] START round=69 head_norm_before_train=2.036950 cos_to_last_merge=0.9913 (last merge round=41)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9306989828133604, 'auprc': 0.9369443162104926, 'loss_val': 0.29784900859305363, 'psi': 0.9331971161722132}-{'f1_val': 0.944409815351, 'auprc': 0.9830222655787475, 'loss_val': 0.2818039290786366, 'psi': 0.9598547954420991}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.696821 cos_to_last_merge=0.9679 (last merge round=38)
[S5] round=69 local utility u=0.003225 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939246889601259, 'loss_val': 0.03022635379029598, 'psi': 0.995591056671125}-{'f1_val': 0.9970695586110643, 'auprc': 0.9937357174667422, 'loss_val': 0.038315780876692476, 'psi': 0.9957360221533355}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=69 head_norm_before_train=2.077152 cos_to_last_merge=0.7895 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.789
[S6] round=69 local utility u=0.188833 metrics={'f1_val': 0.6702535996016385, 'auprc': 0.7443916087089382, 'loss_val': 1.1604872725619182, 'psi': 0.6999088032445584}-{'f1_val': 0.6274028150338877, 'auprc': 0.7822773778788423, 'loss_val': 1.3947057738255495, 'psi': 0.6893526401718696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=69 head_norm_before_train=1.818264 cos_to_last_merge=0.9978 (last merge round=39)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5970375477735594, 'auprc': 0.78382829424983, 'loss_val': 0.7040863214851072, 'psi': 0.6717538463640678}-{'f1_val': 0.7510697530106225, 'auprc': 0.9608718213855538, 'loss_val': 0.19857010684637075, 'psi': 0.834990580360595}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=2.307943 (no previous merge yet)
[S8] round=69 local utility u=0.004476 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9988583375030707, 'loss_val': 0.0261625385406472, 'psi': 0.9961587513605442}-{'f1_val': 0.9930382012516658, 'auprc': 0.9992237130001627, 'loss_val': 0.028286083218175294, 'psi': 0.9955124059510645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=69 head_norm_before_train=1.701809 cos_to_last_merge=0.9734 (last merge round=34)
[S9] round=69 local utility u=0.001992 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9982824630511016, 'loss_val': 0.024217327654387177, 'psi': 0.9964122890544097}-{'f1_val': 0.9947440946163844, 'auprc': 0.9982813770052821, 'loss_val': 0.025668892196743294, 'psi': 0.9961590075719435}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=69 head_norm_before_train=2.163828 cos_to_last_merge=0.9548 (last merge round=34)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940236040246102, 'loss_val': 0.027012285344879695, 'psi': 0.9944693318353615}-{'f1_val': 0.9947664837091956, 'auprc': 0.9942260334288335, 'loss_val': 0.027214208209982254, 'psi': 0.9945503035970508}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.778722 cos_to_last_merge=0.9625 (last merge round=35)
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9947094549336037, 'auprc': 0.9982577492058387, 'loss_val': 0.02715806173156693, 'psi': 0.9961287726424977}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981099769118258, 'loss_val': 0.024234886724850208, 'psi': 0.996924195712716}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.836110 cos_to_last_merge=0.9917 (last merge round=39)
[S13] round=69 local utility u=0.426968 metrics={'f1_val': 0.7366268849095163, 'auprc': 0.7437407987562901, 'loss_val': 0.875700135347879, 'psi': 0.7394724504482258}-{'f1_val': 0.6651581491277312, 'auprc': 0.7008552680494158, 'loss_val': 1.1721664183531557, 'psi': 0.679436996696405}
[S13] not sending this round → trigger blocked (psi=0.739)
[S14] START round=69 head_norm_before_train=1.938856 cos_to_last_merge=0.9758 (last merge round=39)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9990459109314569, 'loss_val': 0.017804128638772652, 'psi': 0.9978305380463082}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990492197042562, 'loss_val': 0.01691737764266526, 'psi': 0.9978181927763015}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=2.087043 cos_to_last_merge=0.9635 (last merge round=41)
[S15] round=69 local utility u=0.015480 metrics={'f1_val': 0.9181507453609636, 'auprc': 0.9970521782252351, 'loss_val': 0.17924453350087055, 'psi': 0.9497113185066722}-{'f1_val': 0.9148932727677044, 'auprc': 0.9970174866135618, 'loss_val': 0.1905547099140103, 'psi': 0.9477429583060473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=69 head_norm_before_train=1.888741 cos_to_last_merge=0.9596 (last merge round=41)
[S16] round=69 local utility u=0.431349 metrics={'f1_val': 0.991370805817843, 'auprc': 0.9876741485336967, 'loss_val': 0.04373613341562992, 'psi': 0.9898921429041845}-{'f1_val': 0.8946585552187857, 'auprc': 0.9838078108889385, 'loss_val': 0.3145621497377704, 'psi': 0.9303182574868468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=69 head_norm_before_train=1.790643 cos_to_last_merge=0.9792 (last merge round=40)
[S17] round=69 local utility u=0.099909 metrics={'f1_val': 0.8210222622412583, 'auprc': 0.93900200156061, 'loss_val': 0.7202009723218925, 'psi': 0.868214157968999}-{'f1_val': 0.8033216294595841, 'auprc': 0.9394384497915726, 'loss_val': 0.8151242392357689, 'psi': 0.8577683575923796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=70 head_norm_before_train=2.052263 cos_to_last_merge=0.9646 (last merge round=41)
[S2] round=70 local utility u=0.381783 metrics={'f1_val': 0.7082913303069304, 'auprc': 0.9906000954061722, 'loss_val': 0.6138996568776212, 'psi': 0.8212148363466272}-{'f1_val': 0.6888985047680225, 'auprc': 0.8245980846512683, 'loss_val': 0.7631017043055355, 'psi': 0.7431783367213208}
[S2] not sending this round → trigger blocked (psi=0.821)
[S3] START round=70 head_norm_before_train=1.706863 cos_to_last_merge=0.9835 (last merge round=40)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.8475130433196914, 'auprc': 0.9570317952776932, 'loss_val': 0.5260558886069004, 'psi': 0.8913205441028921}-{'f1_val': 0.870473963617997, 'auprc': 0.9809680979934272, 'loss_val': 0.39707346671629273, 'psi': 0.914671617368169}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.041729 cos_to_last_merge=0.9911 (last merge round=41)
[S4] round=70 local utility u=0.121253 metrics={'f1_val': 0.9412888844474001, 'auprc': 0.9814052934700042, 'loss_val': 0.2522661952750261, 'psi': 0.9573354480564418}-{'f1_val': 0.9306989828133604, 'auprc': 0.9369443162104926, 'loss_val': 0.29784900859305363, 'psi': 0.9331971161722132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=70 head_norm_before_train=1.704210 cos_to_last_merge=0.9672 (last merge round=38)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9909734037933015, 'loss_val': 0.03442395748522362, 'psi': 0.9941896486954547}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939246889601259, 'loss_val': 0.03022635379029598, 'psi': 0.995591056671125}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.088522 cos_to_last_merge=0.7884 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.788
[S6] round=70 local utility u=0.520072 metrics={'f1_val': 0.7511373550152268, 'auprc': 0.8622941179255631, 'loss_val': 0.9593542340822762, 'psi': 0.7956000601793614}-{'f1_val': 0.6702535996016385, 'auprc': 0.7443916087089382, 'loss_val': 1.1604872725619182, 'psi': 0.6999088032445584}
[S6] not sending this round → trigger blocked (psi=0.796)
[S7] START round=70 head_norm_before_train=1.819761 cos_to_last_merge=0.9977 (last merge round=39)
[S7] round=70 local utility u=0.524032 metrics={'f1_val': 0.6961287534293075, 'auprc': 0.8185641618780549, 'loss_val': 0.35477713112706294, 'psi': 0.7451029168088065}-{'f1_val': 0.5970375477735594, 'auprc': 0.78382829424983, 'loss_val': 0.7040863214851072, 'psi': 0.6717538463640678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=70 head_norm_before_train=2.312987 (no previous merge yet)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.7006134363551966, 'auprc': 0.8525149490862893, 'loss_val': 0.7843127288342062, 'psi': 0.7613740414476337}-{'f1_val': 0.9943590272655265, 'auprc': 0.9988583375030707, 'loss_val': 0.0261625385406472, 'psi': 0.9961587513605442}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=1.708182 cos_to_last_merge=0.9729 (last merge round=34)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.998331072464315, 'loss_val': 0.028929627319460284, 'psi': 0.994925103336127}-{'f1_val': 0.9951655063899485, 'auprc': 0.9982824630511016, 'loss_val': 0.024217327654387177, 'psi': 0.9964122890544097}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.171603 cos_to_last_merge=0.9541 (last merge round=34)
[S10] round=70 local utility u=0.000006 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939914594757955, 'loss_val': 0.0269041105298365, 'psi': 0.9944564740158355}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940236040246102, 'loss_val': 0.027012285344879695, 'psi': 0.9944693318353615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=70 head_norm_before_train=1.784536 cos_to_last_merge=0.9619 (last merge round=35)
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9870812881532985, 'auprc': 0.9975603157577869, 'loss_val': 0.05091605507578714, 'psi': 0.9912728991950939}-{'f1_val': 0.9947094549336037, 'auprc': 0.9982577492058387, 'loss_val': 0.02715806173156693, 'psi': 0.9961287726424977}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.846287 cos_to_last_merge=0.9911 (last merge round=39)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.7473957098250708, 'auprc': 0.72874946032029, 'loss_val': 1.1310454920990676, 'psi': 0.7399372100231585}-{'f1_val': 0.7366268849095163, 'auprc': 0.7437407987562901, 'loss_val': 0.875700135347879, 'psi': 0.7394724504482258}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.943393 cos_to_last_merge=0.9755 (last merge round=39)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9965773233830622, 'auprc': 0.9985921864570197, 'loss_val': 0.022672103285385384, 'psi': 0.9973832686126451}-{'f1_val': 0.9970202894562089, 'auprc': 0.9990459109314569, 'loss_val': 0.017804128638772652, 'psi': 0.9978305380463082}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.095073 cos_to_last_merge=0.9629 (last merge round=41)
[S15] round=70 local utility u=0.053504 metrics={'f1_val': 0.9302876235403376, 'auprc': 0.9971848517254153, 'loss_val': 0.14545645669720428, 'psi': 0.9570465148143686}-{'f1_val': 0.9181507453609636, 'auprc': 0.9970521782252351, 'loss_val': 0.17924453350087055, 'psi': 0.9497113185066722}
[S15] not sending this round → trigger blocked (psi=0.957)
[S16] START round=70 head_norm_before_train=1.896409 cos_to_last_merge=0.9589 (last merge round=41)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.991273326651706, 'auprc': 0.9880545945729304, 'loss_val': 0.04485023131243045, 'psi': 0.9899858338201958}-{'f1_val': 0.991370805817843, 'auprc': 0.9876741485336967, 'loss_val': 0.04373613341562992, 'psi': 0.9898921429041845}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=1.799490 cos_to_last_merge=0.9785 (last merge round=40)
[S17] round=70 local utility u=0.232572 metrics={'f1_val': 0.8963054247493407, 'auprc': 0.8677165067564313, 'loss_val': 0.49289884998151834, 'psi': 0.884869857552177}-{'f1_val': 0.8210222622412583, 'auprc': 0.93900200156061, 'loss_val': 0.7202009723218925, 'psi': 0.868214157968999}
[S17] not sending this round → trigger blocked (psi=0.885)
[S2] START round=71 head_norm_before_train=2.055252 cos_to_last_merge=0.9643 (last merge round=41)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.6974331855727947, 'auprc': 0.8587584401059631, 'loss_val': 0.6839002748256049, 'psi': 0.761963287386062}-{'f1_val': 0.7082913303069304, 'auprc': 0.9906000954061722, 'loss_val': 0.6138996568776212, 'psi': 0.8212148363466272}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=1.715634 cos_to_last_merge=0.9830 (last merge round=40)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.7337203673985508, 'auprc': 0.9016735001398524, 'loss_val': 0.9213560165475764, 'psi': 0.8009016204950714}-{'f1_val': 0.8475130433196914, 'auprc': 0.9570317952776932, 'loss_val': 0.5260558886069004, 'psi': 0.8913205441028921}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.045889 cos_to_last_merge=0.9909 (last merge round=41)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9417204704732852, 'auprc': 0.981121239545052, 'loss_val': 0.2903784492264451, 'psi': 0.9574807781019918}-{'f1_val': 0.9412888844474001, 'auprc': 0.9814052934700042, 'loss_val': 0.2522661952750261, 'psi': 0.9573354480564418}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.712628 cos_to_last_merge=0.9665 (last merge round=38)
[S5] round=71 local utility u=0.002196 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9912990582549777, 'loss_val': 0.03100900246447934, 'psi': 0.9943199104801251}-{'f1_val': 0.9963338119635569, 'auprc': 0.9909734037933015, 'loss_val': 0.03442395748522362, 'psi': 0.9941896486954547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=71 head_norm_before_train=2.096753 cos_to_last_merge=0.7876 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.788
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6433907690517215, 'auprc': 0.7408728629843018, 'loss_val': 1.4314947028412652, 'psi': 0.6823836066247537}-{'f1_val': 0.7511373550152268, 'auprc': 0.8622941179255631, 'loss_val': 0.9593542340822762, 'psi': 0.7956000601793614}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.823362 cos_to_last_merge=0.9976 (last merge round=39)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6089986042473002, 'auprc': 0.7887061750129576, 'loss_val': 0.7259583540193173, 'psi': 0.6808816325535632}-{'f1_val': 0.6961287534293075, 'auprc': 0.8185641618780549, 'loss_val': 0.35477713112706294, 'psi': 0.7451029168088065}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=2.315896 (no previous merge yet)
[S8] round=71 local utility u=1.000000 metrics={'f1_val': 0.9759952027997838, 'auprc': 0.9988958040524902, 'loss_val': 0.058833376473821655, 'psi': 0.9851554433008664}-{'f1_val': 0.7006134363551966, 'auprc': 0.8525149490862893, 'loss_val': 0.7843127288342062, 'psi': 0.7613740414476337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=71 head_norm_before_train=1.712118 cos_to_last_merge=0.9726 (last merge round=34)
[S9] round=71 local utility u=0.006889 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9935263482220613, 'loss_val': 0.022311013256176876, 'psi': 0.9951605961563911}-{'f1_val': 0.9926544572506684, 'auprc': 0.998331072464315, 'loss_val': 0.028929627319460284, 'psi': 0.994925103336127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=71 head_norm_before_train=2.172599 cos_to_last_merge=0.9540 (last merge round=34)
[S10] round=71 local utility u=0.000037 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939978884744175, 'loss_val': 0.026849826384985884, 'psi': 0.9944590456152844}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939914594757955, 'loss_val': 0.0269041105298365, 'psi': 0.9944564740158355}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=71 head_norm_before_train=1.789698 cos_to_last_merge=0.9615 (last merge round=35)
[S11] round=71 local utility u=0.040694 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978341704353791, 'loss_val': 0.024786165307342813, 'psi': 0.9968261530205988}-{'f1_val': 0.9870812881532985, 'auprc': 0.9975603157577869, 'loss_val': 0.05091605507578714, 'psi': 0.9912728991950939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=71 head_norm_before_train=1.859722 cos_to_last_merge=0.9904 (last merge round=39)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.6333641120425975, 'auprc': 0.6791229342178411, 'loss_val': 1.310498462064615, 'psi': 0.6516676409126949}-{'f1_val': 0.7473957098250708, 'auprc': 0.72874946032029, 'loss_val': 1.1310454920990676, 'psi': 0.7399372100231585}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=1.947344 cos_to_last_merge=0.9752 (last merge round=39)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9516907399907604, 'auprc': 0.9990323797657685, 'loss_val': 0.05927370037988334, 'psi': 0.9706273959007636}-{'f1_val': 0.9965773233830622, 'auprc': 0.9985921864570197, 'loss_val': 0.022672103285385384, 'psi': 0.9973832686126451}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=2.102951 cos_to_last_merge=0.9622 (last merge round=41)
[S15] round=71 local utility u=0.031069 metrics={'f1_val': 0.9374209704788372, 'auprc': 0.9972611044287127, 'loss_val': 0.12634659161471606, 'psi': 0.9613570240587874}-{'f1_val': 0.9302876235403376, 'auprc': 0.9971848517254153, 'loss_val': 0.14545645669720428, 'psi': 0.9570465148143686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=71 head_norm_before_train=1.901715 cos_to_last_merge=0.9584 (last merge round=41)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9276175079157337, 'auprc': 0.9805684231982914, 'loss_val': 0.4518171985761296, 'psi': 0.9487978740287568}-{'f1_val': 0.991273326651706, 'auprc': 0.9880545945729304, 'loss_val': 0.04485023131243045, 'psi': 0.9899858338201958}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.809375 cos_to_last_merge=0.9778 (last merge round=40)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8062094402845392, 'auprc': 0.860840284649916, 'loss_val': 0.7907042854056454, 'psi': 0.8280617780306899}-{'f1_val': 0.8963054247493407, 'auprc': 0.8677165067564313, 'loss_val': 0.49289884998151834, 'psi': 0.884869857552177}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=2.060650 cos_to_last_merge=0.9637 (last merge round=41)
[S2] round=72 local utility u=0.283925 metrics={'f1_val': 0.7093156867579709, 'auprc': 0.9917353894064249, 'loss_val': 0.5862764506866492, 'psi': 0.8222835678173526}-{'f1_val': 0.6974331855727947, 'auprc': 0.8587584401059631, 'loss_val': 0.6839002748256049, 'psi': 0.761963287386062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=72 head_norm_before_train=1.723512 cos_to_last_merge=0.9825 (last merge round=40)
[S3] round=72 local utility u=0.532513 metrics={'f1_val': 0.8105856879372428, 'auprc': 0.9846179207486536, 'loss_val': 0.5663557181020104, 'psi': 0.8801985810618072}-{'f1_val': 0.7337203673985508, 'auprc': 0.9016735001398524, 'loss_val': 0.9213560165475764, 'psi': 0.8009016204950714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=72 head_norm_before_train=2.054418 cos_to_last_merge=0.9906 (last merge round=41)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.930414951580978, 'auprc': 0.943172937997986, 'loss_val': 0.3329733294838599, 'psi': 0.9355181461477811}-{'f1_val': 0.9417204704732852, 'auprc': 0.981121239545052, 'loss_val': 0.2903784492264451, 'psi': 0.9574807781019918}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.721220 cos_to_last_merge=0.9658 (last merge round=38)
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9901829940835878, 'loss_val': 0.039342505767354, 'psi': 0.9938734848115691}-{'f1_val': 0.9963338119635569, 'auprc': 0.9912990582549777, 'loss_val': 0.03100900246447934, 'psi': 0.9943199104801251}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=2.099247 cos_to_last_merge=0.7874 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=72 local utility u=0.354358 metrics={'f1_val': 0.694041709132923, 'auprc': 0.787646060102714, 'loss_val': 1.167004701371649, 'psi': 0.7314834495208393}-{'f1_val': 0.6433907690517215, 'auprc': 0.7408728629843018, 'loss_val': 1.4314947028412652, 'psi': 0.6823836066247537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=72 head_norm_before_train=1.827770 cos_to_last_merge=0.9975 (last merge round=39)
[S7] round=72 local utility u=0.070240 metrics={'f1_val': 0.6213137038325944, 'auprc': 0.7952756917915845, 'loss_val': 0.6790780293422288, 'psi': 0.6908984990161905}-{'f1_val': 0.6089986042473002, 'auprc': 0.7887061750129576, 'loss_val': 0.7259583540193173, 'psi': 0.6808816325535632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=72 head_norm_before_train=2.313104 (no previous merge yet)
[S8] round=72 local utility u=0.072016 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.999105136938955, 'loss_val': 0.025612724647612536, 'psi': 0.9962574711348979}-{'f1_val': 0.9759952027997838, 'auprc': 0.9988958040524902, 'loss_val': 0.058833376473821655, 'psi': 0.9851554433008664}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=72 head_norm_before_train=1.716294 cos_to_last_merge=0.9723 (last merge round=34)
[S9] round=72 local utility u=0.006601 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9966692407215743, 'loss_val': 0.020999575826039948, 'psi': 0.9966640033769646}-{'f1_val': 0.9962500947792776, 'auprc': 0.9935263482220613, 'loss_val': 0.022311013256176876, 'psi': 0.9951605961563911}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=72 head_norm_before_train=2.177637 cos_to_last_merge=0.9536 (last merge round=34)
[S10] round=72 local utility u=0.000032 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939981831626195, 'loss_val': 0.026786282808937877, 'psi': 0.9944591634905651}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939978884744175, 'loss_val': 0.026849826384985884, 'psi': 0.9944590456152844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=72 head_norm_before_train=1.795378 cos_to_last_merge=0.9610 (last merge round=35)
[S11] round=72 local utility u=0.000639 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9980701382208953, 'loss_val': 0.024094031393144998, 'psi': 0.9969082602363437}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978341704353791, 'loss_val': 0.024786165307342813, 'psi': 0.9968261530205988}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=72 head_norm_before_train=1.868633 cos_to_last_merge=0.9899 (last merge round=39)
[S13] round=72 local utility u=0.749609 metrics={'f1_val': 0.7704832932965355, 'auprc': 0.7694144907963465, 'loss_val': 0.9048692575179959, 'psi': 0.7700557722964599}-{'f1_val': 0.6333641120425975, 'auprc': 0.6791229342178411, 'loss_val': 1.310498462064615, 'psi': 0.6516676409126949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=72 head_norm_before_train=1.952659 cos_to_last_merge=0.9748 (last merge round=39)
[S14] round=72 local utility u=0.155217 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9990465081873702, 'loss_val': 0.020684800131167733, 'psi': 0.9978132294884174}-{'f1_val': 0.9516907399907604, 'auprc': 0.9990323797657685, 'loss_val': 0.05927370037988334, 'psi': 0.9706273959007636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=72 head_norm_before_train=2.110514 cos_to_last_merge=0.9616 (last merge round=41)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9348943582185678, 'auprc': 0.9972513151109172, 'loss_val': 0.13308400843967133, 'psi': 0.9598371409755075}-{'f1_val': 0.9374209704788372, 'auprc': 0.9972611044287127, 'loss_val': 0.12634659161471606, 'psi': 0.9613570240587874}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.905673 cos_to_last_merge=0.9579 (last merge round=41)
[S16] round=72 local utility u=0.411041 metrics={'f1_val': 0.9922158355346136, 'auprc': 0.9884808252333004, 'loss_val': 0.04106192435636077, 'psi': 0.9907218314140883}-{'f1_val': 0.9276175079157337, 'auprc': 0.9805684231982914, 'loss_val': 0.4518171985761296, 'psi': 0.9487978740287568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=72 head_norm_before_train=1.820050 cos_to_last_merge=0.9771 (last merge round=40)
[S17] round=72 local utility u=0.403041 metrics={'f1_val': 0.8950248555891562, 'auprc': 0.8555858010263333, 'loss_val': 0.5017522830938334, 'psi': 0.8792492337640271}-{'f1_val': 0.8062094402845392, 'auprc': 0.860840284649916, 'loss_val': 0.7907042854056454, 'psi': 0.8280617780306899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=73 head_norm_before_train=2.064448 cos_to_last_merge=0.9633 (last merge round=41)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.6017158770775444, 'auprc': 0.794852007992552, 'loss_val': 1.3345831794956013, 'psi': 0.6789703294435474}-{'f1_val': 0.7093156867579709, 'auprc': 0.9917353894064249, 'loss_val': 0.5862764506866492, 'psi': 0.8222835678173526}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=1.730952 cos_to_last_merge=0.9821 (last merge round=40)
[S3] round=73 local utility u=0.368144 metrics={'f1_val': 0.8816147063816291, 'auprc': 0.9962747397388265, 'loss_val': 0.2912125885366916, 'psi': 0.9274787197245081}-{'f1_val': 0.8105856879372428, 'auprc': 0.9846179207486536, 'loss_val': 0.5663557181020104, 'psi': 0.8801985810618072}
[S3] not sending this round → trigger blocked (psi=0.927)
[S4] START round=73 head_norm_before_train=2.058770 cos_to_last_merge=0.9903 (last merge round=41)
[S4] round=73 local utility u=0.150031 metrics={'f1_val': 0.9466518578456926, 'auprc': 0.9828028181590414, 'loss_val': 0.24922209122110506, 'psi': 0.9611122419710322}-{'f1_val': 0.930414951580978, 'auprc': 0.943172937997986, 'loss_val': 0.3329733294838599, 'psi': 0.9355181461477811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=73 head_norm_before_train=1.732438 cos_to_last_merge=0.9648 (last merge round=38)
[S5] round=73 local utility u=0.007406 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9918316695191882, 'loss_val': 0.029476419012568436, 'psi': 0.9945329549858093}-{'f1_val': 0.9963338119635569, 'auprc': 0.9901829940835878, 'loss_val': 0.039342505767354, 'psi': 0.9938734848115691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S5] sending update (kind=head size=1808 to 1 peers)
[S6] START round=73 head_norm_before_train=2.103163 cos_to_last_merge=0.7869 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=73 local utility u=0.219121 metrics={'f1_val': 0.7210276030968539, 'auprc': 0.8423199539067716, 'loss_val': 1.054699596720498, 'psi': 0.769544543420821}-{'f1_val': 0.694041709132923, 'auprc': 0.787646060102714, 'loss_val': 1.167004701371649, 'psi': 0.7314834495208393}
[S6] not sending this round → trigger blocked (psi=0.770)
[S7] START round=73 head_norm_before_train=1.832683 cos_to_last_merge=0.9973 (last merge round=39)
[S7] round=73 local utility u=0.001837 metrics={'f1_val': 0.6168472242962173, 'auprc': 0.7939907182079828, 'loss_val': 0.6447493382536331, 'psi': 0.6877046218609235}-{'f1_val': 0.6213137038325944, 'auprc': 0.7952756917915845, 'loss_val': 0.6790780293422288, 'psi': 0.6908984990161905}
[S7] not sending this round → trigger blocked (psi=0.688)
[S8] START round=73 head_norm_before_train=2.318155 (no previous merge yet)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9990958964342114, 'loss_val': 0.026493692287400703, 'psi': 0.9962537749330005}-{'f1_val': 0.9943590272655265, 'auprc': 0.999105136938955, 'loss_val': 0.025612724647612536, 'psi': 0.9962574711348979}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.721415 cos_to_last_merge=0.9718 (last merge round=34)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9862500280618778, 'auprc': 0.9961648416228333, 'loss_val': 0.054237837243674376, 'psi': 0.99021595348626}-{'f1_val': 0.9966605118138915, 'auprc': 0.9966692407215743, 'loss_val': 0.020999575826039948, 'psi': 0.9966640033769646}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.184489 cos_to_last_merge=0.9530 (last merge round=34)
[S10] round=73 local utility u=0.000055 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940119870532873, 'loss_val': 0.026717218769205412, 'psi': 0.9944646850468323}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939981831626195, 'loss_val': 0.026786282808937877, 'psi': 0.9944591634905651}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=73 head_norm_before_train=1.801857 cos_to_last_merge=0.9605 (last merge round=35)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9501590466861968, 'auprc': 0.9978190423617466, 'loss_val': 0.17820072359931913, 'psi': 0.9692230449564168}-{'f1_val': 0.9961336749133093, 'auprc': 0.9980701382208953, 'loss_val': 0.024094031393144998, 'psi': 0.9969082602363437}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.875493 cos_to_last_merge=0.9895 (last merge round=39)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.746051513859803, 'auprc': 0.7846431062557819, 'loss_val': 1.0700349590715446, 'psi': 0.7614881508181945}-{'f1_val': 0.7704832932965355, 'auprc': 0.7694144907963465, 'loss_val': 0.9048692575179959, 'psi': 0.7700557722964599}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=1.956929 cos_to_last_merge=0.9745 (last merge round=39)
[S14] round=73 local utility u=0.003015 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990435816566738, 'loss_val': 0.017165538192682156, 'psi': 0.9980640292233665}-{'f1_val': 0.9969910436891155, 'auprc': 0.9990465081873702, 'loss_val': 0.020684800131167733, 'psi': 0.9978132294884174}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=73 head_norm_before_train=2.117885 cos_to_last_merge=0.9610 (last merge round=41)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9333672888498293, 'auprc': 0.9972257436662271, 'loss_val': 0.1404321167512409, 'psi': 0.9589106707763885}-{'f1_val': 0.9348943582185678, 'auprc': 0.9972513151109172, 'loss_val': 0.13308400843967133, 'psi': 0.9598371409755075}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.910150 cos_to_last_merge=0.9575 (last merge round=41)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.8777758197018249, 'auprc': 0.9840768412679053, 'loss_val': 0.4329737057701041, 'psi': 0.920296228328257}-{'f1_val': 0.9922158355346136, 'auprc': 0.9884808252333004, 'loss_val': 0.04106192435636077, 'psi': 0.9907218314140883}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.828354 cos_to_last_merge=0.9765 (last merge round=40)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.6876521398296684, 'auprc': 0.8596146432003617, 'loss_val': 1.2012513671330898, 'psi': 0.7564371411779458}-{'f1_val': 0.8950248555891562, 'auprc': 0.8555858010263333, 'loss_val': 0.5017522830938334, 'psi': 0.8792492337640271}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.073107 cos_to_last_merge=0.9627 (last merge round=41)
[S2] round=74 local utility u=0.991163 metrics={'f1_val': 0.7095896523819583, 'auprc': 0.983358486418285, 'loss_val': 0.5650192171845025, 'psi': 0.8190971859964891}-{'f1_val': 0.6017158770775444, 'auprc': 0.794852007992552, 'loss_val': 1.3345831794956013, 'psi': 0.6789703294435474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=74 head_norm_before_train=1.738487 cos_to_last_merge=0.9816 (last merge round=40)
[S3] round=74 local utility u=0.120648 metrics={'f1_val': 0.9153744175519563, 'auprc': 0.9883648723675056, 'loss_val': 0.2287461611859247, 'psi': 0.944570599478176}-{'f1_val': 0.8816147063816291, 'auprc': 0.9962747397388265, 'loss_val': 0.2912125885366916, 'psi': 0.9274787197245081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=74 head_norm_before_train=2.062507 cos_to_last_merge=0.9899 (last merge round=41)
[S4] round=74 local utility u=0.001253 metrics={'f1_val': 0.945624666165717, 'auprc': 0.9853765230069531, 'loss_val': 0.24827339119868325, 'psi': 0.9615254089022114}-{'f1_val': 0.9466518578456926, 'auprc': 0.9828028181590414, 'loss_val': 0.24922209122110506, 'psi': 0.9611122419710322}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=74 head_norm_before_train=1.745009 cos_to_last_merge=0.9637 (last merge round=38)
[S5] round=74 local utility u=0.005732 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940113923596706, 'loss_val': 0.02676104970897517, 'psi': 0.9956257380309428}-{'f1_val': 0.9963338119635569, 'auprc': 0.9918316695191882, 'loss_val': 0.029476419012568436, 'psi': 0.9945329549858093}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=74 head_norm_before_train=2.110198 cos_to_last_merge=0.7863 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=74 local utility u=1.000000 metrics={'f1_val': 0.9128727172499974, 'auprc': 0.9383459396281584, 'loss_val': 0.2557660548319393, 'psi': 0.9230620062012618}-{'f1_val': 0.7210276030968539, 'auprc': 0.8423199539067716, 'loss_val': 1.054699596720498, 'psi': 0.769544543420821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=74 head_norm_before_train=1.837774 cos_to_last_merge=0.9971 (last merge round=39)
[S7] round=74 local utility u=0.096615 metrics={'f1_val': 0.6276292716422208, 'auprc': 0.800211351817786, 'loss_val': 0.5348741805807915, 'psi': 0.696662103712447}-{'f1_val': 0.6168472242962173, 'auprc': 0.7939907182079828, 'loss_val': 0.6447493382536331, 'psi': 0.6877046218609235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=74 head_norm_before_train=2.326549 (no previous merge yet)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9773611464556267, 'auprc': 0.9989757556446774, 'loss_val': 0.053623276818048723, 'psi': 0.9860069901312469}-{'f1_val': 0.9943590272655265, 'auprc': 0.9990958964342114, 'loss_val': 0.026493692287400703, 'psi': 0.9962537749330005}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=1.727505 cos_to_last_merge=0.9714 (last merge round=34)
[S9] round=74 local utility u=0.042167 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9983695308662935, 'loss_val': 0.023979219784405006, 'psi': 0.9958438723701915}-{'f1_val': 0.9862500280618778, 'auprc': 0.9961648416228333, 'loss_val': 0.054237837243674376, 'psi': 0.99021595348626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=74 head_norm_before_train=2.191858 cos_to_last_merge=0.9524 (last merge round=34)
[S10] round=74 local utility u=0.000317 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9942431463769049, 'loss_val': 0.026775831792468015, 'psi': 0.9945571487762793}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940119870532873, 'loss_val': 0.026717218769205412, 'psi': 0.9944646850468323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=74 head_norm_before_train=1.806196 cos_to_last_merge=0.9601 (last merge round=35)
[S11] round=74 local utility u=0.212074 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978895168168816, 'loss_val': 0.028660041301554803, 'psi': 0.9966909094479011}-{'f1_val': 0.9501590466861968, 'auprc': 0.9978190423617466, 'loss_val': 0.17820072359931913, 'psi': 0.9692230449564168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=74 head_norm_before_train=1.878156 cos_to_last_merge=0.9892 (last merge round=39)
[S13] round=74 local utility u=0.230046 metrics={'f1_val': 0.7693987726489259, 'auprc': 0.8118868320475802, 'loss_val': 0.8317582639947878, 'psi': 0.7863939964083876}-{'f1_val': 0.746051513859803, 'auprc': 0.7846431062557819, 'loss_val': 1.0700349590715446, 'psi': 0.7614881508181945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=74 head_norm_before_train=1.960526 cos_to_last_merge=0.9741 (last merge round=39)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9990471795591007, 'loss_val': 0.018085782683047617, 'psi': 0.9978061781847629}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990435816566738, 'loss_val': 0.017165538192682156, 'psi': 0.9980640292233665}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.125020 cos_to_last_merge=0.9605 (last merge round=41)
[S15] round=74 local utility u=0.037827 metrics={'f1_val': 0.9429004481172103, 'auprc': 0.9972771386927645, 'loss_val': 0.12213172413673237, 'psi': 0.9646511243474319}-{'f1_val': 0.9333672888498293, 'auprc': 0.9972257436662271, 'loss_val': 0.1404321167512409, 'psi': 0.9589106707763885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=74 head_norm_before_train=1.915795 cos_to_last_merge=0.9570 (last merge round=41)
[S16] round=74 local utility u=0.509990 metrics={'f1_val': 0.9862329699618105, 'auprc': 0.9849621164915762, 'loss_val': 0.06639280093239912, 'psi': 0.9857246285737168}-{'f1_val': 0.8777758197018249, 'auprc': 0.9840768412679053, 'loss_val': 0.4329737057701041, 'psi': 0.920296228328257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=74 head_norm_before_train=1.832771 cos_to_last_merge=0.9760 (last merge round=40)
[S17] round=74 local utility u=0.626409 metrics={'f1_val': 0.8474792744114488, 'auprc': 0.7819368988914973, 'loss_val': 0.6743628440671796, 'psi': 0.8212623242034682}-{'f1_val': 0.6876521398296684, 'auprc': 0.8596146432003617, 'loss_val': 1.2012513671330898, 'psi': 0.7564371411779458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=75 head_norm_before_train=2.079624 cos_to_last_merge=0.9622 (last merge round=41)
[S2] round=75 local utility u=0.035568 metrics={'f1_val': 0.709590108822474, 'auprc': 0.989891508721691, 'loss_val': 0.5134843018453679, 'psi': 0.8217106687821607}-{'f1_val': 0.7095896523819583, 'auprc': 0.983358486418285, 'loss_val': 0.5650192171845025, 'psi': 0.8190971859964891}
[S2] not sending this round → trigger blocked (psi=0.822)
[S3] START round=75 head_norm_before_train=1.746097 cos_to_last_merge=0.9811 (last merge round=40)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.896925068578775, 'auprc': 0.9690555702562491, 'loss_val': 0.3426073357975019, 'psi': 0.9257772692497647}-{'f1_val': 0.9153744175519563, 'auprc': 0.9883648723675056, 'loss_val': 0.2287461611859247, 'psi': 0.944570599478176}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=2.068642 cos_to_last_merge=0.9899 (last merge round=41)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9331483703689459, 'auprc': 0.9422893384722962, 'loss_val': 0.31253286756961, 'psi': 0.936804757610286}-{'f1_val': 0.945624666165717, 'auprc': 0.9853765230069531, 'loss_val': 0.24827339119868325, 'psi': 0.9615254089022114}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.755346 cos_to_last_merge=0.9626 (last merge round=38)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9909010205702694, 'loss_val': 0.039937984654930696, 'psi': 0.9941606954062419}-{'f1_val': 0.9967019684784577, 'auprc': 0.9940113923596706, 'loss_val': 0.02676104970897517, 'psi': 0.9956257380309428}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=2.120604 cos_to_last_merge=0.7856 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.8425899700678416, 'auprc': 0.9700937297958303, 'loss_val': 0.2538325502103864, 'psi': 0.8935914739590372}-{'f1_val': 0.9128727172499974, 'auprc': 0.9383459396281584, 'loss_val': 0.2557660548319393, 'psi': 0.9230620062012618}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.844378 cos_to_last_merge=0.9969 (last merge round=39)
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6119318000575914, 'auprc': 0.795636330912732, 'loss_val': 0.6566041087909625, 'psi': 0.6854136123996477}-{'f1_val': 0.6276292716422208, 'auprc': 0.800211351817786, 'loss_val': 0.5348741805807915, 'psi': 0.696662103712447}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.327896 (no previous merge yet)
[S8] round=75 local utility u=0.062308 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9991337280957763, 'loss_val': 0.027066852388862184, 'psi': 0.9958286935070084}-{'f1_val': 0.9773611464556267, 'auprc': 0.9989757556446774, 'loss_val': 0.053623276818048723, 'psi': 0.9860069901312469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=75 head_norm_before_train=1.733612 cos_to_last_merge=0.9710 (last merge round=34)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9901390217031396, 'loss_val': 0.02183524876742614, 'psi': 0.9938056655488224}-{'f1_val': 0.9941601000394567, 'auprc': 0.9983695308662935, 'loss_val': 0.023979219784405006, 'psi': 0.9958438723701915}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.199284 cos_to_last_merge=0.9518 (last merge round=34)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9942515882097845, 'loss_val': 0.026848341350353484, 'psi': 0.9945605255094312}-{'f1_val': 0.9947664837091956, 'auprc': 0.9942431463769049, 'loss_val': 0.026775831792468015, 'psi': 0.9945571487762793}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=1.811727 cos_to_last_merge=0.9596 (last merge round=35)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9885029689749749, 'auprc': 0.9980272509177309, 'loss_val': 0.0478695404030272, 'psi': 0.9923126817520773}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978895168168816, 'loss_val': 0.028660041301554803, 'psi': 0.9966909094479011}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.885761 cos_to_last_merge=0.9886 (last merge round=39)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.7258628701562123, 'auprc': 0.7377063844684424, 'loss_val': 1.1296009613303746, 'psi': 0.7306002758811043}-{'f1_val': 0.7693987726489259, 'auprc': 0.8118868320475802, 'loss_val': 0.8317582639947878, 'psi': 0.7863939964083876}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=1.965313 cos_to_last_merge=0.9738 (last merge round=39)
[S14] round=75 local utility u=0.002301 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990503818173849, 'loss_val': 0.01752777020351882, 'psi': 0.9982108235568661}-{'f1_val': 0.9969788439352044, 'auprc': 0.9990471795591007, 'loss_val': 0.018085782683047617, 'psi': 0.9978061781847629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=75 head_norm_before_train=2.132027 cos_to_last_merge=0.9599 (last merge round=41)
[S15] round=75 local utility u=0.027006 metrics={'f1_val': 0.9506858069062497, 'auprc': 0.9972920486872162, 'loss_val': 0.11487723304392229, 'psi': 0.9693283036186362}-{'f1_val': 0.9429004481172103, 'auprc': 0.9972771386927645, 'loss_val': 0.12213172413673237, 'psi': 0.9646511243474319}
[S15] not sending this round → trigger blocked (psi=0.969)
[S16] START round=75 head_norm_before_train=1.920457 cos_to_last_merge=0.9565 (last merge round=41)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9462070036012808, 'auprc': 0.9751416356473794, 'loss_val': 0.22739778248289652, 'psi': 0.9577808564197203}-{'f1_val': 0.9862329699618105, 'auprc': 0.9849621164915762, 'loss_val': 0.06639280093239912, 'psi': 0.9857246285737168}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.839304 cos_to_last_merge=0.9756 (last merge round=40)
[S17] round=75 local utility u=0.016190 metrics={'f1_val': 0.8344130817932033, 'auprc': 0.8156578285886922, 'loss_val': 0.6647478539202243, 'psi': 0.8269109805113989}-{'f1_val': 0.8474792744114488, 'auprc': 0.7819368988914973, 'loss_val': 0.6743628440671796, 'psi': 0.8212623242034682}
[S17] not sending this round → trigger blocked (psi=0.827)
[S2] START round=76 head_norm_before_train=2.088280 cos_to_last_merge=0.9617 (last merge round=41)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.710192339996905, 'auprc': 0.8774127539237084, 'loss_val': 0.6162542269640717, 'psi': 0.7770805055676264}-{'f1_val': 0.709590108822474, 'auprc': 0.989891508721691, 'loss_val': 0.5134843018453679, 'psi': 0.8217106687821607}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=1.753311 cos_to_last_merge=0.9807 (last merge round=40)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.8732788734485069, 'auprc': 0.9751051524944667, 'loss_val': 0.3749683355516874, 'psi': 0.9140093850668908}-{'f1_val': 0.896925068578775, 'auprc': 0.9690555702562491, 'loss_val': 0.3426073357975019, 'psi': 0.9257772692497647}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=2.072963 cos_to_last_merge=0.9898 (last merge round=41)
[S4] round=76 local utility u=0.020947 metrics={'f1_val': 0.9329740441822518, 'auprc': 0.9563164059695919, 'loss_val': 0.31167366079018055, 'psi': 0.9423109888971879}-{'f1_val': 0.9331483703689459, 'auprc': 0.9422893384722962, 'loss_val': 0.31253286756961, 'psi': 0.936804757610286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=76 head_norm_before_train=1.759972 cos_to_last_merge=0.9620 (last merge round=38)
[S5] round=76 local utility u=0.007839 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9926464418361615, 'loss_val': 0.029496036876666413, 'psi': 0.9948588639125986}-{'f1_val': 0.9963338119635569, 'auprc': 0.9909010205702694, 'loss_val': 0.039937984654930696, 'psi': 0.9941606954062419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=76 head_norm_before_train=2.130597 cos_to_last_merge=0.7845 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7029583957953033, 'auprc': 0.7454062967351477, 'loss_val': 1.0006852097771903, 'psi': 0.7199375561712411}-{'f1_val': 0.8425899700678416, 'auprc': 0.9700937297958303, 'loss_val': 0.2538325502103864, 'psi': 0.8935914739590372}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.853821 cos_to_last_merge=0.9965 (last merge round=39)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6021708725654309, 'auprc': 0.796117876362256, 'loss_val': 0.6291526261278139, 'psi': 0.6797496740841609}-{'f1_val': 0.6119318000575914, 'auprc': 0.795636330912732, 'loss_val': 0.6566041087909625, 'psi': 0.6854136123996477}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=2.336126 (no previous merge yet)
[S8] round=76 local utility u=0.003109 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9992033370926235, 'loss_val': 0.02546066836611134, 'psi': 0.9962967511963654}-{'f1_val': 0.9936253371144965, 'auprc': 0.9991337280957763, 'loss_val': 0.027066852388862184, 'psi': 0.9958286935070084}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=76 head_norm_before_train=1.736968 cos_to_last_merge=0.9707 (last merge round=34)
[S9] round=76 local utility u=0.004775 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9925147207495097, 'loss_val': 0.02056455197374473, 'psi': 0.9948711868067299}-{'f1_val': 0.9962500947792776, 'auprc': 0.9901390217031396, 'loss_val': 0.02183524876742614, 'psi': 0.9938056655488224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=76 head_norm_before_train=2.201857 cos_to_last_merge=0.9516 (last merge round=34)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939944127316807, 'loss_val': 0.026822242765551035, 'psi': 0.9944576553181896}-{'f1_val': 0.9947664837091956, 'auprc': 0.9942515882097845, 'loss_val': 0.026848341350353484, 'psi': 0.9945605255094312}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.817096 cos_to_last_merge=0.9591 (last merge round=35)
[S11] round=76 local utility u=0.034759 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978977297204041, 'loss_val': 0.02374818835131638, 'psi': 0.9968392968361472}-{'f1_val': 0.9885029689749749, 'auprc': 0.9980272509177309, 'loss_val': 0.0478695404030272, 'psi': 0.9923126817520773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=76 head_norm_before_train=1.893919 cos_to_last_merge=0.9878 (last merge round=39)
[S13] round=76 local utility u=0.268282 metrics={'f1_val': 0.7603185418334723, 'auprc': 0.7864008001903089, 'loss_val': 0.9458533615201224, 'psi': 0.7707514451762069}-{'f1_val': 0.7258628701562123, 'auprc': 0.7377063844684424, 'loss_val': 1.1296009613303746, 'psi': 0.7306002758811043}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=76 head_norm_before_train=1.970633 cos_to_last_merge=0.9734 (last merge round=39)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9965992529308234, 'auprc': 0.9986695357427298, 'loss_val': 0.023296824214720565, 'psi': 0.9974273660555859}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990503818173849, 'loss_val': 0.01752777020351882, 'psi': 0.9982108235568661}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=2.138894 cos_to_last_merge=0.9594 (last merge round=41)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9429004481172103, 'auprc': 0.9972700288562708, 'loss_val': 0.12420073085428329, 'psi': 0.9646482804128345}-{'f1_val': 0.9506858069062497, 'auprc': 0.9972920486872162, 'loss_val': 0.11487723304392229, 'psi': 0.9693283036186362}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.923494 cos_to_last_merge=0.9561 (last merge round=41)
[S16] round=76 local utility u=0.252711 metrics={'f1_val': 0.992729206564174, 'auprc': 0.9888798798664705, 'loss_val': 0.04232392504866421, 'psi': 0.9911894758850925}-{'f1_val': 0.9462070036012808, 'auprc': 0.9751416356473794, 'loss_val': 0.22739778248289652, 'psi': 0.9577808564197203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=76 head_norm_before_train=1.845885 cos_to_last_merge=0.9750 (last merge round=40)
[S17] round=76 local utility u=0.158122 metrics={'f1_val': 0.8576282382065212, 'auprc': 0.8495001729326542, 'loss_val': 0.5893225504693483, 'psi': 0.8543770120969745}-{'f1_val': 0.8344130817932033, 'auprc': 0.8156578285886922, 'loss_val': 0.6647478539202243, 'psi': 0.8269109805113989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=77 head_norm_before_train=2.093784 cos_to_last_merge=0.9612 (last merge round=41)
[S2] round=77 local utility u=0.170991 metrics={'f1_val': 0.7097721377789685, 'auprc': 0.9781577146624509, 'loss_val': 0.5739866037853877, 'psi': 0.8171263685323615}-{'f1_val': 0.710192339996905, 'auprc': 0.8774127539237084, 'loss_val': 0.6162542269640717, 'psi': 0.7770805055676264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=77 head_norm_before_train=1.759652 cos_to_last_merge=0.9802 (last merge round=40)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.8509642808806759, 'auprc': 0.9873203616429215, 'loss_val': 0.4031697324379806, 'psi': 0.9055067131855742}-{'f1_val': 0.8732788734485069, 'auprc': 0.9751051524944667, 'loss_val': 0.3749683355516874, 'psi': 0.9140093850668908}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.081320 cos_to_last_merge=0.9897 (last merge round=41)
[S4] round=77 local utility u=0.002166 metrics={'f1_val': 0.9330864796261764, 'auprc': 0.9574756496264362, 'loss_val': 0.31149322214104874, 'psi': 0.9428421476262803}-{'f1_val': 0.9329740441822518, 'auprc': 0.9563164059695919, 'loss_val': 0.31167366079018055, 'psi': 0.9423109888971879}
[S4] not sending this round → trigger blocked (psi=0.943)
[S5] START round=77 head_norm_before_train=1.764004 cos_to_last_merge=0.9613 (last merge round=38)
[S5] round=77 local utility u=0.004369 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939184902586456, 'loss_val': 0.026783475714051604, 'psi': 0.9955885771905328}-{'f1_val': 0.9963338119635569, 'auprc': 0.9926464418361615, 'loss_val': 0.029496036876666413, 'psi': 0.9948588639125986}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=77 head_norm_before_train=2.141163 cos_to_last_merge=0.7837 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.784
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6651339003139322, 'auprc': 0.8117795002095765, 'loss_val': 1.165361468808035, 'psi': 0.7237921402721899}-{'f1_val': 0.7029583957953033, 'auprc': 0.7454062967351477, 'loss_val': 1.0006852097771903, 'psi': 0.7199375561712411}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.867394 cos_to_last_merge=0.9960 (last merge round=39)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5942970144964033, 'auprc': 0.7935103712192277, 'loss_val': 0.7867053344624693, 'psi': 0.673982357185533}-{'f1_val': 0.6021708725654309, 'auprc': 0.796117876362256, 'loss_val': 0.6291526261278139, 'psi': 0.6797496740841609}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.346955 (no previous merge yet)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990749944365226, 'loss_val': 0.026608916598439444, 'psi': 0.995805200043307}-{'f1_val': 0.9943590272655265, 'auprc': 0.9992033370926235, 'loss_val': 0.02546066836611134, 'psi': 0.9962967511963654}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=1.741822 cos_to_last_merge=0.9703 (last merge round=34)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9914249079028262, 'auprc': 0.9981098863720723, 'loss_val': 0.030865261347415712, 'psi': 0.9940988992905246}-{'f1_val': 0.99644216417821, 'auprc': 0.9925147207495097, 'loss_val': 0.02056455197374473, 'psi': 0.9948711868067299}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.204994 cos_to_last_merge=0.9513 (last merge round=34)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939973794420889, 'loss_val': 0.026831912934199002, 'psi': 0.9944588420023529}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939944127316807, 'loss_val': 0.026822242765551035, 'psi': 0.9944576553181896}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=1.822819 cos_to_last_merge=0.9586 (last merge round=35)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9980123571225423, 'loss_val': 0.024781316140968165, 'psi': 0.9967400455701654}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978977297204041, 'loss_val': 0.02374818835131638, 'psi': 0.9968392968361472}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.906228 cos_to_last_merge=0.9869 (last merge round=39)
[S13] round=77 local utility u=0.006109 metrics={'f1_val': 0.7606687274968922, 'auprc': 0.7819475103878468, 'loss_val': 0.9223765441276959, 'psi': 0.7691802406532741}-{'f1_val': 0.7603185418334723, 'auprc': 0.7864008001903089, 'loss_val': 0.9458533615201224, 'psi': 0.7707514451762069}
[S13] not sending this round → trigger blocked (psi=0.769)
[S14] START round=77 head_norm_before_train=1.977927 cos_to_last_merge=0.9730 (last merge round=39)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9966235765367457, 'auprc': 0.9985837795357007, 'loss_val': 0.026131820989987453, 'psi': 0.9974076577363278}-{'f1_val': 0.9965992529308234, 'auprc': 0.9986695357427298, 'loss_val': 0.023296824214720565, 'psi': 0.9974273660555859}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.145500 cos_to_last_merge=0.9588 (last merge round=41)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9409202586959946, 'auprc': 0.9972632232921763, 'loss_val': 0.12747137290714233, 'psi': 0.9634574445344672}-{'f1_val': 0.9429004481172103, 'auprc': 0.9972700288562708, 'loss_val': 0.12420073085428329, 'psi': 0.9646482804128345}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=1.928055 cos_to_last_merge=0.9557 (last merge round=41)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9920779125332927, 'auprc': 0.9887742400814511, 'loss_val': 0.040105588762058095, 'psi': 0.9907564435525561}-{'f1_val': 0.992729206564174, 'auprc': 0.9888798798664705, 'loss_val': 0.04232392504866421, 'psi': 0.9911894758850925}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.854684 cos_to_last_merge=0.9743 (last merge round=40)
[S17] round=77 local utility u=0.160918 metrics={'f1_val': 0.8622616096261473, 'auprc': 0.9327911508686046, 'loss_val': 0.5451593542358236, 'psi': 0.8904734261231302}-{'f1_val': 0.8576282382065212, 'auprc': 0.8495001729326542, 'loss_val': 0.5893225504693483, 'psi': 0.8543770120969745}
[S17] not sending this round → trigger blocked (psi=0.890)
[S2] START round=78 head_norm_before_train=2.095187 cos_to_last_merge=0.9603 (last merge round=41)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6117038543999853, 'auprc': 0.7914399613136978, 'loss_val': 1.4820162271415092, 'psi': 0.6835982971654704}-{'f1_val': 0.7097721377789685, 'auprc': 0.9781577146624509, 'loss_val': 0.5739866037853877, 'psi': 0.8171263685323615}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=1.764494 cos_to_last_merge=0.9799 (last merge round=40)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.7139850913155661, 'auprc': 0.895861988180356, 'loss_val': 1.0061396636421445, 'psi': 0.7867358500614821}-{'f1_val': 0.8509642808806759, 'auprc': 0.9873203616429215, 'loss_val': 0.4031697324379806, 'psi': 0.9055067131855742}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.083062 cos_to_last_merge=0.9894 (last merge round=41)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9328956700893176, 'auprc': 0.9536535784081942, 'loss_val': 0.3101122880132425, 'psi': 0.9411988334168683}-{'f1_val': 0.9330864796261764, 'auprc': 0.9574756496264362, 'loss_val': 0.31149322214104874, 'psi': 0.9428421476262803}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.769632 cos_to_last_merge=0.9608 (last merge round=38)
[S5] round=78 local utility u=0.000602 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939172708714704, 'loss_val': 0.02557628606761182, 'psi': 0.9955880894356628}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939184902586456, 'loss_val': 0.026783475714051604, 'psi': 0.9955885771905328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=78 head_norm_before_train=2.150109 cos_to_last_merge=0.7833 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.783
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.9620583333881637, 'auprc': 0.9608071946183571, 'loss_val': 0.1640269875738123, 'psi': 0.961557877880241}-{'f1_val': 0.6651339003139322, 'auprc': 0.8117795002095765, 'loss_val': 1.165361468808035, 'psi': 0.7237921402721899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=78 head_norm_before_train=1.880143 cos_to_last_merge=0.9954 (last merge round=39)
[S7] round=78 local utility u=1.000000 metrics={'f1_val': 0.8735632715933261, 'auprc': 0.888218868445501, 'loss_val': 0.21125796917410528, 'psi': 0.8794255103341961}-{'f1_val': 0.5942970144964033, 'auprc': 0.7935103712192277, 'loss_val': 0.7867053344624693, 'psi': 0.673982357185533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=78 head_norm_before_train=2.354251 (no previous merge yet)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9860527263438272, 'auprc': 0.9987719519954734, 'loss_val': 0.04739915519531965, 'psi': 0.9911404166044857}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990749944365226, 'loss_val': 0.026608916598439444, 'psi': 0.995805200043307}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.743095 cos_to_last_merge=0.9701 (last merge round=34)
[S9] round=78 local utility u=0.012022 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9981757632918047, 'loss_val': 0.024610136137974588, 'psi': 0.9958842988344121}-{'f1_val': 0.9914249079028262, 'auprc': 0.9981098863720723, 'loss_val': 0.030865261347415712, 'psi': 0.9940988992905246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=78 head_norm_before_train=2.210902 cos_to_last_merge=0.9508 (last merge round=34)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940018738525327, 'loss_val': 0.026898962408652295, 'psi': 0.9944606397665304}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939973794420889, 'loss_val': 0.026831912934199002, 'psi': 0.9944588420023529}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=1.829046 cos_to_last_merge=0.9581 (last merge round=35)
[S11] round=78 local utility u=0.002336 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983440573688918, 'loss_val': 0.02255471912723929, 'psi': 0.9970178278955423}-{'f1_val': 0.9958918378685807, 'auprc': 0.9980123571225423, 'loss_val': 0.024781316140968165, 'psi': 0.9967400455701654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=78 head_norm_before_train=1.914371 cos_to_last_merge=0.9866 (last merge round=39)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.7000253053620882, 'auprc': 0.7864344054485238, 'loss_val': 1.2552662883633907, 'psi': 0.7345889453966625}-{'f1_val': 0.7606687274968922, 'auprc': 0.7819475103878468, 'loss_val': 0.9223765441276959, 'psi': 0.7691802406532741}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.985172 cos_to_last_merge=0.9725 (last merge round=39)
[S14] round=78 local utility u=0.008340 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990497981760003, 'loss_val': 0.01688217757774695, 'psi': 0.9981973851073365}-{'f1_val': 0.9966235765367457, 'auprc': 0.9985837795357007, 'loss_val': 0.026131820989987453, 'psi': 0.9974076577363278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=78 head_norm_before_train=2.151940 cos_to_last_merge=0.9583 (last merge round=41)
[S15] round=78 local utility u=0.065331 metrics={'f1_val': 0.9582661165015911, 'auprc': 0.9973356260494888, 'loss_val': 0.10110183411238328, 'psi': 0.9738939203207502}-{'f1_val': 0.9409202586959946, 'auprc': 0.9972632232921763, 'loss_val': 0.12747137290714233, 'psi': 0.9634574445344672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=78 head_norm_before_train=1.932723 cos_to_last_merge=0.9552 (last merge round=41)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9919329198697596, 'auprc': 0.9842740588765075, 'loss_val': 0.04373440696387794, 'psi': 0.9888693754724588}-{'f1_val': 0.9920779125332927, 'auprc': 0.9887742400814511, 'loss_val': 0.040105588762058095, 'psi': 0.9907564435525561}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.859842 cos_to_last_merge=0.9739 (last merge round=40)
[S17] round=78 local utility u=0.115679 metrics={'f1_val': 0.9025395714892531, 'auprc': 0.9085080831553933, 'loss_val': 0.4826195474787853, 'psi': 0.9049269761557093}-{'f1_val': 0.8622616096261473, 'auprc': 0.9327911508686046, 'loss_val': 0.5451593542358236, 'psi': 0.8904734261231302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=79 head_norm_before_train=2.099975 cos_to_last_merge=0.9597 (last merge round=41)
[S2] round=79 local utility u=1.000000 metrics={'f1_val': 0.7085712684782008, 'auprc': 0.9843528655418083, 'loss_val': 0.5966690902129798, 'psi': 0.8188839073036438}-{'f1_val': 0.6117038543999853, 'auprc': 0.7914399613136978, 'loss_val': 1.4820162271415092, 'psi': 0.6835982971654704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] r=80 psi=0.819 u=1.0000 p_local=0.3338 f1=0.709 auprc=0.984 bytes=57575
[S3] START round=79 head_norm_before_train=1.770053 cos_to_last_merge=0.9795 (last merge round=40)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.6634882767895623, 'auprc': 0.824078883759993, 'loss_val': 1.30091728678567, 'psi': 0.7277245195777347}-{'f1_val': 0.7139850913155661, 'auprc': 0.895861988180356, 'loss_val': 1.0061396636421445, 'psi': 0.7867358500614821}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.728 u=0.0000 p_local=0.0738 f1=0.663 auprc=0.824 bytes=53957
[S4] START round=79 head_norm_before_train=2.087936 cos_to_last_merge=0.9890 (last merge round=41)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9326988057554211, 'auprc': 0.9433621152419557, 'loss_val': 0.3062677003602587, 'psi': 0.9369641295500349}-{'f1_val': 0.9328956700893176, 'auprc': 0.9536535784081942, 'loss_val': 0.3101122880132425, 'psi': 0.9411988334168683}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.937 u=0.0000 p_local=0.0151 f1=0.933 auprc=0.943 bytes=64826
[S5] START round=79 head_norm_before_train=1.777860 cos_to_last_merge=0.9600 (last merge round=38)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933917635088503, 'loss_val': 0.02556985417410671, 'psi': 0.9951569925816741}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939172708714704, 'loss_val': 0.02557628606761182, 'psi': 0.9955880894356628}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.995 u=0.0000 p_local=0.0111 f1=0.996 auprc=0.993 bytes=63043
[S6] START round=79 head_norm_before_train=2.157333 cos_to_last_merge=0.7831 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.783
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.6927895241068881, 'auprc': 0.8152840233481289, 'loss_val': 1.2114320711481115, 'psi': 0.7417873238033845}-{'f1_val': 0.9620583333881637, 'auprc': 0.9608071946183571, 'loss_val': 0.1640269875738123, 'psi': 0.961557877880241}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.742 u=0.0000 p_local=0.2940 f1=0.693 auprc=0.815 bytes=53968
[S7] START round=79 head_norm_before_train=1.889488 cos_to_last_merge=0.9950 (last merge round=39)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6380392925560026, 'auprc': 0.8050224514895844, 'loss_val': 0.5529414400681959, 'psi': 0.7048325561294353}-{'f1_val': 0.8735632715933261, 'auprc': 0.888218868445501, 'loss_val': 0.21125796917410528, 'psi': 0.8794255103341961}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.705 u=0.0000 p_local=0.2205 f1=0.638 auprc=0.805 bytes=59421
[S8] START round=79 head_norm_before_train=2.353676 (no previous merge yet)
[S8] round=79 local utility u=0.036339 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9989928420375696, 'loss_val': 0.025221351800927362, 'psi': 0.9962125531743438}-{'f1_val': 0.9860527263438272, 'auprc': 0.9987719519954734, 'loss_val': 0.04739915519531965, 'psi': 0.9911404166044857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=80 psi=0.996 u=0.0363 p_local=0.0501 f1=0.994 auprc=0.999 bytes=57566
[S9] START round=79 head_norm_before_train=1.745239 cos_to_last_merge=0.9700 (last merge round=34)
[S9] round=79 local utility u=0.000776 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9924451356047717, 'loss_val': 0.020842557126402268, 'psi': 0.995089605497263}-{'f1_val': 0.994356655862817, 'auprc': 0.9981757632918047, 'loss_val': 0.024610136137974588, 'psi': 0.9958842988344121}
[S9] not sending this round → trigger blocked (psi=0.995)
[S9] r=80 psi=0.995 u=0.0008 p_local=0.0063 f1=0.997 auprc=0.992 bytes=62980
[S10] START round=79 head_norm_before_train=2.217611 cos_to_last_merge=0.9502 (last merge round=34)
[S10] round=79 local utility u=0.000007 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939999352775583, 'loss_val': 0.026878373872426278, 'psi': 0.9944598643365407}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940018738525327, 'loss_val': 0.026898962408652295, 'psi': 0.9944606397665304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] r=80 psi=0.994 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.994 bytes=62978
[S11] START round=79 head_norm_before_train=1.835010 cos_to_last_merge=0.9576 (last merge round=35)
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9564438343772689, 'auprc': 0.9983541700724109, 'loss_val': 0.17069725653212572, 'psi': 0.9732079686553257}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983440573688918, 'loss_val': 0.02255471912723929, 'psi': 0.9970178278955423}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.973 u=0.0000 p_local=0.0272 f1=0.956 auprc=0.998 bytes=62965
[S13] START round=79 head_norm_before_train=1.919101 cos_to_last_merge=0.9864 (last merge round=39)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6359181899310571, 'auprc': 0.7329038832310216, 'loss_val': 1.3212608018002114, 'psi': 0.674712467251043}-{'f1_val': 0.7000253053620882, 'auprc': 0.7864344054485238, 'loss_val': 1.2552662883633907, 'psi': 0.7345889453966625}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.675 u=0.0000 p_local=0.0937 f1=0.636 auprc=0.733 bytes=52215
[S14] START round=79 head_norm_before_train=1.991883 cos_to_last_merge=0.9722 (last merge round=39)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.996868156934156, 'loss_val': 0.02000468652247103, 'psi': 0.9970601839757764}-{'f1_val': 0.9976291097282272, 'auprc': 0.9990497981760003, 'loss_val': 0.01688217757774695, 'psi': 0.9981973851073365}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.997 u=0.0000 p_local=0.0083 f1=0.997 auprc=0.997 bytes=62986
[S15] START round=79 head_norm_before_train=2.158413 cos_to_last_merge=0.9578 (last merge round=41)
[S15] round=79 local utility u=0.022080 metrics={'f1_val': 0.9624454310657871, 'auprc': 0.9973854237545452, 'loss_val': 0.08216695373885105, 'psi': 0.9764214281412904}-{'f1_val': 0.9582661165015911, 'auprc': 0.9973356260494888, 'loss_val': 0.10110183411238328, 'psi': 0.9738939203207502}
[S15] not sending this round → trigger blocked (psi=0.976)
[S15] r=80 psi=0.976 u=0.0221 p_local=0.0306 f1=0.962 auprc=0.997 bytes=52202
[S16] START round=79 head_norm_before_train=1.938197 cos_to_last_merge=0.9547 (last merge round=41)
[S16] round=79 local utility u=0.000193 metrics={'f1_val': 0.9925482116928452, 'auprc': 0.9827057753671772, 'loss_val': 0.04233483465066247, 'psi': 0.988611237162578}-{'f1_val': 0.9919329198697596, 'auprc': 0.9842740588765075, 'loss_val': 0.04373440696387794, 'psi': 0.9888693754724588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=80 psi=0.989 u=0.0002 p_local=0.1103 f1=0.993 auprc=0.983 bytes=55813
[S17] START round=79 head_norm_before_train=1.866629 cos_to_last_merge=0.9733 (last merge round=40)
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.7571797025412796, 'auprc': 0.9569424526639932, 'loss_val': 1.0300922751775456, 'psi': 0.8370848025903651}-{'f1_val': 0.9025395714892531, 'auprc': 0.9085080831553933, 'loss_val': 0.4826195474787853, 'psi': 0.9049269761557093}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.837 u=0.0000 p_local=0.1422 f1=0.757 auprc=0.957 bytes=64791
[S2] START round=80 head_norm_before_train=2.107218 cos_to_last_merge=0.9591 (last merge round=41)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.7082894489107868, 'auprc': 0.9158167195898972, 'loss_val': 0.5766077772512239, 'psi': 0.791300357182431}-{'f1_val': 0.7085712684782008, 'auprc': 0.9843528655418083, 'loss_val': 0.5966690902129798, 'psi': 0.8188839073036438}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=1.776219 cos_to_last_merge=0.9791 (last merge round=40)
[S3] round=80 local utility u=1.000000 metrics={'f1_val': 0.9833863122681773, 'auprc': 0.9991120327539567, 'loss_val': 0.04538951963429111, 'psi': 0.9896766004624891}-{'f1_val': 0.6634882767895623, 'auprc': 0.824078883759993, 'loss_val': 1.30091728678567, 'psi': 0.7277245195777347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=80 head_norm_before_train=2.091145 cos_to_last_merge=0.9888 (last merge round=41)
[S4] round=80 local utility u=0.104124 metrics={'f1_val': 0.9430403999903965, 'auprc': 0.970408190923984, 'loss_val': 0.2412078383619512, 'psi': 0.9539875163638314}-{'f1_val': 0.9326988057554211, 'auprc': 0.9433621152419557, 'loss_val': 0.3062677003602587, 'psi': 0.9369641295500349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=80 head_norm_before_train=1.787183 cos_to_last_merge=0.9592 (last merge round=38)
[S5] round=80 local utility u=0.001055 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939197918414763, 'loss_val': 0.027252372237619962, 'psi': 0.9955890978236651}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933917635088503, 'loss_val': 0.02556985417410671, 'psi': 0.9951569925816741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=80 head_norm_before_train=2.164604 cos_to_last_merge=0.7825 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.783
[S6] round=80 local utility u=0.071923 metrics={'f1_val': 0.716940250115601, 'auprc': 0.7685725588149125, 'loss_val': 1.0723564933490068, 'psi': 0.7375931735953256}-{'f1_val': 0.6927895241068881, 'auprc': 0.8152840233481289, 'loss_val': 1.2114320711481115, 'psi': 0.7417873238033845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=80 head_norm_before_train=1.893859 cos_to_last_merge=0.9948 (last merge round=39)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.6090965505695329, 'auprc': 0.7920289953477341, 'loss_val': 0.795216189811649, 'psi': 0.6822695284808133}-{'f1_val': 0.6380392925560026, 'auprc': 0.8050224514895844, 'loss_val': 0.5529414400681959, 'psi': 0.7048325561294353}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=2.362285 (no previous merge yet)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9941380936044745, 'auprc': 0.9994106497215723, 'loss_val': 0.025624824870014447, 'psi': 0.9962471160513137}-{'f1_val': 0.9943590272655265, 'auprc': 0.9989928420375696, 'loss_val': 0.025221351800927362, 'psi': 0.9962125531743438}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=1.749391 cos_to_last_merge=0.9697 (last merge round=34)
[S9] round=80 local utility u=0.002767 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.995190528438683, 'loss_val': 0.020890795470436957, 'psi': 0.9959223227758057}-{'f1_val': 0.9968525854255906, 'auprc': 0.9924451356047717, 'loss_val': 0.020842557126402268, 'psi': 0.995089605497263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=80 head_norm_before_train=2.222573 cos_to_last_merge=0.9498 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.993986475080217, 'loss_val': 0.02687538711374709, 'psi': 0.9944544802576041}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939999352775583, 'loss_val': 0.026878373872426278, 'psi': 0.9944598643365407}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.840636 cos_to_last_merge=0.9571 (last merge round=35)
[S11] round=80 local utility u=0.190288 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978121854387376, 'loss_val': 0.025183572722938224, 'psi': 0.9966599768966435}-{'f1_val': 0.9564438343772689, 'auprc': 0.9983541700724109, 'loss_val': 0.17069725653212572, 'psi': 0.9732079686553257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=80 head_norm_before_train=1.920287 cos_to_last_merge=0.9864 (last merge round=39)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.602660209998163, 'auprc': 0.6324398898275774, 'loss_val': 1.5751527028240304, 'psi': 0.6145720819299287}-{'f1_val': 0.6359181899310571, 'auprc': 0.7329038832310216, 'loss_val': 1.3212608018002114, 'psi': 0.674712467251043}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.996254 cos_to_last_merge=0.9718 (last merge round=39)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9632014278247667, 'auprc': 0.9990278103173561, 'loss_val': 0.04761801721734834, 'psi': 0.9775319808218025}-{'f1_val': 0.9971882020035234, 'auprc': 0.996868156934156, 'loss_val': 0.02000468652247103, 'psi': 0.9970601839757764}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.164744 cos_to_last_merge=0.9573 (last merge round=41)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9610588691858596, 'auprc': 0.9973651593218028, 'loss_val': 0.09279664370056323, 'psi': 0.9755813852402369}-{'f1_val': 0.9624454310657871, 'auprc': 0.9973854237545452, 'loss_val': 0.08216695373885105, 'psi': 0.9764214281412904}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.943042 cos_to_last_merge=0.9542 (last merge round=41)
[S16] round=80 local utility u=0.012482 metrics={'f1_val': 0.992930965876797, 'auprc': 0.988722699139506, 'loss_val': 0.037717911269608544, 'psi': 0.9912476591818805}-{'f1_val': 0.9925482116928452, 'auprc': 0.9827057753671772, 'loss_val': 0.04233483465066247, 'psi': 0.988611237162578}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=80 head_norm_before_train=1.874264 cos_to_last_merge=0.9728 (last merge round=40)
[S17] round=80 local utility u=0.505451 metrics={'f1_val': 0.895304566777215, 'auprc': 0.8524896561177827, 'loss_val': 0.5345813450627432, 'psi': 0.8781786025134422}-{'f1_val': 0.7571797025412796, 'auprc': 0.9569424526639932, 'loss_val': 1.0300922751775456, 'psi': 0.8370848025903651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=81 head_norm_before_train=2.113447 cos_to_last_merge=0.9587 (last merge round=41)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.6940625940687071, 'auprc': 0.8138405673282397, 'loss_val': 0.7386699940273144, 'psi': 0.7419737833725202}-{'f1_val': 0.7082894489107868, 'auprc': 0.9158167195898972, 'loss_val': 0.5766077772512239, 'psi': 0.791300357182431}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=1.782428 cos_to_last_merge=0.9787 (last merge round=40)
[S3] round=81 local utility u=0.057889 metrics={'f1_val': 0.9981302665422187, 'auprc': 0.999569039444699, 'loss_val': 0.01944586773013405, 'psi': 0.9987057757032108}-{'f1_val': 0.9833863122681773, 'auprc': 0.9991120327539567, 'loss_val': 0.04538951963429111, 'psi': 0.9896766004624891}
[S3] not sending this round → trigger blocked (psi=0.999)
[S4] START round=81 head_norm_before_train=2.094246 cos_to_last_merge=0.9885 (last merge round=41)
[S4] round=81 local utility u=0.011903 metrics={'f1_val': 0.9444369867811555, 'auprc': 0.9811515724885689, 'loss_val': 0.25801220918699136, 'psi': 0.9591228210641208}-{'f1_val': 0.9430403999903965, 'auprc': 0.970408190923984, 'loss_val': 0.2412078383619512, 'psi': 0.9539875163638314}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=81 head_norm_before_train=1.794440 cos_to_last_merge=0.9585 (last merge round=38)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933831224812555, 'loss_val': 0.025426074194390472, 'psi': 0.9951535361706363}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939197918414763, 'loss_val': 0.027252372237619962, 'psi': 0.9955890978236651}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.174637 cos_to_last_merge=0.7819 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.782
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.5908543491527408, 'auprc': 0.7474255440618475, 'loss_val': 1.4017336827201912, 'psi': 0.6534828271163835}-{'f1_val': 0.716940250115601, 'auprc': 0.7685725588149125, 'loss_val': 1.0723564933490068, 'psi': 0.7375931735953256}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.896221 cos_to_last_merge=0.9947 (last merge round=39)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.5623022379901594, 'auprc': 0.780711608418085, 'loss_val': 0.9979341181883122, 'psi': 0.6496659861613296}-{'f1_val': 0.6090965505695329, 'auprc': 0.7920289953477341, 'loss_val': 0.795216189811649, 'psi': 0.6822695284808133}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.365093 (no previous merge yet)
[S8] round=81 local utility u=0.003625 metrics={'f1_val': 0.9950949602617258, 'auprc': 0.9994626836893525, 'loss_val': 0.024271911783539424, 'psi': 0.9968420496327766}-{'f1_val': 0.9941380936044745, 'auprc': 0.9994106497215723, 'loss_val': 0.025624824870014447, 'psi': 0.9962471160513137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=81 head_norm_before_train=1.754601 cos_to_last_merge=0.9693 (last merge round=34)
[S9] round=81 local utility u=0.002893 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9980534516961003, 'loss_val': 0.021207548763873037, 'psi': 0.9968188539699692}-{'f1_val': 0.9964101856672208, 'auprc': 0.995190528438683, 'loss_val': 0.020890795470436957, 'psi': 0.9959223227758057}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=81 head_norm_before_train=2.227145 cos_to_last_merge=0.9494 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939473414650027, 'loss_val': 0.026890995199894182, 'psi': 0.9944388268115185}-{'f1_val': 0.9947664837091956, 'auprc': 0.993986475080217, 'loss_val': 0.02687538711374709, 'psi': 0.9944544802576041}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=1.843744 cos_to_last_merge=0.9568 (last merge round=35)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.6191773439051801, 'auprc': 0.9949886409500309, 'loss_val': 1.0706522456822887, 'psi': 0.7695018627231205}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978121854387376, 'loss_val': 0.025183572722938224, 'psi': 0.9966599768966435}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.926101 cos_to_last_merge=0.9860 (last merge round=39)
[S13] round=81 local utility u=0.890328 metrics={'f1_val': 0.7513368368320671, 'auprc': 0.7691004735732788, 'loss_val': 1.0965380467992751, 'psi': 0.7584422915285518}-{'f1_val': 0.602660209998163, 'auprc': 0.6324398898275774, 'loss_val': 1.5751527028240304, 'psi': 0.6145720819299287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=81 head_norm_before_train=1.999012 cos_to_last_merge=0.9716 (last merge round=39)
[S14] round=81 local utility u=0.113924 metrics={'f1_val': 0.9974543276415314, 'auprc': 0.9985840577140553, 'loss_val': 0.023955438439361886, 'psi': 0.9979062196705409}-{'f1_val': 0.9632014278247667, 'auprc': 0.9990278103173561, 'loss_val': 0.04761801721734834, 'psi': 0.9775319808218025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=81 head_norm_before_train=2.170823 cos_to_last_merge=0.9568 (last merge round=41)
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9573292842324431, 'auprc': 0.9973354926693033, 'loss_val': 0.10287591993005951, 'psi': 0.9733317676071872}-{'f1_val': 0.9610588691858596, 'auprc': 0.9973651593218028, 'loss_val': 0.09279664370056323, 'psi': 0.9755813852402369}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.947737 cos_to_last_merge=0.9538 (last merge round=41)
[S16] round=81 local utility u=0.001555 metrics={'f1_val': 0.9927254446663363, 'auprc': 0.990788340587457, 'loss_val': 0.039572373840190626, 'psi': 0.9919506030347846}-{'f1_val': 0.992930965876797, 'auprc': 0.988722699139506, 'loss_val': 0.037717911269608544, 'psi': 0.9912476591818805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=81 head_norm_before_train=1.877875 cos_to_last_merge=0.9724 (last merge round=40)
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.823201007546265, 'auprc': 0.937308878890288, 'loss_val': 0.799892566729048, 'psi': 0.8688441560838742}-{'f1_val': 0.895304566777215, 'auprc': 0.8524896561177827, 'loss_val': 0.5345813450627432, 'psi': 0.8781786025134422}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.116174 cos_to_last_merge=0.9585 (last merge round=41)
[S2] round=82 local utility u=0.164079 metrics={'f1_val': 0.7085712684782008, 'auprc': 0.8491901333310303, 'loss_val': 0.6036131163303337, 'psi': 0.7648188144193326}-{'f1_val': 0.6940625940687071, 'auprc': 0.8138405673282397, 'loss_val': 0.7386699940273144, 'psi': 0.7419737833725202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=82 head_norm_before_train=1.788774 cos_to_last_merge=0.9783 (last merge round=40)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9719822368964655, 'auprc': 0.9986100807270133, 'loss_val': 0.06887357655323594, 'psi': 0.9826333744286846}-{'f1_val': 0.9981302665422187, 'auprc': 0.999569039444699, 'loss_val': 0.01944586773013405, 'psi': 0.9987057757032108}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.095791 cos_to_last_merge=0.9883 (last merge round=41)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9303297320514656, 'auprc': 0.9377663048829825, 'loss_val': 0.34575047417730576, 'psi': 0.9333043611840725}-{'f1_val': 0.9444369867811555, 'auprc': 0.9811515724885689, 'loss_val': 0.25801220918699136, 'psi': 0.9591228210641208}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.799713 cos_to_last_merge=0.9578 (last merge round=38)
[S5] round=82 local utility u=0.002431 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939278975521515, 'loss_val': 0.02440831712174474, 'psi': 0.9955923401079352}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933831224812555, 'loss_val': 0.025426074194390472, 'psi': 0.9951535361706363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=82 head_norm_before_train=2.181391 cos_to_last_merge=0.7811 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.781
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.7670832788714962, 'auprc': 0.8587808957214971, 'loss_val': 0.6331902928048382, 'psi': 0.8037623256114965}-{'f1_val': 0.5908543491527408, 'auprc': 0.7474255440618475, 'loss_val': 1.4017336827201912, 'psi': 0.6534828271163835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=82 head_norm_before_train=1.895551 cos_to_last_merge=0.9947 (last merge round=39)
[S7] round=82 local utility u=1.000000 metrics={'f1_val': 0.8659529264472242, 'auprc': 0.8874744406001829, 'loss_val': 0.2344729806690853, 'psi': 0.8745615321084077}-{'f1_val': 0.5623022379901594, 'auprc': 0.780711608418085, 'loss_val': 0.9979341181883122, 'psi': 0.6496659861613296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=82 head_norm_before_train=2.367172 (no previous merge yet)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9990407336737132, 'loss_val': 0.02904649250427059, 'psi': 0.9953526169484546}-{'f1_val': 0.9950949602617258, 'auprc': 0.9994626836893525, 'loss_val': 0.024271911783539424, 'psi': 0.9968420496327766}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=1.760410 cos_to_last_merge=0.9688 (last merge round=34)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.9982941317262909, 'loss_val': 0.033818690357161764, 'psi': 0.9936487758991124}-{'f1_val': 0.9959957888192151, 'auprc': 0.9980534516961003, 'loss_val': 0.021207548763873037, 'psi': 0.9968188539699692}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.233368 cos_to_last_merge=0.9489 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=82 local utility u=0.000066 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939895786046481, 'loss_val': 0.026884860715339368, 'psi': 0.9944557216673766}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939473414650027, 'loss_val': 0.026890995199894182, 'psi': 0.9944388268115185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=82 head_norm_before_train=1.845884 cos_to_last_merge=0.9565 (last merge round=35)
[S11] round=82 local utility u=1.000000 metrics={'f1_val': 0.9806844940670087, 'auprc': 0.9984511935763676, 'loss_val': 0.08324090388711042, 'psi': 0.9877911738707523}-{'f1_val': 0.6191773439051801, 'auprc': 0.9949886409500309, 'loss_val': 1.0706522456822887, 'psi': 0.7695018627231205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=82 head_norm_before_train=1.929815 cos_to_last_merge=0.9858 (last merge round=39)
[S13] round=82 local utility u=0.345315 metrics={'f1_val': 0.7946139456641206, 'auprc': 0.8433308454183058, 'loss_val': 0.8882615897500413, 'psi': 0.8141007055657947}-{'f1_val': 0.7513368368320671, 'auprc': 0.7691004735732788, 'loss_val': 1.0965380467992751, 'psi': 0.7584422915285518}
[S13] not sending this round → trigger blocked (psi=0.814)
[S14] START round=82 head_norm_before_train=1.998685 cos_to_last_merge=0.9714 (last merge round=39)
[S14] round=82 local utility u=0.004308 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990333323349672, 'loss_val': 0.016428174617876188, 'psi': 0.9980599294946837}-{'f1_val': 0.9974543276415314, 'auprc': 0.9985840577140553, 'loss_val': 0.023955438439361886, 'psi': 0.9979062196705409}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=82 head_norm_before_train=2.176668 cos_to_last_merge=0.9564 (last merge round=41)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9429004481172103, 'auprc': 0.9972802854640218, 'loss_val': 0.12642096518263674, 'psi': 0.9646523830559348}-{'f1_val': 0.9573292842324431, 'auprc': 0.9973354926693033, 'loss_val': 0.10287591993005951, 'psi': 0.9733317676071872}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=1.952815 cos_to_last_merge=0.9534 (last merge round=41)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9922873425508638, 'auprc': 0.9902833988808033, 'loss_val': 0.039364727433785794, 'psi': 0.9914857650828397}-{'f1_val': 0.9927254446663363, 'auprc': 0.990788340587457, 'loss_val': 0.039572373840190626, 'psi': 0.9919506030347846}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.880249 cos_to_last_merge=0.9721 (last merge round=40)
[S17] round=82 local utility u=0.378473 metrics={'f1_val': 0.9039399567121388, 'auprc': 0.9253671652264717, 'loss_val': 0.49155419937176126, 'psi': 0.9125108401178719}-{'f1_val': 0.823201007546265, 'auprc': 0.937308878890288, 'loss_val': 0.799892566729048, 'psi': 0.8688441560838742}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=83 head_norm_before_train=2.120606 cos_to_last_merge=0.9582 (last merge round=41)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.677259937136734, 'auprc': 0.802972438271803, 'loss_val': 1.085878896803517, 'psi': 0.7275449375907617}-{'f1_val': 0.7085712684782008, 'auprc': 0.8491901333310303, 'loss_val': 0.6036131163303337, 'psi': 0.7648188144193326}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=1.794521 cos_to_last_merge=0.9780 (last merge round=40)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9939342122785371, 'loss_val': 0.13425812804095316, 'psi': 0.974194835574681}-{'f1_val': 0.9719822368964655, 'auprc': 0.9986100807270133, 'loss_val': 0.06887357655323594, 'psi': 0.9826333744286846}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.096874 cos_to_last_merge=0.9880 (last merge round=41)
[S4] round=83 local utility u=0.029920 metrics={'f1_val': 0.930047958522503, 'auprc': 0.9441177285331447, 'loss_val': 0.30327371103416095, 'psi': 0.9356758665267597}-{'f1_val': 0.9303297320514656, 'auprc': 0.9377663048829825, 'loss_val': 0.34575047417730576, 'psi': 0.9333043611840725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=83 head_norm_before_train=1.808096 cos_to_last_merge=0.9569 (last merge round=38)
[S5] round=83 local utility u=0.000431 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938906172128754, 'loss_val': 0.023434799068932623, 'psi': 0.9955774279722247}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939278975521515, 'loss_val': 0.02440831712174474, 'psi': 0.9955923401079352}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=83 head_norm_before_train=2.186280 cos_to_last_merge=0.7808 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.781
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.6988427274647359, 'auprc': 0.9115835321932849, 'loss_val': 1.0279149673361874, 'psi': 0.7839390493561555}-{'f1_val': 0.7670832788714962, 'auprc': 0.8587808957214971, 'loss_val': 0.6331902928048382, 'psi': 0.8037623256114965}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.895269 cos_to_last_merge=0.9947 (last merge round=39)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.4759965549661162, 'auprc': 0.7774464595345885, 'loss_val': 1.1707074526528236, 'psi': 0.5965765167935051}-{'f1_val': 0.8659529264472242, 'auprc': 0.8874744406001829, 'loss_val': 0.2344729806690853, 'psi': 0.8745615321084077}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.374360 (no previous merge yet)
[S8] round=83 local utility u=0.001440 metrics={'f1_val': 0.9934805280689575, 'auprc': 0.9987898180395474, 'loss_val': 0.02893290312638861, 'psi': 0.9956042440571934}-{'f1_val': 0.9928938724649488, 'auprc': 0.9990407336737132, 'loss_val': 0.02904649250427059, 'psi': 0.9953526169484546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=83 head_norm_before_train=1.766037 cos_to_last_merge=0.9684 (last merge round=34)
[S9] round=83 local utility u=0.016095 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9983878403698624, 'loss_val': 0.024562447051021556, 'psi': 0.9959514491555095}-{'f1_val': 0.9905518720143266, 'auprc': 0.9982941317262909, 'loss_val': 0.033818690357161764, 'psi': 0.9936487758991124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=83 head_norm_before_train=2.236962 cos_to_last_merge=0.9486 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940082516273007, 'loss_val': 0.026943245673443247, 'psi': 0.9944631908764376}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939895786046481, 'loss_val': 0.026884860715339368, 'psi': 0.9944557216673766}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=1.848106 cos_to_last_merge=0.9563 (last merge round=35)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9567653203810371, 'auprc': 0.9980157223683404, 'loss_val': 0.10585789026560719, 'psi': 0.9732654811759585}-{'f1_val': 0.9806844940670087, 'auprc': 0.9984511935763676, 'loss_val': 0.08324090388711042, 'psi': 0.9877911738707523}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.927762 cos_to_last_merge=0.9857 (last merge round=39)
[S13] round=83 local utility u=0.029644 metrics={'f1_val': 0.7843737180626414, 'auprc': 0.8459445783996318, 'loss_val': 0.7753741915385914, 'psi': 0.8090020621974376}-{'f1_val': 0.7946139456641206, 'auprc': 0.8433308454183058, 'loss_val': 0.8882615897500413, 'psi': 0.8141007055657947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=83 head_norm_before_train=2.001257 cos_to_last_merge=0.9711 (last merge round=39)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990165655308226, 'loss_val': 0.018924563589058255, 'psi': 0.9978070541408757}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990333323349672, 'loss_val': 0.016428174617876188, 'psi': 0.9980599294946837}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.182507 cos_to_last_merge=0.9559 (last merge round=41)
[S15] round=83 local utility u=0.031170 metrics={'f1_val': 0.951644250605898, 'auprc': 0.9973025822133935, 'loss_val': 0.11661143981744294, 'psi': 0.9699075832488961}-{'f1_val': 0.9429004481172103, 'auprc': 0.9972802854640218, 'loss_val': 0.12642096518263674, 'psi': 0.9646523830559348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=83 head_norm_before_train=1.957693 cos_to_last_merge=0.9529 (last merge round=41)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9064552301514751, 'auprc': 0.9821957361840827, 'loss_val': 0.5686374746252879, 'psi': 0.9367514325645181}-{'f1_val': 0.9922873425508638, 'auprc': 0.9902833988808033, 'loss_val': 0.039364727433785794, 'psi': 0.9914857650828397}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.886602 cos_to_last_merge=0.9717 (last merge round=40)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8335865300108416, 'auprc': 0.9867624718430776, 'loss_val': 0.684366427985382, 'psi': 0.894856906743736}-{'f1_val': 0.9039399567121388, 'auprc': 0.9253671652264717, 'loss_val': 0.49155419937176126, 'psi': 0.9125108401178719}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.124977 cos_to_last_merge=0.9576 (last merge round=41)
[S2] round=84 local utility u=0.454888 metrics={'f1_val': 0.7037451472731351, 'auprc': 0.8913384874535153, 'loss_val': 0.6001120603949888, 'psi': 0.7787824833452872}-{'f1_val': 0.677259937136734, 'auprc': 0.802972438271803, 'loss_val': 1.085878896803517, 'psi': 0.7275449375907617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=84 head_norm_before_train=1.800070 cos_to_last_merge=0.9777 (last merge round=40)
[S3] round=84 local utility u=0.178134 metrics={'f1_val': 0.9981972114826816, 'auprc': 0.9991715046334179, 'loss_val': 0.01667282458569933, 'psi': 0.998586928742976}-{'f1_val': 0.9610352511054436, 'auprc': 0.9939342122785371, 'loss_val': 0.13425812804095316, 'psi': 0.974194835574681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=84 head_norm_before_train=2.100687 cos_to_last_merge=0.9877 (last merge round=41)
[S4] round=84 local utility u=0.116552 metrics={'f1_val': 0.93991312873467, 'auprc': 0.982501959093112, 'loss_val': 0.24451406532551162, 'psi': 0.9569486608780469}-{'f1_val': 0.930047958522503, 'auprc': 0.9441177285331447, 'loss_val': 0.30327371103416095, 'psi': 0.9356758665267597}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=84 head_norm_before_train=1.813109 cos_to_last_merge=0.9560 (last merge round=38)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9938407059578, 'loss_val': 0.02426530239308498, 'psi': 0.9955574634701947}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938906172128754, 'loss_val': 0.023434799068932623, 'psi': 0.9955774279722247}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.195276 cos_to_last_merge=0.7804 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.780
[S6] round=84 local utility u=0.153056 metrics={'f1_val': 0.7671598899115448, 'auprc': 0.8419643006411137, 'loss_val': 0.922847766242855, 'psi': 0.7970816542033723}-{'f1_val': 0.6988427274647359, 'auprc': 0.9115835321932849, 'loss_val': 1.0279149673361874, 'psi': 0.7839390493561555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=84 head_norm_before_train=1.894972 cos_to_last_merge=0.9947 (last merge round=39)
[S7] round=84 local utility u=1.000000 metrics={'f1_val': 0.9827661647608777, 'auprc': 0.9905833906860114, 'loss_val': 0.16850824679273804, 'psi': 0.9858930551309312}-{'f1_val': 0.4759965549661162, 'auprc': 0.7774464595345885, 'loss_val': 1.1707074526528236, 'psi': 0.5965765167935051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=84 head_norm_before_train=2.379746 (no previous merge yet)
[S8] round=84 local utility u=0.006107 metrics={'f1_val': 0.9945058427751525, 'auprc': 0.9996050714010198, 'loss_val': 0.02531687397074849, 'psi': 0.9965455342254994}-{'f1_val': 0.9934805280689575, 'auprc': 0.9987898180395474, 'loss_val': 0.02893290312638861, 'psi': 0.9956042440571934}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=84 head_norm_before_train=1.769867 cos_to_last_merge=0.9681 (last merge round=34)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9908499745782982, 'loss_val': 0.02166209901264468, 'psi': 0.9940900466988858}-{'f1_val': 0.9943271883459407, 'auprc': 0.9983878403698624, 'loss_val': 0.024562447051021556, 'psi': 0.9959514491555095}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.241923 cos_to_last_merge=0.9481 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940086226298981, 'loss_val': 0.02696129252814724, 'psi': 0.9944633392774767}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940082516273007, 'loss_val': 0.026943245673443247, 'psi': 0.9944631908764376}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=1.851686 cos_to_last_merge=0.9560 (last merge round=35)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9553234163713966, 'auprc': 0.998100917466109, 'loss_val': 0.12361039467391045, 'psi': 0.9724344168092816}-{'f1_val': 0.9567653203810371, 'auprc': 0.9980157223683404, 'loss_val': 0.10585789026560719, 'psi': 0.9732654811759585}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.928805 cos_to_last_merge=0.9855 (last merge round=39)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.7508895848913486, 'auprc': 0.7428787242466923, 'loss_val': 1.15262282397261, 'psi': 0.7476852406334861}-{'f1_val': 0.7843737180626414, 'auprc': 0.8459445783996318, 'loss_val': 0.7753741915385914, 'psi': 0.8090020621974376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=2.006248 cos_to_last_merge=0.9707 (last merge round=39)
[S14] round=84 local utility u=0.002464 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990135633726855, 'loss_val': 0.016448572930288313, 'psi': 0.998052021909771}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990165655308226, 'loss_val': 0.018924563589058255, 'psi': 0.9978070541408757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=84 head_norm_before_train=2.188269 cos_to_last_merge=0.9555 (last merge round=41)
[S15] round=84 local utility u=0.023359 metrics={'f1_val': 0.9573292842324431, 'auprc': 0.9973383935778033, 'loss_val': 0.10411095849407995, 'psi': 0.9733329279705871}-{'f1_val': 0.951644250605898, 'auprc': 0.9973025822133935, 'loss_val': 0.11661143981744294, 'psi': 0.9699075832488961}
[S15] not sending this round → trigger blocked (psi=0.973)
[S16] START round=84 head_norm_before_train=1.961007 cos_to_last_merge=0.9525 (last merge round=41)
[S16] round=84 local utility u=0.053011 metrics={'f1_val': 0.9196411819179329, 'auprc': 0.9756815232051416, 'loss_val': 0.5221894557079668, 'psi': 0.9420573184328164}-{'f1_val': 0.9064552301514751, 'auprc': 0.9821957361840827, 'loss_val': 0.5686374746252879, 'psi': 0.9367514325645181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=84 head_norm_before_train=1.895035 cos_to_last_merge=0.9713 (last merge round=40)
[S17] round=84 local utility u=0.015557 metrics={'f1_val': 0.8930128364288532, 'auprc': 0.8349551818075971, 'loss_val': 0.5543888897953071, 'psi': 0.8697897745803507}-{'f1_val': 0.8335865300108416, 'auprc': 0.9867624718430776, 'loss_val': 0.684366427985382, 'psi': 0.894856906743736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=85 head_norm_before_train=2.131055 cos_to_last_merge=0.9572 (last merge round=41)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.6918960481023317, 'auprc': 0.845039533431512, 'loss_val': 0.6992530556630778, 'psi': 0.7531534422340038}-{'f1_val': 0.7037451472731351, 'auprc': 0.8913384874535153, 'loss_val': 0.6001120603949888, 'psi': 0.7787824833452872}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=1.805967 cos_to_last_merge=0.9773 (last merge round=40)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9927752496305641, 'auprc': 0.9991855937793072, 'loss_val': 0.0243262224884523, 'psi': 0.9953393872900613}-{'f1_val': 0.9981972114826816, 'auprc': 0.9991715046334179, 'loss_val': 0.01667282458569933, 'psi': 0.998586928742976}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=2.104563 cos_to_last_merge=0.9874 (last merge round=41)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9313181635075505, 'auprc': 0.9355945336679725, 'loss_val': 0.29687928526032636, 'psi': 0.9330287115717193}-{'f1_val': 0.93991312873467, 'auprc': 0.982501959093112, 'loss_val': 0.24451406532551162, 'psi': 0.9569486608780469}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.817271 cos_to_last_merge=0.9553 (last merge round=38)
[S5] round=85 local utility u=0.002023 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9959229213398149, 'loss_val': 0.026466249922530088, 'psi': 0.9963903496230005}-{'f1_val': 0.9967019684784577, 'auprc': 0.9938407059578, 'loss_val': 0.02426530239308498, 'psi': 0.9955574634701947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=85 head_norm_before_train=2.203600 cos_to_last_merge=0.7801 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.780
[S6] round=85 local utility u=0.823230 metrics={'f1_val': 0.8808330793929577, 'auprc': 0.9523492214224673, 'loss_val': 0.28958161718842096, 'psi': 0.9094395362047616}-{'f1_val': 0.7671598899115448, 'auprc': 0.8419643006411137, 'loss_val': 0.922847766242855, 'psi': 0.7970816542033723}
[S6] not sending this round → trigger blocked (psi=0.909)
[S7] START round=85 head_norm_before_train=1.896060 cos_to_last_merge=0.9946 (last merge round=39)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.5709954924010817, 'auprc': 0.7792234665196751, 'loss_val': 0.8756240525785377, 'psi': 0.6542866820485191}-{'f1_val': 0.9827661647608777, 'auprc': 0.9905833906860114, 'loss_val': 0.16850824679273804, 'psi': 0.9858930551309312}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=2.382291 (no previous merge yet)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9994447270965121, 'loss_val': 0.02457263615306288, 'psi': 0.9963933071979207}-{'f1_val': 0.9945058427751525, 'auprc': 0.9996050714010198, 'loss_val': 0.02531687397074849, 'psi': 0.9965455342254994}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=1.773259 cos_to_last_merge=0.9678 (last merge round=34)
[S9] round=85 local utility u=0.007123 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9952383913188674, 'loss_val': 0.020556983456276618, 'psi': 0.9958430255070785}-{'f1_val': 0.9962500947792776, 'auprc': 0.9908499745782982, 'loss_val': 0.02166209901264468, 'psi': 0.9940900466988858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=85 head_norm_before_train=2.246167 cos_to_last_merge=0.9478 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939824975109217, 'loss_val': 0.02699222262555407, 'psi': 0.9944528892298861}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940086226298981, 'loss_val': 0.02696129252814724, 'psi': 0.9944633392774767}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=1.855479 cos_to_last_merge=0.9557 (last merge round=35)
[S11] round=85 local utility u=0.032880 metrics={'f1_val': 0.9580169450781398, 'auprc': 0.9982260197003157, 'loss_val': 0.07438711210904744, 'psi': 0.9741005749270102}-{'f1_val': 0.9553234163713966, 'auprc': 0.998100917466109, 'loss_val': 0.12361039467391045, 'psi': 0.9724344168092816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=85 head_norm_before_train=1.930730 cos_to_last_merge=0.9853 (last merge round=39)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.7105000682146869, 'auprc': 0.7585262845605646, 'loss_val': 1.1808709122499748, 'psi': 0.729710554753038}-{'f1_val': 0.7508895848913486, 'auprc': 0.7428787242466923, 'loss_val': 1.15262282397261, 'psi': 0.7476852406334861}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.011793 cos_to_last_merge=0.9703 (last merge round=39)
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990503132882346, 'loss_val': 0.01814177111339705, 'psi': 0.9981975911522301}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990135633726855, 'loss_val': 0.016448572930288313, 'psi': 0.998052021909771}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=2.193877 cos_to_last_merge=0.9550 (last merge round=41)
[S15] round=85 local utility u=0.017750 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.997375095380582, 'loss_val': 0.09387563886355772, 'psi': 0.9758631035742354}-{'f1_val': 0.9573292842324431, 'auprc': 0.9973383935778033, 'loss_val': 0.10411095849407995, 'psi': 0.9733329279705871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=85 head_norm_before_train=1.964249 cos_to_last_merge=0.9522 (last merge round=41)
[S16] round=85 local utility u=0.474347 metrics={'f1_val': 0.9913750238512271, 'auprc': 0.988983074568878, 'loss_val': 0.04380257473751517, 'psi': 0.9904182441382874}-{'f1_val': 0.9196411819179329, 'auprc': 0.9756815232051416, 'loss_val': 0.5221894557079668, 'psi': 0.9420573184328164}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=85 head_norm_before_train=1.904490 cos_to_last_merge=0.9707 (last merge round=40)
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8182903659195948, 'auprc': 0.7959144334372016, 'loss_val': 0.8237050469329656, 'psi': 0.8093399929266375}-{'f1_val': 0.8930128364288532, 'auprc': 0.8349551818075971, 'loss_val': 0.5543888897953071, 'psi': 0.8697897745803507}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.140063 cos_to_last_merge=0.9568 (last merge round=41)
[S2] round=86 local utility u=0.049349 metrics={'f1_val': 0.6976848466792971, 'auprc': 0.8589160947614182, 'loss_val': 0.6769179416051808, 'psi': 0.7621773459121455}-{'f1_val': 0.6918960481023317, 'auprc': 0.845039533431512, 'loss_val': 0.6992530556630778, 'psi': 0.7531534422340038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=86 head_norm_before_train=1.810991 cos_to_last_merge=0.9772 (last merge round=40)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.9472906305110824, 'auprc': 0.995223677541868, 'loss_val': 0.12569522318073736, 'psi': 0.9664638493233966}-{'f1_val': 0.9927752496305641, 'auprc': 0.9991855937793072, 'loss_val': 0.0243262224884523, 'psi': 0.9953393872900613}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=2.106323 cos_to_last_merge=0.9871 (last merge round=41)
[S4] round=86 local utility u=0.004292 metrics={'f1_val': 0.9317606666602368, 'auprc': 0.9421218215679305, 'loss_val': 0.3105317440373328, 'psi': 0.9359051286233143}-{'f1_val': 0.9313181635075505, 'auprc': 0.9355945336679725, 'loss_val': 0.29687928526032636, 'psi': 0.9330287115717193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=86 head_norm_before_train=1.819146 cos_to_last_merge=0.9550 (last merge round=38)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9915906247730666, 'loss_val': 0.029330577295886628, 'psi': 0.9944365370873607}-{'f1_val': 0.9967019684784577, 'auprc': 0.9959229213398149, 'loss_val': 0.026466249922530088, 'psi': 0.9963903496230005}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.209185 cos_to_last_merge=0.7789 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.779
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7831022765382182, 'auprc': 0.9010849460597377, 'loss_val': 0.7271296759586929, 'psi': 0.830295344346826}-{'f1_val': 0.8808330793929577, 'auprc': 0.9523492214224673, 'loss_val': 0.28958161718842096, 'psi': 0.9094395362047616}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.898524 cos_to_last_merge=0.9945 (last merge round=39)
[S7] round=86 local utility u=0.514684 metrics={'f1_val': 0.6613458798950442, 'auprc': 0.801152630722604, 'loss_val': 0.4541449390560987, 'psi': 0.7172685802260681}-{'f1_val': 0.5709954924010817, 'auprc': 0.7792234665196751, 'loss_val': 0.8756240525785377, 'psi': 0.6542866820485191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=86 head_norm_before_train=2.390872 (no previous merge yet)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9990401860456269, 'loss_val': 0.026843579113377897, 'psi': 0.9962314907775667}-{'f1_val': 0.9943590272655265, 'auprc': 0.9994447270965121, 'loss_val': 0.02457263615306288, 'psi': 0.9963933071979207}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=1.777636 cos_to_last_merge=0.9674 (last merge round=34)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9784957188746206, 'auprc': 0.969951760358792, 'loss_val': 0.07683615054777702, 'psi': 0.9750781354682891}-{'f1_val': 0.9962461149658858, 'auprc': 0.9952383913188674, 'loss_val': 0.020556983456276618, 'psi': 0.9958430255070785}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.250287 cos_to_last_merge=0.9474 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938682382221884, 'loss_val': 0.02696805426701388, 'psi': 0.9944071855143928}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939824975109217, 'loss_val': 0.02699222262555407, 'psi': 0.9944528892298861}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=1.857725 cos_to_last_merge=0.9555 (last merge round=35)
[S11] round=86 local utility u=0.142422 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985207091488123, 'loss_val': 0.02160825150243727, 'psi': 0.9973364863676787}-{'f1_val': 0.9580169450781398, 'auprc': 0.9982260197003157, 'loss_val': 0.07438711210904744, 'psi': 0.9741005749270102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=86 head_norm_before_train=1.933883 cos_to_last_merge=0.9849 (last merge round=39)
[S13] round=86 local utility u=0.844488 metrics={'f1_val': 0.8078313416682876, 'auprc': 0.9329999416626709, 'loss_val': 0.5993025382463338, 'psi': 0.8578987816660409}-{'f1_val': 0.7105000682146869, 'auprc': 0.7585262845605646, 'loss_val': 1.1808709122499748, 'psi': 0.729710554753038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=86 head_norm_before_train=2.018313 cos_to_last_merge=0.9699 (last merge round=39)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9936999228903409, 'auprc': 0.9985852079248029, 'loss_val': 0.03622952900344611, 'psi': 0.9956540369041258}-{'f1_val': 0.9976291097282272, 'auprc': 0.9990503132882346, 'loss_val': 0.01814177111339705, 'psi': 0.9981975911522301}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.199463 cos_to_last_merge=0.9546 (last merge round=41)
[S15] round=86 local utility u=0.000518 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973777105339685, 'loss_val': 0.09284732577075978, 'psi': 0.97586414963559}-{'f1_val': 0.9615217757033376, 'auprc': 0.997375095380582, 'loss_val': 0.09387563886355772, 'psi': 0.9758631035742354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=86 head_norm_before_train=1.968360 cos_to_last_merge=0.9518 (last merge round=41)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9639075393283347, 'auprc': 0.9802283538775537, 'loss_val': 0.13134388966213445, 'psi': 0.9704358651480223}-{'f1_val': 0.9913750238512271, 'auprc': 0.988983074568878, 'loss_val': 0.04380257473751517, 'psi': 0.9904182441382874}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.910934 cos_to_last_merge=0.9703 (last merge round=40)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.7911636563169147, 'auprc': 0.7540286203395549, 'loss_val': 0.8929666280504631, 'psi': 0.7763096419259707}-{'f1_val': 0.8182903659195948, 'auprc': 0.7959144334372016, 'loss_val': 0.8237050469329656, 'psi': 0.8093399929266375}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.148736 cos_to_last_merge=0.9564 (last merge round=41)
[S2] round=87 local utility u=0.258982 metrics={'f1_val': 0.7095933961666887, 'auprc': 0.9806756284538993, 'loss_val': 0.5956841895817502, 'psi': 0.8180262890815729}-{'f1_val': 0.6976848466792971, 'auprc': 0.8589160947614182, 'loss_val': 0.6769179416051808, 'psi': 0.7621773459121455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=87 head_norm_before_train=1.814486 cos_to_last_merge=0.9769 (last merge round=40)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9008498809855212, 'auprc': 0.9658435312404313, 'loss_val': 0.33187975227681116, 'psi': 0.9268473410874853}-{'f1_val': 0.9472906305110824, 'auprc': 0.995223677541868, 'loss_val': 0.12569522318073736, 'psi': 0.9664638493233966}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.106410 cos_to_last_merge=0.9868 (last merge round=41)
[S4] round=87 local utility u=0.018803 metrics={'f1_val': 0.9332859652009033, 'auprc': 0.9512816469915807, 'loss_val': 0.30955722489740384, 'psi': 0.9404842379171743}-{'f1_val': 0.9317606666602368, 'auprc': 0.9421218215679305, 'loss_val': 0.3105317440373328, 'psi': 0.9359051286233143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=87 head_norm_before_train=1.820166 cos_to_last_merge=0.9544 (last merge round=38)
[S5] round=87 local utility u=0.001916 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9957600997669829, 'loss_val': 0.042421996346287176, 'psi': 0.9965457750734318}-{'f1_val': 0.9963338119635569, 'auprc': 0.9915906247730666, 'loss_val': 0.029330577295886628, 'psi': 0.9944365370873607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=87 head_norm_before_train=2.214878 cos_to_last_merge=0.7779 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.778
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.7185775057696906, 'auprc': 0.8338072222488432, 'loss_val': 1.0361971126053737, 'psi': 0.7646693923613517}-{'f1_val': 0.7831022765382182, 'auprc': 0.9010849460597377, 'loss_val': 0.7271296759586929, 'psi': 0.830295344346826}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.901294 cos_to_last_merge=0.9943 (last merge round=39)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.5539050449243231, 'auprc': 0.7778485256103966, 'loss_val': 0.950973834934918, 'psi': 0.6434824371987526}-{'f1_val': 0.6613458798950442, 'auprc': 0.801152630722604, 'loss_val': 0.4541449390560987, 'psi': 0.7172685802260681}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.394488 (no previous merge yet)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990836652274129, 'loss_val': 0.029062368582434796, 'psi': 0.9958086683596631}-{'f1_val': 0.9943590272655265, 'auprc': 0.9990401860456269, 'loss_val': 0.026843579113377897, 'psi': 0.9962314907775667}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=1.782042 cos_to_last_merge=0.9670 (last merge round=34)
[S9] round=87 local utility u=0.120114 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9947311102658629, 'loss_val': 0.019934888396687785, 'psi': 0.99588875119468}-{'f1_val': 0.9784957188746206, 'auprc': 0.969951760358792, 'loss_val': 0.07683615054777702, 'psi': 0.9750781354682891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=87 head_norm_before_train=2.256005 cos_to_last_merge=0.9469 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=87 local utility u=0.000149 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939809511658702, 'loss_val': 0.027009178068408017, 'psi': 0.9944522706918655}-{'f1_val': 0.9947664837091956, 'auprc': 0.9938682382221884, 'loss_val': 0.02696805426701388, 'psi': 0.9944071855143928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=87 head_norm_before_train=1.860161 cos_to_last_merge=0.9553 (last merge round=35)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.9874995237736947, 'auprc': 0.9987296392251728, 'loss_val': 0.052291455954929525, 'psi': 0.9919915699542858}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985207091488123, 'loss_val': 0.02160825150243727, 'psi': 0.9973364863676787}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=87 head_norm_before_train=1.938309 cos_to_last_merge=0.9846 (last merge round=39)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.7831991740764652, 'auprc': 0.8422982420021405, 'loss_val': 1.0091197966448804, 'psi': 0.8068388012467353}-{'f1_val': 0.8078313416682876, 'auprc': 0.9329999416626709, 'loss_val': 0.5993025382463338, 'psi': 0.8578987816660409}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.019570 cos_to_last_merge=0.9697 (last merge round=39)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9327633323614597, 'auprc': 0.9990323915085646, 'loss_val': 0.14077859907516665, 'psi': 0.9592709560203017}-{'f1_val': 0.9936999228903409, 'auprc': 0.9985852079248029, 'loss_val': 0.03622952900344611, 'psi': 0.9956540369041258}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.204919 cos_to_last_merge=0.9542 (last merge round=41)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973721705792558, 'loss_val': 0.094506257004323, 'psi': 0.9758619336537049}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973777105339685, 'loss_val': 0.09284732577075978, 'psi': 0.97586414963559}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.973074 cos_to_last_merge=0.9514 (last merge round=41)
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9378162732606046, 'auprc': 0.9766862952534212, 'loss_val': 0.3901897257962117, 'psi': 0.9533642820577313}-{'f1_val': 0.9639075393283347, 'auprc': 0.9802283538775537, 'loss_val': 0.13134388966213445, 'psi': 0.9704358651480223}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=1.914205 cos_to_last_merge=0.9699 (last merge round=40)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.69777095336482, 'auprc': 0.8336628283709521, 'loss_val': 1.3023777753856638, 'psi': 0.7521277033672729}-{'f1_val': 0.7911636563169147, 'auprc': 0.7540286203395549, 'loss_val': 0.8929666280504631, 'psi': 0.7763096419259707}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.152093 cos_to_last_merge=0.9564 (last merge round=41)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.7146727941955283, 'auprc': 0.8744497947657761, 'loss_val': 0.6510792443848785, 'psi': 0.7785835944236275}-{'f1_val': 0.7095933961666887, 'auprc': 0.9806756284538993, 'loss_val': 0.5956841895817502, 'psi': 0.8180262890815729}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=1.817966 cos_to_last_merge=0.9766 (last merge round=40)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.7995555865229325, 'auprc': 0.9538544016099184, 'loss_val': 0.699063002206525, 'psi': 0.8612751125577268}-{'f1_val': 0.9008498809855212, 'auprc': 0.9658435312404313, 'loss_val': 0.33187975227681116, 'psi': 0.9268473410874853}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.111540 cos_to_last_merge=0.9865 (last merge round=41)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9315047211603088, 'auprc': 0.946393551082362, 'loss_val': 0.3092787174004621, 'psi': 0.9374602531291301}-{'f1_val': 0.9332859652009033, 'auprc': 0.9512816469915807, 'loss_val': 0.30955722489740384, 'psi': 0.9404842379171743}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.823944 cos_to_last_merge=0.9540 (last merge round=38)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9916397379931511, 'loss_val': 0.030832485400895154, 'psi': 0.9944561823753946}-{'f1_val': 0.9970695586110643, 'auprc': 0.9957600997669829, 'loss_val': 0.042421996346287176, 'psi': 0.9965457750734318}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.224462 cos_to_last_merge=0.7773 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.777
[S6] round=88 local utility u=0.612999 metrics={'f1_val': 0.8178192098241663, 'auprc': 0.9108838826831288, 'loss_val': 0.636878337280975, 'psi': 0.8550450789677513}-{'f1_val': 0.7185775057696906, 'auprc': 0.8338072222488432, 'loss_val': 1.0361971126053737, 'psi': 0.7646693923613517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=88 head_norm_before_train=1.904237 cos_to_last_merge=0.9942 (last merge round=39)
[S7] round=88 local utility u=0.457721 metrics={'f1_val': 0.6243239303837188, 'auprc': 0.7956780369419297, 'loss_val': 0.5115343742087808, 'psi': 0.6928655730070032}-{'f1_val': 0.5539050449243231, 'auprc': 0.7778485256103966, 'loss_val': 0.950973834934918, 'psi': 0.6434824371987526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=88 head_norm_before_train=2.401746 (no previous merge yet)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9990038435464891, 'loss_val': 0.029598782733078855, 'psi': 0.9953378608975649}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990836652274129, 'loss_val': 0.029062368582434796, 'psi': 0.9958086683596631}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=1.784467 cos_to_last_merge=0.9667 (last merge round=34)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937711945614365, 'loss_val': 0.021315499729301187, 'psi': 0.9952585346921412}-{'f1_val': 0.9966605118138915, 'auprc': 0.9947311102658629, 'loss_val': 0.019934888396687785, 'psi': 0.99588875119468}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.262226 cos_to_last_merge=0.9464 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=88 local utility u=0.000010 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939874058080331, 'loss_val': 0.02700817865214211, 'psi': 0.9944548525487307}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939809511658702, 'loss_val': 0.027009178068408017, 'psi': 0.9944522706918655}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=88 head_norm_before_train=1.862966 cos_to_last_merge=0.9551 (last merge round=35)
[S11] round=88 local utility u=0.042930 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989201343088827, 'loss_val': 0.021411292976063458, 'psi': 0.9975085361072813}-{'f1_val': 0.9874995237736947, 'auprc': 0.9987296392251728, 'loss_val': 0.052291455954929525, 'psi': 0.9919915699542858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=88 head_norm_before_train=1.942987 cos_to_last_merge=0.9843 (last merge round=39)
[S13] round=88 local utility u=0.041362 metrics={'f1_val': 0.7770863368305099, 'auprc': 0.8546827121910244, 'loss_val': 0.9268717271576371, 'psi': 0.8081248869747157}-{'f1_val': 0.7831991740764652, 'auprc': 0.8422982420021405, 'loss_val': 1.0091197966448804, 'psi': 0.8068388012467353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=88 head_norm_before_train=2.023294 cos_to_last_merge=0.9694 (last merge round=39)
[S14] round=88 local utility u=0.079230 metrics={'f1_val': 0.9470596839315246, 'auprc': 0.9990341399708088, 'loss_val': 0.06810173762166438, 'psi': 0.9678494663472383}-{'f1_val': 0.9327633323614597, 'auprc': 0.9990323915085646, 'loss_val': 0.14077859907516665, 'psi': 0.9592709560203017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=88 head_norm_before_train=2.210208 cos_to_last_merge=0.9538 (last merge round=41)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.960130881897978, 'auprc': 0.9973443763990386, 'loss_val': 0.10135070014608359, 'psi': 0.9750162796984022}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973721705792558, 'loss_val': 0.094506257004323, 'psi': 0.9758619336537049}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.976603 cos_to_last_merge=0.9510 (last merge round=41)
[S16] round=88 local utility u=0.066419 metrics={'f1_val': 0.9426269688491269, 'auprc': 0.9811948494877798, 'loss_val': 0.29974072619309455, 'psi': 0.958054121104588}-{'f1_val': 0.9378162732606046, 'auprc': 0.9766862952534212, 'loss_val': 0.3901897257962117, 'psi': 0.9533642820577313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=88 head_norm_before_train=1.918400 cos_to_last_merge=0.9696 (last merge round=40)
[S17] round=88 local utility u=0.980349 metrics={'f1_val': 0.8949699959033854, 'auprc': 0.8420159221969395, 'loss_val': 0.5499327183220588, 'psi': 0.873788366420807}-{'f1_val': 0.69777095336482, 'auprc': 0.8336628283709521, 'loss_val': 1.3023777753856638, 'psi': 0.7521277033672729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=89 head_norm_before_train=2.156337 cos_to_last_merge=0.9562 (last merge round=41)
[S2] round=89 local utility u=0.138507 metrics={'f1_val': 0.7097747853580937, 'auprc': 0.9559220963794541, 'loss_val': 0.5890948446442651, 'psi': 0.8082337097666379}-{'f1_val': 0.7146727941955283, 'auprc': 0.8744497947657761, 'loss_val': 0.6510792443848785, 'psi': 0.7785835944236275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=89 head_norm_before_train=1.821523 cos_to_last_merge=0.9762 (last merge round=40)
[S3] round=89 local utility u=0.141419 metrics={'f1_val': 0.8173235022440671, 'auprc': 0.9834076093653368, 'loss_val': 0.611492077614833, 'psi': 0.883757145092575}-{'f1_val': 0.7995555865229325, 'auprc': 0.9538544016099184, 'loss_val': 0.699063002206525, 'psi': 0.8612751125577268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=89 head_norm_before_train=2.115930 cos_to_last_merge=0.9863 (last merge round=41)
[S4] round=89 local utility u=0.062056 metrics={'f1_val': 0.9336077508545512, 'auprc': 0.9817012263405649, 'loss_val': 0.3037074399181818, 'psi': 0.9528451410489567}-{'f1_val': 0.9315047211603088, 'auprc': 0.946393551082362, 'loss_val': 0.3092787174004621, 'psi': 0.9374602531291301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=89 head_norm_before_train=1.827223 cos_to_last_merge=0.9537 (last merge round=38)
[S5] round=89 local utility u=0.010986 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952384391516311, 'loss_val': 0.021865386257583892, 'psi': 0.996116556747727}-{'f1_val': 0.9963338119635569, 'auprc': 0.9916397379931511, 'loss_val': 0.030832485400895154, 'psi': 0.9944561823753946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=89 head_norm_before_train=2.233733 cos_to_last_merge=0.7765 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.776
[S6] round=89 local utility u=0.164022 metrics={'f1_val': 0.8049983723299925, 'auprc': 0.9505887234972623, 'loss_val': 0.35102461208377955, 'psi': 0.8632345127969004}-{'f1_val': 0.8178192098241663, 'auprc': 0.9108838826831288, 'loss_val': 0.636878337280975, 'psi': 0.8550450789677513}
[S6] not sending this round → trigger blocked (psi=0.863)
[S7] START round=89 head_norm_before_train=1.906258 cos_to_last_merge=0.9941 (last merge round=39)
[S7] round=89 local utility u=0.167327 metrics={'f1_val': 0.6593039879189769, 'auprc': 0.8077003310367123, 'loss_val': 0.42282733529587235, 'psi': 0.7186625251660711}-{'f1_val': 0.6243239303837188, 'auprc': 0.7956780369419297, 'loss_val': 0.5115343742087808, 'psi': 0.6928655730070032}
[S7] not sending this round → trigger blocked (psi=0.719)
[S8] START round=89 head_norm_before_train=2.410597 (no previous merge yet)
[S8] round=89 local utility u=0.007986 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9993985059480597, 'loss_val': 0.02360098392813942, 'psi': 0.9963748187385398}-{'f1_val': 0.9928938724649488, 'auprc': 0.9990038435464891, 'loss_val': 0.029598782733078855, 'psi': 0.9953378608975649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=89 head_norm_before_train=1.787351 cos_to_last_merge=0.9665 (last merge round=34)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.8005882441759509, 'auprc': 0.8681287743590347, 'loss_val': 0.39816919406569945, 'psi': 0.8276044562491844}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937711945614365, 'loss_val': 0.021315499729301187, 'psi': 0.9952585346921412}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.265369 cos_to_last_merge=0.9461 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=89 local utility u=0.000011 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939935351494379, 'loss_val': 0.02700452840768435, 'psi': 0.9944573042852924}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939874058080331, 'loss_val': 0.02700817865214211, 'psi': 0.9944548525487307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=89 head_norm_before_train=1.867646 cos_to_last_merge=0.9548 (last merge round=35)
[S11] round=89 local utility u=0.000150 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9989428173494213, 'loss_val': 0.021178443395528733, 'psi': 0.9975176093234968}-{'f1_val': 0.996567470639547, 'auprc': 0.9989201343088827, 'loss_val': 0.021411292976063458, 'psi': 0.9975085361072813}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=89 head_norm_before_train=1.949857 cos_to_last_merge=0.9838 (last merge round=39)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.7457494674801114, 'auprc': 0.7851231343109308, 'loss_val': 1.1087525682246975, 'psi': 0.7614989342124392}-{'f1_val': 0.7770863368305099, 'auprc': 0.8546827121910244, 'loss_val': 0.9268717271576371, 'psi': 0.8081248869747157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.029570 cos_to_last_merge=0.9690 (last merge round=39)
[S14] round=89 local utility u=0.165981 metrics={'f1_val': 0.9949110635196168, 'auprc': 0.9990151167621123, 'loss_val': 0.02319059289055015, 'psi': 0.9965526848166151}-{'f1_val': 0.9470596839315246, 'auprc': 0.9990341399708088, 'loss_val': 0.06810173762166438, 'psi': 0.9678494663472383}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=89 head_norm_before_train=2.215500 cos_to_last_merge=0.9534 (last merge round=41)
[S15] round=89 local utility u=0.006725 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.997365593500671, 'loss_val': 0.09630894179355716, 'psi': 0.9758593028222711}-{'f1_val': 0.960130881897978, 'auprc': 0.9973443763990386, 'loss_val': 0.10135070014608359, 'psi': 0.9750162796984022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=89 head_norm_before_train=1.980303 cos_to_last_merge=0.9506 (last merge round=41)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.8236590128736765, 'auprc': 0.9599631657805301, 'loss_val': 0.8919371118445034, 'psi': 0.878180674036418}-{'f1_val': 0.9426269688491269, 'auprc': 0.9811948494877798, 'loss_val': 0.29974072619309455, 'psi': 0.958054121104588}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=1.923410 cos_to_last_merge=0.9693 (last merge round=40)
[S17] round=89 local utility u=0.032580 metrics={'f1_val': 0.895807043561161, 'auprc': 0.8576996531955974, 'loss_val': 0.5368453740424992, 'psi': 0.8805640874149355}-{'f1_val': 0.8949699959033854, 'auprc': 0.8420159221969395, 'loss_val': 0.5499327183220588, 'psi': 0.873788366420807}
[S17] not sending this round → trigger blocked (psi=0.881)
[S2] START round=90 head_norm_before_train=2.163298 cos_to_last_merge=0.9557 (last merge round=41)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.6796033095857343, 'auprc': 0.8145707566539012, 'loss_val': 0.8035360638954256, 'psi': 0.733590288413001}-{'f1_val': 0.7097747853580937, 'auprc': 0.9559220963794541, 'loss_val': 0.5890948446442651, 'psi': 0.8082337097666379}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=1.826361 cos_to_last_merge=0.9758 (last merge round=40)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.7461569442597982, 'auprc': 0.9205663945660505, 'loss_val': 0.8745825319674555, 'psi': 0.8159207243822991}-{'f1_val': 0.8173235022440671, 'auprc': 0.9834076093653368, 'loss_val': 0.611492077614833, 'psi': 0.883757145092575}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=2.125239 cos_to_last_merge=0.9864 (last merge round=41)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.938411515173724, 'auprc': 0.9700006722203435, 'loss_val': 0.30033628935042916, 'psi': 0.9510471779923718}-{'f1_val': 0.9336077508545512, 'auprc': 0.9817012263405649, 'loss_val': 0.3037074399181818, 'psi': 0.9528451410489567}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.831264 cos_to_last_merge=0.9534 (last merge round=38)
[S5] round=90 local utility u=0.001043 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9968379623538653, 'loss_val': 0.024577051018655705, 'psi': 0.9967563660286207}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952384391516311, 'loss_val': 0.021865386257583892, 'psi': 0.996116556747727}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=90 head_norm_before_train=2.244227 cos_to_last_merge=0.7763 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.776
[S6] round=90 local utility u=0.508756 metrics={'f1_val': 0.9570051760562959, 'auprc': 0.9436707226655042, 'loss_val': 0.22479931110154291, 'psi': 0.9516713946999793}-{'f1_val': 0.8049983723299925, 'auprc': 0.9505887234972623, 'loss_val': 0.35102461208377955, 'psi': 0.8632345127969004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=90 head_norm_before_train=1.910883 cos_to_last_merge=0.9938 (last merge round=39)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.5304271217094056, 'auprc': 0.7789239916680077, 'loss_val': 1.1136184855449978, 'psi': 0.6298258696928465}-{'f1_val': 0.6593039879189769, 'auprc': 0.8077003310367123, 'loss_val': 0.42282733529587235, 'psi': 0.7186625251660711}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.418196 (no previous merge yet)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9993594253347531, 'loss_val': 0.025901098933600986, 'psi': 0.9959189724025992}-{'f1_val': 0.9943590272655265, 'auprc': 0.9993985059480597, 'loss_val': 0.02360098392813942, 'psi': 0.9963748187385398}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=1.786847 cos_to_last_merge=0.9666 (last merge round=34)
[S9] round=90 local utility u=0.972250 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980343490082888, 'loss_val': 0.019818865826047097, 'psi': 0.9972100466916504}-{'f1_val': 0.8005882441759509, 'auprc': 0.8681287743590347, 'loss_val': 0.39816919406569945, 'psi': 0.8276044562491844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=90 head_norm_before_train=2.268255 cos_to_last_merge=0.9458 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938678684072644, 'loss_val': 0.026967175816333684, 'psi': 0.9944070375884231}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939935351494379, 'loss_val': 0.02700452840768435, 'psi': 0.9944573042852924}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=1.872569 cos_to_last_merge=0.9544 (last merge round=35)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998600789834962, 'loss_val': 0.024891221035056258, 'psi': 0.9971328007804321}-{'f1_val': 0.996567470639547, 'auprc': 0.9989428173494213, 'loss_val': 0.021178443395528733, 'psi': 0.9975176093234968}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.956970 cos_to_last_merge=0.9833 (last merge round=39)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6728559779254943, 'auprc': 0.7270568307464139, 'loss_val': 1.3236305036454716, 'psi': 0.6945363190538623}-{'f1_val': 0.7457494674801114, 'auprc': 0.7851231343109308, 'loss_val': 1.1087525682246975, 'psi': 0.7614989342124392}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.036693 cos_to_last_merge=0.9686 (last merge round=39)
[S14] round=90 local utility u=0.009080 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9990197631794978, 'loss_val': 0.0175248125673027, 'psi': 0.9978025314852684}-{'f1_val': 0.9949110635196168, 'auprc': 0.9990151167621123, 'loss_val': 0.02319059289055015, 'psi': 0.9965526848166151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=90 head_norm_before_train=2.220708 cos_to_last_merge=0.9530 (last merge round=41)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9596657944499365, 'auprc': 0.9973370421936352, 'loss_val': 0.10333429327947863, 'psi': 0.9747342935474159}-{'f1_val': 0.9615217757033376, 'auprc': 0.997365593500671, 'loss_val': 0.09630894179355716, 'psi': 0.9758593028222711}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.983373 cos_to_last_merge=0.9503 (last merge round=41)
[S16] round=90 local utility u=0.949152 metrics={'f1_val': 0.9907942060487036, 'auprc': 0.9789022166737225, 'loss_val': 0.053262324712027395, 'psi': 0.9860374102987111}-{'f1_val': 0.8236590128736765, 'auprc': 0.9599631657805301, 'loss_val': 0.8919371118445034, 'psi': 0.878180674036418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=90 head_norm_before_train=1.927591 cos_to_last_merge=0.9690 (last merge round=40)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8972246884708777, 'auprc': 0.8510731236888941, 'loss_val': 0.5419629176561901, 'psi': 0.8787640625580843}-{'f1_val': 0.895807043561161, 'auprc': 0.8576996531955974, 'loss_val': 0.5368453740424992, 'psi': 0.8805640874149355}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.171679 cos_to_last_merge=0.9552 (last merge round=41)
[S2] round=91 local utility u=0.427024 metrics={'f1_val': 0.7097747853580937, 'auprc': 0.9790579214641046, 'loss_val': 0.6239782460373089, 'psi': 0.8174880398004981}-{'f1_val': 0.6796033095857343, 'auprc': 0.8145707566539012, 'loss_val': 0.8035360638954256, 'psi': 0.733590288413001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=91 head_norm_before_train=1.831271 cos_to_last_merge=0.9756 (last merge round=40)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.752682263795727, 'auprc': 0.8917227872322707, 'loss_val': 0.9572371426588571, 'psi': 0.8082984731703445}-{'f1_val': 0.7461569442597982, 'auprc': 0.9205663945660505, 'loss_val': 0.8745825319674555, 'psi': 0.8159207243822991}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.129822 cos_to_last_merge=0.9861 (last merge round=41)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9384792159118607, 'auprc': 0.9500496793524326, 'loss_val': 0.2992095759572138, 'psi': 0.9431074012880895}-{'f1_val': 0.938411515173724, 'auprc': 0.9700006722203435, 'loss_val': 0.30033628935042916, 'psi': 0.9510471779923718}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.834634 cos_to_last_merge=0.9530 (last merge round=38)
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934110921181865, 'loss_val': 0.02302998625271518, 'psi': 0.9951647240254087}-{'f1_val': 0.9967019684784577, 'auprc': 0.9968379623538653, 'loss_val': 0.024577051018655705, 'psi': 0.9967563660286207}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.253271 cos_to_last_merge=0.7761 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.776
[S6] round=91 local utility u=0.224272 metrics={'f1_val': 0.9872347262287389, 'auprc': 0.979672232530927, 'loss_val': 0.06563689278521564, 'psi': 0.9842097287496141}-{'f1_val': 0.9570051760562959, 'auprc': 0.9436707226655042, 'loss_val': 0.22479931110154291, 'psi': 0.9516713946999793}
[S6] not sending this round → trigger blocked (psi=0.984)
[S7] START round=91 head_norm_before_train=1.916753 cos_to_last_merge=0.9935 (last merge round=39)
[S7] round=91 local utility u=0.896627 metrics={'f1_val': 0.6618662729940997, 'auprc': 0.851771519123637, 'loss_val': 0.32754149002458177, 'psi': 0.7378283714459146}-{'f1_val': 0.5304271217094056, 'auprc': 0.7789239916680077, 'loss_val': 1.1136184855449978, 'psi': 0.6298258696928465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=91 head_norm_before_train=2.420514 (no previous merge yet)
[S8] round=91 local utility u=0.003375 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9991369374203948, 'loss_val': 0.02288497210095088, 'psi': 0.9962701913274739}-{'f1_val': 0.9936253371144965, 'auprc': 0.9993594253347531, 'loss_val': 0.025901098933600986, 'psi': 0.9959189724025992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=91 head_norm_before_train=1.786765 cos_to_last_merge=0.9667 (last merge round=34)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980415271988341, 'loss_val': 0.02018047811813242, 'psi': 0.9972129179678685}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980343490082888, 'loss_val': 0.019818865826047097, 'psi': 0.9972100466916504}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.271792 cos_to_last_merge=0.9455 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=91 local utility u=0.000076 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939463855446861, 'loss_val': 0.027051572192771944, 'psi': 0.9944384444433918}-{'f1_val': 0.9947664837091956, 'auprc': 0.9938678684072644, 'loss_val': 0.026967175816333684, 'psi': 0.9944070375884231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=91 head_norm_before_train=1.875911 cos_to_last_merge=0.9540 (last merge round=35)
[S11] round=91 local utility u=0.001062 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979872368573531, 'loss_val': 0.023283030886690648, 'psi': 0.997123097451095}-{'f1_val': 0.9961541414107454, 'auprc': 0.998600789834962, 'loss_val': 0.024891221035056258, 'psi': 0.9971328007804321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=91 head_norm_before_train=1.963633 cos_to_last_merge=0.9827 (last merge round=39)
[S13] round=91 local utility u=0.633202 metrics={'f1_val': 0.7759317062849319, 'auprc': 0.833512396574658, 'loss_val': 0.9950478122767122, 'psi': 0.7989639824008223}-{'f1_val': 0.6728559779254943, 'auprc': 0.7270568307464139, 'loss_val': 1.3236305036454716, 'psi': 0.6945363190538623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=91 head_norm_before_train=2.043915 cos_to_last_merge=0.9682 (last merge round=39)
[S14] round=91 local utility u=0.003799 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9990348547803451, 'loss_val': 0.014943397191446255, 'psi': 0.9983056526924691}-{'f1_val': 0.9969910436891155, 'auprc': 0.9990197631794978, 'loss_val': 0.0175248125673027, 'psi': 0.9978025314852684}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=91 head_norm_before_train=2.225784 cos_to_last_merge=0.9526 (last merge round=41)
[S15] round=91 local utility u=0.008398 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973654645917169, 'loss_val': 0.09775947104923716, 'psi': 0.9758592512586894}-{'f1_val': 0.9596657944499365, 'auprc': 0.9973370421936352, 'loss_val': 0.10333429327947863, 'psi': 0.9747342935474159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=91 head_norm_before_train=1.987393 cos_to_last_merge=0.9500 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=91 local utility u=0.028331 metrics={'f1_val': 0.9920731600293354, 'auprc': 0.9904111091650805, 'loss_val': 0.03880073265268122, 'psi': 0.9914083396836334}-{'f1_val': 0.9907942060487036, 'auprc': 0.9789022166737225, 'loss_val': 0.053262324712027395, 'psi': 0.9860374102987111}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=91 head_norm_before_train=1.928446 cos_to_last_merge=0.9688 (last merge round=40)
[S17] round=91 local utility u=0.007353 metrics={'f1_val': 0.8969446709237278, 'auprc': 0.8567383250736285, 'loss_val': 0.5425717610108041, 'psi': 0.8808621325836881}-{'f1_val': 0.8972246884708777, 'auprc': 0.8510731236888941, 'loss_val': 0.5419629176561901, 'psi': 0.8787640625580843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=92 head_norm_before_train=2.178793 cos_to_last_merge=0.9549 (last merge round=41)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.7147151383738515, 'auprc': 0.8622326387337516, 'loss_val': 0.7709813213944309, 'psi': 0.7737221385178115}-{'f1_val': 0.7097747853580937, 'auprc': 0.9790579214641046, 'loss_val': 0.6239782460373089, 'psi': 0.8174880398004981}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=1.836140 cos_to_last_merge=0.9754 (last merge round=40)
[S3] round=92 local utility u=0.182031 metrics={'f1_val': 0.7856716764869015, 'auprc': 0.9113140337556113, 'loss_val': 0.8498853879804142, 'psi': 0.8359286193943855}-{'f1_val': 0.752682263795727, 'auprc': 0.8917227872322707, 'loss_val': 0.9572371426588571, 'psi': 0.8082984731703445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=92 head_norm_before_train=2.136025 cos_to_last_merge=0.9860 (last merge round=41)
[S4] round=92 local utility u=0.007203 metrics={'f1_val': 0.9357694115948079, 'auprc': 0.9594287399260779, 'loss_val': 0.2966828058991522, 'psi': 0.945233142927316}-{'f1_val': 0.9384792159118607, 'auprc': 0.9500496793524326, 'loss_val': 0.2992095759572138, 'psi': 0.9431074012880895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=92 head_norm_before_train=1.837729 cos_to_last_merge=0.9528 (last merge round=38)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9930398643812834, 'loss_val': 0.02361730489760458, 'psi': 0.9950162329306474}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934110921181865, 'loss_val': 0.02302998625271518, 'psi': 0.9951647240254087}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=2.259656 cos_to_last_merge=0.7750 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.775
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.7225918096396655, 'auprc': 0.8461326628403424, 'loss_val': 1.008049409599155, 'psi': 0.7720081509199364}-{'f1_val': 0.9872347262287389, 'auprc': 0.979672232530927, 'loss_val': 0.06563689278521564, 'psi': 0.9842097287496141}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.921867 cos_to_last_merge=0.9932 (last merge round=39)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.4744944229184247, 'auprc': 0.7775390812616683, 'loss_val': 1.123883420761702, 'psi': 0.5957122862557221}-{'f1_val': 0.6618662729940997, 'auprc': 0.851771519123637, 'loss_val': 0.32754149002458177, 'psi': 0.7378283714459146}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.429757 (no previous merge yet)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.979079025251121, 'auprc': 0.9964172047714956, 'loss_val': 0.06344825709212353, 'psi': 0.9860142970592709}-{'f1_val': 0.9943590272655265, 'auprc': 0.9991369374203948, 'loss_val': 0.02288497210095088, 'psi': 0.9962701913274739}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=1.787852 cos_to_last_merge=0.9667 (last merge round=34)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9937213086844723, 'loss_val': 0.0387560753583809, 'psi': 0.9913056282909134}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980415271988341, 'loss_val': 0.02018047811813242, 'psi': 0.9972129179678685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.277285 cos_to_last_merge=0.9450 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9940021649223652, 'loss_val': 0.02725185403543794, 'psi': 0.9944607561944634}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939463855446861, 'loss_val': 0.027051572192771944, 'psi': 0.9944384444433918}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=1.880991 cos_to_last_merge=0.9536 (last merge round=35)
[S11] round=92 local utility u=0.000580 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977703463131313, 'loss_val': 0.021472621060537857, 'psi': 0.9970363412334062}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979872368573531, 'loss_val': 0.023283030886690648, 'psi': 0.997123097451095}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=92 head_norm_before_train=1.969178 cos_to_last_merge=0.9821 (last merge round=39)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.7577735539610595, 'auprc': 0.7838381319625801, 'loss_val': 1.1095503946864673, 'psi': 0.7681993851616677}-{'f1_val': 0.7759317062849319, 'auprc': 0.833512396574658, 'loss_val': 0.9950478122767122, 'psi': 0.7989639824008223}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=2.048456 cos_to_last_merge=0.9678 (last merge round=39)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990263791600489, 'loss_val': 0.01683437706936044, 'psi': 0.9981880175009559}-{'f1_val': 0.9978195179672185, 'auprc': 0.9990348547803451, 'loss_val': 0.014943397191446255, 'psi': 0.9983056526924691}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.230751 cos_to_last_merge=0.9522 (last merge round=41)
[S15] round=92 local utility u=0.006667 metrics={'f1_val': 0.9624454310657871, 'auprc': 0.997384798913796, 'loss_val': 0.09002588634944615, 'psi': 0.9764211782049906}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973654645917169, 'loss_val': 0.09775947104923716, 'psi': 0.9758592512586894}
[S15] not sending this round → trigger blocked (psi=0.976)
[S16] START round=92 head_norm_before_train=1.992037 cos_to_last_merge=0.9496 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.950
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.6973450368464776, 'auprc': 0.9097989422344134, 'loss_val': 1.3878536839895754, 'psi': 0.7823265990016519}-{'f1_val': 0.9920731600293354, 'auprc': 0.9904111091650805, 'loss_val': 0.03880073265268122, 'psi': 0.9914083396836334}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=1.934454 cos_to_last_merge=0.9683 (last merge round=40)
[S17] round=92 local utility u=0.055768 metrics={'f1_val': 0.9010195610633384, 'auprc': 0.8816342125584626, 'loss_val': 0.5301737144077453, 'psi': 0.893265421661388}-{'f1_val': 0.8969446709237278, 'auprc': 0.8567383250736285, 'loss_val': 0.5425717610108041, 'psi': 0.8808621325836881}
[S17] not sending this round → trigger blocked (psi=0.893)
[S2] START round=93 head_norm_before_train=2.186298 cos_to_last_merge=0.9545 (last merge round=41)
[S2] round=93 local utility u=0.237160 metrics={'f1_val': 0.709773168894499, 'auprc': 0.9899037659440943, 'loss_val': 0.6500235313545337, 'psi': 0.8218254077143372}-{'f1_val': 0.7147151383738515, 'auprc': 0.8622326387337516, 'loss_val': 0.7709813213944309, 'psi': 0.7737221385178115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=93 head_norm_before_train=1.841643 cos_to_last_merge=0.9752 (last merge round=40)
[S3] round=93 local utility u=0.410023 metrics={'f1_val': 0.8445807549809519, 'auprc': 0.9624101128241549, 'loss_val': 0.5365817610737553, 'psi': 0.891712498118233}-{'f1_val': 0.7856716764869015, 'auprc': 0.9113140337556113, 'loss_val': 0.8498853879804142, 'psi': 0.8359286193943855}
[S3] not sending this round → trigger blocked (psi=0.892)
[S4] START round=93 head_norm_before_train=2.142616 cos_to_last_merge=0.9859 (last merge round=41)
[S4] round=93 local utility u=0.043841 metrics={'f1_val': 0.938837169956829, 'auprc': 0.9833803019678007, 'loss_val': 0.2992613578440567, 'psi': 0.9566544227612177}-{'f1_val': 0.9357694115948079, 'auprc': 0.9594287399260779, 'loss_val': 0.2966828058991522, 'psi': 0.945233142927316}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=93 head_norm_before_train=1.836841 cos_to_last_merge=0.9524 (last merge round=38)
[S5] round=93 local utility u=0.001430 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936397995734463, 'loss_val': 0.02255664169518855, 'psi': 0.9952562070075126}-{'f1_val': 0.9963338119635569, 'auprc': 0.9930398643812834, 'loss_val': 0.02361730489760458, 'psi': 0.9950162329306474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=93 head_norm_before_train=2.271176 cos_to_last_merge=0.7747 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.775
[S6] round=93 local utility u=0.571722 metrics={'f1_val': 0.8280460229508396, 'auprc': 0.9227729511711701, 'loss_val': 0.7272524298910047, 'psi': 0.8659367942389719}-{'f1_val': 0.7225918096396655, 'auprc': 0.8461326628403424, 'loss_val': 1.008049409599155, 'psi': 0.7720081509199364}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=93 head_norm_before_train=1.924086 cos_to_last_merge=0.9930 (last merge round=39)
[S7] round=93 local utility u=1.000000 metrics={'f1_val': 0.9074533581035289, 'auprc': 0.9846022842784001, 'loss_val': 0.24946789090271018, 'psi': 0.9383129285734774}-{'f1_val': 0.4744944229184247, 'auprc': 0.7775390812616683, 'loss_val': 1.123883420761702, 'psi': 0.5957122862557221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=93 head_norm_before_train=2.437009 (no previous merge yet)
[S8] round=93 local utility u=0.071740 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9994511011342696, 'loss_val': 0.02295522958847338, 'psi': 0.9966164678445987}-{'f1_val': 0.979079025251121, 'auprc': 0.9964172047714956, 'loss_val': 0.06344825709212353, 'psi': 0.9860142970592709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=93 head_norm_before_train=1.790828 cos_to_last_merge=0.9665 (last merge round=34)
[S9] round=93 local utility u=0.017526 metrics={'f1_val': 0.9918452858557183, 'auprc': 0.9983988509337762, 'loss_val': 0.030636866378667273, 'psi': 0.9944667118869415}-{'f1_val': 0.9896951746952075, 'auprc': 0.9937213086844723, 'loss_val': 0.0387560753583809, 'psi': 0.9913056282909134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=93 head_norm_before_train=2.283352 cos_to_last_merge=0.9446 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939775547423554, 'loss_val': 0.027248430001859607, 'psi': 0.9944509121224595}-{'f1_val': 0.9947664837091956, 'auprc': 0.9940021649223652, 'loss_val': 0.02725185403543794, 'psi': 0.9944607561944634}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=1.886434 cos_to_last_merge=0.9531 (last merge round=35)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9970864418277351, 'loss_val': 0.02145375259983404, 'psi': 0.9967506956284733}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977703463131313, 'loss_val': 0.021472621060537857, 'psi': 0.9970363412334062}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.979126 cos_to_last_merge=0.9815 (last merge round=39)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.7496162074884223, 'auprc': 0.7857889619730714, 'loss_val': 1.0837430730978166, 'psi': 0.7640853092822819}-{'f1_val': 0.7577735539610595, 'auprc': 0.7838381319625801, 'loss_val': 1.1095503946864673, 'psi': 0.7681993851616677}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.048523 cos_to_last_merge=0.9676 (last merge round=39)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9863010219587574, 'auprc': 0.9990137893909593, 'loss_val': 0.04370217351408125, 'psi': 0.9913861289316381}-{'f1_val': 0.9976291097282272, 'auprc': 0.9990263791600489, 'loss_val': 0.01683437706936044, 'psi': 0.9981880175009559}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.235646 cos_to_last_merge=0.9518 (last merge round=41)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973662014871361, 'loss_val': 0.0986323373616357, 'psi': 0.9758595460168571}-{'f1_val': 0.9624454310657871, 'auprc': 0.997384798913796, 'loss_val': 0.09002588634944615, 'psi': 0.9764211782049906}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=1.993787 cos_to_last_merge=0.9494 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=93 local utility u=0.554741 metrics={'f1_val': 0.8271678351555608, 'auprc': 0.9930956287816016, 'loss_val': 1.3071993027969595, 'psi': 0.8935389526059772}-{'f1_val': 0.6973450368464776, 'auprc': 0.9097989422344134, 'loss_val': 1.3878536839895754, 'psi': 0.7823265990016519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=93 head_norm_before_train=1.942011 cos_to_last_merge=0.9678 (last merge round=40)
[S17] round=93 local utility u=0.014317 metrics={'f1_val': 0.902278263725594, 'auprc': 0.8901599290814888, 'loss_val': 0.5346697548845962, 'psi': 0.8974309298679519}-{'f1_val': 0.9010195610633384, 'auprc': 0.8816342125584626, 'loss_val': 0.5301737144077453, 'psi': 0.893265421661388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=94 head_norm_before_train=2.194811 cos_to_last_merge=0.9539 (last merge round=41)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.709779773251187, 'auprc': 0.9877470773547973, 'loss_val': 0.6498382433140357, 'psi': 0.8209666948926311}-{'f1_val': 0.709773168894499, 'auprc': 0.9899037659440943, 'loss_val': 0.6500235313545337, 'psi': 0.8218254077143372}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=1.846961 cos_to_last_merge=0.9749 (last merge round=40)
[S3] round=94 local utility u=0.732780 metrics={'f1_val': 0.9872064055807985, 'auprc': 0.9994927529638936, 'loss_val': 0.0380239056183927, 'psi': 0.9921209445340365}-{'f1_val': 0.8445807549809519, 'auprc': 0.9624101128241549, 'loss_val': 0.5365817610737553, 'psi': 0.891712498118233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=94 head_norm_before_train=2.147706 cos_to_last_merge=0.9859 (last merge round=41)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9385875292594202, 'auprc': 0.9814999206002095, 'loss_val': 0.3051899292277465, 'psi': 0.9557524857957359}-{'f1_val': 0.938837169956829, 'auprc': 0.9833803019678007, 'loss_val': 0.2992613578440567, 'psi': 0.9566544227612177}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.840366 cos_to_last_merge=0.9521 (last merge round=38)
[S5] round=94 local utility u=0.001450 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939106274434942, 'loss_val': 0.022677853773292005, 'psi': 0.9955854320644724}-{'f1_val': 0.9963338119635569, 'auprc': 0.9936397995734463, 'loss_val': 0.02255664169518855, 'psi': 0.9952562070075126}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=94 head_norm_before_train=2.280419 cos_to_last_merge=0.7745 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.774
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.7609374444164867, 'auprc': 0.7868786995665935, 'loss_val': 0.954377432608371, 'psi': 0.7713139464765294}-{'f1_val': 0.8280460229508396, 'auprc': 0.9227729511711701, 'loss_val': 0.7272524298910047, 'psi': 0.8659367942389719}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.927605 cos_to_last_merge=0.9928 (last merge round=39)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5604875140898218, 'auprc': 0.7834374895395607, 'loss_val': 0.9334281485219972, 'psi': 0.6496675042697173}-{'f1_val': 0.9074533581035289, 'auprc': 0.9846022842784001, 'loss_val': 0.24946789090271018, 'psi': 0.9383129285734774}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.441678 (no previous merge yet)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9943590272655265, 'auprc': 0.9994495201347025, 'loss_val': 0.02453059577094721, 'psi': 0.996395224413197}-{'f1_val': 0.9947267123181514, 'auprc': 0.9994511011342696, 'loss_val': 0.02295522958847338, 'psi': 0.9966164678445987}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=1.793852 cos_to_last_merge=0.9662 (last merge round=34)
[S9] round=94 local utility u=0.014170 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9984111362411201, 'loss_val': 0.02239946613308464, 'psi': 0.9964782661738121}-{'f1_val': 0.9918452858557183, 'auprc': 0.9983988509337762, 'loss_val': 0.030636866378667273, 'psi': 0.9944667118869415}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=94 head_norm_before_train=2.288416 cos_to_last_merge=0.9442 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938849415955423, 'loss_val': 0.027184795075608132, 'psi': 0.9944138668637343}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939775547423554, 'loss_val': 0.027248430001859607, 'psi': 0.9944509121224595}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=1.890522 cos_to_last_merge=0.9529 (last merge round=35)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9946929828124721, 'loss_val': 0.02306417556676162, 'psi': 0.9956482102073623}-{'f1_val': 0.9965268648289654, 'auprc': 0.9970864418277351, 'loss_val': 0.02145375259983404, 'psi': 0.9967506956284733}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.988275 cos_to_last_merge=0.9811 (last merge round=39)
[S13] round=94 local utility u=0.197143 metrics={'f1_val': 0.7764594343649234, 'auprc': 0.8357101651706975, 'loss_val': 1.0002804207496907, 'psi': 0.8001597266872331}-{'f1_val': 0.7496162074884223, 'auprc': 0.7857889619730714, 'loss_val': 1.0837430730978166, 'psi': 0.7640853092822819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=94 head_norm_before_train=2.052114 cos_to_last_merge=0.9674 (last merge round=39)
[S14] round=94 local utility u=0.046023 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9986343780516522, 'loss_val': 0.018486511351680664, 'psi': 0.9980312170575971}-{'f1_val': 0.9863010219587574, 'auprc': 0.9990137893909593, 'loss_val': 0.04370217351408125, 'psi': 0.9913861289316381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=94 head_norm_before_train=2.240503 cos_to_last_merge=0.9514 (last merge round=41)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9610588691858596, 'auprc': 0.9973649768035566, 'loss_val': 0.10047082916598597, 'psi': 0.9755813122329384}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973662014871361, 'loss_val': 0.0986323373616357, 'psi': 0.9758595460168571}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.995793 cos_to_last_merge=0.9492 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=94 local utility u=0.542787 metrics={'f1_val': 0.8810857986823701, 'auprc': 0.9874081811378812, 'loss_val': 0.5280713348871607, 'psi': 0.9236147516645745}-{'f1_val': 0.8271678351555608, 'auprc': 0.9930956287816016, 'loss_val': 1.3071993027969595, 'psi': 0.8935389526059772}
[S16] not sending this round → trigger blocked (psi=0.924)
[S17] START round=94 head_norm_before_train=1.945788 cos_to_last_merge=0.9675 (last merge round=40)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8973675834510434, 'auprc': 0.866382350268875, 'loss_val': 0.5473017199989563, 'psi': 0.8849734901781761}-{'f1_val': 0.902278263725594, 'auprc': 0.8901599290814888, 'loss_val': 0.5346697548845962, 'psi': 0.8974309298679519}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.200186 cos_to_last_merge=0.9536 (last merge round=41)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7085726681157636, 'auprc': 0.9901500259088756, 'loss_val': 0.6551789442388197, 'psi': 0.8212036112330083}-{'f1_val': 0.709779773251187, 'auprc': 0.9877470773547973, 'loss_val': 0.6498382433140357, 'psi': 0.8209666948926311}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=1.852716 cos_to_last_merge=0.9746 (last merge round=40)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.9382290892462459, 'auprc': 0.9810514125049604, 'loss_val': 0.18253515993202266, 'psi': 0.9553580185497317}-{'f1_val': 0.9872064055807985, 'auprc': 0.9994927529638936, 'loss_val': 0.0380239056183927, 'psi': 0.9921209445340365}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=2.153741 cos_to_last_merge=0.9859 (last merge round=41)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9319916468831652, 'auprc': 0.9425106734983177, 'loss_val': 0.30797784596003974, 'psi': 0.9361992575292262}-{'f1_val': 0.9385875292594202, 'auprc': 0.9814999206002095, 'loss_val': 0.3051899292277465, 'psi': 0.9557524857957359}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.846053 cos_to_last_merge=0.9518 (last merge round=38)
[S5] round=95 local utility u=0.002385 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9954878151194619, 'loss_val': 0.022639630028869942, 'psi': 0.9962163071348593}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939106274434942, 'loss_val': 0.022677853773292005, 'psi': 0.9955854320644724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=95 head_norm_before_train=2.287541 cos_to_last_merge=0.7740 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.774
[S6] round=95 local utility u=0.799580 metrics={'f1_val': 0.8838390522442825, 'auprc': 0.900327740478445, 'loss_val': 0.432975130850146, 'psi': 0.8904345275379475}-{'f1_val': 0.7609374444164867, 'auprc': 0.7868786995665935, 'loss_val': 0.954377432608371, 'psi': 0.7713139464765294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S7] START round=95 head_norm_before_train=1.931407 cos_to_last_merge=0.9925 (last merge round=39)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.5514948294568686, 'auprc': 0.7809729135319657, 'loss_val': 1.0208689987402229, 'psi': 0.6432860630869075}-{'f1_val': 0.5604875140898218, 'auprc': 0.7834374895395607, 'loss_val': 0.9334281485219972, 'psi': 0.6496675042697173}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.453783 (no previous merge yet)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9994534311168177, 'loss_val': 0.025293188524158152, 'psi': 0.9961765141998351}-{'f1_val': 0.9943590272655265, 'auprc': 0.9994495201347025, 'loss_val': 0.02453059577094721, 'psi': 0.996395224413197}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=1.797412 cos_to_last_merge=0.9659 (last merge round=34)
[S9] round=95 local utility u=0.004401 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9987775427692558, 'loss_val': 0.01970573295746231, 'psi': 0.9971257553112464}-{'f1_val': 0.99518968612894, 'auprc': 0.9984111362411201, 'loss_val': 0.02239946613308464, 'psi': 0.9964782661738121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=95 head_norm_before_train=2.291496 cos_to_last_merge=0.9439 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=95 local utility u=0.000015 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939220085511115, 'loss_val': 0.027266180480422654, 'psi': 0.9944286936459619}-{'f1_val': 0.9947664837091956, 'auprc': 0.9938849415955423, 'loss_val': 0.027184795075608132, 'psi': 0.9944138668637343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=95 head_norm_before_train=1.895212 cos_to_last_merge=0.9526 (last merge round=35)
[S11] round=95 local utility u=0.005443 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9971470195873444, 'loss_val': 0.021112342748242138, 'psi': 0.9967870105430915}-{'f1_val': 0.9962850284706224, 'auprc': 0.9946929828124721, 'loss_val': 0.02306417556676162, 'psi': 0.9956482102073623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=95 head_norm_before_train=1.994013 cos_to_last_merge=0.9805 (last merge round=39)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6712262146939956, 'auprc': 0.7159210304108318, 'loss_val': 1.382525563278267, 'psi': 0.6891041409807301}-{'f1_val': 0.7764594343649234, 'auprc': 0.8357101651706975, 'loss_val': 1.0002804207496907, 'psi': 0.8001597266872331}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.056207 cos_to_last_merge=0.9670 (last merge round=39)
[S14] round=95 local utility u=0.000639 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9988910168158796, 'loss_val': 0.017995816294174228, 'psi': 0.9981355907002776}-{'f1_val': 0.9976291097282272, 'auprc': 0.9986343780516522, 'loss_val': 0.018486511351680664, 'psi': 0.9980312170575971}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=95 head_norm_before_train=2.245181 cos_to_last_merge=0.9511 (last merge round=41)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9563894490581925, 'auprc': 0.9973304364432124, 'loss_val': 0.11062292095953935, 'psi': 0.9727658440122005}-{'f1_val': 0.9610588691858596, 'auprc': 0.9973649768035566, 'loss_val': 0.10047082916598597, 'psi': 0.9755813122329384}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=1.997970 cos_to_last_merge=0.9489 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=95 local utility u=0.543183 metrics={'f1_val': 0.9864686827285202, 'auprc': 0.9850939506711734, 'loss_val': 0.06705896264314318, 'psi': 0.9859187899055815}-{'f1_val': 0.8810857986823701, 'auprc': 0.9874081811378812, 'loss_val': 0.5280713348871607, 'psi': 0.9236147516645745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] sending update (kind=head size=1807 to 1 peers)
[S17] START round=95 head_norm_before_train=1.949669 cos_to_last_merge=0.9670 (last merge round=40)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8958180443432682, 'auprc': 0.8600638066524797, 'loss_val': 0.5574479940119582, 'psi': 0.8815163492669529}-{'f1_val': 0.8973675834510434, 'auprc': 0.866382350268875, 'loss_val': 0.5473017199989563, 'psi': 0.8849734901781761}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.203519 cos_to_last_merge=0.9534 (last merge round=41)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7062853885868503, 'auprc': 0.8751248027832441, 'loss_val': 0.6060608849269153, 'psi': 0.7738211542654079}-{'f1_val': 0.7085726681157636, 'auprc': 0.9901500259088756, 'loss_val': 0.6551789442388197, 'psi': 0.8212036112330083}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=1.857065 cos_to_last_merge=0.9745 (last merge round=40)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.873205801112108, 'auprc': 0.9637777260917089, 'loss_val': 0.36784420889392405, 'psi': 0.9094345711039484}-{'f1_val': 0.9382290892462459, 'auprc': 0.9810514125049604, 'loss_val': 0.18253515993202266, 'psi': 0.9553580185497317}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.157139 cos_to_last_merge=0.9856 (last merge round=41)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9318495110816504, 'auprc': 0.9039960465070004, 'loss_val': 0.28932388852094704, 'psi': 0.9207081252517904}-{'f1_val': 0.9319916468831652, 'auprc': 0.9425106734983177, 'loss_val': 0.30797784596003974, 'psi': 0.9361992575292262}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.851645 cos_to_last_merge=0.9515 (last merge round=38)
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939451148723131, 'loss_val': 0.02164620165168391, 'psi': 0.9955992270359999}-{'f1_val': 0.9967019684784577, 'auprc': 0.9954878151194619, 'loss_val': 0.022639630028869942, 'psi': 0.9962163071348593}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.290243 cos_to_last_merge=0.7729 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.773
[S6] round=96 local utility u=0.408492 metrics={'f1_val': 0.9560114833510878, 'auprc': 0.9412605861370757, 'loss_val': 0.17182435724416067, 'psi': 0.950111124465483}-{'f1_val': 0.8838390522442825, 'auprc': 0.900327740478445, 'loss_val': 0.432975130850146, 'psi': 0.8904345275379475}
[S6] not sending this round → trigger blocked (psi=0.950)
[S7] START round=96 head_norm_before_train=1.936157 cos_to_last_merge=0.9923 (last merge round=39)
[S7] round=96 local utility u=1.000000 metrics={'f1_val': 0.7517712146958808, 'auprc': 0.8618476246532685, 'loss_val': 0.3093493236017502, 'psi': 0.7958017786788358}-{'f1_val': 0.5514948294568686, 'auprc': 0.7809729135319657, 'loss_val': 1.0208689987402229, 'psi': 0.6432860630869075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=96 head_norm_before_train=2.460633 (no previous merge yet)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9990440792823053, 'loss_val': 0.03195504123313396, 'psi': 0.9951350133073138}-{'f1_val': 0.9939919029218467, 'auprc': 0.9994534311168177, 'loss_val': 0.025293188524158152, 'psi': 0.9961765141998351}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=1.801506 cos_to_last_merge=0.9656 (last merge round=34)
[S9] round=96 local utility u=0.002724 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9987102661414842, 'loss_val': 0.019024115512808967, 'psi': 0.997595657711948}-{'f1_val': 0.9960245636725735, 'auprc': 0.9987775427692558, 'loss_val': 0.01970573295746231, 'psi': 0.9971257553112464}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=96 head_norm_before_train=2.296077 cos_to_last_merge=0.9435 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938547008431576, 'loss_val': 0.027260906146898477, 'psi': 0.9944017705627803}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939220085511115, 'loss_val': 0.027266180480422654, 'psi': 0.9944286936459619}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=1.899341 cos_to_last_merge=0.9523 (last merge round=35)
[S11] round=96 local utility u=0.000678 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997626015315987, 'loss_val': 0.02119358585447251, 'psi': 0.9969786088345486}-{'f1_val': 0.9965470045135896, 'auprc': 0.9971470195873444, 'loss_val': 0.021112342748242138, 'psi': 0.9967870105430915}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=96 head_norm_before_train=2.004378 cos_to_last_merge=0.9797 (last merge round=39)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6319606561721525, 'auprc': 0.7086876550721748, 'loss_val': 1.4362354284670031, 'psi': 0.6626514557321614}-{'f1_val': 0.6712262146939956, 'auprc': 0.7159210304108318, 'loss_val': 1.382525563278267, 'psi': 0.6891041409807301}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.060683 cos_to_last_merge=0.9667 (last merge round=39)
[S14] round=96 local utility u=0.001221 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9990116120163851, 'loss_val': 0.016047137499022677, 'psi': 0.9981969504961277}-{'f1_val': 0.9976319732898762, 'auprc': 0.9988910168158796, 'loss_val': 0.017995816294174228, 'psi': 0.9981355907002776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=96 head_norm_before_train=2.249837 cos_to_last_merge=0.9507 (last merge round=41)
[S15] round=96 local utility u=0.018515 metrics={'f1_val': 0.9610588691858596, 'auprc': 0.9973603138288765, 'loss_val': 0.10169842981982767, 'psi': 0.9755794470430663}-{'f1_val': 0.9563894490581925, 'auprc': 0.9973304364432124, 'loss_val': 0.11062292095953935, 'psi': 0.9727658440122005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=96 head_norm_before_train=2.000241 cos_to_last_merge=0.9486 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=96 local utility u=0.036463 metrics={'f1_val': 0.9923896065595397, 'auprc': 0.9877168846200971, 'loss_val': 0.0375265556983964, 'psi': 0.9905205177837626}-{'f1_val': 0.9864686827285202, 'auprc': 0.9850939506711734, 'loss_val': 0.06705896264314318, 'psi': 0.9859187899055815}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=96 head_norm_before_train=1.954421 cos_to_last_merge=0.9666 (last merge round=40)
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.7776300729025019, 'auprc': 0.9449707975247461, 'loss_val': 1.0021773862891215, 'psi': 0.8445663627513995}-{'f1_val': 0.8958180443432682, 'auprc': 0.8600638066524797, 'loss_val': 0.5574479940119582, 'psi': 0.8815163492669529}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.207801 cos_to_last_merge=0.9532 (last merge round=41)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.6417890434912464, 'auprc': 0.7893659914977071, 'loss_val': 1.1799563689728079, 'psi': 0.7008198226938307}-{'f1_val': 0.7062853885868503, 'auprc': 0.8751248027832441, 'loss_val': 0.6060608849269153, 'psi': 0.7738211542654079}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=1.861247 cos_to_last_merge=0.9744 (last merge round=40)
[S3] round=97 local utility u=0.607614 metrics={'f1_val': 0.9986383585344689, 'auprc': 0.99953614182433, 'loss_val': 0.012486575921312448, 'psi': 0.9989974718504133}-{'f1_val': 0.873205801112108, 'auprc': 0.9637777260917089, 'loss_val': 0.36784420889392405, 'psi': 0.9094345711039484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=97 head_norm_before_train=2.162104 cos_to_last_merge=0.9853 (last merge round=41)
[S4] round=97 local utility u=0.087088 metrics={'f1_val': 0.9372873848780262, 'auprc': 0.9548283654134552, 'loss_val': 0.30027237500029696, 'psi': 0.9443037770921978}-{'f1_val': 0.9318495110816504, 'auprc': 0.9039960465070004, 'loss_val': 0.28932388852094704, 'psi': 0.9207081252517904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=97 head_norm_before_train=1.857943 cos_to_last_merge=0.9512 (last merge round=38)
[S5] round=97 local utility u=0.003608 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9968306963040251, 'loss_val': 0.023086013141639935, 'psi': 0.9967534596086847}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939451148723131, 'loss_val': 0.02164620165168391, 'psi': 0.9955992270359999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=97 head_norm_before_train=2.297253 cos_to_last_merge=0.7725 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.773
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.920791510394487, 'auprc': 0.9219870205660509, 'loss_val': 0.2566236782459458, 'psi': 0.9212697144631126}-{'f1_val': 0.9560114833510878, 'auprc': 0.9412605861370757, 'loss_val': 0.17182435724416067, 'psi': 0.950111124465483}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.939784 cos_to_last_merge=0.9921 (last merge round=39)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.5434624958208127, 'auprc': 0.7811461074559416, 'loss_val': 0.9292547380728158, 'psi': 0.6385359404748643}-{'f1_val': 0.7517712146958808, 'auprc': 0.8618476246532685, 'loss_val': 0.3093493236017502, 'psi': 0.7958017786788358}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=2.467172 (no previous merge yet)
[S8] round=97 local utility u=0.006110 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9990676358151, 'loss_val': 0.02638356796192907, 'psi': 0.995802256594738}-{'f1_val': 0.9925289693239863, 'auprc': 0.9990440792823053, 'loss_val': 0.03195504123313396, 'psi': 0.9951350133073138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=97 head_norm_before_train=1.804344 cos_to_last_merge=0.9652 (last merge round=34)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995591858267187, 'loss_val': 0.018068749432708756, 'psi': 0.9964984908141605}-{'f1_val': 0.9968525854255906, 'auprc': 0.9987102661414842, 'loss_val': 0.019024115512808967, 'psi': 0.997595657711948}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.298406 cos_to_last_merge=0.9432 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=97 local utility u=0.000002 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938598552714574, 'loss_val': 0.02727282320397239, 'psi': 0.9944038323341002}-{'f1_val': 0.9947664837091956, 'auprc': 0.9938547008431576, 'loss_val': 0.027260906146898477, 'psi': 0.9944017705627803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=97 head_norm_before_train=1.903236 cos_to_last_merge=0.9521 (last merge round=35)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975794205790413, 'loss_val': 0.02149758243068415, 'psi': 0.9969599709397703}-{'f1_val': 0.9965470045135896, 'auprc': 0.997626015315987, 'loss_val': 0.02119358585447251, 'psi': 0.9969786088345486}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.007731 cos_to_last_merge=0.9790 (last merge round=39)
[S13] round=97 local utility u=0.463062 metrics={'f1_val': 0.631394992886699, 'auprc': 0.9703643234213924, 'loss_val': 1.2917471417902306, 'psi': 0.7669827251005764}-{'f1_val': 0.6319606561721525, 'auprc': 0.7086876550721748, 'loss_val': 1.4362354284670031, 'psi': 0.6626514557321614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=97 head_norm_before_train=2.064990 cos_to_last_merge=0.9664 (last merge round=39)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9990788694380698, 'loss_val': 0.01635611586134246, 'psi': 0.9978437214489533}-{'f1_val': 0.9976538428159559, 'auprc': 0.9990116120163851, 'loss_val': 0.016047137499022677, 'psi': 0.9981969504961277}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.254494 cos_to_last_merge=0.9503 (last merge round=41)
[S15] round=97 local utility u=0.002114 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973727351754247, 'loss_val': 0.10028452096591776, 'psi': 0.9758621594921725}-{'f1_val': 0.9610588691858596, 'auprc': 0.9973603138288765, 'loss_val': 0.10169842981982767, 'psi': 0.9755794470430663}
[S15] not sending this round → trigger blocked (psi=0.976)
[S16] START round=97 head_norm_before_train=1.999902 cos_to_last_merge=0.9485 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.8590174367570285, 'auprc': 0.9820134600165215, 'loss_val': 0.9290813600168817, 'psi': 0.9082158460608256}-{'f1_val': 0.9923896065595397, 'auprc': 0.9877168846200971, 'loss_val': 0.0375265556983964, 'psi': 0.9905205177837626}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=1.960214 cos_to_last_merge=0.9662 (last merge round=40)
[S17] round=97 local utility u=0.587992 metrics={'f1_val': 0.9036574439261822, 'auprc': 0.924531271962355, 'loss_val': 0.5210389686314871, 'psi': 0.9120069751406513}-{'f1_val': 0.7776300729025019, 'auprc': 0.9449707975247461, 'loss_val': 1.0021773862891215, 'psi': 0.8445663627513995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=98 head_norm_before_train=2.210464 cos_to_last_merge=0.9530 (last merge round=41)
[S2] round=98 local utility u=0.698922 metrics={'f1_val': 0.709670557531711, 'auprc': 0.9288127216010434, 'loss_val': 0.6077426262145472, 'psi': 0.797327423159444}-{'f1_val': 0.6417890434912464, 'auprc': 0.7893659914977071, 'loss_val': 1.1799563689728079, 'psi': 0.7008198226938307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=98 head_norm_before_train=1.864818 cos_to_last_merge=0.9742 (last merge round=40)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.8773498496032908, 'auprc': 0.9720884670270611, 'loss_val': 0.32055593798410514, 'psi': 0.9152452965727988}-{'f1_val': 0.9986383585344689, 'auprc': 0.99953614182433, 'loss_val': 0.012486575921312448, 'psi': 0.9989974718504133}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.171552 cos_to_last_merge=0.9853 (last merge round=41)
[S4] round=98 local utility u=0.060530 metrics={'f1_val': 0.9438518620808715, 'auprc': 0.9811369591350242, 'loss_val': 0.29752462455633827, 'psi': 0.9587659009025327}-{'f1_val': 0.9372873848780262, 'auprc': 0.9548283654134552, 'loss_val': 0.30027237500029696, 'psi': 0.9443037770921978}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=98 head_norm_before_train=1.861611 cos_to_last_merge=0.9509 (last merge round=38)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9958396004736627, 'loss_val': 0.020819505703924126, 'psi': 0.9963570212765397}-{'f1_val': 0.9967019684784577, 'auprc': 0.9968306963040251, 'loss_val': 0.023086013141639935, 'psi': 0.9967534596086847}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.306404 cos_to_last_merge=0.7724 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.772
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.8564963912027563, 'auprc': 0.9150815327535974, 'loss_val': 0.41956672481783286, 'psi': 0.8799304478230927}-{'f1_val': 0.920791510394487, 'auprc': 0.9219870205660509, 'loss_val': 0.2566236782459458, 'psi': 0.9212697144631126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.942598 cos_to_last_merge=0.9919 (last merge round=39)
[S7] round=98 local utility u=0.956742 metrics={'f1_val': 0.6878189027922487, 'auprc': 0.9118964633787929, 'loss_val': 0.2741608753696374, 'psi': 0.7774499270268664}-{'f1_val': 0.5434624958208127, 'auprc': 0.7811461074559416, 'loss_val': 0.9292547380728158, 'psi': 0.6385359404748643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=98 head_norm_before_train=2.474654 (no previous merge yet)
[S8] round=98 local utility u=0.001445 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9994847704493087, 'loss_val': 0.025618941398118933, 'psi': 0.9960564512240758}-{'f1_val': 0.9936253371144965, 'auprc': 0.9990676358151, 'loss_val': 0.02638356796192907, 'psi': 0.995802256594738}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=98 head_norm_before_train=1.807253 cos_to_last_merge=0.9649 (last merge round=34)
[S9] round=98 local utility u=0.001169 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984253564056568, 'loss_val': 0.019089892903284583, 'psi': 0.9971178115417942}-{'f1_val': 0.9971029125121428, 'auprc': 0.995591858267187, 'loss_val': 0.018068749432708756, 'psi': 0.9964984908141605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=98 head_norm_before_train=2.303122 cos_to_last_merge=0.9428 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=98 local utility u=0.000042 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9939280150510102, 'loss_val': 0.027392707685586094, 'psi': 0.9944310962459215}-{'f1_val': 0.9947664837091956, 'auprc': 0.9938598552714574, 'loss_val': 0.02727282320397239, 'psi': 0.9944038323341002}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=98 head_norm_before_train=1.907571 cos_to_last_merge=0.9518 (last merge round=35)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978410327344777, 'loss_val': 0.024788845140399685, 'psi': 0.9968166180417767}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975794205790413, 'loss_val': 0.02149758243068415, 'psi': 0.9969599709397703}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.008031 cos_to_last_merge=0.9792 (last merge round=39)
[S13] round=98 local utility u=0.272953 metrics={'f1_val': 0.7046228050854793, 'auprc': 0.832370972329014, 'loss_val': 0.7712284346540461, 'psi': 0.7557220719828932}-{'f1_val': 0.631394992886699, 'auprc': 0.9703643234213924, 'loss_val': 1.2917471417902306, 'psi': 0.7669827251005764}
[S13] not sending this round → trigger blocked (psi=0.756)
[S14] START round=98 head_norm_before_train=2.065095 cos_to_last_merge=0.9663 (last merge round=39)
[S14] round=98 local utility u=0.000965 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9990169603592043, 'loss_val': 0.01524814662439634, 'psi': 0.9979197053457958}-{'f1_val': 0.9970202894562089, 'auprc': 0.9990788694380698, 'loss_val': 0.01635611586134246, 'psi': 0.9978437214489533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=98 head_norm_before_train=2.259026 cos_to_last_merge=0.9500 (last merge round=41)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9615217757033376, 'auprc': 0.9973725828889061, 'loss_val': 0.10037628610230373, 'psi': 0.975862098577565}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973727351754247, 'loss_val': 0.10028452096591776, 'psi': 0.9758621594921725}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.002147 cos_to_last_merge=0.9483 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=98 local utility u=0.594042 metrics={'f1_val': 0.9318082586307975, 'auprc': 0.9871434524078568, 'loss_val': 0.19313306462472107, 'psi': 0.9539423361416213}-{'f1_val': 0.8590174367570285, 'auprc': 0.9820134600165215, 'loss_val': 0.9290813600168817, 'psi': 0.9082158460608256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=98 head_norm_before_train=1.966548 cos_to_last_merge=0.9659 (last merge round=40)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8705589171126944, 'auprc': 0.8506329760616997, 'loss_val': 0.6123662203664635, 'psi': 0.8625885406922965}-{'f1_val': 0.9036574439261822, 'auprc': 0.924531271962355, 'loss_val': 0.5210389686314871, 'psi': 0.9120069751406513}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.215067 cos_to_last_merge=0.9527 (last merge round=41)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7097995106501618, 'auprc': 0.8960195293476164, 'loss_val': 0.6390015083044951, 'psi': 0.7842875181291435}-{'f1_val': 0.709670557531711, 'auprc': 0.9288127216010434, 'loss_val': 0.6077426262145472, 'psi': 0.797327423159444}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.784 u=0.0000 p_local=0.1535 f1=0.710 auprc=0.896 bytes=71955
[S3] START round=99 head_norm_before_train=1.867690 cos_to_last_merge=0.9741 (last merge round=40)
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.8096889697443541, 'auprc': 0.9296344529414252, 'loss_val': 0.635322795256686, 'psi': 0.8576671630231825}-{'f1_val': 0.8773498496032908, 'auprc': 0.9720884670270611, 'loss_val': 0.32055593798410514, 'psi': 0.9152452965727988}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.858 u=0.0000 p_local=0.1632 f1=0.810 auprc=0.930 bytes=64777
[S4] START round=99 head_norm_before_train=2.176662 cos_to_last_merge=0.9851 (last merge round=41)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9382482820716196, 'auprc': 0.9834501617182023, 'loss_val': 0.30052500579110225, 'psi': 0.9563290339302527}-{'f1_val': 0.9438518620808715, 'auprc': 0.9811369591350242, 'loss_val': 0.29752462455633827, 'psi': 0.9587659009025327}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.956 u=0.0000 p_local=0.0266 f1=0.938 auprc=0.983 bytes=77412
[S5] START round=99 head_norm_before_train=1.865791 cos_to_last_merge=0.9505 (last merge round=38)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9618647419792978, 'auprc': 0.9916767831197685, 'loss_val': 0.06766143655927967, 'psi': 0.9737895584354861}-{'f1_val': 0.9967019684784577, 'auprc': 0.9958396004736627, 'loss_val': 0.020819505703924126, 'psi': 0.9963570212765397}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.974 u=0.0000 p_local=0.0013 f1=0.962 auprc=0.992 bytes=77478
[S6] START round=99 head_norm_before_train=2.315234 cos_to_last_merge=0.7721 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.772
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.7733401996416401, 'auprc': 0.884515253203705, 'loss_val': 0.8080678023218097, 'psi': 0.8178102210664662}-{'f1_val': 0.8564963912027563, 'auprc': 0.9150815327535974, 'loss_val': 0.41956672481783286, 'psi': 0.8799304478230927}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.818 u=0.0000 p_local=0.1890 f1=0.773 auprc=0.885 bytes=66546
[S7] START round=99 head_norm_before_train=1.947685 cos_to_last_merge=0.9916 (last merge round=39)
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.5291161768453871, 'auprc': 0.7787476460087457, 'loss_val': 1.181971929754506, 'psi': 0.6289687645107306}-{'f1_val': 0.6878189027922487, 'auprc': 0.9118964633787929, 'loss_val': 0.2741608753696374, 'psi': 0.7774499270268664}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.629 u=0.0000 p_local=0.3692 f1=0.529 auprc=0.779 bytes=73818
[S8] START round=99 head_norm_before_train=2.481812 (no previous merge yet)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9934116751513793, 'auprc': 0.9994318156230819, 'loss_val': 0.03439708589725652, 'psi': 0.9958197313400603}-{'f1_val': 0.9937709050739206, 'auprc': 0.9994847704493087, 'loss_val': 0.025618941398118933, 'psi': 0.9960564512240758}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.996 u=0.0000 p_local=0.0057 f1=0.993 auprc=0.999 bytes=68340
[S9] START round=99 head_norm_before_train=1.808909 cos_to_last_merge=0.9647 (last merge round=34)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9852543644376418, 'auprc': 0.9983903441994663, 'loss_val': 0.058327052657657155, 'psi': 0.9905087563423716}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984253564056568, 'loss_val': 0.019089892903284583, 'psi': 0.9971178115417942}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.991 u=0.0000 p_local=0.0307 f1=0.985 auprc=0.998 bytes=77375
[S10] START round=99 head_norm_before_train=2.308671 cos_to_last_merge=0.9424 (last merge round=34)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9947664837091956, 'auprc': 0.9938988018000008, 'loss_val': 0.027314928679876997, 'psi': 0.9944194109455177}-{'f1_val': 0.9947664837091956, 'auprc': 0.9939280150510102, 'loss_val': 0.027392707685586094, 'psi': 0.9944310962459215}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.994 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.994 bytes=73769
[S11] START round=99 head_norm_before_train=1.910834 cos_to_last_merge=0.9514 (last merge round=35)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.997860926860715, 'loss_val': 0.025199240371536567, 'psi': 0.9968245756922716}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978410327344777, 'loss_val': 0.024788845140399685, 'psi': 0.9968166180417767}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0085 f1=0.996 auprc=0.998 bytes=75557
[S13] START round=99 head_norm_before_train=2.008806 cos_to_last_merge=0.9793 (last merge round=39)
[S13] round=99 local utility u=0.235626 metrics={'f1_val': 0.7708906991906973, 'auprc': 0.8891511871909284, 'loss_val': 0.8679253301110956, 'psi': 0.8181948943907897}-{'f1_val': 0.7046228050854793, 'auprc': 0.832370972329014, 'loss_val': 0.7712284346540461, 'psi': 0.7557220719828932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S13] r=100 psi=0.818 u=0.2356 p_local=0.2002 f1=0.771 auprc=0.889 bytes=66646
[S14] START round=99 head_norm_before_train=2.067868 cos_to_last_merge=0.9660 (last merge round=39)
[S14] round=99 local utility u=0.001074 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990205568873246, 'loss_val': 0.014430525398681946, 'psi': 0.9980531844559652}-{'f1_val': 0.9971882020035234, 'auprc': 0.9990169603592043, 'loss_val': 0.01524814662439634, 'psi': 0.9979197053457958}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=100 psi=0.998 u=0.0011 p_local=0.0094 f1=0.997 auprc=0.999 bytes=75575
[S15] START round=99 head_norm_before_train=2.263506 cos_to_last_merge=0.9497 (last merge round=41)
[S15] ⚠️ Model drifted since last merge! cos=0.950
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.9610588691858596, 'auprc': 0.9973674125138401, 'loss_val': 0.101923403172212, 'psi': 0.9755822865170518}-{'f1_val': 0.9615217757033376, 'auprc': 0.9973725828889061, 'loss_val': 0.10037628610230373, 'psi': 0.975862098577565}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.976 u=0.0000 p_local=0.0037 f1=0.961 auprc=0.997 bytes=62996
[S16] START round=99 head_norm_before_train=2.005591 cos_to_last_merge=0.9480 (last merge round=41)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=99 local utility u=0.175216 metrics={'f1_val': 0.9738979753373262, 'auprc': 0.987249972602886, 'loss_val': 0.09555818280446801, 'psi': 0.9792387742435501}-{'f1_val': 0.9318082586307975, 'auprc': 0.9871434524078568, 'loss_val': 0.19313306462472107, 'psi': 0.9539423361416213}
[S16] not sending this round → trigger blocked (psi=0.979)
[S16] r=100 psi=0.979 u=0.1752 p_local=0.2764 f1=0.974 auprc=0.987 bytes=68445
[S17] START round=99 head_norm_before_train=1.970614 cos_to_last_merge=0.9656 (last merge round=40)
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8510793711416941, 'auprc': 0.8575883704397302, 'loss_val': 0.6651528161218773, 'psi': 0.8536829708609085}-{'f1_val': 0.8705589171126944, 'auprc': 0.8506329760616997, 'loss_val': 0.6123662203664635, 'psi': 0.8625885406922965}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.854 u=0.0000 p_local=0.1011 f1=0.851 auprc=0.858 bytes=77386
[runner] rounds complete.
[runner] all agents stopped.
