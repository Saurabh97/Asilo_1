[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:42003
[S3] → join 127.0.0.1:42002
[S4] → join 127.0.0.1:42002
[S5] → join 127.0.0.1:42002
[S6] → join 127.0.0.1:42002
[S7] → join 127.0.0.1:42002
[S8] → join 127.0.0.1:42002
[S9] → join 127.0.0.1:42002
[S10] → join 127.0.0.1:42002
[S11] → join 127.0.0.1:42002
[S13] → join 127.0.0.1:42002
[S14] → join 127.0.0.1:42002
[S15] → join 127.0.0.1:42002
[S16] → join 127.0.0.1:42002
[S17] → join 127.0.0.1:42002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.213804 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.168690 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.180311 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.148330 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.160164 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.169332 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.109817 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.160551 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.130406 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.146832 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.193773 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.216873 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.134223 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.176836 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.127223 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S8
[S4] + discovered S2
[S4] + discovered S3
[S3] + discovered S16
[S3] + discovered S4
[S3] + discovered S14
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S11
[S3] + discovered S5
[S3] + discovered S10
[S5] + discovered S2
[S5] + discovered S4
[S5] + discovered S3
[S4] + discovered S16
[S4] + discovered S14
[S4] + discovered S15
[S4] + discovered S7
[S4] + discovered S17
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S5
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S8
[S6] + discovered S3
[S6] + discovered S4
[S6] + discovered S2
[S6] + discovered S5
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S10
[S5] + discovered S9
[S5] + discovered S8
[S5] + discovered S11
[S5] + discovered S13
[S5] + discovered S17
[S5] + discovered S15
[S5] + discovered S14
[S5] + discovered S16
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S11
[S7] + discovered S14
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S7
[S7] + discovered S8
[S7] + discovered S17
[S8] + discovered S2
[S7] + discovered S11
[S7] + discovered S15
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S16
[S7] + discovered S9
[S8] + discovered S5
[S7] + discovered S13
[S8] + discovered S16
[S8] + discovered S10
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S17
[S8] + discovered S9
[S8] + discovered S13
[S8] + discovered S14
[S9] + discovered S6
[S9] + discovered S2
[S9] + discovered S5
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S4
[S10] + discovered S5
[S10] + discovered S7
[S10] + discovered S4
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S16
[S10] + discovered S8
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S11
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S2
[S10] + discovered S3
[S11] + discovered S8
[S10] + discovered S17
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S13
[S10] + discovered S16
[S11] + discovered S2
[S11] + discovered S7
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S5
[S11] + discovered S10
[S11] + discovered S9
[S11] + discovered S6
[S10] + discovered S11
[S11] + discovered S17
[S11] + discovered S14
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S9
[S11] + discovered S16
[S11] + discovered S15
[S11] + discovered S13
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S15
[S13] + discovered S16
[S14] + discovered S13
[S14] + discovered S10
[S14] + discovered S9
[S14] + discovered S11
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S15
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S14
[S15] + discovered S10
[S15] + discovered S4
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S2
[S15] + discovered S6
[S14] + discovered S17
[S15] + discovered S8
[S14] + discovered S16
[S15] + discovered S9
[S15] + discovered S7
[S16] + discovered S2
[S16] + discovered S7
[S16] + discovered S4
[S16] + discovered S8
[S16] + discovered S10
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S9
[S16] + discovered S13
[S16] + discovered S11
[S16] + discovered S3
[S16] + discovered S5
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S6
[S17] + discovered S6
[S17] + discovered S4
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S8
[S17] + discovered S9
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S10
[S17] + discovered S14
[S17] + discovered S5
[S17] + discovered S16
[S17] + discovered S7
[S17] + discovered S15
[S16] + discovered S17
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:42015
[S3] ⇄ pheromone p=1.000 → S9@127.0.0.1:42010
[S4] ⇄ pheromone p=1.000 → S8@127.0.0.1:42009
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:42016
[S9] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S10] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S15] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:42012
[S16] ⇄ pheromone p=1.000 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:42004
[S11] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S2] ⇄ pheromone p=1.000 → S13@127.0.0.1:42013
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:42014
[S17] ⇄ pheromone p=1.000 → S3@127.0.0.1:42003
[S2] START round=1 head_norm_before_train=1.219197 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7370979724097809, 'loss_val': 1.3106007190077662, 'psi': 0.3799054689970524}-{'f1_val': 0.1417771333885667, 'auprc': 0.7663791430298817, 'loss_val': 1.348111770919622, 'psi': 0.39161793724509275}
[S3] START round=1 head_norm_before_train=1.175750 (no previous merge yet)
[S3] round=1 local utility u=0.407420 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9825912715760745, 'loss_val': 1.3058081700254134, 'psi': 0.47694054799889407}-{'f1_val': 0.10474797479747974, 'auprc': 0.8009606488394079, 'loss_val': 1.3652033620604191, 'psi': 0.383233044414251}
[S4] START round=1 head_norm_before_train=1.188293 (no previous merge yet)
[S4] round=1 local utility u=0.073538 metrics={'f1_val': 0.39851818030319247, 'auprc': 0.9202826182995122, 'loss_val': 1.3135382300840945, 'psi': 0.6072239555017204}-{'f1_val': 0.3700660122939272, 'auprc': 0.9397094537224183, 'loss_val': 1.3481808537410207, 'psi': 0.5979233888653237}
[S5] START round=1 head_norm_before_train=1.173990 (no previous merge yet)
[S5] round=1 local utility u=0.338616 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.729247097169631, 'loss_val': 1.257486079279387, 'psi': 0.37705598172499527}-{'f1_val': 0.14226190476190476, 'auprc': 0.5271401828550503, 'loss_val': 1.3283971097072997, 'psi': 0.29621321599916295}
[S6] START round=1 head_norm_before_train=1.162514 (no previous merge yet)
[S6] round=1 local utility u=0.335652 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7835024125774442, 'loss_val': 1.3149315511251982, 'psi': 0.3982567342617469}-{'f1_val': 0.14142628205128205, 'auprc': 0.5694340690139484, 'loss_val': 1.3440311326612189, 'psi': 0.3126293968363486}
[S7] START round=1 head_norm_before_train=1.174290 (no previous merge yet)
[S7] round=1 local utility u=0.032815 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7773523101926927, 'loss_val': 1.2781550335510625, 'psi': 0.39617501771453206}-{'f1_val': 0.14205682272909165, 'auprc': 0.77199174445784, 'loss_val': 1.3277033202667248, 'psi': 0.394030791420591}
[S8] START round=1 head_norm_before_train=1.115815 (no previous merge yet)
[S8] round=1 local utility u=0.341063 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.5099169501069333, 'loss_val': 1.3320905514329628, 'psi': 0.2879403694785476}-{'f1_val': 0.13995598239295717, 'auprc': 0.2934112934791218, 'loss_val': 1.3646990921729034, 'psi': 0.20133810682742304}
[S9] START round=1 head_norm_before_train=1.159221 (no previous merge yet)
[S9] round=1 local utility u=0.104770 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7923190430611433, 'loss_val': 1.2760549346201588, 'psi': 0.40176639150845495}-{'f1_val': 0.141397957139996, 'auprc': 0.7466514716321156, 'loss_val': 1.3485915682561096, 'psi': 0.3834993629368439}
[S10] START round=1 head_norm_before_train=1.134057 (no previous merge yet)
[S10] round=1 local utility u=1.000000 metrics={'f1_val': 0.3880123532883504, 'auprc': 0.6385057348010079, 'loss_val': 1.3463862732742198, 'psi': 0.4882097058934134}-{'f1_val': 0.09576103667911268, 'auprc': 0.4576933796049218, 'loss_val': 1.3778516296475143, 'psi': 0.2405339738494363}
[S11] START round=1 head_norm_before_train=1.155280 (no previous merge yet)
[S11] round=1 local utility u=0.138888 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.9243818472002879, 'loss_val': 1.3074823718311286, 'psi': 0.4540009489039815}-{'f1_val': 0.14041368337311058, 'auprc': 0.8427498600803478, 'loss_val': 1.3403628568436305, 'psi': 0.4213481540560055}
[S13] START round=1 head_norm_before_train=1.191541 (no previous merge yet)
[S13] round=1 local utility u=0.311142 metrics={'f1_val': 0.38061444023464003, 'auprc': 0.7094587223805592, 'loss_val': 1.3358097527620938, 'psi': 0.5121521530930077}-{'f1_val': 0.2717716207508919, 'auprc': 0.7324367285576477, 'loss_val': 1.373971794271527, 'psi': 0.45603766387359423}
[S14] START round=1 head_norm_before_train=1.223301 (no previous merge yet)
[S14] round=1 local utility u=0.901852 metrics={'f1_val': 0.3878146585851967, 'auprc': 0.806895752215409, 'loss_val': 1.3316305214660797, 'psi': 0.5554470960372817}-{'f1_val': 0.1038107752956636, 'auprc': 0.7817988147467225, 'loss_val': 1.3560196733618848, 'psi': 0.3750059910760872}
[S15] START round=1 head_norm_before_train=1.125488 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.4649141731850705, 'auprc': 0.7806654412641498, 'loss_val': 1.368324857567947, 'psi': 0.5912146804167022}-{'f1_val': 0.054777695897813804, 'auprc': 0.7107447351137721, 'loss_val': 1.3973543063899279, 'psi': 0.3171645115841972}
[S16] START round=1 head_norm_before_train=1.180688 (no previous merge yet)
[S16] round=1 local utility u=0.023755 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7971070107119725, 'loss_val': 1.3265682308910578, 'psi': 0.403225274404311}-{'f1_val': 0.14063745019920318, 'auprc': 0.7936667701222943, 'loss_val': 1.3637567206961474, 'psi': 0.4018491781684397}
[S17] START round=1 head_norm_before_train=1.120258 (no previous merge yet)
[S17] round=1 local utility u=0.922540 metrics={'f1_val': 0.3917399912315431, 'auprc': 0.5713485087627812, 'loss_val': 1.3525250839472873, 'psi': 0.4635833982440384}-{'f1_val': 0.09718183851487364, 'auprc': 0.5558592511047353, 'loss_val': 1.3837877281531972, 'psi': 0.28065280355081834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S8] → sending delta(kind=head bytes=1783) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S4] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:42011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S7] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S8@127.0.0.1:42009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:42008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S2@127.0.0.1:42002
[S16] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1787 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S7] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1783 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1787) from S4
[S10] cosine check vs S4: cos=0.0275
[S2] RECEIVED delta(kind=head bytes=1783) from S8
[S2] cosine check vs S8: cos=0.0596
[S11] RECEIVED delta(kind=head bytes=1789) from S9
[S11] cosine check vs S9: cos=0.0307
[S9] RECEIVED delta(kind=head bytes=1787) from S14
[S9] cosine check vs S14: cos=-0.0784
[S9] DROPPED delta from S14 (cos=-0.0784 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1788) from S7
[S10] cosine check vs S7: cos=0.0303
[S7] RECEIVED delta(kind=head bytes=1792) from S15
[S7] cosine check vs S15: cos=-0.0193
[S7] DROPPED delta from S15 (cos=-0.0193 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S3
[S6] cosine check vs S3: cos=-0.0440
[S6] DROPPED delta from S3 (cos=-0.0440 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] cosine check vs S11: cos=-0.0072
[S13] DROPPED delta from S11 (cos=-0.0072 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1791) from S5
[S4] cosine check vs S5: cos=-0.1775
[S4] DROPPED delta from S5 (cos=-0.1775 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S16
[S7] cosine check vs S16: cos=-0.0891
[S7] DROPPED delta from S16 (cos=-0.0891 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S6
[S2] cosine check vs S6: cos=0.0396
[S2] RECEIVED delta(kind=head bytes=1787) from S10
[S2] cosine check vs S10: cos=0.0748
[S8] RECEIVED delta(kind=head bytes=1788) from S13
[S8] cosine check vs S13: cos=0.0005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S17] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:42015
[S17] sending update (kind=head size=1786 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1786) from S17
[S15] cosine check vs S17: cos=-0.0011
[S15] DROPPED delta from S17 (cos=-0.0011 < 0.0)
[S2] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.234790
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.696637e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1418 head_norm=0.729489 delta_norm=0.669664
[S2] aggregate: ACCEPT kept=['S8', 'S6', 'S10'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.3880 head_norm=1.146212
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.932558e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.4103 head_norm=0.721493 delta_norm=0.693256
[S10] aggregate: ACCEPT kept=['S4', 'S7'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.175327
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.235871e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.849235 delta_norm=0.823587
[S11] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.134359
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.251381e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.825545 delta_norm=0.825138
[S8] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.729489 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.080829 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7894993788585851, 'loss_val': 1.3061461303341115, 'psi': 0.40086603157657413}-{'f1_val': 0.1417771333885667, 'auprc': 0.7370979724097809, 'loss_val': 1.3106007190077662, 'psi': 0.3799054689970524}
[S3] START round=2 head_norm_before_train=1.198419 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9237675021639253, 'loss_val': 1.2406832350794361, 'psi': 0.45341104023403433}-{'f1_val': 0.13984006561410703, 'auprc': 0.9825912715760745, 'loss_val': 1.3058081700254134, 'psi': 0.47694054799889407}
[S4] START round=2 head_norm_before_train=1.206857 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14186782060641906, 'auprc': 0.777476198304491, 'loss_val': 1.2690414231425273, 'psi': 0.39611117168564786}-{'f1_val': 0.39851818030319247, 'auprc': 0.9202826182995122, 'loss_val': 1.3135382300840945, 'psi': 0.6072239555017204}
[S5] START round=2 head_norm_before_train=1.220644 (no previous merge yet)
[S5] round=2 local utility u=0.049320 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7347026363740861, 'loss_val': 1.1752136514321667, 'psi': 0.3792381974067773}-{'f1_val': 0.14226190476190476, 'auprc': 0.729247097169631, 'loss_val': 1.257486079279387, 'psi': 0.37705598172499527}
[S6] START round=2 head_norm_before_train=1.172985 (no previous merge yet)
[S6] round=2 local utility u=0.049093 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8063035854825449, 'loss_val': 1.2851485978150294, 'psi': 0.4073772034237872}-{'f1_val': 0.14142628205128205, 'auprc': 0.7835024125774442, 'loss_val': 1.3149315511251982, 'psi': 0.3982567342617469}
[S7] START round=2 head_norm_before_train=1.204083 (no previous merge yet)
[S7] round=2 local utility u=0.026434 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7775248314676158, 'loss_val': 1.2258044002054052, 'psi': 0.39624402622450133}-{'f1_val': 0.14205682272909165, 'auprc': 0.7773523101926927, 'loss_val': 1.2781550335510625, 'psi': 0.39617501771453206}
[S8] START round=2 head_norm_before_train=0.825545 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.49577947352194957, 'loss_val': 1.3286924510910736, 'psi': 0.2822853788445541}-{'f1_val': 0.13995598239295717, 'auprc': 0.5099169501069333, 'loss_val': 1.3320905514329628, 'psi': 0.2879403694785476}
[S9] START round=2 head_norm_before_train=1.190629 (no previous merge yet)
[S9] round=2 local utility u=0.158416 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8665851157588035, 'loss_val': 1.1820209090440905, 'psi': 0.431472820587519}-{'f1_val': 0.141397957139996, 'auprc': 0.7923190430611433, 'loss_val': 1.2760549346201588, 'psi': 0.40176639150845495}
[S10] START round=2 head_norm_before_train=0.721493 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6560012802077771, 'loss_val': 1.3276334161307175, 'psi': 0.34557349460814524}-{'f1_val': 0.3880123532883504, 'auprc': 0.6385057348010079, 'loss_val': 1.3463862732742198, 'psi': 0.4882097058934134}
[S11] START round=2 head_norm_before_train=0.849235 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8399392973120049, 'loss_val': 1.3025420662549103, 'psi': 0.42022392894866833}-{'f1_val': 0.14041368337311058, 'auprc': 0.9243818472002879, 'loss_val': 1.3074823718311286, 'psi': 0.4540009489039815}
[S13] START round=2 head_norm_before_train=1.199161 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7036499939883611, 'loss_val': 1.2932449070595733, 'psi': 0.3656914551415763}-{'f1_val': 0.38061444023464003, 'auprc': 0.7094587223805592, 'loss_val': 1.3358097527620938, 'psi': 0.5121521530930077}
[S14] START round=2 head_norm_before_train=1.235824 (no previous merge yet)
[S14] round=2 local utility u=0.149472 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.8798549862530263, 'loss_val': 1.3042387673807898, 'psi': 0.5898981565299678}-{'f1_val': 0.3878146585851967, 'auprc': 0.806895752215409, 'loss_val': 1.3316305214660797, 'psi': 0.5554470960372817}
[S15] START round=2 head_norm_before_train=1.129624 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7799651956695615, 'loss_val': 1.336145768974711, 'psi': 0.3958262690847596}-{'f1_val': 0.4649141731850705, 'auprc': 0.7806654412641498, 'loss_val': 1.368324857567947, 'psi': 0.5912146804167022}
[S16] START round=2 head_norm_before_train=1.195823 (no previous merge yet)
[S16] round=2 local utility u=0.023941 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7977656564060369, 'loss_val': 1.2806626686403908, 'psi': 0.40348873268193675}-{'f1_val': 0.14063745019920318, 'auprc': 0.7971070107119725, 'loss_val': 1.3265682308910578, 'psi': 0.403225274404311}
[S17] START round=2 head_norm_before_train=1.126849 (no previous merge yet)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5693504548828463, 'loss_val': 1.3189362820231094, 'psi': 0.3123095599435691}-{'f1_val': 0.3917399912315431, 'auprc': 0.5713485087627812, 'loss_val': 1.3525250839472873, 'psi': 0.4635833982440384}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.379)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.431)
[S16] not sending this round → trigger blocked (psi=0.403)
[S14] not sending this round → trigger blocked (psi=0.590)
[S7] not sending this round → trigger blocked (psi=0.396)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.407)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:42007
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1795) from S2
[S6] cosine check vs S2: cos=0.2416
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.192555
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.235935e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.778372 delta_norm=0.623594
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.753177 cos_to_last_merge=0.9948 (last merge round=1)
[S2] round=3 local utility u=0.012956 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.779102864138894, 'loss_val': 1.2490440977333521, 'psi': 0.39670742568869766}-{'f1_val': 0.1417771333885667, 'auprc': 0.7894993788585851, 'loss_val': 1.3061461303341115, 'psi': 0.40086603157657413}
[S3] START round=3 head_norm_before_train=1.236006 (no previous merge yet)
[S3] round=3 local utility u=0.105331 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9694488133517367, 'loss_val': 1.1670660810800497, 'psi': 0.47168356470915895}-{'f1_val': 0.13984006561410703, 'auprc': 0.9237675021639253, 'loss_val': 1.2406832350794361, 'psi': 0.45341104023403433}
[S4] START round=3 head_norm_before_train=1.234919 (no previous merge yet)
[S4] round=3 local utility u=0.030746 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7784439387385187, 'loss_val': 1.2006058776629565, 'psi': 0.395513552832518}-{'f1_val': 0.14186782060641906, 'auprc': 0.777476198304491, 'loss_val': 1.2690414231425273, 'psi': 0.39611117168564786}
[S5] START round=3 head_norm_before_train=1.264125 (no previous merge yet)
[S5] round=3 local utility u=0.949108 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7726051499614552, 'loss_val': 1.04484170408258, 'psi': 0.5598128745632338}-{'f1_val': 0.14226190476190476, 'auprc': 0.7347026363740861, 'loss_val': 1.1752136514321667, 'psi': 0.3792381974067773}
[S6] START round=3 head_norm_before_train=0.778372 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8026037856742151, 'loss_val': 1.2840498133625509, 'psi': 0.4058972835004553}-{'f1_val': 0.14142628205128205, 'auprc': 0.8063035854825449, 'loss_val': 1.2851485978150294, 'psi': 0.4073772034237872}
[S7] START round=3 head_norm_before_train=1.241322 (no previous merge yet)
[S7] round=3 local utility u=0.029054 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776688847225277, 'loss_val': 1.1681291511935274, 'psi': 0.39630164752646607}-{'f1_val': 0.14205682272909165, 'auprc': 0.7775248314676158, 'loss_val': 1.2258044002054052, 'psi': 0.39624402622450133}
[S8] START round=3 head_norm_before_train=0.845023 cos_to_last_merge=0.9970 (last merge round=1)
[S8] round=3 local utility u=0.263942 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6582264273323939, 'loss_val': 1.288150074487661, 'psi': 0.34726416036873187}-{'f1_val': 0.13995598239295717, 'auprc': 0.49577947352194957, 'loss_val': 1.3286924510910736, 'psi': 0.2822853788445541}
[S9] START round=3 head_norm_before_train=1.244021 (no previous merge yet)
[S9] round=3 local utility u=0.086727 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8674681312012378, 'loss_val': 1.0112163363814564, 'psi': 0.4318260267644927}-{'f1_val': 0.141397957139996, 'auprc': 0.8665851157588035, 'loss_val': 1.1820209090440905, 'psi': 0.431472820587519}
[S10] START round=3 head_norm_before_train=0.741833 cos_to_last_merge=0.9962 (last merge round=1)
[S10] round=3 local utility u=0.127730 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7301209623008723, 'loss_val': 1.2945329163647765, 'psi': 0.3752213674453833}-{'f1_val': 0.13862163754172394, 'auprc': 0.6560012802077771, 'loss_val': 1.3276334161307175, 'psi': 0.34557349460814524}
[S11] START round=3 head_norm_before_train=0.874063 cos_to_last_merge=0.9968 (last merge round=1)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6128786355034563, 'loss_val': 1.2525628103830981, 'psi': 0.3293996642252489}-{'f1_val': 0.14041368337311058, 'auprc': 0.8399392973120049, 'loss_val': 1.3025420662549103, 'psi': 0.42022392894866833}
[S13] START round=3 head_norm_before_train=1.217865 (no previous merge yet)
[S13] round=3 local utility u=0.038693 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7118857008436839, 'loss_val': 1.240565750673608, 'psi': 0.3689857378837054}-{'f1_val': 0.1403857625770531, 'auprc': 0.7036499939883611, 'loss_val': 1.2932449070595733, 'psi': 0.3656914551415763}
[S14] START round=3 head_norm_before_train=1.256264 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8733080544492837, 'loss_val': 1.2676683100838262, 'psi': 0.4335379335093358}-{'f1_val': 0.39659360338126215, 'auprc': 0.8798549862530263, 'loss_val': 1.3042387673807898, 'psi': 0.5898981565299678}
[S15] START round=3 head_norm_before_train=1.146363 (no previous merge yet)
[S15] round=3 local utility u=0.015359 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7772240629415694, 'loss_val': 1.2972035833910631, 'psi': 0.39472981599356277}-{'f1_val': 0.13973365136155833, 'auprc': 0.7799651956695615, 'loss_val': 1.336145768974711, 'psi': 0.3958262690847596}
[S16] START round=3 head_norm_before_train=1.220646 (no previous merge yet)
[S16] round=3 local utility u=0.033152 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8007306119164869, 'loss_val': 1.223254122771291, 'psi': 0.4046747148861167}-{'f1_val': 0.14063745019920318, 'auprc': 0.7977656564060369, 'loss_val': 1.2806626686403908, 'psi': 0.40348873268193675}
[S17] START round=3 head_norm_before_train=1.143011 (no previous merge yet)
[S17] round=3 local utility u=0.014146 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5640332443945135, 'loss_val': 1.274693384478446, 'psi': 0.31018267574823605}-{'f1_val': 0.14094896331738438, 'auprc': 0.5693504548828463, 'loss_val': 1.3189362820231094, 'psi': 0.3123095599435691}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:42016
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S16] → sending delta(kind=head bytes=1787) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[S2] not sending this round → trigger blocked (psi=0.397)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S15] → sending delta(kind=head bytes=1787) to S11@127.0.0.1:42012
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1787 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1787 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1794) from S13
[S4] cosine check vs S13: cos=0.0469
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=-0.1068
[S3] DROPPED delta from S10 (cos=-0.1068 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S9
[S17] cosine check vs S9: cos=-0.0337
[S17] DROPPED delta from S9 (cos=-0.0337 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1804) from S3
[S9] cosine check vs S3: cos=0.0142
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=-0.0090
[S17] DROPPED delta from S8 (cos=-0.0090 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1787) from S15
[S11] cosine check vs S15: cos=-0.0503
[S11] DROPPED delta from S15 (cos=-0.0503 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.3985
[S17] RECEIVED delta(kind=head bytes=1787) from S16
[S17] cosine check vs S16: cos=0.0613
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] cosine check vs S7: cos=0.0802
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.1069
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S17] → sending delta(kind=head bytes=1789) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1789 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1789) from S17
[S3] cosine check vs S17: cos=-0.0846
[S3] DROPPED delta from S17 (cos=-0.0846 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.285494
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.654377e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.937863 delta_norm=0.865438
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.252881
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.515222e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.947888 delta_norm=0.851522
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=0.768943
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.977474e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.864269 delta_norm=0.597747
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.271712
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.691278e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.3979 head_norm=0.910896 delta_norm=0.869128
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=1.292621
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.977708e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.910582 delta_norm=0.897771
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=3 metric=0.1409 head_norm=1.167821
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.297916e-01
[S17] stored merged vector for next round verification (round=3)
[S17] DEBUG after merge:  round=3 metric=0.1409 head_norm=0.882159 delta_norm=0.829792
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.786710 cos_to_last_merge=0.9821 (last merge round=1)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7529724291057531, 'loss_val': 1.1889235299583731, 'psi': 0.38625525167544134}-{'f1_val': 0.1417771333885667, 'auprc': 0.779102864138894, 'loss_val': 1.2490440977333521, 'psi': 0.39670742568869766}
[S3] START round=4 head_norm_before_train=1.264689 (no previous merge yet)
[S3] round=4 local utility u=0.421918 metrics={'f1_val': 0.24316106083434685, 'auprc': 0.9846872367949274, 'loss_val': 0.9888708457428013, 'psi': 0.5397715312185791}-{'f1_val': 0.13984006561410703, 'auprc': 0.9694488133517367, 'loss_val': 1.1670660810800497, 'psi': 0.47168356470915895}
[S4] START round=4 head_norm_before_train=0.910896 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.012225 metrics={'f1_val': 0.14077475962721864, 'auprc': 0.777902623046461, 'loss_val': 1.1778211169759594, 'psi': 0.39562590499491557}-{'f1_val': 0.14022662889518414, 'auprc': 0.7784439387385187, 'loss_val': 1.2006058776629565, 'psi': 0.395513552832518}
[S5] START round=4 head_norm_before_train=1.295165 (no previous merge yet)
[S5] round=4 local utility u=0.114082 metrics={'f1_val': 0.41778804395810054, 'auprc': 0.781346697321208, 'loss_val': 0.8419233748212309, 'psi': 0.5632115053033435}-{'f1_val': 0.41795135763108626, 'auprc': 0.7726051499614552, 'loss_val': 1.04484170408258, 'psi': 0.5598128745632338}
[S6] START round=4 head_norm_before_train=0.805734 cos_to_last_merge=0.9969 (last merge round=2)
[S6] round=4 local utility u=0.024348 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.803647123968007, 'loss_val': 1.2384841131473938, 'psi': 0.40631461881797204}-{'f1_val': 0.14142628205128205, 'auprc': 0.8026037856742151, 'loss_val': 1.2840498133625509, 'psi': 0.4058972835004553}
[S7] START round=4 head_norm_before_train=1.266746 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.6862494866900057, 'auprc': 0.7772687210226744, 'loss_val': 1.0466181780052461, 'psi': 0.7226571804230733}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776688847225277, 'loss_val': 1.1681291511935274, 'psi': 0.39630164752646607}
[S8] START round=4 head_norm_before_train=0.875824 cos_to_last_merge=0.9890 (last merge round=1)
[S8] round=4 local utility u=0.050640 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6751703120276917, 'loss_val': 1.237702289897799, 'psi': 0.35404171424685105}-{'f1_val': 0.13995598239295717, 'auprc': 0.6582264273323939, 'loss_val': 1.288150074487661, 'psi': 0.34726416036873187}
[S9] START round=4 head_norm_before_train=0.910582 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.664421 metrics={'f1_val': 0.41596643747099904, 'auprc': 0.7158957665151968, 'loss_val': 0.8750688588472486, 'psi': 0.5359381690886782}-{'f1_val': 0.141397957139996, 'auprc': 0.8674681312012378, 'loss_val': 1.0112163363814564, 'psi': 0.4318260267644927}
[S10] START round=4 head_norm_before_train=0.864269 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.078392 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7762507140542042, 'loss_val': 1.276138818684004, 'psi': 0.39367326814671605}-{'f1_val': 0.13862163754172394, 'auprc': 0.7301209623008723, 'loss_val': 1.2945329163647765, 'psi': 0.3752213674453833}
[S11] START round=4 head_norm_before_train=0.908052 cos_to_last_merge=0.9890 (last merge round=1)
[S11] round=4 local utility u=0.011978 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6015772771962292, 'loss_val': 1.1947018429447656, 'psi': 0.32487912090235804}-{'f1_val': 0.14041368337311058, 'auprc': 0.6128786355034563, 'loss_val': 1.2525628103830981, 'psi': 0.3293996642252489}
[S13] START round=4 head_norm_before_train=1.246184 (no previous merge yet)
[S13] round=4 local utility u=0.050895 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7235287953204024, 'loss_val': 1.1737046151888457, 'psi': 0.3736429756743928}-{'f1_val': 0.1403857625770531, 'auprc': 0.7118857008436839, 'loss_val': 1.240565750673608, 'psi': 0.3689857378837054}
[S14] START round=4 head_norm_before_train=0.937863 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8471785877558529, 'loss_val': 1.2684419493086547, 'psi': 0.42308614683196344}-{'f1_val': 0.14035785288270378, 'auprc': 0.8733080544492837, 'loss_val': 1.2676683100838262, 'psi': 0.4335379335093358}
[S15] START round=4 head_norm_before_train=1.172669 (no previous merge yet)
[S15] round=4 local utility u=0.023474 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7765996407149741, 'loss_val': 1.248383067506966, 'psi': 0.39448004710292467}-{'f1_val': 0.13973365136155833, 'auprc': 0.7772240629415694, 'loss_val': 1.2972035833910631, 'psi': 0.39472981599356277}
[S16] START round=4 head_norm_before_train=0.947888 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6591412805347199, 'loss_val': 1.206241073009094, 'psi': 0.3480389823334099}-{'f1_val': 0.14063745019920318, 'auprc': 0.8007306119164869, 'loss_val': 1.223254122771291, 'psi': 0.4046747148861167}
[S17] START round=4 head_norm_before_train=0.882159 cos_to_last_merge=1.0000 (last merge round=3)
[S17] round=4 local utility u=0.004512 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5617312796969511, 'loss_val': 1.2587633941996468, 'psi': 0.3092618898692111}-{'f1_val': 0.14094896331738438, 'auprc': 0.5640332443945135, 'loss_val': 1.274693384478446, 'psi': 0.31018267574823605}
[S3] not sending this round → trigger blocked (psi=0.540)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:42012
[S8] not sending this round → trigger blocked (psi=0.354)
[S7] not sending this round → trigger blocked (psi=0.723)
[S15] not sending this round → trigger blocked (psi=0.394)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S5] not sending this round → trigger blocked (psi=0.563)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.536)
[S13] not sending this round → trigger blocked (psi=0.374)
[S4] not sending this round → trigger blocked (psi=0.396)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0797
[S13] DROPPED delta from S11 (cos=-0.0797 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1793) from S6
[S11] cosine check vs S6: cos=0.0012
[S17] not sending this round → trigger blocked (psi=0.309)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.950687
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.356906e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.636451 delta_norm=0.635691
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.824526 cos_to_last_merge=0.9671 (last merge round=1)
[S2] round=5 local utility u=0.042825 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7606486926363168, 'loss_val': 1.126302765292528, 'psi': 0.3893257570876668}-{'f1_val': 0.1417771333885667, 'auprc': 0.7529724291057531, 'loss_val': 1.1889235299583731, 'psi': 0.38625525167544134}
[S3] START round=5 head_norm_before_train=1.321505 (no previous merge yet)
[S3] round=5 local utility u=0.277332 metrics={'f1_val': 0.39314335298265274, 'auprc': 0.8269912626204237, 'loss_val': 0.8610124289721904, 'psi': 0.5666825168377612}-{'f1_val': 0.24316106083434685, 'auprc': 0.9846872367949274, 'loss_val': 0.9888708457428013, 'psi': 0.5397715312185791}
[S4] START round=5 head_norm_before_train=0.951045 cos_to_last_merge=0.9969 (last merge round=3)
[S4] round=5 local utility u=1.000000 metrics={'f1_val': 0.5960726158126339, 'auprc': 0.7739267240025393, 'loss_val': 1.0189356680081565, 'psi': 0.6672142590885961}-{'f1_val': 0.14077475962721864, 'auprc': 0.777902623046461, 'loss_val': 1.1778211169759594, 'psi': 0.39562590499491557}
[S5] START round=5 head_norm_before_train=1.351564 (no previous merge yet)
[S5] round=5 local utility u=0.344863 metrics={'f1_val': 0.41770670426636225, 'auprc': 0.9767185850674731, 'loss_val': 0.7378247464625018, 'psi': 0.6413114565868065}-{'f1_val': 0.41778804395810054, 'auprc': 0.781346697321208, 'loss_val': 0.8419233748212309, 'psi': 0.5632115053033435}
[S6] START round=5 head_norm_before_train=0.845304 cos_to_last_merge=0.9885 (last merge round=2)
[S6] round=5 local utility u=0.004502 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7890243929879169, 'loss_val': 1.1856111662152875, 'psi': 0.400465526425936}-{'f1_val': 0.14142628205128205, 'auprc': 0.803647123968007, 'loss_val': 1.2384841131473938, 'psi': 0.40631461881797204}
[S7] START round=5 head_norm_before_train=1.312501 (no previous merge yet)
[S7] round=5 local utility u=0.221675 metrics={'f1_val': 0.7142519351135562, 'auprc': 0.7940852820866537, 'loss_val': 0.8217332214646542, 'psi': 0.7461852739027952}-{'f1_val': 0.6862494866900057, 'auprc': 0.7772687210226744, 'loss_val': 1.0466181780052461, 'psi': 0.7226571804230733}
[S8] START round=5 head_norm_before_train=0.913948 cos_to_last_merge=0.9777 (last merge round=1)
[S8] round=5 local utility u=0.602279 metrics={'f1_val': 0.2912755337085322, 'auprc': 0.7572474611857105, 'loss_val': 1.1872935154305988, 'psi': 0.4776643046994035}-{'f1_val': 0.13995598239295717, 'auprc': 0.6751703120276917, 'loss_val': 1.237702289897799, 'psi': 0.35404171424685105}
[S9] START round=5 head_norm_before_train=0.980622 cos_to_last_merge=0.9928 (last merge round=3)
[S9] round=5 local utility u=1.000000 metrics={'f1_val': 0.701513881536201, 'auprc': 0.9995831753296558, 'loss_val': 0.5843742182389821, 'psi': 0.8207415990535829}-{'f1_val': 0.41596643747099904, 'auprc': 0.7158957665151968, 'loss_val': 0.8750688588472486, 'psi': 0.5359381690886782}
[S10] START round=5 head_norm_before_train=0.882283 cos_to_last_merge=0.9976 (last merge round=3)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7462717366615788, 'loss_val': 1.2281288835439466, 'psi': 0.3816816771896659}-{'f1_val': 0.13862163754172394, 'auprc': 0.7762507140542042, 'loss_val': 1.276138818684004, 'psi': 0.39367326814671605}
[S11] START round=5 head_norm_before_train=0.636451 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5985668740938999, 'loss_val': 1.1985173281465902, 'psi': 0.3236749596614263}-{'f1_val': 0.14041368337311058, 'auprc': 0.6015772771962292, 'loss_val': 1.1947018429447656, 'psi': 0.32487912090235804}
[S13] START round=5 head_norm_before_train=1.278371 (no previous merge yet)
[S13] round=5 local utility u=0.877319 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.7292725269940559, 'loss_val': 1.093285022826733, 'psi': 0.5416392162450627}-{'f1_val': 0.1403857625770531, 'auprc': 0.7235287953204024, 'loss_val': 1.1737046151888457, 'psi': 0.3736429756743928}
[S14] START round=5 head_norm_before_train=0.966446 cos_to_last_merge=0.9973 (last merge round=3)
[S14] round=5 local utility u=0.000421 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8239985899369578, 'loss_val': 1.1980601576042815, 'psi': 0.4138141477044054}-{'f1_val': 0.14035785288270378, 'auprc': 0.8471785877558529, 'loss_val': 1.2684419493086547, 'psi': 0.42308614683196344}
[S15] START round=5 head_norm_before_train=1.207349 (no previous merge yet)
[S15] round=5 local utility u=0.022455 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7768742449549391, 'loss_val': 1.2042962220140234, 'psi': 0.39458988879891066}-{'f1_val': 0.13973365136155833, 'auprc': 0.7765996407149741, 'loss_val': 1.248383067506966, 'psi': 0.39448004710292467}
[S16] START round=5 head_norm_before_train=0.976902 cos_to_last_merge=0.9978 (last merge round=3)
[S16] round=5 local utility u=0.762932 metrics={'f1_val': 0.4138892987575528, 'auprc': 0.5878095793392003, 'loss_val': 1.1058936813503086, 'psi': 0.4834574109902118}-{'f1_val': 0.14063745019920318, 'auprc': 0.6591412805347199, 'loss_val': 1.206241073009094, 'psi': 0.3480389823334099}
[S17] START round=5 head_norm_before_train=0.911321 cos_to_last_merge=0.9973 (last merge round=3)
[S17] round=5 local utility u=0.032433 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5568825083652109, 'loss_val': 1.1793514897260942, 'psi': 0.307322381336515}-{'f1_val': 0.14094896331738438, 'auprc': 0.5617312796969511, 'loss_val': 1.2587633941996468, 'psi': 0.3092618898692111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:42004
[S6] not sending this round → trigger blocked (psi=0.400)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:42011
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:42013
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[S7] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.6861
[S4] RECEIVED delta(kind=head bytes=1790) from S13
[S4] cosine check vs S13: cos=0.6620
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.6148
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.5691
[S11] RECEIVED delta(kind=head bytes=1790) from S15
[S11] cosine check vs S15: cos=-0.0671
[S11] DROPPED delta from S15 (cos=-0.0671 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] cosine check vs S8: cos=-0.0383
[S17] DROPPED delta from S8 (cos=-0.0383 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1798) from S9
[S17] cosine check vs S9: cos=-0.1194
[S17] DROPPED delta from S9 (cos=-0.1194 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.6607
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.7122
[S13] RECEIVED delta(kind=head bytes=1795) from S2
[S13] cosine check vs S2: cos=-0.0370
[S13] DROPPED delta from S2 (cos=-0.0370 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=-0.0146
[S15] DROPPED delta from S14 (cos=-0.0146 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1794 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1794) from S17
[S3] cosine check vs S17: cos=-0.0724
[S3] DROPPED delta from S17 (cos=-0.0724 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.906938
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.950287e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=0.869156 delta_norm=0.395029
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.438 → S3@127.0.0.1:42003
[S6] ⇄ pheromone p=0.365 → S11@127.0.0.1:42012
[S11] ⇄ pheromone p=0.341 → S13@127.0.0.1:42013
[S15] ⇄ pheromone p=0.420 → S11@127.0.0.1:42012
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.5961 head_norm=1.000211
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.945441e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6484 head_norm=1.053617 delta_norm=0.494544
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.540 → S10@127.0.0.1:42011
[S3] ⇄ pheromone p=0.498 → S9@127.0.0.1:42010
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7015 head_norm=1.073505
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.562006e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7008 head_norm=1.105108 delta_norm=0.556201
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.670 → S17@127.0.0.1:42017
[S13] ⇄ pheromone p=0.542 → S4@127.0.0.1:42004
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=1.000919
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.967002e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.087340 delta_norm=0.496700
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.417 → S15@127.0.0.1:42015
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4139 head_norm=1.014736
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.952907e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4149 head_norm=1.124801 delta_norm=0.495291
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.489 → S17@127.0.0.1:42017
[S8] ⇄ pheromone p=0.518 → S17@127.0.0.1:42017
[S7] ⇄ pheromone p=0.541 → S14@127.0.0.1:42014
[S5] ⇄ pheromone p=0.569 → S16@127.0.0.1:42016
[S2] ⇄ pheromone p=0.346 → S13@127.0.0.1:42013
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=5 metric=0.1409 head_norm=0.947759
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.564016e-01
[S17] stored merged vector for next round verification (round=5)
[S17] DEBUG after merge:  round=5 metric=0.1409 head_norm=0.869290 delta_norm=0.456402
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.412 → S3@127.0.0.1:42003
[S2] START round=6 head_norm_before_train=0.865016 cos_to_last_merge=0.9521 (last merge round=1)
[S2] round=6 local utility u=0.892359 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.7763837607998627, 'loss_val': 1.0359583570279964, 'psi': 0.5603366873730126}-{'f1_val': 0.1417771333885667, 'auprc': 0.7606486926363168, 'loss_val': 1.126302765292528, 'psi': 0.3893257570876668}
[S3] START round=6 head_norm_before_train=1.381606 (no previous merge yet)
[S3] round=6 local utility u=0.174529 metrics={'f1_val': 0.48483029670249556, 'auprc': 0.7431678765724167, 'loss_val': 0.8106057872999523, 'psi': 0.588165328650464}-{'f1_val': 0.39314335298265274, 'auprc': 0.8269912626204237, 'loss_val': 0.8610124289721904, 'psi': 0.5666825168377612}
[S4] START round=6 head_norm_before_train=1.053617 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.068920 metrics={'f1_val': 0.6735946025815178, 'auprc': 0.6388390239435201, 'loss_val': 0.9409638317057308, 'psi': 0.6596923711263187}-{'f1_val': 0.5960726158126339, 'auprc': 0.7739267240025393, 'loss_val': 1.0189356680081565, 'psi': 0.6672142590885961}
[S5] START round=6 head_norm_before_train=1.411130 (no previous merge yet)
[S5] round=6 local utility u=0.413642 metrics={'f1_val': 0.5919601533739085, 'auprc': 0.861442200428387, 'loss_val': 0.6102330286684334, 'psi': 0.6997529721956999}-{'f1_val': 0.41770670426636225, 'auprc': 0.9767185850674731, 'loss_val': 0.7378247464625018, 'psi': 0.6413114565868065}
[S6] START round=6 head_norm_before_train=0.890621 cos_to_last_merge=0.9773 (last merge round=2)
[S6] round=6 local utility u=0.802490 metrics={'f1_val': 0.41524424617876, 'auprc': 0.7421509693720867, 'loss_val': 1.0829186364804853, 'psi': 0.5460069354560906}-{'f1_val': 0.14142628205128205, 'auprc': 0.7890243929879169, 'loss_val': 1.1856111662152875, 'psi': 0.400465526425936}
[S7] START round=6 head_norm_before_train=1.362425 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.5725923191859801, 'auprc': 0.7921331974079225, 'loss_val': 0.7413470433923398, 'psi': 0.6604086704747572}-{'f1_val': 0.7142519351135562, 'auprc': 0.7940852820866537, 'loss_val': 0.8217332214646542, 'psi': 0.7461852739027952}
[S8] START round=6 head_norm_before_train=0.946913 cos_to_last_merge=0.9677 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7153201919565738, 'auprc': 0.7686671578750613, 'loss_val': 1.0985254319663909, 'psi': 0.7366589783239689}-{'f1_val': 0.2912755337085322, 'auprc': 0.7572474611857105, 'loss_val': 1.1872935154305988, 'psi': 0.4776643046994035}
[S9] START round=6 head_norm_before_train=1.105108 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.066381 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9993409508587751, 'loss_val': 0.44954456409686416, 'psi': 0.820510670468048}-{'f1_val': 0.701513881536201, 'auprc': 0.9995831753296558, 'loss_val': 0.5843742182389821, 'psi': 0.8207415990535829}
[S10] START round=6 head_norm_before_train=0.869156 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6798331186821781, 'loss_val': 1.187745017910024, 'psi': 0.3551062299979056}-{'f1_val': 0.13862163754172394, 'auprc': 0.7462717366615788, 'loss_val': 1.2281288835439466, 'psi': 0.3816816771896659}
[S11] START round=6 head_norm_before_train=0.674746 cos_to_last_merge=0.9940 (last merge round=4)
[S11] round=6 local utility u=0.848621 metrics={'f1_val': 0.40178803242195693, 'auprc': 0.6005900408974079, 'loss_val': 1.07559187628693, 'psi': 0.48130883581213735}-{'f1_val': 0.14041368337311058, 'auprc': 0.5985668740938999, 'loss_val': 1.1985173281465902, 'psi': 0.3236749596614263}
[S13] START round=6 head_norm_before_train=1.307266 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.371846974807442, 'auprc': 0.7467048803531415, 'loss_val': 0.9669776074626288, 'psi': 0.5217901370257219}-{'f1_val': 0.41655034241240063, 'auprc': 0.7292725269940559, 'loss_val': 1.093285022826733, 'psi': 0.5416392162450627}
[S14] START round=6 head_norm_before_train=1.087340 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.093288 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8654949666652394, 'loss_val': 1.135972665057764, 'psi': 0.43041269839571805}-{'f1_val': 0.14035785288270378, 'auprc': 0.8239985899369578, 'loss_val': 1.1980601576042815, 'psi': 0.4138141477044054}
[S15] START round=6 head_norm_before_train=1.244043 (no previous merge yet)
[S15] round=6 local utility u=0.865496 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7765126855587174, 'loss_val': 1.1297683177790558, 'psi': 0.5602000791104627}-{'f1_val': 0.13973365136155833, 'auprc': 0.7768742449549391, 'loss_val': 1.2042962220140234, 'psi': 0.39458988879891066}
[S16] START round=6 head_norm_before_train=1.124801 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.055606 metrics={'f1_val': 0.4170779150236796, 'auprc': 0.5793211196971589, 'loss_val': 0.9883485173882344, 'psi': 0.48197519689307133}-{'f1_val': 0.4138892987575528, 'auprc': 0.5878095793392003, 'loss_val': 1.1058936813503086, 'psi': 0.4834574109902118}
[S17] START round=6 head_norm_before_train=0.869290 cos_to_last_merge=1.0000 (last merge round=5)
[S17] round=6 local utility u=0.868905 metrics={'f1_val': 0.41624555125281304, 'auprc': 0.5776880968551577, 'loss_val': 1.1557367947044612, 'psi': 0.4808225694937509}-{'f1_val': 0.14094896331738438, 'auprc': 0.5568825083652109, 'loss_val': 1.1793514897260942, 'psi': 0.307322381336515}
[S4] not sending this round → trigger blocked (psi=0.660)
[S2] not sending this round → trigger blocked (psi=0.560)
[S15] not sending this round → trigger blocked (psi=0.560)
[S3] not sending this round → trigger blocked (psi=0.588)
[S8] not sending this round → trigger blocked (psi=0.737)
[S9] not sending this round → trigger blocked (psi=0.821)
[S16] not sending this round → trigger blocked (psi=0.482)
[S5] not sending this round → trigger blocked (psi=0.700)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:42012
[S14] not sending this round → trigger blocked (psi=0.430)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=-0.0803
[S13] DROPPED delta from S11 (cos=-0.0803 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S6
[S11] cosine check vs S6: cos=0.5648
[S17] not sending this round → trigger blocked (psi=0.481)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.4018 head_norm=0.719758
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.987701e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.735251 delta_norm=0.398770
[S11] aggregate: ROLLBACK (f1_val pre=0.402 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.898997 cos_to_last_merge=0.9405 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.941
[S2] round=7 local utility u=0.432840 metrics={'f1_val': 0.5392027501954846, 'auprc': 0.7763792645548557, 'loss_val': 0.9076499797693636, 'psi': 0.6340733559392331}-{'f1_val': 0.41630530508844577, 'auprc': 0.7763837607998627, 'loss_val': 1.0359583570279964, 'psi': 0.5603366873730126}
[S3] START round=7 head_norm_before_train=1.450357 (no previous merge yet)
[S3] round=7 local utility u=0.000000 metrics={'f1_val': 0.4290695214608258, 'auprc': 0.6887232119084656, 'loss_val': 0.9369176569076885, 'psi': 0.5329309976398817}-{'f1_val': 0.48483029670249556, 'auprc': 0.7431678765724167, 'loss_val': 0.8106057872999523, 'psi': 0.588165328650464}
[S4] START round=7 head_norm_before_train=1.091163 cos_to_last_merge=0.9965 (last merge round=5)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3850254275975054, 'auprc': 0.6539377028734618, 'loss_val': 0.8197445163303348, 'psi': 0.49259033770788796}-{'f1_val': 0.6735946025815178, 'auprc': 0.6388390239435201, 'loss_val': 0.9409638317057308, 'psi': 0.6596923711263187}
[S5] START round=7 head_norm_before_train=1.468588 (no previous merge yet)
[S5] round=7 local utility u=0.411330 metrics={'f1_val': 0.7010650608352189, 'auprc': 0.8613037788682248, 'loss_val': 0.4417873960200243, 'psi': 0.7651605480484213}-{'f1_val': 0.5919601533739085, 'auprc': 0.861442200428387, 'loss_val': 0.6102330286684334, 'psi': 0.6997529721956999}
[S6] START round=7 head_norm_before_train=0.938707 cos_to_last_merge=0.9649 (last merge round=2)
[S6] round=7 local utility u=0.182462 metrics={'f1_val': 0.41745618053540323, 'auprc': 0.7973913402879689, 'loss_val': 0.8969881945950346, 'psi': 0.5694302444364295}-{'f1_val': 0.41524424617876, 'auprc': 0.7421509693720867, 'loss_val': 1.0829186364804853, 'psi': 0.5460069354560906}
[S7] START round=7 head_norm_before_train=1.425614 (no previous merge yet)
[S7] round=7 local utility u=0.215860 metrics={'f1_val': 0.6249185337300198, 'auprc': 0.7959550799332826, 'loss_val': 0.6350500927451261, 'psi': 0.6933331522113249}-{'f1_val': 0.5725923191859801, 'auprc': 0.7921331974079225, 'loss_val': 0.7413470433923398, 'psi': 0.6604086704747572}
[S8] START round=7 head_norm_before_train=0.975581 cos_to_last_merge=0.9595 (last merge round=1)
[S8] round=7 local utility u=0.000000 metrics={'f1_val': 0.37306606018310795, 'auprc': 0.776507805834525, 'loss_val': 0.9648506739345224, 'psi': 0.5344427584436747}-{'f1_val': 0.7153201919565738, 'auprc': 0.7686671578750613, 'loss_val': 1.0985254319663909, 'psi': 0.7366589783239689}
[S9] START round=7 head_norm_before_train=1.183831 cos_to_last_merge=0.9904 (last merge round=5)
[S9] round=7 local utility u=0.076469 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982072939834199, 'loss_val': 0.292762649398979, 'psi': 0.8200128660573791}-{'f1_val': 0.7012904835408967, 'auprc': 0.9993409508587751, 'loss_val': 0.44954456409686416, 'psi': 0.820510670468048}
[S10] START round=7 head_norm_before_train=0.891317 cos_to_last_merge=0.9973 (last merge round=5)
[S10] round=7 local utility u=0.872587 metrics={'f1_val': 0.41670936461107344, 'auprc': 0.6659539548844123, 'loss_val': 1.0694589061677249, 'psi': 0.516407200720409}-{'f1_val': 0.13862163754172394, 'auprc': 0.6798331186821781, 'loss_val': 1.187745017910024, 'psi': 0.3551062299979056}
[S11] START round=7 head_norm_before_train=0.735251 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.341251 metrics={'f1_val': 0.41567515922599385, 'auprc': 0.7968147185930907, 'loss_val': 1.0650861718644276, 'psi': 0.5681309829728326}-{'f1_val': 0.40178803242195693, 'auprc': 0.6005900408974079, 'loss_val': 1.07559187628693, 'psi': 0.48130883581213735}
[S13] START round=7 head_norm_before_train=1.348290 (no previous merge yet)
[S13] round=7 local utility u=0.389372 metrics={'f1_val': 0.4677145453913564, 'auprc': 0.7579031580749293, 'loss_val': 0.7970336147947841, 'psi': 0.5837899904647855}-{'f1_val': 0.371846974807442, 'auprc': 0.7467048803531415, 'loss_val': 0.9669776074626288, 'psi': 0.5217901370257219}
[S14] START round=7 head_norm_before_train=1.113507 cos_to_last_merge=0.9979 (last merge round=5)
[S14] round=7 local utility u=0.997943 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9621397919701402, 'loss_val': 0.9674347910163948, 'psi': 0.6228120788168133}-{'f1_val': 0.14035785288270378, 'auprc': 0.8654949666652394, 'loss_val': 1.135972665057764, 'psi': 0.43041269839571805}
[S15] START round=7 head_norm_before_train=1.270774 (no previous merge yet)
[S15] round=7 local utility u=0.064147 metrics={'f1_val': 0.4167674234858094, 'auprc': 0.7781245059360693, 'loss_val': 1.0109635537618997, 'psi': 0.5613102564659134}-{'f1_val': 0.41599167481162613, 'auprc': 0.7765126855587174, 'loss_val': 1.1297683177790558, 'psi': 0.5602000791104627}
[S16] START round=7 head_norm_before_train=1.154223 cos_to_last_merge=0.9977 (last merge round=5)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.38591558338563875, 'auprc': 0.5583823437335101, 'loss_val': 0.8631903150604764, 'psi': 0.45490228752478734}-{'f1_val': 0.4170779150236796, 'auprc': 0.5793211196971589, 'loss_val': 0.9883485173882344, 'psi': 0.48197519689307133}
[S17] START round=7 head_norm_before_train=0.893957 cos_to_last_merge=0.9968 (last merge round=5)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.34941276698181656, 'auprc': 0.5909665012647782, 'loss_val': 0.9684587350708963, 'psi': 0.44603426069500124}-{'f1_val': 0.41624555125281304, 'auprc': 0.5776880968551577, 'loss_val': 1.1557367947044612, 'psi': 0.4808225694937509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S10] → sending delta(kind=head bytes=1786) to S3@127.0.0.1:42003
[S11] not sending this round → trigger blocked (psi=0.568)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:42015
[S6] not sending this round → trigger blocked (psi=0.569)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:42004
[S2] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S15
[S11] cosine check vs S15: cos=-0.0566
[S11] DROPPED delta from S15 (cos=-0.0566 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=-0.0572
[S13] DROPPED delta from S2 (cos=-0.0572 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9075
[S3] RECEIVED delta(kind=head bytes=1786) from S10
[S3] cosine check vs S10: cos=-0.0672
[S3] DROPPED delta from S10 (cos=-0.0672 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S9
[S17] cosine check vs S9: cos=-0.0819
[S17] DROPPED delta from S9 (cos=-0.0819 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S13
[S4] cosine check vs S13: cos=0.8785
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=-0.0182
[S15] DROPPED delta from S14 (cos=-0.0182 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.8895
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3850 head_norm=1.139621
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.368540e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6650 head_norm=1.229957 delta_norm=0.336854
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=1.151645
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.463719e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.7006 head_norm=1.277099 delta_norm=0.346372
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3859 head_norm=1.195452
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.324895e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3865 head_norm=1.326887 delta_norm=0.332489
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.948850 cos_to_last_merge=0.9243 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.924
[S2] round=8 local utility u=0.613383 metrics={'f1_val': 0.7139440215062263, 'auprc': 0.7783371964928608, 'loss_val': 0.7352058180710273, 'psi': 0.73970129150088}-{'f1_val': 0.5392027501954846, 'auprc': 0.7763792645548557, 'loss_val': 0.9076499797693636, 'psi': 0.6340733559392331}
[S3] START round=8 head_norm_before_train=1.512096 (no previous merge yet)
[S3] round=8 local utility u=0.399769 metrics={'f1_val': 0.4811610453361981, 'auprc': 0.7852050648600577, 'loss_val': 0.7393745568942182, 'psi': 0.602778653145742}-{'f1_val': 0.4290695214608258, 'auprc': 0.6887232119084656, 'loss_val': 0.9369176569076885, 'psi': 0.5329309976398817}
[S4] START round=8 head_norm_before_train=1.229957 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.3755966813476201, 'auprc': 0.6537496201210873, 'loss_val': 0.8071835828639425, 'psi': 0.48685785685700694}-{'f1_val': 0.3850254275975054, 'auprc': 0.6539377028734618, 'loss_val': 0.8197445163303348, 'psi': 0.49259033770788796}
[S5] START round=8 head_norm_before_train=1.520938 (no previous merge yet)
[S5] round=8 local utility u=0.237036 metrics={'f1_val': 0.7008586083484586, 'auprc': 0.9901772412847836, 'loss_val': 0.35309737136126107, 'psi': 0.8165860615229886}-{'f1_val': 0.7010650608352189, 'auprc': 0.8613037788682248, 'loss_val': 0.4417873960200243, 'psi': 0.7651605480484213}
[S6] START round=8 head_norm_before_train=0.979036 cos_to_last_merge=0.9520 (last merge round=2)
[S6] round=8 local utility u=0.042201 metrics={'f1_val': 0.4172560359570804, 'auprc': 0.7922844731259515, 'loss_val': 0.7960647407552995, 'psi': 0.5672674108246288}-{'f1_val': 0.41745618053540323, 'auprc': 0.7973913402879689, 'loss_val': 0.8969881945950346, 'psi': 0.5694302444364295}
[S7] START round=8 head_norm_before_train=1.475000 (no previous merge yet)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.5661771666874711, 'auprc': 0.7847500327441472, 'loss_val': 0.7255828533153719, 'psi': 0.6536063131101415}-{'f1_val': 0.6249185337300198, 'auprc': 0.7959550799332826, 'loss_val': 0.6350500927451261, 'psi': 0.6933331522113249}
[S8] START round=8 head_norm_before_train=1.008297 cos_to_last_merge=0.9505 (last merge round=1)
[S8] round=8 local utility u=0.380588 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.9920674982575088, 'loss_val': 0.8503853994322613, 'psi': 0.6206698085709299}-{'f1_val': 0.37306606018310795, 'auprc': 0.776507805834525, 'loss_val': 0.9648506739345224, 'psi': 0.5344427584436747}
[S9] START round=8 head_norm_before_train=1.283987 cos_to_last_merge=0.9698 (last merge round=5)
[S9] round=8 local utility u=0.050140 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9980401646395886, 'loss_val': 0.19198158535969903, 'psi': 0.8199460143198466}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982072939834199, 'loss_val': 0.292762649398979, 'psi': 0.8200128660573791}
[S10] START round=8 head_norm_before_train=0.921453 cos_to_last_merge=0.9894 (last merge round=5)
[S10] round=8 local utility u=0.097786 metrics={'f1_val': 0.42327429281069157, 'auprc': 0.6651426962065928, 'loss_val': 0.9108425456144175, 'psi': 0.5200216541690521}-{'f1_val': 0.41670936461107344, 'auprc': 0.6659539548844123, 'loss_val': 1.0694589061677249, 'psi': 0.516407200720409}
[S11] START round=8 head_norm_before_train=0.763367 cos_to_last_merge=0.9938 (last merge round=6)
[S11] round=8 local utility u=0.280591 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9639466104605755, 'loss_val': 0.8903603474447542, 'psi': 0.6234897768297298}-{'f1_val': 0.41567515922599385, 'auprc': 0.7968147185930907, 'loss_val': 1.0650861718644276, 'psi': 0.5681309829728326}
[S13] START round=8 head_norm_before_train=1.397782 (no previous merge yet)
[S13] round=8 local utility u=0.363358 metrics={'f1_val': 0.5794540793665636, 'auprc': 0.7473552268941699, 'loss_val': 0.709110986902429, 'psi': 0.6466145383776061}-{'f1_val': 0.4677145453913564, 'auprc': 0.7579031580749293, 'loss_val': 0.7970336147947841, 'psi': 0.5837899904647855}
[S14] START round=8 head_norm_before_train=1.277099 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.7927320824434614, 'auprc': 0.9953676113278033, 'loss_val': 0.8249362307409994, 'psi': 0.8737862939971981}-{'f1_val': 0.39659360338126215, 'auprc': 0.9621397919701402, 'loss_val': 0.9674347910163948, 'psi': 0.6228120788168133}
[S15] START round=8 head_norm_before_train=1.304651 (no previous merge yet)
[S15] round=8 local utility u=0.163735 metrics={'f1_val': 0.4259803627312685, 'auprc': 0.799524824885645, 'loss_val': 0.802972101590687, 'psi': 0.5753981475930192}-{'f1_val': 0.4167674234858094, 'auprc': 0.7781245059360693, 'loss_val': 1.0109635537618997, 'psi': 0.5613102564659134}
[S16] START round=8 head_norm_before_train=1.326887 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.440806 metrics={'f1_val': 0.4362598395537193, 'auprc': 0.7374188805194097, 'loss_val': 0.8207536624341177, 'psi': 0.5567234559399954}-{'f1_val': 0.38591558338563875, 'auprc': 0.5583823437335101, 'loss_val': 0.8631903150604764, 'psi': 0.45490228752478734}
[S17] START round=8 head_norm_before_train=0.939081 cos_to_last_merge=0.9858 (last merge round=5)
[S17] round=8 local utility u=0.316020 metrics={'f1_val': 0.3687112836847375, 'auprc': 0.7379855659246821, 'loss_val': 0.8932672877391727, 'psi': 0.5164209965807154}-{'f1_val': 0.34941276698181656, 'auprc': 0.5909665012647782, 'loss_val': 0.9684587350708963, 'psi': 0.44603426069500124}
[S5] not sending this round → trigger blocked (psi=0.817)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:42010
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.874)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:42017
[S2] not sending this round → trigger blocked (psi=0.740)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:42012
[S10] not sending this round → trigger blocked (psi=0.520)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S9] not sending this round → trigger blocked (psi=0.820)
[S15] not sending this round → trigger blocked (psi=0.575)
[S13] not sending this round → trigger blocked (psi=0.647)
[S11] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S3
[S9] cosine check vs S3: cos=0.7965
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0588
[S13] DROPPED delta from S11 (cos=-0.0588 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S6
[S11] cosine check vs S6: cos=0.8178
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=-0.0583
[S17] DROPPED delta from S8 (cos=-0.0583 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S16
[S17] cosine check vs S16: cos=0.5777
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=-0.0287
[S3] DROPPED delta from S17 (cos=-0.0287 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7012 head_norm=1.373746
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.755585e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.8956 head_norm=1.389352 delta_norm=0.475558
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3965 head_norm=0.805850
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.941186e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.4153 head_norm=0.871365 delta_norm=0.294119
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3687 head_norm=0.991415
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.648515e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3660 head_norm=1.048092 delta_norm=0.564852
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.009801 cos_to_last_merge=0.9063 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=9 local utility u=0.068705 metrics={'f1_val': 0.7003529119551686, 'auprc': 0.7836345999007509, 'loss_val': 0.5321410111929329, 'psi': 0.7336655871334015}-{'f1_val': 0.7139440215062263, 'auprc': 0.7783371964928608, 'loss_val': 0.7352058180710273, 'psi': 0.73970129150088}
[S3] START round=9 head_norm_before_train=1.557475 (no previous merge yet)
[S3] round=9 local utility u=0.269083 metrics={'f1_val': 0.521313069480289, 'auprc': 0.8472793690972871, 'loss_val': 0.6283435980292302, 'psi': 0.6516995893270883}-{'f1_val': 0.4811610453361981, 'auprc': 0.7852050648600577, 'loss_val': 0.7393745568942182, 'psi': 0.602778653145742}
[S4] START round=9 head_norm_before_train=1.272675 cos_to_last_merge=0.9970 (last merge round=7)
[S4] round=9 local utility u=0.145329 metrics={'f1_val': 0.3720776017934417, 'auprc': 0.7428447839790995, 'loss_val': 0.7626958086785288, 'psi': 0.5203844746677049}-{'f1_val': 0.3755966813476201, 'auprc': 0.6537496201210873, 'loss_val': 0.8071835828639425, 'psi': 0.48685785685700694}
[S5] START round=9 head_norm_before_train=1.581008 (no previous merge yet)
[S5] round=9 local utility u=0.030730 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9903161359228829, 'loss_val': 0.29204312361760665, 'psi': 0.8166406244586724}-{'f1_val': 0.7008586083484586, 'auprc': 0.9901772412847836, 'loss_val': 0.35309737136126107, 'psi': 0.8165860615229886}
[S6] START round=9 head_norm_before_train=1.020869 cos_to_last_merge=0.9358 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=9 local utility u=0.034883 metrics={'f1_val': 0.4171352566691459, 'auprc': 0.7899265733548713, 'loss_val': 0.7184993817093743, 'psi': 0.5662517833434361}-{'f1_val': 0.4172560359570804, 'auprc': 0.7922844731259515, 'loss_val': 0.7960647407552995, 'psi': 0.5672674108246288}
[S7] START round=9 head_norm_before_train=1.509110 (no previous merge yet)
[S7] round=9 local utility u=0.374427 metrics={'f1_val': 0.6475004522240643, 'auprc': 0.8034725536318941, 'loss_val': 0.5208365654412691, 'psi': 0.7098892927871963}-{'f1_val': 0.5661771666874711, 'auprc': 0.7847500327441472, 'loss_val': 0.7255828533153719, 'psi': 0.6536063131101415}
[S8] START round=9 head_norm_before_train=1.050067 cos_to_last_merge=0.9378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.938
[S8] round=9 local utility u=0.001481 metrics={'f1_val': 0.3729988868650071, 'auprc': 0.961256830288274, 'loss_val': 0.7545570213178059, 'psi': 0.6083020642343139}-{'f1_val': 0.37307134877987713, 'auprc': 0.9920674982575088, 'loss_val': 0.8503853994322613, 'psi': 0.6206698085709299}
[S9] START round=9 head_norm_before_train=1.389352 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.880211 metrics={'f1_val': 0.9933237369199828, 'auprc': 0.9984655681935265, 'loss_val': 0.18547820794452424, 'psi': 0.9953804694294002}-{'f1_val': 0.7012165807733519, 'auprc': 0.9980401646395886, 'loss_val': 0.19198158535969903, 'psi': 0.8199460143198466}
[S10] START round=9 head_norm_before_train=0.957214 cos_to_last_merge=0.9780 (last merge round=5)
[S10] round=9 local utility u=0.279910 metrics={'f1_val': 0.3954524641552402, 'auprc': 0.8601818762095326, 'loss_val': 0.7692091219491732, 'psi': 0.5813442289769571}-{'f1_val': 0.42327429281069157, 'auprc': 0.6651426962065928, 'loss_val': 0.9108425456144175, 'psi': 0.5200216541690521}
[S11] START round=9 head_norm_before_train=0.871365 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.899139 metrics={'f1_val': 0.7009232981065369, 'auprc': 0.9409662297035141, 'loss_val': 0.8495703376208289, 'psi': 0.7969404707453278}-{'f1_val': 0.39651855440916606, 'auprc': 0.9639466104605755, 'loss_val': 0.8903603474447542, 'psi': 0.6234897768297298}
[S13] START round=9 head_norm_before_train=1.442388 (no previous merge yet)
[S13] round=9 local utility u=0.489515 metrics={'f1_val': 0.712004967500554, 'auprc': 0.7601010790904563, 'loss_val': 0.5636239235183369, 'psi': 0.731243412136515}-{'f1_val': 0.5794540793665636, 'auprc': 0.7473552268941699, 'loss_val': 0.709110986902429, 'psi': 0.6466145383776061}
[S14] START round=9 head_norm_before_train=1.313205 cos_to_last_merge=0.9977 (last merge round=7)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.7007381799683068, 'auprc': 0.9941920345977249, 'loss_val': 0.6527333090270357, 'psi': 0.818119721820074}-{'f1_val': 0.7927320824434614, 'auprc': 0.9953676113278033, 'loss_val': 0.8249362307409994, 'psi': 0.8737862939971981}
[S15] START round=9 head_norm_before_train=1.347193 (no previous merge yet)
[S15] round=9 local utility u=0.963419 metrics={'f1_val': 0.6254368346597149, 'auprc': 0.9841242499119452, 'loss_val': 0.6266721219746182, 'psi': 0.7689118007606071}-{'f1_val': 0.4259803627312685, 'auprc': 0.799524824885645, 'loss_val': 0.802972101590687, 'psi': 0.5753981475930192}
[S16] START round=9 head_norm_before_train=1.360957 cos_to_last_merge=0.9982 (last merge round=7)
[S16] round=9 local utility u=0.337227 metrics={'f1_val': 0.5292654337692569, 'auprc': 0.7604652396964618, 'loss_val': 0.7734723586160546, 'psi': 0.6217453561401389}-{'f1_val': 0.4362598395537193, 'auprc': 0.7374188805194097, 'loss_val': 0.8207536624341177, 'psi': 0.5567234559399954}
[S17] START round=9 head_norm_before_train=1.048092 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35192342427522916, 'auprc': 0.4881347181392769, 'loss_val': 0.9613709658415981, 'psi': 0.4064079418208483}-{'f1_val': 0.3687112836847375, 'auprc': 0.7379855659246821, 'loss_val': 0.8932672877391727, 'psi': 0.5164209965807154}
[S16] not sending this round → trigger blocked (psi=0.622)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:42011
[S11] not sending this round → trigger blocked (psi=0.797)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:42004
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.566)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:42016
[S8] not sending this round → trigger blocked (psi=0.608)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:42013
[S3] not sending this round → trigger blocked (psi=0.652)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=0.9351
[S14] RECEIVED delta(kind=head bytes=1806) from S7
[S14] cosine check vs S7: cos=0.9457
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=-0.0423
[S11] DROPPED delta from S15 (cos=-0.0423 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S4
[S10] cosine check vs S4: cos=0.5536
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=-0.0716
[S3] DROPPED delta from S10 (cos=-0.0716 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=-0.0076
[S17] DROPPED delta from S9 (cos=-0.0076 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9519
[S13] RECEIVED delta(kind=head bytes=1793) from S2
[S13] cosine check vs S2: cos=-0.0787
[S13] DROPPED delta from S2 (cos=-0.0787 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.7007 head_norm=1.357550
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.540266e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.9278 head_norm=1.426781 delta_norm=0.254027
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.3955 head_norm=0.999725
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.652547e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.3956 head_norm=1.024221 delta_norm=0.565255
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3721 head_norm=1.318193
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.652016e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3734 head_norm=1.378180 delta_norm=0.265202
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.5293 head_norm=1.402918
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.579884e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.5444 head_norm=1.493540 delta_norm=0.257988
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.079255 cos_to_last_merge=0.8874 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.887
[S2] round=10 local utility u=0.078169 metrics={'f1_val': 0.7016375772275852, 'auprc': 0.7950125572629778, 'loss_val': 0.41764474586453326, 'psi': 0.7389875692417422}-{'f1_val': 0.7003529119551686, 'auprc': 0.7836345999007509, 'loss_val': 0.5321410111929329, 'psi': 0.7336655871334015}
[S3] START round=10 head_norm_before_train=1.600913 (no previous merge yet)
[S3] round=10 local utility u=0.944865 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9971457913589549, 'loss_val': 0.2637962952878603, 'psi': 0.8192044979313513}-{'f1_val': 0.521313069480289, 'auprc': 0.8472793690972871, 'loss_val': 0.6283435980292302, 'psi': 0.6516995893270883}
[S4] START round=10 head_norm_before_train=1.378180 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.755624 metrics={'f1_val': 0.6628050692201636, 'auprc': 0.652008273954901, 'loss_val': 0.7233036608491378, 'psi': 0.6584863511140586}-{'f1_val': 0.3720776017934417, 'auprc': 0.7428447839790995, 'loss_val': 0.7626958086785288, 'psi': 0.5203844746677049}
[S5] START round=10 head_norm_before_train=1.620574 (no previous merge yet)
[S5] round=10 local utility u=0.016307 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.9931550349070011, 'loss_val': 0.2679459310442267, 'psi': 0.8177761840523197}-{'f1_val': 0.7008569501491988, 'auprc': 0.9903161359228829, 'loss_val': 0.29204312361760665, 'psi': 0.8166406244586724}
[S6] START round=10 head_norm_before_train=1.069601 cos_to_last_merge=0.9183 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=10 local utility u=0.012324 metrics={'f1_val': 0.4169753086419753, 'auprc': 0.7897991768206558, 'loss_val': 0.6925103140640873, 'psi': 0.5661048559134475}-{'f1_val': 0.4171352566691459, 'auprc': 0.7899265733548713, 'loss_val': 0.7184993817093743, 'psi': 0.5662517833434361}
[S7] START round=10 head_norm_before_train=1.535423 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6342917022356298, 'auprc': 0.8017332156199817, 'loss_val': 0.5476117683180487, 'psi': 0.7012683075893706}-{'f1_val': 0.6475004522240643, 'auprc': 0.8034725536318941, 'loss_val': 0.5208365654412691, 'psi': 0.7098892927871963}
[S8] START round=10 head_norm_before_train=1.098718 cos_to_last_merge=0.9218 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.922
[S8] round=10 local utility u=0.085209 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9924825856535688, 'loss_val': 0.6766123533655644, 'psi': 0.6206720632391596}-{'f1_val': 0.3729988868650071, 'auprc': 0.961256830288274, 'loss_val': 0.7545570213178059, 'psi': 0.6083020642343139}
[S9] START round=10 head_norm_before_train=1.452799 cos_to_last_merge=0.9974 (last merge round=8)
[S9] round=10 local utility u=0.037747 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9985442796088458, 'loss_val': 0.11523887037418329, 'psi': 0.9959137718672123}-{'f1_val': 0.9933237369199828, 'auprc': 0.9984655681935265, 'loss_val': 0.18547820794452424, 'psi': 0.9953804694294002}
[S10] START round=10 head_norm_before_train=1.024221 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.875101 metrics={'f1_val': 0.6950812966309432, 'auprc': 0.8199508482683101, 'loss_val': 0.6960872635121722, 'psi': 0.74502911728589}-{'f1_val': 0.3954524641552402, 'auprc': 0.8601818762095326, 'loss_val': 0.7692091219491732, 'psi': 0.5813442289769571}
[S11] START round=10 head_norm_before_train=0.904785 cos_to_last_merge=0.9933 (last merge round=8)
[S11] round=10 local utility u=0.065177 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9410726765757496, 'loss_val': 0.7253400820340534, 'psi': 0.7975634552026651}-{'f1_val': 0.7009232981065369, 'auprc': 0.9409662297035141, 'loss_val': 0.8495703376208289, 'psi': 0.7969404707453278}
[S13] START round=10 head_norm_before_train=1.483843 (no previous merge yet)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6785732654732805, 'auprc': 0.7462693233023617, 'loss_val': 0.5726191716854795, 'psi': 0.7056516886049129}-{'f1_val': 0.712004967500554, 'auprc': 0.7601010790904563, 'loss_val': 0.5636239235183369, 'psi': 0.731243412136515}
[S14] START round=10 head_norm_before_train=1.426781 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.050752 metrics={'f1_val': 0.7015328563814676, 'auprc': 0.9941460757086836, 'loss_val': 0.5558586896886936, 'psi': 0.8185781441123541}-{'f1_val': 0.7007381799683068, 'auprc': 0.9941920345977249, 'loss_val': 0.6527333090270357, 'psi': 0.818119721820074}
[S15] START round=10 head_norm_before_train=1.396829 (no previous merge yet)
[S15] round=10 local utility u=0.300904 metrics={'f1_val': 0.6984978113777484, 'auprc': 0.9961730384920429, 'loss_val': 0.49937654634960776, 'psi': 0.8175679022234662}-{'f1_val': 0.6254368346597149, 'auprc': 0.9841242499119452, 'loss_val': 0.6266721219746182, 'psi': 0.7689118007606071}
[S16] START round=10 head_norm_before_train=1.493540 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.4483927678171484, 'auprc': 0.7540089068840339, 'loss_val': 0.7751675811143958, 'psi': 0.5706392234439026}-{'f1_val': 0.5292654337692569, 'auprc': 0.7604652396964618, 'loss_val': 0.7734723586160546, 'psi': 0.6217453561401389}
[S17] START round=10 head_norm_before_train=1.088580 cos_to_last_merge=0.9962 (last merge round=8)
[S17] round=10 local utility u=0.039133 metrics={'f1_val': 0.35192342427522916, 'auprc': 0.496905560788309, 'loss_val': 0.9094181089206376, 'psi': 0.4099162788804611}-{'f1_val': 0.35192342427522916, 'auprc': 0.4881347181392769, 'loss_val': 0.9613709658415981, 'psi': 0.4064079418208483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:42013
[S10] not sending this round → trigger blocked (psi=0.745)
[S4] not sending this round → trigger blocked (psi=0.658)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:42010
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[S2] not sending this round → trigger blocked (psi=0.739)
[S5] not sending this round → trigger blocked (psi=0.818)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.8903
[S13] RECEIVED delta(kind=head bytes=1788) from S11
[S13] cosine check vs S11: cos=-0.0419
[S13] DROPPED delta from S11 (cos=-0.0419 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=-0.0411
[S17] DROPPED delta from S8 (cos=-0.0411 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=-0.0215
[S15] DROPPED delta from S14 (cos=-0.0215 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S3
[S9] cosine check vs S3: cos=0.9130
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.0061
[S4] ⇄ pheromone p=0.357 → S10@127.0.0.1:42011
[S2] ⇄ pheromone p=0.336 → S13@127.0.0.1:42013
[S7] ⇄ pheromone p=0.259 → S14@127.0.0.1:42014
[S10] ⇄ pheromone p=0.465 → S3@127.0.0.1:42003
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9942 head_norm=1.524334
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.363751e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9946 head_norm=1.551741 delta_norm=0.336375
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.388 → S17@127.0.0.1:42017
[S15] ⇄ pheromone p=0.450 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.301 → S16@127.0.0.1:42016
[S13] ⇄ pheromone p=0.342 → S4@127.0.0.1:42004
[S14] ⇄ pheromone p=0.385 → S15@127.0.0.1:42015
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.7019 head_norm=0.949221
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.572507e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.7021 head_norm=1.007974 delta_norm=0.257251
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.409 → S13@127.0.0.1:42013
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=10 metric=0.7006 head_norm=1.648789
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.975367e-01
[S3] stored merged vector for next round verification (round=10)
[S3] DEBUG after merge:  round=10 metric=0.7006 head_norm=1.003273 delta_norm=0.997537
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.461 → S9@127.0.0.1:42010
[S6] ⇄ pheromone p=0.217 → S11@127.0.0.1:42012
[S8] ⇄ pheromone p=0.318 → S17@127.0.0.1:42017
[S16] ⇄ pheromone p=0.275 → S17@127.0.0.1:42017
[S17] ⇄ pheromone p=0.255 → S3@127.0.0.1:42003
[S2] START round=11 head_norm_before_train=1.151067 cos_to_last_merge=0.8697 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.870
[S2] round=11 local utility u=0.238216 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.9260766649204132, 'loss_val': 0.33448645695616025, 'psi': 0.7914214033025484}-{'f1_val': 0.7016375772275852, 'auprc': 0.7950125572629778, 'loss_val': 0.41764474586453326, 'psi': 0.7389875692417422}
[S3] START round=11 head_norm_before_train=1.003273 cos_to_last_merge=1.0000 (last merge round=10)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.7003264167718803, 'auprc': 0.9967811589533446, 'loss_val': 0.3331797539906745, 'psi': 0.8189083136444661}-{'f1_val': 0.7005769689796157, 'auprc': 0.9971457913589549, 'loss_val': 0.2637962952878603, 'psi': 0.8192044979313513}
[S4] START round=11 head_norm_before_train=1.415869 cos_to_last_merge=0.9985 (last merge round=9)
[S4] round=11 local utility u=0.030479 metrics={'f1_val': 0.6642375571552259, 'auprc': 0.6508811434116457, 'loss_val': 0.6675599890722335, 'psi': 0.6588949916577937}-{'f1_val': 0.6628050692201636, 'auprc': 0.652008273954901, 'loss_val': 0.7233036608491378, 'psi': 0.6584863511140586}
[S5] START round=11 head_norm_before_train=1.646553 (no previous merge yet)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9887528034726494, 'loss_val': 0.2600516039674972, 'psi': 0.8158665777925282}-{'f1_val': 0.7008569501491988, 'auprc': 0.9931550349070011, 'loss_val': 0.2679459310442267, 'psi': 0.8177761840523197}
[S6] START round=11 head_norm_before_train=1.123992 cos_to_last_merge=0.9024 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.7103954876629905, 'auprc': 0.9641269079409132, 'loss_val': 0.4693026898312294, 'psi': 0.8118880557741596}-{'f1_val': 0.4169753086419753, 'auprc': 0.7897991768206558, 'loss_val': 0.6925103140640873, 'psi': 0.5661048559134475}
[S7] START round=11 head_norm_before_train=1.563487 (no previous merge yet)
[S7] round=11 local utility u=0.126673 metrics={'f1_val': 0.6626100705526831, 'auprc': 0.8040136137752786, 'loss_val': 0.47101619418479423, 'psi': 0.7191714878417212}-{'f1_val': 0.6342917022356298, 'auprc': 0.8017332156199817, 'loss_val': 0.5476117683180487, 'psi': 0.7012683075893706}
[S8] START round=11 head_norm_before_train=1.154583 cos_to_last_merge=0.9056 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.906
[S8] round=11 local utility u=0.011729 metrics={'f1_val': 0.3727976540791911, 'auprc': 0.9723720662403448, 'loss_val': 0.5928187220020182, 'psi': 0.6126274189436526}-{'f1_val': 0.3727983816295533, 'auprc': 0.9924825856535688, 'loss_val': 0.6766123533655644, 'psi': 0.6206720632391596}
[S9] START round=11 head_norm_before_train=1.551741 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.006452 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980265427107413, 'loss_val': 0.11578424011976687, 'psi': 0.9972069241726313}-{'f1_val': 0.9941601000394567, 'auprc': 0.9985442796088458, 'loss_val': 0.11523887037418329, 'psi': 0.9959137718672123}
[S10] START round=11 head_norm_before_train=1.064236 cos_to_last_merge=0.9968 (last merge round=9)
[S10] round=11 local utility u=0.316871 metrics={'f1_val': 0.6921885451082121, 'auprc': 0.9880272091632559, 'loss_val': 0.5492176851652655, 'psi': 0.8105240107302296}-{'f1_val': 0.6950812966309432, 'auprc': 0.8199508482683101, 'loss_val': 0.6960872635121722, 'psi': 0.74502911728589}
[S11] START round=11 head_norm_before_train=1.007974 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.057758 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9557504725358932, 'loss_val': 0.6526735562524587, 'psi': 0.8033162767665122}-{'f1_val': 0.701890640953942, 'auprc': 0.9410726765757496, 'loss_val': 0.7253400820340534, 'psi': 0.7975634552026651}
[S13] START round=11 head_norm_before_train=1.522448 (no previous merge yet)
[S13] round=11 local utility u=0.000000 metrics={'f1_val': 0.6457721160975538, 'auprc': 0.752045145731032, 'loss_val': 0.49936070368991975, 'psi': 0.6882813279509451}-{'f1_val': 0.6785732654732805, 'auprc': 0.7462693233023617, 'loss_val': 0.5726191716854795, 'psi': 0.7056516886049129}
[S14] START round=11 head_norm_before_train=1.467102 cos_to_last_merge=0.9984 (last merge round=9)
[S14] round=11 local utility u=0.071862 metrics={'f1_val': 0.7018830358736575, 'auprc': 0.9957786449938144, 'loss_val': 0.41913354471591757, 'psi': 0.8194412795217203}-{'f1_val': 0.7015328563814676, 'auprc': 0.9941460757086836, 'loss_val': 0.5558586896886936, 'psi': 0.8185781441123541}
[S15] START round=11 head_norm_before_train=1.443932 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6930570429112, 'auprc': 0.9690386001563227, 'loss_val': 0.443562678288205, 'psi': 0.8034496658092491}-{'f1_val': 0.6984978113777484, 'auprc': 0.9961730384920429, 'loss_val': 0.49937654634960776, 'psi': 0.8175679022234662}
[S16] START round=11 head_norm_before_train=1.530474 cos_to_last_merge=0.9989 (last merge round=9)
[S16] round=11 local utility u=0.359836 metrics={'f1_val': 0.5541799318892486, 'auprc': 0.7834203856329871, 'loss_val': 0.778452006823513, 'psi': 0.6458761133867441}-{'f1_val': 0.4483927678171484, 'auprc': 0.7540089068840339, 'loss_val': 0.7751675811143958, 'psi': 0.5706392234439026}
[S17] START round=11 head_norm_before_train=1.133476 cos_to_last_merge=0.9872 (last merge round=8)
[S17] round=11 local utility u=0.066098 metrics={'f1_val': 0.3532559436946084, 'auprc': 0.532305269115029, 'loss_val': 0.8914160139811856, 'psi': 0.42487567386277664}-{'f1_val': 0.35192342427522916, 'auprc': 0.496905560788309, 'loss_val': 0.9094181089206376, 'psi': 0.4099162788804611}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S14] not sending this round → trigger blocked (psi=0.819)
[S8] not sending this round → trigger blocked (psi=0.613)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:42014
[S6] not sending this round → trigger blocked (psi=0.812)
[S11] not sending this round → trigger blocked (psi=0.803)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[S7] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S2
[S13] cosine check vs S2: cos=-0.0900
[S13] DROPPED delta from S2 (cos=-0.0900 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=-0.0895
[S3] DROPPED delta from S10 (cos=-0.0895 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.8315
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.8346
[S17] RECEIVED delta(kind=head bytes=1807) from S9
[S17] cosine check vs S9: cos=-0.0049
[S17] DROPPED delta from S9 (cos=-0.0049 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9660
[S17] not sending this round → trigger blocked (psi=0.425)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.7019 head_norm=1.510448
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.062334e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.7015 head_norm=1.537524 delta_norm=0.206233
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6922 head_norm=1.113164
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.083009e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6849 head_norm=1.231651 delta_norm=0.408301
[S10] aggregate: ROLLBACK (f1_val pre=0.692 post=0.685 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3533 head_norm=1.174051
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.384688e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3532 head_norm=1.316261 delta_norm=0.438469
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.214359 cos_to_last_merge=0.8548 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.855
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7018298824914997, 'auprc': 0.9034009957676876, 'loss_val': 0.3018271028441647, 'psi': 0.7824583278019749}-{'f1_val': 0.7016512288906386, 'auprc': 0.9260766649204132, 'loss_val': 0.33448645695616025, 'psi': 0.7914214033025484}
[S3] START round=12 head_norm_before_train=1.058390 cos_to_last_merge=0.9975 (last merge round=10)
[S3] round=12 local utility u=0.433573 metrics={'f1_val': 0.8518742580162488, 'auprc': 0.9940509143310022, 'loss_val': 0.3671291776307342, 'psi': 0.9087449205421502}-{'f1_val': 0.7003264167718803, 'auprc': 0.9967811589533446, 'loss_val': 0.3331797539906745, 'psi': 0.8189083136444661}
[S4] START round=12 head_norm_before_train=1.458839 cos_to_last_merge=0.9947 (last merge round=9)
[S4] round=12 local utility u=0.036251 metrics={'f1_val': 0.6657836162640213, 'auprc': 0.651244915122688, 'loss_val': 0.6054256228316564, 'psi': 0.659968135807488}-{'f1_val': 0.6642375571552259, 'auprc': 0.6508811434116457, 'loss_val': 0.6675599890722335, 'psi': 0.6588949916577937}
[S5] START round=12 head_norm_before_train=1.664086 (no previous merge yet)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9744454803657853, 'loss_val': 0.27089037050992226, 'psi': 0.8101432277439187}-{'f1_val': 0.7006090940057808, 'auprc': 0.9887528034726494, 'loss_val': 0.2600516039674972, 'psi': 0.8158665777925282}
[S6] START round=12 head_norm_before_train=1.172403 cos_to_last_merge=0.8898 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6873574958862305, 'auprc': 0.8057956805582238, 'loss_val': 0.4862237302726068, 'psi': 0.7347327697550279}-{'f1_val': 0.7103954876629905, 'auprc': 0.9641269079409132, 'loss_val': 0.4693026898312294, 'psi': 0.8118880557741596}
[S7] START round=12 head_norm_before_train=1.591091 (no previous merge yet)
[S7] round=12 local utility u=0.120728 metrics={'f1_val': 0.680381756304353, 'auprc': 0.8238043057727001, 'loss_val': 0.3955617393401119, 'psi': 0.7377507760916919}-{'f1_val': 0.6626100705526831, 'auprc': 0.8040136137752786, 'loss_val': 0.47101619418479423, 'psi': 0.7191714878417212}
[S8] START round=12 head_norm_before_train=1.204829 cos_to_last_merge=0.8920 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.892
[S8] round=12 local utility u=0.052578 metrics={'f1_val': 0.37266438550987346, 'auprc': 0.991631628943107, 'loss_val': 0.5446416874837103, 'psi': 0.6202512828831669}-{'f1_val': 0.3727976540791911, 'auprc': 0.9723720662403448, 'loss_val': 0.5928187220020182, 'psi': 0.6126274189436526}
[S9] START round=12 head_norm_before_train=1.614948 cos_to_last_merge=0.9978 (last merge round=10)
[S9] round=12 local utility u=0.003022 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9984654717436361, 'loss_val': 0.0786207019606718, 'psi': 0.994138787621599}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980265427107413, 'loss_val': 0.11578424011976687, 'psi': 0.9972069241726313}
[S10] START round=12 head_norm_before_train=1.231651 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.000607 metrics={'f1_val': 0.6809301656234724, 'auprc': 0.9878044234920076, 'loss_val': 0.4797846978513893, 'psi': 0.8036798687708865}-{'f1_val': 0.6921885451082121, 'auprc': 0.9880272091632559, 'loss_val': 0.5492176851652655, 'psi': 0.8105240107302296}
[S11] START round=12 head_norm_before_train=1.044049 cos_to_last_merge=0.9963 (last merge round=10)
[S11] round=12 local utility u=0.094017 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9883237079998006, 'loss_val': 0.5656524292878529, 'psi': 0.8166749762394787}-{'f1_val': 0.7016934795869249, 'auprc': 0.9557504725358932, 'loss_val': 0.6526735562524587, 'psi': 0.8033162767665122}
[S13] START round=12 head_norm_before_train=1.551739 (no previous merge yet)
[S13] round=12 local utility u=0.185098 metrics={'f1_val': 0.709870050992068, 'auprc': 0.7316316306200865, 'loss_val': 0.45251222167025634, 'psi': 0.7185746828432754}-{'f1_val': 0.6457721160975538, 'auprc': 0.752045145731032, 'loss_val': 0.49936070368991975, 'psi': 0.6882813279509451}
[S14] START round=12 head_norm_before_train=1.537524 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.013529 metrics={'f1_val': 0.7018173705706284, 'auprc': 0.995661445170032, 'loss_val': 0.3913290705769903, 'psi': 0.8193550004103898}-{'f1_val': 0.7018830358736575, 'auprc': 0.9957786449938144, 'loss_val': 0.41913354471591757, 'psi': 0.8194412795217203}
[S15] START round=12 head_norm_before_train=1.494135 (no previous merge yet)
[S15] round=12 local utility u=0.081930 metrics={'f1_val': 0.6937862743929353, 'auprc': 0.9856967342170591, 'loss_val': 0.3340529661803427, 'psi': 0.8105504583225849}-{'f1_val': 0.6930570429112, 'auprc': 0.9690386001563227, 'loss_val': 0.443562678288205, 'psi': 0.8034496658092491}
[S16] START round=12 head_norm_before_train=1.572005 cos_to_last_merge=0.9963 (last merge round=9)
[S16] round=12 local utility u=0.520109 metrics={'f1_val': 0.7019196956260799, 'auprc': 0.7990712695418567, 'loss_val': 0.6716248635581322, 'psi': 0.7407803251923906}-{'f1_val': 0.5541799318892486, 'auprc': 0.7834203856329871, 'loss_val': 0.778452006823513, 'psi': 0.6458761133867441}
[S17] START round=12 head_norm_before_train=1.316261 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.006101 metrics={'f1_val': 0.39366988320125973, 'auprc': 0.4649094379095704, 'loss_val': 0.919509776077006, 'psi': 0.422165705084584}-{'f1_val': 0.3532559436946084, 'auprc': 0.532305269115029, 'loss_val': 0.8914160139811856, 'psi': 0.42487567386277664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S10] not sending this round → trigger blocked (psi=0.804)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:42013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.660)
[S9] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:42015
[S7] not sending this round → trigger blocked (psi=0.738)
[S16] not sending this round → trigger blocked (psi=0.741)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:42010
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=-0.0210
[S15] DROPPED delta from S14 (cos=-0.0210 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=-0.0346
[S11] DROPPED delta from S15 (cos=-0.0346 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=0.8081
[S13] RECEIVED delta(kind=head bytes=1793) from S11
[S13] cosine check vs S11: cos=-0.0337
[S13] DROPPED delta from S11 (cos=-0.0337 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=-0.0196
[S17] DROPPED delta from S8 (cos=-0.0196 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=0.9510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1796) from S17
[S3] cosine check vs S17: cos=0.5043
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6658 head_norm=1.502176
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.425555e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6654 head_norm=1.516462 delta_norm=0.242555
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.9913 head_norm=1.682706
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.076739e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.9917 head_norm=1.344479 delta_norm=0.507674
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.8519 head_norm=1.139832
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.247070e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.6097 head_norm=1.078462 delta_norm=0.624707
[S3] aggregate: ROLLBACK (f1_val pre=0.852 post=0.610 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.268703 cos_to_last_merge=0.8417 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.842
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.7060927127840552, 'auprc': 0.7860928170086159, 'loss_val': 0.4241693167478405, 'psi': 0.7380927544738795}-{'f1_val': 0.7018298824914997, 'auprc': 0.9034009957676876, 'loss_val': 0.3018271028441647, 'psi': 0.7824583278019749}
[S3] START round=13 head_norm_before_train=1.078462 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6321414286530916, 'auprc': 0.9985860572123378, 'loss_val': 0.4116325787051567, 'psi': 0.7787192800767901}-{'f1_val': 0.8518742580162488, 'auprc': 0.9940509143310022, 'loss_val': 0.3671291776307342, 'psi': 0.9087449205421502}
[S4] START round=13 head_norm_before_train=1.516462 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.037160 metrics={'f1_val': 0.6641010151879717, 'auprc': 0.6725768390520055, 'loss_val': 0.5850057608258031, 'psi': 0.6674913447335853}-{'f1_val': 0.6657836162640213, 'auprc': 0.651244915122688, 'loss_val': 0.6054256228316564, 'psi': 0.659968135807488}
[S5] START round=13 head_norm_before_train=1.691215 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.6345105111302062, 'auprc': 0.8813396204443236, 'loss_val': 0.3682419478601873, 'psi': 0.7332421548558532}-{'f1_val': 0.7006083926626743, 'auprc': 0.9744454803657853, 'loss_val': 0.27089037050992226, 'psi': 0.8101432277439187}
[S6] START round=13 head_norm_before_train=1.217516 cos_to_last_merge=0.8796 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=13 local utility u=0.326265 metrics={'f1_val': 0.7067645703192269, 'auprc': 0.9523408429188772, 'loss_val': 0.38977221904873743, 'psi': 0.804995079359087}-{'f1_val': 0.6873574958862305, 'auprc': 0.8057956805582238, 'loss_val': 0.4862237302726068, 'psi': 0.7347327697550279}
[S7] START round=13 head_norm_before_train=1.615243 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5418167511613265, 'auprc': 0.7815797792518389, 'loss_val': 0.8433495282767081, 'psi': 0.6377219623975314}-{'f1_val': 0.680381756304353, 'auprc': 0.8238043057727001, 'loss_val': 0.3955617393401119, 'psi': 0.7377507760916919}
[S8] START round=13 head_norm_before_train=1.255519 cos_to_last_merge=0.8797 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.880
[S8] round=13 local utility u=0.880612 metrics={'f1_val': 0.6435525039190351, 'auprc': 0.9933444368781864, 'loss_val': 0.413884345079094, 'psi': 0.7834692771026956}-{'f1_val': 0.37266438550987346, 'auprc': 0.991631628943107, 'loss_val': 0.5446416874837103, 'psi': 0.6202512828831669}
[S9] START round=13 head_norm_before_train=1.344479 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984514852191886, 'loss_val': 0.11050120271401753, 'psi': 0.9968766251061867}-{'f1_val': 0.991254331540241, 'auprc': 0.9984654717436361, 'loss_val': 0.0786207019606718, 'psi': 0.994138787621599}
[S10] START round=13 head_norm_before_train=1.271704 cos_to_last_merge=0.9981 (last merge round=11)
[S10] round=13 local utility u=0.097529 metrics={'f1_val': 0.6942481179257215, 'auprc': 0.9958892633432853, 'loss_val': 0.3888895008010094, 'psi': 0.814904576092747}-{'f1_val': 0.6809301656234724, 'auprc': 0.9878044234920076, 'loss_val': 0.4797846978513893, 'psi': 0.8036798687708865}
[S11] START round=13 head_norm_before_train=1.087577 cos_to_last_merge=0.9878 (last merge round=10)
[S11] round=13 local utility u=0.068283 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9957036475756809, 'loss_val': 0.4479315772237153, 'psi': 0.8192975467824273}-{'f1_val': 0.702242488399264, 'auprc': 0.9883237079998006, 'loss_val': 0.5656524292878529, 'psi': 0.8166749762394787}
[S13] START round=13 head_norm_before_train=1.568582 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6326730083406018, 'auprc': 0.6933377589046703, 'loss_val': 0.5317387977062614, 'psi': 0.6569389085662292}-{'f1_val': 0.709870050992068, 'auprc': 0.7316316306200865, 'loss_val': 0.45251222167025634, 'psi': 0.7185746828432754}
[S14] START round=13 head_norm_before_train=1.572193 cos_to_last_merge=0.9992 (last merge round=11)
[S14] round=13 local utility u=0.019251 metrics={'f1_val': 0.7012245912013874, 'auprc': 0.9929309076081729, 'loss_val': 0.34107893293170627, 'psi': 0.8179071177641015}-{'f1_val': 0.7018173705706284, 'auprc': 0.995661445170032, 'loss_val': 0.3913290705769903, 'psi': 0.8193550004103898}
[S15] START round=13 head_norm_before_train=1.544217 (no previous merge yet)
[S15] round=13 local utility u=0.001549 metrics={'f1_val': 0.6986184249994525, 'auprc': 0.9833685119955099, 'loss_val': 0.35296244019865924, 'psi': 0.8125184597978754}-{'f1_val': 0.6937862743929353, 'auprc': 0.9856967342170591, 'loss_val': 0.3340529661803427, 'psi': 0.8105504583225849}
[S16] START round=13 head_norm_before_train=1.609770 cos_to_last_merge=0.9932 (last merge round=9)
[S16] round=13 local utility u=0.312884 metrics={'f1_val': 0.7726883163184823, 'auprc': 0.8434144947892808, 'loss_val': 0.6034978936743485, 'psi': 0.8009787877068018}-{'f1_val': 0.7019196956260799, 'auprc': 0.7990712695418567, 'loss_val': 0.6716248635581322, 'psi': 0.7407803251923906}
[S17] START round=13 head_norm_before_train=1.344419 cos_to_last_merge=0.9986 (last merge round=11)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.37477911100795186, 'auprc': 0.48036962185146725, 'loss_val': 0.9266587626576607, 'psi': 0.417015315345358}-{'f1_val': 0.39366988320125973, 'auprc': 0.4649094379095704, 'loss_val': 0.919509776077006, 'psi': 0.422165705084584}
[S8] not sending this round → trigger blocked (psi=0.783)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.813)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.818)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:42011
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:42012
[S11] not sending this round → trigger blocked (psi=0.819)
[S16] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.9161
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.9207
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=-0.0524
[S3] DROPPED delta from S10 (cos=-0.0524 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.9472
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.7017 head_norm=1.127265
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.513339e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.7017 head_norm=1.164977 delta_norm=0.251334
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.6942 head_norm=1.315306
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.087962e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.7897 head_norm=1.406393 delta_norm=0.308796
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3748 head_norm=1.376233
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.790812e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3524 head_norm=1.490980 delta_norm=0.279081
[S17] aggregate: ROLLBACK (f1_val pre=0.375 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S2] START round=14 head_norm_before_train=1.312253 cos_to_last_merge=0.8309 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.831
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.701760200622316, 'auprc': 0.7045490864843897, 'loss_val': 0.34668089878097413, 'psi': 0.7028757549671456}-{'f1_val': 0.7060927127840552, 'auprc': 0.7860928170086159, 'loss_val': 0.4241693167478405, 'psi': 0.7380927544738795}
[S3] START round=14 head_norm_before_train=1.161877 cos_to_last_merge=0.9909 (last merge round=12)
[S3] round=14 local utility u=0.183399 metrics={'f1_val': 0.7315921626266454, 'auprc': 0.9709550957915889, 'loss_val': 0.5586466850716293, 'psi': 0.8273373358926228}-{'f1_val': 0.6321414286530916, 'auprc': 0.9985860572123378, 'loss_val': 0.4116325787051567, 'psi': 0.7787192800767901}
[S4] START round=14 head_norm_before_train=1.554531 cos_to_last_merge=0.9992 (last merge round=12)
[S4] round=14 local utility u=0.200691 metrics={'f1_val': 0.6645136017642096, 'auprc': 0.7898277988049062, 'loss_val': 0.5378518297450806, 'psi': 0.7146392805804882}-{'f1_val': 0.6641010151879717, 'auprc': 0.6725768390520055, 'loss_val': 0.5850057608258031, 'psi': 0.6674913447335853}
[S5] START round=14 head_norm_before_train=1.717908 (no previous merge yet)
[S5] round=14 local utility u=0.159873 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8540782442104146, 'loss_val': 0.3632991793632026, 'psi': 0.7619963332817704}-{'f1_val': 0.6345105111302062, 'auprc': 0.8813396204443236, 'loss_val': 0.3682419478601873, 'psi': 0.7332421548558532}
[S6] START round=14 head_norm_before_train=1.252978 cos_to_last_merge=0.8713 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=14 local utility u=0.017217 metrics={'f1_val': 0.7075365143577863, 'auprc': 0.9570806934564366, 'loss_val': 0.3741893763608703, 'psi': 0.8073541859972464}-{'f1_val': 0.7067645703192269, 'auprc': 0.9523408429188772, 'loss_val': 0.38977221904873743, 'psi': 0.804995079359087}
[S7] START round=14 head_norm_before_train=1.632135 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5398773701839088, 'auprc': 0.7836094681670335, 'loss_val': 0.8949896613919993, 'psi': 0.6373702093771587}-{'f1_val': 0.5418167511613265, 'auprc': 0.7815797792518389, 'loss_val': 0.8433495282767081, 'psi': 0.6377219623975314}
[S8] START round=14 head_norm_before_train=1.297446 cos_to_last_merge=0.8698 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=14 local utility u=0.935928 metrics={'f1_val': 0.9401160912005128, 'auprc': 0.9958522794791144, 'loss_val': 0.32893242595842503, 'psi': 0.9624105665119534}-{'f1_val': 0.6435525039190351, 'auprc': 0.9933444368781864, 'loss_val': 0.413884345079094, 'psi': 0.7834692771026956}
[S9] START round=14 head_norm_before_train=1.425181 cos_to_last_merge=0.9964 (last merge round=12)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9984425179408369, 'loss_val': 0.08082508050009894, 'psi': 0.9929586238932064}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984514852191886, 'loss_val': 0.11050120271401753, 'psi': 0.9968766251061867}
[S10] START round=14 head_norm_before_train=1.406393 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.506568 metrics={'f1_val': 0.8646976751037249, 'auprc': 0.9956729302767077, 'loss_val': 0.3978019359863206, 'psi': 0.917087777172918}-{'f1_val': 0.6942481179257215, 'auprc': 0.9958892633432853, 'loss_val': 0.3888895008010094, 'psi': 0.814904576092747}
[S11] START round=14 head_norm_before_train=1.164977 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6984020643894748, 'auprc': 0.9967623723146285, 'loss_val': 0.49776873505412755, 'psi': 0.8177461875595362}-{'f1_val': 0.7016934795869249, 'auprc': 0.9957036475756809, 'loss_val': 0.4479315772237153, 'psi': 0.8192975467824273}
[S13] START round=14 head_norm_before_train=1.584264 (no previous merge yet)
[S13] round=14 local utility u=0.134044 metrics={'f1_val': 0.6802367268948133, 'auprc': 0.6762763066952922, 'loss_val': 0.4978484139066864, 'psi': 0.6786525588150049}-{'f1_val': 0.6326730083406018, 'auprc': 0.6933377589046703, 'loss_val': 0.5317387977062614, 'psi': 0.6569389085662292}
[S14] START round=14 head_norm_before_train=1.605250 cos_to_last_merge=0.9973 (last merge round=11)
[S14] round=14 local utility u=0.722855 metrics={'f1_val': 0.9325474602948018, 'auprc': 0.9978113597270886, 'loss_val': 0.29794738596973164, 'psi': 0.9586530200677166}-{'f1_val': 0.7012245912013874, 'auprc': 0.9929309076081729, 'loss_val': 0.34107893293170627, 'psi': 0.8179071177641015}
[S15] START round=14 head_norm_before_train=1.586015 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6889187716157583, 'auprc': 0.9606002918461982, 'loss_val': 0.28005016819805867, 'psi': 0.7975913797079343}-{'f1_val': 0.6986184249994525, 'auprc': 0.9833685119955099, 'loss_val': 0.35296244019865924, 'psi': 0.8125184597978754}
[S16] START round=14 head_norm_before_train=1.645540 cos_to_last_merge=0.9897 (last merge round=9)
[S16] round=14 local utility u=0.213297 metrics={'f1_val': 0.8437514955805393, 'auprc': 0.8652936758339856, 'loss_val': 0.6689212983523438, 'psi': 0.8523683676819178}-{'f1_val': 0.7726883163184823, 'auprc': 0.8434144947892808, 'loss_val': 0.6034978936743485, 'psi': 0.8009787877068018}
[S17] START round=14 head_norm_before_train=1.490980 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.345193 metrics={'f1_val': 0.49951585259220743, 'auprc': 0.4638830275200272, 'loss_val': 0.9352327219054061, 'psi': 0.48526272256333536}-{'f1_val': 0.37477911100795186, 'auprc': 0.48036962185146725, 'loss_val': 0.9266587626576607, 'psi': 0.417015315345358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:42015
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.807)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:42010
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:42016
[S10] not sending this round → trigger blocked (psi=0.917)
[S4] not sending this round → trigger blocked (psi=0.715)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.852)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=-0.0074
[S17] DROPPED delta from S8 (cos=-0.0074 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.9752
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=-0.0232
[S15] DROPPED delta from S14 (cos=-0.0232 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S3
[S9] cosine check vs S3: cos=0.7054
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9545
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1806 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1806) from S17
[S3] cosine check vs S17: cos=0.7771
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9893 head_norm=1.510870
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.441555e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9893 head_norm=1.280246 delta_norm=0.544156
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.6645 head_norm=1.591976
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.778169e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.6649 head_norm=1.585482 delta_norm=0.177817
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=14 metric=0.7316 head_norm=1.259976
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.786167e-01
[S3] stored merged vector for next round verification (round=14)
[S3] DEBUG after merge:  round=14 metric=0.7091 head_norm=1.308778 delta_norm=0.478617
[S3] aggregate: ROLLBACK (f1_val pre=0.732 post=0.709 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.8438 head_norm=1.679407
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.598261e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.8414 head_norm=1.690605 delta_norm=0.259826
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.349628 cos_to_last_merge=0.8235 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.824
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.6956952787772155, 'auprc': 0.6721469598698029, 'loss_val': 0.3273506527781581, 'psi': 0.6862759512142504}-{'f1_val': 0.701760200622316, 'auprc': 0.7045490864843897, 'loss_val': 0.34668089878097413, 'psi': 0.7028757549671456}
[S3] START round=15 head_norm_before_train=1.308778 cos_to_last_merge=1.0000 (last merge round=14)
[S3] round=15 local utility u=0.313200 metrics={'f1_val': 0.811999572368236, 'auprc': 0.9830618351847322, 'loss_val': 0.45101163359043667, 'psi': 0.8804244774948344}-{'f1_val': 0.7315921626266454, 'auprc': 0.9709550957915889, 'loss_val': 0.5586466850716293, 'psi': 0.8273373358926228}
[S4] START round=15 head_norm_before_train=1.585482 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6183286800468201, 'auprc': 0.8489222914525136, 'loss_val': 0.5387453485959742, 'psi': 0.7105661246090975}-{'f1_val': 0.6645136017642096, 'auprc': 0.7898277988049062, 'loss_val': 0.5378518297450806, 'psi': 0.7146392805804882}
[S5] START round=15 head_norm_before_train=1.740948 (no previous merge yet)
[S5] round=15 local utility u=0.012226 metrics={'f1_val': 0.700781124122831, 'auprc': 0.8701842538545267, 'loss_val': 0.38820082654160004, 'psi': 0.7685423760155092}-{'f1_val': 0.7006083926626743, 'auprc': 0.8540782442104146, 'loss_val': 0.3632991793632026, 'psi': 0.7619963332817704}
[S6] START round=15 head_norm_before_train=1.280486 cos_to_last_merge=0.8655 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=15 local utility u=0.087586 metrics={'f1_val': 0.728710445469006, 'auprc': 0.9594833572175702, 'loss_val': 0.33326877546405087, 'psi': 0.8210196101684317}-{'f1_val': 0.7075365143577863, 'auprc': 0.9570806934564366, 'loss_val': 0.3741893763608703, 'psi': 0.8073541859972464}
[S7] START round=15 head_norm_before_train=1.650982 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.5207535870496984, 'auprc': 0.7814029187095894, 'loss_val': 1.0468988577218565, 'psi': 0.6250133197136548}-{'f1_val': 0.5398773701839088, 'auprc': 0.7836094681670335, 'loss_val': 0.8949896613919993, 'psi': 0.6373702093771587}
[S8] START round=15 head_norm_before_train=1.339636 cos_to_last_merge=0.8603 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.860
[S8] round=15 local utility u=0.228674 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9960602073445385, 'loss_val': 0.20962969646650279, 'psi': 0.9962359278991901}-{'f1_val': 0.9401160912005128, 'auprc': 0.9958522794791144, 'loss_val': 0.32893242595842503, 'psi': 0.9624105665119534}
[S9] START round=15 head_norm_before_train=1.280246 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.978091755602868, 'auprc': 0.988019219093071, 'loss_val': 0.15627948028579822, 'psi': 0.9820627409989491}-{'f1_val': 0.9893026945281196, 'auprc': 0.9984425179408369, 'loss_val': 0.08082508050009894, 'psi': 0.9929586238932064}
[S10] START round=15 head_norm_before_train=1.442374 cos_to_last_merge=0.9990 (last merge round=13)
[S10] round=15 local utility u=0.063530 metrics={'f1_val': 0.8676064531566325, 'auprc': 0.9957554408195344, 'loss_val': 0.2884428921639642, 'psi': 0.9188660482217932}-{'f1_val': 0.8646976751037249, 'auprc': 0.9956729302767077, 'loss_val': 0.3978019359863206, 'psi': 0.917087777172918}
[S11] START round=15 head_norm_before_train=1.198366 cos_to_last_merge=0.9986 (last merge round=13)
[S11] round=15 local utility u=0.064249 metrics={'f1_val': 0.7016282822309048, 'auprc': 0.9947967012851552, 'loss_val': 0.3827308393905456, 'psi': 0.818895649852605}-{'f1_val': 0.6984020643894748, 'auprc': 0.9967623723146285, 'loss_val': 0.49776873505412755, 'psi': 0.8177461875595362}
[S13] START round=15 head_norm_before_train=1.598860 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6239313844735572, 'auprc': 0.6255914439007273, 'loss_val': 0.5844614299344385, 'psi': 0.6245954082444253}-{'f1_val': 0.6802367268948133, 'auprc': 0.6762763066952922, 'loss_val': 0.4978484139066864, 'psi': 0.6786525588150049}
[S14] START round=15 head_norm_before_train=1.635461 cos_to_last_merge=0.9951 (last merge round=11)
[S14] round=15 local utility u=0.204563 metrics={'f1_val': 0.9974678030733966, 'auprc': 0.9929680677081626, 'loss_val': 0.2638138768141279, 'psi': 0.995667908927303}-{'f1_val': 0.9325474602948018, 'auprc': 0.9978113597270886, 'loss_val': 0.29794738596973164, 'psi': 0.9586530200677166}
[S15] START round=15 head_norm_before_train=1.618860 (no previous merge yet)
[S15] round=15 local utility u=0.040117 metrics={'f1_val': 0.7000194663246705, 'auprc': 0.9799393033150028, 'loss_val': 0.32443807096439276, 'psi': 0.8119874011208035}-{'f1_val': 0.6889187716157583, 'auprc': 0.9606002918461982, 'loss_val': 0.28005016819805867, 'psi': 0.7975913797079343}
[S16] START round=15 head_norm_before_train=1.690605 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.430983 metrics={'f1_val': 0.9141397654187324, 'auprc': 0.9318652900430793, 'loss_val': 0.42899889667960955, 'psi': 0.9212299752684712}-{'f1_val': 0.8437514955805393, 'auprc': 0.8652936758339856, 'loss_val': 0.6689212983523438, 'psi': 0.8523683676819178}
[S17] START round=15 head_norm_before_train=1.515390 cos_to_last_merge=0.9990 (last merge round=13)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3534728608424502, 'auprc': 0.5278498821500774, 'loss_val': 0.9408404184387175, 'psi': 0.4232236693655011}-{'f1_val': 0.49951585259220743, 'auprc': 0.4638830275200272, 'loss_val': 0.9352327219054061, 'psi': 0.48526272256333536}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S5] not sending this round → trigger blocked (psi=0.769)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S14] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S3] not sending this round → trigger blocked (psi=0.880)
[S6] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=-0.0297
[S11] DROPPED delta from S15 (cos=-0.0297 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9594
[S3] RECEIVED delta(kind=head bytes=1803) from S10
[S3] cosine check vs S10: cos=-0.0165
[S3] DROPPED delta from S10 (cos=-0.0165 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.9605
[S13] RECEIVED delta(kind=head bytes=1801) from S11
[S13] cosine check vs S11: cos=-0.0329
[S13] DROPPED delta from S11 (cos=-0.0329 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=0.287 → S9@127.0.0.1:42010
[S5] ⇄ pheromone p=0.127 → S16@127.0.0.1:42016
[S13] ⇄ pheromone p=0.153 → S4@127.0.0.1:42004
[S8] ⇄ pheromone p=0.419 → S17@127.0.0.1:42017
[S4] ⇄ pheromone p=0.160 → S10@127.0.0.1:42011
[S2] ⇄ pheromone p=0.130 → S13@127.0.0.1:42013
[S9] ⇄ pheromone p=0.128 → S17@127.0.0.1:42017
[S14] ⇄ pheromone p=0.292 → S15@127.0.0.1:42015
[S7] ⇄ pheromone p=0.108 → S14@127.0.0.1:42014
[S10] ⇄ pheromone p=0.285 → S3@127.0.0.1:42003
[S15] ⇄ pheromone p=0.164 → S11@127.0.0.1:42012
[S6] ⇄ pheromone p=0.215 → S11@127.0.0.1:42012
[S16] ⇄ pheromone p=0.333 → S17@127.0.0.1:42017
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=15 metric=0.7016 head_norm=1.233387
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.850811e-01
[S11] stored merged vector for next round verification (round=15)
[S11] DEBUG after merge:  round=15 metric=0.7016 head_norm=1.258611 delta_norm=0.185081
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.170 → S13@127.0.0.1:42013
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3535 head_norm=1.538185
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.468353e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3546 head_norm=1.614646 delta_norm=0.246835
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.145 → S3@127.0.0.1:42003
[S2] START round=16 head_norm_before_train=1.379308 cos_to_last_merge=0.8199 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.6566684756305821, 'auprc': 0.7252066727520214, 'loss_val': 0.46505178705245687, 'psi': 0.6840837544791578}-{'f1_val': 0.6956952787772155, 'auprc': 0.6721469598698029, 'loss_val': 0.3273506527781581, 'psi': 0.6862759512142504}
[S3] START round=16 head_norm_before_train=1.387070 cos_to_last_merge=0.9933 (last merge round=14)
[S3] round=16 local utility u=0.058248 metrics={'f1_val': 0.8299754318385414, 'auprc': 0.9744109332895459, 'loss_val': 0.41641871805303876, 'psi': 0.8877496324189431}-{'f1_val': 0.811999572368236, 'auprc': 0.9830618351847322, 'loss_val': 0.45101163359043667, 'psi': 0.8804244774948344}
[S4] START round=16 head_norm_before_train=1.620487 cos_to_last_merge=0.9992 (last merge round=14)
[S4] round=16 local utility u=0.116973 metrics={'f1_val': 0.6132494986604777, 'auprc': 0.937445054883484, 'loss_val': 0.539892677258334, 'psi': 0.7429277211496802}-{'f1_val': 0.6183286800468201, 'auprc': 0.8489222914525136, 'loss_val': 0.5387453485959742, 'psi': 0.7105661246090975}
[S5] START round=16 head_norm_before_train=1.757656 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.700781124122831, 'auprc': 0.8560449149818643, 'loss_val': 0.374330511790198, 'psi': 0.7628866404664443}-{'f1_val': 0.700781124122831, 'auprc': 0.8701842538545267, 'loss_val': 0.38820082654160004, 'psi': 0.7685423760155092}
[S6] START round=16 head_norm_before_train=1.309759 cos_to_last_merge=0.8601 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.6672030744940314, 'auprc': 0.8170443098136289, 'loss_val': 0.4122444306512574, 'psi': 0.7271395686218703}-{'f1_val': 0.728710445469006, 'auprc': 0.9594833572175702, 'loss_val': 0.33326877546405087, 'psi': 0.8210196101684317}
[S7] START round=16 head_norm_before_train=1.669177 (no previous merge yet)
[S7] round=16 local utility u=0.425129 metrics={'f1_val': 0.596769066255078, 'auprc': 0.7922603596624128, 'loss_val': 0.6853055685871386, 'psi': 0.674965583618012}-{'f1_val': 0.5207535870496984, 'auprc': 0.7814029187095894, 'loss_val': 1.0468988577218565, 'psi': 0.6250133197136548}
[S8] START round=16 head_norm_before_train=1.375988 cos_to_last_merge=0.8527 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.853
[S8] round=16 local utility u=0.032463 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9960317049901557, 'loss_val': 0.14461819956428906, 'psi': 0.996224526957437}-{'f1_val': 0.9963530749356245, 'auprc': 0.9960602073445385, 'loss_val': 0.20962969646650279, 'psi': 0.9962359278991901}
[S9] START round=16 head_norm_before_train=1.354604 cos_to_last_merge=0.9971 (last merge round=14)
[S9] round=16 local utility u=0.103577 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9949895165846673, 'loss_val': 0.08144984055409057, 'psi': 0.9959921137222018}-{'f1_val': 0.978091755602868, 'auprc': 0.988019219093071, 'loss_val': 0.15627948028579822, 'psi': 0.9820627409989491}
[S10] START round=16 head_norm_before_train=1.477330 cos_to_last_merge=0.9968 (last merge round=13)
[S10] round=16 local utility u=0.009268 metrics={'f1_val': 0.8621702558937043, 'auprc': 0.9961802959235838, 'loss_val': 0.23856384449073642, 'psi': 0.9157742719056561}-{'f1_val': 0.8676064531566325, 'auprc': 0.9957554408195344, 'loss_val': 0.2884428921639642, 'psi': 0.9188660482217932}
[S11] START round=16 head_norm_before_train=1.258611 cos_to_last_merge=1.0000 (last merge round=15)
[S11] round=16 local utility u=0.004413 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9979639542779475, 'loss_val': 0.3852490076320967, 'psi': 0.8203467716901711}-{'f1_val': 0.7016282822309048, 'auprc': 0.9947967012851552, 'loss_val': 0.3827308393905456, 'psi': 0.818895649852605}
[S13] START round=16 head_norm_before_train=1.613952 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6160080607810272, 'auprc': 0.6023803560015628, 'loss_val': 0.5910418910782783, 'psi': 0.6105569788692414}-{'f1_val': 0.6239313844735572, 'auprc': 0.6255914439007273, 'loss_val': 0.5844614299344385, 'psi': 0.6245954082444253}
[S14] START round=16 head_norm_before_train=1.657561 cos_to_last_merge=0.9934 (last merge round=11)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.9552913044652784, 'auprc': 0.9969829092599503, 'loss_val': 0.2086684661017851, 'psi': 0.9719679463831471}-{'f1_val': 0.9974678030733966, 'auprc': 0.9929680677081626, 'loss_val': 0.2638138768141279, 'psi': 0.995667908927303}
[S15] START round=16 head_norm_before_train=1.643387 (no previous merge yet)
[S15] round=16 local utility u=0.076513 metrics={'f1_val': 0.6979118116511112, 'auprc': 0.9880362942653098, 'loss_val': 0.18305700708664877, 'psi': 0.8139616046967906}-{'f1_val': 0.7000194663246705, 'auprc': 0.9799393033150028, 'loss_val': 0.32443807096439276, 'psi': 0.8119874011208035}
[S16] START round=16 head_norm_before_train=1.723371 cos_to_last_merge=0.9996 (last merge round=14)
[S16] round=16 local utility u=0.145637 metrics={'f1_val': 0.9300253054130865, 'auprc': 0.9551411786468084, 'loss_val': 0.3028650578371807, 'psi': 0.9400716547065752}-{'f1_val': 0.9141397654187324, 'auprc': 0.9318652900430793, 'loss_val': 0.42899889667960955, 'psi': 0.9212299752684712}
[S17] START round=16 head_norm_before_train=1.614646 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.35351202434239126, 'auprc': 0.5300936204652723, 'loss_val': 0.9525902312423973, 'psi': 0.42414466279154367}-{'f1_val': 0.3534728608424502, 'auprc': 0.5278498821500774, 'loss_val': 0.9408404184387175, 'psi': 0.4232236693655011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S16] not sending this round → trigger blocked (psi=0.940)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.820)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:42014
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.814)
[S10] not sending this round → trigger blocked (psi=0.916)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.4649
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.0068
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.9700
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.7776
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=0.9547
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.8622 head_norm=1.511939
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.494019e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.9925 head_norm=1.567286 delta_norm=0.249402
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9553 head_norm=1.679270
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.054535e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9805 head_norm=1.665477 delta_norm=0.205453
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9967 head_norm=1.416911
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.827436e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9967 head_norm=1.362784 delta_norm=0.482744
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3535 head_norm=1.633735
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.993507e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3547 head_norm=1.088537 delta_norm=0.799351
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.405106 cos_to_last_merge=0.8166 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=17 local utility u=0.190782 metrics={'f1_val': 0.7074051138353924, 'auprc': 0.7762425158191391, 'loss_val': 0.5410158345925908, 'psi': 0.734940074628891}-{'f1_val': 0.6566684756305821, 'auprc': 0.7252066727520214, 'loss_val': 0.46505178705245687, 'psi': 0.6840837544791578}
[S3] START round=17 head_norm_before_train=1.474043 cos_to_last_merge=0.9795 (last merge round=14)
[S3] round=17 local utility u=0.137283 metrics={'f1_val': 0.8515133006788073, 'auprc': 0.9921508995889032, 'loss_val': 0.3242993478269989, 'psi': 0.9077683402428457}-{'f1_val': 0.8299754318385414, 'auprc': 0.9744109332895459, 'loss_val': 0.41641871805303876, 'psi': 0.8877496324189431}
[S4] START round=17 head_norm_before_train=1.658679 cos_to_last_merge=0.9971 (last merge round=14)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6126565797096294, 'auprc': 0.934243892704002, 'loss_val': 0.5516704102086062, 'psi': 0.7412915049073785}-{'f1_val': 0.6132494986604777, 'auprc': 0.937445054883484, 'loss_val': 0.539892677258334, 'psi': 0.7429277211496802}
[S5] START round=17 head_norm_before_train=1.768096 (no previous merge yet)
[S5] round=17 local utility u=0.290607 metrics={'f1_val': 0.7020603460463012, 'auprc': 0.9899653489931459, 'loss_val': 0.20255231341573196, 'psi': 0.8172223472250391}-{'f1_val': 0.700781124122831, 'auprc': 0.8560449149818643, 'loss_val': 0.374330511790198, 'psi': 0.7628866404664443}
[S6] START round=17 head_norm_before_train=1.345296 cos_to_last_merge=0.8542 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.9317904973386045, 'auprc': 0.9783535498422663, 'loss_val': 0.2654156457477013, 'psi': 0.9504157183400692}-{'f1_val': 0.6672030744940314, 'auprc': 0.8170443098136289, 'loss_val': 0.4122444306512574, 'psi': 0.7271395686218703}
[S7] START round=17 head_norm_before_train=1.676932 (no previous merge yet)
[S7] round=17 local utility u=0.205467 metrics={'f1_val': 0.6375312584767636, 'auprc': 0.8005471786702973, 'loss_val': 0.5438060721435525, 'psi': 0.7027376265541772}-{'f1_val': 0.596769066255078, 'auprc': 0.7922603596624128, 'loss_val': 0.6853055685871386, 'psi': 0.674965583618012}
[S8] START round=17 head_norm_before_train=1.412245 cos_to_last_merge=0.8457 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=17 local utility u=0.019626 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9972574395018668, 'loss_val': 0.10904241558044944, 'psi': 0.9967148207621215}-{'f1_val': 0.9963530749356245, 'auprc': 0.9960317049901557, 'loss_val': 0.14461819956428906, 'psi': 0.996224526957437}
[S9] START round=17 head_norm_before_train=1.362784 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9984590699247546, 'loss_val': 0.11658244567855769, 'psi': 0.9963978786183793}-{'f1_val': 0.9966605118138915, 'auprc': 0.9949895165846673, 'loss_val': 0.08144984055409057, 'psi': 0.9959921137222018}
[S10] START round=17 head_norm_before_train=1.567286 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.390134 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.996425103491329, 'loss_val': 0.2596657657460413, 'psi': 0.9959358335055435}-{'f1_val': 0.8621702558937043, 'auprc': 0.9961802959235838, 'loss_val': 0.23856384449073642, 'psi': 0.9157742719056561}
[S11] START round=17 head_norm_before_train=1.287362 cos_to_last_merge=0.9991 (last merge round=15)
[S11] round=17 local utility u=0.033864 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9978032660731166, 'loss_val': 0.317039418221326, 'psi': 0.8202824964082387}-{'f1_val': 0.7019353166316534, 'auprc': 0.9979639542779475, 'loss_val': 0.3852490076320967, 'psi': 0.8203467716901711}
[S13] START round=17 head_norm_before_train=1.631387 (no previous merge yet)
[S13] round=17 local utility u=0.068064 metrics={'f1_val': 0.6238515683938378, 'auprc': 0.6374627154224571, 'loss_val': 0.6072211923215096, 'psi': 0.6292960272052855}-{'f1_val': 0.6160080607810272, 'auprc': 0.6023803560015628, 'loss_val': 0.5910418910782783, 'psi': 0.6105569788692414}
[S14] START round=17 head_norm_before_train=1.665477 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.132373 metrics={'f1_val': 0.99727647169645, 'auprc': 0.9969396357468576, 'loss_val': 0.1957038145662742, 'psi': 0.997141737316613}-{'f1_val': 0.9552913044652784, 'auprc': 0.9969829092599503, 'loss_val': 0.2086684661017851, 'psi': 0.9719679463831471}
[S15] START round=17 head_norm_before_train=1.663337 (no previous merge yet)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6985694014092775, 'auprc': 0.9776542994062364, 'loss_val': 0.36178134938612583, 'psi': 0.8102033606080611}-{'f1_val': 0.6979118116511112, 'auprc': 0.9880362942653098, 'loss_val': 0.18305700708664877, 'psi': 0.8139616046967906}
[S16] START round=17 head_norm_before_train=1.759907 cos_to_last_merge=0.9984 (last merge round=14)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8747105851420626, 'auprc': 0.9855886553721271, 'loss_val': 0.550912967605539, 'psi': 0.9190618132340884}-{'f1_val': 0.9300253054130865, 'auprc': 0.9551411786468084, 'loss_val': 0.3028650578371807, 'psi': 0.9400716547065752}
[S17] START round=17 head_norm_before_train=1.088537 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.083667 metrics={'f1_val': 0.36211577730213795, 'auprc': 0.5688892293205393, 'loss_val': 0.9532662277872567, 'psi': 0.4448251581094985}-{'f1_val': 0.35351202434239126, 'auprc': 0.5300936204652723, 'loss_val': 0.9525902312423973, 'psi': 0.42414466279154367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:42016
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.908)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S8] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → trigger blocked (psi=0.703)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:42004
[S6] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=-0.0071
[S3] DROPPED delta from S10 (cos=-0.0071 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.9774
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=-0.0230
[S15] DROPPED delta from S14 (cos=-0.0230 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0333
[S13] DROPPED delta from S11 (cos=-0.0333 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9752
[S13] RECEIVED delta(kind=head bytes=1796) from S2
[S13] cosine check vs S2: cos=-0.1022
[S13] DROPPED delta from S2 (cos=-0.1022 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9761
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S17
[S3] cosine check vs S17: cos=0.8878
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=17 metric=0.8515 head_norm=1.550045
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.794119e-01
[S3] stored merged vector for next round verification (round=17)
[S3] DEBUG after merge:  round=17 metric=0.8530 head_norm=1.296777 delta_norm=0.379412
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.6127 head_norm=1.697227
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.793697e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.6129 head_norm=1.663015 delta_norm=0.179370
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.7019 head_norm=1.319441
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.518406e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.7019 head_norm=1.336716 delta_norm=0.151841
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.8747 head_norm=1.792547
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.953716e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.8710 head_norm=1.775477 delta_norm=0.195372
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.427179 cos_to_last_merge=0.8139 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7014839022085803, 'auprc': 0.6843138881003271, 'loss_val': 0.3207265686321826, 'psi': 0.694615896565279}-{'f1_val': 0.7074051138353924, 'auprc': 0.7762425158191391, 'loss_val': 0.5410158345925908, 'psi': 0.734940074628891}
[S3] START round=18 head_norm_before_train=1.296777 cos_to_last_merge=1.0000 (last merge round=17)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.7516046627852093, 'auprc': 0.9505776251555902, 'loss_val': 0.5571435700864027, 'psi': 0.8311938477333617}-{'f1_val': 0.8515133006788073, 'auprc': 0.9921508995889032, 'loss_val': 0.3242993478269989, 'psi': 0.9077683402428457}
[S4] START round=18 head_norm_before_train=1.663015 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.035069 metrics={'f1_val': 0.6193427983538496, 'auprc': 0.9325912950090831, 'loss_val': 0.5166910649417209, 'psi': 0.744642197015943}-{'f1_val': 0.6126565797096294, 'auprc': 0.934243892704002, 'loss_val': 0.5516704102086062, 'psi': 0.7412915049073785}
[S5] START round=18 head_norm_before_train=1.779819 (no previous merge yet)
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7020607518057955, 'auprc': 0.9878549931520342, 'loss_val': 0.20659076698471157, 'psi': 0.816378448344291}-{'f1_val': 0.7020603460463012, 'auprc': 0.9899653489931459, 'loss_val': 0.20255231341573196, 'psi': 0.8172223472250391}
[S6] START round=18 head_norm_before_train=1.370696 cos_to_last_merge=0.8505 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.46690778815659495, 'auprc': 0.72588155648394, 'loss_val': 0.7613989772971728, 'psi': 0.5704972954875329}-{'f1_val': 0.9317904973386045, 'auprc': 0.9783535498422663, 'loss_val': 0.2654156457477013, 'psi': 0.9504157183400692}
[S7] START round=18 head_norm_before_train=1.689474 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6242894576973365, 'auprc': 0.7990044581848041, 'loss_val': 0.5385741543152124, 'psi': 0.6941754578923236}-{'f1_val': 0.6375312584767636, 'auprc': 0.8005471786702973, 'loss_val': 0.5438060721435525, 'psi': 0.7027376265541772}
[S8] START round=18 head_norm_before_train=1.450736 cos_to_last_merge=0.8392 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.839
[S8] round=18 local utility u=0.003862 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9982534174174174, 'loss_val': 0.10430687561699614, 'psi': 0.9971132119283417}-{'f1_val': 0.9963530749356245, 'auprc': 0.9972574395018668, 'loss_val': 0.10904241558044944, 'psi': 0.9967148207621215}
[S9] START round=18 head_norm_before_train=1.432642 cos_to_last_merge=0.9968 (last merge round=16)
[S9] round=18 local utility u=0.003771 metrics={'f1_val': 0.9903801002864661, 'auprc': 0.9983991062469323, 'loss_val': 0.08099905868048157, 'psi': 0.9935877026706526}-{'f1_val': 0.9950237510807955, 'auprc': 0.9984590699247546, 'loss_val': 0.11658244567855769, 'psi': 0.9963978786183793}
[S10] START round=18 head_norm_before_train=1.601779 cos_to_last_merge=0.9994 (last merge round=16)
[S10] round=18 local utility u=0.047570 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9965329764330326, 'loss_val': 0.162171914843205, 'psi': 0.9957111718013858}-{'f1_val': 0.9956096535150197, 'auprc': 0.996425103491329, 'loss_val': 0.2596657657460413, 'psi': 0.9959358335055435}
[S11] START round=18 head_norm_before_train=1.336716 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=0.738964 metrics={'f1_val': 0.9451825552469971, 'auprc': 0.9976105704660148, 'loss_val': 0.29801707355744356, 'psi': 0.9661537613346042}-{'f1_val': 0.7019353166316534, 'auprc': 0.9978032660731166, 'loss_val': 0.317039418221326, 'psi': 0.8202824964082387}
[S13] START round=18 head_norm_before_train=1.647727 (no previous merge yet)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.6156235605190526, 'auprc': 0.6215123482190718, 'loss_val': 0.5745781968250768, 'psi': 0.6179790755990603}-{'f1_val': 0.6238515683938378, 'auprc': 0.6374627154224571, 'loss_val': 0.6072211923215096, 'psi': 0.6292960272052855}
[S14] START round=18 head_norm_before_train=1.690941 cos_to_last_merge=0.9997 (last merge round=16)
[S14] round=18 local utility u=0.020075 metrics={'f1_val': 0.9950002216535363, 'auprc': 0.9969499569834221, 'loss_val': 0.14192749761726034, 'psi': 0.9957801157854906}-{'f1_val': 0.99727647169645, 'auprc': 0.9969396357468576, 'loss_val': 0.1957038145662742, 'psi': 0.997141737316613}
[S15] START round=18 head_norm_before_train=1.684962 (no previous merge yet)
[S15] round=18 local utility u=0.064869 metrics={'f1_val': 0.6959038745817501, 'auprc': 0.9877936345042223, 'loss_val': 0.2464673065611575, 'psi': 0.812659778550739}-{'f1_val': 0.6985694014092775, 'auprc': 0.9776542994062364, 'loss_val': 0.36178134938612583, 'psi': 0.8102033606080611}
[S16] START round=18 head_norm_before_train=1.775477 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=0.139652 metrics={'f1_val': 0.9051513102842137, 'auprc': 0.9884776350204855, 'loss_val': 0.4629209806924106, 'psi': 0.9384818401787224}-{'f1_val': 0.8747105851420626, 'auprc': 0.9855886553721271, 'loss_val': 0.550912967605539, 'psi': 0.9190618132340884}
[S17] START round=18 head_norm_before_train=1.117375 cos_to_last_merge=0.9973 (last merge round=16)
[S17] round=18 local utility u=0.013523 metrics={'f1_val': 0.35413197831898446, 'auprc': 0.5897635220563613, 'loss_val': 0.9409412041721497, 'psi': 0.4483845958139352}-{'f1_val': 0.36211577730213795, 'auprc': 0.5688892293205393, 'loss_val': 0.9532662277872567, 'psi': 0.4448251581094985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S14] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → trigger blocked (psi=0.966)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:42011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:42017
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S15
[S11] cosine check vs S15: cos=-0.0171
[S11] DROPPED delta from S15 (cos=-0.0171 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=0.9736
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.3018
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.7910
[S17] RECEIVED delta(kind=head bytes=1803) from S16
[S17] cosine check vs S16: cos=0.8656
[S17] not sending this round → trigger blocked (psi=0.448)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=18 metric=0.9952 head_norm=1.640642
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.937344e-01
[S10] stored merged vector for next round verification (round=18)
[S10] DEBUG after merge:  round=18 metric=0.9951 head_norm=1.656979 delta_norm=0.193734
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=18 metric=0.3541 head_norm=1.154359
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.678781e-01
[S17] stored merged vector for next round verification (round=18)
[S17] DEBUG after merge:  round=18 metric=0.3688 head_norm=1.177888 delta_norm=0.167878
[S17] aggregate: ACCEPT kept=['S8', 'S9', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.445543 cos_to_last_merge=0.8114 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=19 local utility u=0.221353 metrics={'f1_val': 0.7017875202698274, 'auprc': 0.8502206389745418, 'loss_val': 0.3775632454617741, 'psi': 0.7611607677517132}-{'f1_val': 0.7014839022085803, 'auprc': 0.6843138881003271, 'loss_val': 0.3207265686321826, 'psi': 0.694615896565279}
[S3] START round=19 head_norm_before_train=1.369704 cos_to_last_merge=0.9974 (last merge round=17)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7272892324504086, 'auprc': 0.9358525630252981, 'loss_val': 0.6258069424818952, 'psi': 0.8107145646803644}-{'f1_val': 0.7516046627852093, 'auprc': 0.9505776251555902, 'loss_val': 0.5571435700864027, 'psi': 0.8311938477333617}
[S4] START round=19 head_norm_before_train=1.695442 cos_to_last_merge=0.9996 (last merge round=17)
[S4] round=19 local utility u=0.002778 metrics={'f1_val': 0.6215628444477919, 'auprc': 0.9332745074410861, 'loss_val': 0.526504157453006, 'psi': 0.7462475096451096}-{'f1_val': 0.6193427983538496, 'auprc': 0.9325912950090831, 'loss_val': 0.5166910649417209, 'psi': 0.744642197015943}
[S5] START round=19 head_norm_before_train=1.792489 (no previous merge yet)
[S5] round=19 local utility u=0.544031 metrics={'f1_val': 0.8715007937291794, 'auprc': 0.9922280428114707, 'loss_val': 0.1482877168354142, 'psi': 0.919791693362096}-{'f1_val': 0.7020607518057955, 'auprc': 0.9878549931520342, 'loss_val': 0.20659076698471157, 'psi': 0.816378448344291}
[S6] START round=19 head_norm_before_train=1.382723 cos_to_last_merge=0.8494 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.9621847483074051, 'auprc': 0.9719819778268479, 'loss_val': 0.1927657233289083, 'psi': 0.9661036401151822}-{'f1_val': 0.46690778815659495, 'auprc': 0.72588155648394, 'loss_val': 0.7613989772971728, 'psi': 0.5704972954875329}
[S7] START round=19 head_norm_before_train=1.697268 (no previous merge yet)
[S7] round=19 local utility u=0.196779 metrics={'f1_val': 0.6585682588433459, 'auprc': 0.8107701045916298, 'loss_val': 0.3859862000201001, 'psi': 0.7194489971426594}-{'f1_val': 0.6242894576973365, 'auprc': 0.7990044581848041, 'loss_val': 0.5385741543152124, 'psi': 0.6941754578923236}
[S8] START round=19 head_norm_before_train=1.488705 cos_to_last_merge=0.8341 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.834
[S8] round=19 local utility u=0.007449 metrics={'f1_val': 0.9945115937032949, 'auprc': 0.9974165592336393, 'loss_val': 0.0758493851791531, 'psi': 0.9956735799154326}-{'f1_val': 0.9963530749356245, 'auprc': 0.9982534174174174, 'loss_val': 0.10430687561699614, 'psi': 0.9971132119283417}
[S9] START round=19 head_norm_before_train=1.508682 cos_to_last_merge=0.9894 (last merge round=16)
[S9] round=19 local utility u=0.028900 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958425163567022, 'loss_val': 0.053211835923952636, 'psi': 0.9963333136310157}-{'f1_val': 0.9903801002864661, 'auprc': 0.9983991062469323, 'loss_val': 0.08099905868048157, 'psi': 0.9935877026706526}
[S10] START round=19 head_norm_before_train=1.656979 cos_to_last_merge=1.0000 (last merge round=18)
[S10] round=19 local utility u=0.000636 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9971106225231301, 'loss_val': 0.1614622549722851, 'psi': 0.9958251609282978}-{'f1_val': 0.9951633020469546, 'auprc': 0.9965329764330326, 'loss_val': 0.162171914843205, 'psi': 0.9957111718013858}
[S11] START round=19 head_norm_before_train=1.367620 cos_to_last_merge=0.9989 (last merge round=17)
[S11] round=19 local utility u=0.077823 metrics={'f1_val': 0.9592161590226278, 'auprc': 0.9979074572443747, 'loss_val': 0.22746340703719742, 'psi': 0.9746926783113266}-{'f1_val': 0.9451825552469971, 'auprc': 0.9976105704660148, 'loss_val': 0.29801707355744356, 'psi': 0.9661537613346042}
[S13] START round=19 head_norm_before_train=1.662483 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5904185072638242, 'auprc': 0.675400191301308, 'loss_val': 0.7838394871833295, 'psi': 0.6244111808788178}-{'f1_val': 0.6156235605190526, 'auprc': 0.6215123482190718, 'loss_val': 0.5745781968250768, 'psi': 0.6179790755990603}
[S14] START round=19 head_norm_before_train=1.725853 cos_to_last_merge=0.9987 (last merge round=16)
[S14] round=19 local utility u=0.020496 metrics={'f1_val': 0.9968429160880343, 'auprc': 0.9970620949250075, 'loss_val': 0.11232791802581983, 'psi': 0.9969305876228236}-{'f1_val': 0.9950002216535363, 'auprc': 0.9969499569834221, 'loss_val': 0.14192749761726034, 'psi': 0.9957801157854906}
[S15] START round=19 head_norm_before_train=1.704353 (no previous merge yet)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7010233509369124, 'auprc': 0.9551936703251451, 'loss_val': 0.44092673686116907, 'psi': 0.8026914786922055}-{'f1_val': 0.6959038745817501, 'auprc': 0.9877936345042223, 'loss_val': 0.2464673065611575, 'psi': 0.812659778550739}
[S16] START round=19 head_norm_before_train=1.805498 cos_to_last_merge=0.9997 (last merge round=17)
[S16] round=19 local utility u=0.213643 metrics={'f1_val': 0.9394393528024225, 'auprc': 0.9869539933101982, 'loss_val': 0.23679194266496567, 'psi': 0.9584452090055329}-{'f1_val': 0.9051513102842137, 'auprc': 0.9884776350204855, 'loss_val': 0.4629209806924106, 'psi': 0.9384818401787224}
[S17] START round=19 head_norm_before_train=1.177888 cos_to_last_merge=1.0000 (last merge round=18)
[S17] round=19 local utility u=0.042198 metrics={'f1_val': 0.35770957994852526, 'auprc': 0.6127762870487012, 'loss_val': 0.9470487537269059, 'psi': 0.4597362627885957}-{'f1_val': 0.35413197831898446, 'auprc': 0.5897635220563613, 'loss_val': 0.9409412041721497, 'psi': 0.4483845958139352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S16] not sending this round → trigger blocked (psi=0.958)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:42016
[S8] not sending this round → trigger blocked (psi=0.996)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:42003
[S9] not sending this round → trigger blocked (psi=0.996)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[S4] not sending this round → trigger blocked (psi=0.746)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S2
[S13] cosine check vs S2: cos=-0.1047
[S13] DROPPED delta from S2 (cos=-0.1047 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S11
[S13] cosine check vs S11: cos=-0.0339
[S13] DROPPED delta from S11 (cos=-0.0339 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9805
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.9879
[S3] RECEIVED delta(kind=head bytes=1802) from S10
[S3] cosine check vs S10: cos=0.0700
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=-0.0237
[S15] DROPPED delta from S14 (cos=-0.0237 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9829
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.9494
[S15] r=20 psi=0.803 u=0.0000 p_local=0.0855 f1=0.701 auprc=0.955 bytes=14370
[S4] r=20 psi=0.746 u=0.0028 p_local=0.0837 f1=0.622 auprc=0.933 bytes=14368
[S13] r=20 psi=0.624 u=0.0000 p_local=0.0712 f1=0.590 auprc=0.675 bytes=14365
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=19 metric=0.7273 head_norm=1.440485
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.101693e-01
[S3] stored merged vector for next round verification (round=19)
[S3] DEBUG after merge:  round=19 metric=0.7300 head_norm=1.133501 delta_norm=0.610169
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] r=20 psi=0.811 u=0.0000 p_local=0.1412 f1=0.727 auprc=0.936 bytes=14388
[S8] r=20 psi=0.996 u=0.0074 p_local=0.1794 f1=0.995 auprc=0.997 bytes=16173
[S9] r=20 psi=0.996 u=0.0289 p_local=0.0694 f1=0.997 auprc=0.996 bytes=14387
[S10] r=20 psi=0.996 u=0.0006 p_local=0.1753 f1=0.995 auprc=0.997 bytes=16178
[S5] r=20 psi=0.920 u=0.5440 p_local=0.1979 f1=0.872 auprc=0.992 bytes=14406
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9968 head_norm=1.764602
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.628692e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9968 head_norm=1.730022 delta_norm=0.162869
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] r=20 psi=0.997 u=0.0205 p_local=0.1440 f1=0.997 auprc=0.997 bytes=14386
[S7] r=20 psi=0.719 u=0.1968 p_local=0.1533 f1=0.659 auprc=0.811 bytes=14399
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9592 head_norm=1.407430
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.383178e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9592 head_norm=1.392708 delta_norm=0.138318
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.975 u=0.0778 p_local=0.2082 f1=0.959 auprc=0.998 bytes=16168
[S2] r=20 psi=0.761 u=0.2214 p_local=0.1218 f1=0.702 auprc=0.850 bytes=12575
[S6] r=20 psi=0.966 u=1.0000 p_local=0.4162 f1=0.962 auprc=0.972 bytes=16173
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=19 metric=0.9394 head_norm=1.835561
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.423094e-01
[S16] stored merged vector for next round verification (round=19)
[S16] DEBUG after merge:  round=19 metric=0.9382 head_norm=1.814206 delta_norm=0.142309
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] r=20 psi=0.958 u=0.2136 p_local=0.2165 f1=0.939 auprc=0.987 bytes=14383
[S17] r=20 psi=0.460 u=0.0422 p_local=0.0806 f1=0.358 auprc=0.613 bytes=16168
[S2] START round=20 head_norm_before_train=1.461251 cos_to_last_merge=0.8099 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.714341145447683, 'auprc': 0.7790942274691022, 'loss_val': 0.7953323439797455, 'psi': 0.7402423782562506}-{'f1_val': 0.7017875202698274, 'auprc': 0.8502206389745418, 'loss_val': 0.3775632454617741, 'psi': 0.7611607677517132}
[S3] START round=20 head_norm_before_train=1.133501 cos_to_last_merge=1.0000 (last merge round=19)
[S3] round=20 local utility u=0.302449 metrics={'f1_val': 0.8073230811929403, 'auprc': 0.9388036371446997, 'loss_val': 0.5099659096699695, 'psi': 0.859915303573644}-{'f1_val': 0.7272892324504086, 'auprc': 0.9358525630252981, 'loss_val': 0.6258069424818952, 'psi': 0.8107145646803644}
[S4] START round=20 head_norm_before_train=1.726509 cos_to_last_merge=0.9985 (last merge round=17)
[S4] round=20 local utility u=1.000000 metrics={'f1_val': 0.9457438213480022, 'auprc': 0.9421736369516074, 'loss_val': 0.4149913877119504, 'psi': 0.9443157475894444}-{'f1_val': 0.6215628444477919, 'auprc': 0.9332745074410861, 'loss_val': 0.526504157453006, 'psi': 0.7462475096451096}
[S5] START round=20 head_norm_before_train=1.803859 (no previous merge yet)
[S5] round=20 local utility u=0.246414 metrics={'f1_val': 0.9525902071043484, 'auprc': 0.9923632506657949, 'loss_val': 0.14240112026591845, 'psi': 0.9684994245289269}-{'f1_val': 0.8715007937291794, 'auprc': 0.9922280428114707, 'loss_val': 0.1482877168354142, 'psi': 0.919791693362096}
[S6] START round=20 head_norm_before_train=1.391645 cos_to_last_merge=0.8486 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8226182044330819, 'auprc': 0.9428721340588946, 'loss_val': 0.41368027994139267, 'psi': 0.8707197762834069}-{'f1_val': 0.9621847483074051, 'auprc': 0.9719819778268479, 'loss_val': 0.1927657233289083, 'psi': 0.9661036401151822}
[S7] START round=20 head_norm_before_train=1.710317 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.6262402320319762, 'auprc': 0.799827106371743, 'loss_val': 0.6085510727130358, 'psi': 0.6956749817678829}-{'f1_val': 0.6585682588433459, 'auprc': 0.8107701045916298, 'loss_val': 0.3859862000201001, 'psi': 0.7194489971426594}
[S8] START round=20 head_norm_before_train=1.520886 cos_to_last_merge=0.8299 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=20 local utility u=0.011700 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9991700779913865, 'loss_val': 0.06785895467132945, 'psi': 0.9973898932366463}-{'f1_val': 0.9945115937032949, 'auprc': 0.9974165592336393, 'loss_val': 0.0758493851791531, 'psi': 0.9956735799154326}
[S9] START round=20 head_norm_before_train=1.571140 cos_to_last_merge=0.9824 (last merge round=16)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.998393729721309, 'loss_val': 0.046924814131127014, 'psi': 0.9958535519121976}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958425163567022, 'loss_val': 0.053211835923952636, 'psi': 0.9963333136310157}
[S10] START round=20 head_norm_before_train=1.691303 cos_to_last_merge=0.9995 (last merge round=18)
[S10] round=20 local utility u=0.017955 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9972792659513832, 'loss_val': 0.12605827448067686, 'psi': 0.995892618299599}-{'f1_val': 0.9949681865317428, 'auprc': 0.9971106225231301, 'loss_val': 0.1614622549722851, 'psi': 0.9958251609282978}
[S11] START round=20 head_norm_before_train=1.392708 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.119772 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9978853732064054, 'loss_val': 0.21419945701442597, 'psi': 0.9973185634522967}-{'f1_val': 0.9592161590226278, 'auprc': 0.9979074572443747, 'loss_val': 0.22746340703719742, 'psi': 0.9746926783113266}
[S13] START round=20 head_norm_before_train=1.677426 (no previous merge yet)
[S13] round=20 local utility u=0.220923 metrics={'f1_val': 0.635201162828416, 'auprc': 0.6520663452969612, 'loss_val': 0.5406870041767399, 'psi': 0.641947235815834}-{'f1_val': 0.5904185072638242, 'auprc': 0.675400191301308, 'loss_val': 0.7838394871833295, 'psi': 0.6244111808788178}
[S14] START round=20 head_norm_before_train=1.730022 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.008503 metrics={'f1_val': 0.998062872566559, 'auprc': 0.9986518244535854, 'loss_val': 0.10741030189862083, 'psi': 0.9982984533213695}-{'f1_val': 0.9968429160880343, 'auprc': 0.9970620949250075, 'loss_val': 0.11232791802581983, 'psi': 0.9969305876228236}
[S15] START round=20 head_norm_before_train=1.721863 (no previous merge yet)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.9863131042187415, 'auprc': 0.9911617604338306, 'loss_val': 0.13114350565625793, 'psi': 0.9882525667047772}-{'f1_val': 0.7010233509369124, 'auprc': 0.9551936703251451, 'loss_val': 0.44092673686116907, 'psi': 0.8026914786922055}
[S16] START round=20 head_norm_before_train=1.814206 cos_to_last_merge=1.0000 (last merge round=19)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8870531721902959, 'auprc': 0.9900307331171967, 'loss_val': 0.5026703860373275, 'psi': 0.9282441965610562}-{'f1_val': 0.9394393528024225, 'auprc': 0.9869539933101982, 'loss_val': 0.23679194266496567, 'psi': 0.9584452090055329}
[S17] START round=20 head_norm_before_train=1.209755 cos_to_last_merge=0.9980 (last merge round=18)
[S17] round=20 local utility u=0.069896 metrics={'f1_val': 0.36006707149889616, 'auprc': 0.6541543713730968, 'loss_val': 0.945536700688937, 'psi': 0.4777019914485764}-{'f1_val': 0.35770957994852526, 'auprc': 0.6127762870487012, 'loss_val': 0.9470487537269059, 'psi': 0.4597362627885957}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:42016
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:42011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S10
[S3] cosine check vs S10: cos=0.4278
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=-0.0327
[S13] DROPPED delta from S11 (cos=-0.0327 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.2561
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.9836
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=-0.0226
[S15] DROPPED delta from S14 (cos=-0.0226 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S3
[S9] cosine check vs S3: cos=0.7966
[S16] RECEIVED delta(kind=head bytes=1803) from S5
[S16] cosine check vs S5: cos=0.9950
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=-0.0170
[S11] DROPPED delta from S15 (cos=-0.0170 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.9871
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1800) from S17
[S3] cosine check vs S17: cos=0.9140
[S7] ⇄ pheromone p=0.123 → S14@127.0.0.1:42014
[S6] ⇄ pheromone p=0.333 → S11@127.0.0.1:42012
[S2] ⇄ pheromone p=0.097 → S13@127.0.0.1:42013
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9942 head_norm=1.618084
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.903347e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9937 head_norm=1.345623 delta_norm=0.490335
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.055 → S17@127.0.0.1:42017
[S14] ⇄ pheromone p=0.117 → S15@127.0.0.1:42015
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=20 metric=0.8073 head_norm=1.218221
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.509859e-01
[S3] stored merged vector for next round verification (round=20)
[S3] DEBUG after merge:  round=20 metric=0.8083 head_norm=1.124827 delta_norm=0.350986
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.173 → S9@127.0.0.1:42010
[S13] ⇄ pheromone p=0.101 → S4@127.0.0.1:42004
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9950 head_norm=1.726005
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.399435e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9950 head_norm=1.732946 delta_norm=0.139944
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.144 → S3@127.0.0.1:42003
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9457 head_norm=1.751080
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.588413e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9459 head_norm=1.711598 delta_norm=0.158841
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.267 → S10@127.0.0.1:42011
[S11] ⇄ pheromone p=0.191 → S13@127.0.0.1:42013
[S15] ⇄ pheromone p=0.268 → S11@127.0.0.1:42012
[S5] ⇄ pheromone p=0.208 → S16@127.0.0.1:42016
[S8] ⇄ pheromone p=0.146 → S17@127.0.0.1:42017
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8871 head_norm=1.839790
[S16] _apply_head_vector_avg (torch): Δ‖w‖=9.272631e-02
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8847 head_norm=1.823732 delta_norm=0.092726
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.173 → S17@127.0.0.1:42017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=20 metric=0.3601 head_norm=1.243484
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.599941e-01
[S17] stored merged vector for next round verification (round=20)
[S17] DEBUG after merge:  round=20 metric=0.3538 head_norm=1.110344 delta_norm=0.859994
[S17] aggregate: ROLLBACK (f1_val pre=0.360 post=0.354 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.078 → S3@127.0.0.1:42003
[S2] START round=21 head_norm_before_train=1.472715 cos_to_last_merge=0.8091 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=21 local utility u=0.509505 metrics={'f1_val': 0.8080351446845702, 'auprc': 0.7828894674348249, 'loss_val': 0.3498730528858729, 'psi': 0.7979768737846721}-{'f1_val': 0.714341145447683, 'auprc': 0.7790942274691022, 'loss_val': 0.7953323439797455, 'psi': 0.7402423782562506}
[S3] START round=21 head_norm_before_train=1.124827 cos_to_last_merge=1.0000 (last merge round=20)
[S3] round=21 local utility u=0.380869 metrics={'f1_val': 0.885086900708477, 'auprc': 0.9807597358746714, 'loss_val': 0.3406795340370659, 'psi': 0.9233560347749548}-{'f1_val': 0.8073230811929403, 'auprc': 0.9388036371446997, 'loss_val': 0.5099659096699695, 'psi': 0.859915303573644}
[S4] START round=21 head_norm_before_train=1.711598 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.031636 metrics={'f1_val': 0.9444621935550597, 'auprc': 0.9474647662898552, 'loss_val': 0.3599038624938079, 'psi': 0.9456632226489778}-{'f1_val': 0.9457438213480022, 'auprc': 0.9421736369516074, 'loss_val': 0.4149913877119504, 'psi': 0.9443157475894444}
[S5] START round=21 head_norm_before_train=1.812281 (no previous merge yet)
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.700868080518019, 'auprc': 0.9868457360212569, 'loss_val': 0.28767913386916794, 'psi': 0.8152591427193141}-{'f1_val': 0.9525902071043484, 'auprc': 0.9923632506657949, 'loss_val': 0.14240112026591845, 'psi': 0.9684994245289269}
[S6] START round=21 head_norm_before_train=1.400819 cos_to_last_merge=0.8478 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.848
[S6] round=21 local utility u=0.498720 metrics={'f1_val': 0.9487164103480986, 'auprc': 0.9638987754708872, 'loss_val': 0.2359098468868186, 'psi': 0.9547893563972141}-{'f1_val': 0.8226182044330819, 'auprc': 0.9428721340588946, 'loss_val': 0.41368027994139267, 'psi': 0.8707197762834069}
[S7] START round=21 head_norm_before_train=1.723938 (no previous merge yet)
[S7] round=21 local utility u=0.204166 metrics={'f1_val': 0.6546430241290359, 'auprc': 0.8138866141287265, 'loss_val': 0.4128150110373459, 'psi': 0.7183404601289121}-{'f1_val': 0.6262402320319762, 'auprc': 0.799827106371743, 'loss_val': 0.6085510727130358, 'psi': 0.6956749817678829}
[S8] START round=21 head_norm_before_train=1.548759 cos_to_last_merge=0.8259 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.826
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9941443971419754, 'auprc': 0.9973252981357162, 'loss_val': 0.06675773268791806, 'psi': 0.9954167575394717}-{'f1_val': 0.9962031034001528, 'auprc': 0.9991700779913865, 'loss_val': 0.06785895467132945, 'psi': 0.9973898932366463}
[S9] START round=21 head_norm_before_train=1.345623 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982478947433551, 'loss_val': 0.09258140956028092, 'psi': 0.9975609054046277}-{'f1_val': 0.9941601000394567, 'auprc': 0.998393729721309, 'loss_val': 0.046924814131127014, 'psi': 0.9958535519121976}
[S10] START round=21 head_norm_before_train=1.732946 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.994243089309356, 'auprc': 0.9972450656842743, 'loss_val': 0.12184718343938604, 'psi': 0.9954438798593234}-{'f1_val': 0.9949681865317428, 'auprc': 0.9972792659513832, 'loss_val': 0.12605827448067686, 'psi': 0.995892618299599}
[S11] START round=21 head_norm_before_train=1.431903 cos_to_last_merge=0.9988 (last merge round=19)
[S11] round=21 local utility u=0.021870 metrics={'f1_val': 0.9954982291663762, 'auprc': 0.9977521145807956, 'loss_val': 0.16140582003531553, 'psi': 0.9963997833321439}-{'f1_val': 0.9969406902828911, 'auprc': 0.9978853732064054, 'loss_val': 0.21419945701442597, 'psi': 0.9973185634522967}
[S13] START round=21 head_norm_before_train=1.686213 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6154284909389657, 'auprc': 0.6750639941382677, 'loss_val': 0.6376564715308003, 'psi': 0.6392826922186865}-{'f1_val': 0.635201162828416, 'auprc': 0.6520663452969612, 'loss_val': 0.5406870041767399, 'psi': 0.641947235815834}
[S14] START round=21 head_norm_before_train=1.764872 cos_to_last_merge=0.9996 (last merge round=19)
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9933275795315845, 'auprc': 0.9970617595504998, 'loss_val': 0.09183955052283736, 'psi': 0.9948212515391506}-{'f1_val': 0.998062872566559, 'auprc': 0.9986518244535854, 'loss_val': 0.10741030189862083, 'psi': 0.9982984533213695}
[S15] START round=21 head_norm_before_train=1.735632 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7011977867787224, 'auprc': 0.8587233482800558, 'loss_val': 0.4541283511641379, 'psi': 0.7642080113792558}-{'f1_val': 0.9863131042187415, 'auprc': 0.9911617604338306, 'loss_val': 0.13114350565625793, 'psi': 0.9882525667047772}
[S16] START round=21 head_norm_before_train=1.823732 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.170494 metrics={'f1_val': 0.9207912400451783, 'auprc': 0.9894534278564828, 'loss_val': 0.3623788462445871, 'psi': 0.9482561151697001}-{'f1_val': 0.8870531721902959, 'auprc': 0.9900307331171967, 'loss_val': 0.5026703860373275, 'psi': 0.9282441965610562}
[S17] START round=21 head_norm_before_train=1.110344 cos_to_last_merge=1.0000 (last merge round=20)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.35406388426773305, 'auprc': 0.634910276859509, 'loss_val': 0.9429621982729984, 'psi': 0.4664024413044434}-{'f1_val': 0.36006707149889616, 'auprc': 0.6541543713730968, 'loss_val': 0.945536700688937, 'psi': 0.4777019914485764}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.996)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.923)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.946)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=-0.1040
[S13] DROPPED delta from S2 (cos=-0.1040 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9824
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.5052
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9895
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9933 head_norm=1.797368
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.315292e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9937 head_norm=1.763149 delta_norm=0.131529
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9955 head_norm=1.473760
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.385403e-01
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9948 head_norm=1.437728 delta_norm=0.138540
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3541 head_norm=1.136895
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.049896e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3573 head_norm=1.308117 delta_norm=0.804990
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.481429 cos_to_last_merge=0.8085 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.691478594951875, 'auprc': 0.8229312248704147, 'loss_val': 0.3574010430871853, 'psi': 0.7440596469192908}-{'f1_val': 0.8080351446845702, 'auprc': 0.7828894674348249, 'loss_val': 0.3498730528858729, 'psi': 0.7979768737846721}
[S3] START round=22 head_norm_before_train=1.225475 cos_to_last_merge=0.9916 (last merge round=20)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.6676719371385642, 'auprc': 0.847574078092777, 'loss_val': 0.8212666113445031, 'psi': 0.7396327935202494}-{'f1_val': 0.885086900708477, 'auprc': 0.9807597358746714, 'loss_val': 0.3406795340370659, 'psi': 0.9233560347749548}
[S4] START round=22 head_norm_before_train=1.733176 cos_to_last_merge=0.9998 (last merge round=20)
[S4] round=22 local utility u=0.011209 metrics={'f1_val': 0.9427334499140565, 'auprc': 0.9506923620176814, 'loss_val': 0.33679522983409105, 'psi': 0.9459170147555065}-{'f1_val': 0.9444621935550597, 'auprc': 0.9474647662898552, 'loss_val': 0.3599038624938079, 'psi': 0.9456632226489778}
[S5] START round=22 head_norm_before_train=1.818030 (no previous merge yet)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.5145852226752686, 'auprc': 0.8212273730831247, 'loss_val': 0.8766008299722384, 'psi': 0.6372420828384111}-{'f1_val': 0.700868080518019, 'auprc': 0.9868457360212569, 'loss_val': 0.28767913386916794, 'psi': 0.8152591427193141}
[S6] START round=22 head_norm_before_train=1.414405 cos_to_last_merge=0.8469 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.847
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.5676711868414396, 'auprc': 0.7779678603241822, 'loss_val': 0.8126411332647931, 'psi': 0.6517898562345367}-{'f1_val': 0.9487164103480986, 'auprc': 0.9638987754708872, 'loss_val': 0.2359098468868186, 'psi': 0.9547893563972141}
[S7] START round=22 head_norm_before_train=1.738233 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6080190843116029, 'auprc': 0.7949492260645926, 'loss_val': 0.6915353832884217, 'psi': 0.6827911410127988}-{'f1_val': 0.6546430241290359, 'auprc': 0.8138866141287265, 'loss_val': 0.4128150110373459, 'psi': 0.7183404601289121}
[S8] START round=22 head_norm_before_train=1.568726 cos_to_last_merge=0.8224 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=22 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9979869366689816, 'loss_val': 0.2343249612057875, 'psi': 0.8277382379062901}-{'f1_val': 0.9941443971419754, 'auprc': 0.9973252981357162, 'loss_val': 0.06675773268791806, 'psi': 0.9954167575394717}
[S9] START round=22 head_norm_before_train=1.407880 cos_to_last_merge=0.9980 (last merge round=20)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9846069371183261, 'auprc': 0.99838904828321, 'loss_val': 0.09357978600803753, 'psi': 0.9901197815842797}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982478947433551, 'loss_val': 0.09258140956028092, 'psi': 0.9975609054046277}
[S10] START round=22 head_norm_before_train=1.766171 cos_to_last_merge=0.9995 (last merge round=20)
[S10] round=22 local utility u=0.010717 metrics={'f1_val': 0.9938290824763921, 'auprc': 0.9973190861096605, 'loss_val': 0.09815163955353413, 'psi': 0.9952250839296994}-{'f1_val': 0.994243089309356, 'auprc': 0.9972450656842743, 'loss_val': 0.12184718343938604, 'psi': 0.9954438798593234}
[S11] START round=22 head_norm_before_train=1.437728 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.008221 metrics={'f1_val': 0.9966988539245482, 'auprc': 0.9973695300474184, 'loss_val': 0.15102059253909797, 'psi': 0.9969671243736962}-{'f1_val': 0.9954982291663762, 'auprc': 0.9977521145807956, 'loss_val': 0.16140582003531553, 'psi': 0.9963997833321439}
[S13] START round=22 head_norm_before_train=1.695506 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.6056735989475873, 'auprc': 0.6763520891312729, 'loss_val': 0.7513308140314259, 'psi': 0.6339449950210615}-{'f1_val': 0.6154284909389657, 'auprc': 0.6750639941382677, 'loss_val': 0.6376564715308003, 'psi': 0.6392826922186865}
[S14] START round=22 head_norm_before_train=1.763149 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.015664 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9969402441838464, 'loss_val': 0.08476849577372542, 'psi': 0.9972347279779162}-{'f1_val': 0.9933275795315845, 'auprc': 0.9970617595504998, 'loss_val': 0.09183955052283736, 'psi': 0.9948212515391506}
[S15] START round=22 head_norm_before_train=1.751735 (no previous merge yet)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9891442489251623, 'auprc': 0.9917511018346523, 'loss_val': 0.11098274037268294, 'psi': 0.9901869900889584}-{'f1_val': 0.7011977867787224, 'auprc': 0.8587233482800558, 'loss_val': 0.4541283511641379, 'psi': 0.7642080113792558}
[S16] START round=22 head_norm_before_train=1.850899 cos_to_last_merge=0.9996 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8776777704902128, 'auprc': 0.9863696505199766, 'loss_val': 0.5572606792615492, 'psi': 0.9211545225021183}-{'f1_val': 0.9207912400451783, 'auprc': 0.9894534278564828, 'loss_val': 0.3623788462445871, 'psi': 0.9482561151697001}
[S17] START round=22 head_norm_before_train=1.308117 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.644073 metrics={'f1_val': 0.5887283675810996, 'auprc': 0.6008752242846016, 'loss_val': 0.9606979358276004, 'psi': 0.5935871102625003}-{'f1_val': 0.35406388426773305, 'auprc': 0.634910276859509, 'loss_val': 0.9429621982729984, 'psi': 0.4664024413044434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:42015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S11
[S13] cosine check vs S11: cos=-0.0341
[S13] DROPPED delta from S11 (cos=-0.0341 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=-0.0151
[S11] DROPPED delta from S15 (cos=-0.0151 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.9874
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=-0.0226
[S15] DROPPED delta from S14 (cos=-0.0226 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.5593
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.7718
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=22 metric=0.6677 head_norm=1.330434
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.836842e-01
[S3] stored merged vector for next round verification (round=22)
[S3] DEBUG after merge:  round=22 metric=0.6733 head_norm=1.226557 delta_norm=0.383684
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9938 head_norm=1.800973
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.428249e-01
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9938 head_norm=1.773872 delta_norm=0.142825
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.487964 cos_to_last_merge=0.8081 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.808
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6326450351806729, 'auprc': 0.7682895706199734, 'loss_val': 0.583321990533005, 'psi': 0.6869028493563931}-{'f1_val': 0.691478594951875, 'auprc': 0.8229312248704147, 'loss_val': 0.3574010430871853, 'psi': 0.7440596469192908}
[S3] START round=23 head_norm_before_train=1.226557 cos_to_last_merge=1.0000 (last merge round=22)
[S3] round=23 local utility u=1.000000 metrics={'f1_val': 0.9633920277542459, 'auprc': 0.9981412083825199, 'loss_val': 0.18659579296947548, 'psi': 0.9772917000055554}-{'f1_val': 0.6676719371385642, 'auprc': 0.847574078092777, 'loss_val': 0.8212666113445031, 'psi': 0.7396327935202494}
[S4] START round=23 head_norm_before_train=1.757991 cos_to_last_merge=0.9991 (last merge round=20)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9387999053837432, 'auprc': 0.9329843851080045, 'loss_val': 0.37002637511765984, 'psi': 0.9364736972734478}-{'f1_val': 0.9427334499140565, 'auprc': 0.9506923620176814, 'loss_val': 0.33679522983409105, 'psi': 0.9459170147555065}
[S5] START round=23 head_norm_before_train=1.825799 (no previous merge yet)
[S5] round=23 local utility u=0.993456 metrics={'f1_val': 0.7007406076076139, 'auprc': 0.9320697411421119, 'loss_val': 0.33914823336265504, 'psi': 0.7932722610214131}-{'f1_val': 0.5145852226752686, 'auprc': 0.8212273730831247, 'loss_val': 0.8766008299722384, 'psi': 0.6372420828384111}
[S6] START round=23 head_norm_before_train=1.429381 cos_to_last_merge=0.8464 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=23 local utility u=1.000000 metrics={'f1_val': 0.9346304331341119, 'auprc': 0.9486103292925947, 'loss_val': 0.25861169476238066, 'psi': 0.940222391597505}-{'f1_val': 0.5676711868414396, 'auprc': 0.7779678603241822, 'loss_val': 0.8126411332647931, 'psi': 0.6517898562345367}
[S7] START round=23 head_norm_before_train=1.751295 (no previous merge yet)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.5488313738816206, 'auprc': 0.7839106000490306, 'loss_val': 0.9930457981829283, 'psi': 0.6428630643485846}-{'f1_val': 0.6080190843116029, 'auprc': 0.7949492260645926, 'loss_val': 0.6915353832884217, 'psi': 0.6827911410127988}
[S8] START round=23 head_norm_before_train=1.586658 cos_to_last_merge=0.8198 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.820
[S8] round=23 local utility u=0.901366 metrics={'f1_val': 0.9908755629288465, 'auprc': 0.9973093587103519, 'loss_val': 0.08937931684281945, 'psi': 0.9934490812414487}-{'f1_val': 0.7142391053978291, 'auprc': 0.9979869366689816, 'loss_val': 0.2343249612057875, 'psi': 0.8277382379062901}
[S9] START round=23 head_norm_before_train=1.479415 cos_to_last_merge=0.9924 (last merge round=20)
[S9] round=23 local utility u=0.055257 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99627956279403, 'loss_val': 0.04905888261662253, 'psi': 0.9965081322059468}-{'f1_val': 0.9846069371183261, 'auprc': 0.99838904828321, 'loss_val': 0.09357978600803753, 'psi': 0.9901197815842797}
[S10] START round=23 head_norm_before_train=1.773872 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.000000 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.997475234375372, 'loss_val': 0.1032833347580089, 'psi': 0.9951561016214157}-{'f1_val': 0.9938290824763921, 'auprc': 0.9973190861096605, 'loss_val': 0.09815163955353413, 'psi': 0.9952250839296994}
[S11] START round=23 head_norm_before_train=1.476176 cos_to_last_merge=0.9991 (last merge round=21)
[S11] round=23 local utility u=0.009569 metrics={'f1_val': 0.9950183814381909, 'auprc': 0.99775442337912, 'loss_val': 0.12295348870279149, 'psi': 0.9961127982145626}-{'f1_val': 0.9966988539245482, 'auprc': 0.9973695300474184, 'loss_val': 0.15102059253909797, 'psi': 0.9969671243736962}
[S13] START round=23 head_norm_before_train=1.707190 (no previous merge yet)
[S13] round=23 local utility u=0.089681 metrics={'f1_val': 0.6224917197273323, 'auprc': 0.6698480581906541, 'loss_val': 0.6533656516541893, 'psi': 0.6414342551126611}-{'f1_val': 0.6056735989475873, 'auprc': 0.6763520891312729, 'loss_val': 0.7513308140314259, 'psi': 0.6339449950210615}
[S14] START round=23 head_norm_before_train=1.792973 cos_to_last_merge=0.9997 (last merge round=21)
[S14] round=23 local utility u=0.001212 metrics={'f1_val': 0.9953966330784393, 'auprc': 0.9990506884787761, 'loss_val': 0.07646965121204821, 'psi': 0.996858255238574}-{'f1_val': 0.9974310505072961, 'auprc': 0.9969402441838464, 'loss_val': 0.08476849577372542, 'psi': 0.9972347279779162}
[S15] START round=23 head_norm_before_train=1.768039 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.701349946339206, 'auprc': 0.9788267296319149, 'loss_val': 0.4327504089192721, 'psi': 0.8123406596562895}-{'f1_val': 0.9891442489251623, 'auprc': 0.9917511018346523, 'loss_val': 0.11098274037268294, 'psi': 0.9901869900889584}
[S16] START round=23 head_norm_before_train=1.881084 cos_to_last_merge=0.9986 (last merge round=20)
[S16] round=23 local utility u=0.192795 metrics={'f1_val': 0.9158740348516261, 'auprc': 0.9893996614192226, 'loss_val': 0.40993743649295117, 'psi': 0.9452842854786647}-{'f1_val': 0.8776777704902128, 'auprc': 0.9863696505199766, 'loss_val': 0.5572606792615492, 'psi': 0.9211545225021183}
[S17] START round=23 head_norm_before_train=1.338425 cos_to_last_merge=0.9977 (last merge round=21)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.3924497812614419, 'auprc': 0.6460669451666428, 'loss_val': 0.9844948994285713, 'psi': 0.49389664682352225}-{'f1_val': 0.5887283675810996, 'auprc': 0.6008752242846016, 'loss_val': 0.9606979358276004, 'psi': 0.5935871102625003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.996)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:42012
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:42004
[S9] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1795) from S6
[S11] cosine check vs S6: cos=0.9850
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9925
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.7336
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.6904
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.3625
[S17] RECEIVED delta(kind=head bytes=1804) from S16
[S17] cosine check vs S16: cos=0.9152
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=0.9881
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9388 head_norm=1.783221
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.390876e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9400 head_norm=1.744533 delta_norm=0.139088
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9950 head_norm=1.512695
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.327363e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9936 head_norm=1.472237 delta_norm=0.132736
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9967 head_norm=1.535688
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.300288e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9967 head_norm=1.326527 delta_norm=0.530029
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9159 head_norm=1.909059
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.208512e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9155 head_norm=1.866388 delta_norm=0.120851
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.3924 head_norm=1.365525
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.791811e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.3937 head_norm=1.297850 delta_norm=0.279181
[S17] aggregate: ACCEPT kept=['S9', 'S8', 'S16'] (k=3/3) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.498319 cos_to_last_merge=0.8073 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=24 local utility u=0.643762 metrics={'f1_val': 0.7922845551655275, 'auprc': 0.8171229542980443, 'loss_val': 0.40013453411488326, 'psi': 0.8022199148185343}-{'f1_val': 0.6326450351806729, 'auprc': 0.7682895706199734, 'loss_val': 0.583321990533005, 'psi': 0.6869028493563931}
[S3] START round=24 head_norm_before_train=1.312583 cos_to_last_merge=0.9948 (last merge round=22)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9290494795739681, 'auprc': 0.9907608235669277, 'loss_val': 0.20939626512792273, 'psi': 0.9537340171711519}-{'f1_val': 0.9633920277542459, 'auprc': 0.9981412083825199, 'loss_val': 0.18659579296947548, 'psi': 0.9772917000055554}
[S4] START round=24 head_norm_before_train=1.744533 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.077248 metrics={'f1_val': 0.9416205812081683, 'auprc': 0.9538679033413908, 'loss_val': 0.29510508112774186, 'psi': 0.9465195100614574}-{'f1_val': 0.9387999053837432, 'auprc': 0.9329843851080045, 'loss_val': 0.37002637511765984, 'psi': 0.9364736972734478}
[S5] START round=24 head_norm_before_train=1.830714 (no previous merge yet)
[S5] round=24 local utility u=1.000000 metrics={'f1_val': 0.9967280377725878, 'auprc': 0.995081449377281, 'loss_val': 0.09621094688998552, 'psi': 0.9960694024144651}-{'f1_val': 0.7007406076076139, 'auprc': 0.9320697411421119, 'loss_val': 0.33914823336265504, 'psi': 0.7932722610214131}
[S6] START round=24 head_norm_before_train=1.442899 cos_to_last_merge=0.8456 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8205828811548708, 'auprc': 0.9501370101081215, 'loss_val': 0.46727978599986747, 'psi': 0.872404532736171}-{'f1_val': 0.9346304331341119, 'auprc': 0.9486103292925947, 'loss_val': 0.25861169476238066, 'psi': 0.940222391597505}
[S7] START round=24 head_norm_before_train=1.761521 (no previous merge yet)
[S7] round=24 local utility u=0.080270 metrics={'f1_val': 0.562714096243214, 'auprc': 0.7824041516724404, 'loss_val': 0.911282294587327, 'psi': 0.6505901184149046}-{'f1_val': 0.5488313738816206, 'auprc': 0.7839106000490306, 'loss_val': 0.9930457981829283, 'psi': 0.6428630643485846}
[S8] START round=24 head_norm_before_train=1.602686 cos_to_last_merge=0.8175 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=24 local utility u=0.027206 metrics={'f1_val': 0.9948793501963274, 'auprc': 0.9991371845923952, 'loss_val': 0.06447378582168684, 'psi': 0.9965824839547546}-{'f1_val': 0.9908755629288465, 'auprc': 0.9973093587103519, 'loss_val': 0.08937931684281945, 'psi': 0.9934490812414487}
[S9] START round=24 head_norm_before_train=1.326527 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9949685554772734, 'loss_val': 0.1067484391343077, 'psi': 0.9952369217128809}-{'f1_val': 0.9966605118138915, 'auprc': 0.99627956279403, 'loss_val': 0.04905888261662253, 'psi': 0.9965081322059468}
[S10] START round=24 head_norm_before_train=1.807441 cos_to_last_merge=0.9995 (last merge round=22)
[S10] round=24 local utility u=0.012284 metrics={'f1_val': 0.9942179850461464, 'auprc': 0.9974827880914743, 'loss_val': 0.08238517123011409, 'psi': 0.9955239062642776}-{'f1_val': 0.9936100131187782, 'auprc': 0.997475234375372, 'loss_val': 0.1032833347580089, 'psi': 0.9951561016214157}
[S11] START round=24 head_norm_before_train=1.472237 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.004507 metrics={'f1_val': 0.9969406902828911, 'auprc': 0.9977885139299592, 'loss_val': 0.12557515775056233, 'psi': 0.9972798197417183}-{'f1_val': 0.9950183814381909, 'auprc': 0.99775442337912, 'loss_val': 0.12295348870279149, 'psi': 0.9961127982145626}
[S13] START round=24 head_norm_before_train=1.716277 (no previous merge yet)
[S13] round=24 local utility u=0.057642 metrics={'f1_val': 0.630627418413211, 'auprc': 0.6674415002418028, 'loss_val': 0.5796769099379008, 'psi': 0.6453530511446477}-{'f1_val': 0.6224917197273323, 'auprc': 0.6698480581906541, 'loss_val': 0.6533656516541893, 'psi': 0.6414342551126611}
[S14] START round=24 head_norm_before_train=1.820950 cos_to_last_merge=0.9986 (last merge round=21)
[S14] round=24 local utility u=0.010574 metrics={'f1_val': 0.9974537796719909, 'auprc': 0.9969303480421946, 'loss_val': 0.06130427306298276, 'psi': 0.9972444070200723}-{'f1_val': 0.9953966330784393, 'auprc': 0.9990506884787761, 'loss_val': 0.07646965121204821, 'psi': 0.996858255238574}
[S15] START round=24 head_norm_before_train=1.783374 (no previous merge yet)
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9867211796733275, 'auprc': 0.9964106789406177, 'loss_val': 0.08744543022935938, 'psi': 0.9905969793802436}-{'f1_val': 0.701349946339206, 'auprc': 0.9788267296319149, 'loss_val': 0.4327504089192721, 'psi': 0.8123406596562895}
[S16] START round=24 head_norm_before_train=1.866388 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.128760 metrics={'f1_val': 0.934612609842987, 'auprc': 0.9897539701073919, 'loss_val': 0.2659111278518091, 'psi': 0.9566691539487489}-{'f1_val': 0.9158740348516261, 'auprc': 0.9893996614192226, 'loss_val': 0.40993743649295117, 'psi': 0.9452842854786647}
[S17] START round=24 head_norm_before_train=1.297850 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.37040239605907266, 'auprc': 0.6624814201090148, 'loss_val': 0.9530166455739383, 'psi': 0.4872340056790495}-{'f1_val': 0.3924497812614419, 'auprc': 0.6460669451666428, 'loss_val': 0.9844948994285713, 'psi': 0.49389664682352225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S10@127.0.0.1:42011
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.645)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S16] not sending this round → trigger blocked (psi=0.957)
[S5] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S14] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=-0.1025
[S13] DROPPED delta from S2 (cos=-0.1025 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S15
[S11] cosine check vs S15: cos=-0.0137
[S11] DROPPED delta from S15 (cos=-0.0137 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1805) from S4
[S10] cosine check vs S4: cos=0.9882
[S3] RECEIVED delta(kind=head bytes=1799) from S10
[S3] cosine check vs S10: cos=0.6520
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=-0.0237
[S15] DROPPED delta from S14 (cos=-0.0237 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.9909
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] cosine check vs S11: cos=-0.0319
[S13] DROPPED delta from S11 (cos=-0.0319 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=24 metric=0.9290 head_norm=1.400021
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.054752e-01
[S3] stored merged vector for next round verification (round=24)
[S3] DEBUG after merge:  round=24 metric=0.9394 head_norm=1.476255 delta_norm=0.705475
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9975 head_norm=1.842576
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.273491e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9975 head_norm=1.800448 delta_norm=0.127349
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=24 metric=0.9942 head_norm=1.842278
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.432933e-01
[S10] stored merged vector for next round verification (round=24)
[S10] DEBUG after merge:  round=24 metric=0.9942 head_norm=1.802117 delta_norm=0.143293
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.509605 cos_to_last_merge=0.8064 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=25 local utility u=0.202839 metrics={'f1_val': 0.8297346260766502, 'auprc': 0.83542052085985, 'loss_val': 0.274049890097949, 'psi': 0.8320089839899301}-{'f1_val': 0.7922845551655275, 'auprc': 0.8171229542980443, 'loss_val': 0.40013453411488326, 'psi': 0.8022199148185343}
[S3] START round=25 head_norm_before_train=1.476255 cos_to_last_merge=1.0000 (last merge round=24)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9033441433013277, 'auprc': 0.990675119538093, 'loss_val': 0.2777182023548186, 'psi': 0.9382765337960338}-{'f1_val': 0.9290494795739681, 'auprc': 0.9907608235669277, 'loss_val': 0.20939626512792273, 'psi': 0.9537340171711519}
[S4] START round=25 head_norm_before_train=1.772661 cos_to_last_merge=0.9996 (last merge round=23)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9406262485274789, 'auprc': 0.9324677564323831, 'loss_val': 0.3089683888345955, 'psi': 0.9373628516894406}-{'f1_val': 0.9416205812081683, 'auprc': 0.9538679033413908, 'loss_val': 0.29510508112774186, 'psi': 0.9465195100614574}
[S5] START round=25 head_norm_before_train=1.837200 (no previous merge yet)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.888615913825882, 'auprc': 0.9922809628394448, 'loss_val': 0.1329257952609971, 'psi': 0.9300819334313071}-{'f1_val': 0.9967280377725878, 'auprc': 0.995081449377281, 'loss_val': 0.09621094688998552, 'psi': 0.9960694024144651}
[S6] START round=25 head_norm_before_train=1.455332 cos_to_last_merge=0.8447 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=25 local utility u=0.113191 metrics={'f1_val': 0.8245919425235733, 'auprc': 0.9605849257290864, 'loss_val': 0.2962962752088778, 'psi': 0.8789891358057785}-{'f1_val': 0.8205828811548708, 'auprc': 0.9501370101081215, 'loss_val': 0.46727978599986747, 'psi': 0.872404532736171}
[S7] START round=25 head_norm_before_train=1.766515 (no previous merge yet)
[S7] round=25 local utility u=0.137382 metrics={'f1_val': 0.5835819089185069, 'auprc': 0.7849523019931492, 'loss_val': 0.7693699893946195, 'psi': 0.6641300661483638}-{'f1_val': 0.562714096243214, 'auprc': 0.7824041516724404, 'loss_val': 0.911282294587327, 'psi': 0.6505901184149046}
[S8] START round=25 head_norm_before_train=1.616571 cos_to_last_merge=0.8157 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9944290756445932, 'auprc': 0.9993601032844504, 'loss_val': 0.08356843235316899, 'psi': 0.9964014867005361}-{'f1_val': 0.9948793501963274, 'auprc': 0.9991371845923952, 'loss_val': 0.06447378582168684, 'psi': 0.9965824839547546}
[S9] START round=25 head_norm_before_train=1.397502 cos_to_last_merge=0.9972 (last merge round=23)
[S9] round=25 local utility u=0.024843 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9960587023117702, 'loss_val': 0.06546416977443349, 'psi': 0.9961860983629518}-{'f1_val': 0.9954158325366191, 'auprc': 0.9949685554772734, 'loss_val': 0.1067484391343077, 'psi': 0.9952369217128809}
[S10] START round=25 head_norm_before_train=1.802117 cos_to_last_merge=1.0000 (last merge round=24)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.996603990386119, 'loss_val': 0.09689193189383889, 'psi': 0.9954907616860711}-{'f1_val': 0.9942179850461464, 'auprc': 0.9974827880914743, 'loss_val': 0.08238517123011409, 'psi': 0.9955239062642776}
[S11] START round=25 head_norm_before_train=1.499351 cos_to_last_merge=0.9996 (last merge round=23)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9982304454484482, 'loss_val': 0.17854134345931796, 'psi': 0.9970776289496004}-{'f1_val': 0.9969406902828911, 'auprc': 0.9977885139299592, 'loss_val': 0.12557515775056233, 'psi': 0.9972798197417183}
[S13] START round=25 head_norm_before_train=1.725148 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.6017404899439509, 'auprc': 0.6771684555229878, 'loss_val': 0.6956799421171709, 'psi': 0.6319116761755657}-{'f1_val': 0.630627418413211, 'auprc': 0.6674415002418028, 'loss_val': 0.5796769099379008, 'psi': 0.6453530511446477}
[S14] START round=25 head_norm_before_train=1.800448 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9641144624272828, 'auprc': 0.9969730493607106, 'loss_val': 0.09094227889211239, 'psi': 0.9772578972006539}-{'f1_val': 0.9974537796719909, 'auprc': 0.9969303480421946, 'loss_val': 0.06130427306298276, 'psi': 0.9972444070200723}
[S15] START round=25 head_norm_before_train=1.801029 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7012852013685485, 'auprc': 0.9870558705557864, 'loss_val': 0.3894792168121527, 'psi': 0.8155934690434437}-{'f1_val': 0.9867211796733275, 'auprc': 0.9964106789406177, 'loss_val': 0.08744543022935938, 'psi': 0.9905969793802436}
[S16] START round=25 head_norm_before_train=1.892681 cos_to_last_merge=0.9998 (last merge round=23)
[S16] round=25 local utility u=0.027668 metrics={'f1_val': 0.9381760425545052, 'auprc': 0.9896987204296241, 'loss_val': 0.23178942007831144, 'psi': 0.9587851137045528}-{'f1_val': 0.934612609842987, 'auprc': 0.9897539701073919, 'loss_val': 0.2659111278518091, 'psi': 0.9566691539487489}
[S17] START round=25 head_norm_before_train=1.319877 cos_to_last_merge=0.9990 (last merge round=23)
[S17] round=25 local utility u=0.072563 metrics={'f1_val': 0.37166980243334513, 'auprc': 0.6777634755498352, 'loss_val': 0.8613418283304937, 'psi': 0.4941072716799412}-{'f1_val': 0.37040239605907266, 'auprc': 0.6624814201090148, 'loss_val': 0.9530166455739383, 'psi': 0.4872340056790495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.664)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[S2] not sending this round → trigger blocked (psi=0.832)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9903
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.8388
[S17] RECEIVED delta(kind=head bytes=1799) from S16
[S17] cosine check vs S16: cos=0.8858
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1795) from S17
[S3] cosine check vs S17: cos=0.5583
[S8] ⇄ pheromone p=0.168 → S17@127.0.0.1:42017
[S5] ⇄ pheromone p=0.355 → S16@127.0.0.1:42016
[S13] ⇄ pheromone p=0.054 → S4@127.0.0.1:42004
[S14] ⇄ pheromone p=0.042 → S15@127.0.0.1:42015
[S10] ⇄ pheromone p=0.050 → S3@127.0.0.1:42003
[S7] ⇄ pheromone p=0.097 → S14@127.0.0.1:42014
[S2] ⇄ pheromone p=0.217 → S13@127.0.0.1:42013
[S4] ⇄ pheromone p=0.104 → S10@127.0.0.1:42011
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=25 metric=0.9033 head_norm=1.551507
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.859720e-01
[S3] stored merged vector for next round verification (round=25)
[S3] DEBUG after merge:  round=25 metric=0.9034 head_norm=1.277471 delta_norm=0.685972
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.216 → S9@127.0.0.1:42010
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9963 head_norm=1.521019
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.075264e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9963 head_norm=1.490069 delta_norm=0.107526
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.067 → S13@127.0.0.1:42013
[S15] ⇄ pheromone p=0.350 → S11@127.0.0.1:42012
[S16] ⇄ pheromone p=0.122 → S17@127.0.0.1:42017
[S9] ⇄ pheromone p=0.030 → S17@127.0.0.1:42017
[S6] ⇄ pheromone p=0.301 → S11@127.0.0.1:42012
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.3717 head_norm=1.340822
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.336479e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.3747 head_norm=1.423392 delta_norm=0.233648
[S17] aggregate: ACCEPT kept=['S9', 'S16'] (k=2/2) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.106 → S3@127.0.0.1:42003
[S2] START round=26 head_norm_before_train=1.524220 cos_to_last_merge=0.8050 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=26 local utility u=0.156997 metrics={'f1_val': 0.8306762254668139, 'auprc': 0.9314218333240254, 'loss_val': 0.2537084573499645, 'psi': 0.8709744686096985}-{'f1_val': 0.8297346260766502, 'auprc': 0.83542052085985, 'loss_val': 0.274049890097949, 'psi': 0.8320089839899301}
[S3] START round=26 head_norm_before_train=1.277471 cos_to_last_merge=1.0000 (last merge round=25)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8885317088657468, 'auprc': 0.9809132044769608, 'loss_val': 0.2998321573063823, 'psi': 0.9254843071102324}-{'f1_val': 0.9033441433013277, 'auprc': 0.990675119538093, 'loss_val': 0.2777182023548186, 'psi': 0.9382765337960338}
[S4] START round=26 head_norm_before_train=1.797042 cos_to_last_merge=0.9989 (last merge round=23)
[S4] round=26 local utility u=0.062673 metrics={'f1_val': 0.9436448518034135, 'auprc': 0.9570422258739703, 'loss_val': 0.27545731801301576, 'psi': 0.9490038014316362}-{'f1_val': 0.9406262485274789, 'auprc': 0.9324677564323831, 'loss_val': 0.3089683888345955, 'psi': 0.9373628516894406}
[S5] START round=26 head_norm_before_train=1.845700 (no previous merge yet)
[S5] round=26 local utility u=0.356851 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9952136160993973, 'loss_val': 0.07917220555560439, 'psi': 0.9963700636405339}-{'f1_val': 0.888615913825882, 'auprc': 0.9922809628394448, 'loss_val': 0.1329257952609971, 'psi': 0.9300819334313071}
[S6] START round=26 head_norm_before_train=1.466368 cos_to_last_merge=0.8437 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.6973492003736669, 'auprc': 0.9510083496069477, 'loss_val': 0.6521407949543198, 'psi': 0.7988128600669793}-{'f1_val': 0.8245919425235733, 'auprc': 0.9605849257290864, 'loss_val': 0.2962962752088778, 'psi': 0.8789891358057785}
[S7] START round=26 head_norm_before_train=1.771729 (no previous merge yet)
[S7] round=26 local utility u=0.102425 metrics={'f1_val': 0.6054920638810546, 'auprc': 0.7899964193126419, 'loss_val': 0.7111134942504497, 'psi': 0.6792938060536895}-{'f1_val': 0.5835819089185069, 'auprc': 0.7849523019931492, 'loss_val': 0.7693699893946195, 'psi': 0.6641300661483638}
[S8] START round=26 head_norm_before_train=1.633791 cos_to_last_merge=0.8139 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9765436552989963, 'auprc': 0.9990950139730519, 'loss_val': 0.14782521931527237, 'psi': 0.9855641987686186}-{'f1_val': 0.9944290756445932, 'auprc': 0.9993601032844504, 'loss_val': 0.08356843235316899, 'psi': 0.9964014867005361}
[S9] START round=26 head_norm_before_train=1.481687 cos_to_last_merge=0.9893 (last merge round=23)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9960113636821912, 'loss_val': 0.0535896786965597, 'psi': 0.9938957326604083}-{'f1_val': 0.9962710290637395, 'auprc': 0.9960587023117702, 'loss_val': 0.06546416977443349, 'psi': 0.9961860983629518}
[S10] START round=26 head_norm_before_train=1.831785 cos_to_last_merge=0.9997 (last merge round=24)
[S10] round=26 local utility u=0.008862 metrics={'f1_val': 0.994250896972037, 'auprc': 0.9977629825565477, 'loss_val': 0.0796594627238325, 'psi': 0.9956557312058412}-{'f1_val': 0.9947486092193725, 'auprc': 0.996603990386119, 'loss_val': 0.09689193189383889, 'psi': 0.9954907616860711}
[S11] START round=26 head_norm_before_train=1.490069 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.031802 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9967350289694005, 'loss_val': 0.11175692179379365, 'psi': 0.9966101304851394}-{'f1_val': 0.9963090846170353, 'auprc': 0.9982304454484482, 'loss_val': 0.17854134345931796, 'psi': 0.9970776289496004}
[S13] START round=26 head_norm_before_train=1.731828 (no previous merge yet)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5898052091090606, 'auprc': 0.6773398378465697, 'loss_val': 0.8670871048860046, 'psi': 0.6248190606040642}-{'f1_val': 0.6017404899439509, 'auprc': 0.6771684555229878, 'loss_val': 0.6956799421171709, 'psi': 0.6319116761755657}
[S14] START round=26 head_norm_before_train=1.823937 cos_to_last_merge=0.9998 (last merge round=24)
[S14] round=26 local utility u=0.114159 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969709683244221, 'loss_val': 0.05859597655011943, 'psi': 0.9968548519012306}-{'f1_val': 0.9641144624272828, 'auprc': 0.9969730493607106, 'loss_val': 0.09094227889211239, 'psi': 0.9772578972006539}
[S15] START round=26 head_norm_before_train=1.816662 (no previous merge yet)
[S15] round=26 local utility u=0.516758 metrics={'f1_val': 0.8353386614981554, 'auprc': 0.9902867180847761, 'loss_val': 0.16997640392813934, 'psi': 0.8973178841328038}-{'f1_val': 0.7012852013685485, 'auprc': 0.9870558705557864, 'loss_val': 0.3894792168121527, 'psi': 0.8155934690434437}
[S16] START round=26 head_norm_before_train=1.916567 cos_to_last_merge=0.9993 (last merge round=23)
[S16] round=26 local utility u=0.201900 metrics={'f1_val': 0.9839034958381412, 'auprc': 0.988325920693691, 'loss_val': 0.09823490922029975, 'psi': 0.985672465780361}-{'f1_val': 0.9381760425545052, 'auprc': 0.9896987204296241, 'loss_val': 0.23178942007831144, 'psi': 0.9587851137045528}
[S17] START round=26 head_norm_before_train=1.423392 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.445432 metrics={'f1_val': 0.4213683969750665, 'auprc': 0.8143862738308587, 'loss_val': 0.6785373703577496, 'psi': 0.5785755477173834}-{'f1_val': 0.37166980243334513, 'auprc': 0.6777634755498352, 'loss_val': 0.8613418283304937, 'psi': 0.4941072716799412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:42014
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:42016
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:42012
[S15] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.6249
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=-0.0235
[S15] DROPPED delta from S14 (cos=-0.0235 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.9945
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] cosine check vs S11: cos=-0.0298
[S13] DROPPED delta from S11 (cos=-0.0298 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=-0.0996
[S13] DROPPED delta from S2 (cos=-0.0996 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1805) from S15
[S11] cosine check vs S15: cos=-0.0110
[S11] DROPPED delta from S15 (cos=-0.0110 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.9926
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9940
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S17
[S3] cosine check vs S17: cos=0.8636
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:42017
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1806) from S16
[S17] cosine check vs S16: cos=0.9154
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=26 metric=0.8885 head_norm=1.380235
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.516736e-01
[S3] stored merged vector for next round verification (round=26)
[S3] DEBUG after merge:  round=26 metric=0.8915 head_norm=1.313710 delta_norm=0.251674
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=26 metric=0.9943 head_norm=1.862750
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.137661e-01
[S10] stored merged vector for next round verification (round=26)
[S10] DEBUG after merge:  round=26 metric=0.9940 head_norm=1.837296 delta_norm=0.113766
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9839 head_norm=1.939345
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.104621e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9837 head_norm=1.898998 delta_norm=0.110462
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9968 head_norm=1.850704
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.016547e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9968 head_norm=1.812584 delta_norm=0.101655
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.4214 head_norm=1.441724
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.244114e-01
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.4227 head_norm=1.655200 delta_norm=0.424411
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.543520 cos_to_last_merge=0.8030 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.5576036340324471, 'auprc': 0.7491118098574006, 'loss_val': 0.4830226643368025, 'psi': 0.6342069043624284}-{'f1_val': 0.8306762254668139, 'auprc': 0.9314218333240254, 'loss_val': 0.2537084573499645, 'psi': 0.8709744686096985}
[S3] START round=27 head_norm_before_train=1.313710 cos_to_last_merge=1.0000 (last merge round=26)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7260139249829971, 'auprc': 0.8811937436412428, 'loss_val': 0.7218061117313671, 'psi': 0.7880858524462955}-{'f1_val': 0.8885317088657468, 'auprc': 0.9809132044769608, 'loss_val': 0.2998321573063823, 'psi': 0.9254843071102324}
[S4] START round=27 head_norm_before_train=1.818615 cos_to_last_merge=0.9979 (last merge round=23)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.939154765436459, 'auprc': 0.9284005708358808, 'loss_val': 0.3341512221797729, 'psi': 0.9348530875962278}-{'f1_val': 0.9436448518034135, 'auprc': 0.9570422258739703, 'loss_val': 0.27545731801301576, 'psi': 0.9490038014316362}
[S5] START round=27 head_norm_before_train=1.864332 (no previous merge yet)
[S5] round=27 local utility u=0.011439 metrics={'f1_val': 0.9971410286679584, 'auprc': 0.9972989005203184, 'loss_val': 0.06254999974833492, 'psi': 0.9972041774089024}-{'f1_val': 0.9971410286679584, 'auprc': 0.9952136160993973, 'loss_val': 0.07917220555560439, 'psi': 0.9963700636405339}
[S6] START round=27 head_norm_before_train=1.481252 cos_to_last_merge=0.8424 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=27 local utility u=0.538133 metrics={'f1_val': 0.8232725627624152, 'auprc': 0.962032190575755, 'loss_val': 0.3644856724168982, 'psi': 0.8787764138877512}-{'f1_val': 0.6973492003736669, 'auprc': 0.9510083496069477, 'loss_val': 0.6521407949543198, 'psi': 0.7988128600669793}
[S7] START round=27 head_norm_before_train=1.779462 (no previous merge yet)
[S7] round=27 local utility u=0.137292 metrics={'f1_val': 0.6288357444064802, 'auprc': 0.8003562718769994, 'loss_val': 0.6076702732927379, 'psi': 0.6974439553946878}-{'f1_val': 0.6054920638810546, 'auprc': 0.7899964193126419, 'loss_val': 0.7111134942504497, 'psi': 0.6792938060536895}
[S8] START round=27 head_norm_before_train=1.651772 cos_to_last_merge=0.8122 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9970950677252141, 'loss_val': 0.43481183810305574, 'psi': 0.827381490328783}-{'f1_val': 0.9765436552989963, 'auprc': 0.9990950139730519, 'loss_val': 0.14782521931527237, 'psi': 0.9855641987686186}
[S9] START round=27 head_norm_before_train=1.545787 cos_to_last_merge=0.9820 (last merge round=23)
[S9] round=27 local utility u=0.018213 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9949456990664871, 'loss_val': 0.03901767897760759, 'psi': 0.9959745867149297}-{'f1_val': 0.9924853119792197, 'auprc': 0.9960113636821912, 'loss_val': 0.0535896786965597, 'psi': 0.9938957326604083}
[S10] START round=27 head_norm_before_train=1.837296 cos_to_last_merge=1.0000 (last merge round=26)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9933416400801217, 'auprc': 0.9984480136049465, 'loss_val': 0.0897210202967376, 'psi': 0.9953841894900517}-{'f1_val': 0.994250896972037, 'auprc': 0.9977629825565477, 'loss_val': 0.0796594627238325, 'psi': 0.9956557312058412}
[S11] START round=27 head_norm_before_train=1.513077 cos_to_last_merge=0.9997 (last merge round=25)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9576733145540692, 'auprc': 0.9958913770202977, 'loss_val': 0.12302011257668252, 'psi': 0.9729605395405607}-{'f1_val': 0.9965268648289654, 'auprc': 0.9967350289694005, 'loss_val': 0.11175692179379365, 'psi': 0.9966101304851394}
[S13] START round=27 head_norm_before_train=1.744773 (no previous merge yet)
[S13] round=27 local utility u=0.074405 metrics={'f1_val': 0.6114828488386886, 'auprc': 0.6604473289183828, 'loss_val': 0.7976651336583922, 'psi': 0.6310686408705664}-{'f1_val': 0.5898052091090606, 'auprc': 0.6773398378465697, 'loss_val': 0.8670871048860046, 'psi': 0.6248190606040642}
[S14] START round=27 head_norm_before_train=1.812584 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9968527342645841, 'auprc': 0.996223721909393, 'loss_val': 0.06667195433505829, 'psi': 0.9966011293225077}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969709683244221, 'loss_val': 0.05859597655011943, 'psi': 0.9968548519012306}
[S15] START round=27 head_norm_before_train=1.833503 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.7000806179029501, 'auprc': 0.9844912644182637, 'loss_val': 0.3945012419521979, 'psi': 0.8138448765090756}-{'f1_val': 0.8353386614981554, 'auprc': 0.9902867180847761, 'loss_val': 0.16997640392813934, 'psi': 0.8973178841328038}
[S16] START round=27 head_norm_before_train=1.898998 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9350668251151973, 'auprc': 0.9898823851208434, 'loss_val': 0.28396833946914957, 'psi': 0.9569930491174556}-{'f1_val': 0.9839034958381412, 'auprc': 0.988325920693691, 'loss_val': 0.09823490922029975, 'psi': 0.985672465780361}
[S17] START round=27 head_norm_before_train=1.655200 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.016917 metrics={'f1_val': 0.41778727679175576, 'auprc': 0.8264362848642979, 'loss_val': 0.6593658732419451, 'psi': 0.5812468800207726}-{'f1_val': 0.4213683969750665, 'auprc': 0.8143862738308587, 'loss_val': 0.6785373703577496, 'psi': 0.5785755477173834}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:42014
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[S9] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9922
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9973
[S17] RECEIVED delta(kind=head bytes=1801) from S9
[S17] cosine check vs S9: cos=0.7255
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=0.9882
[S14] RECEIVED delta(kind=head bytes=1795) from S7
[S14] cosine check vs S7: cos=0.9974
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1805) from S17
[S3] cosine check vs S17: cos=0.7200
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=27 metric=0.7260 head_norm=1.398346
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.882307e-01
[S3] stored merged vector for next round verification (round=27)
[S3] DEBUG after merge:  round=27 metric=0.7249 head_norm=1.424572 delta_norm=0.588231
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9969 head_norm=1.839126
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.027203e-02
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9969 head_norm=1.813748 delta_norm=0.070272
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9577 head_norm=1.541346
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.780639e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9567 head_norm=1.514990 delta_norm=0.097806
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9392 head_norm=1.838769
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.438387e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9399 head_norm=1.792576 delta_norm=0.143839
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.4178 head_norm=1.671966
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.057237e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.4211 head_norm=1.515820 delta_norm=0.605724
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.9351 head_norm=1.919138
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.254428e-02
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.9346 head_norm=1.896008 delta_norm=0.072544
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.562454 cos_to_last_merge=0.8008 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=28 local utility u=0.682011 metrics={'f1_val': 0.7284895466753553, 'auprc': 0.8620339500959576, 'loss_val': 0.48308331094036394, 'psi': 0.7819073080435962}-{'f1_val': 0.5576036340324471, 'auprc': 0.7491118098574006, 'loss_val': 0.4830226643368025, 'psi': 0.6342069043624284}
[S3] START round=28 head_norm_before_train=1.424572 cos_to_last_merge=1.0000 (last merge round=27)
[S3] round=28 local utility u=1.000000 metrics={'f1_val': 0.9708565150821976, 'auprc': 0.9994100680197167, 'loss_val': 0.10783194502394207, 'psi': 0.9822779362572052}-{'f1_val': 0.7260139249829971, 'auprc': 0.8811937436412428, 'loss_val': 0.7218061117313671, 'psi': 0.7880858524462955}
[S4] START round=28 head_norm_before_train=1.792576 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9052306152801276, 'auprc': 0.923986334714503, 'loss_val': 0.39599639516437385, 'psi': 0.9127329030538778}-{'f1_val': 0.939154765436459, 'auprc': 0.9284005708358808, 'loss_val': 0.3341512221797729, 'psi': 0.9348530875962278}
[S5] START round=28 head_norm_before_train=1.875402 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9940563414050063, 'loss_val': 0.06457807576989871, 'psi': 0.9956437176490771}-{'f1_val': 0.9971410286679584, 'auprc': 0.9972989005203184, 'loss_val': 0.06254999974833492, 'psi': 0.9972041774089024}
[S6] START round=28 head_norm_before_train=1.494581 cos_to_last_merge=0.8415 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.7225469084611058, 'auprc': 0.9525981059165562, 'loss_val': 0.5943017322067381, 'psi': 0.8145673874432859}-{'f1_val': 0.8232725627624152, 'auprc': 0.962032190575755, 'loss_val': 0.3644856724168982, 'psi': 0.8787764138877512}
[S7] START round=28 head_norm_before_train=1.790769 (no previous merge yet)
[S7] round=28 local utility u=0.239978 metrics={'f1_val': 0.6639240149626684, 'auprc': 0.8138134362649272, 'loss_val': 0.3786159342236693, 'psi': 0.723879783483572}-{'f1_val': 0.6288357444064802, 'auprc': 0.8003562718769994, 'loss_val': 0.6076702732927379, 'psi': 0.6974439553946878}
[S8] START round=28 head_norm_before_train=1.667831 cos_to_last_merge=0.8108 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=28 local utility u=0.978800 metrics={'f1_val': 0.9827219368085839, 'auprc': 0.9991532782080047, 'loss_val': 0.09428381898333278, 'psi': 0.9892944733683522}-{'f1_val': 0.7142391053978291, 'auprc': 0.9970950677252141, 'loss_val': 0.43481183810305574, 'psi': 0.827381490328783}
[S9] START round=28 head_norm_before_train=1.591777 cos_to_last_merge=0.9767 (last merge round=23)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9958636659742512, 'loss_val': 0.036900487290909, 'psi': 0.994941779397265}-{'f1_val': 0.9966605118138915, 'auprc': 0.9949456990664871, 'loss_val': 0.03901767897760759, 'psi': 0.9959745867149297}
[S10] START round=28 head_norm_before_train=1.865109 cos_to_last_merge=0.9997 (last merge round=26)
[S10] round=28 local utility u=0.011749 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981360403954502, 'loss_val': 0.07372859584534891, 'psi': 0.9961035816898036}-{'f1_val': 0.9933416400801217, 'auprc': 0.9984480136049465, 'loss_val': 0.0897210202967376, 'psi': 0.9953841894900517}
[S11] START round=28 head_norm_before_train=1.514990 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.136539 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9975142341719364, 'loss_val': 0.0879327574702128, 'psi': 0.9969218125661538}-{'f1_val': 0.9576733145540692, 'auprc': 0.9958913770202977, 'loss_val': 0.12302011257668252, 'psi': 0.9729605395405607}
[S13] START round=28 head_norm_before_train=1.756976 (no previous merge yet)
[S13] round=28 local utility u=0.102488 metrics={'f1_val': 0.6184179722213172, 'auprc': 0.6764817624375995, 'loss_val': 0.682403661340914, 'psi': 0.6416434883078301}-{'f1_val': 0.6114828488386886, 'auprc': 0.6604473289183828, 'loss_val': 0.7976651336583922, 'psi': 0.6310686408705664}
[S14] START round=28 head_norm_before_train=1.813748 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.006189 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9989741775592229, 'loss_val': 0.06108833419624465, 'psi': 0.9975556789893436}-{'f1_val': 0.9968527342645841, 'auprc': 0.996223721909393, 'loss_val': 0.06667195433505829, 'psi': 0.9966011293225077}
[S15] START round=28 head_norm_before_train=1.851127 (no previous merge yet)
[S15] round=28 local utility u=1.000000 metrics={'f1_val': 0.9946628919215652, 'auprc': 0.9904065580522309, 'loss_val': 0.059188150799966775, 'psi': 0.9929603583738315}-{'f1_val': 0.7000806179029501, 'auprc': 0.9844912644182637, 'loss_val': 0.3945012419521979, 'psi': 0.8138448765090756}
[S16] START round=28 head_norm_before_train=1.896008 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9325565443396335, 'auprc': 0.9896244508130494, 'loss_val': 0.3087036588482074, 'psi': 0.9553837069289999}-{'f1_val': 0.9350668251151973, 'auprc': 0.9898823851208434, 'loss_val': 0.28396833946914957, 'psi': 0.9569930491174556}
[S17] START round=28 head_norm_before_train=1.515820 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.4038503126207604, 'auprc': 0.8387544552094247, 'loss_val': 0.6666935136144856, 'psi': 0.577811969656226}-{'f1_val': 0.41778727679175576, 'auprc': 0.8264362848642979, 'loss_val': 0.6593658732419451, 'psi': 0.5812468800207726}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S3
[S9] cosine check vs S3: cos=0.8394
[S11] RECEIVED delta(kind=head bytes=1798) from S15
[S11] cosine check vs S15: cos=-0.0098
[S11] DROPPED delta from S15 (cos=-0.0098 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=-0.0230
[S15] DROPPED delta from S14 (cos=-0.0230 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=0.9956
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.4140
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.1860
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9982
[S13] RECEIVED delta(kind=head bytes=1796) from S11
[S13] cosine check vs S11: cos=-0.0269
[S13] DROPPED delta from S11 (cos=-0.0269 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=-0.0971
[S13] DROPPED delta from S2 (cos=-0.0971 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=28 metric=0.9052 head_norm=1.807236
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.620293e-02
[S4] stored merged vector for next round verification (round=28)
[S4] DEBUG after merge:  round=28 metric=0.9148 head_norm=1.783431 delta_norm=0.086203
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9943 head_norm=1.628589
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.473504e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9943 head_norm=1.498807 delta_norm=0.447350
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9966 head_norm=1.843930
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.947560e-02
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9966 head_norm=1.819918 delta_norm=0.059476
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=28 metric=0.9709 head_norm=1.496925
[S3] _apply_head_vector_avg (torch): Δ‖w‖=9.317675e-01
[S3] stored merged vector for next round verification (round=28)
[S3] DEBUG after merge:  round=28 metric=0.9744 head_norm=1.428330 delta_norm=0.931768
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=28 metric=0.4039 head_norm=1.531929
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.025297e+00
[S17] stored merged vector for next round verification (round=28)
[S17] DEBUG after merge:  round=28 metric=0.4166 head_norm=1.236648 delta_norm=1.025297
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.576048 cos_to_last_merge=0.7994 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=29 local utility u=0.531029 metrics={'f1_val': 0.8286223337345677, 'auprc': 0.9519859891762079, 'loss_val': 0.29167726253489523, 'psi': 0.8779677959112238}-{'f1_val': 0.7284895466753553, 'auprc': 0.8620339500959576, 'loss_val': 0.48308331094036394, 'psi': 0.7819073080435962}
[S3] START round=29 head_norm_before_train=1.428330 cos_to_last_merge=1.0000 (last merge round=28)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9985481424891409, 'loss_val': 0.169508756294086, 'psi': 0.9758875486125157}-{'f1_val': 0.9708565150821976, 'auprc': 0.9994100680197167, 'loss_val': 0.10783194502394207, 'psi': 0.9822779362572052}
[S4] START round=29 head_norm_before_train=1.783431 cos_to_last_merge=1.0000 (last merge round=28)
[S4] round=29 local utility u=0.046213 metrics={'f1_val': 0.916324813363715, 'auprc': 0.9277187800391042, 'loss_val': 0.3813334628483925, 'psi': 0.9208824000338707}-{'f1_val': 0.9052306152801276, 'auprc': 0.923986334714503, 'loss_val': 0.39599639516437385, 'psi': 0.9127329030538778}
[S5] START round=29 head_norm_before_train=1.890129 (no previous merge yet)
[S5] round=29 local utility u=0.019662 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9988463320643188, 'loss_val': 0.041829978385988634, 'psi': 0.9977802679923662}-{'f1_val': 0.9967019684784577, 'auprc': 0.9940563414050063, 'loss_val': 0.06457807576989871, 'psi': 0.9956437176490771}
[S6] START round=29 head_norm_before_train=1.507862 cos_to_last_merge=0.8404 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=29 local utility u=0.966030 metrics={'f1_val': 0.9633811031226898, 'auprc': 0.9723735041171929, 'loss_val': 0.1665730920978448, 'psi': 0.966978063520491}-{'f1_val': 0.7225469084611058, 'auprc': 0.9525981059165562, 'loss_val': 0.5943017322067381, 'psi': 0.8145673874432859}
[S7] START round=29 head_norm_before_train=1.797553 (no previous merge yet)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6310980014415044, 'auprc': 0.8045237174140967, 'loss_val': 0.5019496809964218, 'psi': 0.7004682878305413}-{'f1_val': 0.6639240149626684, 'auprc': 0.8138134362649272, 'loss_val': 0.3786159342236693, 'psi': 0.723879783483572}
[S8] START round=29 head_norm_before_train=1.677576 cos_to_last_merge=0.8096 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9741425858121917, 'auprc': 0.999187878308953, 'loss_val': 0.09543829169107344, 'psi': 0.9841607028108962}-{'f1_val': 0.9827219368085839, 'auprc': 0.9991532782080047, 'loss_val': 0.09428381898333278, 'psi': 0.9892944733683522}
[S9] START round=29 head_norm_before_train=1.498807 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9970103529795421, 'loss_val': 0.06957101572542375, 'psi': 0.9970658886991025}-{'f1_val': 0.9943271883459407, 'auprc': 0.9958636659742512, 'loss_val': 0.036900487290909, 'psi': 0.994941779397265}
[S10] START round=29 head_norm_before_train=1.890992 cos_to_last_merge=0.9990 (last merge round=26)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9938648248016556, 'auprc': 0.993940633787405, 'loss_val': 0.10798644215620236, 'psi': 0.9938951483959554}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981360403954502, 'loss_val': 0.07372859584534891, 'psi': 0.9961035816898036}
[S11] START round=29 head_norm_before_train=1.544398 cos_to_last_merge=0.9994 (last merge round=27)
[S11] round=29 local utility u=0.008387 metrics={'f1_val': 0.9958050841232382, 'auprc': 0.9981581292451158, 'loss_val': 0.06875989820882485, 'psi': 0.9967463021719892}-{'f1_val': 0.9965268648289654, 'auprc': 0.9975142341719364, 'loss_val': 0.0879327574702128, 'psi': 0.9969218125661538}
[S13] START round=29 head_norm_before_train=1.763522 (no previous merge yet)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.6097002198197508, 'auprc': 0.6758845014940387, 'loss_val': 0.7488693944311585, 'psi': 0.636173932489466}-{'f1_val': 0.6184179722213172, 'auprc': 0.6764817624375995, 'loss_val': 0.682403661340914, 'psi': 0.6416434883078301}
[S14] START round=29 head_norm_before_train=1.819918 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.000000 metrics={'f1_val': 0.9967712526152024, 'auprc': 0.9972557139982916, 'loss_val': 0.062209682371357176, 'psi': 0.996965037168438}-{'f1_val': 0.9966100132760906, 'auprc': 0.9989741775592229, 'loss_val': 0.06108833419624465, 'psi': 0.9975556789893436}
[S15] START round=29 head_norm_before_train=1.868754 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.9908920538769722, 'auprc': 0.993657069903716, 'loss_val': 0.055067957774644724, 'psi': 0.9919980602876698}-{'f1_val': 0.9946628919215652, 'auprc': 0.9904065580522309, 'loss_val': 0.059188150799966775, 'psi': 0.9929603583738315}
[S16] START round=29 head_norm_before_train=1.917900 cos_to_last_merge=0.9999 (last merge round=27)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8791788359274844, 'auprc': 0.988171530396747, 'loss_val': 0.5781043063584191, 'psi': 0.9227759137151894}-{'f1_val': 0.9325565443396335, 'auprc': 0.9896244508130494, 'loss_val': 0.3087036588482074, 'psi': 0.9553837069289999}
[S17] START round=29 head_norm_before_train=1.236648 cos_to_last_merge=1.0000 (last merge round=28)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.3933599397730877, 'auprc': 0.8190585508487975, 'loss_val': 0.7367168380150063, 'psi': 0.5636393842033716}-{'f1_val': 0.4038503126207604, 'auprc': 0.8387544552094247, 'loss_val': 0.6666935136144856, 'psi': 0.577811969656226}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:42016
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:42013
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:42013
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S2
[S13] cosine check vs S2: cos=-0.0966
[S13] DROPPED delta from S2 (cos=-0.0966 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9920
[S16] RECEIVED delta(kind=head bytes=1797) from S5
[S16] cosine check vs S5: cos=0.9974
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=0.9877
[S13] RECEIVED delta(kind=head bytes=1798) from S11
[S13] cosine check vs S11: cos=-0.0281
[S13] DROPPED delta from S11 (cos=-0.0281 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9958 head_norm=1.575205
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.017484e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9958 head_norm=1.543901 delta_norm=0.101748
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9939 head_norm=1.916164
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.562993e-01
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9952 head_norm=1.854326 delta_norm=0.156299
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.8792 head_norm=1.939181
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.097230e-02
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.8790 head_norm=1.925004 delta_norm=0.070972
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.591365 cos_to_last_merge=0.7979 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7300313871590608, 'auprc': 0.8080149201558018, 'loss_val': 0.4134231725997744, 'psi': 0.7612248003577572}-{'f1_val': 0.8286223337345677, 'auprc': 0.9519859891762079, 'loss_val': 0.29167726253489523, 'psi': 0.8779677959112238}
[S3] START round=30 head_norm_before_train=1.498971 cos_to_last_merge=0.9959 (last merge round=28)
[S3] round=30 local utility u=0.032219 metrics={'f1_val': 0.9621690429782117, 'auprc': 0.9980110638417599, 'loss_val': 0.11179039774034065, 'psi': 0.976505851323631}-{'f1_val': 0.9607804860280988, 'auprc': 0.9985481424891409, 'loss_val': 0.169508756294086, 'psi': 0.9758875486125157}
[S4] START round=30 head_norm_before_train=1.803946 cos_to_last_merge=0.9998 (last merge round=28)
[S4] round=30 local utility u=0.150699 metrics={'f1_val': 0.9403347134213316, 'auprc': 0.9516797463243946, 'loss_val': 0.29587813100775917, 'psi': 0.9448727265825567}-{'f1_val': 0.916324813363715, 'auprc': 0.9277187800391042, 'loss_val': 0.3813334628483925, 'psi': 0.9208824000338707}
[S5] START round=30 head_norm_before_train=1.913357 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.996294135943965, 'loss_val': 0.03927406052019863, 'psi': 0.9969796050891813}-{'f1_val': 0.9970695586110643, 'auprc': 0.9988463320643188, 'loss_val': 0.041829978385988634, 'psi': 0.9977802679923662}
[S6] START round=30 head_norm_before_train=1.518781 cos_to_last_merge=0.8396 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.840
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.7927549878535446, 'auprc': 0.9518591897380022, 'loss_val': 0.4894036221586411, 'psi': 0.8563966686073277}-{'f1_val': 0.9633811031226898, 'auprc': 0.9723735041171929, 'loss_val': 0.1665730920978448, 'psi': 0.966978063520491}
[S7] START round=30 head_norm_before_train=1.804398 (no previous merge yet)
[S7] round=30 local utility u=0.010440 metrics={'f1_val': 0.6420537995963183, 'auprc': 0.8056998118487098, 'loss_val': 0.5503329172212484, 'psi': 0.7075122044972748}-{'f1_val': 0.6310980014415044, 'auprc': 0.8045237174140967, 'loss_val': 0.5019496809964218, 'psi': 0.7004682878305413}
[S8] START round=30 head_norm_before_train=1.686597 cos_to_last_merge=0.8088 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.809
[S8] round=30 local utility u=0.078423 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9991003641994242, 'loss_val': 0.04870305980529025, 'psi': 0.9951629804290708}-{'f1_val': 0.9741425858121917, 'auprc': 0.999187878308953, 'loss_val': 0.09543829169107344, 'psi': 0.9841607028108962}
[S9] START round=30 head_norm_before_train=1.545560 cos_to_last_merge=0.9992 (last merge round=28)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9986010213942791, 'loss_val': 0.06543138260116818, 'psi': 0.9932761775461932}-{'f1_val': 0.9971029125121428, 'auprc': 0.9970103529795421, 'loss_val': 0.06957101572542375, 'psi': 0.9970658886991025}
[S10] START round=30 head_norm_before_train=1.854326 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.027176 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9987021065410235, 'loss_val': 0.07571063722568327, 'psi': 0.9965788238445821}-{'f1_val': 0.9938648248016556, 'auprc': 0.993940633787405, 'loss_val': 0.10798644215620236, 'psi': 0.9938951483959554}
[S11] START round=30 head_norm_before_train=1.543901 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000653 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9969464678706437, 'loss_val': 0.06814867162727675, 'psi': 0.9966947060456366}-{'f1_val': 0.9958050841232382, 'auprc': 0.9981581292451158, 'loss_val': 0.06875989820882485, 'psi': 0.9967463021719892}
[S13] START round=30 head_norm_before_train=1.766335 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.598865238434392, 'auprc': 0.6798185788143664, 'loss_val': 0.8497523634388247, 'psi': 0.6312465745863818}-{'f1_val': 0.6097002198197508, 'auprc': 0.6758845014940387, 'loss_val': 0.7488693944311585, 'psi': 0.636173932489466}
[S14] START round=30 head_norm_before_train=1.848764 cos_to_last_merge=0.9997 (last merge round=28)
[S14] round=30 local utility u=0.000795 metrics={'f1_val': 0.9967943852547877, 'auprc': 0.9950814468605199, 'loss_val': 0.054235230871640984, 'psi': 0.9961092098970805}-{'f1_val': 0.9967712526152024, 'auprc': 0.9972557139982916, 'loss_val': 0.062209682371357176, 'psi': 0.996965037168438}
[S15] START round=30 head_norm_before_train=1.885161 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7010465482809536, 'auprc': 0.9133413798304575, 'loss_val': 0.5063928661855244, 'psi': 0.7859644809007551}-{'f1_val': 0.9908920538769722, 'auprc': 0.993657069903716, 'loss_val': 0.055067957774644724, 'psi': 0.9919980602876698}
[S16] START round=30 head_norm_before_train=1.925004 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8646209799409712, 'auprc': 0.9896348814817666, 'loss_val': 0.6884596103320195, 'psi': 0.9146265405572893}-{'f1_val': 0.8791788359274844, 'auprc': 0.988171530396747, 'loss_val': 0.5781043063584191, 'psi': 0.9227759137151894}
[S17] START round=30 head_norm_before_train=1.256265 cos_to_last_merge=0.9990 (last merge round=28)
[S17] round=30 local utility u=0.410157 metrics={'f1_val': 0.5054697582633212, 'auprc': 0.8414417044887522, 'loss_val': 0.6562119293023414, 'psi': 0.6398585367534937}-{'f1_val': 0.3933599397730877, 'auprc': 0.8190585508487975, 'loss_val': 0.7367168380150063, 'psi': 0.5636393842033716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:42010
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:42014
[S7] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S3
[S9] cosine check vs S3: cos=0.7785
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=-0.0232
[S15] DROPPED delta from S14 (cos=-0.0232 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S11
[S13] cosine check vs S11: cos=-0.0248
[S13] DROPPED delta from S11 (cos=-0.0248 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S10
[S3] cosine check vs S10: cos=0.8257
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.7722
[S14] RECEIVED delta(kind=head bytes=1805) from S7
[S14] cosine check vs S7: cos=0.9970
[S10] RECEIVED delta(kind=head bytes=1794) from S4
[S10] cosine check vs S4: cos=0.9958
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S17
[S3] cosine check vs S17: cos=0.7610
[S5] ⇄ pheromone p=0.150 → S16@127.0.0.1:42016
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9897 head_norm=1.600336
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.279261e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9897 head_norm=1.495539 delta_norm=0.527926
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.012 → S17@127.0.0.1:42017
[S15] ⇄ pheromone p=0.285 → S11@127.0.0.1:42012
[S6] ⇄ pheromone p=0.308 → S11@127.0.0.1:42012
[S2] ⇄ pheromone p=0.256 → S13@127.0.0.1:42013
[S13] ⇄ pheromone p=0.038 → S4@127.0.0.1:42004
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9968 head_norm=1.876096
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.748102e-02
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9968 head_norm=1.843411 delta_norm=0.077481
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.024 → S15@127.0.0.1:42015
[S7] ⇄ pheromone p=0.087 → S14@127.0.0.1:42014
[S3] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=30 metric=0.9622 head_norm=1.571499
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.047431e-01
[S3] stored merged vector for next round verification (round=30)
[S3] DEBUG after merge:  round=30 metric=0.9626 head_norm=1.441912 delta_norm=0.304743
[S3] aggregate: ACCEPT kept=['S10', 'S17'] (k=2/2) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.205 → S9@127.0.0.1:42010
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9952 head_norm=1.877951
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.826599e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9952 head_norm=1.850993 delta_norm=0.088266
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.024 → S3@127.0.0.1:42003
[S4] ⇄ pheromone p=0.077 → S10@127.0.0.1:42011
[S8] ⇄ pheromone p=0.196 → S17@127.0.0.1:42017
[S11] ⇄ pheromone p=0.044 → S13@127.0.0.1:42013
[S16] ⇄ pheromone p=0.056 → S17@127.0.0.1:42017
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5055 head_norm=1.284141
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.385844e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.4957 head_norm=1.403795 delta_norm=0.538584
[S17] aggregate: ROLLBACK (f1_val pre=0.505 post=0.496 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.155 → S3@127.0.0.1:42003
[S2] START round=31 head_norm_before_train=1.608137 cos_to_last_merge=0.7960 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=31 local utility u=0.535798 metrics={'f1_val': 0.8097798426641073, 'auprc': 0.9915230434428097, 'loss_val': 0.37084172882432564, 'psi': 0.8824771229755883}-{'f1_val': 0.7300313871590608, 'auprc': 0.8080149201558018, 'loss_val': 0.4134231725997744, 'psi': 0.7612248003577572}
[S3] START round=31 head_norm_before_train=1.441912 cos_to_last_merge=1.0000 (last merge round=30)
[S3] round=31 local utility u=0.114897 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.997270939275519, 'loss_val': 0.08945054983604117, 'psi': 0.9971773352588531}-{'f1_val': 0.9621690429782117, 'auprc': 0.9980110638417599, 'loss_val': 0.11179039774034065, 'psi': 0.976505851323631}
[S4] START round=31 head_norm_before_train=1.827904 cos_to_last_merge=0.9992 (last merge round=28)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9384078941600975, 'auprc': 0.9503520398180233, 'loss_val': 0.3127108026948788, 'psi': 0.9431855524232677}-{'f1_val': 0.9403347134213316, 'auprc': 0.9516797463243946, 'loss_val': 0.29587813100775917, 'psi': 0.9448727265825567}
[S5] START round=31 head_norm_before_train=1.939154 (no previous merge yet)
[S5] round=31 local utility u=0.000593 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9963440142871582, 'loss_val': 0.03823849109938913, 'psi': 0.9969995564264585}-{'f1_val': 0.9974365845193254, 'auprc': 0.996294135943965, 'loss_val': 0.03927406052019863, 'psi': 0.9969796050891813}
[S6] START round=31 head_norm_before_train=1.528644 cos_to_last_merge=0.8386 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=31 local utility u=0.610504 metrics={'f1_val': 0.9423752139177295, 'auprc': 0.9711115203591293, 'loss_val': 0.22387327068225282, 'psi': 0.9538697364942894}-{'f1_val': 0.7927549878535446, 'auprc': 0.9518591897380022, 'loss_val': 0.4894036221586411, 'psi': 0.8563966686073277}
[S7] START round=31 head_norm_before_train=1.813449 (no previous merge yet)
[S7] round=31 local utility u=0.355420 metrics={'f1_val': 0.6856036100097287, 'auprc': 0.857987943562029, 'loss_val': 0.2576566145329426, 'psi': 0.7545573434306488}-{'f1_val': 0.6420537995963183, 'auprc': 0.8056998118487098, 'loss_val': 0.5503329172212484, 'psi': 0.7075122044972748}
[S8] START round=31 head_norm_before_train=1.694818 cos_to_last_merge=0.8081 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.808
[S8] round=31 local utility u=0.000000 metrics={'f1_val': 0.9894339852550165, 'auprc': 0.9990954226161409, 'loss_val': 0.06439147171147029, 'psi': 0.9932985601994662}-{'f1_val': 0.9925380579155019, 'auprc': 0.9991003641994242, 'loss_val': 0.04870305980529025, 'psi': 0.9951629804290708}
[S9] START round=31 head_norm_before_train=1.495539 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.992517307028054, 'loss_val': 0.09605015331045205, 'psi': 0.9952686703185073}-{'f1_val': 0.9897262816474692, 'auprc': 0.9986010213942791, 'loss_val': 0.06543138260116818, 'psi': 0.9932761775461932}
[S10] START round=31 head_norm_before_train=1.850993 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9942179850461464, 'auprc': 0.9986645699615384, 'loss_val': 0.08022590133349004, 'psi': 0.9959966190123032}-{'f1_val': 0.9951633020469546, 'auprc': 0.9987021065410235, 'loss_val': 0.07571063722568327, 'psi': 0.9965788238445821}
[S11] START round=31 head_norm_before_train=1.573587 cos_to_last_merge=0.9996 (last merge round=29)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9926899424571232, 'auprc': 0.9964796077809431, 'loss_val': 0.06275188815463202, 'psi': 0.9942058085866512}-{'f1_val': 0.9965268648289654, 'auprc': 0.9969464678706437, 'loss_val': 0.06814867162727675, 'psi': 0.9966947060456366}
[S13] START round=31 head_norm_before_train=1.767933 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5312634287167983, 'auprc': 0.6914408695068266, 'loss_val': 0.9796304725324159, 'psi': 0.5953344050328097}-{'f1_val': 0.598865238434392, 'auprc': 0.6798185788143664, 'loss_val': 0.8497523634388247, 'psi': 0.6312465745863818}
[S14] START round=31 head_norm_before_train=1.843411 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.007233 metrics={'f1_val': 0.9976737714957896, 'auprc': 0.9966545837628338, 'loss_val': 0.0497643205126918, 'psi': 0.9972660964026072}-{'f1_val': 0.9967943852547877, 'auprc': 0.9950814468605199, 'loss_val': 0.054235230871640984, 'psi': 0.9961092098970805}
[S15] START round=31 head_norm_before_train=1.897484 (no previous merge yet)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9948830260911032, 'auprc': 0.9927274820453283, 'loss_val': 0.03692386318686497, 'psi': 0.9940208084727933}-{'f1_val': 0.7010465482809536, 'auprc': 0.9133413798304575, 'loss_val': 0.5063928661855244, 'psi': 0.7859644809007551}
[S16] START round=31 head_norm_before_train=1.945174 cos_to_last_merge=0.9999 (last merge round=29)
[S16] round=31 local utility u=0.680006 metrics={'f1_val': 0.9889430115591722, 'auprc': 0.9884546568947498, 'loss_val': 0.07083961381912507, 'psi': 0.9887476696934032}-{'f1_val': 0.8646209799409712, 'auprc': 0.9896348814817666, 'loss_val': 0.6884596103320195, 'psi': 0.9146265405572893}
[S17] START round=31 head_norm_before_train=1.403795 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.313250 metrics={'f1_val': 0.585768617886578, 'auprc': 0.8894855344145853, 'loss_val': 0.6556369448785906, 'psi': 0.7072553844977809}-{'f1_val': 0.5054697582633212, 'auprc': 0.8414417044887522, 'loss_val': 0.6562119293023414, 'psi': 0.6398585367534937}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:42010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:42012
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:42016
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:42012
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:42015
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S3
[S9] cosine check vs S3: cos=0.8947
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.9928
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9976
[S13] RECEIVED delta(kind=head bytes=1799) from S2
[S13] cosine check vs S2: cos=-0.0932
[S13] DROPPED delta from S2 (cos=-0.0932 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1799) from S14
[S15] cosine check vs S14: cos=-0.0235
[S15] DROPPED delta from S14 (cos=-0.0235 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1802) from S15
[S11] cosine check vs S15: cos=-0.0089
[S11] DROPPED delta from S15 (cos=-0.0089 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1802) from S16
[S17] cosine check vs S16: cos=0.2991
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[S17] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S17
[S3] cosine check vs S17: cos=0.7230
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9971 head_norm=1.559036
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.531701e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9971 head_norm=1.494748 delta_norm=0.353170
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=31 metric=0.9971 head_norm=1.512417
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.485679e-01
[S3] stored merged vector for next round verification (round=31)
[S3] DEBUG after merge:  round=31 metric=0.9971 head_norm=1.364613 delta_norm=0.548568
[S3] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9977 head_norm=1.866637
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.897801e-02
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9977 head_norm=1.842459 delta_norm=0.058978
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=31 metric=0.9927 head_norm=1.602645
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.915441e-02
[S11] stored merged vector for next round verification (round=31)
[S11] DEBUG after merge:  round=31 metric=0.9917 head_norm=1.569262 delta_norm=0.099154
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=31 metric=0.9889 head_norm=1.964943
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.853648e-02
[S16] stored merged vector for next round verification (round=31)
[S16] DEBUG after merge:  round=31 metric=0.9889 head_norm=1.959012 delta_norm=0.068536
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.5858 head_norm=1.427861
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.027328e+00
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.4573 head_norm=1.376405 delta_norm=1.027328
[S17] aggregate: ROLLBACK (f1_val pre=0.586 post=0.457 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.622237 cos_to_last_merge=0.7946 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.8380725256097268, 'auprc': 0.7997680015950517, 'loss_val': 0.3174068159965896, 'psi': 0.8227507160038567}-{'f1_val': 0.8097798426641073, 'auprc': 0.9915230434428097, 'loss_val': 0.37084172882432564, 'psi': 0.8824771229755883}
[S3] START round=32 head_norm_before_train=1.364613 cos_to_last_merge=1.0000 (last merge round=31)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9974844266432159, 'loss_val': 0.14544808113263566, 'psi': 0.9759168838302948}-{'f1_val': 0.9971149325810758, 'auprc': 0.997270939275519, 'loss_val': 0.08945054983604117, 'psi': 0.9971773352588531}
[S4] START round=32 head_norm_before_train=1.852359 cos_to_last_merge=0.9982 (last merge round=28)
[S4] round=32 local utility u=0.057961 metrics={'f1_val': 0.9475327439051386, 'auprc': 0.9592803830812634, 'loss_val': 0.2783233075599278, 'psi': 0.9522317995755886}-{'f1_val': 0.9384078941600975, 'auprc': 0.9503520398180233, 'loss_val': 0.3127108026948788, 'psi': 0.9431855524232677}
[S5] START round=32 head_norm_before_train=1.955465 (no previous merge yet)
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9950779052571288, 'loss_val': 0.03279466297051032, 'psi': 0.9960523431899262}-{'f1_val': 0.9974365845193254, 'auprc': 0.9963440142871582, 'loss_val': 0.03823849109938913, 'psi': 0.9969995564264585}
[S6] START round=32 head_norm_before_train=1.541545 cos_to_last_merge=0.8376 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8277541806866424, 'auprc': 0.9549191775823652, 'loss_val': 0.43203248194404165, 'psi': 0.8786201794449315}-{'f1_val': 0.9423752139177295, 'auprc': 0.9711115203591293, 'loss_val': 0.22387327068225282, 'psi': 0.9538697364942894}
[S7] START round=32 head_norm_before_train=1.819873 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6745888685029531, 'auprc': 0.843660459575579, 'loss_val': 0.29866344721141674, 'psi': 0.7422175049320034}-{'f1_val': 0.6856036100097287, 'auprc': 0.857987943562029, 'loss_val': 0.2576566145329426, 'psi': 0.7545573434306488}
[S8] START round=32 head_norm_before_train=1.705903 cos_to_last_merge=0.8073 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.98701020433489, 'auprc': 0.9990479316126692, 'loss_val': 0.07582235276754232, 'psi': 0.9918252952460017}-{'f1_val': 0.9894339852550165, 'auprc': 0.9990954226161409, 'loss_val': 0.06439147171147029, 'psi': 0.9932985601994662}
[S9] START round=32 head_norm_before_train=1.494748 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.001724 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9981682849326048, 'loss_val': 0.10955598964635298, 'psi': 0.9975290614803276}-{'f1_val': 0.9971029125121428, 'auprc': 0.992517307028054, 'loss_val': 0.09605015331045205, 'psi': 0.9952686703185073}
[S10] START round=32 head_norm_before_train=1.876471 cos_to_last_merge=0.9996 (last merge round=30)
[S10] round=32 local utility u=0.004194 metrics={'f1_val': 0.9936100131187782, 'auprc': 0.9982156001622218, 'loss_val': 0.06684225608688002, 'psi': 0.9954522479361556}-{'f1_val': 0.9942179850461464, 'auprc': 0.9986645699615384, 'loss_val': 0.08022590133349004, 'psi': 0.9959966190123032}
[S11] START round=32 head_norm_before_train=1.569262 cos_to_last_merge=1.0000 (last merge round=31)
[S11] round=32 local utility u=0.015248 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9976718615930688, 'loss_val': 0.05885421523937417, 'psi': 0.9969848635346067}-{'f1_val': 0.9926899424571232, 'auprc': 0.9964796077809431, 'loss_val': 0.06275188815463202, 'psi': 0.9942058085866512}
[S13] START round=32 head_norm_before_train=1.771073 (no previous merge yet)
[S13] round=32 local utility u=0.325589 metrics={'f1_val': 0.6028540798762709, 'auprc': 0.6688166481580243, 'loss_val': 0.6901240271445181, 'psi': 0.6292391071889722}-{'f1_val': 0.5312634287167983, 'auprc': 0.6914408695068266, 'loss_val': 0.9796304725324159, 'psi': 0.5953344050328097}
[S14] START round=32 head_norm_before_train=1.842459 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9969210875230057, 'loss_val': 0.05308218813716148, 'psi': 0.9964567393280046}-{'f1_val': 0.9976737714957896, 'auprc': 0.9966545837628338, 'loss_val': 0.0497643205126918, 'psi': 0.9972660964026072}
[S15] START round=32 head_norm_before_train=1.909078 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7776003200620973, 'auprc': 0.9897585007263761, 'loss_val': 0.3226637321683523, 'psi': 0.8624635923278088}-{'f1_val': 0.9948830260911032, 'auprc': 0.9927274820453283, 'loss_val': 0.03692386318686497, 'psi': 0.9940208084727933}
[S16] START round=32 head_norm_before_train=1.959012 cos_to_last_merge=1.0000 (last merge round=31)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9333702865712745, 'auprc': 0.9909346679808778, 'loss_val': 0.35483034667472635, 'psi': 0.9563960391351158}-{'f1_val': 0.9889430115591722, 'auprc': 0.9884546568947498, 'loss_val': 0.07083961381912507, 'psi': 0.9887476696934032}
[S17] START round=32 head_norm_before_train=1.376405 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5355984507636424, 'auprc': 0.8428972179019367, 'loss_val': 0.5973409371906004, 'psi': 0.6585179576189601}-{'f1_val': 0.585768617886578, 'auprc': 0.8894855344145853, 'loss_val': 0.6556369448785906, 'psi': 0.7072553844977809}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:42004
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] → sending delta(kind=head bytes=1810) to S17@127.0.0.1:42017
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:42013
[S11] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1810 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S11
[S13] cosine check vs S11: cos=-0.0211
[S13] DROPPED delta from S11 (cos=-0.0211 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.7338
[S10] RECEIVED delta(kind=head bytes=1806) from S4
[S10] cosine check vs S4: cos=0.9958
[S17] RECEIVED delta(kind=head bytes=1810) from S9
[S17] cosine check vs S9: cos=0.7439
[S4] RECEIVED delta(kind=head bytes=1802) from S13
[S4] cosine check vs S13: cos=0.9923
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=32 metric=0.9615 head_norm=1.436531
[S3] _apply_head_vector_avg (torch): Δ‖w‖=6.470981e-01
[S3] stored merged vector for next round verification (round=32)
[S3] DEBUG after merge:  round=32 metric=0.9666 head_norm=1.557473 delta_norm=0.647098
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9475 head_norm=1.870718
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.230453e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9472 head_norm=1.818399 delta_norm=0.123045
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=32 metric=0.9936 head_norm=1.904020
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.820743e-02
[S10] stored merged vector for next round verification (round=32)
[S10] DEBUG after merge:  round=32 metric=0.9936 head_norm=1.885380 delta_norm=0.088207
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.5356 head_norm=1.413460
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.384610e-01
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.5799 head_norm=1.392620 delta_norm=0.538461
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.634741 cos_to_last_merge=0.7930 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.793
[S2] round=33 local utility u=0.230737 metrics={'f1_val': 0.8275918206079502, 'auprc': 0.9814148361281363, 'loss_val': 0.3379881118124619, 'psi': 0.8891210268160247}-{'f1_val': 0.8380725256097268, 'auprc': 0.7997680015950517, 'loss_val': 0.3174068159965896, 'psi': 0.8227507160038567}
[S3] START round=33 head_norm_before_train=1.557473 cos_to_last_merge=1.0000 (last merge round=32)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9971655157322112, 'loss_val': 0.16851373878059908, 'psi': 0.9753583981543652}-{'f1_val': 0.9615385219550141, 'auprc': 0.9974844266432159, 'loss_val': 0.14544808113263566, 'psi': 0.9759168838302948}
[S4] START round=33 head_norm_before_train=1.818399 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9385637437278604, 'auprc': 0.9293146328450614, 'loss_val': 0.3308898875362615, 'psi': 0.9348640993747408}-{'f1_val': 0.9475327439051386, 'auprc': 0.9592803830812634, 'loss_val': 0.2783233075599278, 'psi': 0.9522317995755886}
[S5] START round=33 head_norm_before_train=1.962949 (no previous merge yet)
[S5] round=33 local utility u=0.006416 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9974110794831083, 'loss_val': 0.029168311539603094, 'psi': 0.997206166959882}-{'f1_val': 0.9967019684784577, 'auprc': 0.9950779052571288, 'loss_val': 0.03279466297051032, 'psi': 0.9960523431899262}
[S6] START round=33 head_norm_before_train=1.552942 cos_to_last_merge=0.8367 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.837
[S6] round=33 local utility u=0.109299 metrics={'f1_val': 0.8556072090039493, 'auprc': 0.9597678516019068, 'loss_val': 0.39509823107491265, 'psi': 0.8972714660431322}-{'f1_val': 0.8277541806866424, 'auprc': 0.9549191775823652, 'loss_val': 0.43203248194404165, 'psi': 0.8786201794449315}
[S7] START round=33 head_norm_before_train=1.821694 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6146267711791907, 'auprc': 0.7974913566999262, 'loss_val': 0.6944613592155601, 'psi': 0.687772605387485}-{'f1_val': 0.6745888685029531, 'auprc': 0.843660459575579, 'loss_val': 0.29866344721141674, 'psi': 0.7422175049320034}
[S8] START round=33 head_norm_before_train=1.718552 cos_to_last_merge=0.8064 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=33 local utility u=0.028612 metrics={'f1_val': 0.9915895183459548, 'auprc': 0.9992587972923379, 'loss_val': 0.046707333973821485, 'psi': 0.994657229924508}-{'f1_val': 0.98701020433489, 'auprc': 0.9990479316126692, 'loss_val': 0.07582235276754232, 'psi': 0.9918252952460017}
[S9] START round=33 head_norm_before_train=1.568691 cos_to_last_merge=0.9943 (last merge round=31)
[S9] round=33 local utility u=0.020854 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984115300925078, 'loss_val': 0.06343768835329648, 'psi': 0.9971122810165346}-{'f1_val': 0.9971029125121428, 'auprc': 0.9981682849326048, 'loss_val': 0.10955598964635298, 'psi': 0.9975290614803276}
[S10] START round=33 head_norm_before_train=1.885380 cos_to_last_merge=1.0000 (last merge round=32)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.994089666687197, 'loss_val': 0.07650995946633546, 'psi': 0.9946167785939245}-{'f1_val': 0.9936100131187782, 'auprc': 0.9982156001622218, 'loss_val': 0.06684225608688002, 'psi': 0.9954522479361556}
[S11] START round=33 head_norm_before_train=1.596723 cos_to_last_merge=0.9996 (last merge round=31)
[S11] round=33 local utility u=0.005176 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9977555261119562, 'loss_val': 0.048753980792756633, 'psi': 0.9970183293421617}-{'f1_val': 0.9965268648289654, 'auprc': 0.9976718615930688, 'loss_val': 0.05885421523937417, 'psi': 0.9969848635346067}
[S13] START round=33 head_norm_before_train=1.773088 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5729707106925448, 'auprc': 0.6848916253347943, 'loss_val': 0.8771555272731876, 'psi': 0.6177390765494446}-{'f1_val': 0.6028540798762709, 'auprc': 0.6688166481580243, 'loss_val': 0.6901240271445181, 'psi': 0.6292391071889722}
[S14] START round=33 head_norm_before_train=1.866197 cos_to_last_merge=0.9998 (last merge round=31)
[S14] round=33 local utility u=0.010849 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9990391090015085, 'loss_val': 0.04645206618097098, 'psi': 0.9981753137503834}-{'f1_val': 0.9961471738646706, 'auprc': 0.9969210875230057, 'loss_val': 0.05308218813716148, 'psi': 0.9964567393280046}
[S15] START round=33 head_norm_before_train=1.923982 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.701196517572327, 'auprc': 0.8834675754175134, 'loss_val': 0.5089894288957358, 'psi': 0.7741049407104016}-{'f1_val': 0.7776003200620973, 'auprc': 0.9897585007263761, 'loss_val': 0.3226637321683523, 'psi': 0.8624635923278088}
[S16] START round=33 head_norm_before_train=1.979209 cos_to_last_merge=0.9999 (last merge round=31)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9152289638878505, 'auprc': 0.9908845780871731, 'loss_val': 0.4494200306028415, 'psi': 0.9454912095675796}-{'f1_val': 0.9333702865712745, 'auprc': 0.9909346679808778, 'loss_val': 0.35483034667472635, 'psi': 0.9563960391351158}
[S17] START round=33 head_norm_before_train=1.392620 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5002923418998128, 'auprc': 0.717401670284722, 'loss_val': 0.7157996713922774, 'psi': 0.5871360732537765}-{'f1_val': 0.5355984507636424, 'auprc': 0.8428972179019367, 'loss_val': 0.5973409371906004, 'psi': 0.6585179576189601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:42015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:42013
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:42016
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:42012
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S9] → sending delta(kind=head bytes=1808) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1808 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9935
[S16] RECEIVED delta(kind=head bytes=1800) from S5
[S16] cosine check vs S5: cos=0.9982
[S17] RECEIVED delta(kind=head bytes=1808) from S9
[S17] cosine check vs S9: cos=0.9289
[S13] RECEIVED delta(kind=head bytes=1800) from S2
[S13] cosine check vs S2: cos=-0.0911
[S13] DROPPED delta from S2 (cos=-0.0911 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.5145
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=-0.0234
[S15] DROPPED delta from S14 (cos=-0.0234 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S11
[S13] cosine check vs S11: cos=-0.0219
[S13] DROPPED delta from S11 (cos=-0.0219 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9965 head_norm=1.623051
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.578124e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9965 head_norm=1.590717 delta_norm=0.095781
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.5003 head_norm=1.431213
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.991644e-01
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.5325 head_norm=1.375956 delta_norm=0.399164
[S17] aggregate: ACCEPT kept=['S9', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9152 head_norm=1.998948
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.111304e-02
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9152 head_norm=1.984754 delta_norm=0.061113
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.642919 cos_to_last_merge=0.7922 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.832156274395553, 'auprc': 0.8379101921020187, 'loss_val': 0.3300881280235165, 'psi': 0.8344578414781393}-{'f1_val': 0.8275918206079502, 'auprc': 0.9814148361281363, 'loss_val': 0.3379881118124619, 'psi': 0.8891210268160247}
[S3] START round=34 head_norm_before_train=1.630039 cos_to_last_merge=0.9955 (last merge round=32)
[S3] round=34 local utility u=0.160708 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9973453245759196, 'loss_val': 0.0657496174379356, 'psi': 0.9972415477747854}-{'f1_val': 0.9608203197691346, 'auprc': 0.9971655157322112, 'loss_val': 0.16851373878059908, 'psi': 0.9753583981543652}
[S4] START round=34 head_norm_before_train=1.832174 cos_to_last_merge=0.9999 (last merge round=32)
[S4] round=34 local utility u=0.067760 metrics={'f1_val': 0.9420918805041915, 'auprc': 0.9535316261678064, 'loss_val': 0.28918886360335744, 'psi': 0.9466677787696375}-{'f1_val': 0.9385637437278604, 'auprc': 0.9293146328450614, 'loss_val': 0.3308898875362615, 'psi': 0.9348640993747408}
[S5] START round=34 head_norm_before_train=1.972352 (no previous merge yet)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9951205128574775, 'loss_val': 0.030274907613670986, 'psi': 0.9962899403096296}-{'f1_val': 0.9970695586110643, 'auprc': 0.9974110794831083, 'loss_val': 0.029168311539603094, 'psi': 0.997206166959882}
[S6] START round=34 head_norm_before_train=1.563591 cos_to_last_merge=0.8358 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.7752960682633334, 'auprc': 0.9583490532878212, 'loss_val': 0.4829709082965849, 'psi': 0.8485172622731285}-{'f1_val': 0.8556072090039493, 'auprc': 0.9597678516019068, 'loss_val': 0.39509823107491265, 'psi': 0.8972714660431322}
[S7] START round=34 head_norm_before_train=1.826806 (no previous merge yet)
[S7] round=34 local utility u=0.293887 metrics={'f1_val': 0.6569200334823382, 'auprc': 0.8125373365857269, 'loss_val': 0.4055853860828573, 'psi': 0.7191669547236936}-{'f1_val': 0.6146267711791907, 'auprc': 0.7974913566999262, 'loss_val': 0.6944613592155601, 'psi': 0.687772605387485}
[S8] START round=34 head_norm_before_train=1.729181 cos_to_last_merge=0.8057 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9990865982209087, 'loss_val': 0.05507370200067842, 'psi': 0.993212770506379}-{'f1_val': 0.9915895183459548, 'auprc': 0.9992587972923379, 'loss_val': 0.046707333973821485, 'psi': 0.994657229924508}
[S9] START round=34 head_norm_before_train=1.650677 cos_to_last_merge=0.9829 (last merge round=31)
[S9] round=34 local utility u=0.009034 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.998337584587191, 'loss_val': 0.04529817704079329, 'psi': 0.9970976512731201}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984115300925078, 'loss_val': 0.06343768835329648, 'psi': 0.9971122810165346}
[S10] START round=34 head_norm_before_train=1.911157 cos_to_last_merge=0.9997 (last merge round=32)
[S10] round=34 local utility u=0.014606 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9983757916790719, 'loss_val': 0.06015666366061948, 'psi': 0.9963312285906745}-{'f1_val': 0.9949681865317428, 'auprc': 0.994089666687197, 'loss_val': 0.07650995946633546, 'psi': 0.9946167785939245}
[S11] START round=34 head_norm_before_train=1.590717 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9680096593315367, 'auprc': 0.9980672794057752, 'loss_val': 0.13332318899614454, 'psi': 0.980032707361232}-{'f1_val': 0.9965268648289654, 'auprc': 0.9977555261119562, 'loss_val': 0.048753980792756633, 'psi': 0.9970183293421617}
[S13] START round=34 head_norm_before_train=1.778792 (no previous merge yet)
[S13] round=34 local utility u=0.151579 metrics={'f1_val': 0.6039903754558379, 'auprc': 0.6732393560268892, 'loss_val': 0.7251583077659831, 'psi': 0.6316899676842584}-{'f1_val': 0.5729707106925448, 'auprc': 0.6848916253347943, 'loss_val': 0.8771555272731876, 'psi': 0.6177390765494446}
[S14] START round=34 head_norm_before_train=1.888056 cos_to_last_merge=0.9993 (last merge round=31)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9990465400146092, 'loss_val': 0.04311761860316185, 'psi': 0.997813242219313}-{'f1_val': 0.9975994502496334, 'auprc': 0.9990391090015085, 'loss_val': 0.04645206618097098, 'psi': 0.9981753137503834}
[S15] START round=34 head_norm_before_train=1.936384 (no previous merge yet)
[S15] round=34 local utility u=0.607578 metrics={'f1_val': 0.8078298817396405, 'auprc': 0.989634705847027, 'loss_val': 0.2521353488331245, 'psi': 0.8805518113825951}-{'f1_val': 0.701196517572327, 'auprc': 0.8834675754175134, 'loss_val': 0.5089894288957358, 'psi': 0.7741049407104016}
[S16] START round=34 head_norm_before_train=1.984754 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.056666 metrics={'f1_val': 0.9245788865745881, 'auprc': 0.9901074537569344, 'loss_val': 0.3898568456145113, 'psi': 0.9507903134475266}-{'f1_val': 0.9152289638878505, 'auprc': 0.9908845780871731, 'loss_val': 0.4494200306028415, 'psi': 0.9454912095675796}
[S17] START round=34 head_norm_before_train=1.375956 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.48900636292415345, 'auprc': 0.7085193450645191, 'loss_val': 0.8117276061658417, 'psi': 0.5768115557802997}-{'f1_val': 0.5002923418998128, 'auprc': 0.717401670284722, 'loss_val': 0.7157996713922774, 'psi': 0.5871360732537765}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:42010
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:42017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S10
[S3] cosine check vs S10: cos=0.9084
[S17] RECEIVED delta(kind=head bytes=1802) from S9
[S17] cosine check vs S9: cos=0.9101
[S9] RECEIVED delta(kind=head bytes=1803) from S3
[S9] cosine check vs S3: cos=0.8418
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=0.9942
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:42004
[S13] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1804) from S13
[S4] cosine check vs S13: cos=0.9964
[S11] RECEIVED delta(kind=head bytes=1803) from S15
[S11] cosine check vs S15: cos=-0.0101
[S11] DROPPED delta from S15 (cos=-0.0101 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:42017
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S16
[S17] cosine check vs S16: cos=0.5772
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=34 metric=0.9950 head_norm=1.937141
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.116429e-01
[S10] stored merged vector for next round verification (round=34)
[S10] DEBUG after merge:  round=34 metric=0.9950 head_norm=1.888638 delta_norm=0.111643
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=34 metric=0.9972 head_norm=1.705139
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.059289e-01
[S3] stored merged vector for next round verification (round=34)
[S3] DEBUG after merge:  round=34 metric=0.9968 head_norm=1.779109 delta_norm=0.405929
[S3] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9421 head_norm=1.845621
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.242688e-02
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9421 head_norm=1.814813 delta_norm=0.082427
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.4890 head_norm=1.413243
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.564865e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.4626 head_norm=1.458653 delta_norm=0.456486
[S17] aggregate: ROLLBACK (f1_val pre=0.489 post=0.463 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9963 head_norm=1.715369
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.809810e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9963 head_norm=1.641235 delta_norm=0.480981
[S9] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.650664 cos_to_last_merge=0.7912 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.8217693205576497, 'auprc': 0.8780961824914059, 'loss_val': 0.42424402390585464, 'psi': 0.8443000653311521}-{'f1_val': 0.832156274395553, 'auprc': 0.8379101921020187, 'loss_val': 0.3300881280235165, 'psi': 0.8344578414781393}
[S3] START round=35 head_norm_before_train=1.779109 cos_to_last_merge=1.0000 (last merge round=34)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9972735872110248, 'loss_val': 0.14889611803866706, 'psi': 0.9753777265012693}-{'f1_val': 0.9971723632406959, 'auprc': 0.9973453245759196, 'loss_val': 0.0657496174379356, 'psi': 0.9972415477747854}
[S4] START round=35 head_norm_before_train=1.814813 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9408638380071288, 'auprc': 0.9512775552018619, 'loss_val': 0.2894274904338851, 'psi': 0.9450293248850221}-{'f1_val': 0.9420918805041915, 'auprc': 0.9535316261678064, 'loss_val': 0.28918886360335744, 'psi': 0.9466677787696375}
[S5] START round=35 head_norm_before_train=1.985126 (no previous merge yet)
[S5] round=35 local utility u=0.006088 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9980147262419518, 'loss_val': 0.02678236399187957, 'psi': 0.9974476256634193}-{'f1_val': 0.9970695586110643, 'auprc': 0.9951205128574775, 'loss_val': 0.030274907613670986, 'psi': 0.9962899403096296}
[S6] START round=35 head_norm_before_train=1.577217 cos_to_last_merge=0.8346 (last merge round=2)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=35 local utility u=0.420751 metrics={'f1_val': 0.8763391061067, 'auprc': 0.9713685928099669, 'loss_val': 0.2867850847788839, 'psi': 0.9143509007880067}-{'f1_val': 0.7752960682633334, 'auprc': 0.9583490532878212, 'loss_val': 0.4829709082965849, 'psi': 0.8485172622731285}
[S7] START round=35 head_norm_before_train=1.832269 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.627049253470749, 'auprc': 0.8014216712053586, 'loss_val': 0.50715016251666, 'psi': 0.6967982205645928}-{'f1_val': 0.6569200334823382, 'auprc': 0.8125373365857269, 'loss_val': 0.4055853860828573, 'psi': 0.7191669547236936}
[S8] START round=35 head_norm_before_train=1.741899 cos_to_last_merge=0.8046 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9889384063943332, 'auprc': 0.9990878468832117, 'loss_val': 0.054479971721859394, 'psi': 0.9929981825898846}-{'f1_val': 0.9892968853633592, 'auprc': 0.9990865982209087, 'loss_val': 0.05507370200067842, 'psi': 0.993212770506379}
[S9] START round=35 head_norm_before_train=1.641235 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9933040133416353, 'loss_val': 0.0869144380624783, 'psi': 0.9955833528439398}-{'f1_val': 0.9962710290637395, 'auprc': 0.998337584587191, 'loss_val': 0.04529817704079329, 'psi': 0.9970976512731201}
[S10] START round=35 head_norm_before_train=1.888638 cos_to_last_merge=1.0000 (last merge round=34)
[S10] round=35 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9974986951666758, 'loss_val': 0.0743814684476618, 'psi': 0.995980389985716}-{'f1_val': 0.9949681865317428, 'auprc': 0.9983757916790719, 'loss_val': 0.06015666366061948, 'psi': 0.9963312285906745}
[S11] START round=35 head_norm_before_train=1.612390 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=35 local utility u=0.125395 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.9980100780989306, 'loss_val': 0.0495339373245617, 'psi': 0.996727050383184}-{'f1_val': 0.9680096593315367, 'auprc': 0.9980672794057752, 'loss_val': 0.13332318899614454, 'psi': 0.980032707361232}
[S13] START round=35 head_norm_before_train=1.787278 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5579326282238269, 'auprc': 0.6820647038162151, 'loss_val': 0.7605570041830622, 'psi': 0.6075854584607823}-{'f1_val': 0.6039903754558379, 'auprc': 0.6732393560268892, 'loss_val': 0.7251583077659831, 'psi': 0.6316899676842584}
[S14] START round=35 head_norm_before_train=1.906535 cos_to_last_merge=0.9986 (last merge round=31)
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9959272586020071, 'auprc': 0.9962281138364635, 'loss_val': 0.04334221352282626, 'psi': 0.9960476006957897}-{'f1_val': 0.9969910436891155, 'auprc': 0.9990465400146092, 'loss_val': 0.04311761860316185, 'psi': 0.997813242219313}
[S15] START round=35 head_norm_before_train=1.950337 (no previous merge yet)
[S15] round=35 local utility u=0.661537 metrics={'f1_val': 0.993291639802511, 'auprc': 0.9910773125071496, 'loss_val': 0.046159072688117045, 'psi': 0.9924059088843664}-{'f1_val': 0.8078298817396405, 'auprc': 0.989634705847027, 'loss_val': 0.2521353488331245, 'psi': 0.8805518113825951}
[S16] START round=35 head_norm_before_train=2.001247 cos_to_last_merge=0.9999 (last merge round=33)
[S16] round=35 local utility u=0.308254 metrics={'f1_val': 0.9782612474091866, 'auprc': 0.9901586836411418, 'loss_val': 0.09559700690061623, 'psi': 0.9830202219019687}-{'f1_val': 0.9245788865745881, 'auprc': 0.9901074537569344, 'loss_val': 0.3898568456145113, 'psi': 0.9507903134475266}
[S17] START round=35 head_norm_before_train=1.458653 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.167546 metrics={'f1_val': 0.5444180974767017, 'auprc': 0.7159973006666078, 'loss_val': 0.8315393217181072, 'psi': 0.6130497787526641}-{'f1_val': 0.48900636292415345, 'auprc': 0.7085193450645191, 'loss_val': 0.8117276061658417, 'psi': 0.5768115557802997}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:42007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:42014
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:42005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1797) from S11
[S6] cosine check vs S11: cos=0.9951
[S5] RECEIVED delta(kind=head bytes=1803) from S16
[S5] cosine check vs S16: cos=0.9988
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=-0.0234
[S14] DROPPED delta from S15 (cos=-0.0234 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.4794
[S10] ⇄ pheromone p=0.011 → S4@127.0.0.1:42004
[S13] ⇄ pheromone p=0.070 → S2@127.0.0.1:42002
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.9971 head_norm=1.993528
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.125395e-02
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.9971 head_norm=2.004234 delta_norm=0.051254
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.102 → S17@127.0.0.1:42017
[S4] ⇄ pheromone p=0.042 → S13@127.0.0.1:42013
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.8763 head_norm=1.589256
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.257826e-02
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.8756 head_norm=1.607664 delta_norm=0.082578
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.008 → S3@127.0.0.1:42003
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9889 head_norm=1.755816
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.359854e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9875 head_norm=1.397675 delta_norm=0.835985
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.042 → S6@127.0.0.1:42007
[S14] ⇄ pheromone p=0.010 → S7@127.0.0.1:42008
[S16] ⇄ pheromone p=0.145 → S5@127.0.0.1:42005
[S17] ⇄ pheromone p=0.110 → S8@127.0.0.1:42009
[S15] ⇄ pheromone p=0.405 → S14@127.0.0.1:42014
[S2] START round=36 head_norm_before_train=1.662156 cos_to_last_merge=0.7898 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.8326070425486574, 'auprc': 0.8145507493893841, 'loss_val': 0.31326239580035364, 'psi': 0.8253845252849481}-{'f1_val': 0.8217693205576497, 'auprc': 0.8780961824914059, 'loss_val': 0.42424402390585464, 'psi': 0.8443000653311521}
[S3] START round=36 head_norm_before_train=1.834480 cos_to_last_merge=0.9979 (last merge round=34)
[S3] round=36 local utility u=0.010099 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9978958670854028, 'loss_val': 0.13080413907604557, 'psi': 0.9756505386956418}-{'f1_val': 0.9607804860280988, 'auprc': 0.9972735872110248, 'loss_val': 0.14889611803866706, 'psi': 0.9753777265012693}
[S4] START round=36 head_norm_before_train=1.828272 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9393465543322861, 'auprc': 0.9485646965120306, 'loss_val': 0.3037217133008065, 'psi': 0.9430338112041838}-{'f1_val': 0.9408638380071288, 'auprc': 0.9512775552018619, 'loss_val': 0.2894274904338851, 'psi': 0.9450293248850221}
[S5] START round=36 head_norm_before_train=2.004234 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.003474 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992972887712392, 'loss_val': 0.025883705811063206, 'psi': 0.998180866220091}-{'f1_val': 0.9970695586110643, 'auprc': 0.9980147262419518, 'loss_val': 0.02678236399187957, 'psi': 0.9974476256634193}
[S6] START round=36 head_norm_before_train=1.607664 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6222539646363217, 'auprc': 0.9461073167352103, 'loss_val': 0.6728567263384596, 'psi': 0.7517953054758771}-{'f1_val': 0.8763391061067, 'auprc': 0.9713685928099669, 'loss_val': 0.2867850847788839, 'psi': 0.9143509007880067}
[S7] START round=36 head_norm_before_train=1.838980 (no previous merge yet)
[S7] round=36 local utility u=0.258449 metrics={'f1_val': 0.6805629415618452, 'auprc': 0.8161402780984461, 'loss_val': 0.3554901359504901, 'psi': 0.7347938761764856}-{'f1_val': 0.627049253470749, 'auprc': 0.8014216712053586, 'loss_val': 0.50715016251666, 'psi': 0.6967982205645928}
[S8] START round=36 head_norm_before_train=1.397675 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9894339852550165, 'auprc': 0.9992421762680451, 'loss_val': 0.09701488835656959, 'psi': 0.993357261660228}-{'f1_val': 0.9889384063943332, 'auprc': 0.9990878468832117, 'loss_val': 0.054479971721859394, 'psi': 0.9929981825898846}
[S9] START round=36 head_norm_before_train=1.698339 cos_to_last_merge=0.9981 (last merge round=34)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9950216149016509, 'loss_val': 0.0662288539578453, 'psi': 0.992358189776948}-{'f1_val': 0.9971029125121428, 'auprc': 0.9933040133416353, 'loss_val': 0.0869144380624783, 'psi': 0.9955833528439398}
[S10] START round=36 head_norm_before_train=1.913315 cos_to_last_merge=0.9997 (last merge round=34)
[S10] round=36 local utility u=0.009873 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9986294397851811, 'loss_val': 0.058028046304851005, 'psi': 0.9964326878331182}-{'f1_val': 0.9949681865317428, 'auprc': 0.9974986951666758, 'loss_val': 0.0743814684476618, 'psi': 0.995980389985716}
[S11] START round=36 head_norm_before_train=1.630051 cos_to_last_merge=0.9993 (last merge round=33)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9950844037124505, 'auprc': 0.9984036020711536, 'loss_val': 0.047455025911075324, 'psi': 0.9964120830559318}-{'f1_val': 0.9958716985726862, 'auprc': 0.9980100780989306, 'loss_val': 0.0495339373245617, 'psi': 0.996727050383184}
[S13] START round=36 head_norm_before_train=1.795091 (no previous merge yet)
[S13] round=36 local utility u=0.008214 metrics={'f1_val': 0.5668041400713549, 'auprc': 0.6854309712036788, 'loss_val': 0.8074575127812043, 'psi': 0.6142548725242845}-{'f1_val': 0.5579326282238269, 'auprc': 0.6820647038162151, 'loss_val': 0.7605570041830622, 'psi': 0.6075854584607823}
[S14] START round=36 head_norm_before_train=1.923843 cos_to_last_merge=0.9979 (last merge round=31)
[S14] round=36 local utility u=0.001654 metrics={'f1_val': 0.9970407855713329, 'auprc': 0.9986667154120071, 'loss_val': 0.054030616401278965, 'psi': 0.9976911575076026}-{'f1_val': 0.9959272586020071, 'auprc': 0.9962281138364635, 'loss_val': 0.04334221352282626, 'psi': 0.9960476006957897}
[S15] START round=36 head_norm_before_train=1.966488 (no previous merge yet)
[S15] round=36 local utility u=0.015968 metrics={'f1_val': 0.9959848157269323, 'auprc': 0.9920904028850791, 'loss_val': 0.033421799550488115, 'psi': 0.994427050590191}-{'f1_val': 0.993291639802511, 'auprc': 0.9910773125071496, 'loss_val': 0.046159072688117045, 'psi': 0.9924059088843664}
[S16] START round=36 head_norm_before_train=2.016186 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9246809349433368, 'auprc': 0.9902774340237334, 'loss_val': 0.3979516586057875, 'psi': 0.9509195345754955}-{'f1_val': 0.9782612474091866, 'auprc': 0.9901586836411418, 'loss_val': 0.09559700690061623, 'psi': 0.9830202219019687}
[S17] START round=36 head_norm_before_train=1.490585 cos_to_last_merge=0.9994 (last merge round=34)
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.5371157176949298, 'auprc': 0.7122853979865317, 'loss_val': 0.9049432143691384, 'psi': 0.6071835898115705}-{'f1_val': 0.5444180974767017, 'auprc': 0.7159973006666078, 'loss_val': 0.8315393217181072, 'psi': 0.6130497787526641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:42002
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9994
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:42017
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=-0.0235
[S15] DROPPED delta from S14 (cos=-0.0235 < 0.0)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:42014
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:42004
[S3] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S3
[S17] cosine check vs S3: cos=0.6648
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.9945
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S13
[S2] cosine check vs S13: cos=-0.0892
[S2] DROPPED delta from S13 (cos=-0.0892 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=0.9940
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:42014
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0235
[S14] DROPPED delta from S15 (cos=-0.0235 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9393 head_norm=1.844156
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.134259e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9393 head_norm=1.888465 delta_norm=0.113426
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9970 head_norm=1.940235
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.096488e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9970 head_norm=1.890290 delta_norm=0.109649
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9247 head_norm=2.031978
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.736866e-02
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9245 head_norm=2.022498 delta_norm=0.037369
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.5371 head_norm=1.519188
[S17] _apply_head_vector_avg (torch): Δ‖w‖=7.159196e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.5428 head_norm=1.553819 delta_norm=0.715920
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.675809 cos_to_last_merge=0.7884 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=37 local utility u=0.030762 metrics={'f1_val': 0.8180587472532909, 'auprc': 0.873148698138917, 'loss_val': 0.3402427222319607, 'psi': 0.8400947276075413}-{'f1_val': 0.8326070425486574, 'auprc': 0.8145507493893841, 'loss_val': 0.31326239580035364, 'psi': 0.8253845252849481}
[S3] START round=37 head_norm_before_train=1.883045 cos_to_last_merge=0.9938 (last merge round=34)
[S3] round=37 local utility u=0.151941 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9983250663909404, 'loss_val': 0.04632160562227131, 'psi': 0.9976334445007937}-{'f1_val': 0.9608203197691346, 'auprc': 0.9978958670854028, 'loss_val': 0.13080413907604557, 'psi': 0.9756505386956418}
[S4] START round=37 head_norm_before_train=1.888465 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.017820 metrics={'f1_val': 0.9410192095055083, 'auprc': 0.9555196188403945, 'loss_val': 0.29898146554874994, 'psi': 0.9468193732394627}-{'f1_val': 0.9393465543322861, 'auprc': 0.9485646965120306, 'loss_val': 0.3037217133008065, 'psi': 0.9430338112041838}
[S5] START round=37 head_norm_before_train=2.013668 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9979706532840316, 'loss_val': 0.025086573654658592, 'psi': 0.9974299964802512}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992972887712392, 'loss_val': 0.025883705811063206, 'psi': 0.998180866220091}
[S6] START round=37 head_norm_before_train=1.622728 cos_to_last_merge=0.9999 (last merge round=35)
[S6] round=37 local utility u=0.972016 metrics={'f1_val': 0.8704541580222597, 'auprc': 0.9695598424136451, 'loss_val': 0.2883838869281851, 'psi': 0.9100964317788138}-{'f1_val': 0.6222539646363217, 'auprc': 0.9461073167352103, 'loss_val': 0.6728567263384596, 'psi': 0.7517953054758771}
[S7] START round=37 head_norm_before_train=1.845515 (no previous merge yet)
[S7] round=37 local utility u=1.000000 metrics={'f1_val': 0.9762884553285082, 'auprc': 0.9834975724309316, 'loss_val': 0.1351352234438526, 'psi': 0.9791721021694776}-{'f1_val': 0.6805629415618452, 'auprc': 0.8161402780984461, 'loss_val': 0.3554901359504901, 'psi': 0.7347938761764856}
[S8] START round=37 head_norm_before_train=1.423807 cos_to_last_merge=0.9999 (last merge round=35)
[S8] round=37 local utility u=0.017752 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9990681174022799, 'loss_val': 0.07525108699023926, 'psi': 0.9947138276586178}-{'f1_val': 0.9894339852550165, 'auprc': 0.9992421762680451, 'loss_val': 0.09701488835656959, 'psi': 0.993357261660228}
[S9] START round=37 head_norm_before_train=1.757191 cos_to_last_merge=0.9933 (last merge round=34)
[S9] round=37 local utility u=0.029382 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9934666407721493, 'loss_val': 0.04192267941280841, 'psi': 0.9956484038161454}-{'f1_val': 0.990582573027146, 'auprc': 0.9950216149016509, 'loss_val': 0.0662288539578453, 'psi': 0.992358189776948}
[S10] START round=37 head_norm_before_train=1.938406 cos_to_last_merge=0.9990 (last merge round=34)
[S10] round=37 local utility u=0.001139 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9980156160554898, 'loss_val': 0.05390915419741235, 'psi': 0.9961871583412416}-{'f1_val': 0.9949681865317428, 'auprc': 0.9986294397851811, 'loss_val': 0.058028046304851005, 'psi': 0.9964326878331182}
[S11] START round=37 head_norm_before_train=1.647801 cos_to_last_merge=0.9987 (last merge round=33)
[S11] round=37 local utility u=0.008080 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9983747889536954, 'loss_val': 0.03986333521944941, 'psi': 0.9972660344788573}-{'f1_val': 0.9950844037124505, 'auprc': 0.9984036020711536, 'loss_val': 0.047455025911075324, 'psi': 0.9964120830559318}
[S13] START round=37 head_norm_before_train=1.802761 (no previous merge yet)
[S13] round=37 local utility u=0.121607 metrics={'f1_val': 0.5856110762773965, 'auprc': 0.6827633127346102, 'loss_val': 0.6690822450496277, 'psi': 0.6244719708602819}-{'f1_val': 0.5668041400713549, 'auprc': 0.6854309712036788, 'loss_val': 0.8074575127812043, 'psi': 0.6142548725242845}
[S14] START round=37 head_norm_before_train=1.890290 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.006142 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9986677325351762, 'loss_val': 0.04162591617259587, 'psi': 0.9976792666877958}-{'f1_val': 0.9970407855713329, 'auprc': 0.9986667154120071, 'loss_val': 0.054030616401278965, 'psi': 0.9976911575076026}
[S15] START round=37 head_norm_before_train=1.983623 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8866621551137734, 'auprc': 0.9898073749840296, 'loss_val': 0.14488318619860546, 'psi': 0.9279202430618759}-{'f1_val': 0.9959848157269323, 'auprc': 0.9920904028850791, 'loss_val': 0.033421799550488115, 'psi': 0.994427050590191}
[S16] START round=37 head_norm_before_train=2.022498 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8692662030159403, 'auprc': 0.9898929235043274, 'loss_val': 0.6951448433524415, 'psi': 0.9175168912112951}-{'f1_val': 0.9246809349433368, 'auprc': 0.9902774340237334, 'loss_val': 0.3979516586057875, 'psi': 0.9509195345754955}
[S17] START round=37 head_norm_before_train=1.553819 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.197535 metrics={'f1_val': 0.5539942500482167, 'auprc': 0.7685076581687056, 'loss_val': 0.7798118140546256, 'psi': 0.6397996132964122}-{'f1_val': 0.5371157176949298, 'auprc': 0.7122853979865317, 'loss_val': 0.9049432143691384, 'psi': 0.6071835898115705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:42014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:42015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:42012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:42017
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:42002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S6@127.0.0.1:42007
[S10] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=-0.0877
[S13] DROPPED delta from S2 (cos=-0.0877 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1805) from S9
[S3] cosine check vs S9: cos=0.8797
[S6] RECEIVED delta(kind=head bytes=1805) from S11
[S6] cosine check vs S11: cos=0.9968
[S17] RECEIVED delta(kind=head bytes=1807) from S8
[S17] cosine check vs S8: cos=0.8339
[S17] RECEIVED delta(kind=head bytes=1797) from S3
[S17] cosine check vs S3: cos=0.9290
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.9977
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=-0.0216
[S15] DROPPED delta from S14 (cos=-0.0216 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S7
[S14] cosine check vs S7: cos=0.9981
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=-0.0877
[S2] DROPPED delta from S13 (cos=-0.0877 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1803) from S4
[S13] cosine check vs S4: cos=0.9928
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:42009
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.8339
[S6] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9968
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9918 head_norm=1.462080
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.417716e-01
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9918 head_norm=1.456059 delta_norm=0.441772
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.9972 head_norm=1.919689
[S3] _apply_head_vector_avg (torch): Δ‖w‖=4.602970e-01
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.9976 head_norm=1.806518 delta_norm=0.460297
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=37 metric=0.9410 head_norm=1.902077
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.153453e-02
[S4] stored merged vector for next round verification (round=37)
[S4] DEBUG after merge:  round=37 metric=0.9410 head_norm=1.931042 delta_norm=0.071535
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9965 head_norm=1.667217
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.848450e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9965 head_norm=1.649520 delta_norm=0.068485
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5856 head_norm=1.810822
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.200610e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5980 head_norm=1.853125 delta_norm=0.120061
[S13] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9970 head_norm=1.902099
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.295498e-02
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9970 head_norm=1.875531 delta_norm=0.062955
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.5540 head_norm=1.578879
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.291770e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.5603 head_norm=1.556567 delta_norm=0.229177
[S17] aggregate: ACCEPT kept=['S8', 'S3'] (k=2/2) mode=median trim_p=0.1
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S16
[S11]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S3
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S16
[S15]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S17
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8705 head_norm=1.634503
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.848450e-02
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8701 head_norm=1.649520 delta_norm=0.068485
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.686895 cos_to_last_merge=0.7870 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=38 local utility u=0.064071 metrics={'f1_val': 0.8306279582458639, 'auprc': 0.8983395360157791, 'loss_val': 0.3630880282814825, 'psi': 0.85771258935383}-{'f1_val': 0.8180587472532909, 'auprc': 0.873148698138917, 'loss_val': 0.3402427222319607, 'psi': 0.8400947276075413}
[S3] START round=38 head_norm_before_train=1.806518 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.007657 metrics={'f1_val': 0.9971723632406959, 'auprc': 0.9988628238244207, 'loss_val': 0.03262169196731291, 'psi': 0.9978485474741858}-{'f1_val': 0.9971723632406959, 'auprc': 0.9983250663909404, 'loss_val': 0.04632160562227131, 'psi': 0.9976334445007937}
[S4] START round=38 head_norm_before_train=1.931042 cos_to_last_merge=1.0000 (last merge round=37)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9378806559863401, 'auprc': 0.9496050404525787, 'loss_val': 0.37397532985618065, 'psi': 0.9425704097728356}-{'f1_val': 0.9410192095055083, 'auprc': 0.9555196188403945, 'loss_val': 0.29898146554874994, 'psi': 0.9468193732394627}
[S5] START round=38 head_norm_before_train=2.023826 cos_to_last_merge=0.9999 (last merge round=35)
[S5] round=38 local utility u=0.003321 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9993220112018996, 'loss_val': 0.024700983427076422, 'psi': 0.9981907551923551}-{'f1_val': 0.9970695586110643, 'auprc': 0.9979706532840316, 'loss_val': 0.025086573654658592, 'psi': 0.9974299964802512}
[S6] START round=38 head_norm_before_train=1.649520 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.065621 metrics={'f1_val': 0.8771878327124671, 'auprc': 0.9774931015059423, 'loss_val': 0.22134284549428146, 'psi': 0.9173099402298572}-{'f1_val': 0.8704541580222597, 'auprc': 0.9695598424136451, 'loss_val': 0.2883838869281851, 'psi': 0.9100964317788138}
[S7] START round=38 head_norm_before_train=1.850725 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6619307104274423, 'auprc': 0.8052522235786749, 'loss_val': 0.4427221001521342, 'psi': 0.7192593156879354}-{'f1_val': 0.9762884553285082, 'auprc': 0.9834975724309316, 'loss_val': 0.1351352234438526, 'psi': 0.9791721021694776}
[S8] START round=38 head_norm_before_train=1.456059 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9989659541312539, 'loss_val': 0.11644138859551408, 'psi': 0.9927346523519931}-{'f1_val': 0.9918109678295097, 'auprc': 0.9990681174022799, 'loss_val': 0.07525108699023926, 'psi': 0.9947138276586178}
[S9] START round=38 head_norm_before_train=1.807085 cos_to_last_merge=0.9881 (last merge round=34)
[S9] round=38 local utility u=0.000637 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9971173495609021, 'loss_val': 0.0389506130865043, 'psi': 0.9958435922821938}-{'f1_val': 0.9971029125121428, 'auprc': 0.9934666407721493, 'loss_val': 0.04192267941280841, 'psi': 0.9956484038161454}
[S10] START round=38 head_norm_before_train=1.962188 cos_to_last_merge=0.9980 (last merge round=34)
[S10] round=38 local utility u=0.006666 metrics={'f1_val': 0.9949436619942489, 'auprc': 0.9985321110953356, 'loss_val': 0.04198015247736171, 'psi': 0.9963790416346836}-{'f1_val': 0.9949681865317428, 'auprc': 0.9980156160554898, 'loss_val': 0.05390915419741235, 'psi': 0.9961871583412416}
[S11] START round=38 head_norm_before_train=1.649520 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9983561931602013, 'loss_val': 0.04140424363100678, 'psi': 0.9972585961614597}-{'f1_val': 0.9965268648289654, 'auprc': 0.9983747889536954, 'loss_val': 0.03986333521944941, 'psi': 0.9972660344788573}
[S13] START round=38 head_norm_before_train=1.853125 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5543881922437514, 'auprc': 0.7003281924496465, 'loss_val': 1.2136380071028148, 'psi': 0.6127641923261093}-{'f1_val': 0.5856110762773965, 'auprc': 0.6827633127346102, 'loss_val': 0.6690822450496277, 'psi': 0.6244719708602819}
[S14] START round=38 head_norm_before_train=1.875531 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9961701069502772, 'auprc': 0.9952935365396074, 'loss_val': 0.04801566689632847, 'psi': 0.9958194787860093}-{'f1_val': 0.9970202894562089, 'auprc': 0.9986677325351762, 'loss_val': 0.04162591617259587, 'psi': 0.9976792666877958}
[S15] START round=38 head_norm_before_train=2.000325 (no previous merge yet)
[S15] round=38 local utility u=0.240340 metrics={'f1_val': 0.9561432167217938, 'auprc': 0.9896553536792119, 'loss_val': 0.0806325708849747, 'psi': 0.969548071504761}-{'f1_val': 0.8866621551137734, 'auprc': 0.9898073749840296, 'loss_val': 0.14488318619860546, 'psi': 0.9279202430618759}
[S16] START round=38 head_norm_before_train=2.038121 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=38 local utility u=0.679135 metrics={'f1_val': 0.9899233924742044, 'auprc': 0.9889148645713336, 'loss_val': 0.05788339901470207, 'psi': 0.9895199813130561}-{'f1_val': 0.8692662030159403, 'auprc': 0.9898929235043274, 'loss_val': 0.6951448433524415, 'psi': 0.9175168912112951}
[S17] START round=38 head_norm_before_train=1.556567 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.154578 metrics={'f1_val': 0.5691509450607262, 'auprc': 0.8472843584352377, 'loss_val': 0.7979265563270247, 'psi': 0.6804043104105308}-{'f1_val': 0.5539942500482167, 'auprc': 0.7685076581687056, 'loss_val': 0.7798118140546256, 'psi': 0.6397996132964122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:42003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:42012
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:42004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:42016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:42013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:42005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:42014
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1804 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1802) from S2
[S13] cosine check vs S2: cos=-0.0895
[S13] DROPPED delta from S2 (cos=-0.0895 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9992
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.9992
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0211
[S14] DROPPED delta from S15 (cos=-0.0211 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1803) from S9
[S3] cosine check vs S9: cos=0.9639
[S4] RECEIVED delta(kind=head bytes=1793) from S10
[S4] cosine check vs S10: cos=0.9990
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:42017
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9974 head_norm=2.037627
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.239342e-02
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.9974 head_norm=2.044006 delta_norm=0.042393
[S5] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9899 head_norm=2.051241
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.239341e-02
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9898 head_norm=2.044006 delta_norm=0.042393
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=38 metric=0.9965 head_norm=1.667826
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.546771e-02
[S11] stored merged vector for next round verification (round=38)
[S11] DEBUG after merge:  round=38 metric=0.9965 head_norm=1.662638 delta_norm=0.015468
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=38 metric=0.9379 head_norm=1.942139
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.867160e-02
[S4] stored merged vector for next round verification (round=38)
[S4] DEBUG after merge:  round=38 metric=0.9379 head_norm=1.962132 delta_norm=0.048672
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1798) from S3
[S17] cosine check vs S3: cos=0.9681
[S17] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:42009
[S3] CommDone barrier timeout: have=1 need=2 — continuing
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9972 head_norm=1.839538
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.473912e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9972 head_norm=1.824113 delta_norm=0.247391
[S3] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9739
[S11]  timeout peer S6
[S11]  timeout peer S15
[S4]  timeout peer S13
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S16
[S13]  timeout peer S2
[S13]  timeout peer S11
[S9]  timeout peer S3
[S16]  timeout peer S5
[S3]  timeout peer S10
[S3]  timeout peer S17
[S14]  timeout peer S7
[S10]  timeout peer S4
[S15]  timeout peer S14
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.5692 head_norm=1.584128
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.506350e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.5700 head_norm=1.698194 delta_norm=0.250635
[S17] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.699102 cos_to_last_merge=0.7856 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=39 local utility u=0.013591 metrics={'f1_val': 0.8316742899942011, 'auprc': 0.9012657152196524, 'loss_val': 0.35096162188722624, 'psi': 0.8595108600843816}-{'f1_val': 0.8306279582458639, 'auprc': 0.8983395360157791, 'loss_val': 0.3630880282814825, 'psi': 0.85771258935383}
[S3] START round=39 head_norm_before_train=1.824113 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9976571676663379, 'loss_val': 0.134203648771739, 'psi': 0.975555058928016}-{'f1_val': 0.9971723632406959, 'auprc': 0.9988628238244207, 'loss_val': 0.03262169196731291, 'psi': 0.9978485474741858}
[S4] START round=39 head_norm_before_train=1.962132 cos_to_last_merge=1.0000 (last merge round=38)
[S4] round=39 local utility u=0.025726 metrics={'f1_val': 0.93956049310445, 'auprc': 0.9519945141243248, 'loss_val': 0.3397713137299076, 'psi': 0.9445341015123998}-{'f1_val': 0.9378806559863401, 'auprc': 0.9496050404525787, 'loss_val': 0.37397532985618065, 'psi': 0.9425704097728356}
[S5] START round=39 head_norm_before_train=2.044006 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9990413839172315, 'loss_val': 0.02286134051712199, 'psi': 0.9978582887335312}-{'f1_val': 0.9974365845193254, 'auprc': 0.9993220112018996, 'loss_val': 0.024700983427076422, 'psi': 0.9981907551923551}
[S6] START round=39 head_norm_before_train=1.657578 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6152893031789683, 'auprc': 0.9536924356333707, 'loss_val': 0.7968866336905203, 'psi': 0.7506505561607293}-{'f1_val': 0.8771878327124671, 'auprc': 0.9774931015059423, 'loss_val': 0.22134284549428146, 'psi': 0.9173099402298572}
[S7] START round=39 head_norm_before_train=1.852953 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.6080763918420335, 'auprc': 0.7930713051510825, 'loss_val': 0.592199386632859, 'psi': 0.6820743571656531}-{'f1_val': 0.6619307104274423, 'auprc': 0.8052522235786749, 'loss_val': 0.4427221001521342, 'psi': 0.7192593156879354}
[S8] START round=39 head_norm_before_train=1.499392 cos_to_last_merge=0.9992 (last merge round=37)
[S8] round=39 local utility u=0.022451 metrics={'f1_val': 0.9936253371144965, 'auprc': 0.9904502667325766, 'loss_val': 0.07626204403332132, 'psi': 0.9923553089617285}-{'f1_val': 0.9885804511658192, 'auprc': 0.9989659541312539, 'loss_val': 0.11644138859551408, 'psi': 0.9927346523519931}
[S9] START round=39 head_norm_before_train=1.842087 cos_to_last_merge=0.9843 (last merge round=34)
[S9] round=39 local utility u=0.003594 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9966735671275679, 'loss_val': 0.03295888009107454, 'psi': 0.9959189263729986}-{'f1_val': 0.994994420763055, 'auprc': 0.9971173495609021, 'loss_val': 0.0389506130865043, 'psi': 0.9958435922821938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S9] sending update (kind=head size=1810 to 1 peers)
[S9] r=40 psi=0.996 u=0.0036 p_local=0.0079 f1=0.995 auprc=0.997 bytes=30631
[S10] START round=39 head_norm_before_train=1.983118 cos_to_last_merge=0.9970 (last merge round=34)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9945413663322713, 'loss_val': 0.04618729759148224, 'psi': 0.9947974584519542}-{'f1_val': 0.9949436619942489, 'auprc': 0.9985321110953356, 'loss_val': 0.04198015247736171, 'psi': 0.9963790416346836}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0066 f1=0.995 auprc=0.995 bytes=35962
[S11] START round=39 head_norm_before_train=1.662638 cos_to_last_merge=1.0000 (last merge round=38)
[S11] round=39 local utility u=0.000504 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998342906739604, 'loss_val': 0.040501611046505306, 'psi': 0.9972677156929}-{'f1_val': 0.9965268648289654, 'auprc': 0.9983561931602013, 'loss_val': 0.04140424363100678, 'psi': 0.9972585961614597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S11] r=40 psi=0.997 u=0.0005 p_local=0.0182 f1=0.997 auprc=0.998 bytes=37784
[S13] START round=39 head_norm_before_train=1.861208 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=39 local utility u=0.179623 metrics={'f1_val': 0.5848162631561362, 'auprc': 0.6278480760236118, 'loss_val': 0.8195209801219399, 'psi': 0.6020289883031265}-{'f1_val': 0.5543881922437514, 'auprc': 0.7003281924496465, 'loss_val': 1.2136380071028148, 'psi': 0.6127641923261093}
[S14] START round=39 head_norm_before_train=1.890310 cos_to_last_merge=0.9999 (last merge round=37)
[S14] round=39 local utility u=0.011196 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9990472320214879, 'loss_val': 0.044313157353263355, 'psi': 0.9980638545096305}-{'f1_val': 0.9961701069502772, 'auprc': 0.9952935365396074, 'loss_val': 0.04801566689632847, 'psi': 0.9958194787860093}
[S15] START round=39 head_norm_before_train=2.012072 (no previous merge yet)
[S15] round=39 local utility u=0.150332 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9931409200690093, 'loss_val': 0.031819630636741605, 'psi': 0.9950816762137975}-{'f1_val': 0.9561432167217938, 'auprc': 0.9896553536792119, 'loss_val': 0.0806325708849747, 'psi': 0.969548071504761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] r=40 psi=0.995 u=0.1503 p_local=0.2360 f1=0.996 auprc=0.993 bytes=34178
[S16] START round=39 head_norm_before_train=2.044006 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.003059 metrics={'f1_val': 0.9900496873602671, 'auprc': 0.989990106549899, 'loss_val': 0.055747976062061645, 'psi': 0.9900258550361198}-{'f1_val': 0.9899233924742044, 'auprc': 0.9889148645713336, 'loss_val': 0.05788339901470207, 'psi': 0.9895199813130561}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=40 psi=0.990 u=0.0031 p_local=0.1686 f1=0.990 auprc=0.990 bytes=30601
[S17] START round=39 head_norm_before_train=1.698194 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5281832085787266, 'auprc': 0.7313373943485777, 'loss_val': 0.9104405370798533, 'psi': 0.609444882886667}-{'f1_val': 0.5691509450607262, 'auprc': 0.8472843584352377, 'loss_val': 0.7979265563270247, 'psi': 0.6804043104105308}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:42011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:42013
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:42015
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:42017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:42004
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.682 u=0.0000 p_local=0.1973 f1=0.608 auprc=0.793 bytes=32405
[S6] r=40 psi=0.751 u=0.0000 p_local=0.2370 f1=0.615 auprc=0.954 bytes=34169
[S2] sending update (kind=head size=1801 to 1 peers)
[S17] r=40 psi=0.609 u=0.0000 p_local=0.0951 f1=0.528 auprc=0.731 bytes=34164
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0636 f1=0.961 auprc=0.998 bytes=30584
[S5] r=40 psi=0.998 u=0.0000 p_local=0.0219 f1=0.997 auprc=0.999 bytes=32402
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=-0.0211
[S15] DROPPED delta from S14 (cos=-0.0211 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S4
[S10] cosine check vs S4: cos=0.9995
[S13] RECEIVED delta(kind=head bytes=1801) from S2
[S13] cosine check vs S2: cos=-0.0884
[S13] DROPPED delta from S2 (cos=-0.0884 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S13
[S4] cosine check vs S13: cos=0.9929
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9367
[S14] r=40 psi=0.998 u=0.0112 p_local=0.0072 f1=0.997 auprc=0.999 bytes=34187
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9936 head_norm=1.548686
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.020110e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9936 head_norm=1.553427 delta_norm=0.202011
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.992 u=0.0225 p_local=0.0346 f1=0.994 auprc=0.990 bytes=28788
[S2] r=40 psi=0.860 u=0.0136 p_local=0.0814 f1=0.832 auprc=0.901 bytes=30574
[S13] r=40 psi=0.602 u=0.1796 p_local=0.0811 f1=0.585 auprc=0.628 bytes=30580
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=39 metric=0.9396 head_norm=1.971320
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.262352e-01
[S4] stored merged vector for next round verification (round=39)
[S4] DEBUG after merge:  round=39 metric=0.9396 head_norm=1.914675 delta_norm=0.126235
[S4] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S4] r=40 psi=0.945 u=0.0257 p_local=0.0246 f1=0.940 auprc=0.952 bytes=32371
[S2] START round=40 head_norm_before_train=1.712008 cos_to_last_merge=0.7841 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.8265390224867065, 'auprc': 0.8995803979916712, 'loss_val': 0.3741444589073561, 'psi': 0.8557555726886924}-{'f1_val': 0.8316742899942011, 'auprc': 0.9012657152196524, 'loss_val': 0.35096162188722624, 'psi': 0.8595108600843816}
[S3] START round=40 head_norm_before_train=1.847540 cos_to_last_merge=0.9999 (last merge round=38)
[S3] round=40 local utility u=0.006161 metrics={'f1_val': 0.9600790074500462, 'auprc': 0.9969962472960818, 'loss_val': 0.11545172542667481, 'psi': 0.9748459033884604}-{'f1_val': 0.9608203197691346, 'auprc': 0.9976571676663379, 'loss_val': 0.134203648771739, 'psi': 0.975555058928016}
[S4] START round=40 head_norm_before_train=1.914675 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=40 local utility u=0.008458 metrics={'f1_val': 0.9397834203405133, 'auprc': 0.9528859459971373, 'loss_val': 0.3268667559921567, 'psi': 0.9450244306031629}-{'f1_val': 0.93956049310445, 'auprc': 0.9519945141243248, 'loss_val': 0.3397713137299076, 'psi': 0.9445341015123998}
[S5] START round=40 head_norm_before_train=2.054887 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9933628007858665, 'loss_val': 0.024276115569577712, 'psi': 0.9955868554809852}-{'f1_val': 0.9970695586110643, 'auprc': 0.9990413839172315, 'loss_val': 0.02286134051712199, 'psi': 0.9978582887335312}
[S6] START round=40 head_norm_before_train=1.666141 cos_to_last_merge=0.9999 (last merge round=37)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.9855014037117011, 'auprc': 0.982457867226846, 'loss_val': 0.09024581642616286, 'psi': 0.984283989117759}-{'f1_val': 0.6152893031789683, 'auprc': 0.9536924356333707, 'loss_val': 0.7968866336905203, 'psi': 0.7506505561607293}
[S7] START round=40 head_norm_before_train=1.855827 (no previous merge yet)
[S7] round=40 local utility u=0.379319 metrics={'f1_val': 0.679453520443912, 'auprc': 0.8199962066356268, 'loss_val': 0.34259807456738794, 'psi': 0.7356705949205979}-{'f1_val': 0.6080763918420335, 'auprc': 0.7930713051510825, 'loss_val': 0.592199386632859, 'psi': 0.6820743571656531}
[S8] START round=40 head_norm_before_train=1.553427 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9781042520488272, 'auprc': 0.9987007942978645, 'loss_val': 0.12941850837097454, 'psi': 0.9863428689484421}-{'f1_val': 0.9936253371144965, 'auprc': 0.9904502667325766, 'loss_val': 0.07626204403332132, 'psi': 0.9923553089617285}
[S9] START round=40 head_norm_before_train=1.869395 cos_to_last_merge=0.9815 (last merge round=34)
[S9] round=40 local utility u=0.001656 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.995266409114405, 'loss_val': 0.03139199020606499, 'psi': 0.9959526750460945}-{'f1_val': 0.9954158325366191, 'auprc': 0.9966735671275679, 'loss_val': 0.03295888009107454, 'psi': 0.9959189263729986}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=40 head_norm_before_train=2.000822 cos_to_last_merge=0.9962 (last merge round=34)
[S10] round=40 local utility u=0.007879 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.997916822173623, 'loss_val': 0.037920731303680205, 'psi': 0.9958841929484858}-{'f1_val': 0.9949681865317428, 'auprc': 0.9945413663322713, 'loss_val': 0.04618729759148224, 'psi': 0.9947974584519542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=40 metric=0.9945 head_norm=2.017170
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.745482e-02
[S10] stored merged vector for next round verification (round=40)
[S10] DEBUG after merge:  round=40 metric=0.9945 head_norm=1.993812 delta_norm=0.047455
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] START round=40 head_norm_before_train=1.680797 cos_to_last_merge=0.9999 (last merge round=38)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9337309037699937, 'auprc': 0.9981853787350793, 'loss_val': 0.20468086871331465, 'psi': 0.9595126937560279}-{'f1_val': 0.9965509216617638, 'auprc': 0.998342906739604, 'loss_val': 0.040501611046505306, 'psi': 0.9972677156929}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.864867 cos_to_last_merge=0.9999 (last merge round=37)
[S13] round=40 local utility u=0.080450 metrics={'f1_val': 0.5909474107312321, 'auprc': 0.6289531880966881, 'loss_val': 0.698723595696703, 'psi': 0.6061497216774145}-{'f1_val': 0.5848162631561362, 'auprc': 0.6278480760236118, 'loss_val': 0.8195209801219399, 'psi': 0.6020289883031265}
[S14] START round=40 head_norm_before_train=1.906273 cos_to_last_merge=0.9998 (last merge round=37)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9954468032922007, 'loss_val': 0.039269030672650286, 'psi': 0.9968704320972113}-{'f1_val': 0.9974082695017256, 'auprc': 0.9990472320214879, 'loss_val': 0.044313157353263355, 'psi': 0.9980638545096305}
[S15] START round=40 head_norm_before_train=2.023903 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7883261035272529, 'auprc': 0.9896783571735273, 'loss_val': 0.30339485266879573, 'psi': 0.8688670049857626}-{'f1_val': 0.9963755136436562, 'auprc': 0.9931409200690093, 'loss_val': 0.031819630636741605, 'psi': 0.9950816762137975}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=2.056011 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.8258599855979152, 'auprc': 0.8549615362215338, 'loss_val': 1.172525724781449, 'psi': 0.8375006058473626}-{'f1_val': 0.9900496873602671, 'auprc': 0.989990106549899, 'loss_val': 0.055747976062061645, 'psi': 0.9900258550361198}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.727797 cos_to_last_merge=0.9993 (last merge round=38)
[S17] round=40 local utility u=0.098606 metrics={'f1_val': 0.5537972957337168, 'auprc': 0.7515505996985479, 'loss_val': 0.9275522828811702, 'psi': 0.6328986173196492}-{'f1_val': 0.5281832085787266, 'auprc': 0.7313373943485777, 'loss_val': 0.9104405370798533, 'psi': 0.609444882886667}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.945)
[S13] not sending this round → trigger blocked (psi=0.606)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.5538 head_norm=1.758128
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.075076e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.5557 head_norm=1.627931 delta_norm=0.307508
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=41 head_norm_before_train=1.721889 cos_to_last_merge=0.7830 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.7110000787900597, 'auprc': 0.8680536733982172, 'loss_val': 0.7249650349190074, 'psi': 0.7738215166333227}-{'f1_val': 0.8265390224867065, 'auprc': 0.8995803979916712, 'loss_val': 0.3741444589073561, 'psi': 0.8557555726886924}
[S3] START round=41 head_norm_before_train=1.863517 cos_to_last_merge=0.9997 (last merge round=38)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9395882407730874, 'auprc': 0.9884309284573541, 'loss_val': 0.16384099972326485, 'psi': 0.9591253158467942}-{'f1_val': 0.9600790074500462, 'auprc': 0.9969962472960818, 'loss_val': 0.11545172542667481, 'psi': 0.9748459033884604}
[S4] START round=41 head_norm_before_train=1.923878 cos_to_last_merge=1.0000 (last merge round=39)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9391846069439056, 'auprc': 0.9503012770921168, 'loss_val': 0.3442815877009392, 'psi': 0.9436312750031901}-{'f1_val': 0.9397834203405133, 'auprc': 0.9528859459971373, 'loss_val': 0.3268667559921567, 'psi': 0.9450244306031629}
[S5] START round=41 head_norm_before_train=2.065938 cos_to_last_merge=0.9999 (last merge round=38)
[S5] round=41 local utility u=0.008184 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9982758730891317, 'loss_val': 0.024849384284908464, 'psi': 0.9977722999472479}-{'f1_val': 0.9970695586110643, 'auprc': 0.9933628007858665, 'loss_val': 0.024276115569577712, 'psi': 0.9955868554809852}
[S6] START round=41 head_norm_before_train=1.674437 cos_to_last_merge=0.9998 (last merge round=37)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8659021642359346, 'auprc': 0.9748953073911141, 'loss_val': 0.27263180074408827, 'psi': 0.9094994214980063}-{'f1_val': 0.9855014037117011, 'auprc': 0.982457867226846, 'loss_val': 0.09024581642616286, 'psi': 0.984283989117759}
[S7] START round=41 head_norm_before_train=1.863955 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5896338602613794, 'auprc': 0.7879106060246963, 'loss_val': 0.8721796024236601, 'psi': 0.6689445585667062}-{'f1_val': 0.679453520443912, 'auprc': 0.8199962066356268, 'loss_val': 0.34259807456738794, 'psi': 0.7356705949205979}
[S8] START round=41 head_norm_before_train=1.599460 cos_to_last_merge=0.9992 (last merge round=39)
[S8] round=41 local utility u=0.078456 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9966620208884344, 'loss_val': 0.06343806194278125, 'psi': 0.9952321127067918}-{'f1_val': 0.9781042520488272, 'auprc': 0.9987007942978645, 'loss_val': 0.12941850837097454, 'psi': 0.9863428689484421}
[S9] START round=41 head_norm_before_train=1.891743 cos_to_last_merge=0.9792 (last merge round=34)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9934298384428056, 'loss_val': 0.03000614693787922, 'psi': 0.9952180467774547}-{'f1_val': 0.9964101856672208, 'auprc': 0.995266409114405, 'loss_val': 0.03139199020606499, 'psi': 0.9959526750460945}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.993812 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9977384020443205, 'loss_val': 0.039193659311812595, 'psi': 0.9959445263493517}-{'f1_val': 0.9945291067983943, 'auprc': 0.997916822173623, 'loss_val': 0.037920731303680205, 'psi': 0.9958841929484858}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.697762 cos_to_last_merge=0.9997 (last merge round=38)
[S11] round=41 local utility u=0.269807 metrics={'f1_val': 0.9958716985726862, 'auprc': 0.997516493195564, 'loss_val': 0.03590555319959107, 'psi': 0.9965296164218373}-{'f1_val': 0.9337309037699937, 'auprc': 0.9981853787350793, 'loss_val': 0.20468086871331465, 'psi': 0.9595126937560279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=41 head_norm_before_train=1.867337 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.5567897194809075, 'auprc': 0.714668666553296, 'loss_val': 1.1370535775050559, 'psi': 0.6199412983098629}-{'f1_val': 0.5909474107312321, 'auprc': 0.6289531880966881, 'loss_val': 0.698723595696703, 'psi': 0.6061497216774145}
[S14] START round=41 head_norm_before_train=1.925864 cos_to_last_merge=0.9994 (last merge round=37)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965344645149313, 'auprc': 0.9969692225738374, 'loss_val': 0.036691777965951994, 'psi': 0.9967083677384938}-{'f1_val': 0.9978195179672185, 'auprc': 0.9954468032922007, 'loss_val': 0.039269030672650286, 'psi': 0.9968704320972113}
[S15] START round=41 head_norm_before_train=2.036347 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7748414417113076, 'auprc': 0.9879924391236392, 'loss_val': 0.38213294977456, 'psi': 0.8601018406762403}-{'f1_val': 0.7883261035272529, 'auprc': 0.9896783571735273, 'loss_val': 0.30339485266879573, 'psi': 0.8688670049857626}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=2.068152 cos_to_last_merge=0.9999 (last merge round=38)
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.9317929347908287, 'auprc': 0.9730110874714194, 'loss_val': 0.1462081367906653, 'psi': 0.9482801958630649}-{'f1_val': 0.8258599855979152, 'auprc': 0.8549615362215338, 'loss_val': 1.172525724781449, 'psi': 0.8375006058473626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=41 head_norm_before_train=1.627931 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.124921 metrics={'f1_val': 0.5723275847953397, 'auprc': 0.8079295992098302, 'loss_val': 0.9580287117191637, 'psi': 0.6665683905611359}-{'f1_val': 0.5537972957337168, 'auprc': 0.7515505996985479, 'loss_val': 0.9275522828811702, 'psi': 0.6328986173196492}
[S17] not sending this round → trigger blocked (psi=0.667)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=42 head_norm_before_train=1.730588 cos_to_last_merge=0.7817 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=42 local utility u=0.598343 metrics={'f1_val': 0.829876318520022, 'auprc': 0.9026046563077016, 'loss_val': 0.34518947693149865, 'psi': 0.8589676536350939}-{'f1_val': 0.7110000787900597, 'auprc': 0.8680536733982172, 'loss_val': 0.7249650349190074, 'psi': 0.7738215166333227}
[S3] START round=42 head_norm_before_train=1.872193 cos_to_last_merge=0.9996 (last merge round=38)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.8223763558032516, 'auprc': 0.9920805272134686, 'loss_val': 0.5503691141872902, 'psi': 0.8902580243673384}-{'f1_val': 0.9395882407730874, 'auprc': 0.9884309284573541, 'loss_val': 0.16384099972326485, 'psi': 0.9591253158467942}
[S4] START round=42 head_norm_before_train=1.934146 cos_to_last_merge=0.9999 (last merge round=39)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9201447218689213, 'auprc': 0.946622196962389, 'loss_val': 0.4010305295350553, 'psi': 0.9307357119063084}-{'f1_val': 0.9391846069439056, 'auprc': 0.9503012770921168, 'loss_val': 0.3442815877009392, 'psi': 0.9436312750031901}
[S5] START round=42 head_norm_before_train=2.077779 cos_to_last_merge=0.9998 (last merge round=38)
[S5] round=42 local utility u=0.001728 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9991896813653831, 'loss_val': 0.024134890292853595, 'psi': 0.9981378232577485}-{'f1_val': 0.9974365845193254, 'auprc': 0.9982758730891317, 'loss_val': 0.024849384284908464, 'psi': 0.9977722999472479}
[S6] START round=42 head_norm_before_train=1.675945 cos_to_last_merge=0.9996 (last merge round=37)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.752931221246476, 'auprc': 0.9536572943594219, 'loss_val': 0.6259842616824475, 'psi': 0.8332216504916543}-{'f1_val': 0.8659021642359346, 'auprc': 0.9748953073911141, 'loss_val': 0.27263180074408827, 'psi': 0.9094994214980063}
[S7] START round=42 head_norm_before_train=1.871938 (no previous merge yet)
[S7] round=42 local utility u=0.200269 metrics={'f1_val': 0.6176495501713369, 'auprc': 0.7977773469894502, 'loss_val': 0.6693355715389617, 'psi': 0.6897006688985823}-{'f1_val': 0.5896338602613794, 'auprc': 0.7879106060246963, 'loss_val': 0.8721796024236601, 'psi': 0.6689445585667062}
[S8] START round=42 head_norm_before_train=1.643990 cos_to_last_merge=0.9971 (last merge round=39)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.999236488071567, 'loss_val': 0.06339867381986868, 'psi': 0.9932727264466423}-{'f1_val': 0.9942788405856967, 'auprc': 0.9966620208884344, 'loss_val': 0.06343806194278125, 'psi': 0.9952321127067918}
[S9] START round=42 head_norm_before_train=1.909828 cos_to_last_merge=0.9774 (last merge round=34)
[S9] round=42 local utility u=0.002159 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9960441071028336, 'loss_val': 0.02852891822873041, 'psi': 0.9957634781716422}-{'f1_val': 0.9964101856672208, 'auprc': 0.9934298384428056, 'loss_val': 0.03000614693787922, 'psi': 0.9952180467774547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=42 head_norm_before_train=2.009364 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=42 local utility u=0.000836 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9975889039933321, 'loss_val': 0.03707387841163091, 'psi': 0.9958847271289564}-{'f1_val': 0.9947486092193725, 'auprc': 0.9977384020443205, 'loss_val': 0.039193659311812595, 'psi': 0.9959445263493517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=42 head_norm_before_train=1.710860 cos_to_last_merge=0.9995 (last merge round=38)
[S11] round=42 local utility u=0.003023 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9980930326347206, 'loss_val': 0.03304059762732205, 'psi': 0.9969053340125057}-{'f1_val': 0.9958716985726862, 'auprc': 0.997516493195564, 'loss_val': 0.03590555319959107, 'psi': 0.9965296164218373}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=42 head_norm_before_train=1.872656 cos_to_last_merge=0.9998 (last merge round=37)
[S13] round=42 local utility u=0.197334 metrics={'f1_val': 0.5793223474748129, 'auprc': 0.7205920166070594, 'loss_val': 0.8953508333581087, 'psi': 0.6358302151277115}-{'f1_val': 0.5567897194809075, 'auprc': 0.714668666553296, 'loss_val': 1.1370535775050559, 'psi': 0.6199412983098629}
[S14] START round=42 head_norm_before_train=1.940729 cos_to_last_merge=0.9988 (last merge round=37)
[S14] round=42 local utility u=0.001335 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996971886643177, 'loss_val': 0.034346691606497955, 'psi': 0.996741093623721}-{'f1_val': 0.9965344645149313, 'auprc': 0.9969692225738374, 'loss_val': 0.036691777965951994, 'psi': 0.9967083677384938}
[S15] START round=42 head_norm_before_train=2.048141 (no previous merge yet)
[S15] round=42 local utility u=0.847685 metrics={'f1_val': 0.9962053994161175, 'auprc': 0.9925972617901709, 'loss_val': 0.028761953760790607, 'psi': 0.9947621443657388}-{'f1_val': 0.7748414417113076, 'auprc': 0.9879924391236392, 'loss_val': 0.38213294977456, 'psi': 0.8601018406762403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=42 head_norm_before_train=2.077926 cos_to_last_merge=0.9998 (last merge round=38)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8361939747478931, 'auprc': 0.9850628134399543, 'loss_val': 1.0700381381742765, 'psi': 0.8957415102247175}-{'f1_val': 0.9317929347908287, 'auprc': 0.9730110874714194, 'loss_val': 0.1462081367906653, 'psi': 0.9482801958630649}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.657814 cos_to_last_merge=0.9995 (last merge round=40)
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.5587399107766113, 'auprc': 0.7956558765226118, 'loss_val': 1.0282901981728023, 'psi': 0.6535062970750115}-{'f1_val': 0.5723275847953397, 'auprc': 0.8079295992098302, 'loss_val': 0.9580287117191637, 'psi': 0.6665683905611359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.738980 cos_to_last_merge=0.7802 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=43 local utility u=0.119536 metrics={'f1_val': 0.82873893541295, 'auprc': 0.9885088539872877, 'loss_val': 0.3570048135305641, 'psi': 0.8926469028426851}-{'f1_val': 0.829876318520022, 'auprc': 0.9026046563077016, 'loss_val': 0.34518947693149865, 'psi': 0.8589676536350939}
[S3] START round=43 head_norm_before_train=1.882934 cos_to_last_merge=0.9994 (last merge round=38)
[S3] round=43 local utility u=0.381186 metrics={'f1_val': 0.9256544568519622, 'auprc': 0.9374071302956883, 'loss_val': 0.2436454687900693, 'psi': 0.9303555262294527}-{'f1_val': 0.8223763558032516, 'auprc': 0.9920805272134686, 'loss_val': 0.5503691141872902, 'psi': 0.8902580243673384}
[S4] START round=43 head_norm_before_train=1.944930 cos_to_last_merge=0.9998 (last merge round=39)
[S4] round=43 local utility u=0.116751 metrics={'f1_val': 0.9416765802940521, 'auprc': 0.951004392831197, 'loss_val': 0.3098656907495062, 'psi': 0.94540770530891}-{'f1_val': 0.9201447218689213, 'auprc': 0.946622196962389, 'loss_val': 0.4010305295350553, 'psi': 0.9307357119063084}
[S5] START round=43 head_norm_before_train=2.096125 cos_to_last_merge=0.9997 (last merge round=38)
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9975233641753958, 'loss_val': 0.019124350974649172, 'psi': 0.9972510808367969}-{'f1_val': 0.9974365845193254, 'auprc': 0.9991896813653831, 'loss_val': 0.024134890292853595, 'psi': 0.9981378232577485}
[S6] START round=43 head_norm_before_train=1.681789 cos_to_last_merge=0.9994 (last merge round=37)
[S6] round=43 local utility u=0.180764 metrics={'f1_val': 0.7902301273110856, 'auprc': 0.9606041867559555, 'loss_val': 0.5090905176262008, 'psi': 0.8583797510890335}-{'f1_val': 0.752931221246476, 'auprc': 0.9536572943594219, 'loss_val': 0.6259842616824475, 'psi': 0.8332216504916543}
[S7] START round=43 head_norm_before_train=1.882909 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.605335979415949, 'auprc': 0.7957090391406747, 'loss_val': 0.7395216037330657, 'psi': 0.6814852033058393}-{'f1_val': 0.6176495501713369, 'auprc': 0.7977773469894502, 'loss_val': 0.6693355715389617, 'psi': 0.6897006688985823}
[S8] START round=43 head_norm_before_train=1.683007 cos_to_last_merge=0.9949 (last merge round=39)
[S8] round=43 local utility u=0.008503 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9904030972090709, 'loss_val': 0.05091399695830184, 'psi': 0.9928415600650655}-{'f1_val': 0.9892968853633592, 'auprc': 0.999236488071567, 'loss_val': 0.06339867381986868, 'psi': 0.9932727264466423}
[S9] START round=43 head_norm_before_train=1.928494 cos_to_last_merge=0.9755 (last merge round=34)
[S9] round=43 local utility u=0.001767 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9961935297671778, 'loss_val': 0.026945595123413314, 'psi': 0.9959734429253824}-{'f1_val': 0.9955763922175147, 'auprc': 0.9960441071028336, 'loss_val': 0.02852891822873041, 'psi': 0.9957634781716422}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=43 head_norm_before_train=2.024550 cos_to_last_merge=0.9998 (last merge round=40)
[S10] round=43 local utility u=0.002353 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982420189287664, 'loss_val': 0.034327931133844566, 'psi': 0.9961459731031301}-{'f1_val': 0.9947486092193725, 'auprc': 0.9975889039933321, 'loss_val': 0.03707387841163091, 'psi': 0.9958847271289564}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=43 head_norm_before_train=1.723416 cos_to_last_merge=0.9993 (last merge round=38)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.9949111790385226, 'auprc': 0.9983779636237413, 'loss_val': 0.0341505194642263, 'psi': 0.9962978928726101}-{'f1_val': 0.9961135349310292, 'auprc': 0.9980930326347206, 'loss_val': 0.03304059762732205, 'psi': 0.9969053340125057}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.877808 cos_to_last_merge=0.9997 (last merge round=37)
[S13] round=43 local utility u=0.188447 metrics={'f1_val': 0.6001139472322122, 'auprc': 0.7190919434931697, 'loss_val': 0.6387053491736243, 'psi': 0.6477051457365952}-{'f1_val': 0.5793223474748129, 'auprc': 0.7205920166070594, 'loss_val': 0.8953508333581087, 'psi': 0.6358302151277115}
[S14] START round=43 head_norm_before_train=1.954340 cos_to_last_merge=0.9982 (last merge round=37)
[S14] round=43 local utility u=0.007288 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990390371501854, 'loss_val': 0.029891305194305495, 'psi': 0.9979598288835501}-{'f1_val': 0.9965872316107504, 'auprc': 0.996971886643177, 'loss_val': 0.034346691606497955, 'psi': 0.996741093623721}
[S15] START round=43 head_norm_before_train=2.059753 (no previous merge yet)
[S15] round=43 local utility u=0.000516 metrics={'f1_val': 0.9957757960160583, 'auprc': 0.9929507477680133, 'loss_val': 0.026211925761660683, 'psi': 0.9946457767168403}-{'f1_val': 0.9962053994161175, 'auprc': 0.9925972617901709, 'loss_val': 0.028761953760790607, 'psi': 0.9947621443657388}
[S15] not sending this round → trigger blocked (psi=0.995)
[S16] START round=43 head_norm_before_train=2.086312 cos_to_last_merge=0.9997 (last merge round=38)
[S16] round=43 local utility u=0.720464 metrics={'f1_val': 0.9398446493031519, 'auprc': 0.9874503915098003, 'loss_val': 0.25817737705895694, 'psi': 0.9588869461858113}-{'f1_val': 0.8361939747478931, 'auprc': 0.9850628134399543, 'loss_val': 1.0700381381742765, 'psi': 0.8957415102247175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.683688 cos_to_last_merge=0.9984 (last merge round=40)
[S17] round=43 local utility u=0.167394 metrics={'f1_val': 0.6012745803263343, 'auprc': 0.7966124930163725, 'loss_val': 0.9515794069728042, 'psi': 0.6794097454023496}-{'f1_val': 0.5587399107766113, 'auprc': 0.7956558765226118, 'loss_val': 1.0282901981728023, 'psi': 0.6535062970750115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S14] not sending this round → trigger blocked (psi=0.998)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.648)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → trigger blocked (psi=0.893)
[S2] START round=44 head_norm_before_train=1.749183 cos_to_last_merge=0.7787 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8304149365145606, 'auprc': 0.9043874992748778, 'loss_val': 0.39253489024191457, 'psi': 0.8600039616186874}-{'f1_val': 0.82873893541295, 'auprc': 0.9885088539872877, 'loss_val': 0.3570048135305641, 'psi': 0.8926469028426851}
[S3] START round=44 head_norm_before_train=1.892856 cos_to_last_merge=0.9992 (last merge round=38)
[S3] round=44 local utility u=0.059319 metrics={'f1_val': 0.916453993465474, 'auprc': 0.9970840302657893, 'loss_val': 0.24883632761174485, 'psi': 0.9487060081856001}-{'f1_val': 0.9256544568519622, 'auprc': 0.9374071302956883, 'loss_val': 0.2436454687900693, 'psi': 0.9303555262294527}
[S4] START round=44 head_norm_before_train=1.954462 cos_to_last_merge=0.9996 (last merge round=39)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9404582531524683, 'auprc': 0.9532317576858392, 'loss_val': 0.3187487214333126, 'psi': 0.9455676549658167}-{'f1_val': 0.9416765802940521, 'auprc': 0.951004392831197, 'loss_val': 0.3098656907495062, 'psi': 0.94540770530891}
[S5] START round=44 head_norm_before_train=2.113142 cos_to_last_merge=0.9994 (last merge round=38)
[S5] round=44 local utility u=0.001061 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9982829785105001, 'loss_val': 0.019281783265807102, 'psi': 0.9975549265708387}-{'f1_val': 0.9970695586110643, 'auprc': 0.9975233641753958, 'loss_val': 0.019124350974649172, 'psi': 0.9972510808367969}
[S6] START round=44 head_norm_before_train=1.692582 cos_to_last_merge=0.9994 (last merge round=37)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6484065244109491, 'auprc': 0.9544579479925547, 'loss_val': 0.7328647710313178, 'psi': 0.7708270938435913}-{'f1_val': 0.7902301273110856, 'auprc': 0.9606041867559555, 'loss_val': 0.5090905176262008, 'psi': 0.8583797510890335}
[S7] START round=44 head_norm_before_train=1.894127 (no previous merge yet)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5994699697740731, 'auprc': 0.7946756518932653, 'loss_val': 0.7907970250354219, 'psi': 0.67755224262175}-{'f1_val': 0.605335979415949, 'auprc': 0.7957090391406747, 'loss_val': 0.7395216037330657, 'psi': 0.6814852033058393}
[S8] START round=44 head_norm_before_train=1.714615 cos_to_last_merge=0.9930 (last merge round=39)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9736904608187118, 'auprc': 0.9959566142092902, 'loss_val': 0.10475268875532565, 'psi': 0.9825969221749431}-{'f1_val': 0.9944672019690619, 'auprc': 0.9904030972090709, 'loss_val': 0.05091399695830184, 'psi': 0.9928415600650655}
[S9] START round=44 head_norm_before_train=1.946611 cos_to_last_merge=0.9738 (last merge round=34)
[S9] round=44 local utility u=0.003653 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962381891303386, 'loss_val': 0.024777257814507604, 'psi': 0.9964915827404703}-{'f1_val': 0.9958267183641853, 'auprc': 0.9961935297671778, 'loss_val': 0.026945595123413314, 'psi': 0.9959734429253824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=44 head_norm_before_train=2.039265 cos_to_last_merge=0.9997 (last merge round=40)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9980257635418112, 'loss_val': 0.033878333401992644, 'psi': 0.9960594709483479}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982420189287664, 'loss_val': 0.034327931133844566, 'psi': 0.9961459731031301}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.735699 cos_to_last_merge=0.9990 (last merge round=38)
[S11] round=44 local utility u=0.005636 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.998263796712111, 'loss_val': 0.030778716403418258, 'psi': 0.9970765357672179}-{'f1_val': 0.9949111790385226, 'auprc': 0.9983779636237413, 'loss_val': 0.0341505194642263, 'psi': 0.9962978928726101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=44 head_norm_before_train=1.879451 cos_to_last_merge=0.9996 (last merge round=37)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5853700559084816, 'auprc': 0.7223180748198124, 'loss_val': 0.9220174868351196, 'psi': 0.6401492634730139}-{'f1_val': 0.6001139472322122, 'auprc': 0.7190919434931697, 'loss_val': 0.6387053491736243, 'psi': 0.6477051457365952}
[S14] START round=44 head_norm_before_train=1.968164 cos_to_last_merge=0.9976 (last merge round=37)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969747293489531, 'loss_val': 0.03217416467979479, 'psi': 0.9971028129416952}-{'f1_val': 0.997240356705793, 'auprc': 0.9990390371501854, 'loss_val': 0.029891305194305495, 'psi': 0.9979598288835501}
[S15] START round=44 head_norm_before_train=2.069976 (no previous merge yet)
[S15] round=44 local utility u=0.009583 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9964016480157984, 'loss_val': 0.023223135516639497, 'psi': 0.9966086602388318}-{'f1_val': 0.9957757960160583, 'auprc': 0.9929507477680133, 'loss_val': 0.026211925761660683, 'psi': 0.9946457767168403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=44 head_norm_before_train=2.094806 cos_to_last_merge=0.9996 (last merge round=38)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9127361620379713, 'auprc': 0.9859690342164746, 'loss_val': 0.19950855684664331, 'psi': 0.9420293109093727}-{'f1_val': 0.9398446493031519, 'auprc': 0.9874503915098003, 'loss_val': 0.25817737705895694, 'psi': 0.9588869461858113}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.701993 cos_to_last_merge=0.9973 (last merge round=40)
[S17] round=44 local utility u=0.022654 metrics={'f1_val': 0.5931722021482821, 'auprc': 0.8521057303823898, 'loss_val': 1.0241363283189, 'psi': 0.6967456134419252}-{'f1_val': 0.6012745803263343, 'auprc': 0.7966124930163725, 'loss_val': 0.9515794069728042, 'psi': 0.6794097454023496}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.949)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.697)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.758478 cos_to_last_merge=0.7772 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=45 local utility u=0.000231 metrics={'f1_val': 0.829786198765327, 'auprc': 0.8992997444257094, 'loss_val': 0.373037761528784, 'psi': 0.85759161702948}-{'f1_val': 0.8304149365145606, 'auprc': 0.9043874992748778, 'loss_val': 0.39253489024191457, 'psi': 0.8600039616186874}
[S3] START round=45 head_norm_before_train=1.896864 cos_to_last_merge=0.9990 (last merge round=38)
[S3] round=45 local utility u=0.142306 metrics={'f1_val': 0.9490612345985034, 'auprc': 0.994482666411043, 'loss_val': 0.15206307364618488, 'psi': 0.9672298073235193}-{'f1_val': 0.916453993465474, 'auprc': 0.9970840302657893, 'loss_val': 0.24883632761174485, 'psi': 0.9487060081856001}
[S4] START round=45 head_norm_before_train=1.962544 cos_to_last_merge=0.9995 (last merge round=39)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.8882389033214528, 'auprc': 0.9125324731837972, 'loss_val': 0.442518978870026, 'psi': 0.8979563312663905}-{'f1_val': 0.9404582531524683, 'auprc': 0.9532317576858392, 'loss_val': 0.3187487214333126, 'psi': 0.9455676549658167}
[S5] START round=45 head_norm_before_train=2.128743 cos_to_last_merge=0.9990 (last merge round=38)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9932707840921892, 'loss_val': 0.019433893100070532, 'psi': 0.9955500488035143}-{'f1_val': 0.9970695586110643, 'auprc': 0.9982829785105001, 'loss_val': 0.019281783265807102, 'psi': 0.9975549265708387}
[S6] START round=45 head_norm_before_train=1.704320 cos_to_last_merge=0.9993 (last merge round=37)
[S6] round=45 local utility u=0.847717 metrics={'f1_val': 0.8468432254081963, 'auprc': 0.9699787769785633, 'loss_val': 0.2746133551894483, 'psi': 0.8960974460363431}-{'f1_val': 0.6484065244109491, 'auprc': 0.9544579479925547, 'loss_val': 0.7328647710313178, 'psi': 0.7708270938435913}
[S7] START round=45 head_norm_before_train=1.902528 (no previous merge yet)
[S7] round=45 local utility u=0.445231 metrics={'f1_val': 0.6701869948997251, 'auprc': 0.8154354115356737, 'loss_val': 0.3869169093863915, 'psi': 0.7282863615541046}-{'f1_val': 0.5994699697740731, 'auprc': 0.7946756518932653, 'loss_val': 0.7907970250354219, 'psi': 0.67755224262175}
[S8] START round=45 head_norm_before_train=1.741634 cos_to_last_merge=0.9914 (last merge round=39)
[S8] round=45 local utility u=0.074688 metrics={'f1_val': 0.9885804511658192, 'auprc': 0.9992255586751445, 'loss_val': 0.05452364631654794, 'psi': 0.9928384941695494}-{'f1_val': 0.9736904608187118, 'auprc': 0.9959566142092902, 'loss_val': 0.10475268875532565, 'psi': 0.9825969221749431}
[S9] START round=45 head_norm_before_train=1.960751 cos_to_last_merge=0.9724 (last merge round=34)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9942133092066594, 'loss_val': 0.02434584982876405, 'psi': 0.9956816307709986}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962381891303386, 'loss_val': 0.024777257814507604, 'psi': 0.9964915827404703}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=2.052479 cos_to_last_merge=0.9995 (last merge round=40)
[S10] round=45 local utility u=0.000356 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981034571440036, 'loss_val': 0.03339900986887677, 'psi': 0.996090548389225}-{'f1_val': 0.9947486092193725, 'auprc': 0.9980257635418112, 'loss_val': 0.033878333401992644, 'psi': 0.9960594709483479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=45 head_norm_before_train=1.748888 cos_to_last_merge=0.9987 (last merge round=38)
[S11] round=45 local utility u=0.001895 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9983293864274209, 'loss_val': 0.02863718272310799, 'psi': 0.9972478734683475}-{'f1_val': 0.9962850284706224, 'auprc': 0.998263796712111, 'loss_val': 0.030778716403418258, 'psi': 0.9970765357672179}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=45 head_norm_before_train=1.882916 cos_to_last_merge=0.9994 (last merge round=37)
[S13] round=45 local utility u=0.029227 metrics={'f1_val': 0.5810988078460307, 'auprc': 0.7504890289877919, 'loss_val': 0.9224493216397015, 'psi': 0.6488548963027352}-{'f1_val': 0.5853700559084816, 'auprc': 0.7223180748198124, 'loss_val': 0.9220174868351196, 'psi': 0.6401492634730139}
[S14] START round=45 head_norm_before_train=1.981078 cos_to_last_merge=0.9971 (last merge round=37)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9969690213109823, 'loss_val': 0.030459621814520596, 'psi': 0.9968403275166118}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969747293489531, 'loss_val': 0.03217416467979479, 'psi': 0.9971028129416952}
[S15] START round=45 head_norm_before_train=2.077065 (no previous merge yet)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9393275985297741, 'loss_val': 0.5300028927044815, 'psi': 0.7962812257136838}-{'f1_val': 0.9967466683875206, 'auprc': 0.9964016480157984, 'loss_val': 0.023223135516639497, 'psi': 0.9966086602388318}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=2.104380 cos_to_last_merge=0.9995 (last merge round=38)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.8307842324095773, 'auprc': 0.9832503745019289, 'loss_val': 1.1635896610187788, 'psi': 0.8917706892465179}-{'f1_val': 0.9127361620379713, 'auprc': 0.9859690342164746, 'loss_val': 0.19950855684664331, 'psi': 0.9420293109093727}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=45 head_norm_before_train=1.717922 cos_to_last_merge=0.9963 (last merge round=40)
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.5827309270035912, 'auprc': 0.8363959868372763, 'loss_val': 1.0909645078710168, 'psi': 0.6841969509370653}-{'f1_val': 0.5931722021482821, 'auprc': 0.8521057303823898, 'loss_val': 1.0241363283189, 'psi': 0.6967456134419252}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S2] START round=46 head_norm_before_train=1.768005 cos_to_last_merge=0.7757 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=46 local utility u=0.120226 metrics={'f1_val': 0.8275044145408343, 'auprc': 0.9903345872677766, 'loss_val': 0.3919998832759353, 'psi': 0.8926364836316112}-{'f1_val': 0.829786198765327, 'auprc': 0.8992997444257094, 'loss_val': 0.373037761528784, 'psi': 0.85759161702948}
[S3] START round=46 head_norm_before_train=1.903811 cos_to_last_merge=0.9987 (last merge round=38)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9422527057897107, 'auprc': 0.9939392476926971, 'loss_val': 0.14667885718954665, 'psi': 0.9629273225509053}-{'f1_val': 0.9490612345985034, 'auprc': 0.994482666411043, 'loss_val': 0.15206307364618488, 'psi': 0.9672298073235193}
[S4] START round=46 head_norm_before_train=1.971238 cos_to_last_merge=0.9993 (last merge round=39)
[S4] round=46 local utility u=0.290473 metrics={'f1_val': 0.9418398397767684, 'auprc': 0.957379549867774, 'loss_val': 0.3177198782671996, 'psi': 0.9480557238131706}-{'f1_val': 0.8882389033214528, 'auprc': 0.9125324731837972, 'loss_val': 0.442518978870026, 'psi': 0.8979563312663905}
[S5] START round=46 head_norm_before_train=2.142715 cos_to_last_merge=0.9988 (last merge round=38)
[S5] round=46 local utility u=0.000995 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9935886410017318, 'loss_val': 0.01839805431416684, 'psi': 0.9956771915673314}-{'f1_val': 0.9970695586110643, 'auprc': 0.9932707840921892, 'loss_val': 0.019433893100070532, 'psi': 0.9955500488035143}
[S6] START round=46 head_norm_before_train=1.716556 cos_to_last_merge=0.9991 (last merge round=37)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6843332823634287, 'auprc': 0.9548122957429372, 'loss_val': 0.6654164862842884, 'psi': 0.7925248877152321}-{'f1_val': 0.8468432254081963, 'auprc': 0.9699787769785633, 'loss_val': 0.2746133551894483, 'psi': 0.8960974460363431}
[S7] START round=46 head_norm_before_train=1.910096 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6139152782647359, 'auprc': 0.7940202470771006, 'loss_val': 0.8878685965744567, 'psi': 0.6859572657896817}-{'f1_val': 0.6701869948997251, 'auprc': 0.8154354115356737, 'loss_val': 0.3869169093863915, 'psi': 0.7282863615541046}
[S8] START round=46 head_norm_before_train=1.764910 cos_to_last_merge=0.9899 (last merge round=39)
[S8] round=46 local utility u=0.017608 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9992488408876603, 'loss_val': 0.04093972042796771, 'psi': 0.9950040805731312}-{'f1_val': 0.9885804511658192, 'auprc': 0.9992255586751445, 'loss_val': 0.05452364631654794, 'psi': 0.9928384941695494}
[S9] START round=46 head_norm_before_train=1.975742 cos_to_last_merge=0.9709 (last merge round=34)
[S9] round=46 local utility u=0.002669 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9964777619121, 'loss_val': 0.023314497574480914, 'psi': 0.9963387737443715}-{'f1_val': 0.9966605118138915, 'auprc': 0.9942133092066594, 'loss_val': 0.02434584982876405, 'psi': 0.9956816307709986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=46 head_norm_before_train=2.062872 cos_to_last_merge=0.9994 (last merge round=40)
[S10] round=46 local utility u=0.001032 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9984522381786555, 'loss_val': 0.03238206677244962, 'psi': 0.9962300608030856}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981034571440036, 'loss_val': 0.03339900986887677, 'psi': 0.996090548389225}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=46 head_norm_before_train=1.761750 cos_to_last_merge=0.9983 (last merge round=38)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985342567213553, 'loss_val': 0.031355712089829964, 'psi': 0.9973442556856005}-{'f1_val': 0.9965268648289654, 'auprc': 0.9983293864274209, 'loss_val': 0.02863718272310799, 'psi': 0.9972478734683475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.889179 cos_to_last_merge=0.9993 (last merge round=37)
[S13] round=46 local utility u=0.092974 metrics={'f1_val': 0.6059218126905792, 'auprc': 0.7642280576502491, 'loss_val': 0.9266562193665714, 'psi': 0.6692443106744472}-{'f1_val': 0.5810988078460307, 'auprc': 0.7504890289877919, 'loss_val': 0.9224493216397015, 'psi': 0.6488548963027352}
[S14] START round=46 head_norm_before_train=1.991006 cos_to_last_merge=0.9966 (last merge round=37)
[S14] round=46 local utility u=0.001518 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969744243410334, 'loss_val': 0.028898377826761284, 'psi': 0.9969882746310124}-{'f1_val': 0.996754531653698, 'auprc': 0.9969690213109823, 'loss_val': 0.030459621814520596, 'psi': 0.9968403275166118}
[S15] START round=46 head_norm_before_train=2.081717 (no previous merge yet)
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9669017880823552, 'auprc': 0.9908152338356773, 'loss_val': 0.06653549117208192, 'psi': 0.976467166383684}-{'f1_val': 0.7009169771696235, 'auprc': 0.9393275985297741, 'loss_val': 0.5300028927044815, 'psi': 0.7962812257136838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=46 head_norm_before_train=2.111481 cos_to_last_merge=0.9994 (last merge round=38)
[S16] round=46 local utility u=0.128532 metrics={'f1_val': 0.8451758044079172, 'auprc': 0.9814467418737914, 'loss_val': 0.9874637456531603, 'psi': 0.8996841793942669}-{'f1_val': 0.8307842324095773, 'auprc': 0.9832503745019289, 'loss_val': 1.1635896610187788, 'psi': 0.8917706892465179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=46 head_norm_before_train=1.735394 cos_to_last_merge=0.9952 (last merge round=40)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5629770683953017, 'auprc': 0.7496663803219465, 'loss_val': 1.1467922709975011, 'psi': 0.6376527931659597}-{'f1_val': 0.5827309270035912, 'auprc': 0.8363959868372763, 'loss_val': 1.0909645078710168, 'psi': 0.6841969509370653}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.669)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.995)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.893)
[S2] START round=47 head_norm_before_train=1.778712 cos_to_last_merge=0.7745 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.640318557770474, 'auprc': 0.7453928160461241, 'loss_val': 0.8127851204952281, 'psi': 0.6823482610807341}-{'f1_val': 0.8275044145408343, 'auprc': 0.9903345872677766, 'loss_val': 0.3919998832759353, 'psi': 0.8926364836316112}
[S3] START round=47 head_norm_before_train=1.913857 cos_to_last_merge=0.9984 (last merge round=38)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.8946878930612477, 'auprc': 0.9775357854488937, 'loss_val': 0.28323068663844564, 'psi': 0.9278270500163062}-{'f1_val': 0.9422527057897107, 'auprc': 0.9939392476926971, 'loss_val': 0.14667885718954665, 'psi': 0.9629273225509053}
[S4] START round=47 head_norm_before_train=1.977869 cos_to_last_merge=0.9991 (last merge round=39)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9435018514071966, 'auprc': 0.9527883606137428, 'loss_val': 0.3181066961012293, 'psi': 0.947216455089815}-{'f1_val': 0.9418398397767684, 'auprc': 0.957379549867774, 'loss_val': 0.3177198782671996, 'psi': 0.9480557238131706}
[S5] START round=47 head_norm_before_train=2.154830 cos_to_last_merge=0.9986 (last merge round=38)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9919083701438426, 'loss_val': 0.02837696844068948, 'psi': 0.9947845291446116}-{'f1_val': 0.9970695586110643, 'auprc': 0.9935886410017318, 'loss_val': 0.01839805431416684, 'psi': 0.9956771915673314}
[S6] START round=47 head_norm_before_train=1.727105 cos_to_last_merge=0.9989 (last merge round=37)
[S6] round=47 local utility u=0.716592 metrics={'f1_val': 0.8640845135674547, 'auprc': 0.9625599837650307, 'loss_val': 0.33398231460197475, 'psi': 0.903474701646485}-{'f1_val': 0.6843332823634287, 'auprc': 0.9548122957429372, 'loss_val': 0.6654164862842884, 'psi': 0.7925248877152321}
[S7] START round=47 head_norm_before_train=1.917593 (no previous merge yet)
[S7] round=47 local utility u=0.299028 metrics={'f1_val': 0.656940946449847, 'auprc': 0.8051790284627222, 'loss_val': 0.5814424086163631, 'psi': 0.7162361792549972}-{'f1_val': 0.6139152782647359, 'auprc': 0.7940202470771006, 'loss_val': 0.8878685965744567, 'psi': 0.6859572657896817}
[S8] START round=47 head_norm_before_train=1.783450 cos_to_last_merge=0.9886 (last merge round=39)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9825962690416792, 'auprc': 0.9962707747203199, 'loss_val': 0.06331901582099829, 'psi': 0.9880660713131355}-{'f1_val': 0.992174240363445, 'auprc': 0.9992488408876603, 'loss_val': 0.04093972042796771, 'psi': 0.9950040805731312}
[S9] START round=47 head_norm_before_train=1.988455 cos_to_last_merge=0.9696 (last merge round=34)
[S9] round=47 local utility u=0.001163 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962446855932978, 'loss_val': 0.02277533679315257, 'psi': 0.996494181325654}-{'f1_val': 0.9962461149658858, 'auprc': 0.9964777619121, 'loss_val': 0.023314497574480914, 'psi': 0.9963387737443715}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=47 head_norm_before_train=2.073756 cos_to_last_merge=0.9992 (last merge round=40)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982293495775907, 'loss_val': 0.032002592829883846, 'psi': 0.9961409053626598}-{'f1_val': 0.9947486092193725, 'auprc': 0.9984522381786555, 'loss_val': 0.03238206677244962, 'psi': 0.9962300608030856}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=1.773608 cos_to_last_merge=0.9980 (last merge round=38)
[S11] round=47 local utility u=0.001469 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984693117772876, 'loss_val': 0.02822352801051902, 'psi': 0.9973182777079734}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985342567213553, 'loss_val': 0.031355712089829964, 'psi': 0.9973442556856005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=47 head_norm_before_train=1.898973 cos_to_last_merge=0.9990 (last merge round=37)
[S13] round=47 local utility u=0.142021 metrics={'f1_val': 0.6247223331008198, 'auprc': 0.7828019817153219, 'loss_val': 0.8111394039931705, 'psi': 0.6879541925466206}-{'f1_val': 0.6059218126905792, 'auprc': 0.7642280576502491, 'loss_val': 0.9266562193665714, 'psi': 0.6692443106744472}
[S14] START round=47 head_norm_before_train=2.001052 cos_to_last_merge=0.9961 (last merge round=37)
[S14] round=47 local utility u=0.003635 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990423153146646, 'loss_val': 0.02783122823887883, 'psi': 0.9978154310204649}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969744243410334, 'loss_val': 0.028898377826761284, 'psi': 0.9969882746310124}
[S15] START round=47 head_norm_before_train=2.087764 (no previous merge yet)
[S15] round=47 local utility u=0.117065 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9959017954244415, 'loss_val': 0.024248668463515092, 'psi': 0.9961601646790611}-{'f1_val': 0.9669017880823552, 'auprc': 0.9908152338356773, 'loss_val': 0.06653549117208192, 'psi': 0.976467166383684}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=47 head_norm_before_train=2.116955 cos_to_last_merge=0.9993 (last merge round=38)
[S16] round=47 local utility u=0.919668 metrics={'f1_val': 0.991990432657946, 'auprc': 0.9873120501705477, 'loss_val': 0.04661119718171868, 'psi': 0.9901190796629866}-{'f1_val': 0.8451758044079172, 'auprc': 0.9814467418737914, 'loss_val': 0.9874637456531603, 'psi': 0.8996841793942669}
[S16] not sending this round → trigger blocked (psi=0.990)
[S17] START round=47 head_norm_before_train=1.749196 cos_to_last_merge=0.9942 (last merge round=40)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.42353147154942056, 'auprc': 0.6554268564407, 'loss_val': 1.451846420385077, 'psi': 0.5162896255059324}-{'f1_val': 0.5629770683953017, 'auprc': 0.7496663803219465, 'loss_val': 1.1467922709975011, 'psi': 0.6376527931659597}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.789661 cos_to_last_merge=0.7735 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=48 local utility u=0.722820 metrics={'f1_val': 0.7088332700176482, 'auprc': 0.9912887649071008, 'loss_val': 0.5159206922626578, 'psi': 0.8218154679734293}-{'f1_val': 0.640318557770474, 'auprc': 0.7453928160461241, 'loss_val': 0.8127851204952281, 'psi': 0.6823482610807341}
[S3] START round=48 head_norm_before_train=1.923261 cos_to_last_merge=0.9982 (last merge round=38)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7781851803133859, 'auprc': 0.9398956214761139, 'loss_val': 0.646152659259094, 'psi': 0.8428693567784771}-{'f1_val': 0.8946878930612477, 'auprc': 0.9775357854488937, 'loss_val': 0.28323068663844564, 'psi': 0.9278270500163062}
[S4] START round=48 head_norm_before_train=1.983366 cos_to_last_merge=0.9989 (last merge round=39)
[S4] round=48 local utility u=0.012682 metrics={'f1_val': 0.9483436441873966, 'auprc': 0.9519279364552347, 'loss_val': 0.3192118923959368, 'psi': 0.9497773610945318}-{'f1_val': 0.9435018514071966, 'auprc': 0.9527883606137428, 'loss_val': 0.3181066961012293, 'psi': 0.947216455089815}
[S5] START round=48 head_norm_before_train=2.158742 cos_to_last_merge=0.9985 (last merge round=38)
[S5] round=48 local utility u=0.016000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9994600053349112, 'loss_val': 0.023438996707301884, 'psi': 0.9982459528455597}-{'f1_val': 0.9967019684784577, 'auprc': 0.9919083701438426, 'loss_val': 0.02837696844068948, 'psi': 0.9947845291446116}
[S6] START round=48 head_norm_before_train=1.735283 cos_to_last_merge=0.9987 (last merge round=37)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6379082166937503, 'auprc': 0.9432224919074547, 'loss_val': 0.7517996425133892, 'psi': 0.760033926779232}-{'f1_val': 0.8640845135674547, 'auprc': 0.9625599837650307, 'loss_val': 0.33398231460197475, 'psi': 0.903474701646485}
[S7] START round=48 head_norm_before_train=1.918919 (no previous merge yet)
[S7] round=48 local utility u=0.453226 metrics={'f1_val': 0.7106043508646551, 'auprc': 0.8794179155501866, 'loss_val': 0.21968689827180723, 'psi': 0.7781297767388677}-{'f1_val': 0.656940946449847, 'auprc': 0.8051790284627222, 'loss_val': 0.5814424086163631, 'psi': 0.7162361792549972}
[S8] START round=48 head_norm_before_train=1.801196 cos_to_last_merge=0.9874 (last merge round=39)
[S8] round=48 local utility u=0.049906 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9990725079745728, 'loss_val': 0.03593853910611739, 'psi': 0.995589405110753}-{'f1_val': 0.9825962690416792, 'auprc': 0.9962707747203199, 'loss_val': 0.06331901582099829, 'psi': 0.9880660713131355}
[S9] START round=48 head_norm_before_train=2.000291 cos_to_last_merge=0.9684 (last merge round=34)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9940538691846683, 'loss_val': 0.022838266192058233, 'psi': 0.9954676590741999}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962446855932978, 'loss_val': 0.02277533679315257, 'psi': 0.996494181325654}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=2.084577 cos_to_last_merge=0.9989 (last merge round=40)
[S10] round=48 local utility u=0.000281 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.998205980189435, 'loss_val': 0.03137128760620815, 'psi': 0.9961315576073975}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982293495775907, 'loss_val': 0.032002592829883846, 'psi': 0.9961409053626598}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=48 head_norm_before_train=1.785967 cos_to_last_merge=0.9976 (last merge round=38)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9795389662688634, 'auprc': 0.9982541854587552, 'loss_val': 0.06629200018365597, 'psi': 0.9870250539448202}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984693117772876, 'loss_val': 0.02822352801051902, 'psi': 0.9973182777079734}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.909993 cos_to_last_merge=0.9985 (last merge round=37)
[S13] round=48 local utility u=0.140320 metrics={'f1_val': 0.6663867266993693, 'auprc': 0.7792164300744644, 'loss_val': 0.7697294256978934, 'psi': 0.7115186080494074}-{'f1_val': 0.6247223331008198, 'auprc': 0.7828019817153219, 'loss_val': 0.8111394039931705, 'psi': 0.6879541925466206}
[S14] START round=48 head_norm_before_train=2.011276 cos_to_last_merge=0.9956 (last merge round=37)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969681840345332, 'loss_val': 0.0279116584553863, 'psi': 0.9968537381852751}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990423153146646, 'loss_val': 0.02783122823887883, 'psi': 0.9978154310204649}
[S15] START round=48 head_norm_before_train=2.096002 (no previous merge yet)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.7393398374319522, 'auprc': 0.9428695623631425, 'loss_val': 0.5155252965704609, 'psi': 0.8207517274044283}-{'f1_val': 0.9963324108488076, 'auprc': 0.9959017954244415, 'loss_val': 0.024248668463515092, 'psi': 0.9961601646790611}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=2.123261 cos_to_last_merge=0.9991 (last merge round=38)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9924156602567238, 'auprc': 0.9846227043149836, 'loss_val': 0.04477337720171155, 'psi': 0.9892984778800277}-{'f1_val': 0.991990432657946, 'auprc': 0.9873120501705477, 'loss_val': 0.04661119718171868, 'psi': 0.9901190796629866}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.758579 cos_to_last_merge=0.9936 (last merge round=40)
[S17] round=48 local utility u=0.910400 metrics={'f1_val': 0.584664924436187, 'auprc': 0.8281843013026683, 'loss_val': 1.1161202116368436, 'psi': 0.6820726751827795}-{'f1_val': 0.42353147154942056, 'auprc': 0.6554268564407, 'loss_val': 1.451846420385077, 'psi': 0.5162896255059324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.712)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → trigger blocked (psi=0.778)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] START round=49 head_norm_before_train=1.797252 cos_to_last_merge=0.7729 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=49 local utility u=0.109459 metrics={'f1_val': 0.8317735592688097, 'auprc': 0.7676609380038538, 'loss_val': 0.3637610735982776, 'psi': 0.8061285107628273}-{'f1_val': 0.7088332700176482, 'auprc': 0.9912887649071008, 'loss_val': 0.5159206922626578, 'psi': 0.8218154679734293}
[S3] START round=49 head_norm_before_train=1.934107 cos_to_last_merge=0.9979 (last merge round=38)
[S3] round=49 local utility u=0.919715 metrics={'f1_val': 0.9649582626647751, 'auprc': 0.9972021056794469, 'loss_val': 0.09928103446319465, 'psi': 0.9778557998706439}-{'f1_val': 0.7781851803133859, 'auprc': 0.9398956214761139, 'loss_val': 0.646152659259094, 'psi': 0.8428693567784771}
[S4] START round=49 head_norm_before_train=1.990703 cos_to_last_merge=0.9986 (last merge round=39)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9420170831888893, 'auprc': 0.950206850285849, 'loss_val': 0.3251254197007576, 'psi': 0.9452929900276732}-{'f1_val': 0.9483436441873966, 'auprc': 0.9519279364552347, 'loss_val': 0.3192118923959368, 'psi': 0.9497773610945318}
[S5] START round=49 head_norm_before_train=2.159648 cos_to_last_merge=0.9985 (last merge round=38)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9916038247819702, 'loss_val': 0.02396567350299502, 'psi': 0.9946627109998627}-{'f1_val': 0.9974365845193254, 'auprc': 0.9994600053349112, 'loss_val': 0.023438996707301884, 'psi': 0.9982459528455597}
[S6] START round=49 head_norm_before_train=1.742265 cos_to_last_merge=0.9986 (last merge round=37)
[S6] round=49 local utility u=0.991878 metrics={'f1_val': 0.8688775717039761, 'auprc': 0.9725299025958113, 'loss_val': 0.24178133582369926, 'psi': 0.9103385040607102}-{'f1_val': 0.6379082166937503, 'auprc': 0.9432224919074547, 'loss_val': 0.7517996425133892, 'psi': 0.760033926779232}
[S7] START round=49 head_norm_before_train=1.920455 (no previous merge yet)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6590886371740017, 'auprc': 0.8068087500076688, 'loss_val': 0.5254154954929141, 'psi': 0.7181766823074686}-{'f1_val': 0.7106043508646551, 'auprc': 0.8794179155501866, 'loss_val': 0.21968689827180723, 'psi': 0.7781297767388677}
[S8] START round=49 head_norm_before_train=1.815965 cos_to_last_merge=0.9865 (last merge round=39)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9665313084276178, 'auprc': 0.999131647839032, 'loss_val': 0.10347203832546539, 'psi': 0.9795714441921834}-{'f1_val': 0.9932673365348732, 'auprc': 0.9990725079745728, 'loss_val': 0.03593853910611739, 'psi': 0.995589405110753}
[S9] START round=49 head_norm_before_train=2.013402 cos_to_last_merge=0.9671 (last merge round=34)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9958297137965918, 'loss_val': 0.02493623599615502, 'psi': 0.9951783422884674}-{'f1_val': 0.9964101856672208, 'auprc': 0.9940538691846683, 'loss_val': 0.022838266192058233, 'psi': 0.9954676590741999}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=2.095090 cos_to_last_merge=0.9987 (last merge round=40)
[S10] round=49 local utility u=0.000168 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981837379374798, 'loss_val': 0.03096870641780454, 'psi': 0.9961226607066154}-{'f1_val': 0.9947486092193725, 'auprc': 0.998205980189435, 'loss_val': 0.03137128760620815, 'psi': 0.9961315576073975}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=49 head_norm_before_train=1.798060 cos_to_last_merge=0.9971 (last merge round=38)
[S11] round=49 local utility u=0.069847 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.998082384038911, 'loss_val': 0.025530624448362176, 'psi': 0.9969010745741819}-{'f1_val': 0.9795389662688634, 'auprc': 0.9982541854587552, 'loss_val': 0.06629200018365597, 'psi': 0.9870250539448202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=49 head_norm_before_train=1.916692 cos_to_last_merge=0.9979 (last merge round=37)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6251373271131833, 'auprc': 0.7638821619024242, 'loss_val': 0.9833663341626105, 'psi': 0.6806352610288797}-{'f1_val': 0.6663867266993693, 'auprc': 0.7792164300744644, 'loss_val': 0.7697294256978934, 'psi': 0.7115186080494074}
[S14] START round=49 head_norm_before_train=2.023293 cos_to_last_merge=0.9950 (last merge round=37)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969562867220054, 'loss_val': 0.031065431002172215, 'psi': 0.9970954358909162}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969681840345332, 'loss_val': 0.0279116584553863, 'psi': 0.9968537381852751}
[S15] START round=49 head_norm_before_train=2.104335 (no previous merge yet)
[S15] round=49 local utility u=0.193488 metrics={'f1_val': 0.7729842077349695, 'auprc': 0.9842374918267335, 'loss_val': 0.4545198280581785, 'psi': 0.857485521371675}-{'f1_val': 0.7393398374319522, 'auprc': 0.9428695623631425, 'loss_val': 0.5155252965704609, 'psi': 0.8207517274044283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=49 head_norm_before_train=2.131308 cos_to_last_merge=0.9990 (last merge round=38)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9917148021162032, 'auprc': 0.9852064894981867, 'loss_val': 0.0446754212422004, 'psi': 0.9891114770689966}-{'f1_val': 0.9924156602567238, 'auprc': 0.9846227043149836, 'loss_val': 0.04477337720171155, 'psi': 0.9892984778800277}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.767161 cos_to_last_merge=0.9929 (last merge round=40)
[S17] round=49 local utility u=0.389720 metrics={'f1_val': 0.6151879927629349, 'auprc': 0.9889318366436604, 'loss_val': 1.0020613006536723, 'psi': 0.7646855303152251}-{'f1_val': 0.584664924436187, 'auprc': 0.8281843013026683, 'loss_val': 1.1161202116368436, 'psi': 0.6820726751827795}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S17] not sending this round → trigger blocked (psi=0.765)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → trigger blocked (psi=0.806)
[S2] START round=50 head_norm_before_train=1.802300 cos_to_last_merge=0.7722 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.7106494945084202, 'auprc': 0.9896748501549077, 'loss_val': 0.49202531621194723, 'psi': 0.8222596367670152}-{'f1_val': 0.8317735592688097, 'auprc': 0.7676609380038538, 'loss_val': 0.3637610735982776, 'psi': 0.8061285107628273}
[S3] START round=50 head_norm_before_train=1.945527 cos_to_last_merge=0.9977 (last merge round=38)
[S3] round=50 local utility u=0.074123 metrics={'f1_val': 0.9815426475669196, 'auprc': 0.9984594678108873, 'loss_val': 0.05431420121279641, 'psi': 0.9883093756645067}-{'f1_val': 0.9649582626647751, 'auprc': 0.9972021056794469, 'loss_val': 0.09928103446319465, 'psi': 0.9778557998706439}
[S4] START round=50 head_norm_before_train=1.998249 cos_to_last_merge=0.9985 (last merge round=39)
[S4] round=50 local utility u=0.012606 metrics={'f1_val': 0.9423473059666108, 'auprc': 0.957400364033248, 'loss_val': 0.32347546931513765, 'psi': 0.9483685291932658}-{'f1_val': 0.9420170831888893, 'auprc': 0.950206850285849, 'loss_val': 0.3251254197007576, 'psi': 0.9452929900276732}
[S5] START round=50 head_norm_before_train=2.163126 cos_to_last_merge=0.9984 (last merge round=38)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.9300196603868905, 'auprc': 0.9992418440894753, 'loss_val': 0.09537012588767421, 'psi': 0.9577085338679243}-{'f1_val': 0.9967019684784577, 'auprc': 0.9916038247819702, 'loss_val': 0.02396567350299502, 'psi': 0.9946627109998627}
[S6] START round=50 head_norm_before_train=1.750726 cos_to_last_merge=0.9985 (last merge round=37)
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.6243866003273385, 'auprc': 0.954375769700584, 'loss_val': 0.7703119942197614, 'psi': 0.7563822680766368}-{'f1_val': 0.8688775717039761, 'auprc': 0.9725299025958113, 'loss_val': 0.24178133582369926, 'psi': 0.9103385040607102}
[S7] START round=50 head_norm_before_train=1.923451 (no previous merge yet)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.49955255448916874, 'auprc': 0.7774407943276013, 'loss_val': 1.2219338780770554, 'psi': 0.6107078504245418}-{'f1_val': 0.6590886371740017, 'auprc': 0.8068087500076688, 'loss_val': 0.5254154954929141, 'psi': 0.7181766823074686}
[S8] START round=50 head_norm_before_train=1.830396 cos_to_last_merge=0.9856 (last merge round=39)
[S8] round=50 local utility u=0.097324 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.986448012130798, 'loss_val': 0.038388083665354115, 'psi': 0.9912595260337563}-{'f1_val': 0.9665313084276178, 'auprc': 0.999131647839032, 'loss_val': 0.10347203832546539, 'psi': 0.9795714441921834}
[S9] START round=50 head_norm_before_train=2.025202 cos_to_last_merge=0.9659 (last merge round=34)
[S9] round=50 local utility u=0.001337 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9931035932522672, 'loss_val': 0.023118921951016665, 'psi': 0.9949914941684734}-{'f1_val': 0.9947440946163844, 'auprc': 0.9958297137965918, 'loss_val': 0.02493623599615502, 'psi': 0.9951783422884674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=50 head_norm_before_train=2.105278 cos_to_last_merge=0.9985 (last merge round=40)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9984120208050431, 'loss_val': 0.030345685346857113, 'psi': 0.9958190036201855}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981837379374798, 'loss_val': 0.03096870641780454, 'psi': 0.9961226607066154}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=1.807511 cos_to_last_merge=0.9968 (last merge round=38)
[S11] round=50 local utility u=0.001029 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981166865401391, 'loss_val': 0.026055345509326634, 'psi': 0.9971627935134348}-{'f1_val': 0.9961135349310292, 'auprc': 0.998082384038911, 'loss_val': 0.025530624448362176, 'psi': 0.9969010745741819}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=50 head_norm_before_train=1.921372 cos_to_last_merge=0.9976 (last merge round=37)
[S13] round=50 local utility u=0.026319 metrics={'f1_val': 0.6250841994648056, 'auprc': 0.7684156739664506, 'loss_val': 0.9440100687704385, 'psi': 0.6824167892654636}-{'f1_val': 0.6251373271131833, 'auprc': 0.7638821619024242, 'loss_val': 0.9833663341626105, 'psi': 0.6806352610288797}
[S14] START round=50 head_norm_before_train=2.033155 cos_to_last_merge=0.9943 (last merge round=37)
[S14] round=50 local utility u=0.001537 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969651505808488, 'loss_val': 0.028017862590451713, 'psi': 0.9970989814344535}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969562867220054, 'loss_val': 0.031065431002172215, 'psi': 0.9970954358909162}
[S15] START round=50 head_norm_before_train=2.112778 (no previous merge yet)
[S15] round=50 local utility u=0.346803 metrics={'f1_val': 0.8430743958957142, 'auprc': 0.9905772724691368, 'loss_val': 0.20047431171875452, 'psi': 0.9020755465250833}-{'f1_val': 0.7729842077349695, 'auprc': 0.9842374918267335, 'loss_val': 0.4545198280581785, 'psi': 0.857485521371675}
[S15] not sending this round → trigger blocked (psi=0.902)
[S16] START round=50 head_norm_before_train=2.140866 cos_to_last_merge=0.9987 (last merge round=38)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9436737053184501, 'auprc': 0.9812862597547569, 'loss_val': 0.18326080497173936, 'psi': 0.9587187270929728}-{'f1_val': 0.9917148021162032, 'auprc': 0.9852064894981867, 'loss_val': 0.0446754212422004, 'psi': 0.9891114770689966}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.776512 cos_to_last_merge=0.9921 (last merge round=40)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6214268288602627, 'auprc': 0.900529338467557, 'loss_val': 1.0551925305442005, 'psi': 0.7330678327031804}-{'f1_val': 0.6151879927629349, 'auprc': 0.9889318366436604, 'loss_val': 1.0020613006536723, 'psi': 0.7646855303152251}
[S3] not sending this round → trigger blocked (psi=0.988)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S2] START round=51 head_norm_before_train=1.807455 cos_to_last_merge=0.7718 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=51 local utility u=0.221609 metrics={'f1_val': 0.8314149542422395, 'auprc': 0.8527456936337998, 'loss_val': 0.36261346532971317, 'psi': 0.8399472499988636}-{'f1_val': 0.7106494945084202, 'auprc': 0.9896748501549077, 'loss_val': 0.49202531621194723, 'psi': 0.8222596367670152}
[S3] START round=51 head_norm_before_train=1.953489 cos_to_last_merge=0.9976 (last merge round=38)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9717529106753171, 'auprc': 0.9992766576255704, 'loss_val': 0.08395367054919617, 'psi': 0.9827624094554184}-{'f1_val': 0.9815426475669196, 'auprc': 0.9984594678108873, 'loss_val': 0.05431420121279641, 'psi': 0.9883093756645067}
[S4] START round=51 head_norm_before_train=2.004712 cos_to_last_merge=0.9985 (last merge round=39)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9411539829716359, 'auprc': 0.9552498554890011, 'loss_val': 0.3342509400217918, 'psi': 0.946792331978582}-{'f1_val': 0.9423473059666108, 'auprc': 0.957400364033248, 'loss_val': 0.32347546931513765, 'psi': 0.9483685291932658}
[S5] START round=51 head_norm_before_train=2.161345 cos_to_last_merge=0.9985 (last merge round=38)
[S5] round=51 local utility u=0.236829 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9994163671663473, 'loss_val': 0.028935339039235373, 'psi': 0.9984483758777138}-{'f1_val': 0.9300196603868905, 'auprc': 0.9992418440894753, 'loss_val': 0.09537012588767421, 'psi': 0.9577085338679243}
[S6] START round=51 head_norm_before_train=1.756230 cos_to_last_merge=0.9982 (last merge round=37)
[S6] round=51 local utility u=1.000000 metrics={'f1_val': 0.8772719288647818, 'auprc': 0.9664950074742799, 'loss_val': 0.24379068181574515, 'psi': 0.912961160308581}-{'f1_val': 0.6243866003273385, 'auprc': 0.954375769700584, 'loss_val': 0.7703119942197614, 'psi': 0.7563822680766368}
[S7] START round=51 head_norm_before_train=1.924791 (no previous merge yet)
[S7] round=51 local utility u=1.000000 metrics={'f1_val': 0.7145269991521898, 'auprc': 0.8266179816010972, 'loss_val': 0.35351577497943143, 'psi': 0.7593633921317527}-{'f1_val': 0.49955255448916874, 'auprc': 0.7774407943276013, 'loss_val': 1.2219338780770554, 'psi': 0.6107078504245418}
[S8] START round=51 head_norm_before_train=1.842485 cos_to_last_merge=0.9847 (last merge round=39)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9747022859241885, 'auprc': 0.9989322808385767, 'loss_val': 0.07730530222417331, 'psi': 0.9843942838899438}-{'f1_val': 0.9944672019690619, 'auprc': 0.986448012130798, 'loss_val': 0.038388083665354115, 'psi': 0.9912595260337563}
[S9] START round=51 head_norm_before_train=2.032758 cos_to_last_merge=0.9651 (last merge round=34)
[S9] round=51 local utility u=0.006927 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9980660928427778, 'loss_val': 0.02161168161095795, 'psi': 0.9967224681556224}-{'f1_val': 0.9962500947792776, 'auprc': 0.9931035932522672, 'loss_val': 0.023118921951016665, 'psi': 0.9949914941684734}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=51 head_norm_before_train=2.115087 cos_to_last_merge=0.9982 (last merge round=40)
[S10] round=51 local utility u=0.000934 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.998132973552019, 'loss_val': 0.030272543712186194, 'psi': 0.9959706534998443}-{'f1_val': 0.9940903254969471, 'auprc': 0.9984120208050431, 'loss_val': 0.030345685346857113, 'psi': 0.9958190036201855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=51 head_norm_before_train=1.816029 cos_to_last_merge=0.9965 (last merge round=38)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9978324281218756, 'loss_val': 0.02639773733565349, 'psi': 0.9969039883311237}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981166865401391, 'loss_val': 0.026055345509326634, 'psi': 0.9971627935134348}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.927740 cos_to_last_merge=0.9973 (last merge round=37)
[S13] round=51 local utility u=0.225161 metrics={'f1_val': 0.6537359679434918, 'auprc': 0.7924357036421225, 'loss_val': 0.7376582288316809, 'psi': 0.7092158622229441}-{'f1_val': 0.6250841994648056, 'auprc': 0.7684156739664506, 'loss_val': 0.9440100687704385, 'psi': 0.6824167892654636}
[S14] START round=51 head_norm_before_train=2.042666 cos_to_last_merge=0.9936 (last merge round=37)
[S14] round=51 local utility u=0.002065 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9990409650305438, 'loss_val': 0.028970804559704834, 'psi': 0.9978148909068165}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969651505808488, 'loss_val': 0.028017862590451713, 'psi': 0.9970989814344535}
[S15] START round=51 head_norm_before_train=2.120566 (no previous merge yet)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8151224424513305, 'auprc': 0.9896642932143731, 'loss_val': 0.2687711476833622, 'psi': 0.8849391827565476}-{'f1_val': 0.8430743958957142, 'auprc': 0.9905772724691368, 'loss_val': 0.20047431171875452, 'psi': 0.9020755465250833}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.149372 cos_to_last_merge=0.9985 (last merge round=38)
[S16] round=51 local utility u=0.232976 metrics={'f1_val': 0.9922935913444343, 'auprc': 0.9934980924371484, 'loss_val': 0.04566323650884434, 'psi': 0.9927753917815199}-{'f1_val': 0.9436737053184501, 'auprc': 0.9812862597547569, 'loss_val': 0.18326080497173936, 'psi': 0.9587187270929728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=51 head_norm_before_train=1.784218 cos_to_last_merge=0.9914 (last merge round=40)
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.5011489289877321, 'auprc': 0.6835097829544576, 'loss_val': 1.408357305580324, 'psi': 0.5740932705744224}-{'f1_val': 0.6214268288602627, 'auprc': 0.900529338467557, 'loss_val': 1.0551925305442005, 'psi': 0.7330678327031804}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.709)
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S2] START round=52 head_norm_before_train=1.813134 cos_to_last_merge=0.7712 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=52 local utility u=0.045466 metrics={'f1_val': 0.7872479113766402, 'auprc': 0.9889721518436296, 'loss_val': 0.41535826775306567, 'psi': 0.867937607563436}-{'f1_val': 0.8314149542422395, 'auprc': 0.8527456936337998, 'loss_val': 0.36261346532971317, 'psi': 0.8399472499988636}
[S3] START round=52 head_norm_before_train=1.962403 cos_to_last_merge=0.9974 (last merge round=38)
[S3] round=52 local utility u=0.016695 metrics={'f1_val': 0.9762327627024889, 'auprc': 0.9989532893566853, 'loss_val': 0.0764732444671523, 'psi': 0.9853209733641675}-{'f1_val': 0.9717529106753171, 'auprc': 0.9992766576255704, 'loss_val': 0.08395367054919617, 'psi': 0.9827624094554184}
[S4] START round=52 head_norm_before_train=2.009917 cos_to_last_merge=0.9983 (last merge round=39)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.940410832266876, 'auprc': 0.929704881696687, 'loss_val': 0.3380240920070903, 'psi': 0.9361284520388005}-{'f1_val': 0.9411539829716359, 'auprc': 0.9552498554890011, 'loss_val': 0.3342509400217918, 'psi': 0.946792331978582}
[S5] START round=52 head_norm_before_train=2.161059 cos_to_last_merge=0.9984 (last merge round=38)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.9652577546847164, 'auprc': 0.9900214388424182, 'loss_val': 0.0674066546345071, 'psi': 0.9751632283477971}-{'f1_val': 0.9978030483519582, 'auprc': 0.9994163671663473, 'loss_val': 0.028935339039235373, 'psi': 0.9984483758777138}
[S6] START round=52 head_norm_before_train=1.763161 cos_to_last_merge=0.9980 (last merge round=37)
[S6] round=52 local utility u=0.033423 metrics={'f1_val': 0.8824710790448377, 'auprc': 0.9730794090049746, 'loss_val': 0.22789256370589112, 'psi': 0.9187144110288924}-{'f1_val': 0.8772719288647818, 'auprc': 0.9664950074742799, 'loss_val': 0.24379068181574515, 'psi': 0.912961160308581}
[S7] START round=52 head_norm_before_train=1.925976 (no previous merge yet)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.6408435210059853, 'auprc': 0.799909436066856, 'loss_val': 0.57445734639839, 'psi': 0.7044698870303336}-{'f1_val': 0.7145269991521898, 'auprc': 0.8266179816010972, 'loss_val': 0.35351577497943143, 'psi': 0.7593633921317527}
[S8] START round=52 head_norm_before_train=1.851024 cos_to_last_merge=0.9843 (last merge round=39)
[S8] round=52 local utility u=0.048005 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9990157806004465, 'loss_val': 0.049867242753515, 'psi': 0.9912598690150151}-{'f1_val': 0.9747022859241885, 'auprc': 0.9989322808385767, 'loss_val': 0.07730530222417331, 'psi': 0.9843942838899438}
[S9] START round=52 head_norm_before_train=2.042862 cos_to_last_merge=0.9641 (last merge round=34)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9981232844948286, 'loss_val': 0.027552492818828697, 'psi': 0.9954946187917564}-{'f1_val': 0.9958267183641853, 'auprc': 0.9980660928427778, 'loss_val': 0.02161168161095795, 'psi': 0.9967224681556224}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=2.124463 cos_to_last_merge=0.9979 (last merge round=40)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.993871046050545, 'auprc': 0.9982715929690615, 'loss_val': 0.02983659976219285, 'psi': 0.9956312648179516}-{'f1_val': 0.9945291067983943, 'auprc': 0.998132973552019, 'loss_val': 0.030272543712186194, 'psi': 0.9959706534998443}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=1.825519 cos_to_last_merge=0.9962 (last merge round=38)
[S11] round=52 local utility u=0.001361 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.998410201213666, 'loss_val': 0.024380910493446827, 'psi': 0.9970322014440838}-{'f1_val': 0.9962850284706224, 'auprc': 0.9978324281218756, 'loss_val': 0.02639773733565349, 'psi': 0.9969039883311237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=52 head_norm_before_train=1.932275 cos_to_last_merge=0.9972 (last merge round=37)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6320236071567803, 'auprc': 0.790130091725228, 'loss_val': 1.0107583256614534, 'psi': 0.6952662009841594}-{'f1_val': 0.6537359679434918, 'auprc': 0.7924357036421225, 'loss_val': 0.7376582288316809, 'psi': 0.7092158622229441}
[S14] START round=52 head_norm_before_train=2.048230 cos_to_last_merge=0.9928 (last merge round=37)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986615909130415, 'loss_val': 0.026191995225648593, 'psi': 0.9974169753316668}-{'f1_val': 0.9969975081576651, 'auprc': 0.9990409650305438, 'loss_val': 0.028970804559704834, 'psi': 0.9978148909068165}
[S15] START round=52 head_norm_before_train=2.128670 (no previous merge yet)
[S15] round=52 local utility u=0.674153 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9953340671349554, 'loss_val': 0.024992787657621744, 'psi': 0.9959589350401759}-{'f1_val': 0.8151224424513305, 'auprc': 0.9896642932143731, 'loss_val': 0.2687711476833622, 'psi': 0.8849391827565476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=52 head_norm_before_train=2.156870 cos_to_last_merge=0.9983 (last merge round=38)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9108566600588045, 'auprc': 0.9766403546680908, 'loss_val': 0.2061398960263315, 'psi': 0.937170137902519}-{'f1_val': 0.9922935913444343, 'auprc': 0.9934980924371484, 'loss_val': 0.04566323650884434, 'psi': 0.9927753917815199}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.790615 cos_to_last_merge=0.9909 (last merge round=40)
[S17] round=52 local utility u=0.632976 metrics={'f1_val': 0.6066968713563385, 'auprc': 0.7632026190630617, 'loss_val': 1.0147710153668659, 'psi': 0.6692991704390279}-{'f1_val': 0.5011489289877321, 'auprc': 0.6835097829544576, 'loss_val': 1.408357305580324, 'psi': 0.5740932705744224}
[S3]  timeout peer S9
[S2]  timeout peer S13
[S13]  timeout peer S4
[S17]  timeout peer S3
[S7]  timeout peer S14
[S6]  timeout peer S11
[S4]  timeout peer S10
[S8]  timeout peer S17
[S14]  timeout peer S15
[S5]  timeout peer S16
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → trigger blocked (psi=0.919)
[S2] not sending this round → trigger blocked (psi=0.868)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] sending update (kind=head size=1791 to 1 peers)
[S2] START round=53 head_norm_before_train=1.821347 cos_to_last_merge=0.7706 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=53 local utility u=0.128202 metrics={'f1_val': 0.8273997510718984, 'auprc': 0.9903528486683708, 'loss_val': 0.40400798318261644, 'psi': 0.8925809901104874}-{'f1_val': 0.7872479113766402, 'auprc': 0.9889721518436296, 'loss_val': 0.41535826775306567, 'psi': 0.867937607563436}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=53 head_norm_before_train=1.970016 cos_to_last_merge=0.9972 (last merge round=38)
[S3] round=53 local utility u=0.016387 metrics={'f1_val': 0.9807576278248005, 'auprc': 0.9987100457019773, 'loss_val': 0.07011836178245386, 'psi': 0.9879385949756712}-{'f1_val': 0.9762327627024889, 'auprc': 0.9989532893566853, 'loss_val': 0.0764732444671523, 'psi': 0.9853209733641675}
[S3] not sending this round → trigger blocked (psi=0.988)
[S4] START round=53 head_norm_before_train=2.012937 cos_to_last_merge=0.9981 (last merge round=39)
[S4] round=53 local utility u=0.043085 metrics={'f1_val': 0.9418108237307232, 'auprc': 0.954178304835482, 'loss_val': 0.33367361248632793, 'psi': 0.9467578161726268}-{'f1_val': 0.940410832266876, 'auprc': 0.929704881696687, 'loss_val': 0.3380240920070903, 'psi': 0.9361284520388005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=53 head_norm_before_train=2.163089 cos_to_last_merge=0.9983 (last merge round=38)
[S5] round=53 local utility u=0.134538 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9995451656816944, 'loss_val': 0.019975177551560152, 'psi': 0.998280016984273}-{'f1_val': 0.9652577546847164, 'auprc': 0.9900214388424182, 'loss_val': 0.0674066546345071, 'psi': 0.9751632283477971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=53 head_norm_before_train=1.768698 cos_to_last_merge=0.9975 (last merge round=37)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5990360003297381, 'auprc': 0.9346331220270174, 'loss_val': 0.9947189588707532, 'psi': 0.7332748490086498}-{'f1_val': 0.8824710790448377, 'auprc': 0.9730794090049746, 'loss_val': 0.22789256370589112, 'psi': 0.9187144110288924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.931395 (no previous merge yet)
[S7] round=53 local utility u=1.000000 metrics={'f1_val': 0.9643952717928643, 'auprc': 0.9774299744978527, 'loss_val': 0.1695377745488326, 'psi': 0.9696091528748596}-{'f1_val': 0.6408435210059853, 'auprc': 0.799909436066856, 'loss_val': 0.57445734639839, 'psi': 0.7044698870303336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=53 head_norm_before_train=1.859785 cos_to_last_merge=0.9838 (last merge round=39)
[S8] round=53 local utility u=0.024334 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9956348327751294, 'loss_val': 0.033604701872390404, 'psi': 0.9941624191873311}-{'f1_val': 0.9860892612913941, 'auprc': 0.9990157806004465, 'loss_val': 0.049867242753515, 'psi': 0.9912598690150151}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=53 head_norm_before_train=2.053525 cos_to_last_merge=0.9631 (last merge round=34)
[S9] round=53 local utility u=0.009649 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9969162456032794, 'loss_val': 0.02081315562262505, 'psi': 0.9966297909680835}-{'f1_val': 0.9937421749897083, 'auprc': 0.9981232844948286, 'loss_val': 0.027552492818828697, 'psi': 0.9954946187917564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=53 head_norm_before_train=2.133561 cos_to_last_merge=0.9977 (last merge round=40)
[S10] round=53 local utility u=0.001603 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9979731226896992, 'loss_val': 0.029683029755271418, 'psi': 0.9959067131549163}-{'f1_val': 0.993871046050545, 'auprc': 0.9982715929690615, 'loss_val': 0.02983659976219285, 'psi': 0.9956312648179516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=53 head_norm_before_train=1.833090 cos_to_last_merge=0.9960 (last merge round=38)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9946271333047509, 'auprc': 0.9986059130137026, 'loss_val': 0.03316060047358092, 'psi': 0.9962186451883316}-{'f1_val': 0.9961135349310292, 'auprc': 0.998410201213666, 'loss_val': 0.024380910493446827, 'psi': 0.9970322014440838}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.937722 cos_to_last_merge=0.9968 (last merge round=37)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6191065100179394, 'auprc': 0.756872490917057, 'loss_val': 0.9493640470392093, 'psi': 0.6742129023775865}-{'f1_val': 0.6320236071567803, 'auprc': 0.790130091725228, 'loss_val': 1.0107583256614534, 'psi': 0.6952662009841594}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=2.056180 cos_to_last_merge=0.9922 (last merge round=37)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969669607682428, 'loss_val': 0.026305271533522252, 'psi': 0.9968532488787589}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986615909130415, 'loss_val': 0.026191995225648593, 'psi': 0.9974169753316668}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=2.137456 (no previous merge yet)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7729606016560958, 'auprc': 0.9902510438674805, 'loss_val': 0.4777741420084137, 'psi': 0.8598767785406497}-{'f1_val': 0.9963755136436562, 'auprc': 0.9953340671349554, 'loss_val': 0.024992787657621744, 'psi': 0.9959589350401759}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=2.165851 cos_to_last_merge=0.9981 (last merge round=38)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8337579793642821, 'auprc': 0.9817376232941926, 'loss_val': 0.5964146264541533, 'psi': 0.8929498369362463}-{'f1_val': 0.9108566600588045, 'auprc': 0.9766403546680908, 'loss_val': 0.2061398960263315, 'psi': 0.937170137902519}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.797310 cos_to_last_merge=0.9905 (last merge round=40)
[S17] round=53 local utility u=0.243886 metrics={'f1_val': 0.5977610625102365, 'auprc': 0.9727115563598783, 'loss_val': 1.1019113084653531, 'psi': 0.7477412600500932}-{'f1_val': 0.6066968713563385, 'auprc': 0.7632026190630617, 'loss_val': 1.0147710153668659, 'psi': 0.6692991704390279}
[S17] not sending this round → trigger blocked (psi=0.748)
[S2] START round=54 head_norm_before_train=1.829950 cos_to_last_merge=0.7700 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.8316552735528705, 'auprc': 0.9044879104581043, 'loss_val': 0.3930990904878633, 'psi': 0.860788328314964}-{'f1_val': 0.8273997510718984, 'auprc': 0.9903528486683708, 'loss_val': 0.40400798318261644, 'psi': 0.8925809901104874}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=1.979307 cos_to_last_merge=0.9969 (last merge round=38)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.7404552296224993, 'auprc': 0.9357445870059644, 'loss_val': 0.7908144838996589, 'psi': 0.8185709725758854}-{'f1_val': 0.9807576278248005, 'auprc': 0.9987100457019773, 'loss_val': 0.07011836178245386, 'psi': 0.9879385949756712}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=2.018887 cos_to_last_merge=0.9980 (last merge round=39)
[S4] round=54 local utility u=0.014354 metrics={'f1_val': 0.9443704628157817, 'auprc': 0.9554800441926965, 'loss_val': 0.32422854687387936, 'psi': 0.9488142953665477}-{'f1_val': 0.9418108237307232, 'auprc': 0.954178304835482, 'loss_val': 0.33367361248632793, 'psi': 0.9467578161726268}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=54 head_norm_before_train=2.170574 cos_to_last_merge=0.9981 (last merge round=38)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9966264776874995, 'loss_val': 0.017121360431160332, 'psi': 0.9968923262416384}-{'f1_val': 0.9974365845193254, 'auprc': 0.9995451656816944, 'loss_val': 0.019975177551560152, 'psi': 0.998280016984273}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.773831 cos_to_last_merge=0.9968 (last merge round=37)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.867462078939983, 'auprc': 0.9671907833074117, 'loss_val': 0.32920854314740466, 'psi': 0.9073535606869544}-{'f1_val': 0.5990360003297381, 'auprc': 0.9346331220270174, 'loss_val': 0.9947189588707532, 'psi': 0.7332748490086498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=54 head_norm_before_train=1.936807 (no previous merge yet)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6494617375823578, 'auprc': 0.8071353369430387, 'loss_val': 0.4959431119152512, 'psi': 0.7125311773266302}-{'f1_val': 0.9643952717928643, 'auprc': 0.9774299744978527, 'loss_val': 0.1695377745488326, 'psi': 0.9696091528748596}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.867820 cos_to_last_merge=0.9834 (last merge round=39)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9992385453418031, 'loss_val': 0.04026400200889715, 'psi': 0.9934889521931498}-{'f1_val': 0.9931808101287989, 'auprc': 0.9956348327751294, 'loss_val': 0.033604701872390404, 'psi': 0.9941624191873311}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.060447 cos_to_last_merge=0.9623 (last merge round=34)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9965589926533402, 'loss_val': 0.023432066848448688, 'psi': 0.9954876514578821}-{'f1_val': 0.9964388212112862, 'auprc': 0.9969162456032794, 'loss_val': 0.02081315562262505, 'psi': 0.9966297909680835}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=2.141551 cos_to_last_merge=0.9974 (last merge round=40)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9951308449077813, 'loss_val': 0.031954533724197653, 'psi': 0.9950332498821581}-{'f1_val': 0.9945291067983943, 'auprc': 0.9979731226896992, 'loss_val': 0.029683029755271418, 'psi': 0.9959067131549163}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.840963 cos_to_last_merge=0.9956 (last merge round=38)
[S11] round=54 local utility u=0.009705 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986224709005297, 'loss_val': 0.02534379238840618, 'psi': 0.9973795413572702}-{'f1_val': 0.9946271333047509, 'auprc': 0.9986059130137026, 'loss_val': 0.03316060047358092, 'psi': 0.9962186451883316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=54 head_norm_before_train=1.941895 cos_to_last_merge=0.9963 (last merge round=37)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.6108528232685377, 'auprc': 0.7696743062555296, 'loss_val': 1.1916200442733602, 'psi': 0.6743814164633345}-{'f1_val': 0.6191065100179394, 'auprc': 0.756872490917057, 'loss_val': 0.9493640470392093, 'psi': 0.6742129023775865}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.063578 cos_to_last_merge=0.9918 (last merge round=37)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9969629216772892, 'loss_val': 0.026495307765283055, 'psi': 0.9966054675343063}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969669607682428, 'loss_val': 0.026305271533522252, 'psi': 0.9968532488787589}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.146334 (no previous merge yet)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.7034001770598011, 'auprc': 0.9750242618923654, 'loss_val': 0.5799455031718002, 'psi': 0.8120498109928268}-{'f1_val': 0.7729606016560958, 'auprc': 0.9902510438674805, 'loss_val': 0.4777741420084137, 'psi': 0.8598767785406497}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=2.174646 cos_to_last_merge=0.9979 (last merge round=38)
[S16] round=54 local utility u=0.764780 metrics={'f1_val': 0.9919283421098847, 'auprc': 0.990997966128085, 'loss_val': 0.04365724959527168, 'psi': 0.9915561917171647}-{'f1_val': 0.8337579793642821, 'auprc': 0.9817376232941926, 'loss_val': 0.5964146264541533, 'psi': 0.8929498369362463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=54 head_norm_before_train=1.803334 cos_to_last_merge=0.9899 (last merge round=40)
[S17] round=54 local utility u=0.055756 metrics={'f1_val': 0.6153268174001815, 'auprc': 0.9723609746232011, 'loss_val': 1.094742742110962, 'psi': 0.7581404802893894}-{'f1_val': 0.5977610625102365, 'auprc': 0.9727115563598783, 'loss_val': 1.1019113084653531, 'psi': 0.7477412600500932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=55 head_norm_before_train=1.837908 cos_to_last_merge=0.7693 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.769
[S2] round=55 local utility u=0.106734 metrics={'f1_val': 0.8273997510718984, 'auprc': 0.991186105017997, 'loss_val': 0.4141933767686123, 'psi': 0.892914292650338}-{'f1_val': 0.8316552735528705, 'auprc': 0.9044879104581043, 'loss_val': 0.3930990904878633, 'psi': 0.860788328314964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=55 head_norm_before_train=1.986821 cos_to_last_merge=0.9967 (last merge round=38)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.6184065048421953, 'auprc': 0.8394133014398029, 'loss_val': 1.4424881055074839, 'psi': 0.7068092234812383}-{'f1_val': 0.7404552296224993, 'auprc': 0.9357445870059644, 'loss_val': 0.7908144838996589, 'psi': 0.8185709725758854}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=2.025217 cos_to_last_merge=0.9978 (last merge round=39)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9425454111020608, 'auprc': 0.9526466380687363, 'loss_val': 0.32714680755821285, 'psi': 0.946585901888731}-{'f1_val': 0.9443704628157817, 'auprc': 0.9554800441926965, 'loss_val': 0.32422854687387936, 'psi': 0.9488142953665477}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=2.176491 cos_to_last_merge=0.9979 (last merge round=38)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9937605188652956, 'loss_val': 0.01788219600498341, 'psi': 0.9957459427127568}-{'f1_val': 0.9970695586110643, 'auprc': 0.9966264776874995, 'loss_val': 0.017121360431160332, 'psi': 0.9968923262416384}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.779230 cos_to_last_merge=0.9964 (last merge round=37)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.8577909939654429, 'auprc': 0.9661811317585555, 'loss_val': 0.30852425035913694, 'psi': 0.901147049082688}-{'f1_val': 0.867462078939983, 'auprc': 0.9671907833074117, 'loss_val': 0.32920854314740466, 'psi': 0.9073535606869544}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.940928 (no previous merge yet)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5377892026577067, 'auprc': 0.7671900665155507, 'loss_val': 1.4389820611730122, 'psi': 0.6295495482008442}-{'f1_val': 0.6494617375823578, 'auprc': 0.8071353369430387, 'loss_val': 0.4959431119152512, 'psi': 0.7125311773266302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.876263 cos_to_last_merge=0.9829 (last merge round=39)
[S8] round=55 local utility u=0.010354 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9990860002513571, 'loss_val': 0.03420830408360756, 'psi': 0.9949389443186099}-{'f1_val': 0.9896558900940475, 'auprc': 0.9992385453418031, 'loss_val': 0.04026400200889715, 'psi': 0.9934889521931498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=55 head_norm_before_train=2.067548 cos_to_last_merge=0.9615 (last merge round=34)
[S9] round=55 local utility u=0.003585 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9949036852011314, 'loss_val': 0.020156419349407075, 'psi': 0.9957115309480191}-{'f1_val': 0.9947734239942433, 'auprc': 0.9965589926533402, 'loss_val': 0.023432066848448688, 'psi': 0.9954876514578821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=55 head_norm_before_train=2.148492 cos_to_last_merge=0.9973 (last merge round=40)
[S10] round=55 local utility u=0.005480 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9980983426694618, 'loss_val': 0.028580360940408247, 'psi': 0.9960885025994082}-{'f1_val': 0.9949681865317428, 'auprc': 0.9951308449077813, 'loss_val': 0.031954533724197653, 'psi': 0.9950332498821581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=55 head_norm_before_train=1.849693 cos_to_last_merge=0.9953 (last merge round=38)
[S11] round=55 local utility u=0.000795 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998688812773332, 'loss_val': 0.023952275663344864, 'psi': 0.9974060781063911}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986224709005297, 'loss_val': 0.02534379238840618, 'psi': 0.9973795413572702}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=55 head_norm_before_train=1.947376 cos_to_last_merge=0.9961 (last merge round=37)
[S13] round=55 local utility u=0.493564 metrics={'f1_val': 0.667677194447703, 'auprc': 0.7880404675638053, 'loss_val': 0.600537674360372, 'psi': 0.7158225036941439}-{'f1_val': 0.6108528232685377, 'auprc': 0.7696743062555296, 'loss_val': 1.1916200442733602, 'psi': 0.6743814164633345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=55 head_norm_before_train=2.073338 cos_to_last_merge=0.9914 (last merge round=37)
[S14] round=55 local utility u=0.002021 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9972999947182059, 'loss_val': 0.032179363877500235, 'psi': 0.9976117086676134}-{'f1_val': 0.9963671647723179, 'auprc': 0.9969629216772892, 'loss_val': 0.026495307765283055, 'psi': 0.9966054675343063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=55 head_norm_before_train=2.154886 (no previous merge yet)
[S15] round=55 local utility u=1.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9921057661465181, 'loss_val': 0.02531225910675789, 'psi': 0.994667614644801}-{'f1_val': 0.7034001770598011, 'auprc': 0.9750242618923654, 'loss_val': 0.5799455031718002, 'psi': 0.8120498109928268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=55 head_norm_before_train=2.183422 cos_to_last_merge=0.9977 (last merge round=38)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9411415436741516, 'auprc': 0.9829502451727377, 'loss_val': 0.2660450708845109, 'psi': 0.957865024273586}-{'f1_val': 0.9919283421098847, 'auprc': 0.990997966128085, 'loss_val': 0.04365724959527168, 'psi': 0.9915561917171647}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.810815 cos_to_last_merge=0.9892 (last merge round=40)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.5202199464585586, 'auprc': 0.6835055756210517, 'loss_val': 1.4078243539828132, 'psi': 0.5855341981235558}-{'f1_val': 0.6153268174001815, 'auprc': 0.9723609746232011, 'loss_val': 1.094742742110962, 'psi': 0.7581404802893894}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=1.846002 cos_to_last_merge=0.7684 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.8313571524217215, 'auprc': 0.9284954973266805, 'loss_val': 0.38300673072475716, 'psi': 0.8702124903837051}-{'f1_val': 0.8273997510718984, 'auprc': 0.991186105017997, 'loss_val': 0.4141933767686123, 'psi': 0.892914292650338}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=1.993319 cos_to_last_merge=0.9964 (last merge round=38)
[S3] round=56 local utility u=1.000000 metrics={'f1_val': 0.9612046783862453, 'auprc': 0.9985387656078898, 'loss_val': 0.10420726343399249, 'psi': 0.9761383132749031}-{'f1_val': 0.6184065048421953, 'auprc': 0.8394133014398029, 'loss_val': 1.4424881055074839, 'psi': 0.7068092234812383}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=56 head_norm_before_train=2.030102 cos_to_last_merge=0.9977 (last merge round=39)
[S4] round=56 local utility u=0.002975 metrics={'f1_val': 0.9431108111825496, 'auprc': 0.9531038181003046, 'loss_val': 0.32595981441919336, 'psi': 0.9471080139496517}-{'f1_val': 0.9425454111020608, 'auprc': 0.9526466380687363, 'loss_val': 0.32714680755821285, 'psi': 0.946585901888731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=56 head_norm_before_train=2.185744 cos_to_last_merge=0.9977 (last merge round=38)
[S5] round=56 local utility u=0.003072 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992918431288978, 'loss_val': 0.030534934969473244, 'psi': 0.9981786879631545}-{'f1_val': 0.9970695586110643, 'auprc': 0.9937605188652956, 'loss_val': 0.01788219600498341, 'psi': 0.9957459427127568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=56 head_norm_before_train=1.786846 cos_to_last_merge=0.9963 (last merge round=37)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.6853852589324787, 'auprc': 0.9558396433157007, 'loss_val': 0.6788698054496101, 'psi': 0.7935670126857675}-{'f1_val': 0.8577909939654429, 'auprc': 0.9661811317585555, 'loss_val': 0.30852425035913694, 'psi': 0.901147049082688}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.945704 (no previous merge yet)
[S7] round=56 local utility u=0.921999 metrics={'f1_val': 0.6712178524451555, 'auprc': 0.8063177995385807, 'loss_val': 0.5129395099679607, 'psi': 0.7252578312825256}-{'f1_val': 0.5377892026577067, 'auprc': 0.7671900665155507, 'loss_val': 1.4389820611730122, 'psi': 0.6295495482008442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=56 head_norm_before_train=1.883766 cos_to_last_merge=0.9823 (last merge round=39)
[S8] round=56 local utility u=0.002942 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9988812907010146, 'loss_val': 0.03202703248697335, 'psi': 0.9952888397593751}-{'f1_val': 0.992174240363445, 'auprc': 0.9990860002513571, 'loss_val': 0.03420830408360756, 'psi': 0.9949389443186099}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=56 head_norm_before_train=2.074984 cos_to_last_merge=0.9607 (last merge round=34)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9984514398843682, 'loss_val': 0.02453047221751893, 'psi': 0.9961270846493141}-{'f1_val': 0.9962500947792776, 'auprc': 0.9949036852011314, 'loss_val': 0.020156419349407075, 'psi': 0.9957115309480191}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.155720 cos_to_last_merge=0.9970 (last merge round=40)
[S10] round=56 local utility u=0.002357 metrics={'f1_val': 0.9949436619942489, 'auprc': 0.998633997854146, 'loss_val': 0.026644610796157348, 'psi': 0.9964197963382078}-{'f1_val': 0.9947486092193725, 'auprc': 0.9980983426694618, 'loss_val': 0.028580360940408247, 'psi': 0.9960885025994082}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=56 head_norm_before_train=1.857783 cos_to_last_merge=0.9949 (last merge round=38)
[S11] round=56 local utility u=0.000253 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985365227393155, 'loss_val': 0.022988732565145137, 'psi': 0.9973451620927846}-{'f1_val': 0.9965509216617638, 'auprc': 0.998688812773332, 'loss_val': 0.023952275663344864, 'psi': 0.9974060781063911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=56 head_norm_before_train=1.950430 cos_to_last_merge=0.9961 (last merge round=37)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6170760553359118, 'auprc': 0.7821905331594868, 'loss_val': 1.0970746378695138, 'psi': 0.6831218464653419}-{'f1_val': 0.667677194447703, 'auprc': 0.7880404675638053, 'loss_val': 0.600537674360372, 'psi': 0.7158225036941439}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=2.083240 cos_to_last_merge=0.9910 (last merge round=37)
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9966189199929325, 'auprc': 0.9986282763947569, 'loss_val': 0.04167232452323367, 'psi': 0.9974226625536622}-{'f1_val': 0.9978195179672185, 'auprc': 0.9972999947182059, 'loss_val': 0.032179363877500235, 'psi': 0.9976117086676134}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=2.162387 (no previous merge yet)
[S15] round=56 local utility u=0.009290 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9965471648360911, 'loss_val': 0.02228309630055234, 'psi': 0.9966668669669487}-{'f1_val': 0.9963755136436562, 'auprc': 0.9921057661465181, 'loss_val': 0.02531225910675789, 'psi': 0.994667614644801}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=56 head_norm_before_train=2.192898 cos_to_last_merge=0.9975 (last merge round=38)
[S16] round=56 local utility u=0.268636 metrics={'f1_val': 0.9908439077793931, 'auprc': 0.9902943768738415, 'loss_val': 0.049020355497387876, 'psi': 0.9906240954171724}-{'f1_val': 0.9411415436741516, 'auprc': 0.9829502451727377, 'loss_val': 0.2660450708845109, 'psi': 0.957865024273586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=56 head_norm_before_train=1.818861 cos_to_last_merge=0.9885 (last merge round=40)
[S17] round=56 local utility u=0.549683 metrics={'f1_val': 0.6052052931742972, 'auprc': 0.8014117921900902, 'loss_val': 1.1720897389111962, 'psi': 0.6836878927806144}-{'f1_val': 0.5202199464585586, 'auprc': 0.6835055756210517, 'loss_val': 1.4078243539828132, 'psi': 0.5855341981235558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=57 head_norm_before_train=1.852689 cos_to_last_merge=0.7674 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=57 local utility u=0.059080 metrics={'f1_val': 0.8272944784409078, 'auprc': 0.9915767041520995, 'loss_val': 0.42971481107481924, 'psi': 0.8930073687253844}-{'f1_val': 0.8313571524217215, 'auprc': 0.9284954973266805, 'loss_val': 0.38300673072475716, 'psi': 0.8702124903837051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=57 head_norm_before_train=2.000226 cos_to_last_merge=0.9962 (last merge round=38)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9960113957744239, 'loss_val': 0.14255691412627608, 'psi': 0.9750020107894712}-{'f1_val': 0.9612046783862453, 'auprc': 0.9985387656078898, 'loss_val': 0.10420726343399249, 'psi': 0.9761383132749031}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=2.036454 cos_to_last_merge=0.9976 (last merge round=39)
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9421204421746622, 'auprc': 0.9513811804781753, 'loss_val': 0.3323769580620842, 'psi': 0.9458247374960673}-{'f1_val': 0.9431108111825496, 'auprc': 0.9531038181003046, 'loss_val': 0.32595981441919336, 'psi': 0.9471080139496517}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=2.196155 cos_to_last_merge=0.9974 (last merge round=38)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9956730753327265, 'loss_val': 0.017692899217081896, 'psi': 0.9965109652997293}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992918431288978, 'loss_val': 0.030534934969473244, 'psi': 0.9981786879631545}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=1.797734 cos_to_last_merge=0.9963 (last merge round=37)
[S6] round=57 local utility u=0.363822 metrics={'f1_val': 0.7837262822106541, 'auprc': 0.9571861359841713, 'loss_val': 0.5453104811300096, 'psi': 0.853110223720061}-{'f1_val': 0.6853852589324787, 'auprc': 0.9558396433157007, 'loss_val': 0.6788698054496101, 'psi': 0.7935670126857675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=57 head_norm_before_train=1.945772 (no previous merge yet)
[S7] round=57 local utility u=1.000000 metrics={'f1_val': 0.9785049079862065, 'auprc': 0.9902397027380349, 'loss_val': 0.14378070111001562, 'psi': 0.9831988258869379}-{'f1_val': 0.6712178524451555, 'auprc': 0.8063177995385807, 'loss_val': 0.5129395099679607, 'psi': 0.7252578312825256}
[S7] not sending this round → trigger blocked (psi=0.983)
[S8] START round=57 head_norm_before_train=1.891443 cos_to_last_merge=0.9818 (last merge round=39)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9990845671889175, 'loss_val': 0.036979325563928814, 'psi': 0.9942854565210079}-{'f1_val': 0.9928938724649488, 'auprc': 0.9988812907010146, 'loss_val': 0.03202703248697335, 'psi': 0.9952888397593751}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.082825 cos_to_last_merge=0.9599 (last merge round=34)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9984819809529681, 'loss_val': 0.042691505069595785, 'psi': 0.9931058594520134}-{'f1_val': 0.9945775144926113, 'auprc': 0.9984514398843682, 'loss_val': 0.02453047221751893, 'psi': 0.9961270846493141}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.163079 cos_to_last_merge=0.9968 (last merge round=40)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.998221948894255, 'loss_val': 0.027501649778850366, 'psi': 0.9961379450893255}-{'f1_val': 0.9949436619942489, 'auprc': 0.998633997854146, 'loss_val': 0.026644610796157348, 'psi': 0.9964197963382078}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=1.864630 cos_to_last_merge=0.9947 (last merge round=38)
[S11] round=57 local utility u=0.000193 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985317446249623, 'loss_val': 0.022588390619028082, 'psi': 0.9973432508470432}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985365227393155, 'loss_val': 0.022988732565145137, 'psi': 0.9973451620927846}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=57 head_norm_before_train=1.953984 cos_to_last_merge=0.9960 (last merge round=37)
[S13] round=57 local utility u=0.153093 metrics={'f1_val': 0.6447977172805092, 'auprc': 0.7859551242943784, 'loss_val': 0.968511405628427, 'psi': 0.7012606800860569}-{'f1_val': 0.6170760553359118, 'auprc': 0.7821905331594868, 'loss_val': 1.0970746378695138, 'psi': 0.6831218464653419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=57 head_norm_before_train=2.089140 cos_to_last_merge=0.9904 (last merge round=37)
[S14] round=57 local utility u=0.006625 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969617576015528, 'loss_val': 0.02437376764299665, 'psi': 0.9968511676120828}-{'f1_val': 0.9966189199929325, 'auprc': 0.9986282763947569, 'loss_val': 0.04167232452323367, 'psi': 0.9974226625536622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=57 head_norm_before_train=2.170060 (no previous merge yet)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.9185934960175622, 'loss_val': 0.6838646662151062, 'psi': 0.7879882466681989}-{'f1_val': 0.9967466683875206, 'auprc': 0.9965471648360911, 'loss_val': 0.02228309630055234, 'psi': 0.9966668669669487}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.202728 cos_to_last_merge=0.9972 (last merge round=38)
[S16] round=57 local utility u=0.005252 metrics={'f1_val': 0.9908866466614469, 'auprc': 0.9918490581360772, 'loss_val': 0.04343632989755485, 'psi': 0.991271611251299}-{'f1_val': 0.9908439077793931, 'auprc': 0.9902943768738415, 'loss_val': 0.049020355497387876, 'psi': 0.9906240954171724}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=57 head_norm_before_train=1.826436 cos_to_last_merge=0.9878 (last merge round=40)
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.6044871018498942, 'auprc': 0.7820732993639664, 'loss_val': 1.2162775740066796, 'psi': 0.675521580855523}-{'f1_val': 0.6052052931742972, 'auprc': 0.8014117921900902, 'loss_val': 1.1720897389111962, 'psi': 0.6836878927806144}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=1.861617 cos_to_last_merge=0.7666 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.8150728042225112, 'auprc': 0.8862060931537104, 'loss_val': 0.40577084301857147, 'psi': 0.8435261197949908}-{'f1_val': 0.8272944784409078, 'auprc': 0.9915767041520995, 'loss_val': 0.42971481107481924, 'psi': 0.8930073687253844}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.008837 cos_to_last_merge=0.9959 (last merge round=38)
[S3] round=58 local utility u=0.001518 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9963436240079458, 'loss_val': 0.14051836889779087, 'psi': 0.97513490208288}-{'f1_val': 0.960995754132836, 'auprc': 0.9960113957744239, 'loss_val': 0.14255691412627608, 'psi': 0.9750020107894712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=58 head_norm_before_train=2.042663 cos_to_last_merge=0.9974 (last merge round=39)
[S4] round=58 local utility u=0.021252 metrics={'f1_val': 0.9465346680131249, 'auprc': 0.9546757312532435, 'loss_val': 0.3262420601623082, 'psi': 0.9497910933091722}-{'f1_val': 0.9421204421746622, 'auprc': 0.9513811804781753, 'loss_val': 0.3323769580620842, 'psi': 0.9458247374960673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=58 head_norm_before_train=2.190807 cos_to_last_merge=0.9972 (last merge round=38)
[S5] round=58 local utility u=0.004608 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9985265380167492, 'loss_val': 0.01924037728793027, 'psi': 0.997872565918295}-{'f1_val': 0.9970695586110643, 'auprc': 0.9956730753327265, 'loss_val': 0.017692899217081896, 'psi': 0.9965109652997293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=58 head_norm_before_train=1.805866 cos_to_last_merge=0.9961 (last merge round=37)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.694455875528586, 'auprc': 0.9355449537030607, 'loss_val': 0.7585945362393038, 'psi': 0.7908915067983759}-{'f1_val': 0.7837262822106541, 'auprc': 0.9571861359841713, 'loss_val': 0.5453104811300096, 'psi': 0.853110223720061}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.947530 (no previous merge yet)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5862850734234604, 'auprc': 0.7828414496311099, 'loss_val': 0.8578743007212755, 'psi': 0.6649076239065201}-{'f1_val': 0.9785049079862065, 'auprc': 0.9902397027380349, 'loss_val': 0.14378070111001562, 'psi': 0.9831988258869379}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.898884 cos_to_last_merge=0.9814 (last merge round=39)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9857354242324556, 'auprc': 0.9990428313657872, 'loss_val': 0.047389807982972765, 'psi': 0.9910583870857883}-{'f1_val': 0.9910860494090681, 'auprc': 0.9990845671889175, 'loss_val': 0.036979325563928814, 'psi': 0.9942854565210079}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.092234 cos_to_last_merge=0.9590 (last merge round=34)
[S9] round=58 local utility u=0.032619 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982234637274661, 'loss_val': 0.019510079224483164, 'psi': 0.9972856925793213}-{'f1_val': 0.9895217784513768, 'auprc': 0.9984819809529681, 'loss_val': 0.042691505069595785, 'psi': 0.9931058594520134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=58 head_norm_before_train=2.170286 cos_to_last_merge=0.9966 (last merge round=40)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9964310992489758, 'loss_val': 0.02873196740934681, 'psi': 0.995553351618636}-{'f1_val': 0.9947486092193725, 'auprc': 0.998221948894255, 'loss_val': 0.027501649778850366, 'psi': 0.9961379450893255}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=1.871196 cos_to_last_merge=0.9944 (last merge round=38)
[S11] round=58 local utility u=0.000278 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985853765058793, 'loss_val': 0.022192534719894182, 'psi': 0.9973647035994101}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985317446249623, 'loss_val': 0.022588390619028082, 'psi': 0.9973432508470432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=58 head_norm_before_train=1.956714 cos_to_last_merge=0.9957 (last merge round=37)
[S13] round=58 local utility u=0.026689 metrics={'f1_val': 0.6347411030135022, 'auprc': 0.786956584326012, 'loss_val': 0.8577986125506002, 'psi': 0.6956272955385061}-{'f1_val': 0.6447977172805092, 'auprc': 0.7859551242943784, 'loss_val': 0.968511405628427, 'psi': 0.7012606800860569}
[S13] not sending this round → trigger blocked (psi=0.696)
[S14] START round=58 head_norm_before_train=2.094872 cos_to_last_merge=0.9899 (last merge round=37)
[S14] round=58 local utility u=0.000260 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9969639909260745, 'loss_val': 0.02386128649006945, 'psi': 0.9968520609418916}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969617576015528, 'loss_val': 0.02437376764299665, 'psi': 0.9968511676120828}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=58 head_norm_before_train=2.177489 (no previous merge yet)
[S15] round=58 local utility u=1.000000 metrics={'f1_val': 0.9150884844778551, 'auprc': 0.9951111164256278, 'loss_val': 0.12620053311539917, 'psi': 0.9470975372569641}-{'f1_val': 0.7009180804352899, 'auprc': 0.9185934960175622, 'loss_val': 0.6838646662151062, 'psi': 0.7879882466681989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=58 head_norm_before_train=2.208431 cos_to_last_merge=0.9970 (last merge round=38)
[S16] round=58 local utility u=0.002228 metrics={'f1_val': 0.9917089919190707, 'auprc': 0.9915208734607249, 'loss_val': 0.0429303649181414, 'psi': 0.9916337445357324}-{'f1_val': 0.9908866466614469, 'auprc': 0.9918490581360772, 'loss_val': 0.04343632989755485, 'psi': 0.991271611251299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=58 head_norm_before_train=1.835620 cos_to_last_merge=0.9869 (last merge round=40)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.507861269896424, 'auprc': 0.6566901973097339, 'loss_val': 1.5254023861762527, 'psi': 0.5673928408617479}-{'f1_val': 0.6044871018498942, 'auprc': 0.7820732993639664, 'loss_val': 1.2162775740066796, 'psi': 0.675521580855523}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.870843 cos_to_last_merge=0.7657 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.766
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.763823141205448, 'auprc': 0.8553501825341354, 'loss_val': 0.5987675792952514, 'psi': 0.800433957736923}-{'f1_val': 0.8150728042225112, 'auprc': 0.8862060931537104, 'loss_val': 0.40577084301857147, 'psi': 0.8435261197949908}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.800 u=0.0000 p_local=0.0528 f1=0.764 auprc=0.855 bytes=41378
[S3] START round=59 head_norm_before_train=2.017749 cos_to_last_merge=0.9956 (last merge round=38)
[S3] round=59 local utility u=0.024306 metrics={'f1_val': 0.9623846900862575, 'auprc': 0.9972849920872537, 'loss_val': 0.10306335632226758, 'psi': 0.9763448108866559}-{'f1_val': 0.960995754132836, 'auprc': 0.9963436240079458, 'loss_val': 0.14051836889779087, 'psi': 0.97513490208288}
[S3] not sending this round → trigger blocked (psi=0.976)
[S3] r=60 psi=0.976 u=0.0243 p_local=0.1354 f1=0.962 auprc=0.997 bytes=43179
[S4] START round=59 head_norm_before_train=2.048647 cos_to_last_merge=0.9973 (last merge round=39)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9430833019743083, 'auprc': 0.9540237952643047, 'loss_val': 0.32944254591875594, 'psi': 0.9474594992903069}-{'f1_val': 0.9465346680131249, 'auprc': 0.9546757312532435, 'loss_val': 0.3262420601623082, 'psi': 0.9497910933091722}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.947 u=0.0000 p_local=0.0116 f1=0.943 auprc=0.954 bytes=44958
[S5] START round=59 head_norm_before_train=2.198870 cos_to_last_merge=0.9969 (last merge round=38)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.998026524068039, 'loss_val': 0.017626856182157664, 'psi': 0.9974523447938543}-{'f1_val': 0.9974365845193254, 'auprc': 0.9985265380167492, 'loss_val': 0.01924037728793027, 'psi': 0.997872565918295}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.997 u=0.0000 p_local=0.0166 f1=0.997 auprc=0.998 bytes=46774
[S6] START round=59 head_norm_before_train=1.815318 cos_to_last_merge=0.9959 (last merge round=37)
[S6] round=59 local utility u=0.477119 metrics={'f1_val': 0.7958649975453436, 'auprc': 0.95618617776143, 'loss_val': 0.4747349106990287, 'psi': 0.8599934696317781}-{'f1_val': 0.694455875528586, 'auprc': 0.9355449537030607, 'loss_val': 0.7585945362393038, 'psi': 0.7908915067983759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=60 psi=0.860 u=0.4771 p_local=0.2877 f1=0.796 auprc=0.956 bytes=50371
[S7] START round=59 head_norm_before_train=1.950801 (no previous merge yet)
[S7] round=59 local utility u=1.000000 metrics={'f1_val': 0.819687457245228, 'auprc': 0.9747636041000414, 'loss_val': 0.17516653993152323, 'psi': 0.8817179159871533}-{'f1_val': 0.5862850734234604, 'auprc': 0.7828414496311099, 'loss_val': 0.8578743007212755, 'psi': 0.6649076239065201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=60 psi=0.882 u=1.0000 p_local=0.5285 f1=0.820 auprc=0.975 bytes=46788
[S8] START round=59 head_norm_before_train=1.906389 cos_to_last_merge=0.9810 (last merge round=39)
[S8] round=59 local utility u=0.013706 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9880629081338926, 'loss_val': 0.03942810262903662, 'psi': 0.9919054844349942}-{'f1_val': 0.9857354242324556, 'auprc': 0.9990428313657872, 'loss_val': 0.047389807982972765, 'psi': 0.9910583870857883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S8] r=60 psi=0.992 u=0.0137 p_local=0.0122 f1=0.994 auprc=0.988 bytes=43204
[S9] START round=59 head_norm_before_train=2.101814 cos_to_last_merge=0.9581 (last merge round=34)
[S9] round=59 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9964063459874191, 'loss_val': 0.0197110582138514, 'psi': 0.9966740896503219}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982234637274661, 'loss_val': 0.019510079224483164, 'psi': 0.9972856925793213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=60 psi=0.997 u=0.0000 p_local=0.0065 f1=0.997 auprc=0.996 bytes=43239
[S10] START round=59 head_norm_before_train=2.175608 cos_to_last_merge=0.9964 (last merge round=40)
[S10] round=59 local utility u=0.000165 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9963650893091571, 'loss_val': 0.02820418629744567, 'psi': 0.9955269476427085}-{'f1_val': 0.9949681865317428, 'auprc': 0.9964310992489758, 'loss_val': 0.02873196740934681, 'psi': 0.995553351618636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=60 psi=0.996 u=0.0002 p_local=0.0010 f1=0.995 auprc=0.996 bytes=50329
[S11] START round=59 head_norm_before_train=1.877624 cos_to_last_merge=0.9941 (last merge round=38)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986115583311732, 'loss_val': 0.04466543214870216, 'psi': 0.9973751763295277}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985853765058793, 'loss_val': 0.022192534719894182, 'psi': 0.9973647035994101}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0037 f1=0.997 auprc=0.999 bytes=52208
[S13] START round=59 head_norm_before_train=1.956151 cos_to_last_merge=0.9954 (last merge round=37)
[S13] round=59 local utility u=0.225196 metrics={'f1_val': 0.6889806279230876, 'auprc': 0.7861249848814098, 'loss_val': 0.7303487070637957, 'psi': 0.7278383707064164}-{'f1_val': 0.6347411030135022, 'auprc': 0.786956584326012, 'loss_val': 0.8577986125506002, 'psi': 0.6956272955385061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=60 psi=0.728 u=0.2252 p_local=0.1264 f1=0.689 auprc=0.786 bytes=43183
[S14] START round=59 head_norm_before_train=2.098650 cos_to_last_merge=0.9897 (last merge round=37)
[S14] round=59 local utility u=0.001961 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9988672488531732, 'loss_val': 0.02969399187269231, 'psi': 0.998017827822552}-{'f1_val': 0.9967774409524363, 'auprc': 0.9969639909260745, 'loss_val': 0.02386128649006945, 'psi': 0.9968520609418916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] r=60 psi=0.998 u=0.0020 p_local=0.0018 f1=0.997 auprc=0.999 bytes=44967
[S15] START round=59 head_norm_before_train=2.185061 (no previous merge yet)
[S15] round=59 local utility u=0.299124 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9972188141245857, 'loss_val': 0.02290056716570645, 'psi': 0.9968030930155851}-{'f1_val': 0.9150884844778551, 'auprc': 0.9951111164256278, 'loss_val': 0.12620053311539917, 'psi': 0.9470975372569641}
[S15] not sending this round → trigger blocked (psi=0.997)
[S15] r=60 psi=0.997 u=0.2991 p_local=0.3636 f1=0.997 auprc=0.997 bytes=46763
[S16] START round=59 head_norm_before_train=2.214481 cos_to_last_merge=0.9969 (last merge round=38)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9927567674919364, 'auprc': 0.986320749643597, 'loss_val': 0.042766305386940005, 'psi': 0.9901823603526005}-{'f1_val': 0.9917089919190707, 'auprc': 0.9915208734607249, 'loss_val': 0.0429303649181414, 'psi': 0.9916337445357324}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.990 u=0.0000 p_local=0.1101 f1=0.993 auprc=0.986 bytes=43198
[S17] START round=59 head_norm_before_train=1.844972 cos_to_last_merge=0.9859 (last merge round=40)
[S17] round=59 local utility u=0.609332 metrics={'f1_val': 0.6053414576773284, 'auprc': 0.7611362758471841, 'loss_val': 1.2049587111038356, 'psi': 0.6676593849452707}-{'f1_val': 0.507861269896424, 'auprc': 0.6566901973097339, 'loss_val': 1.5254023861762527, 'psi': 0.5673928408617479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S17] r=60 psi=0.668 u=0.6093 p_local=0.2481 f1=0.605 auprc=0.761 bytes=46783
[S2] START round=60 head_norm_before_train=1.877892 cos_to_last_merge=0.7653 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=60 local utility u=0.310181 metrics={'f1_val': 0.8168966993655078, 'auprc': 0.9174683811454147, 'loss_val': 0.48320241388247376, 'psi': 0.8571253720774705}-{'f1_val': 0.763823141205448, 'auprc': 0.8553501825341354, 'loss_val': 0.5987675792952514, 'psi': 0.800433957736923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=60 head_norm_before_train=2.023635 cos_to_last_merge=0.9953 (last merge round=38)
[S3] round=60 local utility u=0.076996 metrics={'f1_val': 0.9812021963608356, 'auprc': 0.9975524407595493, 'loss_val': 0.06277888380808516, 'psi': 0.9877422941203211}-{'f1_val': 0.9623846900862575, 'auprc': 0.9972849920872537, 'loss_val': 0.10306335632226758, 'psi': 0.9763448108866559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=60 head_norm_before_train=2.053486 cos_to_last_merge=0.9972 (last merge round=39)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9417842178312021, 'auprc': 0.9553448704590044, 'loss_val': 0.332905641538426, 'psi': 0.9472084788823231}-{'f1_val': 0.9430833019743083, 'auprc': 0.9540237952643047, 'loss_val': 0.32944254591875594, 'psi': 0.9474594992903069}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=2.214515 cos_to_last_merge=0.9966 (last merge round=38)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9942610287678815, 'loss_val': 0.016510230807510854, 'psi': 0.9959461466737912}-{'f1_val': 0.9970695586110643, 'auprc': 0.998026524068039, 'loss_val': 0.017626856182157664, 'psi': 0.9974523447938543}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.822741 cos_to_last_merge=0.9957 (last merge round=37)
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.5687131228592451, 'auprc': 0.7726807292324457, 'loss_val': 1.182014873339187, 'psi': 0.6503001654085254}-{'f1_val': 0.7958649975453436, 'auprc': 0.95618617776143, 'loss_val': 0.4747349106990287, 'psi': 0.8599934696317781}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.953321 (no previous merge yet)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.7037449269581658, 'auprc': 0.8603679836875726, 'loss_val': 0.27040262709363405, 'psi': 0.7663941496499286}-{'f1_val': 0.819687457245228, 'auprc': 0.9747636041000414, 'loss_val': 0.17516653993152323, 'psi': 0.8817179159871533}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=1.914140 cos_to_last_merge=0.9806 (last merge round=39)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9743645676724044, 'auprc': 0.9992763193926121, 'loss_val': 0.07386897438251441, 'psi': 0.9843292683604875}-{'f1_val': 0.9944672019690619, 'auprc': 0.9880629081338926, 'loss_val': 0.03942810262903662, 'psi': 0.9919054844349942}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.108330 cos_to_last_merge=0.9574 (last merge round=34)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9959294811926069, 'loss_val': 0.019467840106875623, 'psi': 0.9964833437323971}-{'f1_val': 0.9968525854255906, 'auprc': 0.9964063459874191, 'loss_val': 0.0197110582138514, 'psi': 0.9966740896503219}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.181164 cos_to_last_merge=0.9963 (last merge round=40)
[S10] round=60 local utility u=0.003369 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9986536879547525, 'loss_val': 0.027013837064104387, 'psi': 0.9963106407135245}-{'f1_val': 0.9949681865317428, 'auprc': 0.9963650893091571, 'loss_val': 0.02820418629744567, 'psi': 0.9955269476427085}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=60 head_norm_before_train=1.883693 cos_to_last_merge=0.9939 (last merge round=38)
[S11] round=60 local utility u=0.011333 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9988688619446446, 'loss_val': 0.022771277995113613, 'psi': 0.9974780977749163}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986115583311732, 'loss_val': 0.04466543214870216, 'psi': 0.9973751763295277}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=60 head_norm_before_train=1.959600 cos_to_last_merge=0.9950 (last merge round=37)
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6030180054268155, 'auprc': 0.7746467167597582, 'loss_val': 1.2800409252310645, 'psi': 0.6716694899599925}-{'f1_val': 0.6889806279230876, 'auprc': 0.7861249848814098, 'loss_val': 0.7303487070637957, 'psi': 0.7278383707064164}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=60 head_norm_before_train=2.103714 cos_to_last_merge=0.9894 (last merge round=37)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969397997571552, 'loss_val': 0.023167478467013572, 'psi': 0.9970888411049761}-{'f1_val': 0.9974515471354712, 'auprc': 0.9988672488531732, 'loss_val': 0.02969399187269231, 'psi': 0.998017827822552}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.192398 (no previous merge yet)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9968042255103271, 'loss_val': 0.022488474154380253, 'psi': 0.9966372575698816}-{'f1_val': 0.9965259456095847, 'auprc': 0.9972188141245857, 'loss_val': 0.02290056716570645, 'psi': 0.9968030930155851}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.220463 cos_to_last_merge=0.9967 (last merge round=38)
[S16] round=60 local utility u=0.005273 metrics={'f1_val': 0.9915721878737821, 'auprc': 0.9919090430860436, 'loss_val': 0.0418785165615335, 'psi': 0.9917069299586867}-{'f1_val': 0.9927567674919364, 'auprc': 0.986320749643597, 'loss_val': 0.042766305386940005, 'psi': 0.9901823603526005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=60 head_norm_before_train=1.854192 cos_to_last_merge=0.9847 (last merge round=40)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.5192194504367333, 'auprc': 0.6642096591580252, 'loss_val': 1.5355306175425705, 'psi': 0.57721553392525}-{'f1_val': 0.6053414576773284, 'auprc': 0.7611362758471841, 'loss_val': 1.2049587111038356, 'psi': 0.6676593849452707}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=1.883554 cos_to_last_merge=0.7647 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=61 local utility u=0.161778 metrics={'f1_val': 0.8269976387060285, 'auprc': 0.9884203925517456, 'loss_val': 0.43310856546739324, 'psi': 0.8915667402443154}-{'f1_val': 0.8168966993655078, 'auprc': 0.9174683811454147, 'loss_val': 0.48320241388247376, 'psi': 0.8571253720774705}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=61 head_norm_before_train=2.028886 cos_to_last_merge=0.9950 (last merge round=38)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9958869948605241, 'loss_val': 0.1513773492516057, 'psi': 0.9749522504239113}-{'f1_val': 0.9812021963608356, 'auprc': 0.9975524407595493, 'loss_val': 0.06277888380808516, 'psi': 0.9877422941203211}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=2.056292 cos_to_last_merge=0.9970 (last merge round=39)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9404009060652772, 'auprc': 0.9509182245224186, 'loss_val': 0.3426657930989796, 'psi': 0.9446078334481338}-{'f1_val': 0.9417842178312021, 'auprc': 0.9553448704590044, 'loss_val': 0.332905641538426, 'psi': 0.9472084788823231}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=2.229460 cos_to_last_merge=0.9962 (last merge round=38)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9992167108984711, 'loss_val': 0.039177199257231524, 'psi': 0.9983685133705634}-{'f1_val': 0.9970695586110643, 'auprc': 0.9942610287678815, 'loss_val': 0.016510230807510854, 'psi': 0.9959461466737912}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.831690 cos_to_last_merge=0.9952 (last merge round=37)
[S6] round=61 local utility u=1.000000 metrics={'f1_val': 0.8356809678228564, 'auprc': 0.9530887193902073, 'loss_val': 0.44778890193109355, 'psi': 0.8826440684497968}-{'f1_val': 0.5687131228592451, 'auprc': 0.7726807292324457, 'loss_val': 1.182014873339187, 'psi': 0.6503001654085254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=61 head_norm_before_train=1.950484 (no previous merge yet)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5949744656947802, 'auprc': 0.7777631236734178, 'loss_val': 0.8700963520187497, 'psi': 0.6680899288862352}-{'f1_val': 0.7037449269581658, 'auprc': 0.8603679836875726, 'loss_val': 0.27040262709363405, 'psi': 0.7663941496499286}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.920179 cos_to_last_merge=0.9802 (last merge round=39)
[S8] round=61 local utility u=0.055981 metrics={'f1_val': 0.9878661038880452, 'auprc': 0.9991458161794595, 'loss_val': 0.04252432574554762, 'psi': 0.9923779888046109}-{'f1_val': 0.9743645676724044, 'auprc': 0.9992763193926121, 'loss_val': 0.07386897438251441, 'psi': 0.9843292683604875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=61 head_norm_before_train=2.116095 cos_to_last_merge=0.9566 (last merge round=34)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959897148509952, 'loss_val': 0.01959882336797403, 'psi': 0.9963921930287329}-{'f1_val': 0.9968525854255906, 'auprc': 0.9959294811926069, 'loss_val': 0.019467840106875623, 'psi': 0.9964833437323971}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=2.186632 cos_to_last_merge=0.9961 (last merge round=40)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982363024878541, 'loss_val': 0.02705760489712629, 'psi': 0.9961436865267652}-{'f1_val': 0.9947486092193725, 'auprc': 0.9986536879547525, 'loss_val': 0.027013837064104387, 'psi': 0.9963106407135245}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=61 head_norm_before_train=1.889490 cos_to_last_merge=0.9937 (last merge round=38)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986158089429822, 'loss_val': 0.02219661565157539, 'psi': 0.9973768765742512}-{'f1_val': 0.9965509216617638, 'auprc': 0.9988688619446446, 'loss_val': 0.022771277995113613, 'psi': 0.9974780977749163}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.960761 cos_to_last_merge=0.9949 (last merge round=37)
[S13] round=61 local utility u=0.628436 metrics={'f1_val': 0.7251925351888728, 'auprc': 0.7733838322034969, 'loss_val': 0.7524278916999401, 'psi': 0.7444690539947225}-{'f1_val': 0.6030180054268155, 'auprc': 0.7746467167597582, 'loss_val': 1.2800409252310645, 'psi': 0.6716694899599925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=61 head_norm_before_train=2.106507 cos_to_last_merge=0.9892 (last merge round=37)
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9965574496053289, 'auprc': 0.996960738241824, 'loss_val': 0.023396478272241304, 'psi': 0.996718765059927}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969397997571552, 'loss_val': 0.023167478467013572, 'psi': 0.9970888411049761}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=2.199619 (no previous merge yet)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9059308369774252, 'auprc': 0.9903688812009914, 'loss_val': 0.13620893007887663, 'psi': 0.9397060546668516}-{'f1_val': 0.9965259456095847, 'auprc': 0.9968042255103271, 'loss_val': 0.022488474154380253, 'psi': 0.9966372575698816}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=2.225067 cos_to_last_merge=0.9965 (last merge round=38)
[S16] round=61 local utility u=0.005540 metrics={'f1_val': 0.9920909602081043, 'auprc': 0.9946241697888748, 'loss_val': 0.04205706049958801, 'psi': 0.9931042440404125}-{'f1_val': 0.9915721878737821, 'auprc': 0.9919090430860436, 'loss_val': 0.0418785165615335, 'psi': 0.9917069299586867}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=61 head_norm_before_train=1.864717 cos_to_last_merge=0.9837 (last merge round=40)
[S17] round=61 local utility u=0.483572 metrics={'f1_val': 0.5968059255907044, 'auprc': 0.7503470800256744, 'loss_val': 1.2923167919373235, 'psi': 0.6582223873646924}-{'f1_val': 0.5192194504367333, 'auprc': 0.6642096591580252, 'loss_val': 1.5355306175425705, 'psi': 0.57721553392525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=62 head_norm_before_train=1.891102 cos_to_last_merge=0.7639 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.6619959119599272, 'auprc': 0.8335550026336618, 'loss_val': 1.362885036934002, 'psi': 0.7306195482294211}-{'f1_val': 0.8269976387060285, 'auprc': 0.9884203925517456, 'loss_val': 0.43310856546739324, 'psi': 0.8915667402443154}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.035170 cos_to_last_merge=0.9948 (last merge round=38)
[S3] round=62 local utility u=0.142073 metrics={'f1_val': 0.9880088602545498, 'auprc': 0.997453002368708, 'loss_val': 0.03400714037884634, 'psi': 0.9917865171002131}-{'f1_val': 0.960995754132836, 'auprc': 0.9958869948605241, 'loss_val': 0.1513773492516057, 'psi': 0.9749522504239113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=62 head_norm_before_train=2.056931 cos_to_last_merge=0.9969 (last merge round=39)
[S4] round=62 local utility u=0.062513 metrics={'f1_val': 0.9542878291928363, 'auprc': 0.9582847336506515, 'loss_val': 0.32306177285430915, 'psi': 0.9558865909759624}-{'f1_val': 0.9404009060652772, 'auprc': 0.9509182245224186, 'loss_val': 0.3426657930989796, 'psi': 0.9446078334481338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=62 head_norm_before_train=2.228204 cos_to_last_merge=0.9958 (last merge round=38)
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9991865330199671, 'loss_val': 0.048955495334653536, 'psi': 0.9983564422191618}-{'f1_val': 0.9978030483519582, 'auprc': 0.9992167108984711, 'loss_val': 0.039177199257231524, 'psi': 0.9983685133705634}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=1.837674 cos_to_last_merge=0.9948 (last merge round=37)
[S6] round=62 local utility u=0.279421 metrics={'f1_val': 0.8865779506012995, 'auprc': 0.955374261754552, 'loss_val': 0.20118482888726777, 'psi': 0.9140964750626004}-{'f1_val': 0.8356809678228564, 'auprc': 0.9530887193902073, 'loss_val': 0.44778890193109355, 'psi': 0.8826440684497968}
[S6] not sending this round → trigger blocked (psi=0.914)
[S7] START round=62 head_norm_before_train=1.955898 (no previous merge yet)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.5798682718494296, 'auprc': 0.7795379626835037, 'loss_val': 1.014423701463146, 'psi': 0.6597361481830593}-{'f1_val': 0.5949744656947802, 'auprc': 0.7777631236734178, 'loss_val': 0.8700963520187497, 'psi': 0.6680899288862352}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=1.927152 cos_to_last_merge=0.9796 (last merge round=39)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.8450569188408101, 'auprc': 0.9956315281975572, 'loss_val': 0.32642316385916686, 'psi': 0.9052867625835089}-{'f1_val': 0.9878661038880452, 'auprc': 0.9991458161794595, 'loss_val': 0.04252432574554762, 'psi': 0.9923779888046109}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.120361 cos_to_last_merge=0.9560 (last merge round=34)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9984093446221165, 'loss_val': 0.028433838462614824, 'psi': 0.99510660788725}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959897148509952, 'loss_val': 0.01959882336797403, 'psi': 0.9963921930287329}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.191683 cos_to_last_merge=0.9960 (last merge round=40)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9977864497514688, 'loss_val': 0.027031689408393234, 'psi': 0.995963745432211}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982363024878541, 'loss_val': 0.02705760489712629, 'psi': 0.9961436865267652}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=1.896191 cos_to_last_merge=0.9934 (last merge round=38)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9961135349310292, 'auprc': 0.9981795322281108, 'loss_val': 0.02174304329427183, 'psi': 0.9969399338498618}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986158089429822, 'loss_val': 0.02219661565157539, 'psi': 0.9973768765742512}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.960852 cos_to_last_merge=0.9945 (last merge round=37)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.615109586634466, 'auprc': 0.7832441507088773, 'loss_val': 1.14299961742891, 'psi': 0.6823634122642306}-{'f1_val': 0.7251925351888728, 'auprc': 0.7733838322034969, 'loss_val': 0.7524278916999401, 'psi': 0.7444690539947225}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.111343 cos_to_last_merge=0.9888 (last merge round=37)
[S14] round=62 local utility u=0.001810 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969071715158814, 'loss_val': 0.02225599195996803, 'psi': 0.9969613735009516}-{'f1_val': 0.9965574496053289, 'auprc': 0.996960738241824, 'loss_val': 0.023396478272241304, 'psi': 0.996718765059927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=62 head_norm_before_train=2.206307 (no previous merge yet)
[S15] round=62 local utility u=0.328646 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9918946764191425, 'loss_val': 0.02616212357362954, 'psi': 0.9945831787538508}-{'f1_val': 0.9059308369774252, 'auprc': 0.9903688812009914, 'loss_val': 0.13620893007887663, 'psi': 0.9397060546668516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=62 head_norm_before_train=2.231435 cos_to_last_merge=0.9963 (last merge round=38)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9904391609549015, 'auprc': 0.9948456567840321, 'loss_val': 0.04968979423730683, 'psi': 0.9922017592865537}-{'f1_val': 0.9920909602081043, 'auprc': 0.9946241697888748, 'loss_val': 0.04205706049958801, 'psi': 0.9931042440404125}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.877204 cos_to_last_merge=0.9828 (last merge round=40)
[S17] round=62 local utility u=0.105272 metrics={'f1_val': 0.609904772753214, 'auprc': 0.8037561716452954, 'loss_val': 1.320592389852332, 'psi': 0.6874453323100466}-{'f1_val': 0.5968059255907044, 'auprc': 0.7503470800256744, 'loss_val': 1.2923167919373235, 'psi': 0.6582223873646924}
[S17] not sending this round → trigger blocked (psi=0.687)
[S2] START round=63 head_norm_before_train=1.898905 cos_to_last_merge=0.7631 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=63 local utility u=0.657480 metrics={'f1_val': 0.760053135659092, 'auprc': 0.8520083136056356, 'loss_val': 0.6916279968773246, 'psi': 0.7968352068377094}-{'f1_val': 0.6619959119599272, 'auprc': 0.8335550026336618, 'loss_val': 1.362885036934002, 'psi': 0.7306195482294211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=63 head_norm_before_train=2.042499 cos_to_last_merge=0.9945 (last merge round=38)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.9812021963608356, 'auprc': 0.997266121498767, 'loss_val': 0.06648813642474655, 'psi': 0.9876277664160082}-{'f1_val': 0.9880088602545498, 'auprc': 0.997453002368708, 'loss_val': 0.03400714037884634, 'psi': 0.9917865171002131}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=2.059414 cos_to_last_merge=0.9968 (last merge round=39)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9398249352542829, 'auprc': 0.9538261193395335, 'loss_val': 0.3425532093674459, 'psi': 0.9454254088883832}-{'f1_val': 0.9542878291928363, 'auprc': 0.9582847336506515, 'loss_val': 0.32306177285430915, 'psi': 0.9558865909759624}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=2.227777 cos_to_last_merge=0.9955 (last merge round=38)
[S5] round=63 local utility u=0.011204 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.997792380697291, 'loss_val': 0.020166180550583078, 'psi': 0.9975789029905117}-{'f1_val': 0.9978030483519582, 'auprc': 0.9991865330199671, 'loss_val': 0.048955495334653536, 'psi': 0.9983564422191618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=63 head_norm_before_train=1.843060 cos_to_last_merge=0.9945 (last merge round=37)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.6333897000985447, 'auprc': 0.7277003832986298, 'loss_val': 1.1100474334114974, 'psi': 0.6711139733785787}-{'f1_val': 0.8865779506012995, 'auprc': 0.955374261754552, 'loss_val': 0.20118482888726777, 'psi': 0.9140964750626004}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.963287 (no previous merge yet)
[S7] round=63 local utility u=0.326295 metrics={'f1_val': 0.6231990707992019, 'auprc': 0.7960278834985494, 'loss_val': 0.6712885010843472, 'psi': 0.692330595878941}-{'f1_val': 0.5798682718494296, 'auprc': 0.7795379626835037, 'loss_val': 1.014423701463146, 'psi': 0.6597361481830593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=63 head_norm_before_train=1.932317 cos_to_last_merge=0.9793 (last merge round=39)
[S8] round=63 local utility u=0.584389 metrics={'f1_val': 0.9900154226160678, 'auprc': 0.9990636685779303, 'loss_val': 0.03769341528247646, 'psi': 0.9936347210008127}-{'f1_val': 0.8450569188408101, 'auprc': 0.9956315281975572, 'loss_val': 0.32642316385916686, 'psi': 0.9052867625835089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=63 head_norm_before_train=2.123992 cos_to_last_merge=0.9555 (last merge round=34)
[S9] round=63 local utility u=0.012391 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964136823084381, 'loss_val': 0.020198673152539214, 'psi': 0.9965617800117101}-{'f1_val': 0.992904783397339, 'auprc': 0.9984093446221165, 'loss_val': 0.028433838462614824, 'psi': 0.99510660788725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=63 head_norm_before_train=2.197387 cos_to_last_merge=0.9958 (last merge round=40)
[S10] round=63 local utility u=0.000149 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.997830471808943, 'loss_val': 0.026866362682319147, 'psi': 0.9959813542552007}-{'f1_val': 0.9947486092193725, 'auprc': 0.9977864497514688, 'loss_val': 0.027031689408393234, 'psi': 0.995963745432211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=63 head_norm_before_train=1.903340 cos_to_last_merge=0.9931 (last merge round=38)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9958728184308341, 'auprc': 0.9982128658906624, 'loss_val': 0.02282489393265074, 'psi': 0.9968088374147654}-{'f1_val': 0.9961135349310292, 'auprc': 0.9981795322281108, 'loss_val': 0.02174304329427183, 'psi': 0.9969399338498618}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.964310 cos_to_last_merge=0.9942 (last merge round=37)
[S13] round=63 local utility u=0.041990 metrics={'f1_val': 0.6274579069524975, 'auprc': 0.7880677370590509, 'loss_val': 1.1475797495514024, 'psi': 0.6917018389951188}-{'f1_val': 0.615109586634466, 'auprc': 0.7832441507088773, 'loss_val': 1.14299961742891, 'psi': 0.6823634122642306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=63 head_norm_before_train=2.116211 cos_to_last_merge=0.9883 (last merge round=37)
[S14] round=63 local utility u=0.001279 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.998938066156343, 'loss_val': 0.025789914780219164, 'psi': 0.9977737313571362}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969071715158814, 'loss_val': 0.02225599195996803, 'psi': 0.9969613735009516}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=63 head_norm_before_train=2.212437 (no previous merge yet)
[S15] round=63 local utility u=0.005295 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9947165717362645, 'loss_val': 0.02403796676372477, 'psi': 0.9957119368806995}-{'f1_val': 0.9963755136436562, 'auprc': 0.9918946764191425, 'loss_val': 0.02616212357362954, 'psi': 0.9945831787538508}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=63 head_norm_before_train=2.237951 cos_to_last_merge=0.9961 (last merge round=38)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9877954257563317, 'auprc': 0.9947049091983241, 'loss_val': 0.06301729509146631, 'psi': 0.9905592191331287}-{'f1_val': 0.9904391609549015, 'auprc': 0.9948456567840321, 'loss_val': 0.04968979423730683, 'psi': 0.9922017592865537}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=1.888533 cos_to_last_merge=0.9820 (last merge round=40)
[S17] round=63 local utility u=0.162507 metrics={'f1_val': 0.6293703685372134, 'auprc': 0.843736983563102, 'loss_val': 1.2323142915329826, 'psi': 0.7151170145475688}-{'f1_val': 0.609904772753214, 'auprc': 0.8037561716452954, 'loss_val': 1.320592389852332, 'psi': 0.6874453323100466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S17] sending update (kind=head size=1809 to 1 peers)
[S2] START round=64 head_norm_before_train=1.903509 cos_to_last_merge=0.7621 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=64 local utility u=0.523583 metrics={'f1_val': 0.8179944415640377, 'auprc': 0.9925181845270915, 'loss_val': 0.4136388840462022, 'psi': 0.8878039387492591}-{'f1_val': 0.760053135659092, 'auprc': 0.8520083136056356, 'loss_val': 0.6916279968773246, 'psi': 0.7968352068377094}
[S2] not sending this round → trigger blocked (psi=0.888)
[S3] START round=64 head_norm_before_train=2.049861 cos_to_last_merge=0.9943 (last merge round=38)
[S3] round=64 local utility u=0.015774 metrics={'f1_val': 0.9834726908581045, 'auprc': 0.9976439012284686, 'loss_val': 0.049697138613345834, 'psi': 0.9891411750062502}-{'f1_val': 0.9812021963608356, 'auprc': 0.997266121498767, 'loss_val': 0.06648813642474655, 'psi': 0.9876277664160082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=64 head_norm_before_train=2.062096 cos_to_last_merge=0.9967 (last merge round=39)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9157951106793911, 'auprc': 0.9474481979260738, 'loss_val': 0.4155653699150599, 'psi': 0.9284563455780641}-{'f1_val': 0.9398249352542829, 'auprc': 0.9538261193395335, 'loss_val': 0.3425532093674459, 'psi': 0.9454254088883832}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=2.236069 cos_to_last_merge=0.9953 (last merge round=38)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9970545369277345, 'loss_val': 0.022844054346628798, 'psi': 0.997283765482689}-{'f1_val': 0.9974365845193254, 'auprc': 0.997792380697291, 'loss_val': 0.020166180550583078, 'psi': 0.9975789029905117}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.848769 cos_to_last_merge=0.9940 (last merge round=37)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.4344065484119885, 'auprc': 0.7912805818432906, 'loss_val': 1.302384224508777, 'psi': 0.5771561617845093}-{'f1_val': 0.6333897000985447, 'auprc': 0.7277003832986298, 'loss_val': 1.1100474334114974, 'psi': 0.6711139733785787}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.968802 (no previous merge yet)
[S7] round=64 local utility u=1.000000 metrics={'f1_val': 0.9909427327325815, 'auprc': 0.993657363605329, 'loss_val': 0.15708747753967964, 'psi': 0.9920285850816806}-{'f1_val': 0.6231990707992019, 'auprc': 0.7960278834985494, 'loss_val': 0.6712885010843472, 'psi': 0.692330595878941}
[S7] not sending this round → trigger blocked (psi=0.992)
[S8] START round=64 head_norm_before_train=1.937762 cos_to_last_merge=0.9790 (last merge round=39)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9868857595829291, 'loss_val': 0.038462958611179585, 'psi': 0.9913216081845897}-{'f1_val': 0.9900154226160678, 'auprc': 0.9990636685779303, 'loss_val': 0.03769341528247646, 'psi': 0.9936347210008127}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.129098 cos_to_last_merge=0.9549 (last merge round=34)
[S9] round=64 local utility u=0.002786 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980650230514346, 'loss_val': 0.019580143391129762, 'psi': 0.9972223163089087}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964136823084381, 'loss_val': 0.020198673152539214, 'psi': 0.9965617800117101}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=64 head_norm_before_train=2.203434 cos_to_last_merge=0.9956 (last merge round=40)
[S10] round=64 local utility u=0.000684 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982132879583161, 'loss_val': 0.02664759155060687, 'psi': 0.9961344807149499}-{'f1_val': 0.9947486092193725, 'auprc': 0.997830471808943, 'loss_val': 0.026866362682319147, 'psi': 0.9959813542552007}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=64 head_norm_before_train=1.909356 cos_to_last_merge=0.9928 (last merge round=38)
[S11] round=64 local utility u=0.002553 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981596787974563, 'loss_val': 0.02148309581553218, 'psi': 0.9971799904163616}-{'f1_val': 0.9958728184308341, 'auprc': 0.9982128658906624, 'loss_val': 0.02282489393265074, 'psi': 0.9968088374147654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=64 head_norm_before_train=1.971768 cos_to_last_merge=0.9936 (last merge round=37)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6035961309057286, 'auprc': 0.753323013885063, 'loss_val': 1.2630729341079945, 'psi': 0.6634868840974624}-{'f1_val': 0.6274579069524975, 'auprc': 0.7880677370590509, 'loss_val': 1.1475797495514024, 'psi': 0.6917018389951188}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=2.122444 cos_to_last_merge=0.9878 (last merge round=37)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.996969983568091, 'loss_val': 0.022259314560086004, 'psi': 0.9968562979315196}-{'f1_val': 0.9969975081576651, 'auprc': 0.998938066156343, 'loss_val': 0.025789914780219164, 'psi': 0.9977737313571362}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=2.218473 (no previous merge yet)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9944421141517651, 'loss_val': 0.025841935013155733, 'psi': 0.9956021538468998}-{'f1_val': 0.9963755136436562, 'auprc': 0.9947165717362645, 'loss_val': 0.02403796676372477, 'psi': 0.9957119368806995}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.244023 cos_to_last_merge=0.9959 (last merge round=38)
[S16] round=64 local utility u=0.016065 metrics={'f1_val': 0.9907826329927185, 'auprc': 0.9965389058106242, 'loss_val': 0.05431260808924704, 'psi': 0.9930851421198807}-{'f1_val': 0.9877954257563317, 'auprc': 0.9947049091983241, 'loss_val': 0.06301729509146631, 'psi': 0.9905592191331287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=64 head_norm_before_train=1.899428 cos_to_last_merge=0.9811 (last merge round=40)
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6230649350400528, 'auprc': 0.866010061762347, 'loss_val': 1.2669053174134002, 'psi': 0.7202429857289705}-{'f1_val': 0.6293703685372134, 'auprc': 0.843736983563102, 'loss_val': 1.2323142915329826, 'psi': 0.7151170145475688}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=1.908042 cos_to_last_merge=0.7619 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=65 local utility u=0.060538 metrics={'f1_val': 0.8279831725594904, 'auprc': 0.9901473972478662, 'loss_val': 0.34538231712365225, 'psi': 0.8928488624348407}-{'f1_val': 0.8179944415640377, 'auprc': 0.9925181845270915, 'loss_val': 0.4136388840462022, 'psi': 0.8878039387492591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=65 head_norm_before_train=2.054226 cos_to_last_merge=0.9941 (last merge round=38)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.949619642652807, 'auprc': 0.994439698386296, 'loss_val': 0.17365791651091575, 'psi': 0.9675476649462026}-{'f1_val': 0.9834726908581045, 'auprc': 0.9976439012284686, 'loss_val': 0.049697138613345834, 'psi': 0.9891411750062502}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=2.066855 cos_to_last_merge=0.9966 (last merge round=39)
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.8067634230143146, 'auprc': 0.9465529065068121, 'loss_val': 0.5050735129588936, 'psi': 0.8626792164113136}-{'f1_val': 0.9157951106793911, 'auprc': 0.9474481979260738, 'loss_val': 0.4155653699150599, 'psi': 0.9284563455780641}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=2.241324 cos_to_last_merge=0.9950 (last merge round=38)
[S5] round=65 local utility u=0.000268 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9985456125578884, 'loss_val': 0.02678035498918893, 'psi': 0.9978801957347506}-{'f1_val': 0.9974365845193254, 'auprc': 0.9970545369277345, 'loss_val': 0.022844054346628798, 'psi': 0.997283765482689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=65 head_norm_before_train=1.852650 cos_to_last_merge=0.9936 (last merge round=37)
[S6] round=65 local utility u=1.000000 metrics={'f1_val': 0.7958493527521986, 'auprc': 0.9304270844527709, 'loss_val': 0.6157392222672721, 'psi': 0.8496804454324275}-{'f1_val': 0.4344065484119885, 'auprc': 0.7912805818432906, 'loss_val': 1.302384224508777, 'psi': 0.5771561617845093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=65 head_norm_before_train=1.968875 (no previous merge yet)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.6060418769401898, 'auprc': 0.7953532762340743, 'loss_val': 0.5934807357818918, 'psi': 0.6817664366577436}-{'f1_val': 0.9909427327325815, 'auprc': 0.993657363605329, 'loss_val': 0.15708747753967964, 'psi': 0.9920285850816806}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.945920 cos_to_last_merge=0.9785 (last merge round=39)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.7964082586684771, 'auprc': 0.9957681923813464, 'loss_val': 0.5605248764961669, 'psi': 0.8761522321536248}-{'f1_val': 0.9942788405856967, 'auprc': 0.9868857595829291, 'loss_val': 0.038462958611179585, 'psi': 0.9913216081845897}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=2.133909 cos_to_last_merge=0.9545 (last merge round=34)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965493859351477, 'loss_val': 0.020006075558909237, 'psi': 0.996616061462394}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980650230514346, 'loss_val': 0.019580143391129762, 'psi': 0.9972223163089087}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.209601 cos_to_last_merge=0.9954 (last merge round=40)
[S10] round=65 local utility u=0.000052 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982521403604618, 'loss_val': 0.02666029474563401, 'psi': 0.9961500216758082}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982132879583161, 'loss_val': 0.02664759155060687, 'psi': 0.9961344807149499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=65 head_norm_before_train=1.915983 cos_to_last_merge=0.9925 (last merge round=38)
[S11] round=65 local utility u=0.000062 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9981824062852206, 'loss_val': 0.021427783110666593, 'psi': 0.9971890814114674}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981596787974563, 'loss_val': 0.02148309581553218, 'psi': 0.9971799904163616}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=65 head_norm_before_train=1.980155 cos_to_last_merge=0.9929 (last merge round=37)
[S13] round=65 local utility u=0.693809 metrics={'f1_val': 0.7302465590546117, 'auprc': 0.778701462093607, 'loss_val': 0.711492300743942, 'psi': 0.7496285202702098}-{'f1_val': 0.6035961309057286, 'auprc': 0.753323013885063, 'loss_val': 1.2630729341079945, 'psi': 0.6634868840974624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=65 head_norm_before_train=2.129571 cos_to_last_merge=0.9874 (last merge round=37)
[S14] round=65 local utility u=0.002694 metrics={'f1_val': 0.9968002980424979, 'auprc': 0.9986675815031371, 'loss_val': 0.022082964000694972, 'psi': 0.9975472114267535}-{'f1_val': 0.9967805075071389, 'auprc': 0.996969983568091, 'loss_val': 0.022259314560086004, 'psi': 0.9968562979315196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=65 head_norm_before_train=2.224527 (no previous merge yet)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9871291649828589, 'auprc': 0.9944696423439537, 'loss_val': 0.03989329834583364, 'psi': 0.9900653559272967}-{'f1_val': 0.9963755136436562, 'auprc': 0.9944421141517651, 'loss_val': 0.025841935013155733, 'psi': 0.9956021538468998}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.250889 cos_to_last_merge=0.9957 (last merge round=38)
[S16] round=65 local utility u=0.000680 metrics={'f1_val': 0.9907826329927185, 'auprc': 0.9965769768683567, 'loss_val': 0.053067263379776956, 'psi': 0.9931003705429737}-{'f1_val': 0.9907826329927185, 'auprc': 0.9965389058106242, 'loss_val': 0.05431260808924704, 'psi': 0.9930851421198807}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=65 head_norm_before_train=1.910090 cos_to_last_merge=0.9802 (last merge round=40)
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.573545229594258, 'auprc': 0.7152474190681052, 'loss_val': 1.4715722060523468, 'psi': 0.6302261053837969}-{'f1_val': 0.6230649350400528, 'auprc': 0.866010061762347, 'loss_val': 1.2669053174134002, 'psi': 0.7202429857289705}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.910563 cos_to_last_merge=0.7614 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.827458226951265, 'auprc': 0.9921289720636151, 'loss_val': 0.3653117633529666, 'psi': 0.893326524996205}-{'f1_val': 0.8279831725594904, 'auprc': 0.9901473972478662, 'loss_val': 0.34538231712365225, 'psi': 0.8928488624348407}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.058559 cos_to_last_merge=0.9940 (last merge round=38)
[S3] round=66 local utility u=0.111185 metrics={'f1_val': 0.9719921251615864, 'auprc': 0.9965916335724749, 'loss_val': 0.09197800742160425, 'psi': 0.9818319285259418}-{'f1_val': 0.949619642652807, 'auprc': 0.994439698386296, 'loss_val': 0.17365791651091575, 'psi': 0.9675476649462026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=66 head_norm_before_train=2.072418 cos_to_last_merge=0.9965 (last merge round=39)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.626222505928783, 'auprc': 0.9419911647200339, 'loss_val': 0.807127882790661, 'psi': 0.7525299694452834}-{'f1_val': 0.8067634230143146, 'auprc': 0.9465529065068121, 'loss_val': 0.5050735129588936, 'psi': 0.8626792164113136}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=2.247030 cos_to_last_merge=0.9947 (last merge round=38)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9955675321910517, 'loss_val': 0.028603629819618157, 'psi': 0.996688963588016}-{'f1_val': 0.9974365845193254, 'auprc': 0.9985456125578884, 'loss_val': 0.02678035498918893, 'psi': 0.9978801957347506}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.857149 cos_to_last_merge=0.9935 (last merge round=37)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.7032619680092084, 'auprc': 0.8878563252724827, 'loss_val': 0.7980662507877514, 'psi': 0.7770997109145181}-{'f1_val': 0.7958493527521986, 'auprc': 0.9304270844527709, 'loss_val': 0.6157392222672721, 'psi': 0.8496804454324275}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.970230 (no previous merge yet)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.5950378386401382, 'auprc': 0.786248073044358, 'loss_val': 0.7789167948120876, 'psi': 0.671521932401826}-{'f1_val': 0.6060418769401898, 'auprc': 0.7953532762340743, 'loss_val': 0.5934807357818918, 'psi': 0.6817664366577436}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.950419 cos_to_last_merge=0.9782 (last merge round=39)
[S8] round=66 local utility u=0.856936 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9992466403113126, 'loss_val': 0.03168386784387444, 'psi': 0.995003200342592}-{'f1_val': 0.7964082586684771, 'auprc': 0.9957681923813464, 'loss_val': 0.5605248764961669, 'psi': 0.8761522321536248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] sending update (kind=head size=1807 to 1 peers)
[S9] START round=66 head_norm_before_train=2.139374 cos_to_last_merge=0.9539 (last merge round=34)
[S9] round=66 local utility u=0.003300 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998449944592498, 'loss_val': 0.019108087120655492, 'psi': 0.997376284925334}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965493859351477, 'loss_val': 0.020006075558909237, 'psi': 0.996616061462394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=66 head_norm_before_train=2.215738 cos_to_last_merge=0.9951 (last merge round=40)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9978007831157072, 'loss_val': 0.026744411565590303, 'psi': 0.9959694787779063}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982521403604618, 'loss_val': 0.02666029474563401, 'psi': 0.9961500216758082}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=1.922719 cos_to_last_merge=0.9922 (last merge round=38)
[S11] round=66 local utility u=0.000278 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984333500109466, 'loss_val': 0.021768653239228775, 'psi': 0.997303893001437}-{'f1_val': 0.9965268648289654, 'auprc': 0.9981824062852206, 'loss_val': 0.021427783110666593, 'psi': 0.9971890814114674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=66 head_norm_before_train=1.985272 cos_to_last_merge=0.9925 (last merge round=37)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.596623831186858, 'auprc': 0.7443567387444067, 'loss_val': 1.3539098143714907, 'psi': 0.6557169942098775}-{'f1_val': 0.7302465590546117, 'auprc': 0.778701462093607, 'loss_val': 0.711492300743942, 'psi': 0.7496285202702098}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.136841 cos_to_last_merge=0.9871 (last merge round=37)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9969693691573589, 'loss_val': 0.024212204885885803, 'psi': 0.9971006688650575}-{'f1_val': 0.9968002980424979, 'auprc': 0.9986675815031371, 'loss_val': 0.022082964000694972, 'psi': 0.9975472114267535}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.230519 (no previous merge yet)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9819752611568814, 'auprc': 0.9952082543522721, 'loss_val': 0.04500127947082948, 'psi': 0.9872684584350377}-{'f1_val': 0.9871291649828589, 'auprc': 0.9944696423439537, 'loss_val': 0.03989329834583364, 'psi': 0.9900653559272967}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=2.258010 cos_to_last_merge=0.9955 (last merge round=38)
[S16] round=66 local utility u=0.001579 metrics={'f1_val': 0.991001208262579, 'auprc': 0.9966999235126697, 'loss_val': 0.05158991756468181, 'psi': 0.9932806943626152}-{'f1_val': 0.9907826329927185, 'auprc': 0.9965769768683567, 'loss_val': 0.053067263379776956, 'psi': 0.9931003705429737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=66 head_norm_before_train=1.918010 cos_to_last_merge=0.9794 (last merge round=40)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.4637435087655587, 'auprc': 0.6294991103978097, 'loss_val': 1.791507985019568, 'psi': 0.5300457494184591}-{'f1_val': 0.573545229594258, 'auprc': 0.7152474190681052, 'loss_val': 1.4715722060523468, 'psi': 0.6302261053837969}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=1.915215 cos_to_last_merge=0.7608 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.8289290193375138, 'auprc': 0.9590425921375864, 'loss_val': 0.39544322582982994, 'psi': 0.8809744484575428}-{'f1_val': 0.827458226951265, 'auprc': 0.9921289720636151, 'loss_val': 0.3653117633529666, 'psi': 0.893326524996205}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.063612 cos_to_last_merge=0.9938 (last merge round=38)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.9574934630987351, 'auprc': 0.9930320454880122, 'loss_val': 0.168352051109444, 'psi': 0.971708896054446}-{'f1_val': 0.9719921251615864, 'auprc': 0.9965916335724749, 'loss_val': 0.09197800742160425, 'psi': 0.9818319285259418}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.075552 cos_to_last_merge=0.9962 (last merge round=39)
[S4] round=67 local utility u=0.766016 metrics={'f1_val': 0.8237837675236681, 'auprc': 0.9513282575595582, 'loss_val': 0.4884743903173637, 'psi': 0.8748015635380242}-{'f1_val': 0.626222505928783, 'auprc': 0.9419911647200339, 'loss_val': 0.807127882790661, 'psi': 0.7525299694452834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=67 head_norm_before_train=2.248518 cos_to_last_merge=0.9943 (last merge round=38)
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9937458047718573, 'loss_val': 0.06535570636971967, 'psi': 0.9961801509199179}-{'f1_val': 0.9974365845193254, 'auprc': 0.9955675321910517, 'loss_val': 0.028603629819618157, 'psi': 0.996688963588016}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.865048 cos_to_last_merge=0.9935 (last merge round=37)
[S6] round=67 local utility u=0.323546 metrics={'f1_val': 0.7400348691793153, 'auprc': 0.9501626207894025, 'loss_val': 0.5585297722607393, 'psi': 0.8240859698233503}-{'f1_val': 0.7032619680092084, 'auprc': 0.8878563252724827, 'loss_val': 0.7980662507877514, 'psi': 0.7770997109145181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=67 head_norm_before_train=1.973035 (no previous merge yet)
[S7] round=67 local utility u=1.000000 metrics={'f1_val': 0.9317902078488842, 'auprc': 0.9882484519244623, 'loss_val': 0.1480412367332829, 'psi': 0.9543735054791154}-{'f1_val': 0.5950378386401382, 'auprc': 0.786248073044358, 'loss_val': 0.7789167948120876, 'psi': 0.671521932401826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=67 head_norm_before_train=1.956611 cos_to_last_merge=0.9779 (last merge round=39)
[S8] round=67 local utility u=0.004165 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9992323028758536, 'loss_val': 0.029868458754059517, 'psi': 0.9956533230712654}-{'f1_val': 0.992174240363445, 'auprc': 0.9992466403113126, 'loss_val': 0.03168386784387444, 'psi': 0.995003200342592}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=67 head_norm_before_train=2.142175 cos_to_last_merge=0.9535 (last merge round=34)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9982719824874632, 'loss_val': 0.019359635357488848, 'psi': 0.9973051000833202}-{'f1_val': 0.9966605118138915, 'auprc': 0.998449944592498, 'loss_val': 0.019108087120655492, 'psi': 0.997376284925334}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=2.221769 cos_to_last_merge=0.9949 (last merge round=40)
[S10] round=67 local utility u=0.000356 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9979951139211041, 'loss_val': 0.026615228817887027, 'psi': 0.9960472111000651}-{'f1_val': 0.9947486092193725, 'auprc': 0.9978007831157072, 'loss_val': 0.026744411565590303, 'psi': 0.9959694787779063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=67 head_norm_before_train=1.928721 cos_to_last_merge=0.9919 (last merge round=38)
[S11] round=67 local utility u=0.000633 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998768613504898, 'loss_val': 0.021507917445725708, 'psi': 0.9974379983990176}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984333500109466, 'loss_val': 0.021768653239228775, 'psi': 0.997303893001437}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=67 head_norm_before_train=1.990489 cos_to_last_merge=0.9923 (last merge round=37)
[S13] round=67 local utility u=0.271745 metrics={'f1_val': 0.6220059789329425, 'auprc': 0.7671932344865495, 'loss_val': 1.031222549374839, 'psi': 0.6800808811543853}-{'f1_val': 0.596623831186858, 'auprc': 0.7443567387444067, 'loss_val': 1.3539098143714907, 'psi': 0.6557169942098775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=67 head_norm_before_train=2.137815 cos_to_last_merge=0.9866 (last merge round=37)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.996972120534442, 'loss_val': 0.02275375706986984, 'psi': 0.9968415672059956}-{'f1_val': 0.9971882020035234, 'auprc': 0.9969693691573589, 'loss_val': 0.024212204885885803, 'psi': 0.9971006688650575}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=2.236543 (no previous merge yet)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.7782313208563422, 'auprc': 0.9902228339962751, 'loss_val': 0.4588637880008572, 'psi': 0.8630279261123153}-{'f1_val': 0.9819752611568814, 'auprc': 0.9952082543522721, 'loss_val': 0.04500127947082948, 'psi': 0.9872684584350377}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=2.263479 cos_to_last_merge=0.9953 (last merge round=38)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9320654593502447, 'auprc': 0.9900227994114731, 'loss_val': 0.3688466047501941, 'psi': 0.9552483953747359}-{'f1_val': 0.991001208262579, 'auprc': 0.9966999235126697, 'loss_val': 0.05158991756468181, 'psi': 0.9932806943626152}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=1.922686 cos_to_last_merge=0.9786 (last merge round=40)
[S17] round=67 local utility u=0.661768 metrics={'f1_val': 0.5824239620255728, 'auprc': 0.7257105931702448, 'loss_val': 1.4686901278237423, 'psi': 0.6397386144834416}-{'f1_val': 0.4637435087655587, 'auprc': 0.6294991103978097, 'loss_val': 1.791507985019568, 'psi': 0.5300457494184591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=68 head_norm_before_train=1.920395 cos_to_last_merge=0.7606 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.8220129947800962, 'auprc': 0.9385350931733458, 'loss_val': 0.46923564872391293, 'psi': 0.868621834137396}-{'f1_val': 0.8289290193375138, 'auprc': 0.9590425921375864, 'loss_val': 0.39544322582982994, 'psi': 0.8809744484575428}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.069664 cos_to_last_merge=0.9935 (last merge round=38)
[S3] round=68 local utility u=0.137096 metrics={'f1_val': 0.9833271682698365, 'auprc': 0.9981111763572488, 'loss_val': 0.06440015831293246, 'psi': 0.9892407715048013}-{'f1_val': 0.9574934630987351, 'auprc': 0.9930320454880122, 'loss_val': 0.168352051109444, 'psi': 0.971708896054446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=68 head_norm_before_train=2.080070 cos_to_last_merge=0.9959 (last merge round=39)
[S4] round=68 local utility u=0.422636 metrics={'f1_val': 0.9392006581961305, 'auprc': 0.9545316046312686, 'loss_val': 0.3453146551744878, 'psi': 0.9453330367701858}-{'f1_val': 0.8237837675236681, 'auprc': 0.9513282575595582, 'loss_val': 0.4884743903173637, 'psi': 0.8748015635380242}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=68 head_norm_before_train=2.249990 cos_to_last_merge=0.9940 (last merge round=38)
[S5] round=68 local utility u=0.018676 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.994013301027568, 'loss_val': 0.02660839896343466, 'psi': 0.9960672711226225}-{'f1_val': 0.9978030483519582, 'auprc': 0.9937458047718573, 'loss_val': 0.06535570636971967, 'psi': 0.9961801509199179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=68 head_norm_before_train=1.871825 cos_to_last_merge=0.9932 (last merge round=37)
[S6] round=68 local utility u=0.040898 metrics={'f1_val': 0.7433043318061312, 'auprc': 0.9456552525045887, 'loss_val': 0.4828290928549826, 'psi': 0.8242447000855142}-{'f1_val': 0.7400348691793153, 'auprc': 0.9501626207894025, 'loss_val': 0.5585297722607393, 'psi': 0.8240859698233503}
[S6] not sending this round → trigger blocked (psi=0.824)
[S7] START round=68 head_norm_before_train=1.980090 (no previous merge yet)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.6374842594837952, 'auprc': 0.7920423064441948, 'loss_val': 0.6445501749073403, 'psi': 0.699307478267955}-{'f1_val': 0.9317902078488842, 'auprc': 0.9882484519244623, 'loss_val': 0.1480412367332829, 'psi': 0.9543735054791154}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.964372 cos_to_last_merge=0.9774 (last merge round=39)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.8122052531379558, 'auprc': 0.9986164158379338, 'loss_val': 0.4495058013235188, 'psi': 0.886769718217947}-{'f1_val': 0.9932673365348732, 'auprc': 0.9992323028758536, 'loss_val': 0.029868458754059517, 'psi': 0.9956533230712654}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.148030 cos_to_last_merge=0.9529 (last merge round=34)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9984530130219444, 'loss_val': 0.04733340397723944, 'psi': 0.992198409884939}-{'f1_val': 0.9966605118138915, 'auprc': 0.9982719824874632, 'loss_val': 0.019359635357488848, 'psi': 0.9973051000833202}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.225926 cos_to_last_merge=0.9948 (last merge round=40)
[S10] round=68 local utility u=0.000055 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.998015650981781, 'loss_val': 0.026567023276541143, 'psi': 0.9960554259243359}-{'f1_val': 0.9947486092193725, 'auprc': 0.9979951139211041, 'loss_val': 0.026615228817887027, 'psi': 0.9960472111000651}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=68 head_norm_before_train=1.934641 cos_to_last_merge=0.9917 (last merge round=38)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9987025325359855, 'loss_val': 0.022064475856977683, 'psi': 0.9974115660114525}-{'f1_val': 0.9965509216617638, 'auprc': 0.998768613504898, 'loss_val': 0.021507917445725708, 'psi': 0.9974379983990176}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.995560 cos_to_last_merge=0.9921 (last merge round=37)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6156946408870954, 'auprc': 0.7738935829662966, 'loss_val': 1.0735422338872918, 'psi': 0.6789742177187759}-{'f1_val': 0.6220059789329425, 'auprc': 0.7671932344865495, 'loss_val': 1.031222549374839, 'psi': 0.6800808811543853}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=2.142675 cos_to_last_merge=0.9862 (last merge round=37)
[S14] round=68 local utility u=0.000401 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9969943990293642, 'loss_val': 0.02201896315667795, 'psi': 0.9968504786039645}-{'f1_val': 0.996754531653698, 'auprc': 0.996972120534442, 'loss_val': 0.02275375706986984, 'psi': 0.9968415672059956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=68 head_norm_before_train=2.242685 (no previous merge yet)
[S15] round=68 local utility u=0.420251 metrics={'f1_val': 0.8769031726554851, 'auprc': 0.9922406975030377, 'loss_val': 0.21644599811538615, 'psi': 0.9230381825945062}-{'f1_val': 0.7782313208563422, 'auprc': 0.9902228339962751, 'loss_val': 0.4588637880008572, 'psi': 0.8630279261123153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=68 head_norm_before_train=2.265055 cos_to_last_merge=0.9953 (last merge round=38)
[S16] round=68 local utility u=0.345713 metrics={'f1_val': 0.9921499874340187, 'auprc': 0.9918840157809587, 'loss_val': 0.0435118905712868, 'psi': 0.9920435987727948}-{'f1_val': 0.9320654593502447, 'auprc': 0.9900227994114731, 'loss_val': 0.3688466047501941, 'psi': 0.9552483953747359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=68 head_norm_before_train=1.929131 cos_to_last_merge=0.9777 (last merge round=40)
[S17] round=68 local utility u=0.204120 metrics={'f1_val': 0.6085146261705867, 'auprc': 0.7895425974785, 'loss_val': 1.4084909516852027, 'psi': 0.680925814693752}-{'f1_val': 0.5824239620255728, 'auprc': 0.7257105931702448, 'loss_val': 1.4686901278237423, 'psi': 0.6397386144834416}
[S17] not sending this round → trigger blocked (psi=0.681)
[S2] START round=69 head_norm_before_train=1.926568 cos_to_last_merge=0.7603 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7282129655119366, 'auprc': 0.8485972444662925, 'loss_val': 0.9368179453147099, 'psi': 0.776366677093679}-{'f1_val': 0.8220129947800962, 'auprc': 0.9385350931733458, 'loss_val': 0.46923564872391293, 'psi': 0.868621834137396}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.075889 cos_to_last_merge=0.9932 (last merge round=38)
[S3] round=69 local utility u=0.063652 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9987337036154924, 'loss_val': 0.021690380972936147, 'psi': 0.9977624409948425}-{'f1_val': 0.9833271682698365, 'auprc': 0.9981111763572488, 'loss_val': 0.06440015831293246, 'psi': 0.9892407715048013}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=69 head_norm_before_train=2.083300 cos_to_last_merge=0.9957 (last merge round=39)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.938545858358576, 'auprc': 0.9521067005785457, 'loss_val': 0.34907371448211716, 'psi': 0.9439701952465639}-{'f1_val': 0.9392006581961305, 'auprc': 0.9545316046312686, 'loss_val': 0.3453146551744878, 'psi': 0.9453330367701858}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=2.256141 cos_to_last_merge=0.9937 (last merge round=38)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9919557704034224, 'loss_val': 0.020717169623091412, 'psi': 0.9948034892484436}-{'f1_val': 0.9974365845193254, 'auprc': 0.994013301027568, 'loss_val': 0.02660839896343466, 'psi': 0.9960672711226225}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.875534 cos_to_last_merge=0.9929 (last merge round=37)
[S6] round=69 local utility u=0.786865 metrics={'f1_val': 0.9354368238255901, 'auprc': 0.9763258179779202, 'loss_val': 0.15390634043309082, 'psi': 0.9517924214865221}-{'f1_val': 0.7433043318061312, 'auprc': 0.9456552525045887, 'loss_val': 0.4828290928549826, 'psi': 0.8242447000855142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=69 head_norm_before_train=1.986047 (no previous merge yet)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.6207157542942803, 'auprc': 0.7945132028308035, 'loss_val': 0.6201228046887873, 'psi': 0.6902347337088897}-{'f1_val': 0.6374842594837952, 'auprc': 0.7920423064441948, 'loss_val': 0.6445501749073403, 'psi': 0.699307478267955}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.971505 cos_to_last_merge=0.9770 (last merge round=39)
[S8] round=69 local utility u=0.757296 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9990538937590026, 'loss_val': 0.02866784152386767, 'psi': 0.9961888618550191}-{'f1_val': 0.8122052531379558, 'auprc': 0.9986164158379338, 'loss_val': 0.4495058013235188, 'psi': 0.886769718217947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=69 head_norm_before_train=2.152978 cos_to_last_merge=0.9522 (last merge round=34)
[S9] round=69 local utility u=0.031434 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9939667909687033, 'loss_val': 0.0203355370815922, 'psi': 0.9953367732550479}-{'f1_val': 0.9880286744602689, 'auprc': 0.9984530130219444, 'loss_val': 0.04733340397723944, 'psi': 0.992198409884939}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=69 head_norm_before_train=2.229083 cos_to_last_merge=0.9948 (last merge round=40)
[S10] round=69 local utility u=0.000144 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9980851806097479, 'loss_val': 0.026488399002658588, 'psi': 0.9960832377755227}-{'f1_val': 0.9947486092193725, 'auprc': 0.998015650981781, 'loss_val': 0.026567023276541143, 'psi': 0.9960554259243359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=69 head_norm_before_train=1.941135 cos_to_last_merge=0.9913 (last merge round=38)
[S11] round=69 local utility u=0.000970 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989509752151315, 'loss_val': 0.020870285921402665, 'psi': 0.997510943083111}-{'f1_val': 0.9965509216617638, 'auprc': 0.9987025325359855, 'loss_val': 0.022064475856977683, 'psi': 0.9974115660114525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=69 head_norm_before_train=2.002197 cos_to_last_merge=0.9916 (last merge round=37)
[S13] round=69 local utility u=0.000000 metrics={'f1_val': 0.6596179346000911, 'auprc': 0.7031496914758688, 'loss_val': 1.2399963944113732, 'psi': 0.6770306373504021}-{'f1_val': 0.6156946408870954, 'auprc': 0.7738935829662966, 'loss_val': 1.0735422338872918, 'psi': 0.6789742177187759}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=69 head_norm_before_train=2.150004 cos_to_last_merge=0.9857 (last merge round=37)
[S14] round=69 local utility u=0.004607 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9986707146518405, 'loss_val': 0.02175727555624795, 'psi': 0.9979132475617716}-{'f1_val': 0.996754531653698, 'auprc': 0.9969943990293642, 'loss_val': 0.02201896315667795, 'psi': 0.9968504786039645}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=69 head_norm_before_train=2.245989 (no previous merge yet)
[S15] round=69 local utility u=0.462264 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9966902464396172, 'loss_val': 0.022100462279743865, 'psi': 0.9965014067620406}-{'f1_val': 0.8769031726554851, 'auprc': 0.9922406975030377, 'loss_val': 0.21644599811538615, 'psi': 0.9230381825945062}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=69 head_norm_before_train=2.264417 cos_to_last_merge=0.9952 (last merge round=38)
[S16] round=69 local utility u=0.003833 metrics={'f1_val': 0.9920144870514954, 'auprc': 0.993793107312099, 'loss_val': 0.04075981003959623, 'psi': 0.9927259351557369}-{'f1_val': 0.9921499874340187, 'auprc': 0.9918840157809587, 'loss_val': 0.0435118905712868, 'psi': 0.9920435987727948}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=69 head_norm_before_train=1.935273 cos_to_last_merge=0.9768 (last merge round=40)
[S17] round=69 local utility u=0.609746 metrics={'f1_val': 0.680206633977178, 'auprc': 0.8731644964617893, 'loss_val': 0.8700176401794808, 'psi': 0.7573897789710224}-{'f1_val': 0.6085146261705867, 'auprc': 0.7895425974785, 'loss_val': 1.4084909516852027, 'psi': 0.680925814693752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=70 head_norm_before_train=1.930186 cos_to_last_merge=0.7600 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=70 local utility u=0.783324 metrics={'f1_val': 0.8271982432324211, 'auprc': 0.9926369136160847, 'loss_val': 0.3962006331558313, 'psi': 0.8933737113858866}-{'f1_val': 0.7282129655119366, 'auprc': 0.8485972444662925, 'loss_val': 0.9368179453147099, 'psi': 0.776366677093679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=70 head_norm_before_train=2.083170 cos_to_last_merge=0.9930 (last merge round=38)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9827764819671727, 'auprc': 0.9974446798259056, 'loss_val': 0.06131051555029682, 'psi': 0.9886437611106659}-{'f1_val': 0.9971149325810758, 'auprc': 0.9987337036154924, 'loss_val': 0.021690380972936147, 'psi': 0.9977624409948425}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.087475 cos_to_last_merge=0.9956 (last merge round=39)
[S4] round=70 local utility u=0.021554 metrics={'f1_val': 0.9416224518288705, 'auprc': 0.9567882494153029, 'loss_val': 0.33846986923902406, 'psi': 0.9476887708634435}-{'f1_val': 0.938545858358576, 'auprc': 0.9521067005785457, 'loss_val': 0.34907371448211716, 'psi': 0.9439701952465639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=70 head_norm_before_train=2.261371 cos_to_last_merge=0.9936 (last merge round=38)
[S5] round=70 local utility u=0.013645 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9988182138336664, 'loss_val': 0.018422364847149653, 'psi': 0.9979892362450619}-{'f1_val': 0.9967019684784577, 'auprc': 0.9919557704034224, 'loss_val': 0.020717169623091412, 'psi': 0.9948034892484436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=70 head_norm_before_train=1.879277 cos_to_last_merge=0.9927 (last merge round=37)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.867078120639257, 'auprc': 0.9639347560008783, 'loss_val': 0.33817890244639315, 'psi': 0.9058207747839055}-{'f1_val': 0.9354368238255901, 'auprc': 0.9763258179779202, 'loss_val': 0.15390634043309082, 'psi': 0.9517924214865221}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.994373 (no previous merge yet)
[S7] round=70 local utility u=0.281704 metrics={'f1_val': 0.6714226572231914, 'auprc': 0.8152740715033538, 'loss_val': 0.4232381690767559, 'psi': 0.7289632229352564}-{'f1_val': 0.6207157542942803, 'auprc': 0.7945132028308035, 'loss_val': 0.6201228046887873, 'psi': 0.6902347337088897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=70 head_norm_before_train=1.976911 cos_to_last_merge=0.9766 (last merge round=39)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9867984609811391, 'auprc': 0.995798213699096, 'loss_val': 0.04533216179708388, 'psi': 0.9903983620683219}-{'f1_val': 0.9942788405856967, 'auprc': 0.9990538937590026, 'loss_val': 0.02866784152386767, 'psi': 0.9961888618550191}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.159314 cos_to_last_merge=0.9516 (last merge round=34)
[S9] round=70 local utility u=0.007883 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984583294666121, 'loss_val': 0.018168881611495238, 'psi': 0.9971459492248885}-{'f1_val': 0.9962500947792776, 'auprc': 0.9939667909687033, 'loss_val': 0.0203355370815922, 'psi': 0.9953367732550479}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=70 head_norm_before_train=2.233478 cos_to_last_merge=0.9946 (last merge round=40)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9980513145054528, 'loss_val': 0.02655644236583187, 'psi': 0.9960696913338046}-{'f1_val': 0.9947486092193725, 'auprc': 0.9980851806097479, 'loss_val': 0.026488399002658588, 'psi': 0.9960832377755227}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=1.947756 cos_to_last_merge=0.9910 (last merge round=38)
[S11] round=70 local utility u=0.000174 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998936889524817, 'loss_val': 0.02047920792075576, 'psi': 0.9975053088069852}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989509752151315, 'loss_val': 0.020870285921402665, 'psi': 0.997510943083111}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=70 head_norm_before_train=2.009646 cos_to_last_merge=0.9907 (last merge round=37)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.5771758711754645, 'auprc': 0.5639055602212382, 'loss_val': 1.592465508119715, 'psi': 0.571867746793774}-{'f1_val': 0.6596179346000911, 'auprc': 0.7031496914758688, 'loss_val': 1.2399963944113732, 'psi': 0.6770306373504021}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.155401 cos_to_last_merge=0.9854 (last merge round=37)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.96426672426729, 'auprc': 0.9979800735414407, 'loss_val': 0.07103559569880331, 'psi': 0.9777520639769502}-{'f1_val': 0.9974082695017256, 'auprc': 0.9986707146518405, 'loss_val': 0.02175727555624795, 'psi': 0.9979132475617716}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.248801 (no previous merge yet)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.7252275268623015, 'auprc': 0.9884179182087829, 'loss_val': 0.6034725081560456, 'psi': 0.8305036834008941}-{'f1_val': 0.9963755136436562, 'auprc': 0.9966902464396172, 'loss_val': 0.022100462279743865, 'psi': 0.9965014067620406}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=2.267361 cos_to_last_merge=0.9950 (last merge round=38)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9634215298197403, 'auprc': 0.9906295822753326, 'loss_val': 0.1089551064763446, 'psi': 0.9743047508019771}-{'f1_val': 0.9920144870514954, 'auprc': 0.993793107312099, 'loss_val': 0.04075981003959623, 'psi': 0.9927259351557369}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=1.940967 cos_to_last_merge=0.9760 (last merge round=40)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.5674513192334565, 'auprc': 0.7560927321180124, 'loss_val': 1.520282510760226, 'psi': 0.6429078843872789}-{'f1_val': 0.680206633977178, 'auprc': 0.8731644964617893, 'loss_val': 0.8700176401794808, 'psi': 0.7573897789710224}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=1.933918 cos_to_last_merge=0.7596 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.8295079430813286, 'auprc': 0.9187004249329502, 'loss_val': 0.3948373241709918, 'psi': 0.8651849358219772}-{'f1_val': 0.8271982432324211, 'auprc': 0.9926369136160847, 'loss_val': 0.3962006331558313, 'psi': 0.8933737113858866}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.088129 cos_to_last_merge=0.9928 (last merge round=38)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9602728180634086, 'auprc': 0.9874989081912132, 'loss_val': 0.162400396743611, 'psi': 0.9711632541145304}-{'f1_val': 0.9827764819671727, 'auprc': 0.9974446798259056, 'loss_val': 0.06131051555029682, 'psi': 0.9886437611106659}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.086835 cos_to_last_merge=0.9955 (last merge round=39)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9414485731136766, 'auprc': 0.9544673738904069, 'loss_val': 0.3402728110412903, 'psi': 0.9466560934243687}-{'f1_val': 0.9416224518288705, 'auprc': 0.9567882494153029, 'loss_val': 0.33846986923902406, 'psi': 0.9476887708634435}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=2.269177 cos_to_last_merge=0.9933 (last merge round=38)
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9966537505048044, 'loss_val': 0.01824502943153866, 'psi': 0.9971234509135171}-{'f1_val': 0.9974365845193254, 'auprc': 0.9988182138336664, 'loss_val': 0.018422364847149653, 'psi': 0.9979892362450619}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.884779 cos_to_last_merge=0.9926 (last merge round=37)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.5983155369092565, 'auprc': 0.8800066340242907, 'loss_val': 1.187268236301049, 'psi': 0.7109919757552702}-{'f1_val': 0.867078120639257, 'auprc': 0.9639347560008783, 'loss_val': 0.33817890244639315, 'psi': 0.9058207747839055}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=2.005448 (no previous merge yet)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6515621610960243, 'auprc': 0.8052176217670277, 'loss_val': 0.5292121612624118, 'psi': 0.7130243453644256}-{'f1_val': 0.6714226572231914, 'auprc': 0.8152740715033538, 'loss_val': 0.4232381690767559, 'psi': 0.7289632229352564}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.983583 cos_to_last_merge=0.9762 (last merge round=39)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9090081523136795, 'auprc': 0.9990793448220419, 'loss_val': 0.1990511821222692, 'psi': 0.9450366293170245}-{'f1_val': 0.9867984609811391, 'auprc': 0.995798213699096, 'loss_val': 0.04533216179708388, 'psi': 0.9903983620683219}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.163949 cos_to_last_merge=0.9512 (last merge round=34)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.991254331540241, 'auprc': 0.9985102187278377, 'loss_val': 0.03103349251359359, 'psi': 0.9941566864152797}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984583294666121, 'loss_val': 0.018168881611495238, 'psi': 0.9971459492248885}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.238504 cos_to_last_merge=0.9944 (last merge round=40)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.997910427248681, 'loss_val': 0.026703931426093345, 'psi': 0.9960133364310959}-{'f1_val': 0.9947486092193725, 'auprc': 0.9980513145054528, 'loss_val': 0.02655644236583187, 'psi': 0.9960696913338046}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=1.953506 cos_to_last_merge=0.9908 (last merge round=38)
[S11] round=71 local utility u=0.000043 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989263738682792, 'loss_val': 0.02036076399239714, 'psi': 0.9975011025443701}-{'f1_val': 0.9965509216617638, 'auprc': 0.998936889524817, 'loss_val': 0.02047920792075576, 'psi': 0.9975053088069852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=71 head_norm_before_train=2.014338 cos_to_last_merge=0.9899 (last merge round=37)
[S13] round=71 local utility u=0.967115 metrics={'f1_val': 0.7279277102065987, 'auprc': 0.6911975155508512, 'loss_val': 0.9446224033348705, 'psi': 0.7132356323442997}-{'f1_val': 0.5771758711754645, 'auprc': 0.5639055602212382, 'loss_val': 1.592465508119715, 'psi': 0.571867746793774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=71 head_norm_before_train=2.158226 cos_to_last_merge=0.9850 (last merge round=37)
[S14] round=71 local utility u=0.122503 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.998667985649598, 'loss_val': 0.02562151046260191, 'psi': 0.9977801154619532}-{'f1_val': 0.96426672426729, 'auprc': 0.9979800735414407, 'loss_val': 0.07103559569880331, 'psi': 0.9777520639769502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=71 head_norm_before_train=2.253402 (no previous merge yet)
[S15] round=71 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9967455844453621, 'loss_val': 0.023493778759965157, 'psi': 0.9964976802874294}-{'f1_val': 0.7252275268623015, 'auprc': 0.9884179182087829, 'loss_val': 0.6034725081560456, 'psi': 0.8305036834008941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=71 head_norm_before_train=2.272526 cos_to_last_merge=0.9949 (last merge round=38)
[S16] round=71 local utility u=0.120591 metrics={'f1_val': 0.9920129957373984, 'auprc': 0.9926121212944417, 'loss_val': 0.045270167593467935, 'psi': 0.9922526459602157}-{'f1_val': 0.9634215298197403, 'auprc': 0.9906295822753326, 'loss_val': 0.1089551064763446, 'psi': 0.9743047508019771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=71 head_norm_before_train=1.948072 cos_to_last_merge=0.9754 (last merge round=40)
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.5671081492659985, 'auprc': 0.7156754088516804, 'loss_val': 1.4759698513038522, 'psi': 0.6265350531002712}-{'f1_val': 0.5674513192334565, 'auprc': 0.7560927321180124, 'loss_val': 1.520282510760226, 'psi': 0.6429078843872789}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=72 head_norm_before_train=1.938244 cos_to_last_merge=0.7590 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7158672857016504, 'auprc': 0.9723081936771779, 'loss_val': 0.5411501840224107, 'psi': 0.8184436488918614}-{'f1_val': 0.8295079430813286, 'auprc': 0.9187004249329502, 'loss_val': 0.3948373241709918, 'psi': 0.8651849358219772}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.094453 cos_to_last_merge=0.9927 (last merge round=38)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9577455385901139, 'auprc': 0.9929666263392329, 'loss_val': 0.16418127118390782, 'psi': 0.9718339736897614}-{'f1_val': 0.9602728180634086, 'auprc': 0.9874989081912132, 'loss_val': 0.162400396743611, 'psi': 0.9711632541145304}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.087813 cos_to_last_merge=0.9953 (last merge round=39)
[S4] round=72 local utility u=0.005177 metrics={'f1_val': 0.9418738652420665, 'auprc': 0.9565643386436475, 'loss_val': 0.33876140533622634, 'psi': 0.9477500546026989}-{'f1_val': 0.9414485731136766, 'auprc': 0.9544673738904069, 'loss_val': 0.3402728110412903, 'psi': 0.9466560934243687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=72 head_norm_before_train=2.272092 cos_to_last_merge=0.9931 (last merge round=38)
[S5] round=72 local utility u=0.000832 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9973759211385225, 'loss_val': 0.01654588894044615, 'psi': 0.9971921036220476}-{'f1_val': 0.9974365845193254, 'auprc': 0.9966537505048044, 'loss_val': 0.01824502943153866, 'psi': 0.9971234509135171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=72 head_norm_before_train=1.889467 cos_to_last_merge=0.9924 (last merge round=37)
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.8769957844951711, 'auprc': 0.9809892865840781, 'loss_val': 0.26662246820125535, 'psi': 0.9185931853307339}-{'f1_val': 0.5983155369092565, 'auprc': 0.8800066340242907, 'loss_val': 1.187268236301049, 'psi': 0.7109919757552702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=72 head_norm_before_train=2.014804 (no previous merge yet)
[S7] round=72 local utility u=1.000000 metrics={'f1_val': 0.9292467964863229, 'auprc': 0.9820593722814258, 'loss_val': 0.18854366214672724, 'psi': 0.950371826804364}-{'f1_val': 0.6515621610960243, 'auprc': 0.8052176217670277, 'loss_val': 0.5292121612624118, 'psi': 0.7130243453644256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=72 head_norm_before_train=1.990925 cos_to_last_merge=0.9758 (last merge round=39)
[S8] round=72 local utility u=0.273701 metrics={'f1_val': 0.9777620017838513, 'auprc': 0.9992160087157259, 'loss_val': 0.06458227681766866, 'psi': 0.9863436045566011}-{'f1_val': 0.9090081523136795, 'auprc': 0.9990793448220419, 'loss_val': 0.1990511821222692, 'psi': 0.9450366293170245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=72 head_norm_before_train=2.169089 cos_to_last_merge=0.9507 (last merge round=34)
[S9] round=72 local utility u=0.012840 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.993678221763427, 'loss_val': 0.020832564656351298, 'psi': 0.9952213455729374}-{'f1_val': 0.991254331540241, 'auprc': 0.9985102187278377, 'loss_val': 0.03103349251359359, 'psi': 0.9941566864152797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=72 head_norm_before_train=2.243696 cos_to_last_merge=0.9942 (last merge round=40)
[S10] round=72 local utility u=0.000390 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981481919362735, 'loss_val': 0.026637085523053262, 'psi': 0.9961084423061328}-{'f1_val': 0.9947486092193725, 'auprc': 0.997910427248681, 'loss_val': 0.026703931426093345, 'psi': 0.9960133364310959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=72 head_norm_before_train=1.958586 cos_to_last_merge=0.9905 (last merge round=38)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989343392990272, 'loss_val': 0.020616023579942168, 'psi': 0.9975042887166692}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989263738682792, 'loss_val': 0.02036076399239714, 'psi': 0.9975011025443701}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=2.017656 cos_to_last_merge=0.9893 (last merge round=37)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.5782402835194984, 'auprc': 0.5767180260989053, 'loss_val': 1.5591546917077677, 'psi': 0.5776313805512612}-{'f1_val': 0.7279277102065987, 'auprc': 0.6911975155508512, 'loss_val': 0.9446224033348705, 'psi': 0.7132356323442997}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.163318 cos_to_last_merge=0.9847 (last merge round=37)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963375338307721, 'auprc': 0.9969186842214577, 'loss_val': 0.023977232747819894, 'psi': 0.9965699939870464}-{'f1_val': 0.9971882020035234, 'auprc': 0.998667985649598, 'loss_val': 0.02562151046260191, 'psi': 0.9977801154619532}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.258411 (no previous merge yet)
[S15] round=72 local utility u=0.002789 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971504360025888, 'loss_val': 0.021614900564044616, 'psi': 0.9969081754335478}-{'f1_val': 0.9963324108488076, 'auprc': 0.9967455844453621, 'loss_val': 0.023493778759965157, 'psi': 0.9964976802874294}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=72 head_norm_before_train=2.278833 cos_to_last_merge=0.9947 (last merge round=38)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9929599904979123, 'auprc': 0.9871192473670536, 'loss_val': 0.03965806717852288, 'psi': 0.9906236932455689}-{'f1_val': 0.9920129957373984, 'auprc': 0.9926121212944417, 'loss_val': 0.045270167593467935, 'psi': 0.9922526459602157}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.953559 cos_to_last_merge=0.9751 (last merge round=40)
[S17] round=72 local utility u=0.727269 metrics={'f1_val': 0.6765297588123856, 'auprc': 0.8100987859265405, 'loss_val': 0.9612318873357649, 'psi': 0.7299573696580476}-{'f1_val': 0.5671081492659985, 'auprc': 0.7156754088516804, 'loss_val': 1.4759698513038522, 'psi': 0.6265350531002712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=73 head_norm_before_train=1.941552 cos_to_last_merge=0.7589 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=73 local utility u=0.317715 metrics={'f1_val': 0.7919932778459903, 'auprc': 0.9906832781361592, 'loss_val': 0.417601337007799, 'psi': 0.8714692779620579}-{'f1_val': 0.7158672857016504, 'auprc': 0.9723081936771779, 'loss_val': 0.5411501840224107, 'psi': 0.8184436488918614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=73 head_norm_before_train=2.101818 cos_to_last_merge=0.9924 (last merge round=38)
[S3] round=73 local utility u=0.065060 metrics={'f1_val': 0.9675874688080072, 'auprc': 0.9962769063643466, 'loss_val': 0.10304308453245292, 'psi': 0.979063243830543}-{'f1_val': 0.9577455385901139, 'auprc': 0.9929666263392329, 'loss_val': 0.16418127118390782, 'psi': 0.9718339736897614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=73 head_norm_before_train=2.091378 cos_to_last_merge=0.9953 (last merge round=39)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9397486227363478, 'auprc': 0.9525319757847095, 'loss_val': 0.34796250199001993, 'psi': 0.9448619639556924}-{'f1_val': 0.9418738652420665, 'auprc': 0.9565643386436475, 'loss_val': 0.33876140533622634, 'psi': 0.9477500546026989}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=2.279089 cos_to_last_merge=0.9932 (last merge round=38)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.999571363374742, 'loss_val': 0.02677721677353081, 'psi': 0.998290496061492}-{'f1_val': 0.9970695586110643, 'auprc': 0.9973759211385225, 'loss_val': 0.01654588894044615, 'psi': 0.9971921036220476}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.894075 cos_to_last_merge=0.9922 (last merge round=37)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6090662907708174, 'auprc': 0.8877612516057697, 'loss_val': 1.0078227064094512, 'psi': 0.7205442751047983}-{'f1_val': 0.8769957844951711, 'auprc': 0.9809892865840781, 'loss_val': 0.26662246820125535, 'psi': 0.9185931853307339}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=2.021564 (no previous merge yet)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6018335633064151, 'auprc': 0.7913286201066124, 'loss_val': 0.8526531741676778, 'psi': 0.6776315860264941}-{'f1_val': 0.9292467964863229, 'auprc': 0.9820593722814258, 'loss_val': 0.18854366214672724, 'psi': 0.950371826804364}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=1.999932 cos_to_last_merge=0.9753 (last merge round=39)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.8747115916190646, 'auprc': 0.9956467044730462, 'loss_val': 0.2716073690165211, 'psi': 0.9230856367606572}-{'f1_val': 0.9777620017838513, 'auprc': 0.9992160087157259, 'loss_val': 0.06458227681766866, 'psi': 0.9863436045566011}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.172550 cos_to_last_merge=0.9503 (last merge round=34)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9980549317323928, 'loss_val': 0.027880845539435685, 'psi': 0.9953170819987797}-{'f1_val': 0.9962500947792776, 'auprc': 0.993678221763427, 'loss_val': 0.020832564656351298, 'psi': 0.9952213455729374}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.248978 cos_to_last_merge=0.9940 (last merge round=40)
[S10] round=73 local utility u=0.000277 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9987360220649826, 'loss_val': 0.026529675384674774, 'psi': 0.9962118729050297}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981481919362735, 'loss_val': 0.026637085523053262, 'psi': 0.9961084423061328}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=73 head_norm_before_train=1.964258 cos_to_last_merge=0.9903 (last merge round=38)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986781679798783, 'loss_val': 0.0319763383514269, 'psi': 0.9974018201890097}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989343392990272, 'loss_val': 0.020616023579942168, 'psi': 0.9975042887166692}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=2.021926 cos_to_last_merge=0.9889 (last merge round=37)
[S13] round=73 local utility u=0.719239 metrics={'f1_val': 0.6700374002875785, 'auprc': 0.7449285779818995, 'loss_val': 1.1760914083810274, 'psi': 0.6999938713653069}-{'f1_val': 0.5782402835194984, 'auprc': 0.5767180260989053, 'loss_val': 1.5591546917077677, 'psi': 0.5776313805512612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=73 head_norm_before_train=2.170078 cos_to_last_merge=0.9844 (last merge round=37)
[S14] round=73 local utility u=0.006838 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986674594809672, 'loss_val': 0.01950654554704784, 'psi': 0.997665488686986}-{'f1_val': 0.9963375338307721, 'auprc': 0.9969186842214577, 'loss_val': 0.023977232747819894, 'psi': 0.9965699939870464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=73 head_norm_before_train=2.263433 (no previous merge yet)
[S15] round=73 local utility u=0.000084 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972351303165822, 'loss_val': 0.021700401256444013, 'psi': 0.9969420531591452}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971504360025888, 'loss_val': 0.021614900564044616, 'psi': 0.9969081754335478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=73 head_norm_before_train=2.285088 cos_to_last_merge=0.9945 (last merge round=38)
[S16] round=73 local utility u=0.007886 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9924280010656819, 'loss_val': 0.03915705605344337, 'psi': 0.9926817077709963}-{'f1_val': 0.9929599904979123, 'auprc': 0.9871192473670536, 'loss_val': 0.03965806717852288, 'psi': 0.9906236932455689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=73 head_norm_before_train=1.960620 cos_to_last_merge=0.9747 (last merge round=40)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.582153698332536, 'auprc': 0.8227016577892122, 'loss_val': 1.4839366344268021, 'psi': 0.6783728821152065}-{'f1_val': 0.6765297588123856, 'auprc': 0.8100987859265405, 'loss_val': 0.9612318873357649, 'psi': 0.7299573696580476}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=1.947007 cos_to_last_merge=0.7586 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=74 local utility u=0.007301 metrics={'f1_val': 0.8275725984528863, 'auprc': 0.9310942465353873, 'loss_val': 0.4377074435116868, 'psi': 0.8689812576858866}-{'f1_val': 0.7919932778459903, 'auprc': 0.9906832781361592, 'loss_val': 0.417601337007799, 'psi': 0.8714692779620579}
[S2] not sending this round → trigger blocked (psi=0.869)
[S3] START round=74 head_norm_before_train=2.109209 cos_to_last_merge=0.9921 (last merge round=38)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9604461075006218, 'auprc': 0.9945701505178307, 'loss_val': 0.11357946736844987, 'psi': 0.9740957247075053}-{'f1_val': 0.9675874688080072, 'auprc': 0.9962769063643466, 'loss_val': 0.10304308453245292, 'psi': 0.979063243830543}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=2.097152 cos_to_last_merge=0.9952 (last merge round=39)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9391923777538194, 'auprc': 0.953347365458779, 'loss_val': 0.36202973713448466, 'psi': 0.9448543728358032}-{'f1_val': 0.9397486227363478, 'auprc': 0.9525319757847095, 'loss_val': 0.34796250199001993, 'psi': 0.9448619639556924}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=2.283921 cos_to_last_merge=0.9930 (last merge round=38)
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9936345217216718, 'loss_val': 0.016666626058554217, 'psi': 0.9956955438553073}-{'f1_val': 0.9974365845193254, 'auprc': 0.999571363374742, 'loss_val': 0.02677721677353081, 'psi': 0.998290496061492}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.900062 cos_to_last_merge=0.9918 (last merge round=37)
[S6] round=74 local utility u=1.000000 metrics={'f1_val': 0.858782475825973, 'auprc': 0.9560634217995025, 'loss_val': 0.38692312570419723, 'psi': 0.8976948542153849}-{'f1_val': 0.6090662907708174, 'auprc': 0.8877612516057697, 'loss_val': 1.0078227064094512, 'psi': 0.7205442751047983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=74 head_norm_before_train=2.027146 (no previous merge yet)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5728230904874583, 'auprc': 0.7831173885873952, 'loss_val': 1.1486157934585797, 'psi': 0.6569408097274331}-{'f1_val': 0.6018335633064151, 'auprc': 0.7913286201066124, 'loss_val': 0.8526531741676778, 'psi': 0.6776315860264941}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.003764 cos_to_last_merge=0.9749 (last merge round=39)
[S8] round=74 local utility u=0.481981 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9991342908717382, 'loss_val': 0.02944282042226275, 'psi': 0.9956141182696192}-{'f1_val': 0.8747115916190646, 'auprc': 0.9956467044730462, 'loss_val': 0.2716073690165211, 'psi': 0.9230856367606572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] sending update (kind=head size=1806 to 1 peers)
[S9] START round=74 head_norm_before_train=2.177395 cos_to_last_merge=0.9497 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=74 local utility u=0.011567 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9967021488848538, 'loss_val': 0.019701048044624414, 'psi': 0.9966771666422763}-{'f1_val': 0.9934918488430377, 'auprc': 0.9980549317323928, 'loss_val': 0.027880845539435685, 'psi': 0.9953170819987797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=74 head_norm_before_train=2.253264 cos_to_last_merge=0.9939 (last merge round=40)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9983337968939562, 'loss_val': 0.026824155761863408, 'psi': 0.9960509828366191}-{'f1_val': 0.9945291067983943, 'auprc': 0.9987360220649826, 'loss_val': 0.026529675384674774, 'psi': 0.9962118729050297}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=1.970188 cos_to_last_merge=0.9900 (last merge round=38)
[S11] round=74 local utility u=0.005723 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9988571304604318, 'loss_val': 0.021066685639861943, 'psi': 0.9974734051812311}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986781679798783, 'loss_val': 0.0319763383514269, 'psi': 0.9974018201890097}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=74 head_norm_before_train=2.023835 cos_to_last_merge=0.9886 (last merge round=37)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6051512481696915, 'auprc': 0.6460830897810407, 'loss_val': 1.192828933018397, 'psi': 0.6215239848142311}-{'f1_val': 0.6700374002875785, 'auprc': 0.7449285779818995, 'loss_val': 1.1760914083810274, 'psi': 0.6999938713653069}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=2.177487 cos_to_last_merge=0.9841 (last merge round=37)
[S14] round=74 local utility u=0.001758 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.9990460695865354, 'loss_val': 0.019850136388418173, 'psi': 0.9980893561158969}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986674594809672, 'loss_val': 0.01950654554704784, 'psi': 0.997665488686986}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=74 head_norm_before_train=2.268124 (no previous merge yet)
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9618624254168752, 'auprc': 0.9963433728272583, 'loss_val': 0.0730865763839509, 'psi': 0.9756548043810284}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972351303165822, 'loss_val': 0.021700401256444013, 'psi': 0.9969420531591452}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.290803 cos_to_last_merge=0.9943 (last merge round=38)
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9923823720697644, 'auprc': 0.9932444783192046, 'loss_val': 0.03975666975229895, 'psi': 0.9927272145695405}-{'f1_val': 0.9928508455745393, 'auprc': 0.9924280010656819, 'loss_val': 0.03915705605344337, 'psi': 0.9926817077709963}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=1.964499 cos_to_last_merge=0.9741 (last merge round=40)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.5089962314841651, 'auprc': 0.6894339337984797, 'loss_val': 1.7158473627953854, 'psi': 0.581171312409891}-{'f1_val': 0.582153698332536, 'auprc': 0.8227016577892122, 'loss_val': 1.4839366344268021, 'psi': 0.6783728821152065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=1.954085 cos_to_last_merge=0.7581 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.8312709488937223, 'auprc': 0.8655221136787953, 'loss_val': 0.45982569170024157, 'psi': 0.8449714148077515}-{'f1_val': 0.8275725984528863, 'auprc': 0.9310942465353873, 'loss_val': 0.4377074435116868, 'psi': 0.8689812576858866}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.114773 cos_to_last_merge=0.9918 (last merge round=38)
[S3] round=75 local utility u=0.125332 metrics={'f1_val': 0.9890293076412255, 'auprc': 0.9977257821422363, 'loss_val': 0.04388170133435612, 'psi': 0.9925078974416298}-{'f1_val': 0.9604461075006218, 'auprc': 0.9945701505178307, 'loss_val': 0.11357946736844987, 'psi': 0.9740957247075053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=75 head_norm_before_train=2.102692 cos_to_last_merge=0.9951 (last merge round=39)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9129459955058521, 'auprc': 0.9521603554390459, 'loss_val': 0.42468343033734324, 'psi': 0.9286317394791296}-{'f1_val': 0.9391923777538194, 'auprc': 0.953347365458779, 'loss_val': 0.36202973713448466, 'psi': 0.9448543728358032}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=2.289094 cos_to_last_merge=0.9929 (last merge round=38)
[S5] round=75 local utility u=0.004579 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9996341673821555, 'loss_val': 0.029909012934538903, 'psi': 0.9985354959640371}-{'f1_val': 0.9970695586110643, 'auprc': 0.9936345217216718, 'loss_val': 0.016666626058554217, 'psi': 0.9956955438553073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=75 head_norm_before_train=1.907623 cos_to_last_merge=0.9918 (last merge round=37)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.7909730822479496, 'auprc': 0.946895531549279, 'loss_val': 0.5772184632904146, 'psi': 0.8533420619684813}-{'f1_val': 0.858782475825973, 'auprc': 0.9560634217995025, 'loss_val': 0.38692312570419723, 'psi': 0.8976948542153849}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=2.029407 (no previous merge yet)
[S7] round=75 local utility u=1.000000 metrics={'f1_val': 0.8176194874216012, 'auprc': 0.9336217587655838, 'loss_val': 0.39358846748544124, 'psi': 0.8640203959591942}-{'f1_val': 0.5728230904874583, 'auprc': 0.7831173885873952, 'loss_val': 1.1486157934585797, 'psi': 0.6569408097274331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=75 head_norm_before_train=2.006176 cos_to_last_merge=0.9747 (last merge round=39)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9993158370349662, 'loss_val': 0.03333920513105003, 'psi': 0.9943779644594273}-{'f1_val': 0.9932673365348732, 'auprc': 0.9991342908717382, 'loss_val': 0.02944282042226275, 'psi': 0.9956141182696192}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.181499 cos_to_last_merge=0.9492 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=75 local utility u=0.000713 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9971422940323642, 'loss_val': 0.019595628792020894, 'psi': 0.9968532247012806}-{'f1_val': 0.9966605118138915, 'auprc': 0.9967021488848538, 'loss_val': 0.019701048044624414, 'psi': 0.9966771666422763}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=75 head_norm_before_train=2.257198 cos_to_last_merge=0.9937 (last merge round=40)
[S10] round=75 local utility u=0.000270 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981506778651706, 'loss_val': 0.0270516687233531, 'psi': 0.9961094366776917}-{'f1_val': 0.9945291067983943, 'auprc': 0.9983337968939562, 'loss_val': 0.026824155761863408, 'psi': 0.9960509828366191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=75 head_norm_before_train=1.976074 cos_to_last_merge=0.9897 (last merge round=38)
[S11] round=75 local utility u=0.000576 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989314841896223, 'loss_val': 0.020137928818383197, 'psi': 0.9975031466729073}-{'f1_val': 0.9965509216617638, 'auprc': 0.9988571304604318, 'loss_val': 0.021066685639861943, 'psi': 0.9974734051812311}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=75 head_norm_before_train=2.026558 cos_to_last_merge=0.9885 (last merge round=37)
[S13] round=75 local utility u=0.133020 metrics={'f1_val': 0.6094205247263051, 'auprc': 0.7096670138692418, 'loss_val': 1.143156001602041, 'psi': 0.6495191203834798}-{'f1_val': 0.6051512481696915, 'auprc': 0.6460830897810407, 'loss_val': 1.192828933018397, 'psi': 0.6215239848142311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=75 head_norm_before_train=2.182504 cos_to_last_merge=0.9836 (last merge round=37)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9986705106251943, 'loss_val': 0.019349668442797757, 'psi': 0.9975346688215394}-{'f1_val': 0.9974515471354712, 'auprc': 0.9990460695865354, 'loss_val': 0.019850136388418173, 'psi': 0.9980893561158969}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.272927 (no previous merge yet)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.7009022883855206, 'auprc': 0.9222188459490976, 'loss_val': 0.704755083310362, 'psi': 0.7894289114109514}-{'f1_val': 0.9618624254168752, 'auprc': 0.9963433728272583, 'loss_val': 0.0730865763839509, 'psi': 0.9756548043810284}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.294218 cos_to_last_merge=0.9942 (last merge round=38)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9905833695624888, 'auprc': 0.9932779942559821, 'loss_val': 0.049716716626252155, 'psi': 0.9916612194398862}-{'f1_val': 0.9923823720697644, 'auprc': 0.9932444783192046, 'loss_val': 0.03975666975229895, 'psi': 0.9927272145695405}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.966283 cos_to_last_merge=0.9738 (last merge round=40)
[S17] round=75 local utility u=0.714691 metrics={'f1_val': 0.6311993219281662, 'auprc': 0.7332583975159196, 'loss_val': 1.1511571972721393, 'psi': 0.6720229521632675}-{'f1_val': 0.5089962314841651, 'auprc': 0.6894339337984797, 'loss_val': 1.7158473627953854, 'psi': 0.581171312409891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=76 head_norm_before_train=1.960410 cos_to_last_merge=0.7576 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=76 local utility u=0.166194 metrics={'f1_val': 0.8275044145408343, 'auprc': 0.9922531313504903, 'loss_val': 0.48503204791908233, 'psi': 0.8934039012646967}-{'f1_val': 0.8312709488937223, 'auprc': 0.8655221136787953, 'loss_val': 0.45982569170024157, 'psi': 0.8449714148077515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=76 head_norm_before_train=2.121176 cos_to_last_merge=0.9916 (last merge round=38)
[S3] round=76 local utility u=0.028881 metrics={'f1_val': 0.9950619306009424, 'auprc': 0.998507246628707, 'loss_val': 0.024659830259498253, 'psi': 0.9964400570120482}-{'f1_val': 0.9890293076412255, 'auprc': 0.9977257821422363, 'loss_val': 0.04388170133435612, 'psi': 0.9925078974416298}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=76 head_norm_before_train=2.107340 cos_to_last_merge=0.9949 (last merge round=39)
[S4] round=76 local utility u=0.011993 metrics={'f1_val': 0.9148581020498375, 'auprc': 0.9525991252764958, 'loss_val': 0.41348669055832366, 'psi': 0.9299545113405009}-{'f1_val': 0.9129459955058521, 'auprc': 0.9521603554390459, 'loss_val': 0.42468343033734324, 'psi': 0.9286317394791296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=76 head_norm_before_train=2.297294 cos_to_last_merge=0.9928 (last merge round=38)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.988467768181715, 'auprc': 0.9904358355535912, 'loss_val': 0.034121684147773015, 'psi': 0.9892549951304654}-{'f1_val': 0.9978030483519582, 'auprc': 0.9996341673821555, 'loss_val': 0.029909012934538903, 'psi': 0.9985354959640371}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.913631 cos_to_last_merge=0.9917 (last merge round=37)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.6210788828995415, 'auprc': 0.9081535335683585, 'loss_val': 1.0064277227680845, 'psi': 0.7359087431670683}-{'f1_val': 0.7909730822479496, 'auprc': 0.946895531549279, 'loss_val': 0.5772184632904146, 'psi': 0.8533420619684813}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=2.030332 (no previous merge yet)
[S7] round=76 local utility u=0.498976 metrics={'f1_val': 0.915103175265571, 'auprc': 0.991591161063594, 'loss_val': 0.15444752172038562, 'psi': 0.9456983695847802}-{'f1_val': 0.8176194874216012, 'auprc': 0.9336217587655838, 'loss_val': 0.39358846748544124, 'psi': 0.8640203959591942}
[S7] not sending this round → trigger blocked (psi=0.946)
[S8] START round=76 head_norm_before_train=2.009463 cos_to_last_merge=0.9744 (last merge round=39)
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9736904608187118, 'auprc': 0.9991273156271239, 'loss_val': 0.0749437198170698, 'psi': 0.9838652027420767}-{'f1_val': 0.9910860494090681, 'auprc': 0.9993158370349662, 'loss_val': 0.03333920513105003, 'psi': 0.9943779644594273}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.183542 cos_to_last_merge=0.9488 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9984560279600927, 'loss_val': 0.03779154650980363, 'psi': 0.9937070147803058}-{'f1_val': 0.9966605118138915, 'auprc': 0.9971422940323642, 'loss_val': 0.019595628792020894, 'psi': 0.9968532247012806}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.261717 cos_to_last_merge=0.9936 (last merge round=40)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9979700505051409, 'loss_val': 0.02680224090386174, 'psi': 0.9960371857336798}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981506778651706, 'loss_val': 0.0270516687233531, 'psi': 0.9961094366776917}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=1.981466 cos_to_last_merge=0.9894 (last merge round=38)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986374020370226, 'loss_val': 0.020200230545923237, 'psi': 0.9973855138118674}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989314841896223, 'loss_val': 0.020137928818383197, 'psi': 0.9975031466729073}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=2.028924 cos_to_last_merge=0.9884 (last merge round=37)
[S13] round=76 local utility u=0.440107 metrics={'f1_val': 0.6865012705108013, 'auprc': 0.7798744240523101, 'loss_val': 0.9360482525677566, 'psi': 0.7238505319274049}-{'f1_val': 0.6094205247263051, 'auprc': 0.7096670138692418, 'loss_val': 1.143156001602041, 'psi': 0.6495191203834798}
[S13] not sending this round → trigger blocked (psi=0.724)
[S14] START round=76 head_norm_before_train=2.185984 cos_to_last_merge=0.9831 (last merge round=37)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9953058942963702, 'auprc': 0.9969709035307643, 'loss_val': 0.034524089235040606, 'psi': 0.9959718979901279}-{'f1_val': 0.9967774409524363, 'auprc': 0.9986705106251943, 'loss_val': 0.019349668442797757, 'psi': 0.9975346688215394}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=2.277837 (no previous merge yet)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.9174231450961178, 'loss_val': 0.739578813152871, 'psi': 0.7875201062996211}-{'f1_val': 0.7009022883855206, 'auprc': 0.9222188459490976, 'loss_val': 0.704755083310362, 'psi': 0.7894289114109514}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.297958 cos_to_last_merge=0.9940 (last merge round=38)
[S16] round=76 local utility u=0.008039 metrics={'f1_val': 0.9927238206841863, 'auprc': 0.9931809086982136, 'loss_val': 0.046190670735028146, 'psi': 0.9929066558897972}-{'f1_val': 0.9905833695624888, 'auprc': 0.9932779942559821, 'loss_val': 0.049716716626252155, 'psi': 0.9916612194398862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=76 head_norm_before_train=1.966950 cos_to_last_merge=0.9737 (last merge round=40)
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.5922698212396702, 'auprc': 0.8407068763057057, 'loss_val': 1.4018583262166089, 'psi': 0.6916446432660843}-{'f1_val': 0.6311993219281662, 'auprc': 0.7332583975159196, 'loss_val': 1.1511571972721393, 'psi': 0.6720229521632675}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=1.963261 cos_to_last_merge=0.7571 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7605921491857659, 'auprc': 0.8767109845503287, 'loss_val': 0.7882205731209148, 'psi': 0.807039683331591}-{'f1_val': 0.8275044145408343, 'auprc': 0.9922531313504903, 'loss_val': 0.48503204791908233, 'psi': 0.8934039012646967}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.127814 cos_to_last_merge=0.9913 (last merge round=38)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9832152568592551, 'auprc': 0.9962081591269761, 'loss_val': 0.07913274069547702, 'psi': 0.9884124177663435}-{'f1_val': 0.9950619306009424, 'auprc': 0.998507246628707, 'loss_val': 0.024659830259498253, 'psi': 0.9964400570120482}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.113609 cos_to_last_merge=0.9947 (last merge round=39)
[S4] round=77 local utility u=0.102897 metrics={'f1_val': 0.9393111820479456, 'auprc': 0.9545992226188513, 'loss_val': 0.36041064321216587, 'psi': 0.9454263982763078}-{'f1_val': 0.9148581020498375, 'auprc': 0.9525991252764958, 'loss_val': 0.41348669055832366, 'psi': 0.9299545113405009}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=77 head_norm_before_train=2.306669 cos_to_last_merge=0.9925 (last merge round=38)
[S5] round=77 local utility u=0.043833 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9997572589978191, 'loss_val': 0.03043236324182879, 'psi': 0.9985847326103026}-{'f1_val': 0.988467768181715, 'auprc': 0.9904358355535912, 'loss_val': 0.034121684147773015, 'psi': 0.9892549951304654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=77 head_norm_before_train=1.917300 cos_to_last_merge=0.9915 (last merge round=37)
[S6] round=77 local utility u=0.310345 metrics={'f1_val': 0.6862287540331106, 'auprc': 0.9407886756726181, 'loss_val': 0.8745432057068759, 'psi': 0.7880527226889136}-{'f1_val': 0.6210788828995415, 'auprc': 0.9081535335683585, 'loss_val': 1.0064277227680845, 'psi': 0.7359087431670683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=77 head_norm_before_train=2.034874 (no previous merge yet)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5708740358635113, 'auprc': 0.7786213466495681, 'loss_val': 1.0291330474976872, 'psi': 0.653972960177934}-{'f1_val': 0.915103175265571, 'auprc': 0.991591161063594, 'loss_val': 0.15444752172038562, 'psi': 0.9456983695847802}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.014636 cos_to_last_merge=0.9741 (last merge round=39)
[S8] round=77 local utility u=0.055377 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9931521510467823, 'loss_val': 0.039902820868199414, 'psi': 0.9908389916367284}-{'f1_val': 0.9736904608187118, 'auprc': 0.9991273156271239, 'loss_val': 0.0749437198170698, 'psi': 0.9838652027420767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=77 head_norm_before_train=2.183479 cos_to_last_merge=0.9485 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=77 local utility u=0.027488 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984706090196029, 'loss_val': 0.01957563226524843, 'psi': 0.997384550696176}-{'f1_val': 0.9905410059937811, 'auprc': 0.9984560279600927, 'loss_val': 0.03779154650980363, 'psi': 0.9937070147803058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=77 head_norm_before_train=2.266567 cos_to_last_merge=0.9934 (last merge round=40)
[S10] round=77 local utility u=0.000592 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982724856502763, 'loss_val': 0.026524951338352257, 'psi': 0.9961581597917339}-{'f1_val': 0.9947486092193725, 'auprc': 0.9979700505051409, 'loss_val': 0.02680224090386174, 'psi': 0.9960371857336798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=77 head_norm_before_train=1.986141 cos_to_last_merge=0.9892 (last merge round=38)
[S11] round=77 local utility u=0.000118 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9986852148620659, 'loss_val': 0.020108321857697425, 'psi': 0.9974046389418847}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986374020370226, 'loss_val': 0.020200230545923237, 'psi': 0.9973855138118674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=77 head_norm_before_train=2.033661 cos_to_last_merge=0.9880 (last merge round=37)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6039680934931895, 'auprc': 0.7353141257609782, 'loss_val': 1.2729634670382666, 'psi': 0.6565065064003051}-{'f1_val': 0.6865012705108013, 'auprc': 0.7798744240523101, 'loss_val': 0.9360482525677566, 'psi': 0.7238505319274049}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=2.190725 cos_to_last_merge=0.9828 (last merge round=37)
[S14] round=77 local utility u=0.008733 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9969064207681995, 'loss_val': 0.029462500797718148, 'psi': 0.9972058861388704}-{'f1_val': 0.9953058942963702, 'auprc': 0.9969709035307643, 'loss_val': 0.034524089235040606, 'psi': 0.9959718979901279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=77 head_norm_before_train=2.282671 (no previous merge yet)
[S15] round=77 local utility u=1.000000 metrics={'f1_val': 0.9853806569964317, 'auprc': 0.9960372635776893, 'loss_val': 0.036042449808089246, 'psi': 0.9896432996289347}-{'f1_val': 0.7009180804352899, 'auprc': 0.9174231450961178, 'loss_val': 0.739578813152871, 'psi': 0.7875201062996211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=77 head_norm_before_train=2.303206 cos_to_last_merge=0.9939 (last merge round=38)
[S16] round=77 local utility u=0.005223 metrics={'f1_val': 0.9927947506434659, 'auprc': 0.994836543837017, 'loss_val': 0.04113749785246317, 'psi': 0.9936114679208864}-{'f1_val': 0.9927238206841863, 'auprc': 0.9931809086982136, 'loss_val': 0.046190670735028146, 'psi': 0.9929066558897972}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=77 head_norm_before_train=1.969114 cos_to_last_merge=0.9732 (last merge round=40)
[S17] round=77 local utility u=0.130916 metrics={'f1_val': 0.580778608084819, 'auprc': 0.9306818570153674, 'loss_val': 1.3410047763568615, 'psi': 0.7207399076570383}-{'f1_val': 0.5922698212396702, 'auprc': 0.8407068763057057, 'loss_val': 1.4018583262166089, 'psi': 0.6916446432660843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=78 head_norm_before_train=1.966060 cos_to_last_merge=0.7565 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6561741381678157, 'auprc': 0.7554757743630554, 'loss_val': 1.4789409612889408, 'psi': 0.6958947926459116}-{'f1_val': 0.7605921491857659, 'auprc': 0.8767109845503287, 'loss_val': 0.7882205731209148, 'psi': 0.807039683331591}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.131814 cos_to_last_merge=0.9911 (last merge round=38)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.8901176589495048, 'auprc': 0.9402594559888631, 'loss_val': 0.3089743598958219, 'psi': 0.910174377765248}-{'f1_val': 0.9832152568592551, 'auprc': 0.9962081591269761, 'loss_val': 0.07913274069547702, 'psi': 0.9884124177663435}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.117376 cos_to_last_merge=0.9946 (last merge round=39)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.8826909980138762, 'auprc': 0.9511880912583486, 'loss_val': 0.44558813406104253, 'psi': 0.9100898353116652}-{'f1_val': 0.9393111820479456, 'auprc': 0.9545992226188513, 'loss_val': 0.36041064321216587, 'psi': 0.9454263982763078}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=2.309408 cos_to_last_merge=0.9922 (last merge round=38)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9928529158410825, 'loss_val': 0.018503539001294828, 'psi': 0.9951623474235076}-{'f1_val': 0.9978030483519582, 'auprc': 0.9997572589978191, 'loss_val': 0.03043236324182879, 'psi': 0.9985847326103026}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.923269 cos_to_last_merge=0.9914 (last merge round=37)
[S6] round=78 local utility u=0.046099 metrics={'f1_val': 0.7019891069137121, 'auprc': 0.9285401411765031, 'loss_val': 0.8401609396510042, 'psi': 0.7926095206188285}-{'f1_val': 0.6862287540331106, 'auprc': 0.9407886756726181, 'loss_val': 0.8745432057068759, 'psi': 0.7880527226889136}
[S6] not sending this round → trigger blocked (psi=0.793)
[S7] START round=78 head_norm_before_train=2.035254 (no previous merge yet)
[S7] round=78 local utility u=0.143743 metrics={'f1_val': 0.5868684161271096, 'auprc': 0.7823596859838127, 'loss_val': 0.8488280556516592, 'psi': 0.6650649240697908}-{'f1_val': 0.5708740358635113, 'auprc': 0.7786213466495681, 'loss_val': 1.0291330474976872, 'psi': 0.653972960177934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=78 head_norm_before_train=2.018920 cos_to_last_merge=0.9739 (last merge round=39)
[S8] round=78 local utility u=0.020149 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9989602811741579, 'loss_val': 0.032112749761545344, 'psi': 0.994670693167369}-{'f1_val': 0.9892968853633592, 'auprc': 0.9931521510467823, 'loss_val': 0.039902820868199414, 'psi': 0.9908389916367284}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=78 head_norm_before_train=2.188921 cos_to_last_merge=0.9480 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980885861471905, 'loss_val': 0.019666606466512564, 'psi': 0.9972317415472111}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984706090196029, 'loss_val': 0.01957563226524843, 'psi': 0.997384550696176}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.271543 cos_to_last_merge=0.9931 (last merge round=40)
[S10] round=78 local utility u=0.000122 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983328852906156, 'loss_val': 0.02646251027790562, 'psi': 0.9961823196478697}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982724856502763, 'loss_val': 0.026524951338352257, 'psi': 0.9961581597917339}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=78 head_norm_before_train=1.990268 cos_to_last_merge=0.9890 (last merge round=38)
[S11] round=78 local utility u=0.000365 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998929080072265, 'loss_val': 0.020109344364510194, 'psi': 0.9975021850259643}-{'f1_val': 0.9965509216617638, 'auprc': 0.9986852148620659, 'loss_val': 0.020108321857697425, 'psi': 0.9974046389418847}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=78 head_norm_before_train=2.045748 cos_to_last_merge=0.9873 (last merge round=37)
[S13] round=78 local utility u=0.070432 metrics={'f1_val': 0.6180629987650011, 'auprc': 0.7178772031642293, 'loss_val': 1.1643571422752883, 'psi': 0.6579886805246924}-{'f1_val': 0.6039680934931895, 'auprc': 0.7353141257609782, 'loss_val': 1.2729634670382666, 'psi': 0.6565065064003051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=78 head_norm_before_train=2.194803 cos_to_last_merge=0.9824 (last merge round=37)
[S14] round=78 local utility u=0.001759 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9969383364504937, 'loss_val': 0.02706654455696653, 'psi': 0.9973212594581482}-{'f1_val': 0.9974055297193176, 'auprc': 0.9969064207681995, 'loss_val': 0.029462500797718148, 'psi': 0.9972058861388704}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=78 head_norm_before_train=2.287007 (no previous merge yet)
[S15] round=78 local utility u=0.043993 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9974829819088492, 'loss_val': 0.020588694753813228, 'psi': 0.997041193796052}-{'f1_val': 0.9853806569964317, 'auprc': 0.9960372635776893, 'loss_val': 0.036042449808089246, 'psi': 0.9896432996289347}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=78 head_norm_before_train=2.307937 cos_to_last_merge=0.9937 (last merge round=38)
[S16] round=78 local utility u=0.001571 metrics={'f1_val': 0.9925754506651738, 'auprc': 0.9962198480784605, 'loss_val': 0.04083043082505876, 'psi': 0.9940332096304886}-{'f1_val': 0.9927947506434659, 'auprc': 0.994836543837017, 'loss_val': 0.04113749785246317, 'psi': 0.9936114679208864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=78 head_norm_before_train=1.970756 cos_to_last_merge=0.9729 (last merge round=40)
[S17] round=78 local utility u=0.153836 metrics={'f1_val': 0.6036020901215671, 'auprc': 0.9469055156193533, 'loss_val': 1.2189446917098445, 'psi': 0.7409234603206816}-{'f1_val': 0.580778608084819, 'auprc': 0.9306818570153674, 'loss_val': 1.3410047763568615, 'psi': 0.7207399076570383}
[S17] not sending this round → trigger blocked (psi=0.741)
[S2] START round=79 head_norm_before_train=1.971222 cos_to_last_merge=0.7558 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=79 local utility u=0.966726 metrics={'f1_val': 0.7082111886007302, 'auprc': 0.9923500016619567, 'loss_val': 0.5683332837000027, 'psi': 0.8218667138252209}-{'f1_val': 0.6561741381678157, 'auprc': 0.7554757743630554, 'loss_val': 1.4789409612889408, 'psi': 0.6958947926459116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S2] r=80 psi=0.822 u=0.9667 p_local=0.2585 f1=0.708 auprc=0.992 bytes=53974
[S3] START round=79 head_norm_before_train=2.134818 cos_to_last_merge=0.9909 (last merge round=38)
[S3] round=79 local utility u=0.373389 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.997004708566415, 'loss_val': 0.15664749388620483, 'psi': 0.9752940752880468}-{'f1_val': 0.8901176589495048, 'auprc': 0.9402594559888631, 'loss_val': 0.3089743598958219, 'psi': 0.910174377765248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S3] r=80 psi=0.975 u=0.3734 p_local=0.0988 f1=0.961 auprc=0.997 bytes=57572
[S4] START round=79 head_norm_before_train=2.120040 cos_to_last_merge=0.9948 (last merge round=39)
[S4] round=79 local utility u=0.192786 metrics={'f1_val': 0.9356815894136209, 'auprc': 0.9525289819181737, 'loss_val': 0.3819818531274444, 'psi': 0.942420546415442}-{'f1_val': 0.8826909980138762, 'auprc': 0.9511880912583486, 'loss_val': 0.44558813406104253, 'psi': 0.9100898353116652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=80 psi=0.942 u=0.1928 p_local=0.0720 f1=0.936 auprc=0.953 bytes=55763
[S5] START round=79 head_norm_before_train=2.311300 cos_to_last_merge=0.9921 (last merge round=38)
[S5] round=79 local utility u=0.013232 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9998042126351081, 'loss_val': 0.015098153858703427, 'psi': 0.9981634202206818}-{'f1_val': 0.9967019684784577, 'auprc': 0.9928529158410825, 'loss_val': 0.018503539001294828, 'psi': 0.9951623474235076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=80 psi=0.998 u=0.0132 p_local=0.0096 f1=0.997 auprc=1.000 bytes=61175
[S6] START round=79 head_norm_before_train=1.927577 cos_to_last_merge=0.9911 (last merge round=37)
[S6] round=79 local utility u=1.000000 metrics={'f1_val': 0.9775571635931242, 'auprc': 0.9790503585074414, 'loss_val': 0.11175941308420786, 'psi': 0.978154441558851}-{'f1_val': 0.7019891069137121, 'auprc': 0.9285401411765031, 'loss_val': 0.8401609396510042, 'psi': 0.7926095206188285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] sending update (kind=head size=1791 to 1 peers)
[S6] r=80 psi=0.978 u=1.0000 p_local=0.3936 f1=0.978 auprc=0.979 bytes=64768
[S7] START round=79 head_norm_before_train=2.039093 (no previous merge yet)
[S7] round=79 local utility u=0.681571 metrics={'f1_val': 0.7310305830118524, 'auprc': 0.8288024332572814, 'loss_val': 0.48998776997243987, 'psi': 0.770139323110024}-{'f1_val': 0.5868684161271096, 'auprc': 0.7823596859838127, 'loss_val': 0.8488280556516592, 'psi': 0.6650649240697908}
[S7] not sending this round → trigger blocked (psi=0.770)
[S7] r=80 psi=0.770 u=0.6816 p_local=0.3705 f1=0.731 auprc=0.829 bytes=57580
[S8] START round=79 head_norm_before_train=2.021958 cos_to_last_merge=0.9736 (last merge round=39)
[S8] round=79 local utility u=0.004837 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9992062876816272, 'loss_val': 0.029724665525575754, 'psi': 0.9954239686318365}-{'f1_val': 0.9918109678295097, 'auprc': 0.9989602811741579, 'loss_val': 0.032112749761545344, 'psi': 0.994670693167369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=80 psi=0.995 u=0.0048 p_local=0.0837 f1=0.993 auprc=0.999 bytes=57624
[S9] START round=79 head_norm_before_train=2.194961 cos_to_last_merge=0.9475 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.998431420079611, 'loss_val': 0.018205252284678612, 'psi': 0.9971178367172351}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980885861471905, 'loss_val': 0.019666606466512564, 'psi': 0.9972317415472111}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.997 u=0.0000 p_local=0.0060 f1=0.996 auprc=0.998 bytes=54040
[S10] START round=79 head_norm_before_train=2.276515 cos_to_last_merge=0.9929 (last merge round=40)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982563668919417, 'loss_val': 0.02669343366895102, 'psi': 0.9961517122884003}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983328852906156, 'loss_val': 0.02646251027790562, 'psi': 0.9961823196478697}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.998 bytes=62895
[S11] START round=79 head_norm_before_train=1.995097 cos_to_last_merge=0.9888 (last merge round=38)
[S11] round=79 local utility u=0.000020 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989318691166151, 'loss_val': 0.020077091913171592, 'psi': 0.9975033006437044}-{'f1_val': 0.9965509216617638, 'auprc': 0.998929080072265, 'loss_val': 0.020109344364510194, 'psi': 0.9975021850259643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] r=80 psi=0.998 u=0.0000 p_local=0.0006 f1=0.997 auprc=0.999 bytes=66601
[S13] START round=79 head_norm_before_train=2.055204 cos_to_last_merge=0.9867 (last merge round=37)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.591491970022404, 'auprc': 0.7373221358654403, 'loss_val': 1.416154033666771, 'psi': 0.6498240363596184}-{'f1_val': 0.6180629987650011, 'auprc': 0.7178772031642293, 'loss_val': 1.1643571422752883, 'psi': 0.6579886805246924}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.650 u=0.0000 p_local=0.1512 f1=0.591 auprc=0.737 bytes=57590
[S14] START round=79 head_norm_before_train=2.199968 cos_to_last_merge=0.9820 (last merge round=37)
[S14] round=79 local utility u=0.001365 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9969706364317382, 'loss_val': 0.02443343720714326, 'psi': 0.9973341794506461}-{'f1_val': 0.9975765414632514, 'auprc': 0.9969383364504937, 'loss_val': 0.02706654455696653, 'psi': 0.9973212594581482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] r=80 psi=0.997 u=0.0014 p_local=0.0064 f1=0.998 auprc=0.997 bytes=57538
[S15] START round=79 head_norm_before_train=2.291546 (no previous merge yet)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.8949134720945064, 'auprc': 0.9959124642527774, 'loss_val': 0.21504884108531833, 'psi': 0.9353130689578149}-{'f1_val': 0.9967466683875206, 'auprc': 0.9974829819088492, 'loss_val': 0.020588694753813228, 'psi': 0.997041193796052}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.935 u=0.0000 p_local=0.1916 f1=0.895 auprc=0.996 bytes=55742
[S16] START round=79 head_norm_before_train=2.311826 cos_to_last_merge=0.9935 (last merge round=38)
[S16] round=79 local utility u=0.000526 metrics={'f1_val': 0.9925754506651738, 'auprc': 0.9963626484013007, 'loss_val': 0.04020656956657061, 'psi': 0.9940903297596246}-{'f1_val': 0.9925754506651738, 'auprc': 0.9962198480784605, 'loss_val': 0.04083043082505876, 'psi': 0.9940332096304886}
[S16] not sending this round → trigger blocked (psi=0.994)
[S16] r=80 psi=0.994 u=0.0005 p_local=0.0138 f1=0.993 auprc=0.996 bytes=57583
[S17] START round=79 head_norm_before_train=1.968202 cos_to_last_merge=0.9732 (last merge round=40)
[S17] round=79 local utility u=0.433412 metrics={'f1_val': 0.7406454590252518, 'auprc': 0.8023810164112993, 'loss_val': 0.7408071375528232, 'psi': 0.7653396819796707}-{'f1_val': 0.6036020901215671, 'auprc': 0.9469055156193533, 'loss_val': 1.2189446917098445, 'psi': 0.7409234603206816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S17] r=80 psi=0.765 u=0.4334 p_local=0.2488 f1=0.741 auprc=0.802 bytes=61201
[S2] START round=80 head_norm_before_train=1.975571 cos_to_last_merge=0.7557 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=80 local utility u=0.299658 metrics={'f1_val': 0.8285743109063237, 'auprc': 0.8762436446812105, 'loss_val': 0.34287790357384623, 'psi': 0.8476420444162784}-{'f1_val': 0.7082111886007302, 'auprc': 0.9923500016619567, 'loss_val': 0.5683332837000027, 'psi': 0.8218667138252209}
[S2] not sending this round → trigger blocked (psi=0.848)
[S3] START round=80 head_norm_before_train=2.137913 cos_to_last_merge=0.9908 (last merge round=38)
[S3] round=80 local utility u=0.006561 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9955836484222835, 'loss_val': 0.14357116761313793, 'psi': 0.9751565725419219}-{'f1_val': 0.9608203197691346, 'auprc': 0.997004708566415, 'loss_val': 0.15664749388620483, 'psi': 0.9752940752880468}
[S3] not sending this round → trigger blocked (psi=0.975)
[S4] START round=80 head_norm_before_train=2.121593 cos_to_last_merge=0.9948 (last merge round=39)
[S4] round=80 local utility u=0.060098 metrics={'f1_val': 0.9433413740893108, 'auprc': 0.962503226414873, 'loss_val': 0.3376679996494439, 'psi': 0.9510061150195357}-{'f1_val': 0.9356815894136209, 'auprc': 0.9525289819181737, 'loss_val': 0.3819818531274444, 'psi': 0.942420546415442}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=80 head_norm_before_train=2.305243 cos_to_last_merge=0.9917 (last merge round=38)
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9998089717209131, 'loss_val': 0.01748974544308409, 'psi': 0.9983855393999606}-{'f1_val': 0.9970695586110643, 'auprc': 0.9998042126351081, 'loss_val': 0.015098153858703427, 'psi': 0.9981634202206818}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=1.931710 cos_to_last_merge=0.9908 (last merge round=37)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.8822140251692661, 'auprc': 0.9747016249537593, 'loss_val': 0.29639241379970355, 'psi': 0.9192090650830633}-{'f1_val': 0.9775571635931242, 'auprc': 0.9790503585074414, 'loss_val': 0.11175941308420786, 'psi': 0.978154441558851}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=2.049406 (no previous merge yet)
[S7] round=80 local utility u=0.526463 metrics={'f1_val': 0.8266786615104262, 'auprc': 0.9436749948772466, 'loss_val': 0.35556726630259333, 'psi': 0.8734771948571544}-{'f1_val': 0.7310305830118524, 'auprc': 0.8288024332572814, 'loss_val': 0.48998776997243987, 'psi': 0.770139323110024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=80 head_norm_before_train=2.026429 cos_to_last_merge=0.9732 (last merge round=39)
[S8] round=80 local utility u=0.001007 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9992584328904682, 'loss_val': 0.02958905843164402, 'psi': 0.995616989313683}-{'f1_val': 0.9929024225986427, 'auprc': 0.9992062876816272, 'loss_val': 0.029724665525575754, 'psi': 0.9954239686318365}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=80 head_norm_before_train=2.201744 cos_to_last_merge=0.9470 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=80 local utility u=0.002938 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998423694799072, 'loss_val': 0.017470441197958805, 'psi': 0.9976312254269145}-{'f1_val': 0.9962421144756511, 'auprc': 0.998431420079611, 'loss_val': 0.018205252284678612, 'psi': 0.9971178367172351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=80 head_norm_before_train=2.279958 cos_to_last_merge=0.9928 (last merge round=40)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981497387099677, 'loss_val': 0.026783090315313323, 'psi': 0.9961090610156106}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982563668919417, 'loss_val': 0.02669343366895102, 'psi': 0.9961517122884003}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.000200 cos_to_last_merge=0.9885 (last merge round=38)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9943872065727898, 'auprc': 0.9989291421646622, 'loss_val': 0.025752170412949218, 'psi': 0.9962039808095388}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989318691166151, 'loss_val': 0.020077091913171592, 'psi': 0.9975033006437044}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=2.061814 cos_to_last_merge=0.9862 (last merge round=37)
[S13] round=80 local utility u=0.087974 metrics={'f1_val': 0.5921392596920048, 'auprc': 0.7747120211672011, 'loss_val': 1.3562590191128747, 'psi': 0.6651683642820833}-{'f1_val': 0.591491970022404, 'auprc': 0.7373221358654403, 'loss_val': 1.416154033666771, 'psi': 0.6498240363596184}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=80 head_norm_before_train=2.204329 cos_to_last_merge=0.9816 (last merge round=37)
[S14] round=80 local utility u=0.002421 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9969769868550069, 'loss_val': 0.01976086682763262, 'psi': 0.9973517266220069}-{'f1_val': 0.9975765414632514, 'auprc': 0.9969706364317382, 'loss_val': 0.02443343720714326, 'psi': 0.9973341794506461}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=80 head_norm_before_train=2.296086 (no previous merge yet)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.8925501693682097, 'auprc': 0.9958094481657449, 'loss_val': 0.23930450683652257, 'psi': 0.9338538808872239}-{'f1_val': 0.8949134720945064, 'auprc': 0.9959124642527774, 'loss_val': 0.21504884108531833, 'psi': 0.9353130689578149}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.315450 cos_to_last_merge=0.9933 (last merge round=38)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.993399047037773, 'auprc': 0.990594146556603, 'loss_val': 0.04079310897572788, 'psi': 0.992277086845305}-{'f1_val': 0.9925754506651738, 'auprc': 0.9963626484013007, 'loss_val': 0.04020656956657061, 'psi': 0.9940903297596246}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=1.969075 cos_to_last_merge=0.9731 (last merge round=40)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.550066389051576, 'auprc': 0.7252807350975562, 'loss_val': 1.3731870711684606, 'psi': 0.6201521274699682}-{'f1_val': 0.7406454590252518, 'auprc': 0.8023810164112993, 'loss_val': 0.7408071375528232, 'psi': 0.7653396819796707}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=1.976088 cos_to_last_merge=0.7554 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=81 local utility u=0.117774 metrics={'f1_val': 0.8262128771395064, 'auprc': 0.9901435507802847, 'loss_val': 0.4348611734660729, 'psi': 0.8917851465958178}-{'f1_val': 0.8285743109063237, 'auprc': 0.8762436446812105, 'loss_val': 0.34287790357384623, 'psi': 0.8476420444162784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=81 head_norm_before_train=2.143001 cos_to_last_merge=0.9905 (last merge round=38)
[S3] round=81 local utility u=0.021065 metrics={'f1_val': 0.9629245758879437, 'auprc': 0.9970088006035186, 'loss_val': 0.11403204949041142, 'psi': 0.9765582657741736}-{'f1_val': 0.9615385219550141, 'auprc': 0.9955836484222835, 'loss_val': 0.14357116761313793, 'psi': 0.9751565725419219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=81 head_norm_before_train=2.123595 cos_to_last_merge=0.9947 (last merge round=39)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9386129047693854, 'auprc': 0.9460994074684981, 'loss_val': 0.3728862712150924, 'psi': 0.9416075058490304}-{'f1_val': 0.9433413740893108, 'auprc': 0.962503226414873, 'loss_val': 0.3376679996494439, 'psi': 0.9510061150195357}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.307411 cos_to_last_merge=0.9915 (last merge round=38)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9996577732122441, 'loss_val': 0.025755788650883498, 'psi': 0.9983250599964929}-{'f1_val': 0.9974365845193254, 'auprc': 0.9998089717209131, 'loss_val': 0.01748974544308409, 'psi': 0.9983855393999606}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=1.937389 cos_to_last_merge=0.9904 (last merge round=37)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6107036284280198, 'auprc': 0.8881716863007574, 'loss_val': 1.0766972867477744, 'psi': 0.7216908515771149}-{'f1_val': 0.8822140251692661, 'auprc': 0.9747016249537593, 'loss_val': 0.29639241379970355, 'psi': 0.9192090650830633}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=2.057927 (no previous merge yet)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6510508870387791, 'auprc': 0.8053958661637088, 'loss_val': 0.5769087686356859, 'psi': 0.7127888786887511}-{'f1_val': 0.8266786615104262, 'auprc': 0.9436749948772466, 'loss_val': 0.35556726630259333, 'psi': 0.8734771948571544}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.032807 cos_to_last_merge=0.9728 (last merge round=39)
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9690594748738162, 'auprc': 0.9957760643571961, 'loss_val': 0.09637076837884885, 'psi': 0.9797461106671681}-{'f1_val': 0.9931893602624928, 'auprc': 0.9992584328904682, 'loss_val': 0.02958905843164402, 'psi': 0.995616989313683}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=2.206840 cos_to_last_merge=0.9464 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=81 local utility u=0.000398 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9984040051487475, 'loss_val': 0.016598165474099962, 'psi': 0.997621631783037}-{'f1_val': 0.9971029125121428, 'auprc': 0.998423694799072, 'loss_val': 0.017470441197958805, 'psi': 0.9976312254269145}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=81 head_norm_before_train=2.283489 cos_to_last_merge=0.9927 (last merge round=40)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9979848531754207, 'loss_val': 0.026517513977767384, 'psi': 0.9960431068017919}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981497387099677, 'loss_val': 0.026783090315313323, 'psi': 0.9961090610156106}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.005284 cos_to_last_merge=0.9882 (last merge round=38)
[S11] round=81 local utility u=0.009409 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989283776947937, 'loss_val': 0.019914199789874066, 'psi': 0.9975019040749759}-{'f1_val': 0.9943872065727898, 'auprc': 0.9989291421646622, 'loss_val': 0.025752170412949218, 'psi': 0.9962039808095388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=81 head_norm_before_train=2.066033 cos_to_last_merge=0.9859 (last merge round=37)
[S13] round=81 local utility u=0.405234 metrics={'f1_val': 0.6548672235523447, 'auprc': 0.7771710699916553, 'loss_val': 0.9295366477906777, 'psi': 0.703788762128069}-{'f1_val': 0.5921392596920048, 'auprc': 0.7747120211672011, 'loss_val': 1.3562590191128747, 'psi': 0.6651683642820833}
[S13] not sending this round → trigger blocked (psi=0.704)
[S14] START round=81 head_norm_before_train=2.206770 cos_to_last_merge=0.9812 (last merge round=37)
[S14] round=81 local utility u=0.001983 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986730694578847, 'loss_val': 0.018402584131856047, 'psi': 0.9977821489852678}-{'f1_val': 0.9976015531333403, 'auprc': 0.9969769868550069, 'loss_val': 0.01976086682763262, 'psi': 0.9973517266220069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=81 head_norm_before_train=2.301034 (no previous merge yet)
[S15] round=81 local utility u=0.117140 metrics={'f1_val': 0.916398087889179, 'auprc': 0.9957115912317882, 'loss_val': 0.14781913726649878, 'psi': 0.9481234892262227}-{'f1_val': 0.8925501693682097, 'auprc': 0.9958094481657449, 'loss_val': 0.23930450683652257, 'psi': 0.9338538808872239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=81 head_norm_before_train=2.318228 cos_to_last_merge=0.9932 (last merge round=38)
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9907740792833173, 'loss_val': 0.03929891754651736, 'psi': 0.9920201390580505}-{'f1_val': 0.993399047037773, 'auprc': 0.990594146556603, 'loss_val': 0.04079310897572788, 'psi': 0.992277086845305}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.972077 cos_to_last_merge=0.9727 (last merge round=40)
[S17] round=81 local utility u=0.292311 metrics={'f1_val': 0.5989026526144999, 'auprc': 0.7568016305481355, 'loss_val': 1.1761444176538611, 'psi': 0.6620622437879542}-{'f1_val': 0.550066389051576, 'auprc': 0.7252807350975562, 'loss_val': 1.3731870711684606, 'psi': 0.6201521274699682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=82 head_norm_before_train=1.976743 cos_to_last_merge=0.7551 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.8226781361483706, 'auprc': 0.9200576484392685, 'loss_val': 0.48255400574658397, 'psi': 0.8616299410647298}-{'f1_val': 0.8262128771395064, 'auprc': 0.9901435507802847, 'loss_val': 0.4348611734660729, 'psi': 0.8917851465958178}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.148962 cos_to_last_merge=0.9903 (last merge round=38)
[S3] round=82 local utility u=0.042217 metrics={'f1_val': 0.9737928150552124, 'auprc': 0.9963811551889492, 'loss_val': 0.09292536761946944, 'psi': 0.9828281511087071}-{'f1_val': 0.9629245758879437, 'auprc': 0.9970088006035186, 'loss_val': 0.11403204949041142, 'psi': 0.9765582657741736}
[S3] not sending this round → trigger blocked (psi=0.983)
[S4] START round=82 head_norm_before_train=2.125623 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.8141901398389941, 'auprc': 0.9216973472913994, 'loss_val': 0.5582951937632329, 'psi': 0.8571930228199562}-{'f1_val': 0.9386129047693854, 'auprc': 0.9460994074684981, 'loss_val': 0.3728862712150924, 'psi': 0.9416075058490304}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=2.315334 cos_to_last_merge=0.9914 (last merge round=38)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9978030483519582, 'auprc': 0.9997259701750918, 'loss_val': 0.03936303208806016, 'psi': 0.9985722170812117}-{'f1_val': 0.9974365845193254, 'auprc': 0.9996577732122441, 'loss_val': 0.025755788650883498, 'psi': 0.9983250599964929}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.940092 cos_to_last_merge=0.9895 (last merge round=37)
[S6] round=82 local utility u=1.000000 metrics={'f1_val': 0.958458646176509, 'auprc': 0.9762995611420503, 'loss_val': 0.1742606369360243, 'psi': 0.9655950121627255}-{'f1_val': 0.6107036284280198, 'auprc': 0.8881716863007574, 'loss_val': 1.0766972867477744, 'psi': 0.7216908515771149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=82 head_norm_before_train=2.067291 (no previous merge yet)
[S7] round=82 local utility u=0.806322 metrics={'f1_val': 0.7988136375470379, 'auprc': 0.9557653644747428, 'loss_val': 0.3019501658987744, 'psi': 0.8615943283181199}-{'f1_val': 0.6510508870387791, 'auprc': 0.8053958661637088, 'loss_val': 0.5769087686356859, 'psi': 0.7127888786887511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=82 head_norm_before_train=2.037000 cos_to_last_merge=0.9726 (last merge round=39)
[S8] round=82 local utility u=0.110552 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9992485285574345, 'loss_val': 0.028944035241935232, 'psi': 0.9954611207880679}-{'f1_val': 0.9690594748738162, 'auprc': 0.9957760643571961, 'loss_val': 0.09637076837884885, 'psi': 0.9797461106671681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=82 head_norm_before_train=2.210835 cos_to_last_merge=0.9460 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985051245296872, 'loss_val': 0.01747538207890565, 'psi': 0.9976637973191606}-{'f1_val': 0.9971000495392299, 'auprc': 0.9984040051487475, 'loss_val': 0.016598165474099962, 'psi': 0.997621631783037}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.287576 cos_to_last_merge=0.9925 (last merge round=40)
[S10] round=82 local utility u=0.000409 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982007355902368, 'loss_val': 0.026347215497547382, 'psi': 0.9961294597677182}-{'f1_val': 0.9947486092193725, 'auprc': 0.9979848531754207, 'loss_val': 0.026517513977767384, 'psi': 0.9960431068017919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=82 head_norm_before_train=2.010060 cos_to_last_merge=0.9880 (last merge round=38)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986372716722032, 'loss_val': 0.020508292574239185, 'psi': 0.9972403594391024}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989283776947937, 'loss_val': 0.019914199789874066, 'psi': 0.9975019040749759}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.071523 cos_to_last_merge=0.9854 (last merge round=37)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6034733293835143, 'auprc': 0.6923200448635889, 'loss_val': 1.3412564625287515, 'psi': 0.6390120155755441}-{'f1_val': 0.6548672235523447, 'auprc': 0.7771710699916553, 'loss_val': 0.9295366477906777, 'psi': 0.703788762128069}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=2.212434 cos_to_last_merge=0.9809 (last merge round=37)
[S14] round=82 local utility u=0.000178 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986723085102558, 'loss_val': 0.01804358720427835, 'psi': 0.9977818446062163}-{'f1_val': 0.9971882020035234, 'auprc': 0.9986730694578847, 'loss_val': 0.018402584131856047, 'psi': 0.9977821489852678}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=82 head_norm_before_train=2.305999 (no previous merge yet)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9069867346131365, 'auprc': 0.9966002177982223, 'loss_val': 0.2080407063260202, 'psi': 0.9428321278871707}-{'f1_val': 0.916398087889179, 'auprc': 0.9957115912317882, 'loss_val': 0.14781913726649878, 'psi': 0.9481234892262227}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.320932 cos_to_last_merge=0.9931 (last merge round=38)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9885644580392532, 'auprc': 0.9907465731457858, 'loss_val': 0.05703438774618259, 'psi': 0.9894373040818663}-{'f1_val': 0.9928508455745393, 'auprc': 0.9907740792833173, 'loss_val': 0.03929891754651736, 'psi': 0.9920201390580505}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.978467 cos_to_last_merge=0.9723 (last merge round=40)
[S17] round=82 local utility u=0.000000 metrics={'f1_val': 0.6001208040080971, 'auprc': 0.7661183199292714, 'loss_val': 1.241139868116592, 'psi': 0.6665198103765668}-{'f1_val': 0.5989026526144999, 'auprc': 0.7568016305481355, 'loss_val': 1.1761444176538611, 'psi': 0.6620622437879542}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=83 head_norm_before_train=1.979741 cos_to_last_merge=0.7548 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7543542350949632, 'auprc': 0.8553062951655177, 'loss_val': 0.7374211318726209, 'psi': 0.794735059123185}-{'f1_val': 0.8226781361483706, 'auprc': 0.9200576484392685, 'loss_val': 0.48255400574658397, 'psi': 0.8616299410647298}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.154825 cos_to_last_merge=0.9900 (last merge round=38)
[S3] round=83 local utility u=0.053573 metrics={'f1_val': 0.9850448311508235, 'auprc': 0.9971977847788467, 'loss_val': 0.05574226039004389, 'psi': 0.9899060126020327}-{'f1_val': 0.9737928150552124, 'auprc': 0.9963811551889492, 'loss_val': 0.09292536761946944, 'psi': 0.9828281511087071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=83 head_norm_before_train=2.127265 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=83 local utility u=0.495655 metrics={'f1_val': 0.9382907445400457, 'auprc': 0.9431869293158869, 'loss_val': 0.37605746831293974, 'psi': 0.9402492184503821}-{'f1_val': 0.8141901398389941, 'auprc': 0.9216973472913994, 'loss_val': 0.5582951937632329, 'psi': 0.8571930228199562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=83 head_norm_before_train=2.314315 cos_to_last_merge=0.9910 (last merge round=38)
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.9903644822424971, 'auprc': 0.9915189088575517, 'loss_val': 0.031551800005832874, 'psi': 0.990826252888519}-{'f1_val': 0.9978030483519582, 'auprc': 0.9997259701750918, 'loss_val': 0.03936303208806016, 'psi': 0.9985722170812117}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=1.942304 cos_to_last_merge=0.9891 (last merge round=37)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.8761898852985455, 'auprc': 0.9722453292457167, 'loss_val': 0.33543508118368803, 'psi': 0.9146120628774139}-{'f1_val': 0.958458646176509, 'auprc': 0.9762995611420503, 'loss_val': 0.1742606369360243, 'psi': 0.9655950121627255}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=2.077272 (no previous merge yet)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.8211314297407927, 'auprc': 0.9358112595007639, 'loss_val': 0.46793044393895455, 'psi': 0.8670033616447812}-{'f1_val': 0.7988136375470379, 'auprc': 0.9557653644747428, 'loss_val': 0.3019501658987744, 'psi': 0.8615943283181199}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.040956 cos_to_last_merge=0.9724 (last merge round=39)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9770788825400718, 'auprc': 0.9992729454149167, 'loss_val': 0.06636816063862602, 'psi': 0.9859565076900098}-{'f1_val': 0.9929361822751569, 'auprc': 0.9992485285574345, 'loss_val': 0.028944035241935232, 'psi': 0.9954611207880679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.217312 cos_to_last_merge=0.9454 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985208986419181, 'loss_val': 0.01753553191194574, 'psi': 0.9976701069640529}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985051245296872, 'loss_val': 0.01747538207890565, 'psi': 0.9976637973191606}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.289971 cos_to_last_merge=0.9925 (last merge round=40)
[S10] round=83 local utility u=0.000077 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982507276642779, 'loss_val': 0.026344061352054277, 'psi': 0.9961494565973347}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982007355902368, 'loss_val': 0.026347215497547382, 'psi': 0.9961294597677182}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=83 head_norm_before_train=2.015033 cos_to_last_merge=0.9877 (last merge round=38)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.987485090280092, 'auprc': 0.9988148610371101, 'loss_val': 0.045546278646959246, 'psi': 0.9920169985828993}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986372716722032, 'loss_val': 0.020508292574239185, 'psi': 0.9972403594391024}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=2.078062 cos_to_last_merge=0.9850 (last merge round=37)
[S13] round=83 local utility u=0.330828 metrics={'f1_val': 0.6565125533530181, 'auprc': 0.7762357868978509, 'loss_val': 1.24958321541018, 'psi': 0.7044018467709512}-{'f1_val': 0.6034733293835143, 'auprc': 0.6923200448635889, 'loss_val': 1.3412564625287515, 'psi': 0.6390120155755441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=83 head_norm_before_train=2.217904 cos_to_last_merge=0.9808 (last merge round=37)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9986701347463324, 'loss_val': 0.01866639503291042, 'psi': 0.997780975100647}-{'f1_val': 0.9971882020035234, 'auprc': 0.9986723085102558, 'loss_val': 0.01804358720427835, 'psi': 0.9977818446062163}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.311163 (no previous merge yet)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.8037949325813274, 'auprc': 0.9941898808540828, 'loss_val': 0.49180913566724316, 'psi': 0.8799529118904295}-{'f1_val': 0.9069867346131365, 'auprc': 0.9966002177982223, 'loss_val': 0.2080407063260202, 'psi': 0.9428321278871707}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.325303 cos_to_last_merge=0.9929 (last merge round=38)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9066864423174834, 'auprc': 0.9838946920183562, 'loss_val': 0.2972061514367443, 'psi': 0.9375697421978326}-{'f1_val': 0.9885644580392532, 'auprc': 0.9907465731457858, 'loss_val': 0.05703438774618259, 'psi': 0.9894373040818663}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.985365 cos_to_last_merge=0.9717 (last merge round=40)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.5838103453912593, 'auprc': 0.7796198588865311, 'loss_val': 1.360616317382216, 'psi': 0.662134150789368}-{'f1_val': 0.6001208040080971, 'auprc': 0.7661183199292714, 'loss_val': 1.241139868116592, 'psi': 0.6665198103765668}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=1.980859 cos_to_last_merge=0.7541 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=84 local utility u=0.342885 metrics={'f1_val': 0.7540593811620767, 'auprc': 0.9907987609078424, 'loss_val': 0.4563602769566483, 'psi': 0.848755133060383}-{'f1_val': 0.7543542350949632, 'auprc': 0.8553062951655177, 'loss_val': 0.7374211318726209, 'psi': 0.794735059123185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=84 head_norm_before_train=2.159796 cos_to_last_merge=0.9898 (last merge round=38)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.9102625452778917, 'auprc': 0.9666116957050901, 'loss_val': 0.2769931018794445, 'psi': 0.9328022054487711}-{'f1_val': 0.9850448311508235, 'auprc': 0.9971977847788467, 'loss_val': 0.05574226039004389, 'psi': 0.9899060126020327}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.121974 cos_to_last_merge=0.9944 (last merge round=39)
[S4] round=84 local utility u=0.072479 metrics={'f1_val': 0.9495545244055626, 'auprc': 0.956666976738544, 'loss_val': 0.33912153186535526, 'psi': 0.9523995053387551}-{'f1_val': 0.9382907445400457, 'auprc': 0.9431869293158869, 'loss_val': 0.37605746831293974, 'psi': 0.9402492184503821}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=84 head_norm_before_train=2.317733 cos_to_last_merge=0.9908 (last merge round=38)
[S5] round=84 local utility u=0.041282 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9998792189881349, 'loss_val': 0.014298205135593281, 'psi': 0.9981934227618926}-{'f1_val': 0.9903644822424971, 'auprc': 0.9915189088575517, 'loss_val': 0.031551800005832874, 'psi': 0.990826252888519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=84 head_norm_before_train=1.944982 cos_to_last_merge=0.9889 (last merge round=37)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.7589903498317989, 'auprc': 0.9540371961110402, 'loss_val': 0.6835237179818652, 'psi': 0.8370090883434954}-{'f1_val': 0.8761898852985455, 'auprc': 0.9722453292457167, 'loss_val': 0.33543508118368803, 'psi': 0.9146120628774139}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=2.086801 (no previous merge yet)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6844204860483245, 'auprc': 0.8741592737174863, 'loss_val': 0.5224656502518072, 'psi': 0.7603160011159893}-{'f1_val': 0.8211314297407927, 'auprc': 0.9358112595007639, 'loss_val': 0.46793044393895455, 'psi': 0.8670033616447812}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.047297 cos_to_last_merge=0.9721 (last merge round=39)
[S8] round=84 local utility u=0.026190 metrics={'f1_val': 0.9829227792597723, 'auprc': 0.9993900853737332, 'loss_val': 0.049403869072511125, 'psi': 0.9895097017053567}-{'f1_val': 0.9770788825400718, 'auprc': 0.9992729454149167, 'loss_val': 0.06636816063862602, 'psi': 0.9859565076900098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=84 head_norm_before_train=2.222433 cos_to_last_merge=0.9449 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9920865114751727, 'auprc': 0.9983638849808013, 'loss_val': 0.0258954542104441, 'psi': 0.9945974608774241}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985208986419181, 'loss_val': 0.01753553191194574, 'psi': 0.9976701069640529}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.293454 cos_to_last_merge=0.9923 (last merge round=40)
[S10] round=84 local utility u=0.000197 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983723602780197, 'loss_val': 0.026315765144961624, 'psi': 0.9961981096428314}-{'f1_val': 0.9947486092193725, 'auprc': 0.9982507276642779, 'loss_val': 0.026344061352054277, 'psi': 0.9961494565973347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=84 head_norm_before_train=2.019722 cos_to_last_merge=0.9875 (last merge round=38)
[S11] round=84 local utility u=0.039951 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9987755189487486, 'loss_val': 0.019921942845632024, 'psi': 0.9974407605765578}-{'f1_val': 0.987485090280092, 'auprc': 0.9988148610371101, 'loss_val': 0.045546278646959246, 'psi': 0.9920169985828993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=84 head_norm_before_train=2.082408 cos_to_last_merge=0.9846 (last merge round=37)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.5905177308322339, 'auprc': 0.6908976796654972, 'loss_val': 1.4284832451561331, 'psi': 0.6306697103655392}-{'f1_val': 0.6565125533530181, 'auprc': 0.7762357868978509, 'loss_val': 1.24958321541018, 'psi': 0.7044018467709512}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=2.221926 cos_to_last_merge=0.9805 (last merge round=37)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9587309102012667, 'auprc': 0.999012633947928, 'loss_val': 0.056137549438516704, 'psi': 0.9748435996999312}-{'f1_val': 0.9971882020035234, 'auprc': 0.9986701347463324, 'loss_val': 0.01866639503291042, 'psi': 0.997780975100647}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.316396 (no previous merge yet)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.7148542342604479, 'auprc': 0.990369137911592, 'loss_val': 0.6410992905229053, 'psi': 0.8250601957209056}-{'f1_val': 0.8037949325813274, 'auprc': 0.9941898808540828, 'loss_val': 0.49180913566724316, 'psi': 0.8799529118904295}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.330766 cos_to_last_merge=0.9927 (last merge round=38)
[S16] round=84 local utility u=0.388675 metrics={'f1_val': 0.9919307115245445, 'auprc': 0.9882071520206934, 'loss_val': 0.04425949452608772, 'psi': 0.990441287723004}-{'f1_val': 0.9066864423174834, 'auprc': 0.9838946920183562, 'loss_val': 0.2972061514367443, 'psi': 0.9375697421978326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=84 head_norm_before_train=1.991449 cos_to_last_merge=0.9710 (last merge round=40)
[S17] round=84 local utility u=0.424114 metrics={'f1_val': 0.6404916257687461, 'auprc': 0.8791365560782144, 'loss_val': 1.1510264173983573, 'psi': 0.7359495978925334}-{'f1_val': 0.5838103453912593, 'auprc': 0.7796198588865311, 'loss_val': 1.360616317382216, 'psi': 0.662134150789368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=85 head_norm_before_train=1.984859 cos_to_last_merge=0.7537 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=85 local utility u=0.270624 metrics={'f1_val': 0.8273716352751951, 'auprc': 0.9910499076691923, 'loss_val': 0.3557387308170032, 'psi': 0.892842944232794}-{'f1_val': 0.7540593811620767, 'auprc': 0.9907987609078424, 'loss_val': 0.4563602769566483, 'psi': 0.848755133060383}
[S2] not sending this round → trigger blocked (psi=0.893)
[S3] START round=85 head_norm_before_train=2.163615 cos_to_last_merge=0.9896 (last merge round=38)
[S3] round=85 local utility u=0.429408 metrics={'f1_val': 0.996729136408276, 'auprc': 0.9978380942351579, 'loss_val': 0.030656741176957075, 'psi': 0.9971727195390288}-{'f1_val': 0.9102625452778917, 'auprc': 0.9666116957050901, 'loss_val': 0.2769931018794445, 'psi': 0.9328022054487711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=85 head_norm_before_train=2.110208 cos_to_last_merge=0.9946 (last merge round=39)
[S4] round=85 local utility u=0.033845 metrics={'f1_val': 0.9508118729242508, 'auprc': 0.9724376938356691, 'loss_val': 0.3262881716027876, 'psi': 0.9594622012888181}-{'f1_val': 0.9495545244055626, 'auprc': 0.956666976738544, 'loss_val': 0.33912153186535526, 'psi': 0.9523995053387551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=85 head_norm_before_train=2.320625 cos_to_last_merge=0.9906 (last merge round=38)
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9967536469391907, 'loss_val': 0.017840337525118356, 'psi': 0.9967226398627509}-{'f1_val': 0.9970695586110643, 'auprc': 0.9998792189881349, 'loss_val': 0.014298205135593281, 'psi': 0.9981934227618926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.948500 cos_to_last_merge=0.9894 (last merge round=37)
[S6] round=85 local utility u=0.602495 metrics={'f1_val': 0.8785087059738643, 'auprc': 0.971352860865234, 'loss_val': 0.24759034481111597, 'psi': 0.9156463679304121}-{'f1_val': 0.7589903498317989, 'auprc': 0.9540371961110402, 'loss_val': 0.6835237179818652, 'psi': 0.8370090883434954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=85 head_norm_before_train=2.096517 (no previous merge yet)
[S7] round=85 local utility u=0.569093 metrics={'f1_val': 0.819454993934233, 'auprc': 0.9561196143580599, 'loss_val': 0.4403672234246205, 'psi': 0.8741208421037638}-{'f1_val': 0.6844204860483245, 'auprc': 0.8741592737174863, 'loss_val': 0.5224656502518072, 'psi': 0.7603160011159893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=85 head_norm_before_train=2.050792 cos_to_last_merge=0.9717 (last merge round=39)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9832945426381587, 'auprc': 0.9963830716924632, 'loss_val': 0.05337035231502898, 'psi': 0.9885299542598806}-{'f1_val': 0.9829227792597723, 'auprc': 0.9993900853737332, 'loss_val': 0.049403869072511125, 'psi': 0.9895097017053567}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=2.226613 cos_to_last_merge=0.9444 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=85 local utility u=0.019531 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998447940654419, 'loss_val': 0.01718369460997178, 'psi': 0.9976409237690533}-{'f1_val': 0.9920865114751727, 'auprc': 0.9983638849808013, 'loss_val': 0.0258954542104441, 'psi': 0.9945974608774241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=85 head_norm_before_train=2.297515 cos_to_last_merge=0.9922 (last merge round=40)
[S10] round=85 local utility u=0.000064 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9984329826349541, 'loss_val': 0.026368854829527666, 'psi': 0.9962223585856051}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983723602780197, 'loss_val': 0.026315765144961624, 'psi': 0.9961981096428314}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=85 head_norm_before_train=2.023423 cos_to_last_merge=0.9873 (last merge round=38)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9984313887734614, 'loss_val': 0.021678289273741356, 'psi': 0.9971580062796057}-{'f1_val': 0.9965509216617638, 'auprc': 0.9987755189487486, 'loss_val': 0.019921942845632024, 'psi': 0.9974407605765578}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.085038 cos_to_last_merge=0.9845 (last merge round=37)
[S13] round=85 local utility u=0.544140 metrics={'f1_val': 0.6962730221876214, 'auprc': 0.7322259421308763, 'loss_val': 1.0987197414939809, 'psi': 0.7106541901649234}-{'f1_val': 0.5905177308322339, 'auprc': 0.6908976796654972, 'loss_val': 1.4284832451561331, 'psi': 0.6306697103655392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=85 head_norm_before_train=2.224142 cos_to_last_merge=0.9800 (last merge round=37)
[S14] round=85 local utility u=0.113543 metrics={'f1_val': 0.9940755032987544, 'auprc': 0.997070980752846, 'loss_val': 0.03529429840122435, 'psi': 0.995273694280391}-{'f1_val': 0.9587309102012667, 'auprc': 0.999012633947928, 'loss_val': 0.056137549438516704, 'psi': 0.9748435996999312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=85 head_norm_before_train=2.321331 (no previous merge yet)
[S15] round=85 local utility u=0.668411 metrics={'f1_val': 0.8749008918196974, 'auprc': 0.9938113258543397, 'loss_val': 0.2748836684079132, 'psi': 0.9224650654335544}-{'f1_val': 0.7148542342604479, 'auprc': 0.990369137911592, 'loss_val': 0.6410992905229053, 'psi': 0.8250601957209056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=85 head_norm_before_train=2.334914 cos_to_last_merge=0.9926 (last merge round=38)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9921054438842623, 'auprc': 0.9863040597698891, 'loss_val': 0.04843845423121563, 'psi': 0.989784890238513}-{'f1_val': 0.9919307115245445, 'auprc': 0.9882071520206934, 'loss_val': 0.04425949452608772, 'psi': 0.990441287723004}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.996185 cos_to_last_merge=0.9705 (last merge round=40)
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.6387026605640328, 'auprc': 0.8154771548946633, 'loss_val': 1.1126097170766787, 'psi': 0.7094124582962851}-{'f1_val': 0.6404916257687461, 'auprc': 0.8791365560782144, 'loss_val': 1.1510264173983573, 'psi': 0.7359495978925334}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=1.989004 cos_to_last_merge=0.7530 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7304551110662745, 'auprc': 0.9920633413471704, 'loss_val': 0.4262628588208146, 'psi': 0.8350984031786328}-{'f1_val': 0.8273716352751951, 'auprc': 0.9910499076691923, 'loss_val': 0.3557387308170032, 'psi': 0.892842944232794}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.165313 cos_to_last_merge=0.9894 (last merge round=38)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9977021742632306, 'loss_val': 0.15208947738875658, 'psi': 0.9756783221849938}-{'f1_val': 0.996729136408276, 'auprc': 0.9978380942351579, 'loss_val': 0.030656741176957075, 'psi': 0.9971727195390288}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=2.100066 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9379745363429597, 'auprc': 0.9538796364855694, 'loss_val': 0.37778228787679397, 'psi': 0.9443365764000036}-{'f1_val': 0.9508118729242508, 'auprc': 0.9724376938356691, 'loss_val': 0.3262881716027876, 'psi': 0.9594622012888181}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=2.327784 cos_to_last_merge=0.9904 (last merge round=38)
[S5] round=86 local utility u=0.005655 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9996904664802654, 'loss_val': 0.019749059748096147, 'psi': 0.9983381373037015}-{'f1_val': 0.9967019684784577, 'auprc': 0.9967536469391907, 'loss_val': 0.017840337525118356, 'psi': 0.9967226398627509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=86 head_norm_before_train=1.954453 cos_to_last_merge=0.9898 (last merge round=37)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7146582820340833, 'auprc': 0.8930698525206713, 'loss_val': 0.6832948778791406, 'psi': 0.7860229102287185}-{'f1_val': 0.8785087059738643, 'auprc': 0.971352860865234, 'loss_val': 0.24759034481111597, 'psi': 0.9156463679304121}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=2.108330 (no previous merge yet)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.738381473209238, 'auprc': 0.8812040352363038, 'loss_val': 0.6746418871287251, 'psi': 0.7955104980200642}-{'f1_val': 0.819454993934233, 'auprc': 0.9561196143580599, 'loss_val': 0.4403672234246205, 'psi': 0.8741208421037638}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.056162 cos_to_last_merge=0.9714 (last merge round=39)
[S8] round=86 local utility u=0.041039 metrics={'f1_val': 0.9924707537771836, 'auprc': 0.9994030128569472, 'loss_val': 0.03540962584278489, 'psi': 0.995243657409089}-{'f1_val': 0.9832945426381587, 'auprc': 0.9963830716924632, 'loss_val': 0.05337035231502898, 'psi': 0.9885299542598806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=86 head_norm_before_train=2.230289 cos_to_last_merge=0.9439 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=86 local utility u=0.001689 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984509602667736, 'loss_val': 0.016280370410084125, 'psi': 0.997888674560756}-{'f1_val': 0.9971029125121428, 'auprc': 0.998447940654419, 'loss_val': 0.01718369460997178, 'psi': 0.9976409237690533}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=86 head_norm_before_train=2.301804 cos_to_last_merge=0.9920 (last merge round=40)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9984542054252816, 'loss_val': 0.02656595782422117, 'psi': 0.9962308477017361}-{'f1_val': 0.9947486092193725, 'auprc': 0.9984329826349541, 'loss_val': 0.026368854829527666, 'psi': 0.9962223585856051}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.027220 cos_to_last_merge=0.9871 (last merge round=38)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9958285835988112, 'auprc': 0.9989192780154287, 'loss_val': 0.020402952084092443, 'psi': 0.9970648613654582}-{'f1_val': 0.9963090846170353, 'auprc': 0.9984313887734614, 'loss_val': 0.021678289273741356, 'psi': 0.9971580062796057}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=2.086468 cos_to_last_merge=0.9841 (last merge round=37)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.583568371586136, 'auprc': 0.6133184773045172, 'loss_val': 1.5778476708155866, 'psi': 0.5954684138734885}-{'f1_val': 0.6962730221876214, 'auprc': 0.7322259421308763, 'loss_val': 1.0987197414939809, 'psi': 0.7106541901649234}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=2.227100 cos_to_last_merge=0.9795 (last merge round=37)
[S14] round=86 local utility u=0.018507 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9969758321594135, 'loss_val': 0.020459587363514112, 'psi': 0.9974820436440964}-{'f1_val': 0.9940755032987544, 'auprc': 0.997070980752846, 'loss_val': 0.03529429840122435, 'psi': 0.995273694280391}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=86 head_norm_before_train=2.325742 (no previous merge yet)
[S15] round=86 local utility u=0.291566 metrics={'f1_val': 0.9402957690557281, 'auprc': 0.9961114420227829, 'loss_val': 0.0910209923613, 'psi': 0.96262203824255}-{'f1_val': 0.8749008918196974, 'auprc': 0.9938113258543397, 'loss_val': 0.2748836684079132, 'psi': 0.9224650654335544}
[S15] not sending this round → trigger blocked (psi=0.963)
[S16] START round=86 head_norm_before_train=2.337614 cos_to_last_merge=0.9925 (last merge round=38)
[S16] round=86 local utility u=0.015305 metrics={'f1_val': 0.9913998499104087, 'auprc': 0.9962935220184524, 'loss_val': 0.04356238372184342, 'psi': 0.9933573187536262}-{'f1_val': 0.9921054438842623, 'auprc': 0.9863040597698891, 'loss_val': 0.04843845423121563, 'psi': 0.989784890238513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=86 head_norm_before_train=1.998676 cos_to_last_merge=0.9698 (last merge round=40)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.542725829552379, 'auprc': 0.7103467570757738, 'loss_val': 1.4002222322356392, 'psi': 0.6097742005617369}-{'f1_val': 0.6387026605640328, 'auprc': 0.8154771548946633, 'loss_val': 1.1126097170766787, 'psi': 0.7094124582962851}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=1.990643 cos_to_last_merge=0.7528 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=87 local utility u=0.068543 metrics={'f1_val': 0.7561099261189039, 'auprc': 0.9923395479156651, 'loss_val': 0.44393499979169376, 'psi': 0.8506017748376085}-{'f1_val': 0.7304551110662745, 'auprc': 0.9920633413471704, 'loss_val': 0.4262628588208146, 'psi': 0.8350984031786328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=87 head_norm_before_train=2.167774 cos_to_last_merge=0.9893 (last merge round=38)
[S3] round=87 local utility u=0.174861 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9982903810997639, 'loss_val': 0.01990693560403687, 'psi': 0.9974911760017027}-{'f1_val': 0.960995754132836, 'auprc': 0.9977021742632306, 'loss_val': 0.15208947738875658, 'psi': 0.9756783221849938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=87 head_norm_before_train=2.097124 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9238714149705072, 'auprc': 0.9482674426054877, 'loss_val': 0.42241311841518614, 'psi': 0.9336298260244994}-{'f1_val': 0.9379745363429597, 'auprc': 0.9538796364855694, 'loss_val': 0.37778228787679397, 'psi': 0.9443365764000036}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=2.326282 cos_to_last_merge=0.9900 (last merge round=38)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992032517445504, 'loss_val': 0.019303403543407666, 'psi': 0.9981432514094154}-{'f1_val': 0.9974365845193254, 'auprc': 0.9996904664802654, 'loss_val': 0.019749059748096147, 'psi': 0.9983381373037015}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=1.957006 cos_to_last_merge=0.9894 (last merge round=37)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.6543434449832761, 'auprc': 0.8740971063106542, 'loss_val': 0.7789227039741388, 'psi': 0.7422449095142274}-{'f1_val': 0.7146582820340833, 'auprc': 0.8930698525206713, 'loss_val': 0.6832948778791406, 'psi': 0.7860229102287185}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=2.118164 (no previous merge yet)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.6413710759522281, 'auprc': 0.8691005889766503, 'loss_val': 0.5832974389183059, 'psi': 0.732462881161997}-{'f1_val': 0.738381473209238, 'auprc': 0.8812040352363038, 'loss_val': 0.6746418871287251, 'psi': 0.7955104980200642}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.061977 cos_to_last_merge=0.9710 (last merge round=39)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9791337865767122, 'auprc': 0.9995250332962948, 'loss_val': 0.06421291444942562, 'psi': 0.9872902852645453}-{'f1_val': 0.9924707537771836, 'auprc': 0.9994030128569472, 'loss_val': 0.03540962584278489, 'psi': 0.995243657409089}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.235551 cos_to_last_merge=0.9434 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=87 local utility u=0.000018 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.998457831431794, 'loss_val': 0.016264003324771133, 'psi': 0.9978914230267641}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984509602667736, 'loss_val': 0.016280370410084125, 'psi': 0.997888674560756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=87 head_norm_before_train=2.304707 cos_to_last_merge=0.9919 (last merge round=40)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9984704925804297, 'loss_val': 0.026588259718149355, 'psi': 0.9961056611112085}-{'f1_val': 0.9947486092193725, 'auprc': 0.9984542054252816, 'loss_val': 0.02656595782422117, 'psi': 0.9962308477017361}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.029985 cos_to_last_merge=0.9870 (last merge round=38)
[S11] round=87 local utility u=0.002519 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989178638812959, 'loss_val': 0.019693834045352313, 'psi': 0.9974976985495767}-{'f1_val': 0.9958285835988112, 'auprc': 0.9989192780154287, 'loss_val': 0.020402952084092443, 'psi': 0.9970648613654582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=87 head_norm_before_train=2.089236 cos_to_last_merge=0.9837 (last merge round=37)
[S13] round=87 local utility u=0.985453 metrics={'f1_val': 0.719802120378755, 'auprc': 0.7934427888990743, 'loss_val': 0.9647169236376755, 'psi': 0.7492583877868827}-{'f1_val': 0.583568371586136, 'auprc': 0.6133184773045172, 'loss_val': 1.5778476708155866, 'psi': 0.5954684138734885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=87 head_norm_before_train=2.231740 cos_to_last_merge=0.9790 (last merge round=37)
[S14] round=87 local utility u=0.000268 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971943407764278, 'loss_val': 0.02057887315618603, 'psi': 0.9975694470909021}-{'f1_val': 0.9978195179672185, 'auprc': 0.9969758321594135, 'loss_val': 0.020459587363514112, 'psi': 0.9974820436440964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=87 head_norm_before_train=2.330108 (no previous merge yet)
[S15] round=87 local utility u=0.071316 metrics={'f1_val': 0.9604408222142897, 'auprc': 0.9968364861411287, 'loss_val': 0.0714341229449321, 'psi': 0.9749990877850253}-{'f1_val': 0.9402957690557281, 'auprc': 0.9961114420227829, 'loss_val': 0.0910209923613, 'psi': 0.96262203824255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=87 head_norm_before_train=2.340098 cos_to_last_merge=0.9924 (last merge round=38)
[S16] round=87 local utility u=0.005137 metrics={'f1_val': 0.9922883748415763, 'auprc': 0.9975411628674388, 'loss_val': 0.04236216441871284, 'psi': 0.9943894900519212}-{'f1_val': 0.9913998499104087, 'auprc': 0.9962935220184524, 'loss_val': 0.04356238372184342, 'psi': 0.9933573187536262}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=87 head_norm_before_train=2.002597 cos_to_last_merge=0.9692 (last merge round=40)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.45258740404122766, 'auprc': 0.6724371530486203, 'loss_val': 1.7785686476447355, 'psi': 0.5405273036441847}-{'f1_val': 0.542725829552379, 'auprc': 0.7103467570757738, 'loss_val': 1.4002222322356392, 'psi': 0.6097742005617369}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=1.994284 cos_to_last_merge=0.7525 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=88 local utility u=0.182035 metrics={'f1_val': 0.8275725984528863, 'auprc': 0.9557318057245514, 'loss_val': 0.3988185164118089, 'psi': 0.8788362813615523}-{'f1_val': 0.7561099261189039, 'auprc': 0.9923395479156651, 'loss_val': 0.44393499979169376, 'psi': 0.8506017748376085}
[S2] not sending this round → trigger blocked (psi=0.879)
[S3] START round=88 head_norm_before_train=2.171614 cos_to_last_merge=0.9891 (last merge round=38)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9829480772495159, 'loss_val': 0.1714030816012903, 'psi': 0.9698003815630725}-{'f1_val': 0.9969583726029951, 'auprc': 0.9982903810997639, 'loss_val': 0.01990693560403687, 'psi': 0.9974911760017027}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.099082 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=88 local utility u=0.119256 metrics={'f1_val': 0.9423633568511927, 'auprc': 0.9641045109726927, 'loss_val': 0.34236441024639547, 'psi': 0.9510598184997927}-{'f1_val': 0.9238714149705072, 'auprc': 0.9482674426054877, 'loss_val': 0.42241311841518614, 'psi': 0.9336298260244994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=88 head_norm_before_train=2.322743 cos_to_last_merge=0.9894 (last merge round=38)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9976286804259029, 'loss_val': 0.018673351197323357, 'psi': 0.9975134228819564}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992032517445504, 'loss_val': 0.019303403543407666, 'psi': 0.9981432514094154}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.959670 cos_to_last_merge=0.9891 (last merge round=37)
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.9353177739472975, 'auprc': 0.965192768915051, 'loss_val': 0.21030024814280884, 'psi': 0.9472677719343989}-{'f1_val': 0.6543434449832761, 'auprc': 0.8740971063106542, 'loss_val': 0.7789227039741388, 'psi': 0.7422449095142274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=88 head_norm_before_train=2.127389 (no previous merge yet)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5921280345682306, 'auprc': 0.8017877928947035, 'loss_val': 0.8437011126355011, 'psi': 0.6759919378988197}-{'f1_val': 0.6413710759522281, 'auprc': 0.8691005889766503, 'loss_val': 0.5832974389183059, 'psi': 0.732462881161997}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.067858 cos_to_last_merge=0.9707 (last merge round=39)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9363983183096571, 'auprc': 0.9957295484843922, 'loss_val': 0.1450301080783792, 'psi': 0.9601308103795512}-{'f1_val': 0.9791337865767122, 'auprc': 0.9995250332962948, 'loss_val': 0.06421291444942562, 'psi': 0.9872902852645453}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.240577 cos_to_last_merge=0.9429 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9984537192559102, 'loss_val': 0.028676870761814785, 'psi': 0.993724592762099}-{'f1_val': 0.9975138174234109, 'auprc': 0.998457831431794, 'loss_val': 0.016264003324771133, 'psi': 0.9978914230267641}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.307839 cos_to_last_merge=0.9917 (last merge round=40)
[S10] round=88 local utility u=0.000499 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983850797013746, 'loss_val': 0.026651065704235866, 'psi': 0.9962031974121733}-{'f1_val': 0.9945291067983943, 'auprc': 0.9984704925804297, 'loss_val': 0.026588259718149355, 'psi': 0.9961056611112085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=88 head_norm_before_train=2.033753 cos_to_last_merge=0.9868 (last merge round=38)
[S11] round=88 local utility u=0.000072 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989288658312528, 'loss_val': 0.01958285499697107, 'psi': 0.9975020993295595}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989178638812959, 'loss_val': 0.019693834045352313, 'psi': 0.9974976985495767}
[S11] not sending this round → trigger blocked (psi=0.998)
[S13] START round=88 head_norm_before_train=2.090594 cos_to_last_merge=0.9835 (last merge round=37)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6167067435654857, 'auprc': 0.732749974458472, 'loss_val': 1.2669342621482247, 'psi': 0.6631240359226802}-{'f1_val': 0.719802120378755, 'auprc': 0.7934427888990743, 'loss_val': 0.9647169236376755, 'psi': 0.7492583877868827}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=2.236778 cos_to_last_merge=0.9785 (last merge round=37)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9984998063595196, 'loss_val': 0.02206192544862549, 'psi': 0.9978465191045047}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971943407764278, 'loss_val': 0.02057887315618603, 'psi': 0.9975694470909021}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.334488 (no previous merge yet)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9243975981634922, 'auprc': 0.9967087900010696, 'loss_val': 0.13608586143535892, 'psi': 0.9533220748985232}-{'f1_val': 0.9604408222142897, 'auprc': 0.9968364861411287, 'loss_val': 0.0714341229449321, 'psi': 0.9749990877850253}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=2.342801 cos_to_last_merge=0.9922 (last merge round=38)
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9923408999791452, 'auprc': 0.9864273223084696, 'loss_val': 0.04167999132372329, 'psi': 0.989975468910875}-{'f1_val': 0.9922883748415763, 'auprc': 0.9975411628674388, 'loss_val': 0.04236216441871284, 'psi': 0.9943894900519212}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.007969 cos_to_last_merge=0.9685 (last merge round=40)
[S17] round=88 local utility u=1.000000 metrics={'f1_val': 0.6253272983951306, 'auprc': 0.8567173500367398, 'loss_val': 1.3362764560672722, 'psi': 0.7178833190517742}-{'f1_val': 0.45258740404122766, 'auprc': 0.6724371530486203, 'loss_val': 1.7785686476447355, 'psi': 0.5405273036441847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=89 head_norm_before_train=1.995550 cos_to_last_merge=0.7520 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.8177704270506181, 'auprc': 0.9154562968121183, 'loss_val': 0.4755233844134308, 'psi': 0.8568447749552182}-{'f1_val': 0.8275725984528863, 'auprc': 0.9557318057245514, 'loss_val': 0.3988185164118089, 'psi': 0.8788362813615523}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.171225 cos_to_last_merge=0.9893 (last merge round=38)
[S3] round=89 local utility u=0.092163 metrics={'f1_val': 0.9707828219767068, 'auprc': 0.9990367265588076, 'loss_val': 0.09382859100702025, 'psi': 0.9820843838095471}-{'f1_val': 0.9610352511054436, 'auprc': 0.9829480772495159, 'loss_val': 0.1714030816012903, 'psi': 0.9698003815630725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=89 head_norm_before_train=2.101222 cos_to_last_merge=0.9945 (last merge round=39)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.7206684023672207, 'auprc': 0.9455268651043612, 'loss_val': 0.6072407879313049, 'psi': 0.810611787462077}-{'f1_val': 0.9423633568511927, 'auprc': 0.9641045109726927, 'loss_val': 0.34236441024639547, 'psi': 0.9510598184997927}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.324302 cos_to_last_merge=0.9892 (last merge round=38)
[S5] round=89 local utility u=0.001155 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992430808924607, 'loss_val': 0.021207197386235367, 'psi': 0.9981591830685795}-{'f1_val': 0.9974365845193254, 'auprc': 0.9976286804259029, 'loss_val': 0.018673351197323357, 'psi': 0.9975134228819564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=89 head_norm_before_train=1.964087 cos_to_last_merge=0.9887 (last merge round=37)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.6440383292449046, 'auprc': 0.9319762434391756, 'loss_val': 0.8305256424349765, 'psi': 0.759213494922613}-{'f1_val': 0.9353177739472975, 'auprc': 0.965192768915051, 'loss_val': 0.21030024814280884, 'psi': 0.9472677719343989}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=2.137547 (no previous merge yet)
[S7] round=89 local utility u=1.000000 metrics={'f1_val': 0.8422892163084775, 'auprc': 0.9785343416154018, 'loss_val': 0.41423134145701024, 'psi': 0.8967872664312473}-{'f1_val': 0.5921280345682306, 'auprc': 0.8017877928947035, 'loss_val': 0.8437011126355011, 'psi': 0.6759919378988197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=89 head_norm_before_train=2.072098 cos_to_last_merge=0.9705 (last merge round=39)
[S8] round=89 local utility u=0.209524 metrics={'f1_val': 0.9896980765677541, 'auprc': 0.9958910743715875, 'loss_val': 0.046265697634025015, 'psi': 0.9921752756892875}-{'f1_val': 0.9363983183096571, 'auprc': 0.9957295484843922, 'loss_val': 0.1450301080783792, 'psi': 0.9601308103795512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=89 head_norm_before_train=2.244716 cos_to_last_merge=0.9424 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=89 local utility u=0.025670 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9984882120657764, 'loss_val': 0.016610173982393932, 'psi': 0.9976553145498486}-{'f1_val': 0.9905718417662249, 'auprc': 0.9984537192559102, 'loss_val': 0.028676870761814785, 'psi': 0.993724592762099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=89 head_norm_before_train=2.311599 cos_to_last_merge=0.9916 (last merge round=40)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983111831874965, 'loss_val': 0.026592194055630593, 'psi': 0.996173638806622}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983850797013746, 'loss_val': 0.026651065704235866, 'psi': 0.9962031974121733}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.038009 cos_to_last_merge=0.9866 (last merge round=38)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.995107348883878, 'auprc': 0.9989008771591601, 'loss_val': 0.021845830533775732, 'psi': 0.9966247601939908}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989288658312528, 'loss_val': 0.01958285499697107, 'psi': 0.9975020993295595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.094612 cos_to_last_merge=0.9833 (last merge round=37)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6115979285691684, 'auprc': 0.6931757821490064, 'loss_val': 1.3833522828949798, 'psi': 0.6442290700011035}-{'f1_val': 0.6167067435654857, 'auprc': 0.732749974458472, 'loss_val': 1.2669342621482247, 'psi': 0.6631240359226802}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=2.242209 cos_to_last_merge=0.9781 (last merge round=37)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9969775853234166, 'loss_val': 0.019869355268693142, 'psi': 0.9972376306900635}-{'f1_val': 0.9974109942678281, 'auprc': 0.9984998063595196, 'loss_val': 0.02206192544862549, 'psi': 0.9978465191045047}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.338829 (no previous merge yet)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.9141959226979693, 'auprc': 0.9960680373257222, 'loss_val': 0.16336508631416816, 'psi': 0.9469447685490706}-{'f1_val': 0.9243975981634922, 'auprc': 0.9967087900010696, 'loss_val': 0.13608586143535892, 'psi': 0.9533220748985232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=2.345230 cos_to_last_merge=0.9920 (last merge round=38)
[S16] round=89 local utility u=0.005483 metrics={'f1_val': 0.9929991741310175, 'auprc': 0.9881743272181798, 'loss_val': 0.03990528174597592, 'psi': 0.9910692353658823}-{'f1_val': 0.9923408999791452, 'auprc': 0.9864273223084696, 'loss_val': 0.04167999132372329, 'psi': 0.989975468910875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=89 head_norm_before_train=2.013470 cos_to_last_merge=0.9679 (last merge round=40)
[S17] round=89 local utility u=0.246107 metrics={'f1_val': 0.6328201355337401, 'auprc': 0.9840004942411076, 'loss_val': 1.2708690877771065, 'psi': 0.7732922790166871}-{'f1_val': 0.6253272983951306, 'auprc': 0.8567173500367398, 'loss_val': 1.3362764560672722, 'psi': 0.7178833190517742}
[S17] not sending this round → trigger blocked (psi=0.773)
[S2] START round=90 head_norm_before_train=1.997558 cos_to_last_merge=0.7519 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7587719884501438, 'auprc': 0.8791130140868002, 'loss_val': 0.7146723946164739, 'psi': 0.8069083987048065}-{'f1_val': 0.8177704270506181, 'auprc': 0.9154562968121183, 'loss_val': 0.4755233844134308, 'psi': 0.8568447749552182}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.173936 cos_to_last_merge=0.9894 (last merge round=38)
[S3] round=90 local utility u=0.112252 metrics={'f1_val': 0.9971149325810758, 'auprc': 0.9987895637290899, 'loss_val': 0.026575242280913052, 'psi': 0.9977847850402815}-{'f1_val': 0.9707828219767068, 'auprc': 0.9990367265588076, 'loss_val': 0.09382859100702025, 'psi': 0.9820843838095471}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=90 head_norm_before_train=2.104984 cos_to_last_merge=0.9946 (last merge round=39)
[S4] round=90 local utility u=0.802916 metrics={'f1_val': 0.939968981092995, 'auprc': 0.9583556154662053, 'loss_val': 0.3556988447740525, 'psi': 0.9473236348422791}-{'f1_val': 0.7206684023672207, 'auprc': 0.9455268651043612, 'loss_val': 0.6072407879313049, 'psi': 0.810611787462077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=90 head_norm_before_train=2.330036 cos_to_last_merge=0.9890 (last merge round=38)
[S5] round=90 local utility u=0.000319 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9986948345465152, 'loss_val': 0.018923512891345976, 'psi': 0.9979398845302013}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992430808924607, 'loss_val': 0.021207197386235367, 'psi': 0.9981591830685795}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=90 head_norm_before_train=1.966515 cos_to_last_merge=0.9884 (last merge round=37)
[S6] round=90 local utility u=0.852218 metrics={'f1_val': 0.8332570832219084, 'auprc': 0.9605921506927204, 'loss_val': 0.3472492048487219, 'psi': 0.8841911102102332}-{'f1_val': 0.6440383292449046, 'auprc': 0.9319762434391756, 'loss_val': 0.8305256424349765, 'psi': 0.759213494922613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=90 head_norm_before_train=2.144794 (no previous merge yet)
[S7] round=90 local utility u=0.535682 metrics={'f1_val': 0.9689643545904215, 'auprc': 0.9886777453330051, 'loss_val': 0.13334875612270106, 'psi': 0.976849710887455}-{'f1_val': 0.8422892163084775, 'auprc': 0.9785343416154018, 'loss_val': 0.41423134145701024, 'psi': 0.8967872664312473}
[S7] not sending this round → trigger blocked (psi=0.977)
[S8] START round=90 head_norm_before_train=2.073874 cos_to_last_merge=0.9703 (last merge round=39)
[S8] round=90 local utility u=0.007854 metrics={'f1_val': 0.9896558900940475, 'auprc': 0.9993182133305736, 'loss_val': 0.04058557554519999, 'psi': 0.993520819388658}-{'f1_val': 0.9896980765677541, 'auprc': 0.9958910743715875, 'loss_val': 0.046265697634025015, 'psi': 0.9921752756892875}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=90 head_norm_before_train=2.249101 cos_to_last_merge=0.9419 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984888001867142, 'loss_val': 0.01721356837611454, 'psi': 0.9976572675819714}-{'f1_val': 0.9971000495392299, 'auprc': 0.9984882120657764, 'loss_val': 0.016610173982393932, 'psi': 0.9976553145498486}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.315704 cos_to_last_merge=0.9914 (last merge round=40)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981399551841366, 'loss_val': 0.026472275651099723, 'psi': 0.9961051476052781}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983111831874965, 'loss_val': 0.026592194055630593, 'psi': 0.996173638806622}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.042276 cos_to_last_merge=0.9864 (last merge round=38)
[S11] round=90 local utility u=0.005460 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989150627890144, 'loss_val': 0.019628845723678446, 'psi': 0.9974965781126641}-{'f1_val': 0.995107348883878, 'auprc': 0.9989008771591601, 'loss_val': 0.021845830533775732, 'psi': 0.9966247601939908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=90 head_norm_before_train=2.097332 cos_to_last_merge=0.9829 (last merge round=37)
[S13] round=90 local utility u=0.540782 metrics={'f1_val': 0.6788359418863341, 'auprc': 0.7917609571087058, 'loss_val': 1.0009714544096198, 'psi': 0.7240059479752827}-{'f1_val': 0.6115979285691684, 'auprc': 0.6931757821490064, 'loss_val': 1.3833522828949798, 'psi': 0.6442290700011035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=90 head_norm_before_train=2.245162 cos_to_last_merge=0.9778 (last merge round=37)
[S14] round=90 local utility u=0.002741 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9986101052881637, 'loss_val': 0.019284542669710386, 'psi': 0.9978906386759624}-{'f1_val': 0.9974109942678281, 'auprc': 0.9969775853234166, 'loss_val': 0.019869355268693142, 'psi': 0.9972376306900635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=90 head_norm_before_train=2.343160 (no previous merge yet)
[S15] round=90 local utility u=0.009947 metrics={'f1_val': 0.9153101336361065, 'auprc': 0.9954243350808729, 'loss_val': 0.14822529455093164, 'psi': 0.947355814214013}-{'f1_val': 0.9141959226979693, 'auprc': 0.9960680373257222, 'loss_val': 0.16336508631416816, 'psi': 0.9469447685490706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=90 head_norm_before_train=2.347700 cos_to_last_merge=0.9919 (last merge round=38)
[S16] round=90 local utility u=0.005850 metrics={'f1_val': 0.993148273899568, 'auprc': 0.992009083308363, 'loss_val': 0.040604359009920314, 'psi': 0.9926925976630859}-{'f1_val': 0.9929991741310175, 'auprc': 0.9881743272181798, 'loss_val': 0.03990528174597592, 'psi': 0.9910692353658823}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=90 head_norm_before_train=2.019886 cos_to_last_merge=0.9673 (last merge round=40)
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.6073476172404414, 'auprc': 0.8265605988166603, 'loss_val': 1.4067779807926983, 'psi': 0.695032809870929}-{'f1_val': 0.6328201355337401, 'auprc': 0.9840004942411076, 'loss_val': 1.2708690877771065, 'psi': 0.7732922790166871}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.001643 cos_to_last_merge=0.7517 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=91 local utility u=0.478076 metrics={'f1_val': 0.8174921990023134, 'auprc': 0.9916923951024403, 'loss_val': 0.4485798602621756, 'psi': 0.8871722774423642}-{'f1_val': 0.7587719884501438, 'auprc': 0.8791130140868002, 'loss_val': 0.7146723946164739, 'psi': 0.8069083987048065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=91 head_norm_before_train=2.178414 cos_to_last_merge=0.9892 (last merge round=38)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.997682138046089, 'loss_val': 0.05135781928684268, 'psi': 0.9975291327903701}-{'f1_val': 0.9971149325810758, 'auprc': 0.9987895637290899, 'loss_val': 0.026575242280913052, 'psi': 0.9977847850402815}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.110477 cos_to_last_merge=0.9947 (last merge round=39)
[S4] round=91 local utility u=0.006628 metrics={'f1_val': 0.9408191501078822, 'auprc': 0.9579017651896846, 'loss_val': 0.34618186823649894, 'psi': 0.9476521961406033}-{'f1_val': 0.939968981092995, 'auprc': 0.9583556154662053, 'loss_val': 0.3556988447740525, 'psi': 0.9473236348422791}
[S4] not sending this round → trigger blocked (psi=0.948)
[S5] START round=91 head_norm_before_train=2.331284 cos_to_last_merge=0.9887 (last merge round=38)
[S5] round=91 local utility u=0.001362 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9994075661921342, 'loss_val': 0.01613564730248738, 'psi': 0.9980047616434923}-{'f1_val': 0.9974365845193254, 'auprc': 0.9986948345465152, 'loss_val': 0.018923512891345976, 'psi': 0.9979398845302013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=91 head_norm_before_train=1.969239 cos_to_last_merge=0.9882 (last merge round=37)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6922692617556965, 'auprc': 0.917472356104262, 'loss_val': 0.5645634727017234, 'psi': 0.7823504994951227}-{'f1_val': 0.8332570832219084, 'auprc': 0.9605921506927204, 'loss_val': 0.3472492048487219, 'psi': 0.8841911102102332}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=2.149360 (no previous merge yet)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.9077377777006777, 'auprc': 0.9883797418632625, 'loss_val': 0.27313963702273214, 'psi': 0.9399945633657116}-{'f1_val': 0.9689643545904215, 'auprc': 0.9886777453330051, 'loss_val': 0.13334875612270106, 'psi': 0.976849710887455}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.076914 cos_to_last_merge=0.9700 (last merge round=39)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9648009109845477, 'auprc': 0.999492721865471, 'loss_val': 0.108773070831889, 'psi': 0.9786776353369171}-{'f1_val': 0.9896558900940475, 'auprc': 0.9993182133305736, 'loss_val': 0.04058557554519999, 'psi': 0.993520819388658}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=2.253320 cos_to_last_merge=0.9414 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998482696430478, 'loss_val': 0.017021447791515317, 'psi': 0.997389385660526}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984888001867142, 'loss_val': 0.01721356837611454, 'psi': 0.9976572675819714}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.319942 cos_to_last_merge=0.9912 (last merge round=40)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9980908440362543, 'loss_val': 0.026434539160177593, 'psi': 0.9960855031461252}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981399551841366, 'loss_val': 0.026472275651099723, 'psi': 0.9961051476052781}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.046068 cos_to_last_merge=0.9862 (last merge round=38)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9985735477412396, 'loss_val': 0.02067367324056781, 'psi': 0.997214869866717}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989150627890144, 'loss_val': 0.019628845723678446, 'psi': 0.9974965781126641}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=2.096036 cos_to_last_merge=0.9823 (last merge round=37)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.5960013129035161, 'auprc': 0.7214777468079265, 'loss_val': 1.4239116646625047, 'psi': 0.6461918864652803}-{'f1_val': 0.6788359418863341, 'auprc': 0.7917609571087058, 'loss_val': 1.0009714544096198, 'psi': 0.7240059479752827}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.248356 cos_to_last_merge=0.9775 (last merge round=37)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.998672440031332, 'loss_val': 0.01820051622236422, 'psi': 0.9977834489726252}-{'f1_val': 0.9974109942678281, 'auprc': 0.9986101052881637, 'loss_val': 0.019284542669710386, 'psi': 0.9978906386759624}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.347412 (no previous merge yet)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9125708947116397, 'auprc': 0.9955115001486342, 'loss_val': 0.16362330111888973, 'psi': 0.9457471368864374}-{'f1_val': 0.9153101336361065, 'auprc': 0.9954243350808729, 'loss_val': 0.14822529455093164, 'psi': 0.947355814214013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.352118 cos_to_last_merge=0.9918 (last merge round=38)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9934652486599074, 'auprc': 0.9875527250139295, 'loss_val': 0.03879687152194034, 'psi': 0.9911002392015162}-{'f1_val': 0.993148273899568, 'auprc': 0.992009083308363, 'loss_val': 0.040604359009920314, 'psi': 0.9926925976630859}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.025504 cos_to_last_merge=0.9668 (last merge round=40)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.35940374338333153, 'auprc': 0.6543345121781541, 'loss_val': 2.3276230447246613, 'psi': 0.47737605090126056}-{'f1_val': 0.6073476172404414, 'auprc': 0.8265605988166603, 'loss_val': 1.4067779807926983, 'psi': 0.695032809870929}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.005465 cos_to_last_merge=0.7518 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=92 local utility u=0.081184 metrics={'f1_val': 0.8314976181276063, 'auprc': 0.9872519941501913, 'loss_val': 0.35692333635577217, 'psi': 0.8937993685366403}-{'f1_val': 0.8174921990023134, 'auprc': 0.9916923951024403, 'loss_val': 0.4485798602621756, 'psi': 0.8871722774423642}
[S2] not sending this round → trigger blocked (psi=0.894)
[S3] START round=92 head_norm_before_train=2.181123 cos_to_last_merge=0.9890 (last merge round=38)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9595139574881344, 'auprc': 0.9864001767351596, 'loss_val': 0.17082755142879885, 'psi': 0.9702684451869444}-{'f1_val': 0.9974271292865575, 'auprc': 0.997682138046089, 'loss_val': 0.05135781928684268, 'psi': 0.9975291327903701}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.116597 cos_to_last_merge=0.9946 (last merge round=39)
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.8496595914146094, 'auprc': 0.9471192573883931, 'loss_val': 0.4900628930883918, 'psi': 0.8886434578041229}-{'f1_val': 0.9408191501078822, 'auprc': 0.9579017651896846, 'loss_val': 0.34618186823649894, 'psi': 0.9476521961406033}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=2.340161 cos_to_last_merge=0.9887 (last merge round=38)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9991006812999244, 'loss_val': 0.01625939726755112, 'psi': 0.9978820076866084}-{'f1_val': 0.9970695586110643, 'auprc': 0.9994075661921342, 'loss_val': 0.01613564730248738, 'psi': 0.9980047616434923}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=1.969603 cos_to_last_merge=0.9880 (last merge round=37)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.4826978942548288, 'auprc': 0.9013935137246821, 'loss_val': 0.8506896933366263, 'psi': 0.6501761420427701}-{'f1_val': 0.6922692617556965, 'auprc': 0.917472356104262, 'loss_val': 0.5645634727017234, 'psi': 0.7823504994951227}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=2.157669 (no previous merge yet)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.9048439659606609, 'auprc': 0.9871258313322648, 'loss_val': 0.27702234538044684, 'psi': 0.9377567121093024}-{'f1_val': 0.9077377777006777, 'auprc': 0.9883797418632625, 'loss_val': 0.27313963702273214, 'psi': 0.9399945633657116}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.080228 cos_to_last_merge=0.9697 (last merge round=39)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9632768949028556, 'auprc': 0.9996176742286832, 'loss_val': 0.1111082289049581, 'psi': 0.9778132066331867}-{'f1_val': 0.9648009109845477, 'auprc': 0.999492721865471, 'loss_val': 0.108773070831889, 'psi': 0.9786776353369171}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.258751 cos_to_last_merge=0.9410 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9984894376419194, 'loss_val': 0.017876944502408322, 'psi': 0.996891806075279}-{'f1_val': 0.9966605118138915, 'auprc': 0.998482696430478, 'loss_val': 0.017021447791515317, 'psi': 0.997389385660526}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.324198 cos_to_last_merge=0.9910 (last merge round=40)
[S10] round=92 local utility u=0.000530 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983883230125326, 'loss_val': 0.02626777690091137, 'psi': 0.9962044947366365}-{'f1_val': 0.9947486092193725, 'auprc': 0.9980908440362543, 'loss_val': 0.026434539160177593, 'psi': 0.9960855031461252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=92 head_norm_before_train=2.049525 cos_to_last_merge=0.9860 (last merge round=38)
[S11] round=92 local utility u=0.001827 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998900171310062, 'loss_val': 0.019449736740529067, 'psi': 0.9974906215210831}-{'f1_val': 0.9963090846170353, 'auprc': 0.9985735477412396, 'loss_val': 0.02067367324056781, 'psi': 0.997214869866717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=92 head_norm_before_train=2.097871 cos_to_last_merge=0.9817 (last merge round=37)
[S13] round=92 local utility u=0.625953 metrics={'f1_val': 0.7018226133238432, 'auprc': 0.7921707688272529, 'loss_val': 1.019012167197802, 'psi': 0.7379618755252071}-{'f1_val': 0.5960013129035161, 'auprc': 0.7214777468079265, 'loss_val': 1.4239116646625047, 'psi': 0.6461918864652803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=92 head_norm_before_train=2.252263 cos_to_last_merge=0.9773 (last merge round=37)
[S14] round=92 local utility u=0.001524 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9989836462266902, 'loss_val': 0.017406549421997947, 'psi': 0.998040055051373}-{'f1_val': 0.9971907882668205, 'auprc': 0.998672440031332, 'loss_val': 0.01820051622236422, 'psi': 0.9977834489726252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=92 head_norm_before_train=2.351514 (no previous merge yet)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9030426372207844, 'auprc': 0.9956277654109534, 'loss_val': 0.1999363876012934, 'psi': 0.940076688496852}-{'f1_val': 0.9125708947116397, 'auprc': 0.9955115001486342, 'loss_val': 0.16362330111888973, 'psi': 0.9457471368864374}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=2.357148 cos_to_last_merge=0.9917 (last merge round=38)
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9921094023593338, 'auprc': 0.9849178171324375, 'loss_val': 0.04523607876009147, 'psi': 0.9892327682685753}-{'f1_val': 0.9934652486599074, 'auprc': 0.9875527250139295, 'loss_val': 0.03879687152194034, 'psi': 0.9911002392015162}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.029659 cos_to_last_merge=0.9665 (last merge round=40)
[S17] round=92 local utility u=1.000000 metrics={'f1_val': 0.588644062141246, 'auprc': 0.712516588598306, 'loss_val': 1.2287200172859527, 'psi': 0.63819307272407}-{'f1_val': 0.35940374338333153, 'auprc': 0.6543345121781541, 'loss_val': 2.3276230447246613, 'psi': 0.47737605090126056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=93 head_norm_before_train=2.008230 cos_to_last_merge=0.7514 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7139119020252236, 'auprc': 0.9893046952691855, 'loss_val': 0.4599219684283866, 'psi': 0.8240690193228084}-{'f1_val': 0.8314976181276063, 'auprc': 0.9872519941501913, 'loss_val': 0.35692333635577217, 'psi': 0.8937993685366403}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.185786 cos_to_last_merge=0.9889 (last merge round=38)
[S3] round=93 local utility u=0.201399 metrics={'f1_val': 0.9962927538398917, 'auprc': 0.9978459613797355, 'loss_val': 0.023039246907423348, 'psi': 0.9969140368558292}-{'f1_val': 0.9595139574881344, 'auprc': 0.9864001767351596, 'loss_val': 0.17082755142879885, 'psi': 0.9702684451869444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=93 head_norm_before_train=2.122512 cos_to_last_merge=0.9946 (last merge round=39)
[S4] round=93 local utility u=0.330545 metrics={'f1_val': 0.9384993938245353, 'auprc': 0.9496325124410653, 'loss_val': 0.36955105010096195, 'psi': 0.9429526412711473}-{'f1_val': 0.8496595914146094, 'auprc': 0.9471192573883931, 'loss_val': 0.4900628930883918, 'psi': 0.8886434578041229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=93 head_norm_before_train=2.348842 cos_to_last_merge=0.9887 (last merge round=38)
[S5] round=93 local utility u=0.000237 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9989324103235538, 'loss_val': 0.015280799313596416, 'psi': 0.9978146992960601}-{'f1_val': 0.9970695586110643, 'auprc': 0.9991006812999244, 'loss_val': 0.01625939726755112, 'psi': 0.9978820076866084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=93 head_norm_before_train=1.971717 cos_to_last_merge=0.9879 (last merge round=37)
[S6] round=93 local utility u=0.317748 metrics={'f1_val': 0.6073665702950297, 'auprc': 0.8993066457206519, 'loss_val': 0.9569461056278277, 'psi': 0.7241426004652787}-{'f1_val': 0.4826978942548288, 'auprc': 0.9013935137246821, 'loss_val': 0.8506896933366263, 'psi': 0.6501761420427701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=93 head_norm_before_train=2.170259 (no previous merge yet)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.829176225327309, 'auprc': 0.9652482447178199, 'loss_val': 0.38219677658641654, 'psi': 0.8836050330835133}-{'f1_val': 0.9048439659606609, 'auprc': 0.9871258313322648, 'loss_val': 0.27702234538044684, 'psi': 0.9377567121093024}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.083625 cos_to_last_merge=0.9693 (last merge round=39)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9567964975654231, 'auprc': 0.9994991875128267, 'loss_val': 0.12221835912772061, 'psi': 0.9738775735443845}-{'f1_val': 0.9632768949028556, 'auprc': 0.9996176742286832, 'loss_val': 0.1111082289049581, 'psi': 0.9778132066331867}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.262561 cos_to_last_merge=0.9404 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=93 local utility u=0.005871 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984925564768488, 'loss_val': 0.016267296358099367, 'psi': 0.997905313044786}-{'f1_val': 0.9958267183641853, 'auprc': 0.9984894376419194, 'loss_val': 0.017876944502408322, 'psi': 0.996891806075279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=93 head_norm_before_train=2.328471 cos_to_last_merge=0.9908 (last merge round=40)
[S10] round=93 local utility u=0.000164 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9984860310113514, 'loss_val': 0.02623361173262794, 'psi': 0.996243577936164}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983883230125326, 'loss_val': 0.02626777690091137, 'psi': 0.9962044947366365}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=93 head_norm_before_train=2.053287 cos_to_last_merge=0.9858 (last merge round=38)
[S11] round=93 local utility u=0.000026 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989097024909207, 'loss_val': 0.019425372268387937, 'psi': 0.9974944339934266}-{'f1_val': 0.9965509216617638, 'auprc': 0.998900171310062, 'loss_val': 0.019449736740529067, 'psi': 0.9974906215210831}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=93 head_norm_before_train=2.100002 cos_to_last_merge=0.9811 (last merge round=37)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6050496686601013, 'auprc': 0.7288414249002423, 'loss_val': 1.377730011972292, 'psi': 0.6545663711561578}-{'f1_val': 0.7018226133238432, 'auprc': 0.7921707688272529, 'loss_val': 1.019012167197802, 'psi': 0.7379618755252071}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.255938 cos_to_last_merge=0.9771 (last merge round=37)
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9940522555841613, 'auprc': 0.9990535303612732, 'loss_val': 0.03405652888294281, 'psi': 0.9960527654950061}-{'f1_val': 0.9974109942678281, 'auprc': 0.9989836462266902, 'loss_val': 0.017406549421997947, 'psi': 0.998040055051373}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.355614 (no previous merge yet)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.8978382281279005, 'auprc': 0.9957357401731558, 'loss_val': 0.23028644552470348, 'psi': 0.9369972329460027}-{'f1_val': 0.9030426372207844, 'auprc': 0.9956277654109534, 'loss_val': 0.1999363876012934, 'psi': 0.940076688496852}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.361428 cos_to_last_merge=0.9915 (last merge round=38)
[S16] round=93 local utility u=0.014383 metrics={'f1_val': 0.9932187487813045, 'auprc': 0.9897391218171292, 'loss_val': 0.037589485284259136, 'psi': 0.9918268979956343}-{'f1_val': 0.9921094023593338, 'auprc': 0.9849178171324375, 'loss_val': 0.04523607876009147, 'psi': 0.9892327682685753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=93 head_norm_before_train=2.034878 cos_to_last_merge=0.9661 (last merge round=40)
[S17] round=93 local utility u=0.690548 metrics={'f1_val': 0.6641099374779981, 'auprc': 0.9592381087975277, 'loss_val': 1.0405844085582912, 'psi': 0.7821612060058099}-{'f1_val': 0.588644062141246, 'auprc': 0.712516588598306, 'loss_val': 1.2287200172859527, 'psi': 0.63819307272407}
[S17] not sending this round → trigger blocked (psi=0.782)
[S2] START round=94 head_norm_before_train=2.012137 cos_to_last_merge=0.7511 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=94 local utility u=0.399197 metrics={'f1_val': 0.8284720319228412, 'auprc': 0.9894822475091325, 'loss_val': 0.3494219410009131, 'psi': 0.8928761181573577}-{'f1_val': 0.7139119020252236, 'auprc': 0.9893046952691855, 'loss_val': 0.4599219684283866, 'psi': 0.8240690193228084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] sending update (kind=head size=1791 to 1 peers)
[S3] START round=94 head_norm_before_train=2.188030 cos_to_last_merge=0.9888 (last merge round=38)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.9761836507044117, 'auprc': 0.9786066602528566, 'loss_val': 0.09528190903704853, 'psi': 0.9771528545237897}-{'f1_val': 0.9962927538398917, 'auprc': 0.9978459613797355, 'loss_val': 0.023039246907423348, 'psi': 0.9969140368558292}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=2.129097 cos_to_last_merge=0.9944 (last merge round=39)
[S4] round=94 local utility u=0.106893 metrics={'f1_val': 0.9544374692025149, 'auprc': 0.9738155723493707, 'loss_val': 0.3239427804631841, 'psi': 0.9621887104612572}-{'f1_val': 0.9384993938245353, 'auprc': 0.9496325124410653, 'loss_val': 0.36955105010096195, 'psi': 0.9429526412711473}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=94 head_norm_before_train=2.355438 cos_to_last_merge=0.9887 (last merge round=38)
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9957045983781412, 'loss_val': 0.014318955004373668, 'psi': 0.9965235745178951}-{'f1_val': 0.9970695586110643, 'auprc': 0.9989324103235538, 'loss_val': 0.015280799313596416, 'psi': 0.9978146992960601}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=1.975224 cos_to_last_merge=0.9878 (last merge round=37)
[S6] round=94 local utility u=0.279092 metrics={'f1_val': 0.6485228899944593, 'auprc': 0.9258534888468359, 'loss_val': 0.7253399167607081, 'psi': 0.75945512953541}-{'f1_val': 0.6073665702950297, 'auprc': 0.8993066457206519, 'loss_val': 0.9569461056278277, 'psi': 0.7241426004652787}
[S6] not sending this round → trigger blocked (psi=0.759)
[S7] START round=94 head_norm_before_train=2.179748 (no previous merge yet)
[S7] round=94 local utility u=0.314108 metrics={'f1_val': 0.9158341543975763, 'auprc': 0.9821518070454427, 'loss_val': 0.32463859272304085, 'psi': 0.9423612154567228}-{'f1_val': 0.829176225327309, 'auprc': 0.9652482447178199, 'loss_val': 0.38219677658641654, 'psi': 0.8836050330835133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=94 head_norm_before_train=2.089009 cos_to_last_merge=0.9690 (last merge round=39)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9536589116742189, 'auprc': 0.9932539718008693, 'loss_val': 0.12816950207252617, 'psi': 0.969496935724879}-{'f1_val': 0.9567964975654231, 'auprc': 0.9994991875128267, 'loss_val': 0.12221835912772061, 'psi': 0.9738775735443845}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=2.268402 cos_to_last_merge=0.9400 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984869134749605, 'loss_val': 0.01626858955565219, 'psi': 0.9976565128972699}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984925564768488, 'loss_val': 0.016267296358099367, 'psi': 0.997905313044786}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.332658 cos_to_last_merge=0.9906 (last merge round=40)
[S10] round=94 local utility u=0.000346 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9986430971717216, 'loss_val': 0.026012701888293147, 'psi': 0.9963064044003122}-{'f1_val': 0.9947486092193725, 'auprc': 0.9984860310113514, 'loss_val': 0.02623361173262794, 'psi': 0.996243577936164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=94 head_norm_before_train=2.057151 cos_to_last_merge=0.9856 (last merge round=38)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986557287071134, 'loss_val': 0.020685818989697676, 'psi': 0.9972477422530666}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989097024909207, 'loss_val': 0.019425372268387937, 'psi': 0.9974944339934266}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.099021 cos_to_last_merge=0.9802 (last merge round=37)
[S13] round=94 local utility u=0.400761 metrics={'f1_val': 0.6563996246090343, 'auprc': 0.7898970977171108, 'loss_val': 1.0674757644965818, 'psi': 0.709798613852265}-{'f1_val': 0.6050496686601013, 'auprc': 0.7288414249002423, 'loss_val': 1.377730011972292, 'psi': 0.6545663711561578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=94 head_norm_before_train=2.257478 cos_to_last_merge=0.9767 (last merge round=37)
[S14] round=94 local utility u=0.012110 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9986703703892216, 'loss_val': 0.02632065245454139, 'psi': 0.997662774369158}-{'f1_val': 0.9940522555841613, 'auprc': 0.9990535303612732, 'loss_val': 0.03405652888294281, 'psi': 0.9960527654950061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=94 head_norm_before_train=2.359599 (no previous merge yet)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8955010131207426, 'auprc': 0.9957905904760316, 'loss_val': 0.2456857895863492, 'psi': 0.9356168440628582}-{'f1_val': 0.8978382281279005, 'auprc': 0.9957357401731558, 'loss_val': 0.23028644552470348, 'psi': 0.9369972329460027}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.362168 cos_to_last_merge=0.9914 (last merge round=38)
[S16] round=94 local utility u=0.002534 metrics={'f1_val': 0.9933677106311442, 'auprc': 0.9914492866639637, 'loss_val': 0.038545228472815676, 'psi': 0.992600341044272}-{'f1_val': 0.9932187487813045, 'auprc': 0.9897391218171292, 'loss_val': 0.037589485284259136, 'psi': 0.9918268979956343}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=94 head_norm_before_train=2.039737 cos_to_last_merge=0.9657 (last merge round=40)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.6237946355696208, 'auprc': 0.9904191025023947, 'loss_val': 1.3160260689371925, 'psi': 0.7704444223427304}-{'f1_val': 0.6641099374779981, 'auprc': 0.9592381087975277, 'loss_val': 1.0405844085582912, 'psi': 0.7821612060058099}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.016521 cos_to_last_merge=0.7508 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.8164079464761164, 'auprc': 0.9359848220623086, 'loss_val': 0.4804713442960627, 'psi': 0.8642386967105933}-{'f1_val': 0.8284720319228412, 'auprc': 0.9894822475091325, 'loss_val': 0.3494219410009131, 'psi': 0.8928761181573577}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.190088 cos_to_last_merge=0.9886 (last merge round=38)
[S3] round=95 local utility u=0.000000 metrics={'f1_val': 0.9345947525032497, 'auprc': 0.9761097376367452, 'loss_val': 0.21731369077257226, 'psi': 0.951200746556648}-{'f1_val': 0.9761836507044117, 'auprc': 0.9786066602528566, 'loss_val': 0.09528190903704853, 'psi': 0.9771528545237897}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=95 head_norm_before_train=2.133676 cos_to_last_merge=0.9944 (last merge round=39)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9411093719822892, 'auprc': 0.9571451976333206, 'loss_val': 0.3499887003862507, 'psi': 0.9475237022427018}-{'f1_val': 0.9544374692025149, 'auprc': 0.9738155723493707, 'loss_val': 0.3239427804631841, 'psi': 0.9621887104612572}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.356483 cos_to_last_merge=0.9885 (last merge round=38)
[S5] round=95 local utility u=0.001528 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9989553098593544, 'loss_val': 0.023216512581361433, 'psi': 0.9980440746553371}-{'f1_val': 0.9970695586110643, 'auprc': 0.9957045983781412, 'loss_val': 0.014318955004373668, 'psi': 0.9965235745178951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=95 head_norm_before_train=1.976941 cos_to_last_merge=0.9875 (last merge round=37)
[S6] round=95 local utility u=0.686603 metrics={'f1_val': 0.8171008488401589, 'auprc': 0.9553285087552008, 'loss_val': 0.4520272193819575, 'psi': 0.8723919128061757}-{'f1_val': 0.6485228899944593, 'auprc': 0.9258534888468359, 'loss_val': 0.7253399167607081, 'psi': 0.75945512953541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=95 head_norm_before_train=2.191361 (no previous merge yet)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.8215039838803995, 'auprc': 0.9810980050866791, 'loss_val': 0.42468234872471416, 'psi': 0.8853415923629113}-{'f1_val': 0.9158341543975763, 'auprc': 0.9821518070454427, 'loss_val': 0.32463859272304085, 'psi': 0.9423612154567228}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.092127 cos_to_last_merge=0.9689 (last merge round=39)
[S8] round=95 local utility u=0.182170 metrics={'f1_val': 0.9942788405856967, 'auprc': 0.9996365981244765, 'loss_val': 0.026697001663180498, 'psi': 0.9964219436012086}-{'f1_val': 0.9536589116742189, 'auprc': 0.9932539718008693, 'loss_val': 0.12816950207252617, 'psi': 0.969496935724879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=95 head_norm_before_train=2.274035 cos_to_last_merge=0.9395 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984898970060024, 'loss_val': 0.016296813135602786, 'psi': 0.9976577063096866}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984869134749605, 'loss_val': 0.01626858955565219, 'psi': 0.9976565128972699}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.334629 cos_to_last_merge=0.9906 (last merge round=40)
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9986370634995732, 'loss_val': 0.026209346067003484, 'psi': 0.9961722894788658}-{'f1_val': 0.9947486092193725, 'auprc': 0.9986430971717216, 'loss_val': 0.026012701888293147, 'psi': 0.9963064044003122}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=2.061143 cos_to_last_merge=0.9854 (last merge round=38)
[S11] round=95 local utility u=0.001853 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989378376290183, 'loss_val': 0.01927665219817304, 'psi': 0.9975056880486657}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986557287071134, 'loss_val': 0.020685818989697676, 'psi': 0.9972477422530666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=95 head_norm_before_train=2.102497 cos_to_last_merge=0.9795 (last merge round=37)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6135893388385687, 'auprc': 0.7041577617672614, 'loss_val': 1.323275853959276, 'psi': 0.6498167080100459}-{'f1_val': 0.6563996246090343, 'auprc': 0.7898970977171108, 'loss_val': 1.0674757644965818, 'psi': 0.709798613852265}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.258792 cos_to_last_merge=0.9764 (last merge round=37)
[S14] round=95 local utility u=0.003195 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9969853666850663, 'loss_val': 0.018539578561577216, 'psi': 0.9973550785540307}-{'f1_val': 0.9969910436891155, 'auprc': 0.9986703703892216, 'loss_val': 0.02632065245454139, 'psi': 0.997662774369158}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=95 head_norm_before_train=2.363399 (no previous merge yet)
[S15] round=95 local utility u=0.008037 metrics={'f1_val': 0.8972558542485122, 'auprc': 0.9958885825842588, 'loss_val': 0.24043398294813878, 'psi': 0.9367089455828108}-{'f1_val': 0.8955010131207426, 'auprc': 0.9957905904760316, 'loss_val': 0.2456857895863492, 'psi': 0.9356168440628582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S15] sending update (kind=head size=1786 to 1 peers)
[S16] START round=95 head_norm_before_train=2.365041 cos_to_last_merge=0.9913 (last merge round=38)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9929991741310175, 'auprc': 0.9897453193742709, 'loss_val': 0.03846582763373855, 'psi': 0.9916976322283189}-{'f1_val': 0.9933677106311442, 'auprc': 0.9914492866639637, 'loss_val': 0.038545228472815676, 'psi': 0.992600341044272}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.046162 cos_to_last_merge=0.9654 (last merge round=40)
[S17] round=95 local utility u=0.106105 metrics={'f1_val': 0.6685228423435384, 'auprc': 0.9003502640275668, 'loss_val': 1.1019786074951174, 'psi': 0.7612538110171498}-{'f1_val': 0.6237946355696208, 'auprc': 0.9904191025023947, 'loss_val': 1.3160260689371925, 'psi': 0.7704444223427304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=96 head_norm_before_train=2.018916 cos_to_last_merge=0.7504 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7302736960343159, 'auprc': 0.8624294080750983, 'loss_val': 1.0052237125595924, 'psi': 0.7831359808506289}-{'f1_val': 0.8164079464761164, 'auprc': 0.9359848220623086, 'loss_val': 0.4804713442960627, 'psi': 0.8642386967105933}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.193470 cos_to_last_merge=0.9884 (last merge round=38)
[S3] round=96 local utility u=0.301412 metrics={'f1_val': 0.9936013819723951, 'auprc': 0.9984239288487692, 'loss_val': 0.035471858101058934, 'psi': 0.9955304007229447}-{'f1_val': 0.9345947525032497, 'auprc': 0.9761097376367452, 'loss_val': 0.21731369077257226, 'psi': 0.951200746556648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=96 head_norm_before_train=2.137710 cos_to_last_merge=0.9943 (last merge round=39)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.7001665406507903, 'auprc': 0.9454568354200901, 'loss_val': 0.633293027571905, 'psi': 0.7982826585585102}-{'f1_val': 0.9411093719822892, 'auprc': 0.9571451976333206, 'loss_val': 0.3499887003862507, 'psi': 0.9475237022427018}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.350288 cos_to_last_merge=0.9882 (last merge round=38)
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9958325728523583, 'loss_val': 0.01497419119562014, 'psi': 0.996574764307582}-{'f1_val': 0.9974365845193254, 'auprc': 0.9989553098593544, 'loss_val': 0.023216512581361433, 'psi': 0.9980440746553371}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.978400 cos_to_last_merge=0.9872 (last merge round=37)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.7778308388606707, 'auprc': 0.952736428925743, 'loss_val': 0.5374178996706899, 'psi': 0.8477930748866995}-{'f1_val': 0.8171008488401589, 'auprc': 0.9553285087552008, 'loss_val': 0.4520272193819575, 'psi': 0.8723919128061757}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.204253 (no previous merge yet)
[S7] round=96 local utility u=0.509462 metrics={'f1_val': 0.9520225136885754, 'auprc': 0.9868502318576582, 'loss_val': 0.20612559154825916, 'psi': 0.9659536009562085}-{'f1_val': 0.8215039838803995, 'auprc': 0.9810980050866791, 'loss_val': 0.42468234872471416, 'psi': 0.8853415923629113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=96 head_norm_before_train=2.096674 cos_to_last_merge=0.9688 (last merge round=39)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9930461454137609, 'auprc': 0.9998009822308158, 'loss_val': 0.028536358036423102, 'psi': 0.9957480801405829}-{'f1_val': 0.9942788405856967, 'auprc': 0.9996365981244765, 'loss_val': 0.026697001663180498, 'psi': 0.9964219436012086}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.277397 cos_to_last_merge=0.9390 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9984576184282896, 'loss_val': 0.016226695775611283, 'psi': 0.9976447948786016}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984898970060024, 'loss_val': 0.016296813135602786, 'psi': 0.9976577063096866}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.335697 cos_to_last_merge=0.9906 (last merge round=40)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9985028393793192, 'loss_val': 0.026645283283691777, 'psi': 0.9961185998307642}-{'f1_val': 0.9945291067983943, 'auprc': 0.9986370634995732, 'loss_val': 0.026209346067003484, 'psi': 0.9961722894788658}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.065103 cos_to_last_merge=0.9852 (last merge round=38)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989495654092528, 'loss_val': 0.019403006630796048, 'psi': 0.9975103791607595}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989378376290183, 'loss_val': 0.01927665219817304, 'psi': 0.9975056880486657}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.106623 cos_to_last_merge=0.9790 (last merge round=37)
[S13] round=96 local utility u=0.569426 metrics={'f1_val': 0.7066050310687796, 'auprc': 0.7998183143468023, 'loss_val': 1.029499867442725, 'psi': 0.7438903443799887}-{'f1_val': 0.6135893388385687, 'auprc': 0.7041577617672614, 'loss_val': 1.323275853959276, 'psi': 0.6498167080100459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=96 head_norm_before_train=2.260291 cos_to_last_merge=0.9762 (last merge round=37)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9969770539982576, 'loss_val': 0.01928037402837556, 'psi': 0.9973517534793073}-{'f1_val': 0.9976015531333403, 'auprc': 0.9969853666850663, 'loss_val': 0.018539578561577216, 'psi': 0.9973550785540307}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.367088 (no previous merge yet)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.8972558542485122, 'auprc': 0.9958961438742189, 'loss_val': 0.24399703804657988, 'psi': 0.9367119700987948}-{'f1_val': 0.8972558542485122, 'auprc': 0.9958885825842588, 'loss_val': 0.24043398294813878, 'psi': 0.9367089455828108}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.369236 cos_to_last_merge=0.9912 (last merge round=38)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9930256471423583, 'auprc': 0.9894890738419383, 'loss_val': 0.039893947590117766, 'psi': 0.9916110178221902}-{'f1_val': 0.9929991741310175, 'auprc': 0.9897453193742709, 'loss_val': 0.03846582763373855, 'psi': 0.9916976322283189}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.051770 cos_to_last_merge=0.9651 (last merge round=40)
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.3416057322711561, 'auprc': 0.6508543580129607, 'loss_val': 2.670189222401538, 'psi': 0.4653051825678779}-{'f1_val': 0.6685228423435384, 'auprc': 0.9003502640275668, 'loss_val': 1.1019786074951174, 'psi': 0.7612538110171498}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.022664 cos_to_last_merge=0.7499 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=97 local utility u=0.787769 metrics={'f1_val': 0.8283678654774747, 'auprc': 0.9895254956668054, 'loss_val': 0.39953995278618204, 'psi': 0.892830917553207}-{'f1_val': 0.7302736960343159, 'auprc': 0.8624294080750983, 'loss_val': 1.0052237125595924, 'psi': 0.7831359808506289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=97 head_norm_before_train=2.196400 cos_to_last_merge=0.9882 (last merge round=38)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9610304299627639, 'auprc': 0.9933263437023109, 'loss_val': 0.1259506202906153, 'psi': 0.9739487954585827}-{'f1_val': 0.9936013819723951, 'auprc': 0.9984239288487692, 'loss_val': 0.035471858101058934, 'psi': 0.9955304007229447}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.138633 cos_to_last_merge=0.9944 (last merge round=39)
[S4] round=97 local utility u=0.863718 metrics={'f1_val': 0.9402441876108951, 'auprc': 0.9501377009671828, 'loss_val': 0.36036544631683864, 'psi': 0.9442015929534102}-{'f1_val': 0.7001665406507903, 'auprc': 0.9454568354200901, 'loss_val': 0.633293027571905, 'psi': 0.7982826585585102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=97 head_norm_before_train=2.349172 cos_to_last_merge=0.9878 (last merge round=38)
[S5] round=97 local utility u=0.002533 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9991259232030529, 'loss_val': 0.02198990341068183, 'psi': 0.9981123199928165}-{'f1_val': 0.9970695586110643, 'auprc': 0.9958325728523583, 'loss_val': 0.01497419119562014, 'psi': 0.996574764307582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=97 head_norm_before_train=1.981089 cos_to_last_merge=0.9867 (last merge round=37)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.7139793591565894, 'auprc': 0.9247332106491606, 'loss_val': 0.5340113440724019, 'psi': 0.7982808997536179}-{'f1_val': 0.7778308388606707, 'auprc': 0.952736428925743, 'loss_val': 0.5374178996706899, 'psi': 0.8477930748866995}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=2.211805 (no previous merge yet)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.8944305276525613, 'auprc': 0.9733367097074823, 'loss_val': 0.38050257643939034, 'psi': 0.9259930004745297}-{'f1_val': 0.9520225136885754, 'auprc': 0.9868502318576582, 'loss_val': 0.20612559154825916, 'psi': 0.9659536009562085}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=2.100858 cos_to_last_merge=0.9685 (last merge round=39)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9995939995062051, 'loss_val': 0.03208921376912701, 'psi': 0.9949241805001878}-{'f1_val': 0.9930461454137609, 'auprc': 0.9998009822308158, 'loss_val': 0.028536358036423102, 'psi': 0.9957480801405829}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.282623 cos_to_last_merge=0.9386 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=97 local utility u=0.001313 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984222985390435, 'loss_val': 0.015960452725540197, 'psi': 0.997877209869664}-{'f1_val': 0.9971029125121428, 'auprc': 0.9984576184282896, 'loss_val': 0.016226695775611283, 'psi': 0.9976447948786016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=97 head_norm_before_train=2.337948 cos_to_last_merge=0.9905 (last merge round=40)
[S10] round=97 local utility u=0.000369 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9983254128715371, 'loss_val': 0.02669104084993661, 'psi': 0.9961793306802383}-{'f1_val': 0.9945291067983943, 'auprc': 0.9985028393793192, 'loss_val': 0.026645283283691777, 'psi': 0.9961185998307642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=97 head_norm_before_train=2.067886 cos_to_last_merge=0.9851 (last merge round=38)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9986960629087086, 'loss_val': 0.020771942983839803, 'psi': 0.9972638759337047}-{'f1_val': 0.9965509216617638, 'auprc': 0.9989495654092528, 'loss_val': 0.019403006630796048, 'psi': 0.9975103791607595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.112576 cos_to_last_merge=0.9786 (last merge round=37)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.5929434462660946, 'auprc': 0.6618810911087383, 'loss_val': 1.5235269890503624, 'psi': 0.620518504203152}-{'f1_val': 0.7066050310687796, 'auprc': 0.7998183143468023, 'loss_val': 1.029499867442725, 'psi': 0.7438903443799887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=2.264646 cos_to_last_merge=0.9760 (last merge round=37)
[S14] round=97 local utility u=0.000485 metrics={'f1_val': 0.9976015531333403, 'auprc': 0.9969792052987305, 'loss_val': 0.01831705273877813, 'psi': 0.9973526139994964}-{'f1_val': 0.9976015531333403, 'auprc': 0.9969770539982576, 'loss_val': 0.01928037402837556, 'psi': 0.9973517534793073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=97 head_norm_before_train=2.370638 (no previous merge yet)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.896817179980694, 'auprc': 0.995894511923147, 'loss_val': 0.2505939825396879, 'psi': 0.9364481127576753}-{'f1_val': 0.8972558542485122, 'auprc': 0.9958961438742189, 'loss_val': 0.24399703804657988, 'psi': 0.9367119700987948}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.374259 cos_to_last_merge=0.9910 (last merge round=38)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9926091570412587, 'auprc': 0.9900525573121417, 'loss_val': 0.041549962710888136, 'psi': 0.9915865171496119}-{'f1_val': 0.9930256471423583, 'auprc': 0.9894890738419383, 'loss_val': 0.039893947590117766, 'psi': 0.9916110178221902}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.055898 cos_to_last_merge=0.9647 (last merge round=40)
[S17] round=97 local utility u=1.000000 metrics={'f1_val': 0.6257246295407497, 'auprc': 0.7801957552523624, 'loss_val': 1.2958288939115241, 'psi': 0.6875130798253948}-{'f1_val': 0.3416057322711561, 'auprc': 0.6508543580129607, 'loss_val': 2.670189222401538, 'psi': 0.4653051825678779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=98 head_norm_before_train=2.020385 cos_to_last_merge=0.7496 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7984300267174756, 'auprc': 0.9876170450031837, 'loss_val': 0.40068411687361805, 'psi': 0.8741048340317589}-{'f1_val': 0.8283678654774747, 'auprc': 0.9895254956668054, 'loss_val': 0.39953995278618204, 'psi': 0.892830917553207}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.200371 cos_to_last_merge=0.9880 (last merge round=38)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.9870598402671629, 'loss_val': 0.16513522131918915, 'psi': 0.9712922277237245}-{'f1_val': 0.9610304299627639, 'auprc': 0.9933263437023109, 'loss_val': 0.1259506202906153, 'psi': 0.9739487954585827}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.130971 cos_to_last_merge=0.9943 (last merge round=39)
[S4] round=98 local utility u=0.096905 metrics={'f1_val': 0.9550279619640879, 'auprc': 0.9730577087926883, 'loss_val': 0.32401756138555216, 'psi': 0.962239860695528}-{'f1_val': 0.9402441876108951, 'auprc': 0.9501377009671828, 'loss_val': 0.36036544631683864, 'psi': 0.9442015929534102}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=98 head_norm_before_train=2.348630 cos_to_last_merge=0.9873 (last merge round=38)
[S5] round=98 local utility u=0.002982 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9992137839513118, 'loss_val': 0.01629041682974828, 'psi': 0.99814746429212}-{'f1_val': 0.9974365845193254, 'auprc': 0.9991259232030529, 'loss_val': 0.02198990341068183, 'psi': 0.9981123199928165}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=98 head_norm_before_train=1.985036 cos_to_last_merge=0.9862 (last merge round=37)
[S6] round=98 local utility u=0.347012 metrics={'f1_val': 0.7916225296235303, 'auprc': 0.9526530625276649, 'loss_val': 0.38960595825643535, 'psi': 0.8560347427851842}-{'f1_val': 0.7139793591565894, 'auprc': 0.9247332106491606, 'loss_val': 0.5340113440724019, 'psi': 0.7982808997536179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=98 head_norm_before_train=2.217693 (no previous merge yet)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6967640160542763, 'auprc': 0.9366013053535858, 'loss_val': 0.6446947832470673, 'psi': 0.7926989317740001}-{'f1_val': 0.8944305276525613, 'auprc': 0.9733367097074823, 'loss_val': 0.38050257643939034, 'psi': 0.9259930004745297}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.103541 cos_to_last_merge=0.9682 (last merge round=39)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9878661038880452, 'auprc': 0.999386796909544, 'loss_val': 0.04126514077262118, 'psi': 0.9924743810966448}-{'f1_val': 0.9918109678295097, 'auprc': 0.9995939995062051, 'loss_val': 0.03208921376912701, 'psi': 0.9949241805001878}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.287658 cos_to_last_merge=0.9383 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.998504306707808, 'loss_val': 0.017185125154960228, 'psi': 0.9976445706047433}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984222985390435, 'loss_val': 0.015960452725540197, 'psi': 0.997877209869664}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.341124 cos_to_last_merge=0.9904 (last merge round=40)
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9981994443990809, 'loss_val': 0.02664185927405959, 'psi': 0.9961289432912559}-{'f1_val': 0.9947486092193725, 'auprc': 0.9983254128715371, 'loss_val': 0.02669104084993661, 'psi': 0.9961793306802383}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.070583 cos_to_last_merge=0.9849 (last merge round=38)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9948671806073948, 'auprc': 0.9989318786725806, 'loss_val': 0.022849838203413485, 'psi': 0.9964930598334691}-{'f1_val': 0.9963090846170353, 'auprc': 0.9986960629087086, 'loss_val': 0.020771942983839803, 'psi': 0.9972638759337047}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.119342 cos_to_last_merge=0.9782 (last merge round=37)
[S13] round=98 local utility u=0.779825 metrics={'f1_val': 0.7012895669841537, 'auprc': 0.7974724438717848, 'loss_val': 1.0207280936931817, 'psi': 0.7397627177392061}-{'f1_val': 0.5929434462660946, 'auprc': 0.6618810911087383, 'loss_val': 1.5235269890503624, 'psi': 0.620518504203152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=98 head_norm_before_train=2.270641 cos_to_last_merge=0.9758 (last merge round=37)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9353176325876272, 'auprc': 0.9987445238199326, 'loss_val': 0.10241022316843308, 'psi': 0.9606883890805494}-{'f1_val': 0.9976015531333403, 'auprc': 0.9969792052987305, 'loss_val': 0.01831705273877813, 'psi': 0.9973526139994964}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.374182 (no previous merge yet)
[S15] round=98 local utility u=0.002080 metrics={'f1_val': 0.8966721979339662, 'auprc': 0.9958180093005422, 'loss_val': 0.24533362655827146, 'psi': 0.9363305224805967}-{'f1_val': 0.896817179980694, 'auprc': 0.995894511923147, 'loss_val': 0.2505939825396879, 'psi': 0.9364481127576753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=98 head_norm_before_train=2.379693 cos_to_last_merge=0.9908 (last merge round=38)
[S16] round=98 local utility u=0.000520 metrics={'f1_val': 0.9927577691791041, 'auprc': 0.9901543583680168, 'loss_val': 0.04170705081701761, 'psi': 0.9917164048546692}-{'f1_val': 0.9926091570412587, 'auprc': 0.9900525573121417, 'loss_val': 0.041549962710888136, 'psi': 0.9915865171496119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=98 head_norm_before_train=2.060431 cos_to_last_merge=0.9643 (last merge round=40)
[S17] round=98 local utility u=1.000000 metrics={'f1_val': 0.8354077633686763, 'auprc': 0.9741731751340135, 'loss_val': 0.5813616506207102, 'psi': 0.8909139280748112}-{'f1_val': 0.6257246295407497, 'auprc': 0.7801957552523624, 'loss_val': 1.2958288939115241, 'psi': 0.6875130798253948}
[S17] not sending this round → trigger blocked (psi=0.891)
[S2] START round=99 head_norm_before_train=2.016827 cos_to_last_merge=0.7492 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.749
[S2] round=99 local utility u=0.112132 metrics={'f1_val': 0.829361388160236, 'auprc': 0.9860095334337883, 'loss_val': 0.35718615206720916, 'psi': 0.8920206462696569}-{'f1_val': 0.7984300267174756, 'auprc': 0.9876170450031837, 'loss_val': 0.40068411687361805, 'psi': 0.8741048340317589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=100 psi=0.892 u=0.1121 p_local=0.1820 f1=0.829 auprc=0.986 bytes=66552
[S3] START round=99 head_norm_before_train=2.205761 cos_to_last_merge=0.9877 (last merge round=38)
[S3] round=99 local utility u=0.040304 metrics={'f1_val': 0.961283756324695, 'auprc': 0.9960774327736923, 'loss_val': 0.11459903621169079, 'psi': 0.9752012269042939}-{'f1_val': 0.9607804860280988, 'auprc': 0.9870598402671629, 'loss_val': 0.16513522131918915, 'psi': 0.9712922277237245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=100 psi=0.975 u=0.0403 p_local=0.0624 f1=0.961 auprc=0.996 bytes=71953
[S4] START round=99 head_norm_before_train=2.130639 cos_to_last_merge=0.9940 (last merge round=39)
[S4] round=99 local utility u=0.002281 metrics={'f1_val': 0.9557116320336803, 'auprc': 0.9730204855364382, 'loss_val': 0.32344675400970146, 'psi': 0.9626351734347834}-{'f1_val': 0.9550279619640879, 'auprc': 0.9730577087926883, 'loss_val': 0.32401756138555216, 'psi': 0.962239860695528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] r=100 psi=0.963 u=0.0023 p_local=0.1793 f1=0.956 auprc=0.973 bytes=68344
[S5] START round=99 head_norm_before_train=2.354645 cos_to_last_merge=0.9872 (last merge round=38)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9974365845193254, 'auprc': 0.9989763923006392, 'loss_val': 0.020238514452299107, 'psi': 0.9980525076318509}-{'f1_val': 0.9974365845193254, 'auprc': 0.9992137839513118, 'loss_val': 0.01629041682974828, 'psi': 0.99814746429212}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.998 u=0.0000 p_local=0.0015 f1=0.997 auprc=0.999 bytes=73752
[S6] START round=99 head_norm_before_train=1.988479 cos_to_last_merge=0.9860 (last merge round=37)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.7316270200761805, 'auprc': 0.9712359762969752, 'loss_val': 0.4771314206207065, 'psi': 0.8274706025644984}-{'f1_val': 0.7916225296235303, 'auprc': 0.9526530625276649, 'loss_val': 0.38960595825643535, 'psi': 0.8560347427851842}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.827 u=0.0000 p_local=0.2011 f1=0.732 auprc=0.971 bytes=77373
[S7] START round=99 head_norm_before_train=2.228938 (no previous merge yet)
[S7] round=99 local utility u=0.616870 metrics={'f1_val': 0.8461661283579367, 'auprc': 0.9756969233187893, 'loss_val': 0.42465382324181794, 'psi': 0.8979784463422777}-{'f1_val': 0.6967640160542763, 'auprc': 0.9366013053535858, 'loss_val': 0.6446947832470673, 'psi': 0.7926989317740001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S7] r=100 psi=0.898 u=0.6169 p_local=0.2464 f1=0.846 auprc=0.976 bytes=70153
[S8] START round=99 head_norm_before_train=2.106503 cos_to_last_merge=0.9681 (last merge round=39)
[S8] round=99 local utility u=0.024288 metrics={'f1_val': 0.9935542741987232, 'auprc': 0.9996190756000621, 'loss_val': 0.027514586601175055, 'psi': 0.9959801947592588}-{'f1_val': 0.9878661038880452, 'auprc': 0.999386796909544, 'loss_val': 0.04126514077262118, 'psi': 0.9924743810966448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S8] r=100 psi=0.996 u=0.0243 p_local=0.0266 f1=0.994 auprc=1.000 bytes=68426
[S9] START round=99 head_norm_before_train=2.289657 cos_to_last_merge=0.9378 (last merge round=34)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985052304484122, 'loss_val': 0.017425484197980047, 'psi': 0.9976638396866506}-{'f1_val': 0.9970714132027002, 'auprc': 0.998504306707808, 'loss_val': 0.017185125154960228, 'psi': 0.9976445706047433}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.998 u=0.0000 p_local=0.0013 f1=0.997 auprc=0.999 bytes=64850
[S10] START round=99 head_norm_before_train=2.344745 cos_to_last_merge=0.9902 (last merge round=40)
[S10] round=99 local utility u=0.000065 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9982381183173924, 'loss_val': 0.026627697183475865, 'psi': 0.9961444128585805}-{'f1_val': 0.9947486092193725, 'auprc': 0.9981994443990809, 'loss_val': 0.02664185927405959, 'psi': 0.9961289432912559}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] r=100 psi=0.996 u=0.0001 p_local=0.0001 f1=0.995 auprc=0.998 bytes=75461
[S11] START round=99 head_norm_before_train=2.073685 cos_to_last_merge=0.9847 (last merge round=38)
[S11] round=99 local utility u=0.006741 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9989576526439661, 'loss_val': 0.01954808870841403, 'psi': 0.9975136140546448}-{'f1_val': 0.9948671806073948, 'auprc': 0.9989318786725806, 'loss_val': 0.022849838203413485, 'psi': 0.9964930598334691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=100 psi=0.998 u=0.0067 p_local=0.0021 f1=0.997 auprc=0.999 bytes=79190
[S13] START round=99 head_norm_before_train=2.124591 cos_to_last_merge=0.9776 (last merge round=37)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6279604673965606, 'auprc': 0.744411779765749, 'loss_val': 1.189453508636442, 'psi': 0.674540992344236}-{'f1_val': 0.7012895669841537, 'auprc': 0.7974724438717848, 'loss_val': 1.0207280936931817, 'psi': 0.7397627177392061}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.675 u=0.0000 p_local=0.2738 f1=0.628 auprc=0.744 bytes=73779
[S14] START round=99 head_norm_before_train=2.274591 cos_to_last_merge=0.9754 (last merge round=37)
[S14] round=99 local utility u=0.211799 metrics={'f1_val': 0.9944935406943898, 'auprc': 0.9990535387899908, 'loss_val': 0.03479443527891505, 'psi': 0.9963175399326303}-{'f1_val': 0.9353176325876272, 'auprc': 0.9987445238199326, 'loss_val': 0.10241022316843308, 'psi': 0.9606883890805494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S14] r=100 psi=0.996 u=0.2118 p_local=0.0449 f1=0.994 auprc=0.999 bytes=71908
[S15] START round=99 head_norm_before_train=2.377797 (no previous merge yet)
[S15] round=99 local utility u=0.000567 metrics={'f1_val': 0.8960872529733948, 'auprc': 0.9957474255852682, 'loss_val': 0.24047846689678762, 'psi': 0.9359513220181441}-{'f1_val': 0.8966721979339662, 'auprc': 0.9958180093005422, 'loss_val': 0.24533362655827146, 'psi': 0.9363305224805967}
[S15] not sending this round → trigger blocked (psi=0.936)
[S15] r=100 psi=0.936 u=0.0006 p_local=0.0141 f1=0.896 auprc=0.996 bytes=66503
[S16] START round=99 head_norm_before_train=2.382425 cos_to_last_merge=0.9907 (last merge round=38)
[S16] round=99 local utility u=0.000235 metrics={'f1_val': 0.9927577691791041, 'auprc': 0.9900519927148153, 'loss_val': 0.040930620543074864, 'psi': 0.9916754585933885}-{'f1_val': 0.9927577691791041, 'auprc': 0.9901543583680168, 'loss_val': 0.04170705081701761, 'psi': 0.9917164048546692}
[S16] not sending this round → trigger blocked (psi=0.992)
[S16] r=100 psi=0.992 u=0.0002 p_local=0.0045 f1=0.993 auprc=0.990 bytes=66555
[S17] START round=99 head_norm_before_train=2.065045 cos_to_last_merge=0.9639 (last merge round=40)
[S17] round=99 local utility u=0.065425 metrics={'f1_val': 0.9029945756787997, 'auprc': 0.8551334606562141, 'loss_val': 0.4989137774471419, 'psi': 0.8838501296697655}-{'f1_val': 0.8354077633686763, 'auprc': 0.9741731751340135, 'loss_val': 0.5813616506207102, 'psi': 0.8909139280748112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S17] r=100 psi=0.884 u=0.0654 p_local=0.4173 f1=0.903 auprc=0.855 bytes=73801
[runner] rounds complete.
[runner] all agents stopped.
