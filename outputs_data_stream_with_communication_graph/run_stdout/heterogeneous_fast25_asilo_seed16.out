[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:37103
[S3] → join 127.0.0.1:37102
[S4] → join 127.0.0.1:37102
[S5] → join 127.0.0.1:37102
[S6] → join 127.0.0.1:37102
[S7] → join 127.0.0.1:37102
[S8] → join 127.0.0.1:37102
[S9] → join 127.0.0.1:37102
[S10] → join 127.0.0.1:37102
[S11] → join 127.0.0.1:37102
[S13] → join 127.0.0.1:37102
[S14] → join 127.0.0.1:37102
[S15] → join 127.0.0.1:37102
[S16] → join 127.0.0.1:37102
[S17] → join 127.0.0.1:37102
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.109644 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.173587 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.163544 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.141418 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.123992 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.226990 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.132212 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.185098 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.124541 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.120085 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.170443 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.144629 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.189357 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.244751 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.159254 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S6
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S5
[S3] + discovered S13
[S3] + discovered S4
[S4] + discovered S2
[S4] + discovered S3
[S5] + discovered S3
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S13
[S4] + discovered S14
[S5] + discovered S2
[S4] + discovered S5
[S5] + discovered S4
[S4] + discovered S9
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S11
[S4] + discovered S17
[S5] + discovered S14
[S5] + discovered S8
[S5] + discovered S9
[S5] + discovered S13
[S5] + discovered S11
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S15
[S6] + discovered S4
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S10
[S7] + discovered S5
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S3
[S7] + discovered S4
[S6] + discovered S13
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S11
[S6] + discovered S16
[S6] + discovered S15
[S6] + discovered S8
[S6] + discovered S10
[S6] + discovered S9
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S10
[S8] + discovered S3
[S8] + discovered S4
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S14
[S7] + discovered S11
[S7] + discovered S16
[S7] + discovered S15
[S7] + discovered S9
[S7] + discovered S17
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S5
[S9] + discovered S4
[S9] + discovered S3
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S10
[S8] + discovered S13
[S8] + discovered S11
[S8] + discovered S9
[S8] + discovered S15
[S10] + discovered S3
[S10] + discovered S2
[S10] + discovered S4
[S9] + discovered S11
[S10] + discovered S7
[S9] + discovered S13
[S9] + discovered S17
[S10] + discovered S6
[S9] + discovered S15
[S9] + discovered S16
[S10] + discovered S9
[S10] + discovered S8
[S10] + discovered S5
[S9] + discovered S14
[S9] + discovered S10
[S11] + discovered S7
[S11] + discovered S4
[S11] + discovered S5
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S2
[S10] + discovered S14
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S6
[S10] + discovered S17
[S10] + discovered S13
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S16
[S13] + discovered S7
[S13] + discovered S9
[S13] + discovered S6
[S13] + discovered S4
[S13] + discovered S11
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S3
[S13] + discovered S8
[S13] + discovered S5
[S11] + discovered S17
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S14] + discovered S2
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S7
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S13] + discovered S15
[S14] + discovered S5
[S14] + discovered S8
[S14] + discovered S3
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S10
[S15] + discovered S13
[S15] + discovered S8
[S15] + discovered S4
[S15] + discovered S14
[S15] + discovered S11
[S15] + discovered S3
[S15] + discovered S7
[S15] + discovered S2
[S14] + discovered S16
[S15] + discovered S9
[S14] + discovered S15
[S14] + discovered S17
[S16] + discovered S11
[S15] + discovered S17
[S16] + discovered S4
[S16] + discovered S15
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S3
[S16] + discovered S9
[S16] + discovered S8
[S16] + discovered S13
[S16] + discovered S10
[S15] + discovered S16
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S2
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S10
[S17] + discovered S15
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S6
[S17] + discovered S5
[S17] + discovered S2
[S17] + discovered S3
[S16] + discovered S17
[S17] + discovered S8
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S17@127.0.0.1:37117
[S9] ⇄ pheromone p=1.000 → S13@127.0.0.1:37113
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S15] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S14] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=1.000 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=1.000 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=1.000 → S11@127.0.0.1:37112
[S16] ⇄ pheromone p=1.000 → S2@127.0.0.1:37102
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S3] ⇄ pheromone p=1.000 → S4@127.0.0.1:37104
[S4] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:37110
[S2] START round=1 head_norm_before_train=1.121835 (no previous merge yet)
[S2] round=1 local utility u=0.056196 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.661666115117842, 'loss_val': 1.2829610357078336, 'psi': 0.34973272608027683}-{'f1_val': 0.1417771333885667, 'auprc': 0.6367121189146717, 'loss_val': 1.3204905159225075, 'psi': 0.3397511275990087}
[S3] START round=1 head_norm_before_train=1.181551 (no previous merge yet)
[S3] round=1 local utility u=0.252749 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8724134833554843, 'loss_val': 1.2866967125443687, 'psi': 0.4328694327106579}-{'f1_val': 0.13984006561410703, 'auprc': 0.7243086882272775, 'loss_val': 1.347881244100145, 'psi': 0.37362751465937516}
[S4] START round=1 head_norm_before_train=1.162177 (no previous merge yet)
[S4] round=1 local utility u=0.455183 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7661131926236393, 'loss_val': 1.3265137296438936, 'psi': 0.3905812543865662}-{'f1_val': 0.1691182938763841, 'auprc': 0.416282569008044, 'loss_val': 1.3607373728189947, 'psi': 0.2679840039290481}
[S5] START round=1 head_norm_before_train=1.158247 (no previous merge yet)
[S5] round=1 local utility u=0.076000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6096796861005341, 'loss_val': 1.2513549035793137, 'psi': 0.32922901729735654}-{'f1_val': 0.14226190476190476, 'auprc': 0.5849799761653414, 'loss_val': 1.329256459032243, 'psi': 0.3193491333232794}
[S6] START round=1 head_norm_before_train=1.129541 (no previous merge yet)
[S6] round=1 local utility u=0.025587 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6106101504007833, 'loss_val': 1.321759232324973, 'psi': 0.3290998293910825}-{'f1_val': 0.14142628205128205, 'auprc': 0.6029849713490787, 'loss_val': 1.3500567422094394, 'psi': 0.3260497577704007}
[S7] START round=1 head_norm_before_train=1.227471 (no previous merge yet)
[S7] round=1 local utility u=0.049117 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7781811379038598, 'loss_val': 1.2840258676906988, 'psi': 0.39650654879899894}-{'f1_val': 0.14205682272909165, 'auprc': 0.7640377151353893, 'loss_val': 1.3398298613669104, 'psi': 0.39084917969161076}
[S8] START round=1 head_norm_before_train=1.134944 (no previous merge yet)
[S8] round=1 local utility u=0.050284 metrics={'f1_val': 0.09203293033834788, 'auprc': 0.7571598881025576, 'loss_val': 1.3535771636531733, 'psi': 0.3580837134440318}-{'f1_val': 0.09148694665153236, 'auprc': 0.7349368621410459, 'loss_val': 1.384201139290718, 'psi': 0.3488669128473378}
[S9] START round=1 head_norm_before_train=1.186857 (no previous merge yet)
[S9] round=1 local utility u=0.008788 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9692632155117599, 'loss_val': 1.249707817375647, 'psi': 0.47254406048870157}-{'f1_val': 0.141397957139996, 'auprc': 0.9931845544534543, 'loss_val': 1.3390483970913953, 'psi': 0.4821125960653794}
[S10] START round=1 head_norm_before_train=1.121112 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5757576273671876, 'loss_val': 1.3478844588365098, 'psi': 0.31347603347190944}-{'f1_val': 0.38432169491030715, 'auprc': 0.38217994872458155, 'loss_val': 1.3731385925522854, 'psi': 0.38346499643601695}
[S11] START round=1 head_norm_before_train=1.114033 (no previous merge yet)
[S11] round=1 local utility u=0.652734 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7000470925833902, 'loss_val': 1.3555154149474498, 'psi': 0.3642670470572224}-{'f1_val': 0.054460325283390836, 'auprc': 0.44846991343312304, 'loss_val': 1.390531581080201, 'psi': 0.21206416054328373}
[S13] START round=1 head_norm_before_train=1.181304 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6398526871573358, 'loss_val': 1.2924019635952184, 'psi': 0.3401725324091662}-{'f1_val': 0.24117232245026737, 'auprc': 0.5560440412313783, 'loss_val': 1.332187653642469, 'psi': 0.36712100996271174}
[S14] START round=1 head_norm_before_train=1.144870 (no previous merge yet)
[S14] round=1 local utility u=0.782227 metrics={'f1_val': 0.1402863392324518, 'auprc': 0.7048078600391801, 'loss_val': 1.3571846555071083, 'psi': 0.3660949475551431}-{'f1_val': 0.09155565590426733, 'auprc': 0.2882529289432439, 'loss_val': 1.3795901123239744, 'psi': 0.17023456511985796}
[S15] START round=1 head_norm_before_train=1.187317 (no previous merge yet)
[S15] round=1 local utility u=0.610044 metrics={'f1_val': 0.2796147246872704, 'auprc': 0.7717252733848046, 'loss_val': 1.3497096287639514, 'psi': 0.4764589441662841}-{'f1_val': 0.2552013557174875, 'auprc': 0.4228845090977523, 'loss_val': 1.376794417652835, 'psi': 0.32227461706959337}
[S16] START round=1 head_norm_before_train=1.241975 (no previous merge yet)
[S16] round=1 local utility u=0.301263 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7916318240722182, 'loss_val': 1.311260860165968, 'psi': 0.4010351997484092}-{'f1_val': 0.14063745019920318, 'auprc': 0.6012080728507798, 'loss_val': 1.342515877351447, 'psi': 0.3248656992598339}
[S17] START round=1 head_norm_before_train=1.166013 (no previous merge yet)
[S17] round=1 local utility u=0.249804 metrics={'f1_val': 0.14215329110637173, 'auprc': 0.6116558454889686, 'loss_val': 1.350351468198176, 'psi': 0.32995431285941046}-{'f1_val': 0.09718183851487364, 'auprc': 0.5456173868812375, 'loss_val': 1.3820162662707516, 'psi': 0.2765560578614192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:37115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S9] → sending delta(kind=head bytes=1787) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:37115
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:37105
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S4] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:37115
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S7] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:37115
[S11] sending update (kind=head size=1785 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1787 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1789) from S16
[S15] cosine check vs S16: cos=-0.0807
[S15] DROPPED delta from S16 (cos=-0.0807 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1789) from S2
[S17] cosine check vs S2: cos=0.0358
[S10] RECEIVED delta(kind=head bytes=1785) from S11
[S10] cosine check vs S11: cos=-0.0606
[S10] DROPPED delta from S11 (cos=-0.0606 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S5
[S6] cosine check vs S5: cos=0.0827
[S10] RECEIVED delta(kind=head bytes=1792) from S3
[S10] cosine check vs S3: cos=-0.1113
[S10] DROPPED delta from S3 (cos=-0.1113 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S14
[S13] cosine check vs S14: cos=-0.0572
[S13] DROPPED delta from S14 (cos=-0.0572 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1789) from S7
[S15] cosine check vs S7: cos=0.0419
[S14] RECEIVED delta(kind=head bytes=1787) from S9
[S14] cosine check vs S9: cos=0.1033
[S15] RECEIVED delta(kind=head bytes=1789) from S6
[S15] cosine check vs S6: cos=-0.0578
[S15] DROPPED delta from S6 (cos=-0.0578 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=-0.0041
[S15] DROPPED delta from S8 (cos=-0.0041 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1790) from S15
[S5] cosine check vs S15: cos=-0.1196
[S5] DROPPED delta from S15 (cos=-0.1196 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1790) from S4
[S11] cosine check vs S4: cos=-0.0380
[S11] DROPPED delta from S4 (cos=-0.0380 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] cosine check vs S17: cos=-0.0278
[S9] DROPPED delta from S17 (cos=-0.0278 < 0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=1 metric=0.2796 head_norm=1.194081
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.474545e-01
[S15] stored merged vector for next round verification (round=1)
[S15] DEBUG after merge:  round=1 metric=0.1397 head_norm=0.883715 delta_norm=0.847455
[S15] aggregate: ROLLBACK (f1_val pre=0.280 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1403 head_norm=1.155212
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.962240e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.883076 delta_norm=0.796224
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=1 metric=0.1414 head_norm=1.145676
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.933751e-01
[S6] stored merged vector for next round verification (round=1)
[S6] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.861844 delta_norm=0.793375
[S6] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1422 head_norm=1.181810
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.069707e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.836385 delta_norm=0.806971
[S17] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.142282 (no previous merge yet)
[S2] round=2 local utility u=0.053985 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6829865078351259, 'loss_val': 1.2389525243397945, 'psi': 0.3582608831671904}-{'f1_val': 0.1417771333885667, 'auprc': 0.661666115117842, 'loss_val': 1.2829610357078336, 'psi': 0.34973272608027683}
[S3] START round=2 head_norm_before_train=1.215936 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8368805138808824, 'loss_val': 1.1990379412409913, 'psi': 0.4186562449208172}-{'f1_val': 0.13984006561410703, 'auprc': 0.8724134833554843, 'loss_val': 1.2866967125443687, 'psi': 0.4328694327106579}
[S4] START round=2 head_norm_before_train=1.168239 (no previous merge yet)
[S4] round=2 local utility u=0.041255 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7802263375037092, 'loss_val': 1.2863440246093085, 'psi': 0.3962265123385942}-{'f1_val': 0.14022662889518414, 'auprc': 0.7661131926236393, 'loss_val': 1.3265137296438936, 'psi': 0.3905812543865662}
[S5] START round=2 head_norm_before_train=1.196606 (no previous merge yet)
[S5] round=2 local utility u=0.943376 metrics={'f1_val': 0.3587127196115573, 'auprc': 0.7684482701958596, 'loss_val': 1.1396125595090894, 'psi': 0.5226069398452782}-{'f1_val': 0.14226190476190476, 'auprc': 0.6096796861005341, 'loss_val': 1.2513549035793137, 'psi': 0.32922901729735654}
[S6] START round=2 head_norm_before_train=0.861844 cos_to_last_merge=1.0000 (last merge round=1)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6080531919256922, 'loss_val': 1.3184747955031586, 'psi': 0.3280770460010461}-{'f1_val': 0.14142628205128205, 'auprc': 0.6106101504007833, 'loss_val': 1.321759232324973, 'psi': 0.3290998293910825}
[S7] START round=2 head_norm_before_train=1.253967 (no previous merge yet)
[S7] round=2 local utility u=0.017549 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.771883642661719, 'loss_val': 1.230035788453192, 'psi': 0.39398755070214264}-{'f1_val': 0.14205682272909165, 'auprc': 0.7781811379038598, 'loss_val': 1.2840258676906988, 'psi': 0.39650654879899894}
[S8] START round=2 head_norm_before_train=1.147471 (no previous merge yet)
[S8] round=2 local utility u=0.873426 metrics={'f1_val': 0.3852253139931251, 'auprc': 0.741952842377878, 'loss_val': 1.3202584744510653, 'psi': 0.5279163253470263}-{'f1_val': 0.09203293033834788, 'auprc': 0.7571598881025576, 'loss_val': 1.3535771636531733, 'psi': 0.3580837134440318}
[S9] START round=2 head_norm_before_train=1.221916 (no previous merge yet)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.866134326270562, 'loss_val': 1.1313637704815849, 'psi': 0.4312925047922224}-{'f1_val': 0.141397957139996, 'auprc': 0.9692632155117599, 'loss_val': 1.249707817375647, 'psi': 0.47254406048870157}
[S10] START round=2 head_norm_before_train=1.127630 (no previous merge yet)
[S10] round=2 local utility u=0.018831 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5786940591721147, 'loss_val': 1.3190310438996988, 'psi': 0.31465060619388024}-{'f1_val': 0.13862163754172394, 'auprc': 0.5757576273671876, 'loss_val': 1.3478844588365098, 'psi': 0.31347603347190944}
[S11] START round=2 head_norm_before_train=1.119225 (no previous merge yet)
[S11] round=2 local utility u=0.188673 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8118385939800216, 'loss_val': 1.313544182893131, 'psi': 0.40898364761587497}-{'f1_val': 0.14041368337311058, 'auprc': 0.7000470925833902, 'loss_val': 1.3555154149474498, 'psi': 0.3642670470572224}
[S13] START round=2 head_norm_before_train=1.199156 (no previous merge yet)
[S13] round=2 local utility u=0.045789 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6540673131825796, 'loss_val': 1.2434671094240046, 'psi': 0.3458583828192637}-{'f1_val': 0.1403857625770531, 'auprc': 0.6398526871573358, 'loss_val': 1.2924019635952184, 'psi': 0.3401725324091662}
[S14] START round=2 head_norm_before_train=0.883076 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6152163564392391, 'loss_val': 1.347915467294024, 'psi': 0.3303012543053179}-{'f1_val': 0.1402863392324518, 'auprc': 0.7048078600391801, 'loss_val': 1.3571846555071083, 'psi': 0.3660949475551431}
[S15] START round=2 head_norm_before_train=0.883715 cos_to_last_merge=1.0000 (last merge round=1)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7664505217653268, 'loss_val': 1.330695504405823, 'psi': 0.39042039952306573}-{'f1_val': 0.2796147246872704, 'auprc': 0.7717252733848046, 'loss_val': 1.3497096287639514, 'psi': 0.4764589441662841}
[S16] START round=2 head_norm_before_train=1.252750 (no previous merge yet)
[S16] round=2 local utility u=0.017805 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7933408783588717, 'loss_val': 1.2807782866179356, 'psi': 0.4017188214630706}-{'f1_val': 0.14063745019920318, 'auprc': 0.7916318240722182, 'loss_val': 1.311260860165968, 'psi': 0.4010351997484092}
[S17] START round=2 head_norm_before_train=0.836385 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.020165 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6189226849596555, 'loss_val': 1.324595648403149, 'psi': 0.3321384519742928}-{'f1_val': 0.14215329110637173, 'auprc': 0.6116558454889686, 'loss_val': 1.350351468198176, 'psi': 0.32995431285941046}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S10] → sending delta(kind=head bytes=1782) to S5@127.0.0.1:37105
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.528)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.394)
[S5] not sending this round → trigger blocked (psi=0.523)
[S11] not sending this round → trigger blocked (psi=0.409)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.358)
[S4] not sending this round → trigger blocked (psi=0.396)
[S16] not sending this round → trigger blocked (psi=0.402)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1782 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=-0.0019
[S14] DROPPED delta from S13 (cos=-0.0019 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1782) from S10
[S5] cosine check vs S10: cos=0.0448
[S17] not sending this round → trigger blocked (psi=0.332)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.3587 head_norm=1.242305
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.261142e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.863851 delta_norm=0.826114
[S5] aggregate: ROLLBACK (f1_val pre=0.359 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S2] START round=3 head_norm_before_train=1.169020 (no previous merge yet)
[S2] round=3 local utility u=0.094624 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7288881384439702, 'loss_val': 1.187408717218646, 'psi': 0.3766215354107281}-{'f1_val': 0.1417771333885667, 'auprc': 0.6829865078351259, 'loss_val': 1.2389525243397945, 'psi': 0.3582608831671904}
[S3] START round=3 head_norm_before_train=1.271976 (no previous merge yet)
[S3] round=3 local utility u=0.736606 metrics={'f1_val': 0.35124313502691884, 'auprc': 0.8435143520195154, 'loss_val': 1.01414587555424, 'psi': 0.5481516218239575}-{'f1_val': 0.13984006561410703, 'auprc': 0.8368805138808824, 'loss_val': 1.1990379412409913, 'psi': 0.4186562449208172}
[S4] START round=3 head_norm_before_train=1.183329 (no previous merge yet)
[S4] round=3 local utility u=0.031992 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.781641407496382, 'loss_val': 1.2266045390898936, 'psi': 0.3967925403356633}-{'f1_val': 0.14022662889518414, 'auprc': 0.7802263375037092, 'loss_val': 1.2863440246093085, 'psi': 0.3962265123385942}
[S5] START round=3 head_norm_before_train=0.863851 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.233080 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7696886138814083, 'loss_val': 1.0314003382754997, 'psi': 0.5585257790220066}-{'f1_val': 0.3587127196115573, 'auprc': 0.7684482701958596, 'loss_val': 1.1396125595090894, 'psi': 0.5226069398452782}
[S6] START round=3 head_norm_before_train=0.884331 cos_to_last_merge=0.9965 (last merge round=1)
[S6] round=3 local utility u=0.016036 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6059375120845829, 'loss_val': 1.2800557002746722, 'psi': 0.3272307740646024}-{'f1_val': 0.14142628205128205, 'auprc': 0.6080531919256922, 'loss_val': 1.3184747955031586, 'psi': 0.3280770460010461}
[S7] START round=3 head_norm_before_train=1.291805 (no previous merge yet)
[S7] round=3 local utility u=0.047038 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7750428147761089, 'loss_val': 1.1454382354039208, 'psi': 0.3952512195478986}-{'f1_val': 0.14205682272909165, 'auprc': 0.771883642661719, 'loss_val': 1.230035788453192, 'psi': 0.39398755070214264}
[S8] START round=3 head_norm_before_train=1.167277 (no previous merge yet)
[S8] round=3 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7384107669203679, 'loss_val': 1.2792212485694523, 'psi': 0.3793378962039215}-{'f1_val': 0.3852253139931251, 'auprc': 0.741952842377878, 'loss_val': 1.3202584744510653, 'psi': 0.5279163253470263}
[S9] START round=3 head_norm_before_train=1.278770 (no previous merge yet)
[S9] round=3 local utility u=1.000000 metrics={'f1_val': 0.41576403377768284, 'auprc': 0.9034948882210783, 'loss_val': 0.8603521084670003, 'psi': 0.610856375555041}-{'f1_val': 0.141397957139996, 'auprc': 0.866134326270562, 'loss_val': 1.1313637704815849, 'psi': 0.4312925047922224}
[S10] START round=3 head_norm_before_train=1.146335 (no previous merge yet)
[S10] round=3 local utility u=0.027430 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.584545235558615, 'loss_val': 1.281724073749148, 'psi': 0.31699107674848037}-{'f1_val': 0.13862163754172394, 'auprc': 0.5786940591721147, 'loss_val': 1.3190310438996988, 'psi': 0.31465060619388024}
[S11] START round=3 head_norm_before_train=1.136310 (no previous merge yet)
[S11] round=3 local utility u=0.096213 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8570797387965524, 'loss_val': 1.2568410893681075, 'psi': 0.4270801055424873}-{'f1_val': 0.14041368337311058, 'auprc': 0.8118385939800216, 'loss_val': 1.313544182893131, 'psi': 0.40898364761587497}
[S13] START round=3 head_norm_before_train=1.226882 (no previous merge yet)
[S13] round=3 local utility u=0.019566 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6526644727327873, 'loss_val': 1.200127349423665, 'psi': 0.34529724663934674}-{'f1_val': 0.1403857625770531, 'auprc': 0.6540673131825796, 'loss_val': 1.2434671094240046, 'psi': 0.3458583828192637}
[S14] START round=3 head_norm_before_train=0.895707 cos_to_last_merge=0.9972 (last merge round=1)
[S14] round=3 local utility u=0.170356 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7205490126542571, 'loss_val': 1.323200890088261, 'psi': 0.3724343167913251}-{'f1_val': 0.14035785288270378, 'auprc': 0.6152163564392391, 'loss_val': 1.347915467294024, 'psi': 0.3303012543053179}
[S15] START round=3 head_norm_before_train=0.899820 cos_to_last_merge=0.9976 (last merge round=1)
[S15] round=3 local utility u=0.019077 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7699384825990049, 'loss_val': 1.3030052907072343, 'psi': 0.391815583856537}-{'f1_val': 0.13973365136155833, 'auprc': 0.7664505217653268, 'loss_val': 1.330695504405823, 'psi': 0.39042039952306573}
[S16] START round=3 head_norm_before_train=1.271037 (no previous merge yet)
[S16] round=3 local utility u=0.019870 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7962565351089798, 'loss_val': 1.2497859074313014, 'psi': 0.40288508416311386}-{'f1_val': 0.14063745019920318, 'auprc': 0.7933408783588717, 'loss_val': 1.2807782866179356, 'psi': 0.4017188214630706}
[S17] START round=3 head_norm_before_train=0.857818 cos_to_last_merge=0.9969 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5728898474564175, 'loss_val': 1.2854682130262411, 'psi': 0.31372531697299766}-{'f1_val': 0.14094896331738438, 'auprc': 0.6189226849596555, 'loss_val': 1.324595648403149, 'psi': 0.3321384519742928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[S10] not sending this round → trigger blocked (psi=0.317)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S13] not sending this round → trigger blocked (psi=0.345)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.0349
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=-0.0311
[S4] DROPPED delta from S14 (cos=-0.0311 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.0434
[S8] RECEIVED delta(kind=head bytes=1798) from S2
[S8] cosine check vs S2: cos=0.0766
[S8] RECEIVED delta(kind=head bytes=1795) from S16
[S8] cosine check vs S16: cos=0.0106
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.0439
[S9] RECEIVED delta(kind=head bytes=1791) from S4
[S9] cosine check vs S4: cos=0.0041
[S13] RECEIVED delta(kind=head bytes=1790) from S9
[S13] cosine check vs S9: cos=0.0598
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=-0.0055
[S14] DROPPED delta from S11 (cos=-0.0055 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S15
[S16] cosine check vs S15: cos=-0.0661
[S16] DROPPED delta from S15 (cos=-0.0661 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=-0.0358
[S9] DROPPED delta from S5 (cos=-0.0358 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.1386 head_norm=1.173286
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.711097e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.1386 head_norm=0.901835 delta_norm=0.871110
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=3 metric=0.1404 head_norm=1.252520
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.907532e-01
[S13] stored merged vector for next round verification (round=3)
[S13] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.945573 delta_norm=0.890753
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=1.193523
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.151235e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.757747 delta_norm=0.715123
[S8] aggregate: ACCEPT kept=['S2', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.4158 head_norm=1.343984
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.018385e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.4166 head_norm=0.905498 delta_norm=0.901839
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=1.162614
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.240816e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.755659 delta_norm=0.724082
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.1402 head_norm=1.208382
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.783232e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.1402 head_norm=0.917146 delta_norm=0.878323
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.194555 (no previous merge yet)
[S2] round=4 local utility u=0.040864 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7365630947177744, 'loss_val': 1.1287046986035694, 'psi': 0.3796915179202498}-{'f1_val': 0.1417771333885667, 'auprc': 0.7288881384439702, 'loss_val': 1.187408717218646, 'psi': 0.3766215354107281}
[S3] START round=4 head_norm_before_train=1.328544 (no previous merge yet)
[S3] round=4 local utility u=0.450103 metrics={'f1_val': 0.39642092198300777, 'auprc': 0.9691667650842101, 'loss_val': 0.7619635176336923, 'psi': 0.6255192592234886}-{'f1_val': 0.35124313502691884, 'auprc': 0.8435143520195154, 'loss_val': 1.01414587555424, 'psi': 0.5481516218239575}
[S4] START round=4 head_norm_before_train=0.917146 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.002744 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7842837974631836, 'loss_val': 1.229042834184267, 'psi': 0.3978494963223839}-{'f1_val': 0.14022662889518414, 'auprc': 0.781641407496382, 'loss_val': 1.2266045390898936, 'psi': 0.3967925403356633}
[S5] START round=4 head_norm_before_train=0.913295 cos_to_last_merge=0.9931 (last merge round=2)
[S5] round=4 local utility u=0.133050 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7946183436032073, 'loss_val': 0.8395897194231755, 'psi': 0.5684476488211301}-{'f1_val': 0.4177505557824055, 'auprc': 0.7696886138814083, 'loss_val': 1.0314003382754997, 'psi': 0.5585257790220066}
[S6] START round=4 head_norm_before_train=0.915947 cos_to_last_merge=0.9874 (last merge round=1)
[S6] round=4 local utility u=0.003948 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.5946636561144347, 'loss_val': 1.2383387922336075, 'psi': 0.3227212316765431}-{'f1_val': 0.14142628205128205, 'auprc': 0.6059375120845829, 'loss_val': 1.2800557002746722, 'psi': 0.3272307740646024}
[S7] START round=4 head_norm_before_train=1.329540 (no previous merge yet)
[S7] round=4 local utility u=1.000000 metrics={'f1_val': 0.5538978974235945, 'auprc': 0.7741136855500904, 'loss_val': 0.9660201843700174, 'psi': 0.6419842126741928}-{'f1_val': 0.14205682272909165, 'auprc': 0.7750428147761089, 'loss_val': 1.1454382354039208, 'psi': 0.3952512195478986}
[S8] START round=4 head_norm_before_train=0.757747 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.005153 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7414256162170625, 'loss_val': 1.277960149538114, 'psi': 0.3805438359225993}-{'f1_val': 0.13995598239295717, 'auprc': 0.7384107669203679, 'loss_val': 1.2792212485694523, 'psi': 0.3793378962039215}
[S9] START round=4 head_norm_before_train=0.905498 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9960735765179218, 'loss_val': 0.6445088513450548, 'psi': 0.8194430198984428}-{'f1_val': 0.41576403377768284, 'auprc': 0.9034948882210783, 'loss_val': 0.8603521084670003, 'psi': 0.610856375555041}
[S10] START round=4 head_norm_before_train=0.901835 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.012173 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5905365281088786, 'loss_val': 1.2753511701355247, 'psi': 0.31938759376858583}-{'f1_val': 0.13862163754172394, 'auprc': 0.584545235558615, 'loss_val': 1.281724073749148, 'psi': 0.31699107674848037}
[S11] START round=4 head_norm_before_train=0.755659 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6506149685633659, 'loss_val': 1.2373776518350825, 'psi': 0.3444941974492127}-{'f1_val': 0.14041368337311058, 'auprc': 0.8570797387965524, 'loss_val': 1.2568410893681075, 'psi': 0.4270801055424873}
[S13] START round=4 head_norm_before_train=0.945573 cos_to_last_merge=1.0000 (last merge round=3)
[S13] round=4 local utility u=0.098822 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7210917164735416, 'loss_val': 1.2077656964021481, 'psi': 0.3726681441356485}-{'f1_val': 0.1403857625770531, 'auprc': 0.6526644727327873, 'loss_val': 1.200127349423665, 'psi': 0.34529724663934674}
[S14] START round=4 head_norm_before_train=0.917309 cos_to_last_merge=0.9891 (last merge round=1)
[S14] round=4 local utility u=0.196592 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8403878620837242, 'loss_val': 1.289532497733872, 'psi': 0.42036985656311193}-{'f1_val': 0.14035785288270378, 'auprc': 0.7205490126542571, 'loss_val': 1.323200890088261, 'psi': 0.3724343167913251}
[S15] START round=4 head_norm_before_train=0.927004 cos_to_last_merge=0.9909 (last merge round=1)
[S15] round=4 local utility u=0.013714 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7669459435015022, 'loss_val': 1.2665993330311276, 'psi': 0.39061856821753593}-{'f1_val': 0.13973365136155833, 'auprc': 0.7699384825990049, 'loss_val': 1.3030052907072343, 'psi': 0.391815583856537}
[S16] START round=4 head_norm_before_train=1.294047 (no previous merge yet)
[S16] round=4 local utility u=0.037587 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8075527281389271, 'loss_val': 1.2084998511462686, 'psi': 0.4074035613750928}-{'f1_val': 0.14063745019920318, 'auprc': 0.7962565351089798, 'loss_val': 1.2497859074313014, 'psi': 0.40288508416311386}
[S17] START round=4 head_norm_before_train=0.888707 cos_to_last_merge=0.9887 (last merge round=1)
[S17] round=4 local utility u=0.002846 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5586314426612187, 'loss_val': 1.237001613630587, 'psi': 0.30802195505491814}-{'f1_val': 0.14094896331738438, 'auprc': 0.5728898474564175, 'loss_val': 1.2854682130262411, 'psi': 0.31372531697299766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[S7] not sending this round → trigger blocked (psi=0.642)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[S16] not sending this round → trigger blocked (psi=0.407)
[S3] not sending this round → trigger blocked (psi=0.626)
[S6] not sending this round → trigger blocked (psi=0.323)
[S9] not sending this round → trigger blocked (psi=0.819)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[S5] not sending this round → trigger blocked (psi=0.568)
[S4] not sending this round → trigger blocked (psi=0.398)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.420)
[S15] not sending this round → trigger blocked (psi=0.391)
[S2] not sending this round → trigger blocked (psi=0.380)
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.3697
[S14] RECEIVED delta(kind=head bytes=1797) from S10
[S14] cosine check vs S10: cos=-0.0129
[S14] DROPPED delta from S10 (cos=-0.0129 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=0.0530
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.0080
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.7017 head_norm=0.999738
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.779518e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.4382 head_norm=0.683396 delta_norm=0.677952
[S9] aggregate: ROLLBACK (f1_val pre=0.702 post=0.438 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=4 metric=0.1409 head_norm=0.924024
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.833733e-01
[S17] stored merged vector for next round verification (round=4)
[S17] DEBUG after merge:  round=4 metric=0.1409 head_norm=0.708594 delta_norm=0.483373
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=1.324883
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.991068e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1406 head_norm=0.840480 delta_norm=0.799107
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.221870 (no previous merge yet)
[S2] round=5 local utility u=0.867856 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.735776374945025, 'loss_val': 1.0378025347493856, 'psi': 0.5440937330310776}-{'f1_val': 0.1417771333885667, 'auprc': 0.7365630947177744, 'loss_val': 1.1287046986035694, 'psi': 0.3796915179202498}
[S3] START round=5 head_norm_before_train=1.404738 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.3922829794209693, 'auprc': 0.8419602140909856, 'loss_val': 0.8280489848113448, 'psi': 0.5721538732889758}-{'f1_val': 0.39642092198300777, 'auprc': 0.9691667650842101, 'loss_val': 0.7619635176336923, 'psi': 0.6255192592234886}
[S4] START round=5 head_norm_before_train=0.941355 cos_to_last_merge=0.9965 (last merge round=3)
[S4] round=5 local utility u=0.018639 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7683492167851256, 'loss_val': 1.1439610795837818, 'psi': 0.39147566405116074}-{'f1_val': 0.14022662889518414, 'auprc': 0.7842837974631836, 'loss_val': 1.229042834184267, 'psi': 0.3978494963223839}
[S5] START round=5 head_norm_before_train=0.968182 cos_to_last_merge=0.9770 (last merge round=2)
[S5] round=5 local utility u=0.072049 metrics={'f1_val': 0.42108556758421156, 'auprc': 0.7929937143551902, 'loss_val': 0.7111273454822472, 'psi': 0.5698488262926029}-{'f1_val': 0.4176671856330787, 'auprc': 0.7946183436032073, 'loss_val': 0.8395897194231755, 'psi': 0.5684476488211301}
[S6] START round=5 head_norm_before_train=0.953374 cos_to_last_merge=0.9754 (last merge round=1)
[S6] round=5 local utility u=0.039427 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6092755965310479, 'loss_val': 1.203321170274195, 'psi': 0.3285660078431884}-{'f1_val': 0.14142628205128205, 'auprc': 0.5946636561144347, 'loss_val': 1.2383387922336075, 'psi': 0.3227212316765431}
[S7] START round=5 head_norm_before_train=1.382045 (no previous merge yet)
[S7] round=5 local utility u=0.471895 metrics={'f1_val': 0.6807973446995128, 'auprc': 0.7757068840856428, 'loss_val': 0.7884074142255171, 'psi': 0.7187611604539648}-{'f1_val': 0.5538978974235945, 'auprc': 0.7741136855500904, 'loss_val': 0.9660201843700174, 'psi': 0.6419842126741928}
[S8] START round=5 head_norm_before_train=0.785932 cos_to_last_merge=0.9975 (last merge round=3)
[S8] round=5 local utility u=0.061333 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661979999668885, 'loss_val': 1.2296120329897924, 'psi': 0.39045278942252976}-{'f1_val': 0.13995598239295717, 'auprc': 0.7414256162170625, 'loss_val': 1.277960149538114, 'psi': 0.3805438359225993}
[S9] START round=5 head_norm_before_train=0.683396 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.032679 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9989178775609625, 'loss_val': 0.5852908638577975, 'psi': 0.820341441148923}-{'f1_val': 0.7016893154854569, 'auprc': 0.9960735765179218, 'loss_val': 0.6445088513450548, 'psi': 0.8194430198984428}
[S10] START round=5 head_norm_before_train=0.931404 cos_to_last_merge=0.9976 (last merge round=3)
[S10] round=5 local utility u=0.053511 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6064228052484028, 'loss_val': 1.2159889471443284, 'psi': 0.32574210462439546}-{'f1_val': 0.13862163754172394, 'auprc': 0.5905365281088786, 'loss_val': 1.2753511701355247, 'psi': 0.31938759376858583}
[S11] START round=5 head_norm_before_train=0.789458 cos_to_last_merge=0.9959 (last merge round=3)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6017114749576036, 'loss_val': 1.2040757536621105, 'psi': 0.3249328000069078}-{'f1_val': 0.14041368337311058, 'auprc': 0.6506149685633659, 'loss_val': 1.2373776518350825, 'psi': 0.3444941974492127}
[S13] START round=5 head_norm_before_train=0.966768 cos_to_last_merge=0.9984 (last merge round=3)
[S13] round=5 local utility u=0.755759 metrics={'f1_val': 0.3770950168962294, 'auprc': 0.7254467997613518, 'loss_val': 1.1295693398863862, 'psi': 0.5164357300422784}-{'f1_val': 0.1403857625770531, 'auprc': 0.7210917164735416, 'loss_val': 1.2077656964021481, 'psi': 0.3726681441356485}
[S14] START round=5 head_norm_before_train=0.948118 cos_to_last_merge=0.9772 (last merge round=1)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8061586553768445, 'loss_val': 1.2443631276037994, 'psi': 0.4066781738803601}-{'f1_val': 0.14035785288270378, 'auprc': 0.8403878620837242, 'loss_val': 1.289532497733872, 'psi': 0.42036985656311193}
[S15] START round=5 head_norm_before_train=0.964980 cos_to_last_merge=0.9807 (last merge round=1)
[S15] round=5 local utility u=0.030642 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7737575751030987, 'loss_val': 1.2257509809931357, 'psi': 0.3933432208581745}-{'f1_val': 0.13973365136155833, 'auprc': 0.7669459435015022, 'loss_val': 1.2665993330311276, 'psi': 0.39061856821753593}
[S16] START round=5 head_norm_before_train=0.840480 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7916141277088895, 'loss_val': 1.2055640328428172, 'psi': 0.40102812120307774}-{'f1_val': 0.14063745019920318, 'auprc': 0.8075527281389271, 'loss_val': 1.2084998511462686, 'psi': 0.4074035613750928}
[S17] START round=5 head_norm_before_train=0.708594 cos_to_last_merge=1.0000 (last merge round=4)
[S17] round=5 local utility u=0.024702 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.559650301291759, 'loss_val': 1.190653582999929, 'psi': 0.3084294985071342}-{'f1_val': 0.14094896331738438, 'auprc': 0.5586314426612187, 'loss_val': 1.237001613630587, 'psi': 0.30802195505491814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.326)
[S13] not sending this round → trigger blocked (psi=0.516)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S6
[S11] cosine check vs S6: cos=0.6059
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.0351
[S16] RECEIVED delta(kind=head bytes=1790) from S15
[S16] cosine check vs S15: cos=-0.0120
[S16] DROPPED delta from S15 (cos=-0.0120 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.4009
[S9] RECEIVED delta(kind=head bytes=1797) from S4
[S9] cosine check vs S4: cos=0.2146
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.7143
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.4647
[S17] not sending this round → trigger blocked (psi=0.308)
[S14] ⇄ pheromone p=0.445 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.515 → S4@127.0.0.1:37104
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=5 metric=0.3771 head_norm=0.992052
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.690479e-01
[S13] stored merged vector for next round verification (round=5)
[S13] DEBUG after merge:  round=5 metric=0.4153 head_norm=0.764409 delta_norm=0.469048
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.502 → S16@127.0.0.1:37116
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=0.817356
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.914144e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.1400 head_norm=0.870131 delta_norm=0.591414
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.434 → S17@127.0.0.1:37117
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=0.827303
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.099762e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.815149 delta_norm=0.409976
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.413 → S14@127.0.0.1:37114
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.964875
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.079738e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=1.120775 delta_norm=0.507974
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.346 → S14@127.0.0.1:37114
[S6] ⇄ pheromone p=0.340 → S11@127.0.0.1:37112
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7013 head_norm=0.790244
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.813942e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7013 head_norm=0.573161 delta_norm=0.481394
[S9] aggregate: ACCEPT kept=['S5', 'S4'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.623 → S13@127.0.0.1:37113
[S15] ⇄ pheromone p=0.388 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.594 → S10@127.0.0.1:37111
[S4] ⇄ pheromone p=0.377 → S9@127.0.0.1:37110
[S5] ⇄ pheromone p=0.496 → S9@127.0.0.1:37110
[S2] ⇄ pheromone p=0.530 → S8@127.0.0.1:37109
[S16] ⇄ pheromone p=0.363 → S8@127.0.0.1:37109
[S17] ⇄ pheromone p=0.356 → S9@127.0.0.1:37110
[S2] START round=6 head_norm_before_train=1.243274 (no previous merge yet)
[S2] round=6 local utility u=0.064749 metrics={'f1_val': 0.41710880107850823, 'auprc': 0.7379949905933035, 'loss_val': 0.9197814988478937, 'psi': 0.5454632768844263}-{'f1_val': 0.41630530508844577, 'auprc': 0.735776374945025, 'loss_val': 1.0378025347493856, 'psi': 0.5440937330310776}
[S3] START round=6 head_norm_before_train=1.475596 (no previous merge yet)
[S3] round=6 local utility u=0.071364 metrics={'f1_val': 0.48784656094679835, 'auprc': 0.7451914467620612, 'loss_val': 0.9683952899493127, 'psi': 0.5907845152729034}-{'f1_val': 0.3922829794209693, 'auprc': 0.8419602140909856, 'loss_val': 0.8280489848113448, 'psi': 0.5721538732889758}
[S4] START round=6 head_norm_before_train=0.972380 cos_to_last_merge=0.9879 (last merge round=3)
[S4] round=6 local utility u=0.878495 metrics={'f1_val': 0.41183037827645946, 'auprc': 0.7677550507882904, 'loss_val': 1.0148103096424352, 'psi': 0.5542002472811919}-{'f1_val': 0.14022662889518414, 'auprc': 0.7683492167851256, 'loss_val': 1.1439610795837818, 'psi': 0.39147566405116074}
[S5] START round=6 head_norm_before_train=1.032513 cos_to_last_merge=0.9551 (last merge round=2)
[S5] round=6 local utility u=0.667381 metrics={'f1_val': 0.6328598133467352, 'auprc': 0.7916708466289977, 'loss_val': 0.6430414221546509, 'psi': 0.6963842266596403}-{'f1_val': 0.42108556758421156, 'auprc': 0.7929937143551902, 'loss_val': 0.7111273454822472, 'psi': 0.5698488262926029}
[S6] START round=6 head_norm_before_train=0.990286 cos_to_last_merge=0.9635 (last merge round=1)
[S6] round=6 local utility u=0.760487 metrics={'f1_val': 0.3787035079817252, 'auprc': 0.6131640278426136, 'loss_val': 1.1176765789758576, 'psi': 0.4724877159260805}-{'f1_val': 0.14142628205128205, 'auprc': 0.6092755965310479, 'loss_val': 1.203321170274195, 'psi': 0.3285660078431884}
[S7] START round=6 head_norm_before_train=1.448228 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.6026134289655702, 'auprc': 0.7841691073573889, 'loss_val': 0.7305682740454998, 'psi': 0.6752357003222977}-{'f1_val': 0.6807973446995128, 'auprc': 0.7757068840856428, 'loss_val': 0.7884074142255171, 'psi': 0.7187611604539648}
[S8] START round=6 head_norm_before_train=0.870131 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.022257 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7712814262376622, 'loss_val': 1.2003488047674957, 'psi': 0.3924861599308392}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661979999668885, 'loss_val': 1.2296120329897924, 'psi': 0.39045278942252976}
[S9] START round=6 head_norm_before_train=0.573161 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.007887 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9982828088479775, 'loss_val': 0.567611942154376, 'psi': 0.8200874136637291}-{'f1_val': 0.7012904835408967, 'auprc': 0.9989178775609625, 'loss_val': 0.5852908638577975, 'psi': 0.820341441148923}
[S10] START round=6 head_norm_before_train=1.120775 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.928270 metrics={'f1_val': 0.41615846728099787, 'auprc': 0.658269866076211, 'loss_val': 1.1802118828392119, 'psi': 0.513003026799083}-{'f1_val': 0.13862163754172394, 'auprc': 0.6064228052484028, 'loss_val': 1.2159889471443284, 'psi': 0.32574210462439546}
[S11] START round=6 head_norm_before_train=0.815149 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.244189 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.752866828390018, 'loss_val': 1.1691637074421102, 'psi': 0.38539494137987357}-{'f1_val': 0.14041368337311058, 'auprc': 0.6017114749576036, 'loss_val': 1.2040757536621105, 'psi': 0.3249328000069078}
[S13] START round=6 head_norm_before_train=0.764409 cos_to_last_merge=1.0000 (last merge round=5)
[S13] round=6 local utility u=0.117612 metrics={'f1_val': 0.4162370592043806, 'auprc': 0.7296238670230332, 'loss_val': 1.1417278461955618, 'psi': 0.5415917823318416}-{'f1_val': 0.3770950168962294, 'auprc': 0.7254467997613518, 'loss_val': 1.1295693398863862, 'psi': 0.5164357300422784}
[S14] START round=6 head_norm_before_train=0.984555 cos_to_last_merge=0.9636 (last merge round=1)
[S14] round=6 local utility u=0.131881 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.873542520654422, 'loss_val': 1.1827517671468397, 'psi': 0.43363171999139105}-{'f1_val': 0.14035785288270378, 'auprc': 0.8061586553768445, 'loss_val': 1.2443631276037994, 'psi': 0.4066781738803601}
[S15] START round=6 head_norm_before_train=1.001907 cos_to_last_merge=0.9703 (last merge round=1)
[S15] round=6 local utility u=0.857594 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7762271600659055, 'loss_val': 1.175519581580505, 'psi': 0.5600858689133379}-{'f1_val': 0.13973365136155833, 'auprc': 0.7737575751030987, 'loss_val': 1.2257509809931357, 'psi': 0.3933432208581745}
[S16] START round=6 head_norm_before_train=0.871194 cos_to_last_merge=0.9976 (last merge round=4)
[S16] round=6 local utility u=0.771923 metrics={'f1_val': 0.4144820245979186, 'auprc': 0.7294151446402188, 'loss_val': 1.1181892392478008, 'psi': 0.5404552726148387}-{'f1_val': 0.14063745019920318, 'auprc': 0.7916141277088895, 'loss_val': 1.2055640328428172, 'psi': 0.40102812120307774}
[S17] START round=6 head_norm_before_train=0.748682 cos_to_last_merge=0.9962 (last merge round=4)
[S17] round=6 local utility u=0.974745 metrics={'f1_val': 0.3971676116314645, 'auprc': 0.6637976683009285, 'loss_val': 1.090918361978351, 'psi': 0.50381963429925}-{'f1_val': 0.14094896331738438, 'auprc': 0.559650301291759, 'loss_val': 1.190653582999929, 'psi': 0.3084294985071342}
[S6] not sending this round → trigger blocked (psi=0.472)
[S2] not sending this round → trigger blocked (psi=0.545)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:37104
[S15] not sending this round → trigger blocked (psi=0.560)
[S5] not sending this round → trigger blocked (psi=0.696)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:37117
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.554)
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S16] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S13
[S16] cosine check vs S13: cos=0.5495
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] cosine check vs S8: cos=0.8004
[S4] RECEIVED delta(kind=head bytes=1802) from S3
[S4] cosine check vs S3: cos=0.6830
[S4] RECEIVED delta(kind=head bytes=1805) from S14
[S4] cosine check vs S14: cos=-0.0323
[S4] DROPPED delta from S14 (cos=-0.0323 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1790) from S16
[S8] cosine check vs S16: cos=0.1887
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.0059
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=-0.0078
[S14] DROPPED delta from S10 (cos=-0.0078 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] cosine check vs S17: cos=0.3543
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7013 head_norm=0.688860
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.235018e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7013 head_norm=0.610851 delta_norm=0.423502
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4118 head_norm=1.009393
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.582965e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.3697 head_norm=1.168373 delta_norm=0.558297
[S4] aggregate: ROLLBACK (f1_val pre=0.412 post=0.370 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=1.029647
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.620657e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.665928 delta_norm=0.662066
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4145 head_norm=0.908110
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.056758e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.2956 head_norm=0.746374 delta_norm=0.405676
[S16] aggregate: ROLLBACK (f1_val pre=0.414 post=0.296 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.1400 head_norm=0.894629
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.741182e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.1400 head_norm=0.694911 delta_norm=0.574118
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=6 metric=0.3972 head_norm=0.794013
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.709625e-01
[S17] stored merged vector for next round verification (round=6)
[S17] DEBUG after merge:  round=6 metric=0.3414 head_norm=0.801242 delta_norm=0.270963
[S17] aggregate: ROLLBACK (f1_val pre=0.397 post=0.341 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.272120 (no previous merge yet)
[S2] round=7 local utility u=0.655963 metrics={'f1_val': 0.6049618945686995, 'auprc': 0.7513953945754853, 'loss_val': 0.775175644668153, 'psi': 0.6635352945714139}-{'f1_val': 0.41710880107850823, 'auprc': 0.7379949905933035, 'loss_val': 0.9197814988478937, 'psi': 0.5454632768844263}
[S3] START round=7 head_norm_before_train=1.527974 (no previous merge yet)
[S3] round=7 local utility u=0.364448 metrics={'f1_val': 0.5613513796355291, 'auprc': 0.7839364014418102, 'loss_val': 0.7967633729497955, 'psi': 0.6503853883580415}-{'f1_val': 0.48784656094679835, 'auprc': 0.7451914467620612, 'loss_val': 0.9683952899493127, 'psi': 0.5907845152729034}
[S4] START round=7 head_norm_before_train=1.168373 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3687295971408692, 'auprc': 0.7776366747227907, 'loss_val': 0.9787722222304249, 'psi': 0.5322924281736379}-{'f1_val': 0.41183037827645946, 'auprc': 0.7677550507882904, 'loss_val': 1.0148103096424352, 'psi': 0.5542002472811919}
[S5] START round=7 head_norm_before_train=1.085290 cos_to_last_merge=0.9371 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.937
[S5] round=7 local utility u=0.278744 metrics={'f1_val': 0.7006051326740982, 'auprc': 0.7919129945914729, 'loss_val': 0.4927527766427241, 'psi': 0.7371282774410481}-{'f1_val': 0.6328598133467352, 'auprc': 0.7916708466289977, 'loss_val': 0.6430414221546509, 'psi': 0.6963842266596403}
[S6] START round=7 head_norm_before_train=1.014168 cos_to_last_merge=0.9552 (last merge round=1)
[S6] round=7 local utility u=0.171502 metrics={'f1_val': 0.4166544795555117, 'auprc': 0.613602576992764, 'loss_val': 1.0036943683033452, 'psi': 0.4954337185304126}-{'f1_val': 0.3787035079817252, 'auprc': 0.6131640278426136, 'loss_val': 1.1176765789758576, 'psi': 0.4724877159260805}
[S7] START round=7 head_norm_before_train=1.496535 (no previous merge yet)
[S7] round=7 local utility u=0.000000 metrics={'f1_val': 0.5166342268760646, 'auprc': 0.7787406139816531, 'loss_val': 0.786431550176414, 'psi': 0.6214767817183}-{'f1_val': 0.6026134289655702, 'auprc': 0.7841691073573889, 'loss_val': 0.7305682740454998, 'psi': 0.6752357003222977}
[S8] START round=7 head_norm_before_train=0.694911 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.025758 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7770083572858115, 'loss_val': 1.16601308088848, 'psi': 0.394776932350099}-{'f1_val': 0.13995598239295717, 'auprc': 0.7712814262376622, 'loss_val': 1.2003488047674957, 'psi': 0.3924861599308392}
[S9] START round=7 head_norm_before_train=0.610851 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.023661 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981335131546578, 'loss_val': 0.5198416252212656, 'psi': 0.8200276953864012}-{'f1_val': 0.7012904835408967, 'auprc': 0.9982828088479775, 'loss_val': 0.567611942154376, 'psi': 0.8200874136637291}
[S10] START round=7 head_norm_before_train=1.138272 cos_to_last_merge=0.9978 (last merge round=5)
[S10] round=7 local utility u=0.264539 metrics={'f1_val': 0.42757578539707397, 'auprc': 0.7568530702585404, 'loss_val': 1.0153877701761973, 'psi': 0.5592866993416605}-{'f1_val': 0.41615846728099787, 'auprc': 0.658269866076211, 'loss_val': 1.1802118828392119, 'psi': 0.513003026799083}
[S11] START round=7 head_norm_before_train=0.838696 cos_to_last_merge=0.9971 (last merge round=5)
[S11] round=7 local utility u=0.920431 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.768051399113165, 'loss_val': 1.0656986194090212, 'psi': 0.5606531578303908}-{'f1_val': 0.14041368337311058, 'auprc': 0.752866828390018, 'loss_val': 1.1691637074421102, 'psi': 0.38539494137987357}
[S13] START round=7 head_norm_before_train=0.786531 cos_to_last_merge=0.9967 (last merge round=5)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.37746489940660416, 'auprc': 0.7029472077513718, 'loss_val': 1.0328237613481341, 'psi': 0.5076578227445112}-{'f1_val': 0.4162370592043806, 'auprc': 0.7296238670230332, 'loss_val': 1.1417278461955618, 'psi': 0.5415917823318416}
[S14] START round=7 head_norm_before_train=0.665928 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.010848 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.864400984059135, 'loss_val': 1.1336303254131341, 'psi': 0.42997510535327627}-{'f1_val': 0.14035785288270378, 'auprc': 0.873542520654422, 'loss_val': 1.1827517671468397, 'psi': 0.43363171999139105}
[S15] START round=7 head_norm_before_train=1.031865 cos_to_last_merge=0.9621 (last merge round=1)
[S15] round=7 local utility u=0.088477 metrics={'f1_val': 0.416567672447929, 'auprc': 0.7980404469242687, 'loss_val': 1.0674615252126534, 'psi': 0.5691567822384649}-{'f1_val': 0.41599167481162613, 'auprc': 0.7762271600659055, 'loss_val': 1.175519581580505, 'psi': 0.5600858689133379}
[S16] START round=7 head_norm_before_train=0.746374 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.4172714079442033, 'auprc': 0.5212068026196458, 'loss_val': 1.0867919941786066, 'psi': 0.4588455658143803}-{'f1_val': 0.4144820245979186, 'auprc': 0.7294151446402188, 'loss_val': 1.1181892392478008, 'psi': 0.5404552726148387}
[S17] START round=7 head_norm_before_train=0.801242 cos_to_last_merge=1.0000 (last merge round=6)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3901014611798188, 'auprc': 0.6435747496860924, 'loss_val': 1.0193377785998108, 'psi': 0.49149077658232826}-{'f1_val': 0.3971676116314645, 'auprc': 0.6637976683009285, 'loss_val': 1.090918361978351, 'psi': 0.50381963429925}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.430)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:37109
[S11] not sending this round → trigger blocked (psi=0.561)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.559)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[S8] not sending this round → trigger blocked (psi=0.395)
[S3] not sending this round → trigger blocked (psi=0.650)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.8677
[S8] RECEIVED delta(kind=head bytes=1795) from S2
[S8] cosine check vs S2: cos=0.5537
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.6045
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.0293
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.2050
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.1400 head_norm=0.721581
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.443761e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.1400 head_norm=0.904834 delta_norm=0.544376
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.3775 head_norm=0.821314
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.458706e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.3752 head_norm=0.691093 delta_norm=0.345871
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.4224 head_norm=0.870364
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.596878e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.4224 head_norm=0.924513 delta_norm=0.259688
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7013 head_norm=0.721052
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.103346e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7013 head_norm=0.735951 delta_norm=0.610335
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.4173 head_norm=0.779835
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.495932e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.4171 head_norm=0.668001 delta_norm=0.649593
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.307464 (no previous merge yet)
[S2] round=8 local utility u=0.242017 metrics={'f1_val': 0.7009739925773752, 'auprc': 0.6722939514256719, 'loss_val': 0.6299107806506313, 'psi': 0.6895019761166938}-{'f1_val': 0.6049618945686995, 'auprc': 0.7513953945754853, 'loss_val': 0.775175644668153, 'psi': 0.6635352945714139}
[S3] START round=8 head_norm_before_train=1.560787 (no previous merge yet)
[S3] round=8 local utility u=0.766968 metrics={'f1_val': 0.678500909693525, 'auprc': 0.9624879849845154, 'loss_val': 0.5013794939118054, 'psi': 0.7920957398099211}-{'f1_val': 0.5613513796355291, 'auprc': 0.7839364014418102, 'loss_val': 0.7967633729497955, 'psi': 0.6503853883580415}
[S4] START round=8 head_norm_before_train=1.194519 cos_to_last_merge=0.9973 (last merge round=6)
[S4] round=8 local utility u=0.079813 metrics={'f1_val': 0.37610811293972807, 'auprc': 0.7649038530548885, 'loss_val': 0.8252193911725902, 'psi': 0.5316264089857923}-{'f1_val': 0.3687295971408692, 'auprc': 0.7776366747227907, 'loss_val': 0.9787722222304249, 'psi': 0.5322924281736379}
[S5] START round=8 head_norm_before_train=1.143831 cos_to_last_merge=0.9189 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.919
[S5] round=8 local utility u=0.054940 metrics={'f1_val': 0.7143346225523001, 'auprc': 0.7918884144614163, 'loss_val': 0.465175150231606, 'psi': 0.7453561393159466}-{'f1_val': 0.7006051326740982, 'auprc': 0.7919129945914729, 'loss_val': 0.4927527766427241, 'psi': 0.7371282774410481}
[S6] START round=8 head_norm_before_train=1.042493 cos_to_last_merge=0.9449 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=8 local utility u=0.282620 metrics={'f1_val': 0.4172958214624881, 'auprc': 0.765653960263228, 'loss_val': 0.898455906184882, 'psi': 0.556639076982784}-{'f1_val': 0.4166544795555117, 'auprc': 0.613602576992764, 'loss_val': 1.0036943683033452, 'psi': 0.4954337185304126}
[S7] START round=8 head_norm_before_train=1.544775 (no previous merge yet)
[S7] round=8 local utility u=0.253731 metrics={'f1_val': 0.5795590543429998, 'auprc': 0.7818940428759986, 'loss_val': 0.665979136193999, 'psi': 0.6604930497561994}-{'f1_val': 0.5166342268760646, 'auprc': 0.7787406139816531, 'loss_val': 0.786431550176414, 'psi': 0.6214767817183}
[S8] START round=8 head_norm_before_train=0.904834 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7945228298671011, 'loss_val': 1.0740756891368637, 'psi': 0.7468293791803327}-{'f1_val': 0.13995598239295717, 'auprc': 0.7770083572858115, 'loss_val': 1.16601308088848, 'psi': 0.394776932350099}
[S9] START round=8 head_norm_before_train=0.735951 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.000000 metrics={'f1_val': 0.7011126798871403, 'auprc': 0.9978206650762445, 'loss_val': 0.5545071861490941, 'psi': 0.819795873962782}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981335131546578, 'loss_val': 0.5198416252212656, 'psi': 0.8200276953864012}
[S10] START round=8 head_norm_before_train=1.168932 cos_to_last_merge=0.9900 (last merge round=5)
[S10] round=8 local utility u=0.225058 metrics={'f1_val': 0.4113958060279741, 'auprc': 0.8619315596233244, 'loss_val': 0.7834266050929135, 'psi': 0.5916101074661142}-{'f1_val': 0.42757578539707397, 'auprc': 0.7568530702585404, 'loss_val': 1.0153877701761973, 'psi': 0.5592866993416605}
[S11] START round=8 head_norm_before_train=0.924513 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.259878 metrics={'f1_val': 0.4268995358654275, 'auprc': 0.9016473188307365, 'loss_val': 0.9738009575574135, 'psi': 0.6167986490515511}-{'f1_val': 0.4223876636418746, 'auprc': 0.768051399113165, 'loss_val': 1.0656986194090212, 'psi': 0.5606531578303908}
[S13] START round=8 head_norm_before_train=0.691093 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.41858520535992755, 'auprc': 0.5286823734679078, 'loss_val': 1.0397129625738253, 'psi': 0.46262407260311966}-{'f1_val': 0.37746489940660416, 'auprc': 0.7029472077513718, 'loss_val': 1.0328237613481341, 'psi': 0.5076578227445112}
[S14] START round=8 head_norm_before_train=0.704791 cos_to_last_merge=0.9945 (last merge round=6)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.5213944724647424, 'auprc': 0.8645278979372092, 'loss_val': 0.9703019636064218, 'psi': 0.6586478426537291}-{'f1_val': 0.14035785288270378, 'auprc': 0.864400984059135, 'loss_val': 1.1336303254131341, 'psi': 0.42997510535327627}
[S15] START round=8 head_norm_before_train=1.062192 cos_to_last_merge=0.9547 (last merge round=1)
[S15] round=8 local utility u=0.081069 metrics={'f1_val': 0.4167593395843331, 'auprc': 0.7993677062903795, 'loss_val': 0.9104543396738584, 'psi': 0.5698026862667516}-{'f1_val': 0.416567672447929, 'auprc': 0.7980404469242687, 'loss_val': 1.0674615252126534, 'psi': 0.5691567822384649}
[S16] START round=8 head_norm_before_train=0.668001 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.304559 metrics={'f1_val': 0.43170401048163043, 'auprc': 0.6879674819865325, 'loss_val': 1.0645522865409482, 'psi': 0.5342093990835912}-{'f1_val': 0.4172714079442033, 'auprc': 0.5212068026196458, 'loss_val': 1.0867919941786066, 'psi': 0.4588455658143803}
[S17] START round=8 head_norm_before_train=0.842948 cos_to_last_merge=0.9952 (last merge round=6)
[S17] round=8 local utility u=0.378368 metrics={'f1_val': 0.39023619505744794, 'auprc': 0.8331213354149396, 'loss_val': 0.8320507063694866, 'psi': 0.5673902512004446}-{'f1_val': 0.3901014611798188, 'auprc': 0.6435747496860924, 'loss_val': 1.0193377785998108, 'psi': 0.49149077658232826}
[S6] not sending this round → trigger blocked (psi=0.557)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:37117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.570)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:37104
[S2] not sending this round → trigger blocked (psi=0.690)
[S5] not sending this round → trigger blocked (psi=0.745)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S4] sending update (kind=head size=1806 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.3355
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=-0.0001
[S14] DROPPED delta from S10 (cos=-0.0001 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1806) from S4
[S9] cosine check vs S4: cos=-0.0006
[S9] DROPPED delta from S4 (cos=-0.0006 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S7
[S10] cosine check vs S7: cos=0.8839
[S4] RECEIVED delta(kind=head bytes=1795) from S3
[S4] cosine check vs S3: cos=0.9067
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.8450
[S4] RECEIVED delta(kind=head bytes=1795) from S14
[S4] cosine check vs S14: cos=-0.0385
[S4] DROPPED delta from S14 (cos=-0.0385 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.5527
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S17
[S9] cosine check vs S17: cos=0.3743
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7011 head_norm=0.817023
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.806438e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7011 head_norm=0.710942 delta_norm=0.480644
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3761 head_norm=1.234633
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.527496e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3762 head_norm=1.382234 delta_norm=0.352750
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.4114 head_norm=1.213626
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.825901e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.4114 head_norm=1.359322 delta_norm=0.382590
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5214 head_norm=0.758396
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.141449e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.2912 head_norm=0.756030 delta_norm=0.414145
[S14] aggregate: ROLLBACK (f1_val pre=0.521 post=0.291 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.7150 head_norm=0.925762
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.782536e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.7150 head_norm=0.668750 delta_norm=0.478254
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3902 head_norm=0.897434
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.541509e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3902 head_norm=0.875568 delta_norm=0.254151
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.346774 (no previous merge yet)
[S2] round=9 local utility u=0.156822 metrics={'f1_val': 0.701470645897668, 'auprc': 0.7297146813748889, 'loss_val': 0.49150912447536, 'psi': 0.7127682600885563}-{'f1_val': 0.7009739925773752, 'auprc': 0.6722939514256719, 'loss_val': 0.6299107806506313, 'psi': 0.6895019761166938}
[S3] START round=9 head_norm_before_train=1.595521 (no previous merge yet)
[S3] round=9 local utility u=0.195111 metrics={'f1_val': 0.7005859652789095, 'auprc': 0.99421043934607, 'loss_val': 0.3388351080249293, 'psi': 0.8180357549057737}-{'f1_val': 0.678500909693525, 'auprc': 0.9624879849845154, 'loss_val': 0.5013794939118054, 'psi': 0.7920957398099211}
[S4] START round=9 head_norm_before_train=1.382234 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.006677 metrics={'f1_val': 0.3768684812885948, 'auprc': 0.7557995588576023, 'loss_val': 0.7891153101784741, 'psi': 0.5284409123161978}-{'f1_val': 0.37610811293972807, 'auprc': 0.7649038530548885, 'loss_val': 0.8252193911725902, 'psi': 0.5316264089857923}
[S5] START round=9 head_norm_before_train=1.210459 cos_to_last_merge=0.8996 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.7143346225523001, 'auprc': 0.7914745018556374, 'loss_val': 0.4701904174920249, 'psi': 0.745190574273635}-{'f1_val': 0.7143346225523001, 'auprc': 0.7918884144614163, 'loss_val': 0.465175150231606, 'psi': 0.7453561393159466}
[S6] START round=9 head_norm_before_train=1.078256 cos_to_last_merge=0.9321 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=9 local utility u=0.496191 metrics={'f1_val': 0.5487186758252884, 'auprc': 0.7894215949156403, 'loss_val': 0.7659146289926247, 'psi': 0.6449998434614292}-{'f1_val': 0.4172958214624881, 'auprc': 0.765653960263228, 'loss_val': 0.898455906184882, 'psi': 0.556639076982784}
[S7] START round=9 head_norm_before_train=1.585994 (no previous merge yet)
[S7] round=9 local utility u=0.694441 metrics={'f1_val': 0.6985212246987377, 'auprc': 0.8981533612942045, 'loss_val': 0.33964762928314135, 'psi': 0.7783740793369245}-{'f1_val': 0.5795590543429998, 'auprc': 0.7818940428759986, 'loss_val': 0.665979136193999, 'psi': 0.6604930497561994}
[S8] START round=9 head_norm_before_train=0.668750 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.055055 metrics={'f1_val': 0.7145254456069222, 'auprc': 0.7946434958146774, 'loss_val': 0.9612781242587224, 'psi': 0.7465726656900243}-{'f1_val': 0.7150337453891538, 'auprc': 0.7945228298671011, 'loss_val': 1.0740756891368637, 'psi': 0.7468293791803327}
[S9] START round=9 head_norm_before_train=0.710942 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.041267 metrics={'f1_val': 0.7012888352718426, 'auprc': 0.9981855030363299, 'loss_val': 0.4741250704438594, 'psi': 0.8200475023776376}-{'f1_val': 0.7011126798871403, 'auprc': 0.9978206650762445, 'loss_val': 0.5545071861490941, 'psi': 0.819795873962782}
[S10] START round=9 head_norm_before_train=1.359322 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.7014667009264342, 'auprc': 0.9397722888976858, 'loss_val': 0.6032821522767344, 'psi': 0.7967889361149348}-{'f1_val': 0.4113958060279741, 'auprc': 0.8619315596233244, 'loss_val': 0.7834266050929135, 'psi': 0.5916101074661142}
[S11] START round=9 head_norm_before_train=0.954478 cos_to_last_merge=0.9952 (last merge round=7)
[S11] round=9 local utility u=0.847861 metrics={'f1_val': 0.6306726527830373, 'auprc': 0.9985427031612848, 'loss_val': 0.7914041975748293, 'psi': 0.7778206729343362}-{'f1_val': 0.4268995358654275, 'auprc': 0.9016473188307365, 'loss_val': 0.9738009575574135, 'psi': 0.6167986490515511}
[S13] START round=9 head_norm_before_train=0.721725 cos_to_last_merge=0.9933 (last merge round=7)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.3755828805556426, 'auprc': 0.5329021573227041, 'loss_val': 0.9683953653156264, 'psi': 0.43851059126246716}-{'f1_val': 0.41858520535992755, 'auprc': 0.5286823734679078, 'loss_val': 1.0397129625738253, 'psi': 0.46262407260311966}
[S14] START round=9 head_norm_before_train=0.756030 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.464303 metrics={'f1_val': 0.6666085774798228, 'auprc': 0.865152166610964, 'loss_val': 0.9148539094501131, 'psi': 0.7460260131322793}-{'f1_val': 0.5213944724647424, 'auprc': 0.8645278979372092, 'loss_val': 0.9703019636064218, 'psi': 0.6586478426537291}
[S15] START round=9 head_norm_before_train=1.108498 cos_to_last_merge=0.9437 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=9 local utility u=0.229694 metrics={'f1_val': 0.3843923301979377, 'auprc': 0.9730232745962322, 'loss_val': 0.7778319709909259, 'psi': 0.6198447079572555}-{'f1_val': 0.4167593395843331, 'auprc': 0.7993677062903795, 'loss_val': 0.9104543396738584, 'psi': 0.5698026862667516}
[S16] START round=9 head_norm_before_train=0.703470 cos_to_last_merge=0.9912 (last merge round=7)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.38264920505811467, 'auprc': 0.7264541459306397, 'loss_val': 1.000965896788707, 'psi': 0.5201711814071247}-{'f1_val': 0.43170401048163043, 'auprc': 0.6879674819865325, 'loss_val': 1.0645522865409482, 'psi': 0.5342093990835912}
[S17] START round=9 head_norm_before_train=0.875568 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3642804785796989, 'auprc': 0.7927155442105596, 'loss_val': 0.8668360477925727, 'psi': 0.5356545048320431}-{'f1_val': 0.39023619505744794, 'auprc': 0.8331213354149396, 'loss_val': 0.8320507063694866, 'psi': 0.5673902512004446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:37109
[S10] not sending this round → trigger blocked (psi=0.797)
[S11] not sending this round → trigger blocked (psi=0.778)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:37113
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:37116
[S14] not sending this round → trigger blocked (psi=0.746)
[S7] not sending this round → trigger blocked (psi=0.778)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:37112
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.818)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.528)
[S8] not sending this round → trigger blocked (psi=0.747)
[S6] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1793) from S15
[S16] cosine check vs S15: cos=0.7263
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9148
[S13] RECEIVED delta(kind=head bytes=1794) from S9
[S13] cosine check vs S9: cos=0.6740
[S8] RECEIVED delta(kind=head bytes=1793) from S2
[S8] cosine check vs S2: cos=0.7202
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.6307 head_norm=0.998971
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.270194e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6872 head_norm=1.037793 delta_norm=0.227019
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.3756 head_norm=0.759470
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.151228e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4199 head_norm=0.712954 delta_norm=0.315123
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.7145 head_norm=0.702782
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.042400e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.7145 head_norm=0.978399 delta_norm=0.504240
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.3826 head_norm=0.755492
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.984331e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3845 head_norm=0.889609 delta_norm=0.398433
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.388936 (no previous merge yet)
[S2] round=10 local utility u=0.075822 metrics={'f1_val': 0.7010315658334224, 'auprc': 0.7592623296437466, 'loss_val': 0.4258726166414493, 'psi': 0.7243238713575522}-{'f1_val': 0.701470645897668, 'auprc': 0.7297146813748889, 'loss_val': 0.49150912447536, 'psi': 0.7127682600885563}
[S3] START round=10 head_norm_before_train=1.637816 (no previous merge yet)
[S3] round=10 local utility u=0.021410 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9943774444265305, 'loss_val': 0.29801720762384165, 'psi': 0.8182527152166859}-{'f1_val': 0.7005859652789095, 'auprc': 0.99421043934607, 'loss_val': 0.3388351080249293, 'psi': 0.8180357549057737}
[S4] START round=10 head_norm_before_train=1.417962 cos_to_last_merge=0.9974 (last merge round=8)
[S4] round=10 local utility u=0.764884 metrics={'f1_val': 0.6579252942750133, 'auprc': 0.6599067429421043, 'loss_val': 0.6580092819523259, 'psi': 0.6587178737418498}-{'f1_val': 0.3768684812885948, 'auprc': 0.7557995588576023, 'loss_val': 0.7891153101784741, 'psi': 0.5284409123161978}
[S5] START round=10 head_norm_before_train=1.257763 cos_to_last_merge=0.8864 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.6903111940061046, 'auprc': 0.7915432608464938, 'loss_val': 0.6132291649002565, 'psi': 0.7308040207422604}-{'f1_val': 0.7143346225523001, 'auprc': 0.7914745018556374, 'loss_val': 0.4701904174920249, 'psi': 0.745190574273635}
[S6] START round=10 head_norm_before_train=1.122124 cos_to_last_merge=0.9154 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=10 local utility u=0.632421 metrics={'f1_val': 0.6808905155144482, 'auprc': 0.8996534720751161, 'loss_val': 0.624798399914126, 'psi': 0.7683956981387154}-{'f1_val': 0.5487186758252884, 'auprc': 0.7894215949156403, 'loss_val': 0.7659146289926247, 'psi': 0.6449998434614292}
[S7] START round=10 head_norm_before_train=1.618168 (no previous merge yet)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6095711949231158, 'auprc': 0.7932503342338624, 'loss_val': 0.5956494657078168, 'psi': 0.6830428506474144}-{'f1_val': 0.6985212246987377, 'auprc': 0.8981533612942045, 'loss_val': 0.33964762928314135, 'psi': 0.7783740793369245}
[S8] START round=10 head_norm_before_train=0.978399 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=0.409092 metrics={'f1_val': 0.714460606093301, 'auprc': 0.990183515300703, 'loss_val': 0.7293257842752212, 'psi': 0.8247497697762618}-{'f1_val': 0.7145254456069222, 'auprc': 0.7946434958146774, 'loss_val': 0.9612781242587224, 'psi': 0.7465726656900243}
[S9] START round=10 head_norm_before_train=0.799009 cos_to_last_merge=0.9797 (last merge round=8)
[S9] round=10 local utility u=0.065336 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981921949838259, 'loss_val': 0.3434829375610392, 'psi': 0.8200511681180684}-{'f1_val': 0.7012888352718426, 'auprc': 0.9981855030363299, 'loss_val': 0.4741250704438594, 'psi': 0.8200475023776376}
[S10] START round=10 head_norm_before_train=1.398937 cos_to_last_merge=0.9980 (last merge round=8)
[S10] round=10 local utility u=0.131464 metrics={'f1_val': 0.6894618603300463, 'auprc': 0.9979722170116943, 'loss_val': 0.4429246715948968, 'psi': 0.8128660030027055}-{'f1_val': 0.7014667009264342, 'auprc': 0.9397722888976858, 'loss_val': 0.6032821522767344, 'psi': 0.7967889361149348}
[S11] START round=10 head_norm_before_train=1.037793 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.266499 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9972472071328065, 'loss_val': 0.682882402070147, 'psi': 0.8201387809200866}-{'f1_val': 0.6306726527830373, 'auprc': 0.9985427031612848, 'loss_val': 0.7914041975748293, 'psi': 0.7778206729343362}
[S13] START round=10 head_norm_before_train=0.712954 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.802298 metrics={'f1_val': 0.5652416172831086, 'auprc': 0.6842684154588707, 'loss_val': 0.9558514930992275, 'psi': 0.6128523365534135}-{'f1_val': 0.3755828805556426, 'auprc': 0.5329021573227041, 'loss_val': 0.9683953653156264, 'psi': 0.43851059126246716}
[S14] START round=10 head_norm_before_train=0.798882 cos_to_last_merge=0.9920 (last merge round=8)
[S14] round=10 local utility u=0.396146 metrics={'f1_val': 0.7015765734306869, 'auprc': 0.9931681848184746, 'loss_val': 0.7164172499399232, 'psi': 0.8182132179858019}-{'f1_val': 0.6666085774798228, 'auprc': 0.865152166610964, 'loss_val': 0.9148539094501131, 'psi': 0.7460260131322793}
[S15] START round=10 head_norm_before_train=1.153056 cos_to_last_merge=0.9310 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.42052679397189774, 'auprc': 0.6692507253844386, 'loss_val': 0.7660245919240183, 'psi': 0.5200163665369141}-{'f1_val': 0.3843923301979377, 'auprc': 0.9730232745962322, 'loss_val': 0.7778319709909259, 'psi': 0.6198447079572555}
[S16] START round=10 head_norm_before_train=0.889609 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.189095 metrics={'f1_val': 0.4355516513474991, 'auprc': 0.7264901090856621, 'loss_val': 0.9402983027041045, 'psi': 0.5519270344427644}-{'f1_val': 0.38264920505811467, 'auprc': 0.7264541459306397, 'loss_val': 1.000965896788707, 'psi': 0.5201711814071247}
[S17] START round=10 head_norm_before_train=0.923005 cos_to_last_merge=0.9943 (last merge round=8)
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.35480811482376073, 'auprc': 0.7781614943856205, 'loss_val': 0.891652239521402, 'psi': 0.5241494666485047}-{'f1_val': 0.3642804785796989, 'auprc': 0.7927155442105596, 'loss_val': 0.8668360477925727, 'psi': 0.5356545048320431}
[S2] not sending this round → trigger blocked (psi=0.724)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[S6] not sending this round → trigger blocked (psi=0.768)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[S9] not sending this round → trigger blocked (psi=0.820)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:37117
[S3] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S4
[S9] cosine check vs S4: cos=-0.0804
[S9] DROPPED delta from S4 (cos=-0.0804 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S8
[S17] cosine check vs S8: cos=0.8775
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=0.9516
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] cosine check vs S14: cos=-0.0420
[S4] DROPPED delta from S14 (cos=-0.0420 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.3378
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.2498
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.7940
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.0032
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.433 → S11@127.0.0.1:37112
[S5] ⇄ pheromone p=0.253 → S9@127.0.0.1:37110
[S2] ⇄ pheromone p=0.317 → S8@127.0.0.1:37109
[S9] ⇄ pheromone p=0.227 → S13@127.0.0.1:37113
[S7] ⇄ pheromone p=0.338 → S10@127.0.0.1:37111
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=10 metric=0.7145 head_norm=1.015335
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.589808e-01
[S8] stored merged vector for next round verification (round=10)
[S8] DEBUG after merge:  round=10 metric=0.7144 head_norm=0.793123 delta_norm=0.558981
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.365 → S17@127.0.0.1:37117
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4356 head_norm=0.923093
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.149425e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.3873 head_norm=0.660558 delta_norm=0.514943
[S16] aggregate: ROLLBACK (f1_val pre=0.436 post=0.387 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.259 → S8@127.0.0.1:37109
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6579 head_norm=1.465953
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.661514e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6567 head_norm=1.553052 delta_norm=0.266151
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.360 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.472 → S14@127.0.0.1:37114
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.7016 head_norm=0.859207
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.506255e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6991 head_norm=0.757193 delta_norm=0.450625
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.439 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.345 → S4@127.0.0.1:37104
[S13] ⇄ pheromone p=0.335 → S16@127.0.0.1:37116
[S10] ⇄ pheromone p=0.432 → S14@127.0.0.1:37114
[S15] ⇄ pheromone p=0.254 → S16@127.0.0.1:37116
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3548 head_norm=0.975323
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.470753e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3914 head_norm=0.964383 delta_norm=0.247075
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.245 → S9@127.0.0.1:37110
[S2] START round=11 head_norm_before_train=1.438843 (no previous merge yet)
[S2] round=11 local utility u=0.049877 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.7585377986985533, 'loss_val': 0.3256398642785808, 'psi': 0.7242036297229079}-{'f1_val': 0.7010315658334224, 'auprc': 0.7592623296437466, 'loss_val': 0.4258726166414493, 'psi': 0.7243238713575522}
[S3] START round=11 head_norm_before_train=1.678272 (no previous merge yet)
[S3] round=11 local utility u=0.017074 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9943765076082748, 'loss_val': 0.2623381465343205, 'psi': 0.8180994406385629}-{'f1_val': 0.7008362290767893, 'auprc': 0.9943774444265305, 'loss_val': 0.29801720762384165, 'psi': 0.8182527152166859}
[S4] START round=11 head_norm_before_train=1.553052 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.052749 metrics={'f1_val': 0.6636426988252035, 'auprc': 0.6556859856956958, 'loss_val': 0.5741537393911965, 'psi': 0.6604600135734005}-{'f1_val': 0.6579252942750133, 'auprc': 0.6599067429421043, 'loss_val': 0.6580092819523259, 'psi': 0.6587178737418498}
[S5] START round=11 head_norm_before_train=1.296688 cos_to_last_merge=0.8776 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.878
[S5] round=11 local utility u=0.331004 metrics={'f1_val': 0.7031992092120164, 'auprc': 0.8876897330785569, 'loss_val': 0.3169885114937, 'psi': 0.7769954187586326}-{'f1_val': 0.6903111940061046, 'auprc': 0.7915432608464938, 'loss_val': 0.6132291649002565, 'psi': 0.7308040207422604}
[S6] START round=11 head_norm_before_train=1.166225 cos_to_last_merge=0.8981 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.7093397889999108, 'auprc': 0.81189581959918, 'loss_val': 0.5993719829541614, 'psi': 0.7503622012396185}-{'f1_val': 0.6808905155144482, 'auprc': 0.8996534720751161, 'loss_val': 0.624798399914126, 'psi': 0.7683956981387154}
[S7] START round=11 head_norm_before_train=1.644104 (no previous merge yet)
[S7] round=11 local utility u=0.167219 metrics={'f1_val': 0.6508016122098488, 'auprc': 0.7967760999099098, 'loss_val': 0.5191721940675705, 'psi': 0.7091914072898733}-{'f1_val': 0.6095711949231158, 'auprc': 0.7932503342338624, 'loss_val': 0.5956494657078168, 'psi': 0.6830428506474144}
[S8] START round=11 head_norm_before_train=0.793123 cos_to_last_merge=1.0000 (last merge round=10)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7943114655564038, 'loss_val': 0.7184002798489889, 'psi': 0.746268049461259}-{'f1_val': 0.714460606093301, 'auprc': 0.990183515300703, 'loss_val': 0.7293257842752212, 'psi': 0.8247497697762618}
[S9] START round=11 head_norm_before_train=0.906493 cos_to_last_merge=0.9444 (last merge round=8)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=11 local utility u=0.035738 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9985339656884257, 'loss_val': 0.27453300422520943, 'psi': 0.8203379847965335}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981921949838259, 'loss_val': 0.3434829375610392, 'psi': 0.8200511681180684}
[S10] START round=11 head_norm_before_train=1.443851 cos_to_last_merge=0.9932 (last merge round=8)
[S10] round=11 local utility u=0.053874 metrics={'f1_val': 0.689287422803073, 'auprc': 0.9979954685057995, 'loss_val': 0.3342003420360501, 'psi': 0.8127706410841635}-{'f1_val': 0.6894618603300463, 'auprc': 0.9979722170116943, 'loss_val': 0.4429246715948968, 'psi': 0.8128660030027055}
[S11] START round=11 head_norm_before_train=1.079657 cos_to_last_merge=0.9963 (last merge round=9)
[S11] round=11 local utility u=0.074190 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9980486250325021, 'loss_val': 0.5361195963739288, 'psi': 0.8203806399919928}-{'f1_val': 0.7020664967782734, 'auprc': 0.9972472071328065, 'loss_val': 0.682882402070147, 'psi': 0.8201387809200866}
[S13] START round=11 head_norm_before_train=0.742230 cos_to_last_merge=0.9942 (last merge round=9)
[S13] round=11 local utility u=0.259439 metrics={'f1_val': 0.637117471490442, 'auprc': 0.6869840923970711, 'loss_val': 0.8763748262873226, 'psi': 0.6570641198530937}-{'f1_val': 0.5652416172831086, 'auprc': 0.6842684154588707, 'loss_val': 0.9558514930992275, 'psi': 0.6128523365534135}
[S14] START round=11 head_norm_before_train=0.757193 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.010059 metrics={'f1_val': 0.701751512821432, 'auprc': 0.9955990500356271, 'loss_val': 0.7046420121441144, 'psi': 0.8192905277071101}-{'f1_val': 0.7015765734306869, 'auprc': 0.9931681848184746, 'loss_val': 0.7164172499399232, 'psi': 0.8182132179858019}
[S15] START round=11 head_norm_before_train=1.191809 cos_to_last_merge=0.9184 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=11 local utility u=0.138154 metrics={'f1_val': 0.4372307327397813, 'auprc': 0.7096875664896793, 'loss_val': 0.7112505754158452, 'psi': 0.5462134662397405}-{'f1_val': 0.42052679397189774, 'auprc': 0.6692507253844386, 'loss_val': 0.7660245919240183, 'psi': 0.5200163665369141}
[S16] START round=11 head_norm_before_train=0.660558 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.286209 metrics={'f1_val': 0.5227468304232422, 'auprc': 0.7441213339648128, 'loss_val': 0.9439443806083473, 'psi': 0.6112966318398705}-{'f1_val': 0.4355516513474991, 'auprc': 0.7264901090856621, 'loss_val': 0.9402983027041045, 'psi': 0.5519270344427644}
[S17] START round=11 head_norm_before_train=0.964383 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.081420 metrics={'f1_val': 0.46486716658298455, 'auprc': 0.6223971563394577, 'loss_val': 0.9218727861245677, 'psi': 0.5278791624855739}-{'f1_val': 0.35480811482376073, 'auprc': 0.7781614943856205, 'loss_val': 0.891652239521402, 'psi': 0.5241494666485047}
[S11] not sending this round → trigger blocked (psi=0.820)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.660)
[S14] not sending this round → trigger blocked (psi=0.819)
[S13] not sending this round → trigger blocked (psi=0.657)
[S10] not sending this round → trigger blocked (psi=0.813)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:37113
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.611)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:37116
[S3] not sending this round → trigger blocked (psi=0.818)
[S9] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.3536
[S10] RECEIVED delta(kind=head bytes=1802) from S7
[S10] cosine check vs S7: cos=0.9432
[S8] RECEIVED delta(kind=head bytes=1801) from S2
[S8] cosine check vs S2: cos=0.6988
[S16] RECEIVED delta(kind=head bytes=1798) from S15
[S16] cosine check vs S15: cos=0.6601
[S13] RECEIVED delta(kind=head bytes=1789) from S9
[S13] cosine check vs S9: cos=0.8629
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.6608
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=11 metric=0.7142 head_norm=0.834952
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.424636e-01
[S8] stored merged vector for next round verification (round=11)
[S8] DEBUG after merge:  round=11 metric=0.7142 head_norm=1.078528 delta_norm=0.542464
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6371 head_norm=0.780601
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.554007e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.7123 head_norm=0.858717 delta_norm=0.255401
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.6893 head_norm=1.489323
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.795574e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.6891 head_norm=1.554893 delta_norm=0.279557
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7015 head_norm=0.997953
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.718575e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7015 head_norm=0.839105 delta_norm=0.371857
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.5227 head_norm=0.711747
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.637852e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.5777 head_norm=0.889913 delta_norm=0.463785
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.489239 (no previous merge yet)
[S2] round=12 local utility u=0.128213 metrics={'f1_val': 0.7013141837391442, 'auprc': 0.8340359016313798, 'loss_val': 0.2957084121212044, 'psi': 0.7544028708960384}-{'f1_val': 0.7013141837391442, 'auprc': 0.7585377986985533, 'loss_val': 0.3256398642785808, 'psi': 0.7242036297229079}
[S3] START round=12 head_norm_before_train=1.716048 (no previous merge yet)
[S3] round=12 local utility u=0.006315 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.99715146251712, 'loss_val': 0.25908097501820515, 'psi': 0.8193143072480278}-{'f1_val': 0.7005813959920884, 'auprc': 0.9943765076082748, 'loss_val': 0.2623381465343205, 'psi': 0.8180994406385629}
[S4] START round=12 head_norm_before_train=1.594863 cos_to_last_merge=0.9986 (last merge round=10)
[S4] round=12 local utility u=0.026926 metrics={'f1_val': 0.6626166811621129, 'auprc': 0.6564874552404649, 'loss_val': 0.5165502052626033, 'psi': 0.6601649907934537}-{'f1_val': 0.6636426988252035, 'auprc': 0.6556859856956958, 'loss_val': 0.5741537393911965, 'psi': 0.6604600135734005}
[S5] START round=12 head_norm_before_train=1.329224 cos_to_last_merge=0.8704 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.870
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.7138452995834559, 'auprc': 0.8025300784449452, 'loss_val': 0.3801808347728695, 'psi': 0.7493192111280516}-{'f1_val': 0.7031992092120164, 'auprc': 0.8876897330785569, 'loss_val': 0.3169885114937, 'psi': 0.7769954187586326}
[S6] START round=12 head_norm_before_train=1.210263 cos_to_last_merge=0.8816 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=12 local utility u=0.295196 metrics={'f1_val': 0.7108395004348865, 'auprc': 0.9632189016452817, 'loss_val': 0.4719479311114584, 'psi': 0.8117912609190446}-{'f1_val': 0.7093397889999108, 'auprc': 0.81189581959918, 'loss_val': 0.5993719829541614, 'psi': 0.7503622012396185}
[S7] START round=12 head_norm_before_train=1.665414 (no previous merge yet)
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.6266330015065333, 'auprc': 0.7962201186647119, 'loss_val': 0.568705637700575, 'psi': 0.6944678483698048}-{'f1_val': 0.6508016122098488, 'auprc': 0.7967760999099098, 'loss_val': 0.5191721940675705, 'psi': 0.7091914072898733}
[S8] START round=12 head_norm_before_train=1.078528 cos_to_last_merge=1.0000 (last merge round=11)
[S8] round=12 local utility u=0.351600 metrics={'f1_val': 0.7003141201968273, 'auprc': 0.9797010146965658, 'loss_val': 0.48781894127433867, 'psi': 0.8120688779967227}-{'f1_val': 0.7142391053978291, 'auprc': 0.7943114655564038, 'loss_val': 0.7184002798489889, 'psi': 0.746268049461259}
[S9] START round=12 head_norm_before_train=0.839105 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9984722361835152, 'loss_val': 0.3372409848807841, 'psi': 0.8201631845979441}-{'f1_val': 0.7015406642019387, 'auprc': 0.9985339656884257, 'loss_val': 0.27453300422520943, 'psi': 0.8203379847965335}
[S10] START round=12 head_norm_before_train=1.554893 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.021987 metrics={'f1_val': 0.6910945136609863, 'auprc': 0.9963811535154161, 'loss_val': 0.29622673756297346, 'psi': 0.8132091696027582}-{'f1_val': 0.689287422803073, 'auprc': 0.9979954685057995, 'loss_val': 0.3342003420360501, 'psi': 0.8127706410841635}
[S11] START round=12 head_norm_before_train=1.129457 cos_to_last_merge=0.9872 (last merge round=9)
[S11] round=12 local utility u=0.060784 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9982841254997576, 'loss_val': 0.4152582908480499, 'psi': 0.820474840178895}-{'f1_val': 0.7019353166316534, 'auprc': 0.9980486250325021, 'loss_val': 0.5361195963739288, 'psi': 0.8203806399919928}
[S13] START round=12 head_norm_before_train=0.858717 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.133651 metrics={'f1_val': 0.6868612161987118, 'auprc': 0.6622316868139391, 'loss_val': 0.833277323849972, 'psi': 0.6770094044448027}-{'f1_val': 0.637117471490442, 'auprc': 0.6869840923970711, 'loss_val': 0.8763748262873226, 'psi': 0.6570641198530937}
[S14] START round=12 head_norm_before_train=0.807387 cos_to_last_merge=0.9910 (last merge round=10)
[S14] round=12 local utility u=0.037268 metrics={'f1_val': 0.7001345863492853, 'auprc': 0.991545897295528, 'loss_val': 0.6082445215000031, 'psi': 0.8166991107277823}-{'f1_val': 0.701751512821432, 'auprc': 0.9955990500356271, 'loss_val': 0.7046420121441144, 'psi': 0.8192905277071101}
[S15] START round=12 head_norm_before_train=1.227803 cos_to_last_merge=0.9046 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=12 local utility u=0.417766 metrics={'f1_val': 0.4685539777780809, 'auprc': 0.9025672779272844, 'loss_val': 0.642298107339146, 'psi': 0.6421592978377624}-{'f1_val': 0.4372307327397813, 'auprc': 0.7096875664896793, 'loss_val': 0.7112505754158452, 'psi': 0.5462134662397405}
[S16] START round=12 head_norm_before_train=0.889913 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.128320 metrics={'f1_val': 0.5426403279194436, 'auprc': 0.7534634597890054, 'loss_val': 0.8346925364030953, 'psi': 0.6269695806672684}-{'f1_val': 0.5227468304232422, 'auprc': 0.7441213339648128, 'loss_val': 0.9439443806083473, 'psi': 0.6112966318398705}
[S17] START round=12 head_norm_before_train=1.004662 cos_to_last_merge=0.9965 (last merge round=10)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3453250834689118, 'auprc': 0.6266371006769504, 'loss_val': 0.9808802888195397, 'psi': 0.4578498903521272}-{'f1_val': 0.46486716658298455, 'auprc': 0.6223971563394577, 'loss_val': 0.9218727861245677, 'psi': 0.5278791624855739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[S15] not sending this round → trigger blocked (psi=0.642)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S2] not sending this round → trigger blocked (psi=0.754)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:37112
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=-0.1398
[S9] DROPPED delta from S4 (cos=-0.1398 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.9094
[S4] RECEIVED delta(kind=head bytes=1801) from S3
[S4] cosine check vs S3: cos=0.9716
[S8] RECEIVED delta(kind=head bytes=1805) from S16
[S8] cosine check vs S16: cos=0.4661
[S4] RECEIVED delta(kind=head bytes=1796) from S14
[S4] cosine check vs S14: cos=-0.0091
[S4] DROPPED delta from S14 (cos=-0.0091 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.4190
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9069
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.7142
[S16] RECEIVED delta(kind=head bytes=1795) from S13
[S16] cosine check vs S13: cos=0.3296
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.6626 head_norm=1.638032
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.100826e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6623 head_norm=1.683588 delta_norm=0.210083
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.5426 head_norm=0.935426
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.279851e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.5420 head_norm=0.743195 delta_norm=0.527985
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7003 head_norm=1.120873
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.371153e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7001 head_norm=0.881587 delta_norm=0.537115
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.7019 head_norm=1.179029
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.630848e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.7019 head_norm=1.182415 delta_norm=0.263085
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.7001 head_norm=0.867696
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.188563e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6970 head_norm=0.869862 delta_norm=0.318856
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3453 head_norm=1.042263
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.333922e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3453 head_norm=1.056817 delta_norm=0.233392
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.535670 (no previous merge yet)
[S2] round=13 local utility u=0.144265 metrics={'f1_val': 0.6979871583978238, 'auprc': 0.9412023942965255, 'loss_val': 0.3087163165882487, 'psi': 0.7952732527573045}-{'f1_val': 0.7013141837391442, 'auprc': 0.8340359016313798, 'loss_val': 0.2957084121212044, 'psi': 0.7544028708960384}
[S3] START round=13 head_norm_before_train=1.753299 (no previous merge yet)
[S3] round=13 local utility u=0.008382 metrics={'f1_val': 0.6955510110700865, 'auprc': 0.9959775750343831, 'loss_val': 0.2075633137535762, 'psi': 0.8157216366558051}-{'f1_val': 0.7007562037352997, 'auprc': 0.99715146251712, 'loss_val': 0.25908097501820515, 'psi': 0.8193143072480278}
[S4] START round=13 head_norm_before_train=1.683588 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.166216 metrics={'f1_val': 0.6650851868765889, 'auprc': 0.7551967346170051, 'loss_val': 0.4950561851942791, 'psi': 0.7011298059727554}-{'f1_val': 0.6626166811621129, 'auprc': 0.6564874552404649, 'loss_val': 0.5165502052626033, 'psi': 0.6601649907934537}
[S5] START round=13 head_norm_before_train=1.367298 cos_to_last_merge=0.8644 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.864
[S5] round=13 local utility u=1.000000 metrics={'f1_val': 0.9775078936060898, 'auprc': 0.9958452914431608, 'loss_val': 0.20947201619545935, 'psi': 0.9848428527409182}-{'f1_val': 0.7138452995834559, 'auprc': 0.8025300784449452, 'loss_val': 0.3801808347728695, 'psi': 0.7493192111280516}
[S6] START round=13 head_norm_before_train=1.242791 cos_to_last_merge=0.8678 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6990123002789431, 'auprc': 0.8218102373499394, 'loss_val': 0.4862076692251041, 'psi': 0.7481314751073416}-{'f1_val': 0.7108395004348865, 'auprc': 0.9632189016452817, 'loss_val': 0.4719479311114584, 'psi': 0.8117912609190446}
[S7] START round=13 head_norm_before_train=1.680268 (no previous merge yet)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.6104556239332297, 'auprc': 0.7927954554669985, 'loss_val': 0.5630224442388461, 'psi': 0.6833915565467372}-{'f1_val': 0.6266330015065333, 'auprc': 0.7962201186647119, 'loss_val': 0.568705637700575, 'psi': 0.6944678483698048}
[S8] START round=13 head_norm_before_train=0.881587 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.7933398752482836, 'loss_val': 0.6537826625855416, 'psi': 0.7458794133380109}-{'f1_val': 0.7003141201968273, 'auprc': 0.9797010146965658, 'loss_val': 0.48781894127433867, 'psi': 0.8120688779967227}
[S9] START round=13 head_norm_before_train=0.913423 cos_to_last_merge=0.9948 (last merge round=11)
[S9] round=13 local utility u=0.919274 metrics={'f1_val': 0.9895530216146718, 'auprc': 0.9984111946405363, 'loss_val': 0.2280845624803411, 'psi': 0.9930962908250176}-{'f1_val': 0.7012904835408967, 'auprc': 0.9984722361835152, 'loss_val': 0.3372409848807841, 'psi': 0.8201631845979441}
[S10] START round=13 head_norm_before_train=1.593610 cos_to_last_merge=0.9992 (last merge round=11)
[S10] round=13 local utility u=0.260073 metrics={'f1_val': 0.7803392650153169, 'auprc': 0.9909599518647323, 'loss_val': 0.29528501483072245, 'psi': 0.8645875397550831}-{'f1_val': 0.6910945136609863, 'auprc': 0.9963811535154161, 'loss_val': 0.29622673756297346, 'psi': 0.8132091696027582}
[S11] START round=13 head_norm_before_train=1.182415 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.285252 metrics={'f1_val': 0.7926789498590143, 'auprc': 0.998347732798344, 'loss_val': 0.38940755693167844, 'psi': 0.8749464630347462}-{'f1_val': 0.7019353166316534, 'auprc': 0.9982841254997576, 'loss_val': 0.4152582908480499, 'psi': 0.820474840178895}
[S13] START round=13 head_norm_before_train=0.887239 cos_to_last_merge=0.9964 (last merge round=11)
[S13] round=13 local utility u=0.094268 metrics={'f1_val': 0.7089185168392816, 'auprc': 0.6702980033683005, 'loss_val': 0.8012845018377764, 'psi': 0.6934703114508891}-{'f1_val': 0.6868612161987118, 'auprc': 0.6622316868139391, 'loss_val': 0.833277323849972, 'psi': 0.6770094044448027}
[S14] START round=13 head_norm_before_train=0.869862 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.6454710655101479, 'auprc': 0.9242244544258258, 'loss_val': 0.6613214937521542, 'psi': 0.756972421076419}-{'f1_val': 0.7001345863492853, 'auprc': 0.991545897295528, 'loss_val': 0.6082445215000031, 'psi': 0.8166991107277823}
[S15] START round=13 head_norm_before_train=1.267016 cos_to_last_merge=0.8933 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=13 local utility u=0.047371 metrics={'f1_val': 0.5025616681350806, 'auprc': 0.8430989663993828, 'loss_val': 0.5731978859723037, 'psi': 0.6387765874408015}-{'f1_val': 0.4685539777780809, 'auprc': 0.9025672779272844, 'loss_val': 0.642298107339146, 'psi': 0.6421592978377624}
[S16] START round=13 head_norm_before_train=0.743195 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.000000 metrics={'f1_val': 0.39081778288259517, 'auprc': 0.7392524212403616, 'loss_val': 0.9563382147537987, 'psi': 0.5301916382257017}-{'f1_val': 0.5426403279194436, 'auprc': 0.7534634597890054, 'loss_val': 0.8346925364030953, 'psi': 0.6269695806672684}
[S17] START round=13 head_norm_before_train=1.056817 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3318981674427793, 'auprc': 0.5686295256841586, 'loss_val': 1.087827843959114, 'psi': 0.426590710739331}-{'f1_val': 0.3453250834689118, 'auprc': 0.6266371006769504, 'loss_val': 0.9808802888195397, 'psi': 0.4578498903521272}
[S13] not sending this round → trigger blocked (psi=0.693)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:37113
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.701)
[S10] not sending this round → trigger blocked (psi=0.865)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.875)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.816)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S9
[S13] cosine check vs S9: cos=0.8906
[S8] RECEIVED delta(kind=head bytes=1796) from S2
[S8] cosine check vs S2: cos=0.7236
[S16] RECEIVED delta(kind=head bytes=1800) from S15
[S16] cosine check vs S15: cos=0.6187
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.5236
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7142 head_norm=0.924253
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.530177e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7142 head_norm=1.165090 delta_norm=0.553018
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.7089 head_norm=0.920143
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.275880e-01
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.7089 head_norm=0.932806 delta_norm=0.227588
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9896 head_norm=0.998591
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.096435e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9958 head_norm=1.049636 delta_norm=0.609644
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=13 metric=0.3908 head_norm=0.792758
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.140678e-01
[S16] stored merged vector for next round verification (round=13)
[S16] DEBUG after merge:  round=13 metric=0.6266 head_norm=0.951833 delta_norm=0.514068
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.572349 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6677426706164676, 'auprc': 0.9483582774290024, 'loss_val': 0.4572215060671085, 'psi': 0.7799889133414815}-{'f1_val': 0.6979871583978238, 'auprc': 0.9412023942965255, 'loss_val': 0.3087163165882487, 'psi': 0.7952732527573045}
[S3] START round=14 head_norm_before_train=1.784309 (no previous merge yet)
[S3] round=14 local utility u=0.956847 metrics={'f1_val': 0.9974247332315468, 'auprc': 0.9992417416215773, 'loss_val': 0.11490398442744483, 'psi': 0.998151536587559}-{'f1_val': 0.6955510110700865, 'auprc': 0.9959775750343831, 'loss_val': 0.2075633137535762, 'psi': 0.8157216366558051}
[S4] START round=14 head_norm_before_train=1.718178 cos_to_last_merge=0.9994 (last merge round=12)
[S4] round=14 local utility u=1.000000 metrics={'f1_val': 0.9455382607033206, 'auprc': 0.9437611551578845, 'loss_val': 0.4845018523059075, 'psi': 0.9448274184851462}-{'f1_val': 0.6650851868765889, 'auprc': 0.7551967346170051, 'loss_val': 0.4950561851942791, 'psi': 0.7011298059727554}
[S5] START round=14 head_norm_before_train=1.396286 cos_to_last_merge=0.8606 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.8636720052616021, 'auprc': 0.9945484691039972, 'loss_val': 0.20433372659792332, 'psi': 0.9160225907985602}-{'f1_val': 0.9775078936060898, 'auprc': 0.9958452914431608, 'loss_val': 0.20947201619545935, 'psi': 0.9848428527409182}
[S6] START round=14 head_norm_before_train=1.277456 cos_to_last_merge=0.8553 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.855
[S6] round=14 local utility u=0.257174 metrics={'f1_val': 0.709965291213394, 'auprc': 0.9462183553075196, 'loss_val': 0.41080139922851994, 'psi': 0.8044665168510443}-{'f1_val': 0.6990123002789431, 'auprc': 0.8218102373499394, 'loss_val': 0.4862076692251041, 'psi': 0.7481314751073416}
[S7] START round=14 head_norm_before_train=1.690567 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5442926964463382, 'auprc': 0.7824876536614384, 'loss_val': 0.7942496201818713, 'psi': 0.6395706793323782}-{'f1_val': 0.6104556239332297, 'auprc': 0.7927954554669985, 'loss_val': 0.5630224442388461, 'psi': 0.6833915565467372}
[S8] START round=14 head_norm_before_train=1.165090 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.365896 metrics={'f1_val': 0.7002053882669599, 'auprc': 0.9790306834383937, 'loss_val': 0.3948608049185131, 'psi': 0.8117355063355334}-{'f1_val': 0.7142391053978291, 'auprc': 0.7933398752482836, 'loss_val': 0.6537826625855416, 'psi': 0.7458794133380109}
[S9] START round=14 head_norm_before_train=1.049636 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9940217430145928, 'loss_val': 0.29149926334047827, 'psi': 0.9958704447131228}-{'f1_val': 0.9895530216146718, 'auprc': 0.9984111946405363, 'loss_val': 0.2280845624803411, 'psi': 0.9930962908250176}
[S10] START round=14 head_norm_before_train=1.627672 cos_to_last_merge=0.9975 (last merge round=11)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.4976270402335126, 'auprc': 0.8637577189309592, 'loss_val': 0.4640579657852106, 'psi': 0.6440793117124912}-{'f1_val': 0.7803392650153169, 'auprc': 0.9909599518647323, 'loss_val': 0.29528501483072245, 'psi': 0.8645875397550831}
[S11] START round=14 head_norm_before_train=1.218457 cos_to_last_merge=0.9986 (last merge round=12)
[S11] round=14 local utility u=0.530982 metrics={'f1_val': 0.9549664622503342, 'auprc': 0.9982376882442128, 'loss_val': 0.30083821691240625, 'psi': 0.9722749526478857}-{'f1_val': 0.7926789498590143, 'auprc': 0.998347732798344, 'loss_val': 0.38940755693167844, 'psi': 0.8749464630347462}
[S13] START round=14 head_norm_before_train=0.932806 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6784509914584466, 'auprc': 0.6487728999956581, 'loss_val': 0.8091690468350152, 'psi': 0.6665797548733312}-{'f1_val': 0.7089185168392816, 'auprc': 0.6702980033683005, 'loss_val': 0.8012845018377764, 'psi': 0.6934703114508891}
[S14] START round=14 head_norm_before_train=0.914588 cos_to_last_merge=0.9951 (last merge round=12)
[S14] round=14 local utility u=0.125526 metrics={'f1_val': 0.6417309038986024, 'auprc': 0.9825606879097457, 'loss_val': 0.5628368928743048, 'psi': 0.7780628175030597}-{'f1_val': 0.6454710655101479, 'auprc': 0.9242244544258258, 'loss_val': 0.6613214937521542, 'psi': 0.756972421076419}
[S15] START round=14 head_norm_before_train=1.308449 cos_to_last_merge=0.8846 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=14 local utility u=0.725522 metrics={'f1_val': 0.6914461464891393, 'auprc': 0.927794747037661, 'loss_val': 0.5095484649431117, 'psi': 0.7859855867085479}-{'f1_val': 0.5025616681350806, 'auprc': 0.8430989663993828, 'loss_val': 0.5731978859723037, 'psi': 0.6387765874408015}
[S16] START round=14 head_norm_before_train=0.951833 cos_to_last_merge=1.0000 (last merge round=13)
[S16] round=14 local utility u=0.976340 metrics={'f1_val': 0.6907803405034005, 'auprc': 0.7490061275961476, 'loss_val': 0.8326950218450689, 'psi': 0.7140706553404994}-{'f1_val': 0.39081778288259517, 'auprc': 0.7392524212403616, 'loss_val': 0.9563382147537987, 'psi': 0.5301916382257017}
[S17] START round=14 head_norm_before_train=1.088379 cos_to_last_merge=0.9979 (last merge round=12)
[S17] round=14 local utility u=0.193921 metrics={'f1_val': 0.3523291739994857, 'auprc': 0.6093334005262417, 'loss_val': 0.9446832524752152, 'psi': 0.45513086461018815}-{'f1_val': 0.3318981674427793, 'auprc': 0.5686295256841586, 'loss_val': 1.087827843959114, 'psi': 0.426590710739331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S4@127.0.0.1:37104
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S15] not sending this round → trigger blocked (psi=0.786)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:37117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1789) from S14
[S4] cosine check vs S14: cos=0.0173
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.4950
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.6602
[S11] RECEIVED delta(kind=head bytes=1805) from S6
[S11] cosine check vs S6: cos=0.9524
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=-0.1580
[S9] DROPPED delta from S4 (cos=-0.1580 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S8
[S17] cosine check vs S8: cos=0.9454
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=0.9827
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.3007
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.9971 head_norm=1.112149
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.599830e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.9971 head_norm=0.900057 delta_norm=0.659983
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.9550 head_norm=1.260733
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.999155e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.9550 head_norm=1.270477 delta_norm=0.199915
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9455 head_norm=1.746490
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.929505e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9466 head_norm=1.347617 delta_norm=0.492951
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=14 metric=0.7002 head_norm=1.207289
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.612795e-01
[S8] stored merged vector for next round verification (round=14)
[S8] DEBUG after merge:  round=14 metric=0.7002 head_norm=0.954512 delta_norm=0.561279
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6417 head_norm=0.967353
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.782539e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.7021 head_norm=1.016801 delta_norm=0.478254
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3523 head_norm=1.120038
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.970570e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3522 head_norm=1.147686 delta_norm=0.197057
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.603655 (no previous merge yet)
[S2] round=15 local utility u=0.144174 metrics={'f1_val': 0.6924751757612997, 'auprc': 0.9435926938877146, 'loss_val': 0.30297134446123586, 'psi': 0.7929221830118657}-{'f1_val': 0.6677426706164676, 'auprc': 0.9483582774290024, 'loss_val': 0.4572215060671085, 'psi': 0.7799889133414815}
[S3] START round=15 head_norm_before_train=1.816018 (no previous merge yet)
[S3] round=15 local utility u=0.010902 metrics={'f1_val': 0.9965655661594752, 'auprc': 0.999232227126565, 'loss_val': 0.0879163717644094, 'psi': 0.9976322305463112}-{'f1_val': 0.9974247332315468, 'auprc': 0.9992417416215773, 'loss_val': 0.11490398442744483, 'psi': 0.998151536587559}
[S4] START round=15 head_norm_before_train=1.347617 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.6671395642550154, 'auprc': 0.8948348291115013, 'loss_val': 0.4787514372654834, 'psi': 0.7582176701976098}-{'f1_val': 0.9455382607033206, 'auprc': 0.9437611551578845, 'loss_val': 0.4845018523059075, 'psi': 0.9448274184851462}
[S5] START round=15 head_norm_before_train=1.426319 cos_to_last_merge=0.8580 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7154812603109921, 'auprc': 0.919918681529538, 'loss_val': 0.32647013433033995, 'psi': 0.7972562287984105}-{'f1_val': 0.8636720052616021, 'auprc': 0.9945484691039972, 'loss_val': 0.20433372659792332, 'psi': 0.9160225907985602}
[S6] START round=15 head_norm_before_train=1.310995 cos_to_last_merge=0.8452 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.845
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6205842955325758, 'auprc': 0.814453605629039, 'loss_val': 0.49927376804066503, 'psi': 0.6981320195711611}-{'f1_val': 0.709965291213394, 'auprc': 0.9462183553075196, 'loss_val': 0.41080139922851994, 'psi': 0.8044665168510443}
[S7] START round=15 head_norm_before_train=1.702514 (no previous merge yet)
[S7] round=15 local utility u=0.173363 metrics={'f1_val': 0.5826772498109671, 'auprc': 0.7912050303303698, 'loss_val': 0.7039839779727337, 'psi': 0.6660883620187282}-{'f1_val': 0.5442926964463382, 'auprc': 0.7824876536614384, 'loss_val': 0.7942496201818713, 'psi': 0.6395706793323782}
[S8] START round=15 head_norm_before_train=0.954512 cos_to_last_merge=1.0000 (last merge round=14)
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.7921105010585927, 'loss_val': 0.5271410774795586, 'psi': 0.7452544292077057}-{'f1_val': 0.7002053882669599, 'auprc': 0.9790306834383937, 'loss_val': 0.3948608049185131, 'psi': 0.8117355063355334}
[S9] START round=15 head_norm_before_train=0.900057 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.020495 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9986949059088643, 'loss_val': 0.2455481309732059, 'psi': 0.9958415899619539}-{'f1_val': 0.9971029125121428, 'auprc': 0.9940217430145928, 'loss_val': 0.29149926334047827, 'psi': 0.9958704447131228}
[S10] START round=15 head_norm_before_train=1.652151 cos_to_last_merge=0.9958 (last merge round=11)
[S10] round=15 local utility u=1.000000 metrics={'f1_val': 0.9792924842474017, 'auprc': 0.9564484069579949, 'loss_val': 0.22099261116698013, 'psi': 0.9701548533316389}-{'f1_val': 0.4976270402335126, 'auprc': 0.8637577189309592, 'loss_val': 0.4640579657852106, 'psi': 0.6440793117124912}
[S11] START round=15 head_norm_before_train=1.270477 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.9449458585466438, 'auprc': 0.9975626060847794, 'loss_val': 0.3182879176008281, 'psi': 0.9659925575618981}-{'f1_val': 0.9549664622503342, 'auprc': 0.9982376882442128, 'loss_val': 0.30083821691240625, 'psi': 0.9722749526478857}
[S13] START round=15 head_norm_before_train=0.961793 cos_to_last_merge=0.9975 (last merge round=13)
[S13] round=15 local utility u=0.036752 metrics={'f1_val': 0.6729084800568832, 'auprc': 0.658596319777963, 'loss_val': 0.7318801338433988, 'psi': 0.6671836159453151}-{'f1_val': 0.6784509914584466, 'auprc': 0.6487728999956581, 'loss_val': 0.8091690468350152, 'psi': 0.6665797548733312}
[S14] START round=15 head_norm_before_train=1.016801 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=1.000000 metrics={'f1_val': 0.9911348035096593, 'auprc': 0.9956914866278752, 'loss_val': 0.48795778854252947, 'psi': 0.9929574767569458}-{'f1_val': 0.6417309038986024, 'auprc': 0.9825606879097457, 'loss_val': 0.5628368928743048, 'psi': 0.7780628175030597}
[S15] START round=15 head_norm_before_train=1.346409 cos_to_last_merge=0.8761 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.6983745202908911, 'auprc': 0.8021107400001655, 'loss_val': 0.43778226369207224, 'psi': 0.7398690081746009}-{'f1_val': 0.6914461464891393, 'auprc': 0.927794747037661, 'loss_val': 0.5095484649431117, 'psi': 0.7859855867085479}
[S16] START round=15 head_norm_before_train=0.997351 cos_to_last_merge=0.9972 (last merge round=13)
[S16] round=15 local utility u=0.516494 metrics={'f1_val': 0.8265436014806233, 'auprc': 0.781037882099592, 'loss_val': 0.7103819427530045, 'psi': 0.8083413137282108}-{'f1_val': 0.6907803405034005, 'auprc': 0.7490061275961476, 'loss_val': 0.8326950218450689, 'psi': 0.7140706553404994}
[S17] START round=15 head_norm_before_train=1.147686 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.066925 metrics={'f1_val': 0.35415510094970304, 'auprc': 0.6406428591398312, 'loss_val': 0.915717489531781, 'psi': 0.4687502042257543}-{'f1_val': 0.3523291739994857, 'auprc': 0.6093334005262417, 'loss_val': 0.9446832524752152, 'psi': 0.45513086461018815}
[S14] not sending this round → trigger blocked (psi=0.993)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:37111
[S3] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → trigger blocked (psi=0.808)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:37113
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S13
[S16] cosine check vs S13: cos=0.3738
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.2869
[S10] RECEIVED delta(kind=head bytes=1804) from S7
[S10] cosine check vs S7: cos=0.9705
[S13] RECEIVED delta(kind=head bytes=1796) from S9
[S13] cosine check vs S9: cos=0.8767
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.7381
[S17] not sending this round → trigger blocked (psi=0.469)
[S4] ⇄ pheromone p=0.306 → S9@127.0.0.1:37110
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7140 head_norm=0.996443
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.593061e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7140 head_norm=1.229333 delta_norm=0.559306
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.214 → S17@127.0.0.1:37117
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9911 head_norm=1.055823
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.502515e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9946 head_norm=1.108497 delta_norm=0.850251
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.369 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.272 → S4@127.0.0.1:37104
[S6] ⇄ pheromone p=0.213 → S11@127.0.0.1:37112
[S5] ⇄ pheromone p=0.238 → S9@127.0.0.1:37110
[S11] ⇄ pheromone p=0.288 → S14@127.0.0.1:37114
[S15] ⇄ pheromone p=0.259 → S16@127.0.0.1:37116
[S7] ⇄ pheromone p=0.159 → S10@127.0.0.1:37111
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6729 head_norm=0.995707
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.458112e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.7119 head_norm=0.958790 delta_norm=0.245811
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.164 → S16@127.0.0.1:37116
[S2] ⇄ pheromone p=0.169 → S8@127.0.0.1:37109
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9793 head_norm=1.669918
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.069117e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9789 head_norm=1.680064 delta_norm=0.206912
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.381 → S14@127.0.0.1:37114
[S9] ⇄ pheromone p=0.199 → S13@127.0.0.1:37113
[S17] ⇄ pheromone p=0.131 → S9@127.0.0.1:37110
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.8265 head_norm=1.046971
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.718706e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.8223 head_norm=0.846614 delta_norm=0.571871
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.381 → S8@127.0.0.1:37109
[S2] START round=16 head_norm_before_train=1.629500 (no previous merge yet)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7010542679632784, 'auprc': 0.8288035838653852, 'loss_val': 0.27081425779283763, 'psi': 0.7521539943241211}-{'f1_val': 0.6924751757612997, 'auprc': 0.9435926938877146, 'loss_val': 0.30297134446123586, 'psi': 0.7929221830118657}
[S3] START round=16 head_norm_before_train=1.847082 (no previous merge yet)
[S3] round=16 local utility u=0.013924 metrics={'f1_val': 0.9973670153333725, 'auprc': 0.9988621765740995, 'loss_val': 0.06376733438440244, 'psi': 0.9979650798296633}-{'f1_val': 0.9965655661594752, 'auprc': 0.999232227126565, 'loss_val': 0.0879163717644094, 'psi': 0.9976322305463112}
[S4] START round=16 head_norm_before_train=1.376325 cos_to_last_merge=0.9993 (last merge round=14)
[S4] round=16 local utility u=0.900435 metrics={'f1_val': 0.9454955591587603, 'auprc': 0.9310088373473651, 'loss_val': 0.4565402182277168, 'psi': 0.9397008704342023}-{'f1_val': 0.6671395642550154, 'auprc': 0.8948348291115013, 'loss_val': 0.4787514372654834, 'psi': 0.7582176701976098}
[S5] START round=16 head_norm_before_train=1.449620 cos_to_last_merge=0.8566 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=16 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9975970264878605, 'loss_val': 0.11714851634695156, 'psi': 0.9968383651884385}-{'f1_val': 0.7154812603109921, 'auprc': 0.919918681529538, 'loss_val': 0.32647013433033995, 'psi': 0.7972562287984105}
[S6] START round=16 head_norm_before_train=1.339332 cos_to_last_merge=0.8376 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=16 local utility u=0.037223 metrics={'f1_val': 0.6214050861125803, 'auprc': 0.8203684524179782, 'loss_val': 0.4474980141481696, 'psi': 0.7009904326347395}-{'f1_val': 0.6205842955325758, 'auprc': 0.814453605629039, 'loss_val': 0.49927376804066503, 'psi': 0.6981320195711611}
[S7] START round=16 head_norm_before_train=1.715293 (no previous merge yet)
[S7] round=16 local utility u=0.542329 metrics={'f1_val': 0.6981787588490276, 'auprc': 0.8119219263501425, 'loss_val': 0.37448474294399076, 'psi': 0.7436760258494736}-{'f1_val': 0.5826772498109671, 'auprc': 0.7912050303303698, 'loss_val': 0.7039839779727337, 'psi': 0.6660883620187282}
[S8] START round=16 head_norm_before_train=1.229333 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.355940 metrics={'f1_val': 0.7014254687860759, 'auprc': 0.9819488514053634, 'loss_val': 0.30922676674583655, 'psi': 0.813634821833791}-{'f1_val': 0.7140170479737811, 'auprc': 0.7921105010585927, 'loss_val': 0.5271410774795586, 'psi': 0.7452544292077057}
[S9] START round=16 head_norm_before_train=0.983855 cos_to_last_merge=0.9911 (last merge round=14)
[S9] round=16 local utility u=0.048244 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9983417058190764, 'loss_val': 0.15802401529739166, 'psi': 0.9967025686014925}-{'f1_val': 0.9939393793306803, 'auprc': 0.9986949059088643, 'loss_val': 0.2455481309732059, 'psi': 0.9958415899619539}
[S10] START round=16 head_norm_before_train=1.680064 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.7010930393875792, 'auprc': 0.9906698898756183, 'loss_val': 0.22751551986925497, 'psi': 0.8169237795827948}-{'f1_val': 0.9792924842474017, 'auprc': 0.9564484069579949, 'loss_val': 0.22099261116698013, 'psi': 0.9701548533316389}
[S11] START round=16 head_norm_before_train=1.307024 cos_to_last_merge=0.9990 (last merge round=14)
[S11] round=16 local utility u=0.093135 metrics={'f1_val': 0.959976774839181, 'auprc': 0.9978245615944891, 'loss_val': 0.22298990226974022, 'psi': 0.9751158895413042}-{'f1_val': 0.9449458585466438, 'auprc': 0.9975626060847794, 'loss_val': 0.3182879176008281, 'psi': 0.9659925575618981}
[S13] START round=16 head_norm_before_train=0.958790 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5851256626092478, 'auprc': 0.659766253067398, 'loss_val': 0.7891366039991851, 'psi': 0.6149818987925079}-{'f1_val': 0.6729084800568832, 'auprc': 0.658596319777963, 'loss_val': 0.7318801338433988, 'psi': 0.6671836159453151}
[S14] START round=16 head_norm_before_train=1.108497 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.013058 metrics={'f1_val': 0.9975054147531532, 'auprc': 0.9970563902281491, 'loss_val': 0.5041609103149043, 'psi': 0.9973258049431515}-{'f1_val': 0.9911348035096593, 'auprc': 0.9956914866278752, 'loss_val': 0.48795778854252947, 'psi': 0.9929574767569458}
[S15] START round=16 head_norm_before_train=1.389323 cos_to_last_merge=0.8683 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=16 local utility u=0.069853 metrics={'f1_val': 0.6971487926588631, 'auprc': 0.8362176790340197, 'loss_val': 0.39304299472546905, 'psi': 0.7527763472089257}-{'f1_val': 0.6983745202908911, 'auprc': 0.8021107400001655, 'loss_val': 0.43778226369207224, 'psi': 0.7398690081746009}
[S16] START round=16 head_norm_before_train=0.846614 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.811228808646269, 'auprc': 0.8047168283337196, 'loss_val': 0.740065289205766, 'psi': 0.8086240165212493}-{'f1_val': 0.8265436014806233, 'auprc': 0.781037882099592, 'loss_val': 0.7103819427530045, 'psi': 0.8083413137282108}
[S17] START round=16 head_norm_before_train=1.170616 cos_to_last_merge=0.9986 (last merge round=14)
[S17] round=16 local utility u=0.044246 metrics={'f1_val': 0.35376849572053815, 'auprc': 0.6758074181500491, 'loss_val': 0.9304000399614335, 'psi': 0.4825840646923425}-{'f1_val': 0.35415510094970304, 'auprc': 0.6406428591398312, 'loss_val': 0.915717489531781, 'psi': 0.4687502042257543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:37116
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[S9] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.744)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S6] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9749
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.4792
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.1295
[S9] DROPPED delta from S4 (cos=-0.1295 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1805) from S15
[S16] cosine check vs S15: cos=0.6076
[S17] RECEIVED delta(kind=head bytes=1807) from S8
[S17] cosine check vs S8: cos=0.9661
[S4] RECEIVED delta(kind=head bytes=1797) from S14
[S4] cosine check vs S14: cos=0.1967
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.9624
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.4535
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.7493
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=16 metric=0.9956 head_norm=1.074325
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.747430e-01
[S9] stored merged vector for next round verification (round=16)
[S9] DEBUG after merge:  round=16 metric=0.9964 head_norm=0.965800 delta_norm=0.274743
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9975 head_norm=1.141587
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.526704e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9975 head_norm=1.057000 delta_norm=0.652670
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9600 head_norm=1.335378
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.523864e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9590 head_norm=1.343688 delta_norm=0.152386
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.9455 head_norm=1.407431
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.001183e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.9459 head_norm=1.234252 delta_norm=0.300118
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.8112 head_norm=0.896135
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.692909e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7607 head_norm=1.050894 delta_norm=0.569291
[S16] aggregate: ROLLBACK (f1_val pre=0.811 post=0.761 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=16 metric=0.3538 head_norm=1.193180
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.638658e-01
[S17] stored merged vector for next round verification (round=16)
[S17] DEBUG after merge:  round=16 metric=0.3677 head_norm=1.218698 delta_norm=0.163866
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.650427 (no previous merge yet)
[S2] round=17 local utility u=0.065247 metrics={'f1_val': 0.6922949618721358, 'auprc': 0.8989658941932804, 'loss_val': 0.2982508829504558, 'psi': 0.7749633348005937}-{'f1_val': 0.7010542679632784, 'auprc': 0.8288035838653852, 'loss_val': 0.27081425779283763, 'psi': 0.7521539943241211}
[S3] START round=17 head_norm_before_train=1.882939 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987414319226879, 'loss_val': 0.08099797660649907, 'psi': 0.9761177234323413}-{'f1_val': 0.9973670153333725, 'auprc': 0.9988621765740995, 'loss_val': 0.06376733438440244, 'psi': 0.9979650798296633}
[S4] START round=17 head_norm_before_train=1.234252 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.7410154691185054, 'auprc': 0.949872228719, 'loss_val': 0.48828617300939126, 'psi': 0.8245581729587033}-{'f1_val': 0.9454955591587603, 'auprc': 0.9310088373473651, 'loss_val': 0.4565402182277168, 'psi': 0.9397008704342023}
[S5] START round=17 head_norm_before_train=1.464873 cos_to_last_merge=0.8558 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=17 local utility u=0.005353 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9975294994185019, 'loss_val': 0.10624057987916098, 'psi': 0.996811354360695}-{'f1_val': 0.9963325909888239, 'auprc': 0.9975970264878605, 'loss_val': 0.11714851634695156, 'psi': 0.9968383651884385}
[S6] START round=17 head_norm_before_train=1.369015 cos_to_last_merge=0.8312 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.831
[S6] round=17 local utility u=0.546518 metrics={'f1_val': 0.7101884186335065, 'auprc': 0.9566632265282734, 'loss_val': 0.29604713366038415, 'psi': 0.8087783417914132}-{'f1_val': 0.6214050861125803, 'auprc': 0.8203684524179782, 'loss_val': 0.4474980141481696, 'psi': 0.7009904326347395}
[S7] START round=17 head_norm_before_train=1.726010 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.62117497968578, 'auprc': 0.7915960738856929, 'loss_val': 0.5853661019885852, 'psi': 0.6893434173657451}-{'f1_val': 0.6981787588490276, 'auprc': 0.8119219263501425, 'loss_val': 0.37448474294399076, 'psi': 0.7436760258494736}
[S8] START round=17 head_norm_before_train=1.265098 cos_to_last_merge=0.9990 (last merge round=15)
[S8] round=17 local utility u=0.903439 metrics={'f1_val': 0.988668482868647, 'auprc': 0.990088424759092, 'loss_val': 0.25022619257284456, 'psi': 0.9892364596248249}-{'f1_val': 0.7014254687860759, 'auprc': 0.9819488514053634, 'loss_val': 0.30922676674583655, 'psi': 0.813634821833791}
[S9] START round=17 head_norm_before_train=0.965800 cos_to_last_merge=1.0000 (last merge round=16)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9956096690375639, 'loss_val': 0.1957582925032993, 'psi': 0.9963554188703798}-{'f1_val': 0.9956098104564366, 'auprc': 0.9983417058190764, 'loss_val': 0.15802401529739166, 'psi': 0.9967025686014925}
[S10] START round=17 head_norm_before_train=1.695112 cos_to_last_merge=0.9999 (last merge round=15)
[S10] round=17 local utility u=0.753430 metrics={'f1_val': 0.9802311922526156, 'auprc': 0.9453996331756771, 'loss_val': 0.25967448458395725, 'psi': 0.9662985686218402}-{'f1_val': 0.7010930393875792, 'auprc': 0.9906698898756183, 'loss_val': 0.22751551986925497, 'psi': 0.8169237795827948}
[S11] START round=17 head_norm_before_train=1.343688 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.098055 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9979659999616154, 'loss_val': 0.24920827681511146, 'psi': 0.9973628978314228}-{'f1_val': 0.959976774839181, 'auprc': 0.9978245615944891, 'loss_val': 0.22298990226974022, 'psi': 0.9751158895413042}
[S13] START round=17 head_norm_before_train=0.987774 cos_to_last_merge=0.9979 (last merge round=15)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5642146426356953, 'auprc': 0.6195645821740768, 'loss_val': 0.7986229767666588, 'psi': 0.586354618451048}-{'f1_val': 0.5851256626092478, 'auprc': 0.659766253067398, 'loss_val': 0.7891366039991851, 'psi': 0.6149818987925079}
[S14] START round=17 head_norm_before_train=1.057000 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.035729 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9968866365958574, 'loss_val': 0.4306041788889328, 'psi': 0.9970988686618187}-{'f1_val': 0.9975054147531532, 'auprc': 0.9970563902281491, 'loss_val': 0.5041609103149043, 'psi': 0.9973258049431515}
[S15] START round=17 head_norm_before_train=1.433137 cos_to_last_merge=0.8600 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=17 local utility u=0.292181 metrics={'f1_val': 0.6966187137620875, 'auprc': 0.9902859802201951, 'loss_val': 0.2677044432365584, 'psi': 0.8140856203453306}-{'f1_val': 0.6971487926588631, 'auprc': 0.8362176790340197, 'loss_val': 0.39304299472546905, 'psi': 0.7527763472089257}
[S16] START round=17 head_norm_before_train=1.050894 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.305081 metrics={'f1_val': 0.8506253112488098, 'auprc': 0.8900774556081194, 'loss_val': 0.6223638960106762, 'psi': 0.8664061689925335}-{'f1_val': 0.811228808646269, 'auprc': 0.8047168283337196, 'loss_val': 0.740065289205766, 'psi': 0.8086240165212493}
[S17] START round=17 head_norm_before_train=1.218698 cos_to_last_merge=1.0000 (last merge round=16)
[S17] round=17 local utility u=0.008003 metrics={'f1_val': 0.3571086729290729, 'auprc': 0.6754128477548939, 'loss_val': 0.9332518237645617, 'psi': 0.4844303428594013}-{'f1_val': 0.35376849572053815, 'auprc': 0.6758074181500491, 'loss_val': 0.9304000399614335, 'psi': 0.4825840646923425}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.814)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[S8] not sending this round → trigger blocked (psi=0.989)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[S6] not sending this round → trigger blocked (psi=0.809)
[S14] not sending this round → trigger blocked (psi=0.997)
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.5067
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=0.9529
[S14] RECEIVED delta(kind=head bytes=1805) from S10
[S14] cosine check vs S10: cos=0.4667
[S17] not sending this round → trigger blocked (psi=0.484)
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=17 metric=0.9887 head_norm=1.296243
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.836484e-01
[S8] stored merged vector for next round verification (round=17)
[S8] DEBUG after merge:  round=17 metric=0.9930 head_norm=1.193448 delta_norm=0.183648
[S8] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.9972 head_norm=1.097722
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.716168e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9972 head_norm=1.213388 delta_norm=0.771617
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.667824 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6418839858845934, 'auprc': 0.9191725465899219, 'loss_val': 0.5055149185397971, 'psi': 0.7527994101667248}-{'f1_val': 0.6922949618721358, 'auprc': 0.8989658941932804, 'loss_val': 0.2982508829504558, 'psi': 0.7749633348005937}
[S3] START round=18 head_norm_before_train=1.914097 (no previous merge yet)
[S3] round=18 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986756166775397, 'loss_val': 0.09940108299083034, 'psi': 0.976091397334282}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987414319226879, 'loss_val': 0.08099797660649907, 'psi': 0.9761177234323413}
[S4] START round=18 head_norm_before_train=1.270342 cos_to_last_merge=0.9990 (last merge round=16)
[S4] round=18 local utility u=0.656292 metrics={'f1_val': 0.9471883260356969, 'auprc': 0.9530252756682029, 'loss_val': 0.42219914634185846, 'psi': 0.9495231058886993}-{'f1_val': 0.7410154691185054, 'auprc': 0.949872228719, 'loss_val': 0.48828617300939126, 'psi': 0.8245581729587033}
[S5] START round=18 head_norm_before_train=1.482718 cos_to_last_merge=0.8550 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.855
[S5] round=18 local utility u=0.007041 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9975566366495756, 'loss_val': 0.09136093789974133, 'psi': 0.9967342686454168}-{'f1_val': 0.9963325909888239, 'auprc': 0.9975294994185019, 'loss_val': 0.10624057987916098, 'psi': 0.996811354360695}
[S6] START round=18 head_norm_before_train=1.399153 cos_to_last_merge=0.8251 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.825
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.6433482516069464, 'auprc': 0.8217183097503167, 'loss_val': 0.45550396861679054, 'psi': 0.7146962748642944}-{'f1_val': 0.7101884186335065, 'auprc': 0.9566632265282734, 'loss_val': 0.29604713366038415, 'psi': 0.8087783417914132}
[S7] START round=18 head_norm_before_train=1.735187 (no previous merge yet)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.6079115038316315, 'auprc': 0.7922258090651868, 'loss_val': 0.5836883773676544, 'psi': 0.6816372259250536}-{'f1_val': 0.62117497968578, 'auprc': 0.7915960738856929, 'loss_val': 0.5853661019885852, 'psi': 0.6893434173657451}
[S8] START round=18 head_norm_before_train=1.193448 cos_to_last_merge=1.0000 (last merge round=17)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9234476626584901, 'loss_val': 0.40060191859701133, 'psi': 0.7977645812708809}-{'f1_val': 0.988668482868647, 'auprc': 0.990088424759092, 'loss_val': 0.25022619257284456, 'psi': 0.9892364596248249}
[S9] START round=18 head_norm_before_train=1.044785 cos_to_last_merge=0.9953 (last merge round=16)
[S9] round=18 local utility u=0.032717 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952269447629019, 'loss_val': 0.13067837070805413, 'psi': 0.9963525254124465}-{'f1_val': 0.9968525854255906, 'auprc': 0.9956096690375639, 'loss_val': 0.1957582925032993, 'psi': 0.9963554188703798}
[S10] START round=18 head_norm_before_train=1.711844 cos_to_last_merge=0.9996 (last merge round=15)
[S10] round=18 local utility u=0.169579 metrics={'f1_val': 0.9919084505890279, 'auprc': 0.9974158638070199, 'loss_val': 0.1466283197702567, 'psi': 0.9941114158762246}-{'f1_val': 0.9802311922526156, 'auprc': 0.9453996331756771, 'loss_val': 0.25967448458395725, 'psi': 0.9662985686218402}
[S11] START round=18 head_norm_before_train=1.370323 cos_to_last_merge=0.9994 (last merge round=16)
[S11] round=18 local utility u=0.031696 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9981328054881522, 'loss_val': 0.1863176164120012, 'psi': 0.9974296200420376}-{'f1_val': 0.996960829744628, 'auprc': 0.9979659999616154, 'loss_val': 0.24920827681511146, 'psi': 0.9973628978314228}
[S13] START round=18 head_norm_before_train=1.021368 cos_to_last_merge=0.9924 (last merge round=15)
[S13] round=18 local utility u=0.229713 metrics={'f1_val': 0.5999187208848785, 'auprc': 0.6709777667443189, 'loss_val': 0.7076607085220318, 'psi': 0.6283423392286547}-{'f1_val': 0.5642146426356953, 'auprc': 0.6195645821740768, 'loss_val': 0.7986229767666588, 'psi': 0.586354618451048}
[S14] START round=18 head_norm_before_train=1.213388 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.000000 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9970165585682206, 'loss_val': 0.47605195334216793, 'psi': 0.9969046715226151}-{'f1_val': 0.997240356705793, 'auprc': 0.9968866365958574, 'loss_val': 0.4306041788889328, 'psi': 0.9970988686618187}
[S15] START round=18 head_norm_before_train=1.470572 cos_to_last_merge=0.8522 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6989580105397954, 'auprc': 0.9757619529240633, 'loss_val': 0.28722195915493837, 'psi': 0.8096795874935026}-{'f1_val': 0.6966187137620875, 'auprc': 0.9902859802201951, 'loss_val': 0.2677044432365584, 'psi': 0.8140856203453306}
[S16] START round=18 head_norm_before_train=1.097905 cos_to_last_merge=0.9981 (last merge round=16)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8348588362855619, 'auprc': 0.9174576237222771, 'loss_val': 0.6800179724517281, 'psi': 0.8678983512602481}-{'f1_val': 0.8506253112488098, 'auprc': 0.8900774556081194, 'loss_val': 0.6223638960106762, 'psi': 0.8664061689925335}
[S17] START round=18 head_norm_before_train=1.238443 cos_to_last_merge=0.9990 (last merge round=16)
[S17] round=18 local utility u=0.010781 metrics={'f1_val': 0.35416166107453695, 'auprc': 0.6872232003040577, 'loss_val': 0.9294396003991696, 'psi': 0.48738627676634527}-{'f1_val': 0.3571086729290729, 'auprc': 0.6754128477548939, 'loss_val': 0.9332518237645617, 'psi': 0.4844303428594013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:37113
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.5888
[S9] RECEIVED delta(kind=head bytes=1800) from S4
[S9] cosine check vs S4: cos=-0.0907
[S9] DROPPED delta from S4 (cos=-0.0907 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S9
[S13] cosine check vs S9: cos=0.9077
[S14] RECEIVED delta(kind=head bytes=1798) from S11
[S14] cosine check vs S11: cos=0.4165
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=0.4126
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.6818
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.9968 head_norm=1.238516
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.153248e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.9971 head_norm=1.110443 delta_norm=0.715325
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9971 head_norm=1.125831
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.407747e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9971 head_norm=1.019920 delta_norm=0.240775
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=18 metric=0.5999 head_norm=1.054502
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.367724e-01
[S13] stored merged vector for next round verification (round=18)
[S13] DEBUG after merge:  round=18 metric=0.6125 head_norm=1.064741 delta_norm=0.236772
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8349 head_norm=1.145360
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.972952e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8337 head_norm=0.924743 delta_norm=0.597295
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.683765 (no previous merge yet)
[S2] round=19 local utility u=0.122769 metrics={'f1_val': 0.6767899847578467, 'auprc': 0.8948755868423153, 'loss_val': 0.39652103994901167, 'psi': 0.7640242255916341}-{'f1_val': 0.6418839858845934, 'auprc': 0.9191725465899219, 'loss_val': 0.5055149185397971, 'psi': 0.7527994101667248}
[S3] START round=19 head_norm_before_train=1.947444 (no previous merge yet)
[S3] round=19 local utility u=0.142691 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998828648606964, 'loss_val': 0.03248449681201029, 'psi': 0.997953278037838}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986756166775397, 'loss_val': 0.09940108299083034, 'psi': 0.976091397334282}
[S4] START round=19 head_norm_before_train=1.313436 cos_to_last_merge=0.9959 (last merge round=16)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9413701528413642, 'auprc': 0.9571068966368345, 'loss_val': 0.42524948888955594, 'psi': 0.9476648503595523}-{'f1_val': 0.9471883260356969, 'auprc': 0.9530252756682029, 'loss_val': 0.42219914634185846, 'psi': 0.9495231058886993}
[S5] START round=19 head_norm_before_train=1.503863 cos_to_last_merge=0.8539 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=19 local utility u=0.007884 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9974908825684579, 'loss_val': 0.07627433691930802, 'psi': 0.9967959076206774}-{'f1_val': 0.996186023309311, 'auprc': 0.9975566366495756, 'loss_val': 0.09136093789974133, 'psi': 0.9967342686454168}
[S6] START round=19 head_norm_before_train=1.424423 cos_to_last_merge=0.8204 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=19 local utility u=0.775540 metrics={'f1_val': 0.8232807522973098, 'auprc': 0.9470445298733656, 'loss_val': 0.3599976371755806, 'psi': 0.8727862633277321}-{'f1_val': 0.6433482516069464, 'auprc': 0.8217183097503167, 'loss_val': 0.45550396861679054, 'psi': 0.7146962748642944}
[S7] START round=19 head_norm_before_train=1.749904 (no previous merge yet)
[S7] round=19 local utility u=0.492482 metrics={'f1_val': 0.6913051297434465, 'auprc': 0.8546485955416753, 'loss_val': 0.28635429871455403, 'psi': 0.756642516062738}-{'f1_val': 0.6079115038316315, 'auprc': 0.7922258090651868, 'loss_val': 0.5836883773676544, 'psi': 0.6816372259250536}
[S8] START round=19 head_norm_before_train=1.228475 cos_to_last_merge=0.9992 (last merge round=17)
[S8] round=19 local utility u=1.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.987379859986378, 'loss_val': 0.21206183289943784, 'psi': 0.9902564882126182}-{'f1_val': 0.7139758603458082, 'auprc': 0.9234476626584901, 'loss_val': 0.40060191859701133, 'psi': 0.7977645812708809}
[S9] START round=19 head_norm_before_train=1.019920 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.996092449505646, 'loss_val': 0.16248883662795652, 'psi': 0.9966987273095441}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952269447629019, 'loss_val': 0.13067837070805413, 'psi': 0.9963525254124465}
[S10] START round=19 head_norm_before_train=1.727658 cos_to_last_merge=0.9992 (last merge round=15)
[S10] round=19 local utility u=0.000000 metrics={'f1_val': 0.8679270228732854, 'auprc': 0.9936546856277605, 'loss_val': 0.17014919889804314, 'psi': 0.9182180879750754}-{'f1_val': 0.9919084505890279, 'auprc': 0.9974158638070199, 'loss_val': 0.1466283197702567, 'psi': 0.9941114158762246}
[S11] START round=19 head_norm_before_train=1.398437 cos_to_last_merge=0.9979 (last merge round=16)
[S11] round=19 local utility u=0.018950 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.997870023478223, 'loss_val': 0.14357405350448718, 'psi': 0.9969190264736627}-{'f1_val': 0.996960829744628, 'auprc': 0.9981328054881522, 'loss_val': 0.1863176164120012, 'psi': 0.9974296200420376}
[S13] START round=19 head_norm_before_train=1.064741 cos_to_last_merge=1.0000 (last merge round=18)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5735147144399575, 'auprc': 0.6694079245924213, 'loss_val': 0.7569047022630049, 'psi': 0.611871998500943}-{'f1_val': 0.5999187208848785, 'auprc': 0.6709777667443189, 'loss_val': 0.7076607085220318, 'psi': 0.6283423392286547}
[S14] START round=19 head_norm_before_train=1.110443 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.039105 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9965490867591228, 'loss_val': 0.4003573926061184, 'psi': 0.9971094813335417}-{'f1_val': 0.9968300801588782, 'auprc': 0.9970165585682206, 'loss_val': 0.47605195334216793, 'psi': 0.9969046715226151}
[S15] START round=19 head_norm_before_train=1.501372 cos_to_last_merge=0.8449 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.845
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.7013477566286542, 'auprc': 0.8000214261552828, 'loss_val': 0.3938855367879649, 'psi': 0.7408172244393056}-{'f1_val': 0.6989580105397954, 'auprc': 0.9757619529240633, 'loss_val': 0.28722195915493837, 'psi': 0.8096795874935026}
[S16] START round=19 head_norm_before_train=0.924743 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.517429 metrics={'f1_val': 0.9380360023573442, 'auprc': 0.9753995588784333, 'loss_val': 0.4380484464265733, 'psi': 0.9529814249657799}-{'f1_val': 0.8348588362855619, 'auprc': 0.9174576237222771, 'loss_val': 0.6800179724517281, 'psi': 0.8678983512602481}
[S17] START round=19 head_norm_before_train=1.260581 cos_to_last_merge=0.9964 (last merge round=16)
[S17] round=19 local utility u=0.015223 metrics={'f1_val': 0.3565839720233662, 'auprc': 0.6892493203397914, 'loss_val': 0.919606678459426, 'psi': 0.4896501113499363}-{'f1_val': 0.35416166107453695, 'auprc': 0.6872232003040577, 'loss_val': 0.9294396003991696, 'psi': 0.48738627676634527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[S5] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:37109
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:37111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S16
[S8] cosine check vs S16: cos=0.7383
[S11] RECEIVED delta(kind=head bytes=1796) from S6
[S11] cosine check vs S6: cos=0.9794
[S10] RECEIVED delta(kind=head bytes=1796) from S7
[S10] cosine check vs S7: cos=0.9844
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9634
[S4] RECEIVED delta(kind=head bytes=1800) from S14
[S4] cosine check vs S14: cos=0.2453
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=0.9181
[S8] RECEIVED delta(kind=head bytes=1807) from S2
[S8] cosine check vs S2: cos=0.9191
[S17] not sending this round → trigger blocked (psi=0.490)
[S13] r=20 psi=0.612 u=0.0000 p_local=0.1039 f1=0.574 auprc=0.669 bytes=12578
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9414 head_norm=1.355746
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.563308e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.6265 head_norm=1.219295 delta_norm=0.256331
[S4] aggregate: ROLLBACK (f1_val pre=0.941 post=0.626 tol_abs=0.005 tol_rel=0.0)
[S4] r=20 psi=0.948 u=0.0000 p_local=0.3227 f1=0.941 auprc=0.957 bytes=16192
[S5] r=20 psi=0.997 u=0.0079 p_local=0.2033 f1=0.996 auprc=0.997 bytes=14385
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.8679 head_norm=1.746670
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.555919e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.8675 head_norm=1.749455 delta_norm=0.155592
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.918 u=0.0000 p_local=0.2798 f1=0.868 auprc=0.994 bytes=14391
[S9] r=20 psi=0.997 u=0.0000 p_local=0.0917 f1=0.997 auprc=0.996 bytes=16153
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9963 head_norm=1.432143
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.460354e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9963 head_norm=1.431338 delta_norm=0.146035
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.997 u=0.0190 p_local=0.1491 f1=0.996 auprc=0.998 bytes=16169
[S14] r=20 psi=0.997 u=0.0391 p_local=0.1647 f1=0.997 auprc=0.997 bytes=16172
[S3] r=20 psi=0.998 u=0.1427 p_local=0.1412 f1=0.997 auprc=0.999 bytes=16181
[S6] r=20 psi=0.873 u=0.7755 p_local=0.3163 f1=0.823 auprc=0.947 bytes=16176
[S16] r=20 psi=0.953 u=0.5174 p_local=0.2986 f1=0.938 auprc=0.975 bytes=16171
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=19 metric=0.9922 head_norm=1.258831
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.258020e-01
[S8] stored merged vector for next round verification (round=19)
[S8] DEBUG after merge:  round=19 metric=0.9922 head_norm=1.205122 delta_norm=0.125802
[S8] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S8] r=20 psi=0.990 u=1.0000 p_local=0.4399 f1=0.992 auprc=0.987 bytes=16168
[S2] r=20 psi=0.764 u=0.1228 p_local=0.1019 f1=0.677 auprc=0.895 bytes=17982
[S7] r=20 psi=0.757 u=0.4925 p_local=0.2192 f1=0.691 auprc=0.855 bytes=12582
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=19 metric=0.3566 head_norm=1.281937
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.723340e-01
[S17] stored merged vector for next round verification (round=19)
[S17] DEBUG after merge:  round=19 metric=0.3556 head_norm=1.258694 delta_norm=0.172334
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=20 psi=0.490 u=0.0152 p_local=0.0641 f1=0.357 auprc=0.689 bytes=14364
[S15] r=20 psi=0.741 u=0.0000 p_local=0.1508 f1=0.701 auprc=0.800 bytes=14371
[S2] START round=20 head_norm_before_train=1.697300 (no previous merge yet)
[S2] round=20 local utility u=0.051863 metrics={'f1_val': 0.6946380519401247, 'auprc': 0.8578040137006941, 'loss_val': 0.2886694244668737, 'psi': 0.7599044366443526}-{'f1_val': 0.6767899847578467, 'auprc': 0.8948755868423153, 'loss_val': 0.39652103994901167, 'psi': 0.7640242255916341}
[S3] START round=20 head_norm_before_train=1.977874 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9986896016259739, 'loss_val': 0.08018503474646164, 'psi': 0.9760969913136557}-{'f1_val': 0.9973696976584205, 'auprc': 0.998828648606964, 'loss_val': 0.03248449681201029, 'psi': 0.997953278037838}
[S4] START round=20 head_norm_before_train=1.219295 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.049060 metrics={'f1_val': 0.9477584442369013, 'auprc': 0.9569584026360138, 'loss_val': 0.3650144183087308, 'psi': 0.9514384275965463}-{'f1_val': 0.9413701528413642, 'auprc': 0.9571068966368345, 'loss_val': 0.42524948888955594, 'psi': 0.9476648503595523}
[S5] START round=20 head_norm_before_train=1.534074 cos_to_last_merge=0.8515 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=20 local utility u=0.004920 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9974658770903729, 'loss_val': 0.06547922015108495, 'psi': 0.9966979648217358}-{'f1_val': 0.9963325909888239, 'auprc': 0.9974908825684579, 'loss_val': 0.07627433691930802, 'psi': 0.9967959076206774}
[S6] START round=20 head_norm_before_train=1.445364 cos_to_last_merge=0.8164 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.816
[S6] round=20 local utility u=0.467446 metrics={'f1_val': 0.9554886614548219, 'auprc': 0.9542968430887955, 'loss_val': 0.24011039512602222, 'psi': 0.9550119341084113}-{'f1_val': 0.8232807522973098, 'auprc': 0.9470445298733656, 'loss_val': 0.3599976371755806, 'psi': 0.8727862633277321}
[S7] START round=20 head_norm_before_train=1.765998 (no previous merge yet)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5893513886929805, 'auprc': 0.7948442257624809, 'loss_val': 0.6678698619646729, 'psi': 0.6715485235207808}-{'f1_val': 0.6913051297434465, 'auprc': 0.8546485955416753, 'loss_val': 0.28635429871455403, 'psi': 0.756642516062738}
[S8] START round=20 head_norm_before_train=1.205122 cos_to_last_merge=1.0000 (last merge round=19)
[S8] round=20 local utility u=0.000145 metrics={'f1_val': 0.9925279616884268, 'auprc': 0.9860905063674504, 'loss_val': 0.21002578071911535, 'psi': 0.9899529795600363}-{'f1_val': 0.992174240363445, 'auprc': 0.987379859986378, 'loss_val': 0.21206183289943784, 'psi': 0.9902564882126182}
[S9] START round=20 head_norm_before_train=1.100202 cos_to_last_merge=0.9960 (last merge round=18)
[S9] round=20 local utility u=0.026779 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9956231201119619, 'loss_val': 0.10752215120966574, 'psi': 0.9965109955520705}-{'f1_val': 0.9971029125121428, 'auprc': 0.996092449505646, 'loss_val': 0.16248883662795652, 'psi': 0.9966987273095441}
[S10] START round=20 head_norm_before_train=1.749455 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.8521748997092518, 'auprc': 0.9957308945919489, 'loss_val': 0.1947087558323889, 'psi': 0.9095972976623306}-{'f1_val': 0.8679270228732854, 'auprc': 0.9936546856277605, 'loss_val': 0.17014919889804314, 'psi': 0.9182180879750754}
[S11] START round=20 head_norm_before_train=1.431338 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9879542800133425, 'auprc': 0.9980619089479561, 'loss_val': 0.17794885938238114, 'psi': 0.991997331587188}-{'f1_val': 0.9962850284706224, 'auprc': 0.997870023478223, 'loss_val': 0.14357405350448718, 'psi': 0.9969190264736627}
[S13] START round=20 head_norm_before_train=1.092084 cos_to_last_merge=0.9987 (last merge round=18)
[S13] round=20 local utility u=0.134718 metrics={'f1_val': 0.6074864125790223, 'auprc': 0.6715760494614458, 'loss_val': 0.6978032369640483, 'psi': 0.6331222673319916}-{'f1_val': 0.5735147144399575, 'auprc': 0.6694079245924213, 'loss_val': 0.7569047022630049, 'psi': 0.611871998500943}
[S14] START round=20 head_norm_before_train=1.142497 cos_to_last_merge=0.9979 (last merge round=18)
[S14] round=20 local utility u=0.049326 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9965524851396123, 'loss_val': 0.3002593990457532, 'psi': 0.9969652080793208}-{'f1_val': 0.9974830777164877, 'auprc': 0.9965490867591228, 'loss_val': 0.4003573926061184, 'psi': 0.9971094813335417}
[S15] START round=20 head_norm_before_train=1.532027 cos_to_last_merge=0.8385 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.838
[S15] round=20 local utility u=0.711917 metrics={'f1_val': 0.8117914474603375, 'auprc': 0.9908749115153952, 'loss_val': 0.20527407599464942, 'psi': 0.8834248330823606}-{'f1_val': 0.7013477566286542, 'auprc': 0.8000214261552828, 'loss_val': 0.3938855367879649, 'psi': 0.7408172244393056}
[S16] START round=20 head_norm_before_train=0.978261 cos_to_last_merge=0.9980 (last merge round=18)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8858572333221805, 'auprc': 0.98541272898223, 'loss_val': 0.5144744563800847, 'psi': 0.9256794315862003}-{'f1_val': 0.9380360023573442, 'auprc': 0.9753995588784333, 'loss_val': 0.4380484464265733, 'psi': 0.9529814249657799}
[S17] START round=20 head_norm_before_train=1.258694 cos_to_last_merge=1.0000 (last merge round=19)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.3524623916090688, 'auprc': 0.6854522515416662, 'loss_val': 0.9334485014416237, 'psi': 0.4856583355821078}-{'f1_val': 0.3565839720233662, 'auprc': 0.6892493203397914, 'loss_val': 0.919606678459426, 'psi': 0.4896501113499363}
[S14] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:37110
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S8] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:37116
[S6] not sending this round → trigger blocked (psi=0.955)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → trigger blocked (psi=0.760)
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.6352
[S9] RECEIVED delta(kind=head bytes=1792) from S4
[S9] cosine check vs S4: cos=-0.0579
[S9] DROPPED delta from S4 (cos=-0.0579 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] cosine check vs S9: cos=0.9439
[S16] RECEIVED delta(kind=head bytes=1804) from S15
[S16] cosine check vs S15: cos=0.6366
[S16] RECEIVED delta(kind=head bytes=1797) from S13
[S16] cosine check vs S13: cos=0.7805
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.092 → S8@127.0.0.1:37109
[S11] ⇄ pheromone p=0.119 → S14@127.0.0.1:37114
[S7] ⇄ pheromone p=0.175 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.347 → S11@127.0.0.1:37112
[S3] ⇄ pheromone p=0.113 → S4@127.0.0.1:37104
[S14] ⇄ pheromone p=0.142 → S4@127.0.0.1:37104
[S8] ⇄ pheromone p=0.352 → S17@127.0.0.1:37117
[S10] ⇄ pheromone p=0.224 → S14@127.0.0.1:37114
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=20 metric=0.6075 head_norm=1.123661
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.950988e-01
[S13] stored merged vector for next round verification (round=20)
[S13] DEBUG after merge:  round=20 metric=0.6139 head_norm=1.136133 delta_norm=0.195099
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.110 → S16@127.0.0.1:37116
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=20 metric=0.9971 head_norm=1.181147
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.106322e-01
[S9] stored merged vector for next round verification (round=20)
[S9] DEBUG after merge:  round=20 metric=0.9971 head_norm=1.242947 delta_norm=0.610632
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.079 → S13@127.0.0.1:37113
[S5] ⇄ pheromone p=0.164 → S9@127.0.0.1:37110
[S4] ⇄ pheromone p=0.268 → S9@127.0.0.1:37110
[S15] ⇄ pheromone p=0.263 → S16@127.0.0.1:37116
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=20 metric=0.8859 head_norm=1.038815
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.945876e-01
[S16] stored merged vector for next round verification (round=20)
[S16] DEBUG after merge:  round=20 metric=0.8892 head_norm=1.004378 delta_norm=0.194588
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.239 → S8@127.0.0.1:37109
[S17] ⇄ pheromone p=0.051 → S9@127.0.0.1:37110
[S2] START round=21 head_norm_before_train=1.710019 (no previous merge yet)
[S2] round=21 local utility u=0.180194 metrics={'f1_val': 0.701132579636681, 'auprc': 0.9548532885962249, 'loss_val': 0.25839659040996804, 'psi': 0.8026208632204985}-{'f1_val': 0.6946380519401247, 'auprc': 0.8578040137006941, 'loss_val': 0.2886694244668737, 'psi': 0.7599044366443526}
[S3] START round=21 head_norm_before_train=2.002448 (no previous merge yet)
[S3] round=21 local utility u=0.136430 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9988334309532355, 'loss_val': 0.028233520279522816, 'psi': 0.9982022702082527}-{'f1_val': 0.9610352511054436, 'auprc': 0.9986896016259739, 'loss_val': 0.08018503474646164, 'psi': 0.9760969913136557}
[S4] START round=21 head_norm_before_train=1.258821 cos_to_last_merge=0.9989 (last merge round=19)
[S4] round=21 local utility u=0.020933 metrics={'f1_val': 0.9464009957726014, 'auprc': 0.9615359674056992, 'loss_val': 0.32873631205217174, 'psi': 0.9524549844258405}-{'f1_val': 0.9477584442369013, 'auprc': 0.9569584026360138, 'loss_val': 0.3650144183087308, 'psi': 0.9514384275965463}
[S5] START round=21 head_norm_before_train=1.562201 cos_to_last_merge=0.8501 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.850
[S5] round=21 local utility u=0.005410 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9981300132117165, 'loss_val': 0.05577523974595283, 'psi': 0.9968759404281098}-{'f1_val': 0.996186023309311, 'auprc': 0.9974658770903729, 'loss_val': 0.06547922015108495, 'psi': 0.9966979648217358}
[S6] START round=21 head_norm_before_train=1.464328 cos_to_last_merge=0.8132 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.5840192462809509, 'auprc': 0.7876385857182088, 'loss_val': 0.8126384385509647, 'psi': 0.6654669820558541}-{'f1_val': 0.9554886614548219, 'auprc': 0.9542968430887955, 'loss_val': 0.24011039512602222, 'psi': 0.9550119341084113}
[S7] START round=21 head_norm_before_train=1.776086 (no previous merge yet)
[S7] round=21 local utility u=0.148435 metrics={'f1_val': 0.6200148066351525, 'auprc': 0.7978471614122342, 'loss_val': 0.5639901203509825, 'psi': 0.6911477485459852}-{'f1_val': 0.5893513886929805, 'auprc': 0.7948442257624809, 'loss_val': 0.6678698619646729, 'psi': 0.6715485235207808}
[S8] START round=21 head_norm_before_train=1.238437 cos_to_last_merge=0.9993 (last merge round=19)
[S8] round=21 local utility u=0.032608 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9878975192321724, 'loss_val': 0.15901514905560468, 'psi': 0.991554149445977}-{'f1_val': 0.9925279616884268, 'auprc': 0.9860905063674504, 'loss_val': 0.21002578071911535, 'psi': 0.9899529795600363}
[S9] START round=21 head_norm_before_train=1.242947 cos_to_last_merge=1.0000 (last merge round=20)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9897381162675762, 'auprc': 0.9984766072436337, 'loss_val': 0.16313113750549507, 'psi': 0.9932335126579992}-{'f1_val': 0.9971029125121428, 'auprc': 0.9956231201119619, 'loss_val': 0.10752215120966574, 'psi': 0.9965109955520705}
[S10] START round=21 head_norm_before_train=1.765217 cos_to_last_merge=0.9999 (last merge round=19)
[S10] round=21 local utility u=0.445359 metrics={'f1_val': 0.9957529764387818, 'auprc': 0.9944102562558585, 'loss_val': 0.16149779960250965, 'psi': 0.9952158883656126}-{'f1_val': 0.8521748997092518, 'auprc': 0.9957308945919489, 'loss_val': 0.1947087558323889, 'psi': 0.9095972976623306}
[S11] START round=21 head_norm_before_train=1.465195 cos_to_last_merge=0.9994 (last merge round=19)
[S11] round=21 local utility u=0.058713 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9979218443738396, 'loss_val': 0.11153803109037098, 'psi': 0.997084856646915}-{'f1_val': 0.9879542800133425, 'auprc': 0.9980619089479561, 'loss_val': 0.17794885938238114, 'psi': 0.991997331587188}
[S13] START round=21 head_norm_before_train=1.136133 cos_to_last_merge=1.0000 (last merge round=20)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.599419332301295, 'auprc': 0.6592994429483604, 'loss_val': 0.7365975511201827, 'psi': 0.6233713765601212}-{'f1_val': 0.6074864125790223, 'auprc': 0.6715760494614458, 'loss_val': 0.6978032369640483, 'psi': 0.6331222673319916}
[S14] START round=21 head_norm_before_train=1.188858 cos_to_last_merge=0.9908 (last merge round=18)
[S14] round=21 local utility u=0.036899 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.995181325593304, 'loss_val': 0.223804093265745, 'psi': 0.9965623768672142}-{'f1_val': 0.997240356705793, 'auprc': 0.9965524851396123, 'loss_val': 0.3002593990457532, 'psi': 0.9969652080793208}
[S15] START round=21 head_norm_before_train=1.558612 cos_to_last_merge=0.8329 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.833
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6991327535261221, 'auprc': 0.876229918745968, 'loss_val': 0.30967694307742083, 'psi': 0.7699716196140605}-{'f1_val': 0.8117914474603375, 'auprc': 0.9908749115153952, 'loss_val': 0.20527407599464942, 'psi': 0.8834248330823606}
[S16] START round=21 head_norm_before_train=1.004378 cos_to_last_merge=1.0000 (last merge round=20)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8577298801650096, 'auprc': 0.9844937409573264, 'loss_val': 0.601674040133432, 'psi': 0.9084354244819364}-{'f1_val': 0.8858572333221805, 'auprc': 0.98541272898223, 'loss_val': 0.5144744563800847, 'psi': 0.9256794315862003}
[S17] START round=21 head_norm_before_train=1.276189 cos_to_last_merge=0.9995 (last merge round=19)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3637305392308485, 'auprc': 0.6372968430034383, 'loss_val': 0.905516988921715, 'psi': 0.4731570607398844}-{'f1_val': 0.3524623916090688, 'auprc': 0.6854522515416662, 'loss_val': 0.9334485014416237, 'psi': 0.4856583355821078}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[S7] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.8371
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.9932
[S8] RECEIVED delta(kind=head bytes=1805) from S2
[S8] cosine check vs S2: cos=0.9194
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.4953
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9821
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] cosine check vs S14: cos=0.3362
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.9003
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=21 metric=0.9464 head_norm=1.296813
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.893786e-01
[S4] stored merged vector for next round verification (round=21)
[S4] DEBUG after merge:  round=21 metric=0.9440 head_norm=1.220404 delta_norm=0.189379
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9975 head_norm=1.244866
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.635537e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9975 head_norm=1.182668 delta_norm=0.263554
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=21 metric=0.9958 head_norm=1.778314
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.039589e-01
[S10] stored merged vector for next round verification (round=21)
[S10] DEBUG after merge:  round=21 metric=0.9958 head_norm=1.779112 delta_norm=0.103959
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=21 metric=0.9940 head_norm=1.272211
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.729935e-01
[S8] stored merged vector for next round verification (round=21)
[S8] DEBUG after merge:  round=21 metric=0.9940 head_norm=1.467694 delta_norm=0.372993
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3637 head_norm=1.295911
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.218890e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.6258 head_norm=1.278318 delta_norm=0.121889
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.722782 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.9211564036425814, 'loss_val': 0.25833156428201387, 'psi': 0.7893588159931777}-{'f1_val': 0.701132579636681, 'auprc': 0.9548532885962249, 'loss_val': 0.25839659040996804, 'psi': 0.8026208632204985}
[S3] START round=22 head_norm_before_train=2.025140 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9834030929706927, 'auprc': 0.9987802046117281, 'loss_val': 0.048284846125338975, 'psi': 0.989553937627107}-{'f1_val': 0.9977814963782642, 'auprc': 0.9988334309532355, 'loss_val': 0.028233520279522816, 'psi': 0.9982022702082527}
[S4] START round=22 head_norm_before_train=1.220404 cos_to_last_merge=1.0000 (last merge round=21)
[S4] round=22 local utility u=0.004016 metrics={'f1_val': 0.9443697635488445, 'auprc': 0.9674410819447234, 'loss_val': 0.32623191964680565, 'psi': 0.9535982909071961}-{'f1_val': 0.9464009957726014, 'auprc': 0.9615359674056992, 'loss_val': 0.32873631205217174, 'psi': 0.9524549844258405}
[S5] START round=22 head_norm_before_train=1.592113 cos_to_last_merge=0.8485 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=22 local utility u=0.003069 metrics={'f1_val': 0.996186023309311, 'auprc': 0.99806749833045, 'loss_val': 0.05032688445814195, 'psi': 0.9969386133177667}-{'f1_val': 0.9960398919057053, 'auprc': 0.9981300132117165, 'loss_val': 0.05577523974595283, 'psi': 0.9968759404281098}
[S6] START round=22 head_norm_before_train=1.481218 cos_to_last_merge=0.8105 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=22 local utility u=1.000000 metrics={'f1_val': 0.8249606892753459, 'auprc': 0.9551550128760904, 'loss_val': 0.3135734856805396, 'psi': 0.8770384187156437}-{'f1_val': 0.5840192462809509, 'auprc': 0.7876385857182088, 'loss_val': 0.8126384385509647, 'psi': 0.6654669820558541}
[S7] START round=22 head_norm_before_train=1.785970 (no previous merge yet)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5971223162727859, 'auprc': 0.7952826457279063, 'loss_val': 0.6497871253598988, 'psi': 0.676386448054834}-{'f1_val': 0.6200148066351525, 'auprc': 0.7978471614122342, 'loss_val': 0.5639901203509825, 'psi': 0.6911477485459852}
[S8] START round=22 head_norm_before_train=1.467694 cos_to_last_merge=1.0000 (last merge round=21)
[S8] round=22 local utility u=0.008859 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9864644549392878, 'loss_val': 0.1369988137227534, 'psi': 0.9909809237288232}-{'f1_val': 0.9939919029218467, 'auprc': 0.9878975192321724, 'loss_val': 0.15901514905560468, 'psi': 0.991554149445977}
[S9] START round=22 head_norm_before_train=1.308734 cos_to_last_merge=0.9965 (last merge round=20)
[S9] round=22 local utility u=0.039745 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9986230173497367, 'loss_val': 0.10678216552739929, 'psi': 0.9955621621305399}-{'f1_val': 0.9897381162675762, 'auprc': 0.9984766072436337, 'loss_val': 0.16313113750549507, 'psi': 0.9932335126579992}
[S10] START round=22 head_norm_before_train=1.779112 cos_to_last_merge=1.0000 (last merge round=21)
[S10] round=22 local utility u=0.006166 metrics={'f1_val': 0.9950868285240967, 'auprc': 0.9972388483370759, 'loss_val': 0.15365421476785388, 'psi': 0.9959476364492883}-{'f1_val': 0.9957529764387818, 'auprc': 0.9944102562558585, 'loss_val': 0.16149779960250965, 'psi': 0.9952158883656126}
[S11] START round=22 head_norm_before_train=1.498779 cos_to_last_merge=0.9979 (last merge round=19)
[S11] round=22 local utility u=0.012693 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997862372728238, 'loss_val': 0.08609385473289476, 'psi': 0.9970731517994489}-{'f1_val': 0.9965268648289654, 'auprc': 0.9979218443738396, 'loss_val': 0.11153803109037098, 'psi': 0.997084856646915}
[S13] START round=22 head_norm_before_train=1.166928 cos_to_last_merge=0.9987 (last merge round=20)
[S13] round=22 local utility u=0.037642 metrics={'f1_val': 0.6071338188697492, 'auprc': 0.6576362176411651, 'loss_val': 0.7026103413295538, 'psi': 0.6273347783783155}-{'f1_val': 0.599419332301295, 'auprc': 0.6592994429483604, 'loss_val': 0.7365975511201827, 'psi': 0.6233713765601212}
[S14] START round=22 head_norm_before_train=1.182668 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9974798545782899, 'auprc': 0.9950449370712445, 'loss_val': 0.23465527506827435, 'psi': 0.9965058875754718}-{'f1_val': 0.9974830777164877, 'auprc': 0.995181325593304, 'loss_val': 0.223804093265745, 'psi': 0.9965623768672142}
[S15] START round=22 head_norm_before_train=1.585522 cos_to_last_merge=0.8282 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.828
[S15] round=22 local utility u=0.026101 metrics={'f1_val': 0.701585747446104, 'auprc': 0.887175854677012, 'loss_val': 0.3050317049418783, 'psi': 0.7758217903384672}-{'f1_val': 0.6991327535261221, 'auprc': 0.876229918745968, 'loss_val': 0.30967694307742083, 'psi': 0.7699716196140605}
[S16] START round=22 head_norm_before_train=1.064628 cos_to_last_merge=0.9981 (last merge round=20)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8430708205303411, 'auprc': 0.9879108425722691, 'loss_val': 0.6902361268629226, 'psi': 0.9010068293471123}-{'f1_val': 0.8577298801650096, 'auprc': 0.9844937409573264, 'loss_val': 0.601674040133432, 'psi': 0.9084354244819364}
[S17] START round=22 head_norm_before_train=1.278318 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.907790 metrics={'f1_val': 0.5802985470877287, 'auprc': 0.7349863961861511, 'loss_val': 0.6824146000482406, 'psi': 0.6421736867270977}-{'f1_val': 0.3637305392308485, 'auprc': 0.6372968430034383, 'loss_val': 0.905516988921715, 'psi': 0.4731570607398844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:37113
[S8] not sending this round → trigger blocked (psi=0.991)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:37112
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=0.8621
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.8802
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=0.6878
[S11] RECEIVED delta(kind=head bytes=1799) from S6
[S11] cosine check vs S6: cos=0.9808
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.7449
[S9] RECEIVED delta(kind=head bytes=1799) from S4
[S9] cosine check vs S4: cos=-0.0030
[S9] DROPPED delta from S4 (cos=-0.0030 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S17
[S9] cosine check vs S17: cos=0.3728
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9965 head_norm=1.538296
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.502785e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9965 head_norm=1.507759 delta_norm=0.150279
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=22 metric=0.9935 head_norm=1.368906
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.936305e-01
[S9] stored merged vector for next round verification (round=22)
[S9] DEBUG after merge:  round=22 metric=0.9939 head_norm=1.179117 delta_norm=0.293631
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.6071 head_norm=1.197468
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.469791e-01
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.6063 head_norm=1.238355 delta_norm=0.346979
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=22 metric=0.8431 head_norm=1.124854
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.623308e-01
[S16] stored merged vector for next round verification (round=22)
[S16] DEBUG after merge:  round=22 metric=0.8431 head_norm=1.078954 delta_norm=0.162331
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.733909 (no previous merge yet)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7495669137380451, 'loss_val': 0.2643884857567054, 'psi': 0.7207218552335255}-{'f1_val': 0.7014937575602418, 'auprc': 0.9211564036425814, 'loss_val': 0.25833156428201387, 'psi': 0.7893588159931777}
[S3] START round=23 head_norm_before_train=2.042688 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9613698775614676, 'auprc': 0.9985917546664342, 'loss_val': 0.14490310136353102, 'psi': 0.9762586284034542}-{'f1_val': 0.9834030929706927, 'auprc': 0.9987802046117281, 'loss_val': 0.048284846125338975, 'psi': 0.989553937627107}
[S4] START round=23 head_norm_before_train=1.263828 cos_to_last_merge=0.9987 (last merge round=21)
[S4] round=23 local utility u=0.021349 metrics={'f1_val': 0.947012121728732, 'auprc': 0.9644958761081164, 'loss_val': 0.2905521421088693, 'psi': 0.9540056234804857}-{'f1_val': 0.9443697635488445, 'auprc': 0.9674410819447234, 'loss_val': 0.32623191964680565, 'psi': 0.9535982909071961}
[S5] START round=23 head_norm_before_train=1.613724 cos_to_last_merge=0.8476 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9930334109221446, 'loss_val': 0.049640553539267836, 'psi': 0.9949249783544445}-{'f1_val': 0.996186023309311, 'auprc': 0.99806749833045, 'loss_val': 0.05032688445814195, 'psi': 0.9969386133177667}
[S6] START round=23 head_norm_before_train=1.491807 cos_to_last_merge=0.8086 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7098588420788966, 'auprc': 0.8707577752218327, 'loss_val': 0.5248684842907579, 'psi': 0.774218415336071}-{'f1_val': 0.8249606892753459, 'auprc': 0.9551550128760904, 'loss_val': 0.3135734856805396, 'psi': 0.8770384187156437}
[S7] START round=23 head_norm_before_train=1.797437 (no previous merge yet)
[S7] round=23 local utility u=0.405596 metrics={'f1_val': 0.6713953740428061, 'auprc': 0.8210910739127137, 'loss_val': 0.36165935902329666, 'psi': 0.7312736539907692}-{'f1_val': 0.5971223162727859, 'auprc': 0.7952826457279063, 'loss_val': 0.6497871253598988, 'psi': 0.676386448054834}
[S8] START round=23 head_norm_before_train=1.496807 cos_to_last_merge=0.9996 (last merge round=21)
[S8] round=23 local utility u=0.007108 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9981726666143759, 'loss_val': 0.1297376050844617, 'psi': 0.9928471978637659}-{'f1_val': 0.9939919029218467, 'auprc': 0.9864644549392878, 'loss_val': 0.1369988137227534, 'psi': 0.9909809237288232}
[S9] START round=23 head_norm_before_train=1.179117 cos_to_last_merge=1.0000 (last merge round=22)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936412671081706, 'loss_val': 0.1330250194783186, 'psi': 0.9954720016021256}-{'f1_val': 0.9935215919844088, 'auprc': 0.9986230173497367, 'loss_val': 0.10678216552739929, 'psi': 0.9955621621305399}
[S10] START round=23 head_norm_before_train=1.791107 cos_to_last_merge=0.9999 (last merge round=21)
[S10] round=23 local utility u=0.010693 metrics={'f1_val': 0.9938128314971357, 'auprc': 0.997052737339512, 'loss_val': 0.12406658106819488, 'psi': 0.9951087938340862}-{'f1_val': 0.9950868285240967, 'auprc': 0.9972388483370759, 'loss_val': 0.15365421476785388, 'psi': 0.9959476364492883}
[S11] START round=23 head_norm_before_train=1.507759 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978814567429914, 'loss_val': 0.09199130259803799, 'psi': 0.9970807854053503}-{'f1_val': 0.9965470045135896, 'auprc': 0.997862372728238, 'loss_val': 0.08609385473289476, 'psi': 0.9970731517994489}
[S13] START round=23 head_norm_before_train=1.238355 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5925342906719749, 'auprc': 0.6723933880048889, 'loss_val': 0.7732678114678769, 'psi': 0.6244779296051406}-{'f1_val': 0.6071338188697492, 'auprc': 0.6576362176411651, 'loss_val': 0.7026103413295538, 'psi': 0.6273347783783155}
[S14] START round=23 head_norm_before_train=1.238083 cos_to_last_merge=0.9979 (last merge round=21)
[S14] round=23 local utility u=0.028943 metrics={'f1_val': 0.9972371335675952, 'auprc': 0.9943908541889326, 'loss_val': 0.17335168355391034, 'psi': 0.9960986218161302}-{'f1_val': 0.9974798545782899, 'auprc': 0.9950449370712445, 'loss_val': 0.23465527506827435, 'psi': 0.9965058875754718}
[S15] START round=23 head_norm_before_train=1.610167 cos_to_last_merge=0.8240 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.824
[S15] round=23 local utility u=0.842718 metrics={'f1_val': 0.901892956161354, 'auprc': 0.9936851547657279, 'loss_val': 0.14096643044808996, 'psi': 0.9386098356031036}-{'f1_val': 0.701585747446104, 'auprc': 0.887175854677012, 'loss_val': 0.3050317049418783, 'psi': 0.7758217903384672}
[S16] START round=23 head_norm_before_train=1.078954 cos_to_last_merge=1.0000 (last merge round=22)
[S16] round=23 local utility u=0.206389 metrics={'f1_val': 0.8797766173148254, 'auprc': 0.987637199043687, 'loss_val': 0.49687114955609285, 'psi': 0.9229208500063699}-{'f1_val': 0.8430708205303411, 'auprc': 0.9879108425722691, 'loss_val': 0.6902361268629226, 'psi': 0.9010068293471123}
[S17] START round=23 head_norm_before_train=1.300968 cos_to_last_merge=0.9994 (last merge round=21)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4456389731918879, 'auprc': 0.6219309646569122, 'loss_val': 0.7070855165245645, 'psi': 0.5161557697778976}-{'f1_val': 0.5802985470877287, 'auprc': 0.7349863961861511, 'loss_val': 0.6824146000482406, 'psi': 0.6421736867270977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S4] not sending this round → trigger blocked (psi=0.954)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.939)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:37111
[S14] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9727
[S4] RECEIVED delta(kind=head bytes=1801) from S14
[S4] cosine check vs S14: cos=0.4078
[S8] RECEIVED delta(kind=head bytes=1802) from S16
[S8] cosine check vs S16: cos=0.5638
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.6182
[S10] RECEIVED delta(kind=head bytes=1792) from S7
[S10] cosine check vs S7: cos=0.9965
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9470 head_norm=1.309120
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.086833e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9475 head_norm=1.092587 delta_norm=0.708683
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9938 head_norm=1.806767
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.586554e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9938 head_norm=1.805088 delta_norm=0.075866
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9972 head_norm=1.295439
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.156265e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9972 head_norm=1.399701 delta_norm=0.715627
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=23 metric=0.9893 head_norm=1.520854
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.431291e-01
[S8] stored merged vector for next round verification (round=23)
[S8] DEBUG after merge:  round=23 metric=0.9886 head_norm=1.177483 delta_norm=0.643129
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.4456 head_norm=1.328940
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.918504e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.4568 head_norm=1.415179 delta_norm=0.191850
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.744463 (no previous merge yet)
[S2] round=24 local utility u=0.223996 metrics={'f1_val': 0.7014937575602418, 'auprc': 0.8935376037866324, 'loss_val': 0.24832106457267897, 'psi': 0.7783112960507981}-{'f1_val': 0.7014918162305126, 'auprc': 0.7495669137380451, 'loss_val': 0.2643884857567054, 'psi': 0.7207218552335255}
[S3] START round=24 head_norm_before_train=2.058236 (no previous merge yet)
[S3] round=24 local utility u=0.160418 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9986960958992446, 'loss_val': 0.04055056465520107, 'psi': 0.9979173798273323}-{'f1_val': 0.9613698775614676, 'auprc': 0.9985917546664342, 'loss_val': 0.14490310136353102, 'psi': 0.9762586284034542}
[S4] START round=24 head_norm_before_train=1.092587 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9497086163385942, 'auprc': 0.972438013879639, 'loss_val': 0.3960828074673034, 'psi': 0.9588003753550121}-{'f1_val': 0.947012121728732, 'auprc': 0.9644958761081164, 'loss_val': 0.2905521421088693, 'psi': 0.9540056234804857}
[S5] START round=24 head_norm_before_train=1.631277 cos_to_last_merge=0.8470 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=24 local utility u=0.009279 metrics={'f1_val': 0.996186023309311, 'auprc': 0.997843188021738, 'loss_val': 0.04551238923289944, 'psi': 0.9968488891942818}-{'f1_val': 0.996186023309311, 'auprc': 0.9930334109221446, 'loss_val': 0.049640553539267836, 'psi': 0.9949249783544445}
[S6] START round=24 head_norm_before_train=1.501058 cos_to_last_merge=0.8073 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=24 local utility u=0.193168 metrics={'f1_val': 0.7873345745969695, 'auprc': 0.8308480861274887, 'loss_val': 0.48365854416766785, 'psi': 0.8047399792091772}-{'f1_val': 0.7098588420788966, 'auprc': 0.8707577752218327, 'loss_val': 0.5248684842907579, 'psi': 0.774218415336071}
[S7] START round=24 head_norm_before_train=1.806596 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.6612981112227324, 'auprc': 0.8114435250243517, 'loss_val': 0.3967704738458832, 'psi': 0.7213562767433801}-{'f1_val': 0.6713953740428061, 'auprc': 0.8210910739127137, 'loss_val': 0.36165935902329666, 'psi': 0.7312736539907692}
[S8] START round=24 head_norm_before_train=1.177483 cos_to_last_merge=1.0000 (last merge round=23)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7398961750449681, 'auprc': 0.9834797051242543, 'loss_val': 0.25747649018085295, 'psi': 0.8373295870766826}-{'f1_val': 0.9892968853633592, 'auprc': 0.9981726666143759, 'loss_val': 0.1297376050844617, 'psi': 0.9928471978637659}
[S9] START round=24 head_norm_before_train=1.236296 cos_to_last_merge=0.9981 (last merge round=22)
[S9] round=24 local utility u=0.022674 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9955244046547111, 'loss_val': 0.0942872586772983, 'psi': 0.9963213131172388}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936412671081706, 'loss_val': 0.1330250194783186, 'psi': 0.9954720016021256}
[S10] START round=24 head_norm_before_train=1.805088 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9947722960316905, 'auprc': 0.9932422887737004, 'loss_val': 0.12846352545092019, 'psi': 0.9941602931284945}-{'f1_val': 0.9938128314971357, 'auprc': 0.997052737339512, 'loss_val': 0.12406658106819488, 'psi': 0.9951087938340862}
[S11] START round=24 head_norm_before_train=1.547153 cos_to_last_merge=0.9993 (last merge round=22)
[S11] round=24 local utility u=0.011096 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9979514424041788, 'loss_val': 0.07251370282838131, 'psi': 0.9973591309374178}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978814567429914, 'loss_val': 0.09199130259803799, 'psi': 0.9970807854053503}
[S13] START round=24 head_norm_before_train=1.264511 cos_to_last_merge=0.9992 (last merge round=22)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5439525380380056, 'auprc': 0.6839603733807135, 'loss_val': 0.8589819601245123, 'psi': 0.5999556721750887}-{'f1_val': 0.5925342906719749, 'auprc': 0.6723933880048889, 'loss_val': 0.7732678114678769, 'psi': 0.6244779296051406}
[S14] START round=24 head_norm_before_train=1.399701 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9946041802628197, 'loss_val': 0.21636234504978447, 'psi': 0.9963315187350205}-{'f1_val': 0.9972371335675952, 'auprc': 0.9943908541889326, 'loss_val': 0.17335168355391034, 'psi': 0.9960986218161302}
[S15] START round=24 head_norm_before_train=1.632758 cos_to_last_merge=0.8199 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.820
[S15] round=24 local utility u=0.288083 metrics={'f1_val': 0.9916032422033281, 'auprc': 0.9961524344117474, 'loss_val': 0.11046405895419106, 'psi': 0.9934229190866959}-{'f1_val': 0.901892956161354, 'auprc': 0.9936851547657279, 'loss_val': 0.14096643044808996, 'psi': 0.9386098356031036}
[S16] START round=24 head_norm_before_train=1.134534 cos_to_last_merge=0.9987 (last merge round=22)
[S16] round=24 local utility u=0.300047 metrics={'f1_val': 0.9396952943803442, 'auprc': 0.9886665609138257, 'loss_val': 0.2593776821169719, 'psi': 0.9592838009937368}-{'f1_val': 0.8797766173148254, 'auprc': 0.987637199043687, 'loss_val': 0.49687114955609285, 'psi': 0.9229208500063699}
[S17] START round=24 head_norm_before_train=1.415179 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.578364 metrics={'f1_val': 0.5505795722512784, 'auprc': 0.7577860200651905, 'loss_val': 0.5875658435899359, 'psi': 0.6334621513768433}-{'f1_val': 0.4456389731918879, 'auprc': 0.6219309646569122, 'loss_val': 0.7070855165245645, 'psi': 0.5161557697778976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:37110
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S16] not sending this round → trigger blocked (psi=0.959)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] → sending delta(kind=head bytes=1807) to S8@127.0.0.1:37109
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.7850
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.3839
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.5428
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9860
[S8] RECEIVED delta(kind=head bytes=1807) from S2
[S8] cosine check vs S2: cos=0.8328
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.8141
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.9747
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.5048
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=24 metric=0.5440 head_norm=1.292992
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.456161e-01
[S13] stored merged vector for next round verification (round=24)
[S13] DEBUG after merge:  round=24 metric=0.5446 head_norm=1.286533 delta_norm=0.145616
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.9975 head_norm=1.443690
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.429864e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.9972 head_norm=1.260899 delta_norm=0.842986
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.7399 head_norm=1.202394
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.033398e-01
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.7289 head_norm=1.418524 delta_norm=0.503340
[S8] aggregate: ROLLBACK (f1_val pre=0.740 post=0.729 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=24 metric=0.9497 head_norm=1.136441
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.702047e-01
[S4] stored merged vector for next round verification (round=24)
[S4] DEBUG after merge:  round=24 metric=0.9466 head_norm=1.426727 delta_norm=0.870205
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=24 metric=0.9970 head_norm=1.586426
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.341884e-01
[S11] stored merged vector for next round verification (round=24)
[S11] DEBUG after merge:  round=24 metric=0.9970 head_norm=1.546943 delta_norm=0.134188
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=24 metric=0.9969 head_norm=1.296502
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.224322e-01
[S9] stored merged vector for next round verification (round=24)
[S9] DEBUG after merge:  round=24 metric=0.9969 head_norm=1.179397 delta_norm=0.222432
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=24 metric=0.9397 head_norm=1.188627
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.168089e-01
[S16] stored merged vector for next round verification (round=24)
[S16] DEBUG after merge:  round=24 metric=0.9437 head_norm=1.347097 delta_norm=0.516809
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.756523 (no previous merge yet)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7012327640453476, 'auprc': 0.679184690371062, 'loss_val': 0.27608741484691773, 'psi': 0.6924135345756334}-{'f1_val': 0.7014937575602418, 'auprc': 0.8935376037866324, 'loss_val': 0.24832106457267897, 'psi': 0.7783112960507981}
[S3] START round=25 head_norm_before_train=2.072224 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983424050085238, 'loss_val': 0.12203151220455415, 'psi': 0.9759581126666756}-{'f1_val': 0.9973982357793907, 'auprc': 0.9986960958992446, 'loss_val': 0.04055056465520107, 'psi': 0.9979173798273323}
[S4] START round=25 head_norm_before_train=1.426727 cos_to_last_merge=1.0000 (last merge round=24)
[S4] round=25 local utility u=0.034627 metrics={'f1_val': 0.945436071477258, 'auprc': 0.9630934950607214, 'loss_val': 0.27316066152409607, 'psi': 0.9524990409106434}-{'f1_val': 0.9497086163385942, 'auprc': 0.972438013879639, 'loss_val': 0.3960828074673034, 'psi': 0.9588003753550121}
[S5] START round=25 head_norm_before_train=1.646584 cos_to_last_merge=0.8464 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.846
[S5] round=25 local utility u=0.001985 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9978920980662791, 'loss_val': 0.04168996498783379, 'psi': 0.9968684532120983}-{'f1_val': 0.996186023309311, 'auprc': 0.997843188021738, 'loss_val': 0.04551238923289944, 'psi': 0.9968488891942818}
[S6] START round=25 head_norm_before_train=1.518332 cos_to_last_merge=0.8054 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=25 local utility u=0.262482 metrics={'f1_val': 0.8113259301381117, 'auprc': 0.9418317417649196, 'loss_val': 0.4355938872071744, 'psi': 0.8635282547888349}-{'f1_val': 0.7873345745969695, 'auprc': 0.8308480861274887, 'loss_val': 0.48365854416766785, 'psi': 0.8047399792091772}
[S7] START round=25 head_norm_before_train=1.813994 (no previous merge yet)
[S7] round=25 local utility u=0.027681 metrics={'f1_val': 0.6646600294585412, 'auprc': 0.8180548826607036, 'loss_val': 0.3814134850621318, 'psi': 0.7260179707394061}-{'f1_val': 0.6612981112227324, 'auprc': 0.8114435250243517, 'loss_val': 0.3967704738458832, 'psi': 0.7213562767433801}
[S8] START round=25 head_norm_before_train=1.418524 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.843407 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9974762643634296, 'loss_val': 0.12632041351223425, 'psi': 0.9942950499634389}-{'f1_val': 0.7398961750449681, 'auprc': 0.9834797051242543, 'loss_val': 0.25747649018085295, 'psi': 0.8373295870766826}
[S9] START round=25 head_norm_before_train=1.179397 cos_to_last_merge=1.0000 (last merge round=24)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9944938763104523, 'loss_val': 0.11319950329509192, 'psi': 0.9960592980314666}-{'f1_val': 0.9968525854255906, 'auprc': 0.9955244046547111, 'loss_val': 0.0942872586772983, 'psi': 0.9963213131172388}
[S10] START round=25 head_norm_before_train=1.819338 cos_to_last_merge=0.9999 (last merge round=23)
[S10] round=25 local utility u=0.009644 metrics={'f1_val': 0.9941183616473943, 'auprc': 0.9972558738825881, 'loss_val': 0.11729339255741575, 'psi': 0.9953733665414718}-{'f1_val': 0.9947722960316905, 'auprc': 0.9932422887737004, 'loss_val': 0.12846352545092019, 'psi': 0.9941602931284945}
[S11] START round=25 head_norm_before_train=1.546943 cos_to_last_merge=1.0000 (last merge round=24)
[S11] round=25 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9976130698222919, 'loss_val': 0.07866984846267971, 'psi': 0.997223781904663}-{'f1_val': 0.9969642566262439, 'auprc': 0.9979514424041788, 'loss_val': 0.07251370282838131, 'psi': 0.9973591309374178}
[S13] START round=25 head_norm_before_train=1.286533 cos_to_last_merge=1.0000 (last merge round=24)
[S13] round=25 local utility u=0.233965 metrics={'f1_val': 0.6030325924896992, 'auprc': 0.682670652338258, 'loss_val': 0.7416628231988596, 'psi': 0.6348878164291227}-{'f1_val': 0.5439525380380056, 'auprc': 0.6839603733807135, 'loss_val': 0.8589819601245123, 'psi': 0.5999556721750887}
[S14] START round=25 head_norm_before_train=1.260899 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.015818 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9952694848064257, 'loss_val': 0.1852663380915321, 'psi': 0.9964520079460462}-{'f1_val': 0.9974830777164877, 'auprc': 0.9946041802628197, 'loss_val': 0.21636234504978447, 'psi': 0.9963315187350205}
[S15] START round=25 head_norm_before_train=1.658521 cos_to_last_merge=0.8159 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.816
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.7625250548903387, 'auprc': 0.9777042847042938, 'loss_val': 0.29887531870439127, 'psi': 0.8485967468159208}-{'f1_val': 0.9916032422033281, 'auprc': 0.9961524344117474, 'loss_val': 0.11046405895419106, 'psi': 0.9934229190866959}
[S16] START round=25 head_norm_before_train=1.347097 cos_to_last_merge=1.0000 (last merge round=24)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9358846302845683, 'auprc': 0.9897286727734986, 'loss_val': 0.31515974577164485, 'psi': 0.9574222472801404}-{'f1_val': 0.9396952943803442, 'auprc': 0.9886665609138257, 'loss_val': 0.2593776821169719, 'psi': 0.9592838009937368}
[S17] START round=25 head_norm_before_train=1.443941 cos_to_last_merge=0.9993 (last merge round=23)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.3948915914214862, 'auprc': 0.5954385119459706, 'loss_val': 0.9665118035727683, 'psi': 0.47511035963128}-{'f1_val': 0.5505795722512784, 'auprc': 0.7577860200651905, 'loss_val': 0.5875658435899359, 'psi': 0.6334621513768433}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:37117
[S6] not sending this round → trigger blocked (psi=0.864)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S4] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S13
[S16] cosine check vs S13: cos=0.3157
[S10] RECEIVED delta(kind=head bytes=1798) from S7
[S10] cosine check vs S7: cos=0.9975
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=-0.1013
[S9] DROPPED delta from S4 (cos=-0.1013 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9878
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.2773
[S14] RECEIVED delta(kind=head bytes=1802) from S10
[S14] cosine check vs S10: cos=0.5377
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] ⇄ pheromone p=0.243 → S16@127.0.0.1:37116
[S11] ⇄ pheromone p=0.047 → S14@127.0.0.1:37114
[S2] ⇄ pheromone p=0.081 → S8@127.0.0.1:37109
[S3] ⇄ pheromone p=0.074 → S4@127.0.0.1:37104
[S6] ⇄ pheromone p=0.299 → S11@127.0.0.1:37112
[S5] ⇄ pheromone p=0.056 → S9@127.0.0.1:37110
[S9] ⇄ pheromone p=0.033 → S13@127.0.0.1:37113
[S8] ⇄ pheromone p=0.288 → S17@127.0.0.1:37117
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9941 head_norm=1.833232
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.490267e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9941 head_norm=1.827216 delta_norm=0.064903
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.114 → S14@127.0.0.1:37114
[S13] ⇄ pheromone p=0.087 → S16@127.0.0.1:37116
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9972 head_norm=1.306499
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.893111e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9975 head_norm=1.382327 delta_norm=0.789311
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.056 → S4@127.0.0.1:37104
[S7] ⇄ pheromone p=0.127 → S10@127.0.0.1:37111
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=25 metric=0.9454 head_norm=1.478275
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.398243e-01
[S4] stored merged vector for next round verification (round=25)
[S4] DEBUG after merge:  round=25 metric=0.9424 head_norm=1.113918 delta_norm=0.839824
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.100 → S9@127.0.0.1:37110
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=25 metric=0.9359 head_norm=1.388505
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.899473e-01
[S16] stored merged vector for next round verification (round=25)
[S16] DEBUG after merge:  round=25 metric=0.9309 head_norm=1.094689 delta_norm=0.789947
[S16] aggregate: ROLLBACK (f1_val pre=0.936 post=0.931 tol_abs=0.005 tol_rel=0.0)
[S16] ⇄ pheromone p=0.153 → S8@127.0.0.1:37109
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.3949 head_norm=1.475689
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.150706e-01
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.4076 head_norm=1.455389 delta_norm=0.115071
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.202 → S9@127.0.0.1:37110
[S2] START round=26 head_norm_before_train=1.769424 (no previous merge yet)
[S2] round=26 local utility u=0.207545 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.810765923684192, 'loss_val': 0.2572953251509859, 'psi': 0.7452014592119843}-{'f1_val': 0.7012327640453476, 'auprc': 0.679184690371062, 'loss_val': 0.27608741484691773, 'psi': 0.6924135345756334}
[S3] START round=26 head_norm_before_train=2.085110 (no previous merge yet)
[S3] round=26 local utility u=0.071397 metrics={'f1_val': 0.9742014211050578, 'auprc': 0.9986564217766974, 'loss_val': 0.059176347162578115, 'psi': 0.9839834213737136}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983424050085238, 'loss_val': 0.12203151220455415, 'psi': 0.9759581126666756}
[S4] START round=26 head_norm_before_train=1.113918 cos_to_last_merge=1.0000 (last merge round=25)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9496436755204876, 'auprc': 0.9658955196782659, 'loss_val': 0.3470194647739201, 'psi': 0.9561444131835989}-{'f1_val': 0.945436071477258, 'auprc': 0.9630934950607214, 'loss_val': 0.27316066152409607, 'psi': 0.9524990409106434}
[S5] START round=26 head_norm_before_train=1.668655 cos_to_last_merge=0.8452 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=26 local utility u=0.001073 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9980023075057808, 'loss_val': 0.03899683981099679, 'psi': 0.9968248581457355}-{'f1_val': 0.996186023309311, 'auprc': 0.9978920980662791, 'loss_val': 0.04168996498783379, 'psi': 0.9968684532120983}
[S6] START round=26 head_norm_before_train=1.539226 cos_to_last_merge=0.8027 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5977078242332343, 'auprc': 0.8003674516831691, 'loss_val': 0.7494736330115037, 'psi': 0.6787716752132082}-{'f1_val': 0.8113259301381117, 'auprc': 0.9418317417649196, 'loss_val': 0.4355938872071744, 'psi': 0.8635282547888349}
[S7] START round=26 head_norm_before_train=1.823491 (no previous merge yet)
[S7] round=26 local utility u=0.265428 metrics={'f1_val': 0.6953160456201127, 'auprc': 0.8900681545055713, 'loss_val': 0.2505329008355052, 'psi': 0.7732168891742961}-{'f1_val': 0.6646600294585412, 'auprc': 0.8180548826607036, 'loss_val': 0.3814134850621318, 'psi': 0.7260179707394061}
[S8] START round=26 head_norm_before_train=1.444001 cos_to_last_merge=0.9997 (last merge round=24)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.987068961608617, 'loss_val': 0.10723161197461843, 'psi': 0.9901321288615138}-{'f1_val': 0.992174240363445, 'auprc': 0.9974762643634296, 'loss_val': 0.12632041351223425, 'psi': 0.9942950499634389}
[S9] START round=26 head_norm_before_train=1.243769 cos_to_last_merge=0.9980 (last merge round=24)
[S9] round=26 local utility u=0.015930 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9948261225215926, 'loss_val': 0.08233606945702922, 'psi': 0.9961921965159227}-{'f1_val': 0.9971029125121428, 'auprc': 0.9944938763104523, 'loss_val': 0.11319950329509192, 'psi': 0.9960592980314666}
[S10] START round=26 head_norm_before_train=1.827216 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9936332210306406, 'loss_val': 0.11896570798209466, 'psi': 0.994067127439309}-{'f1_val': 0.9941183616473943, 'auprc': 0.9972558738825881, 'loss_val': 0.11729339255741575, 'psi': 0.9953733665414718}
[S11] START round=26 head_norm_before_train=1.583924 cos_to_last_merge=0.9994 (last merge round=24)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9917590156957223, 'auprc': 0.9978513296571769, 'loss_val': 0.0810437939189454, 'psi': 0.9941959412803042}-{'f1_val': 0.9969642566262439, 'auprc': 0.9976130698222919, 'loss_val': 0.07866984846267971, 'psi': 0.997223781904663}
[S13] START round=26 head_norm_before_train=1.310258 cos_to_last_merge=0.9993 (last merge round=24)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5622831513213196, 'auprc': 0.6894841783737212, 'loss_val': 0.824849674086218, 'psi': 0.6131635621422802}-{'f1_val': 0.6030325924896992, 'auprc': 0.682670652338258, 'loss_val': 0.7416628231988596, 'psi': 0.6348878164291227}
[S14] START round=26 head_norm_before_train=1.382327 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9943543188328217, 'loss_val': 0.2115219122723688, 'psi': 0.9959402324277278}-{'f1_val': 0.997240356705793, 'auprc': 0.9952694848064257, 'loss_val': 0.1852663380915321, 'psi': 0.9964520079460462}
[S15] START round=26 head_norm_before_train=1.684543 cos_to_last_merge=0.8131 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.813
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.699769257176521, 'auprc': 0.8570543265786572, 'loss_val': 0.4454520853217549, 'psi': 0.7626832849373755}-{'f1_val': 0.7625250548903387, 'auprc': 0.9777042847042938, 'loss_val': 0.29887531870439127, 'psi': 0.8485967468159208}
[S16] START round=26 head_norm_before_train=1.094689 cos_to_last_merge=1.0000 (last merge round=25)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.860467115016303, 'auprc': 0.9897284149800377, 'loss_val': 0.6016786679114623, 'psi': 0.9121716350017969}-{'f1_val': 0.9358846302845683, 'auprc': 0.9897286727734986, 'loss_val': 0.31515974577164485, 'psi': 0.9574222472801404}
[S17] START round=26 head_norm_before_train=1.455389 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.608939 metrics={'f1_val': 0.533365068407941, 'auprc': 0.6390035987953849, 'loss_val': 0.710168998410558, 'psi': 0.5756204805629186}-{'f1_val': 0.3948915914214862, 'auprc': 0.5954385119459706, 'loss_val': 0.9665118035727683, 'psi': 0.47511035963128}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S8@127.0.0.1:37109
[S7] not sending this round → trigger blocked (psi=0.773)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S5
[S9] cosine check vs S5: cos=0.7625
[S13] RECEIVED delta(kind=head bytes=1798) from S9
[S13] cosine check vs S9: cos=0.9798
[S8] RECEIVED delta(kind=head bytes=1806) from S2
[S8] cosine check vs S2: cos=0.9663
[S4] RECEIVED delta(kind=head bytes=1798) from S3
[S4] cosine check vs S3: cos=0.6229
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.5994
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9496 head_norm=1.162650
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.245502e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9484 head_norm=1.483437 delta_norm=0.824550
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9922 head_norm=1.471901
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.616689e-01
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9922 head_norm=1.613802 delta_norm=0.261669
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=26 metric=0.5623 head_norm=1.337001
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.338677e-01
[S13] stored merged vector for next round verification (round=26)
[S13] DEBUG after merge:  round=26 metric=0.5663 head_norm=1.313671 delta_norm=0.133868
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=26 metric=0.9971 head_norm=1.303738
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.877999e-01
[S9] stored merged vector for next round verification (round=26)
[S9] DEBUG after merge:  round=26 metric=0.9971 head_norm=1.206599 delta_norm=0.187800
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.783020 (no previous merge yet)
[S2] round=27 local utility u=0.140280 metrics={'f1_val': 0.7602481290698907, 'auprc': 0.7934421436148194, 'loss_val': 0.27730230049999716, 'psi': 0.7735257348878621}-{'f1_val': 0.7014918162305126, 'auprc': 0.810765923684192, 'loss_val': 0.2572953251509859, 'psi': 0.7452014592119843}
[S3] START round=27 head_norm_before_train=2.099805 (no previous merge yet)
[S3] round=27 local utility u=0.089655 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9987591829882304, 'loss_val': 0.021655945139967114, 'psi': 0.9981725710222507}-{'f1_val': 0.9742014211050578, 'auprc': 0.9986564217766974, 'loss_val': 0.059176347162578115, 'psi': 0.9839834213737136}
[S4] START round=27 head_norm_before_train=1.483437 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.036582 metrics={'f1_val': 0.9467592217742088, 'auprc': 0.9654776547312922, 'loss_val': 0.2552944573508054, 'psi': 0.9542465949570422}-{'f1_val': 0.9496436755204876, 'auprc': 0.9658955196782659, 'loss_val': 0.3470194647739201, 'psi': 0.9561444131835989}
[S5] START round=27 head_norm_before_train=1.691457 cos_to_last_merge=0.8439 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.844
[S5] round=27 local utility u=0.001318 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977603049177072, 'loss_val': 0.03651155372828021, 'psi': 0.9968157359526695}-{'f1_val': 0.9960398919057053, 'auprc': 0.9980023075057808, 'loss_val': 0.03899683981099679, 'psi': 0.9968248581457355}
[S6] START round=27 head_norm_before_train=1.559197 cos_to_last_merge=0.8004 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.5969108394701673, 'auprc': 0.7236721086449835, 'loss_val': 0.8300077421015318, 'psi': 0.6476153471400938}-{'f1_val': 0.5977078242332343, 'auprc': 0.8003674516831691, 'loss_val': 0.7494736330115037, 'psi': 0.6787716752132082}
[S7] START round=27 head_norm_before_train=1.832193 (no previous merge yet)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6495953136117483, 'auprc': 0.8054183180582483, 'loss_val': 0.5292000632786732, 'psi': 0.7119245153903483}-{'f1_val': 0.6953160456201127, 'auprc': 0.8900681545055713, 'loss_val': 0.2505329008355052, 'psi': 0.7732168891742961}
[S8] START round=27 head_norm_before_train=1.613802 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.001223 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.984038169962498, 'loss_val': 0.10124298678346993, 'psi': 0.9894746971072191}-{'f1_val': 0.992174240363445, 'auprc': 0.987068961608617, 'loss_val': 0.10723161197461843, 'psi': 0.9901321288615138}
[S9] START round=27 head_norm_before_train=1.206599 cos_to_last_merge=1.0000 (last merge round=26)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9956518499767717, 'loss_val': 0.10682223512590475, 'psi': 0.9961240327174805}-{'f1_val': 0.9971029125121428, 'auprc': 0.9948261225215926, 'loss_val': 0.08233606945702922, 'psi': 0.9961921965159227}
[S10] START round=27 head_norm_before_train=1.841673 cos_to_last_merge=0.9999 (last merge round=25)
[S10] round=27 local utility u=0.012173 metrics={'f1_val': 0.9937885261526809, 'auprc': 0.9970080267703841, 'loss_val': 0.10133613633393694, 'psi': 0.9950763263997622}-{'f1_val': 0.9943563983784213, 'auprc': 0.9936332210306406, 'loss_val': 0.11896570798209466, 'psi': 0.994067127439309}
[S11] START round=27 head_norm_before_train=1.618570 cos_to_last_merge=0.9981 (last merge round=24)
[S11] round=27 local utility u=0.029778 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998054589952083, 'loss_val': 0.05332954268951474, 'psi': 0.9974003899565795}-{'f1_val': 0.9917590156957223, 'auprc': 0.9978513296571769, 'loss_val': 0.0810437939189454, 'psi': 0.9941959412803042}
[S13] START round=27 head_norm_before_train=1.313671 cos_to_last_merge=1.0000 (last merge round=26)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5566882140784748, 'auprc': 0.6917546951977356, 'loss_val': 0.8382727088722033, 'psi': 0.6107148065261792}-{'f1_val': 0.5622831513213196, 'auprc': 0.6894841783737212, 'loss_val': 0.824849674086218, 'psi': 0.6131635621422802}
[S14] START round=27 head_norm_before_train=1.422273 cos_to_last_merge=0.9984 (last merge round=25)
[S14] round=27 local utility u=0.024453 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9950062666767056, 'loss_val': 0.16224607542845354, 'psi': 0.9959685146363366}-{'f1_val': 0.9969975081576651, 'auprc': 0.9943543188328217, 'loss_val': 0.2115219122723688, 'psi': 0.9959402324277278}
[S15] START round=27 head_norm_before_train=1.705976 cos_to_last_merge=0.8103 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.810
[S15] round=27 local utility u=0.716202 metrics={'f1_val': 0.8302942149649726, 'auprc': 0.9895116596415324, 'loss_val': 0.19356902026285214, 'psi': 0.8939811928355965}-{'f1_val': 0.699769257176521, 'auprc': 0.8570543265786572, 'loss_val': 0.4454520853217549, 'psi': 0.7626832849373755}
[S16] START round=27 head_norm_before_train=1.140289 cos_to_last_merge=0.9983 (last merge round=25)
[S16] round=27 local utility u=0.085276 metrics={'f1_val': 0.8750424370485511, 'auprc': 0.990160285402659, 'loss_val': 0.5198733671702472, 'psi': 0.9210895763901943}-{'f1_val': 0.860467115016303, 'auprc': 0.9897284149800377, 'loss_val': 0.6016786679114623, 'psi': 0.9121716350017969}
[S17] START round=27 head_norm_before_train=1.484111 cos_to_last_merge=0.9994 (last merge round=25)
[S17] round=27 local utility u=0.281045 metrics={'f1_val': 0.5522248684320201, 'auprc': 0.761974615485415, 'loss_val': 0.6301499344264012, 'psi': 0.6361247672533781}-{'f1_val': 0.533365068407941, 'auprc': 0.6390035987953849, 'loss_val': 0.710168998410558, 'psi': 0.5756204805629186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S3] not sending this round → trigger blocked (psi=0.998)
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S2] not sending this round → trigger blocked (psi=0.774)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S4
[S9] cosine check vs S4: cos=-0.1239
[S9] DROPPED delta from S4 (cos=-0.1239 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9812
[S4] RECEIVED delta(kind=head bytes=1807) from S14
[S4] cosine check vs S14: cos=0.2993
[S8] RECEIVED delta(kind=head bytes=1796) from S16
[S8] cosine check vs S16: cos=0.5072
[S14] RECEIVED delta(kind=head bytes=1804) from S10
[S14] cosine check vs S10: cos=0.8943
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.4412
[S16] RECEIVED delta(kind=head bytes=1801) from S15
[S16] cosine check vs S15: cos=0.6668
[S17] not sending this round → trigger blocked (psi=0.636)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=27 metric=0.9468 head_norm=1.535029
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.876224e-01
[S4] stored merged vector for next round verification (round=27)
[S4] DEBUG after merge:  round=27 metric=0.9487 head_norm=1.208195 delta_norm=0.887622
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9966 head_norm=1.462498
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.419320e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9966 head_norm=1.343707 delta_norm=0.241932
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=27 metric=0.8750 head_norm=1.191810
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.430075e-01
[S16] stored merged vector for next round verification (round=27)
[S16] DEBUG after merge:  round=27 metric=0.8828 head_norm=1.335773 delta_norm=0.643007
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=27 metric=0.9931 head_norm=1.638744
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.288316e-01
[S8] stored merged vector for next round verification (round=27)
[S8] DEBUG after merge:  round=27 metric=0.9930 head_norm=1.233593 delta_norm=0.728832
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=27 metric=0.5522 head_norm=1.515996
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.646409e-01
[S17] stored merged vector for next round verification (round=27)
[S17] DEBUG after merge:  round=27 metric=0.5759 head_norm=1.569954 delta_norm=0.164641
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.797637 (no previous merge yet)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7014918162305126, 'auprc': 0.7721874110156928, 'loss_val': 0.31659806684993047, 'psi': 0.7297700541445846}-{'f1_val': 0.7602481290698907, 'auprc': 0.7934421436148194, 'loss_val': 0.27730230049999716, 'psi': 0.7735257348878621}
[S3] START round=28 head_norm_before_train=2.114456 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9991103760139026, 'loss_val': 0.11783503018015087, 'psi': 0.9762892016452334}-{'f1_val': 0.9977814963782642, 'auprc': 0.9987591829882304, 'loss_val': 0.021655945139967114, 'psi': 0.9981725710222507}
[S4] START round=28 head_norm_before_train=1.208195 cos_to_last_merge=1.0000 (last merge round=27)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9444609256510501, 'auprc': 0.9723293196811595, 'loss_val': 0.32314139963148214, 'psi': 0.9556082832630939}-{'f1_val': 0.9467592217742088, 'auprc': 0.9654776547312922, 'loss_val': 0.2552944573508054, 'psi': 0.9542465949570422}
[S5] START round=28 head_norm_before_train=1.713315 cos_to_last_merge=0.8425 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.843
[S5] round=28 local utility u=0.000934 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9979933276283063, 'loss_val': 0.03446570018093225, 'psi': 0.9968212661947458}-{'f1_val': 0.996186023309311, 'auprc': 0.9977603049177072, 'loss_val': 0.03651155372828021, 'psi': 0.9968157359526695}
[S6] START round=28 head_norm_before_train=1.575307 cos_to_last_merge=0.7986 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.799
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.941071294327662, 'auprc': 0.940179096661812, 'loss_val': 0.2274588343070837, 'psi': 0.940714415261322}-{'f1_val': 0.5969108394701673, 'auprc': 0.7236721086449835, 'loss_val': 0.8300077421015318, 'psi': 0.6476153471400938}
[S7] START round=28 head_norm_before_train=1.836265 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.5661840075468179, 'auprc': 0.7909302013781138, 'loss_val': 0.7696367780585727, 'psi': 0.6560824850793363}-{'f1_val': 0.6495953136117483, 'auprc': 0.8054183180582483, 'loss_val': 0.5292000632786732, 'psi': 0.7119245153903483}
[S8] START round=28 head_norm_before_train=1.233593 cos_to_last_merge=1.0000 (last merge round=27)
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9925289693239863, 'auprc': 0.9852834367238895, 'loss_val': 0.1263705648413487, 'psi': 0.9896307562839475}-{'f1_val': 0.9930990485370332, 'auprc': 0.984038169962498, 'loss_val': 0.10124298678346993, 'psi': 0.9894746971072191}
[S9] START round=28 head_norm_before_train=1.262475 cos_to_last_merge=0.9986 (last merge round=26)
[S9] round=28 local utility u=0.011960 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9942100966003085, 'loss_val': 0.07859729020162808, 'psi': 0.9955493371470494}-{'f1_val': 0.9964388212112862, 'auprc': 0.9956518499767717, 'loss_val': 0.10682223512590475, 'psi': 0.9961240327174805}
[S10] START round=28 head_norm_before_train=1.857494 cos_to_last_merge=0.9996 (last merge round=25)
[S10] round=28 local utility u=0.011779 metrics={'f1_val': 0.9947723700160056, 'auprc': 0.9974574716075377, 'loss_val': 0.08502857647605497, 'psi': 0.9958464106526184}-{'f1_val': 0.9937885261526809, 'auprc': 0.9970080267703841, 'loss_val': 0.10133613633393694, 'psi': 0.9950763263997622}
[S11] START round=28 head_norm_before_train=1.649928 cos_to_last_merge=0.9966 (last merge round=24)
[S11] round=28 local utility u=0.001353 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9976242167535028, 'loss_val': 0.04685293427874062, 'psi': 0.9969802396984595}-{'f1_val': 0.9969642566262439, 'auprc': 0.998054589952083, 'loss_val': 0.05332954268951474, 'psi': 0.9974003899565795}
[S13] START round=28 head_norm_before_train=1.344532 cos_to_last_merge=0.9991 (last merge round=26)
[S13] round=28 local utility u=0.111440 metrics={'f1_val': 0.5908488589353711, 'auprc': 0.6526653337662628, 'loss_val': 0.7030889544689973, 'psi': 0.6155754488677279}-{'f1_val': 0.5566882140784748, 'auprc': 0.6917546951977356, 'loss_val': 0.8382727088722033, 'psi': 0.6107148065261792}
[S14] START round=28 head_norm_before_train=1.343707 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9957908066092357, 'auprc': 0.9964856777885941, 'loss_val': 0.1824630148519924, 'psi': 0.996068755080979}-{'f1_val': 0.9966100132760906, 'auprc': 0.9950062666767056, 'loss_val': 0.16224607542845354, 'psi': 0.9959685146363366}
[S15] START round=28 head_norm_before_train=1.724844 cos_to_last_merge=0.8071 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.807
[S15] round=28 local utility u=0.400613 metrics={'f1_val': 0.9439826106902345, 'auprc': 0.994595910391449, 'loss_val': 0.08972707543770936, 'psi': 0.9642279305707202}-{'f1_val': 0.8302942149649726, 'auprc': 0.9895116596415324, 'loss_val': 0.19356902026285214, 'psi': 0.8939811928355965}
[S16] START round=28 head_norm_before_train=1.335773 cos_to_last_merge=1.0000 (last merge round=27)
[S16] round=28 local utility u=0.341950 metrics={'f1_val': 0.9403215910204176, 'auprc': 0.9911499662555134, 'loss_val': 0.23061679798217805, 'psi': 0.9606529411144559}-{'f1_val': 0.8750424370485511, 'auprc': 0.990160285402659, 'loss_val': 0.5198733671702472, 'psi': 0.9210895763901943}
[S17] START round=28 head_norm_before_train=1.569954 cos_to_last_merge=1.0000 (last merge round=27)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5237279575453766, 'auprc': 0.6379515587262964, 'loss_val': 0.7915122551659558, 'psi': 0.5694173980177445}-{'f1_val': 0.5522248684320201, 'auprc': 0.761974615485415, 'loss_val': 0.6301499344264012, 'psi': 0.6361247672533781}
[S15] not sending this round → trigger blocked (psi=0.964)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S16@127.0.0.1:37116
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] not sending this round → trigger blocked (psi=0.997)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:37113
[S16] not sending this round → trigger blocked (psi=0.961)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.9805
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.7396
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9820
[S16] RECEIVED delta(kind=head bytes=1805) from S13
[S16] cosine check vs S13: cos=0.4124
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9966 head_norm=1.678448
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.615801e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9966 head_norm=1.624548 delta_norm=0.161580
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9964 head_norm=1.321555
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.839322e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9964 head_norm=1.426854 delta_norm=0.583932
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5908 head_norm=1.373633
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.354002e-01
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5943 head_norm=1.341028 delta_norm=0.135400
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9403 head_norm=1.380974
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.465502e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9395 head_norm=1.157429 delta_norm=0.746550
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.812082 (no previous merge yet)
[S2] round=29 local utility u=0.012234 metrics={'f1_val': 0.7036998381966117, 'auprc': 0.7657450503294864, 'loss_val': 0.28605030058832365, 'psi': 0.7285179230497616}-{'f1_val': 0.7014918162305126, 'auprc': 0.7721874110156928, 'loss_val': 0.31659806684993047, 'psi': 0.7297700541445846}
[S3] START round=29 head_norm_before_train=2.126721 (no previous merge yet)
[S3] round=29 local utility u=0.152378 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9991125597119583, 'loss_val': 0.033494338188317985, 'psi': 0.998331044445359}-{'f1_val': 0.9610750853994537, 'auprc': 0.9991103760139026, 'loss_val': 0.11783503018015087, 'psi': 0.9762892016452334}
[S4] START round=29 head_norm_before_train=1.248324 cos_to_last_merge=0.9985 (last merge round=27)
[S4] round=29 local utility u=0.003098 metrics={'f1_val': 0.9455714811050479, 'auprc': 0.9620847056620915, 'loss_val': 0.29287579004964776, 'psi': 0.9521767709278653}-{'f1_val': 0.9444609256510501, 'auprc': 0.9723293196811595, 'loss_val': 0.32314139963148214, 'psi': 0.9556082832630939}
[S5] START round=29 head_norm_before_train=1.734149 cos_to_last_merge=0.8417 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9977493180325812, 'loss_val': 0.03308820352607603, 'psi': 0.9966357214842361}-{'f1_val': 0.9960398919057053, 'auprc': 0.9979933276283063, 'loss_val': 0.03446570018093225, 'psi': 0.9968212661947458}
[S6] START round=29 head_norm_before_train=1.585352 cos_to_last_merge=0.7976 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.5983873487208742, 'auprc': 0.8095915941382494, 'loss_val': 0.7945345131098711, 'psi': 0.6828690468878242}-{'f1_val': 0.941071294327662, 'auprc': 0.940179096661812, 'loss_val': 0.2274588343070837, 'psi': 0.940714415261322}
[S7] START round=29 head_norm_before_train=1.839587 (no previous merge yet)
[S7] round=29 local utility u=0.113758 metrics={'f1_val': 0.5919627679295337, 'auprc': 0.7941687828122354, 'loss_val': 0.7065089055046007, 'psi': 0.6728451738826144}-{'f1_val': 0.5661840075468179, 'auprc': 0.7909302013781138, 'loss_val': 0.7696367780585727, 'psi': 0.6560824850793363}
[S8] START round=29 head_norm_before_train=1.270041 cos_to_last_merge=0.9995 (last merge round=27)
[S8] round=29 local utility u=0.014555 metrics={'f1_val': 0.9935382159373226, 'auprc': 0.9853058120972269, 'loss_val': 0.10338386530521093, 'psi': 0.9902452544012843}-{'f1_val': 0.9925289693239863, 'auprc': 0.9852834367238895, 'loss_val': 0.1263705648413487, 'psi': 0.9896307562839475}
[S9] START round=29 head_norm_before_train=1.426854 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9952679905531154, 'loss_val': 0.10474232993523892, 'psi': 0.9962187474766004}-{'f1_val': 0.99644216417821, 'auprc': 0.9942100966003085, 'loss_val': 0.07859729020162808, 'psi': 0.9955493371470494}
[S10] START round=29 head_norm_before_train=1.872036 cos_to_last_merge=0.9991 (last merge round=25)
[S10] round=29 local utility u=0.004368 metrics={'f1_val': 0.9946892565352771, 'auprc': 0.9978481972451398, 'loss_val': 0.07696659320543116, 'psi': 0.9959528328192222}-{'f1_val': 0.9947723700160056, 'auprc': 0.9974574716075377, 'loss_val': 0.08502857647605497, 'psi': 0.9958464106526184}
[S11] START round=29 head_norm_before_train=1.624548 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9985980948434151, 'loss_val': 0.059241673171095514, 'psi': 0.9973697909344243}-{'f1_val': 0.9965509216617638, 'auprc': 0.9976242167535028, 'loss_val': 0.04685293427874062, 'psi': 0.9969802396984595}
[S13] START round=29 head_norm_before_train=1.341028 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5693499504020074, 'auprc': 0.6893343670582941, 'loss_val': 0.7735845629620178, 'psi': 0.6173437170645221}-{'f1_val': 0.5908488589353711, 'auprc': 0.6526653337662628, 'loss_val': 0.7030889544689973, 'psi': 0.6155754488677279}
[S14] START round=29 head_norm_before_train=1.376830 cos_to_last_merge=0.9991 (last merge round=27)
[S14] round=29 local utility u=0.010878 metrics={'f1_val': 0.9961697877616842, 'auprc': 0.9933395361928069, 'loss_val': 0.15354330395178784, 'psi': 0.9950376871341333}-{'f1_val': 0.9957908066092357, 'auprc': 0.9964856777885941, 'loss_val': 0.1824630148519924, 'psi': 0.996068755080979}
[S15] START round=29 head_norm_before_train=1.746443 cos_to_last_merge=0.8039 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.804
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.776161841083865, 'auprc': 0.9862162129268537, 'loss_val': 0.27242850736381613, 'psi': 0.8601835898210605}-{'f1_val': 0.9439826106902345, 'auprc': 0.994595910391449, 'loss_val': 0.08972707543770936, 'psi': 0.9642279305707202}
[S16] START round=29 head_norm_before_train=1.157429 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.940288498797387, 'auprc': 0.9860921855222378, 'loss_val': 0.27835012960508276, 'psi': 0.9586099734873272}-{'f1_val': 0.9403215910204176, 'auprc': 0.9911499662555134, 'loss_val': 0.23061679798217805, 'psi': 0.9606529411144559}
[S17] START round=29 head_norm_before_train=1.595904 cos_to_last_merge=0.9996 (last merge round=27)
[S17] round=29 local utility u=0.305804 metrics={'f1_val': 0.5715318723362792, 'auprc': 0.720455190730057, 'loss_val': 0.7142389826632248, 'psi': 0.6311011996937903}-{'f1_val': 0.5237279575453766, 'auprc': 0.6379515587262964, 'loss_val': 0.7915122551659558, 'psi': 0.5694173980177445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S14] sending update (kind=head size=1806 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.8273
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.8506
[S4] RECEIVED delta(kind=head bytes=1799) from S3
[S4] cosine check vs S3: cos=0.6538
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9311
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9958
[S4] RECEIVED delta(kind=head bytes=1806) from S14
[S4] cosine check vs S14: cos=0.7538
[S9] RECEIVED delta(kind=head bytes=1802) from S4
[S9] cosine check vs S4: cos=0.0723
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.3118
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9969 head_norm=1.480367
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.685181e-01
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9969 head_norm=1.016443 delta_norm=0.768518
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9962 head_norm=1.403349
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.367706e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9962 head_norm=1.575527 delta_norm=0.536771
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=29 metric=0.9935 head_norm=1.315098
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.928606e-01
[S8] stored merged vector for next round verification (round=29)
[S8] DEBUG after merge:  round=29 metric=0.9934 head_norm=1.509937 delta_norm=0.492861
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9456 head_norm=1.289353
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.012151e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9433 head_norm=1.274617 delta_norm=0.201215
[S4] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=29 metric=0.9947 head_norm=1.889823
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.797020e-02
[S10] stored merged vector for next round verification (round=29)
[S10] DEBUG after merge:  round=29 metric=0.9946 head_norm=1.866043 delta_norm=0.087970
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.5715 head_norm=1.618566
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.103431e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.5713 head_norm=1.441633 delta_norm=0.310343
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.821033 (no previous merge yet)
[S2] round=30 local utility u=0.037731 metrics={'f1_val': 0.7097783069901297, 'auprc': 0.7734433342327474, 'loss_val': 0.2701535605759104, 'psi': 0.7352443178871768}-{'f1_val': 0.7036998381966117, 'auprc': 0.7657450503294864, 'loss_val': 0.28605030058832365, 'psi': 0.7285179230497616}
[S3] START round=30 head_norm_before_train=2.140454 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.9873311794792171, 'auprc': 0.99633975850077, 'loss_val': 0.08979871279930478, 'psi': 0.9909346110878382}-{'f1_val': 0.9978100342676263, 'auprc': 0.9991125597119583, 'loss_val': 0.033494338188317985, 'psi': 0.998331044445359}
[S4] START round=30 head_norm_before_train=1.274617 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9416221348842024, 'auprc': 0.9542403126627522, 'loss_val': 0.28510455465860707, 'psi': 0.9466694059956224}-{'f1_val': 0.9455714811050479, 'auprc': 0.9620847056620915, 'loss_val': 0.29287579004964776, 'psi': 0.9521767709278653}
[S5] START round=30 head_norm_before_train=1.750755 cos_to_last_merge=0.8409 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960939230020631, 'loss_val': 0.03291935900763459, 'psi': 0.9961491831864119}-{'f1_val': 0.9958933237853395, 'auprc': 0.9977493180325812, 'loss_val': 0.03308820352607603, 'psi': 0.9966357214842361}
[S6] START round=30 head_norm_before_train=1.597017 cos_to_last_merge=0.7959 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.796
[S6] round=30 local utility u=1.000000 metrics={'f1_val': 0.9874026862609806, 'auprc': 0.9600087010485456, 'loss_val': 0.10885025854637087, 'psi': 0.9764450921760066}-{'f1_val': 0.5983873487208742, 'auprc': 0.8095915941382494, 'loss_val': 0.7945345131098711, 'psi': 0.6828690468878242}
[S7] START round=30 head_norm_before_train=1.846152 (no previous merge yet)
[S7] round=30 local utility u=0.143553 metrics={'f1_val': 0.6234817367976344, 'auprc': 0.7972149252995331, 'loss_val': 0.6176556383186572, 'psi': 0.6929750121983939}-{'f1_val': 0.5919627679295337, 'auprc': 0.7941687828122354, 'loss_val': 0.7065089055046007, 'psi': 0.6728451738826144}
[S8] START round=30 head_norm_before_train=1.509937 cos_to_last_merge=1.0000 (last merge round=29)
[S8] round=30 local utility u=0.006749 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9848416325845648, 'loss_val': 0.08202733498864007, 'psi': 0.9894130007732063}-{'f1_val': 0.9935382159373226, 'auprc': 0.9853058120972269, 'loss_val': 0.10338386530521093, 'psi': 0.9902452544012843}
[S9] START round=30 head_norm_before_train=1.016443 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9951945592007305, 'auprc': 0.9988118449679357, 'loss_val': 0.15362226650511218, 'psi': 0.9966414735076126}-{'f1_val': 0.9968525854255906, 'auprc': 0.9952679905531154, 'loss_val': 0.10474232993523892, 'psi': 0.9962187474766004}
[S10] START round=30 head_norm_before_train=1.866043 cos_to_last_merge=1.0000 (last merge round=29)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969273044908176, 'loss_val': 0.07883049342783861, 'psi': 0.9958836252079519}-{'f1_val': 0.9946892565352771, 'auprc': 0.9978481972451398, 'loss_val': 0.07696659320543116, 'psi': 0.9959528328192222}
[S11] START round=30 head_norm_before_train=1.650349 cos_to_last_merge=0.9998 (last merge round=28)
[S11] round=30 local utility u=0.003431 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9976524426510055, 'loss_val': 0.04954218641641689, 'psi': 0.9969915300574606}-{'f1_val': 0.9965509216617638, 'auprc': 0.9985980948434151, 'loss_val': 0.059241673171095514, 'psi': 0.9973697909344243}
[S13] START round=30 head_norm_before_train=1.360857 cos_to_last_merge=0.9997 (last merge round=28)
[S13] round=30 local utility u=0.109199 metrics={'f1_val': 0.5992067650149173, 'auprc': 0.6858051624595046, 'loss_val': 0.7237394018701382, 'psi': 0.6338461239927522}-{'f1_val': 0.5693499504020074, 'auprc': 0.6893343670582941, 'loss_val': 0.7735845629620178, 'psi': 0.6173437170645221}
[S14] START round=30 head_norm_before_train=1.575527 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9954395736440247, 'loss_val': 0.18632920307240192, 'psi': 0.9966207911586452}-{'f1_val': 0.9961697877616842, 'auprc': 0.9933395361928069, 'loss_val': 0.15354330395178784, 'psi': 0.9950376871341333}
[S15] START round=30 head_norm_before_train=1.766612 cos_to_last_merge=0.8014 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.801
[S15] round=30 local utility u=0.778598 metrics={'f1_val': 0.9931904339949901, 'auprc': 0.9981827485039977, 'loss_val': 0.053302926856994136, 'psi': 0.9951873597985932}-{'f1_val': 0.776161841083865, 'auprc': 0.9862162129268537, 'loss_val': 0.27242850736381613, 'psi': 0.8601835898210605}
[S16] START round=30 head_norm_before_train=1.201670 cos_to_last_merge=0.9985 (last merge round=28)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8700489462468779, 'auprc': 0.9932457952269448, 'loss_val': 0.5393713122892234, 'psi': 0.9193276858389046}-{'f1_val': 0.940288498797387, 'auprc': 0.9860921855222378, 'loss_val': 0.27835012960508276, 'psi': 0.9586099734873272}
[S17] START round=30 head_norm_before_train=1.441633 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.291980 metrics={'f1_val': 0.5823711482191671, 'auprc': 0.8835143530831813, 'loss_val': 0.6844923275937904, 'psi': 0.7028284301647727}-{'f1_val': 0.5715318723362792, 'auprc': 0.720455190730057, 'loss_val': 0.7142389826632248, 'psi': 0.6311011996937903}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:37112
[S11] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S7
[S10] cosine check vs S7: cos=0.9977
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.2880
[S11] RECEIVED delta(kind=head bytes=1802) from S6
[S11] cosine check vs S6: cos=0.9904
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S2
[S8] cosine check vs S2: cos=0.9700
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9884
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S13] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.8204
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[S15] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.7039
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.6297
[S2] ⇄ pheromone p=0.067 → S8@127.0.0.1:37109
[S3] ⇄ pheromone p=0.064 → S4@127.0.0.1:37104
[S7] ⇄ pheromone p=0.110 → S10@127.0.0.1:37111
[S6] ⇄ pheromone p=0.426 → S11@127.0.0.1:37112
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=30 metric=0.9925 head_norm=1.546668
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.497814e-01
[S8] stored merged vector for next round verification (round=30)
[S8] DEBUG after merge:  round=30 metric=0.9925 head_norm=1.675271 delta_norm=0.249781
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.098 → S17@127.0.0.1:37117
[S4] ⇄ pheromone p=0.037 → S9@127.0.0.1:37110
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=30 metric=0.9952 head_norm=1.100628
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.225101e-01
[S9] stored merged vector for next round verification (round=30)
[S9] DEBUG after merge:  round=30 metric=0.9952 head_norm=1.187584 delta_norm=0.522510
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.014 → S13@127.0.0.1:37113
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=30 metric=0.9966 head_norm=1.678789
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.187977e-01
[S11] stored merged vector for next round verification (round=30)
[S11] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.640469 delta_norm=0.118798
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.019 → S14@127.0.0.1:37114
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9952 head_norm=1.889264
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.476915e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9952 head_norm=1.873965 delta_norm=0.064769
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.041 → S14@127.0.0.1:37114
[S5] ⇄ pheromone p=0.019 → S9@127.0.0.1:37110
[S13] ⇄ pheromone p=0.065 → S16@127.0.0.1:37116
[S15] ⇄ pheromone p=0.360 → S16@127.0.0.1:37116
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.5824 head_norm=1.468116
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.214625e-01
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.5890 head_norm=1.503003 delta_norm=0.121463
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.252 → S9@127.0.0.1:37110
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9974 head_norm=1.596962
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.778024e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9974 head_norm=1.314615 delta_norm=0.977802
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.023 → S4@127.0.0.1:37104
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=30 metric=0.8700 head_norm=1.249489
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.937522e-01
[S16] stored merged vector for next round verification (round=30)
[S16] DEBUG after merge:  round=30 metric=0.8722 head_norm=1.203626 delta_norm=0.193752
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.103 → S8@127.0.0.1:37109
[S2] START round=31 head_norm_before_train=1.829116 (no previous merge yet)
[S2] round=31 local utility u=0.427365 metrics={'f1_val': 0.8269263697514226, 'auprc': 0.8172562967054318, 'loss_val': 0.249750046560699, 'psi': 0.8230583405330263}-{'f1_val': 0.7097783069901297, 'auprc': 0.7734433342327474, 'loss_val': 0.2701535605759104, 'psi': 0.7352443178871768}
[S3] START round=31 head_norm_before_train=2.153118 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9605709740356257, 'auprc': 0.9979988712597996, 'loss_val': 0.14383146167894081, 'psi': 0.9755421329252953}-{'f1_val': 0.9873311794792171, 'auprc': 0.99633975850077, 'loss_val': 0.08979871279930478, 'psi': 0.9909346110878382}
[S4] START round=31 head_norm_before_train=1.313296 cos_to_last_merge=0.9992 (last merge round=29)
[S4] round=31 local utility u=0.075841 metrics={'f1_val': 0.9488096739009593, 'auprc': 0.9807778994842102, 'loss_val': 0.25616102929243156, 'psi': 0.9615969641342597}-{'f1_val': 0.9416221348842024, 'auprc': 0.9542403126627522, 'loss_val': 0.28510455465860707, 'psi': 0.9466694059956224}
[S5] START round=31 head_norm_before_train=1.760346 cos_to_last_merge=0.8406 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9949562902071647, 'loss_val': 0.03224433724269452, 'psi': 0.9956941300684525}-{'f1_val': 0.996186023309311, 'auprc': 0.9960939230020631, 'loss_val': 0.03291935900763459, 'psi': 0.9961491831864119}
[S6] START round=31 head_norm_before_train=1.610022 cos_to_last_merge=0.7945 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.794
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.823979158186874, 'auprc': 0.9462490664720256, 'loss_val': 0.36891720221070035, 'psi': 0.8728871215009346}-{'f1_val': 0.9874026862609806, 'auprc': 0.9600087010485456, 'loss_val': 0.10885025854637087, 'psi': 0.9764450921760066}
[S7] START round=31 head_norm_before_train=1.860795 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6083892110142137, 'auprc': 0.7956601175497681, 'loss_val': 0.6786125739623372, 'psi': 0.6832975736284355}-{'f1_val': 0.6234817367976344, 'auprc': 0.7972149252995331, 'loss_val': 0.6176556383186572, 'psi': 0.6929750121983939}
[S8] START round=31 head_norm_before_train=1.675271 cos_to_last_merge=1.0000 (last merge round=30)
[S8] round=31 local utility u=0.010015 metrics={'f1_val': 0.9923188303974865, 'auprc': 0.9894176183479078, 'loss_val': 0.07487459150503832, 'psi': 0.991158345577655}-{'f1_val': 0.9924605795656339, 'auprc': 0.9848416325845648, 'loss_val': 0.08202733498864007, 'psi': 0.9894130007732063}
[S9] START round=31 head_norm_before_train=1.187584 cos_to_last_merge=1.0000 (last merge round=30)
[S9] round=31 local utility u=0.025081 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9942347386017251, 'loss_val': 0.09871733981397443, 'psi': 0.9957093901995473}-{'f1_val': 0.9951945592007305, 'auprc': 0.9988118449679357, 'loss_val': 0.15362226650511218, 'psi': 0.9966414735076126}
[S10] START round=31 head_norm_before_train=1.873965 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.000211 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9970805090704906, 'loss_val': 0.07491626407073074, 'psi': 0.9955496677072329}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969273044908176, 'loss_val': 0.07883049342783861, 'psi': 0.9958836252079519}
[S11] START round=31 head_norm_before_train=1.640469 cos_to_last_merge=1.0000 (last merge round=30)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9977328966386924, 'loss_val': 0.055729681637137304, 'psi': 0.9972717126312232}-{'f1_val': 0.9965509216617638, 'auprc': 0.9976524426510055, 'loss_val': 0.04954218641641689, 'psi': 0.9969915300574606}
[S13] START round=31 head_norm_before_train=1.384489 cos_to_last_merge=0.9986 (last merge round=28)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5303388796967071, 'auprc': 0.6641905139844194, 'loss_val': 0.8680494074718424, 'psi': 0.583879533411792}-{'f1_val': 0.5992067650149173, 'auprc': 0.6858051624595046, 'loss_val': 0.7237394018701382, 'psi': 0.6338461239927522}
[S14] START round=31 head_norm_before_train=1.314615 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.003148 metrics={'f1_val': 0.9961262791927861, 'auprc': 0.9953762515582766, 'loss_val': 0.1721519938761652, 'psi': 0.9958262681389822}-{'f1_val': 0.9974082695017256, 'auprc': 0.9954395736440247, 'loss_val': 0.18632920307240192, 'psi': 0.9966207911586452}
[S15] START round=31 head_norm_before_train=1.783339 cos_to_last_merge=0.7994 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7908724094026589, 'auprc': 0.9919281146066745, 'loss_val': 0.2846860787702879, 'psi': 0.8712946914842652}-{'f1_val': 0.9931904339949901, 'auprc': 0.9981827485039977, 'loss_val': 0.053302926856994136, 'psi': 0.9951873597985932}
[S16] START round=31 head_norm_before_train=1.203626 cos_to_last_merge=1.0000 (last merge round=30)
[S16] round=31 local utility u=0.464914 metrics={'f1_val': 0.9676253228055643, 'auprc': 0.9935469806642607, 'loss_val': 0.19590518219517045, 'psi': 0.9779939859490429}-{'f1_val': 0.8700489462468779, 'auprc': 0.9932457952269448, 'loss_val': 0.5393713122892234, 'psi': 0.9193276858389046}
[S17] START round=31 head_norm_before_train=1.503003 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.239146 metrics={'f1_val': 0.7427033524773916, 'auprc': 0.7343429577873302, 'loss_val': 0.7206795158211191, 'psi': 0.739359194601367}-{'f1_val': 0.5823711482191671, 'auprc': 0.8835143530831813, 'loss_val': 0.6844923275937904, 'psi': 0.7028284301647727}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:37113
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S9
[S13] cosine check vs S9: cos=0.8689
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9807
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] cosine check vs S14: cos=0.5646
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.4993
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=0.9920
[S9] RECEIVED delta(kind=head bytes=1801) from S4
[S9] cosine check vs S4: cos=0.1058
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.6078
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.9225
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=31 metric=0.5303 head_norm=1.405175
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.486866e-01
[S13] stored merged vector for next round verification (round=31)
[S13] DEBUG after merge:  round=31 metric=0.5573 head_norm=1.293389 delta_norm=0.348687
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9961 head_norm=1.345522
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.611166e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9961 head_norm=1.461099 delta_norm=0.761117
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=31 metric=0.9967 head_norm=1.270575
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.018206e-01
[S9] stored merged vector for next round verification (round=31)
[S9] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.072015 delta_norm=0.401821
[S9] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=31 metric=0.9488 head_norm=1.349806
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.288309e-01
[S4] stored merged vector for next round verification (round=31)
[S4] DEBUG after merge:  round=31 metric=0.9484 head_norm=1.191962 delta_norm=0.628831
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9923 head_norm=1.699665
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.253519e-01
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9923 head_norm=1.478480 delta_norm=0.325352
[S8] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=31 metric=0.7427 head_norm=1.530662
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.796388e-01
[S17] stored merged vector for next round verification (round=31)
[S17] DEBUG after merge:  round=31 metric=0.5553 head_norm=1.607365 delta_norm=0.179639
[S17] aggregate: ROLLBACK (f1_val pre=0.743 post=0.555 tol_abs=0.005 tol_rel=0.0)
[S2] START round=32 head_norm_before_train=1.838344 (no previous merge yet)
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.705967804564075, 'auprc': 0.7558419326383481, 'loss_val': 0.3274686012671922, 'psi': 0.7259174557937842}-{'f1_val': 0.8269263697514226, 'auprc': 0.8172562967054318, 'loss_val': 0.249750046560699, 'psi': 0.8230583405330263}
[S3] START round=32 head_norm_before_train=2.164777 (no previous merge yet)
[S3] round=32 local utility u=0.157704 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.999032385349611, 'loss_val': 0.050878835123268545, 'psi': 0.9978910864417123}-{'f1_val': 0.9605709740356257, 'auprc': 0.9979988712597996, 'loss_val': 0.14383146167894081, 'psi': 0.9755421329252953}
[S4] START round=32 head_norm_before_train=1.191962 cos_to_last_merge=1.0000 (last merge round=31)
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9473257666979746, 'auprc': 0.9607033479403887, 'loss_val': 0.358028615217185, 'psi': 0.9526767991949402}-{'f1_val': 0.9488096739009593, 'auprc': 0.9807778994842102, 'loss_val': 0.25616102929243156, 'psi': 0.9615969641342597}
[S5] START round=32 head_norm_before_train=1.766566 cos_to_last_merge=0.8406 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9922478624970785, 'loss_val': 0.03280400438612611, 'psi': 0.994610758984418}-{'f1_val': 0.996186023309311, 'auprc': 0.9949562902071647, 'loss_val': 0.03224433724269452, 'psi': 0.9956941300684525}
[S6] START round=32 head_norm_before_train=1.620959 cos_to_last_merge=0.7932 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7714873633522028, 'auprc': 0.9360463376960155, 'loss_val': 0.5250796996792749, 'psi': 0.8373109530897278}-{'f1_val': 0.823979158186874, 'auprc': 0.9462490664720256, 'loss_val': 0.36891720221070035, 'psi': 0.8728871215009346}
[S7] START round=32 head_norm_before_train=1.872567 (no previous merge yet)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5882441161813219, 'auprc': 0.7931259018943353, 'loss_val': 0.8426080491381179, 'psi': 0.6701968304665273}-{'f1_val': 0.6083892110142137, 'auprc': 0.7956601175497681, 'loss_val': 0.6786125739623372, 'psi': 0.6832975736284355}
[S8] START round=32 head_norm_before_train=1.478480 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9939116763166854, 'auprc': 0.9882837648753982, 'loss_val': 0.08330503116030397, 'psi': 0.9916605117401704}-{'f1_val': 0.9923188303974865, 'auprc': 0.9894176183479078, 'loss_val': 0.07487459150503832, 'psi': 0.991158345577655}
[S9] START round=32 head_norm_before_train=1.072015 cos_to_last_merge=1.0000 (last merge round=31)
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9924853119792197, 'auprc': 0.9987929910681456, 'loss_val': 0.15206967525824544, 'psi': 0.99500838361479}-{'f1_val': 0.9966924912647621, 'auprc': 0.9942347386017251, 'loss_val': 0.09871733981397443, 'psi': 0.9957093901995473}
[S10] START round=32 head_norm_before_train=1.902049 cos_to_last_merge=0.9997 (last merge round=30)
[S10] round=32 local utility u=0.008892 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9972009620912856, 'loss_val': 0.06347443607125783, 'psi': 0.9961959297909813}-{'f1_val': 0.9945291067983943, 'auprc': 0.9970805090704906, 'loss_val': 0.07491626407073074, 'psi': 0.9955496677072329}
[S11] START round=32 head_norm_before_train=1.669196 cos_to_last_merge=0.9997 (last merge round=30)
[S11] round=32 local utility u=0.004244 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9979003600205115, 'loss_val': 0.047744916254502556, 'psi': 0.9973386979839509}-{'f1_val': 0.9969642566262439, 'auprc': 0.9977328966386924, 'loss_val': 0.055729681637137304, 'psi': 0.9972717126312232}
[S13] START round=32 head_norm_before_train=1.293389 cos_to_last_merge=1.0000 (last merge round=31)
[S13] round=32 local utility u=0.410683 metrics={'f1_val': 0.6166853279820748, 'auprc': 0.6840113474557938, 'loss_val': 0.6242248871573155, 'psi': 0.6436157357715624}-{'f1_val': 0.5303388796967071, 'auprc': 0.6641905139844194, 'loss_val': 0.8680494074718424, 'psi': 0.583879533411792}
[S14] START round=32 head_norm_before_train=1.461099 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.000702 metrics={'f1_val': 0.997240356705793, 'auprc': 0.995438821338955, 'loss_val': 0.17762075360164162, 'psi': 0.9965197425590578}-{'f1_val': 0.9961262791927861, 'auprc': 0.9953762515582766, 'loss_val': 0.1721519938761652, 'psi': 0.9958262681389822}
[S15] START round=32 head_norm_before_train=1.796298 cos_to_last_merge=0.7985 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.799
[S15] round=32 local utility u=0.111166 metrics={'f1_val': 0.8191316079290897, 'auprc': 0.993518325717773, 'loss_val': 0.23667964410682168, 'psi': 0.8888862950445631}-{'f1_val': 0.7908724094026589, 'auprc': 0.9919281146066745, 'loss_val': 0.2846860787702879, 'psi': 0.8712946914842652}
[S16] START round=32 head_norm_before_train=1.249537 cos_to_last_merge=0.9992 (last merge round=30)
[S16] round=32 local utility u=0.093809 metrics={'f1_val': 0.9908891215915885, 'auprc': 0.9859052650933681, 'loss_val': 0.12494517212800194, 'psi': 0.9888955789923003}-{'f1_val': 0.9676253228055643, 'auprc': 0.9935469806642607, 'loss_val': 0.19590518219517045, 'psi': 0.9779939859490429}
[S17] START round=32 head_norm_before_train=1.607365 cos_to_last_merge=1.0000 (last merge round=31)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.5423495357569112, 'auprc': 0.754256372879528, 'loss_val': 0.8379073790453554, 'psi': 0.627112270605958}-{'f1_val': 0.7427033524773916, 'auprc': 0.7343429577873302, 'loss_val': 0.7206795158211191, 'psi': 0.739359194601367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:37104
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:37109
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S4@127.0.0.1:37104
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S16
[S8] cosine check vs S16: cos=0.6243
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.4139
[S16] RECEIVED delta(kind=head bytes=1801) from S13
[S16] cosine check vs S13: cos=0.7797
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.7317
[S14] RECEIVED delta(kind=head bytes=1799) from S10
[S14] cosine check vs S10: cos=0.9250
[S4] RECEIVED delta(kind=head bytes=1804) from S14
[S4] cosine check vs S14: cos=0.8407
[S4] RECEIVED delta(kind=head bytes=1797) from S3
[S4] cosine check vs S3: cos=0.4367
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9939 head_norm=1.503055
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.132922e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9938 head_norm=1.260830 delta_norm=0.613292
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9473 head_norm=1.227955
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.928886e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9469 head_norm=1.227880 delta_norm=0.392889
[S4] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9972 head_norm=1.492123
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.454679e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9975 head_norm=1.383970 delta_norm=0.245468
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=32 metric=0.9909 head_norm=1.293237
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.707968e-01
[S16] stored merged vector for next round verification (round=32)
[S16] DEBUG after merge:  round=32 metric=0.9911 head_norm=1.243588 delta_norm=0.170797
[S16] aggregate: ACCEPT kept=['S13', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.848448 (no previous merge yet)
[S2] round=33 local utility u=0.476979 metrics={'f1_val': 0.8015729703011216, 'auprc': 0.8714853801269713, 'loss_val': 0.2940727149662724, 'psi': 0.8295379342314615}-{'f1_val': 0.705967804564075, 'auprc': 0.7558419326383481, 'loss_val': 0.3274686012671922, 'psi': 0.7259174557937842}
[S3] START round=33 head_norm_before_train=2.174998 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9846966392084899, 'auprc': 0.9989582145555734, 'loss_val': 0.037500002262607426, 'psi': 0.9904012693473234}-{'f1_val': 0.9971302205031132, 'auprc': 0.999032385349611, 'loss_val': 0.050878835123268545, 'psi': 0.9978910864417123}
[S4] START round=33 head_norm_before_train=1.227880 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.070311 metrics={'f1_val': 0.9486741692224832, 'auprc': 0.9770153564107487, 'loss_val': 0.27443393534887534, 'psi': 0.9600106440977894}-{'f1_val': 0.9473257666979746, 'auprc': 0.9607033479403887, 'loss_val': 0.358028615217185, 'psi': 0.9526767991949402}
[S5] START round=33 head_norm_before_train=1.767451 cos_to_last_merge=0.8406 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=33 local utility u=0.000042 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9920676527778878, 'loss_val': 0.032179129567318734, 'psi': 0.9945386750967418}-{'f1_val': 0.996186023309311, 'auprc': 0.9922478624970785, 'loss_val': 0.03280400438612611, 'psi': 0.994610758984418}
[S6] START round=33 head_norm_before_train=1.636294 cos_to_last_merge=0.7917 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=33 local utility u=0.738435 metrics={'f1_val': 0.9565469260084227, 'auprc': 0.944464844690559, 'loss_val': 0.18382166891686053, 'psi': 0.9517140934812772}-{'f1_val': 0.7714873633522028, 'auprc': 0.9360463376960155, 'loss_val': 0.5250796996792749, 'psi': 0.8373109530897278}
[S7] START round=33 head_norm_before_train=1.882807 (no previous merge yet)
[S7] round=33 local utility u=0.773899 metrics={'f1_val': 0.7060276220152142, 'auprc': 0.8729169576366028, 'loss_val': 0.24088507638440618, 'psi': 0.7727833562637696}-{'f1_val': 0.5882441161813219, 'auprc': 0.7931259018943353, 'loss_val': 0.8426080491381179, 'psi': 0.6701968304665273}
[S8] START round=33 head_norm_before_train=1.260830 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9919561654725609, 'auprc': 0.9980377374272137, 'loss_val': 0.11939371870016621, 'psi': 0.9943887942544221}-{'f1_val': 0.9939116763166854, 'auprc': 0.9882837648753982, 'loss_val': 0.08330503116030397, 'psi': 0.9916605117401704}
[S9] START round=33 head_norm_before_train=1.156058 cos_to_last_merge=0.9961 (last merge round=31)
[S9] round=33 local utility u=0.035335 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9934073974312264, 'loss_val': 0.0929494680512329, 'psi': 0.9956247064797763}-{'f1_val': 0.9924853119792197, 'auprc': 0.9987929910681456, 'loss_val': 0.15206967525824544, 'psi': 0.99500838361479}
[S10] START round=33 head_norm_before_train=1.929501 cos_to_last_merge=0.9989 (last merge round=30)
[S10] round=33 local utility u=0.000908 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960437921434405, 'loss_val': 0.056158276557084406, 'psi': 0.9955302202690011}-{'f1_val': 0.9955259082574451, 'auprc': 0.9972009620912856, 'loss_val': 0.06347443607125783, 'psi': 0.9961959297909813}
[S11] START round=33 head_norm_before_train=1.695602 cos_to_last_merge=0.9991 (last merge round=30)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9952055402353074, 'loss_val': 0.04351901898157574, 'psi': 0.9960127690911813}-{'f1_val': 0.9969642566262439, 'auprc': 0.9979003600205115, 'loss_val': 0.047744916254502556, 'psi': 0.9973386979839509}
[S13] START round=33 head_norm_before_train=1.313141 cos_to_last_merge=0.9997 (last merge round=31)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.5661517524133037, 'auprc': 0.696609484296602, 'loss_val': 0.7778664134295408, 'psi': 0.6183348451666231}-{'f1_val': 0.6166853279820748, 'auprc': 0.6840113474557938, 'loss_val': 0.6242248871573155, 'psi': 0.6436157357715624}
[S14] START round=33 head_norm_before_train=1.383970 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.014703 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9986374913559611, 'loss_val': 0.15680637777704964, 'psi': 0.9976986772441282}-{'f1_val': 0.997240356705793, 'auprc': 0.995438821338955, 'loss_val': 0.17762075360164162, 'psi': 0.9965197425590578}
[S15] START round=33 head_norm_before_train=1.807648 cos_to_last_merge=0.7976 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.798
[S15] round=33 local utility u=0.595452 metrics={'f1_val': 0.9861093100887783, 'auprc': 0.9965960165171983, 'loss_val': 0.05687499106967066, 'psi': 0.9903039926601463}-{'f1_val': 0.8191316079290897, 'auprc': 0.993518325717773, 'loss_val': 0.23667964410682168, 'psi': 0.8888862950445631}
[S16] START round=33 head_norm_before_train=1.243588 cos_to_last_merge=1.0000 (last merge round=32)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8424537247000354, 'auprc': 0.988499440830772, 'loss_val': 0.6983072269483456, 'psi': 0.9008720111523301}-{'f1_val': 0.9908891215915885, 'auprc': 0.9859052650933681, 'loss_val': 0.12494517212800194, 'psi': 0.9888955789923003}
[S17] START round=33 head_norm_before_train=1.635778 cos_to_last_merge=0.9996 (last merge round=31)
[S17] round=33 local utility u=0.377085 metrics={'f1_val': 0.6005844565229286, 'auprc': 0.8597570670409732, 'loss_val': 0.7496494792976537, 'psi': 0.7042535007301465}-{'f1_val': 0.5423495357569112, 'auprc': 0.754256372879528, 'loss_val': 0.8379073790453554, 'psi': 0.627112270605958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:37112
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:37104
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:37109
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:37113
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S7
[S10] cosine check vs S7: cos=0.9950
[S9] RECEIVED delta(kind=head bytes=1803) from S4
[S9] cosine check vs S4: cos=0.3436
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.3147
[S8] RECEIVED delta(kind=head bytes=1802) from S2
[S8] cosine check vs S2: cos=0.7793
[S13] RECEIVED delta(kind=head bytes=1800) from S9
[S13] cosine check vs S9: cos=0.9075
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.7924
[S4] RECEIVED delta(kind=head bytes=1798) from S14
[S4] cosine check vs S14: cos=0.7301
[S14] RECEIVED delta(kind=head bytes=1801) from S10
[S14] cosine check vs S10: cos=0.8543
[S11] RECEIVED delta(kind=head bytes=1798) from S6
[S11] cosine check vs S6: cos=0.9916
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1804) from S17
[S9] cosine check vs S17: cos=0.8530
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5662 head_norm=1.330551
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.799672e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5704 head_norm=1.256201 delta_norm=0.279967
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=33 metric=0.9920 head_norm=1.290822
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.879901e-01
[S8] stored merged vector for next round verification (round=33)
[S8] DEBUG after merge:  round=33 metric=0.9923 head_norm=1.488643 delta_norm=0.587990
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9966 head_norm=1.717220
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.138761e-01
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9966 head_norm=1.679958 delta_norm=0.113876
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=33 metric=0.9971 head_norm=1.241966
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.422094e-01
[S9] stored merged vector for next round verification (round=33)
[S9] DEBUG after merge:  round=33 metric=0.9971 head_norm=1.038577 delta_norm=0.342209
[S9] aggregate: ACCEPT kept=['S4', 'S5', 'S17'] (k=3/3) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9952 head_norm=1.955801
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.013172e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9952 head_norm=1.920248 delta_norm=0.101317
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=33 metric=0.9487 head_norm=1.281295
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.004463e-01
[S4] stored merged vector for next round verification (round=33)
[S4] DEBUG after merge:  round=33 metric=0.9515 head_norm=1.256667 delta_norm=0.500446
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9971 head_norm=1.420423
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.234464e-01
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9968 head_norm=1.627078 delta_norm=0.523446
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.8425 head_norm=1.281733
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.607802e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.8440 head_norm=1.470549 delta_norm=0.560780
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.859397 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.7640851103454447, 'auprc': 0.8310274195601202, 'loss_val': 0.41633682174782316, 'psi': 0.7908620340313148}-{'f1_val': 0.8015729703011216, 'auprc': 0.8714853801269713, 'loss_val': 0.2940727149662724, 'psi': 0.8295379342314615}
[S3] START round=34 head_norm_before_train=2.186537 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9574934630987351, 'auprc': 0.9974180582971353, 'loss_val': 0.10394443006585506, 'psi': 0.9734633011780952}-{'f1_val': 0.9846966392084899, 'auprc': 0.9989582145555734, 'loss_val': 0.037500002262607426, 'psi': 0.9904012693473234}
[S4] START round=34 head_norm_before_train=1.256667 cos_to_last_merge=1.0000 (last merge round=33)
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9428558271523322, 'auprc': 0.9699327065926542, 'loss_val': 0.35158531781525104, 'psi': 0.953686578928461}-{'f1_val': 0.9486741692224832, 'auprc': 0.9770153564107487, 'loss_val': 0.27443393534887534, 'psi': 0.9600106440977894}
[S5] START round=34 head_norm_before_train=1.773578 cos_to_last_merge=0.8402 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=34 local utility u=0.009072 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977273992115979, 'loss_val': 0.031015116861120157, 'psi': 0.9968025736702257}-{'f1_val': 0.996186023309311, 'auprc': 0.9920676527778878, 'loss_val': 0.032179129567318734, 'psi': 0.9945386750967418}
[S6] START round=34 head_norm_before_train=1.649729 cos_to_last_merge=0.7908 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6237253759918955, 'auprc': 0.7926548296847518, 'loss_val': 0.8074471360810451, 'psi': 0.6912971574690381}-{'f1_val': 0.9565469260084227, 'auprc': 0.944464844690559, 'loss_val': 0.18382166891686053, 'psi': 0.9517140934812772}
[S7] START round=34 head_norm_before_train=1.889464 (no previous merge yet)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6673825408442378, 'auprc': 0.8096087298385181, 'loss_val': 0.39976209183777767, 'psi': 0.7242730164419499}-{'f1_val': 0.7060276220152142, 'auprc': 0.8729169576366028, 'loss_val': 0.24088507638440618, 'psi': 0.7727833562637696}
[S8] START round=34 head_norm_before_train=1.488643 cos_to_last_merge=1.0000 (last merge round=33)
[S8] round=34 local utility u=0.000893 metrics={'f1_val': 0.992174240363445, 'auprc': 0.984960959671455, 'loss_val': 0.07968588997465668, 'psi': 0.989288928086649}-{'f1_val': 0.9919561654725609, 'auprc': 0.9980377374272137, 'loss_val': 0.11939371870016621, 'psi': 0.9943887942544221}
[S9] START round=34 head_norm_before_train=1.038577 cos_to_last_merge=1.0000 (last merge round=33)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9979815941182875, 'loss_val': 0.12335595350740228, 'psi': 0.9967087201731082}-{'f1_val': 0.9971029125121428, 'auprc': 0.9934073974312264, 'loss_val': 0.0929494680512329, 'psi': 0.9956247064797763}
[S10] START round=34 head_norm_before_train=1.920248 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000518 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969411183699602, 'loss_val': 0.057814675308473146, 'psi': 0.9958891507596089}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960437921434405, 'loss_val': 0.056158276557084406, 'psi': 0.9955302202690011}
[S11] START round=34 head_norm_before_train=1.679958 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.001044 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.998004731817247, 'loss_val': 0.04982777693798842, 'psi': 0.9971324457239572}-{'f1_val': 0.9965509216617638, 'auprc': 0.9952055402353074, 'loss_val': 0.04351901898157574, 'psi': 0.9960127690911813}
[S13] START round=34 head_norm_before_train=1.256201 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.131008 metrics={'f1_val': 0.5985939822391898, 'auprc': 0.6889337450188847, 'loss_val': 0.6874762939009601, 'psi': 0.6347298873510677}-{'f1_val': 0.5661517524133037, 'auprc': 0.696609484296602, 'loss_val': 0.7778664134295408, 'psi': 0.6183348451666231}
[S14] START round=34 head_norm_before_train=1.627078 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.008523 metrics={'f1_val': 0.9974610688245696, 'auprc': 0.9985594080096379, 'loss_val': 0.14185488317109637, 'psi': 0.997900404498597}-{'f1_val': 0.9970728011695729, 'auprc': 0.9986374913559611, 'loss_val': 0.15680637777704964, 'psi': 0.9976986772441282}
[S15] START round=34 head_norm_before_train=1.819653 cos_to_last_merge=0.7966 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.797
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.9376307378657964, 'auprc': 0.9960592949132231, 'loss_val': 0.08523509354325583, 'psi': 0.9610021606847672}-{'f1_val': 0.9861093100887783, 'auprc': 0.9965960165171983, 'loss_val': 0.05687499106967066, 'psi': 0.9903039926601463}
[S16] START round=34 head_norm_before_train=1.470549 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.344128 metrics={'f1_val': 0.9053938977332685, 'auprc': 0.9932741565464269, 'loss_val': 0.4020173269329431, 'psi': 0.9405460012585319}-{'f1_val': 0.8424537247000354, 'auprc': 0.988499440830772, 'loss_val': 0.6983072269483456, 'psi': 0.9008720111523301}
[S17] START round=34 head_norm_before_train=1.665818 cos_to_last_merge=0.9985 (last merge round=31)
[S17] round=34 local utility u=0.070981 metrics={'f1_val': 0.5773992496211904, 'auprc': 0.9665057005062434, 'loss_val': 0.7888229715649179, 'psi': 0.7330418299752116}-{'f1_val': 0.6005844565229286, 'auprc': 0.8597570670409732, 'loss_val': 0.7496494792976537, 'psi': 0.7042535007301465}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S4@127.0.0.1:37104
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:37110
[S14] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S10
[S14] cosine check vs S10: cos=0.9681
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.4807
[S4] RECEIVED delta(kind=head bytes=1806) from S14
[S4] cosine check vs S14: cos=0.8867
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:37114
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:37117
[S8] sending update (kind=head size=1806 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.2867
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=0.9899
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.4897
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1801) from S17
[S9] cosine check vs S17: cos=0.7594
[S8] RECEIVED delta(kind=head bytes=1804) from S16
[S8] cosine check vs S16: cos=0.4725
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9429 head_norm=1.297707
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.926490e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9442 head_norm=1.435653 delta_norm=0.392649
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=34 metric=0.9959 head_norm=1.127978
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.310713e-01
[S9] stored merged vector for next round verification (round=34)
[S9] DEBUG after merge:  round=34 metric=0.9959 head_norm=1.147994 delta_norm=0.331071
[S9] aggregate: ACCEPT kept=['S5', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9922 head_norm=1.519307
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.751777e-01
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9925 head_norm=1.295008 delta_norm=0.775178
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.5774 head_norm=1.694858
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.437516e-01
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.5759 head_norm=1.603045 delta_norm=0.143752
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9975 head_norm=1.657258
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.779312e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9975 head_norm=1.452508 delta_norm=0.377931
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=34 metric=0.9054 head_norm=1.499200
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.070920e-01
[S16] stored merged vector for next round verification (round=34)
[S16] DEBUG after merge:  round=34 metric=0.8987 head_norm=1.197915 delta_norm=0.707092
[S16] aggregate: ROLLBACK (f1_val pre=0.905 post=0.899 tol_abs=0.005 tol_rel=0.0)
[S2] START round=35 head_norm_before_train=1.868583 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7083936195648086, 'auprc': 0.7536053667551206, 'loss_val': 0.36659861730973003, 'psi': 0.7264783184409334}-{'f1_val': 0.7640851103454447, 'auprc': 0.8310274195601202, 'loss_val': 0.41633682174782316, 'psi': 0.7908620340313148}
[S3] START round=35 head_norm_before_train=2.198595 (no previous merge yet)
[S3] round=35 local utility u=0.159824 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9993837575994651, 'loss_val': 0.02962145148695977, 'psi': 0.9981924445074205}-{'f1_val': 0.9574934630987351, 'auprc': 0.9974180582971353, 'loss_val': 0.10394443006585506, 'psi': 0.9734633011780952}
[S4] START round=35 head_norm_before_train=1.435653 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9397381515148708, 'auprc': 0.9556912195099205, 'loss_val': 0.4735210849191837, 'psi': 0.9461193787128908}-{'f1_val': 0.9428558271523322, 'auprc': 0.9699327065926542, 'loss_val': 0.35158531781525104, 'psi': 0.953686578928461}
[S5] START round=35 head_norm_before_train=1.779553 cos_to_last_merge=0.8401 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=35 local utility u=0.000337 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9979394982917543, 'loss_val': 0.030977940038041024, 'psi': 0.9968874133022884}-{'f1_val': 0.996186023309311, 'auprc': 0.9977273992115979, 'loss_val': 0.031015116861120157, 'psi': 0.9968025736702257}
[S6] START round=35 head_norm_before_train=1.659502 cos_to_last_merge=0.7896 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=35 local utility u=1.000000 metrics={'f1_val': 0.8429920692590859, 'auprc': 0.9417895250387193, 'loss_val': 0.3112350213174355, 'psi': 0.8825110515709392}-{'f1_val': 0.6237253759918955, 'auprc': 0.7926548296847518, 'loss_val': 0.8074471360810451, 'psi': 0.6912971574690381}
[S7] START round=35 head_norm_before_train=1.891302 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6601477837699892, 'auprc': 0.804013177987729, 'loss_val': 0.4502573670124148, 'psi': 0.7176939414570851}-{'f1_val': 0.6673825408442378, 'auprc': 0.8096087298385181, 'loss_val': 0.39976209183777767, 'psi': 0.7242730164419499}
[S8] START round=35 head_norm_before_train=1.295008 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9853720141554348, 'loss_val': 0.12100391161649354, 'psi': 0.9896197379335152}-{'f1_val': 0.992174240363445, 'auprc': 0.984960959671455, 'loss_val': 0.07968588997465668, 'psi': 0.989288928086649}
[S9] START round=35 head_norm_before_train=1.147994 cos_to_last_merge=1.0000 (last merge round=34)
[S9] round=35 local utility u=0.007421 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9927011928631665, 'loss_val': 0.0976662821062744, 'psi': 0.9950959719041239}-{'f1_val': 0.9958601375429889, 'auprc': 0.9979815941182875, 'loss_val': 0.12335595350740228, 'psi': 0.9967087201731082}
[S10] START round=35 head_norm_before_train=1.947505 cos_to_last_merge=0.9998 (last merge round=33)
[S10] round=35 local utility u=0.003742 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9967112267698555, 'loss_val': 0.049641735567097715, 'psi': 0.995797194119567}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969411183699602, 'loss_val': 0.057814675308473146, 'psi': 0.9958891507596089}
[S11] START round=35 head_norm_before_train=1.703316 cos_to_last_merge=0.9998 (last merge round=33)
[S11] round=35 local utility u=0.005595 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.998693417106774, 'loss_val': 0.043183894796439984, 'psi': 0.9976559208184559}-{'f1_val': 0.9965509216617638, 'auprc': 0.998004731817247, 'loss_val': 0.04982777693798842, 'psi': 0.9971324457239572}
[S13] START round=35 head_norm_before_train=1.273719 cos_to_last_merge=0.9997 (last merge round=33)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5474311261038747, 'auprc': 0.6960720728492419, 'loss_val': 0.7769129759634761, 'psi': 0.6068875048020215}-{'f1_val': 0.5985939822391898, 'auprc': 0.6889337450188847, 'loss_val': 0.6874762939009601, 'psi': 0.6347298873510677}
[S14] START round=35 head_norm_before_train=1.452508 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.000642 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9968662589591144, 'loss_val': 0.1317060133081569, 'psi': 0.9968445516789726}-{'f1_val': 0.9974610688245696, 'auprc': 0.9985594080096379, 'loss_val': 0.14185488317109637, 'psi': 0.997900404498597}
[S15] START round=35 head_norm_before_train=1.834193 cos_to_last_merge=0.7958 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.796
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.7011955970681706, 'auprc': 0.833150016998731, 'loss_val': 0.5342304021914971, 'psi': 0.7539773650403947}-{'f1_val': 0.9376307378657964, 'auprc': 0.9960592949132231, 'loss_val': 0.08523509354325583, 'psi': 0.9610021606847672}
[S16] START round=35 head_norm_before_train=1.197915 cos_to_last_merge=1.0000 (last merge round=34)
[S16] round=35 local utility u=0.383764 metrics={'f1_val': 0.9917264684477215, 'auprc': 0.9873551111538004, 'loss_val': 0.13472784367301707, 'psi': 0.9899779255301531}-{'f1_val': 0.9053938977332685, 'auprc': 0.9932741565464269, 'loss_val': 0.4020173269329431, 'psi': 0.9405460012585319}
[S17] START round=35 head_norm_before_train=1.603045 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5019627687384396, 'auprc': 0.6848481655747589, 'loss_val': 0.9707509290160353, 'psi': 0.5751169274729673}-{'f1_val': 0.5773992496211904, 'auprc': 0.9665057005062434, 'loss_val': 0.7888229715649179, 'psi': 0.7330418299752116}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:37112
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:37113
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S14
[S4] cosine check vs S14: cos=0.9709
[S14] RECEIVED delta(kind=head bytes=1800) from S10
[S14] cosine check vs S10: cos=0.8969
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9948
[S9] RECEIVED delta(kind=head bytes=1803) from S5
[S9] cosine check vs S5: cos=0.6330
[S13] RECEIVED delta(kind=head bytes=1802) from S9
[S13] cosine check vs S9: cos=0.9684
[S4] RECEIVED delta(kind=head bytes=1796) from S3
[S4] cosine check vs S3: cos=0.2447
[S8] RECEIVED delta(kind=head bytes=1800) from S16
[S8] cosine check vs S16: cos=0.9479
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.4786
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.118 → S8@127.0.0.1:37109
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=35 metric=0.9397 head_norm=1.467866
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.189153e-01
[S4] stored merged vector for next round verification (round=35)
[S4] DEBUG after merge:  round=35 metric=0.8231 head_norm=1.313022 delta_norm=0.518915
[S4] aggregate: ROLLBACK (f1_val pre=0.940 post=0.823 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.027 → S9@127.0.0.1:37110
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9925 head_norm=1.332761
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.128268e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9925 head_norm=1.265580 delta_norm=0.212827
[S8] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.033 → S17@127.0.0.1:37117
[S7] ⇄ pheromone p=0.135 → S10@127.0.0.1:37111
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.5474 head_norm=1.299246
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.629261e-01
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5376 head_norm=1.251343 delta_norm=0.162926
[S13] aggregate: ROLLBACK (f1_val pre=0.547 post=0.538 tol_abs=0.005 tol_rel=0.0)
[S13] ⇄ pheromone p=0.084 → S16@127.0.0.1:37116
[S6] ⇄ pheromone p=0.434 → S11@127.0.0.1:37112
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=35 metric=0.9967 head_norm=1.223424
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.928176e-01
[S9] stored merged vector for next round verification (round=35)
[S9] DEBUG after merge:  round=35 metric=0.9967 head_norm=1.364859 delta_norm=0.692818
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.013 → S13@127.0.0.1:37113
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9968 head_norm=1.484533
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.955186e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9968 head_norm=1.402646 delta_norm=0.195519
[S14] aggregate: ACCEPT kept=['S10', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.011 → S4@127.0.0.1:37104
[S3] ⇄ pheromone p=0.069 → S4@127.0.0.1:37104
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=35 metric=0.9970 head_norm=1.727810
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.091386e-02
[S11] stored merged vector for next round verification (round=35)
[S11] DEBUG after merge:  round=35 metric=0.9970 head_norm=1.696931 delta_norm=0.090914
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.008 → S14@127.0.0.1:37114
[S10] ⇄ pheromone p=0.015 → S14@127.0.0.1:37114
[S16] ⇄ pheromone p=0.213 → S8@127.0.0.1:37109
[S5] ⇄ pheromone p=0.008 → S9@127.0.0.1:37110
[S15] ⇄ pheromone p=0.206 → S16@127.0.0.1:37116
[S17] ⇄ pheromone p=0.162 → S9@127.0.0.1:37110
[S2] START round=36 head_norm_before_train=1.877964 (no previous merge yet)
[S2] round=36 local utility u=0.288300 metrics={'f1_val': 0.8003778394835437, 'auprc': 0.7568116491434445, 'loss_val': 0.35152185576015726, 'psi': 0.782951363347504}-{'f1_val': 0.7083936195648086, 'auprc': 0.7536053667551206, 'loss_val': 0.36659861730973003, 'psi': 0.7264783184409334}
[S3] START round=36 head_norm_before_train=2.210164 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9989901374820451, 'loss_val': 0.03904696861891483, 'psi': 0.9980523325647526}-{'f1_val': 0.9973982357793907, 'auprc': 0.9993837575994651, 'loss_val': 0.02962145148695977, 'psi': 0.9981924445074205}
[S4] START round=36 head_norm_before_train=1.313022 cos_to_last_merge=1.0000 (last merge round=35)
[S4] round=36 local utility u=0.151271 metrics={'f1_val': 0.9477130392885077, 'auprc': 0.9733106817210384, 'loss_val': 0.27168635068721986, 'psi': 0.95795209626152}-{'f1_val': 0.9397381515148708, 'auprc': 0.9556912195099205, 'loss_val': 0.4735210849191837, 'psi': 0.9461193787128908}
[S5] START round=36 head_norm_before_train=1.785750 cos_to_last_merge=0.8402 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=36 local utility u=0.000456 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9980148647053956, 'loss_val': 0.030292973559195004, 'psi': 0.9969175598677449}-{'f1_val': 0.996186023309311, 'auprc': 0.9979394982917543, 'loss_val': 0.030977940038041024, 'psi': 0.9968874133022884}
[S6] START round=36 head_norm_before_train=1.670434 cos_to_last_merge=0.7887 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.789
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6707174779073037, 'auprc': 0.8786573898086907, 'loss_val': 0.725748891754936, 'psi': 0.7538934426678585}-{'f1_val': 0.8429920692590859, 'auprc': 0.9417895250387193, 'loss_val': 0.3112350213174355, 'psi': 0.8825110515709392}
[S7] START round=36 head_norm_before_train=1.896530 (no previous merge yet)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6153894590379936, 'auprc': 0.7983675182580564, 'loss_val': 0.6350013042376388, 'psi': 0.6885806827260187}-{'f1_val': 0.6601477837699892, 'auprc': 0.804013177987729, 'loss_val': 0.4502573670124148, 'psi': 0.7176939414570851}
[S8] START round=36 head_norm_before_train=1.265580 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.015590 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9895429319528686, 'loss_val': 0.11110062087346297, 'psi': 0.9921645376481555}-{'f1_val': 0.9924515537855688, 'auprc': 0.9853720141554348, 'loss_val': 0.12100391161649354, 'psi': 0.9896197379335152}
[S9] START round=36 head_norm_before_train=1.364859 cos_to_last_merge=1.0000 (last merge round=35)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951945592007305, 'auprc': 0.9983207363732597, 'loss_val': 0.11524947853111978, 'psi': 0.9964450300697423}-{'f1_val': 0.9966924912647621, 'auprc': 0.9927011928631665, 'loss_val': 0.0976662821062744, 'psi': 0.9950959719041239}
[S10] START round=36 head_norm_before_train=1.975870 cos_to_last_merge=0.9991 (last merge round=33)
[S10] round=36 local utility u=0.004047 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9972238508469693, 'loss_val': 0.042578984622431384, 'psi': 0.9959516211844467}-{'f1_val': 0.9951878390193748, 'auprc': 0.9967112267698555, 'loss_val': 0.049641735567097715, 'psi': 0.995797194119567}
[S11] START round=36 head_norm_before_train=1.696931 cos_to_last_merge=1.0000 (last merge round=35)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9978715423888141, 'loss_val': 0.04690282578120453, 'psi': 0.9973271709312719}-{'f1_val': 0.9969642566262439, 'auprc': 0.998693417106774, 'loss_val': 0.043183894796439984, 'psi': 0.9976559208184559}
[S13] START round=36 head_norm_before_train=1.251343 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.078585 metrics={'f1_val': 0.5736241699867463, 'auprc': 0.6904188281780648, 'loss_val': 0.759942311146677, 'psi': 0.6203420332632736}-{'f1_val': 0.5474311261038747, 'auprc': 0.6960720728492419, 'loss_val': 0.7769129759634761, 'psi': 0.6068875048020215}
[S14] START round=36 head_norm_before_train=1.402646 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.005539 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9984627294264656, 'loss_val': 0.12774766599331877, 'psi': 0.9977161006690396}-{'f1_val': 0.9968300801588782, 'auprc': 0.9968662589591144, 'loss_val': 0.1317060133081569, 'psi': 0.9968445516789726}
[S15] START round=36 head_norm_before_train=1.849352 cos_to_last_merge=0.7946 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.795
[S15] round=36 local utility u=1.000000 metrics={'f1_val': 0.9928006488957288, 'auprc': 0.9990913160830772, 'loss_val': 0.0431900646227792, 'psi': 0.9953169157706682}-{'f1_val': 0.7011955970681706, 'auprc': 0.833150016998731, 'loss_val': 0.5342304021914971, 'psi': 0.7539773650403947}
[S16] START round=36 head_norm_before_train=1.231960 cos_to_last_merge=0.9990 (last merge round=34)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9672014850964172, 'auprc': 0.9937574744258094, 'loss_val': 0.16971279377277568, 'psi': 0.9778238808281741}-{'f1_val': 0.9917264684477215, 'auprc': 0.9873551111538004, 'loss_val': 0.13472784367301707, 'psi': 0.9899779255301531}
[S17] START round=36 head_norm_before_train=1.628363 cos_to_last_merge=0.9997 (last merge round=34)
[S17] round=36 local utility u=0.807395 metrics={'f1_val': 0.6298486018178944, 'auprc': 0.8911935957358065, 'loss_val': 0.7423127004024893, 'psi': 0.7343865993850592}-{'f1_val': 0.5019627687384396, 'auprc': 0.6848481655747589, 'loss_val': 0.9707509290160353, 'psi': 0.5751169274729673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:37116
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:37110
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:37104
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S15
[S16] cosine check vs S15: cos=0.7296
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.8044
[S8] RECEIVED delta(kind=head bytes=1803) from S2
[S8] cosine check vs S2: cos=0.6424
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=0.9218
[S14] RECEIVED delta(kind=head bytes=1798) from S10
[S14] cosine check vs S10: cos=0.8366
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.8119
[S4] RECEIVED delta(kind=head bytes=1803) from S14
[S4] cosine check vs S14: cos=0.8056
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.4177
[S4] sending update (kind=head size=1805 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1805) from S4
[S9] cosine check vs S4: cos=0.1333
[S9] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=36 metric=0.9952 head_norm=1.421212
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.177738e-01
[S9] stored merged vector for next round verification (round=36)
[S9] DEBUG after merge:  round=36 metric=0.9952 head_norm=1.138274 delta_norm=0.417774
[S9] aggregate: ACCEPT kept=['S5', 'S17', 'S4'] (k=3/3) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9477 head_norm=1.360502
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.378608e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9491 head_norm=1.329691 delta_norm=0.437861
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9672 head_norm=1.268857
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.627764e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9711 head_norm=1.243996 delta_norm=0.162776
[S16] aggregate: ACCEPT kept=['S15', 'S13'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=36 metric=0.9939 head_norm=1.312309
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.256086e-01
[S8] stored merged vector for next round verification (round=36)
[S8] DEBUG after merge:  round=36 metric=0.9937 head_norm=1.455668 delta_norm=0.725609
[S8] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9972 head_norm=1.438275
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.609652e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9972 head_norm=1.650233 delta_norm=0.560965
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6298 head_norm=1.651173
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.905725e-01
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6306 head_norm=1.408404 delta_norm=0.490573
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.889126 (no previous merge yet)
[S2] round=37 local utility u=0.120373 metrics={'f1_val': 0.8119542502419237, 'auprc': 0.8169455065845306, 'loss_val': 0.3606355309119843, 'psi': 0.8139507527789664}-{'f1_val': 0.8003778394835437, 'auprc': 0.7568116491434445, 'loss_val': 0.35152185576015726, 'psi': 0.782951363347504}
[S3] START round=37 head_norm_before_train=2.220808 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9514112346304128, 'auprc': 0.9977303966335564, 'loss_val': 0.19754531660505395, 'psi': 0.9699388994316702}-{'f1_val': 0.9974271292865575, 'auprc': 0.9989901374820451, 'loss_val': 0.03904696861891483, 'psi': 0.9980523325647526}
[S4] START round=37 head_norm_before_train=1.329691 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9521730330559508, 'auprc': 0.9530153197884269, 'loss_val': 0.3345795269482547, 'psi': 0.9525099477489413}-{'f1_val': 0.9477130392885077, 'auprc': 0.9733106817210384, 'loss_val': 0.27168635068721986, 'psi': 0.95795209626152}
[S5] START round=37 head_norm_before_train=1.793966 cos_to_last_merge=0.8395 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9952592720753782, 'loss_val': 0.030728127436051435, 'psi': 0.9958153228157379}-{'f1_val': 0.996186023309311, 'auprc': 0.9980148647053956, 'loss_val': 0.030292973559195004, 'psi': 0.9969175598677449}
[S6] START round=37 head_norm_before_train=1.679114 cos_to_last_merge=0.7872 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=37 local utility u=0.385842 metrics={'f1_val': 0.7472069292131628, 'auprc': 0.9375366914328142, 'loss_val': 0.5896387917348215, 'psi': 0.8233388341010234}-{'f1_val': 0.6707174779073037, 'auprc': 0.8786573898086907, 'loss_val': 0.725748891754936, 'psi': 0.7538934426678585}
[S7] START round=37 head_norm_before_train=1.907896 (no previous merge yet)
[S7] round=37 local utility u=0.210309 metrics={'f1_val': 0.6506811439159381, 'auprc': 0.8106473125144614, 'loss_val': 0.46297372956915034, 'psi': 0.7146676113553474}-{'f1_val': 0.6153894590379936, 'auprc': 0.7983675182580564, 'loss_val': 0.6350013042376388, 'psi': 0.6885806827260187}
[S8] START round=37 head_norm_before_train=1.455668 cos_to_last_merge=1.0000 (last merge round=36)
[S8] round=37 local utility u=0.015868 metrics={'f1_val': 0.9924509553239076, 'auprc': 0.9885698307279428, 'loss_val': 0.06767758660332066, 'psi': 0.9908985054855216}-{'f1_val': 0.9939122747783468, 'auprc': 0.9895429319528686, 'loss_val': 0.11110062087346297, 'psi': 0.9921645376481555}
[S9] START round=37 head_norm_before_train=1.138274 cos_to_last_merge=1.0000 (last merge round=36)
[S9] round=37 local utility u=0.000000 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9983053432461113, 'loss_val': 0.12489463443667596, 'psi': 0.9966880235723065}-{'f1_val': 0.9951945592007305, 'auprc': 0.9983207363732597, 'loss_val': 0.11524947853111978, 'psi': 0.9964450300697423}
[S10] START round=37 head_norm_before_train=2.001817 cos_to_last_merge=0.9982 (last merge round=33)
[S10] round=37 local utility u=0.002274 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9971667620786434, 'loss_val': 0.03917824249556165, 'psi': 0.9960605771696955}-{'f1_val': 0.9951034680760983, 'auprc': 0.9972238508469693, 'loss_val': 0.042578984622431384, 'psi': 0.9959516211844467}
[S11] START round=37 head_norm_before_train=1.721321 cos_to_last_merge=0.9998 (last merge round=35)
[S11] round=37 local utility u=0.001560 metrics={'f1_val': 0.9965268648289654, 'auprc': 0.9976872692778904, 'loss_val': 0.0406062579717447, 'psi': 0.9969910266085353}-{'f1_val': 0.9969642566262439, 'auprc': 0.9978715423888141, 'loss_val': 0.04690282578120453, 'psi': 0.9973271709312719}
[S13] START round=37 head_norm_before_train=1.280100 cos_to_last_merge=0.9992 (last merge round=35)
[S13] round=37 local utility u=0.046705 metrics={'f1_val': 0.5871392476462451, 'auprc': 0.6894306073002954, 'loss_val': 0.7446576074126066, 'psi': 0.6280557915078653}-{'f1_val': 0.5736241699867463, 'auprc': 0.6904188281780648, 'loss_val': 0.759942311146677, 'psi': 0.6203420332632736}
[S14] START round=37 head_norm_before_train=1.650233 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9947897513402439, 'loss_val': 0.12214084750828291, 'psi': 0.9958682395025478}-{'f1_val': 0.9972183481640888, 'auprc': 0.9984627294264656, 'loss_val': 0.12774766599331877, 'psi': 0.9977161006690396}
[S15] START round=37 head_norm_before_train=1.861439 cos_to_last_merge=0.7937 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.794
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8062594661615891, 'auprc': 0.9919804646323128, 'loss_val': 0.29378101186350053, 'psi': 0.8805478655498786}-{'f1_val': 0.9928006488957288, 'auprc': 0.9990913160830772, 'loss_val': 0.0431900646227792, 'psi': 0.9953169157706682}
[S16] START round=37 head_norm_before_train=1.243996 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.092900 metrics={'f1_val': 0.9913819373831066, 'auprc': 0.989324581889661, 'loss_val': 0.1156977748303805, 'psi': 0.9905589951857283}-{'f1_val': 0.9672014850964172, 'auprc': 0.9937574744258094, 'loss_val': 0.16971279377277568, 'psi': 0.9778238808281741}
[S17] START round=37 head_norm_before_train=1.408404 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.001341 metrics={'f1_val': 0.5938088430890288, 'auprc': 0.981755200002041, 'loss_val': 0.7950761542877405, 'psi': 0.7489873858542337}-{'f1_val': 0.6298486018178944, 'auprc': 0.8911935957358065, 'loss_val': 0.7423127004024893, 'psi': 0.7343865993850592}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:37114
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:37109
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:37111
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:37116
[S13] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S16
[S8] cosine check vs S16: cos=0.7508
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.2958
[S16] RECEIVED delta(kind=head bytes=1802) from S13
[S16] cosine check vs S13: cos=0.7502
[S11] RECEIVED delta(kind=head bytes=1801) from S6
[S11] cosine check vs S6: cos=0.9959
[S10] RECEIVED delta(kind=head bytes=1799) from S7
[S10] cosine check vs S7: cos=0.9924
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9822
[S8] RECEIVED delta(kind=head bytes=1804) from S2
[S8] cosine check vs S2: cos=0.9354
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[S10] sending update (kind=head size=1795 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S10
[S14] cosine check vs S10: cos=0.9675
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.6160
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=37 metric=0.9956 head_norm=1.213810
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.875987e-01
[S9] stored merged vector for next round verification (round=37)
[S9] DEBUG after merge:  round=37 metric=0.9952 head_norm=1.189654 delta_norm=0.587599
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9925 head_norm=1.499481
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.274866e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9925 head_norm=1.435959 delta_norm=0.092749
[S8] aggregate: ACCEPT kept=['S16', 'S2'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=37 metric=0.9953 head_norm=2.023529
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.316781e-01
[S10] stored merged vector for next round verification (round=37)
[S10] DEBUG after merge:  round=37 metric=0.9953 head_norm=1.970260 delta_norm=0.131678
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9965 head_norm=1.746501
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.373775e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9965 head_norm=1.714075 delta_norm=0.083738
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=37 metric=0.9966 head_norm=1.673813
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.679639e-01
[S14] stored merged vector for next round verification (round=37)
[S14] DEBUG after merge:  round=37 metric=0.9966 head_norm=1.485385 delta_norm=0.367964
[S14] aggregate: ACCEPT kept=['S11', 'S10'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=37 metric=0.9914 head_norm=1.279741
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.579696e-01
[S16] stored merged vector for next round verification (round=37)
[S16] DEBUG after merge:  round=37 metric=0.9914 head_norm=1.211607 delta_norm=0.457970
[S16] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=37 metric=0.5938 head_norm=1.431001
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.424771e-01
[S17] stored merged vector for next round verification (round=37)
[S17] DEBUG after merge:  round=37 metric=0.5938 head_norm=1.458699 delta_norm=0.142477
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.900779 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7439043862348533, 'auprc': 0.7759924330805548, 'loss_val': 0.3938138718706334, 'psi': 0.7567396049731339}-{'f1_val': 0.8119542502419237, 'auprc': 0.8169455065845306, 'loss_val': 0.3606355309119843, 'psi': 0.8139507527789664}
[S3] START round=38 head_norm_before_train=2.231475 (no previous merge yet)
[S3] round=38 local utility u=0.179564 metrics={'f1_val': 0.9889155651451682, 'auprc': 0.998316637023485, 'loss_val': 0.06520132123405892, 'psi': 0.9926759938964949}-{'f1_val': 0.9514112346304128, 'auprc': 0.9977303966335564, 'loss_val': 0.19754531660505395, 'psi': 0.9699388994316702}
[S4] START round=38 head_norm_before_train=1.359389 cos_to_last_merge=0.9989 (last merge round=36)
[S4] round=38 local utility u=0.020921 metrics={'f1_val': 0.9451038554269676, 'auprc': 0.9699979243492993, 'loss_val': 0.3012697486536216, 'psi': 0.9550614829959003}-{'f1_val': 0.9521730330559508, 'auprc': 0.9530153197884269, 'loss_val': 0.3345795269482547, 'psi': 0.9525099477489413}
[S5] START round=38 head_norm_before_train=1.797835 cos_to_last_merge=0.8399 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=38 local utility u=0.003331 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9977667265115396, 'loss_val': 0.03071253717553081, 'psi': 0.9967306257480391}-{'f1_val': 0.996186023309311, 'auprc': 0.9952592720753782, 'loss_val': 0.030728127436051435, 'psi': 0.9958153228157379}
[S6] START round=38 head_norm_before_train=1.685190 cos_to_last_merge=0.7863 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=38 local utility u=0.499908 metrics={'f1_val': 0.8525293979633959, 'auprc': 0.9450870139935146, 'loss_val': 0.24440903713549217, 'psi': 0.8895524443754433}-{'f1_val': 0.7472069292131628, 'auprc': 0.9375366914328142, 'loss_val': 0.5896387917348215, 'psi': 0.8233388341010234}
[S7] START round=38 head_norm_before_train=1.924540 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6292606525214679, 'auprc': 0.808304095473923, 'loss_val': 0.4836160314341196, 'psi': 0.70087802970245}-{'f1_val': 0.6506811439159381, 'auprc': 0.8106473125144614, 'loss_val': 0.46297372956915034, 'psi': 0.7146676113553474}
[S8] START round=38 head_norm_before_train=1.435959 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.001544 metrics={'f1_val': 0.992815308526175, 'auprc': 0.9889398057704849, 'loss_val': 0.06788471247630319, 'psi': 0.991265107423899}-{'f1_val': 0.9924509553239076, 'auprc': 0.9885698307279428, 'loss_val': 0.06767758660332066, 'psi': 0.9908985054855216}
[S9] START round=38 head_norm_before_train=1.189654 cos_to_last_merge=1.0000 (last merge round=37)
[S9] round=38 local utility u=0.018556 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9938765490045975, 'loss_val': 0.07947025183684003, 'psi': 0.9954139123286108}-{'f1_val': 0.9956098104564366, 'auprc': 0.9983053432461113, 'loss_val': 0.12489463443667596, 'psi': 0.9966880235723065}
[S10] START round=38 head_norm_before_train=1.970260 cos_to_last_merge=1.0000 (last merge round=37)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996410466671167, 'loss_val': 0.04639217542486419, 'psi': 0.9956768900800916}-{'f1_val': 0.9953231205637304, 'auprc': 0.9971667620786434, 'loss_val': 0.03917824249556165, 'psi': 0.9960605771696955}
[S11] START round=38 head_norm_before_train=1.714075 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9947645810543823, 'loss_val': 0.04486082445055873, 'psi': 0.9958363854188113}-{'f1_val': 0.9965268648289654, 'auprc': 0.9976872692778904, 'loss_val': 0.0406062579717447, 'psi': 0.9969910266085353}
[S13] START round=38 head_norm_before_train=1.310617 cos_to_last_merge=0.9973 (last merge round=35)
[S13] round=38 local utility u=0.000000 metrics={'f1_val': 0.5507449218339149, 'auprc': 0.7001594376514719, 'loss_val': 0.9011058744812539, 'psi': 0.6105107281609377}-{'f1_val': 0.5871392476462451, 'auprc': 0.6894306073002954, 'loss_val': 0.7446576074126066, 'psi': 0.6280557915078653}
[S14] START round=38 head_norm_before_train=1.485385 cos_to_last_merge=1.0000 (last merge round=37)
[S14] round=38 local utility u=0.005646 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9968646723502033, 'loss_val': 0.11707457592528321, 'psi': 0.9966982079065315}-{'f1_val': 0.9965872316107504, 'auprc': 0.9947897513402439, 'loss_val': 0.12214084750828291, 'psi': 0.9958682395025478}
[S15] START round=38 head_norm_before_train=1.871308 cos_to_last_merge=0.7933 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7953355813936659, 'auprc': 0.9927943276971143, 'loss_val': 0.30645674047174504, 'psi': 0.8743190799150453}-{'f1_val': 0.8062594661615891, 'auprc': 0.9919804646323128, 'loss_val': 0.29378101186350053, 'psi': 0.8805478655498786}
[S16] START round=38 head_norm_before_train=1.211607 cos_to_last_merge=1.0000 (last merge round=37)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8463486073030007, 'auprc': 0.989536123300214, 'loss_val': 0.6703594728223032, 'psi': 0.903623613701886}-{'f1_val': 0.9913819373831066, 'auprc': 0.989324581889661, 'loss_val': 0.1156977748303805, 'psi': 0.9905589951857283}
[S17] START round=38 head_norm_before_train=1.458699 cos_to_last_merge=1.0000 (last merge round=37)
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.5864244468594492, 'auprc': 0.9933545102140069, 'loss_val': 0.787987943115341, 'psi': 0.7491964722012723}-{'f1_val': 0.5938088430890288, 'auprc': 0.981755200002041, 'loss_val': 0.7950761542877405, 'psi': 0.7489873858542337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:37103
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.8961
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.8929
[S16] RECEIVED delta(kind=head bytes=1801) from S8
[S16] cosine check vs S8: cos=0.8446
[S3] RECEIVED delta(kind=head bytes=1802) from S4
[S3] cosine check vs S4: cos=0.3460
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9889 head_norm=2.241858
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.096122e+00
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9955 head_norm=1.510802 delta_norm=1.096122
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9952 head_norm=1.992244
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.628485e-01
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9952 head_norm=1.706563 delta_norm=0.462848
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.5864 head_norm=1.483960
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.355151e-01
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.5867 head_norm=1.337070 delta_norm=0.335515
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.8463 head_norm=1.246876
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.941128e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.8470 head_norm=1.306096 delta_norm=0.394113
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.911990 (no previous merge yet)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7071814424705317, 'auprc': 0.8216912247340407, 'loss_val': 0.5110029393589424, 'psi': 0.7529853553759354}-{'f1_val': 0.7439043862348533, 'auprc': 0.7759924330805548, 'loss_val': 0.3938138718706334, 'psi': 0.7567396049731339}
[S3] START round=39 head_norm_before_train=1.510802 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.961521499390029, 'auprc': 0.9992428614026312, 'loss_val': 0.1308691712044994, 'psi': 0.9766100441950698}-{'f1_val': 0.9889155651451682, 'auprc': 0.998316637023485, 'loss_val': 0.06520132123405892, 'psi': 0.9926759938964949}
[S4] START round=39 head_norm_before_train=1.393587 cos_to_last_merge=0.9956 (last merge round=36)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9406626060492586, 'auprc': 0.938388031556208, 'loss_val': 0.3203303112599314, 'psi': 0.9397527762520383}-{'f1_val': 0.9451038554269676, 'auprc': 0.9699979243492993, 'loss_val': 0.3012697486536216, 'psi': 0.9550614829959003}
[S5] START round=39 head_norm_before_train=1.806045 cos_to_last_merge=0.8399 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9977199971300523, 'loss_val': 0.03035021441926696, 'psi': 0.9966239931232246}-{'f1_val': 0.9960398919057053, 'auprc': 0.9977667265115396, 'loss_val': 0.03071253717553081, 'psi': 0.9967306257480391}
[S6] START round=39 head_norm_before_train=1.693837 cos_to_last_merge=0.7858 (last merge round=1)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.72286771907544, 'auprc': 0.9022658665604226, 'loss_val': 0.6812915086370279, 'psi': 0.794626978069433}-{'f1_val': 0.8525293979633959, 'auprc': 0.9450870139935146, 'loss_val': 0.24440903713549217, 'psi': 0.8895524443754433}
[S7] START round=39 head_norm_before_train=1.937637 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.606477986343785, 'auprc': 0.8003351166608588, 'loss_val': 0.6589967704075456, 'psi': 0.6840208384706146}-{'f1_val': 0.6292606525214679, 'auprc': 0.808304095473923, 'loss_val': 0.4836160314341196, 'psi': 0.70087802970245}
[S8] START round=39 head_norm_before_train=1.472319 cos_to_last_merge=0.9996 (last merge round=37)
[S8] round=39 local utility u=0.003714 metrics={'f1_val': 0.992815308526175, 'auprc': 0.9888556604907756, 'loss_val': 0.06020450188436556, 'psi': 0.9912314493120152}-{'f1_val': 0.992815308526175, 'auprc': 0.9889398057704849, 'loss_val': 0.06788471247630319, 'psi': 0.991265107423899}
[S9] START round=39 head_norm_before_train=1.264325 cos_to_last_merge=0.9980 (last merge round=37)
[S9] round=39 local utility u=0.013686 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9966642578130673, 'loss_val': 0.06046142790181302, 'psi': 0.9965289958519987}-{'f1_val': 0.9964388212112862, 'auprc': 0.9938765490045975, 'loss_val': 0.07947025183684003, 'psi': 0.9954139123286108}
[S10] START round=39 head_norm_before_train=1.706563 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996710981211033, 'loss_val': 0.060796377198571366, 'psi': 0.995797095896038}-{'f1_val': 0.9951878390193748, 'auprc': 0.996410466671167, 'loss_val': 0.04639217542486419, 'psi': 0.9956768900800916}
[S11] START round=39 head_norm_before_train=1.737441 cos_to_last_merge=0.9998 (last merge round=37)
[S11] round=39 local utility u=0.002771 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9953397494174706, 'loss_val': 0.04104395185539448, 'psi': 0.9960664527640466}-{'f1_val': 0.9965509216617638, 'auprc': 0.9947645810543823, 'loss_val': 0.04486082445055873, 'psi': 0.9958363854188113}
[S13] START round=39 head_norm_before_train=1.338077 cos_to_last_merge=0.9949 (last merge round=35)
[S13] round=39 local utility u=0.208706 metrics={'f1_val': 0.6040864116797552, 'auprc': 0.6844981130636626, 'loss_val': 0.7567590363381383, 'psi': 0.6362510922333182}-{'f1_val': 0.5507449218339149, 'auprc': 0.7001594376514719, 'loss_val': 0.9011058744812539, 'psi': 0.6105107281609377}
[S14] START round=39 head_norm_before_train=1.511336 cos_to_last_merge=0.9996 (last merge round=37)
[S14] round=39 local utility u=0.012575 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9981824733419055, 'loss_val': 0.09979747571616608, 'psi': 0.997617203360238}-{'f1_val': 0.9965872316107504, 'auprc': 0.9968646723502033, 'loss_val': 0.11707457592528321, 'psi': 0.9966982079065315}
[S15] START round=39 head_norm_before_train=1.881315 cos_to_last_merge=0.7926 (last merge round=1)
[S15] ⚠️ Model drifted since last merge! cos=0.793
[S15] round=39 local utility u=0.531819 metrics={'f1_val': 0.9341151080576334, 'auprc': 0.9964128744308604, 'loss_val': 0.08635179900946455, 'psi': 0.9590342146069242}-{'f1_val': 0.7953355813936659, 'auprc': 0.9927943276971143, 'loss_val': 0.30645674047174504, 'psi': 0.8743190799150453}
[S16] START round=39 head_norm_before_train=1.306096 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.691770 metrics={'f1_val': 0.9915714808080252, 'auprc': 0.9807630050321445, 'loss_val': 0.1318378735670064, 'psi': 0.9872480904976728}-{'f1_val': 0.8463486073030007, 'auprc': 0.989536123300214, 'loss_val': 0.6703594728223032, 'psi': 0.903623613701886}
[S17] START round=39 head_norm_before_train=1.337070 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.016874 metrics={'f1_val': 0.6182376193597199, 'auprc': 0.9204092295488522, 'loss_val': 0.7262823342813723, 'psi': 0.7391062634353729}-{'f1_val': 0.5864244468594492, 'auprc': 0.9933545102140069, 'loss_val': 0.787987943115341, 'psi': 0.7491964722012723}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:37115
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:37111
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:37117
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:37116
[S9] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1805 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S11
[S6] cosine check vs S11: cos=0.9968
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.9626
[S16] RECEIVED delta(kind=head bytes=1800) from S8
[S16] cosine check vs S8: cos=0.9631
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] cosine check vs S16: cos=0.5026
[S17] RECEIVED delta(kind=head bytes=1805) from S9
[S17] cosine check vs S9: cos=0.9633
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.9729
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1805 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9669
[S7] r=40 psi=0.684 u=0.0000 p_local=0.0823 f1=0.606 auprc=0.800 bytes=25159
[S2] r=40 psi=0.753 u=0.0000 p_local=0.0933 f1=0.707 auprc=0.822 bytes=34212
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.7229 head_norm=1.705376
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.384825e-02
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.7237 head_norm=1.730174 delta_norm=0.073848
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.795 u=0.0000 p_local=0.3072 f1=0.723 auprc=0.902 bytes=30584
[S5] r=40 psi=0.997 u=0.0000 p_local=0.0037 f1=0.996 auprc=0.998 bytes=32381
[S4] r=40 psi=0.940 u=0.0000 p_local=0.0300 f1=0.941 auprc=0.938 bytes=32395
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.9952 head_norm=1.735317
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.444090e-01
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.9952 head_norm=1.620935 delta_norm=0.244409
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.996 u=0.0000 p_local=0.0069 f1=0.995 auprc=0.997 bytes=35994
[S3] r=40 psi=0.977 u=0.0000 p_local=0.0570 f1=0.962 auprc=0.999 bytes=28765
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=39 metric=0.9916 head_norm=1.338526
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.097114e-01
[S16] stored merged vector for next round verification (round=39)
[S16] DEBUG after merge:  round=39 metric=0.9916 head_norm=1.407981 delta_norm=0.209711
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] r=40 psi=0.987 u=0.6918 p_local=0.2375 f1=0.992 auprc=0.981 bytes=30572
[S13] r=40 psi=0.636 u=0.2087 p_local=0.0902 f1=0.604 auprc=0.684 bytes=30596
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=39 metric=0.9928 head_norm=1.503704
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.966193e-01
[S8] stored merged vector for next round verification (round=39)
[S8] DEBUG after merge:  round=39 metric=0.9928 head_norm=1.423955 delta_norm=0.196619
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=40 psi=0.991 u=0.0037 p_local=0.0182 f1=0.993 auprc=0.989 bytes=37804
[S14] r=40 psi=0.998 u=0.0126 p_local=0.0085 f1=0.997 auprc=0.998 bytes=39592
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=39 metric=0.9964 head_norm=1.326708
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.573322e-01
[S9] stored merged vector for next round verification (round=39)
[S9] DEBUG after merge:  round=39 metric=0.9964 head_norm=1.334556 delta_norm=0.157332
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] r=40 psi=0.997 u=0.0137 p_local=0.0109 f1=0.996 auprc=0.997 bytes=34164
[S11] r=40 psi=0.996 u=0.0028 p_local=0.0040 f1=0.997 auprc=0.995 bytes=32356
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9341 head_norm=1.893280
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.409545e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9200 head_norm=1.407436 delta_norm=0.840954
[S15] aggregate: ROLLBACK (f1_val pre=0.934 post=0.920 tol_abs=0.005 tol_rel=0.0)
[S15] r=40 psi=0.959 u=0.5318 p_local=0.2930 f1=0.934 auprc=0.996 bytes=30588
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=39 metric=0.6182 head_norm=1.368024
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.836465e-01
[S17] stored merged vector for next round verification (round=39)
[S17] DEBUG after merge:  round=39 metric=0.6151 head_norm=1.334952 delta_norm=0.183647
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] r=40 psi=0.739 u=0.0169 p_local=0.1525 f1=0.618 auprc=0.920 bytes=34190
[S2] START round=40 head_norm_before_train=1.921051 (no previous merge yet)
[S2] round=40 local utility u=0.159645 metrics={'f1_val': 0.7452793616612569, 'auprc': 0.8081032653994646, 'loss_val': 0.37953726097543883, 'psi': 0.77040892315654}-{'f1_val': 0.7071814424705317, 'auprc': 0.8216912247340407, 'loss_val': 0.5110029393589424, 'psi': 0.7529853553759354}
[S3] START round=40 head_norm_before_train=1.552237 cos_to_last_merge=0.9995 (last merge round=38)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.8878727701528462, 'auprc': 0.9986101180025988, 'loss_val': 0.21176053660291605, 'psi': 0.9321677092927472}-{'f1_val': 0.961521499390029, 'auprc': 0.9992428614026312, 'loss_val': 0.1308691712044994, 'psi': 0.9766100441950698}
[S4] START round=40 head_norm_before_train=1.435448 cos_to_last_merge=0.9904 (last merge round=36)
[S4] round=40 local utility u=0.025006 metrics={'f1_val': 0.9401236384421289, 'auprc': 0.9548727384705367, 'loss_val': 0.31653811632288104, 'psi': 0.9460232784534921}-{'f1_val': 0.9406626060492586, 'auprc': 0.938388031556208, 'loss_val': 0.3203303112599314, 'psi': 0.9397527762520383}
[S5] START round=40 head_norm_before_train=1.816123 cos_to_last_merge=0.8395 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9918213905586576, 'loss_val': 0.03125587724289041, 'psi': 0.9942645504946667}-{'f1_val': 0.9958933237853395, 'auprc': 0.9977199971300523, 'loss_val': 0.03035021441926696, 'psi': 0.9966239931232246}
[S6] START round=40 head_norm_before_train=1.730174 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=0.098681 metrics={'f1_val': 0.7780955204699824, 'auprc': 0.8181246714016845, 'loss_val': 0.5628720574793317, 'psi': 0.7941071808426633}-{'f1_val': 0.72286771907544, 'auprc': 0.9022658665604226, 'loss_val': 0.6812915086370279, 'psi': 0.794626978069433}
[S7] START round=40 head_norm_before_train=1.948578 (no previous merge yet)
[S7] round=40 local utility u=0.833774 metrics={'f1_val': 0.8086776962390636, 'auprc': 0.8880404433041383, 'loss_val': 0.4677639410779667, 'psi': 0.8404227950650935}-{'f1_val': 0.606477986343785, 'auprc': 0.8003351166608588, 'loss_val': 0.6589967704075456, 'psi': 0.6840208384706146}
[S8] START round=40 head_norm_before_train=1.423955 cos_to_last_merge=1.0000 (last merge round=39)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.990363285929422, 'auprc': 0.98754709224055, 'loss_val': 0.06567284288131285, 'psi': 0.9892368084538732}-{'f1_val': 0.992815308526175, 'auprc': 0.9888556604907756, 'loss_val': 0.06020450188436556, 'psi': 0.9912314493120152}
[S9] START round=40 head_norm_before_train=1.334556 cos_to_last_merge=1.0000 (last merge round=39)
[S9] round=40 local utility u=0.001272 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9930419621987678, 'loss_val': 0.047071322399738526, 'psi': 0.9950820833864331}-{'f1_val': 0.9964388212112862, 'auprc': 0.9966642578130673, 'loss_val': 0.06046142790181302, 'psi': 0.9965289958519987}
[S10] START round=40 head_norm_before_train=1.620935 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9969914414647185, 'loss_val': 0.06696394526595385, 'psi': 0.9957774885049331}-{'f1_val': 0.9951878390193748, 'auprc': 0.996710981211033, 'loss_val': 0.060796377198571366, 'psi': 0.995797095896038}
[S11] START round=40 head_norm_before_train=1.757727 cos_to_last_merge=0.9995 (last merge round=37)
[S11] round=40 local utility u=0.002581 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9955042760609808, 'loss_val': 0.03637591910547513, 'psi': 0.9961322634214507}-{'f1_val': 0.9965509216617638, 'auprc': 0.9953397494174706, 'loss_val': 0.04104395185539448, 'psi': 0.9960664527640466}
[S13] START round=40 head_norm_before_train=1.360674 cos_to_last_merge=0.9928 (last merge round=35)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5529534763770235, 'auprc': 0.7021703678920047, 'loss_val': 0.9610187954488513, 'psi': 0.6126402329830161}-{'f1_val': 0.6040864116797552, 'auprc': 0.6844981130636626, 'loss_val': 0.7567590363381383, 'psi': 0.6362510922333182}
[S14] START round=40 head_norm_before_train=1.537208 cos_to_last_merge=0.9985 (last merge round=37)
[S14] round=40 local utility u=0.000629 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9948459411632491, 'loss_val': 0.08474834827267803, 'psi': 0.9959043844309541}-{'f1_val': 0.997240356705793, 'auprc': 0.9981824733419055, 'loss_val': 0.09979747571616608, 'psi': 0.997617203360238}
[S15] START round=40 head_norm_before_train=1.407436 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.9376509511869651, 'auprc': 0.9968119414822423, 'loss_val': 0.1131768810194369, 'psi': 0.961315347305076}-{'f1_val': 0.9341151080576334, 'auprc': 0.9964128744308604, 'loss_val': 0.08635179900946455, 'psi': 0.9590342146069242}
[S16] START round=40 head_norm_before_train=1.407981 cos_to_last_merge=1.0000 (last merge round=39)
[S16] round=40 local utility u=0.009026 metrics={'f1_val': 0.9907042626824083, 'auprc': 0.9859556354972865, 'loss_val': 0.12415998608638561, 'psi': 0.9888048118083596}-{'f1_val': 0.9915714808080252, 'auprc': 0.9807630050321445, 'loss_val': 0.1318378735670064, 'psi': 0.9872480904976728}
[S17] START round=40 head_norm_before_train=1.334952 cos_to_last_merge=1.0000 (last merge round=39)
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.41631867283215435, 'auprc': 0.684751113180327, 'loss_val': 1.3967533439319695, 'psi': 0.5236916489714234}-{'f1_val': 0.6182376193597199, 'auprc': 0.9204092295488522, 'loss_val': 0.7262823342813723, 'psi': 0.7391062634353729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] sending update (kind=head size=1790 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:37107
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S11
[S6] cosine check vs S11: cos=0.9986
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:37103
[S4] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.7174
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:37117
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S9
[S17] cosine check vs S9: cos=0.9743
[S14] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S14
[S10] cosine check vs S14: cos=0.9860
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:37115
[S16] sending update (kind=head size=1805 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1805) from S16
[S15] cosine check vs S16: cos=0.7816
[S4] ⇄ pheromone p=0.029 → S3@127.0.0.1:37103
[S13] ⇄ pheromone p=0.072 → S9@127.0.0.1:37110
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=40 metric=0.9950 head_norm=1.656133
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.421430e-01
[S10] stored merged vector for next round verification (round=40)
[S10] DEBUG after merge:  round=40 metric=0.9952 head_norm=1.605153 delta_norm=0.142143
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.006 → S7@127.0.0.1:37108
[S9] ⇄ pheromone p=0.009 → S17@127.0.0.1:37117
[S14] ⇄ pheromone p=0.007 → S10@127.0.0.1:37111
[S7] ⇄ pheromone p=0.233 → S10@127.0.0.1:37111
[S8] ⇄ pheromone p=0.015 → S16@127.0.0.1:37116
[S11] ⇄ pheromone p=0.004 → S6@127.0.0.1:37107
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=40 metric=0.7781 head_norm=1.744697
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.940348e-02
[S6] stored merged vector for next round verification (round=40)
[S6] DEBUG after merge:  round=40 metric=0.7793 head_norm=1.760021 delta_norm=0.049403
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.8879 head_norm=1.617701
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.851067e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9522 head_norm=1.433542 delta_norm=0.585107
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S3] ⇄ pheromone p=0.046 → S4@127.0.0.1:37104
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.9377 head_norm=1.432139
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.744093e-01
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.9211 head_norm=1.355076 delta_norm=0.474409
[S15] aggregate: ROLLBACK (f1_val pre=0.938 post=0.921 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.4163 head_norm=1.365110
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.559528e-01
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.4069 head_norm=1.364586 delta_norm=0.155953
[S17] aggregate: ROLLBACK (f1_val pre=0.416 post=0.407 tol_abs=0.005 tol_rel=0.0)
[S17] ⇄ pheromone p=0.122 → S8@127.0.0.1:37109
[S16] ⇄ pheromone p=0.192 → S15@127.0.0.1:37115
[S2] START round=41 head_norm_before_train=1.927420 (no previous merge yet)
[S2] round=41 local utility u=0.154975 metrics={'f1_val': 0.8188516656176256, 'auprc': 0.7676228536750287, 'loss_val': 0.38957994589860545, 'psi': 0.7983601408405868}-{'f1_val': 0.7452793616612569, 'auprc': 0.8081032653994646, 'loss_val': 0.37953726097543883, 'psi': 0.77040892315654}
[S3] START round=41 head_norm_before_train=1.433542 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.373715 metrics={'f1_val': 0.9898840642803345, 'auprc': 0.9993144212240845, 'loss_val': 0.07851109210941595, 'psi': 0.9936562070578345}-{'f1_val': 0.8878727701528462, 'auprc': 0.9986101180025988, 'loss_val': 0.21176053660291605, 'psi': 0.9321677092927472}
[S4] START round=41 head_norm_before_train=1.475746 cos_to_last_merge=0.9853 (last merge round=36)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9386064525040032, 'auprc': 0.9541589575195506, 'loss_val': 0.3230171798635949, 'psi': 0.9448274545102222}-{'f1_val': 0.9401236384421289, 'auprc': 0.9548727384705367, 'loss_val': 0.31653811632288104, 'psi': 0.9460232784534921}
[S5] START round=41 head_norm_before_train=1.817767 cos_to_last_merge=0.8399 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9893140305438886, 'auprc': 0.9886470006206434, 'loss_val': 0.06001507846247007, 'psi': 0.9890472185745904}-{'f1_val': 0.9958933237853395, 'auprc': 0.9918213905586576, 'loss_val': 0.03125587724289041, 'psi': 0.9942645504946667}
[S6] START round=41 head_norm_before_train=1.760021 cos_to_last_merge=1.0000 (last merge round=40)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7672471565884449, 'auprc': 0.8192124825709584, 'loss_val': 0.6386937277899628, 'psi': 0.7880332869814504}-{'f1_val': 0.7780955204699824, 'auprc': 0.8181246714016845, 'loss_val': 0.5628720574793317, 'psi': 0.7941071808426633}
[S7] START round=41 head_norm_before_train=1.956793 (no previous merge yet)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.5281000586971816, 'auprc': 0.7807423548416217, 'loss_val': 1.101944449446715, 'psi': 0.6291569771549577}-{'f1_val': 0.8086776962390636, 'auprc': 0.8880404433041383, 'loss_val': 0.4677639410779667, 'psi': 0.8404227950650935}
[S8] START round=41 head_norm_before_train=1.449998 cos_to_last_merge=0.9998 (last merge round=39)
[S8] round=41 local utility u=0.008220 metrics={'f1_val': 0.9927572273717925, 'auprc': 0.985782745893577, 'loss_val': 0.05830310059281149, 'psi': 0.9899674347805063}-{'f1_val': 0.990363285929422, 'auprc': 0.98754709224055, 'loss_val': 0.06567284288131285, 'psi': 0.9892368084538732}
[S9] START round=41 head_norm_before_train=1.381778 cos_to_last_merge=0.9997 (last merge round=39)
[S9] round=41 local utility u=0.007874 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.998294247783764, 'loss_val': 0.04208520942734093, 'psi': 0.9966835853873675}-{'f1_val': 0.99644216417821, 'auprc': 0.9930419621987678, 'loss_val': 0.047071322399738526, 'psi': 0.9950820833864331}
[S10] START round=41 head_norm_before_train=1.605153 cos_to_last_merge=1.0000 (last merge round=40)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9969116761669133, 'loss_val': 0.06709341051366437, 'psi': 0.995745582385811}-{'f1_val': 0.9949681865317428, 'auprc': 0.9969914414647185, 'loss_val': 0.06696394526595385, 'psi': 0.9957774885049331}
[S11] START round=41 head_norm_before_train=1.776586 cos_to_last_merge=0.9990 (last merge round=37)
[S11] round=41 local utility u=0.006649 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9987699293280684, 'loss_val': 0.03535434141357392, 'psi': 0.9976865257069736}-{'f1_val': 0.9965509216617638, 'auprc': 0.9955042760609808, 'loss_val': 0.03637591910547513, 'psi': 0.9961322634214507}
[S13] START round=41 head_norm_before_train=1.376636 cos_to_last_merge=0.9912 (last merge round=35)
[S13] round=41 local utility u=0.099643 metrics={'f1_val': 0.5674006349333516, 'auprc': 0.6922798563016337, 'loss_val': 0.8187435247568363, 'psi': 0.6173523234806644}-{'f1_val': 0.5529534763770235, 'auprc': 0.7021703678920047, 'loss_val': 0.9610187954488513, 'psi': 0.6126402329830161}
[S14] START round=41 head_norm_before_train=1.565461 cos_to_last_merge=0.9970 (last merge round=37)
[S14] round=41 local utility u=0.009039 metrics={'f1_val': 0.9968080713232721, 'auprc': 0.996386139333422, 'loss_val': 0.07247896597000505, 'psi': 0.996639298527332}-{'f1_val': 0.9966100132760906, 'auprc': 0.9948459411632491, 'loss_val': 0.08474834827267803, 'psi': 0.9959043844309541}
[S15] START round=41 head_norm_before_train=1.355076 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.8847823030371764, 'auprc': 0.9958391932802252, 'loss_val': 0.21597818981523204, 'psi': 0.9292050591343959}-{'f1_val': 0.9376509511869651, 'auprc': 0.9968119414822423, 'loss_val': 0.1131768810194369, 'psi': 0.961315347305076}
[S16] START round=41 head_norm_before_train=1.439294 cos_to_last_merge=0.9992 (last merge round=39)
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.85201425479002, 'auprc': 0.9821837048774016, 'loss_val': 0.7050440821232564, 'psi': 0.9040820348249727}-{'f1_val': 0.9907042626824083, 'auprc': 0.9859556354972865, 'loss_val': 0.12415998608638561, 'psi': 0.9888048118083596}
[S17] START round=41 head_norm_before_train=1.364586 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.6130065974817304, 'auprc': 0.8898845667082589, 'loss_val': 0.8964493653153399, 'psi': 0.7237577851723418}-{'f1_val': 0.41631867283215435, 'auprc': 0.684751113180327, 'loss_val': 1.3967533439319695, 'psi': 0.5236916489714234}
[S3]  timeout peer S2
[S2]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:37117
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S4@127.0.0.1:37104
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:37116
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:37111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:37110
[S14] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S11
[S6] cosine check vs S11: cos=0.9993
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=0.9933
[S17] RECEIVED delta(kind=head bytes=1803) from S9
[S17] cosine check vs S9: cos=0.9911
[S4] RECEIVED delta(kind=head bytes=1805) from S3
[S4] cosine check vs S3: cos=0.8984
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.9906
[S16] RECEIVED delta(kind=head bytes=1804) from S8
[S16] cosine check vs S8: cos=0.9906
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9382
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=41 metric=0.9386 head_norm=1.513930
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.429292e-01
[S4] stored merged vector for next round verification (round=41)
[S4] DEBUG after merge:  round=41 metric=0.9371 head_norm=1.482035 delta_norm=0.342929
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7672 head_norm=1.770775
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.544251e-02
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7693 head_norm=1.781098 delta_norm=0.035443
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9950 head_norm=1.643455
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.705134e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9950 head_norm=1.615162 delta_norm=0.097051
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9928 head_norm=1.476376
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.555546e-01
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9928 head_norm=1.413382 delta_norm=0.255555
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=41 metric=0.9956 head_norm=1.416385
[S9] _apply_head_vector_avg (torch): Δ‖w‖=9.695099e-02
[S9] stored merged vector for next round verification (round=41)
[S9] DEBUG after merge:  round=41 metric=0.9952 head_norm=1.400129 delta_norm=0.096951
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=41 metric=0.6130 head_norm=1.395074
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.427483e-02
[S17] stored merged vector for next round verification (round=41)
[S17] DEBUG after merge:  round=41 metric=0.6130 head_norm=1.402605 delta_norm=0.094275
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=41 metric=0.8520 head_norm=1.471012
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.012007e-01
[S16] stored merged vector for next round verification (round=41)
[S16] DEBUG after merge:  round=41 metric=0.8525 head_norm=1.470217 delta_norm=0.101201
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.932657 (no previous merge yet)
[S2] round=42 local utility u=0.189229 metrics={'f1_val': 0.8342537768356929, 'auprc': 0.8294351112155067, 'loss_val': 0.2889715256379655, 'psi': 0.8323263105876184}-{'f1_val': 0.8188516656176256, 'auprc': 0.7676228536750287, 'loss_val': 0.38957994589860545, 'psi': 0.7983601408405868}
[S3] START round=42 head_norm_before_train=1.528422 cos_to_last_merge=0.9967 (last merge round=40)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9873533286552678, 'auprc': 0.9972687963828805, 'loss_val': 0.08022742012652369, 'psi': 0.9913195157463128}-{'f1_val': 0.9898840642803345, 'auprc': 0.9993144212240845, 'loss_val': 0.07851109210941595, 'psi': 0.9936562070578345}
[S4] START round=42 head_norm_before_train=1.482035 cos_to_last_merge=1.0000 (last merge round=41)
[S4] round=42 local utility u=0.095233 metrics={'f1_val': 0.9488031554166851, 'auprc': 0.9726599799267389, 'loss_val': 0.24923400637291218, 'psi': 0.9583458852207067}-{'f1_val': 0.9386064525040032, 'auprc': 0.9541589575195506, 'loss_val': 0.3230171798635949, 'psi': 0.9448274545102222}
[S5] START round=42 head_norm_before_train=1.825043 cos_to_last_merge=0.8396 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=42 local utility u=0.038463 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9916494244273599, 'loss_val': 0.031571545840008104, 'psi': 0.9941957640421476}-{'f1_val': 0.9893140305438886, 'auprc': 0.9886470006206434, 'loss_val': 0.06001507846247007, 'psi': 0.9890472185745904}
[S6] START round=42 head_norm_before_train=1.781098 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6898977952522956, 'auprc': 0.8116144182126177, 'loss_val': 0.7584616977164251, 'psi': 0.7385844444364245}-{'f1_val': 0.7672471565884449, 'auprc': 0.8192124825709584, 'loss_val': 0.6386937277899628, 'psi': 0.7880332869814504}
[S7] START round=42 head_norm_before_train=1.962038 (no previous merge yet)
[S7] round=42 local utility u=0.801715 metrics={'f1_val': 0.6645957262671172, 'auprc': 0.8134763644816697, 'loss_val': 0.4156910680470151, 'psi': 0.7241479815529381}-{'f1_val': 0.5281000586971816, 'auprc': 0.7807423548416217, 'loss_val': 1.101944449446715, 'psi': 0.6291569771549577}
[S8] START round=42 head_norm_before_train=1.413382 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9615236277484156, 'auprc': 0.9987376728322621, 'loss_val': 0.14059671577193067, 'psi': 0.9764092457819542}-{'f1_val': 0.9927572273717925, 'auprc': 0.985782745893577, 'loss_val': 0.05830310059281149, 'psi': 0.9899674347805063}
[S9] START round=42 head_norm_before_train=1.400129 cos_to_last_merge=1.0000 (last merge round=41)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9928222479969133, 'loss_val': 0.04005339574174396, 'psi': 0.9951443939576227}-{'f1_val': 0.9956098104564366, 'auprc': 0.998294247783764, 'loss_val': 0.04208520942734093, 'psi': 0.9966835853873675}
[S10] START round=42 head_norm_before_train=1.615162 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000270 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996266684442949, 'loss_val': 0.06593731233367478, 'psi': 0.9956193771888044}-{'f1_val': 0.9949681865317428, 'auprc': 0.9969116761669133, 'loss_val': 0.06709341051366437, 'psi': 0.995745582385811}
[S11] START round=42 head_norm_before_train=1.792062 cos_to_last_merge=0.9985 (last merge round=37)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9953790619562344, 'loss_val': 0.03302108016117157, 'psi': 0.996185076531403}-{'f1_val': 0.9969642566262439, 'auprc': 0.9987699293280684, 'loss_val': 0.03535434141357392, 'psi': 0.9976865257069736}
[S13] START round=42 head_norm_before_train=1.390458 cos_to_last_merge=0.9898 (last merge round=35)
[S13] round=42 local utility u=0.135208 metrics={'f1_val': 0.5988599965908296, 'auprc': 0.6968718118056771, 'loss_val': 0.750860060902978, 'psi': 0.6380647226767686}-{'f1_val': 0.5674006349333516, 'auprc': 0.6922798563016337, 'loss_val': 0.8187435247568363, 'psi': 0.6173523234806644}
[S14] START round=42 head_norm_before_train=1.592290 cos_to_last_merge=0.9953 (last merge round=37)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9959573711480637, 'auprc': 0.9926129214540212, 'loss_val': 0.06977201372949876, 'psi': 0.9946195912704467}-{'f1_val': 0.9968080713232721, 'auprc': 0.996386139333422, 'loss_val': 0.07247896597000505, 'psi': 0.996639298527332}
[S15] START round=42 head_norm_before_train=1.399068 cos_to_last_merge=0.9991 (last merge round=40)
[S15] round=42 local utility u=0.246466 metrics={'f1_val': 0.9504756623938057, 'auprc': 0.9976267955285003, 'loss_val': 0.12256981856874326, 'psi': 0.9693361156476835}-{'f1_val': 0.8847823030371764, 'auprc': 0.9958391932802252, 'loss_val': 0.21597818981523204, 'psi': 0.9292050591343959}
[S16] START round=42 head_norm_before_train=1.470217 cos_to_last_merge=1.0000 (last merge round=41)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8341857963504158, 'auprc': 0.9801615568632436, 'loss_val': 0.8123693391582518, 'psi': 0.8925761005555468}-{'f1_val': 0.85201425479002, 'auprc': 0.9821837048774016, 'loss_val': 0.7050440821232564, 'psi': 0.9040820348249727}
[S17] START round=42 head_norm_before_train=1.402605 cos_to_last_merge=1.0000 (last merge round=41)
[S17] round=42 local utility u=0.110901 metrics={'f1_val': 0.625881445833378, 'auprc': 0.9157653775826804, 'loss_val': 0.8295379617211405, 'psi': 0.741835018533099}-{'f1_val': 0.6130065974817304, 'auprc': 0.8898845667082589, 'loss_val': 0.8964493653153399, 'psi': 0.7237577851723418}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:37110
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:37111
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:37108
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:37103
[S10] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S7
[S10] cosine check vs S7: cos=0.8980
[S7] RECEIVED delta(kind=head bytes=1796) from S10
[S7] cosine check vs S10: cos=0.8980
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.9613
[S16] RECEIVED delta(kind=head bytes=1799) from S15
[S16] cosine check vs S15: cos=0.9125
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.9967
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:37109
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9722
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=42 metric=0.9874 head_norm=1.628507
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.257872e-01
[S3] stored merged vector for next round verification (round=42)
[S3] DEBUG after merge:  round=42 metric=0.9855 head_norm=1.555487 delta_norm=0.225787
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=42 metric=0.9615 head_norm=1.439473
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.692829e-01
[S8] stored merged vector for next round verification (round=42)
[S8] DEBUG after merge:  round=42 metric=0.9612 head_norm=1.426909 delta_norm=0.169283
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=42 metric=0.9967 head_norm=1.425991
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.902036e-02
[S9] stored merged vector for next round verification (round=42)
[S9] DEBUG after merge:  round=42 metric=0.9967 head_norm=1.413257 delta_norm=0.059020
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=42 metric=0.9952 head_norm=1.657158
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.365906e-01
[S10] stored merged vector for next round verification (round=42)
[S10] DEBUG after merge:  round=42 metric=0.9952 head_norm=1.766197 delta_norm=0.436591
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6646 head_norm=1.968236
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.365906e-01
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.6553 head_norm=1.766197 delta_norm=0.436591
[S7] aggregate: ROLLBACK (f1_val pre=0.665 post=0.655 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=42 metric=0.8342 head_norm=1.499375
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.101629e-01
[S16] stored merged vector for next round verification (round=42)
[S16] DEBUG after merge:  round=42 metric=0.8346 head_norm=1.447267 delta_norm=0.310163
[S16] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.940300 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.8252442184720797, 'auprc': 0.797721360122235, 'loss_val': 0.4272453587023768, 'psi': 0.8142350751321419}-{'f1_val': 0.8342537768356929, 'auprc': 0.8294351112155067, 'loss_val': 0.2889715256379655, 'psi': 0.8323263105876184}
[S3] START round=43 head_norm_before_train=1.555487 cos_to_last_merge=1.0000 (last merge round=42)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9135182006689342, 'auprc': 0.9982885716111929, 'loss_val': 0.1813244678978529, 'psi': 0.9474263490458377}-{'f1_val': 0.9873533286552678, 'auprc': 0.9972687963828805, 'loss_val': 0.08022742012652369, 'psi': 0.9913195157463128}
[S4] START round=43 head_norm_before_train=1.512946 cos_to_last_merge=0.9998 (last merge round=41)
[S4] round=43 local utility u=0.038856 metrics={'f1_val': 0.9590364178605773, 'auprc': 0.9743028455128544, 'loss_val': 0.2378499153576323, 'psi': 0.9651429889214881}-{'f1_val': 0.9488031554166851, 'auprc': 0.9726599799267389, 'loss_val': 0.24923400637291218, 'psi': 0.9583458852207067}
[S5] START round=43 head_norm_before_train=1.831234 cos_to_last_merge=0.8392 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=43 local utility u=0.008591 metrics={'f1_val': 0.9955286699203818, 'auprc': 0.9979377802703113, 'loss_val': 0.031065931799202952, 'psi': 0.9964923140603537}-{'f1_val': 0.9958933237853395, 'auprc': 0.9916494244273599, 'loss_val': 0.031571545840008104, 'psi': 0.9941957640421476}
[S6] START round=43 head_norm_before_train=1.792920 cos_to_last_merge=0.9999 (last merge round=41)
[S6] round=43 local utility u=0.485387 metrics={'f1_val': 0.7726294082738553, 'auprc': 0.9216680687151042, 'loss_val': 0.6142376102687075, 'psi': 0.8322448724503548}-{'f1_val': 0.6898977952522956, 'auprc': 0.8116144182126177, 'loss_val': 0.7584616977164251, 'psi': 0.7385844444364245}
[S7] START round=43 head_norm_before_train=1.766197 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.964741 metrics={'f1_val': 0.8569007779125011, 'auprc': 0.9877985762527405, 'loss_val': 0.1630057175842589, 'psi': 0.9092598972485968}-{'f1_val': 0.6645957262671172, 'auprc': 0.8134763644816697, 'loss_val': 0.4156910680470151, 'psi': 0.7241479815529381}
[S8] START round=43 head_norm_before_train=1.426909 cos_to_last_merge=1.0000 (last merge round=42)
[S8] round=43 local utility u=0.078462 metrics={'f1_val': 0.9872235198288487, 'auprc': 0.9844485497279605, 'loss_val': 0.09500377797910689, 'psi': 0.9861135317884935}-{'f1_val': 0.9615236277484156, 'auprc': 0.9987376728322621, 'loss_val': 0.14059671577193067, 'psi': 0.9764092457819542}
[S9] START round=43 head_norm_before_train=1.413257 cos_to_last_merge=1.0000 (last merge round=42)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.99841499937764, 'loss_val': 0.046333459574770815, 'psi': 0.9954789549417012}-{'f1_val': 0.9966924912647621, 'auprc': 0.9928222479969133, 'loss_val': 0.04005339574174396, 'psi': 0.9951443939576227}
[S10] START round=43 head_norm_before_train=1.766197 cos_to_last_merge=1.0000 (last merge round=42)
[S10] round=43 local utility u=0.010686 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9970039787099491, 'loss_val': 0.04758920024198414, 'psi': 0.9959954638222178}-{'f1_val': 0.9951878390193748, 'auprc': 0.996266684442949, 'loss_val': 0.06593731233367478, 'psi': 0.9956193771888044}
[S11] START round=43 head_norm_before_train=1.804196 cos_to_last_merge=0.9980 (last merge round=37)
[S11] round=43 local utility u=0.007017 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9985302889102518, 'loss_val': 0.029891778159074664, 'psi': 0.997590669539847}-{'f1_val': 0.9967224195815153, 'auprc': 0.9953790619562344, 'loss_val': 0.03302108016117157, 'psi': 0.996185076531403}
[S13] START round=43 head_norm_before_train=1.402893 cos_to_last_merge=0.9885 (last merge round=35)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5585806961024762, 'auprc': 0.6999623954776129, 'loss_val': 0.8684021226253184, 'psi': 0.6151333758525308}-{'f1_val': 0.5988599965908296, 'auprc': 0.6968718118056771, 'loss_val': 0.750860060902978, 'psi': 0.6380647226767686}
[S14] START round=43 head_norm_before_train=1.611201 cos_to_last_merge=0.9940 (last merge round=37)
[S14] round=43 local utility u=0.009445 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9955975340953918, 'loss_val': 0.062293723120645815, 'psi': 0.9960593125015474}-{'f1_val': 0.9959573711480637, 'auprc': 0.9926129214540212, 'loss_val': 0.06977201372949876, 'psi': 0.9946195912704467}
[S15] START round=43 head_norm_before_train=1.460631 cos_to_last_merge=0.9961 (last merge round=40)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9253356395130724, 'auprc': 0.9966712764268533, 'loss_val': 0.11820137125489283, 'psi': 0.9538698942785848}-{'f1_val': 0.9504756623938057, 'auprc': 0.9976267955285003, 'loss_val': 0.12256981856874326, 'psi': 0.9693361156476835}
[S16] START round=43 head_norm_before_train=1.447267 cos_to_last_merge=1.0000 (last merge round=42)
[S16] round=43 local utility u=0.853161 metrics={'f1_val': 0.9905591100350157, 'auprc': 0.9919075040520914, 'loss_val': 0.07952559159947227, 'psi': 0.991098467641846}-{'f1_val': 0.8341857963504158, 'auprc': 0.9801615568632436, 'loss_val': 0.8123693391582518, 'psi': 0.8925761005555468}
[S17] START round=43 head_norm_before_train=1.434354 cos_to_last_merge=0.9996 (last merge round=41)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6034231250903738, 'auprc': 0.844809850804228, 'loss_val': 0.964868165941716, 'psi': 0.6999778153759155}-{'f1_val': 0.625881445833378, 'auprc': 0.9157653775826804, 'loss_val': 0.8295379617211405, 'psi': 0.741835018533099}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:37111
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:37112
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:37107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:37103
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:37111
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:37108
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:37116
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:37115
[S11] sending update (kind=head size=1803 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1804) from S6
[S11] cosine check vs S6: cos=0.9991
[S10] RECEIVED delta(kind=head bytes=1806) from S14
[S10] cosine check vs S14: cos=0.9502
[S6] RECEIVED delta(kind=head bytes=1803) from S11
[S6] cosine check vs S11: cos=0.9991
[S15] RECEIVED delta(kind=head bytes=1804) from S16
[S15] cosine check vs S16: cos=0.9695
[S7] RECEIVED delta(kind=head bytes=1794) from S10
[S7] cosine check vs S10: cos=0.9997
[S3] RECEIVED delta(kind=head bytes=1803) from S4
[S3] cosine check vs S4: cos=0.9802
[S16] RECEIVED delta(kind=head bytes=1799) from S8
[S16] cosine check vs S8: cos=0.9153
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1803) from S7
[S10] cosine check vs S7: cos=0.9997
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S14
[S16]  timeout peer S17
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=43 metric=0.9135 head_norm=1.640651
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.670766e-01
[S3] stored merged vector for next round verification (round=43)
[S3] DEBUG after merge:  round=43 metric=0.9339 head_norm=1.577861 delta_norm=0.167077
[S3] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=43 metric=0.9970 head_norm=1.817037
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.937389e-02
[S11] stored merged vector for next round verification (round=43)
[S11] DEBUG after merge:  round=43 metric=0.9970 head_norm=1.809513 delta_norm=0.039374
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.7726 head_norm=1.802818
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.937389e-02
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.7824 head_norm=1.809513 delta_norm=0.039374
[S6] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=43 metric=0.9253 head_norm=1.525623
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.869558e-01
[S15] stored merged vector for next round verification (round=43)
[S15] DEBUG after merge:  round=43 metric=0.9149 head_norm=1.489463 delta_norm=0.186956
[S15] aggregate: ROLLBACK (f1_val pre=0.925 post=0.915 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=43 metric=0.8569 head_norm=1.773497
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.828020e-02
[S7] stored merged vector for next round verification (round=43)
[S7] DEBUG after merge:  round=43 metric=0.8130 head_norm=1.788893 delta_norm=0.028280
[S7] aggregate: ROLLBACK (f1_val pre=0.857 post=0.813 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9906 head_norm=1.476272
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.014371e-01
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9906 head_norm=1.432169 delta_norm=0.301437
[S16] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=43 metric=0.9953 head_norm=1.804602
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.473366e-01
[S10] stored merged vector for next round verification (round=43)
[S10] DEBUG after merge:  round=43 metric=0.9953 head_norm=1.737479 delta_norm=0.147337
[S10] aggregate: ACCEPT kept=['S14', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.949543 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8291699591142071, 'auprc': 0.7635403493710196, 'loss_val': 0.40400012197283564, 'psi': 0.8029181152169321}-{'f1_val': 0.8252442184720797, 'auprc': 0.797721360122235, 'loss_val': 0.4272453587023768, 'psi': 0.8142350751321419}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=1.577861 cos_to_last_merge=1.0000 (last merge round=43)
[S3] round=44 local utility u=0.077678 metrics={'f1_val': 0.9385234791733466, 'auprc': 0.9959145485194307, 'loss_val': 0.16887838821935702, 'psi': 0.9614799069117803}-{'f1_val': 0.9135182006689342, 'auprc': 0.9982885716111929, 'loss_val': 0.1813244678978529, 'psi': 0.9474263490458377}
[S4] START round=44 head_norm_before_train=1.530812 cos_to_last_merge=0.9995 (last merge round=41)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.952115907042211, 'auprc': 0.973977669807226, 'loss_val': 0.24893036607921087, 'psi': 0.960860612148217}-{'f1_val': 0.9590364178605773, 'auprc': 0.9743028455128544, 'loss_val': 0.2378499153576323, 'psi': 0.9651429889214881}
[S5] START round=44 head_norm_before_train=1.837611 cos_to_last_merge=0.8389 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=44 local utility u=0.000729 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9975729370502223, 'loss_val': 0.030700889691164385, 'psi': 0.9965651690912926}-{'f1_val': 0.9955286699203818, 'auprc': 0.9979377802703113, 'loss_val': 0.031065931799202952, 'psi': 0.9964923140603537}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=44 head_norm_before_train=1.809513 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.617202115148503, 'auprc': 0.8337025942841092, 'loss_val': 0.9271478024377314, 'psi': 0.7038023068027455}-{'f1_val': 0.7726294082738553, 'auprc': 0.9216680687151042, 'loss_val': 0.6142376102687075, 'psi': 0.8322448724503548}
[S7] START round=44 head_norm_before_train=1.788893 cos_to_last_merge=1.0000 (last merge round=43)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.691841159032997, 'auprc': 0.8504245938946127, 'loss_val': 0.3177286583756851, 'psi': 0.7552745329776434}-{'f1_val': 0.8569007779125011, 'auprc': 0.9877985762527405, 'loss_val': 0.1630057175842589, 'psi': 0.9092598972485968}
[S8] START round=44 head_norm_before_train=1.450711 cos_to_last_merge=0.9999 (last merge round=42)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.96902029851805, 'auprc': 0.9987616871170111, 'loss_val': 0.12128648986600737, 'psi': 0.9809168539576345}-{'f1_val': 0.9872235198288487, 'auprc': 0.9844485497279605, 'loss_val': 0.09500377797910689, 'psi': 0.9861135317884935}
[S9] START round=44 head_norm_before_train=1.437784 cos_to_last_merge=0.9999 (last merge round=42)
[S9] round=44 local utility u=0.011034 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9957574737033734, 'loss_val': 0.03627822002637694, 'psi': 0.9964145407367038}-{'f1_val': 0.9935215919844088, 'auprc': 0.99841499937764, 'loss_val': 0.046333459574770815, 'psi': 0.9954789549417012}
[S10] START round=44 head_norm_before_train=1.737479 cos_to_last_merge=1.0000 (last merge round=43)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970673028812915, 'loss_val': 0.04751893272243132, 'psi': 0.9956255541581664}-{'f1_val': 0.9953231205637304, 'auprc': 0.9970039787099491, 'loss_val': 0.04758920024198414, 'psi': 0.9959954638222178}
[S11] START round=44 head_norm_before_train=1.809513 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9964825747812232, 'auprc': 0.9987380094053903, 'loss_val': 0.032439957594749436, 'psi': 0.99738474863089}-{'f1_val': 0.9969642566262439, 'auprc': 0.9985302889102518, 'loss_val': 0.029891778159074664, 'psi': 0.997590669539847}
[S13] START round=44 head_norm_before_train=1.412510 cos_to_last_merge=0.9875 (last merge round=35)
[S13] round=44 local utility u=0.153620 metrics={'f1_val': 0.588856246874698, 'auprc': 0.6994300307050483, 'loss_val': 0.7412184173586225, 'psi': 0.6330857604068381}-{'f1_val': 0.5585806961024762, 'auprc': 0.6999623954776129, 'loss_val': 0.8684021226253184, 'psi': 0.6151333758525308}
[S14] START round=44 head_norm_before_train=1.629941 cos_to_last_merge=0.9928 (last merge round=37)
[S14] round=44 local utility u=0.005637 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9964863883325807, 'loss_val': 0.059800895543227726, 'psi': 0.9970263123217812}-{'f1_val': 0.9963671647723179, 'auprc': 0.9955975340953918, 'loss_val': 0.062293723120645815, 'psi': 0.9960593125015474}
[S15] START round=44 head_norm_before_train=1.489463 cos_to_last_merge=1.0000 (last merge round=43)
[S15] round=44 local utility u=0.244745 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9986348486422172, 'loss_val': 0.06565140455481636, 'psi': 0.9977603426636589}-{'f1_val': 0.9253356395130724, 'auprc': 0.9966712764268533, 'loss_val': 0.11820137125489283, 'psi': 0.9538698942785848}
[S16] START round=44 head_norm_before_train=1.432169 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9110954439858212, 'auprc': 0.9846699421635202, 'loss_val': 0.2397126078024637, 'psi': 0.9405252432569008}-{'f1_val': 0.9905591100350157, 'auprc': 0.9919075040520914, 'loss_val': 0.07952559159947227, 'psi': 0.991098467641846}
[S17] START round=44 head_norm_before_train=1.464019 cos_to_last_merge=0.9985 (last merge round=41)
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.5792190972401582, 'auprc': 0.7880998731057236, 'loss_val': 1.0285281588503967, 'psi': 0.6627714075863844}-{'f1_val': 0.6034231250903738, 'auprc': 0.844809850804228, 'loss_val': 0.964868165941716, 'psi': 0.6999778153759155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:37110
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S4@127.0.0.1:37104
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:37116
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.9974
[S4] RECEIVED delta(kind=head bytes=1794) from S3
[S4] cosine check vs S3: cos=0.9862
[S16] RECEIVED delta(kind=head bytes=1797) from S15
[S16] cosine check vs S15: cos=0.9446
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=44 metric=0.9521 head_norm=1.541511
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.474090e-01
[S4] stored merged vector for next round verification (round=44)
[S4] DEBUG after merge:  round=44 metric=0.9509 head_norm=1.599464 delta_norm=0.147409
[S4] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:37111
[S14] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] RECEIVED delta(kind=head bytes=1803) from S14
[S10] cosine check vs S14: cos=0.9682
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=44 metric=0.9111 head_norm=1.458894
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.537436e-01
[S16] stored merged vector for next round verification (round=44)
[S16] DEBUG after merge:  round=44 metric=0.9060 head_norm=1.481457 delta_norm=0.253744
[S16] aggregate: ROLLBACK (f1_val pre=0.911 post=0.906 tol_abs=0.005 tol_rel=0.0)
[S9] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:37117
[S9] sending update (kind=head size=1802 to 1 peers)
[S16]  timeout peer S13
[S16]  timeout peer S15
[S13]  timeout peer S9
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S16
[S11]  timeout peer S6
[S14]  timeout peer S10
[S14]  timeout peer S11
[S4]  timeout peer S14
[S17]  timeout peer S8
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=44 metric=0.9969 head_norm=1.463438
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.538780e-02
[S9] stored merged vector for next round verification (round=44)
[S9] DEBUG after merge:  round=44 metric=0.9969 head_norm=1.443431 delta_norm=0.055388
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.960629 (no previous merge yet)
[S2] round=45 local utility u=0.091710 metrics={'f1_val': 0.8315668867557708, 'auprc': 0.8099415404499084, 'loss_val': 0.37416576342897484, 'psi': 0.8229167482334259}-{'f1_val': 0.8291699591142071, 'auprc': 0.7635403493710196, 'loss_val': 0.40400012197283564, 'psi': 0.8029181152169321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=45 head_norm_before_train=1.668464 cos_to_last_merge=0.9978 (last merge round=43)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8904796640141468, 'auprc': 0.9896842118437943, 'loss_val': 0.2346980457724463, 'psi': 0.9301614831460058}-{'f1_val': 0.9385234791733466, 'auprc': 0.9959145485194307, 'loss_val': 0.16887838821935702, 'psi': 0.9614799069117803}
[S4] START round=45 head_norm_before_train=1.599464 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9433241909442718, 'auprc': 0.974919276611798, 'loss_val': 0.26168414258507006, 'psi': 0.9559622252112823}-{'f1_val': 0.952115907042211, 'auprc': 0.973977669807226, 'loss_val': 0.24893036607921087, 'psi': 0.960860612148217}
[S5] START round=45 head_norm_before_train=1.848217 cos_to_last_merge=0.8382 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9936556015928102, 'loss_val': 0.031063264118584427, 'psi': 0.9949982349083277}-{'f1_val': 0.9958933237853395, 'auprc': 0.9975729370502223, 'loss_val': 0.030700889691164385, 'psi': 0.9965651690912926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.820251 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=45 local utility u=0.906437 metrics={'f1_val': 0.7884058126098116, 'auprc': 0.9476549680024007, 'loss_val': 0.4833541021485234, 'psi': 0.8521054747668473}-{'f1_val': 0.617202115148503, 'auprc': 0.8337025942841092, 'loss_val': 0.9271478024377314, 'psi': 0.7038023068027455}
[S7] START round=45 head_norm_before_train=1.794437 cos_to_last_merge=0.9999 (last merge round=43)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6035685846600505, 'auprc': 0.87015257853792, 'loss_val': 0.46528737200231196, 'psi': 0.7102021822111984}-{'f1_val': 0.691841159032997, 'auprc': 0.8504245938946127, 'loss_val': 0.3177286583756851, 'psi': 0.7552745329776434}
[S8] START round=45 head_norm_before_train=1.474978 cos_to_last_merge=0.9995 (last merge round=42)
[S8] round=45 local utility u=0.085045 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9863083277894261, 'loss_val': 0.05514194796016166, 'psi': 0.9900660987890557}-{'f1_val': 0.96902029851805, 'auprc': 0.9987616871170111, 'loss_val': 0.12128648986600737, 'psi': 0.9809168539576345}
[S9] START round=45 head_norm_before_train=1.443431 cos_to_last_merge=1.0000 (last merge round=44)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9935305614542124, 'loss_val': 0.03692130064922913, 'psi': 0.9955237758370392}-{'f1_val': 0.9968525854255906, 'auprc': 0.9957574737033734, 'loss_val': 0.03627822002637694, 'psi': 0.9964145407367038}
[S10] START round=45 head_norm_before_train=1.771821 cos_to_last_merge=0.9997 (last merge round=43)
[S10] round=45 local utility u=0.004165 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9968743049272347, 'loss_val': 0.042561546979022286, 'psi': 0.9959435943091322}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970673028812915, 'loss_val': 0.04751893272243132, 'psi': 0.9956255541581664}
[S11] START round=45 head_norm_before_train=1.821947 cos_to_last_merge=1.0000 (last merge round=43)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9945887508374047, 'loss_val': 0.0310199399405293, 'psi': 0.995620951105183}-{'f1_val': 0.9964825747812232, 'auprc': 0.9987380094053903, 'loss_val': 0.032439957594749436, 'psi': 0.99738474863089}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.425296 cos_to_last_merge=0.9861 (last merge round=35)
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5677947563711776, 'auprc': 0.7067132923295146, 'loss_val': 0.9400531698233267, 'psi': 0.6233621707545125}-{'f1_val': 0.588856246874698, 'auprc': 0.6994300307050483, 'loss_val': 0.7412184173586225, 'psi': 0.6330857604068381}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.645372 cos_to_last_merge=0.9916 (last merge round=37)
[S14] round=45 local utility u=0.002405 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.996620527714443, 'loss_val': 0.0530606552624429, 'psi': 0.9968467159803762}-{'f1_val': 0.9973862616479148, 'auprc': 0.9964863883325807, 'loss_val': 0.059800895543227726, 'psi': 0.9970263123217812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=45 head_norm_before_train=1.545907 cos_to_last_merge=0.9991 (last merge round=43)
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7615883953478505, 'auprc': 0.9902720459611603, 'loss_val': 0.32778191758094005, 'psi': 0.8530618555931744}-{'f1_val': 0.9971773386779533, 'auprc': 0.9986348486422172, 'loss_val': 0.06565140455481636, 'psi': 0.9977603426636589}
[S16] START round=45 head_norm_before_train=1.481457 cos_to_last_merge=1.0000 (last merge round=44)
[S16] round=45 local utility u=0.313583 metrics={'f1_val': 0.9889117402391991, 'auprc': 0.9876156035216256, 'loss_val': 0.08828135866325233, 'psi': 0.9883932855521698}-{'f1_val': 0.9110954439858212, 'auprc': 0.9846699421635202, 'loss_val': 0.2397126078024637, 'psi': 0.9405252432569008}
[S17] START round=45 head_norm_before_train=1.489563 cos_to_last_merge=0.9973 (last merge round=41)
[S17] round=45 local utility u=0.044245 metrics={'f1_val': 0.5865680790408571, 'auprc': 0.8277780226732893, 'loss_val': 1.1031671830361696, 'psi': 0.6830520564938299}-{'f1_val': 0.5792190972401582, 'auprc': 0.7880998731057236, 'loss_val': 1.0285281588503967, 'psi': 0.6627714075863844}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=45 metric=0.9953 head_norm=1.803424
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.351421e-01
[S10] stored merged vector for next round verification (round=45)
[S10] DEBUG after merge:  round=45 metric=0.9953 head_norm=1.710118 delta_norm=0.235142
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=46 head_norm_before_train=1.968839 (no previous merge yet)
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7751472918072784, 'auprc': 0.751223951279219, 'loss_val': 0.5869241961102608, 'psi': 0.7655779555960547}-{'f1_val': 0.8315668867557708, 'auprc': 0.8099415404499084, 'loss_val': 0.37416576342897484, 'psi': 0.8229167482334259}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=1.747161 cos_to_last_merge=0.9939 (last merge round=43)
[S3] round=46 local utility u=0.363016 metrics={'f1_val': 0.9809920769295603, 'auprc': 0.9989009276662913, 'loss_val': 0.07938968391926618, 'psi': 0.9881556172242527}-{'f1_val': 0.8904796640141468, 'auprc': 0.9896842118437943, 'loss_val': 0.2346980457724463, 'psi': 0.9301614831460058}
[S4] START round=46 head_norm_before_train=1.609040 cos_to_last_merge=1.0000 (last merge round=44)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9007371299802297, 'auprc': 0.9178643976557956, 'loss_val': 0.3658900161929672, 'psi': 0.9075880370504561}-{'f1_val': 0.9433241909442718, 'auprc': 0.974919276611798, 'loss_val': 0.26168414258507006, 'psi': 0.9559622252112823}
[S5] START round=46 head_norm_before_train=1.857797 cos_to_last_merge=0.8377 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9914315098991977, 'loss_val': 0.031431224877743226, 'psi': 0.9941967334985115}-{'f1_val': 0.9958933237853395, 'auprc': 0.9936556015928102, 'loss_val': 0.031063264118584427, 'psi': 0.9949982349083277}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.827904 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6932242373365132, 'auprc': 0.9445250216617799, 'loss_val': 0.6963519944465615, 'psi': 0.7937445510666199}-{'f1_val': 0.7884058126098116, 'auprc': 0.9476549680024007, 'loss_val': 0.4833541021485234, 'psi': 0.8521054747668473}
[S7] START round=46 head_norm_before_train=1.809287 cos_to_last_merge=0.9997 (last merge round=43)
[S7] round=46 local utility u=0.213304 metrics={'f1_val': 0.6347912667790045, 'auprc': 0.9297814260126182, 'loss_val': 0.40490188356087436, 'psi': 0.75278733047245}-{'f1_val': 0.6035685846600505, 'auprc': 0.87015257853792, 'loss_val': 0.46528737200231196, 'psi': 0.7102021822111984}
[S8] START round=46 head_norm_before_train=1.496396 cos_to_last_merge=0.9990 (last merge round=42)
[S8] round=46 local utility u=0.000291 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9856488741562268, 'loss_val': 0.05354588902356143, 'psi': 0.9898986832683073}-{'f1_val': 0.9925712794554754, 'auprc': 0.9863083277894261, 'loss_val': 0.05514194796016166, 'psi': 0.9900660987890557}
[S9] START round=46 head_norm_before_train=1.466344 cos_to_last_merge=0.9999 (last merge round=44)
[S9] round=46 local utility u=0.000483 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9939457849645108, 'loss_val': 0.034738976875543, 'psi': 0.9954436124927303}-{'f1_val': 0.9968525854255906, 'auprc': 0.9935305614542124, 'loss_val': 0.03692130064922913, 'psi': 0.9955237758370392}
[S10] START round=46 head_norm_before_train=1.710118 cos_to_last_merge=1.0000 (last merge round=45)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963711897612482, 'loss_val': 0.048969692461570374, 'psi': 0.9957423482427374}-{'f1_val': 0.9953231205637304, 'auprc': 0.9968743049272347, 'loss_val': 0.042561546979022286, 'psi': 0.9959435943091322}
[S11] START round=46 head_norm_before_train=1.834929 cos_to_last_merge=0.9999 (last merge round=43)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9028427472075851, 'auprc': 0.9949868933125023, 'loss_val': 0.3519988854786328, 'psi': 0.9397004056495519}-{'f1_val': 0.9963090846170353, 'auprc': 0.9945887508374047, 'loss_val': 0.0310199399405293, 'psi': 0.995620951105183}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.437513 cos_to_last_merge=0.9847 (last merge round=35)
[S13] round=46 local utility u=0.129261 metrics={'f1_val': 0.5868693854189316, 'auprc': 0.7035984206350041, 'loss_val': 0.7866346000530456, 'psi': 0.6335609995053606}-{'f1_val': 0.5677947563711776, 'auprc': 0.7067132923295146, 'loss_val': 0.9400531698233267, 'psi': 0.6233621707545125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=46 head_norm_before_train=1.661665 cos_to_last_merge=0.9904 (last merge round=37)
[S14] round=46 local utility u=0.002114 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9960688065262551, 'loss_val': 0.04964215293774691, 'psi': 0.9968724843115374}-{'f1_val': 0.9969975081576651, 'auprc': 0.996620527714443, 'loss_val': 0.0530606552624429, 'psi': 0.9968467159803762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=46 head_norm_before_train=1.597457 cos_to_last_merge=0.9973 (last merge round=43)
[S15] round=46 local utility u=0.853438 metrics={'f1_val': 0.9967630768980411, 'auprc': 0.9977148576146742, 'loss_val': 0.054282677607831946, 'psi': 0.9971437891846944}-{'f1_val': 0.7615883953478505, 'auprc': 0.9902720459611603, 'loss_val': 0.32778191758094005, 'psi': 0.8530618555931744}
[S16] START round=46 head_norm_before_train=1.507764 cos_to_last_merge=0.9998 (last merge round=44)
[S16] round=46 local utility u=0.017026 metrics={'f1_val': 0.9905357997058295, 'auprc': 0.9894798876867041, 'loss_val': 0.06956651680732676, 'psi': 0.9901134348981794}-{'f1_val': 0.9889117402391991, 'auprc': 0.9876156035216256, 'loss_val': 0.08828135866325233, 'psi': 0.9883932855521698}
[S17] START round=46 head_norm_before_train=1.514946 cos_to_last_merge=0.9959 (last merge round=41)
[S17] round=46 local utility u=0.069089 metrics={'f1_val': 0.6032848859991766, 'auprc': 0.8232495567401167, 'loss_val': 1.051704679424686, 'psi': 0.6912707542955526}-{'f1_val': 0.5865680790408571, 'auprc': 0.8277780226732893, 'loss_val': 1.1031671830361696, 'psi': 0.6830520564938299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=1.978604 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7695423824555996, 'auprc': 0.7603454827727598, 'loss_val': 0.6076523908338295, 'psi': 0.7658636225824637}-{'f1_val': 0.7751472918072784, 'auprc': 0.751223951279219, 'loss_val': 0.5869241961102608, 'psi': 0.7655779555960547}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=1.809015 cos_to_last_merge=0.9902 (last merge round=43)
[S3] round=47 local utility u=0.055210 metrics={'f1_val': 0.9919952467380473, 'auprc': 0.9992706514677918, 'loss_val': 0.036097419030416175, 'psi': 0.994905408629945}-{'f1_val': 0.9809920769295603, 'auprc': 0.9989009276662913, 'loss_val': 0.07938968391926618, 'psi': 0.9881556172242527}
[S4] START round=47 head_norm_before_train=1.619301 cos_to_last_merge=0.9999 (last merge round=44)
[S4] round=47 local utility u=0.261989 metrics={'f1_val': 0.942778484872641, 'auprc': 0.9758170342417046, 'loss_val': 0.2680172006372978, 'psi': 0.9559939046202665}-{'f1_val': 0.9007371299802297, 'auprc': 0.9178643976557956, 'loss_val': 0.3658900161929672, 'psi': 0.9075880370504561}
[S5] START round=47 head_norm_before_train=1.857040 cos_to_last_merge=0.8377 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=47 local utility u=0.000319 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9914498498246139, 'loss_val': 0.030847736590866332, 'psi': 0.994204069468678}-{'f1_val': 0.9960402158980539, 'auprc': 0.9914315098991977, 'loss_val': 0.031431224877743226, 'psi': 0.9941967334985115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=47 head_norm_before_train=1.834658 cos_to_last_merge=0.9997 (last merge round=43)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6499700459073987, 'auprc': 0.9199791593676565, 'loss_val': 0.8611738687526882, 'psi': 0.7579736912915018}-{'f1_val': 0.6932242373365132, 'auprc': 0.9445250216617799, 'loss_val': 0.6963519944465615, 'psi': 0.7937445510666199}
[S7] START round=47 head_norm_before_train=1.827264 cos_to_last_merge=0.9994 (last merge round=43)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6386532981387294, 'auprc': 0.8062163270128035, 'loss_val': 0.5526114821000974, 'psi': 0.7056785096883591}-{'f1_val': 0.6347912667790045, 'auprc': 0.9297814260126182, 'loss_val': 0.40490188356087436, 'psi': 0.75278733047245}
[S8] START round=47 head_norm_before_train=1.518531 cos_to_last_merge=0.9983 (last merge round=42)
[S8] round=47 local utility u=0.004218 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9871133768177567, 'loss_val': 0.04853905761081902, 'psi': 0.9903881184003879}-{'f1_val': 0.9927318893430277, 'auprc': 0.9856488741562268, 'loss_val': 0.05354588902356143, 'psi': 0.9898986832683073}
[S9] START round=47 head_norm_before_train=1.488626 cos_to_last_merge=0.9997 (last merge round=44)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9984242825638437, 'loss_val': 0.05742178166934705, 'psi': 0.9921869177016989}-{'f1_val': 0.99644216417821, 'auprc': 0.9939457849645108, 'loss_val': 0.034738976875543, 'psi': 0.9954436124927303}
[S10] START round=47 head_norm_before_train=1.740777 cos_to_last_merge=0.9998 (last merge round=45)
[S10] round=47 local utility u=0.001351 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9956345897668839, 'loss_val': 0.04405837292384169, 'psi': 0.9954477082449917}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963711897612482, 'loss_val': 0.048969692461570374, 'psi': 0.9957423482427374}
[S11] START round=47 head_norm_before_train=1.846527 cos_to_last_merge=0.9998 (last merge round=43)
[S11] round=47 local utility u=0.441713 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9948296897347357, 'loss_val': 0.028899885438921608, 'psi': 0.9957173266641155}-{'f1_val': 0.9028427472075851, 'auprc': 0.9949868933125023, 'loss_val': 0.3519988854786328, 'psi': 0.9397004056495519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=47 head_norm_before_train=1.447076 cos_to_last_merge=0.9836 (last merge round=35)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.5871169359548766, 'auprc': 0.7120733104583832, 'loss_val': 0.9005638851097418, 'psi': 0.6370994857562793}-{'f1_val': 0.5868693854189316, 'auprc': 0.7035984206350041, 'loss_val': 0.7866346000530456, 'psi': 0.6335609995053606}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.678633 cos_to_last_merge=0.9891 (last merge round=37)
[S14] round=47 local utility u=0.001807 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9968408824777841, 'loss_val': 0.04834472497542904, 'psi': 0.997181314692149}-{'f1_val': 0.9974082695017256, 'auprc': 0.9960688065262551, 'loss_val': 0.04964215293774691, 'psi': 0.9968724843115374}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=47 head_norm_before_train=1.645072 cos_to_last_merge=0.9950 (last merge round=43)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9817155965006134, 'auprc': 0.9982228234175946, 'loss_val': 0.05963439198808154, 'psi': 0.9883184872674059}-{'f1_val': 0.9967630768980411, 'auprc': 0.9977148576146742, 'loss_val': 0.054282677607831946, 'psi': 0.9971437891846944}
[S16] START round=47 head_norm_before_train=1.529997 cos_to_last_merge=0.9992 (last merge round=44)
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.8565319422466767, 'auprc': 0.9880089799609916, 'loss_val': 0.7649183937437706, 'psi': 0.9091227573324026}-{'f1_val': 0.9905357997058295, 'auprc': 0.9894798876867041, 'loss_val': 0.06956651680732676, 'psi': 0.9901134348981794}
[S17] START round=47 head_norm_before_train=1.537059 cos_to_last_merge=0.9945 (last merge round=41)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.561982474062684, 'auprc': 0.7458063513204211, 'loss_val': 1.2506679162069516, 'psi': 0.6355120249657789}-{'f1_val': 0.6032848859991766, 'auprc': 0.8232495567401167, 'loss_val': 1.051704679424686, 'psi': 0.6912707542955526}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.990)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] START round=48 head_norm_before_train=1.989336 (no previous merge yet)
[S2] round=48 local utility u=0.303362 metrics={'f1_val': 0.8291723570884095, 'auprc': 0.7800167884418152, 'loss_val': 0.4177231116156221, 'psi': 0.8095101296297718}-{'f1_val': 0.7695423824555996, 'auprc': 0.7603454827727598, 'loss_val': 0.6076523908338295, 'psi': 0.7658636225824637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=48 head_norm_before_train=1.853769 cos_to_last_merge=0.9875 (last merge round=43)
[S3] round=48 local utility u=0.012996 metrics={'f1_val': 0.9944816393083035, 'auprc': 0.9993699962873865, 'loss_val': 0.025322168024170665, 'psi': 0.9964369820999366}-{'f1_val': 0.9919952467380473, 'auprc': 0.9992706514677918, 'loss_val': 0.036097419030416175, 'psi': 0.994905408629945}
[S4] START round=48 head_norm_before_train=1.631122 cos_to_last_merge=0.9998 (last merge round=44)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9425863981968453, 'auprc': 0.9687756704854726, 'loss_val': 0.2739358684305317, 'psi': 0.9530621071122962}-{'f1_val': 0.942778484872641, 'auprc': 0.9758170342417046, 'loss_val': 0.2680172006372978, 'psi': 0.9559939046202665}
[S5] START round=48 head_norm_before_train=1.862176 cos_to_last_merge=0.8372 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=48 local utility u=0.003393 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9940087121120593, 'loss_val': 0.030856268598926654, 'psi': 0.9951394791160274}-{'f1_val': 0.9960402158980539, 'auprc': 0.9914498498246139, 'loss_val': 0.030847736590866332, 'psi': 0.994204069468678}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=48 head_norm_before_train=1.842623 cos_to_last_merge=0.9996 (last merge round=43)
[S6] round=48 local utility u=0.740774 metrics={'f1_val': 0.8193611731142288, 'auprc': 0.9414366333996749, 'loss_val': 0.46034470434614355, 'psi': 0.8681913572284072}-{'f1_val': 0.6499700459073987, 'auprc': 0.9199791593676565, 'loss_val': 0.8611738687526882, 'psi': 0.7579736912915018}
[S7] START round=48 head_norm_before_train=1.845698 cos_to_last_merge=0.9990 (last merge round=43)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5963221898980067, 'auprc': 0.7954653978090832, 'loss_val': 0.7259510589424573, 'psi': 0.6759794730624373}-{'f1_val': 0.6386532981387294, 'auprc': 0.8062163270128035, 'loss_val': 0.5526114821000974, 'psi': 0.7056785096883591}
[S8] START round=48 head_norm_before_train=1.539346 cos_to_last_merge=0.9976 (last merge round=42)
[S8] round=48 local utility u=0.015474 metrics={'f1_val': 0.9925803045490724, 'auprc': 0.9967680897199942, 'loss_val': 0.04660944628653422, 'psi': 0.9942554186174412}-{'f1_val': 0.9925712794554754, 'auprc': 0.9871133768177567, 'loss_val': 0.04853905761081902, 'psi': 0.9903881184003879}
[S9] START round=48 head_norm_before_train=1.506467 cos_to_last_merge=0.9994 (last merge round=44)
[S9] round=48 local utility u=0.037199 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.99600604824342, 'loss_val': 0.03021515296253731, 'psi': 0.9966641668046536}-{'f1_val': 0.9880286744602689, 'auprc': 0.9984242825638437, 'loss_val': 0.05742178166934705, 'psi': 0.9921869177016989}
[S10] START round=48 head_norm_before_train=1.769755 cos_to_last_merge=0.9993 (last merge round=45)
[S10] round=48 local utility u=0.001203 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9968202077429206, 'loss_val': 0.03994033296163386, 'psi': 0.9953950594149623}-{'f1_val': 0.9953231205637304, 'auprc': 0.9956345897668839, 'loss_val': 0.04405837292384169, 'psi': 0.9954477082449917}
[S11] START round=48 head_norm_before_train=1.856325 cos_to_last_merge=0.9997 (last merge round=43)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9881349243467107, 'auprc': 0.9982408236649606, 'loss_val': 0.06722111253502837, 'psi': 0.9921772840740106}-{'f1_val': 0.9963090846170353, 'auprc': 0.9948296897347357, 'loss_val': 0.028899885438921608, 'psi': 0.9957173266641155}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.460741 cos_to_last_merge=0.9820 (last merge round=35)
[S13] round=48 local utility u=0.078607 metrics={'f1_val': 0.588140877542211, 'auprc': 0.7145055433610797, 'loss_val': 0.7567903073341684, 'psi': 0.6386867438697585}-{'f1_val': 0.5871169359548766, 'auprc': 0.7120733104583832, 'loss_val': 0.9005638851097418, 'psi': 0.6370994857562793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=48 head_norm_before_train=1.692649 cos_to_last_merge=0.9879 (last merge round=37)
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9963982768902052, 'auprc': 0.9965103550945832, 'loss_val': 0.043801847033312524, 'psi': 0.9964431081719565}-{'f1_val': 0.9974082695017256, 'auprc': 0.9968408824777841, 'loss_val': 0.04834472497542904, 'psi': 0.997181314692149}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.685798 cos_to_last_merge=0.9928 (last merge round=43)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.790136942441974, 'auprc': 0.9945569385791971, 'loss_val': 0.2836267273759625, 'psi': 0.8719049408968632}-{'f1_val': 0.9817155965006134, 'auprc': 0.9982228234175946, 'loss_val': 0.05963439198808154, 'psi': 0.9883184872674059}
[S16] START round=48 head_norm_before_train=1.550029 cos_to_last_merge=0.9986 (last merge round=44)
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8410484473467309, 'auprc': 0.9885321825148015, 'loss_val': 0.879268200970534, 'psi': 0.9000419414139591}-{'f1_val': 0.8565319422466767, 'auprc': 0.9880089799609916, 'loss_val': 0.7649183937437706, 'psi': 0.9091227573324026}
[S17] START round=48 head_norm_before_train=1.556088 cos_to_last_merge=0.9932 (last merge round=41)
[S17] round=48 local utility u=0.303221 metrics={'f1_val': 0.5980580859627261, 'auprc': 0.7824491865120679, 'loss_val': 0.9706081519443819, 'psi': 0.6718145261824628}-{'f1_val': 0.561982474062684, 'auprc': 0.7458063513204211, 'loss_val': 1.2506679162069516, 'psi': 0.6355120249657789}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] START round=49 head_norm_before_train=2.002012 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.8291608810512405, 'auprc': 0.7686757951048913, 'loss_val': 0.4460662220021414, 'psi': 0.8049668466727008}-{'f1_val': 0.8291723570884095, 'auprc': 0.7800167884418152, 'loss_val': 0.4177231116156221, 'psi': 0.8095101296297718}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=1.890122 cos_to_last_merge=0.9852 (last merge round=43)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9395380277244343, 'auprc': 0.9746624311764276, 'loss_val': 0.20858232993725914, 'psi': 0.9535877891052316}-{'f1_val': 0.9944816393083035, 'auprc': 0.9993699962873865, 'loss_val': 0.025322168024170665, 'psi': 0.9964369820999366}
[S4] START round=49 head_norm_before_train=1.645229 cos_to_last_merge=0.9997 (last merge round=44)
[S4] round=49 local utility u=0.008702 metrics={'f1_val': 0.9436056668938527, 'auprc': 0.9714483639010554, 'loss_val': 0.27066517066501006, 'psi': 0.9547427456967338}-{'f1_val': 0.9425863981968453, 'auprc': 0.9687756704854726, 'loss_val': 0.2739358684305317, 'psi': 0.9530621071122962}
[S5] START round=49 head_norm_before_train=1.871950 cos_to_last_merge=0.8364 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.991460255759028, 'loss_val': 0.02976294335366786, 'psi': 0.9942957162891978}-{'f1_val': 0.9958933237853395, 'auprc': 0.9940087121120593, 'loss_val': 0.030856268598926654, 'psi': 0.9951394791160274}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.850647 cos_to_last_merge=0.9996 (last merge round=43)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.564380518156054, 'auprc': 0.6744499920567455, 'loss_val': 1.1993257265860358, 'psi': 0.6084083077163306}-{'f1_val': 0.8193611731142288, 'auprc': 0.9414366333996749, 'loss_val': 0.46034470434614355, 'psi': 0.8681913572284072}
[S7] START round=49 head_norm_before_train=1.854933 cos_to_last_merge=0.9987 (last merge round=43)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.5682522281897351, 'auprc': 0.8168707243949205, 'loss_val': 0.6951710656591756, 'psi': 0.6676996266718093}-{'f1_val': 0.5963221898980067, 'auprc': 0.7954653978090832, 'loss_val': 0.7259510589424573, 'psi': 0.6759794730624373}
[S8] START round=49 head_norm_before_train=1.560659 cos_to_last_merge=0.9968 (last merge round=42)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9961076766325518, 'loss_val': 0.04419687513722941, 'psi': 0.9937672266117055}-{'f1_val': 0.9925803045490724, 'auprc': 0.9967680897199942, 'loss_val': 0.04660944628653422, 'psi': 0.9942554186174412}
[S9] START round=49 head_norm_before_train=1.522463 cos_to_last_merge=0.9990 (last merge round=44)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.99612421486021, 'loss_val': 0.029262516861938464, 'psi': 0.9965612371994383}-{'f1_val': 0.9971029125121428, 'auprc': 0.99600604824342, 'loss_val': 0.03021515296253731, 'psi': 0.9966641668046536}
[S10] START round=49 head_norm_before_train=1.797085 cos_to_last_merge=0.9985 (last merge round=45)
[S10] round=49 local utility u=0.002061 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955238184969277, 'loss_val': 0.03719758051672472, 'psi': 0.9954033997370093}-{'f1_val': 0.9944449605296568, 'auprc': 0.9968202077429206, 'loss_val': 0.03994033296163386, 'psi': 0.9953950594149623}
[S11] START round=49 head_norm_before_train=1.864536 cos_to_last_merge=0.9995 (last merge round=43)
[S11] round=49 local utility u=0.041937 metrics={'f1_val': 0.9967224195815153, 'auprc': 0.9952944153442977, 'loss_val': 0.02603219014552847, 'psi': 0.9961512178866283}-{'f1_val': 0.9881349243467107, 'auprc': 0.9982408236649606, 'loss_val': 0.06722111253502837, 'psi': 0.9921772840740106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=49 head_norm_before_train=1.473285 cos_to_last_merge=0.9806 (last merge round=35)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.5547970043504695, 'auprc': 0.7219975519214056, 'loss_val': 1.0463227627819487, 'psi': 0.6216772233788439}-{'f1_val': 0.588140877542211, 'auprc': 0.7145055433610797, 'loss_val': 0.7567903073341684, 'psi': 0.6386867438697585}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.705279 cos_to_last_merge=0.9869 (last merge round=37)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9755261041294792, 'auprc': 0.991425478793258, 'loss_val': 0.07470004783924838, 'psi': 0.9818858539949907}-{'f1_val': 0.9963982768902052, 'auprc': 0.9965103550945832, 'loss_val': 0.043801847033312524, 'psi': 0.9964431081719565}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.715914 cos_to_last_merge=0.9910 (last merge round=43)
[S15] round=49 local utility u=0.756108 metrics={'f1_val': 0.9975479273409924, 'auprc': 0.9990615100622275, 'loss_val': 0.029389860612154584, 'psi': 0.9981533604294865}-{'f1_val': 0.790136942441974, 'auprc': 0.9945569385791971, 'loss_val': 0.2836267273759625, 'psi': 0.8719049408968632}
[S16] START round=49 head_norm_before_train=1.568050 cos_to_last_merge=0.9980 (last merge round=44)
[S16] round=49 local utility u=0.636512 metrics={'f1_val': 0.9452876687657976, 'auprc': 0.9923176374538771, 'loss_val': 0.24303533189394744, 'psi': 0.9640996562410294}-{'f1_val': 0.8410484473467309, 'auprc': 0.9885321825148015, 'loss_val': 0.879268200970534, 'psi': 0.9000419414139591}
[S17] START round=49 head_norm_before_train=1.570448 cos_to_last_merge=0.9922 (last merge round=41)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5697429746114542, 'auprc': 0.7604859163856238, 'loss_val': 1.2199213802558486, 'psi': 0.646040151321122}-{'f1_val': 0.5980580859627261, 'auprc': 0.7824491865120679, 'loss_val': 0.9706081519443819, 'psi': 0.6718145261824628}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S8]  timeout peer S17
[S16]  timeout peer S8
[S15]  timeout peer S16
[S4]  timeout peer S3
[S9]  timeout peer S13
[S17]  timeout peer S9
[S10]  timeout peer S7
[S10]  timeout peer S14
[S7]  timeout peer S10
[S6]  timeout peer S11
[S3]  timeout peer S4
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S2] START round=50 head_norm_before_train=2.015104 (no previous merge yet)
[S2] round=50 local utility u=0.097602 metrics={'f1_val': 0.8322595253649474, 'auprc': 0.8123394665832212, 'loss_val': 0.4004446686734227, 'psi': 0.824291501852257}-{'f1_val': 0.8291608810512405, 'auprc': 0.7686757951048913, 'loss_val': 0.4460662220021414, 'psi': 0.8049668466727008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=50 head_norm_before_train=1.915763 cos_to_last_merge=0.9833 (last merge round=43)
[S3] round=50 local utility u=0.118256 metrics={'f1_val': 0.9502536532237242, 'auprc': 0.9983996975962721, 'loss_val': 0.10757671204888225, 'psi': 0.9695120709727434}-{'f1_val': 0.9395380277244343, 'auprc': 0.9746624311764276, 'loss_val': 0.20858232993725914, 'psi': 0.9535877891052316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=50 head_norm_before_train=1.659024 cos_to_last_merge=0.9995 (last merge round=44)
[S4] round=50 local utility u=0.055915 metrics={'f1_val': 0.9533836586809519, 'auprc': 0.9825260261538175, 'loss_val': 0.2507360898713146, 'psi': 0.9650406056700982}-{'f1_val': 0.9436056668938527, 'auprc': 0.9714483639010554, 'loss_val': 0.27066517066501006, 'psi': 0.9547427456967338}
[S4] not sending this round → trigger blocked (psi=0.965)
[S5] START round=50 head_norm_before_train=1.875950 cos_to_last_merge=0.8358 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9913560743440576, 'loss_val': 0.030887711003491806, 'psi': 0.9942540437232097}-{'f1_val': 0.996186023309311, 'auprc': 0.991460255759028, 'loss_val': 0.02976294335366786, 'psi': 0.9942957162891978}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=1.859112 cos_to_last_merge=0.9995 (last merge round=43)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.7382710446150261, 'auprc': 0.909732573357503, 'loss_val': 0.7825932480699233, 'psi': 0.8068556561120168}-{'f1_val': 0.564380518156054, 'auprc': 0.6744499920567455, 'loss_val': 1.1993257265860358, 'psi': 0.6084083077163306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=50 head_norm_before_train=1.863406 cos_to_last_merge=0.9981 (last merge round=43)
[S7] round=50 local utility u=0.438108 metrics={'f1_val': 0.6296116681107422, 'auprc': 0.9323114958412851, 'loss_val': 0.5334333362230871, 'psi': 0.7506915992029595}-{'f1_val': 0.5682522281897351, 'auprc': 0.8168707243949205, 'loss_val': 0.6951710656591756, 'psi': 0.6676996266718093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=50 head_norm_before_train=1.580239 cos_to_last_merge=0.9960 (last merge round=42)
[S8] round=50 local utility u=0.002216 metrics={'f1_val': 0.9920973070316986, 'auprc': 0.9979262300589309, 'loss_val': 0.04456219072324462, 'psi': 0.9944288762425915}-{'f1_val': 0.9922069265978078, 'auprc': 0.9961076766325518, 'loss_val': 0.04419687513722941, 'psi': 0.9937672266117055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=50 head_norm_before_train=1.539109 cos_to_last_merge=0.9986 (last merge round=44)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9957807724006038, 'loss_val': 0.028300189246826462, 'psi': 0.9964238602155959}-{'f1_val': 0.9968525854255906, 'auprc': 0.99612421486021, 'loss_val': 0.029262516861938464, 'psi': 0.9965612371994383}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=1.822728 cos_to_last_merge=0.9977 (last merge round=45)
[S10] round=50 local utility u=0.000101 metrics={'f1_val': 0.9944204775781598, 'auprc': 0.9969708295917744, 'loss_val': 0.03592136762511239, 'psi': 0.9954406183836056}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955238184969277, 'loss_val': 0.03719758051672472, 'psi': 0.9954033997370093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=50 head_norm_before_train=1.871908 cos_to_last_merge=0.9994 (last merge round=43)
[S11] round=50 local utility u=0.001468 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9953625221859469, 'loss_val': 0.02475235070831003, 'psi': 0.996323562850125}-{'f1_val': 0.9967224195815153, 'auprc': 0.9952944153442977, 'loss_val': 0.02603219014552847, 'psi': 0.9961512178866283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=50 head_norm_before_train=1.484158 cos_to_last_merge=0.9794 (last merge round=35)
[S13] round=50 local utility u=0.177209 metrics={'f1_val': 0.5872840859189781, 'auprc': 0.7201817829902939, 'loss_val': 0.8813808354856889, 'psi': 0.6404431647475044}-{'f1_val': 0.5547970043504695, 'auprc': 0.7219975519214056, 'loss_val': 1.0463227627819487, 'psi': 0.6216772233788439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=50 head_norm_before_train=1.715722 cos_to_last_merge=0.9861 (last merge round=37)
[S14] round=50 local utility u=0.087989 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.996823136579557, 'loss_val': 0.04128109555080241, 'psi': 0.996681593598273}-{'f1_val': 0.9755261041294792, 'auprc': 0.991425478793258, 'loss_val': 0.07470004783924838, 'psi': 0.9818858539949907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=50 head_norm_before_train=1.740632 cos_to_last_merge=0.9895 (last merge round=43)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.8406539766805756, 'auprc': 0.9957412116733334, 'loss_val': 0.2729390190632731, 'psi': 0.9026888706776788}-{'f1_val': 0.9975479273409924, 'auprc': 0.9990615100622275, 'loss_val': 0.029389860612154584, 'psi': 0.9981533604294865}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.583606 cos_to_last_merge=0.9974 (last merge round=44)
[S16] round=50 local utility u=0.237253 metrics={'f1_val': 0.9914114887688589, 'auprc': 0.9950354283176011, 'loss_val': 0.053425641390321764, 'psi': 0.9928610645883558}-{'f1_val': 0.9452876687657976, 'auprc': 0.9923176374538771, 'loss_val': 0.24303533189394744, 'psi': 0.9640996562410294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=50 head_norm_before_train=1.578655 cos_to_last_merge=0.9916 (last merge round=41)
[S17] round=50 local utility u=0.035896 metrics={'f1_val': 0.574421970592448, 'auprc': 0.7684860560973799, 'loss_val': 1.2002037538661936, 'psi': 0.6520476047944208}-{'f1_val': 0.5697429746114542, 'auprc': 0.7604859163856238, 'loss_val': 1.2199213802558486, 'psi': 0.646040151321122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=51 head_norm_before_train=2.025507 (no previous merge yet)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.8260253512625141, 'auprc': 0.805908548368964, 'loss_val': 0.46144151033406783, 'psi': 0.817978630105094}-{'f1_val': 0.8322595253649474, 'auprc': 0.8123394665832212, 'loss_val': 0.4004446686734227, 'psi': 0.824291501852257}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=1.939347 cos_to_last_merge=0.9817 (last merge round=43)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.8987488375993044, 'auprc': 0.9534279393966478, 'loss_val': 0.3272051420715962, 'psi': 0.9206204783182417}-{'f1_val': 0.9502536532237242, 'auprc': 0.9983996975962721, 'loss_val': 0.10757671204888225, 'psi': 0.9695120709727434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.667614 cos_to_last_merge=0.9993 (last merge round=44)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9492033296375821, 'auprc': 0.9804767823524289, 'loss_val': 0.261226326855344, 'psi': 0.9617127107235208}-{'f1_val': 0.9533836586809519, 'auprc': 0.9825260261538175, 'loss_val': 0.2507360898713146, 'psi': 0.9650406056700982}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.878926 cos_to_last_merge=0.8356 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9913597141602106, 'loss_val': 0.031202961545260335, 'psi': 0.9941680152029166}-{'f1_val': 0.996186023309311, 'auprc': 0.9913560743440576, 'loss_val': 0.030887711003491806, 'psi': 0.9942540437232097}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.869782 cos_to_last_merge=0.9994 (last merge round=43)
[S6] round=51 local utility u=1.000000 metrics={'f1_val': 0.9610347122390057, 'auprc': 0.9778697447780222, 'loss_val': 0.13519428214094503, 'psi': 0.9677687252546123}-{'f1_val': 0.7382710446150261, 'auprc': 0.909732573357503, 'loss_val': 0.7825932480699233, 'psi': 0.8068556561120168}
[S6] not sending this round → trigger blocked (psi=0.968)
[S7] START round=51 head_norm_before_train=1.875660 cos_to_last_merge=0.9976 (last merge round=43)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.545067369749946, 'auprc': 0.7848576477459848, 'loss_val': 0.9981007747313634, 'psi': 0.6409834809483614}-{'f1_val': 0.6296116681107422, 'auprc': 0.9323114958412851, 'loss_val': 0.5334333362230871, 'psi': 0.7506915992029595}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.596308 cos_to_last_merge=0.9953 (last merge round=42)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9934815081849845, 'auprc': 0.9859162166246253, 'loss_val': 0.040973725995088625, 'psi': 0.9904553915608407}-{'f1_val': 0.9920973070316986, 'auprc': 0.9979262300589309, 'loss_val': 0.04456219072324462, 'psi': 0.9944288762425915}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.554577 cos_to_last_merge=0.9982 (last merge round=44)
[S9] round=51 local utility u=0.003398 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.997753205132954, 'loss_val': 0.0274212001959932, 'psi': 0.9972128333085359}-{'f1_val': 0.9968525854255906, 'auprc': 0.9957807724006038, 'loss_val': 0.028300189246826462, 'psi': 0.9964238602155959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=51 head_norm_before_train=1.846046 cos_to_last_merge=0.9969 (last merge round=45)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937158296263349, 'loss_val': 0.03439033380604921, 'psi': 0.9945990352621588}-{'f1_val': 0.9944204775781598, 'auprc': 0.9969708295917744, 'loss_val': 0.03592136762511239, 'psi': 0.9954406183836056}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=1.879608 cos_to_last_merge=0.9993 (last merge round=43)
[S11] round=51 local utility u=0.004744 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9981522993763844, 'loss_val': 0.023634170299280124, 'psi': 0.9974394737263}-{'f1_val': 0.9969642566262439, 'auprc': 0.9953625221859469, 'loss_val': 0.02475235070831003, 'psi': 0.996323562850125}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=51 head_norm_before_train=1.491999 cos_to_last_merge=0.9785 (last merge round=35)
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.5834543268920128, 'auprc': 0.7212209159063099, 'loss_val': 0.8689000710961914, 'psi': 0.6385609624977316}-{'f1_val': 0.5872840859189781, 'auprc': 0.7201817829902939, 'loss_val': 0.8813808354856889, 'psi': 0.6404431647475044}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.726505 cos_to_last_merge=0.9853 (last merge round=37)
[S14] round=51 local utility u=0.004769 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985337342072667, 'loss_val': 0.039204092436976326, 'psi': 0.9975987937331725}-{'f1_val': 0.9965872316107504, 'auprc': 0.996823136579557, 'loss_val': 0.04128109555080241, 'psi': 0.996681593598273}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=51 head_norm_before_train=1.760690 cos_to_last_merge=0.9883 (last merge round=43)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.701196517572327, 'auprc': 0.9462336667573163, 'loss_val': 0.5136580355866159, 'psi': 0.7992113772463227}-{'f1_val': 0.8406539766805756, 'auprc': 0.9957412116733334, 'loss_val': 0.2729390190632731, 'psi': 0.9026888706776788}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.598921 cos_to_last_merge=0.9968 (last merge round=44)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.9911445912637655, 'auprc': 0.9918061184742399, 'loss_val': 0.05173883282588931, 'psi': 0.9914092021479552}-{'f1_val': 0.9914114887688589, 'auprc': 0.9950354283176011, 'loss_val': 0.053425641390321764, 'psi': 0.9928610645883558}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.587109 cos_to_last_merge=0.9910 (last merge round=41)
[S17] round=51 local utility u=0.234463 metrics={'f1_val': 0.6143671591022741, 'auprc': 0.8221669941327464, 'loss_val': 1.131991524337742, 'psi': 0.697487093114463}-{'f1_val': 0.574421970592448, 'auprc': 0.7684860560973799, 'loss_val': 1.2002037538661936, 'psi': 0.6520476047944208}
[S17] not sending this round → trigger blocked (psi=0.697)
[S2] START round=52 head_norm_before_train=2.034760 (no previous merge yet)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.5775170691339545, 'auprc': 0.7610958575580857, 'loss_val': 1.1401096842126566, 'psi': 0.6509485845036069}-{'f1_val': 0.8260253512625141, 'auprc': 0.805908548368964, 'loss_val': 0.46144151033406783, 'psi': 0.817978630105094}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.958513 cos_to_last_merge=0.9806 (last merge round=43)
[S3] round=52 local utility u=0.325964 metrics={'f1_val': 0.9481665360957752, 'auprc': 0.9982572534482563, 'loss_val': 0.10627060541105968, 'psi': 0.9682028230367676}-{'f1_val': 0.8987488375993044, 'auprc': 0.9534279393966478, 'loss_val': 0.3272051420715962, 'psi': 0.9206204783182417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=52 head_norm_before_train=1.672597 cos_to_last_merge=0.9991 (last merge round=44)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9399351428668401, 'auprc': 0.9651983673564337, 'loss_val': 0.29232023078538366, 'psi': 0.9500404326626776}-{'f1_val': 0.9492033296375821, 'auprc': 0.9804767823524289, 'loss_val': 0.261226326855344, 'psi': 0.9617127107235208}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.885514 cos_to_last_merge=0.8352 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9907760475967357, 'loss_val': 0.03123091693625622, 'psi': 0.9939345485775266}-{'f1_val': 0.9960402158980539, 'auprc': 0.9913597141602106, 'loss_val': 0.031202961545260335, 'psi': 0.9941680152029166}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.876574 cos_to_last_merge=0.9994 (last merge round=43)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.8219774705382177, 'auprc': 0.9527630806284098, 'loss_val': 0.48547115922262046, 'psi': 0.8742917145742946}-{'f1_val': 0.9610347122390057, 'auprc': 0.9778697447780222, 'loss_val': 0.13519428214094503, 'psi': 0.9677687252546123}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.887945 cos_to_last_merge=0.9971 (last merge round=43)
[S7] round=52 local utility u=0.742594 metrics={'f1_val': 0.6417901625969553, 'auprc': 0.9463633624547774, 'loss_val': 0.5777671283021072, 'psi': 0.7636194425400842}-{'f1_val': 0.545067369749946, 'auprc': 0.7848576477459848, 'loss_val': 0.9981007747313634, 'psi': 0.6409834809483614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=52 head_norm_before_train=1.610629 cos_to_last_merge=0.9946 (last merge round=42)
[S8] round=52 local utility u=0.009048 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9928481853655747, 'loss_val': 0.039929702628315286, 'psi': 0.9928538455160576}-{'f1_val': 0.9934815081849845, 'auprc': 0.9859162166246253, 'loss_val': 0.040973725995088625, 'psi': 0.9904553915608407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=52 head_norm_before_train=1.570154 cos_to_last_merge=0.9978 (last merge round=44)
[S9] round=52 local utility u=0.000981 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9980591451696903, 'loss_val': 0.026376436668325662, 'psi': 0.9973352093232304}-{'f1_val': 0.9968525854255906, 'auprc': 0.997753205132954, 'loss_val': 0.0274212001959932, 'psi': 0.9972128333085359}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=52 head_norm_before_train=1.863828 cos_to_last_merge=0.9962 (last merge round=45)
[S10] round=52 local utility u=0.002046 metrics={'f1_val': 0.9942256070413027, 'auprc': 0.9965834488472085, 'loss_val': 0.03312818998154633, 'psi': 0.995168743763665}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937158296263349, 'loss_val': 0.03439033380604921, 'psi': 0.9945990352621588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=52 head_norm_before_train=1.889456 cos_to_last_merge=0.9991 (last merge round=43)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9952021578831611, 'loss_val': 0.023228174113856862, 'psi': 0.9962594171290107}-{'f1_val': 0.9969642566262439, 'auprc': 0.9981522993763844, 'loss_val': 0.023634170299280124, 'psi': 0.9974394737263}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.499311 cos_to_last_merge=0.9776 (last merge round=35)
[S13] round=52 local utility u=0.169066 metrics={'f1_val': 0.6149992468116818, 'auprc': 0.7278148482206183, 'loss_val': 0.7398195760766897, 'psi': 0.6601254873752564}-{'f1_val': 0.5834543268920128, 'auprc': 0.7212209159063099, 'loss_val': 0.8689000710961914, 'psi': 0.6385609624977316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=52 head_norm_before_train=1.736778 cos_to_last_merge=0.9845 (last merge round=37)
[S14] round=52 local utility u=0.000812 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984459115743466, 'loss_val': 0.03731673472234199, 'psi': 0.9975636646800045}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985337342072667, 'loss_val': 0.039204092436976326, 'psi': 0.9975987937331725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=52 head_norm_before_train=1.780129 cos_to_last_merge=0.9871 (last merge round=43)
[S15] round=52 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9981440291334309, 'loss_val': 0.029169123627735563, 'psi': 0.9973056126858847}-{'f1_val': 0.701196517572327, 'auprc': 0.9462336667573163, 'loss_val': 0.5136580355866159, 'psi': 0.7992113772463227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=52 head_norm_before_train=1.613360 cos_to_last_merge=0.9962 (last merge round=44)
[S16] round=52 local utility u=0.003245 metrics={'f1_val': 0.9915793213105296, 'auprc': 0.9925440730749797, 'loss_val': 0.05007008508259107, 'psi': 0.9919652220163095}-{'f1_val': 0.9911445912637655, 'auprc': 0.9918061184742399, 'loss_val': 0.05173883282588931, 'psi': 0.9914092021479552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=52 head_norm_before_train=1.601263 cos_to_last_merge=0.9900 (last merge round=41)
[S17] round=52 local utility u=0.081107 metrics={'f1_val': 0.6146280123637161, 'auprc': 0.8869963019841745, 'loss_val': 1.1658307027903914, 'psi': 0.7235753282118995}-{'f1_val': 0.6143671591022741, 'auprc': 0.8221669941327464, 'loss_val': 1.131991524337742, 'psi': 0.697487093114463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=53 head_norm_before_train=2.043611 (no previous merge yet)
[S2] round=53 local utility u=1.000000 metrics={'f1_val': 0.8258341259697568, 'auprc': 0.8037850676523666, 'loss_val': 0.46450550119604517, 'psi': 0.8170145026428007}-{'f1_val': 0.5775170691339545, 'auprc': 0.7610958575580857, 'loss_val': 1.1401096842126566, 'psi': 0.6509485845036069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=53 head_norm_before_train=1.970696 cos_to_last_merge=0.9801 (last merge round=43)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.8517342388434714, 'auprc': 0.9702463012940141, 'loss_val': 0.34021290134742876, 'psi': 0.8991390638236885}-{'f1_val': 0.9481665360957752, 'auprc': 0.9982572534482563, 'loss_val': 0.10627060541105968, 'psi': 0.9682028230367676}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.677787 cos_to_last_merge=0.9989 (last merge round=44)
[S4] round=53 local utility u=0.036412 metrics={'f1_val': 0.9411081806226086, 'auprc': 0.9820477458302255, 'loss_val': 0.27708218048085503, 'psi': 0.9574840067056554}-{'f1_val': 0.9399351428668401, 'auprc': 0.9651983673564337, 'loss_val': 0.29232023078538366, 'psi': 0.9500404326626776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=53 head_norm_before_train=1.893115 cos_to_last_merge=0.8345 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.835
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9196571914315579, 'auprc': 0.9907416242773199, 'loss_val': 0.11862461623418591, 'psi': 0.9480909645698627}-{'f1_val': 0.9960402158980539, 'auprc': 0.9907760475967357, 'loss_val': 0.03123091693625622, 'psi': 0.9939345485775266}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.879697 cos_to_last_merge=0.9991 (last merge round=43)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5677791866920879, 'auprc': 0.6550278309989473, 'loss_val': 1.3981095439762043, 'psi': 0.6026786444148318}-{'f1_val': 0.8219774705382177, 'auprc': 0.9527630806284098, 'loss_val': 0.48547115922262046, 'psi': 0.8742917145742946}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.899012 cos_to_last_merge=0.9963 (last merge round=43)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5344621036406665, 'auprc': 0.7841766472892753, 'loss_val': 1.2083738081064537, 'psi': 0.63434792110011}-{'f1_val': 0.6417901625969553, 'auprc': 0.9463633624547774, 'loss_val': 0.5777671283021072, 'psi': 0.7636194425400842}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.622328 cos_to_last_merge=0.9941 (last merge round=42)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9849632800667485, 'auprc': 0.9986484328924441, 'loss_val': 0.05752883337744811, 'psi': 0.9904373411970268}-{'f1_val': 0.9928576189497129, 'auprc': 0.9928481853655747, 'loss_val': 0.039929702628315286, 'psi': 0.9928538455160576}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.586206 cos_to_last_merge=0.9973 (last merge round=44)
[S9] round=53 local utility u=0.000977 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.998426488594007, 'loss_val': 0.025524181693661437, 'psi': 0.9974821466929571}-{'f1_val': 0.9968525854255906, 'auprc': 0.9980591451696903, 'loss_val': 0.026376436668325662, 'psi': 0.9973352093232304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=53 head_norm_before_train=1.880814 cos_to_last_merge=0.9955 (last merge round=45)
[S10] round=53 local utility u=0.002564 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9955222671113685, 'loss_val': 0.031401542553639125, 'psi': 0.9954027791827855}-{'f1_val': 0.9942256070413027, 'auprc': 0.9965834488472085, 'loss_val': 0.03312818998154633, 'psi': 0.995168743763665}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=53 head_norm_before_train=1.900530 cos_to_last_merge=0.9989 (last merge round=43)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9945804250405943, 'loss_val': 0.0250799983662898, 'psi': 0.9956176207864589}-{'f1_val': 0.9969642566262439, 'auprc': 0.9952021578831611, 'loss_val': 0.023228174113856862, 'psi': 0.9962594171290107}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.507130 cos_to_last_merge=0.9767 (last merge round=35)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6156310056044166, 'auprc': 0.7231662370942873, 'loss_val': 0.8643058624752331, 'psi': 0.6586450982003649}-{'f1_val': 0.6149992468116818, 'auprc': 0.7278148482206183, 'loss_val': 0.7398195760766897, 'psi': 0.6601254873752564}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.746732 cos_to_last_merge=0.9837 (last merge round=37)
[S14] round=53 local utility u=0.000155 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9989167409947259, 'loss_val': 0.03608931867174794, 'psi': 0.9975190353643406}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984459115743466, 'loss_val': 0.03731673472234199, 'psi': 0.9975636646800045}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=53 head_norm_before_train=1.798059 cos_to_last_merge=0.9859 (last merge round=43)
[S15] round=53 local utility u=0.000249 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998035304760145, 'loss_val': 0.028344034041215833, 'psi': 0.9972621229365703}-{'f1_val': 0.9967466683875206, 'auprc': 0.9981440291334309, 'loss_val': 0.029169123627735563, 'psi': 0.9973056126858847}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=53 head_norm_before_train=1.625775 cos_to_last_merge=0.9958 (last merge round=44)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9916696013660776, 'auprc': 0.9899088376037772, 'loss_val': 0.04961677803991255, 'psi': 0.9909652958611574}-{'f1_val': 0.9915793213105296, 'auprc': 0.9925440730749797, 'loss_val': 0.05007008508259107, 'psi': 0.9919652220163095}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.617751 cos_to_last_merge=0.9888 (last merge round=41)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.5753592731831233, 'auprc': 0.7690903964983836, 'loss_val': 1.3132313381957677, 'psi': 0.6528517225092274}-{'f1_val': 0.6146280123637161, 'auprc': 0.8869963019841745, 'loss_val': 1.1658307027903914, 'psi': 0.7235753282118995}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=2.052991 (no previous merge yet)
[S2] round=54 local utility u=0.013088 metrics={'f1_val': 0.8314882775653653, 'auprc': 0.7922223922994819, 'loss_val': 0.4375670562712603, 'psi': 0.8157819234590119}-{'f1_val': 0.8258341259697568, 'auprc': 0.8037850676523666, 'loss_val': 0.46450550119604517, 'psi': 0.8170145026428007}
[S2] not sending this round → trigger blocked (psi=0.816)
[S3] START round=54 head_norm_before_train=1.981724 cos_to_last_merge=0.9798 (last merge round=43)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.6752140335884896, 'auprc': 0.9054503220621187, 'loss_val': 0.910867076750427, 'psi': 0.7673085489779412}-{'f1_val': 0.8517342388434714, 'auprc': 0.9702463012940141, 'loss_val': 0.34021290134742876, 'psi': 0.8991390638236885}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.683507 cos_to_last_merge=0.9987 (last merge round=44)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9390591410728486, 'auprc': 0.9705560758378575, 'loss_val': 0.30930170863658724, 'psi': 0.9516579149788522}-{'f1_val': 0.9411081806226086, 'auprc': 0.9820477458302255, 'loss_val': 0.27708218048085503, 'psi': 0.9574840067056554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.898521 cos_to_last_merge=0.8342 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=54 local utility u=0.274545 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9916248657862425, 'loss_val': 0.02872609457526627, 'psi': 0.9940984559181707}-{'f1_val': 0.9196571914315579, 'auprc': 0.9907416242773199, 'loss_val': 0.11862461623418591, 'psi': 0.9480909645698627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=54 head_norm_before_train=1.883835 cos_to_last_merge=0.9988 (last merge round=43)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.8022611789734655, 'auprc': 0.9450602744559742, 'loss_val': 0.6062600285628634, 'psi': 0.859380817166469}-{'f1_val': 0.5677791866920879, 'auprc': 0.6550278309989473, 'loss_val': 1.3981095439762043, 'psi': 0.6026786444148318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=54 head_norm_before_train=1.916686 cos_to_last_merge=0.9952 (last merge round=43)
[S7] round=54 local utility u=1.000000 metrics={'f1_val': 0.989747877005132, 'auprc': 0.989804126614895, 'loss_val': 0.13335273106924977, 'psi': 0.9897703768490371}-{'f1_val': 0.5344621036406665, 'auprc': 0.7841766472892753, 'loss_val': 1.2083738081064537, 'psi': 0.63434792110011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=54 head_norm_before_train=1.634298 cos_to_last_merge=0.9934 (last merge round=42)
[S8] round=54 local utility u=0.019644 metrics={'f1_val': 0.9894325396823006, 'auprc': 0.9983791788798081, 'loss_val': 0.0442485117568184, 'psi': 0.9930111953613037}-{'f1_val': 0.9849632800667485, 'auprc': 0.9986484328924441, 'loss_val': 0.05752883337744811, 'psi': 0.9904373411970268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=54 head_norm_before_train=1.598230 cos_to_last_merge=0.9970 (last merge round=44)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9940064048017474, 'loss_val': 0.025426910769153918, 'psi': 0.9956180566795563}-{'f1_val': 0.9968525854255906, 'auprc': 0.998426488594007, 'loss_val': 0.025524181693661437, 'psi': 0.9974821466929571}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.897572 cos_to_last_merge=0.9948 (last merge round=45)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9965528027541373, 'loss_val': 0.03089072372172967, 'psi': 0.9954197541073048}-{'f1_val': 0.9953231205637304, 'auprc': 0.9955222671113685, 'loss_val': 0.031401542553639125, 'psi': 0.9954027791827855}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=1.909633 cos_to_last_merge=0.9986 (last merge round=43)
[S11] round=54 local utility u=0.004251 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9952941275540479, 'loss_val': 0.022649275124017404, 'psi': 0.9962962049973654}-{'f1_val': 0.9963090846170353, 'auprc': 0.9945804250405943, 'loss_val': 0.0250799983662898, 'psi': 0.9956176207864589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=54 head_norm_before_train=1.514920 cos_to_last_merge=0.9759 (last merge round=35)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5859749742494647, 'auprc': 0.7284300010477857, 'loss_val': 0.9029805671963612, 'psi': 0.642956984968793}-{'f1_val': 0.6156310056044166, 'auprc': 0.7231662370942873, 'loss_val': 0.8643058624752331, 'psi': 0.6586450982003649}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.757735 cos_to_last_merge=0.9828 (last merge round=37)
[S14] round=54 local utility u=0.001954 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9989183640729564, 'loss_val': 0.034647887886437266, 'psi': 0.9977658505237816}-{'f1_val': 0.9965872316107504, 'auprc': 0.9989167409947259, 'loss_val': 0.03608931867174794, 'psi': 0.9975190353643406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=54 head_norm_before_train=1.815662 cos_to_last_merge=0.9848 (last merge round=43)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9664131296232913, 'auprc': 0.9976751896958069, 'loss_val': 0.05897493753688702, 'psi': 0.9789179536522975}-{'f1_val': 0.9967466683875206, 'auprc': 0.998035304760145, 'loss_val': 0.028344034041215833, 'psi': 0.9972621229365703}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.637796 cos_to_last_merge=0.9954 (last merge round=44)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.9738718121074229, 'auprc': 0.9822393903654381, 'loss_val': 0.10391039748362593, 'psi': 0.9772188434106289}-{'f1_val': 0.9916696013660776, 'auprc': 0.9899088376037772, 'loss_val': 0.04961677803991255, 'psi': 0.9909652958611574}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=1.630355 cos_to_last_merge=0.9879 (last merge round=41)
[S17] round=54 local utility u=0.656843 metrics={'f1_val': 0.6331113292072017, 'auprc': 0.9625533660355449, 'loss_val': 0.9264467500718767, 'psi': 0.764888143938539}-{'f1_val': 0.5753592731831233, 'auprc': 0.7690903964983836, 'loss_val': 1.3132313381957677, 'psi': 0.6528517225092274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=55 head_norm_before_train=2.062624 (no previous merge yet)
[S2] round=55 local utility u=0.010224 metrics={'f1_val': 0.8275977784136561, 'auprc': 0.818172743174669, 'loss_val': 0.47162736851678366, 'psi': 0.8238277643180613}-{'f1_val': 0.8314882775653653, 'auprc': 0.7922223922994819, 'loss_val': 0.4375670562712603, 'psi': 0.8157819234590119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=55 head_norm_before_train=1.992726 cos_to_last_merge=0.9794 (last merge round=43)
[S3] round=55 local utility u=1.000000 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9987343454557213, 'loss_val': 0.14786722018587892, 'psi': 0.976010032895463}-{'f1_val': 0.6752140335884896, 'auprc': 0.9054503220621187, 'loss_val': 0.910867076750427, 'psi': 0.7673085489779412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=55 head_norm_before_train=1.689012 cos_to_last_merge=0.9984 (last merge round=44)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9364793519138963, 'auprc': 0.9533295896502905, 'loss_val': 0.3770558738127288, 'psi': 0.943219447008454}-{'f1_val': 0.9390591410728486, 'auprc': 0.9705560758378575, 'loss_val': 0.30930170863658724, 'psi': 0.9516579149788522}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.903168 cos_to_last_merge=0.8334 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=55 local utility u=0.006945 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9955958410059028, 'loss_val': 0.027623495988761303, 'psi': 0.9957743306735648}-{'f1_val': 0.9957475160061228, 'auprc': 0.9916248657862425, 'loss_val': 0.02872609457526627, 'psi': 0.9940984559181707}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=55 head_norm_before_train=1.886269 cos_to_last_merge=0.9987 (last merge round=43)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7409470847111459, 'auprc': 0.9030887088712267, 'loss_val': 0.7648370821365368, 'psi': 0.8058037343751783}-{'f1_val': 0.8022611789734655, 'auprc': 0.9450602744559742, 'loss_val': 0.6062600285628634, 'psi': 0.859380817166469}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.928758 cos_to_last_merge=0.9944 (last merge round=43)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.8288516875087248, 'auprc': 0.9786526130549069, 'loss_val': 0.4665606806487614, 'psi': 0.8887720577271977}-{'f1_val': 0.989747877005132, 'auprc': 0.989804126614895, 'loss_val': 0.13335273106924977, 'psi': 0.9897703768490371}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.648222 cos_to_last_merge=0.9927 (last merge round=42)
[S8] round=55 local utility u=0.009265 metrics={'f1_val': 0.9925712794554754, 'auprc': 0.9963996555883418, 'loss_val': 0.03861154285993625, 'psi': 0.994102629908622}-{'f1_val': 0.9894325396823006, 'auprc': 0.9983791788798081, 'loss_val': 0.0442485117568184, 'psi': 0.9930111953613037}
[S8] not sending this round → trigger blocked (psi=0.994)
[S9] START round=55 head_norm_before_train=1.608358 cos_to_last_merge=0.9967 (last merge round=44)
[S9] round=55 local utility u=0.004546 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9984672899581735, 'loss_val': 0.02571034573795242, 'psi': 0.9970016541868134}-{'f1_val': 0.9966924912647621, 'auprc': 0.9940064048017474, 'loss_val': 0.025426910769153918, 'psi': 0.9956180566795563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=55 head_norm_before_train=1.913802 cos_to_last_merge=0.9941 (last merge round=45)
[S10] round=55 local utility u=0.001968 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9962171709961247, 'loss_val': 0.029899830181635605, 'psi': 0.9956807407366881}-{'f1_val': 0.9946643883427498, 'auprc': 0.9965528027541373, 'loss_val': 0.03089072372172967, 'psi': 0.9954197541073048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=55 head_norm_before_train=1.915738 cos_to_last_merge=0.9984 (last merge round=43)
[S11] round=55 local utility u=0.000622 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9954847954272855, 'loss_val': 0.021978215339873614, 'psi': 0.9963724721466605}-{'f1_val': 0.9969642566262439, 'auprc': 0.9952941275540479, 'loss_val': 0.022649275124017404, 'psi': 0.9962962049973654}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=55 head_norm_before_train=1.522040 cos_to_last_merge=0.9750 (last merge round=35)
[S13] round=55 local utility u=0.138169 metrics={'f1_val': 0.6139866297005028, 'auprc': 0.7306396224879166, 'loss_val': 0.8013410702985801, 'psi': 0.6606478268154683}-{'f1_val': 0.5859749742494647, 'auprc': 0.7284300010477857, 'loss_val': 0.9029805671963612, 'psi': 0.642956984968793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=55 head_norm_before_train=1.767797 cos_to_last_merge=0.9820 (last merge round=37)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9969721384427733, 'auprc': 0.9969705257641994, 'loss_val': 0.0366569304808163, 'psi': 0.9969714933713437}-{'f1_val': 0.9969975081576651, 'auprc': 0.9989183640729564, 'loss_val': 0.034647887886437266, 'psi': 0.9977658505237816}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.833312 cos_to_last_merge=0.9836 (last merge round=43)
[S15] round=55 local utility u=0.105397 metrics={'f1_val': 0.9967630768980411, 'auprc': 0.9981632230295903, 'loss_val': 0.031744057164698955, 'psi': 0.9973231353506607}-{'f1_val': 0.9664131296232913, 'auprc': 0.9976751896958069, 'loss_val': 0.05897493753688702, 'psi': 0.9789179536522975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=55 head_norm_before_train=1.648418 cos_to_last_merge=0.9950 (last merge round=44)
[S16] round=55 local utility u=0.092004 metrics={'f1_val': 0.9906337731925993, 'auprc': 0.993346177938367, 'loss_val': 0.053795128250188624, 'psi': 0.9917187350909064}-{'f1_val': 0.9738718121074229, 'auprc': 0.9822393903654381, 'loss_val': 0.10391039748362593, 'psi': 0.9772188434106289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=55 head_norm_before_train=1.638684 cos_to_last_merge=0.9872 (last merge round=41)
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.4872529528186462, 'auprc': 0.6427027602216351, 'loss_val': 1.5181722131689424, 'psi': 0.5494328757798417}-{'f1_val': 0.6331113292072017, 'auprc': 0.9625533660355449, 'loss_val': 0.9264467500718767, 'psi': 0.764888143938539}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=2.068161 (no previous merge yet)
[S2] round=56 local utility u=0.017899 metrics={'f1_val': 0.8314882775653653, 'auprc': 0.8079443760121836, 'loss_val': 0.42848731648624283, 'psi': 0.8220707169440926}-{'f1_val': 0.8275977784136561, 'auprc': 0.818172743174669, 'loss_val': 0.47162736851678366, 'psi': 0.8238277643180613}
[S2] not sending this round → trigger blocked (psi=0.822)
[S3] START round=56 head_norm_before_train=2.003091 cos_to_last_merge=0.9789 (last merge round=43)
[S3] round=56 local utility u=0.156314 metrics={'f1_val': 0.9941033510040047, 'auprc': 0.998876006811408, 'loss_val': 0.03512125941341335, 'psi': 0.996012413326966}-{'f1_val': 0.9608604911886242, 'auprc': 0.9987343454557213, 'loss_val': 0.14786722018587892, 'psi': 0.976010032895463}
[S3] not sending this round → trigger blocked (psi=0.996)
[S4] START round=56 head_norm_before_train=1.692063 cos_to_last_merge=0.9982 (last merge round=44)
[S4] round=56 local utility u=0.120784 metrics={'f1_val': 0.9536498515631815, 'auprc': 0.9643778553313002, 'loss_val': 0.2716553635955266, 'psi': 0.9579410530704289}-{'f1_val': 0.9364793519138963, 'auprc': 0.9533295896502905, 'loss_val': 0.3770558738127288, 'psi': 0.943219447008454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=56 head_norm_before_train=1.911693 cos_to_last_merge=0.8324 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.720084359793581, 'auprc': 0.9890409184711983, 'loss_val': 0.48494135946500044, 'psi': 0.827666983264628}-{'f1_val': 0.9958933237853395, 'auprc': 0.9955958410059028, 'loss_val': 0.027623495988761303, 'psi': 0.9957743306735648}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.889644 cos_to_last_merge=0.9986 (last merge round=43)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.5705751201138592, 'auprc': 0.72584742581023, 'loss_val': 1.0884491387942037, 'psi': 0.6326840423924076}-{'f1_val': 0.7409470847111459, 'auprc': 0.9030887088712267, 'loss_val': 0.7648370821365368, 'psi': 0.8058037343751783}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.940528 cos_to_last_merge=0.9936 (last merge round=43)
[S7] round=56 local utility u=0.522476 metrics={'f1_val': 0.9528549336649035, 'auprc': 0.985717654588756, 'loss_val': 0.18682418187587016, 'psi': 0.9660000220344445}-{'f1_val': 0.8288516875087248, 'auprc': 0.9786526130549069, 'loss_val': 0.4665606806487614, 'psi': 0.8887720577271977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=56 head_norm_before_train=1.661060 cos_to_last_merge=0.9921 (last merge round=42)
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.9864258722700556, 'auprc': 0.9986505184289858, 'loss_val': 0.0492312431641825, 'psi': 0.9913157307336278}-{'f1_val': 0.9925712794554754, 'auprc': 0.9963996555883418, 'loss_val': 0.03861154285993625, 'psi': 0.994102629908622}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.617819 cos_to_last_merge=0.9964 (last merge round=44)
[S9] round=56 local utility u=0.003039 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9984646653687624, 'loss_val': 0.02459213813904852, 'psi': 0.9974974174028592}-{'f1_val': 0.9960245636725735, 'auprc': 0.9984672899581735, 'loss_val': 0.02571034573795242, 'psi': 0.9970016541868134}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=56 head_norm_before_train=1.925683 cos_to_last_merge=0.9936 (last merge round=45)
[S10] round=56 local utility u=0.000485 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9963471124403627, 'loss_val': 0.029319624168863863, 'psi': 0.9957327173143833}-{'f1_val': 0.9953231205637304, 'auprc': 0.9962171709961247, 'loss_val': 0.029899830181635605, 'psi': 0.9956807407366881}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=56 head_norm_before_train=1.923859 cos_to_last_merge=0.9982 (last merge round=43)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9962969820173213, 'loss_val': 0.022269933280342418, 'psi': 0.9964493458039869}-{'f1_val': 0.9969642566262439, 'auprc': 0.9954847954272855, 'loss_val': 0.021978215339873614, 'psi': 0.9963724721466605}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.528054 cos_to_last_merge=0.9744 (last merge round=35)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6073629124321736, 'auprc': 0.735467388023431, 'loss_val': 0.8404081785083112, 'psi': 0.6586047026686765}-{'f1_val': 0.6139866297005028, 'auprc': 0.7306396224879166, 'loss_val': 0.8013410702985801, 'psi': 0.6606478268154683}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.777733 cos_to_last_merge=0.9811 (last merge round=37)
[S14] round=56 local utility u=0.003466 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9989095340166896, 'loss_val': 0.033099898257236283, 'psi': 0.9975029475524517}-{'f1_val': 0.9969721384427733, 'auprc': 0.9969705257641994, 'loss_val': 0.0366569304808163, 'psi': 0.9969714933713437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=56 head_norm_before_train=1.850821 cos_to_last_merge=0.9824 (last merge round=43)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9280618405583284, 'auprc': 0.9971853610169101, 'loss_val': 0.09215150662696885, 'psi': 0.955711248741761}-{'f1_val': 0.9967630768980411, 'auprc': 0.9981632230295903, 'loss_val': 0.031744057164698955, 'psi': 0.9973231353506607}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.659280 cos_to_last_merge=0.9945 (last merge round=44)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8314817938776139, 'auprc': 0.9484406653105449, 'loss_val': 1.0689732552298719, 'psi': 0.8782653424507862}-{'f1_val': 0.9906337731925993, 'auprc': 0.993346177938367, 'loss_val': 0.053795128250188624, 'psi': 0.9917187350909064}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.645001 cos_to_last_merge=0.9868 (last merge round=41)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.45141566014406453, 'auprc': 0.6437078113911745, 'loss_val': 1.6674706658050584, 'psi': 0.5283325206429086}-{'f1_val': 0.4872529528186462, 'auprc': 0.6427027602216351, 'loss_val': 1.5181722131689424, 'psi': 0.5494328757798417}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=2.073384 (no previous merge yet)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.8268913461183554, 'auprc': 0.8077638234082818, 'loss_val': 0.45865698029173047, 'psi': 0.819240337034326}-{'f1_val': 0.8314882775653653, 'auprc': 0.8079443760121836, 'loss_val': 0.42848731648624283, 'psi': 0.8220707169440926}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.016378 cos_to_last_merge=0.9782 (last merge round=43)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9544970514674826, 'auprc': 0.9944599319833559, 'loss_val': 0.10377779323544309, 'psi': 0.9704822036738319}-{'f1_val': 0.9941033510040047, 'auprc': 0.998876006811408, 'loss_val': 0.03512125941341335, 'psi': 0.996012413326966}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.693192 cos_to_last_merge=0.9980 (last merge round=44)
[S4] round=57 local utility u=0.016821 metrics={'f1_val': 0.9576930971426163, 'auprc': 0.9675665593584968, 'loss_val': 0.2718386599745028, 'psi': 0.9616424820289684}-{'f1_val': 0.9536498515631815, 'auprc': 0.9643778553313002, 'loss_val': 0.2716553635955266, 'psi': 0.9579410530704289}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=57 head_norm_before_train=1.913105 cos_to_last_merge=0.8322 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=57 local utility u=1.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9908765206206173, 'loss_val': 0.028951506144815946, 'psi': 0.9937991178519205}-{'f1_val': 0.720084359793581, 'auprc': 0.9890409184711983, 'loss_val': 0.48494135946500044, 'psi': 0.827666983264628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=57 head_norm_before_train=1.894284 cos_to_last_merge=0.9986 (last merge round=43)
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.8045876398662849, 'auprc': 0.921477886079934, 'loss_val': 0.4171653274795438, 'psi': 0.8513437383517446}-{'f1_val': 0.5705751201138592, 'auprc': 0.72584742581023, 'loss_val': 1.0884491387942037, 'psi': 0.6326840423924076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=57 head_norm_before_train=1.967985 cos_to_last_merge=0.9916 (last merge round=43)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.6174627973524882, 'auprc': 0.9450384017096085, 'loss_val': 0.8581157611987762, 'psi': 0.7484930390953364}-{'f1_val': 0.9528549336649035, 'auprc': 0.985717654588756, 'loss_val': 0.18682418187587016, 'psi': 0.9660000220344445}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=1.670303 cos_to_last_merge=0.9917 (last merge round=42)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9898734612970058, 'auprc': 0.9851682874681927, 'loss_val': 0.05635951126509398, 'psi': 0.9879913917654806}-{'f1_val': 0.9864258722700556, 'auprc': 0.9986505184289858, 'loss_val': 0.0492312431641825, 'psi': 0.9913157307336278}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=1.629032 cos_to_last_merge=0.9960 (last merge round=44)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9929874848388971, 'loss_val': 0.02435974479918165, 'psi': 0.9952104886944162}-{'f1_val': 0.9968525854255906, 'auprc': 0.9984646653687624, 'loss_val': 0.02459213813904852, 'psi': 0.9974974174028592}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=1.938310 cos_to_last_merge=0.9930 (last merge round=45)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9965658641012707, 'loss_val': 0.029019772497039506, 'psi': 0.9954249786461582}-{'f1_val': 0.9953231205637304, 'auprc': 0.9963471124403627, 'loss_val': 0.029319624168863863, 'psi': 0.9957327173143833}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=57 head_norm_before_train=1.931386 cos_to_last_merge=0.9979 (last merge round=43)
[S11] round=57 local utility u=0.000331 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9965298162242556, 'loss_val': 0.022305917466331718, 'psi': 0.9965424794867606}-{'f1_val': 0.9965509216617638, 'auprc': 0.9962969820173213, 'loss_val': 0.022269933280342418, 'psi': 0.9964493458039869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=57 head_norm_before_train=1.534109 cos_to_last_merge=0.9738 (last merge round=35)
[S13] round=57 local utility u=0.155861 metrics={'f1_val': 0.6387772534550622, 'auprc': 0.745534420771091, 'loss_val': 0.7473739044828365, 'psi': 0.6814801203814738}-{'f1_val': 0.6073629124321736, 'auprc': 0.735467388023431, 'loss_val': 0.8404081785083112, 'psi': 0.6586047026686765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=57 head_norm_before_train=1.786175 cos_to_last_merge=0.9803 (last merge round=37)
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9985063965324694, 'loss_val': 0.03277898550059926, 'psi': 0.9973416925587637}-{'f1_val': 0.9965652232429598, 'auprc': 0.9989095340166896, 'loss_val': 0.033099898257236283, 'psi': 0.9975029475524517}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.867329 cos_to_last_merge=0.9812 (last merge round=43)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.9110423648777821, 'auprc': 0.9970560313389554, 'loss_val': 0.12161878657794113, 'psi': 0.9454478314622514}-{'f1_val': 0.9280618405583284, 'auprc': 0.9971853610169101, 'loss_val': 0.09215150662696885, 'psi': 0.955711248741761}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.669468 cos_to_last_merge=0.9941 (last merge round=44)
[S16] round=57 local utility u=1.000000 metrics={'f1_val': 0.9921630730391329, 'auprc': 0.9917825244279002, 'loss_val': 0.04589734666585995, 'psi': 0.9920108535946398}-{'f1_val': 0.8314817938776139, 'auprc': 0.9484406653105449, 'loss_val': 1.0689732552298719, 'psi': 0.8782653424507862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=57 head_norm_before_train=1.653159 cos_to_last_merge=0.9861 (last merge round=41)
[S17] round=57 local utility u=1.000000 metrics={'f1_val': 0.6407143955094102, 'auprc': 0.7979136067588021, 'loss_val': 1.1048576106107442, 'psi': 0.703594080009167}-{'f1_val': 0.45141566014406453, 'auprc': 0.6437078113911745, 'loss_val': 1.6674706658050584, 'psi': 0.5283325206429086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=58 head_norm_before_train=2.079017 (no previous merge yet)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.8281158258146766, 'auprc': 0.795250904457193, 'loss_val': 0.4452876109815808, 'psi': 0.8149698572716833}-{'f1_val': 0.8268913461183554, 'auprc': 0.8077638234082818, 'loss_val': 0.45865698029173047, 'psi': 0.819240337034326}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.030722 cos_to_last_merge=0.9774 (last merge round=43)
[S3] round=58 local utility u=0.002440 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9992325980841363, 'loss_val': 0.15292435961214318, 'psi': 0.9763621935743461}-{'f1_val': 0.9544970514674826, 'auprc': 0.9944599319833559, 'loss_val': 0.10377779323544309, 'psi': 0.9704822036738319}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=58 head_norm_before_train=1.694990 cos_to_last_merge=0.9978 (last merge round=44)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9412105573185827, 'auprc': 0.9813982526055854, 'loss_val': 0.2855553546856013, 'psi': 0.9572856354333839}-{'f1_val': 0.9576930971426163, 'auprc': 0.9675665593584968, 'loss_val': 0.2718386599745028, 'psi': 0.9616424820289684}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.911347 cos_to_last_merge=0.8322 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9906047828438485, 'loss_val': 0.030066462200100615, 'psi': 0.9936904227412131}-{'f1_val': 0.9957475160061228, 'auprc': 0.9908765206206173, 'loss_val': 0.028951506144815946, 'psi': 0.9937991178519205}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.900422 cos_to_last_merge=0.9986 (last merge round=43)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7190428840952687, 'auprc': 0.9168412322964208, 'loss_val': 0.6959193259584648, 'psi': 0.7981622233757295}-{'f1_val': 0.8045876398662849, 'auprc': 0.921477886079934, 'loss_val': 0.4171653274795438, 'psi': 0.8513437383517446}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.985901 cos_to_last_merge=0.9903 (last merge round=43)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5678359652937656, 'auprc': 0.8766530100691288, 'loss_val': 1.203796948880377, 'psi': 0.6913627832039109}-{'f1_val': 0.6174627973524882, 'auprc': 0.9450384017096085, 'loss_val': 0.8581157611987762, 'psi': 0.7484930390953364}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.675360 cos_to_last_merge=0.9914 (last merge round=42)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.9419633032272638, 'auprc': 0.9984897144670318, 'loss_val': 0.1619763955676202, 'psi': 0.964573867723171}-{'f1_val': 0.9898734612970058, 'auprc': 0.9851682874681927, 'loss_val': 0.05635951126509398, 'psi': 0.9879913917654806}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.639639 cos_to_last_merge=0.9956 (last merge round=44)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9939457934366372, 'auprc': 0.9984612962138206, 'loss_val': 0.027590060119219023, 'psi': 0.9957519945475106}-{'f1_val': 0.9966924912647621, 'auprc': 0.9929874848388971, 'loss_val': 0.02435974479918165, 'psi': 0.9952104886944162}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.950815 cos_to_last_merge=0.9924 (last merge round=45)
[S10] round=58 local utility u=0.000856 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9965279665679512, 'loss_val': 0.028510253707291194, 'psi': 0.9955415210854173}-{'f1_val': 0.9946643883427498, 'auprc': 0.9965658641012707, 'loss_val': 0.029019772497039506, 'psi': 0.9954249786461582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=58 head_norm_before_train=1.939108 cos_to_last_merge=0.9977 (last merge round=43)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954834096892631, 'loss_val': 0.02141074821546956, 'psi': 0.9961239168727636}-{'f1_val': 0.9965509216617638, 'auprc': 0.9965298162242556, 'loss_val': 0.022305917466331718, 'psi': 0.9965424794867606}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.543260 cos_to_last_merge=0.9728 (last merge round=35)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6371757032103702, 'auprc': 0.761696353795534, 'loss_val': 0.8343931919163851, 'psi': 0.6869839634444357}-{'f1_val': 0.6387772534550622, 'auprc': 0.745534420771091, 'loss_val': 0.7473739044828365, 'psi': 0.6814801203814738}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.795875 cos_to_last_merge=0.9795 (last merge round=37)
[S14] round=58 local utility u=0.000295 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9985335010940617, 'loss_val': 0.03227121107354675, 'psi': 0.9973525343834007}-{'f1_val': 0.9965652232429598, 'auprc': 0.9985063965324694, 'loss_val': 0.03277898550059926, 'psi': 0.9973416925587637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=58 head_norm_before_train=1.883051 cos_to_last_merge=0.9801 (last merge round=43)
[S15] round=58 local utility u=0.304879 metrics={'f1_val': 0.9967630768980411, 'auprc': 0.9978949558100481, 'loss_val': 0.02870092555665298, 'psi': 0.9972158284628438}-{'f1_val': 0.9110423648777821, 'auprc': 0.9970560313389554, 'loss_val': 0.12161878657794113, 'psi': 0.9454478314622514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=58 head_norm_before_train=1.678159 cos_to_last_merge=0.9936 (last merge round=44)
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9200955613839287, 'auprc': 0.9809884233607508, 'loss_val': 0.24843371261803243, 'psi': 0.9444527061746575}-{'f1_val': 0.9921630730391329, 'auprc': 0.9917825244279002, 'loss_val': 0.04589734666585995, 'psi': 0.9920108535946398}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.663975 cos_to_last_merge=0.9853 (last merge round=41)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.633199952361426, 'auprc': 0.8243454323913705, 'loss_val': 1.1973851734683139, 'psi': 0.7096581443734038}-{'f1_val': 0.6407143955094102, 'auprc': 0.7979136067588021, 'loss_val': 1.1048576106107442, 'psi': 0.703594080009167}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.085159 (no previous merge yet)
[S2] round=59 local utility u=0.032862 metrics={'f1_val': 0.8268127369279497, 'auprc': 0.8254209346268611, 'loss_val': 0.46225518299651, 'psi': 0.8262560160075142}-{'f1_val': 0.8281158258146766, 'auprc': 0.795250904457193, 'loss_val': 0.4452876109815808, 'psi': 0.8149698572716833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S2] r=60 psi=0.826 u=0.0329 p_local=0.0741 f1=0.827 auprc=0.825 bytes=50416
[S3] START round=59 head_norm_before_train=2.043090 cos_to_last_merge=0.9769 (last merge round=43)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.7994617007303679, 'auprc': 0.9284357166757623, 'loss_val': 0.48582777482681666, 'psi': 0.8510513071085257}-{'f1_val': 0.9611152572344858, 'auprc': 0.9992325980841363, 'loss_val': 0.15292435961214318, 'psi': 0.9763621935743461}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.851 u=0.0000 p_local=0.1227 f1=0.799 auprc=0.928 bytes=43172
[S4] START round=59 head_norm_before_train=1.698253 cos_to_last_merge=0.9976 (last merge round=44)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9407236140375905, 'auprc': 0.9821226154051318, 'loss_val': 0.2930845437285092, 'psi': 0.9572832145846071}-{'f1_val': 0.9412105573185827, 'auprc': 0.9813982526055854, 'loss_val': 0.2855553546856013, 'psi': 0.9572856354333839}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.957 u=0.0000 p_local=0.0228 f1=0.941 auprc=0.982 bytes=45009
[S5] START round=59 head_norm_before_train=1.911853 cos_to_last_merge=0.8324 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=59 local utility u=0.002432 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9916489153708554, 'loss_val': 0.02833431597530138, 'psi': 0.9941080757520159}-{'f1_val': 0.9957475160061228, 'auprc': 0.9906047828438485, 'loss_val': 0.030066462200100615, 'psi': 0.9936904227412131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=60 psi=0.994 u=0.0024 p_local=0.1474 f1=0.996 auprc=0.992 bytes=43178
[S6] START round=59 head_norm_before_train=1.906491 cos_to_last_merge=0.9981 (last merge round=43)
[S6] round=59 local utility u=0.296583 metrics={'f1_val': 0.7842742926114008, 'auprc': 0.9367691289155071, 'loss_val': 0.55392510447724, 'psi': 0.8452722271330433}-{'f1_val': 0.7190428840952687, 'auprc': 0.9168412322964208, 'loss_val': 0.6959193259584648, 'psi': 0.7981622233757295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=60 psi=0.845 u=0.2966 p_local=0.3405 f1=0.784 auprc=0.937 bytes=44995
[S7] START round=59 head_norm_before_train=2.004755 cos_to_last_merge=0.9890 (last merge round=43)
[S7] round=59 local utility u=1.000000 metrics={'f1_val': 0.8329328178858835, 'auprc': 0.9495244656277191, 'loss_val': 0.6281316139985078, 'psi': 0.8795694769826177}-{'f1_val': 0.5678359652937656, 'auprc': 0.8766530100691288, 'loss_val': 1.203796948880377, 'psi': 0.6913627832039109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=60 psi=0.880 u=1.0000 p_local=0.3767 f1=0.833 auprc=0.950 bytes=41364
[S8] START round=59 head_norm_before_train=1.680898 cos_to_last_merge=0.9911 (last merge round=42)
[S8] round=59 local utility u=0.203196 metrics={'f1_val': 0.9934667705418724, 'auprc': 0.9901782479603115, 'loss_val': 0.03967106704052913, 'psi': 0.9921513615092481}-{'f1_val': 0.9419633032272638, 'auprc': 0.9984897144670318, 'loss_val': 0.1619763955676202, 'psi': 0.964573867723171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] r=60 psi=0.992 u=0.2032 p_local=0.0449 f1=0.993 auprc=0.990 bytes=54002
[S9] START round=59 head_norm_before_train=1.649107 cos_to_last_merge=0.9953 (last merge round=44)
[S9] round=59 local utility u=0.002802 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.993529399049388, 'loss_val': 0.02367014163297155, 'psi': 0.9954272543786125}-{'f1_val': 0.9939457934366372, 'auprc': 0.9984612962138206, 'loss_val': 0.027590060119219023, 'psi': 0.9957519945475106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=60 psi=0.995 u=0.0028 p_local=0.0023 f1=0.997 auprc=0.994 bytes=50363
[S10] START round=59 head_norm_before_train=1.961244 cos_to_last_merge=0.9919 (last merge round=45)
[S10] round=59 local utility u=0.000116 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996492236690889, 'loss_val': 0.02817103629123942, 'psi': 0.9955272291345924}-{'f1_val': 0.9948838907637279, 'auprc': 0.9965279665679512, 'loss_val': 0.028510253707291194, 'psi': 0.9955415210854173}
[S10] not sending this round → trigger blocked (psi=0.996)
[S10] r=60 psi=0.996 u=0.0001 p_local=0.0009 f1=0.995 auprc=0.996 bytes=52186
[S11] START round=59 head_norm_before_train=1.947985 cos_to_last_merge=0.9974 (last merge round=43)
[S11] round=59 local utility u=0.001065 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9951766023752591, 'loss_val': 0.02084042335608635, 'psi': 0.9962491949258498}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954834096892631, 'loss_val': 0.02141074821546956, 'psi': 0.9961239168727636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S11] r=60 psi=0.996 u=0.0011 p_local=0.0079 f1=0.997 auprc=0.995 bytes=48558
[S13] START round=59 head_norm_before_train=1.554521 cos_to_last_merge=0.9714 (last merge round=35)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6387154844310179, 'auprc': 0.753805865382791, 'loss_val': 0.9030747254593896, 'psi': 0.6847516368117272}-{'f1_val': 0.6371757032103702, 'auprc': 0.761696353795534, 'loss_val': 0.8343931919163851, 'psi': 0.6869839634444357}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.685 u=0.0000 p_local=0.0490 f1=0.639 auprc=0.754 bytes=46794
[S14] START round=59 head_norm_before_train=1.804609 cos_to_last_merge=0.9788 (last merge round=37)
[S14] round=59 local utility u=0.001016 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9988687637050092, 'loss_val': 0.031244887629932532, 'psi': 0.9974866394277796}-{'f1_val': 0.9965652232429598, 'auprc': 0.9985335010940617, 'loss_val': 0.03227121107354675, 'psi': 0.9973525343834007}
[S14] not sending this round → trigger blocked (psi=0.997)
[S14] r=60 psi=0.997 u=0.0010 p_local=0.0036 f1=0.997 auprc=0.999 bytes=59401
[S15] START round=59 head_norm_before_train=1.897965 cos_to_last_merge=0.9790 (last merge round=43)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9402683682135957, 'auprc': 0.9973687136082697, 'loss_val': 0.07860139049836744, 'psi': 0.9631085063714654}-{'f1_val': 0.9967630768980411, 'auprc': 0.9978949558100481, 'loss_val': 0.02870092555665298, 'psi': 0.9972158284628438}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.963 u=0.0000 p_local=0.1312 f1=0.940 auprc=0.997 bytes=43173
[S16] START round=59 head_norm_before_train=1.685733 cos_to_last_merge=0.9934 (last merge round=44)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8674997161925248, 'auprc': 0.9914145685103675, 'loss_val': 0.7052394976818581, 'psi': 0.9170656571196618}-{'f1_val': 0.9200955613839287, 'auprc': 0.9809884233607508, 'loss_val': 0.24843371261803243, 'psi': 0.9444527061746575}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.917 u=0.0000 p_local=0.1662 f1=0.867 auprc=0.991 bytes=46787
[S17] START round=59 head_norm_before_train=1.674000 cos_to_last_merge=0.9845 (last merge round=41)
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.5949243153952504, 'auprc': 0.8180531979445278, 'loss_val': 1.3069965223114965, 'psi': 0.6841758684149614}-{'f1_val': 0.633199952361426, 'auprc': 0.8243454323913705, 'loss_val': 1.1973851734683139, 'psi': 0.7096581443734038}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.684 u=0.0000 p_local=0.1955 f1=0.595 auprc=0.818 bytes=50402
[S2] START round=60 head_norm_before_train=2.092112 (no previous merge yet)
[S2] round=60 local utility u=0.014393 metrics={'f1_val': 0.8276066689461687, 'auprc': 0.8345748716433152, 'loss_val': 0.4656949823141924, 'psi': 0.8303939500250274}-{'f1_val': 0.8268127369279497, 'auprc': 0.8254209346268611, 'loss_val': 0.46225518299651, 'psi': 0.8262560160075142}
[S2] not sending this round → trigger blocked (psi=0.830)
[S3] START round=60 head_norm_before_train=2.055342 cos_to_last_merge=0.9760 (last merge round=43)
[S3] round=60 local utility u=0.667009 metrics={'f1_val': 0.9288934088196863, 'auprc': 0.9981509243508195, 'loss_val': 0.137546149734417, 'psi': 0.9565964150321397}-{'f1_val': 0.7994617007303679, 'auprc': 0.9284357166757623, 'loss_val': 0.48582777482681666, 'psi': 0.8510513071085257}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=60 head_norm_before_train=1.702435 cos_to_last_merge=0.9974 (last merge round=44)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9400360499041569, 'auprc': 0.9721624614593471, 'loss_val': 0.2900762183429758, 'psi': 0.952886614526233}-{'f1_val': 0.9407236140375905, 'auprc': 0.9821226154051318, 'loss_val': 0.2930845437285092, 'psi': 0.9572832145846071}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.916899 cos_to_last_merge=0.8321 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=60 local utility u=0.008047 metrics={'f1_val': 0.9957741494321548, 'auprc': 0.9976744135484644, 'loss_val': 0.030476564439086706, 'psi': 0.9965342550786787}-{'f1_val': 0.9957475160061228, 'auprc': 0.9916489153708554, 'loss_val': 0.02833431597530138, 'psi': 0.9941080757520159}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=60 head_norm_before_train=1.916172 cos_to_last_merge=0.9979 (last merge round=43)
[S6] round=60 local utility u=0.292036 metrics={'f1_val': 0.8481955362436334, 'auprc': 0.9486207347897968, 'loss_val': 0.38893496748876666, 'psi': 0.8883656156620987}-{'f1_val': 0.7842742926114008, 'auprc': 0.9367691289155071, 'loss_val': 0.55392510447724, 'psi': 0.8452722271330433}
[S6] not sending this round → trigger blocked (psi=0.888)
[S7] START round=60 head_norm_before_train=2.030004 cos_to_last_merge=0.9861 (last merge round=43)
[S7] round=60 local utility u=0.315900 metrics={'f1_val': 0.8885074110299368, 'auprc': 0.9644669491116371, 'loss_val': 0.3746073715926338, 'psi': 0.918891226262617}-{'f1_val': 0.8329328178858835, 'auprc': 0.9495244656277191, 'loss_val': 0.6281316139985078, 'psi': 0.8795694769826177}
[S7] not sending this round → trigger blocked (psi=0.919)
[S8] START round=60 head_norm_before_train=1.687078 cos_to_last_merge=0.9908 (last merge round=42)
[S8] round=60 local utility u=0.000381 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9874273119914833, 'loss_val': 0.03504777031582377, 'psi': 0.9914900937890572}-{'f1_val': 0.9934667705418724, 'auprc': 0.9901782479603115, 'loss_val': 0.03967106704052913, 'psi': 0.9921513615092481}
[S8] not sending this round → trigger blocked (psi=0.991)
[S9] START round=60 head_norm_before_train=1.659899 cos_to_last_merge=0.9949 (last merge round=44)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9888602739236441, 'auprc': 0.9913407375753482, 'loss_val': 0.04751184978318216, 'psi': 0.9898524593843258}-{'f1_val': 0.9966924912647621, 'auprc': 0.993529399049388, 'loss_val': 0.02367014163297155, 'psi': 0.9954272543786125}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=1.970856 cos_to_last_merge=0.9915 (last merge round=45)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9966415814618288, 'loss_val': 0.028134986174671802, 'psi': 0.9954552655903814}-{'f1_val': 0.9948838907637279, 'auprc': 0.996492236690889, 'loss_val': 0.02817103629123942, 'psi': 0.9955272291345924}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=1.957168 cos_to_last_merge=0.9971 (last merge round=43)
[S11] round=60 local utility u=0.000145 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9951425760223035, 'loss_val': 0.020448071682514876, 'psi': 0.9962355843846677}-{'f1_val': 0.9969642566262439, 'auprc': 0.9951766023752591, 'loss_val': 0.02084042335608635, 'psi': 0.9962491949258498}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=60 head_norm_before_train=1.564685 cos_to_last_merge=0.9703 (last merge round=35)
[S13] round=60 local utility u=0.077805 metrics={'f1_val': 0.6516591461518261, 'auprc': 0.7856837417018627, 'loss_val': 0.9207600119826302, 'psi': 0.7052689843718407}-{'f1_val': 0.6387154844310179, 'auprc': 0.753805865382791, 'loss_val': 0.9030747254593896, 'psi': 0.6847516368117272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=60 head_norm_before_train=1.814556 cos_to_last_merge=0.9780 (last merge round=37)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963222473248441, 'auprc': 0.998525125004954, 'loss_val': 0.032819487218613996, 'psi': 0.997203398396888}-{'f1_val': 0.9965652232429598, 'auprc': 0.9988687637050092, 'loss_val': 0.031244887629932532, 'psi': 0.9974866394277796}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.911798 cos_to_last_merge=0.9780 (last merge round=43)
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8866883358549889, 'auprc': 0.9962133309314134, 'loss_val': 0.1928158446274745, 'psi': 0.9304983338855586}-{'f1_val': 0.9402683682135957, 'auprc': 0.9973687136082697, 'loss_val': 0.07860139049836744, 'psi': 0.9631085063714654}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.693120 cos_to_last_merge=0.9932 (last merge round=44)
[S16] round=60 local utility u=0.131484 metrics={'f1_val': 0.8813989749681264, 'auprc': 0.9908076859433711, 'loss_val': 0.523845800124489, 'psi': 0.9251624593582243}-{'f1_val': 0.8674997161925248, 'auprc': 0.9914145685103675, 'loss_val': 0.7052394976818581, 'psi': 0.9170656571196618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=60 head_norm_before_train=1.683401 cos_to_last_merge=0.9837 (last merge round=41)
[S17] round=60 local utility u=0.266536 metrics={'f1_val': 0.6282535689168722, 'auprc': 0.8718795509814827, 'loss_val': 1.1353786355566162, 'psi': 0.7257039617427165}-{'f1_val': 0.5949243153952504, 'auprc': 0.8180531979445278, 'loss_val': 1.3069965223114965, 'psi': 0.6841758684149614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=61 head_norm_before_train=2.099757 (no previous merge yet)
[S2] round=61 local utility u=0.000754 metrics={'f1_val': 0.8291699591142071, 'auprc': 0.8319156507872808, 'loss_val': 0.4655888253858531, 'psi': 0.8302682357834366}-{'f1_val': 0.8276066689461687, 'auprc': 0.8345748716433152, 'loss_val': 0.4656949823141924, 'psi': 0.8303939500250274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=61 head_norm_before_train=2.066057 cos_to_last_merge=0.9752 (last merge round=43)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9308903609777442, 'auprc': 0.9851733927304405, 'loss_val': 0.24482365685812374, 'psi': 0.9526035736788228}-{'f1_val': 0.9288934088196863, 'auprc': 0.9981509243508195, 'loss_val': 0.137546149734417, 'psi': 0.9565964150321397}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.708568 cos_to_last_merge=0.9973 (last merge round=44)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.940196277554945, 'auprc': 0.9626346093047513, 'loss_val': 0.29368334362564463, 'psi': 0.9491716102548675}-{'f1_val': 0.9400360499041569, 'auprc': 0.9721624614593471, 'loss_val': 0.2900762183429758, 'psi': 0.952886614526233}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.921236 cos_to_last_merge=0.8320 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=61 local utility u=0.002795 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9978953518921125, 'loss_val': 0.027144815339747063, 'psi': 0.9967820759002681}-{'f1_val': 0.9957741494321548, 'auprc': 0.9976744135484644, 'loss_val': 0.030476564439086706, 'psi': 0.9965342550786787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=61 head_norm_before_train=1.927078 cos_to_last_merge=0.9978 (last merge round=43)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.67342124373554, 'auprc': 0.9396634593285742, 'loss_val': 0.7887885523469694, 'psi': 0.7799181299727537}-{'f1_val': 0.8481955362436334, 'auprc': 0.9486207347897968, 'loss_val': 0.38893496748876666, 'psi': 0.8883656156620987}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=2.058838 cos_to_last_merge=0.9831 (last merge round=43)
[S7] round=61 local utility u=0.277184 metrics={'f1_val': 0.9347010916356258, 'auprc': 0.9827655017528613, 'loss_val': 0.15229724509107598, 'psi': 0.95392685568252}-{'f1_val': 0.8885074110299368, 'auprc': 0.9644669491116371, 'loss_val': 0.3746073715926338, 'psi': 0.918891226262617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=61 head_norm_before_train=1.692242 cos_to_last_merge=0.9904 (last merge round=42)
[S8] round=61 local utility u=0.016653 metrics={'f1_val': 0.9943205514018633, 'auprc': 0.998135198469875, 'loss_val': 0.0345977859384519, 'psi': 0.995846410229068}-{'f1_val': 0.9941986149874398, 'auprc': 0.9874273119914833, 'loss_val': 0.03504777031582377, 'psi': 0.9914900937890572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=61 head_norm_before_train=1.669271 cos_to_last_merge=0.9946 (last merge round=44)
[S9] round=61 local utility u=0.037965 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9929004683138807, 'loss_val': 0.023254725264346243, 'psi': 0.9951756820844095}-{'f1_val': 0.9888602739236441, 'auprc': 0.9913407375753482, 'loss_val': 0.04751184978318216, 'psi': 0.9898524593843258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=61 head_norm_before_train=1.981181 cos_to_last_merge=0.9910 (last merge round=45)
[S10] round=61 local utility u=0.000091 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9965946797759169, 'loss_val': 0.027813080114213323, 'psi': 0.9954365049160165}-{'f1_val': 0.9946643883427498, 'auprc': 0.9966415814618288, 'loss_val': 0.028134986174671802, 'psi': 0.9954552655903814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=61 head_norm_before_train=1.966452 cos_to_last_merge=0.9968 (last merge round=43)
[S11] round=61 local utility u=0.000220 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9951638797608227, 'loss_val': 0.0200722936862967, 'psi': 0.9962441058800753}-{'f1_val': 0.9969642566262439, 'auprc': 0.9951425760223035, 'loss_val': 0.020448071682514876, 'psi': 0.9962355843846677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=61 head_norm_before_train=1.572679 cos_to_last_merge=0.9694 (last merge round=35)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6246875263714489, 'auprc': 0.8085547350484126, 'loss_val': 0.955838379151486, 'psi': 0.6982344098422344}-{'f1_val': 0.6516591461518261, 'auprc': 0.7856837417018627, 'loss_val': 0.9207600119826302, 'psi': 0.7052689843718407}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.820724 cos_to_last_merge=0.9774 (last merge round=37)
[S14] round=61 local utility u=0.002485 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.99844518713391, 'loss_val': 0.031529176226648775, 'psi': 0.9975633749038298}-{'f1_val': 0.9963222473248441, 'auprc': 0.998525125004954, 'loss_val': 0.032819487218613996, 'psi': 0.997203398396888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=61 head_norm_before_train=1.924538 cos_to_last_merge=0.9771 (last merge round=43)
[S15] round=61 local utility u=0.193074 metrics={'f1_val': 0.9336336403945319, 'auprc': 0.9975214005579428, 'loss_val': 0.0922633111623455, 'psi': 0.9591887444598963}-{'f1_val': 0.8866883358549889, 'auprc': 0.9962133309314134, 'loss_val': 0.1928158446274745, 'psi': 0.9304983338855586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=61 head_norm_before_train=1.701180 cos_to_last_merge=0.9928 (last merge round=44)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8713192472328188, 'auprc': 0.989551918201813, 'loss_val': 0.6153034129756995, 'psi': 0.9186123156204166}-{'f1_val': 0.8813989749681264, 'auprc': 0.9908076859433711, 'loss_val': 0.523845800124489, 'psi': 0.9251624593582243}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.689098 cos_to_last_merge=0.9832 (last merge round=41)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.607400203498462, 'auprc': 0.8222403845932517, 'loss_val': 1.25655533467293, 'psi': 0.6933362759363779}-{'f1_val': 0.6282535689168722, 'auprc': 0.8718795509814827, 'loss_val': 1.1353786355566162, 'psi': 0.7257039617427165}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.108440 (no previous merge yet)
[S2] round=62 local utility u=0.002804 metrics={'f1_val': 0.8291699591142071, 'auprc': 0.8355008772587171, 'loss_val': 0.4707366905131757, 'psi': 0.8317023263720111}-{'f1_val': 0.8291699591142071, 'auprc': 0.8319156507872808, 'loss_val': 0.4655888253858531, 'psi': 0.8302682357834366}
[S2] not sending this round → trigger blocked (psi=0.832)
[S3] START round=62 head_norm_before_train=2.074028 cos_to_last_merge=0.9747 (last merge round=43)
[S3] round=62 local utility u=0.333889 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9996226007004335, 'loss_val': 0.017912705742589324, 'psi': 0.9981351223696163}-{'f1_val': 0.9308903609777442, 'auprc': 0.9851733927304405, 'loss_val': 0.24482365685812374, 'psi': 0.9526035736788228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=62 head_norm_before_train=1.713321 cos_to_last_merge=0.9971 (last merge round=44)
[S4] round=62 local utility u=0.027278 metrics={'f1_val': 0.9435446096297625, 'auprc': 0.9690098283318309, 'loss_val': 0.27834388492760476, 'psi': 0.9537306971105899}-{'f1_val': 0.940196277554945, 'auprc': 0.9626346093047513, 'loss_val': 0.29368334362564463, 'psi': 0.9491716102548675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=62 head_norm_before_train=1.925635 cos_to_last_merge=0.8317 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9951753527027533, 'loss_val': 0.02735759484883429, 'psi': 0.9955186506847751}-{'f1_val': 0.9960398919057053, 'auprc': 0.9978953518921125, 'loss_val': 0.027144815339747063, 'psi': 0.9967820759002681}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=1.934182 cos_to_last_merge=0.9975 (last merge round=43)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6946976549275635, 'auprc': 0.8343274252503641, 'loss_val': 0.9333425635212932, 'psi': 0.7505495630566837}-{'f1_val': 0.67342124373554, 'auprc': 0.9396634593285742, 'loss_val': 0.7887885523469694, 'psi': 0.7799181299727537}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=2.081349 cos_to_last_merge=0.9813 (last merge round=43)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.9032169829107493, 'auprc': 0.9810681053530472, 'loss_val': 0.3303873033149491, 'psi': 0.9343574318876685}-{'f1_val': 0.9347010916356258, 'auprc': 0.9827655017528613, 'loss_val': 0.15229724509107598, 'psi': 0.95392685568252}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=1.697966 cos_to_last_merge=0.9901 (last merge round=42)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9389179713543918, 'auprc': 0.9983206667902724, 'loss_val': 0.16181415483020897, 'psi': 0.9626790495287441}-{'f1_val': 0.9943205514018633, 'auprc': 0.998135198469875, 'loss_val': 0.0345977859384519, 'psi': 0.995846410229068}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.677124 cos_to_last_merge=0.9943 (last merge round=44)
[S9] round=62 local utility u=0.004930 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.995938139779522, 'loss_val': 0.0223160289558122, 'psi': 0.9963715630001436}-{'f1_val': 0.9966924912647621, 'auprc': 0.9929004683138807, 'loss_val': 0.023254725264346243, 'psi': 0.9951756820844095}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=62 head_norm_before_train=1.991506 cos_to_last_merge=0.9905 (last merge round=45)
[S10] round=62 local utility u=0.001269 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9964100169768051, 'loss_val': 0.02735501799113884, 'psi': 0.9956260876363809}-{'f1_val': 0.9946643883427498, 'auprc': 0.9965946797759169, 'loss_val': 0.027813080114213323, 'psi': 0.9954365049160165}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=62 head_norm_before_train=1.975479 cos_to_last_merge=0.9966 (last merge round=43)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954374983108104, 'loss_val': 0.020143391611466208, 'psi': 0.9961055523213825}-{'f1_val': 0.9969642566262439, 'auprc': 0.9951638797608227, 'loss_val': 0.0200722936862967, 'psi': 0.9962441058800753}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.578128 cos_to_last_merge=0.9688 (last merge round=35)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5911460208155197, 'auprc': 0.721674983376773, 'loss_val': 1.0610583894648287, 'psi': 0.643357605840021}-{'f1_val': 0.6246875263714489, 'auprc': 0.8085547350484126, 'loss_val': 0.955838379151486, 'psi': 0.6982344098422344}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.827260 cos_to_last_merge=0.9768 (last merge round=37)
[S14] round=62 local utility u=0.001261 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985611232527003, 'loss_val': 0.029354208497506765, 'psi': 0.9976097493513459}-{'f1_val': 0.9969755000837764, 'auprc': 0.99844518713391, 'loss_val': 0.031529176226648775, 'psi': 0.9975633749038298}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=62 head_norm_before_train=1.935798 cos_to_last_merge=0.9762 (last merge round=43)
[S15] round=62 local utility u=0.213805 metrics={'f1_val': 0.9938619664327626, 'auprc': 0.9985249745539247, 'loss_val': 0.029034880916505197, 'psi': 0.9957271696812274}-{'f1_val': 0.9336336403945319, 'auprc': 0.9975214005579428, 'loss_val': 0.0922633111623455, 'psi': 0.9591887444598963}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=62 head_norm_before_train=1.710196 cos_to_last_merge=0.9924 (last merge round=44)
[S16] round=62 local utility u=0.643849 metrics={'f1_val': 0.9908285605912204, 'auprc': 0.9924005946408847, 'loss_val': 0.053207829269072006, 'psi': 0.9914573742110862}-{'f1_val': 0.8713192472328188, 'auprc': 0.989551918201813, 'loss_val': 0.6153034129756995, 'psi': 0.9186123156204166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=62 head_norm_before_train=1.694353 cos_to_last_merge=0.9828 (last merge round=41)
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.5274557026502038, 'auprc': 0.6741695384569408, 'loss_val': 1.4400918730966217, 'psi': 0.5861412369728987}-{'f1_val': 0.607400203498462, 'auprc': 0.8222403845932517, 'loss_val': 1.25655533467293, 'psi': 0.6933362759363779}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.116764 (no previous merge yet)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.8307240287991268, 'auprc': 0.8275841281429145, 'loss_val': 0.46951558526018117, 'psi': 0.8294680685366418}-{'f1_val': 0.8291699591142071, 'auprc': 0.8355008772587171, 'loss_val': 0.4707366905131757, 'psi': 0.8317023263720111}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.082035 cos_to_last_merge=0.9742 (last merge round=43)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.8904102626533875, 'auprc': 0.8805742545470107, 'loss_val': 0.4785728071928282, 'psi': 0.8864758594108368}-{'f1_val': 0.9971434701490716, 'auprc': 0.9996226007004335, 'loss_val': 0.017912705742589324, 'psi': 0.9981351223696163}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.718243 cos_to_last_merge=0.9970 (last merge round=44)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.9457867346308099, 'auprc': 0.9633768325368475, 'loss_val': 0.2781644304044605, 'psi': 0.9528227737932249}-{'f1_val': 0.9435446096297625, 'auprc': 0.9690098283318309, 'loss_val': 0.27834388492760476, 'psi': 0.9537306971105899}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.925541 cos_to_last_merge=0.8318 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=63 local utility u=0.003636 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9976057355163409, 'loss_val': 0.029131520093171465, 'psi': 0.9966662293499595}-{'f1_val': 0.9957475160061228, 'auprc': 0.9951753527027533, 'loss_val': 0.02735759484883429, 'psi': 0.9955186506847751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=63 head_norm_before_train=1.943031 cos_to_last_merge=0.9972 (last merge round=43)
[S6] round=63 local utility u=0.409589 metrics={'f1_val': 0.763677166454368, 'auprc': 0.9263356763389752, 'loss_val': 0.8040664517502112, 'psi': 0.8287405704082109}-{'f1_val': 0.6946976549275635, 'auprc': 0.8343274252503641, 'loss_val': 0.9333425635212932, 'psi': 0.7505495630566837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=63 head_norm_before_train=2.099200 cos_to_last_merge=0.9799 (last merge round=43)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5536018370332166, 'auprc': 0.8635111258422724, 'loss_val': 1.5344354957093154, 'psi': 0.6775655525568389}-{'f1_val': 0.9032169829107493, 'auprc': 0.9810681053530472, 'loss_val': 0.3303873033149491, 'psi': 0.9343574318876685}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.702876 cos_to_last_merge=0.9899 (last merge round=42)
[S8] round=63 local utility u=0.223641 metrics={'f1_val': 0.9926820383061284, 'auprc': 0.9986231366461948, 'loss_val': 0.03802427099212334, 'psi': 0.9950584776421549}-{'f1_val': 0.9389179713543918, 'auprc': 0.9983206667902724, 'loss_val': 0.16181415483020897, 'psi': 0.9626790495287441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=63 head_norm_before_train=1.685473 cos_to_last_merge=0.9939 (last merge round=44)
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9984682045325122, 'loss_val': 0.030443444212079583, 'psi': 0.9957331461486765}-{'f1_val': 0.9966605118138915, 'auprc': 0.995938139779522, 'loss_val': 0.0223160289558122, 'psi': 0.9963715630001436}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=2.001692 cos_to_last_merge=0.9900 (last merge round=45)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9965736366546787, 'loss_val': 0.027318613152757278, 'psi': 0.9954280876675213}-{'f1_val': 0.9951034680760983, 'auprc': 0.9964100169768051, 'loss_val': 0.02735501799113884, 'psi': 0.9956260876363809}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.983630 cos_to_last_merge=0.9963 (last merge round=43)
[S11] round=63 local utility u=0.002252 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9967716683784216, 'loss_val': 0.019641650542406287, 'psi': 0.996639220348427}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954374983108104, 'loss_val': 0.020143391611466208, 'psi': 0.9961055523213825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=63 head_norm_before_train=1.582680 cos_to_last_merge=0.9683 (last merge round=35)
[S13] round=63 local utility u=0.417321 metrics={'f1_val': 0.6525312433370731, 'auprc': 0.7851395320725856, 'loss_val': 0.7851221678769688, 'psi': 0.7055745588312781}-{'f1_val': 0.5911460208155197, 'auprc': 0.721674983376773, 'loss_val': 1.0610583894648287, 'psi': 0.643357605840021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=63 head_norm_before_train=1.835137 cos_to_last_merge=0.9762 (last merge round=37)
[S14] round=63 local utility u=0.000951 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9989605969847811, 'loss_val': 0.028651211862236726, 'psi': 0.9977695388441783}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985611232527003, 'loss_val': 0.029354208497506765, 'psi': 0.9976097493513459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=63 head_norm_before_train=1.947191 cos_to_last_merge=0.9754 (last merge round=43)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.9275920740529995, 'auprc': 0.9975282499649136, 'loss_val': 0.10638649445339145, 'psi': 0.9555665444177652}-{'f1_val': 0.9938619664327626, 'auprc': 0.9985249745539247, 'loss_val': 0.029034880916505197, 'psi': 0.9957271696812274}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.718824 cos_to_last_merge=0.9920 (last merge round=44)
[S16] round=63 local utility u=0.001179 metrics={'f1_val': 0.9910698248635139, 'auprc': 0.9909221686974392, 'loss_val': 0.04786212670815169, 'psi': 0.9910107623970841}-{'f1_val': 0.9908285605912204, 'auprc': 0.9924005946408847, 'loss_val': 0.053207829269072006, 'psi': 0.9914573742110862}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=63 head_norm_before_train=1.701815 cos_to_last_merge=0.9822 (last merge round=41)
[S17] round=63 local utility u=0.685760 metrics={'f1_val': 0.6289018703115032, 'auprc': 0.8438856188698947, 'loss_val': 1.1863964425133378, 'psi': 0.7148953697348598}-{'f1_val': 0.5274557026502038, 'auprc': 0.6741695384569408, 'loss_val': 1.4400918730966217, 'psi': 0.5861412369728987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=64 head_norm_before_train=2.125361 (no previous merge yet)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.8263172691985475, 'auprc': 0.8146415344286791, 'loss_val': 0.4981851235062675, 'psi': 0.8216469752906002}-{'f1_val': 0.8307240287991268, 'auprc': 0.8275841281429145, 'loss_val': 0.46951558526018117, 'psi': 0.8294680685366418}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.088592 cos_to_last_merge=0.9737 (last merge round=43)
[S3] round=64 local utility u=0.548354 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9989255244994051, 'loss_val': 0.15937835667661793, 'psi': 0.9760624016612427}-{'f1_val': 0.8904102626533875, 'auprc': 0.8805742545470107, 'loss_val': 0.4785728071928282, 'psi': 0.8864758594108368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=64 head_norm_before_train=1.722937 cos_to_last_merge=0.9966 (last merge round=44)
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9447864622232803, 'auprc': 0.9647057327176333, 'loss_val': 0.2784249094300102, 'psi': 0.9527541704210215}-{'f1_val': 0.9457867346308099, 'auprc': 0.9633768325368475, 'loss_val': 0.2781644304044605, 'psi': 0.9528227737932249}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=1.923796 cos_to_last_merge=0.8321 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9975941558135779, 'loss_val': 0.029053176489285137, 'psi': 0.9965736565966348}-{'f1_val': 0.9960398919057053, 'auprc': 0.9976057355163409, 'loss_val': 0.029131520093171465, 'psi': 0.9966662293499595}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.954128 cos_to_last_merge=0.9969 (last merge round=43)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.7242509524753343, 'auprc': 0.8829273809122531, 'loss_val': 0.8571547494607803, 'psi': 0.7877215238501019}-{'f1_val': 0.763677166454368, 'auprc': 0.9263356763389752, 'loss_val': 0.8040664517502112, 'psi': 0.8287405704082109}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=2.108710 cos_to_last_merge=0.9794 (last merge round=43)
[S7] round=64 local utility u=1.000000 metrics={'f1_val': 0.9155706298191291, 'auprc': 0.9815659067167566, 'loss_val': 0.2615430195706303, 'psi': 0.94196874057818}-{'f1_val': 0.5536018370332166, 'auprc': 0.8635111258422724, 'loss_val': 1.5344354957093154, 'psi': 0.6775655525568389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=64 head_norm_before_train=1.704758 cos_to_last_merge=0.9898 (last merge round=42)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9981823862829791, 'loss_val': 0.0386046723140307, 'psi': 0.994749302252572}-{'f1_val': 0.9926820383061284, 'auprc': 0.9986231366461948, 'loss_val': 0.03802427099212334, 'psi': 0.9950584776421549}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=1.694083 cos_to_last_merge=0.9936 (last merge round=44)
[S9] round=64 local utility u=0.010638 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9984668129707355, 'loss_val': 0.023180504622176898, 'psi': 0.9971343941678257}-{'f1_val': 0.993909773892786, 'auprc': 0.9984682045325122, 'loss_val': 0.030443444212079583, 'psi': 0.9957331461486765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=64 head_norm_before_train=2.011715 cos_to_last_merge=0.9895 (last merge round=45)
[S10] round=64 local utility u=0.000339 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9967456461184405, 'loss_val': 0.027155647609285103, 'psi': 0.995496891453026}-{'f1_val': 0.9946643883427498, 'auprc': 0.9965736366546787, 'loss_val': 0.027318613152757278, 'psi': 0.9954280876675213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=64 head_norm_before_train=1.989275 cos_to_last_merge=0.9960 (last merge round=43)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9952968475159762, 'loss_val': 0.01972341971267091, 'psi': 0.9960492920034488}-{'f1_val': 0.9965509216617638, 'auprc': 0.9967716683784216, 'loss_val': 0.019641650542406287, 'psi': 0.996639220348427}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.584381 cos_to_last_merge=0.9681 (last merge round=35)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.5988460945884222, 'auprc': 0.751105861665682, 'loss_val': 1.142454138224513, 'psi': 0.6597500014193262}-{'f1_val': 0.6525312433370731, 'auprc': 0.7851395320725856, 'loss_val': 0.7851221678769688, 'psi': 0.7055745588312781}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.842440 cos_to_last_merge=0.9756 (last merge round=37)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9988637129663146, 'loss_val': 0.02861499981379729, 'psi': 0.9977459131150725}-{'f1_val': 0.9969755000837764, 'auprc': 0.9989605969847811, 'loss_val': 0.028651211862236726, 'psi': 0.9977695388441783}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=1.957857 cos_to_last_merge=0.9746 (last merge round=43)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.897401060907727, 'auprc': 0.9970319289623637, 'loss_val': 0.1873210212401129, 'psi': 0.9372534081295816}-{'f1_val': 0.9275920740529995, 'auprc': 0.9975282499649136, 'loss_val': 0.10638649445339145, 'psi': 0.9555665444177652}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.727353 cos_to_last_merge=0.9917 (last merge round=44)
[S16] round=64 local utility u=0.004120 metrics={'f1_val': 0.9912646484371039, 'auprc': 0.9925691454304011, 'loss_val': 0.0457310105765178, 'psi': 0.9917864472344228}-{'f1_val': 0.9910698248635139, 'auprc': 0.9909221686974392, 'loss_val': 0.04786212670815169, 'psi': 0.9910107623970841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=64 head_norm_before_train=1.711981 cos_to_last_merge=0.9814 (last merge round=41)
[S17] round=64 local utility u=0.108387 metrics={'f1_val': 0.6370458265189225, 'auprc': 0.8750866769328729, 'loss_val': 1.1120890071827199, 'psi': 0.7322621666845026}-{'f1_val': 0.6289018703115032, 'auprc': 0.8438856188698947, 'loss_val': 1.1863964425133378, 'psi': 0.7148953697348598}
[S17] not sending this round → trigger blocked (psi=0.732)
[S2] START round=65 head_norm_before_train=2.127839 (no previous merge yet)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7355333600966097, 'auprc': 0.7535262677082404, 'loss_val': 0.785342460910714, 'psi': 0.742730523141262}-{'f1_val': 0.8263172691985475, 'auprc': 0.8146415344286791, 'loss_val': 0.4981851235062675, 'psi': 0.8216469752906002}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=65 head_norm_before_train=2.094775 cos_to_last_merge=0.9732 (last merge round=43)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.98945433108313, 'loss_val': 0.1644677659806417, 'psi': 0.9724508867739434}-{'f1_val': 0.9608203197691346, 'auprc': 0.9989255244994051, 'loss_val': 0.15937835667661793, 'psi': 0.9760624016612427}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.730959 cos_to_last_merge=0.9965 (last merge round=44)
[S4] round=65 local utility u=0.001149 metrics={'f1_val': 0.9465323767941175, 'auprc': 0.9618380158977804, 'loss_val': 0.277998758916898, 'psi': 0.9526546324355827}-{'f1_val': 0.9447864622232803, 'auprc': 0.9647057327176333, 'loss_val': 0.2784249094300102, 'psi': 0.9527541704210215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=65 head_norm_before_train=1.921591 cos_to_last_merge=0.8321 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=65 local utility u=0.001598 metrics={'f1_val': 0.9960398919057053, 'auprc': 0.9979475829840201, 'loss_val': 0.027796005102761322, 'psi': 0.9968029683370312}-{'f1_val': 0.9958933237853395, 'auprc': 0.9975941558135779, 'loss_val': 0.029053176489285137, 'psi': 0.9965736565966348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=65 head_norm_before_train=1.960071 cos_to_last_merge=0.9964 (last merge round=43)
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.5959463264856115, 'auprc': 0.5968908258243715, 'loss_val': 1.5010628260202232, 'psi': 0.5963241262211155}-{'f1_val': 0.7242509524753343, 'auprc': 0.8829273809122531, 'loss_val': 0.8571547494607803, 'psi': 0.7877215238501019}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=2.111800 cos_to_last_merge=0.9793 (last merge round=43)
[S7] round=65 local utility u=0.198593 metrics={'f1_val': 0.9581276877652201, 'auprc': 0.9881755417605296, 'loss_val': 0.1395290790236485, 'psi': 0.970146829363344}-{'f1_val': 0.9155706298191291, 'auprc': 0.9815659067167566, 'loss_val': 0.2615430195706303, 'psi': 0.94196874057818}
[S7] not sending this round → trigger blocked (psi=0.970)
[S8] START round=65 head_norm_before_train=1.710276 cos_to_last_merge=0.9895 (last merge round=42)
[S8] round=65 local utility u=0.001170 metrics={'f1_val': 0.9924509553239076, 'auprc': 0.9980664545665592, 'loss_val': 0.03585986651352216, 'psi': 0.9946971550209682}-{'f1_val': 0.9924605795656339, 'auprc': 0.9981823862829791, 'loss_val': 0.0386046723140307, 'psi': 0.994749302252572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=65 head_norm_before_train=1.704089 cos_to_last_merge=0.9932 (last merge round=44)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953077600502026, 'loss_val': 0.022089055709044694, 'psi': 0.996119411108416}-{'f1_val': 0.9962461149658858, 'auprc': 0.9984668129707355, 'loss_val': 0.023180504622176898, 'psi': 0.9971343941678257}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.018589 cos_to_last_merge=0.9891 (last merge round=45)
[S10] round=65 local utility u=0.000590 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970767316683194, 'loss_val': 0.026968104764507967, 'psi': 0.9956293256729776}-{'f1_val': 0.9946643883427498, 'auprc': 0.9967456461184405, 'loss_val': 0.027155647609285103, 'psi': 0.995496891453026}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=65 head_norm_before_train=1.995668 cos_to_last_merge=0.9958 (last merge round=43)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9948584493302608, 'loss_val': 0.021552603571185918, 'psi': 0.9957288305023255}-{'f1_val': 0.9965509216617638, 'auprc': 0.9952968475159762, 'loss_val': 0.01972341971267091, 'psi': 0.9960492920034488}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.585880 cos_to_last_merge=0.9679 (last merge round=35)
[S13] round=65 local utility u=0.223239 metrics={'f1_val': 0.6305231025628947, 'auprc': 0.7593801593668443, 'loss_val': 0.9108614031352315, 'psi': 0.6820659252844745}-{'f1_val': 0.5988460945884222, 'auprc': 0.751105861665682, 'loss_val': 1.142454138224513, 'psi': 0.6597500014193262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] sending update (kind=head size=1792 to 1 peers)
[S14] START round=65 head_norm_before_train=1.849312 cos_to_last_merge=0.9751 (last merge round=37)
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9985356288907663, 'loss_val': 0.02866635857336765, 'psi': 0.9976015579174291}-{'f1_val': 0.9970007132142444, 'auprc': 0.9988637129663146, 'loss_val': 0.02861499981379729, 'psi': 0.9977459131150725}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.968382 cos_to_last_merge=0.9738 (last merge round=43)
[S15] round=65 local utility u=0.300331 metrics={'f1_val': 0.9735903377014359, 'auprc': 0.9980372562073344, 'loss_val': 0.046811359183036874, 'psi': 0.9833691051037953}-{'f1_val': 0.897401060907727, 'auprc': 0.9970319289623637, 'loss_val': 0.1873210212401129, 'psi': 0.9372534081295816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=65 head_norm_before_train=1.736153 cos_to_last_merge=0.9913 (last merge round=44)
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9910495074682953, 'auprc': 0.9925542788676551, 'loss_val': 0.047208656049155945, 'psi': 0.9916514160280392}-{'f1_val': 0.9912646484371039, 'auprc': 0.9925691454304011, 'loss_val': 0.0457310105765178, 'psi': 0.9917864472344228}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.721029 cos_to_last_merge=0.9807 (last merge round=41)
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.614494298272005, 'auprc': 0.8004648285813147, 'loss_val': 1.3240493574518784, 'psi': 0.6888825103957289}-{'f1_val': 0.6370458265189225, 'auprc': 0.8750866769328729, 'loss_val': 1.1120890071827199, 'psi': 0.7322621666845026}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=2.132952 (no previous merge yet)
[S2] round=66 local utility u=0.464338 metrics={'f1_val': 0.8211453602139931, 'auprc': 0.8074519077307296, 'loss_val': 0.5321151060678028, 'psi': 0.8156679792206877}-{'f1_val': 0.7355333600966097, 'auprc': 0.7535262677082404, 'loss_val': 0.785342460910714, 'psi': 0.742730523141262}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=66 head_norm_before_train=2.101999 cos_to_last_merge=0.9727 (last merge round=43)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.9470427290892212, 'auprc': 0.9755179042790734, 'loss_val': 0.2021763437771375, 'psi': 0.9584327991651621}-{'f1_val': 0.9611152572344858, 'auprc': 0.98945433108313, 'loss_val': 0.1644677659806417, 'psi': 0.9724508867739434}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=1.739178 cos_to_last_merge=0.9962 (last merge round=44)
[S4] round=66 local utility u=0.026601 metrics={'f1_val': 0.9511243860413766, 'auprc': 0.9698467118072794, 'loss_val': 0.2763753886159664, 'psi': 0.9586133163477377}-{'f1_val': 0.9465323767941175, 'auprc': 0.9618380158977804, 'loss_val': 0.277998758916898, 'psi': 0.9526546324355827}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=66 head_norm_before_train=1.916675 cos_to_last_merge=0.8320 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9922683656164712, 'loss_val': 0.02927207597440749, 'psi': 0.9944433405177922}-{'f1_val': 0.9960398919057053, 'auprc': 0.9979475829840201, 'loss_val': 0.027796005102761322, 'psi': 0.9968029683370312}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=66 head_norm_before_train=1.966577 cos_to_last_merge=0.9960 (last merge round=43)
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.7078474453727757, 'auprc': 0.8607405502922112, 'loss_val': 0.8493155844284275, 'psi': 0.7690046873405498}-{'f1_val': 0.5959463264856115, 'auprc': 0.5968908258243715, 'loss_val': 1.5010628260202232, 'psi': 0.5963241262211155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=66 head_norm_before_train=2.111667 cos_to_last_merge=0.9795 (last merge round=43)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.6630392784925772, 'auprc': 0.9657591680746511, 'loss_val': 0.9949312329366329, 'psi': 0.7841272343254068}-{'f1_val': 0.9581276877652201, 'auprc': 0.9881755417605296, 'loss_val': 0.1395290790236485, 'psi': 0.970146829363344}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=1.718100 cos_to_last_merge=0.9891 (last merge round=42)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9934815081849845, 'auprc': 0.9885308978698764, 'loss_val': 0.03645670413086438, 'psi': 0.9915012640589412}-{'f1_val': 0.9924509553239076, 'auprc': 0.9980664545665592, 'loss_val': 0.03585986651352216, 'psi': 0.9946971550209682}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=1.712897 cos_to_last_merge=0.9928 (last merge round=44)
[S9] round=66 local utility u=0.000121 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9953051683618778, 'loss_val': 0.02183946021246112, 'psi': 0.9961183744330859}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953077600502026, 'loss_val': 0.022089055709044694, 'psi': 0.996119411108416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=66 head_norm_before_train=2.026038 cos_to_last_merge=0.9887 (last merge round=45)
[S10] round=66 local utility u=0.000160 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9971416613480582, 'loss_val': 0.02684195265566855, 'psi': 0.9956552975448731}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970767316683194, 'loss_val': 0.026968104764507967, 'psi': 0.9956293256729776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=66 head_norm_before_train=2.002442 cos_to_last_merge=0.9955 (last merge round=43)
[S11] round=66 local utility u=0.004912 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9971514275946078, 'loss_val': 0.02005803463767656, 'psi': 0.9967911240349014}-{'f1_val': 0.9963090846170353, 'auprc': 0.9948584493302608, 'loss_val': 0.021552603571185918, 'psi': 0.9957288305023255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=66 head_norm_before_train=1.585838 cos_to_last_merge=0.9679 (last merge round=35)
[S13] round=66 local utility u=0.273073 metrics={'f1_val': 0.6771638646038879, 'auprc': 0.7814394187162774, 'loss_val': 0.7107375953980006, 'psi': 0.7188740862488437}-{'f1_val': 0.6305231025628947, 'auprc': 0.7593801593668443, 'loss_val': 0.9108614031352315, 'psi': 0.6820659252844745}
[S13] not sending this round → trigger blocked (psi=0.719)
[S14] START round=66 head_norm_before_train=1.857484 cos_to_last_merge=0.9744 (last merge round=37)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9984139680303733, 'loss_val': 0.029525826824221318, 'psi': 0.9973047211579252}-{'f1_val': 0.9969788439352044, 'auprc': 0.9985356288907663, 'loss_val': 0.02866635857336765, 'psi': 0.9976015579174291}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.978677 cos_to_last_merge=0.9730 (last merge round=43)
[S15] round=66 local utility u=0.082263 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9977407314502469, 'loss_val': 0.022918010466149795, 'psi': 0.9974026957868707}-{'f1_val': 0.9735903377014359, 'auprc': 0.9980372562073344, 'loss_val': 0.046811359183036874, 'psi': 0.9833691051037953}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=66 head_norm_before_train=1.743757 cos_to_last_merge=0.9911 (last merge round=44)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.9910958328639886, 'auprc': 0.9910336200368177, 'loss_val': 0.049385173875217285, 'psi': 0.9910709477331202}-{'f1_val': 0.9910495074682953, 'auprc': 0.9925542788676551, 'loss_val': 0.047208656049155945, 'psi': 0.9916514160280392}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=66 head_norm_before_train=1.729485 cos_to_last_merge=0.9800 (last merge round=41)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.5783631472827322, 'auprc': 0.7429388381456746, 'loss_val': 1.286996300719375, 'psi': 0.6441934236279092}-{'f1_val': 0.614494298272005, 'auprc': 0.8004648285813147, 'loss_val': 1.3240493574518784, 'psi': 0.6888825103957289}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.140047 (no previous merge yet)
[S2] round=67 local utility u=0.185944 metrics={'f1_val': 0.8260340547897453, 'auprc': 0.9035832847871267, 'loss_val': 0.477954142344938, 'psi': 0.8570537467886978}-{'f1_val': 0.8211453602139931, 'auprc': 0.8074519077307296, 'loss_val': 0.5321151060678028, 'psi': 0.8156679792206877}
[S2] not sending this round → trigger blocked (psi=0.857)
[S3] START round=67 head_norm_before_train=2.109590 cos_to_last_merge=0.9722 (last merge round=43)
[S3] round=67 local utility u=0.162516 metrics={'f1_val': 0.9729279712569923, 'auprc': 0.996666813693131, 'loss_val': 0.09590215402493414, 'psi': 0.9824235082314478}-{'f1_val': 0.9470427290892212, 'auprc': 0.9755179042790734, 'loss_val': 0.2021763437771375, 'psi': 0.9584327991651621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=67 head_norm_before_train=1.744933 cos_to_last_merge=0.9960 (last merge round=44)
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9436045827866069, 'auprc': 0.9755282896301742, 'loss_val': 0.28729069451525624, 'psi': 0.9563740655240338}-{'f1_val': 0.9511243860413766, 'auprc': 0.9698467118072794, 'loss_val': 0.2763753886159664, 'psi': 0.9586133163477377}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=1.917692 cos_to_last_merge=0.8318 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9917713087777367, 'loss_val': 0.02972079598163507, 'psi': 0.9941570331147684}-{'f1_val': 0.9958933237853395, 'auprc': 0.9922683656164712, 'loss_val': 0.02927207597440749, 'psi': 0.9944433405177922}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.970052 cos_to_last_merge=0.9958 (last merge round=43)
[S6] round=67 local utility u=0.654552 metrics={'f1_val': 0.8223741034926997, 'auprc': 0.9547118413461938, 'loss_val': 0.5092849832754895, 'psi': 0.8753091986340973}-{'f1_val': 0.7078474453727757, 'auprc': 0.8607405502922112, 'loss_val': 0.8493155844284275, 'psi': 0.7690046873405498}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=67 head_norm_before_train=2.111717 cos_to_last_merge=0.9794 (last merge round=43)
[S7] round=67 local utility u=0.406857 metrics={'f1_val': 0.7844966313106604, 'auprc': 0.9185076568323105, 'loss_val': 0.7682069630764179, 'psi': 0.8381010415193204}-{'f1_val': 0.6630392784925772, 'auprc': 0.9657591680746511, 'loss_val': 0.9949312329366329, 'psi': 0.7841272343254068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=67 head_norm_before_train=1.727580 cos_to_last_merge=0.9886 (last merge round=42)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9879583996134726, 'loss_val': 0.03956870949791451, 'psi': 0.9908224934512057}-{'f1_val': 0.9934815081849845, 'auprc': 0.9885308978698764, 'loss_val': 0.03645670413086438, 'psi': 0.9915012640589412}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.722182 cos_to_last_merge=0.9925 (last merge round=44)
[S9] round=67 local utility u=0.000173 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.99845921101894, 'loss_val': 0.023487606333696537, 'psi': 0.9966331839295475}-{'f1_val': 0.9966605118138915, 'auprc': 0.9953051683618778, 'loss_val': 0.02183946021246112, 'psi': 0.9961183744330859}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=67 head_norm_before_train=2.034092 cos_to_last_merge=0.9883 (last merge round=45)
[S10] round=67 local utility u=0.000553 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.997008975799038, 'loss_val': 0.026654642452124698, 'psi': 0.9957339247778519}-{'f1_val': 0.9946643883427498, 'auprc': 0.9971416613480582, 'loss_val': 0.02684195265566855, 'psi': 0.9956552975448731}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=67 head_norm_before_train=2.009075 cos_to_last_merge=0.9953 (last merge round=43)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954077177794995, 'loss_val': 0.019008740135322357, 'psi': 0.9960936401088581}-{'f1_val': 0.9965509216617638, 'auprc': 0.9971514275946078, 'loss_val': 0.02005803463767656, 'psi': 0.9967911240349014}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.585755 cos_to_last_merge=0.9678 (last merge round=35)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.5986474558885643, 'auprc': 0.7682053098756395, 'loss_val': 1.0967144191761513, 'psi': 0.6664705974833944}-{'f1_val': 0.6771638646038879, 'auprc': 0.7814394187162774, 'loss_val': 0.7107375953980006, 'psi': 0.7188740862488437}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.864810 cos_to_last_merge=0.9739 (last merge round=37)
[S14] round=67 local utility u=0.002778 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9985384195978709, 'loss_val': 0.02682526908317611, 'psi': 0.997602674200271}-{'f1_val': 0.9965652232429598, 'auprc': 0.9984139680303733, 'loss_val': 0.029525826824221318, 'psi': 0.9973047211579252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=67 head_norm_before_train=1.988054 cos_to_last_merge=0.9723 (last merge round=43)
[S15] round=67 local utility u=0.003459 metrics={'f1_val': 0.9971342989135215, 'auprc': 0.9985733521276745, 'loss_val': 0.01823871921464633, 'psi': 0.9977099201991827}-{'f1_val': 0.9971773386779533, 'auprc': 0.9977407314502469, 'loss_val': 0.022918010466149795, 'psi': 0.9974026957868707}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=67 head_norm_before_train=1.750361 cos_to_last_merge=0.9909 (last merge round=44)
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9907058824816869, 'auprc': 0.9904362747161558, 'loss_val': 0.0563009852194109, 'psi': 0.9905980393754745}-{'f1_val': 0.9910958328639886, 'auprc': 0.9910336200368177, 'loss_val': 0.049385173875217285, 'psi': 0.9910709477331202}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=1.739704 cos_to_last_merge=0.9792 (last merge round=41)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.5436888191513892, 'auprc': 0.7202396610789283, 'loss_val': 1.519500414812011, 'psi': 0.6143091559224049}-{'f1_val': 0.5783631472827322, 'auprc': 0.7429388381456746, 'loss_val': 1.286996300719375, 'psi': 0.6441934236279092}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=2.141654 (no previous merge yet)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.8291699591142071, 'auprc': 0.842247694564893, 'loss_val': 0.44446811144319676, 'psi': 0.8344010532944814}-{'f1_val': 0.8260340547897453, 'auprc': 0.9035832847871267, 'loss_val': 0.477954142344938, 'psi': 0.8570537467886978}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.118851 cos_to_last_merge=0.9716 (last merge round=43)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.864051155136746, 'auprc': 0.9674553926372276, 'loss_val': 0.3230589253399491, 'psi': 0.9054128501369386}-{'f1_val': 0.9729279712569923, 'auprc': 0.996666813693131, 'loss_val': 0.09590215402493414, 'psi': 0.9824235082314478}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.752478 cos_to_last_merge=0.9959 (last merge round=44)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9417762555255232, 'auprc': 0.9593570997364902, 'loss_val': 0.2934361288045464, 'psi': 0.9488085932099101}-{'f1_val': 0.9436045827866069, 'auprc': 0.9755282896301742, 'loss_val': 0.28729069451525624, 'psi': 0.9563740655240338}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.920265 cos_to_last_merge=0.8316 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.832
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9892196298712023, 'loss_val': 0.03036258781549095, 'psi': 0.9933119814873133}-{'f1_val': 0.9957475160061228, 'auprc': 0.9917713087777367, 'loss_val': 0.02972079598163507, 'psi': 0.9941570331147684}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.970253 cos_to_last_merge=0.9955 (last merge round=43)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7323215437695202, 'auprc': 0.9509463431970796, 'loss_val': 0.7572139955618093, 'psi': 0.819771463540544}-{'f1_val': 0.8223741034926997, 'auprc': 0.9547118413461938, 'loss_val': 0.5092849832754895, 'psi': 0.8753091986340973}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=2.123331 cos_to_last_merge=0.9784 (last merge round=43)
[S7] round=68 local utility u=0.285148 metrics={'f1_val': 0.8427322478500373, 'auprc': 0.9545518779903355, 'loss_val': 0.65545756828663, 'psi': 0.8874600999061566}-{'f1_val': 0.7844966313106604, 'auprc': 0.9185076568323105, 'loss_val': 0.7682069630764179, 'psi': 0.8381010415193204}
[S7] not sending this round → trigger blocked (psi=0.887)
[S8] START round=68 head_norm_before_train=1.733252 cos_to_last_merge=0.9883 (last merge round=42)
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9849632800667485, 'auprc': 0.9988151606729482, 'loss_val': 0.0474058082343388, 'psi': 0.9905040323092285}-{'f1_val': 0.9927318893430277, 'auprc': 0.9879583996134726, 'loss_val': 0.03956870949791451, 'psi': 0.9908224934512057}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.728226 cos_to_last_merge=0.9923 (last merge round=44)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937888936005798, 'loss_val': 0.02205649870016706, 'psi': 0.9952656143077985}-{'f1_val': 0.9954158325366191, 'auprc': 0.99845921101894, 'loss_val': 0.023487606333696537, 'psi': 0.9966331839295475}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=2.042396 cos_to_last_merge=0.9879 (last merge round=45)
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9967629542083519, 'loss_val': 0.02648168655132676, 'psi': 0.9956355161415775}-{'f1_val': 0.9948838907637279, 'auprc': 0.997008975799038, 'loss_val': 0.026654642452124698, 'psi': 0.9957339247778519}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.015691 cos_to_last_merge=0.9951 (last merge round=43)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9949517318217243, 'loss_val': 0.020884175333651764, 'psi': 0.9957661434989109}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954077177794995, 'loss_val': 0.019008740135322357, 'psi': 0.9960936401088581}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.587360 cos_to_last_merge=0.9676 (last merge round=35)
[S13] round=68 local utility u=0.066777 metrics={'f1_val': 0.6078843476656148, 'auprc': 0.7707842365288357, 'loss_val': 1.0263187556749434, 'psi': 0.6730443032109032}-{'f1_val': 0.5986474558885643, 'auprc': 0.7682053098756395, 'loss_val': 1.0967144191761513, 'psi': 0.6664705974833944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=68 head_norm_before_train=1.871635 cos_to_last_merge=0.9732 (last merge round=37)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985368051013022, 'loss_val': 0.02739491234359313, 'psi': 0.9976000220907867}-{'f1_val': 0.9969788439352044, 'auprc': 0.9985384195978709, 'loss_val': 0.02682526908317611, 'psi': 0.997602674200271}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.997376 cos_to_last_merge=0.9716 (last merge round=43)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9706744171156799, 'auprc': 0.9992657066060733, 'loss_val': 0.12267118082786284, 'psi': 0.9821109329118373}-{'f1_val': 0.9971342989135215, 'auprc': 0.9985733521276745, 'loss_val': 0.01823871921464633, 'psi': 0.9977099201991827}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=1.757333 cos_to_last_merge=0.9907 (last merge round=44)
[S16] round=68 local utility u=0.000322 metrics={'f1_val': 0.9907058824816869, 'auprc': 0.9904474907969226, 'loss_val': 0.05569150691719224, 'psi': 0.9906025258077812}-{'f1_val': 0.9907058824816869, 'auprc': 0.9904362747161558, 'loss_val': 0.0563009852194109, 'psi': 0.9905980393754745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=68 head_norm_before_train=1.749933 cos_to_last_merge=0.9783 (last merge round=41)
[S17] round=68 local utility u=0.211751 metrics={'f1_val': 0.5714312527344964, 'auprc': 0.7746191266388334, 'loss_val': 1.4255904248642268, 'psi': 0.6527064022962312}-{'f1_val': 0.5436888191513892, 'auprc': 0.7202396610789283, 'loss_val': 1.519500414812011, 'psi': 0.6143091559224049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=69 head_norm_before_train=2.142090 (no previous merge yet)
[S2] round=69 local utility u=0.116552 metrics={'f1_val': 0.8260340547897453, 'auprc': 0.9297745526276234, 'loss_val': 0.455129350457305, 'psi': 0.8675302539248966}-{'f1_val': 0.8291699591142071, 'auprc': 0.842247694564893, 'loss_val': 0.44446811144319676, 'psi': 0.8344010532944814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=69 head_norm_before_train=2.128947 cos_to_last_merge=0.9710 (last merge round=43)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.8117417095411116, 'auprc': 0.9811583958696501, 'loss_val': 0.3479588028492372, 'psi': 0.879508384072527}-{'f1_val': 0.864051155136746, 'auprc': 0.9674553926372276, 'loss_val': 0.3230589253399491, 'psi': 0.9054128501369386}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.760258 cos_to_last_merge=0.9957 (last merge round=44)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9417851908977535, 'auprc': 0.9498912836834057, 'loss_val': 0.2953355572866487, 'psi': 0.9450276280120145}-{'f1_val': 0.9417762555255232, 'auprc': 0.9593570997364902, 'loss_val': 0.2934361288045464, 'psi': 0.9488085932099101}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.925376 cos_to_last_merge=0.8312 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=69 local utility u=0.011258 metrics={'f1_val': 0.9956266841206929, 'auprc': 0.9977831560268887, 'loss_val': 0.0310551982406082, 'psi': 0.9964892728831712}-{'f1_val': 0.9960402158980539, 'auprc': 0.9892196298712023, 'loss_val': 0.03036258781549095, 'psi': 0.9933119814873133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=69 head_norm_before_train=1.971501 cos_to_last_merge=0.9948 (last merge round=43)
[S6] round=69 local utility u=0.830683 metrics={'f1_val': 0.9108285729427366, 'auprc': 0.9718491928707699, 'loss_val': 0.2295990170264508, 'psi': 0.9352368209139499}-{'f1_val': 0.7323215437695202, 'auprc': 0.9509463431970796, 'loss_val': 0.7572139955618093, 'psi': 0.819771463540544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=69 head_norm_before_train=2.135868 cos_to_last_merge=0.9777 (last merge round=43)
[S7] round=69 local utility u=0.072381 metrics={'f1_val': 0.8404517235809137, 'auprc': 0.9714414762759878, 'loss_val': 0.5476821950104158, 'psi': 0.8928476246589434}-{'f1_val': 0.8427322478500373, 'auprc': 0.9545518779903355, 'loss_val': 0.65545756828663, 'psi': 0.8874600999061566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=69 head_norm_before_train=1.737161 cos_to_last_merge=0.9880 (last merge round=42)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9850054765175075, 'auprc': 0.9983635866848686, 'loss_val': 0.05026846130465213, 'psi': 0.9903487205844519}-{'f1_val': 0.9849632800667485, 'auprc': 0.9988151606729482, 'loss_val': 0.0474058082343388, 'psi': 0.9905040323092285}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=1.735125 cos_to_last_merge=0.9920 (last merge round=44)
[S9] round=69 local utility u=0.008559 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984646834027806, 'loss_val': 0.021429021149560194, 'psi': 0.9973821804494472}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937888936005798, 'loss_val': 0.02205649870016706, 'psi': 0.9952656143077985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=69 head_norm_before_train=2.050544 cos_to_last_merge=0.9874 (last merge round=45)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969190498057122, 'loss_val': 0.02666587414801582, 'psi': 0.9955662529279348}-{'f1_val': 0.9948838907637279, 'auprc': 0.9967629542083519, 'loss_val': 0.02648168655132676, 'psi': 0.9956355161415775}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=2.022355 cos_to_last_merge=0.9948 (last merge round=43)
[S11] round=69 local utility u=0.002355 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954175292452052, 'loss_val': 0.019021640178870525, 'psi': 0.9960975646951404}-{'f1_val': 0.9963090846170353, 'auprc': 0.9949517318217243, 'loss_val': 0.020884175333651764, 'psi': 0.9957661434989109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=69 head_norm_before_train=1.592623 cos_to_last_merge=0.9670 (last merge round=35)
[S13] round=69 local utility u=0.387879 metrics={'f1_val': 0.706506292868337, 'auprc': 0.7885841783901846, 'loss_val': 0.8956931030221003, 'psi': 0.739337447077076}-{'f1_val': 0.6078843476656148, 'auprc': 0.7707842365288357, 'loss_val': 1.0263187556749434, 'psi': 0.6730443032109032}
[S13] not sending this round → trigger blocked (psi=0.739)
[S14] START round=69 head_norm_before_train=1.876036 cos_to_last_merge=0.9727 (last merge round=37)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985280043608298, 'loss_val': 0.027888426421006484, 'psi': 0.9975965017945978}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985368051013022, 'loss_val': 0.02739491234359313, 'psi': 0.9976000220907867}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=2.006536 cos_to_last_merge=0.9709 (last merge round=43)
[S15] round=69 local utility u=0.130583 metrics={'f1_val': 0.9971342989135215, 'auprc': 0.998581125654574, 'loss_val': 0.018211382664076327, 'psi': 0.9977130296099425}-{'f1_val': 0.9706744171156799, 'auprc': 0.9992657066060733, 'loss_val': 0.12267118082786284, 'psi': 0.9821109329118373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=69 head_norm_before_train=1.764911 cos_to_last_merge=0.9903 (last merge round=44)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9882997321365337, 'auprc': 0.9904482645715476, 'loss_val': 0.06236517580310098, 'psi': 0.9891591451105393}-{'f1_val': 0.9907058824816869, 'auprc': 0.9904474907969226, 'loss_val': 0.05569150691719224, 'psi': 0.9906025258077812}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.759768 cos_to_last_merge=0.9775 (last merge round=41)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.49317293211231694, 'auprc': 0.6793157804766463, 'loss_val': 1.7348743823797081, 'psi': 0.5676300714580487}-{'f1_val': 0.5714312527344964, 'auprc': 0.7746191266388334, 'loss_val': 1.4255904248642268, 'psi': 0.6527064022962312}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.143713 (no previous merge yet)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.826517116133133, 'auprc': 0.8367812843560869, 'loss_val': 0.4851369602640049, 'psi': 0.8306227834223145}-{'f1_val': 0.8260340547897453, 'auprc': 0.9297745526276234, 'loss_val': 0.455129350457305, 'psi': 0.8675302539248966}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.140968 cos_to_last_merge=0.9702 (last merge round=43)
[S3] round=70 local utility u=0.389617 metrics={'f1_val': 0.9061037404463261, 'auprc': 0.9973424795187158, 'loss_val': 0.1834483907199189, 'psi': 0.942599236075282}-{'f1_val': 0.8117417095411116, 'auprc': 0.9811583958696501, 'loss_val': 0.3479588028492372, 'psi': 0.879508384072527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=70 head_norm_before_train=1.768505 cos_to_last_merge=0.9954 (last merge round=44)
[S4] round=70 local utility u=0.033661 metrics={'f1_val': 0.9423922219840307, 'auprc': 0.9713650686574868, 'loss_val': 0.2960772511178078, 'psi': 0.9539813606534131}-{'f1_val': 0.9417851908977535, 'auprc': 0.9498912836834057, 'loss_val': 0.2953355572866487, 'psi': 0.9450276280120145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=70 head_norm_before_train=1.925078 cos_to_last_merge=0.8312 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=70 local utility u=0.000383 metrics={'f1_val': 0.9956266841206929, 'auprc': 0.997833215200859, 'loss_val': 0.03043859566969508, 'psi': 0.9965092965527593}-{'f1_val': 0.9956266841206929, 'auprc': 0.9977831560268887, 'loss_val': 0.0310551982406082, 'psi': 0.9964892728831712}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=70 head_norm_before_train=1.976580 cos_to_last_merge=0.9944 (last merge round=43)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.8314627880819953, 'auprc': 0.9039193755316388, 'loss_val': 0.5703260371628454, 'psi': 0.8604454230618527}-{'f1_val': 0.9108285729427366, 'auprc': 0.9718491928707699, 'loss_val': 0.2295990170264508, 'psi': 0.9352368209139499}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=2.155470 cos_to_last_merge=0.9762 (last merge round=43)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.8293762898560431, 'auprc': 0.9653809869015697, 'loss_val': 0.6434394873458519, 'psi': 0.8837781686742537}-{'f1_val': 0.8404517235809137, 'auprc': 0.9714414762759878, 'loss_val': 0.5476821950104158, 'psi': 0.8928476246589434}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=1.744367 cos_to_last_merge=0.9876 (last merge round=42)
[S8] round=70 local utility u=0.021777 metrics={'f1_val': 0.9903312961433964, 'auprc': 0.9979508854482411, 'loss_val': 0.03743127179087244, 'psi': 0.9933791318653342}-{'f1_val': 0.9850054765175075, 'auprc': 0.9983635866848686, 'loss_val': 0.05026846130465213, 'psi': 0.9903487205844519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=70 head_norm_before_train=1.740545 cos_to_last_merge=0.9918 (last merge round=44)
[S9] round=70 local utility u=0.000123 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984742069699959, 'loss_val': 0.021211968831020174, 'psi': 0.9973859898763332}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984646834027806, 'loss_val': 0.021429021149560194, 'psi': 0.9973821804494472}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=70 head_norm_before_train=2.058763 cos_to_last_merge=0.9870 (last merge round=45)
[S10] round=70 local utility u=0.000345 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970927307397011, 'loss_val': 0.026497718873615867, 'psi': 0.9956357253015302}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969190498057122, 'loss_val': 0.02666587414801582, 'psi': 0.9955662529279348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=70 head_norm_before_train=2.025813 cos_to_last_merge=0.9946 (last merge round=43)
[S11] round=70 local utility u=0.002196 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9968087461977301, 'loss_val': 0.01880275243127327, 'psi': 0.9966540514761504}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954175292452052, 'loss_val': 0.019021640178870525, 'psi': 0.9960975646951404}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=70 head_norm_before_train=1.597853 cos_to_last_merge=0.9665 (last merge round=35)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6652032005714382, 'auprc': 0.7807426722694288, 'loss_val': 0.8086659308337458, 'psi': 0.7114189892506344}-{'f1_val': 0.706506292868337, 'auprc': 0.7885841783901846, 'loss_val': 0.8956931030221003, 'psi': 0.739337447077076}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.881962 cos_to_last_merge=0.9722 (last merge round=37)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9985396478658499, 'loss_val': 0.02558114481408961, 'psi': 0.997354993092116}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985280043608298, 'loss_val': 0.027888426421006484, 'psi': 0.9975965017945978}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.012210 cos_to_last_merge=0.9704 (last merge round=43)
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.918048098838125, 'auprc': 0.9973189721884447, 'loss_val': 0.12556077100279603, 'psi': 0.9497564481782528}-{'f1_val': 0.9971342989135215, 'auprc': 0.998581125654574, 'loss_val': 0.018211382664076327, 'psi': 0.9977130296099425}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.772116 cos_to_last_merge=0.9898 (last merge round=44)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9874268761187679, 'auprc': 0.9904902335815579, 'loss_val': 0.06386196354074711, 'psi': 0.9886522191038839}-{'f1_val': 0.9882997321365337, 'auprc': 0.9904482645715476, 'loss_val': 0.06236517580310098, 'psi': 0.9891591451105393}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=1.770084 cos_to_last_merge=0.9766 (last merge round=41)
[S17] round=70 local utility u=0.998801 metrics={'f1_val': 0.6306344132413094, 'auprc': 0.9229929447955741, 'loss_val': 1.2930735156314008, 'psi': 0.7475778258630154}-{'f1_val': 0.49317293211231694, 'auprc': 0.6793157804766463, 'loss_val': 1.7348743823797081, 'psi': 0.5676300714580487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=71 head_norm_before_train=2.145660 (no previous merge yet)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.8105298189260061, 'auprc': 0.7711353982078986, 'loss_val': 0.4965538834593886, 'psi': 0.794772050638763}-{'f1_val': 0.826517116133133, 'auprc': 0.8367812843560869, 'loss_val': 0.4851369602640049, 'psi': 0.8306227834223145}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.153174 cos_to_last_merge=0.9695 (last merge round=43)
[S3] round=71 local utility u=0.177791 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9983409465342719, 'loss_val': 0.1594023347642048, 'psi': 0.9758526733268832}-{'f1_val': 0.9061037404463261, 'auprc': 0.9973424795187158, 'loss_val': 0.1834483907199189, 'psi': 0.942599236075282}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=71 head_norm_before_train=1.777405 cos_to_last_merge=0.9952 (last merge round=44)
[S4] round=71 local utility u=0.011155 metrics={'f1_val': 0.9488882978804655, 'auprc': 0.9628872259735295, 'loss_val': 0.28730934292311683, 'psi': 0.954487869117691}-{'f1_val': 0.9423922219840307, 'auprc': 0.9713650686574868, 'loss_val': 0.2960772511178078, 'psi': 0.9539813606534131}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=71 head_norm_before_train=1.927339 cos_to_last_merge=0.8310 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=71 local utility u=0.000634 metrics={'f1_val': 0.9955286699203818, 'auprc': 0.9977727420468648, 'loss_val': 0.028400412008759878, 'psi': 0.996426298770975}-{'f1_val': 0.9956266841206929, 'auprc': 0.997833215200859, 'loss_val': 0.03043859566969508, 'psi': 0.9965092965527593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=71 head_norm_before_train=1.982525 cos_to_last_merge=0.9942 (last merge round=43)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.616705896170748, 'auprc': 0.6794443515818187, 'loss_val': 1.2183095384139073, 'psi': 0.6418012783351763}-{'f1_val': 0.8314627880819953, 'auprc': 0.9039193755316388, 'loss_val': 0.5703260371628454, 'psi': 0.8604454230618527}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=2.175603 cos_to_last_merge=0.9750 (last merge round=43)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5982690041620884, 'auprc': 0.9108223577187897, 'loss_val': 1.4913587889182214, 'psi': 0.7232903455847689}-{'f1_val': 0.8293762898560431, 'auprc': 0.9653809869015697, 'loss_val': 0.6434394873458519, 'psi': 0.8837781686742537}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.753035 cos_to_last_merge=0.9872 (last merge round=42)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9988042257237626, 'loss_val': 0.03974299841593119, 'psi': 0.9930479883703676}-{'f1_val': 0.9903312961433964, 'auprc': 0.9979508854482411, 'loss_val': 0.03743127179087244, 'psi': 0.9933791318653342}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=1.748400 cos_to_last_merge=0.9916 (last merge round=44)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9927859844863899, 'loss_val': 0.02118613997113447, 'psi': 0.9951298885534132}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984742069699959, 'loss_val': 0.021211968831020174, 'psi': 0.9973859898763332}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.064346 cos_to_last_merge=0.9867 (last merge round=45)
[S10] round=71 local utility u=0.000261 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9972354361161574, 'loss_val': 0.026403775853055953, 'psi': 0.9956928074521127}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970927307397011, 'loss_val': 0.026497718873615867, 'psi': 0.9956357253015302}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=71 head_norm_before_train=2.030189 cos_to_last_merge=0.9944 (last merge round=43)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9953554040411894, 'loss_val': 0.01905383141918163, 'psi': 0.9960727146135341}-{'f1_val': 0.9965509216617638, 'auprc': 0.9968087461977301, 'loss_val': 0.01880275243127327, 'psi': 0.9966540514761504}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.604865 cos_to_last_merge=0.9657 (last merge round=35)
[S13] round=71 local utility u=0.072503 metrics={'f1_val': 0.7047005074689388, 'auprc': 0.7833289993107384, 'loss_val': 0.9084020654750866, 'psi': 0.7361519042056586}-{'f1_val': 0.6652032005714382, 'auprc': 0.7807426722694288, 'loss_val': 0.8086659308337458, 'psi': 0.7114189892506344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=71 head_norm_before_train=1.889615 cos_to_last_merge=0.9716 (last merge round=37)
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9965690443088828, 'auprc': 0.9984522019950889, 'loss_val': 0.02617914126986418, 'psi': 0.9973223073833652}-{'f1_val': 0.9965652232429598, 'auprc': 0.9985396478658499, 'loss_val': 0.02558114481408961, 'psi': 0.997354993092116}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=2.018304 cos_to_last_merge=0.9699 (last merge round=43)
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.8907089265506406, 'auprc': 0.9969611996054248, 'loss_val': 0.2581392991659385, 'psi': 0.9332098357725542}-{'f1_val': 0.918048098838125, 'auprc': 0.9973189721884447, 'loss_val': 0.12556077100279603, 'psi': 0.9497564481782528}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=1.778117 cos_to_last_merge=0.9895 (last merge round=44)
[S16] round=71 local utility u=0.008510 metrics={'f1_val': 0.9893923703994126, 'auprc': 0.9905315405240193, 'loss_val': 0.05875861525668864, 'psi': 0.9898480384492554}-{'f1_val': 0.9874268761187679, 'auprc': 0.9904902335815579, 'loss_val': 0.06386196354074711, 'psi': 0.9886522191038839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S16] sending update (kind=head size=1805 to 1 peers)
[S17] START round=71 head_norm_before_train=1.775539 cos_to_last_merge=0.9761 (last merge round=41)
[S17] round=71 local utility u=1.000000 metrics={'f1_val': 0.9145039183575039, 'auprc': 0.9775083692200304, 'loss_val': 0.3486014517187765, 'psi': 0.9397056987025144}-{'f1_val': 0.6306344132413094, 'auprc': 0.9229929447955741, 'loss_val': 1.2930735156314008, 'psi': 0.7475778258630154}
[S17] not sending this round → trigger blocked (psi=0.940)
[S2] START round=72 head_norm_before_train=2.149492 (no previous merge yet)
[S2] round=72 local utility u=0.289229 metrics={'f1_val': 0.8182886220972161, 'auprc': 0.9430357249554675, 'loss_val': 0.4803489362730386, 'psi': 0.8681874632405167}-{'f1_val': 0.8105298189260061, 'auprc': 0.7711353982078986, 'loss_val': 0.4965538834593886, 'psi': 0.794772050638763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=72 head_norm_before_train=2.160896 cos_to_last_merge=0.9691 (last merge round=43)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9427331109802561, 'auprc': 0.9794843625133474, 'loss_val': 0.17344034573953837, 'psi': 0.9574336115934927}-{'f1_val': 0.9608604911886242, 'auprc': 0.9983409465342719, 'loss_val': 0.1594023347642048, 'psi': 0.9758526733268832}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=1.782762 cos_to_last_merge=0.9948 (last merge round=44)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9508628125673942, 'auprc': 0.9547209101417644, 'loss_val': 0.28881704427255156, 'psi': 0.9524060515971423}-{'f1_val': 0.9488882978804655, 'auprc': 0.9628872259735295, 'loss_val': 0.28730934292311683, 'psi': 0.954487869117691}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.931101 cos_to_last_merge=0.8309 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9912499811648297, 'auprc': 0.9964207013188753, 'loss_val': 0.052422503348453754, 'psi': 0.9933182692264478}-{'f1_val': 0.9955286699203818, 'auprc': 0.9977727420468648, 'loss_val': 0.028400412008759878, 'psi': 0.996426298770975}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.986170 cos_to_last_merge=0.9938 (last merge round=43)
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.806285684672844, 'auprc': 0.9185191307392245, 'loss_val': 0.592529244467734, 'psi': 0.8511790630993963}-{'f1_val': 0.616705896170748, 'auprc': 0.6794443515818187, 'loss_val': 1.2183095384139073, 'psi': 0.6418012783351763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=72 head_norm_before_train=2.190367 cos_to_last_merge=0.9740 (last merge round=43)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.6206460669970627, 'auprc': 0.8469758551737322, 'loss_val': 1.4393427710679467, 'psi': 0.7111779822677304}-{'f1_val': 0.5982690041620884, 'auprc': 0.9108223577187897, 'loss_val': 1.4913587889182214, 'psi': 0.7232903455847689}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=1.759743 cos_to_last_merge=0.9869 (last merge round=42)
[S8] round=72 local utility u=0.011791 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9988113839746378, 'loss_val': 0.035682723880509935, 'psi': 0.9950009013292354}-{'f1_val': 0.9892104968014376, 'auprc': 0.9988042257237626, 'loss_val': 0.03974299841593119, 'psi': 0.9930479883703676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=72 head_norm_before_train=1.756949 cos_to_last_merge=0.9912 (last merge round=44)
[S9] round=72 local utility u=0.000477 metrics={'f1_val': 0.9947496160742828, 'auprc': 0.9984720200783277, 'loss_val': 0.025633188288909075, 'psi': 0.9962385776759008}-{'f1_val': 0.9966924912647621, 'auprc': 0.9927859844863899, 'loss_val': 0.02118613997113447, 'psi': 0.9951298885534132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=72 head_norm_before_train=2.070026 cos_to_last_merge=0.9864 (last merge round=45)
[S10] round=72 local utility u=0.000118 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9972668685798434, 'loss_val': 0.026262610546080464, 'psi': 0.9957053804375873}-{'f1_val': 0.9946643883427498, 'auprc': 0.9972354361161574, 'loss_val': 0.026403775853055953, 'psi': 0.9956928074521127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=72 head_norm_before_train=2.035888 cos_to_last_merge=0.9942 (last merge round=43)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9952968263211178, 'loss_val': 0.01895943463029456, 'psi': 0.9960492835255055}-{'f1_val': 0.9965509216617638, 'auprc': 0.9953554040411894, 'loss_val': 0.01905383141918163, 'psi': 0.9960727146135341}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.611841 cos_to_last_merge=0.9649 (last merge round=35)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.567626290256176, 'auprc': 0.7853028948901803, 'loss_val': 1.2825420873985933, 'psi': 0.6546969321097778}-{'f1_val': 0.7047005074689388, 'auprc': 0.7833289993107384, 'loss_val': 0.9084020654750866, 'psi': 0.7361519042056586}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.897144 cos_to_last_merge=0.9710 (last merge round=37)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9965690443088828, 'auprc': 0.998382869183118, 'loss_val': 0.02637616380797996, 'psi': 0.9972945742585769}-{'f1_val': 0.9965690443088828, 'auprc': 0.9984522019950889, 'loss_val': 0.02617914126986418, 'psi': 0.9973223073833652}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.025715 cos_to_last_merge=0.9693 (last merge round=43)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.8740021565165613, 'auprc': 0.9962343106507816, 'loss_val': 0.3149639200384924, 'psi': 0.9228950181702493}-{'f1_val': 0.8907089265506406, 'auprc': 0.9969611996054248, 'loss_val': 0.2581392991659385, 'psi': 0.9332098357725542}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.784629 cos_to_last_merge=0.9893 (last merge round=44)
[S16] round=72 local utility u=0.008102 metrics={'f1_val': 0.9909250539271397, 'auprc': 0.9905473714261317, 'loss_val': 0.05179853744667518, 'psi': 0.9907739809267365}-{'f1_val': 0.9893923703994126, 'auprc': 0.9905315405240193, 'loss_val': 0.05875861525668864, 'psi': 0.9898480384492554}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=72 head_norm_before_train=1.780725 cos_to_last_merge=0.9757 (last merge round=41)
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6441172090093207, 'auprc': 0.9466951224305389, 'loss_val': 1.1990435245135433, 'psi': 0.765148374377808}-{'f1_val': 0.9145039183575039, 'auprc': 0.9775083692200304, 'loss_val': 0.3486014517187765, 'psi': 0.9397056987025144}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.155016 (no previous merge yet)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.8309852530613718, 'auprc': 0.8263121607413787, 'loss_val': 0.4530401657839339, 'psi': 0.8291160161333746}-{'f1_val': 0.8182886220972161, 'auprc': 0.9430357249554675, 'loss_val': 0.4803489362730386, 'psi': 0.8681874632405167}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.166926 cos_to_last_merge=0.9689 (last merge round=43)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.6817362948232089, 'auprc': 0.866292998219441, 'loss_val': 0.992618112535311, 'psi': 0.7555589761817016}-{'f1_val': 0.9427331109802561, 'auprc': 0.9794843625133474, 'loss_val': 0.17344034573953837, 'psi': 0.9574336115934927}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.784566 cos_to_last_merge=0.9945 (last merge round=44)
[S4] round=73 local utility u=0.026812 metrics={'f1_val': 0.9534124560932505, 'auprc': 0.9651655524702979, 'loss_val': 0.28182578698144256, 'psi': 0.9581136946440695}-{'f1_val': 0.9508628125673942, 'auprc': 0.9547209101417644, 'loss_val': 0.28881704427255156, 'psi': 0.9524060515971423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=73 head_norm_before_train=1.929286 cos_to_last_merge=0.8313 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=73 local utility u=0.023432 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9947704871647167, 'loss_val': 0.0293483426925332, 'psi': 0.9955323244047191}-{'f1_val': 0.9912499811648297, 'auprc': 0.9964207013188753, 'loss_val': 0.052422503348453754, 'psi': 0.9933182692264478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=73 head_norm_before_train=1.991992 cos_to_last_merge=0.9935 (last merge round=43)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.6936316217633178, 'auprc': 0.7339258348314341, 'loss_val': 1.0757837521526816, 'psi': 0.7097493069905643}-{'f1_val': 0.806285684672844, 'auprc': 0.9185191307392245, 'loss_val': 0.592529244467734, 'psi': 0.8511790630993963}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=2.202913 cos_to_last_merge=0.9731 (last merge round=43)
[S7] round=73 local utility u=0.798182 metrics={'f1_val': 0.7763317351880126, 'auprc': 0.9367164006296602, 'loss_val': 1.0463153424462963, 'psi': 0.8404856013646715}-{'f1_val': 0.6206460669970627, 'auprc': 0.8469758551737322, 'loss_val': 1.4393427710679467, 'psi': 0.7111779822677304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=73 head_norm_before_train=1.767147 cos_to_last_merge=0.9864 (last merge round=42)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9952752990030879, 'loss_val': 0.03322560576096523, 'psi': 0.9939837673907312}-{'f1_val': 0.9924605795656339, 'auprc': 0.9988113839746378, 'loss_val': 0.035682723880509935, 'psi': 0.9950009013292354}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.760038 cos_to_last_merge=0.9912 (last merge round=44)
[S9] round=73 local utility u=0.008458 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983791730012361, 'loss_val': 0.019903294703858012, 'psi': 0.9973479762888293}-{'f1_val': 0.9947496160742828, 'auprc': 0.9984720200783277, 'loss_val': 0.025633188288909075, 'psi': 0.9962385776759008}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=73 head_norm_before_train=2.076545 cos_to_last_merge=0.9861 (last merge round=45)
[S10] round=73 local utility u=0.000526 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9971163135657636, 'loss_val': 0.026075001852264575, 'psi': 0.9957768598845422}-{'f1_val': 0.9946643883427498, 'auprc': 0.9972668685798434, 'loss_val': 0.026262610546080464, 'psi': 0.9957053804375873}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=73 head_norm_before_train=2.040320 cos_to_last_merge=0.9939 (last merge round=43)
[S11] round=73 local utility u=0.001345 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9952616812965951, 'loss_val': 0.018644381158089942, 'psi': 0.9962832264943844}-{'f1_val': 0.9965509216617638, 'auprc': 0.9952968263211178, 'loss_val': 0.01895943463029456, 'psi': 0.9960492835255055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=73 head_norm_before_train=1.617739 cos_to_last_merge=0.9642 (last merge round=35)
[S13] round=73 local utility u=0.282952 metrics={'f1_val': 0.6229619996905142, 'auprc': 0.8099387349867071, 'loss_val': 1.1225590787998518, 'psi': 0.6977526938089913}-{'f1_val': 0.567626290256176, 'auprc': 0.7853028948901803, 'loss_val': 1.2825420873985933, 'psi': 0.6546969321097778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=73 head_norm_before_train=1.902701 cos_to_last_merge=0.9708 (last merge round=37)
[S14] round=73 local utility u=0.000457 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9984069563671332, 'loss_val': 0.02551214658616599, 'psi': 0.9973019164926292}-{'f1_val': 0.9965690443088828, 'auprc': 0.998382869183118, 'loss_val': 0.02637616380797996, 'psi': 0.9972945742585769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=73 head_norm_before_train=2.033361 cos_to_last_merge=0.9687 (last merge round=43)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.8385872312218156, 'auprc': 0.9966358470166992, 'loss_val': 0.304493624204902, 'psi': 0.901806677539769}-{'f1_val': 0.8740021565165613, 'auprc': 0.9962343106507816, 'loss_val': 0.3149639200384924, 'psi': 0.9228950181702493}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.791536 cos_to_last_merge=0.9890 (last merge round=44)
[S16] round=73 local utility u=0.002786 metrics={'f1_val': 0.9913636160107662, 'auprc': 0.990482760222384, 'loss_val': 0.048663117983768246, 'psi': 0.9910112736954133}-{'f1_val': 0.9909250539271397, 'auprc': 0.9905473714261317, 'loss_val': 0.05179853744667518, 'psi': 0.9907739809267365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=73 head_norm_before_train=1.782231 cos_to_last_merge=0.9756 (last merge round=41)
[S17] round=73 local utility u=0.034076 metrics={'f1_val': 0.6293473944414918, 'auprc': 0.9754950679328306, 'loss_val': 1.128673184600924, 'psi': 0.7678064638380273}-{'f1_val': 0.6441172090093207, 'auprc': 0.9466951224305389, 'loss_val': 1.1990435245135433, 'psi': 0.765148374377808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=74 head_norm_before_train=2.161806 (no previous merge yet)
[S2] round=74 local utility u=0.116768 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.912926286255697, 'loss_val': 0.46064280959780474, 'psi': 0.8618912504273271}-{'f1_val': 0.8309852530613718, 'auprc': 0.8263121607413787, 'loss_val': 0.4530401657839339, 'psi': 0.8291160161333746}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=74 head_norm_before_train=2.171819 cos_to_last_merge=0.9688 (last merge round=43)
[S3] round=74 local utility u=1.000000 metrics={'f1_val': 0.9435313547038251, 'auprc': 0.9923246520107649, 'loss_val': 0.14345053230067464, 'psi': 0.9630486736266011}-{'f1_val': 0.6817362948232089, 'auprc': 0.866292998219441, 'loss_val': 0.992618112535311, 'psi': 0.7555589761817016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=74 head_norm_before_train=1.785207 cos_to_last_merge=0.9941 (last merge round=44)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.945505167554604, 'auprc': 0.9548418429228528, 'loss_val': 0.2954960454166025, 'psi': 0.9492398377019035}-{'f1_val': 0.9534124560932505, 'auprc': 0.9651655524702979, 'loss_val': 0.28182578698144256, 'psi': 0.9581136946440695}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.930725 cos_to_last_merge=0.8313 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9945430617613592, 'loss_val': 0.028850237593503386, 'psi': 0.9954413542433761}-{'f1_val': 0.9960402158980539, 'auprc': 0.9947704871647167, 'loss_val': 0.0293483426925332, 'psi': 0.9955323244047191}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=2.000436 cos_to_last_merge=0.9934 (last merge round=43)
[S6] round=74 local utility u=0.113390 metrics={'f1_val': 0.71571673981903, 'auprc': 0.7489099903341968, 'loss_val': 1.0264668010047817, 'psi': 0.7289940400250967}-{'f1_val': 0.6936316217633178, 'auprc': 0.7339258348314341, 'loss_val': 1.0757837521526816, 'psi': 0.7097493069905643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=74 head_norm_before_train=2.211008 cos_to_last_merge=0.9727 (last merge round=43)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6119535611738622, 'auprc': 0.9249606044518062, 'loss_val': 1.4459037769872989, 'psi': 0.7371563784850398}-{'f1_val': 0.7763317351880126, 'auprc': 0.9367164006296602, 'loss_val': 1.0463153424462963, 'psi': 0.8404856013646715}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.773409 cos_to_last_merge=0.9861 (last merge round=42)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9899712503563753, 'auprc': 0.9987692071688327, 'loss_val': 0.038904216539525416, 'psi': 0.9934904330813583}-{'f1_val': 0.993122746315827, 'auprc': 0.9952752990030879, 'loss_val': 0.03322560576096523, 'psi': 0.9939837673907312}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=74 head_norm_before_train=1.765703 cos_to_last_merge=0.9910 (last merge round=44)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9931777120077118, 'loss_val': 0.020656404736006332, 'psi': 0.995286579561942}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983791730012361, 'loss_val': 0.019903294703858012, 'psi': 0.9973479762888293}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.083447 cos_to_last_merge=0.9857 (last merge round=45)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9970719356209417, 'loss_val': 0.026074499752342467, 'psi': 0.9957591087066134}-{'f1_val': 0.9948838907637279, 'auprc': 0.9971163135657636, 'loss_val': 0.026075001852264575, 'psi': 0.9957768598845422}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.045157 cos_to_last_merge=0.9937 (last merge round=43)
[S11] round=74 local utility u=0.000030 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9951966741363145, 'loss_val': 0.01838965139727512, 'psi': 0.996257223630272}-{'f1_val': 0.9969642566262439, 'auprc': 0.9952616812965951, 'loss_val': 0.018644381158089942, 'psi': 0.9962832264943844}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=74 head_norm_before_train=1.621402 cos_to_last_merge=0.9638 (last merge round=35)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6154482507902755, 'auprc': 0.7600679161621456, 'loss_val': 1.005673761801986, 'psi': 0.6732961169390236}-{'f1_val': 0.6229619996905142, 'auprc': 0.8099387349867071, 'loss_val': 1.1225590787998518, 'psi': 0.6977526938089913}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=1.908455 cos_to_last_merge=0.9704 (last merge round=37)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9985247360445532, 'loss_val': 0.029667321710432633, 'psi': 0.9974494089172178}-{'f1_val': 0.9965652232429598, 'auprc': 0.9984069563671332, 'loss_val': 0.02551214658616599, 'psi': 0.9973019164926292}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.040518 cos_to_last_merge=0.9682 (last merge round=43)
[S15] round=74 local utility u=0.158870 metrics={'f1_val': 0.8846446580905414, 'auprc': 0.9969092571279314, 'loss_val': 0.2639188358211372, 'psi': 0.9295504977054974}-{'f1_val': 0.8385872312218156, 'auprc': 0.9966358470166992, 'loss_val': 0.304493624204902, 'psi': 0.901806677539769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=74 head_norm_before_train=1.797972 cos_to_last_merge=0.9888 (last merge round=44)
[S16] round=74 local utility u=0.002295 metrics={'f1_val': 0.9917314007009104, 'auprc': 0.9906548271544491, 'loss_val': 0.04679673206753181, 'psi': 0.9913007712823259}-{'f1_val': 0.9913636160107662, 'auprc': 0.990482760222384, 'loss_val': 0.048663117983768246, 'psi': 0.9910112736954133}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=74 head_norm_before_train=1.784864 cos_to_last_merge=0.9754 (last merge round=41)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.629932404141172, 'auprc': 0.9324606056397001, 'loss_val': 1.1740556553759771, 'psi': 0.7509436847405833}-{'f1_val': 0.6293473944414918, 'auprc': 0.9754950679328306, 'loss_val': 1.128673184600924, 'psi': 0.7678064638380273}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.165979 (no previous merge yet)
[S2] round=75 local utility u=0.007672 metrics={'f1_val': 0.8302093643665346, 'auprc': 0.9112664995036298, 'loss_val': 0.45436839194913164, 'psi': 0.8626322184213726}-{'f1_val': 0.8278678932084138, 'auprc': 0.912926286255697, 'loss_val': 0.46064280959780474, 'psi': 0.8618912504273271}
[S2] not sending this round → trigger blocked (psi=0.863)
[S3] START round=75 head_norm_before_train=2.178617 cos_to_last_merge=0.9685 (last merge round=43)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.7476280007379217, 'auprc': 0.9979983444366703, 'loss_val': 0.6056692438918984, 'psi': 0.8477761382174211}-{'f1_val': 0.9435313547038251, 'auprc': 0.9923246520107649, 'loss_val': 0.14345053230067464, 'psi': 0.9630486736266011}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.787006 cos_to_last_merge=0.9938 (last merge round=44)
[S4] round=75 local utility u=0.002314 metrics={'f1_val': 0.9456935319102134, 'auprc': 0.9564092032689272, 'loss_val': 0.29670025508902426, 'psi': 0.9499798004536989}-{'f1_val': 0.945505167554604, 'auprc': 0.9548418429228528, 'loss_val': 0.2954960454166025, 'psi': 0.9492398377019035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=75 head_norm_before_train=1.930555 cos_to_last_merge=0.8308 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=75 local utility u=0.000809 metrics={'f1_val': 0.996186023309311, 'auprc': 0.994865948210877, 'loss_val': 0.02907539743549578, 'psi': 0.9956579932699374}-{'f1_val': 0.9960402158980539, 'auprc': 0.9945430617613592, 'loss_val': 0.028850237593503386, 'psi': 0.9954413542433761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=75 head_norm_before_train=2.008155 cos_to_last_merge=0.9932 (last merge round=43)
[S6] round=75 local utility u=0.539146 metrics={'f1_val': 0.7716374240149884, 'auprc': 0.8961696953388895, 'loss_val': 0.7254785562786232, 'psi': 0.8214503325445488}-{'f1_val': 0.71571673981903, 'auprc': 0.7489099903341968, 'loss_val': 1.0264668010047817, 'psi': 0.7289940400250967}
[S6] not sending this round → trigger blocked (psi=0.821)
[S7] START round=75 head_norm_before_train=2.218157 cos_to_last_merge=0.9723 (last merge round=43)
[S7] round=75 local utility u=0.907259 metrics={'f1_val': 0.7931567566612985, 'auprc': 0.9422797617177753, 'loss_val': 0.7705630615298683, 'psi': 0.8528059586838892}-{'f1_val': 0.6119535611738622, 'auprc': 0.9249606044518062, 'loss_val': 1.4459037769872989, 'psi': 0.7371563784850398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=75 head_norm_before_train=1.779458 cos_to_last_merge=0.9858 (last merge round=42)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9739428145667117, 'auprc': 0.9987457625284467, 'loss_val': 0.07008029181944044, 'psi': 0.9838639937514058}-{'f1_val': 0.9899712503563753, 'auprc': 0.9987692071688327, 'loss_val': 0.038904216539525416, 'psi': 0.9934904330813583}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=1.772596 cos_to_last_merge=0.9906 (last merge round=44)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.992739354750667, 'loss_val': 0.020532570732744507, 'psi': 0.9951112366591242}-{'f1_val': 0.9966924912647621, 'auprc': 0.9931777120077118, 'loss_val': 0.020656404736006332, 'psi': 0.995286579561942}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.090488 cos_to_last_merge=0.9853 (last merge round=45)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9976032444629466, 'loss_val': 0.026553764257138613, 'psi': 0.9958399307908286}-{'f1_val': 0.9948838907637279, 'auprc': 0.9970719356209417, 'loss_val': 0.026074499752342467, 'psi': 0.9957591087066134}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.050808 cos_to_last_merge=0.9935 (last merge round=43)
[S11] round=75 local utility u=0.000648 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.996642252222944, 'loss_val': 0.018950239446978066, 'psi': 0.9965874538862359}-{'f1_val': 0.9969642566262439, 'auprc': 0.9951966741363145, 'loss_val': 0.01838965139727512, 'psi': 0.996257223630272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=75 head_norm_before_train=1.625159 cos_to_last_merge=0.9633 (last merge round=35)
[S13] round=75 local utility u=0.099083 metrics={'f1_val': 0.6352665592667193, 'auprc': 0.7846139947716754, 'loss_val': 1.0000551977646754, 'psi': 0.6950055334687018}-{'f1_val': 0.6154482507902755, 'auprc': 0.7600679161621456, 'loss_val': 1.005673761801986, 'psi': 0.6732961169390236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=75 head_norm_before_train=1.910110 cos_to_last_merge=0.9701 (last merge round=37)
[S14] round=75 local utility u=0.000298 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9969564275014602, 'loss_val': 0.024653423546090555, 'psi': 0.9968508755048674}-{'f1_val': 0.9967325241656609, 'auprc': 0.9985247360445532, 'loss_val': 0.029667321710432633, 'psi': 0.9974494089172178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=75 head_norm_before_train=2.048099 cos_to_last_merge=0.9676 (last merge round=43)
[S15] round=75 local utility u=0.090911 metrics={'f1_val': 0.9041488670541122, 'auprc': 0.9972128758572378, 'loss_val': 0.20003318555429173, 'psi': 0.9413744705753625}-{'f1_val': 0.8846446580905414, 'auprc': 0.9969092571279314, 'loss_val': 0.2639188358211372, 'psi': 0.9295504977054974}
[S15] not sending this round → trigger blocked (psi=0.941)
[S16] START round=75 head_norm_before_train=1.804786 cos_to_last_merge=0.9884 (last merge round=44)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9835123318325468, 'auprc': 0.9906322334775297, 'loss_val': 0.069669241535813, 'psi': 0.9863602924905399}-{'f1_val': 0.9917314007009104, 'auprc': 0.9906548271544491, 'loss_val': 0.04679673206753181, 'psi': 0.9913007712823259}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.789419 cos_to_last_merge=0.9750 (last merge round=41)
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.48587204879722556, 'auprc': 0.6811336194892886, 'loss_val': 1.5725174327217326, 'psi': 0.5639766770740509}-{'f1_val': 0.629932404141172, 'auprc': 0.9324606056397001, 'loss_val': 1.1740556553759771, 'psi': 0.7509436847405833}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.171096 (no previous merge yet)
[S2] round=76 local utility u=0.020520 metrics={'f1_val': 0.827876877440384, 'auprc': 0.9320654127826772, 'loss_val': 0.46172958734543684, 'psi': 0.8695522915773013}-{'f1_val': 0.8302093643665346, 'auprc': 0.9112664995036298, 'loss_val': 0.45436839194913164, 'psi': 0.8626322184213726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=76 head_norm_before_train=2.176796 cos_to_last_merge=0.9686 (last merge round=43)
[S3] round=76 local utility u=0.866577 metrics={'f1_val': 0.9520740333156694, 'auprc': 0.9985699276818274, 'loss_val': 0.10090658110136708, 'psi': 0.9706723910621327}-{'f1_val': 0.7476280007379217, 'auprc': 0.9979983444366703, 'loss_val': 0.6056692438918984, 'psi': 0.8477761382174211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=76 head_norm_before_train=1.790549 cos_to_last_merge=0.9935 (last merge round=44)
[S4] round=76 local utility u=0.063428 metrics={'f1_val': 0.9566667887659561, 'auprc': 0.9711710741080896, 'loss_val': 0.27996980293811263, 'psi': 0.9624685029028095}-{'f1_val': 0.9456935319102134, 'auprc': 0.9564092032689272, 'loss_val': 0.29670025508902426, 'psi': 0.9499798004536989}
[S4] not sending this round → trigger blocked (psi=0.962)
[S5] START round=76 head_norm_before_train=1.934357 cos_to_last_merge=0.8305 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9940813528929032, 'loss_val': 0.02956667686440036, 'psi': 0.9952566706959937}-{'f1_val': 0.996186023309311, 'auprc': 0.994865948210877, 'loss_val': 0.02907539743549578, 'psi': 0.9956579932699374}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.013720 cos_to_last_merge=0.9930 (last merge round=43)
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7458180597916286, 'auprc': 0.8977772291917694, 'loss_val': 0.8809814458848664, 'psi': 0.806601727551685}-{'f1_val': 0.7716374240149884, 'auprc': 0.8961696953388895, 'loss_val': 0.7254785562786232, 'psi': 0.8214503325445488}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=2.227095 cos_to_last_merge=0.9717 (last merge round=43)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6869905934006093, 'auprc': 0.9304068064295969, 'loss_val': 1.2805993691500819, 'psi': 0.7843570786122044}-{'f1_val': 0.7931567566612985, 'auprc': 0.9422797617177753, 'loss_val': 0.7705630615298683, 'psi': 0.8528059586838892}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.782434 cos_to_last_merge=0.9856 (last merge round=42)
[S8] round=76 local utility u=0.074289 metrics={'f1_val': 0.9932225217693944, 'auprc': 0.9980580636905179, 'loss_val': 0.035118192568119974, 'psi': 0.9951567385378438}-{'f1_val': 0.9739428145667117, 'auprc': 0.9987457625284467, 'loss_val': 0.07008029181944044, 'psi': 0.9838639937514058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=76 head_norm_before_train=1.777801 cos_to_last_merge=0.9905 (last merge round=44)
[S9] round=76 local utility u=0.005946 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9984809186450574, 'loss_val': 0.021857289136697274, 'psi': 0.997007105661567}-{'f1_val': 0.9966924912647621, 'auprc': 0.992739354750667, 'loss_val': 0.020532570732744507, 'psi': 0.9951112366591242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=76 head_norm_before_train=2.094123 cos_to_last_merge=0.9851 (last merge round=45)
[S10] round=76 local utility u=0.000139 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.997595213626636, 'loss_val': 0.026252625247466674, 'psi': 0.9958367184563042}-{'f1_val': 0.9946643883427498, 'auprc': 0.9976032444629466, 'loss_val': 0.026553764257138613, 'psi': 0.9958399307908286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=76 head_norm_before_train=2.056568 cos_to_last_merge=0.9932 (last merge round=43)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954760083343619, 'loss_val': 0.01832817235250823, 'psi': 0.9961209563308031}-{'f1_val': 0.9965509216617638, 'auprc': 0.996642252222944, 'loss_val': 0.018950239446978066, 'psi': 0.9965874538862359}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=76 head_norm_before_train=1.630777 cos_to_last_merge=0.9627 (last merge round=35)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6290817329580138, 'auprc': 0.7800684579098016, 'loss_val': 1.0736191123449965, 'psi': 0.6894764229387289}-{'f1_val': 0.6352665592667193, 'auprc': 0.7846139947716754, 'loss_val': 1.0000551977646754, 'psi': 0.6950055334687018}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=1.913526 cos_to_last_merge=0.9698 (last merge round=37)
[S14] round=76 local utility u=0.000676 metrics={'f1_val': 0.9971660554268293, 'auprc': 0.9969564518536662, 'loss_val': 0.02561564584427995, 'psi': 0.9970822139975641}-{'f1_val': 0.9967805075071389, 'auprc': 0.9969564275014602, 'loss_val': 0.024653423546090555, 'psi': 0.9968508755048674}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=76 head_norm_before_train=2.055710 cos_to_last_merge=0.9670 (last merge round=43)
[S15] round=76 local utility u=0.097079 metrics={'f1_val': 0.9244405565533833, 'auprc': 0.9975033482211573, 'loss_val': 0.12849677187535744, 'psi': 0.9536656732204929}-{'f1_val': 0.9041488670541122, 'auprc': 0.9972128758572378, 'loss_val': 0.20003318555429173, 'psi': 0.9413744705753625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=76 head_norm_before_train=1.810259 cos_to_last_merge=0.9881 (last merge round=44)
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9760936989946449, 'auprc': 0.9900046828622583, 'loss_val': 0.09377139737773739, 'psi': 0.9816580925416902}-{'f1_val': 0.9835123318325468, 'auprc': 0.9906322334775297, 'loss_val': 0.069669241535813, 'psi': 0.9863602924905399}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=1.796651 cos_to_last_merge=0.9744 (last merge round=41)
[S17] round=76 local utility u=1.000000 metrics={'f1_val': 0.7136401943443105, 'auprc': 0.8303107003382423, 'loss_val': 0.9287885620510552, 'psi': 0.7603083967418832}-{'f1_val': 0.48587204879722556, 'auprc': 0.6811336194892886, 'loss_val': 1.5725174327217326, 'psi': 0.5639766770740509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=77 head_norm_before_train=2.176899 (no previous merge yet)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.77650002503599, 'auprc': 0.848065417081539, 'loss_val': 0.6752091155838261, 'psi': 0.8051261818542097}-{'f1_val': 0.827876877440384, 'auprc': 0.9320654127826772, 'loss_val': 0.46172958734543684, 'psi': 0.8695522915773013}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.177918 cos_to_last_merge=0.9684 (last merge round=43)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9304641944067636, 'auprc': 0.9752957562856751, 'loss_val': 0.2446547836406081, 'psi': 0.9483968191583282}-{'f1_val': 0.9520740333156694, 'auprc': 0.9985699276818274, 'loss_val': 0.10090658110136708, 'psi': 0.9706723910621327}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.790266 cos_to_last_merge=0.9932 (last merge round=44)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9397820008152791, 'auprc': 0.9538516894176496, 'loss_val': 0.3127021576944373, 'psi': 0.9454098762562273}-{'f1_val': 0.9566667887659561, 'auprc': 0.9711710741080896, 'loss_val': 0.27996980293811263, 'psi': 0.9624685029028095}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.934488 cos_to_last_merge=0.8299 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=77 local utility u=0.004982 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9977641379465865, 'loss_val': 0.029770226909118628, 'psi': 0.9966416494498382}-{'f1_val': 0.9960402158980539, 'auprc': 0.9940813528929032, 'loss_val': 0.02956667686440036, 'psi': 0.9952566706959937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=77 head_norm_before_train=2.020775 cos_to_last_merge=0.9929 (last merge round=43)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6611263259431998, 'auprc': 0.7567506931512709, 'loss_val': 1.076334271161786, 'psi': 0.6993760728264282}-{'f1_val': 0.7458180597916286, 'auprc': 0.8977772291917694, 'loss_val': 0.8809814458848664, 'psi': 0.806601727551685}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=2.237196 cos_to_last_merge=0.9709 (last merge round=43)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.6393017866294979, 'auprc': 0.9239679074007935, 'loss_val': 1.4360133996638107, 'psi': 0.7531682349380161}-{'f1_val': 0.6869905934006093, 'auprc': 0.9304068064295969, 'loss_val': 1.2805993691500819, 'psi': 0.7843570786122044}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.784820 cos_to_last_merge=0.9854 (last merge round=42)
[S8] round=77 local utility u=0.000000 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9986740293493854, 'loss_val': 0.03840240390417968, 'psi': 0.995184183109582}-{'f1_val': 0.9932225217693944, 'auprc': 0.9980580636905179, 'loss_val': 0.035118192568119974, 'psi': 0.9951567385378438}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=77 head_norm_before_train=1.784347 cos_to_last_merge=0.9902 (last merge round=44)
[S9] round=77 local utility u=0.000000 metrics={'f1_val': 0.9926544572506684, 'auprc': 0.9984796338029325, 'loss_val': 0.03261169276105139, 'psi': 0.994984527871574}-{'f1_val': 0.9960245636725735, 'auprc': 0.9984809186450574, 'loss_val': 0.021857289136697274, 'psi': 0.997007105661567}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=77 head_norm_before_train=2.099326 cos_to_last_merge=0.9848 (last merge round=45)
[S10] round=77 local utility u=0.000437 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9968639083458697, 'loss_val': 0.025818889469209044, 'psi': 0.9958076441840068}-{'f1_val': 0.9946643883427498, 'auprc': 0.997595213626636, 'loss_val': 0.026252625247466674, 'psi': 0.9958367184563042}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=77 head_norm_before_train=2.062241 cos_to_last_merge=0.9930 (last merge round=43)
[S11] round=77 local utility u=0.001563 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9953226889665708, 'loss_val': 0.01722318912864933, 'psi': 0.9963076295623746}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954760083343619, 'loss_val': 0.01832817235250823, 'psi': 0.9961209563308031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=77 head_norm_before_train=1.638714 cos_to_last_merge=0.9617 (last merge round=35)
[S13] round=77 local utility u=0.035070 metrics={'f1_val': 0.6354098140181911, 'auprc': 0.7767533769015565, 'loss_val': 1.0315024212768122, 'psi': 0.6919472391715373}-{'f1_val': 0.6290817329580138, 'auprc': 0.7800684579098016, 'loss_val': 1.0736191123449965, 'psi': 0.6894764229387289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=77 head_norm_before_train=1.918490 cos_to_last_merge=0.9693 (last merge round=37)
[S14] round=77 local utility u=0.001058 metrics={'f1_val': 0.9974089034627865, 'auprc': 0.9968590401359623, 'loss_val': 0.02466392493644646, 'psi': 0.9971889581320568}-{'f1_val': 0.9971660554268293, 'auprc': 0.9969564518536662, 'loss_val': 0.02561564584427995, 'psi': 0.9970822139975641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=77 head_norm_before_train=2.063124 cos_to_last_merge=0.9664 (last merge round=43)
[S15] round=77 local utility u=0.074669 metrics={'f1_val': 0.9421803821816204, 'auprc': 0.9980406457866071, 'loss_val': 0.08720964714844542, 'psi': 0.964524487623615}-{'f1_val': 0.9244405565533833, 'auprc': 0.9975033482211573, 'loss_val': 0.12849677187535744, 'psi': 0.9536656732204929}
[S15] not sending this round → trigger blocked (psi=0.965)
[S16] START round=77 head_norm_before_train=1.816522 cos_to_last_merge=0.9877 (last merge round=44)
[S16] round=77 local utility u=0.002643 metrics={'f1_val': 0.9765233859376188, 'auprc': 0.9899521493135415, 'loss_val': 0.0909067364828686, 'psi': 0.9818948912879879}-{'f1_val': 0.9760936989946449, 'auprc': 0.9900046828622583, 'loss_val': 0.09377139737773739, 'psi': 0.9816580925416902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=77 head_norm_before_train=1.804852 cos_to_last_merge=0.9738 (last merge round=41)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.644144459694634, 'auprc': 0.8809189807545332, 'loss_val': 1.202068388264913, 'psi': 0.7388542681185937}-{'f1_val': 0.7136401943443105, 'auprc': 0.8303107003382423, 'loss_val': 0.9287885620510552, 'psi': 0.7603083967418832}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.182730 (no previous merge yet)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.6431555825234615, 'auprc': 0.7629529002779107, 'loss_val': 1.2934064472505429, 'psi': 0.6910745096252412}-{'f1_val': 0.77650002503599, 'auprc': 0.848065417081539, 'loss_val': 0.6752091155838261, 'psi': 0.8051261818542097}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.174691 cos_to_last_merge=0.9683 (last merge round=43)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9274073383714333, 'auprc': 0.9716390737972453, 'loss_val': 0.23716040928750898, 'psi': 0.945100032541758}-{'f1_val': 0.9304641944067636, 'auprc': 0.9752957562856751, 'loss_val': 0.2446547836406081, 'psi': 0.9483968191583282}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=1.792024 cos_to_last_merge=0.9931 (last merge round=44)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9377150002691684, 'auprc': 0.9327941179617779, 'loss_val': 0.38734787894594297, 'psi': 0.9357466473462123}-{'f1_val': 0.9397820008152791, 'auprc': 0.9538516894176496, 'loss_val': 0.3127021576944373, 'psi': 0.9454098762562273}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.938023 cos_to_last_merge=0.8296 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=78 local utility u=0.001803 metrics={'f1_val': 0.9960427772561394, 'auprc': 0.9978133588250007, 'loss_val': 0.027208550500430282, 'psi': 0.9967510098836839}-{'f1_val': 0.9958933237853395, 'auprc': 0.9977641379465865, 'loss_val': 0.029770226909118628, 'psi': 0.9966416494498382}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=78 head_norm_before_train=2.026916 cos_to_last_merge=0.9923 (last merge round=43)
[S6] round=78 local utility u=0.825140 metrics={'f1_val': 0.7845764416688474, 'auprc': 0.9321436998407389, 'loss_val': 0.6929345588434437, 'psi': 0.843603344937604}-{'f1_val': 0.6611263259431998, 'auprc': 0.7567506931512709, 'loss_val': 1.076334271161786, 'psi': 0.6993760728264282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=78 head_norm_before_train=2.248038 cos_to_last_merge=0.9701 (last merge round=43)
[S7] round=78 local utility u=0.806903 metrics={'f1_val': 0.7989587790043013, 'auprc': 0.9537397759329306, 'loss_val': 0.8694650825624156, 'psi': 0.8608711777757531}-{'f1_val': 0.6393017866294979, 'auprc': 0.9239679074007935, 'loss_val': 1.4360133996638107, 'psi': 0.7531682349380161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=78 head_norm_before_train=1.789364 cos_to_last_merge=0.9851 (last merge round=42)
[S8] round=78 local utility u=0.002573 metrics={'f1_val': 0.9928576189497129, 'auprc': 0.9988624641969375, 'loss_val': 0.033820816112789386, 'psi': 0.9952595570486027}-{'f1_val': 0.9928576189497129, 'auprc': 0.9986740293493854, 'loss_val': 0.03840240390417968, 'psi': 0.995184183109582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=78 head_norm_before_train=1.788562 cos_to_last_merge=0.9900 (last merge round=44)
[S9] round=78 local utility u=0.011961 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984902351337, 'loss_val': 0.023788101434113775, 'psi': 0.9964953978874491}-{'f1_val': 0.9926544572506684, 'auprc': 0.9984796338029325, 'loss_val': 0.03261169276105139, 'psi': 0.994984527871574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=78 head_norm_before_train=2.105224 cos_to_last_merge=0.9845 (last merge round=45)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9972581277127113, 'loss_val': 0.025882078291535635, 'psi': 0.9958335855433212}-{'f1_val': 0.9951034680760983, 'auprc': 0.9968639083458697, 'loss_val': 0.025818889469209044, 'psi': 0.9958076441840068}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.067809 cos_to_last_merge=0.9928 (last merge round=43)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9950288046897648, 'loss_val': 0.01772666013720658, 'psi': 0.9961900758516522}-{'f1_val': 0.9969642566262439, 'auprc': 0.9953226889665708, 'loss_val': 0.01722318912864933, 'psi': 0.9963076295623746}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.648081 cos_to_last_merge=0.9606 (last merge round=35)
[S13] round=78 local utility u=0.252826 metrics={'f1_val': 0.6970351659080705, 'auprc': 0.7835552972657235, 'loss_val': 0.9160087703333729, 'psi': 0.7316432184511317}-{'f1_val': 0.6354098140181911, 'auprc': 0.7767533769015565, 'loss_val': 1.0315024212768122, 'psi': 0.6919472391715373}
[S13] not sending this round → trigger blocked (psi=0.732)
[S14] START round=78 head_norm_before_train=1.922644 cos_to_last_merge=0.9688 (last merge round=37)
[S14] round=78 local utility u=0.000012 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9986467210394516, 'loss_val': 0.023618849268992846, 'psi': 0.9972656989372931}-{'f1_val': 0.9974089034627865, 'auprc': 0.9968590401359623, 'loss_val': 0.02466392493644646, 'psi': 0.9971889581320568}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=78 head_norm_before_train=2.070419 cos_to_last_merge=0.9658 (last merge round=43)
[S15] round=78 local utility u=0.065174 metrics={'f1_val': 0.960868163687112, 'auprc': 0.9976033675720672, 'loss_val': 0.06767637226925985, 'psi': 0.9755622452410941}-{'f1_val': 0.9421803821816204, 'auprc': 0.9980406457866071, 'loss_val': 0.08720964714844542, 'psi': 0.964524487623615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=78 head_norm_before_train=1.822337 cos_to_last_merge=0.9875 (last merge round=44)
[S16] round=78 local utility u=0.034020 metrics={'f1_val': 0.9837292515458508, 'auprc': 0.9906746315572692, 'loss_val': 0.06826857255375118, 'psi': 0.9865074035504181}-{'f1_val': 0.9765233859376188, 'auprc': 0.9899521493135415, 'loss_val': 0.0909067364828686, 'psi': 0.9818948912879879}
[S16] not sending this round → trigger blocked (psi=0.987)
[S17] START round=78 head_norm_before_train=1.814137 cos_to_last_merge=0.9730 (last merge round=41)
[S17] round=78 local utility u=0.010398 metrics={'f1_val': 0.6533114096642109, 'auprc': 0.8529999864264348, 'loss_val': 1.152517523227579, 'psi': 0.7331868403691004}-{'f1_val': 0.644144459694634, 'auprc': 0.8809189807545332, 'loss_val': 1.202068388264913, 'psi': 0.7388542681185937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=79 head_norm_before_train=2.188671 (no previous merge yet)
[S2] round=79 local utility u=1.000000 metrics={'f1_val': 0.7654432826721648, 'auprc': 0.9379902349422193, 'loss_val': 0.5159500384545312, 'psi': 0.8344620635801866}-{'f1_val': 0.6431555825234615, 'auprc': 0.7629529002779107, 'loss_val': 1.2934064472505429, 'psi': 0.6910745096252412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] r=80 psi=0.834 u=1.0000 p_local=0.2336 f1=0.765 auprc=0.938 bytes=63009
[S3] START round=79 head_norm_before_train=2.177512 cos_to_last_merge=0.9682 (last merge round=43)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.7338502599074506, 'auprc': 0.995722314770057, 'loss_val': 0.7175609184152839, 'psi': 0.8385990818524931}-{'f1_val': 0.9274073383714333, 'auprc': 0.9716390737972453, 'loss_val': 0.23716040928750898, 'psi': 0.945100032541758}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.839 u=0.0000 p_local=0.1816 f1=0.734 auprc=0.996 bytes=55774
[S4] START round=79 head_norm_before_train=1.798562 cos_to_last_merge=0.9930 (last merge round=44)
[S4] round=79 local utility u=0.040605 metrics={'f1_val': 0.9389598981464561, 'auprc': 0.9380527670721702, 'loss_val': 0.32938274394676076, 'psi': 0.9385970457167417}-{'f1_val': 0.9377150002691684, 'auprc': 0.9327941179617779, 'loss_val': 0.38734787894594297, 'psi': 0.9357466473462123}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=80 psi=0.939 u=0.0406 p_local=0.0182 f1=0.939 auprc=0.938 bytes=55814
[S5] START round=79 head_norm_before_train=1.953129 cos_to_last_merge=0.8286 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9977472946365683, 'loss_val': 0.028268532461269553, 'psi': 0.996634912125831}-{'f1_val': 0.9960427772561394, 'auprc': 0.9978133588250007, 'loss_val': 0.027208550500430282, 'psi': 0.9967510098836839}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.997 u=0.0000 p_local=0.0043 f1=0.996 auprc=0.998 bytes=57589
[S6] START round=79 head_norm_before_train=2.029780 cos_to_last_merge=0.9918 (last merge round=43)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.7650081049137099, 'auprc': 0.9395166544105333, 'loss_val': 0.8334170808324385, 'psi': 0.8348115247124392}-{'f1_val': 0.7845764416688474, 'auprc': 0.9321436998407389, 'loss_val': 0.6929345588434437, 'psi': 0.843603344937604}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.835 u=0.0000 p_local=0.2705 f1=0.765 auprc=0.940 bytes=55791
[S7] START round=79 head_norm_before_train=2.256875 cos_to_last_merge=0.9693 (last merge round=43)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.7749641903629475, 'auprc': 0.9549693733519009, 'loss_val': 1.035800492979149, 'psi': 0.8469662635585289}-{'f1_val': 0.7989587790043013, 'auprc': 0.9537397759329306, 'loss_val': 0.8694650825624156, 'psi': 0.8608711777757531}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.847 u=0.0000 p_local=0.2724 f1=0.775 auprc=0.955 bytes=53963
[S8] START round=79 head_norm_before_train=1.797030 cos_to_last_merge=0.9847 (last merge round=42)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9914146370589574, 'auprc': 0.9988790676812584, 'loss_val': 0.03543571389008087, 'psi': 0.9944004093078778}-{'f1_val': 0.9928576189497129, 'auprc': 0.9988624641969375, 'loss_val': 0.033820816112789386, 'psi': 0.9952595570486027}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.994 u=0.0000 p_local=0.0109 f1=0.991 auprc=0.999 bytes=66597
[S9] START round=79 head_norm_before_train=1.793845 cos_to_last_merge=0.9897 (last merge round=44)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9933372174410589, 'loss_val': 0.02054411914617164, 'psi': 0.9953503817352809}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984902351337, 'loss_val': 0.023788101434113775, 'psi': 0.9964953978874491}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.995 u=0.0000 p_local=0.0034 f1=0.997 auprc=0.993 bytes=62952
[S10] START round=79 head_norm_before_train=2.111435 cos_to_last_merge=0.9842 (last merge round=45)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9975620637561895, 'loss_val': 0.026511462342121546, 'psi': 0.9958234585081256}-{'f1_val': 0.9948838907637279, 'auprc': 0.9972581277127113, 'loss_val': 0.025882078291535635, 'psi': 0.9958335855433212}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.996 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.998 bytes=62964
[S11] START round=79 head_norm_before_train=2.071718 cos_to_last_merge=0.9926 (last merge round=43)
[S11] round=79 local utility u=0.001039 metrics={'f1_val': 0.9969642566262439, 'auprc': 0.9954506908166117, 'loss_val': 0.016913580149567408, 'psi': 0.9963588303023909}-{'f1_val': 0.9969642566262439, 'auprc': 0.9950288046897648, 'loss_val': 0.01772666013720658, 'psi': 0.9961900758516522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S11] r=80 psi=0.996 u=0.0010 p_local=0.0008 f1=0.997 auprc=0.995 bytes=62933
[S13] START round=79 head_norm_before_train=1.656453 cos_to_last_merge=0.9596 (last merge round=35)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.607959216564229, 'auprc': 0.7615539406173876, 'loss_val': 1.2167685034427251, 'psi': 0.6693971061854924}-{'f1_val': 0.6970351659080705, 'auprc': 0.7835552972657235, 'loss_val': 0.9160087703333729, 'psi': 0.7316432184511317}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.669 u=0.0000 p_local=0.0879 f1=0.608 auprc=0.762 bytes=61181
[S14] START round=79 head_norm_before_train=1.927778 cos_to_last_merge=0.9682 (last merge round=37)
[S14] round=79 local utility u=0.001990 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9990210691453165, 'loss_val': 0.023241840431106216, 'psi': 0.9976635271417357}-{'f1_val': 0.996345017535854, 'auprc': 0.9986467210394516, 'loss_val': 0.023618849268992846, 'psi': 0.9972656989372931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] r=80 psi=0.998 u=0.0020 p_local=0.0008 f1=0.997 auprc=0.999 bytes=71998
[S15] START round=79 head_norm_before_train=2.077314 cos_to_last_merge=0.9652 (last merge round=43)
[S15] round=79 local utility u=0.032230 metrics={'f1_val': 0.9691076836759945, 'auprc': 0.9975887455003863, 'loss_val': 0.052609176994101225, 'psi': 0.9805001084057512}-{'f1_val': 0.960868163687112, 'auprc': 0.9976033675720672, 'loss_val': 0.06767637226925985, 'psi': 0.9755622452410941}
[S15] not sending this round → trigger blocked (psi=0.981)
[S15] r=80 psi=0.981 u=0.0322 p_local=0.0638 f1=0.969 auprc=0.998 bytes=55766
[S16] START round=79 head_norm_before_train=1.828339 cos_to_last_merge=0.9872 (last merge round=44)
[S16] round=79 local utility u=0.029426 metrics={'f1_val': 0.9909250539271397, 'auprc': 0.9906645640990939, 'loss_val': 0.05256201937258362, 'psi': 0.9908208579959215}-{'f1_val': 0.9837292515458508, 'auprc': 0.9906746315572692, 'loss_val': 0.06826857255375118, 'psi': 0.9865074035504181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S16] r=80 psi=0.991 u=0.0294 p_local=0.0178 f1=0.991 auprc=0.991 bytes=61192
[S17] START round=79 head_norm_before_train=1.823497 cos_to_last_merge=0.9723 (last merge round=41)
[S17] round=79 local utility u=0.163430 metrics={'f1_val': 0.6615247026588639, 'auprc': 0.9162528913746449, 'loss_val': 1.0646960156514902, 'psi': 0.7634159781451764}-{'f1_val': 0.6533114096642109, 'auprc': 0.8529999864264348, 'loss_val': 1.152517523227579, 'psi': 0.7331868403691004}
[S17] not sending this round → trigger blocked (psi=0.763)
[S17] r=80 psi=0.763 u=0.1634 p_local=0.2102 f1=0.662 auprc=0.916 bytes=63019
[S2] START round=80 head_norm_before_train=2.192937 (no previous merge yet)
[S2] round=80 local utility u=0.012043 metrics={'f1_val': 0.8322595253649474, 'auprc': 0.7859960702809645, 'loss_val': 0.4367796293716291, 'psi': 0.8137541433313542}-{'f1_val': 0.7654432826721648, 'auprc': 0.9379902349422193, 'loss_val': 0.5159500384545312, 'psi': 0.8344620635801866}
[S2] not sending this round → trigger blocked (psi=0.814)
[S3] START round=80 head_norm_before_train=2.183000 cos_to_last_merge=0.9680 (last merge round=43)
[S3] round=80 local utility u=0.577641 metrics={'f1_val': 0.859367942359792, 'auprc': 0.9897720315476919, 'loss_val': 0.2975350623069083, 'psi': 0.9115295780349519}-{'f1_val': 0.7338502599074506, 'auprc': 0.995722314770057, 'loss_val': 0.7175609184152839, 'psi': 0.8385990818524931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=80 head_norm_before_train=1.797930 cos_to_last_merge=0.9927 (last merge round=44)
[S4] round=80 local utility u=0.064304 metrics={'f1_val': 0.9406196153642055, 'auprc': 0.9693362800748143, 'loss_val': 0.304583539533616, 'psi': 0.9521062812484491}-{'f1_val': 0.9389598981464561, 'auprc': 0.9380527670721702, 'loss_val': 0.32938274394676076, 'psi': 0.9385970457167417}
[S4] not sending this round → trigger blocked (psi=0.952)
[S5] START round=80 head_norm_before_train=1.963753 cos_to_last_merge=0.8278 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.995671490833627, 'auprc': 0.9894329344368427, 'loss_val': 0.03182252805604023, 'psi': 0.9931760682749133}-{'f1_val': 0.9958933237853395, 'auprc': 0.9977472946365683, 'loss_val': 0.028268532461269553, 'psi': 0.996634912125831}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=2.031890 cos_to_last_merge=0.9912 (last merge round=43)
[S6] round=80 local utility u=0.159409 metrics={'f1_val': 0.8086291346615422, 'auprc': 0.9080508952502193, 'loss_val': 0.6819277368599305, 'psi': 0.848397838897013}-{'f1_val': 0.7650081049137099, 'auprc': 0.9395166544105333, 'loss_val': 0.8334170808324385, 'psi': 0.8348115247124392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=80 head_norm_before_train=2.267546 cos_to_last_merge=0.9684 (last merge round=43)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.5323855415635563, 'auprc': 0.8006045316170278, 'loss_val': 2.079859746006915, 'psi': 0.6396731375849449}-{'f1_val': 0.7749641903629475, 'auprc': 0.9549693733519009, 'loss_val': 1.035800492979149, 'psi': 0.8469662635585289}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=1.805231 cos_to_last_merge=0.9842 (last merge round=42)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.8701955459361146, 'auprc': 0.9987963755877488, 'loss_val': 0.2494191394837197, 'psi': 0.9216358777967683}-{'f1_val': 0.9914146370589574, 'auprc': 0.9988790676812584, 'loss_val': 0.03543571389008087, 'psi': 0.9944004093078778}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=1.800367 cos_to_last_merge=0.9894 (last merge round=44)
[S9] round=80 local utility u=0.002570 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984883609361648, 'loss_val': 0.021694839235657334, 'psi': 0.9964946482084349}-{'f1_val': 0.9966924912647621, 'auprc': 0.9933372174410589, 'loss_val': 0.02054411914617164, 'psi': 0.9953503817352809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=80 head_norm_before_train=2.117961 cos_to_last_merge=0.9838 (last merge round=45)
[S10] round=80 local utility u=0.000076 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9974641999906954, 'loss_val': 0.026064918553184182, 'psi': 0.9957843130019279}-{'f1_val': 0.9946643883427498, 'auprc': 0.9975620637561895, 'loss_val': 0.026511462342121546, 'psi': 0.9958234585081256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=80 head_norm_before_train=2.071634 cos_to_last_merge=0.9926 (last merge round=43)
[S11] round=80 local utility u=0.003435 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9973841459750473, 'loss_val': 0.015986441665386063, 'psi': 0.9971463692445484}-{'f1_val': 0.9969642566262439, 'auprc': 0.9954506908166117, 'loss_val': 0.016913580149567408, 'psi': 0.9963588303023909}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=80 head_norm_before_train=1.663725 cos_to_last_merge=0.9588 (last merge round=35)
[S13] round=80 local utility u=0.211592 metrics={'f1_val': 0.6223551249482748, 'auprc': 0.7751139179969477, 'loss_val': 0.9206402723871622, 'psi': 0.683458642167744}-{'f1_val': 0.607959216564229, 'auprc': 0.7615539406173876, 'loss_val': 1.2167685034427251, 'psi': 0.6693971061854924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=80 head_norm_before_train=1.932682 cos_to_last_merge=0.9678 (last merge round=37)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9967358680170888, 'auprc': 0.9986339848969223, 'loss_val': 0.02352317619610085, 'psi': 0.9974951147690223}-{'f1_val': 0.9967584991393483, 'auprc': 0.9990210691453165, 'loss_val': 0.023241840431106216, 'psi': 0.9976635271417357}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.083901 cos_to_last_merge=0.9647 (last merge round=43)
[S15] round=80 local utility u=0.042201 metrics={'f1_val': 0.9801954081073505, 'auprc': 0.9982503891662575, 'loss_val': 0.03671920321682004, 'psi': 0.9874174005309133}-{'f1_val': 0.9691076836759945, 'auprc': 0.9975887455003863, 'loss_val': 0.052609176994101225, 'psi': 0.9805001084057512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=80 head_norm_before_train=1.834030 cos_to_last_merge=0.9869 (last merge round=44)
[S16] round=80 local utility u=0.003994 metrics={'f1_val': 0.9913636160107662, 'auprc': 0.9907284509420811, 'loss_val': 0.047397987593899196, 'psi': 0.9911095499832921}-{'f1_val': 0.9909250539271397, 'auprc': 0.9906645640990939, 'loss_val': 0.05256201937258362, 'psi': 0.9908208579959215}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=80 head_norm_before_train=1.831716 cos_to_last_merge=0.9716 (last merge round=41)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.6382520784621163, 'auprc': 0.8704296151446898, 'loss_val': 1.3353988210837795, 'psi': 0.7311230931351457}-{'f1_val': 0.6615247026588639, 'auprc': 0.9162528913746449, 'loss_val': 1.0646960156514902, 'psi': 0.7634159781451764}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=2.197323 (no previous merge yet)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7749935304846208, 'auprc': 0.8935034180056596, 'loss_val': 0.5387513788611303, 'psi': 0.8223974854930363}-{'f1_val': 0.8322595253649474, 'auprc': 0.7859960702809645, 'loss_val': 0.4367796293716291, 'psi': 0.8137541433313542}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.191623 cos_to_last_merge=0.9677 (last merge round=43)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.6750706788241241, 'auprc': 0.975097291637743, 'loss_val': 0.8846414843295158, 'psi': 0.7950813239495717}-{'f1_val': 0.859367942359792, 'auprc': 0.9897720315476919, 'loss_val': 0.2975350623069083, 'psi': 0.9115295780349519}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.796078 cos_to_last_merge=0.9924 (last merge round=44)
[S4] round=81 local utility u=0.003465 metrics={'f1_val': 0.9403874390943407, 'auprc': 0.97262739383288, 'loss_val': 0.3061345624579935, 'psi': 0.9532834209897564}-{'f1_val': 0.9406196153642055, 'auprc': 0.9693362800748143, 'loss_val': 0.304583539533616, 'psi': 0.9521062812484491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=81 head_norm_before_train=1.969584 cos_to_last_merge=0.8276 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=81 local utility u=0.005411 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9918747543372719, 'loss_val': 0.02965626157460666, 'psi': 0.9942858960061124}-{'f1_val': 0.995671490833627, 'auprc': 0.9894329344368427, 'loss_val': 0.03182252805604023, 'psi': 0.9931760682749133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=81 head_norm_before_train=2.037668 cos_to_last_merge=0.9909 (last merge round=43)
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.6733979065209696, 'auprc': 0.8175581706699687, 'loss_val': 1.1053348310643358, 'psi': 0.7310620121805693}-{'f1_val': 0.8086291346615422, 'auprc': 0.9080508952502193, 'loss_val': 0.6819277368599305, 'psi': 0.848397838897013}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=2.279996 cos_to_last_merge=0.9676 (last merge round=43)
[S7] round=81 local utility u=0.911026 metrics={'f1_val': 0.6408862343062681, 'auprc': 0.9337624205681455, 'loss_val': 1.3082859218665044, 'psi': 0.7580367088110191}-{'f1_val': 0.5323855415635563, 'auprc': 0.8006045316170278, 'loss_val': 2.079859746006915, 'psi': 0.6396731375849449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=81 head_norm_before_train=1.810295 cos_to_last_merge=0.9839 (last merge round=42)
[S8] round=81 local utility u=0.464850 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9990068099085748, 'loss_val': 0.037287545062135316, 'psi': 0.9934136704807126}-{'f1_val': 0.8701955459361146, 'auprc': 0.9987963755877488, 'loss_val': 0.2494191394837197, 'psi': 0.9216358777967683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=81 head_norm_before_train=1.804949 cos_to_last_merge=0.9892 (last merge round=44)
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.9984835109695304, 'loss_val': 0.02512634339874834, 'psi': 0.9964897014529468}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984883609361648, 'loss_val': 0.021694839235657334, 'psi': 0.9964946482084349}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.120970 cos_to_last_merge=0.9836 (last merge round=45)
[S10] round=81 local utility u=0.001015 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.996685550698658, 'loss_val': 0.025651811652194392, 'psi': 0.9958680926177015}-{'f1_val': 0.9946643883427498, 'auprc': 0.9974641999906954, 'loss_val': 0.026064918553184182, 'psi': 0.9957843130019279}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=81 head_norm_before_train=2.074267 cos_to_last_merge=0.9924 (last merge round=43)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.9969878514242156, 'auprc': 0.9974181119403596, 'loss_val': 0.01645759130272028, 'psi': 0.9971599556306733}-{'f1_val': 0.9969878514242156, 'auprc': 0.9973841459750473, 'loss_val': 0.015986441665386063, 'psi': 0.9971463692445484}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.668098 cos_to_last_merge=0.9582 (last merge round=35)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.6404743702412502, 'auprc': 0.7708763161219079, 'loss_val': 1.0875869498868016, 'psi': 0.6926351485935133}-{'f1_val': 0.6223551249482748, 'auprc': 0.7751139179969477, 'loss_val': 0.9206402723871622, 'psi': 0.683458642167744}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.938625 cos_to_last_merge=0.9673 (last merge round=37)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.998318039853967, 'loss_val': 0.025742060443058386, 'psi': 0.9973667304409833}-{'f1_val': 0.9967358680170888, 'auprc': 0.9986339848969223, 'loss_val': 0.02352317619610085, 'psi': 0.9974951147690223}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.090331 cos_to_last_merge=0.9642 (last merge round=43)
[S15] round=81 local utility u=0.018348 metrics={'f1_val': 0.9859494874920441, 'auprc': 0.9983785315084536, 'loss_val': 0.034932095247400485, 'psi': 0.990921105098608}-{'f1_val': 0.9801954081073505, 'auprc': 0.9982503891662575, 'loss_val': 0.03671920321682004, 'psi': 0.9874174005309133}
[S15] not sending this round → trigger blocked (psi=0.991)
[S16] START round=81 head_norm_before_train=1.839205 cos_to_last_merge=0.9865 (last merge round=44)
[S16] round=81 local utility u=0.000708 metrics={'f1_val': 0.9912962067270004, 'auprc': 0.9907525695164685, 'loss_val': 0.04565017842820092, 'psi': 0.9910787518427877}-{'f1_val': 0.9913636160107662, 'auprc': 0.9907284509420811, 'loss_val': 0.047397987593899196, 'psi': 0.9911095499832921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=81 head_norm_before_train=1.837748 cos_to_last_merge=0.9711 (last merge round=41)
[S17] round=81 local utility u=0.054398 metrics={'f1_val': 0.6432707635064291, 'auprc': 0.8762403349509782, 'loss_val': 1.2741473950510287, 'psi': 0.7364585920842488}-{'f1_val': 0.6382520784621163, 'auprc': 0.8704296151446898, 'loss_val': 1.3353988210837795, 'psi': 0.7311230931351457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=82 head_norm_before_train=2.200969 (no previous merge yet)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.7224385533531072, 'auprc': 0.8448480489455981, 'loss_val': 0.8347463789965723, 'psi': 0.7714023515901036}-{'f1_val': 0.7749935304846208, 'auprc': 0.8935034180056596, 'loss_val': 0.5387513788611303, 'psi': 0.8223974854930363}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.202167 cos_to_last_merge=0.9671 (last merge round=43)
[S3] round=82 local utility u=1.000000 metrics={'f1_val': 0.9296290174657442, 'auprc': 0.9841497241947204, 'loss_val': 0.20796210714096547, 'psi': 0.9514373001573346}-{'f1_val': 0.6750706788241241, 'auprc': 0.975097291637743, 'loss_val': 0.8846414843295158, 'psi': 0.7950813239495717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=82 head_norm_before_train=1.798065 cos_to_last_merge=0.9923 (last merge round=44)
[S4] round=82 local utility u=0.004907 metrics={'f1_val': 0.9407569539729682, 'auprc': 0.9743957467068396, 'loss_val': 0.30384205801889763, 'psi': 0.9542124710665167}-{'f1_val': 0.9403874390943407, 'auprc': 0.97262739383288, 'loss_val': 0.3061345624579935, 'psi': 0.9532834209897564}
[S4] not sending this round → trigger blocked (psi=0.954)
[S5] START round=82 head_norm_before_train=1.972648 cos_to_last_merge=0.8277 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.828
[S5] round=82 local utility u=0.007347 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9967991535765047, 'loss_val': 0.02973510283073095, 'psi': 0.9962556557018055}-{'f1_val': 0.9958933237853395, 'auprc': 0.9918747543372719, 'loss_val': 0.02965626157460666, 'psi': 0.9942858960061124}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=82 head_norm_before_train=2.044229 cos_to_last_merge=0.9905 (last merge round=43)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.5223643758733441, 'auprc': 0.6893783167588777, 'loss_val': 0.8690043613510325, 'psi': 0.5891699522275575}-{'f1_val': 0.6733979065209696, 'auprc': 0.8175581706699687, 'loss_val': 1.1053348310643358, 'psi': 0.7310620121805693}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=2.288234 cos_to_last_merge=0.9677 (last merge round=43)
[S7] round=82 local utility u=1.000000 metrics={'f1_val': 0.8384579680226432, 'auprc': 0.9677735272590361, 'loss_val': 0.492667229887439, 'psi': 0.8901841917172004}-{'f1_val': 0.6408862343062681, 'auprc': 0.9337624205681455, 'loss_val': 1.3082859218665044, 'psi': 0.7580367088110191}
[S7] not sending this round → trigger blocked (psi=0.890)
[S8] START round=82 head_norm_before_train=1.813628 cos_to_last_merge=0.9836 (last merge round=42)
[S8] round=82 local utility u=0.011695 metrics={'f1_val': 0.9928666440433099, 'auprc': 0.9990743949724741, 'loss_val': 0.03319055694152823, 'psi': 0.9953497444149755}-{'f1_val': 0.9896849108621378, 'auprc': 0.9990068099085748, 'loss_val': 0.037287545062135316, 'psi': 0.9934136704807126}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=82 head_norm_before_train=1.809087 cos_to_last_merge=0.9891 (last merge round=44)
[S9] round=82 local utility u=0.003903 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9961609831284339, 'loss_val': 0.019352287301086048, 'psi': 0.9964607003397085}-{'f1_val': 0.9951604951085576, 'auprc': 0.9984835109695304, 'loss_val': 0.02512634339874834, 'psi': 0.9964897014529468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=82 head_norm_before_train=2.125568 cos_to_last_merge=0.9834 (last merge round=45)
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9967502823108114, 'loss_val': 0.025744627509370878, 'psi': 0.9956304473825613}-{'f1_val': 0.9953231205637304, 'auprc': 0.996685550698658, 'loss_val': 0.025651811652194392, 'psi': 0.9958680926177015}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.078717 cos_to_last_merge=0.9922 (last merge round=43)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9984736932308695, 'loss_val': 0.018909536185810115, 'psi': 0.9973200302894062}-{'f1_val': 0.9969878514242156, 'auprc': 0.9974181119403596, 'loss_val': 0.01645759130272028, 'psi': 0.9971599556306733}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.671426 cos_to_last_merge=0.9578 (last merge round=35)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6048270532267725, 'auprc': 0.759108093832717, 'loss_val': 1.1530541122266675, 'psi': 0.6665394694691504}-{'f1_val': 0.6404743702412502, 'auprc': 0.7708763161219079, 'loss_val': 1.0875869498868016, 'psi': 0.6926351485935133}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.942588 cos_to_last_merge=0.9668 (last merge round=37)
[S14] round=82 local utility u=0.001133 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9984548819405369, 'loss_val': 0.025344238802736698, 'psi': 0.9975672528264806}-{'f1_val': 0.9967325241656609, 'auprc': 0.998318039853967, 'loss_val': 0.025742060443058386, 'psi': 0.9973667304409833}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=82 head_norm_before_train=2.096674 cos_to_last_merge=0.9637 (last merge round=43)
[S15] round=82 local utility u=0.018523 metrics={'f1_val': 0.9908692238061062, 'auprc': 0.9983354207550285, 'loss_val': 0.027274729820801508, 'psi': 0.9938557025856751}-{'f1_val': 0.9859494874920441, 'auprc': 0.9983785315084536, 'loss_val': 0.034932095247400485, 'psi': 0.990921105098608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=82 head_norm_before_train=1.843593 cos_to_last_merge=0.9862 (last merge round=44)
[S16] round=82 local utility u=0.000602 metrics={'f1_val': 0.9912962067270004, 'auprc': 0.990956204390766, 'loss_val': 0.045057433840292795, 'psi': 0.9911602057925066}-{'f1_val': 0.9912962067270004, 'auprc': 0.9907525695164685, 'loss_val': 0.04565017842820092, 'psi': 0.9910787518427877}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=82 head_norm_before_train=1.842730 cos_to_last_merge=0.9707 (last merge round=41)
[S17] round=82 local utility u=0.932960 metrics={'f1_val': 0.8186538451583469, 'auprc': 0.940106042382777, 'loss_val': 0.6521232933443051, 'psi': 0.867234724048119}-{'f1_val': 0.6432707635064291, 'auprc': 0.8762403349509782, 'loss_val': 1.2741473950510287, 'psi': 0.7364585920842488}
[S17] not sending this round → trigger blocked (psi=0.867)
[S2] START round=83 head_norm_before_train=2.203456 (no previous merge yet)
[S2] round=83 local utility u=0.588621 metrics={'f1_val': 0.8294311833764522, 'auprc': 0.900160805690533, 'loss_val': 0.46539929932293245, 'psi': 0.8577230323020845}-{'f1_val': 0.7224385533531072, 'auprc': 0.8448480489455981, 'loss_val': 0.8347463789965723, 'psi': 0.7714023515901036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=83 head_norm_before_train=2.213309 cos_to_last_merge=0.9665 (last merge round=43)
[S3] round=83 local utility u=0.100586 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.991394259337719, 'loss_val': 0.16231643036557325, 'psi': 0.9677144476660816}-{'f1_val': 0.9296290174657442, 'auprc': 0.9841497241947204, 'loss_val': 0.20796210714096547, 'psi': 0.9514373001573346}
[S3] not sending this round → trigger blocked (psi=0.968)
[S4] START round=83 head_norm_before_train=1.800832 cos_to_last_merge=0.9922 (last merge round=44)
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9419106071424245, 'auprc': 0.9716627290510507, 'loss_val': 0.30369931564263425, 'psi': 0.9538114559058749}-{'f1_val': 0.9407569539729682, 'auprc': 0.9743957467068396, 'loss_val': 0.30384205801889763, 'psi': 0.9542124710665167}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=1.976595 cos_to_last_merge=0.8272 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=83 local utility u=0.001133 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9975908054648859, 'loss_val': 0.02984492998319978, 'psi': 0.996572316457158}-{'f1_val': 0.9958933237853395, 'auprc': 0.9967991535765047, 'loss_val': 0.02973510283073095, 'psi': 0.9962556557018055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=83 head_norm_before_train=2.051923 cos_to_last_merge=0.9901 (last merge round=43)
[S6] round=83 local utility u=0.670825 metrics={'f1_val': 0.698498887040478, 'auprc': 0.840121355194518, 'loss_val': 1.0363906809099965, 'psi': 0.7551478743020941}-{'f1_val': 0.5223643758733441, 'auprc': 0.6893783167588777, 'loss_val': 0.8690043613510325, 'psi': 0.5891699522275575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=83 head_norm_before_train=2.295810 cos_to_last_merge=0.9673 (last merge round=43)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.8556899984999551, 'auprc': 0.9686011069952871, 'loss_val': 0.6548751173978555, 'psi': 0.9008544418980878}-{'f1_val': 0.8384579680226432, 'auprc': 0.9677735272590361, 'loss_val': 0.492667229887439, 'psi': 0.8901841917172004}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.815605 cos_to_last_merge=0.9834 (last merge round=42)
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9990445678758828, 'loss_val': 0.037669192842967665, 'psi': 0.9931441252312156}-{'f1_val': 0.9928666440433099, 'auprc': 0.9990743949724741, 'loss_val': 0.03319055694152823, 'psi': 0.9953497444149755}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=1.812871 cos_to_last_merge=0.9889 (last merge round=44)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9933237680007948, 'loss_val': 0.01960259692343774, 'psi': 0.9953450019591752}-{'f1_val': 0.9966605118138915, 'auprc': 0.9961609831284339, 'loss_val': 0.019352287301086048, 'psi': 0.9964607003397085}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.130955 cos_to_last_merge=0.9831 (last merge round=45)
[S10] round=83 local utility u=0.000050 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.997351399233065, 'loss_val': 0.02613166840539945, 'psi': 0.9957391926988759}-{'f1_val': 0.9948838907637279, 'auprc': 0.9967502823108114, 'loss_val': 0.025744627509370878, 'psi': 0.9956304473825613}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=83 head_norm_before_train=2.084178 cos_to_last_merge=0.9920 (last merge round=43)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9964356528976109, 'loss_val': 0.019114662272986135, 'psi': 0.9965048141561027}-{'f1_val': 0.9965509216617638, 'auprc': 0.9984736932308695, 'loss_val': 0.018909536185810115, 'psi': 0.9973200302894062}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=1.675796 cos_to_last_merge=0.9573 (last merge round=35)
[S13] round=83 local utility u=0.318275 metrics={'f1_val': 0.6508358926693141, 'auprc': 0.7770001353660647, 'loss_val': 0.8462340320630108, 'psi': 0.7013015897480144}-{'f1_val': 0.6048270532267725, 'auprc': 0.759108093832717, 'loss_val': 1.1530541122266675, 'psi': 0.6665394694691504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=83 head_norm_before_train=1.947718 cos_to_last_merge=0.9662 (last merge round=37)
[S14] round=83 local utility u=0.001535 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986313390013497, 'loss_val': 0.022803639463607684, 'psi': 0.9976378356508058}-{'f1_val': 0.9969755000837764, 'auprc': 0.9984548819405369, 'loss_val': 0.025344238802736698, 'psi': 0.9975672528264806}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=83 head_norm_before_train=2.103054 cos_to_last_merge=0.9632 (last merge round=43)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9892191502783977, 'auprc': 0.9976385511527778, 'loss_val': 0.02921321161897923, 'psi': 0.9925869106281497}-{'f1_val': 0.9908692238061062, 'auprc': 0.9983354207550285, 'loss_val': 0.027274729820801508, 'psi': 0.9938557025856751}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.847793 cos_to_last_merge=0.9860 (last merge round=44)
[S16] round=83 local utility u=0.000449 metrics={'f1_val': 0.9913182212421899, 'auprc': 0.9911261956241593, 'loss_val': 0.04480243693369253, 'psi': 0.9912414109949776}-{'f1_val': 0.9912962067270004, 'auprc': 0.990956204390766, 'loss_val': 0.045057433840292795, 'psi': 0.9911602057925066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=83 head_norm_before_train=1.848529 cos_to_last_merge=0.9701 (last merge round=41)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.7224014762007733, 'auprc': 0.9361977311016467, 'loss_val': 0.9598102291302362, 'psi': 0.8079199781611226}-{'f1_val': 0.8186538451583469, 'auprc': 0.940106042382777, 'loss_val': 0.6521232933443051, 'psi': 0.867234724048119}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.205128 (no previous merge yet)
[S2] round=84 local utility u=0.051269 metrics={'f1_val': 0.8255141462615561, 'auprc': 0.9438452728532934, 'loss_val': 0.47041334276717905, 'psi': 0.8728465968982511}-{'f1_val': 0.8294311833764522, 'auprc': 0.900160805690533, 'loss_val': 0.46539929932293245, 'psi': 0.8577230323020845}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=84 head_norm_before_train=2.224296 cos_to_last_merge=0.9659 (last merge round=43)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.9093597798816536, 'auprc': 0.9922008061995695, 'loss_val': 0.19105985556600238, 'psi': 0.94249619040882}-{'f1_val': 0.9519279065516568, 'auprc': 0.991394259337719, 'loss_val': 0.16231643036557325, 'psi': 0.9677144476660816}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=1.803132 cos_to_last_merge=0.9920 (last merge round=44)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.938909309059043, 'auprc': 0.9690509011428178, 'loss_val': 0.31056751231521224, 'psi': 0.9509659458925529}-{'f1_val': 0.9419106071424245, 'auprc': 0.9716627290510507, 'loss_val': 0.30369931564263425, 'psi': 0.9538114559058749}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.974247 cos_to_last_merge=0.8271 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=84 local utility u=0.001185 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9980776046238953, 'loss_val': 0.028934842235536235, 'psi': 0.9967670361207618}-{'f1_val': 0.9958933237853395, 'auprc': 0.9975908054648859, 'loss_val': 0.02984492998319978, 'psi': 0.996572316457158}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=84 head_norm_before_train=2.059306 cos_to_last_merge=0.9899 (last merge round=43)
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.6355509467567246, 'auprc': 0.8920543522136507, 'loss_val': 1.1074313276478818, 'psi': 0.738152308939495}-{'f1_val': 0.698498887040478, 'auprc': 0.840121355194518, 'loss_val': 1.0363906809099965, 'psi': 0.7551478743020941}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=2.303408 cos_to_last_merge=0.9669 (last merge round=43)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.8258702469556605, 'auprc': 0.9625862763489914, 'loss_val': 0.799707697771813, 'psi': 0.8805566587129928}-{'f1_val': 0.8556899984999551, 'auprc': 0.9686011069952871, 'loss_val': 0.6548751173978555, 'psi': 0.9008544418980878}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.820826 cos_to_last_merge=0.9831 (last merge round=42)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9884940992024185, 'auprc': 0.9991871130543604, 'loss_val': 0.04082260080022861, 'psi': 0.9927713047431952}-{'f1_val': 0.9892104968014376, 'auprc': 0.9990445678758828, 'loss_val': 0.037669192842967665, 'psi': 0.9931441252312156}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=1.819057 cos_to_last_merge=0.9886 (last merge round=44)
[S9] round=84 local utility u=0.002349 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947550922698186, 'loss_val': 0.019198609236082638, 'psi': 0.9959175316667848}-{'f1_val': 0.9966924912647621, 'auprc': 0.9933237680007948, 'loss_val': 0.01960259692343774, 'psi': 0.9953450019591752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=84 head_norm_before_train=2.134176 cos_to_last_merge=0.9829 (last merge round=45)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969723848156047, 'loss_val': 0.026039702401718205, 'psi': 0.9955875869318918}-{'f1_val': 0.9946643883427498, 'auprc': 0.997351399233065, 'loss_val': 0.02613166840539945, 'psi': 0.9957391926988759}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.090115 cos_to_last_merge=0.9918 (last merge round=43)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9950162279603871, 'loss_val': 0.019241622027356207, 'psi': 0.9959370441812132}-{'f1_val': 0.9965509216617638, 'auprc': 0.9964356528976109, 'loss_val': 0.019114662272986135, 'psi': 0.9965048141561027}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=1.680419 cos_to_last_merge=0.9568 (last merge round=35)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6197893222435498, 'auprc': 0.7668628482361346, 'loss_val': 1.0682632307375006, 'psi': 0.6786187326405837}-{'f1_val': 0.6508358926693141, 'auprc': 0.7770001353660647, 'loss_val': 0.8462340320630108, 'psi': 0.7013015897480144}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.952087 cos_to_last_merge=0.9658 (last merge round=37)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9969682852238615, 'loss_val': 0.023650083816169825, 'psi': 0.9967235408598033}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986313390013497, 'loss_val': 0.022803639463607684, 'psi': 0.9976378356508058}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.108835 cos_to_last_merge=0.9628 (last merge round=43)
[S15] round=84 local utility u=0.030608 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9984741981176377, 'loss_val': 0.01825393581501274, 'psi': 0.997696082453827}-{'f1_val': 0.9892191502783977, 'auprc': 0.9976385511527778, 'loss_val': 0.02921321161897923, 'psi': 0.9925869106281497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=84 head_norm_before_train=1.852887 cos_to_last_merge=0.9858 (last merge round=44)
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9898299207609107, 'auprc': 0.9907387445062686, 'loss_val': 0.05429933855651844, 'psi': 0.9901934502590539}-{'f1_val': 0.9913182212421899, 'auprc': 0.9911261956241593, 'loss_val': 0.04480243693369253, 'psi': 0.9912414109949776}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.854402 cos_to_last_merge=0.9697 (last merge round=41)
[S17] round=84 local utility u=0.221118 metrics={'f1_val': 0.7664372386909151, 'auprc': 0.9533245811320253, 'loss_val': 0.8331692668471599, 'psi': 0.8411921756673592}-{'f1_val': 0.7224014762007733, 'auprc': 0.9361977311016467, 'loss_val': 0.9598102291302362, 'psi': 0.8079199781611226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=85 head_norm_before_train=2.208627 (no previous merge yet)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.9348933496453583, 'loss_val': 0.46247014818264104, 'psi': 0.8706780757831916}-{'f1_val': 0.8255141462615561, 'auprc': 0.9438452728532934, 'loss_val': 0.47041334276717905, 'psi': 0.8728465968982511}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.234560 cos_to_last_merge=0.9653 (last merge round=43)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.6909945583053114, 'auprc': 0.9584471213684752, 'loss_val': 0.8583903930336844, 'psi': 0.797975583530577}-{'f1_val': 0.9093597798816536, 'auprc': 0.9922008061995695, 'loss_val': 0.19105985556600238, 'psi': 0.94249619040882}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.805470 cos_to_last_merge=0.9916 (last merge round=44)
[S4] round=85 local utility u=0.000828 metrics={'f1_val': 0.9387948771119564, 'auprc': 0.9694336918906477, 'loss_val': 0.3093732308022735, 'psi': 0.9510504030234329}-{'f1_val': 0.938909309059043, 'auprc': 0.9690509011428178, 'loss_val': 0.31056751231521224, 'psi': 0.9509659458925529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=85 head_norm_before_train=1.975726 cos_to_last_merge=0.8271 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9943489347913816, 'loss_val': 0.029272325949937547, 'psi': 0.9952755681877563}-{'f1_val': 0.9958933237853395, 'auprc': 0.9980776046238953, 'loss_val': 0.028934842235536235, 'psi': 0.9967670361207618}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.066284 cos_to_last_merge=0.9897 (last merge round=43)
[S6] round=85 local utility u=0.469417 metrics={'f1_val': 0.7442237249774075, 'auprc': 0.9269422851375653, 'loss_val': 0.9252969988108918, 'psi': 0.8173111490414706}-{'f1_val': 0.6355509467567246, 'auprc': 0.8920543522136507, 'loss_val': 1.1074313276478818, 'psi': 0.738152308939495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=85 head_norm_before_train=2.312733 cos_to_last_merge=0.9660 (last merge round=43)
[S7] round=85 local utility u=0.361034 metrics={'f1_val': 0.8502929229171277, 'auprc': 0.978810168470915, 'loss_val': 0.27284764060623534, 'psi': 0.9016998211386426}-{'f1_val': 0.8258702469556605, 'auprc': 0.9625862763489914, 'loss_val': 0.799707697771813, 'psi': 0.8805566587129928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=85 head_norm_before_train=1.827187 cos_to_last_merge=0.9828 (last merge round=42)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9932883265732785, 'auprc': 0.9875326451233866, 'loss_val': 0.03565662588646699, 'psi': 0.9909860539933217}-{'f1_val': 0.9884940992024185, 'auprc': 0.9991871130543604, 'loss_val': 0.04082260080022861, 'psi': 0.9927713047431952}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=1.824876 cos_to_last_merge=0.9883 (last merge round=44)
[S9] round=85 local utility u=0.004323 metrics={'f1_val': 0.9964388212112862, 'auprc': 0.9984959645734418, 'loss_val': 0.02025393901011546, 'psi': 0.9972616785561486}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947550922698186, 'loss_val': 0.019198609236082638, 'psi': 0.9959175316667848}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=85 head_norm_before_train=2.137902 cos_to_last_merge=0.9826 (last merge round=45)
[S10] round=85 local utility u=0.000504 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9967455284039939, 'loss_val': 0.025668485201736688, 'psi': 0.9956285458198343}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969723848156047, 'loss_val': 0.026039702401718205, 'psi': 0.9955875869318918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=85 head_norm_before_train=2.094967 cos_to_last_merge=0.9916 (last merge round=43)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.994520747867621, 'loss_val': 0.019171402553105385, 'psi': 0.9957388521441067}-{'f1_val': 0.9965509216617638, 'auprc': 0.9950162279603871, 'loss_val': 0.019241622027356207, 'psi': 0.9959370441812132}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=1.684344 cos_to_last_merge=0.9563 (last merge round=35)
[S13] round=85 local utility u=0.144052 metrics={'f1_val': 0.6254688816951698, 'auprc': 0.786294571569967, 'loss_val': 0.8725312400989648, 'psi': 0.6897991576450887}-{'f1_val': 0.6197893222435498, 'auprc': 0.7668628482361346, 'loss_val': 1.0682632307375006, 'psi': 0.6786187326405837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=85 head_norm_before_train=1.956496 cos_to_last_merge=0.9655 (last merge round=37)
[S14] round=85 local utility u=0.003514 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9986388663341813, 'loss_val': 0.021662467266737654, 'psi': 0.9973946804794485}-{'f1_val': 0.9965603779504312, 'auprc': 0.9969682852238615, 'loss_val': 0.023650083816169825, 'psi': 0.9967235408598033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=85 head_norm_before_train=2.114614 cos_to_last_merge=0.9623 (last merge round=43)
[S15] round=85 local utility u=0.000284 metrics={'f1_val': 0.9971342989135215, 'auprc': 0.9985109241865102, 'loss_val': 0.01753743707580875, 'psi': 0.997684949022717}-{'f1_val': 0.9971773386779533, 'auprc': 0.9984741981176377, 'loss_val': 0.01825393581501274, 'psi': 0.997696082453827}
[S15] not sending this round → trigger blocked (psi=0.998)
[S16] START round=85 head_norm_before_train=1.858631 cos_to_last_merge=0.9855 (last merge round=44)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9466916013539075, 'auprc': 0.9871584971765209, 'loss_val': 0.24162924537887184, 'psi': 0.9628783596829529}-{'f1_val': 0.9898299207609107, 'auprc': 0.9907387445062686, 'loss_val': 0.05429933855651844, 'psi': 0.9901934502590539}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.860517 cos_to_last_merge=0.9692 (last merge round=41)
[S17] round=85 local utility u=0.440068 metrics={'f1_val': 0.8567923509482702, 'auprc': 0.9692959849869709, 'loss_val': 0.5430787244740198, 'psi': 0.9017938045637505}-{'f1_val': 0.7664372386909151, 'auprc': 0.9533245811320253, 'loss_val': 0.8331692668471599, 'psi': 0.8411921756673592}
[S17] not sending this round → trigger blocked (psi=0.902)
[S2] START round=86 head_norm_before_train=2.212698 (no previous merge yet)
[S2] round=86 local utility u=0.002119 metrics={'f1_val': 0.8278678932084138, 'auprc': 0.9401716172899695, 'loss_val': 0.4740664946897605, 'psi': 0.872789382841036}-{'f1_val': 0.8278678932084138, 'auprc': 0.9348933496453583, 'loss_val': 0.46247014818264104, 'psi': 0.8706780757831916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=86 head_norm_before_train=2.243362 cos_to_last_merge=0.9647 (last merge round=43)
[S3] round=86 local utility u=1.000000 metrics={'f1_val': 0.9066228464614379, 'auprc': 0.9952251849635274, 'loss_val': 0.19194829245697545, 'psi': 0.9420637818622737}-{'f1_val': 0.6909945583053114, 'auprc': 0.9584471213684752, 'loss_val': 0.8583903930336844, 'psi': 0.797975583530577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=86 head_norm_before_train=1.807946 cos_to_last_merge=0.9914 (last merge round=44)
[S4] round=86 local utility u=0.040127 metrics={'f1_val': 0.9462521316317768, 'auprc': 0.9742009006111048, 'loss_val': 0.28816384577073173, 'psi': 0.957431639223508}-{'f1_val': 0.9387948771119564, 'auprc': 0.9694336918906477, 'loss_val': 0.3093732308022735, 'psi': 0.9510504030234329}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=86 head_norm_before_train=1.977562 cos_to_last_merge=0.8270 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9919881915808599, 'loss_val': 0.029639710311884473, 'psi': 0.9943312709035477}-{'f1_val': 0.9958933237853395, 'auprc': 0.9943489347913816, 'loss_val': 0.029272325949937547, 'psi': 0.9952755681877563}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.069409 cos_to_last_merge=0.9894 (last merge round=43)
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.6578263258206016, 'auprc': 0.70499150948574, 'loss_val': 1.2425533190448839, 'psi': 0.6766923992866569}-{'f1_val': 0.7442237249774075, 'auprc': 0.9269422851375653, 'loss_val': 0.9252969988108918, 'psi': 0.8173111490414706}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=2.322680 cos_to_last_merge=0.9650 (last merge round=43)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.5370912905052163, 'auprc': 0.8426473847751778, 'loss_val': 1.9325457985140662, 'psi': 0.6593137282132009}-{'f1_val': 0.8502929229171277, 'auprc': 0.978810168470915, 'loss_val': 0.27284764060623534, 'psi': 0.9016998211386426}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.831985 cos_to_last_merge=0.9825 (last merge round=42)
[S8] round=86 local utility u=0.003756 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9990152469284613, 'loss_val': 0.03812533985478939, 'psi': 0.9931323968522471}-{'f1_val': 0.9932883265732785, 'auprc': 0.9875326451233866, 'loss_val': 0.03565662588646699, 'psi': 0.9909860539933217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=86 head_norm_before_train=1.827757 cos_to_last_merge=0.9882 (last merge round=44)
[S9] round=86 local utility u=0.001225 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984847923145932, 'loss_val': 0.019100180687564656, 'psi': 0.9973902240141721}-{'f1_val': 0.9964388212112862, 'auprc': 0.9984959645734418, 'loss_val': 0.02025393901011546, 'psi': 0.9972616785561486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=86 head_norm_before_train=2.142772 cos_to_last_merge=0.9824 (last merge round=45)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969338061339645, 'loss_val': 0.025852323190959352, 'psi': 0.9955721554592356}-{'f1_val': 0.9948838907637279, 'auprc': 0.9967455284039939, 'loss_val': 0.025668485201736688, 'psi': 0.9956285458198343}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.098506 cos_to_last_merge=0.9914 (last merge round=43)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9955893461092336, 'auprc': 0.9953361969246837, 'loss_val': 0.020204478996735598, 'psi': 0.9954880864354136}-{'f1_val': 0.9965509216617638, 'auprc': 0.994520747867621, 'loss_val': 0.019171402553105385, 'psi': 0.9957388521441067}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.688654 cos_to_last_merge=0.9558 (last merge round=35)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6114604171037902, 'auprc': 0.7706684088861568, 'loss_val': 1.1287695631118306, 'psi': 0.6751436138167368}-{'f1_val': 0.6254688816951698, 'auprc': 0.786294571569967, 'loss_val': 0.8725312400989648, 'psi': 0.6897991576450887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.961424 cos_to_last_merge=0.9652 (last merge round=37)
[S14] round=86 local utility u=0.000994 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9985849138247928, 'loss_val': 0.021973841728229394, 'psi': 0.997619265580183}-{'f1_val': 0.9965652232429598, 'auprc': 0.9986388663341813, 'loss_val': 0.021662467266737654, 'psi': 0.9973946804794485}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=86 head_norm_before_train=2.120002 cos_to_last_merge=0.9619 (last merge round=43)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9984469660126848, 'loss_val': 0.018474599353104634, 'psi': 0.9976851896118459}-{'f1_val': 0.9971342989135215, 'auprc': 0.9985109241865102, 'loss_val': 0.01753743707580875, 'psi': 0.997684949022717}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=1.864642 cos_to_last_merge=0.9852 (last merge round=44)
[S16] round=86 local utility u=0.001617 metrics={'f1_val': 0.9466916013539075, 'auprc': 0.9872710465867376, 'loss_val': 0.23873194034149917, 'psi': 0.9629233794470395}-{'f1_val': 0.9466916013539075, 'auprc': 0.9871584971765209, 'loss_val': 0.24162924537887184, 'psi': 0.9628783596829529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=86 head_norm_before_train=1.866236 cos_to_last_merge=0.9687 (last merge round=41)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.6394697187858798, 'auprc': 0.9654670852835658, 'loss_val': 1.3493981863504174, 'psi': 0.7698686653849542}-{'f1_val': 0.8567923509482702, 'auprc': 0.9692959849869709, 'loss_val': 0.5430787244740198, 'psi': 0.9017938045637505}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.218687 (no previous merge yet)
[S2] round=87 local utility u=0.004632 metrics={'f1_val': 0.8294403554022002, 'auprc': 0.9393183510845015, 'loss_val': 0.4716780466544356, 'psi': 0.8733915536751207}-{'f1_val': 0.8278678932084138, 'auprc': 0.9401716172899695, 'loss_val': 0.4740664946897605, 'psi': 0.872789382841036}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=87 head_norm_before_train=2.251552 cos_to_last_merge=0.9642 (last merge round=43)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.7930045655055792, 'auprc': 0.9876470759232565, 'loss_val': 0.4532207274320022, 'psi': 0.87086156967265}-{'f1_val': 0.9066228464614379, 'auprc': 0.9952251849635274, 'loss_val': 0.19194829245697545, 'psi': 0.9420637818622737}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.808720 cos_to_last_merge=0.9912 (last merge round=44)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9406114117833175, 'auprc': 0.9681302277997877, 'loss_val': 0.30415145001038796, 'psi': 0.9516189381899056}-{'f1_val': 0.9462521316317768, 'auprc': 0.9742009006111048, 'loss_val': 0.28816384577073173, 'psi': 0.957431639223508}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.983161 cos_to_last_merge=0.8267 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=87 local utility u=0.000111 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9921679050718999, 'loss_val': 0.029082676555501404, 'psi': 0.9943156716324337}-{'f1_val': 0.9958933237853395, 'auprc': 0.9919881915808599, 'loss_val': 0.029639710311884473, 'psi': 0.9943312709035477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=87 head_norm_before_train=2.073639 cos_to_last_merge=0.9891 (last merge round=43)
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.823579715527028, 'auprc': 0.9353815851541354, 'loss_val': 0.4624958584623839, 'psi': 0.868300463377871}-{'f1_val': 0.6578263258206016, 'auprc': 0.70499150948574, 'loss_val': 1.2425533190448839, 'psi': 0.6766923992866569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=87 head_norm_before_train=2.328942 cos_to_last_merge=0.9648 (last merge round=43)
[S7] round=87 local utility u=1.000000 metrics={'f1_val': 0.7747046069138709, 'auprc': 0.9690736245139004, 'loss_val': 0.9509979137362549, 'psi': 0.8524522139538827}-{'f1_val': 0.5370912905052163, 'auprc': 0.8426473847751778, 'loss_val': 1.9325457985140662, 'psi': 0.6593137282132009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=87 head_norm_before_train=1.838354 cos_to_last_merge=0.9821 (last merge round=42)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9773353396799672, 'auprc': 0.9989761719631407, 'loss_val': 0.05798055129666029, 'psi': 0.9859916725932366}-{'f1_val': 0.9892104968014376, 'auprc': 0.9990152469284613, 'loss_val': 0.03812533985478939, 'psi': 0.9931323968522471}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=1.833856 cos_to_last_merge=0.9879 (last merge round=44)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.995772889201894, 'loss_val': 0.02003962470362123, 'psi': 0.9960592125483242}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984847923145932, 'loss_val': 0.019100180687564656, 'psi': 0.9973902240141721}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.148228 cos_to_last_merge=0.9821 (last merge round=45)
[S10] round=87 local utility u=0.000084 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970870486168266, 'loss_val': 0.026143431395219918, 'psi': 0.9956334524523804}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969338061339645, 'loss_val': 0.025852323190959352, 'psi': 0.9955721554592356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=87 head_norm_before_train=2.103040 cos_to_last_merge=0.9912 (last merge round=43)
[S11] round=87 local utility u=0.003240 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9952553122893951, 'loss_val': 0.019251455535947454, 'psi': 0.9960326779128164}-{'f1_val': 0.9955893461092336, 'auprc': 0.9953361969246837, 'loss_val': 0.020204478996735598, 'psi': 0.9954880864354136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=87 head_norm_before_train=1.691902 cos_to_last_merge=0.9555 (last merge round=35)
[S13] round=87 local utility u=0.109407 metrics={'f1_val': 0.6380216042550775, 'auprc': 0.7834172234088802, 'loss_val': 1.1075684300337787, 'psi': 0.6961798519165986}-{'f1_val': 0.6114604171037902, 'auprc': 0.7706684088861568, 'loss_val': 1.1287695631118306, 'psi': 0.6751436138167368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=87 head_norm_before_train=1.966788 cos_to_last_merge=0.9649 (last merge round=37)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9963486998078612, 'auprc': 0.9986011778222972, 'loss_val': 0.024842569471456428, 'psi': 0.9972496910136356}-{'f1_val': 0.9969755000837764, 'auprc': 0.9985849138247928, 'loss_val': 0.021973841728229394, 'psi': 0.997619265580183}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.125417 cos_to_last_merge=0.9615 (last merge round=43)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9971773386779533, 'auprc': 0.9978758952129038, 'loss_val': 0.021802796869182406, 'psi': 0.9974567612919335}-{'f1_val': 0.9971773386779533, 'auprc': 0.9984469660126848, 'loss_val': 0.018474599353104634, 'psi': 0.9976851896118459}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.870701 cos_to_last_merge=0.9848 (last merge round=44)
[S16] round=87 local utility u=0.231949 metrics={'f1_val': 0.9909250539271397, 'auprc': 0.9907997887746395, 'loss_val': 0.05082111836342847, 'psi': 0.9908749478661396}-{'f1_val': 0.9466916013539075, 'auprc': 0.9872710465867376, 'loss_val': 0.23873194034149917, 'psi': 0.9629233794470395}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=87 head_norm_before_train=1.872479 cos_to_last_merge=0.9682 (last merge round=41)
[S17] round=87 local utility u=0.707487 metrics={'f1_val': 0.7599498662897819, 'auprc': 0.9794918056104691, 'loss_val': 0.6993792532114897, 'psi': 0.8477666420180567}-{'f1_val': 0.6394697187858798, 'auprc': 0.9654670852835658, 'loss_val': 1.3493981863504174, 'psi': 0.7698686653849542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=88 head_norm_before_train=2.223362 (no previous merge yet)
[S2] round=88 local utility u=0.015329 metrics={'f1_val': 0.8294403554022002, 'auprc': 0.9451392427805834, 'loss_val': 0.4584823906870602, 'psi': 0.8757199103535535}-{'f1_val': 0.8294403554022002, 'auprc': 0.9393183510845015, 'loss_val': 0.4716780466544356, 'psi': 0.8733915536751207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=88 head_norm_before_train=2.259808 cos_to_last_merge=0.9637 (last merge round=43)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.7300701134682543, 'auprc': 0.9910131702407383, 'loss_val': 0.6099537734814738, 'psi': 0.834447336177248}-{'f1_val': 0.7930045655055792, 'auprc': 0.9876470759232565, 'loss_val': 0.4532207274320022, 'psi': 0.87086156967265}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.810186 cos_to_last_merge=0.9911 (last merge round=44)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9386499738095309, 'auprc': 0.9668416972516446, 'loss_val': 0.3148960459543664, 'psi': 0.9499266631863764}-{'f1_val': 0.9406114117833175, 'auprc': 0.9681302277997877, 'loss_val': 0.30415145001038796, 'psi': 0.9516189381899056}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.992661 cos_to_last_merge=0.8262 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=88 local utility u=0.006921 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9963567786509098, 'loss_val': 0.028683116731504397, 'psi': 0.9960787057315675}-{'f1_val': 0.9957475160061228, 'auprc': 0.9921679050718999, 'loss_val': 0.029082676555501404, 'psi': 0.9943156716324337}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=88 head_norm_before_train=2.077783 cos_to_last_merge=0.9888 (last merge round=43)
[S6] round=88 local utility u=0.119143 metrics={'f1_val': 0.8403241599417118, 'auprc': 0.9367962072619311, 'loss_val': 0.32892000209949845, 'psi': 0.8789129788697996}-{'f1_val': 0.823579715527028, 'auprc': 0.9353815851541354, 'loss_val': 0.4624958584623839, 'psi': 0.868300463377871}
[S6] not sending this round → trigger blocked (psi=0.879)
[S7] START round=88 head_norm_before_train=2.332056 cos_to_last_merge=0.9646 (last merge round=43)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.7801615654057243, 'auprc': 0.964566395936315, 'loss_val': 0.9788112901729652, 'psi': 0.8539234976179606}-{'f1_val': 0.7747046069138709, 'auprc': 0.9690736245139004, 'loss_val': 0.9509979137362549, 'psi': 0.8524522139538827}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=1.842955 cos_to_last_merge=0.9818 (last merge round=42)
[S8] round=88 local utility u=0.027962 metrics={'f1_val': 0.9849632800667485, 'auprc': 0.999107695686398, 'loss_val': 0.04821886371769218, 'psi': 0.9906210463146083}-{'f1_val': 0.9773353396799672, 'auprc': 0.9989761719631407, 'loss_val': 0.05798055129666029, 'psi': 0.9859916725932366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=88 head_norm_before_train=1.839026 cos_to_last_merge=0.9877 (last merge round=44)
[S9] round=88 local utility u=0.005413 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984975584682065, 'loss_val': 0.01985002552125483, 'psi': 0.9973953304756175}-{'f1_val': 0.9962500947792776, 'auprc': 0.995772889201894, 'loss_val': 0.02003962470362123, 'psi': 0.9960592125483242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=88 head_norm_before_train=2.151394 cos_to_last_merge=0.9818 (last merge round=45)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969314972125655, 'loss_val': 0.025841875805118427, 'psi': 0.995571231890676}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970870486168266, 'loss_val': 0.026143431395219918, 'psi': 0.9956334524523804}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=2.105873 cos_to_last_merge=0.9910 (last merge round=43)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9961224273043288, 'loss_val': 0.020739398939462687, 'psi': 0.9962344216919528}-{'f1_val': 0.9965509216617638, 'auprc': 0.9952553122893951, 'loss_val': 0.019251455535947454, 'psi': 0.9960326779128164}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=1.697859 cos_to_last_merge=0.9548 (last merge round=35)
[S13] round=88 local utility u=0.183017 metrics={'f1_val': 0.6864482674780381, 'auprc': 0.7852046758910143, 'loss_val': 1.037455875443508, 'psi': 0.7259508308432285}-{'f1_val': 0.6380216042550775, 'auprc': 0.7834172234088802, 'loss_val': 1.1075684300337787, 'psi': 0.6961798519165986}
[S13] not sending this round → trigger blocked (psi=0.726)
[S14] START round=88 head_norm_before_train=1.970582 cos_to_last_merge=0.9643 (last merge round=37)
[S14] round=88 local utility u=0.002934 metrics={'f1_val': 0.9969788439352044, 'auprc': 0.9985134782776044, 'loss_val': 0.022492587821189635, 'psi': 0.9975926976721644}-{'f1_val': 0.9963486998078612, 'auprc': 0.9986011778222972, 'loss_val': 0.024842569471456428, 'psi': 0.9972496910136356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=88 head_norm_before_train=2.131090 cos_to_last_merge=0.9610 (last merge round=43)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9930120968442631, 'auprc': 0.9977425010603879, 'loss_val': 0.02679725214696686, 'psi': 0.994904258530713}-{'f1_val': 0.9971773386779533, 'auprc': 0.9978758952129038, 'loss_val': 0.021802796869182406, 'psi': 0.9974567612919335}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.876835 cos_to_last_merge=0.9844 (last merge round=44)
[S16] round=88 local utility u=0.005365 metrics={'f1_val': 0.9910989564342257, 'auprc': 0.9920769693147684, 'loss_val': 0.04496590229327674, 'psi': 0.9914901615864429}-{'f1_val': 0.9909250539271397, 'auprc': 0.9907997887746395, 'loss_val': 0.05082111836342847, 'psi': 0.9908749478661396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=88 head_norm_before_train=1.878849 cos_to_last_merge=0.9677 (last merge round=41)
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.7212107191915599, 'auprc': 0.9755844655106365, 'loss_val': 0.930513737405544, 'psi': 0.8229602177191906}-{'f1_val': 0.7599498662897819, 'auprc': 0.9794918056104691, 'loss_val': 0.6993792532114897, 'psi': 0.8477666420180567}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=2.226716 (no previous merge yet)
[S2] round=89 local utility u=0.007971 metrics={'f1_val': 0.8309946134090265, 'auprc': 0.9455864487221454, 'loss_val': 0.45320725719183586, 'psi': 0.876831347534274}-{'f1_val': 0.8294403554022002, 'auprc': 0.9451392427805834, 'loss_val': 0.4584823906870602, 'psi': 0.8757199103535535}
[S2] not sending this round → trigger blocked (psi=0.877)
[S3] START round=89 head_norm_before_train=2.268880 cos_to_last_merge=0.9631 (last merge round=43)
[S3] round=89 local utility u=0.953611 metrics={'f1_val': 0.9626398299056955, 'auprc': 0.9952615956241992, 'loss_val': 0.11089593346547348, 'psi': 0.9756885361930969}-{'f1_val': 0.7300701134682543, 'auprc': 0.9910131702407383, 'loss_val': 0.6099537734814738, 'psi': 0.834447336177248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=89 head_norm_before_train=1.814481 cos_to_last_merge=0.9911 (last merge round=44)
[S4] round=89 local utility u=0.048159 metrics={'f1_val': 0.9465622213298557, 'auprc': 0.9746642855692268, 'loss_val': 0.28952016275311754, 'psi': 0.957803047025604}-{'f1_val': 0.9386499738095309, 'auprc': 0.9668416972516446, 'loss_val': 0.3148960459543664, 'psi': 0.9499266631863764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=89 head_norm_before_train=1.991331 cos_to_last_merge=0.8261 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9919763828164552, 'loss_val': 0.029136128557840722, 'psi': 0.9943265473977857}-{'f1_val': 0.9958933237853395, 'auprc': 0.9963567786509098, 'loss_val': 0.028683116731504397, 'psi': 0.9960787057315675}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.079906 cos_to_last_merge=0.9881 (last merge round=43)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.5396324637152814, 'auprc': 0.7724962105355778, 'loss_val': 1.7435206538793588, 'psi': 0.6327779624434}-{'f1_val': 0.8403241599417118, 'auprc': 0.9367962072619311, 'loss_val': 0.32892000209949845, 'psi': 0.8789129788697996}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=2.338223 cos_to_last_merge=0.9647 (last merge round=43)
[S7] round=89 local utility u=0.330427 metrics={'f1_val': 0.8172941157787404, 'auprc': 0.9571592266344292, 'loss_val': 0.5185319428319426, 'psi': 0.8732401601210159}-{'f1_val': 0.7801615654057243, 'auprc': 0.964566395936315, 'loss_val': 0.9788112901729652, 'psi': 0.8539234976179606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=89 head_norm_before_train=1.843211 cos_to_last_merge=0.9817 (last merge round=42)
[S8] round=89 local utility u=0.033681 metrics={'f1_val': 0.9936536506497753, 'auprc': 0.9988665153452657, 'loss_val': 0.03227559580911807, 'psi': 0.9957387965279715}-{'f1_val': 0.9849632800667485, 'auprc': 0.999107695686398, 'loss_val': 0.04821886371769218, 'psi': 0.9906210463146083}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=89 head_norm_before_train=1.843286 cos_to_last_merge=0.9876 (last merge round=44)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9984963068885573, 'loss_val': 0.02129478725642596, 'psi': 0.996497826589392}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984975584682065, 'loss_val': 0.01985002552125483, 'psi': 0.9973953304756175}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.154948 cos_to_last_merge=0.9816 (last merge round=45)
[S10] round=89 local utility u=0.000528 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.996784513346286, 'loss_val': 0.025662066358013984, 'psi': 0.9956441397967511}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969314972125655, 'loss_val': 0.025841875805118427, 'psi': 0.995571231890676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=89 head_norm_before_train=2.108703 cos_to_last_merge=0.9908 (last merge round=43)
[S11] round=89 local utility u=0.003804 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.996735024824666, 'loss_val': 0.016420457208273086, 'psi': 0.9966245629269248}-{'f1_val': 0.9963090846170353, 'auprc': 0.9961224273043288, 'loss_val': 0.020739398939462687, 'psi': 0.9962344216919528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=89 head_norm_before_train=1.702258 cos_to_last_merge=0.9543 (last merge round=35)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6411595217255066, 'auprc': 0.7763190703585738, 'loss_val': 1.033661979584393, 'psi': 0.6952233411787335}-{'f1_val': 0.6864482674780381, 'auprc': 0.7852046758910143, 'loss_val': 1.037455875443508, 'psi': 0.7259508308432285}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=1.974261 cos_to_last_merge=0.9639 (last merge round=37)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9967325241656609, 'auprc': 0.9985614042864495, 'loss_val': 0.02369398917454957, 'psi': 0.9974640762139764}-{'f1_val': 0.9969788439352044, 'auprc': 0.9985134782776044, 'loss_val': 0.022492587821189635, 'psi': 0.9975926976721644}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.136765 cos_to_last_merge=0.9605 (last merge round=43)
[S15] round=89 local utility u=0.000000 metrics={'f1_val': 0.986238906308869, 'auprc': 0.9977026359432657, 'loss_val': 0.03124479393612202, 'psi': 0.9908243981626277}-{'f1_val': 0.9930120968442631, 'auprc': 0.9977425010603879, 'loss_val': 0.02679725214696686, 'psi': 0.994904258530713}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=89 head_norm_before_train=1.882159 cos_to_last_merge=0.9842 (last merge round=44)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9907058824816869, 'auprc': 0.9907735064606552, 'loss_val': 0.05165958179800986, 'psi': 0.9907329320732743}-{'f1_val': 0.9910989564342257, 'auprc': 0.9920769693147684, 'loss_val': 0.04496590229327674, 'psi': 0.9914901615864429}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=1.884355 cos_to_last_merge=0.9673 (last merge round=41)
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.6964552503175785, 'auprc': 0.9650803959308227, 'loss_val': 1.0537593129260474, 'psi': 0.8039053085628762}-{'f1_val': 0.7212107191915599, 'auprc': 0.9755844655106365, 'loss_val': 0.930513737405544, 'psi': 0.8229602177191906}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.230811 (no previous merge yet)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.8286597753509614, 'auprc': 0.9453077554814013, 'loss_val': 0.4705490942223303, 'psi': 0.8753189674031374}-{'f1_val': 0.8309946134090265, 'auprc': 0.9455864487221454, 'loss_val': 0.45320725719183586, 'psi': 0.876831347534274}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.277819 cos_to_last_merge=0.9627 (last merge round=43)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9979460013990895, 'loss_val': 0.14755148701068352, 'psi': 0.9756761659423739}-{'f1_val': 0.9626398299056955, 'auprc': 0.9952615956241992, 'loss_val': 0.11089593346547348, 'psi': 0.9756885361930969}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.817096 cos_to_last_merge=0.9911 (last merge round=44)
[S4] round=90 local utility u=0.000000 metrics={'f1_val': 0.9435416498082658, 'auprc': 0.9712924806451522, 'loss_val': 0.29805595892393005, 'psi': 0.9546419821430204}-{'f1_val': 0.9465622213298557, 'auprc': 0.9746642855692268, 'loss_val': 0.28952016275311754, 'psi': 0.957803047025604}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=90 head_norm_before_train=1.995115 cos_to_last_merge=0.8257 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9919451629229217, 'loss_val': 0.02990606461869301, 'psi': 0.9942265747728424}-{'f1_val': 0.9958933237853395, 'auprc': 0.9919763828164552, 'loss_val': 0.029136128557840722, 'psi': 0.9943265473977857}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=2.084440 cos_to_last_merge=0.9876 (last merge round=43)
[S6] round=90 local utility u=0.417429 metrics={'f1_val': 0.6238914809280552, 'auprc': 0.7327145850487164, 'loss_val': 1.2948719274980873, 'psi': 0.6674207225763197}-{'f1_val': 0.5396324637152814, 'auprc': 0.7724962105355778, 'loss_val': 1.7435206538793588, 'psi': 0.6327779624434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=90 head_norm_before_train=2.347432 cos_to_last_merge=0.9642 (last merge round=43)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.7527141792929406, 'auprc': 0.8977347476123458, 'loss_val': 0.7254895525927734, 'psi': 0.8107224066207027}-{'f1_val': 0.8172941157787404, 'auprc': 0.9571592266344292, 'loss_val': 0.5185319428319426, 'psi': 0.8732401601210159}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=1.846904 cos_to_last_merge=0.9815 (last merge round=42)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9887483131798827, 'loss_val': 0.036632888788299955, 'psi': 0.991618907848435}-{'f1_val': 0.9936536506497753, 'auprc': 0.9988665153452657, 'loss_val': 0.03227559580911807, 'psi': 0.9957387965279715}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=90 head_norm_before_train=1.847450 cos_to_last_merge=0.9873 (last merge round=44)
[S9] round=90 local utility u=0.005176 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985014952714854, 'loss_val': 0.019928514611484503, 'psi': 0.997396905196929}-{'f1_val': 0.9951655063899485, 'auprc': 0.9984963068885573, 'loss_val': 0.02129478725642596, 'psi': 0.996497826589392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=90 head_norm_before_train=2.159627 cos_to_last_merge=0.9813 (last merge round=45)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9967821970851842, 'loss_val': 0.02567475261161826, 'psi': 0.9956432132923104}-{'f1_val': 0.9948838907637279, 'auprc': 0.996784513346286, 'loss_val': 0.025662066358013984, 'psi': 0.9956441397967511}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.112396 cos_to_last_merge=0.9907 (last merge round=43)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9964667353825205, 'loss_val': 0.017875592561639113, 'psi': 0.9965172471500665}-{'f1_val': 0.9965509216617638, 'auprc': 0.996735024824666, 'loss_val': 0.016420457208273086, 'psi': 0.9966245629269248}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.705292 cos_to_last_merge=0.9540 (last merge round=35)
[S13] round=90 local utility u=0.192457 metrics={'f1_val': 0.6864418330682598, 'auprc': 0.7855926585340144, 'loss_val': 0.9482634802635258, 'psi': 0.7261021632545617}-{'f1_val': 0.6411595217255066, 'auprc': 0.7763190703585738, 'loss_val': 1.033661979584393, 'psi': 0.6952233411787335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=90 head_norm_before_train=1.976249 cos_to_last_merge=0.9638 (last merge round=37)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9969747287871726, 'loss_val': 0.02216790070350256, 'psi': 0.9968581960191524}-{'f1_val': 0.9967325241656609, 'auprc': 0.9985614042864495, 'loss_val': 0.02369398917454957, 'psi': 0.9974640762139764}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.142384 cos_to_last_merge=0.9601 (last merge round=43)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.983231294992486, 'auprc': 0.9976670388592456, 'loss_val': 0.0364059219800239, 'psi': 0.9890055925391898}-{'f1_val': 0.986238906308869, 'auprc': 0.9977026359432657, 'loss_val': 0.03124479393612202, 'psi': 0.9908243981626277}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.885448 cos_to_last_merge=0.9841 (last merge round=44)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9798090385718939, 'auprc': 0.9905783793187659, 'loss_val': 0.07926836614991412, 'psi': 0.9841167748706428}-{'f1_val': 0.9907058824816869, 'auprc': 0.9907735064606552, 'loss_val': 0.05165958179800986, 'psi': 0.9907329320732743}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=1.890428 cos_to_last_merge=0.9668 (last merge round=41)
[S17] round=90 local utility u=0.212171 metrics={'f1_val': 0.747098924050972, 'auprc': 0.9619905198755984, 'loss_val': 0.924009481459578, 'psi': 0.8330555623808226}-{'f1_val': 0.6964552503175785, 'auprc': 0.9650803959308227, 'loss_val': 1.0537593129260474, 'psi': 0.8039053085628762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=91 head_norm_before_train=2.236738 (no previous merge yet)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.784469335022103, 'auprc': 0.9259509183185903, 'loss_val': 0.49970877638887834, 'psi': 0.8410619683406979}-{'f1_val': 0.8286597753509614, 'auprc': 0.9453077554814013, 'loss_val': 0.4705490942223303, 'psi': 0.8753189674031374}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.286227 cos_to_last_merge=0.9622 (last merge round=43)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.8701909313119454, 'auprc': 0.9915540123927913, 'loss_val': 0.27720106337196426, 'psi': 0.9187361637442837}-{'f1_val': 0.9608296089712303, 'auprc': 0.9979460013990895, 'loss_val': 0.14755148701068352, 'psi': 0.9756761659423739}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.820378 cos_to_last_merge=0.9910 (last merge round=44)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9386682189510459, 'auprc': 0.967669590957246, 'loss_val': 0.311526519710584, 'psi': 0.950268767753526}-{'f1_val': 0.9435416498082658, 'auprc': 0.9712924806451522, 'loss_val': 0.29805595892393005, 'psi': 0.9546419821430204}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.994902 cos_to_last_merge=0.8254 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=91 local utility u=0.004186 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.994098896082275, 'loss_val': 0.028869639860996252, 'psi': 0.9951755527041136}-{'f1_val': 0.9957475160061228, 'auprc': 0.9919451629229217, 'loss_val': 0.02990606461869301, 'psi': 0.9942265747728424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=91 head_norm_before_train=2.092164 cos_to_last_merge=0.9876 (last merge round=43)
[S6] round=91 local utility u=1.000000 metrics={'f1_val': 0.8789855938032791, 'auprc': 0.9120906784826597, 'loss_val': 0.33724930901456057, 'psi': 0.8922276276750314}-{'f1_val': 0.6238914809280552, 'auprc': 0.7327145850487164, 'loss_val': 1.2948719274980873, 'psi': 0.6674207225763197}
[S6] not sending this round → trigger blocked (psi=0.892)
[S7] START round=91 head_norm_before_train=2.355215 cos_to_last_merge=0.9635 (last merge round=43)
[S7] round=91 local utility u=0.047014 metrics={'f1_val': 0.7751979385437948, 'auprc': 0.948151996817102, 'loss_val': 0.9176167935594127, 'psi': 0.8443795618531177}-{'f1_val': 0.7527141792929406, 'auprc': 0.8977347476123458, 'loss_val': 0.7254895525927734, 'psi': 0.8107224066207027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=91 head_norm_before_train=1.852518 cos_to_last_merge=0.9812 (last merge round=42)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9636491923730275, 'auprc': 0.9988776136744681, 'loss_val': 0.10239306298541187, 'psi': 0.9777405608936037}-{'f1_val': 0.9935326376274699, 'auprc': 0.9887483131798827, 'loss_val': 0.036632888788299955, 'psi': 0.991618907848435}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=1.851144 cos_to_last_merge=0.9871 (last merge round=44)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9961732736009085, 'loss_val': 0.019954991337956928, 'psi': 0.99621936630793}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985014952714854, 'loss_val': 0.019928514611484503, 'psi': 0.997396905196929}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.164836 cos_to_last_merge=0.9811 (last merge round=45)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968643264852697, 'loss_val': 0.025787489966705667, 'psi': 0.9955443635997577}-{'f1_val': 0.9948838907637279, 'auprc': 0.9967821970851842, 'loss_val': 0.02567475261161826, 'psi': 0.9956432132923104}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.116636 cos_to_last_merge=0.9905 (last merge round=43)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954791996362842, 'loss_val': 0.018332006692748978, 'psi': 0.996122232851572}-{'f1_val': 0.9965509216617638, 'auprc': 0.9964667353825205, 'loss_val': 0.017875592561639113, 'psi': 0.9965172471500665}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=1.707849 cos_to_last_merge=0.9537 (last merge round=35)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6285430375712704, 'auprc': 0.8012337581824027, 'loss_val': 1.2114561443481608, 'psi': 0.6976193258157233}-{'f1_val': 0.6864418330682598, 'auprc': 0.7855926585340144, 'loss_val': 0.9482634802635258, 'psi': 0.7261021632545617}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.979410 cos_to_last_merge=0.9634 (last merge round=37)
[S14] round=91 local utility u=0.000274 metrics={'f1_val': 0.9967805075071389, 'auprc': 0.9970356032754017, 'loss_val': 0.021802110860117657, 'psi': 0.996882545814444}-{'f1_val': 0.9967805075071389, 'auprc': 0.9969747287871726, 'loss_val': 0.02216790070350256, 'psi': 0.9968581960191524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=91 head_norm_before_train=2.147800 cos_to_last_merge=0.9597 (last merge round=43)
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9735903377014359, 'auprc': 0.997639227832618, 'loss_val': 0.04457851337567079, 'psi': 0.9832098937539087}-{'f1_val': 0.983231294992486, 'auprc': 0.9976670388592456, 'loss_val': 0.0364059219800239, 'psi': 0.9890055925391898}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.889933 cos_to_last_merge=0.9838 (last merge round=44)
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9755009546640976, 'auprc': 0.9906650334612253, 'loss_val': 0.09505967729282232, 'psi': 0.9815665861829486}-{'f1_val': 0.9798090385718939, 'auprc': 0.9905783793187659, 'loss_val': 0.07926836614991412, 'psi': 0.9841167748706428}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=1.896294 cos_to_last_merge=0.9663 (last merge round=41)
[S17] round=91 local utility u=0.606973 metrics={'f1_val': 0.8738491958485726, 'auprc': 0.9790754923882925, 'loss_val': 0.5218191184262102, 'psi': 0.9159397144644605}-{'f1_val': 0.747098924050972, 'auprc': 0.9619905198755984, 'loss_val': 0.924009481459578, 'psi': 0.8330555623808226}
[S17] not sending this round → trigger blocked (psi=0.916)
[S2] START round=92 head_norm_before_train=2.240060 (no previous merge yet)
[S2] round=92 local utility u=0.133689 metrics={'f1_val': 0.8309946134090265, 'auprc': 0.9118036994041367, 'loss_val': 0.4690402142209223, 'psi': 0.8633182478070706}-{'f1_val': 0.784469335022103, 'auprc': 0.9259509183185903, 'loss_val': 0.49970877638887834, 'psi': 0.8410619683406979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=92 head_norm_before_train=2.293027 cos_to_last_merge=0.9617 (last merge round=43)
[S3] round=92 local utility u=0.025727 metrics={'f1_val': 0.8940370476564372, 'auprc': 0.9694590656677355, 'loss_val': 0.3025395932950682, 'psi': 0.9242058548609566}-{'f1_val': 0.8701909313119454, 'auprc': 0.9915540123927913, 'loss_val': 0.27720106337196426, 'psi': 0.9187361637442837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=92 head_norm_before_train=1.825583 cos_to_last_merge=0.9910 (last merge round=44)
[S4] round=92 local utility u=0.000208 metrics={'f1_val': 0.9383144880184019, 'auprc': 0.9687992383071732, 'loss_val': 0.31237782098951067, 'psi': 0.9505083881339105}-{'f1_val': 0.9386682189510459, 'auprc': 0.967669590957246, 'loss_val': 0.311526519710584, 'psi': 0.950268767753526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=92 head_norm_before_train=1.998425 cos_to_last_merge=0.8250 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=92 local utility u=0.005182 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9973099656217977, 'loss_val': 0.02813792261207514, 'psi': 0.9964599805199228}-{'f1_val': 0.9958933237853395, 'auprc': 0.994098896082275, 'loss_val': 0.028869639860996252, 'psi': 0.9951755527041136}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=92 head_norm_before_train=2.099514 cos_to_last_merge=0.9874 (last merge round=43)
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.5898004334918733, 'auprc': 0.683540357467769, 'loss_val': 0.897695383366072, 'psi': 0.6272964030822316}-{'f1_val': 0.8789855938032791, 'auprc': 0.9120906784826597, 'loss_val': 0.33724930901456057, 'psi': 0.8922276276750314}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=2.364247 cos_to_last_merge=0.9636 (last merge round=43)
[S7] round=92 local utility u=0.060491 metrics={'f1_val': 0.7889504821531262, 'auprc': 0.9521988694161231, 'loss_val': 0.8912906103658671, 'psi': 0.854249837058325}-{'f1_val': 0.7751979385437948, 'auprc': 0.948151996817102, 'loss_val': 0.9176167935594127, 'psi': 0.8443795618531177}
[S7] not sending this round → trigger blocked (psi=0.854)
[S8] START round=92 head_norm_before_train=1.858600 cos_to_last_merge=0.9809 (last merge round=42)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.8823917325225625, 'auprc': 0.9988230095200484, 'loss_val': 0.2320758925273989, 'psi': 0.9289642433215569}-{'f1_val': 0.9636491923730275, 'auprc': 0.9988776136744681, 'loss_val': 0.10239306298541187, 'psi': 0.9777405608936037}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=1.856482 cos_to_last_merge=0.9869 (last merge round=44)
[S9] round=92 local utility u=0.004075 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9985015605594986, 'loss_val': 0.019750301182429715, 'psi': 0.9972467356241319}-{'f1_val': 0.9962500947792776, 'auprc': 0.9961732736009085, 'loss_val': 0.019954991337956928, 'psi': 0.99621936630793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=92 head_norm_before_train=2.170243 cos_to_last_merge=0.9808 (last merge round=45)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9969315111793416, 'loss_val': 0.026038014825596815, 'psi': 0.9955712374773865}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968643264852697, 'loss_val': 0.025787489966705667, 'psi': 0.9955443635997577}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.121322 cos_to_last_merge=0.9903 (last merge round=43)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9951997185245868, 'loss_val': 0.018559022918376182, 'psi': 0.996010440406893}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954791996362842, 'loss_val': 0.018332006692748978, 'psi': 0.996122232851572}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=1.712047 cos_to_last_merge=0.9532 (last merge round=35)
[S13] round=92 local utility u=0.386899 metrics={'f1_val': 0.7117669452765193, 'auprc': 0.7913646556704159, 'loss_val': 0.907394755207007, 'psi': 0.7436060294340779}-{'f1_val': 0.6285430375712704, 'auprc': 0.8012337581824027, 'loss_val': 1.2114561443481608, 'psi': 0.6976193258157233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=92 head_norm_before_train=1.982529 cos_to_last_merge=0.9629 (last merge round=37)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.998034176036978, 'loss_val': 0.04354356406977817, 'psi': 0.9975128462134464}-{'f1_val': 0.9967805075071389, 'auprc': 0.9970356032754017, 'loss_val': 0.021802110860117657, 'psi': 0.996882545814444}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.153141 cos_to_last_merge=0.9593 (last merge round=43)
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9726990136742166, 'auprc': 0.9976426837923061, 'loss_val': 0.04691078480724478, 'psi': 0.9826764817214524}-{'f1_val': 0.9735903377014359, 'auprc': 0.997639227832618, 'loss_val': 0.04457851337567079, 'psi': 0.9832098937539087}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=1.894572 cos_to_last_merge=0.9836 (last merge round=44)
[S16] round=92 local utility u=0.012045 metrics={'f1_val': 0.977867611286283, 'auprc': 0.9905480989607053, 'loss_val': 0.08481903688887768, 'psi': 0.9829398063560519}-{'f1_val': 0.9755009546640976, 'auprc': 0.9906650334612253, 'loss_val': 0.09505967729282232, 'psi': 0.9815665861829486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=92 head_norm_before_train=1.901832 cos_to_last_merge=0.9659 (last merge round=41)
[S17] round=92 local utility u=0.172483 metrics={'f1_val': 0.9151635787345819, 'auprc': 0.983955913809051, 'loss_val': 0.43937984614150766, 'psi': 0.9426805127643696}-{'f1_val': 0.8738491958485726, 'auprc': 0.9790754923882925, 'loss_val': 0.5218191184262102, 'psi': 0.9159397144644605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=93 head_norm_before_train=2.244358 (no previous merge yet)
[S2] round=93 local utility u=0.029499 metrics={'f1_val': 0.827876877440384, 'auprc': 0.9402733701194345, 'loss_val': 0.4767450979151997, 'psi': 0.8728354745120042}-{'f1_val': 0.8309946134090265, 'auprc': 0.9118036994041367, 'loss_val': 0.4690402142209223, 'psi': 0.8633182478070706}
[S2] not sending this round → trigger blocked (psi=0.873)
[S3] START round=93 head_norm_before_train=2.299606 cos_to_last_merge=0.9613 (last merge round=43)
[S3] round=93 local utility u=0.474129 metrics={'f1_val': 0.9918257187443944, 'auprc': 0.9989797264939638, 'loss_val': 0.029574889086322404, 'psi': 0.9946873218442223}-{'f1_val': 0.8940370476564372, 'auprc': 0.9694590656677355, 'loss_val': 0.3025395932950682, 'psi': 0.9242058548609566}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=93 head_norm_before_train=1.828585 cos_to_last_merge=0.9908 (last merge round=44)
[S4] round=93 local utility u=0.022020 metrics={'f1_val': 0.9415924777278115, 'auprc': 0.9745834886500999, 'loss_val': 0.3053575838300117, 'psi': 0.954788882096727}-{'f1_val': 0.9383144880184019, 'auprc': 0.9687992383071732, 'loss_val': 0.31237782098951067, 'psi': 0.9505083881339105}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=93 head_norm_before_train=2.010328 cos_to_last_merge=0.8243 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9918688860559022, 'loss_val': 0.028307509160792454, 'psi': 0.9941960640260346}-{'f1_val': 0.9958933237853395, 'auprc': 0.9973099656217977, 'loss_val': 0.02813792261207514, 'psi': 0.9964599805199228}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.102365 cos_to_last_merge=0.9869 (last merge round=43)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.4843879095767808, 'auprc': 0.7153890897199726, 'loss_val': 1.9449142404621316, 'psi': 0.5767883816340575}-{'f1_val': 0.5898004334918733, 'auprc': 0.683540357467769, 'loss_val': 0.897695383366072, 'psi': 0.6272964030822316}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=2.377743 cos_to_last_merge=0.9630 (last merge round=43)
[S7] round=93 local utility u=0.249401 metrics={'f1_val': 0.8412630324877695, 'auprc': 0.9687535450994487, 'loss_val': 0.7560279301904834, 'psi': 0.8922592375324412}-{'f1_val': 0.7889504821531262, 'auprc': 0.9521988694161231, 'loss_val': 0.8912906103658671, 'psi': 0.854249837058325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=93 head_norm_before_train=1.865650 cos_to_last_merge=0.9806 (last merge round=42)
[S8] round=93 local utility u=0.355663 metrics={'f1_val': 0.9730255757029723, 'auprc': 0.9989547202584306, 'loss_val': 0.06494890200396983, 'psi': 0.9833972335251556}-{'f1_val': 0.8823917325225625, 'auprc': 0.9988230095200484, 'loss_val': 0.2320758925273989, 'psi': 0.9289642433215569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=93 head_norm_before_train=1.862204 cos_to_last_merge=0.9866 (last merge round=44)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9984988674614266, 'loss_val': 0.02634694858383162, 'psi': 0.9957454113202422}-{'f1_val': 0.9964101856672208, 'auprc': 0.9985015605594986, 'loss_val': 0.019750301182429715, 'psi': 0.9972467356241319}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.175745 cos_to_last_merge=0.9805 (last merge round=45)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9970022787085047, 'loss_val': 0.026328850173308573, 'psi': 0.9955995444890517}-{'f1_val': 0.9946643883427498, 'auprc': 0.9969315111793416, 'loss_val': 0.026038014825596815, 'psi': 0.9955712374773865}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.126200 cos_to_last_merge=0.9901 (last merge round=43)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9951669723705071, 'loss_val': 0.018789955163807555, 'psi': 0.9959973419452612}-{'f1_val': 0.9965509216617638, 'auprc': 0.9951997185245868, 'loss_val': 0.018559022918376182, 'psi': 0.996010440406893}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=1.715576 cos_to_last_merge=0.9528 (last merge round=35)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.7099672570202256, 'auprc': 0.7910043705880838, 'loss_val': 0.9007364637472578, 'psi': 0.7423821024473689}-{'f1_val': 0.7117669452765193, 'auprc': 0.7913646556704159, 'loss_val': 0.907394755207007, 'psi': 0.7436060294340779}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.985965 cos_to_last_merge=0.9626 (last merge round=37)
[S14] round=93 local utility u=0.010643 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.99865738093156, 'loss_val': 0.021686257102518786, 'psi': 0.997518051856233}-{'f1_val': 0.9971652929977585, 'auprc': 0.998034176036978, 'loss_val': 0.04354356406977817, 'psi': 0.9975128462134464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=93 head_norm_before_train=2.158450 cos_to_last_merge=0.9588 (last merge round=43)
[S15] round=93 local utility u=0.016864 metrics={'f1_val': 0.9771303106900409, 'auprc': 0.9976954851812654, 'loss_val': 0.03992928226376566, 'psi': 0.9853563804865306}-{'f1_val': 0.9726990136742166, 'auprc': 0.9976426837923061, 'loss_val': 0.04691078480724478, 'psi': 0.9826764817214524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=93 head_norm_before_train=1.897150 cos_to_last_merge=0.9835 (last merge round=44)
[S16] round=93 local utility u=0.032467 metrics={'f1_val': 0.9854451047055277, 'auprc': 0.9905039489352204, 'loss_val': 0.06521850716483867, 'psi': 0.9874686423974048}-{'f1_val': 0.977867611286283, 'auprc': 0.9905480989607053, 'loss_val': 0.08481903688887768, 'psi': 0.9829398063560519}
[S16] not sending this round → trigger blocked (psi=0.987)
[S17] START round=93 head_norm_before_train=1.907511 cos_to_last_merge=0.9654 (last merge round=41)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.9086691146904368, 'auprc': 0.9660330257024208, 'loss_val': 0.4743858028134547, 'psi': 0.9316146790952303}-{'f1_val': 0.9151635787345819, 'auprc': 0.983955913809051, 'loss_val': 0.43937984614150766, 'psi': 0.9426805127643696}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.249086 (no previous merge yet)
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.8300175772689471, 'auprc': 0.8209820817836129, 'loss_val': 0.4892169546503725, 'psi': 0.8264033790748133}-{'f1_val': 0.827876877440384, 'auprc': 0.9402733701194345, 'loss_val': 0.4767450979151997, 'psi': 0.8728354745120042}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.306806 cos_to_last_merge=0.9609 (last merge round=43)
[S3] round=94 local utility u=0.019987 metrics={'f1_val': 0.996718896605481, 'auprc': 0.999078198532842, 'loss_val': 0.01925556372870819, 'psi': 0.9976626173764254}-{'f1_val': 0.9918257187443944, 'auprc': 0.9989797264939638, 'loss_val': 0.029574889086322404, 'psi': 0.9946873218442223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=94 head_norm_before_train=1.831662 cos_to_last_merge=0.9906 (last merge round=44)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9402253369788827, 'auprc': 0.972793768427125, 'loss_val': 0.31139326236491005, 'psi': 0.9532527095581795}-{'f1_val': 0.9415924777278115, 'auprc': 0.9745834886500999, 'loss_val': 0.3053575838300117, 'psi': 0.954788882096727}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=2.012181 cos_to_last_merge=0.8238 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=94 local utility u=0.004265 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9943471778413536, 'loss_val': 0.02808725393036114, 'psi': 0.9952748654077451}-{'f1_val': 0.9957475160061228, 'auprc': 0.9918688860559022, 'loss_val': 0.028307509160792454, 'psi': 0.9941960640260346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=94 head_norm_before_train=2.104854 cos_to_last_merge=0.9866 (last merge round=43)
[S6] round=94 local utility u=1.000000 metrics={'f1_val': 0.8037221994133223, 'auprc': 0.9028574647994508, 'loss_val': 0.6241657504518271, 'psi': 0.8433763055677737}-{'f1_val': 0.4843879095767808, 'auprc': 0.7153890897199726, 'loss_val': 1.9449142404621316, 'psi': 0.5767883816340575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=94 head_norm_before_train=2.390439 cos_to_last_merge=0.9622 (last merge round=43)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.8260863993525316, 'auprc': 0.9520197832647957, 'loss_val': 1.0288793165453634, 'psi': 0.8764597529174373}-{'f1_val': 0.8412630324877695, 'auprc': 0.9687535450994487, 'loss_val': 0.7560279301904834, 'psi': 0.8922592375324412}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=1.872292 cos_to_last_merge=0.9802 (last merge round=42)
[S8] round=94 local utility u=0.065999 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9914381478891544, 'loss_val': 0.03344258446851089, 'psi': 0.9926948417321437}-{'f1_val': 0.9730255757029723, 'auprc': 0.9989547202584306, 'loss_val': 0.06494890200396983, 'psi': 0.9833972335251556}
[S8] not sending this round → trigger blocked (psi=0.993)
[S9] START round=94 head_norm_before_train=1.867024 cos_to_last_merge=0.9863 (last merge round=44)
[S9] round=94 local utility u=0.002866 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.993656341706686, 'loss_val': 0.020128578382553886, 'psi': 0.9952125935502409}-{'f1_val': 0.993909773892786, 'auprc': 0.9984988674614266, 'loss_val': 0.02634694858383162, 'psi': 0.9957454113202422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=94 head_norm_before_train=2.177730 cos_to_last_merge=0.9803 (last merge round=45)
[S10] round=94 local utility u=0.000024 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968761553930177, 'loss_val': 0.025902344867597852, 'psi': 0.995549095162857}-{'f1_val': 0.9946643883427498, 'auprc': 0.9970022787085047, 'loss_val': 0.026328850173308573, 'psi': 0.9955995444890517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=94 head_norm_before_train=2.130009 cos_to_last_merge=0.9899 (last merge round=43)
[S11] round=94 local utility u=0.000559 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9953548045264367, 'loss_val': 0.018235665034094198, 'psi': 0.9960724748076331}-{'f1_val': 0.9965509216617638, 'auprc': 0.9951669723705071, 'loss_val': 0.018789955163807555, 'psi': 0.9959973419452612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=94 head_norm_before_train=1.720718 cos_to_last_merge=0.9522 (last merge round=35)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6953841950514503, 'auprc': 0.8063357866991855, 'loss_val': 1.0914908822598521, 'psi': 0.7397648317105443}-{'f1_val': 0.7099672570202256, 'auprc': 0.7910043705880838, 'loss_val': 0.9007364637472578, 'psi': 0.7423821024473689}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=1.988916 cos_to_last_merge=0.9624 (last merge round=37)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9986555443227538, 'loss_val': 0.022631935924786288, 'psi': 0.9975173172127105}-{'f1_val': 0.9967584991393483, 'auprc': 0.99865738093156, 'loss_val': 0.021686257102518786, 'psi': 0.997518051856233}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.163799 cos_to_last_merge=0.9584 (last merge round=43)
[S15] round=94 local utility u=0.016242 metrics={'f1_val': 0.9819337168190745, 'auprc': 0.9977362833406389, 'loss_val': 0.03638826093000591, 'psi': 0.9882547434277003}-{'f1_val': 0.9771303106900409, 'auprc': 0.9976954851812654, 'loss_val': 0.03992928226376566, 'psi': 0.9853563804865306}
[S15] not sending this round → trigger blocked (psi=0.988)
[S16] START round=94 head_norm_before_train=1.901146 cos_to_last_merge=0.9833 (last merge round=44)
[S16] round=94 local utility u=0.021102 metrics={'f1_val': 0.9902677573723261, 'auprc': 0.9907475954766866, 'loss_val': 0.052681628592239835, 'psi': 0.9904596926140703}-{'f1_val': 0.9854451047055277, 'auprc': 0.9905039489352204, 'loss_val': 0.06521850716483867, 'psi': 0.9874686423974048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=94 head_norm_before_train=1.914122 cos_to_last_merge=0.9649 (last merge round=41)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7284053530522185, 'auprc': 0.9481687964933228, 'loss_val': 1.0097104630294773, 'psi': 0.8163107304286602}-{'f1_val': 0.9086691146904368, 'auprc': 0.9660330257024208, 'loss_val': 0.4743858028134547, 'psi': 0.9316146790952303}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=2.251581 (no previous merge yet)
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7929974884394013, 'auprc': 0.79618825909181, 'loss_val': 0.6081197090186282, 'psi': 0.7942737967003648}-{'f1_val': 0.8300175772689471, 'auprc': 0.8209820817836129, 'loss_val': 0.4892169546503725, 'psi': 0.8264033790748133}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.314050 cos_to_last_merge=0.9605 (last merge round=43)
[S3] round=95 local utility u=0.004362 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9993979027772001, 'loss_val': 0.01574008686609257, 'psi': 0.9982154386828146}-{'f1_val': 0.996718896605481, 'auprc': 0.999078198532842, 'loss_val': 0.01925556372870819, 'psi': 0.9976626173764254}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=95 head_norm_before_train=1.836216 cos_to_last_merge=0.9905 (last merge round=44)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9391845621308912, 'auprc': 0.9733061687323817, 'loss_val': 0.31486041483916716, 'psi': 0.9528332047714875}-{'f1_val': 0.9402253369788827, 'auprc': 0.972793768427125, 'loss_val': 0.31139326236491005, 'psi': 0.9532527095581795}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.013546 cos_to_last_merge=0.8236 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9957475160061228, 'auprc': 0.9914316487249203, 'loss_val': 0.028841843616118853, 'psi': 0.9940211690936418}-{'f1_val': 0.9958933237853395, 'auprc': 0.9943471778413536, 'loss_val': 0.02808725393036114, 'psi': 0.9952748654077451}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=2.109323 cos_to_last_merge=0.9866 (last merge round=43)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.6885429824239838, 'auprc': 0.7594836446805437, 'loss_val': 0.6359797075863289, 'psi': 0.7169192473266077}-{'f1_val': 0.8037221994133223, 'auprc': 0.9028574647994508, 'loss_val': 0.6241657504518271, 'psi': 0.8433763055677737}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=2.400523 cos_to_last_merge=0.9621 (last merge round=43)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.758492613975665, 'auprc': 0.939936383159711, 'loss_val': 1.2103732631623736, 'psi': 0.8310701216492834}-{'f1_val': 0.8260863993525316, 'auprc': 0.9520197832647957, 'loss_val': 1.0288793165453634, 'psi': 0.8764597529174373}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=1.875986 cos_to_last_merge=0.9801 (last merge round=42)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9895700826501451, 'auprc': 0.9991580497884512, 'loss_val': 0.03768952341308156, 'psi': 0.9934052695054676}-{'f1_val': 0.9935326376274699, 'auprc': 0.9914381478891544, 'loss_val': 0.03344258446851089, 'psi': 0.9926948417321437}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=1.871915 cos_to_last_merge=0.9861 (last merge round=44)
[S9] round=95 local utility u=0.008654 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985003202874825, 'loss_val': 0.019814963580579423, 'psi': 0.9973964352033279}-{'f1_val': 0.9962500947792776, 'auprc': 0.993656341706686, 'loss_val': 0.020128578382553886, 'psi': 0.9952125935502409}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=95 head_norm_before_train=2.181447 cos_to_last_merge=0.9801 (last merge round=45)
[S10] round=95 local utility u=0.000018 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968492152725917, 'loss_val': 0.025785914744141845, 'psi': 0.9955383191146865}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968761553930177, 'loss_val': 0.025902344867597852, 'psi': 0.995549095162857}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=95 head_norm_before_train=2.132757 cos_to_last_merge=0.9897 (last merge round=43)
[S11] round=95 local utility u=0.002248 metrics={'f1_val': 0.9967926336575387, 'auprc': 0.9957114427095445, 'loss_val': 0.016259126787181055, 'psi': 0.996360157278341}-{'f1_val': 0.9965509216617638, 'auprc': 0.9953548045264367, 'loss_val': 0.018235665034094198, 'psi': 0.9960724748076331}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=95 head_norm_before_train=1.726832 cos_to_last_merge=0.9514 (last merge round=35)
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6540125259091157, 'auprc': 0.7859914420445432, 'loss_val': 0.9971613682201714, 'psi': 0.7068040923632868}-{'f1_val': 0.6953841950514503, 'auprc': 0.8063357866991855, 'loss_val': 1.0914908822598521, 'psi': 0.7397648317105443}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=1.992107 cos_to_last_merge=0.9622 (last merge round=37)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.996345017535854, 'auprc': 0.9985565450064695, 'loss_val': 0.022914977357875066, 'psi': 0.9972296285241002}-{'f1_val': 0.9967584991393483, 'auprc': 0.9986555443227538, 'loss_val': 0.022631935924786288, 'psi': 0.9975173172127105}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.169093 cos_to_last_merge=0.9580 (last merge round=43)
[S15] round=95 local utility u=0.015719 metrics={'f1_val': 0.986238906308869, 'auprc': 0.9977954386748795, 'loss_val': 0.030959693014439127, 'psi': 0.9908615192552732}-{'f1_val': 0.9819337168190745, 'auprc': 0.9977362833406389, 'loss_val': 0.03638826093000591, 'psi': 0.9882547434277003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=95 head_norm_before_train=1.905927 cos_to_last_merge=0.9830 (last merge round=44)
[S16] round=95 local utility u=0.005142 metrics={'f1_val': 0.9911442983426363, 'auprc': 0.9909024856026958, 'loss_val': 0.04812110510067105, 'psi': 0.9910475732466602}-{'f1_val': 0.9902677573723261, 'auprc': 0.9907475954766866, 'loss_val': 0.052681628592239835, 'psi': 0.9904596926140703}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=95 head_norm_before_train=1.920492 cos_to_last_merge=0.9644 (last merge round=41)
[S17] round=95 local utility u=0.341927 metrics={'f1_val': 0.7951413077223738, 'auprc': 0.9466179650880558, 'loss_val': 0.7216187006913309, 'psi': 0.8557319706686466}-{'f1_val': 0.7284053530522185, 'auprc': 0.9481687964933228, 'loss_val': 1.0097104630294773, 'psi': 0.8163107304286602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=96 head_norm_before_train=2.256196 (no previous merge yet)
[S2] round=96 local utility u=0.390139 metrics={'f1_val': 0.8294311833764522, 'auprc': 0.938621317576261, 'loss_val': 0.473742119113676, 'psi': 0.8731072370563757}-{'f1_val': 0.7929974884394013, 'auprc': 0.79618825909181, 'loss_val': 0.6081197090186282, 'psi': 0.7942737967003648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=96 head_norm_before_train=2.316712 cos_to_last_merge=0.9607 (last merge round=43)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.7349061525503049, 'auprc': 0.9674912624820841, 'loss_val': 0.6292135629777057, 'psi': 0.8279401965230166}-{'f1_val': 0.9974271292865575, 'auprc': 0.9993979027772001, 'loss_val': 0.01574008686609257, 'psi': 0.9982154386828146}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.842036 cos_to_last_merge=0.9903 (last merge round=44)
[S4] round=96 local utility u=0.023601 metrics={'f1_val': 0.9431733474697275, 'auprc': 0.9766560517643625, 'loss_val': 0.3016409993669253, 'psi': 0.9565664291875815}-{'f1_val': 0.9391845621308912, 'auprc': 0.9733061687323817, 'loss_val': 0.31486041483916716, 'psi': 0.9528332047714875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=96 head_norm_before_train=2.021001 cos_to_last_merge=0.8232 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=96 local utility u=0.001557 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9922865029869343, 'loss_val': 0.029167090833254472, 'psi': 0.9944505954659774}-{'f1_val': 0.9957475160061228, 'auprc': 0.9914316487249203, 'loss_val': 0.028841843616118853, 'psi': 0.9940211690936418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=96 head_norm_before_train=2.113827 cos_to_last_merge=0.9866 (last merge round=43)
[S6] round=96 local utility u=0.383744 metrics={'f1_val': 0.7849849329355414, 'auprc': 0.889095769917154, 'loss_val': 0.8359797129252816, 'psi': 0.8266292677281865}-{'f1_val': 0.6885429824239838, 'auprc': 0.7594836446805437, 'loss_val': 0.6359797075863289, 'psi': 0.7169192473266077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=96 head_norm_before_train=2.414209 cos_to_last_merge=0.9612 (last merge round=43)
[S7] round=96 local utility u=0.593427 metrics={'f1_val': 0.8287584883504844, 'auprc': 0.9630533572901305, 'loss_val': 0.5144661458886042, 'psi': 0.8824764359263428}-{'f1_val': 0.758492613975665, 'auprc': 0.939936383159711, 'loss_val': 1.2103732631623736, 'psi': 0.8310701216492834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=96 head_norm_before_train=1.880854 cos_to_last_merge=0.9798 (last merge round=42)
[S8] round=96 local utility u=0.008690 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.995804120821054, 'loss_val': 0.033979080255651925, 'psi': 0.9944368133750323}-{'f1_val': 0.9895700826501451, 'auprc': 0.9991580497884512, 'loss_val': 0.03768952341308156, 'psi': 0.9934052695054676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=96 head_norm_before_train=1.877513 cos_to_last_merge=0.9858 (last merge round=44)
[S9] round=96 local utility u=0.000096 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9985070611317043, 'loss_val': 0.0196431733184784, 'psi': 0.9973991315410166}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985003202874825, 'loss_val': 0.019814963580579423, 'psi': 0.9973964352033279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=96 head_norm_before_train=2.184582 cos_to_last_merge=0.9799 (last merge round=45)
[S10] round=96 local utility u=0.000006 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968557749568131, 'loss_val': 0.02579326801728205, 'psi': 0.995540942988375}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968492152725917, 'loss_val': 0.025785914744141845, 'psi': 0.9955383191146865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=96 head_norm_before_train=2.136516 cos_to_last_merge=0.9895 (last merge round=43)
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9954220896308179, 'loss_val': 0.018205285475991498, 'psi': 0.9960993888493855}-{'f1_val': 0.9967926336575387, 'auprc': 0.9957114427095445, 'loss_val': 0.016259126787181055, 'psi': 0.996360157278341}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=1.733446 cos_to_last_merge=0.9506 (last merge round=35)
[S13] round=96 local utility u=0.004004 metrics={'f1_val': 0.6607158073571847, 'auprc': 0.8024001770190261, 'loss_val': 1.0785994629256537, 'psi': 0.7173895552219213}-{'f1_val': 0.6540125259091157, 'auprc': 0.7859914420445432, 'loss_val': 0.9971613682201714, 'psi': 0.7068040923632868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=96 head_norm_before_train=1.994954 cos_to_last_merge=0.9619 (last merge round=37)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9965536345053762, 'auprc': 0.9963497430682771, 'loss_val': 0.028933086826893634, 'psi': 0.9964720779305365}-{'f1_val': 0.996345017535854, 'auprc': 0.9985565450064695, 'loss_val': 0.022914977357875066, 'psi': 0.9972296285241002}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.174275 cos_to_last_merge=0.9576 (last merge round=43)
[S15] round=96 local utility u=0.005716 metrics={'f1_val': 0.9879451967824178, 'auprc': 0.9978134799478542, 'loss_val': 0.02981947248717933, 'psi': 0.9918925100485922}-{'f1_val': 0.986238906308869, 'auprc': 0.9977954386748795, 'loss_val': 0.030959693014439127, 'psi': 0.9908615192552732}
[S15] not sending this round → trigger blocked (psi=0.992)
[S16] START round=96 head_norm_before_train=1.910552 cos_to_last_merge=0.9828 (last merge round=44)
[S16] round=96 local utility u=0.000169 metrics={'f1_val': 0.9909290503567701, 'auprc': 0.9908511033609275, 'loss_val': 0.04633712554622658, 'psi': 0.9908978715584331}-{'f1_val': 0.9911442983426363, 'auprc': 0.9909024856026958, 'loss_val': 0.04812110510067105, 'psi': 0.9910475732466602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=96 head_norm_before_train=1.926945 cos_to_last_merge=0.9639 (last merge round=41)
[S17] round=96 local utility u=0.292182 metrics={'f1_val': 0.8599483820878664, 'auprc': 0.9620733837977956, 'loss_val': 0.5724626527639339, 'psi': 0.9007983827718381}-{'f1_val': 0.7951413077223738, 'auprc': 0.9466179650880558, 'loss_val': 0.7216187006913309, 'psi': 0.8557319706686466}
[S17] not sending this round → trigger blocked (psi=0.901)
[S2] START round=97 head_norm_before_train=2.259455 (no previous merge yet)
[S2] round=97 local utility u=0.032801 metrics={'f1_val': 0.8286597753509614, 'auprc': 0.9570603338649294, 'loss_val': 0.4588295281008608, 'psi': 0.8800199987565486}-{'f1_val': 0.8294311833764522, 'auprc': 0.938621317576261, 'loss_val': 0.473742119113676, 'psi': 0.8731072370563757}
[S2] not sending this round → trigger blocked (psi=0.880)
[S3] START round=97 head_norm_before_train=2.316258 cos_to_last_merge=0.9609 (last merge round=43)
[S3] round=97 local utility u=0.194312 metrics={'f1_val': 0.7816457929353511, 'auprc': 0.9793461979595576, 'loss_val': 0.5565927020476713, 'psi': 0.8607259549450337}-{'f1_val': 0.7349061525503049, 'auprc': 0.9674912624820841, 'loss_val': 0.6292135629777057, 'psi': 0.8279401965230166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=97 head_norm_before_train=1.848222 cos_to_last_merge=0.9901 (last merge round=44)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.942768903058554, 'auprc': 0.9765739426057457, 'loss_val': 0.3037683237820373, 'psi': 0.9562909188774307}-{'f1_val': 0.9431733474697275, 'auprc': 0.9766560517643625, 'loss_val': 0.3016409993669253, 'psi': 0.9565664291875815}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.016202 cos_to_last_merge=0.8230 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=97 local utility u=0.002603 metrics={'f1_val': 0.9958933237853395, 'auprc': 0.9943105569919887, 'loss_val': 0.030032899255735962, 'psi': 0.9952602170679992}-{'f1_val': 0.9958933237853395, 'auprc': 0.9922865029869343, 'loss_val': 0.029167090833254472, 'psi': 0.9944505954659774}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=97 head_norm_before_train=2.116124 cos_to_last_merge=0.9866 (last merge round=43)
[S6] round=97 local utility u=0.245610 metrics={'f1_val': 0.8144481137722427, 'auprc': 0.9241751979187827, 'loss_val': 0.6267764363815203, 'psi': 0.8583389474308587}-{'f1_val': 0.7849849329355414, 'auprc': 0.889095769917154, 'loss_val': 0.8359797129252816, 'psi': 0.8266292677281865}
[S6] not sending this round → trigger blocked (psi=0.858)
[S7] START round=97 head_norm_before_train=2.424667 cos_to_last_merge=0.9607 (last merge round=43)
[S7] round=97 local utility u=0.000000 metrics={'f1_val': 0.7279616510746058, 'auprc': 0.9458542541884798, 'loss_val': 1.3879123855647015, 'psi': 0.8151186923201554}-{'f1_val': 0.8287584883504844, 'auprc': 0.9630533572901305, 'loss_val': 0.5144661458886042, 'psi': 0.8824764359263428}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=97 head_norm_before_train=1.882797 cos_to_last_merge=0.9797 (last merge round=42)
[S8] round=97 local utility u=0.002366 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9990546630332682, 'loss_val': 0.03479702682772325, 'psi': 0.9953168625609186}-{'f1_val': 0.9935252750776847, 'auprc': 0.995804120821054, 'loss_val': 0.033979080255651925, 'psi': 0.9944368133750323}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=97 head_norm_before_train=1.880584 cos_to_last_merge=0.9856 (last merge round=44)
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9956327735179132, 'loss_val': 0.020048017751159834, 'psi': 0.9960031662747318}-{'f1_val': 0.9966605118138915, 'auprc': 0.9985070611317043, 'loss_val': 0.0196431733184784, 'psi': 0.9973991315410166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.186792 cos_to_last_merge=0.9797 (last merge round=45)
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968629522910366, 'loss_val': 0.025829499002316448, 'psi': 0.9955438139220645}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968557749568131, 'loss_val': 0.02579326801728205, 'psi': 0.995540942988375}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.140476 cos_to_last_merge=0.9894 (last merge round=43)
[S11] round=97 local utility u=0.001249 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9959620605471695, 'loss_val': 0.017327458284874003, 'psi': 0.9963153772159261}-{'f1_val': 0.9965509216617638, 'auprc': 0.9954220896308179, 'loss_val': 0.018205285475991498, 'psi': 0.9960993888493855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=97 head_norm_before_train=1.739078 cos_to_last_merge=0.9499 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.950
[S13] round=97 local utility u=0.135637 metrics={'f1_val': 0.6900164256287913, 'auprc': 0.8211907634524943, 'loss_val': 1.039501612070036, 'psi': 0.7424861607582725}-{'f1_val': 0.6607158073571847, 'auprc': 0.8024001770190261, 'loss_val': 1.0785994629256537, 'psi': 0.7173895552219213}
[S13] not sending this round → trigger blocked (psi=0.742)
[S14] START round=97 head_norm_before_train=1.997925 cos_to_last_merge=0.9617 (last merge round=37)
[S14] round=97 local utility u=0.004182 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.996417918026008, 'loss_val': 0.02431095064205218, 'psi': 0.9968531386482827}-{'f1_val': 0.9965536345053762, 'auprc': 0.9963497430682771, 'loss_val': 0.028933086826893634, 'psi': 0.9964720779305365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=97 head_norm_before_train=2.179327 cos_to_last_merge=0.9572 (last merge round=43)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9858109440017494, 'auprc': 0.9978071361287962, 'loss_val': 0.03155206309150199, 'psi': 0.9906094208525681}-{'f1_val': 0.9879451967824178, 'auprc': 0.9978134799478542, 'loss_val': 0.02981947248717933, 'psi': 0.9918925100485922}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=1.914809 cos_to_last_merge=0.9827 (last merge round=44)
[S16] round=97 local utility u=0.001374 metrics={'f1_val': 0.9911484415604795, 'auprc': 0.9910106753978062, 'loss_val': 0.04538326051531686, 'psi': 0.9910933350954102}-{'f1_val': 0.9909290503567701, 'auprc': 0.9908511033609275, 'loss_val': 0.04633712554622658, 'psi': 0.9908978715584331}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=97 head_norm_before_train=1.934045 cos_to_last_merge=0.9633 (last merge round=41)
[S17] round=97 local utility u=0.153793 metrics={'f1_val': 0.9046980469951891, 'auprc': 0.9542071628831617, 'loss_val': 0.5097761513707721, 'psi': 0.9245016933503781}-{'f1_val': 0.8599483820878664, 'auprc': 0.9620733837977956, 'loss_val': 0.5724626527639339, 'psi': 0.9007983827718381}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=98 head_norm_before_train=2.262714 (no previous merge yet)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.8270916486870554, 'auprc': 0.9122634507945309, 'loss_val': 0.44483993148815665, 'psi': 0.8611603695300456}-{'f1_val': 0.8286597753509614, 'auprc': 0.9570603338649294, 'loss_val': 0.4588295281008608, 'psi': 0.8800199987565486}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.321837 cos_to_last_merge=0.9607 (last merge round=43)
[S3] round=98 local utility u=0.531494 metrics={'f1_val': 0.9085989426494433, 'auprc': 0.9812590861708372, 'loss_val': 0.26106174808756843, 'psi': 0.9376630000580009}-{'f1_val': 0.7816457929353511, 'auprc': 0.9793461979595576, 'loss_val': 0.5565927020476713, 'psi': 0.8607259549450337}
[S3] not sending this round → trigger blocked (psi=0.938)
[S4] START round=98 head_norm_before_train=1.853384 cos_to_last_merge=0.9899 (last merge round=44)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9410154674985427, 'auprc': 0.9690236272988298, 'loss_val': 0.3119928669056734, 'psi': 0.9522187314186576}-{'f1_val': 0.942768903058554, 'auprc': 0.9765739426057457, 'loss_val': 0.3037683237820373, 'psi': 0.9562909188774307}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.012850 cos_to_last_merge=0.8234 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9912019662943986, 'loss_val': 0.029819591244600423, 'psi': 0.9941049160565918}-{'f1_val': 0.9958933237853395, 'auprc': 0.9943105569919887, 'loss_val': 0.030032899255735962, 'psi': 0.9952602170679992}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.119359 cos_to_last_merge=0.9865 (last merge round=43)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.8011467154993592, 'auprc': 0.9328943358658285, 'loss_val': 0.749707605486267, 'psi': 0.8538457636459469}-{'f1_val': 0.8144481137722427, 'auprc': 0.9241751979187827, 'loss_val': 0.6267764363815203, 'psi': 0.8583389474308587}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=2.434101 cos_to_last_merge=0.9604 (last merge round=43)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.5494735682583901, 'auprc': 0.8167363145824228, 'loss_val': 2.18449557069896, 'psi': 0.6563786667880032}-{'f1_val': 0.7279616510746058, 'auprc': 0.9458542541884798, 'loss_val': 1.3879123855647015, 'psi': 0.8151186923201554}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=1.886247 cos_to_last_merge=0.9795 (last merge round=42)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9564524854410816, 'auprc': 0.9988551792869707, 'loss_val': 0.12636537930128433, 'psi': 0.9734135629794373}-{'f1_val': 0.9928249955793521, 'auprc': 0.9990546630332682, 'loss_val': 0.03479702682772325, 'psi': 0.9953168625609186}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=1.885623 cos_to_last_merge=0.9854 (last merge round=44)
[S9] round=98 local utility u=0.006140 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998504607519101, 'loss_val': 0.018845111685461453, 'psi': 0.9973981500959752}-{'f1_val': 0.9962500947792776, 'auprc': 0.9956327735179132, 'loss_val': 0.020048017751159834, 'psi': 0.9960031662747318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=98 head_norm_before_train=2.190532 cos_to_last_merge=0.9795 (last merge round=45)
[S10] round=98 local utility u=0.000002 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968453114754636, 'loss_val': 0.025772723234612115, 'psi': 0.9955367575958354}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968629522910366, 'loss_val': 0.025829499002316448, 'psi': 0.9955438139220645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=98 head_norm_before_train=2.144547 cos_to_last_merge=0.9892 (last merge round=43)
[S11] round=98 local utility u=0.000248 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9961427112271497, 'loss_val': 0.017372730882612188, 'psi': 0.9963876374879183}-{'f1_val': 0.9965509216617638, 'auprc': 0.9959620605471695, 'loss_val': 0.017327458284874003, 'psi': 0.9963153772159261}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=98 head_norm_before_train=1.745386 cos_to_last_merge=0.9492 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=98 local utility u=0.003245 metrics={'f1_val': 0.6943995576547856, 'auprc': 0.8145182050563471, 'loss_val': 1.0392917904473746, 'psi': 0.7424470166154102}-{'f1_val': 0.6900164256287913, 'auprc': 0.8211907634524943, 'loss_val': 1.039501612070036, 'psi': 0.7424861607582725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=98 head_norm_before_train=2.002121 cos_to_last_merge=0.9613 (last merge round=37)
[S14] round=98 local utility u=0.000189 metrics={'f1_val': 0.9963486998078612, 'auprc': 0.9986034455634778, 'loss_val': 0.025721279238812268, 'psi': 0.9972505981101079}-{'f1_val': 0.9971432857297993, 'auprc': 0.996417918026008, 'loss_val': 0.02431095064205218, 'psi': 0.9968531386482827}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=98 head_norm_before_train=2.184318 cos_to_last_merge=0.9568 (last merge round=43)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.9819337168190745, 'auprc': 0.9977737929288003, 'loss_val': 0.036369369515430634, 'psi': 0.9882697472629649}-{'f1_val': 0.9858109440017494, 'auprc': 0.9978071361287962, 'loss_val': 0.03155206309150199, 'psi': 0.9906094208525681}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=1.918071 cos_to_last_merge=0.9825 (last merge round=44)
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.9911484415604795, 'auprc': 0.9910162019760944, 'loss_val': 0.045480184901947544, 'psi': 0.9910955457267254}-{'f1_val': 0.9911484415604795, 'auprc': 0.9910106753978062, 'loss_val': 0.04538326051531686, 'psi': 0.9910933350954102}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=1.939125 cos_to_last_merge=0.9629 (last merge round=41)
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.7118854380196298, 'auprc': 0.952540842905844, 'loss_val': 1.012383046215411, 'psi': 0.8081475999741154}-{'f1_val': 0.9046980469951891, 'auprc': 0.9542071628831617, 'loss_val': 0.5097761513707721, 'psi': 0.9245016933503781}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.265365 (no previous merge yet)
[S2] round=99 local utility u=0.004991 metrics={'f1_val': 0.8270916486870554, 'auprc': 0.9159697799513365, 'loss_val': 0.4459764949251115, 'psi': 0.8626429011927679}-{'f1_val': 0.8270916486870554, 'auprc': 0.9122634507945309, 'loss_val': 0.44483993148815665, 'psi': 0.8611603695300456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] r=100 psi=0.863 u=0.0050 p_local=0.0592 f1=0.827 auprc=0.916 bytes=73796
[S3] START round=99 head_norm_before_train=2.329475 cos_to_last_merge=0.9604 (last merge round=43)
[S3] round=99 local utility u=0.175984 metrics={'f1_val': 0.953370135498955, 'auprc': 0.9848472067099441, 'loss_val': 0.1884856472947521, 'psi': 0.9659609639833506}-{'f1_val': 0.9085989426494433, 'auprc': 0.9812590861708372, 'loss_val': 0.26106174808756843, 'psi': 0.9376630000580009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=100 psi=0.966 u=0.1760 p_local=0.2130 f1=0.953 auprc=0.985 bytes=70161
[S4] START round=99 head_norm_before_train=1.856543 cos_to_last_merge=0.9898 (last merge round=44)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9409324402405275, 'auprc': 0.9658253841869902, 'loss_val': 0.31374474644255884, 'psi': 0.9508896178191125}-{'f1_val': 0.9410154674985427, 'auprc': 0.9690236272988298, 'loss_val': 0.3119928669056734, 'psi': 0.9522187314186576}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.951 u=0.0000 p_local=0.0055 f1=0.941 auprc=0.966 bytes=64814
[S5] START round=99 head_norm_before_train=2.014017 cos_to_last_merge=0.8235 (last merge round=2)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9882392274751979, 'loss_val': 0.03485105695485605, 'psi': 0.9929198205289116}-{'f1_val': 0.9960402158980539, 'auprc': 0.9912019662943986, 'loss_val': 0.029819591244600423, 'psi': 0.9941049160565918}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.993 u=0.0000 p_local=0.0014 f1=0.996 auprc=0.988 bytes=68387
[S6] START round=99 head_norm_before_train=2.123117 cos_to_last_merge=0.9865 (last merge round=43)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.6670041731515501, 'auprc': 0.7630090057727932, 'loss_val': 0.5907963437912258, 'psi': 0.7054061062000474}-{'f1_val': 0.8011467154993592, 'auprc': 0.9328943358658285, 'loss_val': 0.749707605486267, 'psi': 0.8538457636459469}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.705 u=0.0000 p_local=0.2083 f1=0.667 auprc=0.763 bytes=68392
[S7] START round=99 head_norm_before_train=2.443706 cos_to_last_merge=0.9598 (last merge round=43)
[S7] round=99 local utility u=1.000000 metrics={'f1_val': 0.75788681155132, 'auprc': 0.9144186149634796, 'loss_val': 1.081605297876444, 'psi': 0.8204995329161839}-{'f1_val': 0.5494735682583901, 'auprc': 0.8167363145824228, 'loss_val': 2.18449557069896, 'psi': 0.6563786667880032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S7] r=100 psi=0.820 u=1.0000 p_local=0.3129 f1=0.758 auprc=0.914 bytes=68355
[S8] START round=99 head_norm_before_train=1.890017 cos_to_last_merge=0.9793 (last merge round=42)
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.7961979270717253, 'auprc': 0.9982388470810268, 'loss_val': 0.5755263026841466, 'psi': 0.8770142950754459}-{'f1_val': 0.9564524854410816, 'auprc': 0.9988551792869707, 'loss_val': 0.12636537930128433, 'psi': 0.9734135629794373}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.877 u=0.0000 p_local=0.0273 f1=0.796 auprc=0.998 bytes=75588
[S9] START round=99 head_norm_before_train=1.890287 cos_to_last_merge=0.9852 (last merge round=44)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9928582333961574, 'loss_val': 0.019019536039863717, 'psi': 0.9951587881173203}-{'f1_val': 0.9966605118138915, 'auprc': 0.998504607519101, 'loss_val': 0.018845111685461453, 'psi': 0.9973981500959752}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.995 u=0.0000 p_local=0.0024 f1=0.997 auprc=0.993 bytes=80937
[S10] START round=99 head_norm_before_train=2.195075 cos_to_last_merge=0.9792 (last merge round=45)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9968448137175396, 'loss_val': 0.025826348365031816, 'psi': 0.9955365584926656}-{'f1_val': 0.9946643883427498, 'auprc': 0.9968453114754636, 'loss_val': 0.025772723234612115, 'psi': 0.9955367575958354}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0000 f1=0.995 auprc=0.997 bytes=77340
[S11] START round=99 head_norm_before_train=2.147029 cos_to_last_merge=0.9890 (last merge round=43)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9950101749280243, 'loss_val': 0.020407478599861122, 'psi': 0.9957895207414309}-{'f1_val': 0.9965509216617638, 'auprc': 0.9961427112271497, 'loss_val': 0.017372730882612188, 'psi': 0.9963876374879183}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.996 u=0.0000 p_local=0.0006 f1=0.996 auprc=0.995 bytes=70117
[S13] START round=99 head_norm_before_train=1.750787 cos_to_last_merge=0.9486 (last merge round=35)
[S13] ⚠️ Model drifted since last merge! cos=0.949
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6621614327436802, 'auprc': 0.832763134067717, 'loss_val': 1.1745544210121557, 'psi': 0.730402113273295}-{'f1_val': 0.6943995576547856, 'auprc': 0.8145182050563471, 'loss_val': 1.0392917904473746, 'psi': 0.7424470166154102}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.730 u=0.0000 p_local=0.0490 f1=0.662 auprc=0.833 bytes=75569
[S14] START round=99 head_norm_before_train=2.005088 cos_to_last_merge=0.9609 (last merge round=37)
[S14] round=99 local utility u=0.002674 metrics={'f1_val': 0.9967584991393483, 'auprc': 0.9986446935995371, 'loss_val': 0.022955893585551647, 'psi': 0.9975129769234239}-{'f1_val': 0.9963486998078612, 'auprc': 0.9986034455634778, 'loss_val': 0.025721279238812268, 'psi': 0.9972505981101079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S14] r=100 psi=0.998 u=0.0027 p_local=0.0018 f1=0.997 auprc=0.999 bytes=84616
[S15] START round=99 head_norm_before_train=2.189198 cos_to_last_merge=0.9564 (last merge round=43)
[S15] round=99 local utility u=0.003088 metrics={'f1_val': 0.9827993495351066, 'auprc': 0.997792132370906, 'loss_val': 0.03544121667072157, 'psi': 0.9887964626694263}-{'f1_val': 0.9819337168190745, 'auprc': 0.9977737929288003, 'loss_val': 0.036369369515430634, 'psi': 0.9882697472629649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] r=100 psi=0.989 u=0.0031 p_local=0.0057 f1=0.983 auprc=0.998 bytes=66546
[S16] START round=99 head_norm_before_train=1.922095 cos_to_last_merge=0.9822 (last merge round=44)
[S16] round=99 local utility u=0.001108 metrics={'f1_val': 0.9911484415604795, 'auprc': 0.9916931597332368, 'loss_val': 0.04529559983951702, 'psi': 0.9913663288295824}-{'f1_val': 0.9911484415604795, 'auprc': 0.9910162019760944, 'loss_val': 0.045480184901947544, 'psi': 0.9910955457267254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=100 psi=0.991 u=0.0011 p_local=0.0079 f1=0.991 auprc=0.992 bytes=75603
[S17] START round=99 head_norm_before_train=1.943450 cos_to_last_merge=0.9625 (last merge round=41)
[S17] round=99 local utility u=0.884475 metrics={'f1_val': 0.9125322845090293, 'auprc': 0.9721761618786106, 'loss_val': 0.5062193684001208, 'psi': 0.9363898354568618}-{'f1_val': 0.7118854380196298, 'auprc': 0.952540842905844, 'loss_val': 1.012383046215411, 'psi': 0.8081475999741154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=100 psi=0.936 u=0.8845 p_local=0.3098 f1=0.913 auprc=0.972 bytes=77414
[runner] rounds complete.
[runner] all agents stopped.
