[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39803
[S3] → join 127.0.0.1:39802
[S4] → join 127.0.0.1:39802
[S5] → join 127.0.0.1:39802
[S6] → join 127.0.0.1:39802
[S7] → join 127.0.0.1:39802
[S8] → join 127.0.0.1:39802
[S9] → join 127.0.0.1:39802
[S10] → join 127.0.0.1:39802
[S11] → join 127.0.0.1:39802
[S13] → join 127.0.0.1:39802
[S14] → join 127.0.0.1:39802
[S15] → join 127.0.0.1:39802
[S16] → join 127.0.0.1:39802
[S17] → join 127.0.0.1:39802
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.114141 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.184365 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.168404 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.129289 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.184024 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.176997 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.245668 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.165138 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.134449 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.135635 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.165513 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.204462 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.191381 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.178881 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.144085 (no previous merge yet)
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S3] + discovered S7
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S4
[S3] + discovered S8
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S13
[S3] + discovered S15
[S3] + discovered S17
[S3] + discovered S14
[S4] + discovered S3
[S4] + discovered S2
[S3] + discovered S5
[S3] + discovered S16
[S4] + discovered S6
[S4] + discovered S16
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S11
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S9
[S5] + discovered S4
[S5] + discovered S3
[S5] + discovered S2
[S6] + discovered S2
[S6] + discovered S5
[S6] + discovered S4
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S15
[S5] + discovered S13
[S5] + discovered S14
[S5] + discovered S6
[S7] + discovered S3
[S7] + discovered S6
[S7] + discovered S4
[S7] + discovered S2
[S7] + discovered S5
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S10
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S8
[S8] + discovered S7
[S8] + discovered S6
[S8] + discovered S4
[S8] + discovered S2
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S11
[S7] + discovered S17
[S7] + discovered S10
[S7] + discovered S8
[S7] + discovered S16
[S7] + discovered S9
[S7] + discovered S15
[S7] + discovered S13
[S7] + discovered S14
[S8] + discovered S15
[S8] + discovered S10
[S9] + discovered S5
[S9] + discovered S2
[S9] + discovered S6
[S9] + discovered S7
[S9] + discovered S3
[S9] + discovered S8
[S8] + discovered S16
[S9] + discovered S4
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S9
[S8] + discovered S17
[S8] + discovered S14
[S10] + discovered S2
[S10] + discovered S8
[S10] + discovered S7
[S10] + discovered S6
[S10] + discovered S5
[S9] + discovered S16
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S14
[S10] + discovered S4
[S10] + discovered S9
[S10] + discovered S3
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S17
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S6
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S9
[S10] + discovered S17
[S10] + discovered S16
[S10] + discovered S14
[S10] + discovered S11
[S10] + discovered S15
[S10] + discovered S13
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S2
[S13] + discovered S10
[S13] + discovered S2
[S13] + discovered S8
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S6
[S13] + discovered S11
[S13] + discovered S5
[S13] + discovered S9
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S13
[S11] + discovered S17
[S11] + discovered S16
[S13] + discovered S3
[S14] + discovered S3
[S14] + discovered S13
[S14] + discovered S2
[S14] + discovered S8
[S14] + discovered S7
[S14] + discovered S9
[S14] + discovered S5
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S10
[S14] + discovered S4
[S13] + discovered S14
[S13] + discovered S17
[S13] + discovered S16
[S13] + discovered S15
[S14] + discovered S15
[S14] + discovered S16
[S15] + discovered S10
[S15] + discovered S6
[S15] + discovered S5
[S15] + discovered S7
[S15] + discovered S2
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S8
[S15] + discovered S3
[S14] + discovered S17
[S16] + discovered S13
[S16] + discovered S10
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S4
[S16] + discovered S3
[S16] + discovered S9
[S16] + discovered S11
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S5
[S16] + discovered S2
[S17] + discovered S5
[S17] + discovered S3
[S17] + discovered S10
[S17] + discovered S2
[S17] + discovered S8
[S17] + discovered S7
[S17] + discovered S11
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S6
[S17] + discovered S13
[S17] + discovered S14
[S17] + discovered S9
[S16] + discovered S17
[S17] + discovered S15
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:39802
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39805
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:39811
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:39813
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:39808
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:39803
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:39807
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:39809
[S2] START round=1 head_norm_before_train=1.115946 (no previous merge yet)
[S2] round=1 local utility u=0.089527 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6553235814161148, 'loss_val': 1.2748826349141287, 'psi': 0.347195712599586}-{'f1_val': 0.14180650507561632, 'auprc': 0.6173209229107678, 'loss_val': 1.3401054584408887, 'psi': 0.33201227220967694}
[S3] START round=1 head_norm_before_train=1.189876 (no previous merge yet)
[S3] round=1 local utility u=0.232077 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7928139725488512, 'loss_val': 1.3209059682158466, 'psi': 0.4010296283880047}-{'f1_val': 0.13984006561410703, 'auprc': 0.6469518354936239, 'loss_val': 1.3474737014509415, 'psi': 0.34268477356591376}
[S4] START round=1 head_norm_before_train=1.187258 (no previous merge yet)
[S4] round=1 local utility u=0.057365 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7801571405168714, 'loss_val': 1.2515717632322518, 'psi': 0.39619883354385904}-{'f1_val': 0.14022662889518414, 'auprc': 0.764615070317787, 'loss_val': 1.319674632736118, 'psi': 0.3899820054642253}
[S5] START round=1 head_norm_before_train=1.132376 (no previous merge yet)
[S5] round=1 local utility u=0.260698 metrics={'f1_val': 0.4157320228882436, 'auprc': 0.7715540461944294, 'loss_val': 1.3127360094006493, 'psi': 0.5580608322107179}-{'f1_val': 0.41718547513587745, 'auprc': 0.6078670875271978, 'loss_val': 1.3517910301254599, 'psi': 0.49345812009240553}
[S6] START round=1 head_norm_before_train=1.192400 (no previous merge yet)
[S6] round=1 local utility u=0.307653 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7992497858791994, 'loss_val': 1.2643653538562636, 'psi': 0.404555683582449}-{'f1_val': 0.14142628205128205, 'auprc': 0.6144650645554418, 'loss_val': 1.3253169058486334, 'psi': 0.33064179505294594}
[S7] START round=1 head_norm_before_train=1.179468 (no previous merge yet)
[S7] round=1 local utility u=0.176526 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7943735276840018, 'loss_val': 1.32721726585934, 'psi': 0.40298350471105576}-{'f1_val': 0.08845180584311019, 'auprc': 0.7943890907819087, 'loss_val': 1.3586859572101146, 'psi': 0.3708267198186296}
[S8] START round=1 head_norm_before_train=1.259031 (no previous merge yet)
[S8] round=1 local utility u=0.163263 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660487789551875, 'loss_val': 1.2592515532090955, 'psi': 0.39039310101784935}-{'f1_val': 0.13995598239295717, 'auprc': 0.6849573050423678, 'loss_val': 1.3425029606787884, 'psi': 0.35795651145272145}
[S9] START round=1 head_norm_before_train=1.169364 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.1633810098182102, 'auprc': 0.778493789247968, 'loss_val': 1.3128622305203521, 'psi': 0.4094261215901133}-{'f1_val': 0.329690293967311, 'auprc': 0.7540161633539684, 'loss_val': 1.3520222963776687, 'psi': 0.499420641721974}
[S10] START round=1 head_norm_before_train=1.154037 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.605251839188834, 'loss_val': 1.2737810605317432, 'psi': 0.32527371820056794}-{'f1_val': 0.13862163754172394, 'auprc': 0.7705898959779087, 'loss_val': 1.3420892023762925, 'psi': 0.3914089409161979}
[S11] START round=1 head_norm_before_train=1.143534 (no previous merge yet)
[S11] round=1 local utility u=0.429822 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8824444292749637, 'loss_val': 1.3338003215898413, 'psi': 0.43722598173385185}-{'f1_val': 0.054460325283390836, 'auprc': 0.7809079416221194, 'loss_val': 1.373113952028471, 'psi': 0.3450393718188823}
[S13] START round=1 head_norm_before_train=1.175164 (no previous merge yet)
[S13] round=1 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.574908020575063, 'loss_val': 1.2826312724469668, 'psi': 0.31419466577625704}-{'f1_val': 0.1403857625770531, 'auprc': 0.5973536976385305, 'loss_val': 1.3383087944884189, 'psi': 0.3231729366016441}
[S14] START round=1 head_norm_before_train=1.210271 (no previous merge yet)
[S14] round=1 local utility u=0.083484 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5614408584119623, 'loss_val': 1.3397036795848993, 'psi': 0.3087910550944072}-{'f1_val': 0.14035785288270378, 'auprc': 0.5142613315376158, 'loss_val': 1.365133097092965, 'psi': 0.2899192443446686}
[S15] START round=1 head_norm_before_train=1.205408 (no previous merge yet)
[S15] round=1 local utility u=0.033008 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.769488436479353, 'loss_val': 1.278155696099425, 'psi': 0.3916355654086762}-{'f1_val': 0.13973365136155833, 'auprc': 0.7634673702004144, 'loss_val': 1.3261092650646085, 'psi': 0.3892271388971008}
[S16] START round=1 head_norm_before_train=1.177676 (no previous merge yet)
[S16] round=1 local utility u=0.600067 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.820106626544849, 'loss_val': 1.3485934822347456, 'psi': 0.4124251207374615}-{'f1_val': 0.09148550724637682, 'auprc': 0.5312875312692621, 'loss_val': 1.3873580732976074, 'psi': 0.26740631685553096}
[S17] START round=1 head_norm_before_train=1.155063 (no previous merge yet)
[S17] round=1 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6094565362044154, 'loss_val': 1.2779563444888822, 'psi': 0.3283519924721968}-{'f1_val': 0.14094896331738438, 'auprc': 0.7494805528867443, 'loss_val': 1.3240116082464028, 'psi': 0.38436159914512835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S6] → sending delta(kind=head bytes=1788) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:39816
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S11] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:39817
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39807
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39816
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39805
[S3] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1788 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S15
[S16] cosine check vs S15: cos=0.0748
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=0.0473
[S6] RECEIVED delta(kind=head bytes=1793) from S8
[S6] cosine check vs S8: cos=-0.0871
[S6] DROPPED delta from S8 (cos=-0.0871 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1792) from S7
[S11] cosine check vs S7: cos=-0.0135
[S11] DROPPED delta from S7 (cos=-0.0135 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.0280
[S14] RECEIVED delta(kind=head bytes=1785) from S16
[S14] cosine check vs S16: cos=0.0209
[S17] RECEIVED delta(kind=head bytes=1789) from S11
[S17] cosine check vs S11: cos=-0.0608
[S17] DROPPED delta from S11 (cos=-0.0608 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1790) from S2
[S10] cosine check vs S2: cos=-0.0247
[S10] DROPPED delta from S2 (cos=-0.0247 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1788) from S6
[S11] cosine check vs S6: cos=-0.0137
[S11] DROPPED delta from S6 (cos=-0.0137 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S3
[S5] cosine check vs S3: cos=-0.0764
[S5] DROPPED delta from S3 (cos=-0.0764 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S14
[S8] cosine check vs S14: cos=0.0804
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.198062
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.396859e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.880367 delta_norm=0.839686
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.188853
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.029065e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1406 head_norm=0.753683 delta_norm=0.702906
[S16] aggregate: ACCEPT kept=['S15', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.293172
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.544225e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.926043 delta_norm=0.854423
[S8] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=1 metric=0.1404 head_norm=1.225926
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.448905e-01
[S14] stored merged vector for next round verification (round=1)
[S14] DEBUG after merge:  round=1 metric=0.3637 head_norm=0.862724 delta_norm=0.844891
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.144080 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6205545949454934, 'loss_val': 1.200310789878775, 'psi': 0.3332881180113374}-{'f1_val': 0.1417771333885667, 'auprc': 0.6553235814161148, 'loss_val': 1.2748826349141287, 'psi': 0.347195712599586}
[S3] START round=2 head_norm_before_train=1.201166 (no previous merge yet)
[S3] round=2 local utility u=0.323412 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9982728344093377, 'loss_val': 1.2904587408582058, 'psi': 0.48321317313219936}-{'f1_val': 0.13984006561410703, 'auprc': 0.7928139725488512, 'loss_val': 1.3209059682158466, 'psi': 0.4010296283880047}
[S4] START round=2 head_norm_before_train=1.234861 (no previous merge yet)
[S4] round=2 local utility u=0.069177 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7827956003096368, 'loss_val': 1.1211339901209796, 'psi': 0.39725421746096523}-{'f1_val': 0.14022662889518414, 'auprc': 0.7801571405168714, 'loss_val': 1.2515717632322518, 'psi': 0.39619883354385904}
[S5] START round=2 head_norm_before_train=1.147550 (no previous merge yet)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7760463164937764, 'loss_val': 1.2633476457775314, 'psi': 0.3957756694546534}-{'f1_val': 0.4157320228882436, 'auprc': 0.7715540461944294, 'loss_val': 1.3127360094006493, 'psi': 0.5580608322107179}
[S6] START round=2 head_norm_before_train=1.229189 (no previous merge yet)
[S6] round=2 local utility u=0.025239 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7891501661460149, 'loss_val': 1.183587935075409, 'psi': 0.40051583568917515}-{'f1_val': 0.14142628205128205, 'auprc': 0.7992497858791994, 'loss_val': 1.2643653538562636, 'psi': 0.404555683582449}
[S7] START round=2 head_norm_before_train=1.187442 (no previous merge yet)
[S7] round=2 local utility u=0.016047 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7945765967462773, 'loss_val': 1.2957329898915815, 'psi': 0.40306473233596596}-{'f1_val': 0.14205682272909165, 'auprc': 0.7943735276840018, 'loss_val': 1.32721726585934, 'psi': 0.40298350471105576}
[S8] START round=2 head_norm_before_train=0.926043 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.027721 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7658330531916742, 'loss_val': 1.203162203215946, 'psi': 0.390306810712444}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660487789551875, 'loss_val': 1.2592515532090955, 'psi': 0.39039310101784935}
[S9] START round=2 head_norm_before_train=1.186132 (no previous merge yet)
[S9] round=2 local utility u=0.246620 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9730380474111585, 'loss_val': 1.2713575564549044, 'psi': 0.47405399324846104}-{'f1_val': 0.1633810098182102, 'auprc': 0.778493789247968, 'loss_val': 1.3128622305203521, 'psi': 0.4094261215901133}
[S10] START round=2 head_norm_before_train=0.880367 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.060960 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6293643606619989, 'loss_val': 1.2241991055216919, 'psi': 0.3349187267898339}-{'f1_val': 0.13862163754172394, 'auprc': 0.605251839188834, 'loss_val': 1.2737810605317432, 'psi': 0.32527371820056794}
[S11] START round=2 head_norm_before_train=1.163422 (no previous merge yet)
[S11] round=2 local utility u=0.194230 metrics={'f1_val': 0.1437360157892026, 'auprc': 0.9884131069989339, 'loss_val': 1.2831801319805611, 'psi': 0.48160685227309513}-{'f1_val': 0.14041368337311058, 'auprc': 0.8824444292749637, 'loss_val': 1.3338003215898413, 'psi': 0.43722598173385185}
[S13] START round=2 head_norm_before_train=1.212033 (no previous merge yet)
[S13] round=2 local utility u=0.268360 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7268072874929199, 'loss_val': 1.201609768616942, 'psi': 0.3749543725433998}-{'f1_val': 0.1403857625770531, 'auprc': 0.574908020575063, 'loss_val': 1.2826312724469668, 'psi': 0.31419466577625704}
[S14] START round=2 head_norm_before_train=0.862724 cos_to_last_merge=1.0000 (last merge round=1)
[S14] round=2 local utility u=1.000000 metrics={'f1_val': 0.3845262344912311, 'auprc': 0.8113011192644528, 'loss_val': 1.3529573506453598, 'psi': 0.5552361884005198}-{'f1_val': 0.14035785288270378, 'auprc': 0.5614408584119623, 'loss_val': 1.3397036795848993, 'psi': 0.3087910550944072}
[S15] START round=2 head_norm_before_train=1.235443 (no previous merge yet)
[S15] round=2 local utility u=0.033386 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766417218434708, 'loss_val': 1.232843075663734, 'psi': 0.39449687955432333}-{'f1_val': 0.13973365136155833, 'auprc': 0.769488436479353, 'loss_val': 1.278155696099425, 'psi': 0.3916355654086762}
[S16] START round=2 head_norm_before_train=0.753683 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.083732 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8706490277136063, 'loss_val': 1.3327559881433002, 'psi': 0.4326420812049645}-{'f1_val': 0.14063745019920318, 'auprc': 0.820106626544849, 'loss_val': 1.3485934822347456, 'psi': 0.4124251207374615}
[S17] START round=2 head_norm_before_train=1.188256 (no previous merge yet)
[S17] round=2 local utility u=0.055791 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6147221068007478, 'loss_val': 1.1821712340652766, 'psi': 0.3304582207107297}-{'f1_val': 0.14094896331738438, 'auprc': 0.6094565362044154, 'loss_val': 1.2779563444888822, 'psi': 0.3283519924721968}
[S15] not sending this round → trigger blocked (psi=0.394)
[S16] not sending this round → trigger blocked (psi=0.433)
[S6] not sending this round → trigger blocked (psi=0.401)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39817
[S14] not sending this round → trigger blocked (psi=0.555)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.397)
[S7] not sending this round → trigger blocked (psi=0.403)
[S11] not sending this round → trigger blocked (psi=0.482)
[S8] not sending this round → trigger blocked (psi=0.390)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S3] not sending this round → trigger blocked (psi=0.483)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39805
[S13] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=0.1217
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.0337
[S17] RECEIVED delta(kind=head bytes=1792) from S9
[S17] cosine check vs S9: cos=0.0941
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:39813
[S17] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1797) from S17
[S13] cosine check vs S17: cos=0.1030
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=2 metric=0.1423 head_norm=1.173291
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.007427e-01
[S5] stored merged vector for next round verification (round=2)
[S5] DEBUG after merge:  round=2 metric=0.1423 head_norm=0.789165 delta_norm=0.700743
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=1.205951
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.576700e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.887058 delta_norm=0.857670
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.261198
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.365633e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.927638 delta_norm=0.836563
[S13] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.236964
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.229475e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.904342 delta_norm=0.822948
[S17] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.186583 (no previous merge yet)
[S2] round=3 local utility u=0.763695 metrics={'f1_val': 0.329883518230332, 'auprc': 0.71043620307472, 'loss_val': 1.071204641804537, 'psi': 0.4821045921680872}-{'f1_val': 0.1417771333885667, 'auprc': 0.6205545949454934, 'loss_val': 1.200310789878775, 'psi': 0.3332881180113374}
[S3] START round=3 head_norm_before_train=1.218688 (no previous merge yet)
[S3] round=3 local utility u=0.019120 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9975190184659993, 'loss_val': 1.2499580845877196, 'psi': 0.482911646754864}-{'f1_val': 0.13984006561410703, 'auprc': 0.9982728344093377, 'loss_val': 1.2904587408582058, 'psi': 0.48321317313219936}
[S4] START round=3 head_norm_before_train=1.306547 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6877107087570291, 'auprc': 0.7858321333731932, 'loss_val': 0.8308893973546293, 'psi': 0.7269592786034947}-{'f1_val': 0.14022662889518414, 'auprc': 0.7827956003096368, 'loss_val': 1.1211339901209796, 'psi': 0.39725421746096523}
[S5] START round=3 head_norm_before_train=0.789165 cos_to_last_merge=1.0000 (last merge round=2)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7457240355825699, 'loss_val': 1.2557875470278812, 'psi': 0.3836467570901708}-{'f1_val': 0.14226190476190476, 'auprc': 0.7760463164937764, 'loss_val': 1.2633476457775314, 'psi': 0.3957756694546534}
[S6] START round=3 head_norm_before_train=1.277333 (no previous merge yet)
[S6] round=3 local utility u=0.561501 metrics={'f1_val': 0.3825166606775342, 'auprc': 0.6295653468671908, 'loss_val': 1.0283743994272128, 'psi': 0.4813361351533968}-{'f1_val': 0.14142628205128205, 'auprc': 0.7891501661460149, 'loss_val': 1.183587935075409, 'psi': 0.40051583568917515}
[S7] START round=3 head_norm_before_train=0.887058 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7927015344527752, 'loss_val': 1.3002042005002412, 'psi': 0.4023147074185651}-{'f1_val': 0.14205682272909165, 'auprc': 0.7945765967462773, 'loss_val': 1.2957329898915815, 'psi': 0.40306473233596596}
[S8] START round=3 head_norm_before_train=0.970261 cos_to_last_merge=0.9948 (last merge round=1)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.5746836825828614, 'auprc': 0.7768220908326999, 'loss_val': 1.0461334552173027, 'psi': 0.6555390458827968}-{'f1_val': 0.13995598239295717, 'auprc': 0.7658330531916742, 'loss_val': 1.203162203215946, 'psi': 0.390306810712444}
[S9] START round=3 head_norm_before_train=1.208336 (no previous merge yet)
[S9] round=3 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8918406470372097, 'loss_val': 1.2126817951727218, 'psi': 0.4415750330988815}-{'f1_val': 0.141397957139996, 'auprc': 0.9730380474111585, 'loss_val': 1.2713575564549044, 'psi': 0.47405399324846104}
[S10] START round=3 head_norm_before_train=0.922513 cos_to_last_merge=0.9924 (last merge round=1)
[S10] round=3 local utility u=0.897863 metrics={'f1_val': 0.38618957521687847, 'auprc': 0.6522076538529376, 'loss_val': 0.9824103755107357, 'psi': 0.4925968066713021}-{'f1_val': 0.13862163754172394, 'auprc': 0.6293643606619989, 'loss_val': 1.2241991055216919, 'psi': 0.3349187267898339}
[S11] START round=3 head_norm_before_train=1.193657 (no previous merge yet)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8800333000582176, 'loss_val': 1.2006696882855536, 'psi': 0.4362615300471534}-{'f1_val': 0.1437360157892026, 'auprc': 0.9884131069989339, 'loss_val': 1.2831801319805611, 'psi': 0.48160685227309513}
[S13] START round=3 head_norm_before_train=0.927638 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.680216 metrics={'f1_val': 0.3986614932782816, 'auprc': 0.6444042065940092, 'loss_val': 1.1436222095312578, 'psi': 0.4969585786045726}-{'f1_val': 0.1403857625770531, 'auprc': 0.7268072874929199, 'loss_val': 1.201609768616942, 'psi': 0.3749543725433998}
[S14] START round=3 head_norm_before_train=0.878088 cos_to_last_merge=0.9970 (last merge round=1)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8131915451239319, 'loss_val': 1.3224979848034575, 'psi': 0.409491329779195}-{'f1_val': 0.3845262344912311, 'auprc': 0.8113011192644528, 'loss_val': 1.3529573506453598, 'psi': 0.5552361884005198}
[S15] START round=3 head_norm_before_train=1.265018 (no previous merge yet)
[S15] round=3 local utility u=0.068940 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.793331337033859, 'loss_val': 1.1450310430750088, 'psi': 0.4011727256304786}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766417218434708, 'loss_val': 1.232843075663734, 'psi': 0.39449687955432333}
[S16] START round=3 head_norm_before_train=0.771599 cos_to_last_merge=0.9956 (last merge round=1)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8429544209616417, 'loss_val': 1.2885681364684523, 'psi': 0.4215642385041787}-{'f1_val': 0.14063745019920318, 'auprc': 0.8706490277136063, 'loss_val': 1.3327559881433002, 'psi': 0.4326420812049645}
[S17] START round=3 head_norm_before_train=0.904342 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=1.000000 metrics={'f1_val': 0.5967400011747924, 'auprc': 0.6646255255497143, 'loss_val': 1.023334160266136, 'psi': 0.6238942109247612}-{'f1_val': 0.14094896331738438, 'auprc': 0.6147221068007478, 'loss_val': 1.1821712340652766, 'psi': 0.3304582207107297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39807
[S2] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=-0.0211
[S7] DROPPED delta from S6 (cos=-0.0211 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=-0.0651
[S6] DROPPED delta from S2 (cos=-0.0651 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.0606
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=-0.0539
[S14] DROPPED delta from S4 (cos=-0.0539 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S8
[S5] cosine check vs S8: cos=-0.0590
[S5] DROPPED delta from S8 (cos=-0.0590 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.0938
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] cosine check vs S13: cos=0.0486
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.6448
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=-0.1411
[S8] DROPPED delta from S17 (cos=-0.1411 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.819370
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.881996e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.819891 delta_norm=0.388200
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.903031
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.965325e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1270 head_norm=0.667091 delta_norm=0.596533
[S14] aggregate: ROLLBACK (f1_val pre=0.140 post=0.127 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=3 metric=0.3862 head_norm=0.987155
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.748973e-01
[S10] stored merged vector for next round verification (round=3)
[S10] DEBUG after merge:  round=3 metric=0.3908 head_norm=0.708562 delta_norm=0.674897
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.233929 (no previous merge yet)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.7137638154464938, 'auprc': 0.7811309457497266, 'loss_val': 0.8028736031984283, 'psi': 0.740710667567787}-{'f1_val': 0.329883518230332, 'auprc': 0.71043620307472, 'loss_val': 1.071204641804537, 'psi': 0.4821045921680872}
[S3] START round=4 head_norm_before_train=1.242354 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8701124795077084, 'loss_val': 1.1843052925757291, 'psi': 0.4319490311715476}-{'f1_val': 0.13984006561410703, 'auprc': 0.9975190184659993, 'loss_val': 1.2499580845877196, 'psi': 0.482911646754864}
[S4] START round=4 head_norm_before_train=1.385981 (no previous merge yet)
[S4] round=4 local utility u=0.000000 metrics={'f1_val': 0.6735363181451606, 'auprc': 0.6594837228770717, 'loss_val': 0.5061639670450052, 'psi': 0.667915280037925}-{'f1_val': 0.6877107087570291, 'auprc': 0.7858321333731932, 'loss_val': 0.8308893973546293, 'psi': 0.7269592786034947}
[S5] START round=4 head_norm_before_train=0.819891 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.004953 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7418212706972608, 'loss_val': 1.2341730930354695, 'psi': 0.3820856511360472}-{'f1_val': 0.14226190476190476, 'auprc': 0.7457240355825699, 'loss_val': 1.2557875470278812, 'psi': 0.3836467570901708}
[S6] START round=4 head_norm_before_train=1.335421 (no previous merge yet)
[S6] round=4 local utility u=1.000000 metrics={'f1_val': 0.6233118555947306, 'auprc': 0.8342448915102859, 'loss_val': 0.698705885907691, 'psi': 0.7076850699609527}-{'f1_val': 0.3825166606775342, 'auprc': 0.6295653468671908, 'loss_val': 1.0283743994272128, 'psi': 0.4813361351533968}
[S7] START round=4 head_norm_before_train=0.909853 cos_to_last_merge=0.9974 (last merge round=2)
[S7] round=4 local utility u=0.014297 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7928421521220526, 'loss_val': 1.2720313939113148, 'psi': 0.402370954486276}-{'f1_val': 0.14205682272909165, 'auprc': 0.7927015344527752, 'loss_val': 1.3002042005002412, 'psi': 0.4023147074185651}
[S8] START round=4 head_norm_before_train=1.017171 cos_to_last_merge=0.9848 (last merge round=1)
[S8] round=4 local utility u=0.516469 metrics={'f1_val': 0.7150337453891538, 'auprc': 0.7769382140704023, 'loss_val': 0.8556437588425757, 'psi': 0.7397955328616532}-{'f1_val': 0.5746836825828614, 'auprc': 0.7768220908326999, 'loss_val': 1.0461334552173027, 'psi': 0.6555390458827968}
[S9] START round=4 head_norm_before_train=1.240077 (no previous merge yet)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7065941409431694, 'loss_val': 1.1579318818820907, 'psi': 0.3674764306612654}-{'f1_val': 0.141397957139996, 'auprc': 0.8918406470372097, 'loss_val': 1.2126817951727218, 'psi': 0.4415750330988815}
[S10] START round=4 head_norm_before_train=0.708562 cos_to_last_merge=1.0000 (last merge round=3)
[S10] round=4 local utility u=0.000000 metrics={'f1_val': 0.38677178805060364, 'auprc': 0.6090860788145259, 'loss_val': 0.901738704086088, 'psi': 0.47569750435617253}-{'f1_val': 0.38618957521687847, 'auprc': 0.6522076538529376, 'loss_val': 0.9824103755107357, 'psi': 0.4925968066713021}
[S11] START round=4 head_norm_before_train=1.236501 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.614735952586474, 'loss_val': 1.1101095458657262, 'psi': 0.33014259105845595}-{'f1_val': 0.14041368337311058, 'auprc': 0.8800333000582176, 'loss_val': 1.2006696882855536, 'psi': 0.4362615300471534}
[S13] START round=4 head_norm_before_train=0.969855 cos_to_last_merge=0.9957 (last merge round=2)
[S13] round=4 local utility u=0.160857 metrics={'f1_val': 0.4160038662657951, 'auprc': 0.663862165533645, 'loss_val': 0.9843354448967963, 'psi': 0.5151471859729351}-{'f1_val': 0.3986614932782816, 'auprc': 0.6444042065940092, 'loss_val': 1.1436222095312578, 'psi': 0.4969585786045726}
[S14] START round=4 head_norm_before_train=0.667091 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.790702 metrics={'f1_val': 0.39639674314244955, 'auprc': 0.8279702909315881, 'loss_val': 1.3216642770055747, 'psi': 0.569026162258105}-{'f1_val': 0.14035785288270378, 'auprc': 0.8131915451239319, 'loss_val': 1.3224979848034575, 'psi': 0.409491329779195}
[S15] START round=4 head_norm_before_train=1.302752 (no previous merge yet)
[S15] round=4 local utility u=0.946751 metrics={'f1_val': 0.4166868044349862, 'auprc': 0.7991287685201669, 'loss_val': 0.9306404457437577, 'psi': 0.5696635900690585}-{'f1_val': 0.13973365136155833, 'auprc': 0.793331337033859, 'loss_val': 1.1450310430750088, 'psi': 0.4011727256304786}
[S16] START round=4 head_norm_before_train=0.801167 cos_to_last_merge=0.9848 (last merge round=1)
[S16] round=4 local utility u=0.223662 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9759900484770203, 'loss_val': 1.2403508411264887, 'psi': 0.4747784895103301}-{'f1_val': 0.14063745019920318, 'auprc': 0.8429544209616417, 'loss_val': 1.2885681364684523, 'psi': 0.4215642385041787}
[S17] START round=4 head_norm_before_train=0.966625 cos_to_last_merge=0.9905 (last merge round=2)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.35880084323611955, 'auprc': 0.809963565700629, 'loss_val': 0.9347062820265978, 'psi': 0.5392659322219233}-{'f1_val': 0.5967400011747924, 'auprc': 0.6646255255497143, 'loss_val': 1.023334160266136, 'psi': 0.6238942109247612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[S15] not sending this round → trigger blocked (psi=0.570)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.515)
[S6] not sending this round → trigger blocked (psi=0.708)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:39814
[S2] not sending this round → trigger blocked (psi=0.741)
[S8] not sending this round → trigger blocked (psi=0.740)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1789 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.5419
[S14] RECEIVED delta(kind=head bytes=1789) from S16
[S14] cosine check vs S16: cos=0.5744
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.0200
[S3] DROPPED delta from S5 (cos=-0.0200 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1386
[S7] DROPPED delta from S14 (cos=-0.1386 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=4 metric=0.4160 head_norm=1.025786
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.702101e-01
[S13] stored merged vector for next round verification (round=4)
[S13] DEBUG after merge:  round=4 metric=0.4160 head_norm=0.859574 delta_norm=0.470210
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.3964 head_norm=0.691684
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.584343e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.2731 head_norm=0.678995 delta_norm=0.358434
[S14] aggregate: ROLLBACK (f1_val pre=0.396 post=0.273 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.300231 (no previous merge yet)
[S2] round=5 local utility u=0.097541 metrics={'f1_val': 0.7148856201035052, 'auprc': 0.7828140638136065, 'loss_val': 0.6195716830862233, 'psi': 0.7420569975875457}-{'f1_val': 0.7137638154464938, 'auprc': 0.7811309457497266, 'loss_val': 0.8028736031984283, 'psi': 0.740710667567787}
[S3] START round=5 head_norm_before_train=1.271297 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.773067848532337, 'loss_val': 1.0686522056505208, 'psi': 0.393131178781399}-{'f1_val': 0.13984006561410703, 'auprc': 0.8701124795077084, 'loss_val': 1.1843052925757291, 'psi': 0.4319490311715476}
[S4] START round=5 head_norm_before_train=1.491064 (no previous merge yet)
[S4] round=5 local utility u=0.044151 metrics={'f1_val': 0.6735369102784948, 'auprc': 0.6570338719523852, 'loss_val': 0.4105161276761182, 'psi': 0.6669356949480509}-{'f1_val': 0.6735363181451606, 'auprc': 0.6594837228770717, 'loss_val': 0.5061639670450052, 'psi': 0.667915280037925}
[S5] START round=5 head_norm_before_train=0.842713 cos_to_last_merge=0.9952 (last merge round=3)
[S5] round=5 local utility u=0.749073 metrics={'f1_val': 0.3631992082701566, 'auprc': 0.7700231795683562, 'loss_val': 1.1462568053926125, 'psi': 0.5259287967894365}-{'f1_val': 0.14226190476190476, 'auprc': 0.7418212706972608, 'loss_val': 1.2341730930354695, 'psi': 0.3820856511360472}
[S6] START round=5 head_norm_before_train=1.401335 (no previous merge yet)
[S6] round=5 local utility u=0.245183 metrics={'f1_val': 0.6928483546777489, 'auprc': 0.812682962099083, 'loss_val': 0.5608739401097531, 'psi': 0.7407821976462825}-{'f1_val': 0.6233118555947306, 'auprc': 0.8342448915102859, 'loss_val': 0.698705885907691, 'psi': 0.7076850699609527}
[S7] START round=5 head_norm_before_train=0.931501 cos_to_last_merge=0.9917 (last merge round=2)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6666188668300178, 'loss_val': 1.2350425184738016, 'psi': 0.3518816403694621}-{'f1_val': 0.14205682272909165, 'auprc': 0.7928421521220526, 'loss_val': 1.2720313939113148, 'psi': 0.402370954486276}
[S8] START round=5 head_norm_before_train=1.080220 cos_to_last_merge=0.9705 (last merge round=1)
[S8] round=5 local utility u=0.273739 metrics={'f1_val': 0.6701679458056116, 'auprc': 0.9916788173459825, 'loss_val': 0.6831919537881015, 'psi': 0.7987722944217599}-{'f1_val': 0.7150337453891538, 'auprc': 0.7769382140704023, 'loss_val': 0.8556437588425757, 'psi': 0.7397955328616532}
[S9] START round=5 head_norm_before_train=1.275493 (no previous merge yet)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6689155025892342, 'loss_val': 1.0498731171853604, 'psi': 0.3524049753196913}-{'f1_val': 0.141397957139996, 'auprc': 0.7065941409431694, 'loss_val': 1.1579318818820907, 'psi': 0.3674764306612654}
[S10] START round=5 head_norm_before_train=0.781190 cos_to_last_merge=0.9796 (last merge round=3)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.6520392001186182, 'auprc': 0.7886244204688757, 'loss_val': 0.6250924406367817, 'psi': 0.7066732882587212}-{'f1_val': 0.38677178805060364, 'auprc': 0.6090860788145259, 'loss_val': 0.901738704086088, 'psi': 0.47569750435617253}
[S11] START round=5 head_norm_before_train=1.284268 (no previous merge yet)
[S11] round=5 local utility u=1.000000 metrics={'f1_val': 0.421406390776622, 'auprc': 0.8978884341340102, 'loss_val': 0.9329798832326142, 'psi': 0.6119992081195773}-{'f1_val': 0.14041368337311058, 'auprc': 0.614735952586474, 'loss_val': 1.1101095458657262, 'psi': 0.33014259105845595}
[S13] START round=5 head_norm_before_train=0.859574 cos_to_last_merge=1.0000 (last merge round=4)
[S13] round=5 local utility u=0.208145 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.7522606898457573, 'loss_val': 0.8320610819025671, 'psi': 0.5503886371297212}-{'f1_val': 0.4160038662657951, 'auprc': 0.663862165533645, 'loss_val': 0.9843354448967963, 'psi': 0.5151471859729351}
[S14] START round=5 head_norm_before_train=0.678995 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.004107 metrics={'f1_val': 0.3958711094360253, 'auprc': 0.8225965613057145, 'loss_val': 1.2941760133485507, 'psi': 0.566561290183901}-{'f1_val': 0.39639674314244955, 'auprc': 0.8279702909315881, 'loss_val': 1.3216642770055747, 'psi': 0.569026162258105}
[S15] START round=5 head_norm_before_train=1.356748 (no previous merge yet)
[S15] round=5 local utility u=0.876022 metrics={'f1_val': 0.6620922012764464, 'auprc': 0.797178252269622, 'loss_val': 0.6451772673932624, 'psi': 0.7161266216737167}-{'f1_val': 0.4166868044349862, 'auprc': 0.7991287685201669, 'loss_val': 0.9306404457437577, 'psi': 0.5696635900690585}
[S16] START round=5 head_norm_before_train=0.837014 cos_to_last_merge=0.9715 (last merge round=1)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6392070219568278, 'loss_val': 1.199090306577418, 'psi': 0.340065278902253}-{'f1_val': 0.14063745019920318, 'auprc': 0.9759900484770203, 'loss_val': 1.2403508411264887, 'psi': 0.4747784895103301}
[S17] START round=5 head_norm_before_train=1.051484 cos_to_last_merge=0.9644 (last merge round=2)
[S17] round=5 local utility u=0.005935 metrics={'f1_val': 0.35170074298235576, 'auprc': 0.838830911139121, 'loss_val': 0.9668383635954589, 'psi': 0.5465528102450619}-{'f1_val': 0.35880084323611955, 'auprc': 0.809963565700629, 'loss_val': 0.9347062820265978, 'psi': 0.5392659322219233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.567)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39807
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S5] not sending this round → trigger blocked (psi=0.526)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39811
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S6] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S2
[S6] cosine check vs S2: cos=-0.0725
[S6] DROPPED delta from S2 (cos=-0.0725 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=-0.0523
[S5] DROPPED delta from S8 (cos=-0.0523 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.6357
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.5050
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.5207
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=-0.1978
[S2] DROPPED delta from S11 (cos=-0.1978 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0092
[S7] DROPPED delta from S6 (cos=-0.0092 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.0059
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.1384
[S8] DROPPED delta from S17 (cos=-0.1384 < 0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.3959 head_norm=0.704876
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.390400e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.4189 head_norm=0.739664 delta_norm=0.539040
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.564 → S7@127.0.0.1:39808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.3632 head_norm=0.873171
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.736794e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.4157 head_norm=0.791864 delta_norm=0.373679
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.500 → S3@127.0.0.1:39803
[S3] ⇄ pheromone p=0.382 → S14@127.0.0.1:39814
[S9] ⇄ pheromone p=0.353 → S7@127.0.0.1:39808
[S7] ⇄ pheromone p=0.346 → S13@127.0.0.1:39813
[S6] ⇄ pheromone p=0.636 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.609 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.669 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.583 → S2@127.0.0.1:39802
[S4] ⇄ pheromone p=0.476 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.612 → S6@127.0.0.1:39807
[S13] ⇄ pheromone p=0.510 → S10@127.0.0.1:39811
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.6520 head_norm=0.878032
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.423482e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.6748 head_norm=0.787076 delta_norm=0.442348
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.649 → S5@127.0.0.1:39805
[S17] ⇄ pheromone p=0.463 → S8@127.0.0.1:39809
[S16] ⇄ pheromone p=0.421 → S14@127.0.0.1:39814
[S2] START round=6 head_norm_before_train=1.378816 (no previous merge yet)
[S2] round=6 local utility u=0.102855 metrics={'f1_val': 0.7032160894043017, 'auprc': 0.7994185150925214, 'loss_val': 0.3936572510517581, 'psi': 0.7416970596795895}-{'f1_val': 0.7148856201035052, 'auprc': 0.7828140638136065, 'loss_val': 0.6195716830862233, 'psi': 0.7420569975875457}
[S3] START round=6 head_norm_before_train=1.309701 (no previous merge yet)
[S3] round=6 local utility u=0.868319 metrics={'f1_val': 0.3922169377903356, 'auprc': 0.796187495873626, 'loss_val': 0.9156346220786609, 'psi': 0.5538051610236518}-{'f1_val': 0.13984006561410703, 'auprc': 0.773067848532337, 'loss_val': 1.0686522056505208, 'psi': 0.393131178781399}
[S4] START round=6 head_norm_before_train=1.592095 (no previous merge yet)
[S4] round=6 local utility u=0.000000 metrics={'f1_val': 0.6655882534478169, 'auprc': 0.6581531948621626, 'loss_val': 0.4991917762917812, 'psi': 0.6626142300135551}-{'f1_val': 0.6735369102784948, 'auprc': 0.6570338719523852, 'loss_val': 0.4105161276761182, 'psi': 0.6669356949480509}
[S5] START round=6 head_norm_before_train=0.791864 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.198545 metrics={'f1_val': 0.4177505557824055, 'auprc': 0.7766804509896654, 'loss_val': 1.0964471114860543, 'psi': 0.5613225138653095}-{'f1_val': 0.3631992082701566, 'auprc': 0.7700231795683562, 'loss_val': 1.1462568053926125, 'psi': 0.5259287967894365}
[S6] START round=6 head_norm_before_train=1.475195 (no previous merge yet)
[S6] round=6 local utility u=0.315225 metrics={'f1_val': 0.7095899298305519, 'auprc': 0.9424707190896136, 'loss_val': 0.4202366521191444, 'psi': 0.8027422455341766}-{'f1_val': 0.6928483546777489, 'auprc': 0.812682962099083, 'loss_val': 0.5608739401097531, 'psi': 0.7407821976462825}
[S7] START round=6 head_norm_before_train=0.955992 cos_to_last_merge=0.9837 (last merge round=2)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.611085746102213, 'loss_val': 1.161620418734834, 'psi': 0.3296683920783402}-{'f1_val': 0.14205682272909165, 'auprc': 0.6666188668300178, 'loss_val': 1.2350425184738016, 'psi': 0.3518816403694621}
[S8] START round=6 head_norm_before_train=1.151046 cos_to_last_merge=0.9534 (last merge round=1)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.3772848942496011, 'auprc': 0.9926630650732193, 'loss_val': 0.5145455894815077, 'psi': 0.6234361625790483}-{'f1_val': 0.6701679458056116, 'auprc': 0.9916788173459825, 'loss_val': 0.6831919537881015, 'psi': 0.7987722944217599}
[S9] START round=6 head_norm_before_train=1.305097 (no previous merge yet)
[S9] round=6 local utility u=1.000000 metrics={'f1_val': 0.436422591833139, 'auprc': 0.7507398437204983, 'loss_val': 0.8699533168986523, 'psi': 0.5621494925880828}-{'f1_val': 0.141397957139996, 'auprc': 0.6689155025892342, 'loss_val': 1.0498731171853604, 'psi': 0.3524049753196913}
[S10] START round=6 head_norm_before_train=0.787076 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.404637 metrics={'f1_val': 0.6990854655380969, 'auprc': 0.9485124136814649, 'loss_val': 0.5777603879957253, 'psi': 0.7988562447954441}-{'f1_val': 0.6520392001186182, 'auprc': 0.7886244204688757, 'loss_val': 0.6250924406367817, 'psi': 0.7066732882587212}
[S11] START round=6 head_norm_before_train=1.326110 (no previous merge yet)
[S11] round=6 local utility u=0.163060 metrics={'f1_val': 0.39992541946910537, 'auprc': 0.9991636824109154, 'loss_val': 0.7817997438631592, 'psi': 0.6396207246458294}-{'f1_val': 0.421406390776622, 'auprc': 0.8978884341340102, 'loss_val': 0.9329798832326142, 'psi': 0.6119992081195773}
[S13] START round=6 head_norm_before_train=0.927028 cos_to_last_merge=0.9914 (last merge round=4)
[S13] round=6 local utility u=0.558394 metrics={'f1_val': 0.5958515813651345, 'auprc': 0.7457062739512241, 'loss_val': 0.7758750782407566, 'psi': 0.6557934583995704}-{'f1_val': 0.41580726865236384, 'auprc': 0.7522606898457573, 'loss_val': 0.8320610819025671, 'psi': 0.5503886371297212}
[S14] START round=6 head_norm_before_train=0.739664 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.7214472860410107, 'loss_val': 1.2401701264567186, 'psi': 0.5265152358025993}-{'f1_val': 0.3958711094360253, 'auprc': 0.8225965613057145, 'loss_val': 1.2941760133485507, 'psi': 0.566561290183901}
[S15] START round=6 head_norm_before_train=1.422944 (no previous merge yet)
[S15] round=6 local utility u=0.174187 metrics={'f1_val': 0.6919574134237518, 'auprc': 0.7972490689991653, 'loss_val': 0.4762078624529993, 'psi': 0.7340740756539172}-{'f1_val': 0.6620922012764464, 'auprc': 0.797178252269622, 'loss_val': 0.6451772673932624, 'psi': 0.7161266216737167}
[S16] START round=6 head_norm_before_train=0.870657 cos_to_last_merge=0.9592 (last merge round=1)
[S16] round=6 local utility u=0.258424 metrics={'f1_val': 0.2597976503766183, 'auprc': 0.5512081698634532, 'loss_val': 1.1332079023398802, 'psi': 0.37636185817135226}-{'f1_val': 0.14063745019920318, 'auprc': 0.6392070219568278, 'loss_val': 1.199090306577418, 'psi': 0.340065278902253}
[S17] START round=6 head_norm_before_train=1.129770 cos_to_last_merge=0.9360 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=6 local utility u=0.033538 metrics={'f1_val': 0.35587692567468954, 'auprc': 0.8326119306820978, 'loss_val': 0.9061626313560059, 'psi': 0.5465709276776528}-{'f1_val': 0.35170074298235576, 'auprc': 0.838830911139121, 'loss_val': 0.9668383635954589, 'psi': 0.5465528102450619}
[S13] not sending this round → trigger blocked (psi=0.656)
[S11] not sending this round → trigger blocked (psi=0.640)
[S2] not sending this round → trigger blocked (psi=0.742)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S16] → sending delta(kind=head bytes=1783) to S14@127.0.0.1:39814
[S15] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[S6] not sending this round → trigger blocked (psi=0.803)
[S10] not sending this round → trigger blocked (psi=0.799)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1783 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S5
[S3] cosine check vs S5: cos=-0.0102
[S3] DROPPED delta from S5 (cos=-0.0102 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S9
[S7] cosine check vs S9: cos=0.0283
[S14] RECEIVED delta(kind=head bytes=1783) from S16
[S14] cosine check vs S16: cos=0.6214
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] cosine check vs S3: cos=0.1353
[S17] not sending this round → trigger blocked (psi=0.547)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.988717
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.209450e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=0.843432 delta_norm=0.820945
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.3966 head_norm=0.763561
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.107237e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.3866 head_norm=0.672513 delta_norm=0.410724
[S14] aggregate: ROLLBACK (f1_val pre=0.397 post=0.387 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=1.447903 (no previous merge yet)
[S2] round=7 local utility u=0.336677 metrics={'f1_val': 0.7017474301177078, 'auprc': 0.99106429685341, 'loss_val': 0.28642917142047325, 'psi': 0.8174741768119886}-{'f1_val': 0.7032160894043017, 'auprc': 0.7994185150925214, 'loss_val': 0.3936572510517581, 'psi': 0.7416970596795895}
[S3] START round=7 head_norm_before_train=1.346437 (no previous merge yet)
[S3] round=7 local utility u=0.393933 metrics={'f1_val': 0.401708470248874, 'auprc': 0.9908891042723044, 'loss_val': 0.7688221082843677, 'psi': 0.6373807238582462}-{'f1_val': 0.3922169377903356, 'auprc': 0.796187495873626, 'loss_val': 0.9156346220786609, 'psi': 0.5538051610236518}
[S4] START round=7 head_norm_before_train=1.655668 (no previous merge yet)
[S4] round=7 local utility u=0.273576 metrics={'f1_val': 0.6655882534478169, 'auprc': 0.8416803303462952, 'loss_val': 0.5026219286056735, 'psi': 0.7360250842072082}-{'f1_val': 0.6655882534478169, 'auprc': 0.6581531948621626, 'loss_val': 0.4991917762917812, 'psi': 0.6626142300135551}
[S5] START round=7 head_norm_before_train=0.815911 cos_to_last_merge=0.9956 (last merge round=5)
[S5] round=7 local utility u=0.060296 metrics={'f1_val': 0.41778804395810054, 'auprc': 0.7774994789558943, 'loss_val': 0.9785365305069107, 'psi': 0.561672617957218}-{'f1_val': 0.4177505557824055, 'auprc': 0.7766804509896654, 'loss_val': 1.0964471114860543, 'psi': 0.5613225138653095}
[S6] START round=7 head_norm_before_train=1.527817 (no previous merge yet)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.6188133733933694, 'auprc': 0.7937702045423713, 'loss_val': 0.553201861170148, 'psi': 0.6887961058529701}-{'f1_val': 0.7095899298305519, 'auprc': 0.9424707190896136, 'loss_val': 0.4202366521191444, 'psi': 0.8027422455341766}
[S7] START round=7 head_norm_before_train=0.843432 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.217786 metrics={'f1_val': 0.1440851473234893, 'auprc': 0.7446222029077891, 'loss_val': 1.13882724741508, 'psi': 0.38429996955720924}-{'f1_val': 0.14205682272909165, 'auprc': 0.611085746102213, 'loss_val': 1.161620418734834, 'psi': 0.3296683920783402}
[S8] START round=7 head_norm_before_train=1.225572 cos_to_last_merge=0.9320 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.932
[S8] round=7 local utility u=0.034273 metrics={'f1_val': 0.3727983816295533, 'auprc': 0.9949476991687147, 'loss_val': 0.4259342447011183, 'psi': 0.6216581086452179}-{'f1_val': 0.3772848942496011, 'auprc': 0.9926630650732193, 'loss_val': 0.5145455894815077, 'psi': 0.6234361625790483}
[S9] START round=7 head_norm_before_train=1.339065 (no previous merge yet)
[S9] round=7 local utility u=0.242904 metrics={'f1_val': 0.43729044332193584, 'auprc': 0.8575491907221364, 'loss_val': 0.7097798363636334, 'psi': 0.605393942282016}-{'f1_val': 0.436422591833139, 'auprc': 0.7507398437204983, 'loss_val': 0.8699533168986523, 'psi': 0.5621494925880828}
[S10] START round=7 head_norm_before_train=0.872498 cos_to_last_merge=0.9860 (last merge round=5)
[S10] round=7 local utility u=0.113671 metrics={'f1_val': 0.7012347983485312, 'auprc': 0.9685266223898841, 'loss_val': 0.4233570232909515, 'psi': 0.8081515279650724}-{'f1_val': 0.6990854655380969, 'auprc': 0.9485124136814649, 'loss_val': 0.5777603879957253, 'psi': 0.7988562447954441}
[S11] START round=7 head_norm_before_train=1.368748 (no previous merge yet)
[S11] round=7 local utility u=0.079032 metrics={'f1_val': 0.3998848669786352, 'auprc': 0.9992707963950814, 'loss_val': 0.6238139186475103, 'psi': 0.6396392387452137}-{'f1_val': 0.39992541946910537, 'auprc': 0.9991636824109154, 'loss_val': 0.7817997438631592, 'psi': 0.6396207246458294}
[S13] START round=7 head_norm_before_train=0.993936 cos_to_last_merge=0.9733 (last merge round=4)
[S13] round=7 local utility u=0.298121 metrics={'f1_val': 0.6779062621707072, 'auprc': 0.754579267601163, 'loss_val': 0.6985795606442721, 'psi': 0.7085754643428895}-{'f1_val': 0.5958515813651345, 'auprc': 0.7457062739512241, 'loss_val': 0.7758750782407566, 'psi': 0.6557934583995704}
[S14] START round=7 head_norm_before_train=0.672513 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.117675 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.7685444326900681, 'loss_val': 1.1463094214224991, 'psi': 0.5453739351047845}-{'f1_val': 0.39656053564365834, 'auprc': 0.7214472860410107, 'loss_val': 1.2401701264567186, 'psi': 0.5265152358025993}
[S15] START round=7 head_norm_before_train=1.485375 (no previous merge yet)
[S15] round=7 local utility u=0.354271 metrics={'f1_val': 0.6915050306805697, 'auprc': 0.9889319433103156, 'loss_val': 0.34000025613875157, 'psi': 0.8104757957324681}-{'f1_val': 0.6919574134237518, 'auprc': 0.7972490689991653, 'loss_val': 0.4762078624529993, 'psi': 0.7340740756539172}
[S16] START round=7 head_norm_before_train=0.902183 cos_to_last_merge=0.9479 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=7 local utility u=0.493488 metrics={'f1_val': 0.41742175001598325, 'auprc': 0.5318545672959176, 'loss_val': 1.0339151490991816, 'psi': 0.463194876927957}-{'f1_val': 0.2597976503766183, 'auprc': 0.5512081698634532, 'loss_val': 1.1332079023398802, 'psi': 0.37636185817135226}
[S17] START round=7 head_norm_before_train=1.183412 cos_to_last_merge=0.9137 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=7 local utility u=0.856833 metrics={'f1_val': 0.5963189354685181, 'auprc': 0.8459113348463349, 'loss_val': 0.6750478357728543, 'psi': 0.6961558952196447}-{'f1_val': 0.35587692567468954, 'auprc': 0.8326119306820978, 'loss_val': 0.9061626313560059, 'psi': 0.5465709276776528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39811
[S3] not sending this round → trigger blocked (psi=0.637)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S9] not sending this round → trigger blocked (psi=0.605)
[S16] not sending this round → trigger blocked (psi=0.463)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.562)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39802
[S11] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=-0.0738
[S5] DROPPED delta from S8 (cos=-0.0738 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=0.7023
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.5219
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=-0.1940
[S2] DROPPED delta from S11 (cos=-0.1940 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.7516
[S14] RECEIVED delta(kind=head bytes=1801) from S4
[S14] cosine check vs S4: cos=0.3204
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.1207
[S7] DROPPED delta from S14 (cos=-0.1207 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=-0.0820
[S6] DROPPED delta from S2 (cos=-0.0820 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1792) from S7
[S13] cosine check vs S7: cos=0.4826
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.1414
[S8] DROPPED delta from S17 (cos=-0.1414 < 0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4178 head_norm=0.847452
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.556072e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4177 head_norm=0.839508 delta_norm=0.355607
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=0.707413
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.773320e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3966 head_norm=0.839648 delta_norm=0.477332
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=7 metric=0.7012 head_norm=0.971744
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.611656e-01
[S10] stored merged vector for next round verification (round=7)
[S10] DEBUG after merge:  round=7 metric=0.7010 head_norm=0.952406 delta_norm=0.361166
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.6779 head_norm=1.063367
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.979330e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.6605 head_norm=0.832047 delta_norm=0.497933
[S13] aggregate: ROLLBACK (f1_val pre=0.678 post=0.660 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=1.516948 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7015658713512667, 'auprc': 0.9847662051469752, 'loss_val': 0.26771049483873294, 'psi': 0.8148460048695501}-{'f1_val': 0.7017474301177078, 'auprc': 0.99106429685341, 'loss_val': 0.28642917142047325, 'psi': 0.8174741768119886}
[S3] START round=8 head_norm_before_train=1.394196 (no previous merge yet)
[S3] round=8 local utility u=0.038528 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.9977202024745534, 'loss_val': 0.7166983215084931, 'psi': 0.6405571515811286}-{'f1_val': 0.401708470248874, 'auprc': 0.9908891042723044, 'loss_val': 0.7688221082843677, 'psi': 0.6373807238582462}
[S4] START round=8 head_norm_before_train=1.684930 (no previous merge yet)
[S4] round=8 local utility u=0.000000 metrics={'f1_val': 0.6669368356935497, 'auprc': 0.6567441558425736, 'loss_val': 0.5172322294715259, 'psi': 0.6628597637531592}-{'f1_val': 0.6655882534478169, 'auprc': 0.8416803303462952, 'loss_val': 0.5026219286056735, 'psi': 0.7360250842072082}
[S5] START round=8 head_norm_before_train=0.839508 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.027839 metrics={'f1_val': 0.4176671856330787, 'auprc': 0.7756541416138472, 'loss_val': 0.9165981668999413, 'psi': 0.5608619680253861}-{'f1_val': 0.41778804395810054, 'auprc': 0.7774994789558943, 'loss_val': 0.9785365305069107, 'psi': 0.561672617957218}
[S6] START round=8 head_norm_before_train=1.573062 (no previous merge yet)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.9598879299009866, 'auprc': 0.9703547647362465, 'loss_val': 0.2985514172739624, 'psi': 0.9640746638350906}-{'f1_val': 0.6188133733933694, 'auprc': 0.7937702045423713, 'loss_val': 0.553201861170148, 'psi': 0.6887961058529701}
[S7] START round=8 head_norm_before_train=0.865868 cos_to_last_merge=0.9967 (last merge round=6)
[S7] round=8 local utility u=0.916205 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7717334157249067, 'loss_val': 1.0244879016822, 'psi': 0.5588182060227382}-{'f1_val': 0.1440851473234893, 'auprc': 0.7446222029077891, 'loss_val': 1.13882724741508, 'psi': 0.38429996955720924}
[S8] START round=8 head_norm_before_train=1.292105 cos_to_last_merge=0.9127 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.913
[S8] round=8 local utility u=1.000000 metrics={'f1_val': 0.714460606093301, 'auprc': 0.9981884695105776, 'loss_val': 0.25354909711347334, 'psi': 0.8279517514602116}-{'f1_val': 0.3727983816295533, 'auprc': 0.9949476991687147, 'loss_val': 0.4259342447011183, 'psi': 0.6216581086452179}
[S9] START round=8 head_norm_before_train=1.384775 (no previous merge yet)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7016148490515617, 'auprc': 0.9996398188395674, 'loss_val': 0.5148195369353323, 'psi': 0.820824836966764}-{'f1_val': 0.43729044332193584, 'auprc': 0.8575491907221364, 'loss_val': 0.7097798363636334, 'psi': 0.605393942282016}
[S10] START round=8 head_norm_before_train=0.952406 cos_to_last_merge=1.0000 (last merge round=7)
[S10] round=8 local utility u=0.194924 metrics={'f1_val': 0.7572351276447828, 'auprc': 0.9961929560976213, 'loss_val': 0.45250981174954963, 'psi': 0.8528182590259181}-{'f1_val': 0.7012347983485312, 'auprc': 0.9685266223898841, 'loss_val': 0.4233570232909515, 'psi': 0.8081515279650724}
[S11] START round=8 head_norm_before_train=1.411993 (no previous merge yet)
[S11] round=8 local utility u=0.001905 metrics={'f1_val': 0.40062503679542427, 'auprc': 0.9994650156111198, 'loss_val': 0.6250271535168928, 'psi': 0.6401610283217025}-{'f1_val': 0.3998848669786352, 'auprc': 0.9992707963950814, 'loss_val': 0.6238139186475103, 'psi': 0.6396392387452137}
[S13] START round=8 head_norm_before_train=0.832047 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.101804 metrics={'f1_val': 0.7117492312341136, 'auprc': 0.75952214725258, 'loss_val': 0.7128583284780429, 'psi': 0.7308583976415002}-{'f1_val': 0.6779062621707072, 'auprc': 0.754579267601163, 'loss_val': 0.6985795606442721, 'psi': 0.7085754643428895}
[S14] START round=8 head_norm_before_train=0.839648 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.725177 metrics={'f1_val': 0.5703171526472184, 'auprc': 0.8624492739003923, 'loss_val': 1.0200117276012621, 'psi': 0.687170001148488}-{'f1_val': 0.39659360338126215, 'auprc': 0.7685444326900681, 'loss_val': 1.1463094214224991, 'psi': 0.5453739351047845}
[S15] START round=8 head_norm_before_train=1.550629 (no previous merge yet)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.7000965811740458, 'auprc': 0.79956631524291, 'loss_val': 0.5030114465892134, 'psi': 0.7398844748015915}-{'f1_val': 0.6915050306805697, 'auprc': 0.9889319433103156, 'loss_val': 0.34000025613875157, 'psi': 0.8104757957324681}
[S16] START round=8 head_norm_before_train=0.944097 cos_to_last_merge=0.9334 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.38436943632559206, 'auprc': 0.5429565380134229, 'loss_val': 0.9668523772383277, 'psi': 0.44780427700072445}-{'f1_val': 0.41742175001598325, 'auprc': 0.5318545672959176, 'loss_val': 1.0339151490991816, 'psi': 0.463194876927957}
[S17] START round=8 head_norm_before_train=1.226729 cos_to_last_merge=0.8971 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.39469379253656206, 'auprc': 0.8520822663403493, 'loss_val': 0.6648497617163709, 'psi': 0.5776491820580769}-{'f1_val': 0.5963189354685181, 'auprc': 0.8459113348463349, 'loss_val': 0.6750478357728543, 'psi': 0.6961558952196447}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:39805
[S13] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.2426
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.8080
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=-0.0906
[S5] DROPPED delta from S8 (cos=-0.0906 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=-0.1941
[S2] DROPPED delta from S11 (cos=-0.1941 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0324
[S3] DROPPED delta from S5 (cos=-0.0324 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1217
[S7] DROPPED delta from S14 (cos=-0.1217 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] cosine check vs S10: cos=0.8155
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.7451
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.0030
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=0.8040
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=8 metric=0.7117 head_norm=0.880797
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.786184e-01
[S13] stored merged vector for next round verification (round=8)
[S13] DEBUG after merge:  round=8 metric=0.7106 head_norm=0.844944 delta_norm=0.278618
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.5703 head_norm=0.872668
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.485604e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.2344 head_norm=0.930870 delta_norm=0.748560
[S14] aggregate: ROLLBACK (f1_val pre=0.570 post=0.234 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4169 head_norm=0.898507
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.922785e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4170 head_norm=0.850947 delta_norm=0.492278
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.7572 head_norm=1.038246
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.066003e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.7507 head_norm=0.912620 delta_norm=0.306600
[S10] aggregate: ROLLBACK (f1_val pre=0.757 post=0.751 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4177 head_norm=0.868669
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.006218e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4177 head_norm=0.908789 delta_norm=0.300622
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.569477 (no previous merge yet)
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.7014855066245017, 'auprc': 0.9681791510545648, 'loss_val': 0.2616161350583882, 'psi': 0.8081629643965269}-{'f1_val': 0.7015658713512667, 'auprc': 0.9847662051469752, 'loss_val': 0.26771049483873294, 'psi': 0.8148460048695501}
[S3] START round=9 head_norm_before_train=1.446435 (no previous merge yet)
[S3] round=9 local utility u=0.590365 metrics={'f1_val': 0.5732610619087348, 'auprc': 0.9972360045240078, 'loss_val': 0.55939190872823, 'psi': 0.7428510389548441}-{'f1_val': 0.4024484509855121, 'auprc': 0.9977202024745534, 'loss_val': 0.7166983215084931, 'psi': 0.6405571515811286}
[S4] START round=9 head_norm_before_train=1.706047 (no previous merge yet)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6626308134707769, 'auprc': 0.6586386856671425, 'loss_val': 0.5164077881638403, 'psi': 0.6610339623493231}-{'f1_val': 0.6669368356935497, 'auprc': 0.6567441558425736, 'loss_val': 0.5172322294715259, 'psi': 0.6628597637531592}
[S5] START round=9 head_norm_before_train=0.908789 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.868662 metrics={'f1_val': 0.6985855650731756, 'auprc': 0.7602751299865991, 'loss_val': 0.8186470117148906, 'psi': 0.723261391038545}-{'f1_val': 0.4176671856330787, 'auprc': 0.7756541416138472, 'loss_val': 0.9165981668999413, 'psi': 0.5608619680253861}
[S6] START round=9 head_norm_before_train=1.602154 (no previous merge yet)
[S6] round=9 local utility u=0.075514 metrics={'f1_val': 0.9623691878554806, 'auprc': 0.985555606172672, 'loss_val': 0.20801344576411063, 'psi': 0.9716437551823571}-{'f1_val': 0.9598879299009866, 'auprc': 0.9703547647362465, 'loss_val': 0.2985514172739624, 'psi': 0.9640746638350906}
[S7] START round=9 head_norm_before_train=0.850947 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.667437 metrics={'f1_val': 0.6674603814868035, 'auprc': 0.710842010415879, 'loss_val': 1.0104537863543488, 'psi': 0.6848130330584337}-{'f1_val': 0.4168747328879592, 'auprc': 0.7717334157249067, 'loss_val': 1.0244879016822, 'psi': 0.5588182060227382}
[S8] START round=9 head_norm_before_train=1.361081 cos_to_last_merge=0.8960 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.896
[S8] round=9 local utility u=0.866649 metrics={'f1_val': 0.9878254991571935, 'auprc': 0.9985658534674263, 'loss_val': 0.16157198679282148, 'psi': 0.9921216408812866}-{'f1_val': 0.714460606093301, 'auprc': 0.9981884695105776, 'loss_val': 0.25354909711347334, 'psi': 0.8279517514602116}
[S9] START round=9 head_norm_before_train=1.432686 (no previous merge yet)
[S9] round=9 local utility u=0.057056 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9993674079647956, 'loss_val': 0.39838954953668115, 'psi': 0.8205657638174237}-{'f1_val': 0.7016148490515617, 'auprc': 0.9996398188395674, 'loss_val': 0.5148195369353323, 'psi': 0.820824836966764}
[S10] START round=9 head_norm_before_train=0.912620 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.000000 metrics={'f1_val': 0.7346233440587353, 'auprc': 0.9858540304970047, 'loss_val': 0.5258184289055827, 'psi': 0.8351156186340432}-{'f1_val': 0.7572351276447828, 'auprc': 0.9961929560976213, 'loss_val': 0.45250981174954963, 'psi': 0.8528182590259181}
[S11] START round=9 head_norm_before_train=1.451422 (no previous merge yet)
[S11] round=9 local utility u=1.000000 metrics={'f1_val': 0.9453243100889681, 'auprc': 0.999024445809381, 'loss_val': 0.4256779118953404, 'psi': 0.9668043643771332}-{'f1_val': 0.40062503679542427, 'auprc': 0.9994650156111198, 'loss_val': 0.6250271535168928, 'psi': 0.6401610283217025}
[S13] START round=9 head_norm_before_train=0.844944 cos_to_last_merge=1.0000 (last merge round=8)
[S13] round=9 local utility u=0.000000 metrics={'f1_val': 0.6870708758534456, 'auprc': 0.7361988561872754, 'loss_val': 0.7446653454749405, 'psi': 0.7067220679869776}-{'f1_val': 0.7117492312341136, 'auprc': 0.75952214725258, 'loss_val': 0.7128583284780429, 'psi': 0.7308583976415002}
[S14] START round=9 head_norm_before_train=0.930870 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.000000 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9310503423936627, 'loss_val': 0.9107467197473144, 'psi': 0.6103564583436601}-{'f1_val': 0.5703171526472184, 'auprc': 0.8624492739003923, 'loss_val': 1.0200117276012621, 'psi': 0.687170001148488}
[S15] START round=9 head_norm_before_train=1.603065 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.6985216426773301, 'auprc': 0.7995632959876324, 'loss_val': 0.5599911503406061, 'psi': 0.738938304001451}-{'f1_val': 0.7000965811740458, 'auprc': 0.79956631524291, 'loss_val': 0.5030114465892134, 'psi': 0.7398844748015915}
[S16] START round=9 head_norm_before_train=0.992341 cos_to_last_merge=0.9162 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=9 local utility u=0.275736 metrics={'f1_val': 0.3757302685516051, 'auprc': 0.7360389175676073, 'loss_val': 0.9427923656311269, 'psi': 0.519853728158006}-{'f1_val': 0.38436943632559206, 'auprc': 0.5429565380134229, 'loss_val': 0.9668523772383277, 'psi': 0.44780427700072445}
[S17] START round=9 head_norm_before_train=1.262368 cos_to_last_merge=0.8869 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.887
[S17] round=9 local utility u=0.077354 metrics={'f1_val': 0.4089770162454167, 'auprc': 0.8600255781597653, 'loss_val': 0.619671406962427, 'psi': 0.5893964410111562}-{'f1_val': 0.39469379253656206, 'auprc': 0.8520822663403493, 'loss_val': 0.6648497617163709, 'psi': 0.5776491820580769}
[S7] not sending this round → trigger blocked (psi=0.685)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.967)
[S3] not sending this round → trigger blocked (psi=0.743)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39814
[S6] not sending this round → trigger blocked (psi=0.972)
[S8] not sending this round → trigger blocked (psi=0.992)
[S9] not sending this round → trigger blocked (psi=0.821)
[S5] not sending this round → trigger blocked (psi=0.723)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S16
[S14] cosine check vs S16: cos=0.2391
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.1480
[S8] DROPPED delta from S17 (cos=-0.1480 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3966 head_norm=0.962345
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.193995e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6918 head_norm=0.789783 delta_norm=0.619400
[S14] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.610139 (no previous merge yet)
[S2] round=10 local utility u=0.741863 metrics={'f1_val': 0.9473883024279137, 'auprc': 0.9661051594033772, 'loss_val': 0.24708449373215235, 'psi': 0.9548750452180992}-{'f1_val': 0.7014855066245017, 'auprc': 0.9681791510545648, 'loss_val': 0.2616161350583882, 'psi': 0.8081629643965269}
[S3] START round=10 head_norm_before_train=1.497514 (no previous merge yet)
[S3] round=10 local utility u=0.458108 metrics={'f1_val': 0.7005859652789095, 'auprc': 0.9972728587764518, 'loss_val': 0.4072353759163455, 'psi': 0.8192607226779264}-{'f1_val': 0.5732610619087348, 'auprc': 0.9972360045240078, 'loss_val': 0.55939190872823, 'psi': 0.7428510389548441}
[S4] START round=10 head_norm_before_train=1.723853 (no previous merge yet)
[S4] round=10 local utility u=0.113826 metrics={'f1_val': 0.6140434802374166, 'auprc': 0.8365342635920694, 'loss_val': 0.530918385595181, 'psi': 0.7030397935792778}-{'f1_val': 0.6626308134707769, 'auprc': 0.6586386856671425, 'loss_val': 0.5164077881638403, 'psi': 0.6610339623493231}
[S5] START round=10 head_norm_before_train=0.938321 cos_to_last_merge=0.9959 (last merge round=8)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.5930419604282698, 'auprc': 0.7460769774196957, 'loss_val': 0.6986008421569676, 'psi': 0.6542559672248403}-{'f1_val': 0.6985855650731756, 'auprc': 0.7602751299865991, 'loss_val': 0.8186470117148906, 'psi': 0.723261391038545}
[S6] START round=10 head_norm_before_train=1.634925 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.46250102586552344, 'auprc': 0.7766735602135241, 'loss_val': 0.8754577732261265, 'psi': 0.5881700396047237}-{'f1_val': 0.9623691878554806, 'auprc': 0.985555606172672, 'loss_val': 0.20801344576411063, 'psi': 0.9716437551823571}
[S7] START round=10 head_norm_before_train=0.870992 cos_to_last_merge=0.9952 (last merge round=8)
[S7] round=10 local utility u=0.211558 metrics={'f1_val': 0.6821629200270218, 'auprc': 0.782387147488692, 'loss_val': 0.8901874444348358, 'psi': 0.7222526110116899}-{'f1_val': 0.6674603814868035, 'auprc': 0.710842010415879, 'loss_val': 1.0104537863543488, 'psi': 0.6848130330584337}
[S8] START round=10 head_norm_before_train=1.433928 cos_to_last_merge=0.8808 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.881
[S8] round=10 local utility u=0.050559 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9989966812893769, 'loss_val': 0.10487494910850942, 'psi': 0.9966068625049517}-{'f1_val': 0.9878254991571935, 'auprc': 0.9985658534674263, 'loss_val': 0.16157198679282148, 'psi': 0.9921216408812866}
[S9] START round=10 head_norm_before_train=1.482068 (no previous merge yet)
[S9] round=10 local utility u=0.042663 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9986886743177539, 'loss_val': 0.31058204841438775, 'psi': 0.8202497598516396}-{'f1_val': 0.7013646677191758, 'auprc': 0.9993674079647956, 'loss_val': 0.39838954953668115, 'psi': 0.8205657638174237}
[S10] START round=10 head_norm_before_train=0.993203 cos_to_last_merge=0.9908 (last merge round=8)
[S10] round=10 local utility u=0.929759 metrics={'f1_val': 0.9957455607450773, 'auprc': 0.9963473447106577, 'loss_val': 0.2645142617254198, 'psi': 0.9959862743313094}-{'f1_val': 0.7346233440587353, 'auprc': 0.9858540304970047, 'loss_val': 0.5258184289055827, 'psi': 0.8351156186340432}
[S11] START round=10 head_norm_before_train=1.489910 (no previous merge yet)
[S11] round=10 local utility u=0.000000 metrics={'f1_val': 0.7123120992880742, 'auprc': 0.9985369819216602, 'loss_val': 0.32214789228401924, 'psi': 0.8268020523415085}-{'f1_val': 0.9453243100889681, 'auprc': 0.999024445809381, 'loss_val': 0.4256779118953404, 'psi': 0.9668043643771332}
[S13] START round=10 head_norm_before_train=0.905557 cos_to_last_merge=0.9924 (last merge round=8)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.5885349194033582, 'auprc': 0.7454156690188553, 'loss_val': 0.7009315762992191, 'psi': 0.651287219249557}-{'f1_val': 0.6870708758534456, 'auprc': 0.7361988561872754, 'loss_val': 0.7446653454749405, 'psi': 0.7067220679869776}
[S14] START round=10 head_norm_before_train=0.789783 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=1.000000 metrics={'f1_val': 0.6920241227315899, 'auprc': 0.989783407441277, 'loss_val': 0.7592864057590948, 'psi': 0.8111278366154647}-{'f1_val': 0.39656053564365834, 'auprc': 0.9310503423936627, 'loss_val': 0.9107467197473144, 'psi': 0.6103564583436601}
[S15] START round=10 head_norm_before_train=1.649659 (no previous merge yet)
[S15] round=10 local utility u=0.453649 metrics={'f1_val': 0.7085072481097228, 'auprc': 0.9770950795945224, 'loss_val': 0.2452013240536104, 'psi': 0.8159423807036426}-{'f1_val': 0.6985216426773301, 'auprc': 0.7995632959876324, 'loss_val': 0.5599911503406061, 'psi': 0.738938304001451}
[S16] START round=10 head_norm_before_train=1.043416 cos_to_last_merge=0.8992 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.899
[S16] round=10 local utility u=0.038221 metrics={'f1_val': 0.3851866057383235, 'auprc': 0.7257297062770212, 'loss_val': 0.8921609014099893, 'psi': 0.5214038459538025}-{'f1_val': 0.3757302685516051, 'auprc': 0.7360389175676073, 'loss_val': 0.9427923656311269, 'psi': 0.519853728158006}
[S17] START round=10 head_norm_before_train=1.301246 cos_to_last_merge=0.8782 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=10 local utility u=0.488157 metrics={'f1_val': 0.5535688037571275, 'auprc': 0.884249182289553, 'loss_val': 0.5835788654967702, 'psi': 0.6858409551700977}-{'f1_val': 0.4089770162454167, 'auprc': 0.8600255781597653, 'loss_val': 0.619671406962427, 'psi': 0.5893964410111562}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39814
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S8] → sending delta(kind=head bytes=1807) to S5@127.0.0.1:39805
[S4] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1807 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S16] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.1094
[S7] DROPPED delta from S14 (cos=-0.1094 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S9
[S7] cosine check vs S9: cos=0.7373
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.7158
[S6] RECEIVED delta(kind=head bytes=1804) from S2
[S6] cosine check vs S2: cos=-0.0870
[S6] DROPPED delta from S2 (cos=-0.0870 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.2171
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.4726
[S5] RECEIVED delta(kind=head bytes=1807) from S8
[S5] cosine check vs S8: cos=-0.1014
[S5] DROPPED delta from S8 (cos=-0.1014 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.4938
[S14] RECEIVED delta(kind=head bytes=1790) from S16
[S14] cosine check vs S16: cos=0.7861
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.9036
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.1520
[S8] DROPPED delta from S17 (cos=-0.1520 < 0.0)
[S11] ⇄ pheromone p=0.373 → S2@127.0.0.1:39802
[S6] ⇄ pheromone p=0.374 → S7@127.0.0.1:39808
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=10 metric=0.5885 head_norm=0.978719
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.564741e-01
[S13] stored merged vector for next round verification (round=10)
[S13] DEBUG after merge:  round=10 metric=0.5945 head_norm=0.871889 delta_norm=0.356474
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.256 → S10@127.0.0.1:39811
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.5930 head_norm=0.969211
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.331593e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.6390 head_norm=1.003536 delta_norm=0.233159
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.329 → S3@127.0.0.1:39803
[S9] ⇄ pheromone p=0.368 → S7@127.0.0.1:39808
[S16] ⇄ pheromone p=0.261 → S14@127.0.0.1:39814
[S4] ⇄ pheromone p=0.207 → S14@127.0.0.1:39814
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6920 head_norm=0.837350
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.954800e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6920 head_norm=0.807326 delta_norm=0.195480
[S14] aggregate: ACCEPT kept=['S4', 'S15', 'S3', 'S16'] (k=4/4) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.490 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.480 → S5@127.0.0.1:39805
[S3] ⇄ pheromone p=0.428 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.468 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.361 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.392 → S6@127.0.0.1:39807
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6822 head_norm=0.903681
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.274518e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6786 head_norm=1.138170 delta_norm=0.527452
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.402 → S13@127.0.0.1:39813
[S17] ⇄ pheromone p=0.352 → S8@127.0.0.1:39809
[S2] START round=11 head_norm_before_train=1.643509 (no previous merge yet)
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.7319841776783711, 'auprc': 0.8721085452206851, 'loss_val': 0.3183930979832751, 'psi': 0.7880339246952968}-{'f1_val': 0.9473883024279137, 'auprc': 0.9661051594033772, 'loss_val': 0.24708449373215235, 'psi': 0.9548750452180992}
[S3] START round=11 head_norm_before_train=1.544447 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6924948654681071, 'auprc': 0.998156441665727, 'loss_val': 0.3833395903033526, 'psi': 0.8147594959471551}-{'f1_val': 0.7005859652789095, 'auprc': 0.9972728587764518, 'loss_val': 0.4072353759163455, 'psi': 0.8192607226779264}
[S4] START round=11 head_norm_before_train=1.743173 (no previous merge yet)
[S4] round=11 local utility u=0.160123 metrics={'f1_val': 0.6132381906611037, 'auprc': 0.9458392546349377, 'loss_val': 0.533755918984545, 'psi': 0.7462786162506373}-{'f1_val': 0.6140434802374166, 'auprc': 0.8365342635920694, 'loss_val': 0.530918385595181, 'psi': 0.7030397935792778}
[S5] START round=11 head_norm_before_train=1.003536 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.4173841268229622, 'auprc': 0.7058577855664785, 'loss_val': 0.8037540833383917, 'psi': 0.5327735903203688}-{'f1_val': 0.5930419604282698, 'auprc': 0.7460769774196957, 'loss_val': 0.6986008421569676, 'psi': 0.6542559672248403}
[S6] START round=11 head_norm_before_train=1.660507 (no previous merge yet)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.8231912377961499, 'auprc': 0.9629405255940475, 'loss_val': 0.35206217139631923, 'psi': 0.879090952915309}-{'f1_val': 0.46250102586552344, 'auprc': 0.7766735602135241, 'loss_val': 0.8754577732261265, 'psi': 0.5881700396047237}
[S7] START round=11 head_norm_before_train=1.138170 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.041440 metrics={'f1_val': 0.6862939410466964, 'auprc': 0.788933430090855, 'loss_val': 0.8517314808484572, 'psi': 0.7273497366643599}-{'f1_val': 0.6821629200270218, 'auprc': 0.782387147488692, 'loss_val': 0.8901874444348358, 'psi': 0.7222526110116899}
[S8] START round=11 head_norm_before_train=1.491112 cos_to_last_merge=0.8703 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=11 local utility u=0.005961 metrics={'f1_val': 0.994792642153961, 'auprc': 0.998924341509151, 'loss_val': 0.09140904903738023, 'psi': 0.996445321896037}-{'f1_val': 0.9950136499820015, 'auprc': 0.9989966812893769, 'loss_val': 0.10487494910850942, 'psi': 0.9966068625049517}
[S9] START round=11 head_norm_before_train=1.526641 (no previous merge yet)
[S9] round=11 local utility u=0.031765 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9982309976655084, 'loss_val': 0.24523502135401853, 'psi': 0.8200223475302145}-{'f1_val': 0.7012904835408967, 'auprc': 0.9986886743177539, 'loss_val': 0.31058204841438775, 'psi': 0.8202497598516396}
[S10] START round=11 head_norm_before_train=1.087899 cos_to_last_merge=0.9719 (last merge round=8)
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.802084477923432, 'auprc': 0.9644666693817917, 'loss_val': 0.448219980500769, 'psi': 0.8670373545067758}-{'f1_val': 0.9957455607450773, 'auprc': 0.9963473447106577, 'loss_val': 0.2645142617254198, 'psi': 0.9959862743313094}
[S11] START round=11 head_norm_before_train=1.536240 (no previous merge yet)
[S11] round=11 local utility u=0.790412 metrics={'f1_val': 0.9580598988783908, 'auprc': 0.9984268589803249, 'loss_val': 0.21548021235759668, 'psi': 0.9742066829191645}-{'f1_val': 0.7123120992880742, 'auprc': 0.9985369819216602, 'loss_val': 0.32214789228401924, 'psi': 0.8268020523415085}
[S13] START round=11 head_norm_before_train=0.871889 cos_to_last_merge=1.0000 (last merge round=10)
[S13] round=11 local utility u=0.158761 metrics={'f1_val': 0.6711642277670528, 'auprc': 0.6701299433600584, 'loss_val': 0.6533287683118069, 'psi': 0.670750514004255}-{'f1_val': 0.5885349194033582, 'auprc': 0.7454156690188553, 'loss_val': 0.7009315762992191, 'psi': 0.651287219249557}
[S14] START round=11 head_norm_before_train=0.807326 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.048153 metrics={'f1_val': 0.6920995131601254, 'auprc': 0.9949775582295348, 'loss_val': 0.6790147296224743, 'psi': 0.8132507311878892}-{'f1_val': 0.6920241227315899, 'auprc': 0.989783407441277, 'loss_val': 0.7592864057590948, 'psi': 0.8111278366154647}
[S15] START round=11 head_norm_before_train=1.681206 (no previous merge yet)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.6991566346953568, 'auprc': 0.851259535394033, 'loss_val': 0.3754451774903336, 'psi': 0.7599977949748273}-{'f1_val': 0.7085072481097228, 'auprc': 0.9770950795945224, 'loss_val': 0.2452013240536104, 'psi': 0.8159423807036426}
[S16] START round=11 head_norm_before_train=1.092766 cos_to_last_merge=0.8838 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=11 local utility u=0.019191 metrics={'f1_val': 0.35246408814235164, 'auprc': 0.7647810896409172, 'loss_val': 0.7745980582329682, 'psi': 0.5173908887417779}-{'f1_val': 0.3851866057383235, 'auprc': 0.7257297062770212, 'loss_val': 0.8921609014099893, 'psi': 0.5214038459538025}
[S17] START round=11 head_norm_before_train=1.353616 cos_to_last_merge=0.8683 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=11 local utility u=0.128310 metrics={'f1_val': 0.5929911945968794, 'auprc': 0.8987256864141988, 'loss_val': 0.6069230953549923, 'psi': 0.7152849913238072}-{'f1_val': 0.5535688037571275, 'auprc': 0.884249182289553, 'loss_val': 0.5835788654967702, 'psi': 0.6858409551700977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[S16] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.7375
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.3398
[S13] RECEIVED delta(kind=head bytes=1793) from S7
[S13] cosine check vs S7: cos=0.7795
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.6794
[S5] RECEIVED delta(kind=head bytes=1798) from S8
[S5] cosine check vs S8: cos=-0.1002
[S5] DROPPED delta from S8 (cos=-0.1002 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.2002
[S2] DROPPED delta from S11 (cos=-0.2002 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.9439
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.1693
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=-0.0781
[S7] DROPPED delta from S14 (cos=-0.0781 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.1525
[S8] DROPPED delta from S17 (cos=-0.1525 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.8021 head_norm=1.149580
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.292380e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.7654 head_norm=0.958721 delta_norm=0.429238
[S10] aggregate: ROLLBACK (f1_val pre=0.802 post=0.765 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6921 head_norm=0.858280
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.878793e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.9266 head_norm=0.876453 delta_norm=0.387879
[S14] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.6863 head_norm=1.158344
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.849723e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.6821 head_norm=1.080512 delta_norm=0.384972
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.6712 head_norm=0.940877
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.632587e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.6855 head_norm=0.990731 delta_norm=0.363259
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.668580 (no previous merge yet)
[S2] round=12 local utility u=0.732684 metrics={'f1_val': 0.9186065717329098, 'auprc': 0.9518518378782426, 'loss_val': 0.21198883394346849, 'psi': 0.931904678191043}-{'f1_val': 0.7319841776783711, 'auprc': 0.8721085452206851, 'loss_val': 0.3183930979832751, 'psi': 0.7880339246952968}
[S3] START round=12 head_norm_before_train=1.587568 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.5376723124940125, 'auprc': 0.9539340083005812, 'loss_val': 0.590673737936926, 'psi': 0.70417699081664}-{'f1_val': 0.6924948654681071, 'auprc': 0.998156441665727, 'loss_val': 0.3833395903033526, 'psi': 0.8147594959471551}
[S4] START round=12 head_norm_before_train=1.764768 (no previous merge yet)
[S4] round=12 local utility u=0.000000 metrics={'f1_val': 0.6111781316722968, 'auprc': 0.9495335807387765, 'loss_val': 0.5345370808644773, 'psi': 0.7465203112988887}-{'f1_val': 0.6132381906611037, 'auprc': 0.9458392546349377, 'loss_val': 0.533755918984545, 'psi': 0.7462786162506373}
[S5] START round=12 head_norm_before_train=1.030740 cos_to_last_merge=0.9982 (last merge round=10)
[S5] round=12 local utility u=1.000000 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8132113942098432, 'loss_val': 0.5554525278004736, 'psi': 0.7456260507900956}-{'f1_val': 0.4173841268229622, 'auprc': 0.7058577855664785, 'loss_val': 0.8037540833383917, 'psi': 0.5327735903203688}
[S6] START round=12 head_norm_before_train=1.681862 (no previous merge yet)
[S6] round=12 local utility u=0.037838 metrics={'f1_val': 0.8321718851854412, 'auprc': 0.9627881099651088, 'loss_val': 0.3298121891643557, 'psi': 0.8844183750973083}-{'f1_val': 0.8231912377961499, 'auprc': 0.9629405255940475, 'loss_val': 0.35206217139631923, 'psi': 0.879090952915309}
[S7] START round=12 head_norm_before_train=1.080512 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.113768 metrics={'f1_val': 0.7033657813851739, 'auprc': 0.7905979862825068, 'loss_val': 0.7316211630592224, 'psi': 0.7382586633441071}-{'f1_val': 0.6862939410466964, 'auprc': 0.788933430090855, 'loss_val': 0.8517314808484572, 'psi': 0.7273497366643599}
[S8] START round=12 head_norm_before_train=1.537178 cos_to_last_merge=0.8625 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.862
[S8] round=12 local utility u=0.000590 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9989236921561215, 'loss_val': 0.07485266467379599, 'psi': 0.9949075342719271}-{'f1_val': 0.994792642153961, 'auprc': 0.998924341509151, 'loss_val': 0.09140904903738023, 'psi': 0.996445321896037}
[S9] START round=12 head_norm_before_train=1.562896 (no previous merge yet)
[S9] round=12 local utility u=0.009294 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9981851378858996, 'loss_val': 0.22650894481380845, 'psi': 0.820004003618371}-{'f1_val': 0.7012165807733519, 'auprc': 0.9982309976655084, 'loss_val': 0.24523502135401853, 'psi': 0.8200223475302145}
[S10] START round=12 head_norm_before_train=0.958721 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.658274 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9929211549512765, 'loss_val': 0.37066689364045324, 'psi': 0.9937823010075635}-{'f1_val': 0.802084477923432, 'auprc': 0.9644666693817917, 'loss_val': 0.448219980500769, 'psi': 0.8670373545067758}
[S11] START round=12 head_norm_before_train=1.586166 (no previous merge yet)
[S11] round=12 local utility u=0.023785 metrics={'f1_val': 0.9597511990850949, 'auprc': 0.9983541895268253, 'loss_val': 0.17783949069897698, 'psi': 0.9751923952617871}-{'f1_val': 0.9580598988783908, 'auprc': 0.9984268589803249, 'loss_val': 0.21548021235759668, 'psi': 0.9742066829191645}
[S13] START round=12 head_norm_before_train=0.990731 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6353292936225816, 'auprc': 0.6484870742000163, 'loss_val': 0.6828070915703325, 'psi': 0.6405924058535555}-{'f1_val': 0.6711642277670528, 'auprc': 0.6701299433600584, 'loss_val': 0.6533287683118069, 'psi': 0.670750514004255}
[S14] START round=12 head_norm_before_train=0.876453 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.016301 metrics={'f1_val': 0.6923177505287506, 'auprc': 0.9960287809367954, 'loss_val': 0.6508765267881933, 'psi': 0.8138021626919685}-{'f1_val': 0.6920995131601254, 'auprc': 0.9949775582295348, 'loss_val': 0.6790147296224743, 'psi': 0.8132507311878892}
[S15] START round=12 head_norm_before_train=1.722520 (no previous merge yet)
[S15] round=12 local utility u=1.000000 metrics={'f1_val': 0.9914355028465645, 'auprc': 0.995020577351696, 'loss_val': 0.08333528092646966, 'psi': 0.992869532648617}-{'f1_val': 0.6991566346953568, 'auprc': 0.851259535394033, 'loss_val': 0.3754451774903336, 'psi': 0.7599977949748273}
[S16] START round=12 head_norm_before_train=1.138531 cos_to_last_merge=0.8710 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.871
[S16] round=12 local utility u=0.083271 metrics={'f1_val': 0.3700742020625821, 'auprc': 0.7674793827509723, 'loss_val': 0.7218125691861789, 'psi': 0.5290362743379382}-{'f1_val': 0.35246408814235164, 'auprc': 0.7647810896409172, 'loss_val': 0.7745980582329682, 'psi': 0.5173908887417779}
[S17] START round=12 head_norm_before_train=1.405729 cos_to_last_merge=0.8585 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.858
[S17] round=12 local utility u=0.550370 metrics={'f1_val': 0.7256778906226536, 'auprc': 0.9422162106087784, 'loss_val': 0.43277583211871407, 'psi': 0.8122932186171035}-{'f1_val': 0.5929911945968794, 'auprc': 0.8987256864141988, 'loss_val': 0.6069230953549923, 'psi': 0.7152849913238072}
[S11] not sending this round → trigger blocked (psi=0.975)
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] not sending this round → trigger blocked (psi=0.820)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.814)
[S16] not sending this round → trigger blocked (psi=0.529)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39803
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[S6] not sending this round → trigger blocked (psi=0.884)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S7] not sending this round → trigger blocked (psi=0.738)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=0.8837
[S14] RECEIVED delta(kind=head bytes=1800) from S15
[S14] cosine check vs S15: cos=0.4493
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0694
[S3] DROPPED delta from S5 (cos=-0.0694 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=-0.0858
[S6] DROPPED delta from S2 (cos=-0.0858 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.812)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6923 head_norm=0.921061
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.887419e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6915 head_norm=1.161997 delta_norm=0.788742
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.7006 head_norm=1.061198
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.504656e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.7006 head_norm=1.001613 delta_norm=0.250466
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.685714 (no previous merge yet)
[S2] round=13 local utility u=0.000000 metrics={'f1_val': 0.9173087823986794, 'auprc': 0.9005306651182987, 'loss_val': 0.23189487040101225, 'psi': 0.9105975354865271}-{'f1_val': 0.9186065717329098, 'auprc': 0.9518518378782426, 'loss_val': 0.21198883394346849, 'psi': 0.931904678191043}
[S3] START round=13 head_norm_before_train=1.622062 (no previous merge yet)
[S3] round=13 local utility u=0.691904 metrics={'f1_val': 0.6990764470112911, 'auprc': 0.9987552781987734, 'loss_val': 0.309754318810846, 'psi': 0.8189479794862841}-{'f1_val': 0.5376723124940125, 'auprc': 0.9539340083005812, 'loss_val': 0.590673737936926, 'psi': 0.70417699081664}
[S4] START round=13 head_norm_before_train=1.782615 (no previous merge yet)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.6117022375592673, 'auprc': 0.9494421256046818, 'loss_val': 0.5386341412335967, 'psi': 0.7467981927774332}-{'f1_val': 0.6111781316722968, 'auprc': 0.9495335807387765, 'loss_val': 0.5345370808644773, 'psi': 0.7465203112988887}
[S5] START round=13 head_norm_before_train=1.001613 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.016206 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.8204850865982802, 'loss_val': 0.5433749856368817, 'psi': 0.7483868250996604}-{'f1_val': 0.7005691551769304, 'auprc': 0.8132113942098432, 'loss_val': 0.5554525278004736, 'psi': 0.7456260507900956}
[S6] START round=13 head_norm_before_train=1.701481 (no previous merge yet)
[S6] round=13 local utility u=0.088411 metrics={'f1_val': 0.8549882636658315, 'auprc': 0.9625837091991786, 'loss_val': 0.28927559587979085, 'psi': 0.8980264418791704}-{'f1_val': 0.8321718851854412, 'auprc': 0.9627881099651088, 'loss_val': 0.3298121891643557, 'psi': 0.8844183750973083}
[S7] START round=13 head_norm_before_train=1.105163 cos_to_last_merge=0.9972 (last merge round=11)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.607666949263351, 'auprc': 0.7908253253528366, 'loss_val': 0.746827741881641, 'psi': 0.6809302996991452}-{'f1_val': 0.7033657813851739, 'auprc': 0.7905979862825068, 'loss_val': 0.7316211630592224, 'psi': 0.7382586633441071}
[S8] START round=13 head_norm_before_train=1.579280 cos_to_last_merge=0.8567 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.857
[S8] round=13 local utility u=0.003735 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9989170775807596, 'loss_val': 0.06657012722390851, 'psi': 0.9948255743283199}-{'f1_val': 0.9922300956824643, 'auprc': 0.9989236921561215, 'loss_val': 0.07485266467379599, 'psi': 0.9949075342719271}
[S9] START round=13 head_norm_before_train=1.597411 (no previous merge yet)
[S9] round=13 local utility u=0.412266 metrics={'f1_val': 0.828098229807628, 'auprc': 0.9982138134425275, 'loss_val': 0.163351976102956, 'psi': 0.8961444632615878}-{'f1_val': 0.7012165807733519, 'auprc': 0.9981851378858996, 'loss_val': 0.22650894481380845, 'psi': 0.820004003618371}
[S10] START round=13 head_norm_before_train=1.002887 cos_to_last_merge=0.9981 (last merge round=11)
[S10] round=13 local utility u=0.058903 metrics={'f1_val': 0.9931720938432163, 'auprc': 0.995974969780509, 'loss_val': 0.2549169734531095, 'psi': 0.9942932442181334}-{'f1_val': 0.9943563983784213, 'auprc': 0.9929211549512765, 'loss_val': 0.37066689364045324, 'psi': 0.9937823010075635}
[S11] START round=13 head_norm_before_train=1.631868 (no previous merge yet)
[S11] round=13 local utility u=0.133366 metrics={'f1_val': 0.9971537809852418, 'auprc': 0.9984577474207232, 'loss_val': 0.13583393243411784, 'psi': 0.9976753675594343}-{'f1_val': 0.9597511990850949, 'auprc': 0.9983541895268253, 'loss_val': 0.17783949069897698, 'psi': 0.9751923952617871}
[S13] START round=13 head_norm_before_train=1.056902 cos_to_last_merge=0.9889 (last merge round=11)
[S13] round=13 local utility u=0.027215 metrics={'f1_val': 0.6255944127576162, 'auprc': 0.6731734696627245, 'loss_val': 0.6440261903914746, 'psi': 0.6446260355196596}-{'f1_val': 0.6353292936225816, 'auprc': 0.6484870742000163, 'loss_val': 0.6828070915703325, 'psi': 0.6405924058535555}
[S14] START round=13 head_norm_before_train=1.161997 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.032823 metrics={'f1_val': 0.6911826271789014, 'auprc': 0.9978206876222265, 'loss_val': 0.5837960560585362, 'psi': 0.8138378513562314}-{'f1_val': 0.6923177505287506, 'auprc': 0.9960287809367954, 'loss_val': 0.6508765267881933, 'psi': 0.8138021626919685}
[S15] START round=13 head_norm_before_train=1.759645 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.9911506053710105, 'auprc': 0.9930103034446034, 'loss_val': 0.07912533405192847, 'psi': 0.9918944846004476}-{'f1_val': 0.9914355028465645, 'auprc': 0.995020577351696, 'loss_val': 0.08333528092646966, 'psi': 0.992869532648617}
[S16] START round=13 head_norm_before_train=1.183590 cos_to_last_merge=0.8605 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=13 local utility u=0.236823 metrics={'f1_val': 0.44469587168915037, 'auprc': 0.7697538020354011, 'loss_val': 0.7027203800865106, 'psi': 0.5747190438276506}-{'f1_val': 0.3700742020625821, 'auprc': 0.7674793827509723, 'loss_val': 0.7218125691861789, 'psi': 0.5290362743379382}
[S17] START round=13 head_norm_before_train=1.458463 cos_to_last_merge=0.8489 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.5966796237677079, 'auprc': 0.8295899864730254, 'loss_val': 0.8659497339991753, 'psi': 0.6898437688498349}-{'f1_val': 0.7256778906226536, 'auprc': 0.9422162106087784, 'loss_val': 0.43277583211871407, 'psi': 0.8122932186171035}
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S5] not sending this round → trigger blocked (psi=0.748)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39805
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39811
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.0876
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=0.5791
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.7742
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=-0.2029
[S2] DROPPED delta from S11 (cos=-0.2029 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=-0.1002
[S5] DROPPED delta from S8 (cos=-0.1002 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1807) from S9
[S7] cosine check vs S9: cos=0.8264
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.0913
[S7] DROPPED delta from S14 (cos=-0.0913 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.4720
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.6077 head_norm=1.131971
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.335841e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5853 head_norm=1.130422 delta_norm=0.233584
[S7] aggregate: ROLLBACK (f1_val pre=0.608 post=0.585 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.9932 head_norm=1.070644
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.725443e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.9934 head_norm=1.040482 delta_norm=0.372544
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.6912 head_norm=1.194785
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.999040e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.6910 head_norm=0.934398 delta_norm=0.599904
[S14] aggregate: ACCEPT kept=['S3', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.702259 (no previous merge yet)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.8916447440329722, 'auprc': 0.9288723071144729, 'loss_val': 0.23538692215068394, 'psi': 0.9065357692655724}-{'f1_val': 0.9173087823986794, 'auprc': 0.9005306651182987, 'loss_val': 0.23189487040101225, 'psi': 0.9105975354865271}
[S3] START round=14 head_norm_before_train=1.654873 (no previous merge yet)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.683989201734863, 'auprc': 0.9992069999874517, 'loss_val': 0.33594083468749747, 'psi': 0.8100763210358985}-{'f1_val': 0.6990764470112911, 'auprc': 0.9987552781987734, 'loss_val': 0.309754318810846, 'psi': 0.8189479794862841}
[S4] START round=14 head_norm_before_train=1.793515 (no previous merge yet)
[S4] round=14 local utility u=0.003317 metrics={'f1_val': 0.6120369391407324, 'auprc': 0.9513688033778898, 'loss_val': 0.5397876520820472, 'psi': 0.7477696848355954}-{'f1_val': 0.6117022375592673, 'auprc': 0.9494421256046818, 'loss_val': 0.5386341412335967, 'psi': 0.7467981927774332}
[S5] START round=14 head_norm_before_train=1.041933 cos_to_last_merge=0.9979 (last merge round=12)
[S5] round=14 local utility u=0.104162 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8611067693620752, 'loss_val': 0.45840310744451374, 'psi': 0.7647842008509884}-{'f1_val': 0.7003213174339138, 'auprc': 0.8204850865982802, 'loss_val': 0.5433749856368817, 'psi': 0.7483868250996604}
[S6] START round=14 head_norm_before_train=1.727531 (no previous merge yet)
[S6] round=14 local utility u=0.083745 metrics={'f1_val': 0.8947337914250586, 'auprc': 0.9431547514763202, 'loss_val': 0.3019712709417535, 'psi': 0.9141021754455633}-{'f1_val': 0.8549882636658315, 'auprc': 0.9625837091991786, 'loss_val': 0.28927559587979085, 'psi': 0.8980264418791704}
[S7] START round=14 head_norm_before_train=1.130422 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.4997419802581463, 'auprc': 0.6422497231445856, 'loss_val': 0.9079316221583584, 'psi': 0.5567450774127221}-{'f1_val': 0.607666949263351, 'auprc': 0.7908253253528366, 'loss_val': 0.746827741881641, 'psi': 0.6809302996991452}
[S8] START round=14 head_norm_before_train=1.621772 cos_to_last_merge=0.8511 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.851
[S8] round=14 local utility u=0.006134 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9988912756885909, 'loss_val': 0.057257918862311, 'psi': 0.99511863255398}-{'f1_val': 0.9920979054933599, 'auprc': 0.9989170775807596, 'loss_val': 0.06657012722390851, 'psi': 0.9948255743283199}
[S9] START round=14 head_norm_before_train=1.628805 (no previous merge yet)
[S9] round=14 local utility u=0.492018 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9982115428583845, 'loss_val': 0.1453054897539493, 'psi': 0.9927431260558138}-{'f1_val': 0.828098229807628, 'auprc': 0.9982138134425275, 'loss_val': 0.163351976102956, 'psi': 0.8961444632615878}
[S10] START round=14 head_norm_before_train=1.040482 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9931498852658371, 'loss_val': 0.31884689124135235, 'psi': 0.9938737931333876}-{'f1_val': 0.9931720938432163, 'auprc': 0.995974969780509, 'loss_val': 0.2549169734531095, 'psi': 0.9942932442181334}
[S11] START round=14 head_norm_before_train=1.671650 (no previous merge yet)
[S11] round=14 local utility u=0.007597 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9983115370066136, 'loss_val': 0.11771474007411749, 'psi': 0.9973682895763094}-{'f1_val': 0.9971537809852418, 'auprc': 0.9984577474207232, 'loss_val': 0.13583393243411784, 'psi': 0.9976753675594343}
[S13] START round=14 head_norm_before_train=1.138642 cos_to_last_merge=0.9653 (last merge round=11)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6274502110555875, 'auprc': 0.6579272586184314, 'loss_val': 0.6772212801934181, 'psi': 0.639641030080725}-{'f1_val': 0.6255944127576162, 'auprc': 0.6731734696627245, 'loss_val': 0.6440261903914746, 'psi': 0.6446260355196596}
[S14] START round=14 head_norm_before_train=0.934398 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.011446 metrics={'f1_val': 0.6923150107463425, 'auprc': 0.9981006736179472, 'loss_val': 0.5685383022493442, 'psi': 0.8146292758949844}-{'f1_val': 0.6911826271789014, 'auprc': 0.9978206876222265, 'loss_val': 0.5837960560585362, 'psi': 0.8138378513562314}
[S15] START round=14 head_norm_before_train=1.792316 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.9185942882953135, 'auprc': 0.9887643579808023, 'loss_val': 0.1302740769354563, 'psi': 0.9466623161695091}-{'f1_val': 0.9911506053710105, 'auprc': 0.9930103034446034, 'loss_val': 0.07912533405192847, 'psi': 0.9918944846004476}
[S16] START round=14 head_norm_before_train=1.233136 cos_to_last_merge=0.8511 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.851
[S16] round=14 local utility u=0.287141 metrics={'f1_val': 0.5239744367944897, 'auprc': 0.8005314144896212, 'loss_val': 0.6964420649648979, 'psi': 0.6345972278725424}-{'f1_val': 0.44469587168915037, 'auprc': 0.7697538020354011, 'loss_val': 0.7027203800865106, 'psi': 0.5747190438276506}
[S17] START round=14 head_norm_before_train=1.491849 cos_to_last_merge=0.8427 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=14 local utility u=0.158663 metrics={'f1_val': 0.6198332772883914, 'auprc': 0.8672664959867501, 'loss_val': 0.8005758983983445, 'psi': 0.7188065647677349}-{'f1_val': 0.5966796237677079, 'auprc': 0.8295899864730254, 'loss_val': 0.8659497339991753, 'psi': 0.6898437688498349}
[S9] not sending this round → trigger blocked (psi=0.993)
[S14] not sending this round → trigger blocked (psi=0.815)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S16] not sending this round → trigger blocked (psi=0.635)
[S6] not sending this round → trigger blocked (psi=0.914)
[S11] not sending this round → trigger blocked (psi=0.997)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0834
[S3] DROPPED delta from S5 (cos=-0.0834 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1802) from S4
[S14] cosine check vs S4: cos=0.2228
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.1461
[S8] DROPPED delta from S17 (cos=-0.1461 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.6923 head_norm=0.966478
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.272060e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9973 head_norm=1.118044 delta_norm=0.927206
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.726905 (no previous merge yet)
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.9153637363989191, 'auprc': 0.8541213746726407, 'loss_val': 0.23803448485866574, 'psi': 0.8908667917084077}-{'f1_val': 0.8916447440329722, 'auprc': 0.9288723071144729, 'loss_val': 0.23538692215068394, 'psi': 0.9065357692655724}
[S3] START round=15 head_norm_before_train=1.684634 (no previous merge yet)
[S3] round=15 local utility u=0.000000 metrics={'f1_val': 0.5489862268424732, 'auprc': 0.9006328867520873, 'loss_val': 0.6286678567347297, 'psi': 0.6896448908063189}-{'f1_val': 0.683989201734863, 'auprc': 0.9992069999874517, 'loss_val': 0.33594083468749747, 'psi': 0.8100763210358985}
[S4] START round=15 head_norm_before_train=1.812564 (no previous merge yet)
[S4] round=15 local utility u=0.009128 metrics={'f1_val': 0.6138105463390323, 'auprc': 0.9457411048095157, 'loss_val': 0.515290753285797, 'psi': 0.7465827697272256}-{'f1_val': 0.6120369391407324, 'auprc': 0.9513688033778898, 'loss_val': 0.5397876520820472, 'psi': 0.7477696848355954}
[S5] START round=15 head_norm_before_train=1.091337 cos_to_last_merge=0.9927 (last merge round=12)
[S5] round=15 local utility u=0.242562 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9933456421539578, 'loss_val': 0.3699953774163708, 'psi': 0.8176797499677414}-{'f1_val': 0.7005691551769304, 'auprc': 0.8611067693620752, 'loss_val': 0.45840310744451374, 'psi': 0.7647842008509884}
[S6] START round=15 head_norm_before_train=1.749062 (no previous merge yet)
[S6] round=15 local utility u=0.069454 metrics={'f1_val': 0.9045014307035724, 'auprc': 0.9604331718020865, 'loss_val': 0.2735048439641874, 'psi': 0.9268741271429781}-{'f1_val': 0.8947337914250586, 'auprc': 0.9431547514763202, 'loss_val': 0.3019712709417535, 'psi': 0.9141021754455633}
[S7] START round=15 head_norm_before_train=1.155944 cos_to_last_merge=0.9985 (last merge round=13)
[S7] round=15 local utility u=0.651725 metrics={'f1_val': 0.6046251330353501, 'auprc': 0.7914953350218901, 'loss_val': 0.6815167329587908, 'psi': 0.6793732138299662}-{'f1_val': 0.4997419802581463, 'auprc': 0.6422497231445856, 'loss_val': 0.9079316221583584, 'psi': 0.5567450774127221}
[S8] START round=15 head_norm_before_train=1.658770 cos_to_last_merge=0.8473 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.847
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.9889889874193012, 'auprc': 0.9988476994507915, 'loss_val': 0.05472305304301238, 'psi': 0.9929324722318974}-{'f1_val': 0.9926035371309061, 'auprc': 0.9988912756885909, 'loss_val': 0.057257918862311, 'psi': 0.99511863255398}
[S9] START round=15 head_norm_before_train=1.660290 (no previous merge yet)
[S9] round=15 local utility u=0.021102 metrics={'f1_val': 0.9895217784513768, 'auprc': 0.9982112534590324, 'loss_val': 0.10564681414809854, 'psi': 0.992997568454439}-{'f1_val': 0.9890975148541, 'auprc': 0.9982115428583845, 'loss_val': 0.1453054897539493, 'psi': 0.9927431260558138}
[S10] START round=15 head_norm_before_train=1.110252 cos_to_last_merge=0.9949 (last merge round=13)
[S10] round=15 local utility u=0.063671 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9949780628699374, 'loss_val': 0.1993424874266288, 'psi': 0.9948403906795984}-{'f1_val': 0.9943563983784213, 'auprc': 0.9931498852658371, 'loss_val': 0.31884689124135235, 'psi': 0.9938737931333876}
[S11] START round=15 head_norm_before_train=1.706822 (no previous merge yet)
[S11] round=15 local utility u=0.011242 metrics={'f1_val': 0.9967189926998994, 'auprc': 0.9981769777300828, 'loss_val': 0.09470489928158855, 'psi': 0.9973021867119727}-{'f1_val': 0.9967394579561065, 'auprc': 0.9983115370066136, 'loss_val': 0.11771474007411749, 'psi': 0.9973682895763094}
[S13] START round=15 head_norm_before_train=1.206082 cos_to_last_merge=0.9447 (last merge round=11)
[S13] ⚠️ Model drifted since last merge! cos=0.945
[S13] round=15 local utility u=0.019571 metrics={'f1_val': 0.6179214514811375, 'auprc': 0.6853466332078471, 'loss_val': 0.663165683463788, 'psi': 0.6448915241718214}-{'f1_val': 0.6274502110555875, 'auprc': 0.6579272586184314, 'loss_val': 0.6772212801934181, 'psi': 0.639641030080725}
[S14] START round=15 head_norm_before_train=1.118044 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.916157 metrics={'f1_val': 0.9933931841162156, 'auprc': 0.9987104844561875, 'loss_val': 0.5445235234217195, 'psi': 0.9955201042522044}-{'f1_val': 0.6923150107463425, 'auprc': 0.9981006736179472, 'loss_val': 0.5685383022493442, 'psi': 0.8146292758949844}
[S15] START round=15 head_norm_before_train=1.823776 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.8092345201463889, 'auprc': 0.9879518343388258, 'loss_val': 0.24997425909283447, 'psi': 0.8807214458233636}-{'f1_val': 0.9185942882953135, 'auprc': 0.9887643579808023, 'loss_val': 0.1302740769354563, 'psi': 0.9466623161695091}
[S16] START round=15 head_norm_before_train=1.280943 cos_to_last_merge=0.8428 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=15 local utility u=0.207767 metrics={'f1_val': 0.5736973010867801, 'auprc': 0.8198853114485127, 'loss_val': 0.6373069576612433, 'psi': 0.6721725052314731}-{'f1_val': 0.5239744367944897, 'auprc': 0.8005314144896212, 'loss_val': 0.6964420649648979, 'psi': 0.6345972278725424}
[S17] START round=15 head_norm_before_train=1.517090 cos_to_last_merge=0.8382 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=15 local utility u=0.133070 metrics={'f1_val': 0.6350531252370724, 'auprc': 0.9031232834097538, 'loss_val': 0.7333261218390861, 'psi': 0.7422811885061449}-{'f1_val': 0.6198332772883914, 'auprc': 0.8672664959867501, 'loss_val': 0.8005758983983445, 'psi': 0.7188065647677349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[S9] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.3063
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.8958
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.8761
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=0.8877
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=0.6026
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=-0.2082
[S2] DROPPED delta from S11 (cos=-0.2082 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0871
[S3] DROPPED delta from S5 (cos=-0.0871 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.7155
[S7] RECEIVED delta(kind=head bytes=1795) from S9
[S7] cosine check vs S9: cos=0.7463
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=-0.1013
[S7] DROPPED delta from S14 (cos=-0.1013 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.1447
[S8] DROPPED delta from S17 (cos=-0.1447 < 0.0)
[S3] ⇄ pheromone p=0.229 → S14@127.0.0.1:39814
[S8] ⇄ pheromone p=0.159 → S5@127.0.0.1:39805
[S2] ⇄ pheromone p=0.203 → S6@127.0.0.1:39807
[S11] ⇄ pheromone p=0.210 → S2@127.0.0.1:39802
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9947 head_norm=1.191412
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.902458e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.9950 head_norm=1.184598 delta_norm=0.290246
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.241 → S5@127.0.0.1:39805
[S9] ⇄ pheromone p=0.260 → S7@127.0.0.1:39808
[S6] ⇄ pheromone p=0.247 → S7@127.0.0.1:39808
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9934 head_norm=1.144987
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.477609e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9971 head_norm=1.107530 delta_norm=0.247761
[S14] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.355 → S7@127.0.0.1:39808
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6046 head_norm=1.182705
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.710167e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.5907 head_norm=1.184947 delta_norm=0.171017
[S7] aggregate: ROLLBACK (f1_val pre=0.605 post=0.591 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.277 → S13@127.0.0.1:39813
[S4] ⇄ pheromone p=0.083 → S14@127.0.0.1:39814
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=15 metric=0.7006 head_norm=1.132662
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.905737e-01
[S5] stored merged vector for next round verification (round=15)
[S5] DEBUG after merge:  round=15 metric=0.7006 head_norm=1.125504 delta_norm=0.290574
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.277 → S3@127.0.0.1:39803
[S16] ⇄ pheromone p=0.214 → S14@127.0.0.1:39814
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.6179 head_norm=1.247225
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.592153e-01
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6164 head_norm=1.125301 delta_norm=0.459215
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.104 → S10@127.0.0.1:39811
[S15] ⇄ pheromone p=0.221 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.234 → S8@127.0.0.1:39809
[S2] START round=16 head_norm_before_train=1.757119 (no previous merge yet)
[S2] round=16 local utility u=0.115139 metrics={'f1_val': 0.9067976684340813, 'auprc': 0.9433725091212509, 'loss_val': 0.22411416116563926, 'psi': 0.9214276047089491}-{'f1_val': 0.9153637363989191, 'auprc': 0.8541213746726407, 'loss_val': 0.23803448485866574, 'psi': 0.8908667917084077}
[S3] START round=16 head_norm_before_train=1.709431 (no previous merge yet)
[S3] round=16 local utility u=0.720910 metrics={'f1_val': 0.6873613350726552, 'auprc': 0.9992069999874518, 'loss_val': 0.31281998647690107, 'psi': 0.8120996010385738}-{'f1_val': 0.5489862268424732, 'auprc': 0.9006328867520873, 'loss_val': 0.6286678567347297, 'psi': 0.6896448908063189}
[S4] START round=16 head_norm_before_train=1.817765 (no previous merge yet)
[S4] round=16 local utility u=0.001205 metrics={'f1_val': 0.6127153599475031, 'auprc': 0.9465339426012995, 'loss_val': 0.5086887034927834, 'psi': 0.7462427930090217}-{'f1_val': 0.6138105463390323, 'auprc': 0.9457411048095157, 'loss_val': 0.515290753285797, 'psi': 0.7465827697272256}
[S5] START round=16 head_norm_before_train=1.125504 cos_to_last_merge=1.0000 (last merge round=15)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.42358075108354704, 'auprc': 0.8526458052603545, 'loss_val': 0.8583050952721117, 'psi': 0.59520677275427}-{'f1_val': 0.7005691551769304, 'auprc': 0.9933456421539578, 'loss_val': 0.3699953774163708, 'psi': 0.8176797499677414}
[S6] START round=16 head_norm_before_train=1.766419 (no previous merge yet)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.5975282897330799, 'auprc': 0.8155083914662979, 'loss_val': 0.9182900038494906, 'psi': 0.6847203304263672}-{'f1_val': 0.9045014307035724, 'auprc': 0.9604331718020865, 'loss_val': 0.2735048439641874, 'psi': 0.9268741271429781}
[S7] START round=16 head_norm_before_train=1.184947 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.573069044982192, 'auprc': 0.7485633154020477, 'loss_val': 0.7538037216154188, 'psi': 0.6432667531501343}-{'f1_val': 0.6046251330353501, 'auprc': 0.7914953350218901, 'loss_val': 0.6815167329587908, 'psi': 0.6793732138299662}
[S8] START round=16 head_norm_before_train=1.699365 cos_to_last_merge=0.8423 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.842
[S8] round=16 local utility u=0.002551 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9900482811326176, 'loss_val': 0.04511070427641209, 'psi': 0.9916014067890153}-{'f1_val': 0.9889889874193012, 'auprc': 0.9988476994507915, 'loss_val': 0.05472305304301238, 'psi': 0.9929324722318974}
[S9] START round=16 head_norm_before_train=1.688802 (no previous merge yet)
[S9] round=16 local utility u=0.022709 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9985457711364549, 'loss_val': 0.07649287938676116, 'psi': 0.9946575005826179}-{'f1_val': 0.9895217784513768, 'auprc': 0.9982112534590324, 'loss_val': 0.10564681414809854, 'psi': 0.992997568454439}
[S10] START round=16 head_norm_before_train=1.184598 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9916968184708301, 'loss_val': 0.24476454509163303, 'psi': 0.9932925664153849}-{'f1_val': 0.9947486092193725, 'auprc': 0.9949780628699374, 'loss_val': 0.1993424874266288, 'psi': 0.9948403906795984}
[S11] START round=16 head_norm_before_train=1.738535 (no previous merge yet)
[S11] round=16 local utility u=0.002094 metrics={'f1_val': 0.9967394579561065, 'auprc': 0.9981962574554691, 'loss_val': 0.09069753931003137, 'psi': 0.9973221777558516}-{'f1_val': 0.9967189926998994, 'auprc': 0.9981769777300828, 'loss_val': 0.09470489928158855, 'psi': 0.9973021867119727}
[S13] START round=16 head_norm_before_train=1.125301 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6199586426010166, 'auprc': 0.6429197815467542, 'loss_val': 0.7069022884293156, 'psi': 0.6291430981793117}-{'f1_val': 0.6179214514811375, 'auprc': 0.6853466332078471, 'loss_val': 0.663165683463788, 'psi': 0.6448915241718214}
[S14] START round=16 head_norm_before_train=1.107530 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.027284 metrics={'f1_val': 0.9917004832121963, 'auprc': 0.9986297427410353, 'loss_val': 0.47955623588854895, 'psi': 0.9944721870237319}-{'f1_val': 0.9933931841162156, 'auprc': 0.9987104844561875, 'loss_val': 0.5445235234217195, 'psi': 0.9955201042522044}
[S15] START round=16 head_norm_before_train=1.851786 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.7005982860956178, 'auprc': 0.9534523307876737, 'loss_val': 0.45260424592915, 'psi': 0.8017399039724402}-{'f1_val': 0.8092345201463889, 'auprc': 0.9879518343388258, 'loss_val': 0.24997425909283447, 'psi': 0.8807214458233636}
[S16] START round=16 head_norm_before_train=1.328654 cos_to_last_merge=0.8345 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=16 local utility u=0.028431 metrics={'f1_val': 0.5677465403629864, 'auprc': 0.8432651861510846, 'loss_val': 0.6148797409489778, 'psi': 0.6779539986782257}-{'f1_val': 0.5736973010867801, 'auprc': 0.8198853114485127, 'loss_val': 0.6373069576612433, 'psi': 0.6721725052314731}
[S17] START round=16 head_norm_before_train=1.538714 cos_to_last_merge=0.8346 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=16 local utility u=1.000000 metrics={'f1_val': 0.9023328151674962, 'auprc': 0.9884043481356258, 'loss_val': 0.23323574112897302, 'psi': 0.9367614283547481}-{'f1_val': 0.6350531252370724, 'auprc': 0.9031232834097538, 'loss_val': 0.7333261218390861, 'psi': 0.7422811885061449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[S14] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → trigger blocked (psi=0.678)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.746)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:39814
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S2
[S6] cosine check vs S2: cos=-0.0859
[S6] DROPPED delta from S2 (cos=-0.0859 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=-0.0991
[S5] DROPPED delta from S8 (cos=-0.0991 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1806) from S3
[S14] cosine check vs S3: cos=0.1588
[S17] not sending this round → trigger blocked (psi=0.937)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9917 head_norm=1.138362
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.580353e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.6904 head_norm=1.109510 delta_norm=0.958035
[S14] aggregate: ROLLBACK (f1_val pre=0.992 post=0.690 tol_abs=0.005 tol_rel=0.0)
[S2] START round=17 head_norm_before_train=1.782559 (no previous merge yet)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.8951243633908659, 'auprc': 0.9235105712441268, 'loss_val': 0.23836604712076384, 'psi': 0.9064788465321703}-{'f1_val': 0.9067976684340813, 'auprc': 0.9433725091212509, 'loss_val': 0.22411416116563926, 'psi': 0.9214276047089491}
[S3] START round=17 head_norm_before_train=1.732576 (no previous merge yet)
[S3] round=17 local utility u=0.059306 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9992069999874517, 'loss_val': 0.2720249450241907, 'psi': 0.8198813514068979}-{'f1_val': 0.6873613350726552, 'auprc': 0.9992069999874518, 'loss_val': 0.31281998647690107, 'psi': 0.8120996010385738}
[S4] START round=17 head_norm_before_train=1.824209 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.6122341153027709, 'auprc': 0.9491671779074621, 'loss_val': 0.5195219575692793, 'psi': 0.7470073403446474}-{'f1_val': 0.6127153599475031, 'auprc': 0.9465339426012995, 'loss_val': 0.5086887034927834, 'psi': 0.7462427930090217}
[S5] START round=17 head_norm_before_train=1.156062 cos_to_last_merge=0.9993 (last merge round=15)
[S5] round=17 local utility u=0.010008 metrics={'f1_val': 0.42929589660546286, 'auprc': 0.8533276927639364, 'loss_val': 0.8746252494926459, 'psi': 0.5989086150688523}-{'f1_val': 0.42358075108354704, 'auprc': 0.8526458052603545, 'loss_val': 0.8583050952721117, 'psi': 0.59520677275427}
[S6] START round=17 head_norm_before_train=1.775072 (no previous merge yet)
[S6] round=17 local utility u=1.000000 metrics={'f1_val': 0.8414692843334877, 'auprc': 0.9579347771930531, 'loss_val': 0.3294093375616492, 'psi': 0.8880554814773138}-{'f1_val': 0.5975282897330799, 'auprc': 0.8155083914662979, 'loss_val': 0.9182900038494906, 'psi': 0.6847203304263672}
[S7] START round=17 head_norm_before_train=1.210065 cos_to_last_merge=0.9990 (last merge round=15)
[S7] round=17 local utility u=0.511544 metrics={'f1_val': 0.6838945014301976, 'auprc': 0.7881604776048731, 'loss_val': 0.5144607536036861, 'psi': 0.7256008919000678}-{'f1_val': 0.573069044982192, 'auprc': 0.7485633154020477, 'loss_val': 0.7538037216154188, 'psi': 0.6432667531501343}
[S8] START round=17 head_norm_before_train=1.735624 cos_to_last_merge=0.8378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.838
[S8] round=17 local utility u=0.011636 metrics={'f1_val': 0.9918763177247631, 'auprc': 0.9989156570095483, 'loss_val': 0.043877641886591226, 'psi': 0.9946920534386772}-{'f1_val': 0.9926368238932805, 'auprc': 0.9900482811326176, 'loss_val': 0.04511070427641209, 'psi': 0.9916014067890153}
[S9] START round=17 head_norm_before_train=1.716507 (no previous merge yet)
[S9] round=17 local utility u=0.008152 metrics={'f1_val': 0.9920653202133933, 'auprc': 0.9988490721577408, 'loss_val': 0.061098201014920646, 'psi': 0.9947788209911324}-{'f1_val': 0.9920653202133933, 'auprc': 0.9985457711364549, 'loss_val': 0.07649287938676116, 'psi': 0.9946575005826179}
[S10] START round=17 head_norm_before_train=1.260257 cos_to_last_merge=0.9955 (last merge round=15)
[S10] round=17 local utility u=0.043880 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.991985217777977, 'loss_val': 0.16285754513799136, 'psi': 0.9939067905228156}-{'f1_val': 0.9943563983784213, 'auprc': 0.9916968184708301, 'loss_val': 0.24476454509163303, 'psi': 0.9932925664153849}
[S11] START round=17 head_norm_before_train=1.766127 (no previous merge yet)
[S11] round=17 local utility u=0.005471 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9982190099474471, 'loss_val': 0.07734003908308516, 'psi': 0.9970829837920465}-{'f1_val': 0.9967394579561065, 'auprc': 0.9981962574554691, 'loss_val': 0.09069753931003137, 'psi': 0.9973221777558516}
[S13] START round=17 head_norm_before_train=1.159180 cos_to_last_merge=0.9985 (last merge round=15)
[S13] round=17 local utility u=0.058544 metrics={'f1_val': 0.631094555429539, 'auprc': 0.6495647624749523, 'loss_val': 0.6765647748983161, 'psi': 0.6384826382477042}-{'f1_val': 0.6199586426010166, 'auprc': 0.6429197815467542, 'loss_val': 0.7069022884293156, 'psi': 0.6291430981793117}
[S14] START round=17 head_norm_before_train=1.109510 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.000000 metrics={'f1_val': 0.6908401486114478, 'auprc': 0.996830301735296, 'loss_val': 0.48953104706540146, 'psi': 0.8132362098609871}-{'f1_val': 0.9917004832121963, 'auprc': 0.9986297427410353, 'loss_val': 0.47955623588854895, 'psi': 0.9944721870237319}
[S15] START round=17 head_norm_before_train=1.882091 (no previous merge yet)
[S15] round=17 local utility u=1.000000 metrics={'f1_val': 0.9838638602515976, 'auprc': 0.9984070556866067, 'loss_val': 0.08344957362744901, 'psi': 0.9896811384256012}-{'f1_val': 0.7005982860956178, 'auprc': 0.9534523307876737, 'loss_val': 0.45260424592915, 'psi': 0.8017399039724402}
[S16] START round=17 head_norm_before_train=1.370113 cos_to_last_merge=0.8274 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.827
[S16] round=17 local utility u=0.897145 metrics={'f1_val': 0.852226475470268, 'auprc': 0.8738620606607841, 'loss_val': 0.6192605126646701, 'psi': 0.8608807095464744}-{'f1_val': 0.5677465403629864, 'auprc': 0.8432651861510846, 'loss_val': 0.6148797409489778, 'psi': 0.6779539986782257}
[S17] START round=17 head_norm_before_train=1.571722 cos_to_last_merge=0.8302 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.6014515738989521, 'auprc': 0.6628803879724741, 'loss_val': 1.0463775775271562, 'psi': 0.6260230995283609}-{'f1_val': 0.9023328151674962, 'auprc': 0.9884043481356258, 'loss_val': 0.23323574112897302, 'psi': 0.9367614283547481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39811
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.0910
[S3] DROPPED delta from S5 (cos=-0.0910 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.6558
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.1001
[S5] DROPPED delta from S8 (cos=-0.1001 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1797) from S7
[S13] cosine check vs S7: cos=0.8497
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.7090
[S14] RECEIVED delta(kind=head bytes=1802) from S15
[S14] cosine check vs S15: cos=0.1643
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=-0.2115
[S2] DROPPED delta from S11 (cos=-0.2115 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=0.9278
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.8731
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=0.8509
[S14] RECEIVED delta(kind=head bytes=1797) from S16
[S14] cosine check vs S16: cos=0.2308
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=17 metric=0.6908 head_norm=1.138573
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.362269e-01
[S14] stored merged vector for next round verification (round=17)
[S14] DEBUG after merge:  round=17 metric=0.9864 head_norm=0.979663 delta_norm=0.536227
[S14] aggregate: ACCEPT kept=['S15', 'S3', 'S16'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.6839 head_norm=1.237852
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.441905e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.6813 head_norm=1.228590 delta_norm=0.144191
[S7] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.9952 head_norm=1.328777
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.251515e-01
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.9952 head_norm=1.231560 delta_norm=0.325151
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.4293 head_norm=1.180089
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.492096e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.4317 head_norm=1.231675 delta_norm=0.249210
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.6311 head_norm=1.216255
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.365237e-01
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.6298 head_norm=1.180054 delta_norm=0.336524
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.804940 (no previous merge yet)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.833338835914274, 'auprc': 0.9341314401862594, 'loss_val': 0.31325347889620614, 'psi': 0.8736558776230682}-{'f1_val': 0.8951243633908659, 'auprc': 0.9235105712441268, 'loss_val': 0.23836604712076384, 'psi': 0.9064788465321703}
[S3] START round=18 head_norm_before_train=1.751711 (no previous merge yet)
[S3] round=18 local utility u=0.002616 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9994158611744874, 'loss_val': 0.2674193915884785, 'psi': 0.8199648958817122}-{'f1_val': 0.700330919019862, 'auprc': 0.9992069999874517, 'loss_val': 0.2720249450241907, 'psi': 0.8198813514068979}
[S4] START round=18 head_norm_before_train=1.844419 (no previous merge yet)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6152971312548369, 'auprc': 0.9216844218044686, 'loss_val': 0.5080348100794374, 'psi': 0.7378520474746896}-{'f1_val': 0.6122341153027709, 'auprc': 0.9491671779074621, 'loss_val': 0.5195219575692793, 'psi': 0.7470073403446474}
[S5] START round=18 head_norm_before_train=1.231675 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9890948265666307, 'loss_val': 0.3827146371585197, 'psi': 0.8158307210870006}-{'f1_val': 0.42929589660546286, 'auprc': 0.8533276927639364, 'loss_val': 0.8746252494926459, 'psi': 0.5989086150688523}
[S6] START round=18 head_norm_before_train=1.782856 (no previous merge yet)
[S6] round=18 local utility u=0.338185 metrics={'f1_val': 0.935381640750028, 'auprc': 0.9565191843841496, 'loss_val': 0.21226735789912052, 'psi': 0.9438366582036767}-{'f1_val': 0.8414692843334877, 'auprc': 0.9579347771930531, 'loss_val': 0.3294093375616492, 'psi': 0.8880554814773138}
[S7] START round=18 head_norm_before_train=1.228590 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.4960583847346775, 'auprc': 0.6371084641540173, 'loss_val': 0.9692149492740157, 'psi': 0.5524784165024135}-{'f1_val': 0.6838945014301976, 'auprc': 0.7881604776048731, 'loss_val': 0.5144607536036861, 'psi': 0.7256008919000678}
[S8] START round=18 head_norm_before_train=1.768191 cos_to_last_merge=0.8344 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.834
[S8] round=18 local utility u=0.000604 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9974791206229713, 'loss_val': 0.04073601462748712, 'psi': 0.9943550921651017}-{'f1_val': 0.9918763177247631, 'auprc': 0.9989156570095483, 'loss_val': 0.043877641886591226, 'psi': 0.9946920534386772}
[S9] START round=18 head_norm_before_train=1.743172 (no previous merge yet)
[S9] round=18 local utility u=0.004216 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9988515858013957, 'loss_val': 0.05117142949658191, 'psi': 0.9946296307605919}-{'f1_val': 0.9920653202133933, 'auprc': 0.9988490721577408, 'loss_val': 0.061098201014920646, 'psi': 0.9947788209911324}
[S10] START round=18 head_norm_before_train=1.231560 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.9933667052737687, 'auprc': 0.9960463899490543, 'loss_val': 0.1861141740989534, 'psi': 0.9944385791438829}-{'f1_val': 0.9951878390193748, 'auprc': 0.991985217777977, 'loss_val': 0.16285754513799136, 'psi': 0.9939067905228156}
[S11] START round=18 head_norm_before_train=1.791053 (no previous merge yet)
[S11] round=18 local utility u=0.005422 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9981800649334045, 'loss_val': 0.06625588952595894, 'psi': 0.9970551264546783}-{'f1_val': 0.9963256330217796, 'auprc': 0.9982190099474471, 'loss_val': 0.07734003908308516, 'psi': 0.9970829837920465}
[S13] START round=18 head_norm_before_train=1.180054 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5782316368086994, 'auprc': 0.5447493506439718, 'loss_val': 0.8629850844179491, 'psi': 0.5648387223428084}-{'f1_val': 0.631094555429539, 'auprc': 0.6495647624749523, 'loss_val': 0.6765647748983161, 'psi': 0.6384826382477042}
[S14] START round=18 head_norm_before_train=0.979663 cos_to_last_merge=1.0000 (last merge round=17)
[S14] round=18 local utility u=0.941993 metrics={'f1_val': 0.9861237138721632, 'auprc': 0.9986412555785349, 'loss_val': 0.3826785936680561, 'psi': 0.9911307305547119}-{'f1_val': 0.6908401486114478, 'auprc': 0.996830301735296, 'loss_val': 0.48953104706540146, 'psi': 0.8132362098609871}
[S15] START round=18 head_norm_before_train=1.901646 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6977164334685135, 'auprc': 0.8600585021495648, 'loss_val': 0.5667763224073642, 'psi': 0.762653260940934}-{'f1_val': 0.9838638602515976, 'auprc': 0.9984070556866067, 'loss_val': 0.08344957362744901, 'psi': 0.9896811384256012}
[S16] START round=18 head_norm_before_train=1.413540 cos_to_last_merge=0.8206 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=18 local utility u=0.335624 metrics={'f1_val': 0.9059365733678931, 'auprc': 0.9197773480109932, 'loss_val': 0.40801933807507695, 'psi': 0.9114728832251332}-{'f1_val': 0.852226475470268, 'auprc': 0.8738620606607841, 'loss_val': 0.6192605126646701, 'psi': 0.8608807095464744}
[S17] START round=18 head_norm_before_train=1.594304 cos_to_last_merge=0.8269 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=18 local utility u=1.000000 metrics={'f1_val': 0.8199278584202246, 'auprc': 0.9499579578458884, 'loss_val': 0.320657204887328, 'psi': 0.8719398981904902}-{'f1_val': 0.6014515738989521, 'auprc': 0.6628803879724741, 'loss_val': 1.0463775775271562, 'psi': 0.6260230995283609}
[S8] not sending this round → trigger blocked (psi=0.994)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.911)
[S6] not sending this round → trigger blocked (psi=0.944)
[S3] not sending this round → trigger blocked (psi=0.820)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[S5] not sending this round → trigger blocked (psi=0.816)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=-0.1185
[S7] DROPPED delta from S14 (cos=-0.1185 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.1422
[S8] DROPPED delta from S17 (cos=-0.1422 < 0.0)
[S2] START round=19 head_norm_before_train=1.823950 (no previous merge yet)
[S2] round=19 local utility u=0.105683 metrics={'f1_val': 0.8627341943375375, 'auprc': 0.9323294083519018, 'loss_val': 0.27285303816032713, 'psi': 0.8905722799432833}-{'f1_val': 0.833338835914274, 'auprc': 0.9341314401862594, 'loss_val': 0.31325347889620614, 'psi': 0.8736558776230682}
[S3] START round=19 head_norm_before_train=1.768026 (no previous merge yet)
[S3] round=19 local utility u=0.003136 metrics={'f1_val': 0.700330919019862, 'auprc': 0.999416285029739, 'loss_val': 0.2611485404352761, 'psi': 0.8199650654238129}-{'f1_val': 0.700330919019862, 'auprc': 0.9994158611744874, 'loss_val': 0.2674193915884785, 'psi': 0.8199648958817122}
[S4] START round=19 head_norm_before_train=1.855170 (no previous merge yet)
[S4] round=19 local utility u=0.909715 metrics={'f1_val': 0.9015564444956063, 'auprc': 0.94668364377929, 'loss_val': 0.48115886393572715, 'psi': 0.9196073242090799}-{'f1_val': 0.6152971312548369, 'auprc': 0.9216844218044686, 'loss_val': 0.5080348100794374, 'psi': 0.7378520474746896}
[S5] START round=19 head_norm_before_train=1.251079 cos_to_last_merge=0.9996 (last merge round=17)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.43960796518818884, 'auprc': 0.8513076446900398, 'loss_val': 0.7649325642943852, 'psi': 0.6042878369889293}-{'f1_val': 0.7003213174339138, 'auprc': 0.9890948265666307, 'loss_val': 0.3827146371585197, 'psi': 0.8158307210870006}
[S6] START round=19 head_norm_before_train=1.794264 (no previous merge yet)
[S6] round=19 local utility u=0.107963 metrics={'f1_val': 0.9607965381051233, 'auprc': 0.9696004432384991, 'loss_val': 0.18807376647899282, 'psi': 0.9643181001584736}-{'f1_val': 0.935381640750028, 'auprc': 0.9565191843841496, 'loss_val': 0.21226735789912052, 'psi': 0.9438366582036767}
[S7] START round=19 head_norm_before_train=1.245576 cos_to_last_merge=0.9996 (last merge round=17)
[S7] round=19 local utility u=0.743968 metrics={'f1_val': 0.6221029437711588, 'auprc': 0.7730108899534034, 'loss_val': 0.6452540724288126, 'psi': 0.6824661222440567}-{'f1_val': 0.4960583847346775, 'auprc': 0.6371084641540173, 'loss_val': 0.9692149492740157, 'psi': 0.5524784165024135}
[S8] START round=19 head_norm_before_train=1.793882 cos_to_last_merge=0.8329 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.933896440496837, 'auprc': 0.9861021739975542, 'loss_val': 0.11217593414300665, 'psi': 0.9547787338971239}-{'f1_val': 0.9922724065265219, 'auprc': 0.9974791206229713, 'loss_val': 0.04073601462748712, 'psi': 0.9943550921651017}
[S9] START round=19 head_norm_before_train=1.767427 (no previous merge yet)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9896951746952075, 'auprc': 0.9989274451245238, 'loss_val': 0.05244513987937937, 'psi': 0.993388082866934}-{'f1_val': 0.9918149940667227, 'auprc': 0.9988515858013957, 'loss_val': 0.05117142949658191, 'psi': 0.9946296307605919}
[S10] START round=19 head_norm_before_train=1.306539 cos_to_last_merge=0.9959 (last merge round=17)
[S10] round=19 local utility u=0.025813 metrics={'f1_val': 0.993391017001491, 'auprc': 0.9942212240024928, 'loss_val': 0.12915869244321218, 'psi': 0.9937230998018917}-{'f1_val': 0.9933667052737687, 'auprc': 0.9960463899490543, 'loss_val': 0.1861141740989534, 'psi': 0.9944385791438829}
[S11] START round=19 head_norm_before_train=1.815199 (no previous merge yet)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.957060472845392, 'auprc': 0.9980316861204668, 'loss_val': 0.13000456306172156, 'psi': 0.9734489581554219}-{'f1_val': 0.996305167468861, 'auprc': 0.9981800649334045, 'loss_val': 0.06625588952595894, 'psi': 0.9970551264546783}
[S13] START round=19 head_norm_before_train=1.226180 cos_to_last_merge=0.9965 (last merge round=17)
[S13] round=19 local utility u=0.151077 metrics={'f1_val': 0.6090351324960401, 'auprc': 0.5590257809474848, 'loss_val': 0.7884813733745283, 'psi': 0.589031391876618}-{'f1_val': 0.5782316368086994, 'auprc': 0.5447493506439718, 'loss_val': 0.8629850844179491, 'psi': 0.5648387223428084}
[S14] START round=19 head_norm_before_train=1.024831 cos_to_last_merge=0.9978 (last merge round=17)
[S14] round=19 local utility u=0.019573 metrics={'f1_val': 0.9774382857303701, 'auprc': 0.9987202022866064, 'loss_val': 0.2916560293547338, 'psi': 0.9859510523528646}-{'f1_val': 0.9861237138721632, 'auprc': 0.9986412555785349, 'loss_val': 0.3826785936680561, 'psi': 0.9911307305547119}
[S15] START round=19 head_norm_before_train=1.919755 (no previous merge yet)
[S15] round=19 local utility u=0.016300 metrics={'f1_val': 0.6988291712553267, 'auprc': 0.8577735005325218, 'loss_val': 0.533997159255611, 'psi': 0.7624069029662048}-{'f1_val': 0.6977164334685135, 'auprc': 0.8600585021495648, 'loss_val': 0.5667763224073642, 'psi': 0.762653260940934}
[S16] START round=19 head_norm_before_train=1.456539 cos_to_last_merge=0.8144 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=19 local utility u=0.061808 metrics={'f1_val': 0.9113264372577382, 'auprc': 0.9529190424409137, 'loss_val': 0.41616810052262415, 'psi': 0.9279634793310085}-{'f1_val': 0.9059365733678931, 'auprc': 0.9197773480109932, 'loss_val': 0.40801933807507695, 'psi': 0.9114728832251332}
[S17] START round=19 head_norm_before_train=1.609545 cos_to_last_merge=0.8245 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.6016552098315491, 'auprc': 0.8945249366832908, 'loss_val': 0.9284391739573143, 'psi': 0.7188031005722457}-{'f1_val': 0.8199278584202246, 'auprc': 0.9499579578458884, 'loss_val': 0.320657204887328, 'psi': 0.8719398981904902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39805
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39811
[S14] not sending this round → trigger blocked (psi=0.986)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S4
[S14] cosine check vs S4: cos=0.3255
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.5784
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.6482
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.9476
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] cosine check vs S15: cos=0.5198
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.8806
[S7] RECEIVED delta(kind=head bytes=1803) from S6
[S7] cosine check vs S6: cos=0.6798
[S6] RECEIVED delta(kind=head bytes=1803) from S2
[S6] cosine check vs S2: cos=-0.0837
[S6] DROPPED delta from S2 (cos=-0.0837 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=0.9000
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.4396 head_norm=1.271226
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.195284e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.4444 head_norm=1.304065 delta_norm=0.219528
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] r=20 psi=0.604 u=0.0000 p_local=0.2749 f1=0.440 auprc=0.851 bytes=14385
[S8] r=20 psi=0.955 u=0.0000 p_local=0.0671 f1=0.934 auprc=0.986 bytes=17992
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.9774 head_norm=1.073718
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.038015e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.9912 head_norm=1.007827 delta_norm=0.203802
[S14] aggregate: ACCEPT kept=['S4', 'S16', 'S3', 'S15'] (k=4/4) mode=median trim_p=0.1
[S14] r=20 psi=0.986 u=0.0196 p_local=0.3030 f1=0.977 auprc=0.999 bytes=16181
[S11] r=20 psi=0.973 u=0.0000 p_local=0.0877 f1=0.957 auprc=0.998 bytes=14400
[S9] r=20 psi=0.993 u=0.0000 p_local=0.1105 f1=0.990 auprc=0.999 bytes=14388
[S16] r=20 psi=0.928 u=0.0618 p_local=0.2713 f1=0.911 auprc=0.953 bytes=17922
[S2] r=20 psi=0.891 u=0.1057 p_local=0.1163 f1=0.863 auprc=0.932 bytes=14394
[S6] r=20 psi=0.964 u=0.1080 p_local=0.3049 f1=0.961 auprc=0.970 bytes=16187
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.6090 head_norm=1.278766
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.840985e-01
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.6023 head_norm=1.238047 delta_norm=0.284099
[S13] aggregate: ROLLBACK (f1_val pre=0.609 post=0.602 tol_abs=0.005 tol_rel=0.0)
[S13] r=20 psi=0.589 u=0.1511 p_local=0.0805 f1=0.609 auprc=0.559 bytes=17986
[S3] r=20 psi=0.820 u=0.0031 p_local=0.1761 f1=0.700 auprc=0.999 bytes=16198
[S4] r=20 psi=0.920 u=0.9097 p_local=0.2162 f1=0.902 auprc=0.947 bytes=16189
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.9934 head_norm=1.371693
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.268611e-01
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.9937 head_norm=1.285128 delta_norm=0.326861
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.994 u=0.0258 p_local=0.1095 f1=0.993 auprc=0.994 bytes=17980
[S15] r=20 psi=0.762 u=0.0163 p_local=0.2216 f1=0.699 auprc=0.858 bytes=14393
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6221 head_norm=1.261626
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.632234e-01
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6088 head_norm=1.410909 delta_norm=0.663223
[S7] aggregate: ROLLBACK (f1_val pre=0.622 post=0.609 tol_abs=0.005 tol_rel=0.0)
[S7] r=20 psi=0.682 u=0.7440 p_local=0.3278 f1=0.622 auprc=0.773 bytes=16164
[S17] r=20 psi=0.719 u=0.0000 p_local=0.3583 f1=0.602 auprc=0.895 bytes=17995
[S2] START round=20 head_norm_before_train=1.837205 (no previous merge yet)
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.862808186329415, 'auprc': 0.9351578782676228, 'loss_val': 0.28246984742996845, 'psi': 0.8917480631046981}-{'f1_val': 0.8627341943375375, 'auprc': 0.9323294083519018, 'loss_val': 0.27285303816032713, 'psi': 0.8905722799432833}
[S3] START round=20 head_norm_before_train=1.782132 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.6363895620779514, 'auprc': 0.9989287662484563, 'loss_val': 0.4134679471085119, 'psi': 0.7814052437461534}-{'f1_val': 0.700330919019862, 'auprc': 0.999416285029739, 'loss_val': 0.2611485404352761, 'psi': 0.8199650654238129}
[S4] START round=20 head_norm_before_train=1.870455 (no previous merge yet)
[S4] round=20 local utility u=0.181831 metrics={'f1_val': 0.9586792689913872, 'auprc': 0.9421785498400133, 'loss_val': 0.4467181981506358, 'psi': 0.9520789813308377}-{'f1_val': 0.9015564444956063, 'auprc': 0.94668364377929, 'loss_val': 0.48115886393572715, 'psi': 0.9196073242090799}
[S5] START round=20 head_norm_before_train=1.304065 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9794394094544736, 'loss_val': 0.4065450433059722, 'psi': 0.8119681228766049}-{'f1_val': 0.43960796518818884, 'auprc': 0.8513076446900398, 'loss_val': 0.7649325642943852, 'psi': 0.6042878369889293}
[S6] START round=20 head_norm_before_train=1.808136 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.8266545440856679, 'auprc': 0.9654198315732265, 'loss_val': 0.3247660174896351, 'psi': 0.8821606590806913}-{'f1_val': 0.9607965381051233, 'auprc': 0.9696004432384991, 'loss_val': 0.18807376647899282, 'psi': 0.9643181001584736}
[S7] START round=20 head_norm_before_train=1.410909 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.5807971105122318, 'auprc': 0.7666925257161343, 'loss_val': 0.7516921174154795, 'psi': 0.6551552765937929}-{'f1_val': 0.6221029437711588, 'auprc': 0.7730108899534034, 'loss_val': 0.6452540724288126, 'psi': 0.6824661222440567}
[S8] START round=20 head_norm_before_train=1.813771 cos_to_last_merge=0.8308 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.831
[S8] round=20 local utility u=0.213720 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.986376540359422, 'loss_val': 0.04116855122186168, 'psi': 0.9904495270745808}-{'f1_val': 0.933896440496837, 'auprc': 0.9861021739975542, 'loss_val': 0.11217593414300665, 'psi': 0.9547787338971239}
[S9] START round=20 head_norm_before_train=1.790573 (no previous merge yet)
[S9] round=20 local utility u=0.025009 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9965330042812713, 'loss_val': 0.03818896697417739, 'psi': 0.9967247529678629}-{'f1_val': 0.9896951746952075, 'auprc': 0.9989274451245238, 'loss_val': 0.05244513987937937, 'psi': 0.993388082866934}
[S10] START round=20 head_norm_before_train=1.285128 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920250630200542, 'loss_val': 0.1728789170929612, 'psi': 0.9939227286196466}-{'f1_val': 0.993391017001491, 'auprc': 0.9942212240024928, 'loss_val': 0.12915869244321218, 'psi': 0.9937230998018917}
[S11] START round=20 head_norm_before_train=1.840957 (no previous merge yet)
[S11] round=20 local utility u=0.155239 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997895584551332, 'loss_val': 0.0545864379595604, 'psi': 0.9969413343018494}-{'f1_val': 0.957060472845392, 'auprc': 0.9980316861204668, 'loss_val': 0.13000456306172156, 'psi': 0.9734489581554219}
[S13] START round=20 head_norm_before_train=1.238047 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.185359 metrics={'f1_val': 0.6165523074204153, 'auprc': 0.6518200999316138, 'loss_val': 0.7412484054685435, 'psi': 0.6306594244248948}-{'f1_val': 0.6090351324960401, 'auprc': 0.5590257809474848, 'loss_val': 0.7884813733745283, 'psi': 0.589031391876618}
[S14] START round=20 head_norm_before_train=1.007827 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.043159 metrics={'f1_val': 0.9913636091862319, 'auprc': 0.9986549726797842, 'loss_val': 0.28869494720579014, 'psi': 0.9942801545836528}-{'f1_val': 0.9774382857303701, 'auprc': 0.9987202022866064, 'loss_val': 0.2916560293547338, 'psi': 0.9859510523528646}
[S15] START round=20 head_norm_before_train=1.936880 (no previous merge yet)
[S15] round=20 local utility u=1.000000 metrics={'f1_val': 0.989963302073626, 'auprc': 0.9987845017110554, 'loss_val': 0.04808724265343604, 'psi': 0.9934917819285978}-{'f1_val': 0.6988291712553267, 'auprc': 0.8577735005325218, 'loss_val': 0.533997159255611, 'psi': 0.7624069029662048}
[S16] START round=20 head_norm_before_train=1.496814 cos_to_last_merge=0.8091 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.809
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.8853614021971923, 'auprc': 0.9740506842308224, 'loss_val': 0.4710593328829594, 'psi': 0.9208371150106444}-{'f1_val': 0.9113264372577382, 'auprc': 0.9529190424409137, 'loss_val': 0.41616810052262415, 'psi': 0.9279634793310085}
[S17] START round=20 head_norm_before_train=1.631292 cos_to_last_merge=0.8213 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6056942275014155, 'auprc': 0.8862151533194814, 'loss_val': 0.9656752509015448, 'psi': 0.717902597828642}-{'f1_val': 0.6016552098315491, 'auprc': 0.8945249366832908, 'loss_val': 0.9284391739573143, 'psi': 0.7188031005722457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:39811
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1807 to 1 peers)
[S5] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.3066
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] cosine check vs S15: cos=0.6042
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.4005
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9103
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.2146
[S2] DROPPED delta from S11 (cos=-0.2146 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1807) from S14
[S7] cosine check vs S14: cos=-0.1348
[S7] DROPPED delta from S14 (cos=-0.1348 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=-0.0794
[S5] DROPPED delta from S8 (cos=-0.0794 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1791) from S5
[S3] cosine check vs S5: cos=-0.0870
[S3] DROPPED delta from S5 (cos=-0.0870 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.093 → S6@127.0.0.1:39807
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=20 metric=0.5808 head_norm=1.427840
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.654892e-01
[S7] stored merged vector for next round verification (round=20)
[S7] DEBUG after merge:  round=20 metric=0.5792 head_norm=1.313154 delta_norm=0.965489
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.262 → S13@127.0.0.1:39813
[S6] ⇄ pheromone p=0.244 → S7@127.0.0.1:39808
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=20 metric=0.9952 head_norm=1.349461
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.805312e-01
[S10] stored merged vector for next round verification (round=20)
[S10] DEBUG after merge:  round=20 metric=0.9952 head_norm=1.285310 delta_norm=0.280531
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.088 → S5@127.0.0.1:39805
[S3] ⇄ pheromone p=0.141 → S14@127.0.0.1:39814
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.9914 head_norm=1.050350
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.030670e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.9939 head_norm=1.126984 delta_norm=0.503067
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.251 → S7@127.0.0.1:39808
[S5] ⇄ pheromone p=0.420 → S3@127.0.0.1:39803
[S4] ⇄ pheromone p=0.209 → S14@127.0.0.1:39814
[S13] ⇄ pheromone p=0.101 → S10@127.0.0.1:39811
[S11] ⇄ pheromone p=0.101 → S2@127.0.0.1:39802
[S15] ⇄ pheromone p=0.377 → S14@127.0.0.1:39814
[S9] ⇄ pheromone p=0.093 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.096 → S5@127.0.0.1:39805
[S16] ⇄ pheromone p=0.217 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.287 → S8@127.0.0.1:39809
[S2] START round=21 head_norm_before_train=1.859066 (no previous merge yet)
[S2] round=21 local utility u=0.063280 metrics={'f1_val': 0.9163782853115412, 'auprc': 0.8642205841232722, 'loss_val': 0.2645184389674941, 'psi': 0.8955152048362336}-{'f1_val': 0.862808186329415, 'auprc': 0.9351578782676228, 'loss_val': 0.28246984742996845, 'psi': 0.8917480631046981}
[S3] START round=21 head_norm_before_train=1.795853 (no previous merge yet)
[S3] round=21 local utility u=0.095772 metrics={'f1_val': 0.6580902989354971, 'auprc': 0.9995805580026123, 'loss_val': 0.3540841450491201, 'psi': 0.7946864025623432}-{'f1_val': 0.6363895620779514, 'auprc': 0.9989287662484563, 'loss_val': 0.4134679471085119, 'psi': 0.7814052437461534}
[S4] START round=21 head_norm_before_train=1.885643 (no previous merge yet)
[S4] round=21 local utility u=0.018153 metrics={'f1_val': 0.958523267926374, 'auprc': 0.9459678863296896, 'loss_val': 0.4208436481743845, 'psi': 0.9535011152877002}-{'f1_val': 0.9586792689913872, 'auprc': 0.9421785498400133, 'loss_val': 0.4467181981506358, 'psi': 0.9520789813308377}
[S5] START round=21 head_norm_before_train=1.322861 cos_to_last_merge=0.9997 (last merge round=19)
[S5] round=21 local utility u=0.034366 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9876517261661965, 'loss_val': 0.3624549623518864, 'psi': 0.8152534809268268}-{'f1_val': 0.700320598491359, 'auprc': 0.9794394094544736, 'loss_val': 0.4065450433059722, 'psi': 0.8119681228766049}
[S6] START round=21 head_norm_before_train=1.819304 (no previous merge yet)
[S6] round=21 local utility u=0.160372 metrics={'f1_val': 0.8847127458311923, 'auprc': 0.9488589770377588, 'loss_val': 0.3026883297304967, 'psi': 0.9103712383138189}-{'f1_val': 0.8266545440856679, 'auprc': 0.9654198315732265, 'loss_val': 0.3247660174896351, 'psi': 0.8821606590806913}
[S7] START round=21 head_norm_before_train=1.313154 cos_to_last_merge=1.0000 (last merge round=20)
[S7] round=21 local utility u=0.517161 metrics={'f1_val': 0.6356111442107473, 'auprc': 0.9629112832738358, 'loss_val': 0.6349101897904431, 'psi': 0.7665311998359827}-{'f1_val': 0.5807971105122318, 'auprc': 0.7666925257161343, 'loss_val': 0.7516921174154795, 'psi': 0.6551552765937929}
[S8] START round=21 head_norm_before_train=1.831754 cos_to_last_merge=0.8293 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=21 local utility u=0.012346 metrics={'f1_val': 0.9908318037916036, 'auprc': 0.9988885855397907, 'loss_val': 0.04001534950825092, 'psi': 0.9940545164908785}-{'f1_val': 0.9931648515513533, 'auprc': 0.986376540359422, 'loss_val': 0.04116855122186168, 'psi': 0.9904495270745808}
[S9] START round=21 head_norm_before_train=1.809519 (no previous merge yet)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9909938198082651, 'auprc': 0.9992316427981827, 'loss_val': 0.04335211228956864, 'psi': 0.9942889490042321}-{'f1_val': 0.9968525854255906, 'auprc': 0.9965330042812713, 'loss_val': 0.03818896697417739, 'psi': 0.9967247529678629}
[S10] START round=21 head_norm_before_train=1.285310 cos_to_last_merge=1.0000 (last merge round=20)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9941688697565366, 'loss_val': 0.18985130484347376, 'psi': 0.9933893959973523}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920250630200542, 'loss_val': 0.1728789170929612, 'psi': 0.9939227286196466}
[S11] START round=21 head_norm_before_train=1.864779 (no previous merge yet)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9846452245214713, 'auprc': 0.9978925874544201, 'loss_val': 0.07433000864143836, 'psi': 0.9899441696946509}-{'f1_val': 0.996305167468861, 'auprc': 0.997895584551332, 'loss_val': 0.0545864379595604, 'psi': 0.9969413343018494}
[S13] START round=21 head_norm_before_train=1.280779 cos_to_last_merge=0.9973 (last merge round=19)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6094814617412341, 'auprc': 0.6738912001965134, 'loss_val': 0.7782054642033606, 'psi': 0.6352453571233458}-{'f1_val': 0.6165523074204153, 'auprc': 0.6518200999316138, 'loss_val': 0.7412484054685435, 'psi': 0.6306594244248948}
[S14] START round=21 head_norm_before_train=1.126984 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.018768 metrics={'f1_val': 0.99705655548382, 'auprc': 0.9969532712806423, 'loss_val': 0.28021128031334214, 'psi': 0.9970152418025489}-{'f1_val': 0.9913636091862319, 'auprc': 0.9986549726797842, 'loss_val': 0.28869494720579014, 'psi': 0.9942801545836528}
[S15] START round=21 head_norm_before_train=1.955167 (no previous merge yet)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6964903077972757, 'auprc': 0.7989881995607409, 'loss_val': 0.6587881843425949, 'psi': 0.7374894645026617}-{'f1_val': 0.989963302073626, 'auprc': 0.9987845017110554, 'loss_val': 0.04808724265343604, 'psi': 0.9934917819285978}
[S16] START round=21 head_norm_before_train=1.535168 cos_to_last_merge=0.8043 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.871875287138149, 'auprc': 0.9827501259964411, 'loss_val': 0.5532760883847639, 'psi': 0.9162252226814658}-{'f1_val': 0.8853614021971923, 'auprc': 0.9740506842308224, 'loss_val': 0.4710593328829594, 'psi': 0.9208371150106444}
[S17] START round=21 head_norm_before_train=1.659180 cos_to_last_merge=0.8179 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.6143532313130446, 'auprc': 0.8171234549259304, 'loss_val': 0.8547887028808928, 'psi': 0.695461320758199}-{'f1_val': 0.6056942275014155, 'auprc': 0.8862151533194814, 'loss_val': 0.9656752509015448, 'psi': 0.717902597828642}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[S3] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] cosine check vs S3: cos=0.2620
[S14] RECEIVED delta(kind=head bytes=1803) from S4
[S14] cosine check vs S4: cos=0.6228
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0810
[S6] DROPPED delta from S2 (cos=-0.0810 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0812
[S5] DROPPED delta from S8 (cos=-0.0812 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0895
[S3] DROPPED delta from S5 (cos=-0.0895 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.4971
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=-0.1016
[S7] DROPPED delta from S14 (cos=-0.1016 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1802) from S7
[S13] cosine check vs S7: cos=0.9122
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.6095 head_norm=1.324090
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.782649e-01
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.6070 head_norm=1.298567 delta_norm=0.278265
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=21 metric=0.6356 head_norm=1.331991
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.212553e-01
[S7] stored merged vector for next round verification (round=21)
[S7] DEBUG after merge:  round=21 metric=0.6316 head_norm=1.373238 delta_norm=0.821255
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=21 metric=0.9971 head_norm=1.164597
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.605781e-01
[S14] stored merged vector for next round verification (round=21)
[S14] DEBUG after merge:  round=21 metric=0.9968 head_norm=1.131564 delta_norm=0.560578
[S14] aggregate: ACCEPT kept=['S3', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.882470 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.9053349360436629, 'auprc': 0.8703692737110664, 'loss_val': 0.2673834927720436, 'psi': 0.8913486711106242}-{'f1_val': 0.9163782853115412, 'auprc': 0.8642205841232722, 'loss_val': 0.2645184389674941, 'psi': 0.8955152048362336}
[S3] START round=22 head_norm_before_train=1.809484 (no previous merge yet)
[S3] round=22 local utility u=0.018555 metrics={'f1_val': 0.6617112838542594, 'auprc': 0.9995783537536059, 'loss_val': 0.33869371602585024, 'psi': 0.796858111813998}-{'f1_val': 0.6580902989354971, 'auprc': 0.9995805580026123, 'loss_val': 0.3540841450491201, 'psi': 0.7946864025623432}
[S4] START round=22 head_norm_before_train=1.903024 (no previous merge yet)
[S4] round=22 local utility u=0.006499 metrics={'f1_val': 0.9556282278008174, 'auprc': 0.9462450032267589, 'loss_val': 0.3913076983413805, 'psi': 0.9518749379711939}-{'f1_val': 0.958523267926374, 'auprc': 0.9459678863296896, 'loss_val': 0.4208436481743845, 'psi': 0.9535011152877002}
[S5] START round=22 head_norm_before_train=1.341512 cos_to_last_merge=0.9988 (last merge round=19)
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8499288552913565, 'loss_val': 0.9063844236736943, 'psi': 0.6020312804197658}-{'f1_val': 0.7003213174339138, 'auprc': 0.9876517261661965, 'loss_val': 0.3624549623518864, 'psi': 0.8152534809268268}
[S6] START round=22 head_norm_before_train=1.829286 (no previous merge yet)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.8217839807904186, 'auprc': 0.9537251656151405, 'loss_val': 0.43221020008337313, 'psi': 0.8745604547203074}-{'f1_val': 0.8847127458311923, 'auprc': 0.9488589770377588, 'loss_val': 0.3026883297304967, 'psi': 0.9103712383138189}
[S7] START round=22 head_norm_before_train=1.373238 cos_to_last_merge=1.0000 (last merge round=21)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.5901226198259704, 'auprc': 0.8009640793691025, 'loss_val': 0.7392387688636642, 'psi': 0.6744592036432232}-{'f1_val': 0.6356111442107473, 'auprc': 0.9629112832738358, 'loss_val': 0.6349101897904431, 'psi': 0.7665311998359827}
[S8] START round=22 head_norm_before_train=1.843992 cos_to_last_merge=0.8289 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=22 local utility u=0.003815 metrics={'f1_val': 0.9919085369259982, 'auprc': 0.9988191368480654, 'loss_val': 0.03863714527532403, 'psi': 0.9946727768948251}-{'f1_val': 0.9908318037916036, 'auprc': 0.9988885855397907, 'loss_val': 0.04001534950825092, 'psi': 0.9940545164908785}
[S9] START round=22 head_norm_before_train=1.827173 (no previous merge yet)
[S9] round=22 local utility u=0.020557 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9973350080087506, 'loss_val': 0.03169994544635092, 'psi': 0.9970455544588546}-{'f1_val': 0.9909938198082651, 'auprc': 0.9992316427981827, 'loss_val': 0.04335211228956864, 'psi': 0.9942889490042321}
[S10] START round=22 head_norm_before_train=1.358397 cos_to_last_merge=0.9956 (last merge round=20)
[S10] round=22 local utility u=0.041211 metrics={'f1_val': 0.9940063275949004, 'auprc': 0.9938643726778917, 'loss_val': 0.11333570397209627, 'psi': 0.9939495456280969}-{'f1_val': 0.992869746824563, 'auprc': 0.9941688697565366, 'loss_val': 0.18985130484347376, 'psi': 0.9933893959973523}
[S11] START round=22 head_norm_before_train=1.887180 (no previous merge yet)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9563848619984399, 'auprc': 0.9974087868055933, 'loss_val': 0.16540547944998735, 'psi': 0.9727944319213012}-{'f1_val': 0.9846452245214713, 'auprc': 0.9978925874544201, 'loss_val': 0.07433000864143836, 'psi': 0.9899441696946509}
[S13] START round=22 head_norm_before_train=1.298567 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.611194728422684, 'auprc': 0.6679666839746718, 'loss_val': 0.7908985364963512, 'psi': 0.6339035106434792}-{'f1_val': 0.6094814617412341, 'auprc': 0.6738912001965134, 'loss_val': 0.7782054642033606, 'psi': 0.6352453571233458}
[S14] START round=22 head_norm_before_train=1.131564 cos_to_last_merge=1.0000 (last merge round=21)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9911595974135687, 'auprc': 0.9987136857256378, 'loss_val': 0.29349650920782727, 'psi': 0.9941812327383964}-{'f1_val': 0.99705655548382, 'auprc': 0.9969532712806423, 'loss_val': 0.28021128031334214, 'psi': 0.9970152418025489}
[S15] START round=22 head_norm_before_train=1.967049 (no previous merge yet)
[S15] round=22 local utility u=0.270727 metrics={'f1_val': 0.6996026495155904, 'auprc': 0.9232407654307053, 'loss_val': 0.508765843577109, 'psi': 0.7890578958816363}-{'f1_val': 0.6964903077972757, 'auprc': 0.7989881995607409, 'loss_val': 0.6587881843425949, 'psi': 0.7374894645026617}
[S16] START round=22 head_norm_before_train=1.569793 cos_to_last_merge=0.8003 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.800
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8438171431521113, 'auprc': 0.9196629558991829, 'loss_val': 0.7244743170604322, 'psi': 0.87415546825094}-{'f1_val': 0.871875287138149, 'auprc': 0.9827501259964411, 'loss_val': 0.5532760883847639, 'psi': 0.9162252226814658}
[S17] START round=22 head_norm_before_train=1.681317 cos_to_last_merge=0.8154 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.5908892188817108, 'auprc': 0.8206882391778325, 'loss_val': 1.1338405376645775, 'psi': 0.6828088270001594}-{'f1_val': 0.6143532313130446, 'auprc': 0.8171234549259304, 'loss_val': 0.8547887028808928, 'psi': 0.695461320758199}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.995)
[S4] not sending this round → trigger blocked (psi=0.952)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39808
[S3] not sending this round → trigger blocked (psi=0.797)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1805) from S9
[S7] cosine check vs S9: cos=0.4022
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9039
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.3907
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=22 metric=0.4368 head_norm=1.361940
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.095567e-01
[S5] stored merged vector for next round verification (round=22)
[S5] DEBUG after merge:  round=22 metric=0.4368 head_norm=1.367143 delta_norm=0.309557
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.9912 head_norm=1.165026
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.300432e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.9780 head_norm=1.328093 delta_norm=0.930043
[S14] aggregate: ROLLBACK (f1_val pre=0.991 post=0.978 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.5901 head_norm=1.385166
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.021750e-01
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.5761 head_norm=1.356267 delta_norm=0.902175
[S7] aggregate: ROLLBACK (f1_val pre=0.590 post=0.576 tol_abs=0.005 tol_rel=0.0)
[S2] START round=23 head_norm_before_train=1.904094 (no previous merge yet)
[S2] round=23 local utility u=0.032593 metrics={'f1_val': 0.9164021476325693, 'auprc': 0.8694416573206355, 'loss_val': 0.2658184894575289, 'psi': 0.8976179515077958}-{'f1_val': 0.9053349360436629, 'auprc': 0.8703692737110664, 'loss_val': 0.2673834927720436, 'psi': 0.8913486711106242}
[S3] START round=23 head_norm_before_train=1.823468 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.6390570012680562, 'auprc': 0.9997895805143889, 'loss_val': 0.3758104734379059, 'psi': 0.7833500329665893}-{'f1_val': 0.6617112838542594, 'auprc': 0.9995783537536059, 'loss_val': 0.33869371602585024, 'psi': 0.796858111813998}
[S4] START round=23 head_norm_before_train=1.925915 (no previous merge yet)
[S4] round=23 local utility u=0.013912 metrics={'f1_val': 0.9566895932140321, 'auprc': 0.9425643084045666, 'loss_val': 0.3588099071827568, 'psi': 0.9510394792902459}-{'f1_val': 0.9556282278008174, 'auprc': 0.9462450032267589, 'loss_val': 0.3913076983413805, 'psi': 0.9518749379711939}
[S5] START round=23 head_norm_before_train=1.367143 cos_to_last_merge=1.0000 (last merge round=22)
[S5] round=23 local utility u=0.998210 metrics={'f1_val': 0.6674945936138609, 'auprc': 0.9008029267578749, 'loss_val': 0.446955846525557, 'psi': 0.7608179268714665}-{'f1_val': 0.43676623050537206, 'auprc': 0.8499288552913565, 'loss_val': 0.9063844236736943, 'psi': 0.6020312804197658}
[S6] START round=23 head_norm_before_train=1.839635 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.7010233656608079, 'auprc': 0.9540271097452858, 'loss_val': 0.7654855904645694, 'psi': 0.8022248632945991}-{'f1_val': 0.8217839807904186, 'auprc': 0.9537251656151405, 'loss_val': 0.43221020008337313, 'psi': 0.8745604547203074}
[S7] START round=23 head_norm_before_train=1.356267 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.519900 metrics={'f1_val': 0.6547139566018151, 'auprc': 0.9751740734556968, 'loss_val': 0.6096167033018455, 'psi': 0.7828980033433678}-{'f1_val': 0.5901226198259704, 'auprc': 0.8009640793691025, 'loss_val': 0.7392387688636642, 'psi': 0.6744592036432232}
[S8] START round=23 head_norm_before_train=1.857327 cos_to_last_merge=0.8290 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.9927976282173978, 'auprc': 0.9874716005869162, 'loss_val': 0.03794489882300396, 'psi': 0.9906672171652051}-{'f1_val': 0.9919085369259982, 'auprc': 0.9988191368480654, 'loss_val': 0.03863714527532403, 'psi': 0.9946727768948251}
[S9] START round=23 head_norm_before_train=1.840672 (no previous merge yet)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9992262942942239, 'loss_val': 0.036578520539921125, 'psi': 0.9947795141577231}-{'f1_val': 0.9968525854255906, 'auprc': 0.9973350080087506, 'loss_val': 0.03169994544635092, 'psi': 0.9970455544588546}
[S10] START round=23 head_norm_before_train=1.440462 cos_to_last_merge=0.9855 (last merge round=20)
[S10] round=23 local utility u=0.019355 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9943485269645463, 'loss_val': 0.07871001618233445, 'psi': 0.9944063871036126}-{'f1_val': 0.9940063275949004, 'auprc': 0.9938643726778917, 'loss_val': 0.11333570397209627, 'psi': 0.9939495456280969}
[S11] START round=23 head_norm_before_train=1.909491 (no previous merge yet)
[S11] round=23 local utility u=0.183303 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978120395586589, 'loss_val': 0.03953138005131365, 'psi': 0.9969079163047802}-{'f1_val': 0.9563848619984399, 'auprc': 0.9974087868055933, 'loss_val': 0.16540547944998735, 'psi': 0.9727944319213012}
[S13] START round=23 head_norm_before_train=1.341393 cos_to_last_merge=0.9972 (last merge round=21)
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.6129389705514691, 'auprc': 0.6679119522951233, 'loss_val': 0.8023772613544097, 'psi': 0.6349281632489308}-{'f1_val': 0.611194728422684, 'auprc': 0.6679666839746718, 'loss_val': 0.7908985364963512, 'psi': 0.6339035106434792}
[S14] START round=23 head_norm_before_train=1.328093 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.043939 metrics={'f1_val': 0.9976223066820082, 'auprc': 0.9969600891125345, 'loss_val': 0.2391335079790404, 'psi': 0.9973574196542188}-{'f1_val': 0.9911595974135687, 'auprc': 0.9987136857256378, 'loss_val': 0.29349650920782727, 'psi': 0.9941812327383964}
[S15] START round=23 head_norm_before_train=1.974927 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9922462322398399, 'auprc': 0.9930323331041897, 'loss_val': 0.042772100522872836, 'psi': 0.9925606725855798}-{'f1_val': 0.6996026495155904, 'auprc': 0.9232407654307053, 'loss_val': 0.508765843577109, 'psi': 0.7890578958816363}
[S16] START round=23 head_norm_before_train=1.602097 cos_to_last_merge=0.7963 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.796
[S16] round=23 local utility u=0.556508 metrics={'f1_val': 0.9066947803866386, 'auprc': 0.9889534483620347, 'loss_val': 0.1965961900163127, 'psi': 0.939598247576797}-{'f1_val': 0.8438171431521113, 'auprc': 0.9196629558991829, 'loss_val': 0.7244743170604322, 'psi': 0.87415546825094}
[S17] START round=23 head_norm_before_train=1.700955 cos_to_last_merge=0.8131 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=23 local utility u=0.029097 metrics={'f1_val': 0.5773977142896889, 'auprc': 0.7912204074899749, 'loss_val': 0.9062945374599721, 'psi': 0.6629267915698033}-{'f1_val': 0.5908892188817108, 'auprc': 0.8206882391778325, 'loss_val': 1.1338405376645775, 'psi': 0.6828088270001594}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39813
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.993)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=-0.0790
[S6] DROPPED delta from S2 (cos=-0.0790 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0972
[S3] DROPPED delta from S5 (cos=-0.0972 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=-0.2151
[S2] DROPPED delta from S11 (cos=-0.2151 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S7
[S13] cosine check vs S7: cos=0.9317
[S14] RECEIVED delta(kind=head bytes=1802) from S16
[S14] cosine check vs S16: cos=0.3852
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.0864
[S7] DROPPED delta from S14 (cos=-0.0864 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S4
[S14] cosine check vs S4: cos=0.3771
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1796 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=-0.1400
[S8] DROPPED delta from S17 (cos=-0.1400 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.6129 head_norm=1.393224
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.554850e-01
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.6103 head_norm=1.357107 delta_norm=0.255485
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.9976 head_norm=1.361567
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.354309e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.9975 head_norm=1.153645 delta_norm=0.635431
[S14] aggregate: ACCEPT kept=['S16', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.921231 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.8694858197601266, 'auprc': 0.9390237740157616, 'loss_val': 0.29656936117352706, 'psi': 0.8973010014623807}-{'f1_val': 0.9164021476325693, 'auprc': 0.8694416573206355, 'loss_val': 0.2658184894575289, 'psi': 0.8976179515077958}
[S3] START round=24 head_norm_before_train=1.838075 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.578855561913481, 'auprc': 0.999789580514389, 'loss_val': 0.5199613792783229, 'psi': 0.7472291693538442}-{'f1_val': 0.6390570012680562, 'auprc': 0.9997895805143889, 'loss_val': 0.3758104734379059, 'psi': 0.7833500329665893}
[S4] START round=24 head_norm_before_train=1.947117 (no previous merge yet)
[S4] round=24 local utility u=0.014822 metrics={'f1_val': 0.9577690898778158, 'auprc': 0.9425643275497112, 'loss_val': 0.33564257050097374, 'psi': 0.951687184946574}-{'f1_val': 0.9566895932140321, 'auprc': 0.9425643084045666, 'loss_val': 0.3588099071827568, 'psi': 0.9510394792902459}
[S5] START round=24 head_norm_before_train=1.384953 cos_to_last_merge=0.9997 (last merge round=22)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6256080416015863, 'auprc': 0.8554604945563129, 'loss_val': 0.5054969311228588, 'psi': 0.717549022783477}-{'f1_val': 0.6674945936138609, 'auprc': 0.9008029267578749, 'loss_val': 0.446955846525557, 'psi': 0.7608179268714665}
[S6] START round=24 head_norm_before_train=1.852586 (no previous merge yet)
[S6] round=24 local utility u=0.580570 metrics={'f1_val': 0.8400768117601501, 'auprc': 0.9538983528778279, 'loss_val': 0.43828069004370374, 'psi': 0.8856054282072212}-{'f1_val': 0.7010233656608079, 'auprc': 0.9540271097452858, 'loss_val': 0.7654855904645694, 'psi': 0.8022248632945991}
[S7] START round=24 head_norm_before_train=1.368558 cos_to_last_merge=0.9998 (last merge round=22)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.41648082873294934, 'auprc': 0.7759216826833054, 'loss_val': 1.0526204438389528, 'psi': 0.5602571703130917}-{'f1_val': 0.6547139566018151, 'auprc': 0.9751740734556968, 'loss_val': 0.6096167033018455, 'psi': 0.7828980033433678}
[S8] START round=24 head_norm_before_train=1.874493 cos_to_last_merge=0.8273 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.827
[S8] round=24 local utility u=0.003050 metrics={'f1_val': 0.9886727134413368, 'auprc': 0.9989200988621809, 'loss_val': 0.04144053928710656, 'psi': 0.9927716676096745}-{'f1_val': 0.9927976282173978, 'auprc': 0.9874716005869162, 'loss_val': 0.03794489882300396, 'psi': 0.9906672171652051}
[S9] START round=24 head_norm_before_train=1.851527 (no previous merge yet)
[S9] round=24 local utility u=0.016412 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.997254305835672, 'loss_val': 0.028064752306815852, 'psi': 0.9970132735896231}-{'f1_val': 0.9918149940667227, 'auprc': 0.9992262942942239, 'loss_val': 0.036578520539921125, 'psi': 0.9947795141577231}
[S10] START round=24 head_norm_before_train=1.511039 cos_to_last_merge=0.9758 (last merge round=20)
[S10] round=24 local utility u=0.006527 metrics={'f1_val': 0.9939904298799414, 'auprc': 0.996426598017065, 'loss_val': 0.0691636384870387, 'psi': 0.9949648971347907}-{'f1_val': 0.9944449605296568, 'auprc': 0.9943485269645463, 'loss_val': 0.07871001618233445, 'psi': 0.9944063871036126}
[S11] START round=24 head_norm_before_train=1.928157 (no previous merge yet)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9595426378747243, 'auprc': 0.9979096839056439, 'loss_val': 0.09632353791365668, 'psi': 0.9748894562870921}-{'f1_val': 0.996305167468861, 'auprc': 0.9978120395586589, 'loss_val': 0.03953138005131365, 'psi': 0.9969079163047802}
[S13] START round=24 head_norm_before_train=1.357107 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.602498941656085, 'auprc': 0.6224617872128272, 'loss_val': 0.8523612264784912, 'psi': 0.6104840798787818}-{'f1_val': 0.6129389705514691, 'auprc': 0.6679119522951233, 'loss_val': 0.8023772613544097, 'psi': 0.6349281632489308}
[S14] START round=24 head_norm_before_train=1.153645 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.008450 metrics={'f1_val': 0.9964326399079161, 'auprc': 0.9986190114466064, 'loss_val': 0.22007145517411064, 'psi': 0.9973071885233922}-{'f1_val': 0.9976223066820082, 'auprc': 0.9969600891125345, 'loss_val': 0.2391335079790404, 'psi': 0.9973574196542188}
[S15] START round=24 head_norm_before_train=1.990105 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7690893284264777, 'auprc': 0.987428255634714, 'loss_val': 0.42198351999459494, 'psi': 0.8564248993097723}-{'f1_val': 0.9922462322398399, 'auprc': 0.9930323331041897, 'loss_val': 0.042772100522872836, 'psi': 0.9925606725855798}
[S16] START round=24 head_norm_before_train=1.629403 cos_to_last_merge=0.7929 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=24 local utility u=0.086857 metrics={'f1_val': 0.9390264323888888, 'auprc': 0.9935002269501949, 'loss_val': 0.2305121057380533, 'psi': 0.9608159502134113}-{'f1_val': 0.9066947803866386, 'auprc': 0.9889534483620347, 'loss_val': 0.1965961900163127, 'psi': 0.939598247576797}
[S17] START round=24 head_norm_before_train=1.702976 cos_to_last_merge=0.8122 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=24 local utility u=0.531440 metrics={'f1_val': 0.6665386978093155, 'auprc': 0.8378939697406254, 'loss_val': 0.5182804904219522, 'psi': 0.7350808065818395}-{'f1_val': 0.5773977142896889, 'auprc': 0.7912204074899749, 'loss_val': 0.9062945374599721, 'psi': 0.6629267915698033}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.997)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39805
[S4] not sending this round → trigger blocked (psi=0.952)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:39808
[S16] not sending this round → trigger blocked (psi=0.961)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] cosine check vs S9: cos=0.8783
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.4503
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=0.9739
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=-0.0646
[S5] DROPPED delta from S8 (cos=-0.0646 < 0.0)
[S17] not sending this round → trigger blocked (psi=0.735)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.6256 head_norm=1.412544
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.850354e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.6292 head_norm=1.477046 delta_norm=0.185035
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=24 metric=0.4165 head_norm=1.381266
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.157227e-01
[S7] stored merged vector for next round verification (round=24)
[S7] DEBUG after merge:  round=24 metric=0.4094 head_norm=1.326281 delta_norm=0.215723
[S7] aggregate: ROLLBACK (f1_val pre=0.416 post=0.409 tol_abs=0.005 tol_rel=0.0)
[S2] START round=25 head_norm_before_train=1.934556 (no previous merge yet)
[S2] round=25 local utility u=0.106987 metrics={'f1_val': 0.9088519468783456, 'auprc': 0.9201933048284239, 'loss_val': 0.26230171349154097, 'psi': 0.9133884900583769}-{'f1_val': 0.8694858197601266, 'auprc': 0.9390237740157616, 'loss_val': 0.29656936117352706, 'psi': 0.8973010014623807}
[S3] START round=25 head_norm_before_train=1.853675 (no previous merge yet)
[S3] round=25 local utility u=0.244045 metrics={'f1_val': 0.6342629319946713, 'auprc': 0.9995614803701446, 'loss_val': 0.3636308379723914, 'psi': 0.7803823513448607}-{'f1_val': 0.578855561913481, 'auprc': 0.999789580514389, 'loss_val': 0.5199613792783229, 'psi': 0.7472291693538442}
[S4] START round=25 head_norm_before_train=1.958604 (no previous merge yet)
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.9521173183968118, 'auprc': 0.9255913498489929, 'loss_val': 0.33378062646059226, 'psi': 0.9415069309776842}-{'f1_val': 0.9577690898778158, 'auprc': 0.9425643275497112, 'loss_val': 0.33564257050097374, 'psi': 0.951687184946574}
[S5] START round=25 head_norm_before_train=1.477046 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.513434 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9871734590552763, 'loss_val': 0.32204259350706466, 'psi': 0.815061742716926}-{'f1_val': 0.6256080416015863, 'auprc': 0.8554604945563129, 'loss_val': 0.5054969311228588, 'psi': 0.717549022783477}
[S6] START round=25 head_norm_before_train=1.869332 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.6169474620254691, 'auprc': 0.8245995606277823, 'loss_val': 0.8541263825377938, 'psi': 0.7000083014663944}-{'f1_val': 0.8400768117601501, 'auprc': 0.9538983528778279, 'loss_val': 0.43828069004370374, 'psi': 0.8856054282072212}
[S7] START round=25 head_norm_before_train=1.326281 cos_to_last_merge=1.0000 (last merge round=24)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.6997493224373046, 'auprc': 0.9938053820386842, 'loss_val': 0.4596463687386452, 'psi': 0.8173717462778565}-{'f1_val': 0.41648082873294934, 'auprc': 0.7759216826833054, 'loss_val': 1.0526204438389528, 'psi': 0.5602571703130917}
[S8] START round=25 head_norm_before_train=1.885414 cos_to_last_merge=0.8248 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.825
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.9754092583737635, 'auprc': 0.9989733070965585, 'loss_val': 0.06478863548239938, 'psi': 0.9848348778628815}-{'f1_val': 0.9886727134413368, 'auprc': 0.9989200988621809, 'loss_val': 0.04144053928710656, 'psi': 0.9927716676096745}
[S9] START round=25 head_norm_before_train=1.864632 (no previous merge yet)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9996037905372264, 'loss_val': 0.030192766299144438, 'psi': 0.9959544714055357}-{'f1_val': 0.9968525854255906, 'auprc': 0.997254305835672, 'loss_val': 0.028064752306815852, 'psi': 0.9970132735896231}
[S10] START round=25 head_norm_before_train=1.560938 cos_to_last_merge=0.9689 (last merge round=20)
[S10] round=25 local utility u=0.002569 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9920404113261403, 'loss_val': 0.058862982122325706, 'psi': 0.9940100368686944}-{'f1_val': 0.9939904298799414, 'auprc': 0.996426598017065, 'loss_val': 0.0691636384870387, 'psi': 0.9949648971347907}
[S11] START round=25 head_norm_before_train=1.946568 (no previous merge yet)
[S11] round=25 local utility u=0.141391 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979517768288481, 'loss_val': 0.03424283810183994, 'psi': 0.9969638112128558}-{'f1_val': 0.9595426378747243, 'auprc': 0.9979096839056439, 'loss_val': 0.09632353791365668, 'psi': 0.9748894562870921}
[S13] START round=25 head_norm_before_train=1.395785 cos_to_last_merge=0.9981 (last merge round=23)
[S13] round=25 local utility u=0.193107 metrics={'f1_val': 0.6117097623227392, 'auprc': 0.671538856288688, 'loss_val': 0.668643114347439, 'psi': 0.6356413999091187}-{'f1_val': 0.602498941656085, 'auprc': 0.6224617872128272, 'loss_val': 0.8523612264784912, 'psi': 0.6104840798787818}
[S14] START round=25 head_norm_before_train=1.197194 cos_to_last_merge=0.9988 (last merge round=23)
[S14] round=25 local utility u=0.022155 metrics={'f1_val': 0.9963900223018398, 'auprc': 0.996957083004139, 'loss_val': 0.17051924661457704, 'psi': 0.9966168465827595}-{'f1_val': 0.9964326399079161, 'auprc': 0.9986190114466064, 'loss_val': 0.22007145517411064, 'psi': 0.9973071885233922}
[S15] START round=25 head_norm_before_train=2.007119 (no previous merge yet)
[S15] round=25 local utility u=0.265812 metrics={'f1_val': 0.826613662609374, 'auprc': 0.9899097768115672, 'loss_val': 0.24295034391235226, 'psi': 0.8919321082902513}-{'f1_val': 0.7690893284264777, 'auprc': 0.987428255634714, 'loss_val': 0.42198351999459494, 'psi': 0.8564248993097723}
[S16] START round=25 head_norm_before_train=1.657312 cos_to_last_merge=0.7897 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=25 local utility u=0.222316 metrics={'f1_val': 0.9901292644866216, 'auprc': 0.9928925601676208, 'loss_val': 0.09067447649114661, 'psi': 0.9912345827590213}-{'f1_val': 0.9390264323888888, 'auprc': 0.9935002269501949, 'loss_val': 0.2305121057380533, 'psi': 0.9608159502134113}
[S17] START round=25 head_norm_before_train=1.706239 cos_to_last_merge=0.8112 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=25 local utility u=0.018120 metrics={'f1_val': 0.6340046841707021, 'auprc': 0.9635699488509837, 'loss_val': 0.6638650951915791, 'psi': 0.7658307900428147}-{'f1_val': 0.6665386978093155, 'auprc': 0.8378939697406254, 'loss_val': 0.5182804904219522, 'psi': 0.7350808065818395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:39813
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.9915
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.5853
[S14] RECEIVED delta(kind=head bytes=1804) from S3
[S14] cosine check vs S3: cos=0.1682
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] cosine check vs S15: cos=0.6757
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.8739
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=-0.2146
[S2] DROPPED delta from S11 (cos=-0.2146 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0986
[S3] DROPPED delta from S5 (cos=-0.0986 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=-0.0953
[S7] DROPPED delta from S14 (cos=-0.0953 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1804) from S7
[S13] cosine check vs S7: cos=0.9555
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=-0.0768
[S6] DROPPED delta from S2 (cos=-0.0768 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.1386
[S8] DROPPED delta from S17 (cos=-0.1386 < 0.0)
[S9] ⇄ pheromone p=0.035 → S7@127.0.0.1:39808
[S4] ⇄ pheromone p=0.075 → S14@127.0.0.1:39814
[S6] ⇄ pheromone p=0.186 → S7@127.0.0.1:39808
[S8] ⇄ pheromone p=0.033 → S5@127.0.0.1:39805
[S16] ⇄ pheromone p=0.201 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=0.105 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.061 → S6@127.0.0.1:39807
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=25 metric=0.7003 head_norm=1.501083
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.098491e-01
[S5] stored merged vector for next round verification (round=25)
[S5] DEBUG after merge:  round=25 metric=0.7003 head_norm=1.541128 delta_norm=0.109849
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.371 → S3@127.0.0.1:39803
[S7] ⇄ pheromone p=0.395 → S13@127.0.0.1:39813
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9953 head_norm=1.587777
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.864686e-01
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9953 head_norm=1.460224 delta_norm=0.386469
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.037 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.333 → S14@127.0.0.1:39814
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.9964 head_norm=1.245306
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.014444e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.9964 head_norm=1.158617 delta_norm=0.401444
[S14] aggregate: ACCEPT kept=['S16', 'S3', 'S15'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.095 → S7@127.0.0.1:39808
[S11] ⇄ pheromone p=0.085 → S2@127.0.0.1:39802
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6117 head_norm=1.429052
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.113343e-01
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6120 head_norm=1.367622 delta_norm=0.211334
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.072 → S10@127.0.0.1:39811
[S17] ⇄ pheromone p=0.186 → S8@127.0.0.1:39809
[S2] START round=26 head_norm_before_train=1.949493 (no previous merge yet)
[S2] round=26 local utility u=0.027967 metrics={'f1_val': 0.8893553038409199, 'auprc': 0.9778015120377131, 'loss_val': 0.26221345716479016, 'psi': 0.9247337871196372}-{'f1_val': 0.9088519468783456, 'auprc': 0.9201933048284239, 'loss_val': 0.26230171349154097, 'psi': 0.9133884900583769}
[S3] START round=26 head_norm_before_train=1.870312 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.6120028697343283, 'auprc': 0.9996433687770259, 'loss_val': 0.3700682828418447, 'psi': 0.7670590693514073}-{'f1_val': 0.6342629319946713, 'auprc': 0.9995614803701446, 'loss_val': 0.3636308379723914, 'psi': 0.7803823513448607}
[S4] START round=26 head_norm_before_train=1.965001 (no previous merge yet)
[S4] round=26 local utility u=0.060570 metrics={'f1_val': 0.9573705765637052, 'auprc': 0.9465822842027032, 'loss_val': 0.3071323625258951, 'psi': 0.9530552596193044}-{'f1_val': 0.9521173183968118, 'auprc': 0.9255913498489929, 'loss_val': 0.33378062646059226, 'psi': 0.9415069309776842}
[S5] START round=26 head_norm_before_train=1.541128 cos_to_last_merge=1.0000 (last merge round=25)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.6873608354167353, 'auprc': 0.9725597551199665, 'loss_val': 0.3314128344202076, 'psi': 0.8014404032980278}-{'f1_val': 0.700320598491359, 'auprc': 0.9871734590552763, 'loss_val': 0.32204259350706466, 'psi': 0.815061742716926}
[S6] START round=26 head_norm_before_train=1.886249 (no previous merge yet)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8217624201485307, 'auprc': 0.9487266072338464, 'loss_val': 0.41953289300527663, 'psi': 0.872548094982657}-{'f1_val': 0.6169474620254691, 'auprc': 0.8245995606277823, 'loss_val': 0.8541263825377938, 'psi': 0.7000083014663944}
[S7] START round=26 head_norm_before_train=1.337130 cos_to_last_merge=0.9998 (last merge round=24)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.52923564694384, 'auprc': 0.7875277876957749, 'loss_val': 0.881875689370829, 'psi': 0.632552503244614}-{'f1_val': 0.6997493224373046, 'auprc': 0.9938053820386842, 'loss_val': 0.4596463687386452, 'psi': 0.8173717462778565}
[S8] START round=26 head_norm_before_train=1.894144 cos_to_last_merge=0.8234 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.823
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9852370206290687, 'loss_val': 0.6032047953455286, 'psi': 0.8224803244591123}-{'f1_val': 0.9754092583737635, 'auprc': 0.9989733070965585, 'loss_val': 0.06478863548239938, 'psi': 0.9848348778628815}
[S9] START round=26 head_norm_before_train=1.878401 (no previous merge yet)
[S9] round=26 local utility u=0.009517 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972559625277407, 'loss_val': 0.02560224916483955, 'psi': 0.997164132518382}-{'f1_val': 0.9935215919844088, 'auprc': 0.9996037905372264, 'loss_val': 0.030192766299144438, 'psi': 0.9959544714055357}
[S10] START round=26 head_norm_before_train=1.460224 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9925370074424291, 'loss_val': 0.10201966109189262, 'psi': 0.9939451374352084}-{'f1_val': 0.9953231205637304, 'auprc': 0.9920404113261403, 'loss_val': 0.058862982122325706, 'psi': 0.9940100368686944}
[S11] START round=26 head_norm_before_train=1.962204 (no previous merge yet)
[S11] round=26 local utility u=0.000726 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979352434654528, 'loss_val': 0.03274085570840727, 'psi': 0.9969571978674977}-{'f1_val': 0.996305167468861, 'auprc': 0.9979517768288481, 'loss_val': 0.03424283810183994, 'psi': 0.9969638112128558}
[S13] START round=26 head_norm_before_train=1.367622 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.542316258783223, 'auprc': 0.588239569728869, 'loss_val': 0.9203583087153329, 'psi': 0.5606855831614814}-{'f1_val': 0.6117097623227392, 'auprc': 0.671538856288688, 'loss_val': 0.668643114347439, 'psi': 0.6356413999091187}
[S14] START round=26 head_norm_before_train=1.158617 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.001705 metrics={'f1_val': 0.9972114391202196, 'auprc': 0.9986494761332215, 'loss_val': 0.17711565838478527, 'psi': 0.9977866539254203}-{'f1_val': 0.9963900223018398, 'auprc': 0.996957083004139, 'loss_val': 0.17051924661457704, 'psi': 0.9966168465827595}
[S15] START round=26 head_norm_before_train=2.023223 (no previous merge yet)
[S15] round=26 local utility u=0.615106 metrics={'f1_val': 0.9935363317742903, 'auprc': 0.9954296136958523, 'loss_val': 0.030833869998569786, 'psi': 0.9942936445429151}-{'f1_val': 0.826613662609374, 'auprc': 0.9899097768115672, 'loss_val': 0.24295034391235226, 'psi': 0.8919321082902513}
[S16] START round=26 head_norm_before_train=1.684676 cos_to_last_merge=0.7872 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.787
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9914581070074141, 'auprc': 0.9889167090650737, 'loss_val': 0.09269678474766731, 'psi': 0.990441547830478}-{'f1_val': 0.9901292644866216, 'auprc': 0.9928925601676208, 'loss_val': 0.09067447649114661, 'psi': 0.9912345827590213}
[S17] START round=26 head_norm_before_train=1.717704 cos_to_last_merge=0.8099 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.6200118637342173, 'auprc': 0.9469903481162083, 'loss_val': 0.9384678797130688, 'psi': 0.7508032574870138}-{'f1_val': 0.6340046841707021, 'auprc': 0.9635699488509837, 'loss_val': 0.6638650951915791, 'psi': 0.7658307900428147}
[S2] not sending this round → trigger blocked (psi=0.925)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S9] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39808
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.994)
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.998)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1807 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1807) from S9
[S7] cosine check vs S9: cos=0.7962
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.3705
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.5790
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.9972 head_norm=1.204563
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.512859e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.9966 head_norm=1.338259 delta_norm=0.951286
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.5292 head_norm=1.349830
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.180085e-01
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.5264 head_norm=1.331487 delta_norm=0.118008
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.958219 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.8332782195292747, 'auprc': 0.989687716530915, 'loss_val': 0.3438319596926978, 'psi': 0.8958420183299308}-{'f1_val': 0.8893553038409199, 'auprc': 0.9778015120377131, 'loss_val': 0.26221345716479016, 'psi': 0.9247337871196372}
[S3] START round=27 head_norm_before_train=1.886737 (no previous merge yet)
[S3] round=27 local utility u=0.686338 metrics={'f1_val': 0.8330513560047257, 'auprc': 0.9998228785650027, 'loss_val': 0.3242225782695979, 'psi': 0.8997599650288365}-{'f1_val': 0.6120028697343283, 'auprc': 0.9996433687770259, 'loss_val': 0.3700682828418447, 'psi': 0.7670590693514073}
[S4] START round=27 head_norm_before_train=1.985143 (no previous merge yet)
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9563113434011599, 'auprc': 0.9512475045626276, 'loss_val': 0.3364272856847759, 'psi': 0.954285807865747}-{'f1_val': 0.9573705765637052, 'auprc': 0.9465822842027032, 'loss_val': 0.3071323625258951, 'psi': 0.9530552596193044}
[S5] START round=27 head_norm_before_train=1.560222 cos_to_last_merge=0.9997 (last merge round=25)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.42816797245029226, 'auprc': 0.8552936301415643, 'loss_val': 1.0192475406834562, 'psi': 0.5990182355268011}-{'f1_val': 0.6873608354167353, 'auprc': 0.9725597551199665, 'loss_val': 0.3314128344202076, 'psi': 0.8014404032980278}
[S6] START round=27 head_norm_before_train=1.897636 (no previous merge yet)
[S6] round=27 local utility u=0.533391 metrics={'f1_val': 0.9585402185050291, 'auprc': 0.966638549790819, 'loss_val': 0.22715429989808752, 'psi': 0.961779551019345}-{'f1_val': 0.8217624201485307, 'auprc': 0.9487266072338464, 'loss_val': 0.41953289300527663, 'psi': 0.872548094982657}
[S7] START round=27 head_norm_before_train=1.331487 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.699923887872006, 'auprc': 0.9945663743910019, 'loss_val': 0.42803293920071667, 'psi': 0.8177808824796045}-{'f1_val': 0.52923564694384, 'auprc': 0.7875277876957749, 'loss_val': 0.881875689370829, 'psi': 0.632552503244614}
[S8] START round=27 head_norm_before_train=1.905275 cos_to_last_merge=0.8225 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.823
[S8] round=27 local utility u=0.916644 metrics={'f1_val': 0.9340412095251985, 'auprc': 0.999025460776156, 'loss_val': 0.1316735989342838, 'psi': 0.9600349100255816}-{'f1_val': 0.7139758603458082, 'auprc': 0.9852370206290687, 'loss_val': 0.6032047953455286, 'psi': 0.8224803244591123}
[S9] START round=27 head_norm_before_train=1.893226 (no previous merge yet)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.999606711254924, 'loss_val': 0.02949549013833076, 'psi': 0.995183676001499}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972559625277407, 'loss_val': 0.02560224916483955, 'psi': 0.997164132518382}
[S10] START round=27 head_norm_before_train=1.498207 cos_to_last_merge=0.9995 (last merge round=25)
[S10] round=27 local utility u=0.012699 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9917556564679617, 'loss_val': 0.07691285725654344, 'psi': 0.993896134925423}-{'f1_val': 0.9948838907637279, 'auprc': 0.9925370074424291, 'loss_val': 0.10201966109189262, 'psi': 0.9939451374352084}
[S11] START round=27 head_norm_before_train=1.977647 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9559347661656555, 'auprc': 0.9978193771633137, 'loss_val': 0.17530094762760665, 'psi': 0.9726886105647188}-{'f1_val': 0.996305167468861, 'auprc': 0.9979352434654528, 'loss_val': 0.03274085570840727, 'psi': 0.9969571978674977}
[S13] START round=27 head_norm_before_train=1.400258 cos_to_last_merge=0.9987 (last merge round=25)
[S13] round=27 local utility u=0.223098 metrics={'f1_val': 0.5559478863147111, 'auprc': 0.6822490065124857, 'loss_val': 0.8379811099615957, 'psi': 0.606468334393821}-{'f1_val': 0.542316258783223, 'auprc': 0.588239569728869, 'loss_val': 0.9203583087153329, 'psi': 0.5606855831614814}
[S14] START round=27 head_norm_before_train=1.338259 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.9523701080590166, 'auprc': 0.998664853394029, 'loss_val': 0.22021954459846071, 'psi': 0.9708880061930215}-{'f1_val': 0.9972114391202196, 'auprc': 0.9986494761332215, 'loss_val': 0.17711565838478527, 'psi': 0.9977866539254203}
[S15] START round=27 head_norm_before_train=2.040283 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.775971253905712, 'auprc': 0.9898352969117359, 'loss_val': 0.4002775268205255, 'psi': 0.8615168711081216}-{'f1_val': 0.9935363317742903, 'auprc': 0.9954296136958523, 'loss_val': 0.030833869998569786, 'psi': 0.9942936445429151}
[S16] START round=27 head_norm_before_train=1.710324 cos_to_last_merge=0.7851 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9408947530498225, 'auprc': 0.9917281741797007, 'loss_val': 0.1916116636859776, 'psi': 0.9612281215017737}-{'f1_val': 0.9914581070074141, 'auprc': 0.9889167090650737, 'loss_val': 0.09269678474766731, 'psi': 0.990441547830478}
[S17] START round=27 head_norm_before_train=1.745956 cos_to_last_merge=0.8072 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=27 local utility u=0.326397 metrics={'f1_val': 0.6640290622579148, 'auprc': 0.9770578861983422, 'loss_val': 0.6399800025732925, 'psi': 0.7892405918340858}-{'f1_val': 0.6200118637342173, 'auprc': 0.9469903481162083, 'loss_val': 0.9384678797130688, 'psi': 0.7508032574870138}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:39813
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39805
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.1778
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9372
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.6402
[S13] RECEIVED delta(kind=head bytes=1805) from S7
[S13] cosine check vs S7: cos=0.9622
[S5] RECEIVED delta(kind=head bytes=1802) from S10
[S5] cosine check vs S10: cos=0.9699
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0385
[S5] DROPPED delta from S8 (cos=-0.0385 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.1351
[S8] DROPPED delta from S17 (cos=-0.1351 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.9524 head_norm=1.371246
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.069250e+00
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.9481 head_norm=1.267781 delta_norm=1.069250
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=27 metric=0.4282 head_norm=1.575495
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.920889e-01
[S5] stored merged vector for next round verification (round=27)
[S5] DEBUG after merge:  round=27 metric=0.4294 head_norm=1.551402 delta_norm=0.192089
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=27 metric=0.9953 head_norm=1.550905
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.705077e-01
[S10] stored merged vector for next round verification (round=27)
[S10] DEBUG after merge:  round=27 metric=0.9953 head_norm=1.472053 delta_norm=0.270508
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5559 head_norm=1.440460
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.971863e-01
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5547 head_norm=1.380907 delta_norm=0.197186
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6999 head_norm=1.347830
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.404642e-01
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6999 head_norm=1.485439 delta_norm=0.740464
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.969593 (no previous merge yet)
[S2] round=28 local utility u=0.015593 metrics={'f1_val': 0.836363370324598, 'auprc': 0.9911186064059881, 'loss_val': 0.33544961025925973, 'psi': 0.8982654647571541}-{'f1_val': 0.8332782195292747, 'auprc': 0.989687716530915, 'loss_val': 0.3438319596926978, 'psi': 0.8958420183299308}
[S3] START round=28 head_norm_before_train=1.902844 (no previous merge yet)
[S3] round=28 local utility u=0.385095 metrics={'f1_val': 0.9305745082075645, 'auprc': 0.9995215169564872, 'loss_val': 0.13826693480448346, 'psi': 0.9581533117071336}-{'f1_val': 0.8330513560047257, 'auprc': 0.9998228785650027, 'loss_val': 0.3242225782695979, 'psi': 0.8997599650288365}
[S4] START round=28 head_norm_before_train=2.000163 (no previous merge yet)
[S4] round=28 local utility u=0.020116 metrics={'f1_val': 0.9576180514304193, 'auprc': 0.9513130159078097, 'loss_val': 0.30423287144484745, 'psi': 0.9550960372213755}-{'f1_val': 0.9563113434011599, 'auprc': 0.9512475045626276, 'loss_val': 0.3364272856847759, 'psi': 0.954285807865747}
[S5] START round=28 head_norm_before_train=1.551402 cos_to_last_merge=1.0000 (last merge round=27)
[S5] round=28 local utility u=0.881470 metrics={'f1_val': 0.6598276743210716, 'auprc': 0.7992904740763012, 'loss_val': 0.4782559155738635, 'psi': 0.7156127942231634}-{'f1_val': 0.42816797245029226, 'auprc': 0.8552936301415643, 'loss_val': 1.0192475406834562, 'psi': 0.5990182355268011}
[S6] START round=28 head_norm_before_train=1.921715 (no previous merge yet)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.5933905819988399, 'auprc': 0.6976198827426425, 'loss_val': 1.1247324887520722, 'psi': 0.635082302296361}-{'f1_val': 0.9585402185050291, 'auprc': 0.966638549790819, 'loss_val': 0.22715429989808752, 'psi': 0.961779551019345}
[S7] START round=28 head_norm_before_train=1.485439 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4574923681607562, 'auprc': 0.7503691283721087, 'loss_val': 1.0352090219342458, 'psi': 0.5746430722452972}-{'f1_val': 0.699923887872006, 'auprc': 0.9945663743910019, 'loss_val': 0.42803293920071667, 'psi': 0.8177808824796045}
[S8] START round=28 head_norm_before_train=1.906591 cos_to_last_merge=0.8218 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=28 local utility u=0.224454 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9988996434184533, 'loss_val': 0.033962403347758914, 'psi': 0.9951419517033495}-{'f1_val': 0.9340412095251985, 'auprc': 0.999025460776156, 'loss_val': 0.1316735989342838, 'psi': 0.9600349100255816}
[S9] START round=28 head_norm_before_train=1.904361 (no previous merge yet)
[S9] round=28 local utility u=0.000136 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9996073887793637, 'loss_val': 0.029224835031347467, 'psi': 0.995183947011275}-{'f1_val': 0.9922349858325491, 'auprc': 0.999606711254924, 'loss_val': 0.02949549013833076, 'psi': 0.995183676001499}
[S10] START round=28 head_norm_before_train=1.472053 cos_to_last_merge=1.0000 (last merge round=27)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9952983820976775, 'loss_val': 0.10735923884248015, 'psi': 0.9953132251773091}-{'f1_val': 0.9953231205637304, 'auprc': 0.9917556564679617, 'loss_val': 0.07691285725654344, 'psi': 0.993896134925423}
[S11] START round=28 head_norm_before_train=1.992979 (no previous merge yet)
[S11] round=28 local utility u=0.193494 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978224191443132, 'loss_val': 0.030544155222957538, 'psi': 0.9969120681390419}-{'f1_val': 0.9559347661656555, 'auprc': 0.9978193771633137, 'loss_val': 0.17530094762760665, 'psi': 0.9726886105647188}
[S13] START round=28 head_norm_before_train=1.380907 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.059372 metrics={'f1_val': 0.5773714469651838, 'auprc': 0.6750156842356577, 'loss_val': 0.8260787951060392, 'psi': 0.6164291418733734}-{'f1_val': 0.5559478863147111, 'auprc': 0.6822490065124857, 'loss_val': 0.8379811099615957, 'psi': 0.606468334393821}
[S14] START round=28 head_norm_before_train=1.267781 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.113177 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9972094002138274, 'loss_val': 0.25740024632699376, 'psi': 0.9970959337592564}-{'f1_val': 0.9523701080590166, 'auprc': 0.998664853394029, 'loss_val': 0.22021954459846071, 'psi': 0.9708880061930215}
[S15] START round=28 head_norm_before_train=2.057128 (no previous merge yet)
[S15] round=28 local utility u=0.820107 metrics={'f1_val': 0.9895807945969549, 'auprc': 0.9941660389667119, 'loss_val': 0.05471315264924756, 'psi': 0.9914148923448576}-{'f1_val': 0.775971253905712, 'auprc': 0.9898352969117359, 'loss_val': 0.4002775268205255, 'psi': 0.8615168711081216}
[S16] START round=28 head_norm_before_train=1.734535 cos_to_last_merge=0.7832 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.783
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.8438067539929539, 'auprc': 0.907777091047918, 'loss_val': 0.8063644309472835, 'psi': 0.8693948888149396}-{'f1_val': 0.9408947530498225, 'auprc': 0.9917281741797007, 'loss_val': 0.1916116636859776, 'psi': 0.9612281215017737}
[S17] START round=28 head_norm_before_train=1.774112 cos_to_last_merge=0.8046 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.805
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6220606637146848, 'auprc': 0.9449524099645514, 'loss_val': 1.1717401211005236, 'psi': 0.7512173622146314}-{'f1_val': 0.6640290622579148, 'auprc': 0.9770578861983422, 'loss_val': 0.6399800025732925, 'psi': 0.7892405918340858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:39814
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:39814
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S5] → sending delta(kind=head bytes=1810) to S3@127.0.0.1:39803
[S5] sending update (kind=head size=1810 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1810) from S5
[S3] cosine check vs S5: cos=-0.0987
[S3] DROPPED delta from S5 (cos=-0.0987 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=0.5391
[S14] RECEIVED delta(kind=head bytes=1802) from S3
[S14] cosine check vs S3: cos=0.8382
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=-0.1215
[S7] DROPPED delta from S14 (cos=-0.1215 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=0.9621
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=-0.0740
[S6] DROPPED delta from S2 (cos=-0.0740 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.1907
[S7] RECEIVED delta(kind=head bytes=1805) from S9
[S7] cosine check vs S9: cos=0.3268
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=-0.2122
[S2] DROPPED delta from S11 (cos=-0.2122 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=-0.0351
[S5] DROPPED delta from S8 (cos=-0.0351 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9953 head_norm=1.525010
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.093460e-01
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9953 head_norm=1.456921 delta_norm=0.209346
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.4575 head_norm=1.500128
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.005520e+00
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.4528 head_norm=1.396701 delta_norm=1.005520
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.9970 head_norm=1.296354
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.072071e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.9970 head_norm=1.205432 delta_norm=0.307207
[S14] aggregate: ACCEPT kept=['S4', 'S3', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.981036 (no previous merge yet)
[S2] round=29 local utility u=0.029530 metrics={'f1_val': 0.843153894849203, 'auprc': 0.9875830439415114, 'loss_val': 0.3065258264487031, 'psi': 0.9009255544861263}-{'f1_val': 0.836363370324598, 'auprc': 0.9911186064059881, 'loss_val': 0.33544961025925973, 'psi': 0.8982654647571541}
[S3] START round=29 head_norm_before_train=1.918146 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.8300402556705998, 'auprc': 0.9992754089961537, 'loss_val': 0.3106539421456877, 'psi': 0.8977343170008214}-{'f1_val': 0.9305745082075645, 'auprc': 0.9995215169564872, 'loss_val': 0.13826693480448346, 'psi': 0.9581533117071336}
[S4] START round=29 head_norm_before_train=2.010035 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9538813846833951, 'auprc': 0.9522289825650698, 'loss_val': 0.31214060793061854, 'psi': 0.953220423836065}-{'f1_val': 0.9576180514304193, 'auprc': 0.9513130159078097, 'loss_val': 0.30423287144484745, 'psi': 0.9550960372213755}
[S5] START round=29 head_norm_before_train=1.560920 cos_to_last_merge=0.9999 (last merge round=27)
[S5] round=29 local utility u=0.489798 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.991167409394479, 'loss_val': 0.31725180864648495, 'psi': 0.8166597542181399}-{'f1_val': 0.6598276743210716, 'auprc': 0.7992904740763012, 'loss_val': 0.4782559155738635, 'psi': 0.7156127942231634}
[S6] START round=29 head_norm_before_train=1.937020 (no previous merge yet)
[S6] round=29 local utility u=0.895090 metrics={'f1_val': 0.7037069699320133, 'auprc': 0.9443064544122903, 'loss_val': 0.7365103309031047, 'psi': 0.7999467637241241}-{'f1_val': 0.5933905819988399, 'auprc': 0.6976198827426425, 'loss_val': 1.1247324887520722, 'psi': 0.635082302296361}
[S7] START round=29 head_norm_before_train=1.396701 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=1.000000 metrics={'f1_val': 0.6701675393806821, 'auprc': 0.8817550694822547, 'loss_val': 0.5143747149056601, 'psi': 0.7548025514213111}-{'f1_val': 0.4574923681607562, 'auprc': 0.7503691283721087, 'loss_val': 1.0352090219342458, 'psi': 0.5746430722452972}
[S8] START round=29 head_norm_before_train=1.911128 cos_to_last_merge=0.8212 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.821
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9897076210669344, 'auprc': 0.999025948704938, 'loss_val': 0.03849634588599177, 'psi': 0.9934349521221358}-{'f1_val': 0.9926368238932805, 'auprc': 0.9988996434184533, 'loss_val': 0.033962403347758914, 'psi': 0.9951419517033495}
[S9] START round=29 head_norm_before_train=1.916587 (no previous merge yet)
[S9] round=29 local utility u=0.011337 metrics={'f1_val': 0.9962461149658858, 'auprc': 0.9970470332725558, 'loss_val': 0.02293587889713782, 'psi': 0.9965664822885538}-{'f1_val': 0.9922349858325491, 'auprc': 0.9996073887793637, 'loss_val': 0.029224835031347467, 'psi': 0.995183947011275}
[S10] START round=29 head_norm_before_train=1.456921 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.992361759168431, 'loss_val': 0.11551122056703435, 'psi': 0.9941385760056105}-{'f1_val': 0.9953231205637304, 'auprc': 0.9952983820976775, 'loss_val': 0.10735923884248015, 'psi': 0.9953132251773091}
[S11] START round=29 head_norm_before_train=2.008611 (no previous merge yet)
[S11] round=29 local utility u=0.000000 metrics={'f1_val': 0.9960642655951585, 'auprc': 0.9978148461484511, 'loss_val': 0.03364747474926174, 'psi': 0.9967644978164756}-{'f1_val': 0.996305167468861, 'auprc': 0.9978224191443132, 'loss_val': 0.030544155222957538, 'psi': 0.9969120681390419}
[S13] START round=29 head_norm_before_train=1.416768 cos_to_last_merge=0.9986 (last merge round=27)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5927560356371652, 'auprc': 0.6503620575823523, 'loss_val': 0.8774805414442239, 'psi': 0.61579844441524}-{'f1_val': 0.5773714469651838, 'auprc': 0.6750156842356577, 'loss_val': 0.8260787951060392, 'psi': 0.6164291418733734}
[S14] START round=29 head_norm_before_train=1.205432 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.011662 metrics={'f1_val': 0.9964128278275759, 'auprc': 0.9938789177275664, 'loss_val': 0.22044063682801154, 'psi': 0.995399263787572}-{'f1_val': 0.9970202894562089, 'auprc': 0.9972094002138274, 'loss_val': 0.25740024632699376, 'psi': 0.9970959337592564}
[S15] START round=29 head_norm_before_train=2.074575 (no previous merge yet)
[S15] round=29 local utility u=0.015890 metrics={'f1_val': 0.993906773249813, 'auprc': 0.990838009221544, 'loss_val': 0.03890441433092246, 'psi': 0.9926792676385054}-{'f1_val': 0.9895807945969549, 'auprc': 0.9941660389667119, 'loss_val': 0.05471315264924756, 'psi': 0.9914148923448576}
[S16] START round=29 head_norm_before_train=1.750979 cos_to_last_merge=0.7814 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=29 local utility u=0.935477 metrics={'f1_val': 0.9911716534994917, 'auprc': 0.9895951244840031, 'loss_val': 0.0650540603896933, 'psi': 0.9905410418932963}-{'f1_val': 0.8438067539929539, 'auprc': 0.907777091047918, 'loss_val': 0.8063644309472835, 'psi': 0.8693948888149396}
[S17] START round=29 head_norm_before_train=1.798609 cos_to_last_merge=0.8024 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.802
[S17] round=29 local utility u=0.121786 metrics={'f1_val': 0.640251493759643, 'auprc': 0.958245868049034, 'loss_val': 1.0771929515429814, 'psi': 0.7674492434753994}-{'f1_val': 0.6220606637146848, 'auprc': 0.9449524099645514, 'loss_val': 1.1717401211005236, 'psi': 0.7512173622146314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:39813
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S7] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S5
[S3] cosine check vs S5: cos=-0.0994
[S3] DROPPED delta from S5 (cos=-0.0994 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.8598
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.3812
[S14] RECEIVED delta(kind=head bytes=1801) from S16
[S14] cosine check vs S16: cos=0.1810
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.4843
[S13] RECEIVED delta(kind=head bytes=1803) from S7
[S13] cosine check vs S7: cos=0.9671
[S7] RECEIVED delta(kind=head bytes=1801) from S14
[S7] cosine check vs S14: cos=-0.1228
[S7] DROPPED delta from S14 (cos=-0.1228 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0737
[S6] DROPPED delta from S2 (cos=-0.0737 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=-0.1343
[S8] DROPPED delta from S17 (cos=-0.1343 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=29 metric=0.5928 head_norm=1.457142
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.853481e-01
[S13] stored merged vector for next round verification (round=29)
[S13] DEBUG after merge:  round=29 metric=0.5951 head_norm=1.422718 delta_norm=0.185348
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=29 metric=0.6702 head_norm=1.411983
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.915117e-01
[S7] stored merged vector for next round verification (round=29)
[S7] DEBUG after merge:  round=29 metric=0.6660 head_norm=1.367840 delta_norm=0.191512
[S7] aggregate: ACCEPT kept=['S9', 'S6'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.9964 head_norm=1.240321
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.162023e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.9966 head_norm=1.165556 delta_norm=0.816202
[S14] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.990546 (no previous merge yet)
[S2] round=30 local utility u=0.082024 metrics={'f1_val': 0.887110448045138, 'auprc': 0.944303388972553, 'loss_val': 0.27637790112457855, 'psi': 0.9099876244161039}-{'f1_val': 0.843153894849203, 'auprc': 0.9875830439415114, 'loss_val': 0.3065258264487031, 'psi': 0.9009255544861263}
[S3] START round=30 head_norm_before_train=1.934806 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8006089527029608, 'auprc': 0.9988408141402427, 'loss_val': 0.42769338984400107, 'psi': 0.8799016972778736}-{'f1_val': 0.8300402556705998, 'auprc': 0.9992754089961537, 'loss_val': 0.3106539421456877, 'psi': 0.8977343170008214}
[S4] START round=30 head_norm_before_train=2.019099 (no previous merge yet)
[S4] round=30 local utility u=0.004883 metrics={'f1_val': 0.9537456199310195, 'auprc': 0.9544871661533533, 'loss_val': 0.3083343678023795, 'psi': 0.954042238419953}-{'f1_val': 0.9538813846833951, 'auprc': 0.9522289825650698, 'loss_val': 0.31214060793061854, 'psi': 0.953220423836065}
[S5] START round=30 head_norm_before_train=1.570395 cos_to_last_merge=0.9997 (last merge round=27)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.5454798858792772, 'auprc': 0.673177908040968, 'loss_val': 0.7567325714967946, 'psi': 0.5965590947439535}-{'f1_val': 0.7003213174339138, 'auprc': 0.991167409394479, 'loss_val': 0.31725180864648495, 'psi': 0.8166597542181399}
[S6] START round=30 head_norm_before_train=1.941513 (no previous merge yet)
[S6] round=30 local utility u=0.785216 metrics={'f1_val': 0.87797280711394, 'auprc': 0.9626452766808448, 'loss_val': 0.26668882566937024, 'psi': 0.9118417949407018}-{'f1_val': 0.7037069699320133, 'auprc': 0.9443064544122903, 'loss_val': 0.7365103309031047, 'psi': 0.7999467637241241}
[S7] START round=30 head_norm_before_train=1.367840 cos_to_last_merge=1.0000 (last merge round=29)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6518852190451542, 'auprc': 0.836840432545181, 'loss_val': 0.5685104150791639, 'psi': 0.7258673044451649}-{'f1_val': 0.6701675393806821, 'auprc': 0.8817550694822547, 'loss_val': 0.5143747149056601, 'psi': 0.7548025514213111}
[S8] START round=30 head_norm_before_train=1.924352 cos_to_last_merge=0.8202 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.820
[S8] round=30 local utility u=0.008243 metrics={'f1_val': 0.9935544930252161, 'auprc': 0.9947093836691036, 'loss_val': 0.03214162103732043, 'psi': 0.994016449282771}-{'f1_val': 0.9897076210669344, 'auprc': 0.999025948704938, 'loss_val': 0.03849634588599177, 'psi': 0.9934349521221358}
[S9] START round=30 head_norm_before_train=1.928225 (no previous merge yet)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9905518720143266, 'auprc': 0.999607343741937, 'loss_val': 0.034021121551867504, 'psi': 0.9941740607053708}-{'f1_val': 0.9962461149658858, 'auprc': 0.9970470332725558, 'loss_val': 0.02293587889713782, 'psi': 0.9965664822885538}
[S10] START round=30 head_norm_before_train=1.517769 cos_to_last_merge=0.9980 (last merge round=28)
[S10] round=30 local utility u=0.019322 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9939667629662696, 'loss_val': 0.07772995101036512, 'psi': 0.9943853381921577}-{'f1_val': 0.9953231205637304, 'auprc': 0.992361759168431, 'loss_val': 0.11551122056703435, 'psi': 0.9941385760056105}
[S11] START round=30 head_norm_before_train=2.024081 (no previous merge yet)
[S11] round=30 local utility u=0.003305 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977946106027816, 'loss_val': 0.02842270355884017, 'psi': 0.9969009447224293}-{'f1_val': 0.9960642655951585, 'auprc': 0.9978148461484511, 'loss_val': 0.03364747474926174, 'psi': 0.9967644978164756}
[S13] START round=30 head_norm_before_train=1.422718 cos_to_last_merge=1.0000 (last merge round=29)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.563334850929532, 'auprc': 0.6762616705726002, 'loss_val': 0.8354741888317424, 'psi': 0.6085055787867593}-{'f1_val': 0.5927560356371652, 'auprc': 0.6503620575823523, 'loss_val': 0.8774805414442239, 'psi': 0.61579844441524}
[S14] START round=30 head_norm_before_train=1.165556 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.031333 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9987172840529168, 'loss_val': 0.17725584340455136, 'psi': 0.9978311276446425}-{'f1_val': 0.9964128278275759, 'auprc': 0.9938789177275664, 'loss_val': 0.22044063682801154, 'psi': 0.995399263787572}
[S15] START round=30 head_norm_before_train=2.089363 (no previous merge yet)
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7057482516866472, 'auprc': 0.9416962847630916, 'loss_val': 0.591271206862201, 'psi': 0.800127464917225}-{'f1_val': 0.993906773249813, 'auprc': 0.990838009221544, 'loss_val': 0.03890441433092246, 'psi': 0.9926792676385054}
[S16] START round=30 head_norm_before_train=1.766975 cos_to_last_merge=0.7801 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.8687815715968273, 'auprc': 0.9907628858978067, 'loss_val': 0.6179778358732343, 'psi': 0.9175740973172191}-{'f1_val': 0.9911716534994917, 'auprc': 0.9895951244840031, 'loss_val': 0.0650540603896933, 'psi': 0.9905410418932963}
[S17] START round=30 head_norm_before_train=1.820029 cos_to_last_merge=0.8005 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=30 local utility u=0.469483 metrics={'f1_val': 0.7273543281283458, 'auprc': 0.9597352146997974, 'loss_val': 0.6653126149571712, 'psi': 0.8203066827569264}-{'f1_val': 0.640251493759643, 'auprc': 0.958245868049034, 'loss_val': 1.0771929515429814, 'psi': 0.7674492434753994}
[S2] not sending this round → trigger blocked (psi=0.910)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.912)
[S14] not sending this round → trigger blocked (psi=0.998)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.3572
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=-0.2114
[S2] DROPPED delta from S11 (cos=-0.2114 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=-0.0348
[S5] DROPPED delta from S8 (cos=-0.0348 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=0.9504
[S17] not sending this round → trigger blocked (psi=0.820)
[S7] ⇄ pheromone p=0.392 → S13@127.0.0.1:39813
[S9] ⇄ pheromone p=0.014 → S7@127.0.0.1:39808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.5455 head_norm=1.584107
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.493661e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.5525 head_norm=1.563184 delta_norm=0.249366
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.313 → S3@127.0.0.1:39803
[S3] ⇄ pheromone p=0.154 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.045 → S6@127.0.0.1:39807
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.9972 head_norm=1.210128
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.752972e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.9966 head_norm=1.350984 delta_norm=0.975297
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.054 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.054 → S10@127.0.0.1:39811
[S6] ⇄ pheromone p=0.498 → S7@127.0.0.1:39808
[S15] ⇄ pheromone p=0.267 → S14@127.0.0.1:39814
[S10] ⇄ pheromone p=0.017 → S5@127.0.0.1:39805
[S8] ⇄ pheromone p=0.135 → S5@127.0.0.1:39805
[S4] ⇄ pheromone p=0.033 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.053 → S2@127.0.0.1:39802
[S17] ⇄ pheromone p=0.208 → S8@127.0.0.1:39809
[S16] ⇄ pheromone p=0.215 → S14@127.0.0.1:39814
[S2] START round=31 head_norm_before_train=2.001836 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.9150373811659969, 'auprc': 0.8464227076075339, 'loss_val': 0.27463178799300547, 'psi': 0.8875915117426116}-{'f1_val': 0.887110448045138, 'auprc': 0.944303388972553, 'loss_val': 0.27637790112457855, 'psi': 0.9099876244161039}
[S3] START round=31 head_norm_before_train=1.951805 (no previous merge yet)
[S3] round=31 local utility u=0.244252 metrics={'f1_val': 0.8550475295381058, 'auprc': 0.9996312332028181, 'loss_val': 0.26819192252521823, 'psi': 0.9128810110039908}-{'f1_val': 0.8006089527029608, 'auprc': 0.9988408141402427, 'loss_val': 0.42769338984400107, 'psi': 0.8799016972778736}
[S4] START round=31 head_norm_before_train=2.021958 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9538650640742525, 'auprc': 0.9328258802196645, 'loss_val': 0.3109835223364069, 'psi': 0.9454493905324173}-{'f1_val': 0.9537456199310195, 'auprc': 0.9544871661533533, 'loss_val': 0.3083343678023795, 'psi': 0.954042238419953}
[S5] START round=31 head_norm_before_train=1.563184 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9392264353470589, 'loss_val': 0.38755230227252496, 'psi': 0.7958833645991719}-{'f1_val': 0.5454798858792772, 'auprc': 0.673177908040968, 'loss_val': 0.7567325714967946, 'psi': 0.5965590947439535}
[S6] START round=31 head_norm_before_train=1.952172 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8672862308341898, 'auprc': 0.954889952352562, 'loss_val': 0.3556255167458599, 'psi': 0.9023277194415387}-{'f1_val': 0.87797280711394, 'auprc': 0.9626452766808448, 'loss_val': 0.26668882566937024, 'psi': 0.9118417949407018}
[S7] START round=31 head_norm_before_train=1.383995 cos_to_last_merge=0.9995 (last merge round=29)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.6370551497426469, 'auprc': 0.8124291629547615, 'loss_val': 0.614898515575701, 'psi': 0.7072047550274927}-{'f1_val': 0.6518852190451542, 'auprc': 0.836840432545181, 'loss_val': 0.5685104150791639, 'psi': 0.7258673044451649}
[S8] START round=31 head_norm_before_train=1.939205 cos_to_last_merge=0.8191 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=31 local utility u=0.000008 metrics={'f1_val': 0.9919085369259982, 'auprc': 0.9990103759390345, 'loss_val': 0.035153377466316416, 'psi': 0.9947492725312127}-{'f1_val': 0.9935544930252161, 'auprc': 0.9947093836691036, 'loss_val': 0.03214162103732043, 'psi': 0.994016449282771}
[S9] START round=31 head_norm_before_train=1.940222 (no previous merge yet)
[S9] round=31 local utility u=0.018693 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9981934763584704, 'loss_val': 0.022740498571445444, 'psi': 0.9966432768172501}-{'f1_val': 0.9905518720143266, 'auprc': 0.999607343741937, 'loss_val': 0.034021121551867504, 'psi': 0.9941740607053708}
[S10] START round=31 head_norm_before_train=1.581790 cos_to_last_merge=0.9932 (last merge round=28)
[S10] round=31 local utility u=0.008755 metrics={'f1_val': 0.9946643883427498, 'auprc': 0.9941497822632054, 'loss_val': 0.060769902607908974, 'psi': 0.9944585459109321}-{'f1_val': 0.9946643883427498, 'auprc': 0.9939667629662696, 'loss_val': 0.07772995101036512, 'psi': 0.9943853381921577}
[S11] START round=31 head_norm_before_train=2.039190 (no previous merge yet)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997869912188769, 'loss_val': 0.029535878293607046, 'psi': 0.9969310653568242}-{'f1_val': 0.996305167468861, 'auprc': 0.9977946106027816, 'loss_val': 0.02842270355884017, 'psi': 0.9969009447224293}
[S13] START round=31 head_norm_before_train=1.457629 cos_to_last_merge=0.9990 (last merge round=29)
[S13] round=31 local utility u=0.090867 metrics={'f1_val': 0.5899509169189286, 'auprc': 0.6769231836376759, 'loss_val': 0.8154220485487401, 'psi': 0.6247398236064275}-{'f1_val': 0.563334850929532, 'auprc': 0.6762616705726002, 'loss_val': 0.8354741888317424, 'psi': 0.6085055787867593}
[S14] START round=31 head_norm_before_train=1.350984 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.001204 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9970050161085642, 'loss_val': 0.1644723466290015, 'psi': 0.9966223053068164}-{'f1_val': 0.997240356705793, 'auprc': 0.9987172840529168, 'loss_val': 0.17725584340455136, 'psi': 0.9978311276446425}
[S15] START round=31 head_norm_before_train=2.104322 (no previous merge yet)
[S15] round=31 local utility u=1.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9946068226787097, 'loss_val': 0.02425860371856495, 'psi': 0.9956421755807684}-{'f1_val': 0.7057482516866472, 'auprc': 0.9416962847630916, 'loss_val': 0.591271206862201, 'psi': 0.800127464917225}
[S16] START round=31 head_norm_before_train=1.782851 cos_to_last_merge=0.7789 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.8448815831268311, 'auprc': 0.9899966288531402, 'loss_val': 0.8297154192621412, 'psi': 0.9029276014173548}-{'f1_val': 0.8687815715968273, 'auprc': 0.9907628858978067, 'loss_val': 0.6179778358732343, 'psi': 0.9175740973172191}
[S17] START round=31 head_norm_before_train=1.841853 cos_to_last_merge=0.7987 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.799
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6384058071978018, 'auprc': 0.9485720020169202, 'loss_val': 1.3087990068598767, 'psi': 0.7624722851254492}-{'f1_val': 0.7273543281283458, 'auprc': 0.9597352146997974, 'loss_val': 0.6653126149571712, 'psi': 0.8203066827569264}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39811
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S10] not sending this round → trigger blocked (psi=0.994)
[S8] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.7827
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.1009
[S7] DROPPED delta from S14 (cos=-0.1009 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.1027
[S3] DROPPED delta from S5 (cos=-0.1027 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S3
[S14] cosine check vs S3: cos=0.2162
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.3967
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.9615
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=31 metric=0.9947 head_norm=1.635632
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.281564e-01
[S10] stored merged vector for next round verification (round=31)
[S10] DEBUG after merge:  round=31 metric=0.9947 head_norm=1.549499 delta_norm=0.228156
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.6371 head_norm=1.399651
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.104263e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.6343 head_norm=1.584131 delta_norm=0.610426
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=31 metric=0.9964 head_norm=1.394107
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.362056e-01
[S14] stored merged vector for next round verification (round=31)
[S14] DEBUG after merge:  round=31 metric=0.9964 head_norm=1.193448 delta_norm=0.736206
[S14] aggregate: ACCEPT kept=['S3', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=2.013505 (no previous merge yet)
[S2] round=32 local utility u=0.072489 metrics={'f1_val': 0.9118785236062452, 'auprc': 0.9003100448715348, 'loss_val': 0.27236266433447903, 'psi': 0.9072511321123611}-{'f1_val': 0.9150373811659969, 'auprc': 0.8464227076075339, 'loss_val': 0.27463178799300547, 'psi': 0.8875915117426116}
[S3] START round=32 head_norm_before_train=1.971094 (no previous merge yet)
[S3] round=32 local utility u=0.531444 metrics={'f1_val': 0.9966508675148381, 'auprc': 0.9994943526982256, 'loss_val': 0.05451284881879791, 'psi': 0.9977882615881932}-{'f1_val': 0.8550475295381058, 'auprc': 0.9996312332028181, 'loss_val': 0.26819192252521823, 'psi': 0.9128810110039908}
[S4] START round=32 head_norm_before_train=2.034582 (no previous merge yet)
[S4] round=32 local utility u=0.026609 metrics={'f1_val': 0.9550235177567524, 'auprc': 0.948334931057996, 'loss_val': 0.3112430576425834, 'psi': 0.9523480830772498}-{'f1_val': 0.9538650640742525, 'auprc': 0.9328258802196645, 'loss_val': 0.3109835223364069, 'psi': 0.9454493905324173}
[S5] START round=32 head_norm_before_train=1.578757 cos_to_last_merge=0.9998 (last merge round=30)
[S5] round=32 local utility u=0.108721 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9804558470830208, 'loss_val': 0.2943161278344919, 'psi': 0.8124268717651366}-{'f1_val': 0.7003213174339138, 'auprc': 0.9392264353470589, 'loss_val': 0.38755230227252496, 'psi': 0.7958833645991719}
[S6] START round=32 head_norm_before_train=1.966153 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5969494321571686, 'auprc': 0.6497767167966594, 'loss_val': 1.4443016933159565, 'psi': 0.6180803460129649}-{'f1_val': 0.8672862308341898, 'auprc': 0.954889952352562, 'loss_val': 0.3556255167458599, 'psi': 0.9023277194415387}
[S7] START round=32 head_norm_before_train=1.584131 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.5744585418576775, 'auprc': 0.7977666992565546, 'loss_val': 0.7806410462982124, 'psi': 0.6637818048172284}-{'f1_val': 0.6370551497426469, 'auprc': 0.8124291629547615, 'loss_val': 0.614898515575701, 'psi': 0.7072047550274927}
[S8] START round=32 head_norm_before_train=1.944354 cos_to_last_merge=0.8194 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=32 local utility u=0.002958 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9978425708658322, 'loss_val': 0.032293798233418075, 'psi': 0.9949381030380053}-{'f1_val': 0.9919085369259982, 'auprc': 0.9990103759390345, 'loss_val': 0.035153377466316416, 'psi': 0.9947492725312127}
[S9] START round=32 head_norm_before_train=1.950681 (no previous merge yet)
[S9] round=32 local utility u=0.000196 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9971636618855713, 'loss_val': 0.021746849372950707, 'psi': 0.9964802029577726}-{'f1_val': 0.9956098104564366, 'auprc': 0.9981934763584704, 'loss_val': 0.022740498571445444, 'psi': 0.9966432768172501}
[S10] START round=32 head_norm_before_train=1.549499 cos_to_last_merge=1.0000 (last merge round=31)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9936983023613553, 'loss_val': 0.08119179100296937, 'psi': 0.9944096554027788}-{'f1_val': 0.9946643883427498, 'auprc': 0.9941497822632054, 'loss_val': 0.060769902607908974, 'psi': 0.9944585459109321}
[S11] START round=32 head_norm_before_train=2.050441 (no previous merge yet)
[S11] round=32 local utility u=0.000708 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979207739615296, 'loss_val': 0.028271964254423892, 'psi': 0.9969514100659285}-{'f1_val': 0.996305167468861, 'auprc': 0.997869912188769, 'loss_val': 0.029535878293607046, 'psi': 0.9969310653568242}
[S13] START round=32 head_norm_before_train=1.493557 cos_to_last_merge=0.9960 (last merge round=29)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5716496184888742, 'auprc': 0.6196696902811037, 'loss_val': 0.8654785792354115, 'psi': 0.5908576472057661}-{'f1_val': 0.5899509169189286, 'auprc': 0.6769231836376759, 'loss_val': 0.8154220485487401, 'psi': 0.6247398236064275}
[S14] START round=32 head_norm_before_train=1.193448 cos_to_last_merge=1.0000 (last merge round=31)
[S14] round=32 local utility u=0.005152 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9969546387934842, 'loss_val': 0.15793621597444854, 'psi': 0.996994029191119}-{'f1_val': 0.9963671647723179, 'auprc': 0.9970050161085642, 'loss_val': 0.1644723466290015, 'psi': 0.9966223053068164}
[S15] START round=32 head_norm_before_train=2.116722 (no previous merge yet)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.972501473341339, 'auprc': 0.993724275371469, 'loss_val': 0.11638986847723866, 'psi': 0.980990594153391}-{'f1_val': 0.9963324108488076, 'auprc': 0.9946068226787097, 'loss_val': 0.02425860371856495, 'psi': 0.9956421755807684}
[S16] START round=32 head_norm_before_train=1.798384 cos_to_last_merge=0.7779 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.778
[S16] round=32 local utility u=0.560207 metrics={'f1_val': 0.9377246286613434, 'auprc': 0.9914855281538683, 'loss_val': 0.27082695932750256, 'psi': 0.9592289884583534}-{'f1_val': 0.8448815831268311, 'auprc': 0.9899966288531402, 'loss_val': 0.8297154192621412, 'psi': 0.9029276014173548}
[S17] START round=32 head_norm_before_train=1.863212 cos_to_last_merge=0.7968 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=32 local utility u=0.911307 metrics={'f1_val': 0.798758280902759, 'auprc': 0.9939750177672952, 'loss_val': 0.5845096561245824, 'psi': 0.8768449756485734}-{'f1_val': 0.6384058071978018, 'auprc': 0.9485720020169202, 'loss_val': 1.3087990068598767, 'psi': 0.7624722851254492}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:39814
[S3] not sending this round → trigger blocked (psi=0.998)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.812)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:39814
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:39807
[S4] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=-0.0703
[S6] DROPPED delta from S2 (cos=-0.0703 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1795) from S11
[S2] cosine check vs S11: cos=-0.2101
[S2] DROPPED delta from S11 (cos=-0.2101 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S4
[S14] cosine check vs S4: cos=0.5757
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.3125
[S5] RECEIVED delta(kind=head bytes=1805) from S8
[S5] cosine check vs S8: cos=-0.0302
[S5] DROPPED delta from S8 (cos=-0.0302 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=-0.1330
[S8] DROPPED delta from S17 (cos=-0.1330 < 0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=32 metric=0.9970 head_norm=1.243534
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.552117e-01
[S14] stored merged vector for next round verification (round=32)
[S14] DEBUG after merge:  round=32 metric=0.9970 head_norm=1.179566 delta_norm=0.555212
[S14] aggregate: ACCEPT kept=['S4', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=2.020859 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.8332992920779609, 'auprc': 0.9374695600708771, 'loss_val': 0.40782256462655214, 'psi': 0.8749673992751275}-{'f1_val': 0.9118785236062452, 'auprc': 0.9003100448715348, 'loss_val': 0.27236266433447903, 'psi': 0.9072511321123611}
[S3] START round=33 head_norm_before_train=1.990237 (no previous merge yet)
[S3] round=33 local utility u=0.007096 metrics={'f1_val': 0.996947988970087, 'auprc': 0.9995728191870775, 'loss_val': 0.04233985672401736, 'psi': 0.9979979210568832}-{'f1_val': 0.9966508675148381, 'auprc': 0.9994943526982256, 'loss_val': 0.05451284881879791, 'psi': 0.9977882615881932}
[S4] START round=33 head_norm_before_train=2.043222 (no previous merge yet)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9540351549818509, 'auprc': 0.9322640510368178, 'loss_val': 0.3133731412287721, 'psi': 0.9453267134038377}-{'f1_val': 0.9550235177567524, 'auprc': 0.948334931057996, 'loss_val': 0.3112430576425834, 'psi': 0.9523480830772498}
[S5] START round=33 head_norm_before_train=1.598828 cos_to_last_merge=0.9990 (last merge round=30)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.6103716600193794, 'auprc': 0.8342305914199746, 'loss_val': 0.5403234768307169, 'psi': 0.6999152325796174}-{'f1_val': 0.700407554886547, 'auprc': 0.9804558470830208, 'loss_val': 0.2943161278344919, 'psi': 0.8124268717651366}
[S6] START round=33 head_norm_before_train=1.982323 (no previous merge yet)
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.8725966320395845, 'auprc': 0.9661647262937886, 'loss_val': 0.29055486691666677, 'psi': 0.9100238697412661}-{'f1_val': 0.5969494321571686, 'auprc': 0.6497767167966594, 'loss_val': 1.4443016933159565, 'psi': 0.6180803460129649}
[S7] START round=33 head_norm_before_train=1.597285 cos_to_last_merge=0.9998 (last merge round=31)
[S7] round=33 local utility u=0.144078 metrics={'f1_val': 0.6019817241089264, 'auprc': 0.8030416494676011, 'loss_val': 0.6734489676835826, 'psi': 0.6824056942523964}-{'f1_val': 0.5744585418576775, 'auprc': 0.7977666992565546, 'loss_val': 0.7806410462982124, 'psi': 0.6637818048172284}
[S8] START round=33 head_norm_before_train=1.953997 cos_to_last_merge=0.8191 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.819
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.999060259502027, 'loss_val': 0.033542734327286834, 'psi': 0.9949621612102894}-{'f1_val': 0.9930017911527874, 'auprc': 0.9978425708658322, 'loss_val': 0.032293798233418075, 'psi': 0.9949381030380053}
[S9] START round=33 head_norm_before_train=1.961792 (no previous merge yet)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9996042418689155, 'loss_val': 0.02748504840209857, 'psi': 0.9951826882470957}-{'f1_val': 0.9960245636725735, 'auprc': 0.9971636618855713, 'loss_val': 0.021746849372950707, 'psi': 0.9964802029577726}
[S10] START round=33 head_norm_before_train=1.595826 cos_to_last_merge=0.9993 (last merge round=31)
[S10] round=33 local utility u=0.009759 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937764387261884, 'loss_val': 0.06454341612591753, 'psi': 0.9947044478287135}-{'f1_val': 0.9948838907637279, 'auprc': 0.9936983023613553, 'loss_val': 0.08119179100296937, 'psi': 0.9944096554027788}
[S11] START round=33 head_norm_before_train=2.063116 (no previous merge yet)
[S11] round=33 local utility u=0.000238 metrics={'f1_val': 0.9963256330217796, 'auprc': 0.9980314510479619, 'loss_val': 0.02825100425154992, 'psi': 0.9970079602322526}-{'f1_val': 0.996305167468861, 'auprc': 0.9979207739615296, 'loss_val': 0.028271964254423892, 'psi': 0.9969514100659285}
[S13] START round=33 head_norm_before_train=1.528456 cos_to_last_merge=0.9920 (last merge round=29)
[S13] round=33 local utility u=0.183437 metrics={'f1_val': 0.5875847982575797, 'auprc': 0.6827855775759992, 'loss_val': 0.7835635285943706, 'psi': 0.6256651099849475}-{'f1_val': 0.5716496184888742, 'auprc': 0.6196696902811037, 'loss_val': 0.8654785792354115, 'psi': 0.5908576472057661}
[S14] START round=33 head_norm_before_train=1.179566 cos_to_last_merge=1.0000 (last merge round=32)
[S14] round=33 local utility u=0.004635 metrics={'f1_val': 0.9972630104447024, 'auprc': 0.9968131534571478, 'loss_val': 0.14969745129387463, 'psi': 0.9970830676496806}-{'f1_val': 0.9970202894562089, 'auprc': 0.9969546387934842, 'loss_val': 0.15793621597444854, 'psi': 0.996994029191119}
[S15] START round=33 head_norm_before_train=2.128006 (no previous merge yet)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.820671656685735, 'auprc': 0.9904643208389747, 'loss_val': 0.30834421727475764, 'psi': 0.8885887223470309}-{'f1_val': 0.972501473341339, 'auprc': 0.993724275371469, 'loss_val': 0.11638986847723866, 'psi': 0.980990594153391}
[S16] START round=33 head_norm_before_train=1.809982 cos_to_last_merge=0.7770 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.777
[S16] round=33 local utility u=0.079971 metrics={'f1_val': 0.9443914657221897, 'auprc': 0.9922653942066929, 'loss_val': 0.15322501566158986, 'psi': 0.9635410371159909}-{'f1_val': 0.9377246286613434, 'auprc': 0.9914855281538683, 'loss_val': 0.27082695932750256, 'psi': 0.9592289884583534}
[S17] START round=33 head_norm_before_train=1.881652 cos_to_last_merge=0.7952 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.795
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6744205227872361, 'auprc': 0.9432831345083195, 'loss_val': 1.0023196941096897, 'psi': 0.7819655674756694}-{'f1_val': 0.798758280902759, 'auprc': 0.9939750177672952, 'loss_val': 0.5845096561245824, 'psi': 0.8768449756485734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39811
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39814
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39805
[S16] not sending this round → trigger blocked (psi=0.964)
[S11] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:39813
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S10
[S5] cosine check vs S10: cos=0.9715
[S14] RECEIVED delta(kind=head bytes=1796) from S3
[S14] cosine check vs S3: cos=0.2857
[S7] RECEIVED delta(kind=head bytes=1801) from S6
[S7] cosine check vs S6: cos=0.2514
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=0.9795
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=0.9225
[S7] RECEIVED delta(kind=head bytes=1802) from S14
[S7] cosine check vs S14: cos=-0.0822
[S7] DROPPED delta from S14 (cos=-0.0822 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.6104 head_norm=1.614904
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.951010e-01
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.6228 head_norm=1.617347 delta_norm=0.195101
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6020 head_norm=1.607173
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.110865e+00
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.5883 head_norm=1.427598 delta_norm=1.110865
[S7] aggregate: ROLLBACK (f1_val pre=0.602 post=0.588 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9953 head_norm=1.643119
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.680374e-01
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9953 head_norm=1.588576 delta_norm=0.168037
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=33 metric=0.9973 head_norm=1.230964
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.017531e+00
[S14] stored merged vector for next round verification (round=33)
[S14] DEBUG after merge:  round=33 metric=0.9970 head_norm=1.319985 delta_norm=1.017531
[S14] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5876 head_norm=1.550413
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.121149e-01
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5775 head_norm=1.547894 delta_norm=0.312115
[S13] aggregate: ROLLBACK (f1_val pre=0.588 post=0.578 tol_abs=0.005 tol_rel=0.0)
[S2] START round=34 head_norm_before_train=2.027252 (no previous merge yet)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6087341142222147, 'auprc': 0.8223995290388155, 'loss_val': 0.9490949416699427, 'psi': 0.694200280148855}-{'f1_val': 0.8332992920779609, 'auprc': 0.9374695600708771, 'loss_val': 0.40782256462655214, 'psi': 0.8749673992751275}
[S3] START round=34 head_norm_before_train=2.010021 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.7364381578629833, 'auprc': 0.9174023021931083, 'loss_val': 0.5833612095847758, 'psi': 0.8088238155950332}-{'f1_val': 0.996947988970087, 'auprc': 0.9995728191870775, 'loss_val': 0.04233985672401736, 'psi': 0.9979979210568832}
[S4] START round=34 head_norm_before_train=2.054375 (no previous merge yet)
[S4] round=34 local utility u=0.019174 metrics={'f1_val': 0.9540351549818509, 'auprc': 0.9450241843900744, 'loss_val': 0.3133060627423492, 'psi': 0.9504307667451403}-{'f1_val': 0.9540351549818509, 'auprc': 0.9322640510368178, 'loss_val': 0.3133731412287721, 'psi': 0.9453267134038377}
[S5] START round=34 head_norm_before_train=1.617347 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8556885878757869, 'loss_val': 0.9299131869931057, 'psi': 0.604335173453538}-{'f1_val': 0.6103716600193794, 'auprc': 0.8342305914199746, 'loss_val': 0.5403234768307169, 'psi': 0.6999152325796174}
[S6] START round=34 head_norm_before_train=1.990254 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.6807562798483127, 'auprc': 0.836762845541093, 'loss_val': 0.8795758008167716, 'psi': 0.7431589061254248}-{'f1_val': 0.8725966320395845, 'auprc': 0.9661647262937886, 'loss_val': 0.29055486691666677, 'psi': 0.9100238697412661}
[S7] START round=34 head_norm_before_train=1.427598 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.154283 metrics={'f1_val': 0.6380213629083087, 'auprc': 0.8115358704614597, 'loss_val': 0.6066031337999798, 'psi': 0.7074271659295691}-{'f1_val': 0.6019817241089264, 'auprc': 0.8030416494676011, 'loss_val': 0.6734489676835826, 'psi': 0.6824056942523964}
[S8] START round=34 head_norm_before_train=1.964426 cos_to_last_merge=0.8181 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.990878703649633, 'auprc': 0.9864554043788232, 'loss_val': 0.057443166243079775, 'psi': 0.9891093839413091}-{'f1_val': 0.9922300956824643, 'auprc': 0.999060259502027, 'loss_val': 0.033542734327286834, 'psi': 0.9949621612102894}
[S9] START round=34 head_norm_before_train=1.973362 (no previous merge yet)
[S9] round=34 local utility u=0.011137 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958934935932691, 'loss_val': 0.020631532773934855, 'psi': 0.9963537045256425}-{'f1_val': 0.9922349858325491, 'auprc': 0.9996042418689155, 'loss_val': 0.02748504840209857, 'psi': 0.9951826882470957}
[S10] START round=34 head_norm_before_train=1.588576 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9927051971107713, 'loss_val': 0.07650035684518716, 'psi': 0.9942759511825467}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937764387261884, 'loss_val': 0.06454341612591753, 'psi': 0.9947044478287135}
[S11] START round=34 head_norm_before_train=2.072688 (no previous merge yet)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997971024280511, 'loss_val': 0.028314427316550383, 'psi': 0.9967235124333529}-{'f1_val': 0.9963256330217796, 'auprc': 0.9980314510479619, 'loss_val': 0.02825100425154992, 'psi': 0.9970079602322526}
[S13] START round=34 head_norm_before_train=1.547894 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5841171079042012, 'auprc': 0.6356891962573902, 'loss_val': 0.8816467420781694, 'psi': 0.6047459432454768}-{'f1_val': 0.5875847982575797, 'auprc': 0.6827855775759992, 'loss_val': 0.7835635285943706, 'psi': 0.6256651099849475}
[S14] START round=34 head_norm_before_train=1.319985 cos_to_last_merge=1.0000 (last merge round=33)
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9976574544834568, 'loss_val': 0.1853724129236973, 'psi': 0.9972751554671081}-{'f1_val': 0.9972630104447024, 'auprc': 0.9968131534571478, 'loss_val': 0.14969745129387463, 'psi': 0.9970830676496806}
[S15] START round=34 head_norm_before_train=2.135355 (no previous merge yet)
[S15] round=34 local utility u=0.601868 metrics={'f1_val': 0.9778299891832524, 'auprc': 0.9920528999232857, 'loss_val': 0.052324573632947596, 'psi': 0.9835191534792658}-{'f1_val': 0.820671656685735, 'auprc': 0.9904643208389747, 'loss_val': 0.30834421727475764, 'psi': 0.8885887223470309}
[S16] START round=34 head_norm_before_train=1.818828 cos_to_last_merge=0.7760 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9308982785357384, 'auprc': 0.9903994505468893, 'loss_val': 0.3296403741185746, 'psi': 0.9546987473401988}-{'f1_val': 0.9443914657221897, 'auprc': 0.9922653942066929, 'loss_val': 0.15322501566158986, 'psi': 0.9635410371159909}
[S17] START round=34 head_norm_before_train=1.895069 cos_to_last_merge=0.7941 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.794
[S17] round=34 local utility u=0.081436 metrics={'f1_val': 0.6980940744737701, 'auprc': 0.9156182306960035, 'loss_val': 0.8984942951488198, 'psi': 0.7851037369626634}-{'f1_val': 0.6744205227872361, 'auprc': 0.9432831345083195, 'loss_val': 1.0023196941096897, 'psi': 0.7819655674756694}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.707)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:39808
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.2118
[S14] RECEIVED delta(kind=head bytes=1798) from S4
[S14] cosine check vs S4: cos=0.4041
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.5211
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.1320
[S8] DROPPED delta from S17 (cos=-0.1320 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6380 head_norm=1.443695
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.711027e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6383 head_norm=1.500521 delta_norm=0.871103
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=34 metric=0.9970 head_norm=1.360445
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.793579e-01
[S14] stored merged vector for next round verification (round=34)
[S14] DEBUG after merge:  round=34 metric=0.9970 head_norm=1.218108 delta_norm=0.779358
[S14] aggregate: ACCEPT kept=['S15', 'S4'] (k=2/2) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=2.031242 (no previous merge yet)
[S2] round=35 local utility u=1.000000 metrics={'f1_val': 0.9008704012630836, 'auprc': 0.8295300039588067, 'loss_val': 0.3635270690466038, 'psi': 0.8723342423413729}-{'f1_val': 0.6087341142222147, 'auprc': 0.8223995290388155, 'loss_val': 0.9490949416699427, 'psi': 0.694200280148855}
[S3] START round=35 head_norm_before_train=2.024609 (no previous merge yet)
[S3] round=35 local utility u=0.815674 metrics={'f1_val': 0.8985210112799996, 'auprc': 0.9994512155582856, 'loss_val': 0.17065793859554146, 'psi': 0.9388930929913141}-{'f1_val': 0.7364381578629833, 'auprc': 0.9174023021931083, 'loss_val': 0.5833612095847758, 'psi': 0.8088238155950332}
[S4] START round=35 head_norm_before_train=2.064500 (no previous merge yet)
[S4] round=35 local utility u=0.013959 metrics={'f1_val': 0.9541763163378385, 'auprc': 0.9538516578259176, 'loss_val': 0.3127167699864939, 'psi': 0.9540464529330701}-{'f1_val': 0.9540351549818509, 'auprc': 0.9450241843900744, 'loss_val': 0.3133060627423492, 'psi': 0.9504307667451403}
[S5] START round=35 head_norm_before_train=1.629429 cos_to_last_merge=0.9999 (last merge round=33)
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.8755256460130275, 'auprc': 0.9950063229989851, 'loss_val': 0.2309111173601384, 'psi': 0.9233179168074106}-{'f1_val': 0.43676623050537206, 'auprc': 0.8556885878757869, 'loss_val': 0.9299131869931057, 'psi': 0.604335173453538}
[S6] START round=35 head_norm_before_train=1.996872 (no previous merge yet)
[S6] round=35 local utility u=0.503287 metrics={'f1_val': 0.747403637296025, 'auprc': 0.9586562693530972, 'loss_val': 0.6385664587934493, 'psi': 0.8319046901188538}-{'f1_val': 0.6807562798483127, 'auprc': 0.836762845541093, 'loss_val': 0.8795758008167716, 'psi': 0.7431589061254248}
[S7] START round=35 head_norm_before_train=1.500521 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.5868886525994856, 'auprc': 0.8001308090234429, 'loss_val': 0.7044896971939165, 'psi': 0.6721855151690685}-{'f1_val': 0.6380213629083087, 'auprc': 0.8115358704614597, 'loss_val': 0.6066031337999798, 'psi': 0.7074271659295691}
[S8] START round=35 head_norm_before_train=1.971839 cos_to_last_merge=0.8180 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9014871685373643, 'auprc': 0.9990470543243823, 'loss_val': 0.20380729024696284, 'psi': 0.9405111228521715}-{'f1_val': 0.990878703649633, 'auprc': 0.9864554043788232, 'loss_val': 0.057443166243079775, 'psi': 0.9891093839413091}
[S9] START round=35 head_norm_before_train=1.984064 (no previous merge yet)
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9913944794912241, 'auprc': 0.9996036795830621, 'loss_val': 0.0319976133808029, 'psi': 0.9946781595279592}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958934935932691, 'loss_val': 0.020631532773934855, 'psi': 0.9963537045256425}
[S10] START round=35 head_norm_before_train=1.635645 cos_to_last_merge=0.9993 (last merge round=33)
[S10] round=35 local utility u=0.005509 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9922720095412875, 'loss_val': 0.06337011667811555, 'psi': 0.9940215072281398}-{'f1_val': 0.9953231205637304, 'auprc': 0.9927051971107713, 'loss_val': 0.07650035684518716, 'psi': 0.9942759511825467}
[S11] START round=35 head_norm_before_train=2.084874 (no previous merge yet)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.956152310520687, 'auprc': 0.998051628506818, 'loss_val': 0.18222400626271265, 'psi': 0.9729120377151395}-{'f1_val': 0.9958918378685807, 'auprc': 0.997971024280511, 'loss_val': 0.028314427316550383, 'psi': 0.9967235124333529}
[S13] START round=35 head_norm_before_train=1.567801 cos_to_last_merge=0.9998 (last merge round=33)
[S13] round=35 local utility u=0.112390 metrics={'f1_val': 0.5828858236920628, 'auprc': 0.681055245884028, 'loss_val': 0.7855779599388947, 'psi': 0.6221535925688488}-{'f1_val': 0.5841171079042012, 'auprc': 0.6356891962573902, 'loss_val': 0.8816467420781694, 'psi': 0.6047459432454768}
[S14] START round=35 head_norm_before_train=1.218108 cos_to_last_merge=1.0000 (last merge round=34)
[S14] round=35 local utility u=0.023146 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9982955176416817, 'loss_val': 0.13953816098738078, 'psi': 0.9973846716281345}-{'f1_val': 0.9970202894562089, 'auprc': 0.9976574544834568, 'loss_val': 0.1853724129236973, 'psi': 0.9972751554671081}
[S15] START round=35 head_norm_before_train=2.144011 (no previous merge yet)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9030228911638922, 'auprc': 0.9911454922386544, 'loss_val': 0.13663223399831056, 'psi': 0.9382719315937971}-{'f1_val': 0.9778299891832524, 'auprc': 0.9920528999232857, 'loss_val': 0.052324573632947596, 'psi': 0.9835191534792658}
[S16] START round=35 head_norm_before_train=1.829193 cos_to_last_merge=0.7750 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8695262871869364, 'auprc': 0.9843594347456139, 'loss_val': 0.6712747782945077, 'psi': 0.9154595462104074}-{'f1_val': 0.9308982785357384, 'auprc': 0.9903994505468893, 'loss_val': 0.3296403741185746, 'psi': 0.9546987473401988}
[S17] START round=35 head_norm_before_train=1.905529 cos_to_last_merge=0.7932 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=35 local utility u=0.724827 metrics={'f1_val': 0.8466540040214142, 'auprc': 0.9860850856922172, 'loss_val': 0.5515998496207744, 'psi': 0.9024264366897354}-{'f1_val': 0.6980940744737701, 'auprc': 0.9156182306960035, 'loss_val': 0.8984942951488198, 'psi': 0.7851037369626634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:39808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S10] → sending delta(kind=head bytes=1806) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:39814
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:39811
[S2] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=0.4964
[S6] RECEIVED delta(kind=head bytes=1797) from S2
[S6] cosine check vs S2: cos=-0.0694
[S6] DROPPED delta from S2 (cos=-0.0694 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S4
[S14] cosine check vs S4: cos=0.6675
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9652
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=0.3849
[S3] RECEIVED delta(kind=head bytes=1801) from S5
[S3] cosine check vs S5: cos=-0.1026
[S3] DROPPED delta from S5 (cos=-0.1026 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1806) from S10
[S5] cosine check vs S10: cos=0.9864
[S7] RECEIVED delta(kind=head bytes=1808) from S14
[S7] cosine check vs S14: cos=-0.1141
[S7] DROPPED delta from S14 (cos=-0.1141 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39809
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.1314
[S8] DROPPED delta from S17 (cos=-0.1314 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.5869 head_norm=1.518881
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.996168e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.5765 head_norm=1.474594 delta_norm=0.999617
[S7] aggregate: ROLLBACK (f1_val pre=0.587 post=0.577 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.172 → S13@127.0.0.1:39813
[S8] ⇄ pheromone p=0.045 → S5@127.0.0.1:39805
[S15] ⇄ pheromone p=0.266 → S14@127.0.0.1:39814
[S11] ⇄ pheromone p=0.018 → S2@127.0.0.1:39802
[S9] ⇄ pheromone p=0.008 → S7@127.0.0.1:39808
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=35 metric=0.8755 head_norm=1.639031
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.387162e-01
[S5] stored merged vector for next round verification (round=35)
[S5] DEBUG after merge:  round=35 metric=0.9120 head_norm=1.655048 delta_norm=0.138716
[S5] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.396 → S3@127.0.0.1:39803
[S4] ⇄ pheromone p=0.019 → S14@127.0.0.1:39814
[S3] ⇄ pheromone p=0.289 → S14@127.0.0.1:39814
[S2] ⇄ pheromone p=0.222 → S6@127.0.0.1:39807
[S6] ⇄ pheromone p=0.392 → S7@127.0.0.1:39808
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9952 head_norm=1.682388
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.203304e-01
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9952 head_norm=1.624511 delta_norm=0.220330
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.009 → S5@127.0.0.1:39805
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=35 metric=0.9968 head_norm=1.267658
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.587971e-01
[S14] stored merged vector for next round verification (round=35)
[S14] DEBUG after merge:  round=35 metric=0.9968 head_norm=1.312988 delta_norm=0.458797
[S14] aggregate: ACCEPT kept=['S3', 'S4'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.024 → S7@127.0.0.1:39808
[S13] ⇄ pheromone p=0.071 → S10@127.0.0.1:39811
[S16] ⇄ pheromone p=0.138 → S14@127.0.0.1:39814
[S17] ⇄ pheromone p=0.319 → S8@127.0.0.1:39809
[S2] START round=36 head_norm_before_train=2.032156 (no previous merge yet)
[S2] round=36 local utility u=0.125224 metrics={'f1_val': 0.915596603758512, 'auprc': 0.8456806834531776, 'loss_val': 0.24988860439272453, 'psi': 0.8876302356363783}-{'f1_val': 0.9008704012630836, 'auprc': 0.8295300039588067, 'loss_val': 0.3635270690466038, 'psi': 0.8723342423413729}
[S3] START round=36 head_norm_before_train=2.032158 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.8366240317726031, 'auprc': 0.9988205002158169, 'loss_val': 0.3465550535487746, 'psi': 0.9015026191498887}-{'f1_val': 0.8985210112799996, 'auprc': 0.9994512155582856, 'loss_val': 0.17065793859554146, 'psi': 0.9388930929913141}
[S4] START round=36 head_norm_before_train=2.065666 (no previous merge yet)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9538813846833951, 'auprc': 0.9535400912787334, 'loss_val': 0.3145210015540545, 'psi': 0.9537448673215304}-{'f1_val': 0.9541763163378385, 'auprc': 0.9538516578259176, 'loss_val': 0.3127167699864939, 'psi': 0.9540464529330701}
[S5] START round=36 head_norm_before_train=1.655048 cos_to_last_merge=1.0000 (last merge round=35)
[S5] round=36 local utility u=0.000000 metrics={'f1_val': 0.4171435078150064, 'auprc': 0.8545502976086733, 'loss_val': 1.1037731673163063, 'psi': 0.5921062237324732}-{'f1_val': 0.8755256460130275, 'auprc': 0.9950063229989851, 'loss_val': 0.2309111173601384, 'psi': 0.9233179168074106}
[S6] START round=36 head_norm_before_train=2.010055 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.6177749193213803, 'auprc': 0.91107988152369, 'loss_val': 1.0975063049508686, 'psi': 0.7350969042023041}-{'f1_val': 0.747403637296025, 'auprc': 0.9586562693530972, 'loss_val': 0.6385664587934493, 'psi': 0.8319046901188538}
[S7] START round=36 head_norm_before_train=1.474594 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.064770 metrics={'f1_val': 0.6018810121678204, 'auprc': 0.8038596798700922, 'loss_val': 0.6760905620954978, 'psi': 0.6826724792487291}-{'f1_val': 0.5868886525994856, 'auprc': 0.8001308090234429, 'loss_val': 0.7044896971939165, 'psi': 0.6721855151690685}
[S8] START round=36 head_norm_before_train=1.977372 cos_to_last_merge=0.8177 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9883067689098309, 'loss_val': 0.420711196357292, 'psi': 0.8238661708026298}-{'f1_val': 0.9014871685373643, 'auprc': 0.9990470543243823, 'loss_val': 0.20380729024696284, 'psi': 0.9405111228521715}
[S9] START round=36 head_norm_before_train=1.990281 (no previous merge yet)
[S9] round=36 local utility u=0.018696 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9971639111907402, 'loss_val': 0.020035902171557086, 'psi': 0.9969771157316505}-{'f1_val': 0.9913944794912241, 'auprc': 0.9996036795830621, 'loss_val': 0.0319976133808029, 'psi': 0.9946781595279592}
[S10] START round=36 head_norm_before_train=1.624511 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9918756509637555, 'loss_val': 0.07563622248183313, 'psi': 0.993862963797127}-{'f1_val': 0.9951878390193748, 'auprc': 0.9922720095412875, 'loss_val': 0.06337011667811555, 'psi': 0.9940215072281398}
[S11] START round=36 head_norm_before_train=2.095448 (no previous merge yet)
[S11] round=36 local utility u=0.198780 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997965065552644, 'loss_val': 0.025320592281698005, 'psi': 0.9969691267023741}-{'f1_val': 0.956152310520687, 'auprc': 0.998051628506818, 'loss_val': 0.18222400626271265, 'psi': 0.9729120377151395}
[S13] START round=36 head_norm_before_train=1.595223 cos_to_last_merge=0.9989 (last merge round=33)
[S13] round=36 local utility u=0.000000 metrics={'f1_val': 0.5999358501825898, 'auprc': 0.6413454718810481, 'loss_val': 0.8199486693361168, 'psi': 0.6164996988619731}-{'f1_val': 0.5828858236920628, 'auprc': 0.681055245884028, 'loss_val': 0.7855779599388947, 'psi': 0.6221535925688488}
[S14] START round=36 head_norm_before_train=1.312988 cos_to_last_merge=1.0000 (last merge round=35)
[S14] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971882020035234, 'auprc': 0.9967853777612472, 'loss_val': 0.15064533014123113, 'psi': 0.9970270723066129}-{'f1_val': 0.9967774409524363, 'auprc': 0.9982955176416817, 'loss_val': 0.13953816098738078, 'psi': 0.9973846716281345}
[S15] START round=36 head_norm_before_train=2.155141 (no previous merge yet)
[S15] round=36 local utility u=0.335578 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9913989948858788, 'loss_val': 0.02609415447239188, 'psi': 0.9943590444636361}-{'f1_val': 0.9030228911638922, 'auprc': 0.9911454922386544, 'loss_val': 0.13663223399831056, 'psi': 0.9382719315937971}
[S16] START round=36 head_norm_before_train=1.840011 cos_to_last_merge=0.7739 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=36 local utility u=0.475883 metrics={'f1_val': 0.941917408440769, 'auprc': 0.991316190505779, 'loss_val': 0.17472550219650027, 'psi': 0.961676921266773}-{'f1_val': 0.8695262871869364, 'auprc': 0.9843594347456139, 'loss_val': 0.6712747782945077, 'psi': 0.9154595462104074}
[S17] START round=36 head_norm_before_train=1.917542 cos_to_last_merge=0.7922 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.792
[S17] round=36 local utility u=0.000000 metrics={'f1_val': 0.659217613403499, 'auprc': 0.9842058173803385, 'loss_val': 1.0039785784077977, 'psi': 0.7892128949942349}-{'f1_val': 0.8466540040214142, 'auprc': 0.9860850856922172, 'loss_val': 0.5515998496207744, 'psi': 0.9024264366897354}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39802
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:39807
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39814
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:39814
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1800) from S7
[S6] cosine check vs S7: cos=0.8766
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] cosine check vs S2: cos=-0.2069
[S11] DROPPED delta from S2 (cos=-0.2069 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S16
[S14] cosine check vs S16: cos=0.1311
[S14] RECEIVED delta(kind=head bytes=1793) from S15
[S14] cosine check vs S15: cos=0.2940
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=-0.2069
[S2] DROPPED delta from S11 (cos=-0.2069 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.4519
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=36 metric=0.9972 head_norm=1.355058
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.159561e-01
[S14] stored merged vector for next round verification (round=36)
[S14] DEBUG after merge:  round=36 metric=0.9966 head_norm=1.198037 delta_norm=0.915956
[S14] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=36 metric=0.6178 head_norm=2.013498
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.031877e-01
[S6] stored merged vector for next round verification (round=36)
[S6] DEBUG after merge:  round=36 metric=0.6178 head_norm=1.699354 delta_norm=0.503188
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6019 head_norm=1.492591
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.376551e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6094 head_norm=1.491622 delta_norm=0.937655
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.037913 (no previous merge yet)
[S2] round=37 local utility u=0.117489 metrics={'f1_val': 0.9139842715807008, 'auprc': 0.9273090103307297, 'loss_val': 0.2501222680720575, 'psi': 0.9193141670807123}-{'f1_val': 0.915596603758512, 'auprc': 0.8456806834531776, 'loss_val': 0.24988860439272453, 'psi': 0.8876302356363783}
[S3] START round=37 head_norm_before_train=2.038532 (no previous merge yet)
[S3] round=37 local utility u=0.177628 metrics={'f1_val': 0.8805102090090366, 'auprc': 0.9996267640662194, 'loss_val': 0.25703428881652296, 'psi': 0.9281568310319097}-{'f1_val': 0.8366240317726031, 'auprc': 0.9988205002158169, 'loss_val': 0.3465550535487746, 'psi': 0.9015026191498887}
[S4] START round=37 head_norm_before_train=2.069240 (no previous merge yet)
[S4] round=37 local utility u=0.015075 metrics={'f1_val': 0.9579249888423013, 'auprc': 0.9533606199684426, 'loss_val': 0.30809414871616303, 'psi': 0.9560992412927578}-{'f1_val': 0.9538813846833951, 'auprc': 0.9535400912787334, 'loss_val': 0.3145210015540545, 'psi': 0.9537448673215304}
[S5] START round=37 head_norm_before_train=1.664089 cos_to_last_merge=0.9998 (last merge round=35)
[S5] round=37 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9714850904573537, 'loss_val': 0.355351247910158, 'psi': 0.8087868266432897}-{'f1_val': 0.4171435078150064, 'auprc': 0.8545502976086733, 'loss_val': 1.1037731673163063, 'psi': 0.5921062237324732}
[S6] START round=37 head_norm_before_train=1.699354 cos_to_last_merge=1.0000 (last merge round=36)
[S6] round=37 local utility u=1.000000 metrics={'f1_val': 0.8661373339025495, 'auprc': 0.9604249606559554, 'loss_val': 0.3403858005199392, 'psi': 0.9038523846039119}-{'f1_val': 0.6177749193213803, 'auprc': 0.91107988152369, 'loss_val': 1.0975063049508686, 'psi': 0.7350969042023041}
[S7] START round=37 head_norm_before_train=1.491622 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.286804 metrics={'f1_val': 0.6582190112057891, 'auprc': 0.8279338677076915, 'loss_val': 0.5127326209823009, 'psi': 0.72610495380655}-{'f1_val': 0.6018810121678204, 'auprc': 0.8038596798700922, 'loss_val': 0.6760905620954978, 'psi': 0.6826724792487291}
[S8] START round=37 head_norm_before_train=1.983486 cos_to_last_merge=0.8174 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.817
[S8] round=37 local utility u=1.000000 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9929492526568042, 'loss_val': 0.03266175007045901, 'psi': 0.9936397092768007}-{'f1_val': 0.7142391053978291, 'auprc': 0.9883067689098309, 'loss_val': 0.420711196357292, 'psi': 0.8238661708026298}
[S9] START round=37 head_norm_before_train=1.995104 (no previous merge yet)
[S9] round=37 local utility u=0.000256 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9973389027673085, 'loss_val': 0.020049505483322405, 'psi': 0.9970471123622777}-{'f1_val': 0.9968525854255906, 'auprc': 0.9971639111907402, 'loss_val': 0.020035902171557086, 'psi': 0.9969771157316505}
[S10] START round=37 head_norm_before_train=1.669020 cos_to_last_merge=0.9993 (last merge round=35)
[S10] round=37 local utility u=0.011759 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9937666356170702, 'loss_val': 0.05860269389653062, 'psi': 0.9947005265850664}-{'f1_val': 0.9951878390193748, 'auprc': 0.9918756509637555, 'loss_val': 0.07563622248183313, 'psi': 0.993862963797127}
[S11] START round=37 head_norm_before_train=2.099365 (no previous merge yet)
[S11] round=37 local utility u=0.000287 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979661492909394, 'loss_val': 0.024750292080157495, 'psi': 0.9969695601976923}-{'f1_val': 0.996305167468861, 'auprc': 0.997965065552644, 'loss_val': 0.025320592281698005, 'psi': 0.9969691267023741}
[S13] START round=37 head_norm_before_train=1.622802 cos_to_last_merge=0.9974 (last merge round=33)
[S13] round=37 local utility u=0.000847 metrics={'f1_val': 0.5956577423261007, 'auprc': 0.6615514662216082, 'loss_val': 0.8532033911732395, 'psi': 0.6220152318843037}-{'f1_val': 0.5999358501825898, 'auprc': 0.6413454718810481, 'loss_val': 0.8199486693361168, 'psi': 0.6164996988619731}
[S14] START round=37 head_norm_before_train=1.198037 cos_to_last_merge=1.0000 (last merge round=36)
[S14] round=37 local utility u=0.006601 metrics={'f1_val': 0.9980850197418996, 'auprc': 0.997403813582993, 'loss_val': 0.14467991229180094, 'psi': 0.9978125372783369}-{'f1_val': 0.9971882020035234, 'auprc': 0.9967853777612472, 'loss_val': 0.15064533014123113, 'psi': 0.9970270723066129}
[S15] START round=37 head_norm_before_train=2.167177 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7010691361715489, 'auprc': 0.9266809833465999, 'loss_val': 0.6762537603879596, 'psi': 0.7913138750415694}-{'f1_val': 0.9963324108488076, 'auprc': 0.9913989948858788, 'loss_val': 0.02609415447239188, 'psi': 0.9943590444636361}
[S16] START round=37 head_norm_before_train=1.852463 cos_to_last_merge=0.7731 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9275664852637968, 'auprc': 0.9925221547620933, 'loss_val': 0.36548535781201597, 'psi': 0.9535487530631154}-{'f1_val': 0.941917408440769, 'auprc': 0.991316190505779, 'loss_val': 0.17472550219650027, 'psi': 0.961676921266773}
[S17] START round=37 head_norm_before_train=1.930578 cos_to_last_merge=0.7911 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.791
[S17] round=37 local utility u=0.118322 metrics={'f1_val': 0.6832227529994097, 'auprc': 0.9640008894311682, 'loss_val': 0.8507509999730036, 'psi': 0.7955340075721131}-{'f1_val': 0.659217613403499, 'auprc': 0.9842058173803385, 'loss_val': 1.0039785784077977, 'psi': 0.7892128949942349}
[S11] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S3@127.0.0.1:39803
[S2] not sending this round → trigger blocked (psi=0.919)
[S9] not sending this round → trigger blocked (psi=0.997)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39817
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:39805
[S7] not sending this round → trigger blocked (psi=0.726)
[S3] sending update (kind=head size=1794 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S5
[S8] cosine check vs S5: cos=-0.0216
[S8] DROPPED delta from S5 (cos=-0.0216 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] cosine check vs S3: cos=-0.0989
[S5] DROPPED delta from S3 (cos=-0.0989 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S13
[S7] cosine check vs S13: cos=0.9744
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=-0.1308
[S17] DROPPED delta from S8 (cos=-0.1308 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S6
[S2] cosine check vs S6: cos=-0.0510
[S2] DROPPED delta from S6 (cos=-0.0510 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:39813
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9833
[S14] sending update (kind=head size=1804 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1804) from S14
[S3] cosine check vs S14: cos=0.3228
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.6582 head_norm=1.508384
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.905539e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.6516 head_norm=1.566149 delta_norm=0.190554
[S7] aggregate: ROLLBACK (f1_val pre=0.658 post=0.652 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=37 metric=0.5957 head_norm=1.644095
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.572955e-01
[S13] stored merged vector for next round verification (round=37)
[S13] DEBUG after merge:  round=37 metric=0.5973 head_norm=1.672191 delta_norm=0.157295
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=37 metric=0.8805 head_norm=2.045056
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.011339e+00
[S3] stored merged vector for next round verification (round=37)
[S3] DEBUG after merge:  round=37 metric=0.8845 head_norm=1.358743 delta_norm=1.011339
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=2.048907 (no previous merge yet)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.8279144195036046, 'auprc': 0.9911766118741975, 'loss_val': 0.4204121052211066, 'psi': 0.8932192964518417}-{'f1_val': 0.9139842715807008, 'auprc': 0.9273090103307297, 'loss_val': 0.2501222680720575, 'psi': 0.9193141670807123}
[S3] START round=38 head_norm_before_train=1.358743 cos_to_last_merge=1.0000 (last merge round=37)
[S3] round=38 local utility u=0.376054 metrics={'f1_val': 0.9828856030778024, 'auprc': 0.9997585280476804, 'loss_val': 0.11957468224378466, 'psi': 0.9896347730657535}-{'f1_val': 0.8805102090090366, 'auprc': 0.9996267640662194, 'loss_val': 0.25703428881652296, 'psi': 0.9281568310319097}
[S4] START round=38 head_norm_before_train=2.066707 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9543949762473593, 'auprc': 0.9306412654800135, 'loss_val': 0.31142164232412645, 'psi': 0.9448934919404208}-{'f1_val': 0.9579249888423013, 'auprc': 0.9533606199684426, 'loss_val': 0.30809414871616303, 'psi': 0.9560992412927578}
[S5] START round=38 head_norm_before_train=1.670246 cos_to_last_merge=0.9996 (last merge round=35)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8576440386823644, 'loss_val': 0.8975555142294286, 'psi': 0.6051173537761689}-{'f1_val': 0.7003213174339138, 'auprc': 0.9714850904573537, 'loss_val': 0.355351247910158, 'psi': 0.8087868266432897}
[S6] START round=38 head_norm_before_train=1.717388 cos_to_last_merge=0.9999 (last merge round=36)
[S6] round=38 local utility u=0.313293 metrics={'f1_val': 0.9432694371191018, 'auprc': 0.971326184059873, 'loss_val': 0.20929571173413455, 'psi': 0.9544921358954103}-{'f1_val': 0.8661373339025495, 'auprc': 0.9604249606559554, 'loss_val': 0.3403858005199392, 'psi': 0.9038523846039119}
[S7] START round=38 head_norm_before_train=1.566149 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.5282622949440041, 'auprc': 0.7859076137870491, 'loss_val': 0.9360021017631768, 'psi': 0.6313204224812221}-{'f1_val': 0.6582190112057891, 'auprc': 0.8279338677076915, 'loss_val': 0.5127326209823009, 'psi': 0.72610495380655}
[S8] START round=38 head_norm_before_train=1.988089 cos_to_last_merge=0.8168 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.817
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9833999345127661, 'auprc': 0.9990908017472866, 'loss_val': 0.07291313058965318, 'psi': 0.9896762814065743}-{'f1_val': 0.9941000136901317, 'auprc': 0.9929492526568042, 'loss_val': 0.03266175007045901, 'psi': 0.9936397092768007}
[S9] START round=38 head_norm_before_train=1.999844 (no previous merge yet)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9901493298847097, 'auprc': 0.9996163218657139, 'loss_val': 0.03433487372953373, 'psi': 0.9939361266771114}-{'f1_val': 0.9968525854255906, 'auprc': 0.9973389027673085, 'loss_val': 0.020049505483322405, 'psi': 0.9970471123622777}
[S10] START round=38 head_norm_before_train=1.714317 cos_to_last_merge=0.9976 (last merge round=35)
[S10] round=38 local utility u=0.000763 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924881201272664, 'loss_val': 0.05242986377851147, 'psi': 0.9941079514625314}-{'f1_val': 0.9953231205637304, 'auprc': 0.9937666356170702, 'loss_val': 0.05860269389653062, 'psi': 0.9947005265850664}
[S11] START round=38 head_norm_before_train=2.104192 (no previous merge yet)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9941434828609014, 'auprc': 0.9980675651710699, 'loss_val': 0.035943458898600934, 'psi': 0.9957131157849688}-{'f1_val': 0.996305167468861, 'auprc': 0.9979661492909394, 'loss_val': 0.024750292080157495, 'psi': 0.9969695601976923}
[S13] START round=38 head_norm_before_train=1.672191 cos_to_last_merge=1.0000 (last merge round=37)
[S13] round=38 local utility u=0.124421 metrics={'f1_val': 0.6159438581569489, 'auprc': 0.7121329495365056, 'loss_val': 0.8778222202045254, 'psi': 0.6544194947087716}-{'f1_val': 0.5956577423261007, 'auprc': 0.6615514662216082, 'loss_val': 0.8532033911732395, 'psi': 0.6220152318843037}
[S14] START round=38 head_norm_before_train=1.247286 cos_to_last_merge=0.9992 (last merge round=36)
[S14] round=38 local utility u=0.013671 metrics={'f1_val': 0.997043018986542, 'auprc': 0.9973340782072887, 'loss_val': 0.11087605498457989, 'psi': 0.9971594426748407}-{'f1_val': 0.9980850197418996, 'auprc': 0.997403813582993, 'loss_val': 0.14467991229180094, 'psi': 0.9978125372783369}
[S15] START round=38 head_norm_before_train=2.178946 (no previous merge yet)
[S15] round=38 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9920023240316826, 'loss_val': 0.021285619299474045, 'psi': 0.9948489306451854}-{'f1_val': 0.7010691361715489, 'auprc': 0.9266809833465999, 'loss_val': 0.6762537603879596, 'psi': 0.7913138750415694}
[S16] START round=38 head_norm_before_train=1.860319 cos_to_last_merge=0.7724 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8332808183890085, 'auprc': 0.8808939959494254, 'loss_val': 1.067154625672716, 'psi': 0.8523260894131752}-{'f1_val': 0.9275664852637968, 'auprc': 0.9925221547620933, 'loss_val': 0.36548535781201597, 'psi': 0.9535487530631154}
[S17] START round=38 head_norm_before_train=1.944403 cos_to_last_merge=0.7900 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.790
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6406139346630422, 'auprc': 0.838858109839926, 'loss_val': 1.172136109420126, 'psi': 0.7199116047337957}-{'f1_val': 0.6832227529994097, 'auprc': 0.9640008894311682, 'loss_val': 0.8507509999730036, 'psi': 0.7955340075721131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:39813
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:39808
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S6
[S2] cosine check vs S6: cos=-0.0499
[S2] DROPPED delta from S6 (cos=-0.0499 < 0.0)
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9939
[S7] RECEIVED delta(kind=head bytes=1798) from S13
[S7] cosine check vs S13: cos=0.9868
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=-0.1175
[S5] DROPPED delta from S3 (cos=-0.1175 < 0.0)
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S14
[S3] cosine check vs S14: cos=0.6970
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.5283 head_norm=1.579634
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.436328e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.5280 head_norm=1.629625 delta_norm=0.143633
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6159 head_norm=1.690375
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.002945e-01
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6158 head_norm=1.718883 delta_norm=0.100295
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=38 metric=0.9829 head_norm=1.387045
[S3] _apply_head_vector_avg (torch): Δ‖w‖=5.237378e-01
[S3] stored merged vector for next round verification (round=38)
[S3] DEBUG after merge:  round=38 metric=0.9825 head_norm=1.235412 delta_norm=0.523738
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=2.056027 (no previous merge yet)
[S2] round=39 local utility u=0.129752 metrics={'f1_val': 0.9152631215229066, 'auprc': 0.8456150627646724, 'loss_val': 0.24831529507739447, 'psi': 0.887403898019613}-{'f1_val': 0.8279144195036046, 'auprc': 0.9911766118741975, 'loss_val': 0.4204121052211066, 'psi': 0.8932192964518417}
[S3] START round=39 head_norm_before_train=1.235412 cos_to_last_merge=1.0000 (last merge round=38)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9996801470271239, 'loss_val': 0.19594282411631353, 'psi': 0.9765171100505219}-{'f1_val': 0.9828856030778024, 'auprc': 0.9997585280476804, 'loss_val': 0.11957468224378466, 'psi': 0.9896347730657535}
[S4] START round=39 head_norm_before_train=2.077599 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9541136580144157, 'auprc': 0.927395104768715, 'loss_val': 0.3111266249783237, 'psi': 0.9434262367161355}-{'f1_val': 0.9543949762473593, 'auprc': 0.9306412654800135, 'loss_val': 0.31142164232412645, 'psi': 0.9448934919404208}
[S5] START round=39 head_norm_before_train=1.679461 cos_to_last_merge=0.9994 (last merge round=35)
[S5] round=39 local utility u=0.555372 metrics={'f1_val': 0.6551225154825367, 'auprc': 0.6610444288565454, 'loss_val': 0.507149463729429, 'psi': 0.6574912808321403}-{'f1_val': 0.43676623050537206, 'auprc': 0.8576440386823644, 'loss_val': 0.8975555142294286, 'psi': 0.6051173537761689}
[S6] START round=39 head_norm_before_train=1.745765 cos_to_last_merge=0.9996 (last merge round=36)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.6148431346960715, 'auprc': 0.9386722896379217, 'loss_val': 0.8327285431931659, 'psi': 0.7443747966728116}-{'f1_val': 0.9432694371191018, 'auprc': 0.971326184059873, 'loss_val': 0.20929571173413455, 'psi': 0.9544921358954103}
[S7] START round=39 head_norm_before_train=1.629625 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=1.000000 metrics={'f1_val': 0.6997475839815461, 'auprc': 0.9881953611877582, 'loss_val': 0.2602452180029917, 'psi': 0.815126694864031}-{'f1_val': 0.5282622949440041, 'auprc': 0.7859076137870491, 'loss_val': 0.9360021017631768, 'psi': 0.6313204224812221}
[S8] START round=39 head_norm_before_train=1.991072 cos_to_last_merge=0.8165 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=39 local utility u=0.050178 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9990872071678707, 'loss_val': 0.030158335661876364, 'psi': 0.9954359575588207}-{'f1_val': 0.9833999345127661, 'auprc': 0.9990908017472866, 'loss_val': 0.07291313058965318, 'psi': 0.9896762814065743}
[S9] START round=39 head_norm_before_train=2.006644 (no previous merge yet)
[S9] round=39 local utility u=0.024332 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9996086538379441, 'loss_val': 0.020876493385809786, 'psi': 0.9974558827214899}-{'f1_val': 0.9901493298847097, 'auprc': 0.9996163218657139, 'loss_val': 0.03433487372953373, 'psi': 0.9939361266771114}
[S10] START round=39 head_norm_before_train=1.752674 cos_to_last_merge=0.9955 (last merge round=35)
[S10] round=39 local utility u=0.004145 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929525126678419, 'loss_val': 0.04553352364061718, 'psi': 0.9942937084787615}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924881201272664, 'loss_val': 0.05242986377851147, 'psi': 0.9941079514625314}
[S11] START round=39 head_norm_before_train=2.112602 (no previous merge yet)
[S11] round=39 local utility u=0.000000 metrics={'f1_val': 0.9514366199622308, 'auprc': 0.9980526147088905, 'loss_val': 0.1734855049308573, 'psi': 0.9700830178608947}-{'f1_val': 0.9941434828609014, 'auprc': 0.9980675651710699, 'loss_val': 0.035943458898600934, 'psi': 0.9957131157849688}
[S13] START round=39 head_norm_before_train=1.718883 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.605364362412484, 'auprc': 0.6156332647109324, 'loss_val': 0.949614484854179, 'psi': 0.6094719233318634}-{'f1_val': 0.6159438581569489, 'auprc': 0.7121329495365056, 'loss_val': 0.8778222202045254, 'psi': 0.6544194947087716}
[S14] START round=39 head_norm_before_train=1.295066 cos_to_last_merge=0.9973 (last merge round=36)
[S14] round=39 local utility u=0.012534 metrics={'f1_val': 0.9970207327224484, 'auprc': 0.9990946779129758, 'loss_val': 0.09095669005388722, 'psi': 0.9978503107986594}-{'f1_val': 0.997043018986542, 'auprc': 0.9973340782072887, 'loss_val': 0.11087605498457989, 'psi': 0.9971594426748407}
[S15] START round=39 head_norm_before_train=2.189470 (no previous merge yet)
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7748172784019252, 'auprc': 0.991050065669921, 'loss_val': 0.5043578121853278, 'psi': 0.8613103933091235}-{'f1_val': 0.9967466683875206, 'auprc': 0.9920023240316826, 'loss_val': 0.021285619299474045, 'psi': 0.9948489306451854}
[S16] START round=39 head_norm_before_train=1.868434 cos_to_last_merge=0.7718 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=39 local utility u=0.767942 metrics={'f1_val': 0.8947383504292982, 'auprc': 0.9913254221253759, 'loss_val': 0.23130973997241383, 'psi': 0.9333731791077292}-{'f1_val': 0.8332808183890085, 'auprc': 0.8808939959494254, 'loss_val': 1.067154625672716, 'psi': 0.8523260894131752}
[S17] START round=39 head_norm_before_train=1.958579 cos_to_last_merge=0.7889 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=39 local utility u=1.000000 metrics={'f1_val': 0.8426027587676288, 'auprc': 0.9196604887949104, 'loss_val': 0.5508025211456004, 'psi': 0.8734258507785415}-{'f1_val': 0.6406139346630422, 'auprc': 0.838858109839926, 'loss_val': 1.172136109420126, 'psi': 0.7199116047337957}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39817
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S14] → sending delta(kind=head bytes=1808) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:39812
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39809
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1808 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S5
[S8] cosine check vs S5: cos=-0.0231
[S8] DROPPED delta from S5 (cos=-0.0231 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1808) from S14
[S3] cosine check vs S14: cos=0.8954
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=-0.1304
[S17] DROPPED delta from S8 (cos=-0.1304 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S7
[S6] cosine check vs S7: cos=0.5808
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=-0.2059
[S11] DROPPED delta from S2 (cos=-0.2059 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9973
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] r=40 psi=0.997 u=0.0243 p_local=0.0101 f1=0.996 auprc=1.000 bytes=32403
[S11] r=40 psi=0.970 u=0.0000 p_local=0.0276 f1=0.951 auprc=0.998 bytes=26992
[S5] r=40 psi=0.657 u=0.5554 p_local=0.4011 f1=0.655 auprc=0.661 bytes=32391
[S10] r=40 psi=0.994 u=0.0041 p_local=0.0060 f1=0.995 auprc=0.993 bytes=35980
[S2] r=40 psi=0.887 u=0.1298 p_local=0.1449 f1=0.915 auprc=0.846 bytes=30576
[S7] r=40 psi=0.815 u=1.0000 p_local=0.3136 f1=0.700 auprc=0.988 bytes=30574
[S8] r=40 psi=0.995 u=0.0502 p_local=0.1563 f1=0.993 auprc=0.999 bytes=34212
[S4] r=40 psi=0.943 u=0.0000 p_local=0.0099 f1=0.954 auprc=0.927 bytes=34185
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=39 metric=0.9611 head_norm=1.292895
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.016671e-01
[S3] stored merged vector for next round verification (round=39)
[S3] DEBUG after merge:  round=39 metric=0.9611 head_norm=1.280591 delta_norm=0.301667
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3] r=40 psi=0.977 u=0.0000 p_local=0.2012 f1=0.961 auprc=1.000 bytes=32397
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=39 metric=0.6148 head_norm=1.776632
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.848084e-01
[S6] stored merged vector for next round verification (round=39)
[S6] DEBUG after merge:  round=39 metric=0.6137 head_norm=1.519779 delta_norm=0.784808
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S6] r=40 psi=0.744 u=0.0000 p_local=0.3386 f1=0.615 auprc=0.939 bytes=32386
[S15] r=40 psi=0.861 u=0.0000 p_local=0.3032 f1=0.775 auprc=0.991 bytes=30559
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=39 metric=0.6054 head_norm=1.734874
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.915727e-02
[S13] stored merged vector for next round verification (round=39)
[S13] DEBUG after merge:  round=39 metric=0.6052 head_norm=1.758927 delta_norm=0.069157
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=40 psi=0.609 u=0.0000 p_local=0.0491 f1=0.605 auprc=0.616 bytes=34188
[S14] r=40 psi=0.998 u=0.0125 p_local=0.0152 f1=0.997 auprc=0.999 bytes=37817
[S17] r=40 psi=0.873 u=1.0000 p_local=0.3460 f1=0.843 auprc=0.920 bytes=34179
[S16] r=40 psi=0.933 u=0.7679 p_local=0.2589 f1=0.895 auprc=0.991 bytes=28716
[S2] START round=40 head_norm_before_train=2.058672 (no previous merge yet)
[S2] round=40 local utility u=0.081446 metrics={'f1_val': 0.915596603758512, 'auprc': 0.9024890779867523, 'loss_val': 0.25804531991073437, 'psi': 0.9103535934498082}-{'f1_val': 0.9152631215229066, 'auprc': 0.8456150627646724, 'loss_val': 0.24831529507739447, 'psi': 0.887403898019613}
[S3] START round=40 head_norm_before_train=1.280591 cos_to_last_merge=1.0000 (last merge round=39)
[S3] round=40 local utility u=0.058523 metrics={'f1_val': 0.9808691885975782, 'auprc': 0.9995992639436877, 'loss_val': 0.19741863732782924, 'psi': 0.988361218736022}-{'f1_val': 0.9610750853994537, 'auprc': 0.9996801470271239, 'loss_val': 0.19594282411631353, 'psi': 0.9765171100505219}
[S4] START round=40 head_norm_before_train=2.090273 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9533505952830897, 'auprc': 0.9268091499540958, 'loss_val': 0.31230245040570664, 'psi': 0.9427340171514922}-{'f1_val': 0.9541136580144157, 'auprc': 0.927395104768715, 'loss_val': 0.3111266249783237, 'psi': 0.9434262367161355}
[S5] START round=40 head_norm_before_train=1.686118 cos_to_last_merge=0.9992 (last merge round=35)
[S5] round=40 local utility u=0.319476 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.7458682199632979, 'loss_val': 0.3948941414130419, 'psi': 0.7186432648666106}-{'f1_val': 0.6551225154825367, 'auprc': 0.6610444288565454, 'loss_val': 0.507149463729429, 'psi': 0.6574912808321403}
[S6] START round=40 head_norm_before_train=1.519779 cos_to_last_merge=1.0000 (last merge round=39)
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.940656539365795, 'auprc': 0.9648729887365237, 'loss_val': 0.2589301669410342, 'psi': 0.9503431191140864}-{'f1_val': 0.6148431346960715, 'auprc': 0.9386722896379217, 'loss_val': 0.8327285431931659, 'psi': 0.7443747966728116}
[S7] START round=40 head_norm_before_train=1.641611 cos_to_last_merge=0.9999 (last merge round=38)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5090200921316513, 'auprc': 0.7823787666926597, 'loss_val': 1.0544951903492268, 'psi': 0.6183635619560547}-{'f1_val': 0.6997475839815461, 'auprc': 0.9881953611877582, 'loss_val': 0.2602452180029917, 'psi': 0.815126694864031}
[S8] START round=40 head_norm_before_train=2.002293 cos_to_last_merge=0.8157 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.816
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9707488712283975, 'auprc': 0.999006178878022, 'loss_val': 0.0750872705977212, 'psi': 0.9820517942882472}-{'f1_val': 0.9930017911527874, 'auprc': 0.9990872071678707, 'loss_val': 0.030158335661876364, 'psi': 0.9954359575588207}
[S9] START round=40 head_norm_before_train=2.014520 (no previous merge yet)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9930734107733121, 'auprc': 0.9996075220745069, 'loss_val': 0.0250230210712925, 'psi': 0.99568705529379}-{'f1_val': 0.9960207019771873, 'auprc': 0.9996086538379441, 'loss_val': 0.020876493385809786, 'psi': 0.9974558827214899}
[S10] START round=40 head_norm_before_train=1.785336 cos_to_last_merge=0.9935 (last merge round=35)
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9918753859095, 'loss_val': 0.042960238854113916, 'psi': 0.9938628577754248}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929525126678419, 'loss_val': 0.04553352364061718, 'psi': 0.9942937084787615}
[S11] START round=40 head_norm_before_train=2.122115 (no previous merge yet)
[S11] round=40 local utility u=0.209306 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979600204442366, 'loss_val': 0.02380773246275477, 'psi': 0.9969671086590113}-{'f1_val': 0.9514366199622308, 'auprc': 0.9980526147088905, 'loss_val': 0.1734855049308573, 'psi': 0.9700830178608947}
[S13] START round=40 head_norm_before_train=1.758927 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=40 local utility u=0.250870 metrics={'f1_val': 0.6249373375571865, 'auprc': 0.7358709893472184, 'loss_val': 0.9260247232714386, 'psi': 0.6693107982731993}-{'f1_val': 0.605364362412484, 'auprc': 0.6156332647109324, 'loss_val': 0.949614484854179, 'psi': 0.6094719233318634}
[S14] START round=40 head_norm_before_train=1.338003 cos_to_last_merge=0.9948 (last merge round=36)
[S14] round=40 local utility u=0.001127 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9973323676103004, 'loss_val': 0.08065459182623641, 'psi': 0.9968691738143789}-{'f1_val': 0.9970207327224484, 'auprc': 0.9990946779129758, 'loss_val': 0.09095669005388722, 'psi': 0.9978503107986594}
[S15] START round=40 head_norm_before_train=2.200815 (no previous merge yet)
[S15] round=40 local utility u=0.912689 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9968046944127816, 'loss_val': 0.025334189142902797, 'psi': 0.9965213242743972}-{'f1_val': 0.7748172784019252, 'auprc': 0.991050065669921, 'loss_val': 0.5043578121853278, 'psi': 0.8613103933091235}
[S16] START round=40 head_norm_before_train=1.876967 cos_to_last_merge=0.7712 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=40 local utility u=0.389063 metrics={'f1_val': 0.9927965201703866, 'auprc': 0.9936898118187232, 'loss_val': 0.048626421100980546, 'psi': 0.9931538368297211}-{'f1_val': 0.8947383504292982, 'auprc': 0.9913254221253759, 'loss_val': 0.23130973997241383, 'psi': 0.9333731791077292}
[S17] START round=40 head_norm_before_train=1.971316 cos_to_last_merge=0.7879 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.788
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6287642250300693, 'auprc': 0.8738838460856191, 'loss_val': 1.3523879854272063, 'psi': 0.7268120734522892}-{'f1_val': 0.8426027587676288, 'auprc': 0.9196604887949104, 'loss_val': 0.5508025211456004, 'psi': 0.8734258507785415}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S14] → sending delta(kind=head bytes=1809) to S3@127.0.0.1:39803
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:39808
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:39812
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39802
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39805
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S6
[S2] cosine check vs S6: cos=-0.0192
[S2] DROPPED delta from S6 (cos=-0.0192 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=-0.2055
[S11] DROPPED delta from S2 (cos=-0.2055 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1805) from S3
[S5] cosine check vs S3: cos=-0.1208
[S5] DROPPED delta from S3 (cos=-0.1208 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1805) from S13
[S7] cosine check vs S13: cos=0.9873
[S8] RECEIVED delta(kind=head bytes=1801) from S5
[S8] cosine check vs S5: cos=-0.0233
[S8] DROPPED delta from S5 (cos=-0.0233 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1809 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1809) from S14
[S3] cosine check vs S14: cos=0.9512
[S8] ⇄ pheromone p=0.125 → S17@127.0.0.1:39817
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=40 metric=0.9809 head_norm=1.356290
[S3] _apply_head_vector_avg (torch): Δ‖w‖=2.133636e-01
[S3] stored merged vector for next round verification (round=40)
[S3] DEBUG after merge:  round=40 metric=0.9747 head_norm=1.348133 delta_norm=0.213364
[S3] aggregate: ROLLBACK (f1_val pre=0.981 post=0.975 tol_abs=0.005 tol_rel=0.0)
[S3] ⇄ pheromone p=0.173 → S5@127.0.0.1:39805
[S5] ⇄ pheromone p=0.385 → S8@127.0.0.1:39809
[S13] ⇄ pheromone p=0.089 → S7@127.0.0.1:39808
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.5090 head_norm=1.649961
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.486495e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.5035 head_norm=1.704031 delta_norm=0.148650
[S7] aggregate: ROLLBACK (f1_val pre=0.509 post=0.503 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.251 → S6@127.0.0.1:39807
[S6] ⇄ pheromone p=0.471 → S2@127.0.0.1:39802
[S2] ⇄ pheromone p=0.132 → S11@127.0.0.1:39812
[S14] ⇄ pheromone p=0.012 → S3@127.0.0.1:39803
[S10] ⇄ pheromone p=0.005 → S13@127.0.0.1:39813
[S17] ⇄ pheromone p=0.277 → S8@127.0.0.1:39809
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S2] START round=41 head_norm_before_train=2.063593 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.8881212216498066, 'auprc': 0.9306551711057296, 'loss_val': 0.29493837910100945, 'psi': 0.9051348014321758}-{'f1_val': 0.915596603758512, 'auprc': 0.9024890779867523, 'loss_val': 0.25804531991073437, 'psi': 0.9103535934498082}
[S3] START round=41 head_norm_before_train=1.348133 cos_to_last_merge=1.0000 (last merge round=40)
[S3] round=41 local utility u=0.001941 metrics={'f1_val': 0.9812845891804466, 'auprc': 0.9987654849763904, 'loss_val': 0.19352828955766718, 'psi': 0.9882769474988241}-{'f1_val': 0.9808691885975782, 'auprc': 0.9995992639436877, 'loss_val': 0.19741863732782924, 'psi': 0.988361218736022}
[S4] START round=41 head_norm_before_train=2.099094 (no previous merge yet)
[S4] round=41 local utility u=0.049280 metrics={'f1_val': 0.9563057923357499, 'auprc': 0.9540238636884459, 'loss_val': 0.313117999705189, 'psi': 0.9553930208768283}-{'f1_val': 0.9533505952830897, 'auprc': 0.9268091499540958, 'loss_val': 0.31230245040570664, 'psi': 0.9427340171514922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=41 head_norm_before_train=1.692182 cos_to_last_merge=0.9988 (last merge round=35)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.664063783325712, 'auprc': 0.7050858002974756, 'loss_val': 0.4448648081655374, 'psi': 0.6804725901144175}-{'f1_val': 0.7004932948021524, 'auprc': 0.7458682199632979, 'loss_val': 0.3948941414130419, 'psi': 0.7186432648666106}
[S6] START round=41 head_norm_before_train=1.569450 cos_to_last_merge=0.9990 (last merge round=39)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8221292983539572, 'auprc': 0.9525841401170028, 'loss_val': 0.3679099507336281, 'psi': 0.8743112350591754}-{'f1_val': 0.940656539365795, 'auprc': 0.9648729887365237, 'loss_val': 0.2589301669410342, 'psi': 0.9503431191140864}
[S7] START round=41 head_norm_before_train=1.704031 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.839886 metrics={'f1_val': 0.6698658858029318, 'auprc': 0.8220263480774175, 'loss_val': 0.45874004537500795, 'psi': 0.7307300707127261}-{'f1_val': 0.5090200921316513, 'auprc': 0.7823787666926597, 'loss_val': 1.0544951903492268, 'psi': 0.6183635619560547}
[S8] START round=41 head_norm_before_train=2.014509 cos_to_last_merge=0.8149 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=41 local utility u=0.093126 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9991665443665065, 'loss_val': 0.02942363027605882, 'psi': 0.9961266259606816}-{'f1_val': 0.9707488712283975, 'auprc': 0.999006178878022, 'loss_val': 0.0750872705977212, 'psi': 0.9820517942882472}
[S9] START round=41 head_norm_before_train=2.020845 (no previous merge yet)
[S9] round=41 local utility u=0.008896 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9995830963646639, 'loss_val': 0.022175733958097077, 'psi': 0.9971790738763744}-{'f1_val': 0.9930734107733121, 'auprc': 0.9996075220745069, 'loss_val': 0.0250230210712925, 'psi': 0.99568705529379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=41 head_norm_before_train=1.812969 cos_to_last_merge=0.9917 (last merge round=35)
[S10] round=41 local utility u=0.003179 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9925123372596554, 'loss_val': 0.039325066572312314, 'psi': 0.9941988072421004}-{'f1_val': 0.9951878390193748, 'auprc': 0.9918753859095, 'loss_val': 0.042960238854113916, 'psi': 0.9938628577754248}
[S11] START round=41 head_norm_before_train=2.131541 (no previous merge yet)
[S11] round=41 local utility u=0.000174 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979577939558691, 'loss_val': 0.023453434598793853, 'psi': 0.9969662180636643}-{'f1_val': 0.996305167468861, 'auprc': 0.9979600204442366, 'loss_val': 0.02380773246275477, 'psi': 0.9969671086590113}
[S13] START round=41 head_norm_before_train=1.768973 cos_to_last_merge=1.0000 (last merge round=39)
[S13] round=41 local utility u=0.141122 metrics={'f1_val': 0.6605978194989122, 'auprc': 0.7594623261490768, 'loss_val': 0.9285170673212618, 'psi': 0.7001436221589781}-{'f1_val': 0.6249373375571865, 'auprc': 0.7358709893472184, 'loss_val': 0.9260247232714386, 'psi': 0.6693107982731993}
[S14] START round=41 head_norm_before_train=1.373481 cos_to_last_merge=0.9925 (last merge round=36)
[S14] round=41 local utility u=0.010185 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9989231517717394, 'loss_val': 0.06913698664944838, 'psi': 0.9979134747321716}-{'f1_val': 0.9965603779504312, 'auprc': 0.9973323676103004, 'loss_val': 0.08065459182623641, 'psi': 0.9968691738143789}
[S15] START round=41 head_norm_before_train=2.212517 (no previous merge yet)
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.99356111270615, 'loss_val': 0.024367888526328187, 'psi': 0.9952238915917445}-{'f1_val': 0.9963324108488076, 'auprc': 0.9968046944127816, 'loss_val': 0.025334189142902797, 'psi': 0.9965213242743972}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.885651 cos_to_last_merge=0.7707 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9773528294516767, 'auprc': 0.9921866027793065, 'loss_val': 0.0815485723854112, 'psi': 0.9832863387827286}-{'f1_val': 0.9927965201703866, 'auprc': 0.9936898118187232, 'loss_val': 0.048626421100980546, 'psi': 0.9931538368297211}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.982855 cos_to_last_merge=0.7870 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.787
[S17] round=41 local utility u=1.000000 metrics={'f1_val': 0.8824304236167082, 'auprc': 0.9953153233545168, 'loss_val': 0.42211453247671316, 'psi': 0.9275843835118316}-{'f1_val': 0.6287642250300693, 'auprc': 0.8738838460856191, 'loss_val': 1.3523879854272063, 'psi': 0.7268120734522892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:39809
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:39813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39802
[S10] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39805
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:39808
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=0.9978
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=-0.2056
[S2] DROPPED delta from S11 (cos=-0.2056 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=-0.1301
[S8] DROPPED delta from S17 (cos=-0.1301 < 0.0)
[S8] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=-0.0231
[S5] DROPPED delta from S8 (cos=-0.0231 < 0.0)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39805
[S3] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=-0.1217
[S5] DROPPED delta from S3 (cos=-0.1217 < 0.0)
[S13] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S13
[S7] cosine check vs S13: cos=0.9966
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.6606 head_norm=1.781776
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.614105e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.6448 head_norm=1.807798 delta_norm=0.066141
[S13] aggregate: ROLLBACK (f1_val pre=0.661 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S14] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:39803
[S14] sending update (kind=head size=1803 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S14
[S3] cosine check vs S14: cos=0.9667
[S7] RoundReady barrier timeout: have=2 need=3 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39807
[S7] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=0.8529
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=41 metric=0.9813 head_norm=1.432739
[S3] _apply_head_vector_avg (torch): Δ‖w‖=1.836328e-01
[S3] stored merged vector for next round verification (round=41)
[S3] DEBUG after merge:  round=41 metric=0.9803 head_norm=1.406688 delta_norm=0.183633
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S3]  timeout peer S5
[S5]  timeout peer S8
[S5]  timeout peer S10
[S6]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S15
[S14]  timeout peer S16
[S10]  timeout peer S13
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S14
[S2]  timeout peer S11
[S13]  timeout peer S7
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=41 metric=0.6699 head_norm=1.710094
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.016259e-02
[S7] stored merged vector for next round verification (round=41)
[S7] DEBUG after merge:  round=41 metric=0.6697 head_norm=1.744462 delta_norm=0.080163
[S7] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.070095 (no previous merge yet)
[S2] round=42 local utility u=0.188313 metrics={'f1_val': 0.9157379178655656, 'auprc': 0.9782770039581605, 'loss_val': 0.22687732559395868, 'psi': 0.9407535523026036}-{'f1_val': 0.8881212216498066, 'auprc': 0.9306551711057296, 'loss_val': 0.29493837910100945, 'psi': 0.9051348014321758}
[S3] START round=42 head_norm_before_train=1.406688 cos_to_last_merge=1.0000 (last merge round=41)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9596861317232088, 'auprc': 0.9980003105867193, 'loss_val': 0.194918386219591, 'psi': 0.975011803268613}-{'f1_val': 0.9812845891804466, 'auprc': 0.9987654849763904, 'loss_val': 0.19352828955766718, 'psi': 0.9882769474988241}
[S4] START round=42 head_norm_before_train=2.101270 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9576816111604424, 'auprc': 0.9477106628681713, 'loss_val': 0.3176455999116139, 'psi': 0.9536932318435339}-{'f1_val': 0.9563057923357499, 'auprc': 0.9540238636884459, 'loss_val': 0.313117999705189, 'psi': 0.9553930208768283}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.697993 cos_to_last_merge=0.9984 (last merge round=35)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.6134509628924613, 'auprc': 0.7118388587016965, 'loss_val': 0.5569375355827489, 'psi': 0.6528061212161553}-{'f1_val': 0.664063783325712, 'auprc': 0.7050858002974756, 'loss_val': 0.4448648081655374, 'psi': 0.6804725901144175}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.626169 cos_to_last_merge=0.9964 (last merge round=39)
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7290248360012065, 'auprc': 0.9038984927403624, 'loss_val': 0.5682185681899083, 'psi': 0.7989742986968689}-{'f1_val': 0.8221292983539572, 'auprc': 0.9525841401170028, 'loss_val': 0.3679099507336281, 'psi': 0.8743112350591754}
[S7] START round=42 head_norm_before_train=1.744462 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6415899771500703, 'auprc': 0.8042530147972117, 'loss_val': 0.5598328563163004, 'psi': 0.7066551922089268}-{'f1_val': 0.6698658858029318, 'auprc': 0.8220263480774175, 'loss_val': 0.45874004537500795, 'psi': 0.7307300707127261}
[S8] START round=42 head_norm_before_train=2.024887 cos_to_last_merge=0.8142 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.992959481021298, 'auprc': 0.9991079419314046, 'loss_val': 0.030835762060866998, 'psi': 0.9954188653853407}-{'f1_val': 0.9941000136901317, 'auprc': 0.9991665443665065, 'loss_val': 0.02942363027605882, 'psi': 0.9961266259606816}
[S9] START round=42 head_norm_before_train=2.026633 (no previous merge yet)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9953362285017175, 'loss_val': 0.019367166681557888, 'psi': 0.9959806028010195}-{'f1_val': 0.9955763922175147, 'auprc': 0.9995830963646639, 'loss_val': 0.022175733958097077, 'psi': 0.9971790738763744}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.835835 cos_to_last_merge=0.9901 (last merge round=35)
[S10] round=42 local utility u=0.000986 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927502596379169, 'loss_val': 0.03725555398483129, 'psi': 0.9942128072667915}-{'f1_val': 0.9953231205637304, 'auprc': 0.9925123372596554, 'loss_val': 0.039325066572312314, 'psi': 0.9941988072421004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=42 head_norm_before_train=2.140709 (no previous merge yet)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963061018870393, 'auprc': 0.9980369352536405, 'loss_val': 0.028286951374312915, 'psi': 0.9969984352336798}-{'f1_val': 0.996305167468861, 'auprc': 0.9979577939558691, 'loss_val': 0.023453434598793853, 'psi': 0.9969662180636643}
[S13] START round=42 head_norm_before_train=1.807798 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5942857994667605, 'auprc': 0.7367848591347949, 'loss_val': 1.1906577505185711, 'psi': 0.6512854233339742}-{'f1_val': 0.6605978194989122, 'auprc': 0.7594623261490768, 'loss_val': 0.9285170673212618, 'psi': 0.7001436221589781}
[S14] START round=42 head_norm_before_train=1.404365 cos_to_last_merge=0.9903 (last merge round=36)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963403242578577, 'auprc': 0.9972437238850418, 'loss_val': 0.06440510834291538, 'psi': 0.9967016841087313}-{'f1_val': 0.997240356705793, 'auprc': 0.9989231517717394, 'loss_val': 0.06913698664944838, 'psi': 0.9979134747321716}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.224124 (no previous merge yet)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9452300154913664, 'auprc': 0.9911977601225722, 'loss_val': 0.07812774154203674, 'psi': 0.9636171133438487}-{'f1_val': 0.9963324108488076, 'auprc': 0.99356111270615, 'loss_val': 0.024367888526328187, 'psi': 0.9952238915917445}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.894752 cos_to_last_merge=0.7701 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8491258497832588, 'auprc': 0.935480031933977, 'loss_val': 0.9333734218347445, 'psi': 0.8836675226435461}-{'f1_val': 0.9773528294516767, 'auprc': 0.9921866027793065, 'loss_val': 0.0815485723854112, 'psi': 0.9832863387827286}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.991280 cos_to_last_merge=0.7863 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.8068216250417002, 'auprc': 0.9882399435066255, 'loss_val': 0.6059676363392493, 'psi': 0.8793889524276703}-{'f1_val': 0.8824304236167082, 'auprc': 0.9953153233545168, 'loss_val': 0.42211453247671316, 'psi': 0.9275843835118316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=42 metric=0.7290 head_norm=1.672038
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.791130e-01
[S6] stored merged vector for next round verification (round=42)
[S6] DEBUG after merge:  round=42 metric=0.7266 head_norm=1.621887 delta_norm=0.479113
[S6] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.077587 (no previous merge yet)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.9065036427015398, 'auprc': 0.9843952281794671, 'loss_val': 0.24425656248060204, 'psi': 0.9376602768927107}-{'f1_val': 0.9157379178655656, 'auprc': 0.9782770039581605, 'loss_val': 0.22687732559395868, 'psi': 0.9407535523026036}
[S3] START round=43 head_norm_before_train=1.490412 cos_to_last_merge=0.9950 (last merge round=41)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.8411591325920932, 'auprc': 0.9975137437830883, 'loss_val': 0.3222844874828304, 'psi': 0.9037009770684912}-{'f1_val': 0.9596861317232088, 'auprc': 0.9980003105867193, 'loss_val': 0.194918386219591, 'psi': 0.975011803268613}
[S4] START round=43 head_norm_before_train=2.101530 (no previous merge yet)
[S4] round=43 local utility u=0.004635 metrics={'f1_val': 0.9545084904254237, 'auprc': 0.9565306559136377, 'loss_val': 0.315797485031795, 'psi': 0.9553173566207093}-{'f1_val': 0.9576816111604424, 'auprc': 0.9477106628681713, 'loss_val': 0.3176455999116139, 'psi': 0.9536932318435339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=43 head_norm_before_train=1.709554 cos_to_last_merge=0.9977 (last merge round=35)
[S5] round=43 local utility u=0.509051 metrics={'f1_val': 0.63924523147162, 'auprc': 0.9400715655538845, 'loss_val': 0.37829897930800943, 'psi': 0.7595757651045258}-{'f1_val': 0.6134509628924613, 'auprc': 0.7118388587016965, 'loss_val': 0.5569375355827489, 'psi': 0.6528061212161553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=43 head_norm_before_train=1.621887 cos_to_last_merge=1.0000 (last merge round=42)
[S6] round=43 local utility u=0.521563 metrics={'f1_val': 0.8305120302868407, 'auprc': 0.9624424115806973, 'loss_val': 0.30964773669549434, 'psi': 0.8832841828043834}-{'f1_val': 0.7290248360012065, 'auprc': 0.9038984927403624, 'loss_val': 0.5682185681899083, 'psi': 0.7989742986968689}
[S7] START round=43 head_norm_before_train=1.748277 cos_to_last_merge=1.0000 (last merge round=41)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5922051752298165, 'auprc': 0.795559649573372, 'loss_val': 0.6274523247025912, 'psi': 0.6735469649672388}-{'f1_val': 0.6415899771500703, 'auprc': 0.8042530147972117, 'loss_val': 0.5598328563163004, 'psi': 0.7066551922089268}
[S8] START round=43 head_norm_before_train=2.029488 cos_to_last_merge=0.8136 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9877803895057649, 'auprc': 0.9988973206872603, 'loss_val': 0.04176676530796124, 'psi': 0.992227161978363}-{'f1_val': 0.992959481021298, 'auprc': 0.9991079419314046, 'loss_val': 0.030835762060866998, 'psi': 0.9954188653853407}
[S9] START round=43 head_norm_before_train=2.031694 (no previous merge yet)
[S9] round=43 local utility u=0.000191 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.9997923295498139, 'loss_val': 0.022357233987407257, 'psi': 0.9967633885897562}-{'f1_val': 0.9964101856672208, 'auprc': 0.9953362285017175, 'loss_val': 0.019367166681557888, 'psi': 0.9959806028010195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=43 head_norm_before_train=1.855801 cos_to_last_merge=0.9887 (last merge round=35)
[S10] round=43 local utility u=0.000839 metrics={'f1_val': 0.9953231205637304, 'auprc': 0.9925135415979223, 'loss_val': 0.03568008006898328, 'psi': 0.9941992889774072}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927502596379169, 'loss_val': 0.03725555398483129, 'psi': 0.9942128072667915}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=43 head_norm_before_train=2.148802 (no previous merge yet)
[S11] round=43 local utility u=0.003381 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980653080962767, 'loss_val': 0.023179036986863032, 'psi': 0.9971666056222389}-{'f1_val': 0.9963061018870393, 'auprc': 0.9980369352536405, 'loss_val': 0.028286951374312915, 'psi': 0.9969984352336798}
[S13] START round=43 head_norm_before_train=1.820545 cos_to_last_merge=0.9999 (last merge round=41)
[S13] round=43 local utility u=0.254574 metrics={'f1_val': 0.6208220478067541, 'auprc': 0.7205106915850429, 'loss_val': 0.7919051974703024, 'psi': 0.6606975053180696}-{'f1_val': 0.5942857994667605, 'auprc': 0.7367848591347949, 'loss_val': 1.1906577505185711, 'psi': 0.6512854233339742}
[S14] START round=43 head_norm_before_train=1.430860 cos_to_last_merge=0.9884 (last merge round=36)
[S14] round=43 local utility u=0.008701 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9988864156244455, 'loss_val': 0.0573319769040567, 'psi': 0.997898780273254}-{'f1_val': 0.9963403242578577, 'auprc': 0.9972437238850418, 'loss_val': 0.06440510834291538, 'psi': 0.9967016841087313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=43 head_norm_before_train=2.234181 (no previous merge yet)
[S15] round=43 local utility u=0.183120 metrics={'f1_val': 0.9942813188098336, 'auprc': 0.9971508111604588, 'loss_val': 0.024054275796709504, 'psi': 0.9954291157500836}-{'f1_val': 0.9452300154913664, 'auprc': 0.9911977601225722, 'loss_val': 0.07812774154203674, 'psi': 0.9636171133438487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=43 head_norm_before_train=1.902775 cos_to_last_merge=0.7694 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=43 local utility u=0.764568 metrics={'f1_val': 0.9448146608483483, 'auprc': 0.9936609330507822, 'loss_val': 0.1529124250313908, 'psi': 0.9643531697293218}-{'f1_val': 0.8491258497832588, 'auprc': 0.935480031933977, 'loss_val': 0.9333734218347445, 'psi': 0.8836675226435461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=43 head_norm_before_train=1.999808 cos_to_last_merge=0.7858 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=43 local utility u=0.398790 metrics={'f1_val': 0.9119837059492232, 'auprc': 0.98758324556405, 'loss_val': 0.43739055580878267, 'psi': 0.9422235217951538}-{'f1_val': 0.8068216250417002, 'auprc': 0.9882399435066255, 'loss_val': 0.6059676363392493, 'psi': 0.8793889524276703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=2.082858 (no previous merge yet)
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.8969716342248203, 'auprc': 0.9805791084162092, 'loss_val': 0.24543786785685218, 'psi': 0.9304146239013757}-{'f1_val': 0.9065036427015398, 'auprc': 0.9843952281794671, 'loss_val': 0.24425656248060204, 'psi': 0.9376602768927107}
[S3] START round=44 head_norm_before_train=1.571476 cos_to_last_merge=0.9851 (last merge round=41)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.8137973883351302, 'auprc': 0.9945105646600669, 'loss_val': 0.3949113822476751, 'psi': 0.886082658865105}-{'f1_val': 0.8411591325920932, 'auprc': 0.9975137437830883, 'loss_val': 0.3222844874828304, 'psi': 0.9037009770684912}
[S4] START round=44 head_norm_before_train=2.102196 (no previous merge yet)
[S4] round=44 local utility u=0.016116 metrics={'f1_val': 0.955461393165338, 'auprc': 0.9625023595384313, 'loss_val': 0.3071971156301521, 'psi': 0.9582777797145753}-{'f1_val': 0.9545084904254237, 'auprc': 0.9565306559136377, 'loss_val': 0.315797485031795, 'psi': 0.9553173566207093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.731738 cos_to_last_merge=0.9962 (last merge round=35)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.5272276648610886, 'auprc': 0.8515877387058604, 'loss_val': 0.7564443362914857, 'psi': 0.6569716943989974}-{'f1_val': 0.63924523147162, 'auprc': 0.9400715655538845, 'loss_val': 0.37829897930800943, 'psi': 0.7595757651045258}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.678961 cos_to_last_merge=0.9978 (last merge round=42)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.6927344151632365, 'auprc': 0.9003817262576868, 'loss_val': 0.5790546247723883, 'psi': 0.7757933396010166}-{'f1_val': 0.8305120302868407, 'auprc': 0.9624424115806973, 'loss_val': 0.30964773669549434, 'psi': 0.8832841828043834}
[S7] START round=44 head_norm_before_train=1.754719 cos_to_last_merge=0.9999 (last merge round=41)
[S7] round=44 local utility u=0.783546 metrics={'f1_val': 0.699482662226484, 'auprc': 0.9746507464457347, 'loss_val': 0.24129936742082803, 'psi': 0.8095498959141842}-{'f1_val': 0.5922051752298165, 'auprc': 0.795559649573372, 'loss_val': 0.6274523247025912, 'psi': 0.6735469649672388}
[S8] START round=44 head_norm_before_train=2.037370 cos_to_last_merge=0.8133 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=44 local utility u=0.018894 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9991214401046125, 'loss_val': 0.03134886367365823, 'psi': 0.9949866334513235}-{'f1_val': 0.9877803895057649, 'auprc': 0.9988973206872603, 'loss_val': 0.04176676530796124, 'psi': 0.992227161978363}
[S9] START round=44 head_norm_before_train=2.035540 (no previous merge yet)
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9918149940667227, 'auprc': 0.9999223379743373, 'loss_val': 0.02801112154738127, 'psi': 0.9950579316297685}-{'f1_val': 0.9947440946163844, 'auprc': 0.9997923295498139, 'loss_val': 0.022357233987407257, 'psi': 0.9967633885897562}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.874812 cos_to_last_merge=0.9872 (last merge round=35)
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9919876733757319, 'loss_val': 0.03492144855576002, 'psi': 0.9939077727619177}-{'f1_val': 0.9953231205637304, 'auprc': 0.9925135415979223, 'loss_val': 0.03568008006898328, 'psi': 0.9941992889774072}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.152883 (no previous merge yet)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9981175742722647, 'loss_val': 0.024249422651775307, 'psi': 0.9967944119846928}-{'f1_val': 0.996567470639547, 'auprc': 0.9980653080962767, 'loss_val': 0.023179036986863032, 'psi': 0.9971666056222389}
[S13] START round=44 head_norm_before_train=1.825868 cos_to_last_merge=0.9999 (last merge round=41)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.5932486013111327, 'auprc': 0.7754784246709635, 'loss_val': 1.0950411382300504, 'psi': 0.666140530655065}-{'f1_val': 0.6208220478067541, 'auprc': 0.7205106915850429, 'loss_val': 0.7919051974703024, 'psi': 0.6606975053180696}
[S14] START round=44 head_norm_before_train=1.452252 cos_to_last_merge=0.9869 (last merge round=36)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9971861304288072, 'loss_val': 0.053239294953076395, 'psi': 0.9970866258452482}-{'f1_val': 0.997240356705793, 'auprc': 0.9988864156244455, 'loss_val': 0.0573319769040567, 'psi': 0.997898780273254}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=2.245543 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.8175022345362182, 'auprc': 0.9912018619525996, 'loss_val': 0.3495718389888026, 'psi': 0.8869820855027708}-{'f1_val': 0.9942813188098336, 'auprc': 0.9971508111604588, 'loss_val': 0.024054275796709504, 'psi': 0.9954291157500836}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.909495 cos_to_last_merge=0.7687 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9431219751154301, 'auprc': 0.9907183984759783, 'loss_val': 0.2013410970026792, 'psi': 0.9621605444596493}-{'f1_val': 0.9448146608483483, 'auprc': 0.9936609330507822, 'loss_val': 0.1529124250313908, 'psi': 0.9643531697293218}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=2.010029 cos_to_last_merge=0.7850 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.8703008616376711, 'auprc': 0.9858168053993894, 'loss_val': 0.5058095655034699, 'psi': 0.9165072391423583}-{'f1_val': 0.9119837059492232, 'auprc': 0.98758324556405, 'loss_val': 0.43739055580878267, 'psi': 0.9422235217951538}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S2] START round=45 head_norm_before_train=2.084766 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.9042522894311416, 'auprc': 0.9233458502090091, 'loss_val': 0.3274710142200031, 'psi': 0.9118897137422886}-{'f1_val': 0.8969716342248203, 'auprc': 0.9805791084162092, 'loss_val': 0.24543786785685218, 'psi': 0.9304146239013757}
[S3] START round=45 head_norm_before_train=1.641324 cos_to_last_merge=0.9754 (last merge round=41)
[S3] round=45 local utility u=0.420897 metrics={'f1_val': 0.9193755251363875, 'auprc': 0.9941633931260703, 'loss_val': 0.1855441383148611, 'psi': 0.9492906723322607}-{'f1_val': 0.8137973883351302, 'auprc': 0.9945105646600669, 'loss_val': 0.3949113822476751, 'psi': 0.886082658865105}
[S4] START round=45 head_norm_before_train=2.104022 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9540286019521252, 'auprc': 0.9526760966250644, 'loss_val': 0.31020727421644323, 'psi': 0.9534875998213009}-{'f1_val': 0.955461393165338, 'auprc': 0.9625023595384313, 'loss_val': 0.3071971156301521, 'psi': 0.9582777797145753}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.750220 cos_to_last_merge=0.9950 (last merge round=35)
[S5] round=45 local utility u=0.284967 metrics={'f1_val': 0.5833001003091877, 'auprc': 0.8648399718899077, 'loss_val': 0.5627016939609014, 'psi': 0.6959160489414757}-{'f1_val': 0.5272276648610886, 'auprc': 0.8515877387058604, 'loss_val': 0.7564443362914857, 'psi': 0.6569716943989974}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=45 head_norm_before_train=1.736078 cos_to_last_merge=0.9937 (last merge round=42)
[S6] round=45 local utility u=0.378704 metrics={'f1_val': 0.7743147673721362, 'auprc': 0.9446621233146595, 'loss_val': 0.4439702951647646, 'psi': 0.8424537097491456}-{'f1_val': 0.6927344151632365, 'auprc': 0.9003817262576868, 'loss_val': 0.5790546247723883, 'psi': 0.7757933396010166}
[S7] START round=45 head_norm_before_train=1.761678 cos_to_last_merge=0.9999 (last merge round=41)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.5957247142275799, 'auprc': 0.7976599103591787, 'loss_val': 0.6675389211266144, 'psi': 0.6764987926802194}-{'f1_val': 0.699482662226484, 'auprc': 0.9746507464457347, 'loss_val': 0.24129936742082803, 'psi': 0.8095498959141842}
[S8] START round=45 head_norm_before_train=2.041800 cos_to_last_merge=0.8133 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=45 local utility u=0.003961 metrics={'f1_val': 0.993914489706644, 'auprc': 0.9980334529654915, 'loss_val': 0.030269418605445162, 'psi': 0.995562075010183}-{'f1_val': 0.9922300956824643, 'auprc': 0.9991214401046125, 'loss_val': 0.03134886367365823, 'psi': 0.9949866334513235}
[S9] START round=45 head_norm_before_train=2.041868 (no previous merge yet)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9999226391872587, 'loss_val': 0.03334576254449592, 'psi': 0.9943185994911911}-{'f1_val': 0.9918149940667227, 'auprc': 0.9999223379743373, 'loss_val': 0.02801112154738127, 'psi': 0.9950579316297685}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.890682 cos_to_last_merge=0.9860 (last merge round=35)
[S10] round=45 local utility u=0.001015 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921144423961296, 'loss_val': 0.03327152513690392, 'psi': 0.9939584803700767}-{'f1_val': 0.9951878390193748, 'auprc': 0.9919876733757319, 'loss_val': 0.03492144855576002, 'psi': 0.9939077727619177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=45 head_norm_before_train=2.158401 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9963301590174937, 'auprc': 0.9982110841181746, 'loss_val': 0.033675032564213676, 'psi': 0.9970825290577661}-{'f1_val': 0.9959123037929781, 'auprc': 0.9981175742722647, 'loss_val': 0.024249422651775307, 'psi': 0.9967944119846928}
[S13] START round=45 head_norm_before_train=1.829738 cos_to_last_merge=0.9998 (last merge round=41)
[S13] round=45 local utility u=0.026814 metrics={'f1_val': 0.6117885189294863, 'auprc': 0.7300983442244894, 'loss_val': 1.016512886268033, 'psi': 0.6591124490474876}-{'f1_val': 0.5932486013111327, 'auprc': 0.7754784246709635, 'loss_val': 1.0950411382300504, 'psi': 0.666140530655065}
[S14] START round=45 head_norm_before_train=1.471495 cos_to_last_merge=0.9855 (last merge round=36)
[S14] round=45 local utility u=0.002997 metrics={'f1_val': 0.9968006784347707, 'auprc': 0.998814606334006, 'loss_val': 0.05081375941656223, 'psi': 0.9976062495944649}-{'f1_val': 0.9970202894562089, 'auprc': 0.9971861304288072, 'loss_val': 0.053239294953076395, 'psi': 0.9970866258452482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=45 head_norm_before_train=2.255754 (no previous merge yet)
[S15] round=45 local utility u=0.326890 metrics={'f1_val': 0.8966721979339662, 'auprc': 0.9915555473984564, 'loss_val': 0.17187356795613992, 'psi': 0.9346255377197623}-{'f1_val': 0.8175022345362182, 'auprc': 0.9912018619525996, 'loss_val': 0.3495718389888026, 'psi': 0.8869820855027708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=45 head_norm_before_train=1.916379 cos_to_last_merge=0.7682 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=45 local utility u=0.237433 metrics={'f1_val': 0.9923180924730273, 'auprc': 0.9961199451879599, 'loss_val': 0.03785646549712292, 'psi': 0.9938388335590003}-{'f1_val': 0.9431219751154301, 'auprc': 0.9907183984759783, 'loss_val': 0.2013410970026792, 'psi': 0.9621605444596493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=45 head_norm_before_train=2.020511 cos_to_last_merge=0.7841 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.784
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6601442608257195, 'auprc': 0.9393874146558607, 'loss_val': 1.2777040625131186, 'psi': 0.771841522357776}-{'f1_val': 0.8703008616376711, 'auprc': 0.9858168053993894, 'loss_val': 0.5058095655034699, 'psi': 0.9165072391423583}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S8] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=2.090932 (no previous merge yet)
[S2] round=46 local utility u=0.086131 metrics={'f1_val': 0.8881390500222672, 'auprc': 0.9918934470717067, 'loss_val': 0.2641726893534966, 'psi': 0.929640808842043}-{'f1_val': 0.9042522894311416, 'auprc': 0.9233458502090091, 'loss_val': 0.3274710142200031, 'psi': 0.9118897137422886}
[S3] START round=46 head_norm_before_train=1.697407 cos_to_last_merge=0.9675 (last merge round=41)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.89979348258146, 'auprc': 0.9933617254670801, 'loss_val': 0.21135877455900773, 'psi': 0.937220779735708}-{'f1_val': 0.9193755251363875, 'auprc': 0.9941633931260703, 'loss_val': 0.1855441383148611, 'psi': 0.9492906723322607}
[S4] START round=46 head_norm_before_train=2.109965 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9532919131401001, 'auprc': 0.9358522672059862, 'loss_val': 0.3137502644845985, 'psi': 0.9463160547664545}-{'f1_val': 0.9540286019521252, 'auprc': 0.9526760966250644, 'loss_val': 0.31020727421644323, 'psi': 0.9534875998213009}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.764164 cos_to_last_merge=0.9939 (last merge round=35)
[S5] round=46 local utility u=0.510911 metrics={'f1_val': 0.6574263796878024, 'auprc': 0.964103884341921, 'loss_val': 0.28342871622439, 'psi': 0.7800973815494499}-{'f1_val': 0.5833001003091877, 'auprc': 0.8648399718899077, 'loss_val': 0.5627016939609014, 'psi': 0.6959160489414757}
[S5] not sending this round → trigger blocked (psi=0.780)
[S6] START round=46 head_norm_before_train=1.791163 cos_to_last_merge=0.9885 (last merge round=42)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.7452995258009917, 'auprc': 0.9519887791794613, 'loss_val': 0.46415270724600854, 'psi': 0.8279752271523795}-{'f1_val': 0.7743147673721362, 'auprc': 0.9446621233146595, 'loss_val': 0.4439702951647646, 'psi': 0.8424537097491456}
[S7] START round=46 head_norm_before_train=1.766565 cos_to_last_merge=0.9998 (last merge round=41)
[S7] round=46 local utility u=0.490294 metrics={'f1_val': 0.6848314110180536, 'auprc': 0.8422905271910198, 'loss_val': 0.35548271032290574, 'psi': 0.7478150574872401}-{'f1_val': 0.5957247142275799, 'auprc': 0.7976599103591787, 'loss_val': 0.6675389211266144, 'psi': 0.6764987926802194}
[S8] START round=46 head_norm_before_train=2.047936 cos_to_last_merge=0.8127 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.813
[S8] round=46 local utility u=0.000000 metrics={'f1_val': 0.9673917532451277, 'auprc': 0.9990664109897426, 'loss_val': 0.08910410412185027, 'psi': 0.9800616163429736}-{'f1_val': 0.993914489706644, 'auprc': 0.9980334529654915, 'loss_val': 0.030269418605445162, 'psi': 0.995562075010183}
[S9] START round=46 head_norm_before_train=2.049070 (no previous merge yet)
[S9] round=46 local utility u=0.020339 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9986106613683043, 'loss_val': 0.018895777240750825, 'psi': 0.9968101508211836}-{'f1_val': 0.990582573027146, 'auprc': 0.9999226391872587, 'loss_val': 0.03334576254449592, 'psi': 0.9943185994911911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=46 head_norm_before_train=1.905836 cos_to_last_merge=0.9849 (last merge round=35)
[S10] round=46 local utility u=0.001921 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929898070980935, 'loss_val': 0.03205516312529455, 'psi': 0.9943086262508622}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921144423961296, 'loss_val': 0.03327152513690392, 'psi': 0.9939584803700767}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=46 head_norm_before_train=2.164686 (no previous merge yet)
[S11] round=46 local utility u=0.005147 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9982463939214881, 'loss_val': 0.02348283989894939, 'psi': 0.9970962038652095}-{'f1_val': 0.9963301590174937, 'auprc': 0.9982110841181746, 'loss_val': 0.033675032564213676, 'psi': 0.9970825290577661}
[S13] START round=46 head_norm_before_train=1.834705 cos_to_last_merge=0.9998 (last merge round=41)
[S13] round=46 local utility u=0.226074 metrics={'f1_val': 0.6443830926453179, 'auprc': 0.7412523558269217, 'loss_val': 0.7933938853382289, 'psi': 0.6831307979179594}-{'f1_val': 0.6117885189294863, 'auprc': 0.7300983442244894, 'loss_val': 1.016512886268033, 'psi': 0.6591124490474876}
[S14] START round=46 head_norm_before_train=1.487045 cos_to_last_merge=0.9844 (last merge round=36)
[S14] round=46 local utility u=0.001435 metrics={'f1_val': 0.9968032263876003, 'auprc': 0.9988624606973666, 'loss_val': 0.04810266297363865, 'psi': 0.9976269201115069}-{'f1_val': 0.9968006784347707, 'auprc': 0.998814606334006, 'loss_val': 0.05081375941656223, 'psi': 0.9976062495944649}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=46 head_norm_before_train=2.264172 (no previous merge yet)
[S15] round=46 local utility u=0.383871 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9967197958256155, 'loss_val': 0.020071104121532103, 'psi': 0.9967359193627585}-{'f1_val': 0.8966721979339662, 'auprc': 0.9915555473984564, 'loss_val': 0.17187356795613992, 'psi': 0.9346255377197623}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=46 head_norm_before_train=1.924748 cos_to_last_merge=0.7676 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9950496604272849, 'loss_val': 0.03859564715843836, 'psi': 0.9936694190059245}-{'f1_val': 0.9923180924730273, 'auprc': 0.9961199451879599, 'loss_val': 0.03785646549712292, 'psi': 0.9938388335590003}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=2.029661 cos_to_last_merge=0.7835 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.9085265580825859, 'auprc': 0.9883647248149894, 'loss_val': 0.36321594066907814, 'psi': 0.9404618247755472}-{'f1_val': 0.6601442608257195, 'auprc': 0.9393874146558607, 'loss_val': 1.2777040625131186, 'psi': 0.771841522357776}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] not sending this round → trigger blocked (psi=0.683)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6]  timeout peer S7
[S8]  timeout peer S5
[S8]  timeout peer S17
[S3]  timeout peer S14
[S2] START round=47 head_norm_before_train=2.100447 (no previous merge yet)
[S2] round=47 local utility u=0.066459 metrics={'f1_val': 0.9077472150712049, 'auprc': 0.9896746611132381, 'loss_val': 0.24224701011095953, 'psi': 0.9405181934880182}-{'f1_val': 0.8881390500222672, 'auprc': 0.9918934470717067, 'loss_val': 0.2641726893534966, 'psi': 0.929640808842043}
[S3] START round=47 head_norm_before_train=1.741745 cos_to_last_merge=0.9613 (last merge round=41)
[S3] round=47 local utility u=0.080592 metrics={'f1_val': 0.9182169529908031, 'auprc': 0.9977793795988229, 'loss_val': 0.17396867755651255, 'psi': 0.950041923634011}-{'f1_val': 0.89979348258146, 'auprc': 0.9933617254670801, 'loss_val': 0.21135877455900773, 'psi': 0.937220779735708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=47 head_norm_before_train=2.121759 (no previous merge yet)
[S4] round=47 local utility u=0.060808 metrics={'f1_val': 0.9592034177875777, 'auprc': 0.9619057663350187, 'loss_val': 0.3057635336681991, 'psi': 0.960284357206554}-{'f1_val': 0.9532919131401001, 'auprc': 0.9358522672059862, 'loss_val': 0.3137502644845985, 'psi': 0.9463160547664545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.776352 cos_to_last_merge=0.9929 (last merge round=35)
[S5] round=47 local utility u=0.000000 metrics={'f1_val': 0.646199924775724, 'auprc': 0.8862788634220705, 'loss_val': 0.44667140156080093, 'psi': 0.7422315002342625}-{'f1_val': 0.6574263796878024, 'auprc': 0.964103884341921, 'loss_val': 0.28342871622439, 'psi': 0.7800973815494499}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=47 head_norm_before_train=1.828615 cos_to_last_merge=0.9847 (last merge round=42)
[S6] round=47 local utility u=0.000000 metrics={'f1_val': 0.6425178544375421, 'auprc': 0.859075796193734, 'loss_val': 0.806223483621456, 'psi': 0.7291410311400188}-{'f1_val': 0.7452995258009917, 'auprc': 0.9519887791794613, 'loss_val': 0.46415270724600854, 'psi': 0.8279752271523795}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=47 head_norm_before_train=1.769632 cos_to_last_merge=0.9997 (last merge round=41)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5696430098452658, 'auprc': 0.7943549520222051, 'loss_val': 0.7739663149986704, 'psi': 0.6595277867160416}-{'f1_val': 0.6848314110180536, 'auprc': 0.8422905271910198, 'loss_val': 0.35548271032290574, 'psi': 0.7478150574872401}
[S8] START round=47 head_norm_before_train=2.057114 cos_to_last_merge=0.8117 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=47 local utility u=0.105627 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9991134127076229, 'loss_val': 0.03165216370358014, 'psi': 0.9954464397747216}-{'f1_val': 0.9673917532451277, 'auprc': 0.9990664109897426, 'loss_val': 0.08910410412185027, 'psi': 0.9800616163429736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=2.055976 (no previous merge yet)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945343958009807, 'loss_val': 0.018414881291281972, 'psi': 0.996075505827678}-{'f1_val': 0.9956098104564366, 'auprc': 0.9986106613683043, 'loss_val': 0.018895777240750825, 'psi': 0.9968101508211836}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.920841 cos_to_last_merge=0.9838 (last merge round=35)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920488393644427, 'loss_val': 0.03166873476902289, 'psi': 0.9939322391574019}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929898070980935, 'loss_val': 0.03205516312529455, 'psi': 0.9943086262508622}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=47 head_norm_before_train=2.174043 (no previous merge yet)
[S11] round=47 local utility u=0.000357 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980426234407662, 'loss_val': 0.022012770379605934, 'psi': 0.9970001498576231}-{'f1_val': 0.9963294104943571, 'auprc': 0.9982463939214881, 'loss_val': 0.02348283989894939, 'psi': 0.9970962038652095}
[S13] START round=47 head_norm_before_train=1.840652 cos_to_last_merge=0.9997 (last merge round=41)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6077034098354935, 'auprc': 0.666822361448139, 'loss_val': 1.1331732236702843, 'psi': 0.6313509904805517}-{'f1_val': 0.6443830926453179, 'auprc': 0.7412523558269217, 'loss_val': 0.7933938853382289, 'psi': 0.6831307979179594}
[S14] START round=47 head_norm_before_train=1.504205 cos_to_last_merge=0.9830 (last merge round=36)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967774409524363, 'auprc': 0.9964985991148904, 'loss_val': 0.04539880742489589, 'psi': 0.996665904217418}-{'f1_val': 0.9968032263876003, 'auprc': 0.9988624606973666, 'loss_val': 0.04810266297363865, 'psi': 0.9976269201115069}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.272941 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.9223271618178038, 'loss_val': 0.7041576479205379, 'psi': 0.7894823753481222}-{'f1_val': 0.9967466683875206, 'auprc': 0.9967197958256155, 'loss_val': 0.020071104121532103, 'psi': 0.9967359193627585}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.933672 cos_to_last_merge=0.7671 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=47 local utility u=0.000000 metrics={'f1_val': 0.9293766187444344, 'auprc': 0.9950526809637255, 'loss_val': 0.38351848059134863, 'psi': 0.9556470436321509}-{'f1_val': 0.992749258058351, 'auprc': 0.9950496604272849, 'loss_val': 0.03859564715843836, 'psi': 0.9936694190059245}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=47 head_norm_before_train=2.041686 cos_to_last_merge=0.7826 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.783
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.7263152757988013, 'auprc': 0.9360127317369427, 'loss_val': 1.0159778228030818, 'psi': 0.8101942581740578}-{'f1_val': 0.9085265580825859, 'auprc': 0.9883647248149894, 'loss_val': 0.36321594066907814, 'psi': 0.9404618247755472}
[S13]  timeout peer S10
[S11]  timeout peer S2
[S7]  timeout peer S13
[S2]  timeout peer S6
[S17]  timeout peer S8
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → trigger blocked (psi=0.997)
[S2] not sending this round → trigger blocked (psi=0.941)
[S2] START round=48 head_norm_before_train=2.107531 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.8575440701368624, 'auprc': 0.9917505777239247, 'loss_val': 0.28934999034204406, 'psi': 0.9112266731716874}-{'f1_val': 0.9077472150712049, 'auprc': 0.9896746611132381, 'loss_val': 0.24224701011095953, 'psi': 0.9405181934880182}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=1.774867 cos_to_last_merge=0.9568 (last merge round=41)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.830205231314487, 'auprc': 0.9962473133299914, 'loss_val': 0.38453195984722555, 'psi': 0.8966220641206888}-{'f1_val': 0.9182169529908031, 'auprc': 0.9977793795988229, 'loss_val': 0.17396867755651255, 'psi': 0.950041923634011}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.135886 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9531190676309504, 'auprc': 0.9357496507964236, 'loss_val': 0.32316539601938793, 'psi': 0.9461713008971396}-{'f1_val': 0.9592034177875777, 'auprc': 0.9619057663350187, 'loss_val': 0.3057635336681991, 'psi': 0.960284357206554}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.789292 cos_to_last_merge=0.9919 (last merge round=35)
[S5] round=48 local utility u=0.363272 metrics={'f1_val': 0.7004069097142683, 'auprc': 0.9726540072908201, 'loss_val': 0.30449392468012854, 'psi': 0.8093057487448891}-{'f1_val': 0.646199924775724, 'auprc': 0.8862788634220705, 'loss_val': 0.44667140156080093, 'psi': 0.7422315002342625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=48 head_norm_before_train=1.856618 cos_to_last_merge=0.9822 (last merge round=42)
[S6] round=48 local utility u=0.521513 metrics={'f1_val': 0.7224471858471698, 'auprc': 0.9491890819414801, 'loss_val': 0.513113604469185, 'psi': 0.813143944284894}-{'f1_val': 0.6425178544375421, 'auprc': 0.859075796193734, 'loss_val': 0.806223483621456, 'psi': 0.7291410311400188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=48 head_norm_before_train=1.772241 cos_to_last_merge=0.9996 (last merge round=41)
[S7] round=48 local utility u=0.546072 metrics={'f1_val': 0.6747772833973833, 'auprc': 0.8239424755040929, 'loss_val': 0.40139072192123165, 'psi': 0.7344433602400672}-{'f1_val': 0.5696430098452658, 'auprc': 0.7943549520222051, 'loss_val': 0.7739663149986704, 'psi': 0.6595277867160416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=2.063998 cos_to_last_merge=0.8120 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9992438424396034, 'loss_val': 0.03179548087980196, 'psi': 0.9952796313118095}-{'f1_val': 0.9930017911527874, 'auprc': 0.9991134127076229, 'loss_val': 0.03165216370358014, 'psi': 0.9954464397747216}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.059660 (no previous merge yet)
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9947440946163844, 'auprc': 0.999951139291994, 'loss_val': 0.021512602405424644, 'psi': 0.9968269124866282}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945343958009807, 'loss_val': 0.018414881291281972, 'psi': 0.996075505827678}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.935113 cos_to_last_merge=0.9826 (last merge round=35)
[S10] round=48 local utility u=0.001549 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.992786297159296, 'loss_val': 0.03078245360819472, 'psi': 0.9942272222753432}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920488393644427, 'loss_val': 0.03166873476902289, 'psi': 0.9939322391574019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=48 head_norm_before_train=2.185103 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979402580991856, 'loss_val': 0.022401290624954762, 'psi': 0.9969592037209909}-{'f1_val': 0.996305167468861, 'auprc': 0.9980426234407662, 'loss_val': 0.022012770379605934, 'psi': 0.9970001498576231}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.847516 cos_to_last_merge=0.9996 (last merge round=41)
[S13] round=48 local utility u=0.552497 metrics={'f1_val': 0.6766579323674788, 'auprc': 0.7815550991517514, 'loss_val': 0.7861045460452715, 'psi': 0.7186167990811878}-{'f1_val': 0.6077034098354935, 'auprc': 0.666822361448139, 'loss_val': 1.1331732236702843, 'psi': 0.6313509904805517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=1.520169 cos_to_last_merge=0.9819 (last merge round=36)
[S14] round=48 local utility u=0.000179 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9954625616351054, 'loss_val': 0.043389726136138354, 'psi': 0.9963971983277675}-{'f1_val': 0.9967774409524363, 'auprc': 0.9964985991148904, 'loss_val': 0.04539880742489589, 'psi': 0.996665904217418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=48 head_norm_before_train=2.281911 (no previous merge yet)
[S15] round=48 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9984369887945419, 'loss_val': 0.01812442274178879, 'psi': 0.9974227965503291}-{'f1_val': 0.7009191843683342, 'auprc': 0.9223271618178038, 'loss_val': 0.7041576479205379, 'psi': 0.7894823753481222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=48 head_norm_before_train=1.942019 cos_to_last_merge=0.7666 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9258061805596857, 'auprc': 0.9927488854057862, 'loss_val': 0.40134906149474525, 'psi': 0.9525832624981259}-{'f1_val': 0.9293766187444344, 'auprc': 0.9950526809637255, 'loss_val': 0.38351848059134863, 'psi': 0.9556470436321509}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=2.052970 cos_to_last_merge=0.7817 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.782
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.710026372229828, 'auprc': 0.9438466875738245, 'loss_val': 1.0101624046286488, 'psi': 0.8035544983674265}-{'f1_val': 0.7263152757988013, 'auprc': 0.9360127317369427, 'loss_val': 1.0159778228030818, 'psi': 0.8101942581740578}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=49 head_norm_before_train=2.109896 (no previous merge yet)
[S2] round=49 local utility u=0.066508 metrics={'f1_val': 0.8750989133242384, 'auprc': 0.9895572844405554, 'loss_val': 0.2550832542471536, 'psi': 0.9208822617707652}-{'f1_val': 0.8575440701368624, 'auprc': 0.9917505777239247, 'loss_val': 0.28934999034204406, 'psi': 0.9112266731716874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=49 head_norm_before_train=1.801750 cos_to_last_merge=0.9532 (last merge round=41)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.7289101778942492, 'auprc': 0.9917655895143918, 'loss_val': 0.6131916238173485, 'psi': 0.8340523425423062}-{'f1_val': 0.830205231314487, 'auprc': 0.9962473133299914, 'loss_val': 0.38453195984722555, 'psi': 0.8966220641206888}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=2.141876 (no previous merge yet)
[S4] round=49 local utility u=0.031074 metrics={'f1_val': 0.9552776159596332, 'auprc': 0.9506774925443702, 'loss_val': 0.3187522609409578, 'psi': 0.953437566593528}-{'f1_val': 0.9531190676309504, 'auprc': 0.9357496507964236, 'loss_val': 0.32316539601938793, 'psi': 0.9461713008971396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=49 head_norm_before_train=1.800188 cos_to_last_merge=0.9911 (last merge round=35)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.548495301891356, 'auprc': 0.712501738147219, 'loss_val': 0.8574020924321244, 'psi': 0.6140978763937012}-{'f1_val': 0.7004069097142683, 'auprc': 0.9726540072908201, 'loss_val': 0.30449392468012854, 'psi': 0.8093057487448891}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.875438 cos_to_last_merge=0.9803 (last merge round=42)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.6722167292437657, 'auprc': 0.7718511740468157, 'loss_val': 0.834966905716167, 'psi': 0.7120705071649858}-{'f1_val': 0.7224471858471698, 'auprc': 0.9491890819414801, 'loss_val': 0.513113604469185, 'psi': 0.813143944284894}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.774903 cos_to_last_merge=0.9996 (last merge round=41)
[S7] round=49 local utility u=1.000000 metrics={'f1_val': 0.9868044073086877, 'auprc': 0.9966034877800791, 'loss_val': 0.17331079844161487, 'psi': 0.9907240394972443}-{'f1_val': 0.6747772833973833, 'auprc': 0.8239424755040929, 'loss_val': 0.40139072192123165, 'psi': 0.7344433602400672}
[S7] not sending this round → trigger blocked (psi=0.991)
[S8] START round=49 head_norm_before_train=2.061994 cos_to_last_merge=0.8124 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9657949171953855, 'auprc': 0.9993828792358859, 'loss_val': 0.09988400336504849, 'psi': 0.9792301020115857}-{'f1_val': 0.9926368238932805, 'auprc': 0.9992438424396034, 'loss_val': 0.03179548087980196, 'psi': 0.9952796313118095}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.065745 (no previous merge yet)
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9922349858325491, 'auprc': 0.9999526514085552, 'loss_val': 0.025473750759904344, 'psi': 0.9953220520629515}-{'f1_val': 0.9947440946163844, 'auprc': 0.999951139291994, 'loss_val': 0.021512602405424644, 'psi': 0.9968269124866282}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.946699 cos_to_last_merge=0.9817 (last merge round=35)
[S10] round=49 local utility u=0.000836 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931390463381433, 'loss_val': 0.030169220156076454, 'psi': 0.9943683219468822}-{'f1_val': 0.9951878390193748, 'auprc': 0.992786297159296, 'loss_val': 0.03078245360819472, 'psi': 0.9942272222753432}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=49 head_norm_before_train=2.195774 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979275900048589, 'loss_val': 0.02261088472947331, 'psi': 0.9969541364832601}-{'f1_val': 0.996305167468861, 'auprc': 0.9979402580991856, 'loss_val': 0.022401290624954762, 'psi': 0.9969592037209909}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.853309 cos_to_last_merge=0.9995 (last merge round=41)
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6132815242407013, 'auprc': 0.7047224309547162, 'loss_val': 1.0813223645517394, 'psi': 0.6498578869263072}-{'f1_val': 0.6766579323674788, 'auprc': 0.7815550991517514, 'loss_val': 0.7861045460452715, 'psi': 0.7186167990811878}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.532374 cos_to_last_merge=0.9810 (last merge round=36)
[S14] round=49 local utility u=0.001385 metrics={'f1_val': 0.9969706583433163, 'auprc': 0.9964174051296748, 'loss_val': 0.043185596317970185, 'psi': 0.9967493570578597}-{'f1_val': 0.9970202894562089, 'auprc': 0.9954625616351054, 'loss_val': 0.043389726136138354, 'psi': 0.9963971983277675}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=49 head_norm_before_train=2.289658 (no previous merge yet)
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8476649277241463, 'auprc': 0.9916746304284617, 'loss_val': 0.31925641191627724, 'psi': 0.9052688088058725}-{'f1_val': 0.9967466683875206, 'auprc': 0.9984369887945419, 'loss_val': 0.01812442274178879, 'psi': 0.9974227965503291}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.948924 cos_to_last_merge=0.7661 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=49 local utility u=0.381818 metrics={'f1_val': 0.992749258058351, 'auprc': 0.9938735338087756, 'loss_val': 0.04274492024518713, 'psi': 0.9931989683585208}-{'f1_val': 0.9258061805596857, 'auprc': 0.9927488854057862, 'loss_val': 0.40134906149474525, 'psi': 0.9525832624981259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=49 head_norm_before_train=2.061471 cos_to_last_merge=0.7811 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6641180623072958, 'auprc': 0.9463976011307161, 'loss_val': 1.2489918436100418, 'psi': 0.777029877836664}-{'f1_val': 0.710026372229828, 'auprc': 0.9438466875738245, 'loss_val': 1.0101624046286488, 'psi': 0.8035544983674265}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=2.115094 (no previous merge yet)
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.8325795634273434, 'auprc': 0.9925705743137782, 'loss_val': 0.36731710914558263, 'psi': 0.8965759677819173}-{'f1_val': 0.8750989133242384, 'auprc': 0.9895572844405554, 'loss_val': 0.2550832542471536, 'psi': 0.9208822617707652}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=50 head_norm_before_train=1.823732 cos_to_last_merge=0.9504 (last merge round=41)
[S3] round=50 local utility u=0.172338 metrics={'f1_val': 0.775202306795429, 'auprc': 0.991596586211468, 'loss_val': 0.5457615986182618, 'psi': 0.8617600185618446}-{'f1_val': 0.7289101778942492, 'auprc': 0.9917655895143918, 'loss_val': 0.6131916238173485, 'psi': 0.8340523425423062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=50 head_norm_before_train=2.138995 (no previous merge yet)
[S4] round=50 local utility u=0.009701 metrics={'f1_val': 0.9557997847485096, 'auprc': 0.9572811788291287, 'loss_val': 0.3222933646650175, 'psi': 0.9563923423807572}-{'f1_val': 0.9552776159596332, 'auprc': 0.9506774925443702, 'loss_val': 0.3187522609409578, 'psi': 0.953437566593528}
[S4] not sending this round → trigger blocked (psi=0.956)
[S5] START round=50 head_norm_before_train=1.809775 cos_to_last_merge=0.9903 (last merge round=35)
[S5] round=50 local utility u=0.941793 metrics={'f1_val': 0.66690038556163, 'auprc': 0.9373014784446475, 'loss_val': 0.35864636477673767, 'psi': 0.775060822714837}-{'f1_val': 0.548495301891356, 'auprc': 0.712501738147219, 'loss_val': 0.8574020924321244, 'psi': 0.6140978763937012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=50 head_norm_before_train=1.886462 cos_to_last_merge=0.9792 (last merge round=42)
[S6] round=50 local utility u=0.990801 metrics={'f1_val': 0.8546003778165799, 'auprc': 0.940586363350389, 'loss_val': 0.45387161098481865, 'psi': 0.8889947720301036}-{'f1_val': 0.6722167292437657, 'auprc': 0.7718511740468157, 'loss_val': 0.834966905716167, 'psi': 0.7120705071649858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=50 head_norm_before_train=1.779833 cos_to_last_merge=0.9995 (last merge round=41)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.5281577678430107, 'auprc': 0.7802242612030232, 'loss_val': 1.093166933364773, 'psi': 0.6289843651870157}-{'f1_val': 0.9868044073086877, 'auprc': 0.9966034877800791, 'loss_val': 0.17331079844161487, 'psi': 0.9907240394972443}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=2.063807 cos_to_last_merge=0.8118 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.812
[S8] round=50 local utility u=0.097740 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9907723193183393, 'loss_val': 0.0404360425397072, 'psi': 0.9919721777619301}-{'f1_val': 0.9657949171953855, 'auprc': 0.9993828792358859, 'loss_val': 0.09988400336504849, 'psi': 0.9792301020115857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=50 head_norm_before_train=2.073071 (no previous merge yet)
[S9] round=50 local utility u=0.011344 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952553628731929, 'loss_val': 0.017902324093211405, 'psi': 0.9963638926565629}-{'f1_val': 0.9922349858325491, 'auprc': 0.9999526514085552, 'loss_val': 0.025473750759904344, 'psi': 0.9953220520629515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=50 head_norm_before_train=1.958351 cos_to_last_merge=0.9808 (last merge round=35)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9920893813178112, 'loss_val': 0.029977655587014276, 'psi': 0.9939484559387493}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931390463381433, 'loss_val': 0.030169220156076454, 'psi': 0.9943683219468822}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=2.205713 (no previous merge yet)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9927071445656399, 'auprc': 0.9979286886052571, 'loss_val': 0.03629336930449778, 'psi': 0.9947957621814868}-{'f1_val': 0.996305167468861, 'auprc': 0.9979275900048589, 'loss_val': 0.02261088472947331, 'psi': 0.9969541364832601}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.857563 cos_to_last_merge=0.9994 (last merge round=41)
[S13] round=50 local utility u=0.046902 metrics={'f1_val': 0.6059073525712296, 'auprc': 0.7886325843549568, 'loss_val': 1.1950030890389027, 'psi': 0.6789974452847205}-{'f1_val': 0.6132815242407013, 'auprc': 0.7047224309547162, 'loss_val': 1.0813223645517394, 'psi': 0.6498578869263072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=50 head_norm_before_train=1.544678 cos_to_last_merge=0.9800 (last merge round=36)
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9338133181968595, 'auprc': 0.945940030525109, 'loss_val': 0.1632723703094086, 'psi': 0.9386640031281592}-{'f1_val': 0.9969706583433163, 'auprc': 0.9964174051296748, 'loss_val': 0.043185596317970185, 'psi': 0.9967493570578597}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=2.296916 (no previous merge yet)
[S15] round=50 local utility u=0.600903 metrics={'f1_val': 0.9963324108488076, 'auprc': 0.9965871774904494, 'loss_val': 0.024192779975716984, 'psi': 0.9964343175054643}-{'f1_val': 0.8476649277241463, 'auprc': 0.9916746304284617, 'loss_val': 0.31925641191627724, 'psi': 0.9052688088058725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=50 head_norm_before_train=1.955352 cos_to_last_merge=0.7657 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=50 local utility u=0.006011 metrics={'f1_val': 0.9931673086796463, 'auprc': 0.9953293574724308, 'loss_val': 0.037599614293301754, 'psi': 0.9940321281967601}-{'f1_val': 0.992749258058351, 'auprc': 0.9938735338087756, 'loss_val': 0.04274492024518713, 'psi': 0.9931989683585208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=50 head_norm_before_train=2.070631 cos_to_last_merge=0.7804 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=50 local utility u=1.000000 metrics={'f1_val': 0.9085477978869759, 'auprc': 0.9874965277179117, 'loss_val': 0.3851484408537274, 'psi': 0.9401272898193502}-{'f1_val': 0.6641180623072958, 'auprc': 0.9463976011307161, 'loss_val': 1.2489918436100418, 'psi': 0.777029877836664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=51 head_norm_before_train=2.124721 (no previous merge yet)
[S2] round=51 local utility u=0.279284 metrics={'f1_val': 0.9066373687156268, 'auprc': 0.9871338307609879, 'loss_val': 0.23678612864627102, 'psi': 0.9388359535337714}-{'f1_val': 0.8325795634273434, 'auprc': 0.9925705743137782, 'loss_val': 0.36731710914558263, 'psi': 0.8965759677819173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=51 head_norm_before_train=1.843464 cos_to_last_merge=0.9479 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=51 local utility u=0.320966 metrics={'f1_val': 0.8455234790119468, 'auprc': 0.9976144429631604, 'loss_val': 0.34380948380593523, 'psi': 0.9063598645924322}-{'f1_val': 0.775202306795429, 'auprc': 0.991596586211468, 'loss_val': 0.5457615986182618, 'psi': 0.8617600185618446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=51 head_norm_before_train=2.136379 (no previous merge yet)
[S4] round=51 local utility u=0.004600 metrics={'f1_val': 0.9561508279479185, 'auprc': 0.9582718496330648, 'loss_val': 0.31817077076481154, 'psi': 0.9569992366219771}-{'f1_val': 0.9557997847485096, 'auprc': 0.9572811788291287, 'loss_val': 0.3222933646650175, 'psi': 0.9563923423807572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=51 head_norm_before_train=1.818177 cos_to_last_merge=0.9895 (last merge round=35)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.444039697767928, 'auprc': 0.8551852222953773, 'loss_val': 0.9908778029512706, 'psi': 0.6084979075789078}-{'f1_val': 0.66690038556163, 'auprc': 0.9373014784446475, 'loss_val': 0.35864636477673767, 'psi': 0.775060822714837}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.898129 cos_to_last_merge=0.9779 (last merge round=42)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.5840119151049962, 'auprc': 0.6698625245879015, 'loss_val': 1.179142717784265, 'psi': 0.6183521588981583}-{'f1_val': 0.8546003778165799, 'auprc': 0.940586363350389, 'loss_val': 0.45387161098481865, 'psi': 0.8889947720301036}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.783245 cos_to_last_merge=0.9994 (last merge round=41)
[S7] round=51 local utility u=1.000000 metrics={'f1_val': 0.6954565133343467, 'auprc': 0.8659087909113601, 'loss_val': 0.31660404428579375, 'psi': 0.763637424365152}-{'f1_val': 0.5281577678430107, 'auprc': 0.7802242612030232, 'loss_val': 1.093166933364773, 'psi': 0.6289843651870157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=51 head_norm_before_train=2.074040 cos_to_last_merge=0.8110 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9872015787735056, 'auprc': 0.9991299620394004, 'loss_val': 0.040519684773680766, 'psi': 0.9919729320798636}-{'f1_val': 0.9927720833909908, 'auprc': 0.9907723193183393, 'loss_val': 0.0404360425397072, 'psi': 0.9919721777619301}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.080887 (no previous merge yet)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9999507368896479, 'loss_val': 0.03106911858500803, 'psi': 0.9945826974280725}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952553628731929, 'loss_val': 0.017902324093211405, 'psi': 0.9963638926565629}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.970082 cos_to_last_merge=0.9799 (last merge round=35)
[S10] round=51 local utility u=0.001500 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929135409719121, 'loss_val': 0.029450707975894285, 'psi': 0.9942781198003896}-{'f1_val': 0.9951878390193748, 'auprc': 0.9920893813178112, 'loss_val': 0.029977655587014276, 'psi': 0.9939484559387493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=51 head_norm_before_train=2.212252 (no previous merge yet)
[S11] round=51 local utility u=0.018468 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979263290577032, 'loss_val': 0.02238938173935087, 'psi': 0.997098734331235}-{'f1_val': 0.9927071445656399, 'auprc': 0.9979286886052571, 'loss_val': 0.03629336930449778, 'psi': 0.9947957621814868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=51 head_norm_before_train=1.862999 cos_to_last_merge=0.9992 (last merge round=41)
[S13] round=51 local utility u=0.437745 metrics={'f1_val': 0.6997925947626443, 'auprc': 0.7301216804758877, 'loss_val': 0.7072926174912609, 'psi': 0.7119242290479417}-{'f1_val': 0.6059073525712296, 'auprc': 0.7886325843549568, 'loss_val': 1.1950030890389027, 'psi': 0.6789974452847205}
[S13] not sending this round → trigger blocked (psi=0.712)
[S14] START round=51 head_norm_before_train=1.556845 cos_to_last_merge=0.9791 (last merge round=36)
[S14] round=51 local utility u=0.306993 metrics={'f1_val': 0.9919616620044402, 'auprc': 0.997260859892514, 'loss_val': 0.05213864712044915, 'psi': 0.9940813411596698}-{'f1_val': 0.9338133181968595, 'auprc': 0.945940030525109, 'loss_val': 0.1632723703094086, 'psi': 0.9386640031281592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=51 head_norm_before_train=2.302858 (no previous merge yet)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8753855913456337, 'auprc': 0.9949633479177251, 'loss_val': 0.2883756693848449, 'psi': 0.9232166939744701}-{'f1_val': 0.9963324108488076, 'auprc': 0.9965871774904494, 'loss_val': 0.024192779975716984, 'psi': 0.9964343175054643}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.959273 cos_to_last_merge=0.7652 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8724078348627974, 'auprc': 0.985498373016053, 'loss_val': 0.6994943964532454, 'psi': 0.9176440501240997}-{'f1_val': 0.9931673086796463, 'auprc': 0.9953293574724308, 'loss_val': 0.037599614293301754, 'psi': 0.9940321281967601}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=2.079804 cos_to_last_merge=0.7797 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.780
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.7718505005747958, 'auprc': 0.8934683766788751, 'loss_val': 0.9276437586807319, 'psi': 0.8204976510164275}-{'f1_val': 0.9085477978869759, 'auprc': 0.9874965277179117, 'loss_val': 0.3851484408537274, 'psi': 0.9401272898193502}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=2.127541 (no previous merge yet)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.8344000778847991, 'auprc': 0.990098870094709, 'loss_val': 0.31435085231123816, 'psi': 0.8966795947687631}-{'f1_val': 0.9066373687156268, 'auprc': 0.9871338307609879, 'loss_val': 0.23678612864627102, 'psi': 0.9388359535337714}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=1.861437 cos_to_last_merge=0.9458 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.946
[S3] round=52 local utility u=0.000000 metrics={'f1_val': 0.8529548407255664, 'auprc': 0.9784519216694744, 'loss_val': 0.34791555769942195, 'psi': 0.9031536731031296}-{'f1_val': 0.8455234790119468, 'auprc': 0.9976144429631604, 'loss_val': 0.34380948380593523, 'psi': 0.9063598645924322}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=52 head_norm_before_train=2.145981 (no previous merge yet)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9546792053487118, 'auprc': 0.9470536717947196, 'loss_val': 0.3241574311891406, 'psi': 0.9516289919271148}-{'f1_val': 0.9561508279479185, 'auprc': 0.9582718496330648, 'loss_val': 0.31817077076481154, 'psi': 0.9569992366219771}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.826034 cos_to_last_merge=0.9887 (last merge round=35)
[S5] round=52 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8528429052724238, 'loss_val': 1.2826322475590999, 'psi': 0.6031969004121928}-{'f1_val': 0.444039697767928, 'auprc': 0.8551852222953773, 'loss_val': 0.9908778029512706, 'psi': 0.6084979075789078}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=52 head_norm_before_train=1.909688 cos_to_last_merge=0.9769 (last merge round=42)
[S6] round=52 local utility u=1.000000 metrics={'f1_val': 0.9463823911091186, 'auprc': 0.9764531357924251, 'loss_val': 0.1627518346302154, 'psi': 0.9584106889824411}-{'f1_val': 0.5840119151049962, 'auprc': 0.6698625245879015, 'loss_val': 1.179142717784265, 'psi': 0.6183521588981583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=52 head_norm_before_train=1.786396 cos_to_last_merge=0.9994 (last merge round=41)
[S7] round=52 local utility u=0.000000 metrics={'f1_val': 0.5532229600163504, 'auprc': 0.7863698557212515, 'loss_val': 0.9180386560771131, 'psi': 0.6464817182983109}-{'f1_val': 0.6954565133343467, 'auprc': 0.8659087909113601, 'loss_val': 0.31660404428579375, 'psi': 0.763637424365152}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=52 head_norm_before_train=2.081175 cos_to_last_merge=0.8106 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.811
[S8] round=52 local utility u=0.027434 metrics={'f1_val': 0.9942884390087473, 'auprc': 0.999413980057762, 'loss_val': 0.029024294231205994, 'psi': 0.9963386554283533}-{'f1_val': 0.9872015787735056, 'auprc': 0.9991299620394004, 'loss_val': 0.040519684773680766, 'psi': 0.9919729320798636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=52 head_norm_before_train=2.084882 (no previous merge yet)
[S9] round=52 local utility u=0.012623 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9999456150953192, 'loss_val': 0.02223738952228468, 'psi': 0.9962235510319527}-{'f1_val': 0.9910040044536889, 'auprc': 0.9999507368896479, 'loss_val': 0.03106911858500803, 'psi': 0.9945826974280725}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=52 head_norm_before_train=1.979551 cos_to_last_merge=0.9791 (last merge round=35)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927767308408605, 'loss_val': 0.029141395109645772, 'psi': 0.994223395747969}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929135409719121, 'loss_val': 0.029450707975894285, 'psi': 0.9942781198003896}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=52 head_norm_before_train=2.218185 (no previous merge yet)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979337138416526, 'loss_val': 0.022060181110726024, 'psi': 0.9969565860179777}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979263290577032, 'loss_val': 0.02238938173935087, 'psi': 0.997098734331235}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.865782 cos_to_last_merge=0.9990 (last merge round=41)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6690961691791054, 'auprc': 0.7780222684314926, 'loss_val': 0.935328254059678, 'psi': 0.7126666088800603}-{'f1_val': 0.6997925947626443, 'auprc': 0.7301216804758877, 'loss_val': 0.7072926174912609, 'psi': 0.7119242290479417}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.565734 cos_to_last_merge=0.9785 (last merge round=36)
[S14] round=52 local utility u=0.021832 metrics={'f1_val': 0.9969692246717077, 'auprc': 0.9971723455256334, 'loss_val': 0.0382553380604137, 'psi': 0.997050473013278}-{'f1_val': 0.9919616620044402, 'auprc': 0.997260859892514, 'loss_val': 0.05213864712044915, 'psi': 0.9940813411596698}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=52 head_norm_before_train=2.310185 (no previous merge yet)
[S15] round=52 local utility u=0.224855 metrics={'f1_val': 0.9243975981634922, 'auprc': 0.9955671068076349, 'loss_val': 0.13454896698566585, 'psi': 0.9528654016211493}-{'f1_val': 0.8753855913456337, 'auprc': 0.9949633479177251, 'loss_val': 0.2883756693848449, 'psi': 0.9232166939744701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=52 head_norm_before_train=1.962579 cos_to_last_merge=0.7647 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.765
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8478536655555998, 'auprc': 0.9595211317917058, 'loss_val': 0.9919764159223999, 'psi': 0.8925206520500422}-{'f1_val': 0.8724078348627974, 'auprc': 0.985498373016053, 'loss_val': 0.6994943964532454, 'psi': 0.9176440501240997}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=2.088911 cos_to_last_merge=0.7791 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.779
[S17] round=52 local utility u=0.779176 metrics={'f1_val': 0.9058024849163283, 'auprc': 0.9782466028392738, 'loss_val': 0.42733773572134104, 'psi': 0.9347801320855065}-{'f1_val': 0.7718505005747958, 'auprc': 0.8934683766788751, 'loss_val': 0.9276437586807319, 'psi': 0.8204976510164275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] sending update (kind=head size=1791 to 1 peers)
[S2] START round=53 head_norm_before_train=2.130340 (no previous merge yet)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.8317976479404962, 'auprc': 0.9929894660561016, 'loss_val': 0.3919201564995914, 'psi': 0.8962743751867384}-{'f1_val': 0.8344000778847991, 'auprc': 0.990098870094709, 'loss_val': 0.31435085231123816, 'psi': 0.8966795947687631}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=1.877258 cos_to_last_merge=0.9439 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.8124091587097357, 'auprc': 0.9864524646855108, 'loss_val': 0.49218972489322665, 'psi': 0.8820264811000458}-{'f1_val': 0.8529548407255664, 'auprc': 0.9784519216694744, 'loss_val': 0.34791555769942195, 'psi': 0.9031536731031296}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=2.154052 (no previous merge yet)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.953956399810096, 'auprc': 0.9261169323088845, 'loss_val': 0.327887825824005, 'psi': 0.9428206128096113}-{'f1_val': 0.9546792053487118, 'auprc': 0.9470536717947196, 'loss_val': 0.3241574311891406, 'psi': 0.9516289919271148}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.833085 cos_to_last_merge=0.9881 (last merge round=35)
[S5] round=53 local utility u=1.000000 metrics={'f1_val': 0.754233111670715, 'auprc': 0.9600174068808909, 'loss_val': 0.2948257376801346, 'psi': 0.8365468297547853}-{'f1_val': 0.43676623050537206, 'auprc': 0.8528429052724238, 'loss_val': 1.2826322475590999, 'psi': 0.6031969004121928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=53 head_norm_before_train=1.924237 cos_to_last_merge=0.9755 (last merge round=42)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5884507811633224, 'auprc': 0.6702546191096147, 'loss_val': 1.10194670474453, 'psi': 0.6211723163418392}-{'f1_val': 0.9463823911091186, 'auprc': 0.9764531357924251, 'loss_val': 0.1627518346302154, 'psi': 0.9584106889824411}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.789242 cos_to_last_merge=0.9993 (last merge round=41)
[S7] round=53 local utility u=0.302179 metrics={'f1_val': 0.6075594334744129, 'auprc': 0.7952780288224727, 'loss_val': 0.6664248434757678, 'psi': 0.6826468716136368}-{'f1_val': 0.5532229600163504, 'auprc': 0.7863698557212515, 'loss_val': 0.9180386560771131, 'psi': 0.6464817182983109}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=53 head_norm_before_train=2.088443 cos_to_last_merge=0.8099 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9911512697055136, 'auprc': 0.9992426253456449, 'loss_val': 0.03206720522267142, 'psi': 0.9943878119615661}-{'f1_val': 0.9942884390087473, 'auprc': 0.999413980057762, 'loss_val': 0.029024294231205994, 'psi': 0.9963386554283533}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=2.089838 (no previous merge yet)
[S9] round=53 local utility u=0.001076 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9946275060850243, 'loss_val': 0.01917814770579798, 'psi': 0.9956010593015763}-{'f1_val': 0.9937421749897083, 'auprc': 0.9999456150953192, 'loss_val': 0.02223738952228468, 'psi': 0.9962235510319527}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=53 head_norm_before_train=1.989503 cos_to_last_merge=0.9783 (last merge round=35)
[S10] round=53 local utility u=0.000281 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928808147337707, 'loss_val': 0.028891498057142976, 'psi': 0.9942650293051332}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927767308408605, 'loss_val': 0.029141395109645772, 'psi': 0.994223395747969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=53 head_norm_before_train=2.221361 (no previous merge yet)
[S11] round=53 local utility u=0.001168 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9979443188740811, 'loss_val': 0.0212079595184922, 'psi': 0.9971059302577862}-{'f1_val': 0.996305167468861, 'auprc': 0.9979337138416526, 'loss_val': 0.022060181110726024, 'psi': 0.9969565860179777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=53 head_norm_before_train=1.869087 cos_to_last_merge=0.9988 (last merge round=41)
[S13] round=53 local utility u=0.165869 metrics={'f1_val': 0.7098970298372891, 'auprc': 0.7784301401179349, 'loss_val': 0.849619682726328, 'psi': 0.7373102739495474}-{'f1_val': 0.6690961691791054, 'auprc': 0.7780222684314926, 'loss_val': 0.935328254059678, 'psi': 0.7126666088800603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=53 head_norm_before_train=1.574028 cos_to_last_merge=0.9778 (last merge round=36)
[S14] round=53 local utility u=0.000405 metrics={'f1_val': 0.9965603779504312, 'auprc': 0.9989385893696268, 'loss_val': 0.04029017883336598, 'psi': 0.9975116625181094}-{'f1_val': 0.9969692246717077, 'auprc': 0.9971723455256334, 'loss_val': 0.0382553380604137, 'psi': 0.997050473013278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=53 head_norm_before_train=2.318374 (no previous merge yet)
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.8238332816248931, 'auprc': 0.9917162050739428, 'loss_val': 0.3746648351066693, 'psi': 0.8909864510045129}-{'f1_val': 0.9243975981634922, 'auprc': 0.9955671068076349, 'loss_val': 0.13454896698566585, 'psi': 0.9528654016211493}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.967727 cos_to_last_merge=0.7642 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=53 local utility u=0.634195 metrics={'f1_val': 0.9366443997658122, 'auprc': 0.9936458248119028, 'loss_val': 0.3587051642312584, 'psi': 0.9594449697842484}-{'f1_val': 0.8478536655555998, 'auprc': 0.9595211317917058, 'loss_val': 0.9919764159223999, 'psi': 0.8925206520500422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=53 head_norm_before_train=2.096585 cos_to_last_merge=0.7784 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.9022419495568552, 'auprc': 0.9664313939007538, 'loss_val': 0.49479395490349204, 'psi': 0.9279177272944146}-{'f1_val': 0.9058024849163283, 'auprc': 0.9782466028392738, 'loss_val': 0.42733773572134104, 'psi': 0.9347801320855065}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=2.135892 (no previous merge yet)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.6834275352099369, 'auprc': 0.8238648171705321, 'loss_val': 0.8941080578840392, 'psi': 0.739602447994175}-{'f1_val': 0.8317976479404962, 'auprc': 0.9929894660561016, 'loss_val': 0.3919201564995914, 'psi': 0.8962743751867384}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=1.892265 cos_to_last_merge=0.9422 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.942
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.743395551091247, 'auprc': 0.9807209967366985, 'loss_val': 0.6610097537616365, 'psi': 0.8383257293494277}-{'f1_val': 0.8124091587097357, 'auprc': 0.9864524646855108, 'loss_val': 0.49218972489322665, 'psi': 0.8820264811000458}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=2.155791 (no previous merge yet)
[S4] round=54 local utility u=0.057632 metrics={'f1_val': 0.9556961301713993, 'auprc': 0.9586696228524914, 'loss_val': 0.3207207623608424, 'psi': 0.9568855272438361}-{'f1_val': 0.953956399810096, 'auprc': 0.9261169323088845, 'loss_val': 0.327887825824005, 'psi': 0.9428206128096113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=54 head_norm_before_train=1.839529 cos_to_last_merge=0.9877 (last merge round=35)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.6225168224698927, 'auprc': 0.8430440351406614, 'loss_val': 0.5551974849703976, 'psi': 0.7107277075382001}-{'f1_val': 0.754233111670715, 'auprc': 0.9600174068808909, 'loss_val': 0.2948257376801346, 'psi': 0.8365468297547853}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.938112 cos_to_last_merge=0.9740 (last merge round=42)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.8672257711258602, 'auprc': 0.9540353999587823, 'loss_val': 0.3303481718218759, 'psi': 0.9019496226590291}-{'f1_val': 0.5884507811633224, 'auprc': 0.6702546191096147, 'loss_val': 1.10194670474453, 'psi': 0.6211723163418392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=54 head_norm_before_train=1.792220 cos_to_last_merge=0.9992 (last merge round=41)
[S7] round=54 local utility u=0.029931 metrics={'f1_val': 0.6094240505750609, 'auprc': 0.7959620777675936, 'loss_val': 0.6198036076067076, 'psi': 0.684039261452074}-{'f1_val': 0.6075594334744129, 'auprc': 0.7952780288224727, 'loss_val': 0.6664248434757678, 'psi': 0.6826468716136368}
[S7] not sending this round → trigger blocked (psi=0.684)
[S8] START round=54 head_norm_before_train=2.096904 cos_to_last_merge=0.8084 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.808
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9889702328583625, 'auprc': 0.9879237296496689, 'loss_val': 0.05012593474977644, 'psi': 0.9885516315748851}-{'f1_val': 0.9911512697055136, 'auprc': 0.9992426253456449, 'loss_val': 0.03206720522267142, 'psi': 0.9943878119615661}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.096156 (no previous merge yet)
[S9] round=54 local utility u=0.005940 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9972528839152035, 'loss_val': 0.01763700078311368, 'psi': 0.9968974606544163}-{'f1_val': 0.9962500947792776, 'auprc': 0.9946275060850243, 'loss_val': 0.01917814770579798, 'psi': 0.9956010593015763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=54 head_norm_before_train=1.998032 cos_to_last_merge=0.9775 (last merge round=35)
[S10] round=54 local utility u=0.000327 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9930072528512973, 'loss_val': 0.02861583182704084, 'psi': 0.9943156045521437}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928808147337707, 'loss_val': 0.028891498057142976, 'psi': 0.9942650293051332}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=54 head_norm_before_train=2.225408 (no previous merge yet)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9980440497208094, 'loss_val': 0.020976248116956475, 'psi': 0.9970007203696403}-{'f1_val': 0.9965470045135896, 'auprc': 0.9979443188740811, 'loss_val': 0.0212079595184922, 'psi': 0.9971059302577862}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.875471 cos_to_last_merge=0.9986 (last merge round=41)
[S13] round=54 local utility u=0.074727 metrics={'f1_val': 0.7113502462818535, 'auprc': 0.7860167279243468, 'loss_val': 0.7316450793199993, 'psi': 0.7412168389388508}-{'f1_val': 0.7098970298372891, 'auprc': 0.7784301401179349, 'loss_val': 0.849619682726328, 'psi': 0.7373102739495474}
[S13] not sending this round → trigger blocked (psi=0.741)
[S14] START round=54 head_norm_before_train=1.582370 cos_to_last_merge=0.9771 (last merge round=36)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9965375310696338, 'auprc': 0.9963687419751137, 'loss_val': 0.041649846746296085, 'psi': 0.9964700154318258}-{'f1_val': 0.9965603779504312, 'auprc': 0.9989385893696268, 'loss_val': 0.04029017883336598, 'psi': 0.9975116625181094}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.326258 (no previous merge yet)
[S15] round=54 local utility u=0.587684 metrics={'f1_val': 0.9664131296232913, 'auprc': 0.9951549429661986, 'loss_val': 0.06509230136715911, 'psi': 0.9779098549604541}-{'f1_val': 0.8238332816248931, 'auprc': 0.9917162050739428, 'loss_val': 0.3746648351066693, 'psi': 0.8909864510045129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=54 head_norm_before_train=1.971971 cos_to_last_merge=0.7635 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.764
[S16] round=54 local utility u=0.323691 metrics={'f1_val': 0.99139557355251, 'auprc': 0.9952200228719741, 'loss_val': 0.04455232381288489, 'psi': 0.9929253532802955}-{'f1_val': 0.9366443997658122, 'auprc': 0.9936458248119028, 'loss_val': 0.3587051642312584, 'psi': 0.9594449697842484}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=54 head_norm_before_train=2.102154 cos_to_last_merge=0.7781 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.8962370597122552, 'auprc': 0.970820021716349, 'loss_val': 0.5242165698146447, 'psi': 0.9260702445138927}-{'f1_val': 0.9022419495568552, 'auprc': 0.9664313939007538, 'loss_val': 0.49479395490349204, 'psi': 0.9279177272944146}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=2.136477 (no previous merge yet)
[S2] round=55 local utility u=1.000000 metrics={'f1_val': 0.9103936988144605, 'auprc': 0.8385176620506113, 'loss_val': 0.2866448490955746, 'psi': 0.8816432841089208}-{'f1_val': 0.6834275352099369, 'auprc': 0.8238648171705321, 'loss_val': 0.8941080578840392, 'psi': 0.739602447994175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=55 head_norm_before_train=1.905733 cos_to_last_merge=0.9406 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.727823460258414, 'auprc': 0.990684711198243, 'loss_val': 0.7666767771233125, 'psi': 0.8329679606343456}-{'f1_val': 0.743395551091247, 'auprc': 0.9807209967366985, 'loss_val': 0.6610097537616365, 'psi': 0.8383257293494277}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=2.160922 (no previous merge yet)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9548325195619417, 'auprc': 0.9487960548439809, 'loss_val': 0.3274162812584437, 'psi': 0.9524179336747574}-{'f1_val': 0.9556961301713993, 'auprc': 0.9586696228524914, 'loss_val': 0.3207207623608424, 'psi': 0.9568855272438361}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.845768 cos_to_last_merge=0.9873 (last merge round=35)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.5442887998360009, 'auprc': 0.6932298885268587, 'loss_val': 0.9263911179785174, 'psi': 0.603865235312344}-{'f1_val': 0.6225168224698927, 'auprc': 0.8430440351406614, 'loss_val': 0.5551974849703976, 'psi': 0.7107277075382001}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=1.955448 cos_to_last_merge=0.9722 (last merge round=42)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7302968813170144, 'auprc': 0.8717050224310038, 'loss_val': 0.6882897920799729, 'psi': 0.7868601377626101}-{'f1_val': 0.8672257711258602, 'auprc': 0.9540353999587823, 'loss_val': 0.3303481718218759, 'psi': 0.9019496226590291}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.797249 cos_to_last_merge=0.9990 (last merge round=41)
[S7] round=55 local utility u=0.171273 metrics={'f1_val': 0.6389811477841473, 'auprc': 0.8055108656747085, 'loss_val': 0.4832458330114391, 'psi': 0.7055930349403718}-{'f1_val': 0.6094240505750609, 'auprc': 0.7959620777675936, 'loss_val': 0.6198036076067076, 'psi': 0.684039261452074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=55 head_norm_before_train=2.107285 cos_to_last_merge=0.8072 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9306182757363031, 'auprc': 0.9992437357699177, 'loss_val': 0.1751999834103914, 'psi': 0.9580684597497489}-{'f1_val': 0.9889702328583625, 'auprc': 0.9879237296496689, 'loss_val': 0.05012593474977644, 'psi': 0.9885516315748851}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.102751 (no previous merge yet)
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9999503347473129, 'loss_val': 0.030027605161731113, 'psi': 0.9949670172816619}-{'f1_val': 0.9966605118138915, 'auprc': 0.9972528839152035, 'loss_val': 0.01763700078311368, 'psi': 0.9968974606544163}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=2.007695 cos_to_last_merge=0.9767 (last merge round=35)
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924492948626846, 'loss_val': 0.02844235853078056, 'psi': 0.9940924213566986}-{'f1_val': 0.9951878390193748, 'auprc': 0.9930072528512973, 'loss_val': 0.02861583182704084, 'psi': 0.9943156045521437}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=2.231794 (no previous merge yet)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963263815449162, 'auprc': 0.9980528154533141, 'loss_val': 0.022108626372739828, 'psi': 0.9970169551082754}-{'f1_val': 0.996305167468861, 'auprc': 0.9980440497208094, 'loss_val': 0.020976248116956475, 'psi': 0.9970007203696403}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.882059 cos_to_last_merge=0.9984 (last merge round=41)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6863838128120627, 'auprc': 0.8037338229245524, 'loss_val': 1.0826331655127293, 'psi': 0.7333238168570586}-{'f1_val': 0.7113502462818535, 'auprc': 0.7860167279243468, 'loss_val': 0.7316450793199993, 'psi': 0.7412168389388508}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.590948 cos_to_last_merge=0.9765 (last merge round=36)
[S14] round=55 local utility u=0.008885 metrics={'f1_val': 0.9976543488671686, 'auprc': 0.9985272016027978, 'loss_val': 0.03705650754503432, 'psi': 0.9980034899614203}-{'f1_val': 0.9965375310696338, 'auprc': 0.9963687419751137, 'loss_val': 0.041649846746296085, 'psi': 0.9964700154318258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=55 head_norm_before_train=2.334204 (no previous merge yet)
[S15] round=55 local utility u=0.070823 metrics={'f1_val': 0.9853806569964317, 'auprc': 0.9953342471185435, 'loss_val': 0.03778980252942469, 'psi': 0.9893620930452764}-{'f1_val': 0.9664131296232913, 'auprc': 0.9951549429661986, 'loss_val': 0.06509230136715911, 'psi': 0.9779098549604541}
[S15] not sending this round → trigger blocked (psi=0.989)
[S16] START round=55 head_norm_before_train=1.977885 cos_to_last_merge=0.7630 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=55 local utility u=0.004541 metrics={'f1_val': 0.9918327341602389, 'auprc': 0.9953579450223868, 'loss_val': 0.038507981842539944, 'psi': 0.9932428185050981}-{'f1_val': 0.99139557355251, 'auprc': 0.9952200228719741, 'loss_val': 0.04455232381288489, 'psi': 0.9929253532802955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=55 head_norm_before_train=2.112236 cos_to_last_merge=0.7773 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.7622410507401037, 'auprc': 0.973809349405514, 'loss_val': 0.809018834244315, 'psi': 0.8468683702062678}-{'f1_val': 0.8962370597122552, 'auprc': 0.970820021716349, 'loss_val': 0.5242165698146447, 'psi': 0.9260702445138927}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=2.137720 (no previous merge yet)
[S2] round=56 local utility u=0.002504 metrics={'f1_val': 0.8341269933192608, 'auprc': 0.9921454181831962, 'loss_val': 0.28492071619057785, 'psi': 0.897334363264835}-{'f1_val': 0.9103936988144605, 'auprc': 0.8385176620506113, 'loss_val': 0.2866448490955746, 'psi': 0.8816432841089208}
[S2] not sending this round → trigger blocked (psi=0.897)
[S3] START round=56 head_norm_before_train=1.916879 cos_to_last_merge=0.9394 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.939
[S3] round=56 local utility u=0.218082 metrics={'f1_val': 0.775202306795429, 'auprc': 0.9919742874312067, 'loss_val': 0.6186536646641678, 'psi': 0.8619110990497401}-{'f1_val': 0.727823460258414, 'auprc': 0.990684711198243, 'loss_val': 0.7666767771233125, 'psi': 0.8329679606343456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=56 head_norm_before_train=2.171638 (no previous merge yet)
[S4] round=56 local utility u=0.003713 metrics={'f1_val': 0.9543949762473593, 'auprc': 0.9539663229079969, 'loss_val': 0.3328749982612096, 'psi': 0.9542235149116143}-{'f1_val': 0.9548325195619417, 'auprc': 0.9487960548439809, 'loss_val': 0.3274162812584437, 'psi': 0.9524179336747574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=56 head_norm_before_train=1.851866 cos_to_last_merge=0.9869 (last merge round=35)
[S5] round=56 local utility u=1.000000 metrics={'f1_val': 0.7027160883316786, 'auprc': 0.9973888113561188, 'loss_val': 0.13581149677659562, 'psi': 0.8205851775414548}-{'f1_val': 0.5442887998360009, 'auprc': 0.6932298885268587, 'loss_val': 0.9263911179785174, 'psi': 0.603865235312344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=56 head_norm_before_train=1.975797 cos_to_last_merge=0.9704 (last merge round=42)
[S6] round=56 local utility u=0.596955 metrics={'f1_val': 0.8233967165334395, 'auprc': 0.967113683697786, 'loss_val': 0.3392046894459463, 'psi': 0.8808835033991782}-{'f1_val': 0.7302968813170144, 'auprc': 0.8717050224310038, 'loss_val': 0.6882897920799729, 'psi': 0.7868601377626101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=56 head_norm_before_train=1.803992 cos_to_last_merge=0.9989 (last merge round=41)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.6101037368361638, 'auprc': 0.7953793579465889, 'loss_val': 0.747717478499138, 'psi': 0.684213985280334}-{'f1_val': 0.6389811477841473, 'auprc': 0.8055108656747085, 'loss_val': 0.4832458330114391, 'psi': 0.7055930349403718}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=2.116703 cos_to_last_merge=0.8062 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=56 local utility u=0.229768 metrics={'f1_val': 0.9854270777254233, 'auprc': 0.999390105200084, 'loss_val': 0.04495554311978998, 'psi': 0.9910122887152875}-{'f1_val': 0.9306182757363031, 'auprc': 0.9992437357699177, 'loss_val': 0.1751999834103914, 'psi': 0.9580684597497489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=56 head_norm_before_train=2.110016 (no previous merge yet)
[S9] round=56 local utility u=0.011608 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9945731691100403, 'loss_val': 0.01831282472083603, 'psi': 0.9955793245115827}-{'f1_val': 0.9916448056378947, 'auprc': 0.9999503347473129, 'loss_val': 0.030027605161731113, 'psi': 0.9949670172816619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=56 head_norm_before_train=2.017590 cos_to_last_merge=0.9759 (last merge round=35)
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9921571994639754, 'loss_val': 0.0282916411098277, 'psi': 0.993975583197215}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924492948626846, 'loss_val': 0.02844235853078056, 'psi': 0.9940924213566986}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=2.238420 (no previous merge yet)
[S11] round=56 local utility u=0.001267 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9984022979049731, 'loss_val': 0.022092660658070033, 'psi': 0.997303668029264}-{'f1_val': 0.9963263815449162, 'auprc': 0.9980528154533141, 'loss_val': 0.022108626372739828, 'psi': 0.9970169551082754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=56 head_norm_before_train=1.889986 cos_to_last_merge=0.9982 (last merge round=41)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.636680851046898, 'auprc': 0.7932995790635072, 'loss_val': 0.7985790053545601, 'psi': 0.6993283422535417}-{'f1_val': 0.6863838128120627, 'auprc': 0.8037338229245524, 'loss_val': 1.0826331655127293, 'psi': 0.7333238168570586}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=56 head_norm_before_train=1.599290 cos_to_last_merge=0.9758 (last merge round=36)
[S14] round=56 local utility u=0.000513 metrics={'f1_val': 0.9970459473316442, 'auprc': 0.99903612153646, 'loss_val': 0.033906840610962254, 'psi': 0.9978420170135706}-{'f1_val': 0.9976543488671686, 'auprc': 0.9985272016027978, 'loss_val': 0.03705650754503432, 'psi': 0.9980034899614203}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=56 head_norm_before_train=2.341890 (no previous merge yet)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9722698961093575, 'auprc': 0.995233563072056, 'loss_val': 0.05533952935240555, 'psi': 0.9814553628944369}-{'f1_val': 0.9853806569964317, 'auprc': 0.9953342471185435, 'loss_val': 0.03778980252942469, 'psi': 0.9893620930452764}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.984696 cos_to_last_merge=0.7626 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.763
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9460495449976974, 'auprc': 0.9893120898015403, 'loss_val': 0.19544679673325766, 'psi': 0.9633545629192346}-{'f1_val': 0.9918327341602389, 'auprc': 0.9953579450223868, 'loss_val': 0.038507981842539944, 'psi': 0.9932428185050981}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=2.117488 cos_to_last_merge=0.7769 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.777
[S17] round=56 local utility u=0.594904 metrics={'f1_val': 0.9065078355675158, 'auprc': 0.9791162952763763, 'loss_val': 0.5007331374788971, 'psi': 0.93555121945106}-{'f1_val': 0.7622410507401037, 'auprc': 0.973809349405514, 'loss_val': 0.809018834244315, 'psi': 0.8468683702062678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=57 head_norm_before_train=2.142418 (no previous merge yet)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.8334490138281565, 'auprc': 0.991000101007871, 'loss_val': 0.27866523617953665, 'psi': 0.8964694487000422}-{'f1_val': 0.8341269933192608, 'auprc': 0.9921454181831962, 'loss_val': 0.28492071619057785, 'psi': 0.897334363264835}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=1.928128 cos_to_last_merge=0.9382 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.7299858930240133, 'auprc': 0.9857900014956533, 'loss_val': 0.7374464789787574, 'psi': 0.8323075364126693}-{'f1_val': 0.775202306795429, 'auprc': 0.9919742874312067, 'loss_val': 0.6186536646641678, 'psi': 0.8619110990497401}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=2.177437 (no previous merge yet)
[S4] round=57 local utility u=0.018312 metrics={'f1_val': 0.9555534762318338, 'auprc': 0.9633313160453814, 'loss_val': 0.331297072231795, 'psi': 0.9586646121572528}-{'f1_val': 0.9543949762473593, 'auprc': 0.9539663229079969, 'loss_val': 0.3328749982612096, 'psi': 0.9542235149116143}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=57 head_norm_before_train=1.857556 cos_to_last_merge=0.9864 (last merge round=35)
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.6760786238726372, 'loss_val': 0.49180816904386204, 'psi': 0.6906242400094031}-{'f1_val': 0.7027160883316786, 'auprc': 0.9973888113561188, 'loss_val': 0.13581149677659562, 'psi': 0.8205851775414548}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=2.002452 cos_to_last_merge=0.9680 (last merge round=42)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7745518656767355, 'auprc': 0.9024296027450198, 'loss_val': 0.44579577693543887, 'psi': 0.8257029605040492}-{'f1_val': 0.8233967165334395, 'auprc': 0.967113683697786, 'loss_val': 0.3392046894459463, 'psi': 0.8808835033991782}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.810253 cos_to_last_merge=0.9988 (last merge round=41)
[S7] round=57 local utility u=0.216305 metrics={'f1_val': 0.6506901896892618, 'auprc': 0.8051890036704347, 'loss_val': 0.5880556666647738, 'psi': 0.712489715281731}-{'f1_val': 0.6101037368361638, 'auprc': 0.7953793579465889, 'loss_val': 0.747717478499138, 'psi': 0.684213985280334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=57 head_norm_before_train=2.120925 cos_to_last_merge=0.8058 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9762821404636339, 'auprc': 0.9993868064289209, 'loss_val': 0.06016031961822432, 'psi': 0.9855240068497486}-{'f1_val': 0.9854270777254233, 'auprc': 0.999390105200084, 'loss_val': 0.04495554311978998, 'psi': 0.9910122887152875}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.116064 (no previous merge yet)
[S9] round=57 local utility u=0.007155 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.998150611940115, 'loss_val': 0.0173702201114417, 'psi': 0.9972737337547491}-{'f1_val': 0.9962500947792776, 'auprc': 0.9945731691100403, 'loss_val': 0.01831282472083603, 'psi': 0.9955793245115827}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=57 head_norm_before_train=2.025171 cos_to_last_merge=0.9752 (last merge round=35)
[S10] round=57 local utility u=0.001131 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928371257652934, 'loss_val': 0.02806985844140215, 'psi': 0.9942475537177422}-{'f1_val': 0.9951878390193748, 'auprc': 0.9921571994639754, 'loss_val': 0.0282916411098277, 'psi': 0.993975583197215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=57 head_norm_before_train=2.243361 (no previous merge yet)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9953670360569602, 'auprc': 0.9984406031181078, 'loss_val': 0.03223158195532745, 'psi': 0.9965964628814192}-{'f1_val': 0.9965712481121245, 'auprc': 0.9984022979049731, 'loss_val': 0.022092660658070033, 'psi': 0.997303668029264}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.894336 cos_to_last_merge=0.9980 (last merge round=41)
[S13] round=57 local utility u=0.167825 metrics={'f1_val': 0.7191486878227077, 'auprc': 0.8053863803988599, 'loss_val': 0.99399600125748, 'psi': 0.7536437648531686}-{'f1_val': 0.636680851046898, 'auprc': 0.7932995790635072, 'loss_val': 0.7985790053545601, 'psi': 0.6993283422535417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=57 head_norm_before_train=1.607351 cos_to_last_merge=0.9751 (last merge round=36)
[S14] round=57 local utility u=0.001037 metrics={'f1_val': 0.9972135067804855, 'auprc': 0.9991918480935705, 'loss_val': 0.033305598690622995, 'psi': 0.9980048433057196}-{'f1_val': 0.9970459473316442, 'auprc': 0.99903612153646, 'loss_val': 0.033906840610962254, 'psi': 0.9978420170135706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=57 head_norm_before_train=2.349385 (no previous merge yet)
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.9595113032114848, 'auprc': 0.9950738139382216, 'loss_val': 0.0716923583302177, 'psi': 0.9737363075021794}-{'f1_val': 0.9722698961093575, 'auprc': 0.995233563072056, 'loss_val': 0.05533952935240555, 'psi': 0.9814553628944369}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.983181 cos_to_last_merge=0.7618 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.762
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9445568138830875, 'auprc': 0.9889957347255615, 'loss_val': 0.23132619780089253, 'psi': 0.9623323822200771}-{'f1_val': 0.9460495449976974, 'auprc': 0.9893120898015403, 'loss_val': 0.19544679673325766, 'psi': 0.9633545629192346}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=2.127060 cos_to_last_merge=0.7761 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.8921088810654302, 'auprc': 0.9404643838763296, 'loss_val': 0.5594158944267904, 'psi': 0.91145108218979}-{'f1_val': 0.9065078355675158, 'auprc': 0.9791162952763763, 'loss_val': 0.5007331374788971, 'psi': 0.93555121945106}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=2.151990 (no previous merge yet)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7675601159313306, 'auprc': 0.8399616042751368, 'loss_val': 0.5096242785434435, 'psi': 0.796520711268853}-{'f1_val': 0.8334490138281565, 'auprc': 0.991000101007871, 'loss_val': 0.27866523617953665, 'psi': 0.8964694487000422}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=1.939248 cos_to_last_merge=0.9370 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.937
[S3] round=58 local utility u=0.664482 metrics={'f1_val': 0.8737569597006363, 'auprc': 0.9953126464165196, 'loss_val': 0.29967638893074655, 'psi': 0.9223792343869895}-{'f1_val': 0.7299858930240133, 'auprc': 0.9857900014956533, 'loss_val': 0.7374464789787574, 'psi': 0.8323075364126693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=58 head_norm_before_train=2.178636 (no previous merge yet)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9550176414465241, 'auprc': 0.9529686984323158, 'loss_val': 0.33720764776635753, 'psi': 0.9541980642408407}-{'f1_val': 0.9555534762318338, 'auprc': 0.9633313160453814, 'loss_val': 0.331297072231795, 'psi': 0.9586646121572528}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.859681 cos_to_last_merge=0.9861 (last merge round=35)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.44911557726214935, 'auprc': 0.6905002583354762, 'loss_val': 1.0039465343395475, 'psi': 0.54566944969148}-{'f1_val': 0.7003213174339138, 'auprc': 0.6760786238726372, 'loss_val': 0.49180816904386204, 'psi': 0.6906242400094031}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=2.014891 cos_to_last_merge=0.9666 (last merge round=42)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.7559691037901519, 'auprc': 0.8686949185662644, 'loss_val': 0.5811032519797508, 'psi': 0.8010594297005968}-{'f1_val': 0.7745518656767355, 'auprc': 0.9024296027450198, 'loss_val': 0.44579577693543887, 'psi': 0.8257029605040492}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.815117 cos_to_last_merge=0.9987 (last merge round=41)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6041606252137983, 'auprc': 0.7951710158034908, 'loss_val': 0.7594768242728732, 'psi': 0.6805647814496754}-{'f1_val': 0.6506901896892618, 'auprc': 0.8051890036704347, 'loss_val': 0.5880556666647738, 'psi': 0.712489715281731}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=2.122301 cos_to_last_merge=0.8056 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=58 local utility u=0.024291 metrics={'f1_val': 0.9889702328583625, 'auprc': 0.9875706330991386, 'loss_val': 0.052258556592738134, 'psi': 0.988410392954673}-{'f1_val': 0.9762821404636339, 'auprc': 0.9993868064289209, 'loss_val': 0.06016031961822432, 'psi': 0.9855240068497486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=58 head_norm_before_train=2.117070 (no previous merge yet)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9074569343177634, 'auprc': 0.9992052088150246, 'loss_val': 0.14679053924211838, 'psi': 0.9441562441166679}-{'f1_val': 0.9966891482978385, 'auprc': 0.998150611940115, 'loss_val': 0.0173702201114417, 'psi': 0.9972737337547491}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=2.033803 cos_to_last_merge=0.9745 (last merge round=35)
[S10] round=58 local utility u=0.000081 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9928399685728032, 'loss_val': 0.027915642697572296, 'psi': 0.9942486908407462}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928371257652934, 'loss_val': 0.02806985844140215, 'psi': 0.9942475537177422}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=58 head_norm_before_train=2.247190 (no previous merge yet)
[S11] round=58 local utility u=0.007863 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9983733893578065, 'loss_val': 0.022077755267062727, 'psi': 0.9971470020397368}-{'f1_val': 0.9953670360569602, 'auprc': 0.9984406031181078, 'loss_val': 0.03223158195532745, 'psi': 0.9965964628814192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=58 head_norm_before_train=1.902197 cos_to_last_merge=0.9978 (last merge round=41)
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.623815016354939, 'auprc': 0.7951736405427371, 'loss_val': 0.8829713085928977, 'psi': 0.6923584660300582}-{'f1_val': 0.7191486878227077, 'auprc': 0.8053863803988599, 'loss_val': 0.99399600125748, 'psi': 0.7536437648531686}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.614360 cos_to_last_merge=0.9744 (last merge round=36)
[S14] round=58 local utility u=0.001405 metrics={'f1_val': 0.9978938390605482, 'auprc': 0.9987613173678104, 'loss_val': 0.03328698397408412, 'psi': 0.9982408303834531}-{'f1_val': 0.9972135067804855, 'auprc': 0.9991918480935705, 'loss_val': 0.033305598690622995, 'psi': 0.9980048433057196}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=58 head_norm_before_train=2.356529 (no previous merge yet)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9427456625438181, 'auprc': 0.994397758701848, 'loss_val': 0.09201178559356958, 'psi': 0.9634065010070301}-{'f1_val': 0.9595113032114848, 'auprc': 0.9950738139382216, 'loss_val': 0.0716923583302177, 'psi': 0.9737363075021794}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.985624 cos_to_last_merge=0.7612 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=58 local utility u=0.248638 metrics={'f1_val': 0.9918755575684484, 'auprc': 0.9953950486521195, 'loss_val': 0.037161405880983114, 'psi': 0.9932833540019168}-{'f1_val': 0.9445568138830875, 'auprc': 0.9889957347255615, 'loss_val': 0.23132619780089253, 'psi': 0.9623323822200771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=58 head_norm_before_train=2.135986 cos_to_last_merge=0.7755 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.8225486951944736, 'auprc': 0.9371052539312712, 'loss_val': 0.7421405939934824, 'psi': 0.8683713186891926}-{'f1_val': 0.8921088810654302, 'auprc': 0.9404643838763296, 'loss_val': 0.5594158944267904, 'psi': 0.91145108218979}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.153580 (no previous merge yet)
[S2] round=59 local utility u=0.727316 metrics={'f1_val': 0.8979626845564208, 'auprc': 0.9871109086837881, 'loss_val': 0.27885476040507046, 'psi': 0.9336219742073677}-{'f1_val': 0.7675601159313306, 'auprc': 0.8399616042751368, 'loss_val': 0.5096242785434435, 'psi': 0.796520711268853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S2] r=60 psi=0.934 u=0.7273 p_local=0.2431 f1=0.898 auprc=0.987 bytes=43150
[S3] START round=59 head_norm_before_train=1.950497 cos_to_last_merge=0.9358 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.936
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.8682022345629283, 'auprc': 0.9839329276126617, 'loss_val': 0.3315847177867433, 'psi': 0.9144945117828217}-{'f1_val': 0.8737569597006363, 'auprc': 0.9953126464165196, 'loss_val': 0.29967638893074655, 'psi': 0.9223792343869895}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.914 u=0.0000 p_local=0.1514 f1=0.868 auprc=0.984 bytes=46818
[S4] START round=59 head_norm_before_train=2.182830 (no previous merge yet)
[S4] round=59 local utility u=0.030534 metrics={'f1_val': 0.9564951700504154, 'auprc': 0.9665544255987619, 'loss_val': 0.3257624300557246, 'psi': 0.960518872269754}-{'f1_val': 0.9550176414465241, 'auprc': 0.9529686984323158, 'loss_val': 0.33720764776635753, 'psi': 0.9541980642408407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S4] r=60 psi=0.961 u=0.0305 p_local=0.0150 f1=0.956 auprc=0.967 bytes=50368
[S5] START round=59 head_norm_before_train=1.859738 cos_to_last_merge=0.9858 (last merge round=35)
[S5] round=59 local utility u=1.000000 metrics={'f1_val': 0.9959349617039903, 'auprc': 0.9977709745713349, 'loss_val': 0.1435509967342368, 'psi': 0.9966693668509281}-{'f1_val': 0.44911557726214935, 'auprc': 0.6905002583354762, 'loss_val': 1.0039465343395475, 'psi': 0.54566944969148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=60 psi=0.997 u=1.0000 p_local=0.4029 f1=0.996 auprc=0.998 bytes=46786
[S6] START round=59 head_norm_before_train=2.029983 cos_to_last_merge=0.9651 (last merge round=42)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6212235661151057, 'auprc': 0.7236815709476605, 'loss_val': 1.1212575148765858, 'psi': 0.6622067680481276}-{'f1_val': 0.7559691037901519, 'auprc': 0.8686949185662644, 'loss_val': 0.5811032519797508, 'psi': 0.8010594297005968}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.662 u=0.0000 p_local=0.2172 f1=0.621 auprc=0.724 bytes=46802
[S7] START round=59 head_norm_before_train=1.819362 cos_to_last_merge=0.9986 (last merge round=41)
[S7] round=59 local utility u=0.539666 metrics={'f1_val': 0.6827827631039893, 'auprc': 0.8489491675664076, 'loss_val': 0.313211763763715, 'psi': 0.7492493248889567}-{'f1_val': 0.6041606252137983, 'auprc': 0.7951710158034908, 'loss_val': 0.7594768242728732, 'psi': 0.6805647814496754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S7] r=60 psi=0.749 u=0.5397 p_local=0.2494 f1=0.683 auprc=0.849 bytes=46798
[S8] START round=59 head_norm_before_train=2.131247 cos_to_last_merge=0.8049 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.805
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9713694787942908, 'auprc': 0.9994402983454826, 'loss_val': 0.08033751552604734, 'psi': 0.9825978066147676}-{'f1_val': 0.9889702328583625, 'auprc': 0.9875706330991386, 'loss_val': 0.052258556592738134, 'psi': 0.988410392954673}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=60 psi=0.983 u=0.0000 p_local=0.0349 f1=0.971 auprc=0.999 bytes=46778
[S9] START round=59 head_norm_before_train=2.118750 (no previous merge yet)
[S9] round=59 local utility u=0.333767 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993763300192959, 'loss_val': 0.017645946627740914, 'psi': 0.998012279515004}-{'f1_val': 0.9074569343177634, 'auprc': 0.9992052088150246, 'loss_val': 0.14679053924211838, 'psi': 0.9441562441166679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=60 psi=0.998 u=0.3338 p_local=0.0705 f1=0.997 auprc=0.999 bytes=46794
[S10] START round=59 head_norm_before_train=2.041055 cos_to_last_merge=0.9739 (last merge round=35)
[S10] round=59 local utility u=0.000616 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931945147759901, 'loss_val': 0.027747116144928793, 'psi': 0.9943905093220209}-{'f1_val': 0.9951878390193748, 'auprc': 0.9928399685728032, 'loss_val': 0.027915642697572296, 'psi': 0.9942486908407462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=60 psi=0.994 u=0.0006 p_local=0.0005 f1=0.995 auprc=0.993 bytes=50384
[S11] START round=59 head_norm_before_train=2.252689 (no previous merge yet)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9982023901076887, 'loss_val': 0.020788207280880745, 'psi': 0.9968283383188623}-{'f1_val': 0.9963294104943571, 'auprc': 0.9983733893578065, 'loss_val': 0.022077755267062727, 'psi': 0.9971470020397368}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0031 f1=0.996 auprc=0.998 bytes=41381
[S13] START round=59 head_norm_before_train=1.910976 cos_to_last_merge=0.9975 (last merge round=41)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6024648197897228, 'auprc': 0.7969427295548044, 'loss_val': 1.2386925816961023, 'psi': 0.6802559836957554}-{'f1_val': 0.623815016354939, 'auprc': 0.7951736405427371, 'loss_val': 0.8829713085928977, 'psi': 0.6923584660300582}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.680 u=0.0000 p_local=0.0665 f1=0.602 auprc=0.797 bytes=48614
[S14] START round=59 head_norm_before_train=1.622086 cos_to_last_merge=0.9738 (last merge round=36)
[S14] round=59 local utility u=0.000853 metrics={'f1_val': 0.9976763577590866, 'auprc': 0.9988636140372551, 'loss_val': 0.0305833305564512, 'psi': 0.998151260270354}-{'f1_val': 0.9978938390605482, 'auprc': 0.9987613173678104, 'loss_val': 0.03328698397408412, 'psi': 0.9982408303834531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S14] r=60 psi=0.998 u=0.0009 p_local=0.0129 f1=0.998 auprc=0.999 bytes=55838
[S15] START round=59 head_norm_before_train=2.363605 (no previous merge yet)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9362587169017521, 'auprc': 0.9935154783893725, 'loss_val': 0.1033844258762703, 'psi': 0.9591614214968003}-{'f1_val': 0.9427456625438181, 'auprc': 0.994397758701848, 'loss_val': 0.09201178559356958, 'psi': 0.9634065010070301}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.959 u=0.0000 p_local=0.1013 f1=0.936 auprc=0.994 bytes=43141
[S16] START round=59 head_norm_before_train=1.991102 cos_to_last_merge=0.7608 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.761
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9918755575684484, 'auprc': 0.9957399646058205, 'loss_val': 0.03842986875441425, 'psi': 0.9934213203833973}-{'f1_val': 0.9918755575684484, 'auprc': 0.9953950486521195, 'loss_val': 0.037161405880983114, 'psi': 0.9932833540019168}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.993 u=0.0000 p_local=0.1135 f1=0.992 auprc=0.996 bytes=43097
[S17] START round=59 head_norm_before_train=2.140564 cos_to_last_merge=0.7751 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.775
[S17] round=59 local utility u=0.406493 metrics={'f1_val': 0.9045007464342634, 'auprc': 0.9706420930944584, 'loss_val': 0.521478016773857, 'psi': 0.9309572850983414}-{'f1_val': 0.8225486951944736, 'auprc': 0.9371052539312712, 'loss_val': 0.7421405939934824, 'psi': 0.8683713186891926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S17] r=60 psi=0.931 u=0.4065 p_local=0.2226 f1=0.905 auprc=0.971 bytes=46748
[S2] START round=60 head_norm_before_train=2.156662 (no previous merge yet)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.8302473941910965, 'auprc': 0.9933497478331316, 'loss_val': 0.372971094021372, 'psi': 0.8954883356479105}-{'f1_val': 0.8979626845564208, 'auprc': 0.9871109086837881, 'loss_val': 0.27885476040507046, 'psi': 0.9336219742073677}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=60 head_norm_before_train=1.960961 cos_to_last_merge=0.9346 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=60 local utility u=0.062509 metrics={'f1_val': 0.8875614623592208, 'auprc': 0.978511260252745, 'loss_val': 0.30645700873594905, 'psi': 0.9239413815166305}-{'f1_val': 0.8682022345629283, 'auprc': 0.9839329276126617, 'loss_val': 0.3315847177867433, 'psi': 0.9144945117828217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] sending update (kind=head size=1809 to 1 peers)
[S4] START round=60 head_norm_before_train=2.193320 (no previous merge yet)
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9544876131692768, 'auprc': 0.9285658967770908, 'loss_val': 0.3409471850371997, 'psi': 0.9441189266124024}-{'f1_val': 0.9564951700504154, 'auprc': 0.9665544255987619, 'loss_val': 0.3257624300557246, 'psi': 0.960518872269754}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.860433 cos_to_last_merge=0.9856 (last merge round=35)
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.6869716442389541, 'auprc': 0.6648093797748363, 'loss_val': 0.511708967656584, 'psi': 0.678106738453307}-{'f1_val': 0.9959349617039903, 'auprc': 0.9977709745713349, 'loss_val': 0.1435509967342368, 'psi': 0.9966693668509281}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=2.051985 cos_to_last_merge=0.9632 (last merge round=42)
[S6] round=60 local utility u=1.000000 metrics={'f1_val': 0.815396572935421, 'auprc': 0.9562458369806086, 'loss_val': 0.547791036510864, 'psi': 0.8717362785534961}-{'f1_val': 0.6212235661151057, 'auprc': 0.7236815709476605, 'loss_val': 1.1212575148765858, 'psi': 0.6622067680481276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=60 head_norm_before_train=1.823809 cos_to_last_merge=0.9985 (last merge round=41)
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.5874535630599411, 'auprc': 0.7943392912436615, 'loss_val': 0.7995195954394034, 'psi': 0.6702078543334293}-{'f1_val': 0.6827827631039893, 'auprc': 0.8489491675664076, 'loss_val': 0.313211763763715, 'psi': 0.7492493248889567}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=2.137900 cos_to_last_merge=0.8044 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.804
[S8] round=60 local utility u=0.078331 metrics={'f1_val': 0.9900677324786353, 'auprc': 0.999413877537841, 'loss_val': 0.035785411767883975, 'psi': 0.9938061905023177}-{'f1_val': 0.9713694787942908, 'auprc': 0.9994402983454826, 'loss_val': 0.08033751552604734, 'psi': 0.9825978066147676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=60 head_norm_before_train=2.120630 (no previous merge yet)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9945975481731697, 'loss_val': 0.017600965875586946, 'psi': 0.9958545140281252}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993763300192959, 'loss_val': 0.017645946627740914, 'psi': 0.998012279515004}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.048834 cos_to_last_merge=0.9732 (last merge round=35)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929433190710385, 'loss_val': 0.02764970827374233, 'psi': 0.9942900310400402}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931945147759901, 'loss_val': 0.027747116144928793, 'psi': 0.9943905093220209}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=2.259764 (no previous merge yet)
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.9953670360569602, 'auprc': 0.9985487862971483, 'loss_val': 0.02617788329297791, 'psi': 0.9966397361530355}-{'f1_val': 0.9959123037929781, 'auprc': 0.9982023901076887, 'loss_val': 0.020788207280880745, 'psi': 0.9968283383188623}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=1.915803 cos_to_last_merge=0.9974 (last merge round=41)
[S13] round=60 local utility u=0.557447 metrics={'f1_val': 0.7113172415420499, 'auprc': 0.8016807926133025, 'loss_val': 0.7911273365055137, 'psi': 0.7474626619705509}-{'f1_val': 0.6024648197897228, 'auprc': 0.7969427295548044, 'loss_val': 1.2386925816961023, 'psi': 0.6802559836957554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=60 head_norm_before_train=1.632589 cos_to_last_merge=0.9730 (last merge round=36)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.997266076999405, 'auprc': 0.9987729820040301, 'loss_val': 0.029972658586034876, 'psi': 0.9978688390012551}-{'f1_val': 0.9976763577590866, 'auprc': 0.9988636140372551, 'loss_val': 0.0305833305564512, 'psi': 0.998151260270354}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.370432 (no previous merge yet)
[S15] round=60 local utility u=0.127318 metrics={'f1_val': 0.9704797095968619, 'auprc': 0.9952049576019932, 'loss_val': 0.05914222225380959, 'psi': 0.9803698087989144}-{'f1_val': 0.9362587169017521, 'auprc': 0.9935154783893725, 'loss_val': 0.1033844258762703, 'psi': 0.9591614214968003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=60 head_norm_before_train=1.997455 cos_to_last_merge=0.7604 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.8687424661590255, 'auprc': 0.9895682515193739, 'loss_val': 0.7973260584111999, 'psi': 0.9170727803031649}-{'f1_val': 0.9918755575684484, 'auprc': 0.9957399646058205, 'loss_val': 0.03842986875441425, 'psi': 0.9934213203833973}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=2.150228 cos_to_last_merge=0.7744 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.8986581476503007, 'auprc': 0.9557465919582793, 'loss_val': 0.5788418450279236, 'psi': 0.9214935253734922}-{'f1_val': 0.9045007464342634, 'auprc': 0.9706420930944584, 'loss_val': 0.521478016773857, 'psi': 0.9309572850983414}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=61 head_norm_before_train=2.156305 (no previous merge yet)
[S2] round=61 local utility u=0.315636 metrics={'f1_val': 0.9123609947295204, 'auprc': 0.9863379867213061, 'loss_val': 0.21334510252382555, 'psi': 0.9419517915262346}-{'f1_val': 0.8302473941910965, 'auprc': 0.9933497478331316, 'loss_val': 0.372971094021372, 'psi': 0.8954883356479105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=61 head_norm_before_train=1.971617 cos_to_last_merge=0.9334 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=61 local utility u=0.275732 metrics={'f1_val': 0.9481296520552989, 'auprc': 0.990271641902425, 'loss_val': 0.15368395187165174, 'psi': 0.9649864479941492}-{'f1_val': 0.8875614623592208, 'auprc': 0.978511260252745, 'loss_val': 0.30645700873594905, 'psi': 0.9239413815166305}
[S3] not sending this round → trigger blocked (psi=0.965)
[S4] START round=61 head_norm_before_train=2.209112 (no previous merge yet)
[S4] round=61 local utility u=0.025300 metrics={'f1_val': 0.955270362865586, 'auprc': 0.9423098237391173, 'loss_val': 0.3362763763294324, 'psi': 0.9500861472149986}-{'f1_val': 0.9544876131692768, 'auprc': 0.9285658967770908, 'loss_val': 0.3409471850371997, 'psi': 0.9441189266124024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=61 head_norm_before_train=1.862471 cos_to_last_merge=0.9851 (last merge round=35)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.5429812610180851, 'auprc': 0.6781663721011093, 'loss_val': 0.8383082003476364, 'psi': 0.5970553054512948}-{'f1_val': 0.6869716442389541, 'auprc': 0.6648093797748363, 'loss_val': 0.511708967656584, 'psi': 0.678106738453307}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=2.069485 cos_to_last_merge=0.9617 (last merge round=42)
[S6] round=61 local utility u=0.150625 metrics={'f1_val': 0.8222246668602793, 'auprc': 0.9560689140346051, 'loss_val': 0.28697841945443564, 'psi': 0.8757623657300095}-{'f1_val': 0.815396572935421, 'auprc': 0.9562458369806086, 'loss_val': 0.547791036510864, 'psi': 0.8717362785534961}
[S6] not sending this round → trigger blocked (psi=0.876)
[S7] START round=61 head_norm_before_train=1.827710 cos_to_last_merge=0.9984 (last merge round=41)
[S7] round=61 local utility u=0.518901 metrics={'f1_val': 0.6723478420080446, 'auprc': 0.8275165779674335, 'loss_val': 0.37061450904711635, 'psi': 0.7344153363918002}-{'f1_val': 0.5874535630599411, 'auprc': 0.7943392912436615, 'loss_val': 0.7995195954394034, 'psi': 0.6702078543334293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=61 head_norm_before_train=2.147212 cos_to_last_merge=0.8034 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=61 local utility u=0.010603 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9992931010864854, 'loss_val': 0.029631589964672467, 'psi': 0.9952993347705623}-{'f1_val': 0.9900677324786353, 'auprc': 0.999413877537841, 'loss_val': 0.035785411767883975, 'psi': 0.9938061905023177}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=61 head_norm_before_train=2.125218 (no previous merge yet)
[S9] round=61 local utility u=0.005332 metrics={'f1_val': 0.9959957888192151, 'auprc': 0.9996226994422993, 'loss_val': 0.017831935663192605, 'psi': 0.9974465530684488}-{'f1_val': 0.9966924912647621, 'auprc': 0.9945975481731697, 'loss_val': 0.017600965875586946, 'psi': 0.9958545140281252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=61 head_norm_before_train=2.057153 cos_to_last_merge=0.9725 (last merge round=35)
[S10] round=61 local utility u=0.000420 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931765005332087, 'loss_val': 0.027509830269057237, 'psi': 0.9943833036249083}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929433190710385, 'loss_val': 0.02764970827374233, 'psi': 0.9942900310400402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=61 head_norm_before_train=2.262214 (no previous merge yet)
[S11] round=61 local utility u=0.005810 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9986306427575762, 'loss_val': 0.022027854300457148, 'psi': 0.9973950059703052}-{'f1_val': 0.9953670360569602, 'auprc': 0.9985487862971483, 'loss_val': 0.02617788329297791, 'psi': 0.9966397361530355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=61 head_norm_before_train=1.917829 cos_to_last_merge=0.9973 (last merge round=41)
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6257222103440601, 'auprc': 0.7952414162760362, 'loss_val': 1.0747365741283619, 'psi': 0.6935298927168505}-{'f1_val': 0.7113172415420499, 'auprc': 0.8016807926133025, 'loss_val': 0.7911273365055137, 'psi': 0.7474626619705509}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.644388 cos_to_last_merge=0.9721 (last merge round=36)
[S14] round=61 local utility u=0.000013 metrics={'f1_val': 0.9974862827730671, 'auprc': 0.9979466036158802, 'loss_val': 0.028788595483718305, 'psi': 0.9976704111101923}-{'f1_val': 0.997266076999405, 'auprc': 0.9987729820040301, 'loss_val': 0.029972658586034876, 'psi': 0.9978688390012551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=61 head_norm_before_train=2.377009 (no previous merge yet)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9950874196915567, 'loss_val': 0.06352136513542836, 'psi': 0.9789712870842879}-{'f1_val': 0.9704797095968619, 'auprc': 0.9952049576019932, 'loss_val': 0.05914222225380959, 'psi': 0.9803698087989144}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=2.001631 cos_to_last_merge=0.7599 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.760
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8548163804705523, 'auprc': 0.9896420070904499, 'loss_val': 0.9563932609993618, 'psi': 0.9087466311185113}-{'f1_val': 0.8687424661590255, 'auprc': 0.9895682515193739, 'loss_val': 0.7973260584111999, 'psi': 0.9170727803031649}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=2.159963 cos_to_last_merge=0.7737 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=61 local utility u=0.039748 metrics={'f1_val': 0.9052407041133788, 'auprc': 0.9590198510189405, 'loss_val': 0.5486607795840445, 'psi': 0.9267523628756034}-{'f1_val': 0.8986581476503007, 'auprc': 0.9557465919582793, 'loss_val': 0.5788418450279236, 'psi': 0.9214935253734922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=62 head_norm_before_train=2.161551 (no previous merge yet)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.8318284306761158, 'auprc': 0.9922779110755306, 'loss_val': 0.33779226542739466, 'psi': 0.8960082228358817}-{'f1_val': 0.9123609947295204, 'auprc': 0.9863379867213061, 'loss_val': 0.21334510252382555, 'psi': 0.9419517915262346}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=1.981555 cos_to_last_merge=0.9323 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=62 local utility u=0.073699 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9988177813944, 'loss_val': 0.10806852817816975, 'psi': 0.9760193044192407}-{'f1_val': 0.9481296520552989, 'auprc': 0.990271641902425, 'loss_val': 0.15368395187165174, 'psi': 0.9649864479941492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=62 head_norm_before_train=2.213044 (no previous merge yet)
[S4] round=62 local utility u=0.041271 metrics={'f1_val': 0.957003162457992, 'auprc': 0.9646867360779496, 'loss_val': 0.3312619772256467, 'psi': 0.960076591905975}-{'f1_val': 0.955270362865586, 'auprc': 0.9423098237391173, 'loss_val': 0.3362763763294324, 'psi': 0.9500861472149986}
[S4] not sending this round → trigger blocked (psi=0.960)
[S5] START round=62 head_norm_before_train=1.863915 cos_to_last_merge=0.9846 (last merge round=35)
[S5] round=62 local utility u=0.974045 metrics={'f1_val': 0.7003611031385764, 'auprc': 0.8610839818211353, 'loss_val': 0.3832504321742855, 'psi': 0.7646502546116}-{'f1_val': 0.5429812610180851, 'auprc': 0.6781663721011093, 'loss_val': 0.8383082003476364, 'psi': 0.5970553054512948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=62 head_norm_before_train=2.083448 cos_to_last_merge=0.9603 (last merge round=42)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.7111528114678124, 'auprc': 0.8613258971417189, 'loss_val': 0.8678092724977897, 'psi': 0.7712220457373751}-{'f1_val': 0.8222246668602793, 'auprc': 0.9560689140346051, 'loss_val': 0.28697841945443564, 'psi': 0.8757623657300095}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.831064 cos_to_last_merge=0.9983 (last merge round=41)
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.5733136452077758, 'auprc': 0.784563734302428, 'loss_val': 0.8886291463407502, 'psi': 0.6578136808456367}-{'f1_val': 0.6723478420080446, 'auprc': 0.8275165779674335, 'loss_val': 0.37061450904711635, 'psi': 0.7344153363918002}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=2.153992 cos_to_last_merge=0.8027 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9791693793459708, 'auprc': 0.9991855003093313, 'loss_val': 0.06313211304040296, 'psi': 0.9871758277313151}-{'f1_val': 0.9926368238932805, 'auprc': 0.9992931010864854, 'loss_val': 0.029631589964672467, 'psi': 0.9952993347705623}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=2.128484 (no previous merge yet)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9999351208756089, 'loss_val': 0.02405678345190914, 'psi': 0.9960691576560661}-{'f1_val': 0.9959957888192151, 'auprc': 0.9996226994422993, 'loss_val': 0.017831935663192605, 'psi': 0.9974465530684488}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.064582 cos_to_last_merge=0.9719 (last merge round=35)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9924342465676084, 'loss_val': 0.02751580298934491, 'psi': 0.9940864020386682}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931765005332087, 'loss_val': 0.027509830269057237, 'psi': 0.9943833036249083}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.266779 (no previous merge yet)
[S11] round=62 local utility u=0.000481 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9986102737506686, 'loss_val': 0.021005133987734993, 'psi': 0.9973868583675422}-{'f1_val': 0.9965712481121245, 'auprc': 0.9986306427575762, 'loss_val': 0.022027854300457148, 'psi': 0.9973950059703052}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=62 head_norm_before_train=1.922761 cos_to_last_merge=0.9971 (last merge round=41)
[S13] round=62 local utility u=0.221376 metrics={'f1_val': 0.6759293840621167, 'auprc': 0.7951932386213554, 'loss_val': 0.9330838404903026, 'psi': 0.7236349258858121}-{'f1_val': 0.6257222103440601, 'auprc': 0.7952414162760362, 'loss_val': 1.0747365741283619, 'psi': 0.6935298927168505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=62 head_norm_before_train=1.654212 cos_to_last_merge=0.9712 (last merge round=36)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9966821260910521, 'loss_val': 0.028669632729859545, 'psi': 0.9972651561259944}-{'f1_val': 0.9974862827730671, 'auprc': 0.9979466036158802, 'loss_val': 0.028788595483718305, 'psi': 0.9976704111101923}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=2.383500 (no previous merge yet)
[S15] round=62 local utility u=0.019757 metrics={'f1_val': 0.9731611146872898, 'auprc': 0.9948555015038605, 'loss_val': 0.052915249380605364, 'psi': 0.9818388694139182}-{'f1_val': 0.9682271986794423, 'auprc': 0.9950874196915567, 'loss_val': 0.06352136513542836, 'psi': 0.9789712870842879}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=62 head_norm_before_train=2.001691 cos_to_last_merge=0.7592 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.759
[S16] round=62 local utility u=0.825742 metrics={'f1_val': 0.9818673929228411, 'auprc': 0.9902733593289664, 'loss_val': 0.06911015440350222, 'psi': 0.9852297794852912}-{'f1_val': 0.8548163804705523, 'auprc': 0.9896420070904499, 'loss_val': 0.9563932609993618, 'psi': 0.9087466311185113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=62 head_norm_before_train=2.166120 cos_to_last_merge=0.7732 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.8967430545419792, 'auprc': 0.9445393190285398, 'loss_val': 0.5522196832096753, 'psi': 0.9158615603366034}-{'f1_val': 0.9052407041133788, 'auprc': 0.9590198510189405, 'loss_val': 0.5486607795840445, 'psi': 0.9267523628756034}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=2.173182 (no previous merge yet)
[S2] round=63 local utility u=0.213472 metrics={'f1_val': 0.8863295257134772, 'auprc': 0.9896648024396214, 'loss_val': 0.23001563777676398, 'psi': 0.9276636364039349}-{'f1_val': 0.8318284306761158, 'auprc': 0.9922779110755306, 'loss_val': 0.33779226542739466, 'psi': 0.8960082228358817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=63 head_norm_before_train=1.990521 cos_to_last_merge=0.9313 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.931
[S3] round=63 local utility u=0.095438 metrics={'f1_val': 0.981981085476121, 'auprc': 0.9984527845752378, 'loss_val': 0.04306187440811358, 'psi': 0.9885697651157677}-{'f1_val': 0.9608203197691346, 'auprc': 0.9988177813944, 'loss_val': 0.10806852817816975, 'psi': 0.9760193044192407}
[S3] not sending this round → trigger blocked (psi=0.989)
[S4] START round=63 head_norm_before_train=2.208461 (no previous merge yet)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.954722344121155, 'auprc': 0.9390183745240576, 'loss_val': 0.343986211088634, 'psi': 0.948440756282316}-{'f1_val': 0.957003162457992, 'auprc': 0.9646867360779496, 'loss_val': 0.3312619772256467, 'psi': 0.960076591905975}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.862143 cos_to_last_merge=0.9841 (last merge round=35)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.43660442196719185, 'auprc': 0.8511265500872834, 'loss_val': 1.2932958880866545, 'psi': 0.6024132732152285}-{'f1_val': 0.7003611031385764, 'auprc': 0.8610839818211353, 'loss_val': 0.3832504321742855, 'psi': 0.7646502546116}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=2.096703 cos_to_last_merge=0.9591 (last merge round=42)
[S6] round=63 local utility u=0.578752 metrics={'f1_val': 0.8044753515483356, 'auprc': 0.9243307421846767, 'loss_val': 0.459254746451826, 'psi': 0.8524175078028721}-{'f1_val': 0.7111528114678124, 'auprc': 0.8613258971417189, 'loss_val': 0.8678092724977897, 'psi': 0.7712220457373751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=63 head_norm_before_train=1.835996 cos_to_last_merge=0.9981 (last merge round=41)
[S7] round=63 local utility u=1.000000 metrics={'f1_val': 0.9856880758394877, 'auprc': 0.9835081341884161, 'loss_val': 0.15413487367875575, 'psi': 0.984816099179059}-{'f1_val': 0.5733136452077758, 'auprc': 0.784563734302428, 'loss_val': 0.8886291463407502, 'psi': 0.6578136808456367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=63 head_norm_before_train=2.163275 cos_to_last_merge=0.8020 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=63 local utility u=0.046914 metrics={'f1_val': 0.9901099825334893, 'auprc': 0.9991376929943976, 'loss_val': 0.03480427729884854, 'psi': 0.9937210667178525}-{'f1_val': 0.9791693793459708, 'auprc': 0.9991855003093313, 'loss_val': 0.06313211304040296, 'psi': 0.9871758277313151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=63 head_norm_before_train=2.133413 (no previous merge yet)
[S9] round=63 local utility u=0.005748 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9999367596835345, 'loss_val': 0.021580284817639833, 'psi': 0.9969713563312468}-{'f1_val': 0.9934918488430377, 'auprc': 0.9999351208756089, 'loss_val': 0.02405678345190914, 'psi': 0.9960691576560661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=63 head_norm_before_train=2.071222 cos_to_last_merge=0.9713 (last merge round=35)
[S10] round=63 local utility u=0.001180 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9931715794064073, 'loss_val': 0.02736769811937593, 'psi': 0.9943813351741877}-{'f1_val': 0.9951878390193748, 'auprc': 0.9924342465676084, 'loss_val': 0.02751580298934491, 'psi': 0.9940864020386682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=63 head_norm_before_train=2.273533 (no previous merge yet)
[S11] round=63 local utility u=0.000352 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9984897762608023, 'loss_val': 0.01993973946111149, 'psi': 0.9973386593715956}-{'f1_val': 0.9965712481121245, 'auprc': 0.9986102737506686, 'loss_val': 0.021005133987734993, 'psi': 0.9973868583675422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=63 head_norm_before_train=1.928979 cos_to_last_merge=0.9968 (last merge round=41)
[S13] round=63 local utility u=0.059467 metrics={'f1_val': 0.7023029169089892, 'auprc': 0.8208134244720622, 'loss_val': 1.0492508306060835, 'psi': 0.7497071199342183}-{'f1_val': 0.6759293840621167, 'auprc': 0.7951932386213554, 'loss_val': 0.9330838404903026, 'psi': 0.7236349258858121}
[S13] not sending this round → trigger blocked (psi=0.750)
[S14] START round=63 head_norm_before_train=1.662404 cos_to_last_merge=0.9706 (last merge round=36)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9946268891022239, 'loss_val': 0.030057235703871813, 'psi': 0.9960492605354886}-{'f1_val': 0.9976538428159559, 'auprc': 0.9966821260910521, 'loss_val': 0.028669632729859545, 'psi': 0.9972651561259944}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.389985 (no previous merge yet)
[S15] round=63 local utility u=0.042620 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9951362056490521, 'loss_val': 0.03926338891029467, 'psi': 0.9890257777688987}-{'f1_val': 0.9731611146872898, 'auprc': 0.9948555015038605, 'loss_val': 0.052915249380605364, 'psi': 0.9818388694139182}
[S15] not sending this round → trigger blocked (psi=0.989)
[S16] START round=63 head_norm_before_train=2.004278 cos_to_last_merge=0.7587 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.759
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.8150035500950817, 'auprc': 0.961409303401815, 'loss_val': 0.9107611019546397, 'psi': 0.8735658514177751}-{'f1_val': 0.9818673929228411, 'auprc': 0.9902733593289664, 'loss_val': 0.06911015440350222, 'psi': 0.9852297794852912}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=2.171817 cos_to_last_merge=0.7728 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.773
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.8863369554955858, 'auprc': 0.9339363932540111, 'loss_val': 0.5879271007253225, 'psi': 0.905376730598956}-{'f1_val': 0.8967430545419792, 'auprc': 0.9445393190285398, 'loss_val': 0.5522196832096753, 'psi': 0.9158615603366034}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=2.181062 (no previous merge yet)
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.8341377019173906, 'auprc': 0.9919428392827943, 'loss_val': 0.29815810252791125, 'psi': 0.8972597568635521}-{'f1_val': 0.8863295257134772, 'auprc': 0.9896648024396214, 'loss_val': 0.23001563777676398, 'psi': 0.9276636364039349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=1.998189 cos_to_last_merge=0.9305 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.7481815412366446, 'auprc': 0.9474872604222182, 'loss_val': 0.7248075027297008, 'psi': 0.827903828910874}-{'f1_val': 0.981981085476121, 'auprc': 0.9984527845752378, 'loss_val': 0.04306187440811358, 'psi': 0.9885697651157677}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=2.207438 (no previous merge yet)
[S4] round=64 local utility u=0.020832 metrics={'f1_val': 0.9549366819501753, 'auprc': 0.951770292635747, 'loss_val': 0.3418644837434331, 'psi': 0.9536701262244041}-{'f1_val': 0.954722344121155, 'auprc': 0.9390183745240576, 'loss_val': 0.343986211088634, 'psi': 0.948440756282316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=64 head_norm_before_train=1.863042 cos_to_last_merge=0.9834 (last merge round=35)
[S5] round=64 local utility u=1.000000 metrics={'f1_val': 0.9742929744673533, 'auprc': 0.9945547783153994, 'loss_val': 0.18844476909130323, 'psi': 0.9823976960065717}-{'f1_val': 0.43660442196719185, 'auprc': 0.8511265500872834, 'loss_val': 1.2932958880866545, 'psi': 0.6024132732152285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=64 head_norm_before_train=2.110704 cos_to_last_merge=0.9579 (last merge round=42)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.7404936178784463, 'auprc': 0.9183224583689782, 'loss_val': 0.8161034076538196, 'psi': 0.8116251540746591}-{'f1_val': 0.8044753515483356, 'auprc': 0.9243307421846767, 'loss_val': 0.459254746451826, 'psi': 0.8524175078028721}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.841094 cos_to_last_merge=0.9979 (last merge round=41)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5927096880308411, 'auprc': 0.7929128602787425, 'loss_val': 0.8049970267330451, 'psi': 0.6727909569300017}-{'f1_val': 0.9856880758394877, 'auprc': 0.9835081341884161, 'loss_val': 0.15413487367875575, 'psi': 0.984816099179059}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=2.169644 cos_to_last_merge=0.8021 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9854270777254233, 'auprc': 0.9993816249406822, 'loss_val': 0.043998224956383204, 'psi': 0.9910088966115268}-{'f1_val': 0.9901099825334893, 'auprc': 0.9991376929943976, 'loss_val': 0.03480427729884854, 'psi': 0.9937210667178525}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.139207 (no previous merge yet)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948098675392784, 'loss_val': 0.01801801355748457, 'psi': 0.9956740038832779}-{'f1_val': 0.994994420763055, 'auprc': 0.9999367596835345, 'loss_val': 0.021580284817639833, 'psi': 0.9969713563312468}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.078760 cos_to_last_merge=0.9706 (last merge round=35)
[S10] round=64 local utility u=0.000515 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934705550045265, 'loss_val': 0.02723448610689316, 'psi': 0.9945009254134354}-{'f1_val': 0.9951878390193748, 'auprc': 0.9931715794064073, 'loss_val': 0.02736769811937593, 'psi': 0.9943813351741877}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=64 head_norm_before_train=2.281107 (no previous merge yet)
[S11] round=64 local utility u=0.000143 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9984958656283325, 'loss_val': 0.01967269429704487, 'psi': 0.9973410951186077}-{'f1_val': 0.9965712481121245, 'auprc': 0.9984897762608023, 'loss_val': 0.01993973946111149, 'psi': 0.9973386593715956}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=64 head_norm_before_train=1.933059 cos_to_last_merge=0.9966 (last merge round=41)
[S13] round=64 local utility u=0.058015 metrics={'f1_val': 0.7083364302166372, 'auprc': 0.8000557699618448, 'loss_val': 0.9071480963592409, 'psi': 0.7450241661147203}-{'f1_val': 0.7023029169089892, 'auprc': 0.8208134244720622, 'loss_val': 1.0492508306060835, 'psi': 0.7497071199342183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=64 head_norm_before_train=1.669993 cos_to_last_merge=0.9700 (last merge round=36)
[S14] round=64 local utility u=0.006774 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9975279625859468, 'loss_val': 0.027829705592085648, 'psi': 0.9974713670967346}-{'f1_val': 0.9969975081576651, 'auprc': 0.9946268891022239, 'loss_val': 0.030057235703871813, 'psi': 0.9960492605354886}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=64 head_norm_before_train=2.396194 (no previous merge yet)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9806357866875467, 'auprc': 0.995031349119505, 'loss_val': 0.044198491081224284, 'psi': 0.98639401166033}-{'f1_val': 0.9849521591821299, 'auprc': 0.9951362056490521, 'loss_val': 0.03926338891029467, 'psi': 0.9890257777688987}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.008813 cos_to_last_merge=0.7583 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=64 local utility u=1.000000 metrics={'f1_val': 0.9941001383381214, 'auprc': 0.9881044296769775, 'loss_val': 0.03217678102328863, 'psi': 0.9917018548736638}-{'f1_val': 0.8150035500950817, 'auprc': 0.961409303401815, 'loss_val': 0.9107611019546397, 'psi': 0.8735658514177751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=64 head_norm_before_train=2.176948 cos_to_last_merge=0.7723 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.823498274878762, 'auprc': 0.9258531803073624, 'loss_val': 0.728363653903736, 'psi': 0.8644402370502022}-{'f1_val': 0.8863369554955858, 'auprc': 0.9339363932540111, 'loss_val': 0.5879271007253225, 'psi': 0.905376730598956}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.179481 (no previous merge yet)
[S2] round=65 local utility u=0.153618 metrics={'f1_val': 0.914243462852634, 'auprc': 0.920918641741096, 'loss_val': 0.25848345124057975, 'psi': 0.9169135344080188}-{'f1_val': 0.8341377019173906, 'auprc': 0.9919428392827943, 'loss_val': 0.29815810252791125, 'psi': 0.8972597568635521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=65 head_norm_before_train=2.005562 cos_to_last_merge=0.9296 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=65 local utility u=0.256877 metrics={'f1_val': 0.795508981909729, 'auprc': 0.9969449873073557, 'loss_val': 0.6433919951157034, 'psi': 0.8760833840687796}-{'f1_val': 0.7481815412366446, 'auprc': 0.9474872604222182, 'loss_val': 0.7248075027297008, 'psi': 0.827903828910874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=65 head_norm_before_train=2.208577 (no previous merge yet)
[S4] round=65 local utility u=0.014664 metrics={'f1_val': 0.9565840351713545, 'auprc': 0.9582987573806893, 'loss_val': 0.34200638939254263, 'psi': 0.9572699240550884}-{'f1_val': 0.9549366819501753, 'auprc': 0.951770292635747, 'loss_val': 0.3418644837434331, 'psi': 0.9536701262244041}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=65 head_norm_before_train=1.864570 cos_to_last_merge=0.9829 (last merge round=35)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8531613943365843, 'loss_val': 1.2040596171679676, 'psi': 0.603324296037857}-{'f1_val': 0.9742929744673533, 'auprc': 0.9945547783153994, 'loss_val': 0.18844476909130323, 'psi': 0.9823976960065717}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.123970 cos_to_last_merge=0.9567 (last merge round=42)
[S6] round=65 local utility u=0.675736 metrics={'f1_val': 0.8511820555238013, 'auprc': 0.958656900890661, 'loss_val': 0.24976587951387474, 'psi': 0.8941719936705452}-{'f1_val': 0.7404936178784463, 'auprc': 0.9183224583689782, 'loss_val': 0.8161034076538196, 'psi': 0.8116251540746591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=65 head_norm_before_train=1.844119 cos_to_last_merge=0.9977 (last merge round=41)
[S7] round=65 local utility u=0.579751 metrics={'f1_val': 0.680550260886045, 'auprc': 0.843217158577066, 'loss_val': 0.3234517682672822, 'psi': 0.7456170199624534}-{'f1_val': 0.5927096880308411, 'auprc': 0.7929128602787425, 'loss_val': 0.8049970267330451, 'psi': 0.6727909569300017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=65 head_norm_before_train=2.166380 cos_to_last_merge=0.8023 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=65 local utility u=0.033176 metrics={'f1_val': 0.9937565546873874, 'auprc': 0.9996000374511487, 'loss_val': 0.028278100088143802, 'psi': 0.996093947792892}-{'f1_val': 0.9854270777254233, 'auprc': 0.9993816249406822, 'loss_val': 0.043998224956383204, 'psi': 0.9910088966115268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=65 head_norm_before_train=2.145661 (no previous merge yet)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9946747738430864, 'loss_val': 0.018391550575114303, 'psi': 0.9956199664048011}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948098675392784, 'loss_val': 0.01801801355748457, 'psi': 0.9956740038832779}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=2.085022 cos_to_last_merge=0.9700 (last merge round=35)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934124672314975, 'loss_val': 0.02717174558860821, 'psi': 0.9944776903042238}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934705550045265, 'loss_val': 0.02723448610689316, 'psi': 0.9945009254134354}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.287964 (no previous merge yet)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9985777542290697, 'loss_val': 0.02446819757744531, 'psi': 0.9972287479882421}-{'f1_val': 0.9965712481121245, 'auprc': 0.9984958656283325, 'loss_val': 0.01967269429704487, 'psi': 0.9973410951186077}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.936986 cos_to_last_merge=0.9963 (last merge round=41)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6549041304921417, 'auprc': 0.75725886818206, 'loss_val': 1.0395134080053168, 'psi': 0.695846025568109}-{'f1_val': 0.7083364302166372, 'auprc': 0.8000557699618448, 'loss_val': 0.9071480963592409, 'psi': 0.7450241661147203}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.678135 cos_to_last_merge=0.9693 (last merge round=36)
[S14] round=65 local utility u=0.002188 metrics={'f1_val': 0.9976763577590866, 'auprc': 0.9980593707416159, 'loss_val': 0.026504455145125064, 'psi': 0.9978295629520983}-{'f1_val': 0.9974336367705932, 'auprc': 0.9975279625859468, 'loss_val': 0.027829705592085648, 'psi': 0.9974713670967346}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=65 head_norm_before_train=2.402247 (no previous merge yet)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9775794000968784, 'auprc': 0.9948359292739224, 'loss_val': 0.046773896086537065, 'psi': 0.984482011767696}-{'f1_val': 0.9806357866875467, 'auprc': 0.995031349119505, 'loss_val': 0.044198491081224284, 'psi': 0.98639401166033}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.013216 cos_to_last_merge=0.7580 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9857621759533206, 'auprc': 0.9894285856287426, 'loss_val': 0.06074713301101386, 'psi': 0.9872287398234895}-{'f1_val': 0.9941001383381214, 'auprc': 0.9881044296769775, 'loss_val': 0.03217678102328863, 'psi': 0.9917018548736638}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=2.181736 cos_to_last_merge=0.7720 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=65 local utility u=0.402334 metrics={'f1_val': 0.9047651065264626, 'auprc': 0.9675239951731588, 'loss_val': 0.5363087581231546, 'psi': 0.9298686619851411}-{'f1_val': 0.823498274878762, 'auprc': 0.9258531803073624, 'loss_val': 0.728363653903736, 'psi': 0.8644402370502022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=66 head_norm_before_train=2.185680 (no previous merge yet)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.8727519017906898, 'auprc': 0.9806905281425279, 'loss_val': 0.28598658792099396, 'psi': 0.9159273523314251}-{'f1_val': 0.914243462852634, 'auprc': 0.920918641741096, 'loss_val': 0.25848345124057975, 'psi': 0.9169135344080188}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.012308 cos_to_last_merge=0.9288 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.929
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.7202196099677167, 'auprc': 0.9928510452178977, 'loss_val': 0.8810805728997346, 'psi': 0.8292721840677891}-{'f1_val': 0.795508981909729, 'auprc': 0.9969449873073557, 'loss_val': 0.6433919951157034, 'psi': 0.8760833840687796}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.210490 (no previous merge yet)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9577392191237092, 'auprc': 0.9532096972042453, 'loss_val': 0.34833004590513006, 'psi': 0.9559274103559237}-{'f1_val': 0.9565840351713545, 'auprc': 0.9582987573806893, 'loss_val': 0.34200638939254263, 'psi': 0.9572699240550884}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.865309 cos_to_last_merge=0.9828 (last merge round=35)
[S5] round=66 local utility u=0.634524 metrics={'f1_val': 0.5490296513441403, 'auprc': 0.8594211805385299, 'loss_val': 0.6273724966794946, 'psi': 0.6731862630218961}-{'f1_val': 0.43676623050537206, 'auprc': 0.8531613943365843, 'loss_val': 1.2040596171679676, 'psi': 0.603324296037857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=66 head_norm_before_train=2.138344 cos_to_last_merge=0.9552 (last merge round=42)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.8424600330725447, 'auprc': 0.9687576621708567, 'loss_val': 0.23315408612234323, 'psi': 0.8929790847118695}-{'f1_val': 0.8511820555238013, 'auprc': 0.958656900890661, 'loss_val': 0.24976587951387474, 'psi': 0.8941719936705452}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.848845 cos_to_last_merge=0.9975 (last merge round=41)
[S7] round=66 local utility u=0.000000 metrics={'f1_val': 0.5612118862394013, 'auprc': 0.7863635927513619, 'loss_val': 0.9923711936448267, 'psi': 0.6512725688441856}-{'f1_val': 0.680550260886045, 'auprc': 0.843217158577066, 'loss_val': 0.3234517682672822, 'psi': 0.7456170199624534}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=66 head_norm_before_train=2.167744 cos_to_last_merge=0.8020 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9798748570451079, 'auprc': 0.9960511715178879, 'loss_val': 0.05499254662857929, 'psi': 0.9863453828342199}-{'f1_val': 0.9937565546873874, 'auprc': 0.9996000374511487, 'loss_val': 0.028278100088143802, 'psi': 0.996093947792892}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=66 head_norm_before_train=2.149655 (no previous merge yet)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9899455008418782, 'auprc': 0.9999519742071437, 'loss_val': 0.03764327726802025, 'psi': 0.9939480901879845}-{'f1_val': 0.9962500947792776, 'auprc': 0.9946747738430864, 'loss_val': 0.018391550575114303, 'psi': 0.9956199664048011}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.091310 cos_to_last_merge=0.9695 (last merge round=35)
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927126110967243, 'loss_val': 0.02715972454868762, 'psi': 0.9941977478503146}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934124672314975, 'loss_val': 0.02717174558860821, 'psi': 0.9944776903042238}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=2.290503 (no previous merge yet)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9953670360569602, 'auprc': 0.9985979455872638, 'loss_val': 0.024901053192842033, 'psi': 0.9966593998690816}-{'f1_val': 0.9963294104943571, 'auprc': 0.9985777542290697, 'loss_val': 0.02446819757744531, 'psi': 0.9972287479882421}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.942118 cos_to_last_merge=0.9960 (last merge round=41)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6261217758712624, 'auprc': 0.7059917523109258, 'loss_val': 1.1137177914153678, 'psi': 0.6580697664471278}-{'f1_val': 0.6549041304921417, 'auprc': 0.75725886818206, 'loss_val': 1.0395134080053168, 'psi': 0.695846025568109}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=1.686447 cos_to_last_merge=0.9687 (last merge round=36)
[S14] round=66 local utility u=0.000802 metrics={'f1_val': 0.9976543488671686, 'auprc': 0.9984036183602563, 'loss_val': 0.025800974421249692, 'psi': 0.9979540566644036}-{'f1_val': 0.9976763577590866, 'auprc': 0.9980593707416159, 'loss_val': 0.026504455145125064, 'psi': 0.9978295629520983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=66 head_norm_before_train=2.408319 (no previous merge yet)
[S15] round=66 local utility u=0.012314 metrics={'f1_val': 0.9810700326853032, 'auprc': 0.9949926402123935, 'loss_val': 0.04355952509721899, 'psi': 0.9866390756961394}-{'f1_val': 0.9775794000968784, 'auprc': 0.9948359292739224, 'loss_val': 0.046773896086537065, 'psi': 0.984482011767696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=66 head_norm_before_train=2.018636 cos_to_last_merge=0.7578 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.758
[S16] round=66 local utility u=0.033500 metrics={'f1_val': 0.9920196277539046, 'auprc': 0.9925225105679539, 'loss_val': 0.04057415931179679, 'psi': 0.9922207808795243}-{'f1_val': 0.9857621759533206, 'auprc': 0.9894285856287426, 'loss_val': 0.06074713301101386, 'psi': 0.9872287398234895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=66 head_norm_before_train=2.185822 cos_to_last_merge=0.7715 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8683217633670507, 'auprc': 0.9864327924910035, 'loss_val': 0.6123303801348935, 'psi': 0.9155661750166318}-{'f1_val': 0.9047651065264626, 'auprc': 0.9675239951731588, 'loss_val': 0.5363087581231546, 'psi': 0.9298686619851411}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.189804 (no previous merge yet)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.8325795634273434, 'auprc': 0.993476403184733, 'loss_val': 0.3658567440373741, 'psi': 0.8969382993302992}-{'f1_val': 0.8727519017906898, 'auprc': 0.9806905281425279, 'loss_val': 0.28598658792099396, 'psi': 0.9159273523314251}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.018170 cos_to_last_merge=0.9282 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=67 local utility u=0.143868 metrics={'f1_val': 0.7649145278390569, 'auprc': 0.9597858670329394, 'loss_val': 0.7623176130048389, 'psi': 0.8428630635166099}-{'f1_val': 0.7202196099677167, 'auprc': 0.9928510452178977, 'loss_val': 0.8810805728997346, 'psi': 0.8292721840677891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=67 head_norm_before_train=2.211003 (no previous merge yet)
[S4] round=67 local utility u=0.000786 metrics={'f1_val': 0.9555889184055482, 'auprc': 0.9534145726371175, 'loss_val': 0.3344718189679925, 'psi': 0.9547191800981758}-{'f1_val': 0.9577392191237092, 'auprc': 0.9532096972042453, 'loss_val': 0.34833004590513006, 'psi': 0.9559274103559237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=67 head_norm_before_train=1.867281 cos_to_last_merge=0.9828 (last merge round=35)
[S5] round=67 local utility u=0.479452 metrics={'f1_val': 0.6625449259156126, 'auprc': 0.8733266251242537, 'loss_val': 0.39127560604560396, 'psi': 0.7468576055990691}-{'f1_val': 0.5490296513441403, 'auprc': 0.8594211805385299, 'loss_val': 0.6273724966794946, 'psi': 0.6731862630218961}
[S5] not sending this round → trigger blocked (psi=0.747)
[S6] START round=67 head_norm_before_train=2.152284 cos_to_last_merge=0.9543 (last merge round=42)
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.7421154656411877, 'auprc': 0.8652759938830465, 'loss_val': 0.7061402014656103, 'psi': 0.7913796769379313}-{'f1_val': 0.8424600330725447, 'auprc': 0.9687576621708567, 'loss_val': 0.23315408612234323, 'psi': 0.8929790847118695}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.853748 cos_to_last_merge=0.9973 (last merge round=41)
[S7] round=67 local utility u=0.936634 metrics={'f1_val': 0.7021492424798895, 'auprc': 0.8784254341231028, 'loss_val': 0.24091311996721526, 'psi': 0.7726597191371749}-{'f1_val': 0.5612118862394013, 'auprc': 0.7863635927513619, 'loss_val': 0.9923711936448267, 'psi': 0.6512725688441856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=67 head_norm_before_train=2.174550 cos_to_last_merge=0.8015 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.801
[S8] round=67 local utility u=0.048435 metrics={'f1_val': 0.9937565546873874, 'auprc': 0.9929484513967415, 'loss_val': 0.03210391349001346, 'psi': 0.9934333133711291}-{'f1_val': 0.9798748570451079, 'auprc': 0.9960511715178879, 'loss_val': 0.05499254662857929, 'psi': 0.9863453828342199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=67 head_norm_before_train=2.151455 (no previous merge yet)
[S9] round=67 local utility u=0.026078 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9972630182546935, 'loss_val': 0.017710567187785936, 'psi': 0.9969015143902122}-{'f1_val': 0.9899455008418782, 'auprc': 0.9999519742071437, 'loss_val': 0.03764327726802025, 'psi': 0.9939480901879845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=67 head_norm_before_train=2.097733 cos_to_last_merge=0.9689 (last merge round=35)
[S10] round=67 local utility u=0.000365 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9929377484905733, 'loss_val': 0.027105699483448143, 'psi': 0.9942878028078541}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927126110967243, 'loss_val': 0.02715972454868762, 'psi': 0.9941977478503146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=67 head_norm_before_train=2.294893 (no previous merge yet)
[S11] round=67 local utility u=0.006147 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9985331327985145, 'loss_val': 0.01963792288833962, 'psi': 0.9973560019866805}-{'f1_val': 0.9953670360569602, 'auprc': 0.9985979455872638, 'loss_val': 0.024901053192842033, 'psi': 0.9966593998690816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=67 head_norm_before_train=1.947554 cos_to_last_merge=0.9957 (last merge round=41)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.5969411531486586, 'auprc': 0.6587178529263884, 'loss_val': 1.4298728209017186, 'psi': 0.6216518330597505}-{'f1_val': 0.6261217758712624, 'auprc': 0.7059917523109258, 'loss_val': 1.1137177914153678, 'psi': 0.6580697664471278}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.694986 cos_to_last_merge=0.9680 (last merge round=36)
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9440384795473431, 'auprc': 0.9977960444106153, 'loss_val': 0.11028615858072603, 'psi': 0.965541505492652}-{'f1_val': 0.9976543488671686, 'auprc': 0.9984036183602563, 'loss_val': 0.025800974421249692, 'psi': 0.9979540566644036}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=2.414111 (no previous merge yet)
[S15] round=67 local utility u=0.027302 metrics={'f1_val': 0.9883646006797152, 'auprc': 0.9952987050475313, 'loss_val': 0.033640278925531154, 'psi': 0.9911382424268416}-{'f1_val': 0.9810700326853032, 'auprc': 0.9949926402123935, 'loss_val': 0.04355952509721899, 'psi': 0.9866390756961394}
[S15] not sending this round → trigger blocked (psi=0.991)
[S16] START round=67 head_norm_before_train=2.020131 cos_to_last_merge=0.7573 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.757
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9922192454726135, 'auprc': 0.991939846496346, 'loss_val': 0.04033669976627007, 'psi': 0.9921074858821065}-{'f1_val': 0.9920196277539046, 'auprc': 0.9925225105679539, 'loss_val': 0.04057415931179679, 'psi': 0.9922207808795243}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.190753 cos_to_last_merge=0.7712 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=67 local utility u=0.082885 metrics={'f1_val': 0.8994683064119059, 'auprc': 0.9492709027515517, 'loss_val': 0.5219543206544073, 'psi': 0.9193893449477641}-{'f1_val': 0.8683217633670507, 'auprc': 0.9864327924910035, 'loss_val': 0.6123303801348935, 'psi': 0.9155661750166318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=68 head_norm_before_train=2.195932 (no previous merge yet)
[S2] round=68 local utility u=0.021640 metrics={'f1_val': 0.8341485724017623, 'auprc': 0.9920424680662432, 'loss_val': 0.3276893344199239, 'psi': 0.8973061306675546}-{'f1_val': 0.8325795634273434, 'auprc': 0.993476403184733, 'loss_val': 0.3658567440373741, 'psi': 0.8969382993302992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=68 head_norm_before_train=2.023997 cos_to_last_merge=0.9276 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.7055477191842221, 'auprc': 0.9279113169465241, 'loss_val': 0.9621745934608547, 'psi': 0.7944931582891429}-{'f1_val': 0.7649145278390569, 'auprc': 0.9597858670329394, 'loss_val': 0.7623176130048389, 'psi': 0.8428630635166099}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=2.214180 (no previous merge yet)
[S4] round=68 local utility u=0.003068 metrics={'f1_val': 0.9550176414465241, 'auprc': 0.9561611932939558, 'loss_val': 0.3331482322421556, 'psi': 0.9554750621854968}-{'f1_val': 0.9555889184055482, 'auprc': 0.9534145726371175, 'loss_val': 0.3344718189679925, 'psi': 0.9547191800981758}
[S4] not sending this round → trigger blocked (psi=0.955)
[S5] START round=68 head_norm_before_train=1.871724 cos_to_last_merge=0.9827 (last merge round=35)
[S5] round=68 local utility u=0.053072 metrics={'f1_val': 0.6998916645333034, 'auprc': 0.8351015832946047, 'loss_val': 0.39453755250709166, 'psi': 0.7539756320378239}-{'f1_val': 0.6625449259156126, 'auprc': 0.8733266251242537, 'loss_val': 0.39127560604560396, 'psi': 0.7468576055990691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=68 head_norm_before_train=2.165964 cos_to_last_merge=0.9533 (last merge round=42)
[S6] round=68 local utility u=0.958347 metrics={'f1_val': 0.9408068209966971, 'auprc': 0.9523538614937584, 'loss_val': 0.24282694887424353, 'psi': 0.9454256371955216}-{'f1_val': 0.7421154656411877, 'auprc': 0.8652759938830465, 'loss_val': 0.7061402014656103, 'psi': 0.7913796769379313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=68 head_norm_before_train=1.856298 cos_to_last_merge=0.9973 (last merge round=41)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5748149301349271, 'auprc': 0.7878503720554859, 'loss_val': 0.8978858173933872, 'psi': 0.6600291069031506}-{'f1_val': 0.7021492424798895, 'auprc': 0.8784254341231028, 'loss_val': 0.24091311996721526, 'psi': 0.7726597191371749}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.179939 cos_to_last_merge=0.8005 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9736066227513505, 'auprc': 0.9959938749011458, 'loss_val': 0.07566811290951651, 'psi': 0.9825615236112686}-{'f1_val': 0.9937565546873874, 'auprc': 0.9929484513967415, 'loss_val': 0.03210391349001346, 'psi': 0.9934333133711291}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=2.153611 (no previous merge yet)
[S9] round=68 local utility u=0.003667 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9999468765311555, 'loss_val': 0.018428912728387575, 'psi': 0.9979750577007971}-{'f1_val': 0.9966605118138915, 'auprc': 0.9972630182546935, 'loss_val': 0.017710567187785936, 'psi': 0.9969015143902122}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=68 head_norm_before_train=2.103191 cos_to_last_merge=0.9684 (last merge round=35)
[S10] round=68 local utility u=0.001190 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9936989575231245, 'loss_val': 0.0270100755299856, 'psi': 0.9945922864208747}-{'f1_val': 0.9951878390193748, 'auprc': 0.9929377484905733, 'loss_val': 0.027105699483448143, 'psi': 0.9942878028078541}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=68 head_norm_before_train=2.300244 (no previous merge yet)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9983198213376052, 'loss_val': 0.03114318046687539, 'psi': 0.9971255748316563}-{'f1_val': 0.9965712481121245, 'auprc': 0.9985331327985145, 'loss_val': 0.01963792288833962, 'psi': 0.9973560019866805}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.953784 cos_to_last_merge=0.9954 (last merge round=41)
[S13] round=68 local utility u=0.674403 metrics={'f1_val': 0.6533366568003159, 'auprc': 0.8065081010329079, 'loss_val': 0.8628097559419167, 'psi': 0.7146052344933527}-{'f1_val': 0.5969411531486586, 'auprc': 0.6587178529263884, 'loss_val': 1.4298728209017186, 'psi': 0.6216518330597505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=68 head_norm_before_train=1.703556 cos_to_last_merge=0.9672 (last merge round=36)
[S14] round=68 local utility u=0.203409 metrics={'f1_val': 0.997211058727947, 'auprc': 0.9989909200652449, 'loss_val': 0.026087469477674215, 'psi': 0.9979230032628662}-{'f1_val': 0.9440384795473431, 'auprc': 0.9977960444106153, 'loss_val': 0.11028615858072603, 'psi': 0.965541505492652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=68 head_norm_before_train=2.419731 (no previous merge yet)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.9870890720085022, 'auprc': 0.9952996683796991, 'loss_val': 0.035318594487503324, 'psi': 0.990373310556981}-{'f1_val': 0.9883646006797152, 'auprc': 0.9952987050475313, 'loss_val': 0.033640278925531154, 'psi': 0.9911382424268416}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.020699 cos_to_last_merge=0.7567 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.757
[S16] round=68 local utility u=0.000897 metrics={'f1_val': 0.9922499116589072, 'auprc': 0.9930209807064219, 'loss_val': 0.041970432377277024, 'psi': 0.992558339277913}-{'f1_val': 0.9922192454726135, 'auprc': 0.991939846496346, 'loss_val': 0.04033669976627007, 'psi': 0.9921074858821065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=68 head_norm_before_train=2.199293 cos_to_last_merge=0.7707 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.771
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.8926614400686679, 'auprc': 0.9367288435340677, 'loss_val': 0.5505827377375879, 'psi': 0.9102884014548278}-{'f1_val': 0.8994683064119059, 'auprc': 0.9492709027515517, 'loss_val': 0.5219543206544073, 'psi': 0.9193893449477641}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=69 head_norm_before_train=2.203945 (no previous merge yet)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.8328103916484413, 'auprc': 0.9739298346294468, 'loss_val': 0.3856322865372181, 'psi': 0.8892581688408434}-{'f1_val': 0.8341485724017623, 'auprc': 0.9920424680662432, 'loss_val': 0.3276893344199239, 'psi': 0.8973061306675546}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.030480 cos_to_last_merge=0.9270 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.927
[S3] round=69 local utility u=0.095032 metrics={'f1_val': 0.7177787888488687, 'auprc': 0.9438040179014477, 'loss_val': 0.8931747279531745, 'psi': 0.8081888804699003}-{'f1_val': 0.7055477191842221, 'auprc': 0.9279113169465241, 'loss_val': 0.9621745934608547, 'psi': 0.7944931582891429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=69 head_norm_before_train=2.214606 (no previous merge yet)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9545176572520608, 'auprc': 0.9372206427024111, 'loss_val': 0.3286302788954021, 'psi': 0.9475988514322009}-{'f1_val': 0.9550176414465241, 'auprc': 0.9561611932939558, 'loss_val': 0.3331482322421556, 'psi': 0.9554750621854968}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.875421 cos_to_last_merge=0.9826 (last merge round=35)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.6875311865037737, 'auprc': 0.8345061099562008, 'loss_val': 0.4068291080136658, 'psi': 0.7463211558847445}-{'f1_val': 0.6998916645333034, 'auprc': 0.8351015832946047, 'loss_val': 0.39453755250709166, 'psi': 0.7539756320378239}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=2.177168 cos_to_last_merge=0.9526 (last merge round=42)
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7597639037636952, 'auprc': 0.9120990756821229, 'loss_val': 0.7820968628225883, 'psi': 0.8206979725310662}-{'f1_val': 0.9408068209966971, 'auprc': 0.9523538614937584, 'loss_val': 0.24282694887424353, 'psi': 0.9454256371955216}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.857881 cos_to_last_merge=0.9972 (last merge round=41)
[S7] round=69 local utility u=1.000000 metrics={'f1_val': 0.9944381361781826, 'auprc': 0.9875096418942597, 'loss_val': 0.13795679457026486, 'psi': 0.9916667384646134}-{'f1_val': 0.5748149301349271, 'auprc': 0.7878503720554859, 'loss_val': 0.8978858173933872, 'psi': 0.6600291069031506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=69 head_norm_before_train=2.186248 cos_to_last_merge=0.7997 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=69 local utility u=0.090343 metrics={'f1_val': 0.9936117456418484, 'auprc': 0.9995441169009726, 'loss_val': 0.025664235917109528, 'psi': 0.9959846941454982}-{'f1_val': 0.9736066227513505, 'auprc': 0.9959938749011458, 'loss_val': 0.07566811290951651, 'psi': 0.9825615236112686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=69 head_norm_before_train=2.154107 (no previous merge yet)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9991840266486486, 'loss_val': 0.01933172034475401, 'psi': 0.9969231101814309}-{'f1_val': 0.9966605118138915, 'auprc': 0.9999468765311555, 'loss_val': 0.018428912728387575, 'psi': 0.9979750577007971}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=2.109965 cos_to_last_merge=0.9678 (last merge round=35)
[S10] round=69 local utility u=0.000153 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937841565756212, 'loss_val': 0.026958764124018226, 'psi': 0.9946263660418733}-{'f1_val': 0.9951878390193748, 'auprc': 0.9936989575231245, 'loss_val': 0.0270100755299856, 'psi': 0.9945922864208747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=69 head_norm_before_train=2.305798 (no previous merge yet)
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9842434408391217, 'auprc': 0.9984872909767167, 'loss_val': 0.04716237733952941, 'psi': 0.9899409808941597}-{'f1_val': 0.9963294104943571, 'auprc': 0.9983198213376052, 'loss_val': 0.03114318046687539, 'psi': 0.9971255748316563}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.959653 cos_to_last_merge=0.9950 (last merge round=41)
[S13] round=69 local utility u=0.029511 metrics={'f1_val': 0.7246213813662332, 'auprc': 0.7784392947965827, 'loss_val': 1.1472896831258808, 'psi': 0.746148546738373}-{'f1_val': 0.6533366568003159, 'auprc': 0.8065081010329079, 'loss_val': 0.8628097559419167, 'psi': 0.7146052344933527}
[S13] not sending this round → trigger blocked (psi=0.746)
[S14] START round=69 head_norm_before_train=1.710943 cos_to_last_merge=0.9667 (last merge round=36)
[S14] round=69 local utility u=0.002628 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9989912877132967, 'loss_val': 0.02463297156035596, 'psi': 0.9983031560675865}-{'f1_val': 0.997211058727947, 'auprc': 0.9989909200652449, 'loss_val': 0.026087469477674215, 'psi': 0.9979230032628662}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=69 head_norm_before_train=2.425202 (no previous merge yet)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.9775794000968784, 'auprc': 0.995116045126549, 'loss_val': 0.04697530419596314, 'psi': 0.9845940581087467}-{'f1_val': 0.9870890720085022, 'auprc': 0.9952996683796991, 'loss_val': 0.035318594487503324, 'psi': 0.990373310556981}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=2.016305 cos_to_last_merge=0.7557 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.756
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.8880507149313916, 'auprc': 0.9842669906991153, 'loss_val': 0.6209877459435243, 'psi': 0.926537225238481}-{'f1_val': 0.9922499116589072, 'auprc': 0.9930209807064219, 'loss_val': 0.041970432377277024, 'psi': 0.992558339277913}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=2.206598 cos_to_last_merge=0.7703 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=69 local utility u=0.050873 metrics={'f1_val': 0.8940979899605102, 'auprc': 0.9489208992101149, 'loss_val': 0.4940319133941324, 'psi': 0.916027153660352}-{'f1_val': 0.8926614400686679, 'auprc': 0.9367288435340677, 'loss_val': 0.5505827377375879, 'psi': 0.9102884014548278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=70 head_norm_before_train=2.206614 (no previous merge yet)
[S2] round=70 local utility u=0.109424 metrics={'f1_val': 0.8416805724518369, 'auprc': 0.9915856033469514, 'loss_val': 0.27297231729368543, 'psi': 0.9016425848098828}-{'f1_val': 0.8328103916484413, 'auprc': 0.9739298346294468, 'loss_val': 0.3856322865372181, 'psi': 0.8892581688408434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=70 head_norm_before_train=2.037910 cos_to_last_merge=0.9262 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=70 local utility u=1.000000 metrics={'f1_val': 0.9955305572164924, 'auprc': 0.9983030136308602, 'loss_val': 0.024274074878617317, 'psi': 0.9966395397822395}-{'f1_val': 0.7177787888488687, 'auprc': 0.9438040179014477, 'loss_val': 0.8931747279531745, 'psi': 0.8081888804699003}
[S3] not sending this round → trigger blocked (psi=0.997)
[S4] START round=70 head_norm_before_train=2.220402 (no previous merge yet)
[S4] round=70 local utility u=0.007419 metrics={'f1_val': 0.9555949852077332, 'auprc': 0.939699637543995, 'loss_val': 0.3276935678937725, 'psi': 0.9492368461422379}-{'f1_val': 0.9545176572520608, 'auprc': 0.9372206427024111, 'loss_val': 0.3286302788954021, 'psi': 0.9475988514322009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=70 head_norm_before_train=1.878731 cos_to_last_merge=0.9825 (last merge round=35)
[S5] round=70 local utility u=0.446854 metrics={'f1_val': 0.7234707345822348, 'auprc': 0.9916094346683575, 'loss_val': 0.20006752810531453, 'psi': 0.8307262146166838}-{'f1_val': 0.6875311865037737, 'auprc': 0.8345061099562008, 'loss_val': 0.4068291080136658, 'psi': 0.7463211558847445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=70 head_norm_before_train=2.190319 cos_to_last_merge=0.9515 (last merge round=42)
[S6] round=70 local utility u=0.091490 metrics={'f1_val': 0.7595164668980927, 'auprc': 0.8819498891206609, 'loss_val': 0.5071845460824925, 'psi': 0.80848983578712}-{'f1_val': 0.7597639037636952, 'auprc': 0.9120990756821229, 'loss_val': 0.7820968628225883, 'psi': 0.8206979725310662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=70 head_norm_before_train=1.860297 cos_to_last_merge=0.9971 (last merge round=41)
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.606467172362827, 'auprc': 0.7924203556540375, 'loss_val': 0.7819067953973907, 'psi': 0.6808484456793111}-{'f1_val': 0.9944381361781826, 'auprc': 0.9875096418942597, 'loss_val': 0.13795679457026486, 'psi': 0.9916667384646134}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.193072 cos_to_last_merge=0.7998 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9995466455186165, 'loss_val': 0.026855309100159874, 'psi': 0.9958136585857311}-{'f1_val': 0.9936117456418484, 'auprc': 0.9995441169009726, 'loss_val': 0.025664235917109528, 'psi': 0.9959846941454982}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.157129 (no previous merge yet)
[S9] round=70 local utility u=0.001242 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9991933115669183, 'loss_val': 0.01934062656721131, 'psi': 0.9971733556452785}-{'f1_val': 0.9954158325366191, 'auprc': 0.9991840266486486, 'loss_val': 0.01933172034475401, 'psi': 0.9969231101814309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=70 head_norm_before_train=2.114603 cos_to_last_merge=0.9673 (last merge round=35)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932213507132039, 'loss_val': 0.026965840215856962, 'psi': 0.9944012436969064}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937841565756212, 'loss_val': 0.026958764124018226, 'psi': 0.9946263660418733}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=70 head_norm_before_train=2.309984 (no previous merge yet)
[S11] round=70 local utility u=0.050832 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984504926343473, 'loss_val': 0.0193323985093706, 'psi': 0.9973206794374672}-{'f1_val': 0.9842434408391217, 'auprc': 0.9984872909767167, 'loss_val': 0.04716237733952941, 'psi': 0.9899409808941597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=70 head_norm_before_train=1.964873 cos_to_last_merge=0.9948 (last merge round=41)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6267936156789661, 'auprc': 0.6761024667976892, 'loss_val': 1.2184193619758785, 'psi': 0.6465171561264553}-{'f1_val': 0.7246213813662332, 'auprc': 0.7784392947965827, 'loss_val': 1.1472896831258808, 'psi': 0.746148546738373}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.717318 cos_to_last_merge=0.9663 (last merge round=36)
[S14] round=70 local utility u=0.000496 metrics={'f1_val': 0.997844401637113, 'auprc': 0.99893069753876, 'loss_val': 0.02345944005675874, 'psi': 0.9982789199977717}-{'f1_val': 0.997844401637113, 'auprc': 0.9989912877132967, 'loss_val': 0.02463297156035596, 'psi': 0.9983031560675865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=70 head_norm_before_train=2.430728 (no previous merge yet)
[S15] round=70 local utility u=0.019825 metrics={'f1_val': 0.9832325130774054, 'auprc': 0.9952263724946344, 'loss_val': 0.04157461593133839, 'psi': 0.988030056844297}-{'f1_val': 0.9775794000968784, 'auprc': 0.995116045126549, 'loss_val': 0.04697530419596314, 'psi': 0.9845940581087467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=70 head_norm_before_train=2.016575 cos_to_last_merge=0.7550 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.755
[S16] round=70 local utility u=0.604311 metrics={'f1_val': 0.9920135014807094, 'auprc': 0.9867790137704311, 'loss_val': 0.04367760144194269, 'psi': 0.9899197063965981}-{'f1_val': 0.8880507149313916, 'auprc': 0.9842669906991153, 'loss_val': 0.6209877459435243, 'psi': 0.926537225238481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=70 head_norm_before_train=2.212753 cos_to_last_merge=0.7699 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.8899271978167521, 'auprc': 0.9367885634922507, 'loss_val': 0.6024736236893885, 'psi': 0.9086717440869515}-{'f1_val': 0.8940979899605102, 'auprc': 0.9489208992101149, 'loss_val': 0.4940319133941324, 'psi': 0.916027153660352}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=2.207522 (no previous merge yet)
[S2] round=71 local utility u=0.197616 metrics={'f1_val': 0.9058329786125604, 'auprc': 0.9733229289150126, 'loss_val': 0.20786632064429794, 'psi': 0.9328289587335412}-{'f1_val': 0.8416805724518369, 'auprc': 0.9915856033469514, 'loss_val': 0.27297231729368543, 'psi': 0.9016425848098828}
[S2] not sending this round → trigger blocked (psi=0.933)
[S3] START round=71 head_norm_before_train=2.046046 cos_to_last_merge=0.9254 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.9345947525032497, 'auprc': 0.9982625770063702, 'loss_val': 0.2027626742919643, 'psi': 0.960061882304498}-{'f1_val': 0.9955305572164924, 'auprc': 0.9983030136308602, 'loss_val': 0.024274074878617317, 'psi': 0.9966395397822395}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.235416 (no previous merge yet)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.954298549450138, 'auprc': 0.9341093870083292, 'loss_val': 0.3351498662875459, 'psi': 0.9462228844734146}-{'f1_val': 0.9555949852077332, 'auprc': 0.939699637543995, 'loss_val': 0.3276935678937725, 'psi': 0.9492368461422379}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.882330 cos_to_last_merge=0.9823 (last merge round=35)
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.6054970967071516, 'auprc': 0.8097550386815235, 'loss_val': 0.6177324555514331, 'psi': 0.6872002734969004}-{'f1_val': 0.7234707345822348, 'auprc': 0.9916094346683575, 'loss_val': 0.20006752810531453, 'psi': 0.8307262146166838}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=2.202434 cos_to_last_merge=0.9503 (last merge round=42)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6930473916170423, 'auprc': 0.8732870915794215, 'loss_val': 0.9784853759822413, 'psi': 0.765143271601994}-{'f1_val': 0.7595164668980927, 'auprc': 0.8819498891206609, 'loss_val': 0.5071845460824925, 'psi': 0.80848983578712}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.862042 cos_to_last_merge=0.9970 (last merge round=41)
[S7] round=71 local utility u=0.680145 metrics={'f1_val': 0.694975633235694, 'auprc': 0.8896237980252857, 'loss_val': 0.24427691017044675, 'psi': 0.7728348991515307}-{'f1_val': 0.606467172362827, 'auprc': 0.7924203556540375, 'loss_val': 0.7819067953973907, 'psi': 0.6808484456793111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=71 head_norm_before_train=2.200140 cos_to_last_merge=0.7993 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9237537106000921, 'auprc': 0.9994596686256048, 'loss_val': 0.19581096652230673, 'psi': 0.9540360938102972}-{'f1_val': 0.9933250006304741, 'auprc': 0.9995466455186165, 'loss_val': 0.026855309100159874, 'psi': 0.9958136585857311}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.162215 (no previous merge yet)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988157121036689, 'loss_val': 0.0195447727675793, 'psi': 0.9970223158599788}-{'f1_val': 0.9958267183641853, 'auprc': 0.9991933115669183, 'loss_val': 0.01934062656721131, 'psi': 0.9971733556452785}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.120812 cos_to_last_merge=0.9667 (last merge round=35)
[S10] round=71 local utility u=0.000011 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9932298610605637, 'loss_val': 0.02696985481156795, 'psi': 0.9944046478358504}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932213507132039, 'loss_val': 0.026965840215856962, 'psi': 0.9944012436969064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=71 head_norm_before_train=2.313756 (no previous merge yet)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.998066250535448, 'loss_val': 0.020001146978126372, 'psi': 0.9970096006954958}-{'f1_val': 0.996567470639547, 'auprc': 0.9984504926343473, 'loss_val': 0.0193323985093706, 'psi': 0.9973206794374672}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.970754 cos_to_last_merge=0.9945 (last merge round=41)
[S13] round=71 local utility u=0.221762 metrics={'f1_val': 0.6608635724061896, 'auprc': 0.7060733533889205, 'loss_val': 1.0692285336459018, 'psi': 0.678947484799282}-{'f1_val': 0.6267936156789661, 'auprc': 0.6761024667976892, 'loss_val': 1.2184193619758785, 'psi': 0.6465171561264553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=71 head_norm_before_train=1.723478 cos_to_last_merge=0.9658 (last merge round=36)
[S14] round=71 local utility u=0.001173 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9989469064384244, 'loss_val': 0.022483873003901134, 'psi': 0.998417527316902}-{'f1_val': 0.997844401637113, 'auprc': 0.99893069753876, 'loss_val': 0.02345944005675874, 'psi': 0.9982789199977717}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=71 head_norm_before_train=2.436151 (no previous merge yet)
[S15] round=71 local utility u=0.008487 metrics={'f1_val': 0.9853806569964317, 'auprc': 0.9952866880661065, 'loss_val': 0.03767072087048637, 'psi': 0.9893430694243016}-{'f1_val': 0.9832325130774054, 'auprc': 0.9952263724946344, 'loss_val': 0.04157461593133839, 'psi': 0.988030056844297}
[S15] not sending this round → trigger blocked (psi=0.989)
[S16] START round=71 head_norm_before_train=2.020799 cos_to_last_merge=0.7546 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.755
[S16] round=71 local utility u=0.010840 metrics={'f1_val': 0.9931673086796463, 'auprc': 0.9894496997694467, 'loss_val': 0.036932304611967885, 'psi': 0.9916802651155665}-{'f1_val': 0.9920135014807094, 'auprc': 0.9867790137704311, 'loss_val': 0.04367760144194269, 'psi': 0.9899197063965981}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=71 head_norm_before_train=2.216754 cos_to_last_merge=0.7696 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=71 local utility u=0.182444 metrics={'f1_val': 0.9066091211946896, 'auprc': 0.9809721957028339, 'loss_val': 0.4702283500316634, 'psi': 0.9363543509979473}-{'f1_val': 0.8899271978167521, 'auprc': 0.9367885634922507, 'loss_val': 0.6024736236893885, 'psi': 0.9086717440869515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=72 head_norm_before_train=2.209583 (no previous merge yet)
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.8284948988783498, 'auprc': 0.8949109122771277, 'loss_val': 0.3595960185183269, 'psi': 0.855061304237861}-{'f1_val': 0.9058329786125604, 'auprc': 0.9733229289150126, 'loss_val': 0.20786632064429794, 'psi': 0.9328289587335412}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.052526 cos_to_last_merge=0.9248 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.925
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.926605241391176, 'auprc': 0.996771930910557, 'loss_val': 0.25422084902000314, 'psi': 0.9546719171989284}-{'f1_val': 0.9345947525032497, 'auprc': 0.9982625770063702, 'loss_val': 0.2027626742919643, 'psi': 0.960061882304498}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.253608 (no previous merge yet)
[S4] round=72 local utility u=0.006596 metrics={'f1_val': 0.9550176414465241, 'auprc': 0.9395535492685438, 'loss_val': 0.3426055087825687, 'psi': 0.948832004575332}-{'f1_val': 0.954298549450138, 'auprc': 0.9341093870083292, 'loss_val': 0.3351498662875459, 'psi': 0.9462228844734146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=72 head_norm_before_train=1.885765 cos_to_last_merge=0.9822 (last merge round=35)
[S5] round=72 local utility u=0.008547 metrics={'f1_val': 0.6029476747002991, 'auprc': 0.8254996861365824, 'loss_val': 0.6325761166316218, 'psi': 0.6919684792748124}-{'f1_val': 0.6054970967071516, 'auprc': 0.8097550386815235, 'loss_val': 0.6177324555514331, 'psi': 0.6872002734969004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=72 head_norm_before_train=2.214635 cos_to_last_merge=0.9494 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.949
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.9048304140395829, 'auprc': 0.9549429328609277, 'loss_val': 0.24344795087931406, 'psi': 0.9248754215681207}-{'f1_val': 0.6930473916170423, 'auprc': 0.8732870915794215, 'loss_val': 0.9784853759822413, 'psi': 0.765143271601994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=72 head_norm_before_train=1.865607 cos_to_last_merge=0.9968 (last merge round=41)
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5973740091872796, 'auprc': 0.7943195768237263, 'loss_val': 0.7901656415012674, 'psi': 0.6761522362418583}-{'f1_val': 0.694975633235694, 'auprc': 0.8896237980252857, 'loss_val': 0.24427691017044675, 'psi': 0.7728348991515307}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.205734 cos_to_last_merge=0.7982 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=72 local utility u=0.294141 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9996466673739236, 'loss_val': 0.025772160725902746, 'psi': 0.9958790532139787}-{'f1_val': 0.9237537106000921, 'auprc': 0.9994596686256048, 'loss_val': 0.19581096652230673, 'psi': 0.9540360938102972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=72 head_norm_before_train=2.167640 (no previous merge yet)
[S9] round=72 local utility u=0.004531 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996728713252465, 'loss_val': 0.018057767388010237, 'psi': 0.9978654556184334}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988157121036689, 'loss_val': 0.0195447727675793, 'psi': 0.9970223158599788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=72 head_norm_before_train=2.125415 cos_to_last_merge=0.9662 (last merge round=35)
[S10] round=72 local utility u=0.001359 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940925881351053, 'loss_val': 0.02684081640020129, 'psi': 0.994749738665667}-{'f1_val': 0.9951878390193748, 'auprc': 0.9932298610605637, 'loss_val': 0.02696985481156795, 'psi': 0.9944046478358504}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=72 head_norm_before_train=2.319117 (no previous merge yet)
[S11] round=72 local utility u=0.001248 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984555855481716, 'loss_val': 0.020246034389638064, 'psi': 0.9973227166029969}-{'f1_val': 0.996305167468861, 'auprc': 0.998066250535448, 'loss_val': 0.020001146978126372, 'psi': 0.9970096006954958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=72 head_norm_before_train=1.973974 cos_to_last_merge=0.9943 (last merge round=41)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6623184345620448, 'auprc': 0.7121950344786766, 'loss_val': 1.1728470845119021, 'psi': 0.6822690745286975}-{'f1_val': 0.6608635724061896, 'auprc': 0.7060733533889205, 'loss_val': 1.0692285336459018, 'psi': 0.678947484799282}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.731584 cos_to_last_merge=0.9652 (last merge round=36)
[S14] round=72 local utility u=0.000407 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9990518446801107, 'loss_val': 0.021985544223204055, 'psi': 0.9984595026135765}-{'f1_val': 0.9980646079025537, 'auprc': 0.9989469064384244, 'loss_val': 0.022483873003901134, 'psi': 0.998417527316902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=72 head_norm_before_train=2.441490 (no previous merge yet)
[S15] round=72 local utility u=0.001699 metrics={'f1_val': 0.985808594582198, 'auprc': 0.9952087330831204, 'loss_val': 0.03660641312118108, 'psi': 0.989568649982567}-{'f1_val': 0.9853806569964317, 'auprc': 0.9952866880661065, 'loss_val': 0.03767072087048637, 'psi': 0.9893430694243016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=72 head_norm_before_train=2.026704 cos_to_last_merge=0.7543 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=72 local utility u=0.001965 metrics={'f1_val': 0.9929001652683519, 'auprc': 0.9917649122937215, 'loss_val': 0.03834439353426089, 'psi': 0.9924460640784998}-{'f1_val': 0.9931673086796463, 'auprc': 0.9894496997694467, 'loss_val': 0.036932304611967885, 'psi': 0.9916802651155665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=72 head_norm_before_train=2.220313 cos_to_last_merge=0.7692 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.8251668407968044, 'auprc': 0.9079859506711754, 'loss_val': 0.7499185197599642, 'psi': 0.8582944847465528}-{'f1_val': 0.9066091211946896, 'auprc': 0.9809721957028339, 'loss_val': 0.4702283500316634, 'psi': 0.9363543509979473}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.210650 (no previous merge yet)
[S2] round=73 local utility u=0.154435 metrics={'f1_val': 0.8328201968557273, 'auprc': 0.9933973530274657, 'loss_val': 0.3721377904184243, 'psi': 0.8970510593244226}-{'f1_val': 0.8284948988783498, 'auprc': 0.8949109122771277, 'loss_val': 0.3595960185183269, 'psi': 0.855061304237861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=73 head_norm_before_train=2.058061 cos_to_last_merge=0.9243 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=73 local utility u=0.260597 metrics={'f1_val': 0.9787708982971787, 'auprc': 0.9985831051095949, 'loss_val': 0.05145445499100094, 'psi': 0.9866957810221452}-{'f1_val': 0.926605241391176, 'auprc': 0.996771930910557, 'loss_val': 0.25422084902000314, 'psi': 0.9546719171989284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=73 head_norm_before_train=2.256333 (no previous merge yet)
[S4] round=73 local utility u=0.042673 metrics={'f1_val': 0.9566302354564709, 'auprc': 0.9644039132480772, 'loss_val': 0.341486613578002, 'psi': 0.9597397065731134}-{'f1_val': 0.9550176414465241, 'auprc': 0.9395535492685438, 'loss_val': 0.3426055087825687, 'psi': 0.948832004575332}
[S4] not sending this round → trigger blocked (psi=0.960)
[S5] START round=73 head_norm_before_train=1.891576 cos_to_last_merge=0.9818 (last merge round=35)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.4362261667741541, 'auprc': 0.8538235567599596, 'loss_val': 1.2324518316255755, 'psi': 0.6032651227684762}-{'f1_val': 0.6029476747002991, 'auprc': 0.8254996861365824, 'loss_val': 0.6325761166316218, 'psi': 0.6919684792748124}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=2.231397 cos_to_last_merge=0.9480 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.8252571666926767, 'auprc': 0.9556814137139454, 'loss_val': 0.28066942330092265, 'psi': 0.8774268655011842}-{'f1_val': 0.9048304140395829, 'auprc': 0.9549429328609277, 'loss_val': 0.24344795087931406, 'psi': 0.9248754215681207}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.869042 cos_to_last_merge=0.9966 (last merge round=41)
[S7] round=73 local utility u=0.286703 metrics={'f1_val': 0.6438486021761927, 'auprc': 0.8050900657385525, 'loss_val': 0.5279189122759963, 'psi': 0.7083451876011366}-{'f1_val': 0.5973740091872796, 'auprc': 0.7943195768237263, 'loss_val': 0.7901656415012674, 'psi': 0.6761522362418583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=73 head_norm_before_train=2.214109 cos_to_last_merge=0.7978 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9710356706072059, 'auprc': 0.9992792025274028, 'loss_val': 0.08271706873508569, 'psi': 0.9823330833752846}-{'f1_val': 0.9933673104406822, 'auprc': 0.9996466673739236, 'loss_val': 0.025772160725902746, 'psi': 0.9958790532139787}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.173187 (no previous merge yet)
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9976847708928701, 'loss_val': 0.018487513534574774, 'psi': 0.9970702154454829}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996728713252465, 'loss_val': 0.018057767388010237, 'psi': 0.9978654556184334}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=2.131355 cos_to_last_merge=0.9657 (last merge round=35)
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.99408091532506, 'loss_val': 0.026811555433161216, 'psi': 0.9947450695416489}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940925881351053, 'loss_val': 0.02684081640020129, 'psi': 0.994749738665667}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.325140 (no previous merge yet)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983038012789714, 'loss_val': 0.020566389894857734, 'psi': 0.9972620028953167}-{'f1_val': 0.996567470639547, 'auprc': 0.9984555855481716, 'loss_val': 0.020246034389638064, 'psi': 0.9973227166029969}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.979765 cos_to_last_merge=0.9940 (last merge round=41)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6253893967894182, 'auprc': 0.746235836495389, 'loss_val': 1.240057505336515, 'psi': 0.6737279726718065}-{'f1_val': 0.6623184345620448, 'auprc': 0.7121950344786766, 'loss_val': 1.1728470845119021, 'psi': 0.6822690745286975}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=1.739426 cos_to_last_merge=0.9646 (last merge round=36)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9991458562625344, 'loss_val': 0.021503370523953583, 'psi': 0.9983649834872815}-{'f1_val': 0.9980646079025537, 'auprc': 0.9990518446801107, 'loss_val': 0.021985544223204055, 'psi': 0.9984595026135765}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.446812 (no previous merge yet)
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9836632781139562, 'auprc': 0.9950862867610231, 'loss_val': 0.040290060676134526, 'psi': 0.988232481572783}-{'f1_val': 0.985808594582198, 'auprc': 0.9952087330831204, 'loss_val': 0.03660641312118108, 'psi': 0.989568649982567}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=2.033499 cos_to_last_merge=0.7540 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9924624549696315, 'auprc': 0.9905151563812078, 'loss_val': 0.0391211917945747, 'psi': 0.991683535534262}-{'f1_val': 0.9929001652683519, 'auprc': 0.9917649122937215, 'loss_val': 0.03834439353426089, 'psi': 0.9924460640784998}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.225344 cos_to_last_merge=0.7689 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=73 local utility u=0.401886 metrics={'f1_val': 0.8987231482389901, 'auprc': 0.9515956015689294, 'loss_val': 0.5183127228996157, 'psi': 0.9198721295709659}-{'f1_val': 0.8251668407968044, 'auprc': 0.9079859506711754, 'loss_val': 0.7499185197599642, 'psi': 0.8582944847465528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=74 head_norm_before_train=2.217691 (no previous merge yet)
[S2] round=74 local utility u=0.022469 metrics={'f1_val': 0.8325550621509242, 'auprc': 0.992030916024944, 'loss_val': 0.321510356520313, 'psi': 0.8963454037005322}-{'f1_val': 0.8328201968557273, 'auprc': 0.9933973530274657, 'loss_val': 0.3721377904184243, 'psi': 0.8970510593244226}
[S2] not sending this round → trigger blocked (psi=0.896)
[S3] START round=74 head_norm_before_train=2.063138 cos_to_last_merge=0.9238 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=74 local utility u=0.071558 metrics={'f1_val': 0.9969869110332736, 'auprc': 0.9991058857034918, 'loss_val': 0.01920249955170904, 'psi': 0.9978345009013608}-{'f1_val': 0.9787708982971787, 'auprc': 0.9985831051095949, 'loss_val': 0.05145445499100094, 'psi': 0.9866957810221452}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=74 head_norm_before_train=2.255229 (no previous merge yet)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9552496592397042, 'auprc': 0.9424430016000063, 'loss_val': 0.3454571344192345, 'psi': 0.950126996183825}-{'f1_val': 0.9566302354564709, 'auprc': 0.9644039132480772, 'loss_val': 0.341486613578002, 'psi': 0.9597397065731134}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.897585 cos_to_last_merge=0.9813 (last merge round=35)
[S5] round=74 local utility u=1.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9891060477647854, 'loss_val': 0.2976916023488107, 'psi': 0.8158869520378425}-{'f1_val': 0.4362261667741541, 'auprc': 0.8538235567599596, 'loss_val': 1.2324518316255755, 'psi': 0.6032651227684762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=74 head_norm_before_train=2.247307 cos_to_last_merge=0.9465 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.7279782083920556, 'auprc': 0.8846814826310794, 'loss_val': 0.9048870023364002, 'psi': 0.7906595180876652}-{'f1_val': 0.8252571666926767, 'auprc': 0.9556814137139454, 'loss_val': 0.28066942330092265, 'psi': 0.8774268655011842}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.872081 cos_to_last_merge=0.9964 (last merge round=41)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6278961159653831, 'auprc': 0.8007452807279797, 'loss_val': 0.6097928607074511, 'psi': 0.6970357818704217}-{'f1_val': 0.6438486021761927, 'auprc': 0.8050900657385525, 'loss_val': 0.5279189122759963, 'psi': 0.7083451876011366}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.216626 cos_to_last_merge=0.7971 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=74 local utility u=0.092369 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9996038650577794, 'loss_val': 0.030750317327633857, 'psi': 0.9956426207147842}-{'f1_val': 0.9710356706072059, 'auprc': 0.9992792025274028, 'loss_val': 0.08271706873508569, 'psi': 0.9823330833752846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=74 head_norm_before_train=2.175662 (no previous merge yet)
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9988148731423031, 'loss_val': 0.01842493102897598, 'psi': 0.9967754487788927}-{'f1_val': 0.9966605118138915, 'auprc': 0.9976847708928701, 'loss_val': 0.018487513534574774, 'psi': 0.9970702154454829}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=2.137936 cos_to_last_merge=0.9652 (last merge round=35)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940503967158285, 'loss_val': 0.026807407978630994, 'psi': 0.9947328620979563}-{'f1_val': 0.9951878390193748, 'auprc': 0.99408091532506, 'loss_val': 0.026811555433161216, 'psi': 0.9947450695416489}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=74 head_norm_before_train=2.331556 (no previous merge yet)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998070516024053, 'loss_val': 0.020039449925051318, 'psi': 0.9971686887933494}-{'f1_val': 0.996567470639547, 'auprc': 0.9983038012789714, 'loss_val': 0.020566389894857734, 'psi': 0.9972620028953167}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.989337 cos_to_last_merge=0.9934 (last merge round=41)
[S13] round=74 local utility u=0.162194 metrics={'f1_val': 0.6319282892789415, 'auprc': 0.8141148806026246, 'loss_val': 1.158540720874348, 'psi': 0.7048029258084147}-{'f1_val': 0.6253893967894182, 'auprc': 0.746235836495389, 'loss_val': 1.240057505336515, 'psi': 0.6737279726718065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=74 head_norm_before_train=1.746801 cos_to_last_merge=0.9640 (last merge round=36)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9360686471552662, 'auprc': 0.9991496024488234, 'loss_val': 0.11880184002458188, 'psi': 0.9613010292726891}-{'f1_val': 0.997844401637113, 'auprc': 0.9991458562625344, 'loss_val': 0.021503370523953583, 'psi': 0.9983649834872815}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.451933 (no previous merge yet)
[S15] round=74 local utility u=0.016111 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9952182590675128, 'loss_val': 0.03412372669248082, 'psi': 0.9908512856503625}-{'f1_val': 0.9836632781139562, 'auprc': 0.9950862867610231, 'loss_val': 0.040290060676134526, 'psi': 0.988232481572783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=74 head_norm_before_train=2.040472 cos_to_last_merge=0.7538 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.754
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9920251888873803, 'auprc': 0.9909987709565016, 'loss_val': 0.03930429229688109, 'psi': 0.9916146217150288}-{'f1_val': 0.9924624549696315, 'auprc': 0.9905151563812078, 'loss_val': 0.0391211917945747, 'psi': 0.991683535534262}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.232140 cos_to_last_merge=0.7684 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.9013158040358711, 'auprc': 0.9392729631764558, 'loss_val': 0.5727119264843226, 'psi': 0.916498667692105}-{'f1_val': 0.8987231482389901, 'auprc': 0.9515956015689294, 'loss_val': 0.5183127228996157, 'psi': 0.9198721295709659}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.223135 (no previous merge yet)
[S2] round=75 local utility u=0.282563 metrics={'f1_val': 0.9131509713350301, 'auprc': 0.9895234598642445, 'loss_val': 0.23243644846897052, 'psi': 0.9436999667467159}-{'f1_val': 0.8325550621509242, 'auprc': 0.992030916024944, 'loss_val': 0.321510356520313, 'psi': 0.8963454037005322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=75 head_norm_before_train=2.068776 cos_to_last_merge=0.9232 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=75 local utility u=0.001088 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9985714830498571, 'loss_val': 0.017891215525561333, 'psi': 0.9978675346875773}-{'f1_val': 0.9969869110332736, 'auprc': 0.9991058857034918, 'loss_val': 0.01920249955170904, 'psi': 0.9978345009013608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=75 head_norm_before_train=2.261937 (no previous merge yet)
[S4] round=75 local utility u=0.004029 metrics={'f1_val': 0.9545803430367853, 'auprc': 0.9483795549817068, 'loss_val': 0.35119318415508527, 'psi': 0.952100027814754}-{'f1_val': 0.9552496592397042, 'auprc': 0.9424430016000063, 'loss_val': 0.3454571344192345, 'psi': 0.950126996183825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=75 head_norm_before_train=1.901837 cos_to_last_merge=0.9810 (last merge round=35)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.700407554886547, 'auprc': 0.9811515641308625, 'loss_val': 0.3409936877902766, 'psi': 0.8127051585842733}-{'f1_val': 0.700407554886547, 'auprc': 0.9891060477647854, 'loss_val': 0.2976916023488107, 'psi': 0.8158869520378425}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=2.261668 cos_to_last_merge=0.9451 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=75 local utility u=0.336837 metrics={'f1_val': 0.7741888493917128, 'auprc': 0.9181529935368663, 'loss_val': 0.6088920010297345, 'psi': 0.8317745070497742}-{'f1_val': 0.7279782083920556, 'auprc': 0.8846814826310794, 'loss_val': 0.9048870023364002, 'psi': 0.7906595180876652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=75 head_norm_before_train=1.875727 cos_to_last_merge=0.9963 (last merge round=41)
[S7] round=75 local utility u=0.099960 metrics={'f1_val': 0.6409604079869192, 'auprc': 0.8052756031285713, 'loss_val': 0.5018505353614503, 'psi': 0.70668648604358}-{'f1_val': 0.6278961159653831, 'auprc': 0.8007452807279797, 'loss_val': 0.6097928607074511, 'psi': 0.6970357818704217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=75 head_norm_before_train=2.218037 cos_to_last_merge=0.7968 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=75 local utility u=0.003692 metrics={'f1_val': 0.9936117456418484, 'auprc': 0.9996608145171488, 'loss_val': 0.027195904280782134, 'psi': 0.9960313731919685}-{'f1_val': 0.9930017911527874, 'auprc': 0.9996038650577794, 'loss_val': 0.030750317327633857, 'psi': 0.9956426207147842}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=75 head_norm_before_train=2.179419 (no previous merge yet)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9988130845507495, 'loss_val': 0.02050896501476474, 'psi': 0.9968710691508086}-{'f1_val': 0.9954158325366191, 'auprc': 0.9988148731423031, 'loss_val': 0.01842493102897598, 'psi': 0.9967754487788927}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=2.143545 cos_to_last_merge=0.9647 (last merge round=35)
[S10] round=75 local utility u=0.000148 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9941353087563944, 'loss_val': 0.026765931105537353, 'psi': 0.9947668269141826}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940503967158285, 'loss_val': 0.026807407978630994, 'psi': 0.9947328620979563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=75 head_norm_before_train=2.335862 (no previous merge yet)
[S11] round=75 local utility u=0.000123 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981683718541983, 'loss_val': 0.02008725600247198, 'psi': 0.9972078311254076}-{'f1_val': 0.996567470639547, 'auprc': 0.998070516024053, 'loss_val': 0.020039449925051318, 'psi': 0.9971686887933494}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=75 head_norm_before_train=1.996626 cos_to_last_merge=0.9929 (last merge round=41)
[S13] round=75 local utility u=0.407601 metrics={'f1_val': 0.7316021784898179, 'auprc': 0.85422604231934, 'loss_val': 1.06171631566192, 'psi': 0.7806517240216267}-{'f1_val': 0.6319282892789415, 'auprc': 0.8141148806026246, 'loss_val': 1.158540720874348, 'psi': 0.7048029258084147}
[S13] not sending this round → trigger blocked (psi=0.781)
[S14] START round=75 head_norm_before_train=1.752394 cos_to_last_merge=0.9636 (last merge round=36)
[S14] round=75 local utility u=0.214244 metrics={'f1_val': 0.993262166629685, 'auprc': 0.9992296137401604, 'loss_val': 0.03371462809878575, 'psi': 0.9956491454738752}-{'f1_val': 0.9360686471552662, 'auprc': 0.9991496024488234, 'loss_val': 0.11880184002458188, 'psi': 0.9613010292726891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=75 head_norm_before_train=2.457087 (no previous merge yet)
[S15] round=75 local utility u=0.016881 metrics={'f1_val': 0.993000306567307, 'auprc': 0.995327198152752, 'loss_val': 0.031050040669459787, 'psi': 0.9939310632014849}-{'f1_val': 0.987939970038929, 'auprc': 0.9952182590675128, 'loss_val': 0.03412372669248082, 'psi': 0.9908512856503625}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=75 head_norm_before_train=2.044305 cos_to_last_merge=0.7533 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9904618928877846, 'auprc': 0.9853585944743026, 'loss_val': 0.05017653581666545, 'psi': 0.9884205735223918}-{'f1_val': 0.9920251888873803, 'auprc': 0.9909987709565016, 'loss_val': 0.03930429229688109, 'psi': 0.9916146217150288}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=2.236029 cos_to_last_merge=0.7681 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.9000121438496931, 'auprc': 0.9416867773314739, 'loss_val': 0.5874629223988201, 'psi': 0.9166819972424054}-{'f1_val': 0.9013158040358711, 'auprc': 0.9392729631764558, 'loss_val': 0.5727119264843226, 'psi': 0.916498667692105}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.225358 (no previous merge yet)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.8326086707286486, 'auprc': 0.9932754493800573, 'loss_val': 0.39088546411961816, 'psi': 0.8968753821892121}-{'f1_val': 0.9131509713350301, 'auprc': 0.9895234598642445, 'loss_val': 0.23243644846897052, 'psi': 0.9436999667467159}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.074774 cos_to_last_merge=0.9225 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.923
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.9757292309175276, 'auprc': 0.9980188913625516, 'loss_val': 0.0713447861467152, 'psi': 0.9846450950955372}-{'f1_val': 0.9973982357793907, 'auprc': 0.9985714830498571, 'loss_val': 0.017891215525561333, 'psi': 0.9978675346875773}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=2.266310 (no previous merge yet)
[S4] round=76 local utility u=0.030205 metrics={'f1_val': 0.9563879917677622, 'auprc': 0.9635105749219279, 'loss_val': 0.34702242877944717, 'psi': 0.9592370250294285}-{'f1_val': 0.9545803430367853, 'auprc': 0.9483795549817068, 'loss_val': 0.35119318415508527, 'psi': 0.952100027814754}
[S4] not sending this round → trigger blocked (psi=0.959)
[S5] START round=76 head_norm_before_train=1.903132 cos_to_last_merge=0.9809 (last merge round=35)
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.6680255271047637, 'auprc': 0.8614087975367655, 'loss_val': 0.4522748034227619, 'psi': 0.7453788352775644}-{'f1_val': 0.700407554886547, 'auprc': 0.9811515641308625, 'loss_val': 0.3409936877902766, 'psi': 0.8127051585842733}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=2.277773 cos_to_last_merge=0.9436 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.7790486129861124, 'auprc': 0.9229122083175585, 'loss_val': 0.7879683556652997, 'psi': 0.8365940511186909}-{'f1_val': 0.7741888493917128, 'auprc': 0.9181529935368663, 'loss_val': 0.6088920010297345, 'psi': 0.8317745070497742}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.878491 cos_to_last_merge=0.9962 (last merge round=41)
[S7] round=76 local utility u=0.033332 metrics={'f1_val': 0.6459026187816566, 'auprc': 0.8070983955122846, 'loss_val': 0.4703078691687515, 'psi': 0.7103809294739077}-{'f1_val': 0.6409604079869192, 'auprc': 0.8052756031285713, 'loss_val': 0.5018505353614503, 'psi': 0.70668648604358}
[S7] not sending this round → trigger blocked (psi=0.710)
[S8] START round=76 head_norm_before_train=2.226428 cos_to_last_merge=0.7963 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.796
[S8] round=76 local utility u=0.000000 metrics={'f1_val': 0.9619044542827555, 'auprc': 0.9994142956932738, 'loss_val': 0.12123784902281537, 'psi': 0.9769083908469628}-{'f1_val': 0.9936117456418484, 'auprc': 0.9996608145171488, 'loss_val': 0.027195904280782134, 'psi': 0.9960313731919685}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=76 head_norm_before_train=2.183406 (no previous merge yet)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9947918175458434, 'loss_val': 0.0185766187222991, 'psi': 0.9956667838859039}-{'f1_val': 0.9955763922175147, 'auprc': 0.9988130845507495, 'loss_val': 0.02050896501476474, 'psi': 0.9968710691508086}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.148335 cos_to_last_merge=0.9642 (last merge round=35)
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937154978774382, 'loss_val': 0.02678241070730658, 'psi': 0.9945989025626001}-{'f1_val': 0.9951878390193748, 'auprc': 0.9941353087563944, 'loss_val': 0.026765931105537353, 'psi': 0.9947668269141826}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.339544 (no previous merge yet)
[S11] round=76 local utility u=0.000913 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9984598255464086, 'loss_val': 0.01913548058231381, 'psi': 0.9973244126022917}-{'f1_val': 0.996567470639547, 'auprc': 0.9981683718541983, 'loss_val': 0.02008725600247198, 'psi': 0.9972078311254076}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=76 head_norm_before_train=2.001177 cos_to_last_merge=0.9925 (last merge round=41)
[S13] round=76 local utility u=0.085591 metrics={'f1_val': 0.729210157011537, 'auprc': 0.8254885947728094, 'loss_val': 0.7899695962823824, 'psi': 0.767721532116046}-{'f1_val': 0.7316021784898179, 'auprc': 0.85422604231934, 'loss_val': 1.06171631566192, 'psi': 0.7806517240216267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S13] sending update (kind=head size=1808 to 1 peers)
[S14] START round=76 head_norm_before_train=1.757708 cos_to_last_merge=0.9632 (last merge round=36)
[S14] round=76 local utility u=0.014391 metrics={'f1_val': 0.9972135067804855, 'auprc': 0.9974730240769927, 'loss_val': 0.023370423687336363, 'psi': 0.9973173136990884}-{'f1_val': 0.993262166629685, 'auprc': 0.9992296137401604, 'loss_val': 0.03371462809878575, 'psi': 0.9956491454738752}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=76 head_norm_before_train=2.461986 (no previous merge yet)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.987939970038929, 'auprc': 0.9952768140944275, 'loss_val': 0.0342097562944361, 'psi': 0.9908747076611284}-{'f1_val': 0.993000306567307, 'auprc': 0.995327198152752, 'loss_val': 0.031050040669459787, 'psi': 0.9939310632014849}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.045562 cos_to_last_merge=0.7527 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.753
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9405638243810737, 'auprc': 0.9755849874815787, 'loss_val': 0.38017760068451867, 'psi': 0.9545722896212756}-{'f1_val': 0.9904618928877846, 'auprc': 0.9853585944743026, 'loss_val': 0.05017653581666545, 'psi': 0.9884205735223918}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.243606 cos_to_last_merge=0.7675 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=76 local utility u=0.048538 metrics={'f1_val': 0.9044239128305296, 'auprc': 0.9523145110828612, 'loss_val': 0.5487414344731374, 'psi': 0.9235801521314623}-{'f1_val': 0.9000121438496931, 'auprc': 0.9416867773314739, 'loss_val': 0.5874629223988201, 'psi': 0.9166819972424054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=77 head_norm_before_train=2.230826 (no previous merge yet)
[S2] round=77 local utility u=0.052966 metrics={'f1_val': 0.8346913048814382, 'auprc': 0.9906398583507802, 'loss_val': 0.28954278433762504, 'psi': 0.897070726269175}-{'f1_val': 0.8326086707286486, 'auprc': 0.9932754493800573, 'loss_val': 0.39088546411961816, 'psi': 0.8968753821892121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=77 head_norm_before_train=2.078728 cos_to_last_merge=0.9219 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.9497757343489067, 'auprc': 0.9962411524965836, 'loss_val': 0.14791892457813144, 'psi': 0.9683619016079774}-{'f1_val': 0.9757292309175276, 'auprc': 0.9980188913625516, 'loss_val': 0.0713447861467152, 'psi': 0.9846450950955372}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=2.271079 (no previous merge yet)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9553707863620323, 'auprc': 0.9583603449739397, 'loss_val': 0.3574093414560525, 'psi': 0.9565666098067953}-{'f1_val': 0.9563879917677622, 'auprc': 0.9635105749219279, 'loss_val': 0.34702242877944717, 'psi': 0.9592370250294285}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.903825 cos_to_last_merge=0.9806 (last merge round=35)
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.6444083602452435, 'auprc': 0.8820754412995331, 'loss_val': 0.42958078845976994, 'psi': 0.7394751926669594}-{'f1_val': 0.6680255271047637, 'auprc': 0.8614087975367655, 'loss_val': 0.4522748034227619, 'psi': 0.7453788352775644}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=2.289479 cos_to_last_merge=0.9426 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.943
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.701516009944085, 'auprc': 0.844407412468279, 'loss_val': 1.065394885598795, 'psi': 0.7586725709537626}-{'f1_val': 0.7790486129861124, 'auprc': 0.9229122083175585, 'loss_val': 0.7879683556652997, 'psi': 0.8365940511186909}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.882887 cos_to_last_merge=0.9961 (last merge round=41)
[S7] round=77 local utility u=0.195328 metrics={'f1_val': 0.6791759302353161, 'auprc': 0.8343612731242254, 'loss_val': 0.3610813043105662, 'psi': 0.7412500673908798}-{'f1_val': 0.6459026187816566, 'auprc': 0.8070983955122846, 'loss_val': 0.4703078691687515, 'psi': 0.7103809294739077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=77 head_norm_before_train=2.231103 cos_to_last_merge=0.7955 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=77 local utility u=0.142095 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9996734670509502, 'loss_val': 0.02660177160183626, 'psi': 0.9958897730847893}-{'f1_val': 0.9619044542827555, 'auprc': 0.9994142956932738, 'loss_val': 0.12123784902281537, 'psi': 0.9769083908469628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=77 head_norm_before_train=2.188209 (no previous merge yet)
[S9] round=77 local utility u=0.003340 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959832568821555, 'loss_val': 0.017933899198676828, 'psi': 0.9963896098411971}-{'f1_val': 0.9962500947792776, 'auprc': 0.9947918175458434, 'loss_val': 0.0185766187222991, 'psi': 0.9956667838859039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=77 head_norm_before_train=2.152905 cos_to_last_merge=0.9637 (last merge round=35)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993656512809816, 'loss_val': 0.026775615273202335, 'psi': 0.9945753085355513}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937154978774382, 'loss_val': 0.02678241070730658, 'psi': 0.9945989025626001}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=2.338328 (no previous merge yet)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984679388225968, 'loss_val': 0.01935791590986776, 'psi': 0.9969345578048256}-{'f1_val': 0.996567470639547, 'auprc': 0.9984598255464086, 'loss_val': 0.01913548058231381, 'psi': 0.9973244126022917}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=2.005208 cos_to_last_merge=0.9920 (last merge round=41)
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.6880881796619863, 'auprc': 0.8427117958917583, 'loss_val': 1.1465656996197393, 'psi': 0.7499376261538951}-{'f1_val': 0.729210157011537, 'auprc': 0.8254885947728094, 'loss_val': 0.7899695962823824, 'psi': 0.767721532116046}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=1.763763 cos_to_last_merge=0.9628 (last merge round=36)
[S14] round=77 local utility u=0.006642 metrics={'f1_val': 0.9980651139537664, 'auprc': 0.9991356734888949, 'loss_val': 0.020184823903996642, 'psi': 0.9984933377678178}-{'f1_val': 0.9972135067804855, 'auprc': 0.9974730240769927, 'loss_val': 0.023370423687336363, 'psi': 0.9973173136990884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=77 head_norm_before_train=2.466945 (no previous merge yet)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9832325130774054, 'auprc': 0.9952080731528703, 'loss_val': 0.0408991005564743, 'psi': 0.9880227371075914}-{'f1_val': 0.987939970038929, 'auprc': 0.9952768140944275, 'loss_val': 0.0342097562944361, 'psi': 0.9908747076611284}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.046382 cos_to_last_merge=0.7519 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.752
[S16] round=77 local utility u=0.343268 metrics={'f1_val': 0.9929330073233207, 'auprc': 0.9850360900777294, 'loss_val': 0.036210827328380636, 'psi': 0.9897742404250841}-{'f1_val': 0.9405638243810737, 'auprc': 0.9755849874815787, 'loss_val': 0.38017760068451867, 'psi': 0.9545722896212756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=77 head_norm_before_train=2.250165 cos_to_last_merge=0.7669 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.9005702007520848, 'auprc': 0.9452717886373202, 'loss_val': 0.5501155670896317, 'psi': 0.9184508359061789}-{'f1_val': 0.9044239128305296, 'auprc': 0.9523145110828612, 'loss_val': 0.5487414344731374, 'psi': 0.9235801521314623}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.232972 (no previous merge yet)
[S2] round=78 local utility u=0.158850 metrics={'f1_val': 0.8809133675148101, 'auprc': 0.9890630389462485, 'loss_val': 0.24444416567884178, 'psi': 0.9241732360873854}-{'f1_val': 0.8346913048814382, 'auprc': 0.9906398583507802, 'loss_val': 0.28954278433762504, 'psi': 0.897070726269175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S2] sending update (kind=head size=1790 to 1 peers)
[S3] START round=78 head_norm_before_train=2.084362 cos_to_last_merge=0.9212 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.9482889797810685, 'auprc': 0.9957648058218661, 'loss_val': 0.1733915191634527, 'psi': 0.9672793101973876}-{'f1_val': 0.9497757343489067, 'auprc': 0.9962411524965836, 'loss_val': 0.14791892457813144, 'psi': 0.9683619016079774}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.265012 (no previous merge yet)
[S4] round=78 local utility u=0.005824 metrics={'f1_val': 0.9553290774591987, 'auprc': 0.9611352970317395, 'loss_val': 0.3538354937462138, 'psi': 0.9576515652882149}-{'f1_val': 0.9553707863620323, 'auprc': 0.9583603449739397, 'loss_val': 0.3574093414560525, 'psi': 0.9565666098067953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=78 head_norm_before_train=1.906719 cos_to_last_merge=0.9804 (last merge round=35)
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.6060051207041341, 'auprc': 0.8177914461907928, 'loss_val': 0.6693770248324411, 'psi': 0.6907196508987976}-{'f1_val': 0.6444083602452435, 'auprc': 0.8820754412995331, 'loss_val': 0.42958078845976994, 'psi': 0.7394751926669594}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.305509 cos_to_last_merge=0.9411 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.941
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.9493511139798113, 'auprc': 0.9745721503818026, 'loss_val': 0.13858937918477623, 'psi': 0.9594395285406079}-{'f1_val': 0.701516009944085, 'auprc': 0.844407412468279, 'loss_val': 1.065394885598795, 'psi': 0.7586725709537626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=78 head_norm_before_train=1.888446 cos_to_last_merge=0.9958 (last merge round=41)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.626247738883483, 'auprc': 0.7997293929798812, 'loss_val': 0.6846283296383321, 'psi': 0.6956404005220422}-{'f1_val': 0.6791759302353161, 'auprc': 0.8343612731242254, 'loss_val': 0.3610813043105662, 'psi': 0.7412500673908798}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=2.237555 cos_to_last_merge=0.7949 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.976088789817456, 'auprc': 0.9993914551239224, 'loss_val': 0.06978954240158479, 'psi': 0.9854098559400425}-{'f1_val': 0.9933673104406822, 'auprc': 0.9996734670509502, 'loss_val': 0.02660177160183626, 'psi': 0.9958897730847893}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.193135 (no previous merge yet)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9974112668821151, 'loss_val': 0.05037389183359323, 'psi': 0.9912513094427231}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959832568821555, 'loss_val': 0.017933899198676828, 'psi': 0.9963896098411971}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=2.157569 cos_to_last_merge=0.9632 (last merge round=35)
[S10] round=78 local utility u=0.001120 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943716476420661, 'loss_val': 0.026680934759293836, 'psi': 0.9948613624684512}-{'f1_val': 0.9951878390193748, 'auprc': 0.993656512809816, 'loss_val': 0.026775615273202335, 'psi': 0.9945753085355513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=78 head_norm_before_train=2.340732 (no previous merge yet)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9896284318413406, 'auprc': 0.9985262988633288, 'loss_val': 0.04087871947562607, 'psi': 0.9931875786501358}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984679388225968, 'loss_val': 0.01935791590986776, 'psi': 0.9969345578048256}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=2.006032 cos_to_last_merge=0.9916 (last merge round=41)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6542587062838625, 'auprc': 0.825145794226181, 'loss_val': 1.1605299653041692, 'psi': 0.7226135414607899}-{'f1_val': 0.6880881796619863, 'auprc': 0.8427117958917583, 'loss_val': 1.1465656996197393, 'psi': 0.7499376261538951}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.769407 cos_to_last_merge=0.9623 (last merge round=36)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9992296412461668, 'loss_val': 0.020280524462026123, 'psi': 0.9981520385608226}-{'f1_val': 0.9980651139537664, 'auprc': 0.9991356734888949, 'loss_val': 0.020184823903996642, 'psi': 0.9984933377678178}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.471690 (no previous merge yet)
[S15] round=78 local utility u=0.006018 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9952266142316405, 'loss_val': 0.039236772161705236, 'psi': 0.9890619412019341}-{'f1_val': 0.9832325130774054, 'auprc': 0.9952080731528703, 'loss_val': 0.0408991005564743, 'psi': 0.9880227371075914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=78 head_norm_before_train=2.045478 cos_to_last_merge=0.7511 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.751
[S16] round=78 local utility u=0.005533 metrics={'f1_val': 0.9920251888873803, 'auprc': 0.991091784168302, 'loss_val': 0.037865456325264175, 'psi': 0.991651826999749}-{'f1_val': 0.9929330073233207, 'auprc': 0.9850360900777294, 'loss_val': 0.036210827328380636, 'psi': 0.9897742404250841}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=78 head_norm_before_train=2.254798 cos_to_last_merge=0.7665 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.767
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.8719369069953311, 'auprc': 0.9107882744731794, 'loss_val': 0.6697093242432183, 'psi': 0.8874774539864705}-{'f1_val': 0.9005702007520848, 'auprc': 0.9452717886373202, 'loss_val': 0.5501155670896317, 'psi': 0.9184508359061789}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.236347 (no previous merge yet)
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.8324098482076738, 'auprc': 0.9779141434653839, 'loss_val': 0.3860441749263916, 'psi': 0.8906115663107579}-{'f1_val': 0.8809133675148101, 'auprc': 0.9890630389462485, 'loss_val': 0.24444416567884178, 'psi': 0.9241732360873854}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.891 u=0.0000 p_local=0.0813 f1=0.832 auprc=0.978 bytes=59307
[S3] START round=79 head_norm_before_train=2.090741 cos_to_last_merge=0.9205 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=79 local utility u=0.035823 metrics={'f1_val': 0.9552659905648231, 'auprc': 0.9958940252043373, 'loss_val': 0.14399462410265618, 'psi': 0.9715172044206288}-{'f1_val': 0.9482889797810685, 'auprc': 0.9957648058218661, 'loss_val': 0.1733915191634527, 'psi': 0.9672793101973876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=80 psi=0.972 u=0.0358 p_local=0.0625 f1=0.955 auprc=0.996 bytes=61247
[S4] START round=79 head_norm_before_train=2.269110 (no previous merge yet)
[S4] round=79 local utility u=0.005774 metrics={'f1_val': 0.955474353703597, 'auprc': 0.9641115198749253, 'loss_val': 0.35208782242798986, 'psi': 0.9589292201721283}-{'f1_val': 0.9553290774591987, 'auprc': 0.9611352970317395, 'loss_val': 0.3538354937462138, 'psi': 0.9576515652882149}
[S4] not sending this round → trigger blocked (psi=0.959)
[S4] r=80 psi=0.959 u=0.0058 p_local=0.0090 f1=0.955 auprc=0.964 bytes=62966
[S5] START round=79 head_norm_before_train=1.909883 cos_to_last_merge=0.9804 (last merge round=35)
[S5] round=79 local utility u=0.991682 metrics={'f1_val': 0.7813783119178614, 'auprc': 0.9814535301063854, 'loss_val': 0.2292388205221887, 'psi': 0.8614083991932711}-{'f1_val': 0.6060051207041341, 'auprc': 0.8177914461907928, 'loss_val': 0.6693770248324411, 'psi': 0.6907196508987976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S5] r=80 psi=0.861 u=0.9917 p_local=0.3068 f1=0.781 auprc=0.981 bytes=61199
[S6] START round=79 head_norm_before_train=2.321327 cos_to_last_merge=0.9397 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.7177072004383694, 'auprc': 0.7937950721920832, 'loss_val': 1.105716593074702, 'psi': 0.748142349139855}-{'f1_val': 0.9493511139798113, 'auprc': 0.9745721503818026, 'loss_val': 0.13858937918477623, 'psi': 0.9594395285406079}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.748 u=0.0000 p_local=0.2636 f1=0.718 auprc=0.794 bytes=61215
[S7] START round=79 head_norm_before_train=1.892681 cos_to_last_merge=0.9956 (last merge round=41)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6176761630126322, 'auprc': 0.7960111117744564, 'loss_val': 0.7144870227304077, 'psi': 0.6890101425173618}-{'f1_val': 0.626247738883483, 'auprc': 0.7997293929798812, 'loss_val': 0.6846283296383321, 'psi': 0.6956404005220422}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.689 u=0.0000 p_local=0.1243 f1=0.618 auprc=0.796 bytes=63023
[S8] START round=79 head_norm_before_train=2.246979 cos_to_last_merge=0.7944 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=79 local utility u=0.055179 metrics={'f1_val': 0.9892110952630988, 'auprc': 0.9993860670618564, 'loss_val': 0.03814877514647243, 'psi': 0.9932810839826018}-{'f1_val': 0.976088789817456, 'auprc': 0.9993914551239224, 'loss_val': 0.06978954240158479, 'psi': 0.9854098559400425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S8] r=80 psi=0.993 u=0.0552 p_local=0.0517 f1=0.989 auprc=0.999 bytes=62956
[S9] START round=79 head_norm_before_train=2.197886 (no previous merge yet)
[S9] round=79 local utility u=0.044824 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9967562016931537, 'loss_val': 0.017008362524586873, 'psi': 0.9968140319326158}-{'f1_val': 0.9871446711497952, 'auprc': 0.9974112668821151, 'loss_val': 0.05037389183359323, 'psi': 0.9912513094427231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S9] r=80 psi=0.997 u=0.0448 p_local=0.0109 f1=0.997 auprc=0.997 bytes=59377
[S10] START round=79 head_norm_before_train=2.163460 cos_to_last_merge=0.9628 (last merge round=35)
[S10] round=79 local utility u=0.000213 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9944965847811894, 'loss_val': 0.026628835969085825, 'psi': 0.9949113373241005}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943716476420661, 'loss_val': 0.026680934759293836, 'psi': 0.9948613624684512}
[S10] not sending this round → trigger blocked (psi=0.995)
[S10] r=80 psi=0.995 u=0.0002 p_local=0.0003 f1=0.995 auprc=0.994 bytes=62977
[S11] START round=79 head_norm_before_train=2.344098 (no previous merge yet)
[S11] round=79 local utility u=0.010231 metrics={'f1_val': 0.9917725166776202, 'auprc': 0.9986332900476713, 'loss_val': 0.033602268004262775, 'psi': 0.9945168260256406}-{'f1_val': 0.9896284318413406, 'auprc': 0.9985262988633288, 'loss_val': 0.04087871947562607, 'psi': 0.9931875786501358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S11] r=80 psi=0.995 u=0.0102 p_local=0.0037 f1=0.992 auprc=0.999 bytes=53967
[S13] START round=79 head_norm_before_train=2.010549 cos_to_last_merge=0.9912 (last merge round=41)
[S13] round=79 local utility u=0.000000 metrics={'f1_val': 0.6233597676504439, 'auprc': 0.8244585865013214, 'loss_val': 1.2763770141145867, 'psi': 0.703799295190795}-{'f1_val': 0.6542587062838625, 'auprc': 0.825145794226181, 'loss_val': 1.1605299653041692, 'psi': 0.7226135414607899}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=80 psi=0.704 u=0.0000 p_local=0.0766 f1=0.623 auprc=0.824 bytes=61240
[S14] START round=79 head_norm_before_train=1.775709 cos_to_last_merge=0.9618 (last merge round=36)
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9575651640198508, 'auprc': 0.9992308536981, 'loss_val': 0.053586866901398154, 'psi': 0.9742314398911505}-{'f1_val': 0.9974336367705932, 'auprc': 0.9992296412461668, 'loss_val': 0.020280524462026123, 'psi': 0.9981520385608226}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.974 u=0.0000 p_local=0.0237 f1=0.958 auprc=0.999 bytes=70248
[S15] START round=79 head_norm_before_train=2.476476 (no previous merge yet)
[S15] round=79 local utility u=0.028326 metrics={'f1_val': 0.993000306567307, 'auprc': 0.995333338969064, 'loss_val': 0.03119291906510378, 'psi': 0.9939335195280097}-{'f1_val': 0.9849521591821299, 'auprc': 0.9952266142316405, 'loss_val': 0.039236772161705236, 'psi': 0.9890619412019341}
[S15] not sending this round → trigger blocked (psi=0.994)
[S15] r=80 psi=0.994 u=0.0283 p_local=0.0123 f1=0.993 auprc=0.995 bytes=55700
[S16] START round=79 head_norm_before_train=2.046481 cos_to_last_merge=0.7504 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=79 local utility u=0.003674 metrics={'f1_val': 0.9928078566199261, 'auprc': 0.9922050617102238, 'loss_val': 0.03855276890864181, 'psi': 0.9925667386560453}-{'f1_val': 0.9920251888873803, 'auprc': 0.991091784168302, 'loss_val': 0.037865456325264175, 'psi': 0.991651826999749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] r=80 psi=0.993 u=0.0037 p_local=0.0747 f1=0.993 auprc=0.992 bytes=57496
[S17] START round=79 head_norm_before_train=2.256464 cos_to_last_merge=0.7664 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=79 local utility u=0.117370 metrics={'f1_val': 0.8917090001044892, 'auprc': 0.9283805898447097, 'loss_val': 0.6063797414978234, 'psi': 0.9063776360005774}-{'f1_val': 0.8719369069953311, 'auprc': 0.9107882744731794, 'loss_val': 0.6697093242432183, 'psi': 0.8874774539864705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S17] r=80 psi=0.906 u=0.1174 p_local=0.0641 f1=0.892 auprc=0.928 bytes=61119
[S2] START round=80 head_norm_before_train=2.241096 (no previous merge yet)
[S2] round=80 local utility u=0.048849 metrics={'f1_val': 0.8302501173397937, 'auprc': 0.9912629050852185, 'loss_val': 0.31543440382607757, 'psi': 0.8946552324379636}-{'f1_val': 0.8324098482076738, 'auprc': 0.9779141434653839, 'loss_val': 0.3860441749263916, 'psi': 0.8906115663107579}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=80 head_norm_before_train=2.097637 cos_to_last_merge=0.9198 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=80 local utility u=0.046679 metrics={'f1_val': 0.9623374386406878, 'auprc': 0.996950246822257, 'loss_val': 0.09623458111683539, 'psi': 0.9761825619133155}-{'f1_val': 0.9552659905648231, 'auprc': 0.9958940252043373, 'loss_val': 0.14399462410265618, 'psi': 0.9715172044206288}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=80 head_norm_before_train=2.271466 (no previous merge yet)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9558154523920144, 'auprc': 0.937090933856936, 'loss_val': 0.34093174594244874, 'psi': 0.948325644977983}-{'f1_val': 0.955474353703597, 'auprc': 0.9641115198749253, 'loss_val': 0.35208782242798986, 'psi': 0.9589292201721283}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.914253 cos_to_last_merge=0.9802 (last merge round=35)
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.5806704061070593, 'auprc': 0.7255962509780012, 'loss_val': 0.8119717574787974, 'psi': 0.638640744055436}-{'f1_val': 0.7813783119178614, 'auprc': 0.9814535301063854, 'loss_val': 0.2292388205221887, 'psi': 0.8614083991932711}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=2.331704 cos_to_last_merge=0.9389 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=80 local utility u=0.220397 metrics={'f1_val': 0.789304575045398, 'auprc': 0.7217847827240587, 'loss_val': 0.8784756002269987, 'psi': 0.7622966581168622}-{'f1_val': 0.7177072004383694, 'auprc': 0.7937950721920832, 'loss_val': 1.105716593074702, 'psi': 0.748142349139855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=80 head_norm_before_train=1.896571 cos_to_last_merge=0.9955 (last merge round=41)
[S7] round=80 local utility u=0.452647 metrics={'f1_val': 0.686567049276671, 'auprc': 0.836330699342516, 'loss_val': 0.3434972986491597, 'psi': 0.746472509303009}-{'f1_val': 0.6176761630126322, 'auprc': 0.7960111117744564, 'loss_val': 0.7144870227304077, 'psi': 0.6890101425173618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=80 head_norm_before_train=2.249962 cos_to_last_merge=0.7939 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9857809572028757, 'auprc': 0.9996312154718898, 'loss_val': 0.04487075051975441, 'psi': 0.9913210605104814}-{'f1_val': 0.9892110952630988, 'auprc': 0.9993860670618564, 'loss_val': 0.03814877514647243, 'psi': 0.9932810839826018}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.201904 (no previous merge yet)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9944985741644916, 'loss_val': 0.017551869141156688, 'psi': 0.9958149244246539}-{'f1_val': 0.9968525854255906, 'auprc': 0.9967562016931537, 'loss_val': 0.017008362524586873, 'psi': 0.9968140319326158}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.169667 cos_to_last_merge=0.9623 (last merge round=35)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942213200767498, 'loss_val': 0.026673032078034765, 'psi': 0.9948012314423247}-{'f1_val': 0.9951878390193748, 'auprc': 0.9944965847811894, 'loss_val': 0.026628835969085825, 'psi': 0.9949113373241005}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.347697 (no previous merge yet)
[S11] round=80 local utility u=0.021509 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.9986938834057199, 'loss_val': 0.01955821934629454, 'psi': 0.9974203022295627}-{'f1_val': 0.9917725166776202, 'auprc': 0.9986332900476713, 'loss_val': 0.033602268004262775, 'psi': 0.9945168260256406}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=80 head_norm_before_train=2.015623 cos_to_last_merge=0.9908 (last merge round=41)
[S13] round=80 local utility u=0.213026 metrics={'f1_val': 0.6694034547134712, 'auprc': 0.8397794553976892, 'loss_val': 1.1725491718465952, 'psi': 0.7375538549871583}-{'f1_val': 0.6233597676504439, 'auprc': 0.8244585865013214, 'loss_val': 1.2763770141145867, 'psi': 0.703799295190795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=80 head_norm_before_train=1.781194 cos_to_last_merge=0.9614 (last merge round=36)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.942844389014313, 'auprc': 0.9992310666688771, 'loss_val': 0.07683554549793982, 'psi': 0.9653990600761386}-{'f1_val': 0.9575651640198508, 'auprc': 0.9992308536981, 'loss_val': 0.053586866901398154, 'psi': 0.9742314398911505}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.481159 (no previous merge yet)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.987939970038929, 'auprc': 0.995292286155779, 'loss_val': 0.03445358315170574, 'psi': 0.990880896485669}-{'f1_val': 0.993000306567307, 'auprc': 0.995333338969064, 'loss_val': 0.03119291906510378, 'psi': 0.9939335195280097}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.050823 cos_to_last_merge=0.7500 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9920251888873803, 'auprc': 0.9899699253591605, 'loss_val': 0.03902196136804123, 'psi': 0.9912030834760923}-{'f1_val': 0.9928078566199261, 'auprc': 0.9922050617102238, 'loss_val': 0.03855276890864181, 'psi': 0.9925667386560453}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=2.260883 cos_to_last_merge=0.7660 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.8837042165677941, 'auprc': 0.9218605463424863, 'loss_val': 0.6418188287456975, 'psi': 0.8989667484776709}-{'f1_val': 0.8917090001044892, 'auprc': 0.9283805898447097, 'loss_val': 0.6063797414978234, 'psi': 0.9063776360005774}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=2.242164 (no previous merge yet)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.8318327764744285, 'auprc': 0.9807788222742397, 'loss_val': 0.3683841350091899, 'psi': 0.891411194794353}-{'f1_val': 0.8302501173397937, 'auprc': 0.9912629050852185, 'loss_val': 0.31543440382607757, 'psi': 0.8946552324379636}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.104895 cos_to_last_merge=0.9190 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=81 local utility u=0.029965 metrics={'f1_val': 0.9704225392930954, 'auprc': 0.9973049432432592, 'loss_val': 0.08587956892080757, 'psi': 0.981175500873161}-{'f1_val': 0.9623374386406878, 'auprc': 0.996950246822257, 'loss_val': 0.09623458111683539, 'psi': 0.9761825619133155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=81 head_norm_before_train=2.274431 (no previous merge yet)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9552796807059443, 'auprc': 0.9327705635022947, 'loss_val': 0.346345341415744, 'psi': 0.9462760338244844}-{'f1_val': 0.9558154523920144, 'auprc': 0.937090933856936, 'loss_val': 0.34093174594244874, 'psi': 0.948325644977983}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.916382 cos_to_last_merge=0.9800 (last merge round=35)
[S5] round=81 local utility u=1.000000 metrics={'f1_val': 0.9181601137743767, 'auprc': 0.9961858016968208, 'loss_val': 0.13636551981249131, 'psi': 0.9493703889433543}-{'f1_val': 0.5806704061070593, 'auprc': 0.7255962509780012, 'loss_val': 0.8119717574787974, 'psi': 0.638640744055436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=81 head_norm_before_train=2.342675 cos_to_last_merge=0.9378 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=81 local utility u=0.552400 metrics={'f1_val': 0.8333137740922245, 'auprc': 0.93815910640737, 'loss_val': 0.6868543773038877, 'psi': 0.8752519070182827}-{'f1_val': 0.789304575045398, 'auprc': 0.7217847827240587, 'loss_val': 0.8784756002269987, 'psi': 0.7622966581168622}
[S6] not sending this round → trigger blocked (psi=0.875)
[S7] START round=81 head_norm_before_train=1.900036 cos_to_last_merge=0.9953 (last merge round=41)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6650505626650405, 'auprc': 0.8166047350659832, 'loss_val': 0.3928853506788151, 'psi': 0.7256722316254176}-{'f1_val': 0.686567049276671, 'auprc': 0.836330699342516, 'loss_val': 0.3434972986491597, 'psi': 0.746472509303009}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.254921 cos_to_last_merge=0.7940 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9821392478545178, 'auprc': 0.9960904980584828, 'loss_val': 0.054252642836738384, 'psi': 0.9877197479361037}-{'f1_val': 0.9857809572028757, 'auprc': 0.9996312154718898, 'loss_val': 0.04487075051975441, 'psi': 0.9913210605104814}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=2.202320 (no previous merge yet)
[S9] round=81 local utility u=0.007864 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.999152843804832, 'loss_val': 0.01674690742263682, 'psi': 0.9977726887772871}-{'f1_val': 0.9966924912647621, 'auprc': 0.9944985741644916, 'loss_val': 0.017551869141156688, 'psi': 0.9958149244246539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=81 head_norm_before_train=2.174763 cos_to_last_merge=0.9618 (last merge round=35)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9935253556820707, 'loss_val': 0.026738183319588812, 'psi': 0.994522845684453}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942213200767498, 'loss_val': 0.026673032078034765, 'psi': 0.9948012314423247}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.352428 (no previous merge yet)
[S11] round=81 local utility u=0.000137 metrics={'f1_val': 0.9965712481121245, 'auprc': 0.998657786793266, 'loss_val': 0.019175507432513984, 'psi': 0.9974058635845812}-{'f1_val': 0.9965712481121245, 'auprc': 0.9986938834057199, 'loss_val': 0.01955821934629454, 'psi': 0.9974203022295627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=81 head_norm_before_train=2.019887 cos_to_last_merge=0.9904 (last merge round=41)
[S13] round=81 local utility u=0.095127 metrics={'f1_val': 0.6876043572062196, 'auprc': 0.8437261513442251, 'loss_val': 1.1033409839357182, 'psi': 0.7500530748614218}-{'f1_val': 0.6694034547134712, 'auprc': 0.8397794553976892, 'loss_val': 1.1725491718465952, 'psi': 0.7375538549871583}
[S13] not sending this round → trigger blocked (psi=0.750)
[S14] START round=81 head_norm_before_train=1.787239 cos_to_last_merge=0.9610 (last merge round=36)
[S14] round=81 local utility u=0.163275 metrics={'f1_val': 0.9909167489097961, 'auprc': 0.9975375328743163, 'loss_val': 0.033638830419721294, 'psi': 0.9935650624956042}-{'f1_val': 0.942844389014313, 'auprc': 0.9992310666688771, 'loss_val': 0.07683554549793982, 'psi': 0.9653990600761386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=81 head_norm_before_train=2.485765 (no previous merge yet)
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.9862359745487574, 'auprc': 0.9952301819321443, 'loss_val': 0.03619671244444851, 'psi': 0.9898336575021122}-{'f1_val': 0.987939970038929, 'auprc': 0.995292286155779, 'loss_val': 0.03445358315170574, 'psi': 0.990880896485669}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=2.056248 cos_to_last_merge=0.7498 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.8767057284167048, 'auprc': 0.9199374191895406, 'loss_val': 0.7626563138610978, 'psi': 0.8939984047258391}-{'f1_val': 0.9920251888873803, 'auprc': 0.9899699253591605, 'loss_val': 0.03902196136804123, 'psi': 0.9912030834760923}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=2.266340 cos_to_last_merge=0.7657 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=81 local utility u=0.135864 metrics={'f1_val': 0.9025289526944862, 'auprc': 0.9483184428241398, 'loss_val': 0.5624127711231781, 'psi': 0.9208447487463476}-{'f1_val': 0.8837042165677941, 'auprc': 0.9218605463424863, 'loss_val': 0.6418188287456975, 'psi': 0.8989667484776709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] sending update (kind=head size=1792 to 1 peers)
[S2] START round=82 head_norm_before_train=2.239359 (no previous merge yet)
[S2] round=82 local utility u=0.178961 metrics={'f1_val': 0.8987531454913531, 'auprc': 0.9308487899769656, 'loss_val': 0.26219417236726855, 'psi': 0.9115914032855982}-{'f1_val': 0.8318327764744285, 'auprc': 0.9807788222742397, 'loss_val': 0.3683841350091899, 'psi': 0.891411194794353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=82 head_norm_before_train=2.109946 cos_to_last_merge=0.9183 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.939030389820468, 'auprc': 0.9810068039083137, 'loss_val': 0.21897342485685797, 'psi': 0.9558209554556063}-{'f1_val': 0.9704225392930954, 'auprc': 0.9973049432432592, 'loss_val': 0.08587956892080757, 'psi': 0.981175500873161}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.284226 (no previous merge yet)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9550726068181776, 'auprc': 0.9297415581678439, 'loss_val': 0.3662405023140274, 'psi': 0.9449401873580441}-{'f1_val': 0.9552796807059443, 'auprc': 0.9327705635022947, 'loss_val': 0.346345341415744, 'psi': 0.9462760338244844}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=1.917387 cos_to_last_merge=0.9799 (last merge round=35)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.617847219786106, 'auprc': 0.7339515452783976, 'loss_val': 0.700324508223872, 'psi': 0.6642889499830227}-{'f1_val': 0.9181601137743767, 'auprc': 0.9961858016968208, 'loss_val': 0.13636551981249131, 'psi': 0.9493703889433543}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.351397 cos_to_last_merge=0.9370 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.937
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.7527833001608819, 'auprc': 0.7478855218675866, 'loss_val': 1.0517129862726908, 'psi': 0.7508241888435638}-{'f1_val': 0.8333137740922245, 'auprc': 0.93815910640737, 'loss_val': 0.6868543773038877, 'psi': 0.8752519070182827}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.903484 cos_to_last_merge=0.9951 (last merge round=41)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6477239282737698, 'auprc': 0.8056001729574569, 'loss_val': 0.503904056662874, 'psi': 0.7108744261472446}-{'f1_val': 0.6650505626650405, 'auprc': 0.8166047350659832, 'loss_val': 0.3928853506788151, 'psi': 0.7256722316254176}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=2.262255 cos_to_last_merge=0.7941 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=82 local utility u=0.059170 metrics={'f1_val': 0.9949006242050206, 'auprc': 0.9994902522283883, 'loss_val': 0.02268076585669976, 'psi': 0.9967364754143676}-{'f1_val': 0.9821392478545178, 'auprc': 0.9960904980584828, 'loss_val': 0.054252642836738384, 'psi': 0.9877197479361037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=82 head_norm_before_train=2.205293 (no previous merge yet)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9988108134627149, 'loss_val': 0.05000311776552115, 'psi': 0.9920860691913623}-{'f1_val': 0.9968525854255906, 'auprc': 0.999152843804832, 'loss_val': 0.01674690742263682, 'psi': 0.9977726887772871}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.177588 cos_to_last_merge=0.9614 (last merge round=35)
[S10] round=82 local utility u=0.000828 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940566939089525, 'loss_val': 0.026676734330675644, 'psi': 0.9947353809752058}-{'f1_val': 0.9951878390193748, 'auprc': 0.9935253556820707, 'loss_val': 0.026738183319588812, 'psi': 0.994522845684453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=82 head_norm_before_train=2.358234 (no previous merge yet)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.947434005471632, 'auprc': 0.9981685838991541, 'loss_val': 0.2618818235493274, 'psi': 0.9677278368426409}-{'f1_val': 0.9965712481121245, 'auprc': 0.998657786793266, 'loss_val': 0.019175507432513984, 'psi': 0.9974058635845812}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.024315 cos_to_last_merge=0.9901 (last merge round=41)
[S13] round=82 local utility u=0.353974 metrics={'f1_val': 0.7496993505557209, 'auprc': 0.8612701635429909, 'loss_val': 0.8205949771811841, 'psi': 0.7943276757506289}-{'f1_val': 0.6876043572062196, 'auprc': 0.8437261513442251, 'loss_val': 1.1033409839357182, 'psi': 0.7500530748614218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=82 head_norm_before_train=1.793108 cos_to_last_merge=0.9606 (last merge round=36)
[S14] round=82 local utility u=0.030021 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9992286047996684, 'loss_val': 0.02023641079669142, 'psi': 0.9983980829021352}-{'f1_val': 0.9909167489097961, 'auprc': 0.9975375328743163, 'loss_val': 0.033638830419721294, 'psi': 0.9935650624956042}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=82 head_norm_before_train=2.490333 (no previous merge yet)
[S15] round=82 local utility u=0.001755 metrics={'f1_val': 0.986662799494812, 'auprc': 0.9952940574678963, 'loss_val': 0.03543924633677053, 'psi': 0.9901153026840457}-{'f1_val': 0.9862359745487574, 'auprc': 0.9952301819321443, 'loss_val': 0.03619671244444851, 'psi': 0.9898336575021122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=82 head_norm_before_train=2.061910 cos_to_last_merge=0.7496 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.750
[S16] round=82 local utility u=0.751164 metrics={'f1_val': 0.9798180452553334, 'auprc': 0.9870892949064689, 'loss_val': 0.08045777048074851, 'psi': 0.9827265451157876}-{'f1_val': 0.8767057284167048, 'auprc': 0.9199374191895406, 'loss_val': 0.7626563138610978, 'psi': 0.8939984047258391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=82 head_norm_before_train=2.271946 cos_to_last_merge=0.7655 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=82 local utility u=0.013514 metrics={'f1_val': 0.9044545181275557, 'auprc': 0.9523463363069429, 'loss_val': 0.559021957949162, 'psi': 0.9236112453993106}-{'f1_val': 0.9025289526944862, 'auprc': 0.9483184428241398, 'loss_val': 0.5624127711231781, 'psi': 0.9208447487463476}
[S17] not sending this round → trigger blocked (psi=0.924)
[S2] START round=83 head_norm_before_train=2.245984 (no previous merge yet)
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.8337788109880551, 'auprc': 0.9754359455904565, 'loss_val': 0.34911545905718994, 'psi': 0.8904416648290157}-{'f1_val': 0.8987531454913531, 'auprc': 0.9308487899769656, 'loss_val': 0.26219417236726855, 'psi': 0.9115914032855982}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.112346 cos_to_last_merge=0.9177 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.918
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.846712342879233, 'auprc': 0.9966194730208007, 'loss_val': 0.46362060898967994, 'psi': 0.90667519493586}-{'f1_val': 0.939030389820468, 'auprc': 0.9810068039083137, 'loss_val': 0.21897342485685797, 'psi': 0.9558209554556063}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.285704 (no previous merge yet)
[S4] round=83 local utility u=0.033612 metrics={'f1_val': 0.9559855864459269, 'auprc': 0.9428145453509785, 'loss_val': 0.3437135691945118, 'psi': 0.9507171700079475}-{'f1_val': 0.9550726068181776, 'auprc': 0.9297415581678439, 'loss_val': 0.3662405023140274, 'psi': 0.9449401873580441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=83 head_norm_before_train=1.918176 cos_to_last_merge=0.9799 (last merge round=35)
[S5] round=83 local utility u=1.000000 metrics={'f1_val': 0.8213684708782191, 'auprc': 0.9946945035834991, 'loss_val': 0.16837302717535468, 'psi': 0.8906988839603311}-{'f1_val': 0.617847219786106, 'auprc': 0.7339515452783976, 'loss_val': 0.700324508223872, 'psi': 0.6642889499830227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=83 head_norm_before_train=2.358971 cos_to_last_merge=0.9365 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.6029657915998038, 'auprc': 0.6757744796822128, 'loss_val': 1.5183322225447913, 'psi': 0.6320892668327673}-{'f1_val': 0.7527833001608819, 'auprc': 0.7478855218675866, 'loss_val': 1.0517129862726908, 'psi': 0.7508241888435638}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.906168 cos_to_last_merge=0.9950 (last merge round=41)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6107633250816256, 'auprc': 0.793748069813394, 'loss_val': 0.8110468892722666, 'psi': 0.6839572229743329}-{'f1_val': 0.6477239282737698, 'auprc': 0.8056001729574569, 'loss_val': 0.503904056662874, 'psi': 0.7108744261472446}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=2.269145 cos_to_last_merge=0.7939 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.8899161825085452, 'auprc': 0.9972710726730791, 'loss_val': 0.32780211091275996, 'psi': 0.9328581385743588}-{'f1_val': 0.9949006242050206, 'auprc': 0.9994902522283883, 'loss_val': 0.02268076585669976, 'psi': 0.9967364754143676}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=2.208886 (no previous merge yet)
[S9] round=83 local utility u=0.042149 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9973118835176694, 'loss_val': 0.016705610910710156, 'psi': 0.9970363046624221}-{'f1_val': 0.9876029063437939, 'auprc': 0.9988108134627149, 'loss_val': 0.05000311776552115, 'psi': 0.9920860691913623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=83 head_norm_before_train=2.181382 cos_to_last_merge=0.9609 (last merge round=35)
[S10] round=83 local utility u=0.000361 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942886054038164, 'loss_val': 0.026649625620979778, 'psi': 0.9948281455731514}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940566939089525, 'loss_val': 0.026676734330675644, 'psi': 0.9947353809752058}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=83 head_norm_before_train=2.363694 (no previous merge yet)
[S11] round=83 local utility u=0.268191 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9986629398566711, 'loss_val': 0.020355799097311746, 'psi': 0.9972628222392828}-{'f1_val': 0.947434005471632, 'auprc': 0.9981685838991541, 'loss_val': 0.2618818235493274, 'psi': 0.9677278368426409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=83 head_norm_before_train=2.034730 cos_to_last_merge=0.9896 (last merge round=41)
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6141187981384746, 'auprc': 0.6853927185921889, 'loss_val': 1.4507337788243473, 'psi': 0.6426283663199603}-{'f1_val': 0.7496993505557209, 'auprc': 0.8612701635429909, 'loss_val': 0.8205949771811841, 'psi': 0.7943276757506289}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=1.799713 cos_to_last_merge=0.9602 (last merge round=36)
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9992241077251884, 'loss_val': 0.022917776251949063, 'psi': 0.9979036566966223}-{'f1_val': 0.997844401637113, 'auprc': 0.9992286047996684, 'loss_val': 0.02023641079669142, 'psi': 0.9983980829021352}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.494825 (no previous merge yet)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9849521591821299, 'auprc': 0.9952168211078667, 'loss_val': 0.03960410061728682, 'psi': 0.9890580239524245}-{'f1_val': 0.986662799494812, 'auprc': 0.9952940574678963, 'loss_val': 0.03543924633677053, 'psi': 0.9901153026840457}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.067634 cos_to_last_merge=0.7495 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.749
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9465657967981798, 'auprc': 0.9817986836232405, 'loss_val': 0.21156595341049342, 'psi': 0.9606589515282041}-{'f1_val': 0.9798180452553334, 'auprc': 0.9870892949064689, 'loss_val': 0.08045777048074851, 'psi': 0.9827265451157876}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=2.278731 cos_to_last_merge=0.7651 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.8926614400686679, 'auprc': 0.934411744495816, 'loss_val': 0.5944660212621017, 'psi': 0.9093615618395271}-{'f1_val': 0.9044545181275557, 'auprc': 0.9523463363069429, 'loss_val': 0.559021957949162, 'psi': 0.9236112453993106}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.255457 (no previous merge yet)
[S2] round=84 local utility u=0.011380 metrics={'f1_val': 0.830399705355895, 'auprc': 0.9925662540136819, 'loss_val': 0.3574718831262583, 'psi': 0.8952663248190098}-{'f1_val': 0.8337788109880551, 'auprc': 0.9754359455904565, 'loss_val': 0.34911545905718994, 'psi': 0.8904416648290157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=84 head_norm_before_train=2.116338 cos_to_last_merge=0.9171 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.8462775686643208, 'auprc': 0.9974525983138155, 'loss_val': 0.49852076093073, 'psi': 0.9067475805241186}-{'f1_val': 0.846712342879233, 'auprc': 0.9966194730208007, 'loss_val': 0.46362060898967994, 'psi': 0.90667519493586}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.290890 (no previous merge yet)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.956353954962913, 'auprc': 0.9395752304418962, 'loss_val': 0.3468299797913118, 'psi': 0.9496424651545063}-{'f1_val': 0.9559855864459269, 'auprc': 0.9428145453509785, 'loss_val': 0.3437135691945118, 'psi': 0.9507171700079475}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.919257 cos_to_last_merge=0.9799 (last merge round=35)
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.43671700517611844, 'auprc': 0.8545327075645677, 'loss_val': 1.289977658048136, 'psi': 0.6038432861314982}-{'f1_val': 0.8213684708782191, 'auprc': 0.9946945035834991, 'loss_val': 0.16837302717535468, 'psi': 0.8906988839603311}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.366097 cos_to_last_merge=0.9359 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=84 local utility u=1.000000 metrics={'f1_val': 0.8393691220421022, 'auprc': 0.937661061760636, 'loss_val': 0.6414910761250475, 'psi': 0.8786858979295158}-{'f1_val': 0.6029657915998038, 'auprc': 0.6757744796822128, 'loss_val': 1.5183322225447913, 'psi': 0.6320892668327673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=84 head_norm_before_train=1.908229 cos_to_last_merge=0.9948 (last merge round=41)
[S7] round=84 local utility u=0.235214 metrics={'f1_val': 0.6350919266631012, 'auprc': 0.802744838454918, 'loss_val': 0.5135801817319283, 'psi': 0.702153091379828}-{'f1_val': 0.6107633250816256, 'auprc': 0.793748069813394, 'loss_val': 0.8110468892722666, 'psi': 0.6839572229743329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=84 head_norm_before_train=2.272369 cos_to_last_merge=0.7934 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=84 local utility u=0.471302 metrics={'f1_val': 0.9953935680944039, 'auprc': 0.9994978729942665, 'loss_val': 0.024742562314568773, 'psi': 0.997035290054349}-{'f1_val': 0.8899161825085452, 'auprc': 0.9972710726730791, 'loss_val': 0.32780211091275996, 'psi': 0.9328581385743588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=84 head_norm_before_train=2.213980 (no previous merge yet)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9948033631163444, 'loss_val': 0.01708026610345933, 'psi': 0.9959176523348726}-{'f1_val': 0.9968525854255906, 'auprc': 0.9973118835176694, 'loss_val': 0.016705610910710156, 'psi': 0.9970363046624221}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.186699 cos_to_last_merge=0.9605 (last merge round=35)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942433317148234, 'loss_val': 0.026637039198618227, 'psi': 0.9948100360975543}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942886054038164, 'loss_val': 0.026649625620979778, 'psi': 0.9948281455731514}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.367856 (no previous merge yet)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9986436197269405, 'loss_val': 0.020352290272282202, 'psi': 0.9972550941873904}-{'f1_val': 0.9963294104943571, 'auprc': 0.9986629398566711, 'loss_val': 0.020355799097311746, 'psi': 0.9972628222392828}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.044544 cos_to_last_merge=0.9892 (last merge round=41)
[S13] round=84 local utility u=0.378867 metrics={'f1_val': 0.6667992615836857, 'auprc': 0.7625280907611389, 'loss_val': 1.2404883256761425, 'psi': 0.7050907932546671}-{'f1_val': 0.6141187981384746, 'auprc': 0.6853927185921889, 'loss_val': 1.4507337788243473, 'psi': 0.6426283663199603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=84 head_norm_before_train=1.806167 cos_to_last_merge=0.9597 (last merge round=36)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9992195988355019, 'loss_val': 0.02331758619748291, 'psi': 0.9979018531407478}-{'f1_val': 0.9970233560109115, 'auprc': 0.9992241077251884, 'loss_val': 0.022917776251949063, 'psi': 0.9979036566966223}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.499250 (no previous merge yet)
[S15] round=84 local utility u=0.007244 metrics={'f1_val': 0.986662799494812, 'auprc': 0.9952825223656399, 'loss_val': 0.035576470021360544, 'psi': 0.990110688643143}-{'f1_val': 0.9849521591821299, 'auprc': 0.9952168211078667, 'loss_val': 0.03960410061728682, 'psi': 0.9890580239524245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=84 head_norm_before_train=2.070683 cos_to_last_merge=0.7491 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.749
[S16] round=84 local utility u=0.101162 metrics={'f1_val': 0.9657443637943074, 'auprc': 0.9800550338230136, 'loss_val': 0.11908215542034407, 'psi': 0.9714686318057899}-{'f1_val': 0.9465657967981798, 'auprc': 0.9817986836232405, 'loss_val': 0.21156595341049342, 'psi': 0.9606589515282041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=84 head_norm_before_train=2.279392 cos_to_last_merge=0.7650 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=84 local utility u=0.008036 metrics={'f1_val': 0.8956030559075978, 'auprc': 0.9345227190591576, 'loss_val': 0.5963762913523818, 'psi': 0.9111709211682217}-{'f1_val': 0.8926614400686679, 'auprc': 0.934411744495816, 'loss_val': 0.5944660212621017, 'psi': 0.9093615618395271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=85 head_norm_before_train=2.260265 (no previous merge yet)
[S2] round=85 local utility u=0.306772 metrics={'f1_val': 0.9108488870465598, 'auprc': 0.9878196460612959, 'loss_val': 0.21238221505180432, 'psi': 0.9416371906524542}-{'f1_val': 0.830399705355895, 'auprc': 0.9925662540136819, 'loss_val': 0.3574718831262583, 'psi': 0.8952663248190098}
[S2] not sending this round → trigger blocked (psi=0.942)
[S3] START round=85 head_norm_before_train=2.122511 cos_to_last_merge=0.9165 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=85 local utility u=0.033777 metrics={'f1_val': 0.8527351595170376, 'auprc': 0.9966720184054008, 'loss_val': 0.46736965185201196, 'psi': 0.9103099030723829}-{'f1_val': 0.8462775686643208, 'auprc': 0.9974525983138155, 'loss_val': 0.49852076093073, 'psi': 0.9067475805241186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=85 head_norm_before_train=2.299995 (no previous merge yet)
[S4] round=85 local utility u=0.020052 metrics={'f1_val': 0.9566086049071322, 'auprc': 0.951825590117829, 'loss_val': 0.34500583033433607, 'psi': 0.9546953989914109}-{'f1_val': 0.956353954962913, 'auprc': 0.9395752304418962, 'loss_val': 0.3468299797913118, 'psi': 0.9496424651545063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=85 head_norm_before_train=1.920600 cos_to_last_merge=0.9799 (last merge round=35)
[S5] round=85 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9969569258788786, 'loss_val': 0.1640900449619479, 'psi': 0.8189755608118997}-{'f1_val': 0.43671700517611844, 'auprc': 0.8545327075645677, 'loss_val': 1.289977658048136, 'psi': 0.6038432861314982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=85 head_norm_before_train=2.370574 cos_to_last_merge=0.9354 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=85 local utility u=0.041706 metrics={'f1_val': 0.8026026738929151, 'auprc': 0.9429133646590643, 'loss_val': 0.35323635726596997, 'psi': 0.8587269501993747}-{'f1_val': 0.8393691220421022, 'auprc': 0.937661061760636, 'loss_val': 0.6414910761250475, 'psi': 0.8786858979295158}
[S6] not sending this round → trigger blocked (psi=0.859)
[S7] START round=85 head_norm_before_train=1.909792 cos_to_last_merge=0.9947 (last merge round=41)
[S7] round=85 local utility u=0.072239 metrics={'f1_val': 0.6583859872112078, 'auprc': 0.8064957970796252, 'loss_val': 0.5201187777230677, 'psi': 0.7176299111585747}-{'f1_val': 0.6350919266631012, 'auprc': 0.802744838454918, 'loss_val': 0.5135801817319283, 'psi': 0.702153091379828}
[S7] not sending this round → trigger blocked (psi=0.718)
[S8] START round=85 head_norm_before_train=2.275520 cos_to_last_merge=0.7934 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.902041311260608, 'auprc': 0.999532475254088, 'loss_val': 0.2637154852102909, 'psi': 0.9410377768579999}-{'f1_val': 0.9953935680944039, 'auprc': 0.9994978729942665, 'loss_val': 0.024742562314568773, 'psi': 0.997035290054349}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=2.219500 (no previous merge yet)
[S9] round=85 local utility u=0.003111 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9969978095074454, 'loss_val': 0.017440611682777208, 'psi': 0.9967954308913131}-{'f1_val': 0.9966605118138915, 'auprc': 0.9948033631163444, 'loss_val': 0.01708026610345933, 'psi': 0.9959176523348726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=85 head_norm_before_train=2.191083 cos_to_last_merge=0.9601 (last merge round=35)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.993955726773616, 'loss_val': 0.02665137824173317, 'psi': 0.9946949941210712}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942433317148234, 'loss_val': 0.026637039198618227, 'psi': 0.9948100360975543}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.372343 (no previous merge yet)
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.8748745822620206, 'auprc': 0.9822231784059027, 'loss_val': 0.7074496428547101, 'psi': 0.9178140207195734}-{'f1_val': 0.9963294104943571, 'auprc': 0.9986436197269405, 'loss_val': 0.020352290272282202, 'psi': 0.9972550941873904}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.050591 cos_to_last_merge=0.9889 (last merge round=41)
[S13] round=85 local utility u=0.510120 metrics={'f1_val': 0.742136166655083, 'auprc': 0.8517252105011621, 'loss_val': 0.9398606294382501, 'psi': 0.7859717841935147}-{'f1_val': 0.6667992615836857, 'auprc': 0.7625280907611389, 'loss_val': 1.2404883256761425, 'psi': 0.7050907932546671}
[S13] not sending this round → trigger blocked (psi=0.786)
[S14] START round=85 head_norm_before_train=1.809442 cos_to_last_merge=0.9594 (last merge round=36)
[S14] round=85 local utility u=0.000236 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9992254210018938, 'loss_val': 0.02273076246998202, 'psi': 0.9978909767059407}-{'f1_val': 0.9970233560109115, 'auprc': 0.9992195988355019, 'loss_val': 0.02331758619748291, 'psi': 0.9979018531407478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=85 head_norm_before_train=2.503637 (no previous merge yet)
[S15] round=85 local utility u=0.007723 metrics={'f1_val': 0.9887886891363633, 'auprc': 0.995322326076662, 'loss_val': 0.033005732610567926, 'psi': 0.9914021439124827}-{'f1_val': 0.986662799494812, 'auprc': 0.9952825223656399, 'loss_val': 0.035576470021360544, 'psi': 0.990110688643143}
[S15] not sending this round → trigger blocked (psi=0.991)
[S16] START round=85 head_norm_before_train=2.070943 cos_to_last_merge=0.7485 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.749
[S16] round=85 local utility u=0.135582 metrics={'f1_val': 0.9935888275773034, 'auprc': 0.9867161465445837, 'loss_val': 0.03496862931587912, 'psi': 0.9908397551642156}-{'f1_val': 0.9657443637943074, 'auprc': 0.9800550338230136, 'loss_val': 0.11908215542034407, 'psi': 0.9714686318057899}
[S16] not sending this round → trigger blocked (psi=0.991)
[S17] START round=85 head_norm_before_train=2.280004 cos_to_last_merge=0.7648 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=85 local utility u=0.087811 metrics={'f1_val': 0.9076076269102737, 'auprc': 0.958270209447275, 'loss_val': 0.5640239471731832, 'psi': 0.9278726599250743}-{'f1_val': 0.8956030559075978, 'auprc': 0.9345227190591576, 'loss_val': 0.5963762913523818, 'psi': 0.9111709211682217}
[S17] not sending this round → trigger blocked (psi=0.928)
[S2] START round=86 head_norm_before_train=2.265403 (no previous merge yet)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.8313976827929278, 'auprc': 0.9930226688089008, 'loss_val': 0.3613942604862373, 'psi': 0.896047677199317}-{'f1_val': 0.9108488870465598, 'auprc': 0.9878196460612959, 'loss_val': 0.21238221505180432, 'psi': 0.9416371906524542}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.128147 cos_to_last_merge=0.9160 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=86 local utility u=0.233975 metrics={'f1_val': 0.9020177978435089, 'auprc': 0.9970905113363515, 'loss_val': 0.29637097646798255, 'psi': 0.9400468832406459}-{'f1_val': 0.8527351595170376, 'auprc': 0.9966720184054008, 'loss_val': 0.46736965185201196, 'psi': 0.9103099030723829}
[S3] not sending this round → trigger blocked (psi=0.940)
[S4] START round=86 head_norm_before_train=2.306444 (no previous merge yet)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9557025930879361, 'auprc': 0.9377847720815446, 'loss_val': 0.3479061833959988, 'psi': 0.9485354646853795}-{'f1_val': 0.9566086049071322, 'auprc': 0.951825590117829, 'loss_val': 0.34500583033433607, 'psi': 0.9546953989914109}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.922861 cos_to_last_merge=0.9798 (last merge round=35)
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.436667805632789, 'auprc': 0.8516063962093647, 'loss_val': 1.2975359475769008, 'psi': 0.6026432418634193}-{'f1_val': 0.7003213174339138, 'auprc': 0.9969569258788786, 'loss_val': 0.1640900449619479, 'psi': 0.8189755608118997}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.381783 cos_to_last_merge=0.9344 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.7032604163842167, 'auprc': 0.8488902891170574, 'loss_val': 1.0824002390447218, 'psi': 0.761512365477353}-{'f1_val': 0.8026026738929151, 'auprc': 0.9429133646590643, 'loss_val': 0.35323635726596997, 'psi': 0.8587269501993747}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.913528 cos_to_last_merge=0.9945 (last merge round=41)
[S7] round=86 local utility u=0.383439 metrics={'f1_val': 0.7291557644913618, 'auprc': 0.8548308498511091, 'loss_val': 0.32286545433026587, 'psi': 0.7794257986352607}-{'f1_val': 0.6583859872112078, 'auprc': 0.8064957970796252, 'loss_val': 0.5201187777230677, 'psi': 0.7176299111585747}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=86 head_norm_before_train=2.283281 cos_to_last_merge=0.7936 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=86 local utility u=0.358356 metrics={'f1_val': 0.9850737047007152, 'auprc': 0.9993122036075868, 'loss_val': 0.044536344171036565, 'psi': 0.9907691042634639}-{'f1_val': 0.902041311260608, 'auprc': 0.999532475254088, 'loss_val': 0.2637154852102909, 'psi': 0.9410377768579999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=86 head_norm_before_train=2.220777 (no previous merge yet)
[S9] round=86 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9999487775912713, 'loss_val': 0.018909699316408055, 'psi': 0.99722901055848}-{'f1_val': 0.9966605118138915, 'auprc': 0.9969978095074454, 'loss_val': 0.017440611682777208, 'psi': 0.9967954308913131}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=86 head_norm_before_train=2.195298 cos_to_last_merge=0.9596 (last merge round=35)
[S10] round=86 local utility u=0.000609 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9943571832758875, 'loss_val': 0.026637772334100654, 'psi': 0.9948555767219798}-{'f1_val': 0.9951878390193748, 'auprc': 0.993955726773616, 'loss_val': 0.02665137824173317, 'psi': 0.9946949941210712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=86 head_norm_before_train=2.376437 (no previous merge yet)
[S11] round=86 local utility u=0.729253 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997723525649351, 'loss_val': 0.021547772661386563, 'psi': 0.9966245129808888}-{'f1_val': 0.8748745822620206, 'auprc': 0.9822231784059027, 'loss_val': 0.7074496428547101, 'psi': 0.9178140207195734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=86 head_norm_before_train=2.057854 cos_to_last_merge=0.9886 (last merge round=41)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.7382313675371581, 'auprc': 0.8662684247477324, 'loss_val': 1.1323407433518546, 'psi': 0.7894461904213879}-{'f1_val': 0.742136166655083, 'auprc': 0.8517252105011621, 'loss_val': 0.9398606294382501, 'psi': 0.7859717841935147}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.811579 cos_to_last_merge=0.9592 (last merge round=36)
[S14] round=86 local utility u=0.000301 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9992276549927811, 'loss_val': 0.022134939631105043, 'psi': 0.9978918703022956}-{'f1_val': 0.9970013471753054, 'auprc': 0.9992254210018938, 'loss_val': 0.02273076246998202, 'psi': 0.9978909767059407}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=86 head_norm_before_train=2.507951 (no previous merge yet)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.985808594582198, 'auprc': 0.9952547684706763, 'loss_val': 0.036829762568545324, 'psi': 0.9895870641375893}-{'f1_val': 0.9887886891363633, 'auprc': 0.995322326076662, 'loss_val': 0.033005732610567926, 'psi': 0.9914021439124827}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.074643 cos_to_last_merge=0.7482 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=86 local utility u=0.007169 metrics={'f1_val': 0.9935371116424491, 'auprc': 0.9918780365162662, 'loss_val': 0.03580609804102324, 'psi': 0.992873481591976}-{'f1_val': 0.9935888275773034, 'auprc': 0.9867161465445837, 'loss_val': 0.03496862931587912, 'psi': 0.9908397551642156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=86 head_norm_before_train=2.282541 cos_to_last_merge=0.7647 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=86 local utility u=0.000592 metrics={'f1_val': 0.9071820863905053, 'auprc': 0.9616315463644898, 'loss_val': 0.5703699723171245, 'psi': 0.9289618703800991}-{'f1_val': 0.9076076269102737, 'auprc': 0.958270209447275, 'loss_val': 0.5640239471731832, 'psi': 0.9278726599250743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=87 head_norm_before_train=2.271844 (no previous merge yet)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.8321770676319525, 'auprc': 0.9641921672084676, 'loss_val': 0.3720934073966799, 'psi': 0.8849831074625585}-{'f1_val': 0.8313976827929278, 'auprc': 0.9930226688089008, 'loss_val': 0.3613942604862373, 'psi': 0.896047677199317}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.134640 cos_to_last_merge=0.9155 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=87 local utility u=0.162993 metrics={'f1_val': 0.9357146728451611, 'auprc': 0.9962786639455518, 'loss_val': 0.17013064320353233, 'psi': 0.9599402692853173}-{'f1_val': 0.9020177978435089, 'auprc': 0.9970905113363515, 'loss_val': 0.29637097646798255, 'psi': 0.9400468832406459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=87 head_norm_before_train=2.309356 (no previous merge yet)
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9546097652819233, 'auprc': 0.9330972240472143, 'loss_val': 0.3458453631833443, 'psi': 0.9460047487880398}-{'f1_val': 0.9557025930879361, 'auprc': 0.9377847720815446, 'loss_val': 0.3479061833959988, 'psi': 0.9485354646853795}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.927479 cos_to_last_merge=0.9794 (last merge round=35)
[S5] round=87 local utility u=1.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8261497597202649, 'loss_val': 0.4692624632588072, 'psi': 0.7506522629829213}-{'f1_val': 0.436667805632789, 'auprc': 0.8516063962093647, 'loss_val': 1.2975359475769008, 'psi': 0.6026432418634193}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=87 head_norm_before_train=2.393745 cos_to_last_merge=0.9334 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.9609777470235187, 'auprc': 0.9557999970088703, 'loss_val': 0.19954340741903975, 'psi': 0.9589066470176594}-{'f1_val': 0.7032604163842167, 'auprc': 0.8488902891170574, 'loss_val': 1.0824002390447218, 'psi': 0.761512365477353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=87 head_norm_before_train=1.919429 cos_to_last_merge=0.9942 (last merge round=41)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.601906435668252, 'auprc': 0.7962826432762211, 'loss_val': 0.755359325643444, 'psi': 0.6796569187114396}-{'f1_val': 0.7291557644913618, 'auprc': 0.8548308498511091, 'loss_val': 0.32286545433026587, 'psi': 0.7794257986352607}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.293171 cos_to_last_merge=0.7934 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=87 local utility u=0.012311 metrics={'f1_val': 0.988272459098805, 'auprc': 0.9994581421142327, 'loss_val': 0.03954368941817826, 'psi': 0.9927467323049761}-{'f1_val': 0.9850737047007152, 'auprc': 0.9993122036075868, 'loss_val': 0.044536344171036565, 'psi': 0.9907691042634639}
[S8] not sending this round → trigger blocked (psi=0.993)
[S9] START round=87 head_norm_before_train=2.222634 (no previous merge yet)
[S9] round=87 local utility u=0.000613 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9999397529505942, 'loss_val': 0.020121365921143913, 'psi': 0.997471932198749}-{'f1_val': 0.9954158325366191, 'auprc': 0.9999487775912713, 'loss_val': 0.018909699316408055, 'psi': 0.99722901055848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=87 head_norm_before_train=2.199915 cos_to_last_merge=0.9592 (last merge round=35)
[S10] round=87 local utility u=0.000135 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9944475117621135, 'loss_val': 0.02663925947150958, 'psi': 0.9948917081164703}-{'f1_val': 0.9951878390193748, 'auprc': 0.9943571832758875, 'loss_val': 0.026637772334100654, 'psi': 0.9948555767219798}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=87 head_norm_before_train=2.378111 (no previous merge yet)
[S11] round=87 local utility u=0.001097 metrics={'f1_val': 0.9963090846170353, 'auprc': 0.9977863866039226, 'loss_val': 0.02204483675372236, 'psi': 0.9969000054117902}-{'f1_val': 0.9958918378685807, 'auprc': 0.997723525649351, 'loss_val': 0.021547772661386563, 'psi': 0.9966245129808888}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=87 head_norm_before_train=2.062911 cos_to_last_merge=0.9884 (last merge round=41)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6692997126217697, 'auprc': 0.8335129316849395, 'loss_val': 1.2238519961212908, 'psi': 0.7349850002470376}-{'f1_val': 0.7382313675371581, 'auprc': 0.8662684247477324, 'loss_val': 1.1323407433518546, 'psi': 0.7894461904213879}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=1.815906 cos_to_last_merge=0.9589 (last merge round=36)
[S14] round=87 local utility u=0.000467 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.999207052280106, 'loss_val': 0.021139894757946084, 'psi': 0.9978836292172256}-{'f1_val': 0.9970013471753054, 'auprc': 0.9992276549927811, 'loss_val': 0.022134939631105043, 'psi': 0.9978918703022956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=87 head_norm_before_train=2.512150 (no previous merge yet)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9853806569964317, 'auprc': 0.9952436035020638, 'loss_val': 0.03828216642415224, 'psi': 0.9893258355986845}-{'f1_val': 0.985808594582198, 'auprc': 0.9952547684706763, 'loss_val': 0.036829762568545324, 'psi': 0.9895870641375893}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=2.079894 cos_to_last_merge=0.7479 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.993119053659016, 'auprc': 0.9912531825408948, 'loss_val': 0.03740042339899663, 'psi': 0.9923727052117676}-{'f1_val': 0.9935371116424491, 'auprc': 0.9918780365162662, 'loss_val': 0.03580609804102324, 'psi': 0.992873481591976}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.289122 cos_to_last_merge=0.7643 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.6716562872777649, 'auprc': 0.955777844925959, 'loss_val': 1.3018243013559994, 'psi': 0.7853049103370426}-{'f1_val': 0.9071820863905053, 'auprc': 0.9616315463644898, 'loss_val': 0.5703699723171245, 'psi': 0.9289618703800991}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.271800 (no previous merge yet)
[S2] round=88 local utility u=0.039934 metrics={'f1_val': 0.830732053953143, 'auprc': 0.9926248240277332, 'loss_val': 0.36885385187222935, 'psi': 0.895489161982979}-{'f1_val': 0.8321770676319525, 'auprc': 0.9641921672084676, 'loss_val': 0.3720934073966799, 'psi': 0.8849831074625585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=88 head_norm_before_train=2.141511 cos_to_last_merge=0.9150 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=88 local utility u=0.110927 metrics={'f1_val': 0.9618862016379262, 'auprc': 0.997238871099194, 'loss_val': 0.10818631607822518, 'psi': 0.9760272694224332}-{'f1_val': 0.9357146728451611, 'auprc': 0.9962786639455518, 'loss_val': 0.17013064320353233, 'psi': 0.9599402692853173}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=88 head_norm_before_train=2.317084 (no previous merge yet)
[S4] round=88 local utility u=0.052110 metrics={'f1_val': 0.9592140938641341, 'auprc': 0.9535209086037919, 'loss_val': 0.330522194693105, 'psi': 0.9569368197599972}-{'f1_val': 0.9546097652819233, 'auprc': 0.9330972240472143, 'loss_val': 0.3458453631833443, 'psi': 0.9460047487880398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=88 head_norm_before_train=1.930015 cos_to_last_merge=0.9792 (last merge round=35)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.6400311294069307, 'auprc': 0.6876853671780419, 'loss_val': 0.6382266787625854, 'psi': 0.6590928245153751}-{'f1_val': 0.700320598491359, 'auprc': 0.8261497597202649, 'loss_val': 0.4692624632588072, 'psi': 0.7506522629829213}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.404253 cos_to_last_merge=0.9326 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=88 local utility u=0.170786 metrics={'f1_val': 0.9864517696259019, 'auprc': 0.9798534928972298, 'loss_val': 0.08297606097208156, 'psi': 0.983812458934433}-{'f1_val': 0.9609777470235187, 'auprc': 0.9557999970088703, 'loss_val': 0.19954340741903975, 'psi': 0.9589066470176594}
[S6] not sending this round → trigger blocked (psi=0.984)
[S7] START round=88 head_norm_before_train=1.924204 cos_to_last_merge=0.9940 (last merge round=41)
[S7] round=88 local utility u=0.330381 metrics={'f1_val': 0.6578048861144272, 'auprc': 0.8112236518885101, 'loss_val': 0.47481020144995656, 'psi': 0.7191723924240604}-{'f1_val': 0.601906435668252, 'auprc': 0.7962826432762211, 'loss_val': 0.755359325643444, 'psi': 0.6796569187114396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=88 head_norm_before_train=2.293072 cos_to_last_merge=0.7929 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=88 local utility u=0.022881 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9996925003731753, 'loss_val': 0.02505408223004427, 'psi': 0.9958973864136793}-{'f1_val': 0.988272459098805, 'auprc': 0.9994581421142327, 'loss_val': 0.03954368941817826, 'psi': 0.9927467323049761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=88 head_norm_before_train=2.224282 (no previous merge yet)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9890975148541, 'auprc': 0.9982188569901624, 'loss_val': 0.04680470677610636, 'psi': 0.9927460517085249}-{'f1_val': 0.9958267183641853, 'auprc': 0.9999397529505942, 'loss_val': 0.020121365921143913, 'psi': 0.997471932198749}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.203608 cos_to_last_merge=0.9587 (last merge round=35)
[S10] round=88 local utility u=0.000139 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945351375163385, 'loss_val': 0.026623386497766785, 'psi': 0.9949267584181603}-{'f1_val': 0.9951878390193748, 'auprc': 0.9944475117621135, 'loss_val': 0.02663925947150958, 'psi': 0.9948917081164703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=88 head_norm_before_train=2.379261 (no previous merge yet)
[S11] round=88 local utility u=0.000000 metrics={'f1_val': 0.9963100190352135, 'auprc': 0.9980728747713752, 'loss_val': 0.025663630530641534, 'psi': 0.9970151613296782}-{'f1_val': 0.9963090846170353, 'auprc': 0.9977863866039226, 'loss_val': 0.02204483675372236, 'psi': 0.9969000054117902}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=88 head_norm_before_train=2.069330 cos_to_last_merge=0.9880 (last merge round=41)
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6096773320206925, 'auprc': 0.8228512119313829, 'loss_val': 1.4076667163949463, 'psi': 0.6949468839849686}-{'f1_val': 0.6692997126217697, 'auprc': 0.8335129316849395, 'loss_val': 1.2238519961212908, 'psi': 0.7349850002470376}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.821040 cos_to_last_merge=0.9584 (last merge round=36)
[S14] round=88 local utility u=0.000380 metrics={'f1_val': 0.997244067813585, 'auprc': 0.998851506886417, 'loss_val': 0.020769061279828655, 'psi': 0.9978870434427178}-{'f1_val': 0.9970013471753054, 'auprc': 0.999207052280106, 'loss_val': 0.021139894757946084, 'psi': 0.9978836292172256}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=88 head_norm_before_train=2.516374 (no previous merge yet)
[S15] round=88 local utility u=0.014323 metrics={'f1_val': 0.9892122379451619, 'auprc': 0.9953221396690094, 'loss_val': 0.03286124003574545, 'psi': 0.9916561986347008}-{'f1_val': 0.9853806569964317, 'auprc': 0.9952436035020638, 'loss_val': 0.03828216642415224, 'psi': 0.9893258355986845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=88 head_norm_before_train=2.082867 cos_to_last_merge=0.7475 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.748
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.993119053659016, 'auprc': 0.9912393470251812, 'loss_val': 0.037619607483537855, 'psi': 0.9923671710054821}-{'f1_val': 0.993119053659016, 'auprc': 0.9912531825408948, 'loss_val': 0.03740042339899663, 'psi': 0.9923727052117676}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.296868 cos_to_last_merge=0.7639 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=88 local utility u=1.000000 metrics={'f1_val': 0.8820155021895794, 'auprc': 0.9840284840955611, 'loss_val': 0.5802707939506928, 'psi': 0.9228206949519719}-{'f1_val': 0.6716562872777649, 'auprc': 0.955777844925959, 'loss_val': 1.3018243013559994, 'psi': 0.7853049103370426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=89 head_norm_before_train=2.273674 (no previous merge yet)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.8848795595780984, 'auprc': 0.8347747810545405, 'loss_val': 0.36108822145361286, 'psi': 0.8648376481686753}-{'f1_val': 0.830732053953143, 'auprc': 0.9926248240277332, 'loss_val': 0.36885385187222935, 'psi': 0.895489161982979}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.148381 cos_to_last_merge=0.9144 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.8928166020538979, 'auprc': 0.9918787945108978, 'loss_val': 0.30644729375072793, 'psi': 0.9324414790366978}-{'f1_val': 0.9618862016379262, 'auprc': 0.997238871099194, 'loss_val': 0.10818631607822518, 'psi': 0.9760272694224332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=2.319238 (no previous merge yet)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9556516839902474, 'auprc': 0.9401879699289603, 'loss_val': 0.34205872808960686, 'psi': 0.9494661983657325}-{'f1_val': 0.9592140938641341, 'auprc': 0.9535209086037919, 'loss_val': 0.330522194693105, 'psi': 0.9569368197599972}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.933076 cos_to_last_merge=0.9787 (last merge round=35)
[S5] round=89 local utility u=1.000000 metrics={'f1_val': 0.9961420887187077, 'auprc': 0.9974571458598183, 'loss_val': 0.1095818982857665, 'psi': 0.9966681115751519}-{'f1_val': 0.6400311294069307, 'auprc': 0.6876853671780419, 'loss_val': 0.6382266787625854, 'psi': 0.6590928245153751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=89 head_norm_before_train=2.411841 cos_to_last_merge=0.9321 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.932
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.8278441106763557, 'auprc': 0.9526477063768276, 'loss_val': 0.28459374438851315, 'psi': 0.8777655489565445}-{'f1_val': 0.9864517696259019, 'auprc': 0.9798534928972298, 'loss_val': 0.08297606097208156, 'psi': 0.983812458934433}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.927379 cos_to_last_merge=0.9938 (last merge round=41)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.6479777014739747, 'auprc': 0.8040963023195116, 'loss_val': 0.6753611668286756, 'psi': 0.7104251418121894}-{'f1_val': 0.6578048861144272, 'auprc': 0.8112236518885101, 'loss_val': 0.47481020144995656, 'psi': 0.7191723924240604}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.298255 cos_to_last_merge=0.7923 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.792
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9530375371071274, 'auprc': 0.9994198404390351, 'loss_val': 0.13182224931549916, 'psi': 0.9715904584398904}-{'f1_val': 0.9933673104406822, 'auprc': 0.9996925003731753, 'loss_val': 0.02505408223004427, 'psi': 0.9958973864136793}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.228048 (no previous merge yet)
[S9] round=89 local utility u=0.036507 metrics={'f1_val': 0.9958312226609984, 'auprc': 0.9997476847541311, 'loss_val': 0.01877962190648928, 'psi': 0.9973978074982515}-{'f1_val': 0.9890975148541, 'auprc': 0.9982188569901624, 'loss_val': 0.04680470677610636, 'psi': 0.9927460517085249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=89 head_norm_before_train=2.208658 cos_to_last_merge=0.9584 (last merge round=35)
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9940314666610988, 'loss_val': 0.026666183959906015, 'psi': 0.9947252900760644}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945351375163385, 'loss_val': 0.026623386497766785, 'psi': 0.9949267584181603}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.381686 (no previous merge yet)
[S11] round=89 local utility u=0.002587 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.99792261661789, 'loss_val': 0.021484535436519864, 'psi': 0.9970995996442144}-{'f1_val': 0.9963100190352135, 'auprc': 0.9980728747713752, 'loss_val': 0.025663630530641534, 'psi': 0.9970151613296782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=89 head_norm_before_train=2.073983 cos_to_last_merge=0.9878 (last merge round=41)
[S13] round=89 local utility u=0.603194 metrics={'f1_val': 0.7039007442318616, 'auprc': 0.8273027919898085, 'loss_val': 0.7799743115243476, 'psi': 0.7532615633350404}-{'f1_val': 0.6096773320206925, 'auprc': 0.8228512119313829, 'loss_val': 1.4076667163949463, 'psi': 0.6949468839849686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=89 head_norm_before_train=1.823996 cos_to_last_merge=0.9581 (last merge round=36)
[S14] round=89 local utility u=0.002363 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9992295134213665, 'loss_val': 0.019503640935173983, 'psi': 0.9982709893424724}-{'f1_val': 0.997244067813585, 'auprc': 0.998851506886417, 'loss_val': 0.020769061279828655, 'psi': 0.9978870434427178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=89 head_norm_before_train=2.520525 (no previous merge yet)
[S15] round=89 local utility u=0.009530 metrics={'f1_val': 0.9921621803925177, 'auprc': 0.9953382751937212, 'loss_val': 0.03155027969652257, 'psi': 0.9934326183129991}-{'f1_val': 0.9892122379451619, 'auprc': 0.9953221396690094, 'loss_val': 0.03286124003574545, 'psi': 0.9916561986347008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=89 head_norm_before_train=2.086526 cos_to_last_merge=0.7471 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.747
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9935888275773034, 'auprc': 0.9861141980806525, 'loss_val': 0.03472273244881032, 'psi': 0.9905989757786431}-{'f1_val': 0.993119053659016, 'auprc': 0.9912393470251812, 'loss_val': 0.037619607483537855, 'psi': 0.9923671710054821}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.300404 cos_to_last_merge=0.7636 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.886906996628549, 'auprc': 0.9226872112831486, 'loss_val': 0.6529831608498454, 'psi': 0.9012190824903888}-{'f1_val': 0.8820155021895794, 'auprc': 0.9840284840955611, 'loss_val': 0.5802707939506928, 'psi': 0.9228206949519719}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=90 head_norm_before_train=2.275844 (no previous merge yet)
[S2] round=90 local utility u=0.081611 metrics={'f1_val': 0.8320179885451823, 'auprc': 0.9933309646818338, 'loss_val': 0.3563650662431792, 'psi': 0.8965431789998429}-{'f1_val': 0.8848795595780984, 'auprc': 0.8347747810545405, 'loss_val': 0.36108822145361286, 'psi': 0.8648376481686753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=90 head_norm_before_train=2.154103 cos_to_last_merge=0.9138 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.7095378198253326, 'auprc': 0.9412080562139797, 'loss_val': 1.0092600495619932, 'psi': 0.8022059143807915}-{'f1_val': 0.8928166020538979, 'auprc': 0.9918787945108978, 'loss_val': 0.30644729375072793, 'psi': 0.9324414790366978}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=2.327240 (no previous merge yet)
[S4] round=90 local utility u=0.040097 metrics={'f1_val': 0.9570850316525845, 'auprc': 0.9649105492695096, 'loss_val': 0.34463302851125016, 'psi': 0.9602152386993545}-{'f1_val': 0.9556516839902474, 'auprc': 0.9401879699289603, 'loss_val': 0.34205872808960686, 'psi': 0.9494661983657325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=90 head_norm_before_train=1.937978 cos_to_last_merge=0.9781 (last merge round=35)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.43676623050537206, 'auprc': 0.8522626485906662, 'loss_val': 1.1610036509964352, 'psi': 0.6029647977394897}-{'f1_val': 0.9961420887187077, 'auprc': 0.9974571458598183, 'loss_val': 0.1095818982857665, 'psi': 0.9966681115751519}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=2.421515 cos_to_last_merge=0.9313 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7391626921803267, 'auprc': 0.889668209690374, 'loss_val': 0.9450805820549419, 'psi': 0.7993648991843456}-{'f1_val': 0.8278441106763557, 'auprc': 0.9526477063768276, 'loss_val': 0.28459374438851315, 'psi': 0.8777655489565445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.929947 cos_to_last_merge=0.9937 (last merge round=41)
[S7] round=90 local utility u=0.262776 metrics={'f1_val': 0.6749294253519305, 'auprc': 0.8271492519129544, 'loss_val': 0.38067741401728694, 'psi': 0.7358173559763401}-{'f1_val': 0.6479777014739747, 'auprc': 0.8040963023195116, 'loss_val': 0.6753611668286756, 'psi': 0.7104251418121894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=90 head_norm_before_train=2.304137 cos_to_last_merge=0.7919 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.792
[S8] round=90 local utility u=0.178621 metrics={'f1_val': 0.9947116379946571, 'auprc': 0.9997088124416555, 'loss_val': 0.02549230590309662, 'psi': 0.9967105077734565}-{'f1_val': 0.9530375371071274, 'auprc': 0.9994198404390351, 'loss_val': 0.13182224931549916, 'psi': 0.9715904584398904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=90 head_norm_before_train=2.231528 (no previous merge yet)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9967086529075473, 'loss_val': 0.018586902469136593, 'psi': 0.9966797682513537}-{'f1_val': 0.9958312226609984, 'auprc': 0.9997476847541311, 'loss_val': 0.01877962190648928, 'psi': 0.9973978074982515}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=2.212993 cos_to_last_merge=0.9580 (last merge round=35)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9937587968946049, 'loss_val': 0.02668311775482595, 'psi': 0.9946162221694668}-{'f1_val': 0.9951878390193748, 'auprc': 0.9940314666610988, 'loss_val': 0.026666183959906015, 'psi': 0.9947252900760644}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.386292 (no previous merge yet)
[S11] round=90 local utility u=0.000253 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9978368039438339, 'loss_val': 0.020721789047310344, 'psi': 0.9970652745745919}-{'f1_val': 0.9965509216617638, 'auprc': 0.99792261661789, 'loss_val': 0.021484535436519864, 'psi': 0.9970995996442144}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=90 head_norm_before_train=2.077657 cos_to_last_merge=0.9876 (last merge round=41)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6241744964972427, 'auprc': 0.9105045294423608, 'loss_val': 1.4780354038896137, 'psi': 0.7387065096752898}-{'f1_val': 0.7039007442318616, 'auprc': 0.8273027919898085, 'loss_val': 0.7799743115243476, 'psi': 0.7532615633350404}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=1.827280 cos_to_last_merge=0.9578 (last merge round=36)
[S14] round=90 local utility u=0.001787 metrics={'f1_val': 0.9982854591839057, 'auprc': 0.9988533419306463, 'loss_val': 0.0187216682771986, 'psi': 0.9985126122826019}-{'f1_val': 0.9976319732898762, 'auprc': 0.9992295134213665, 'loss_val': 0.019503640935173983, 'psi': 0.9982709893424724}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=90 head_norm_before_train=2.524652 (no previous merge yet)
[S15] round=90 local utility u=0.004333 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9953735131869437, 'loss_val': 0.030528976410590953, 'psi': 0.994200562985025}-{'f1_val': 0.9921621803925177, 'auprc': 0.9953382751937212, 'loss_val': 0.03155027969652257, 'psi': 0.9934326183129991}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=90 head_norm_before_train=2.087184 cos_to_last_merge=0.7465 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.746
[S16] round=90 local utility u=0.003947 metrics={'f1_val': 0.9948368183563289, 'auprc': 0.9857424645549921, 'loss_val': 0.03320181347619916, 'psi': 0.9911990768357942}-{'f1_val': 0.9935888275773034, 'auprc': 0.9861141980806525, 'loss_val': 0.03472273244881032, 'psi': 0.9905989757786431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=90 head_norm_before_train=2.300183 cos_to_last_merge=0.7636 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8756479261253074, 'auprc': 0.9027825452592142, 'loss_val': 0.6839876502430814, 'psi': 0.8865017737788701}-{'f1_val': 0.886906996628549, 'auprc': 0.9226872112831486, 'loss_val': 0.6529831608498454, 'psi': 0.9012190824903888}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.281892 (no previous merge yet)
[S2] round=91 local utility u=0.003138 metrics={'f1_val': 0.8317186407618864, 'auprc': 0.9933686316812275, 'loss_val': 0.34840537725270815, 'psi': 0.8963786371296227}-{'f1_val': 0.8320179885451823, 'auprc': 0.9933309646818338, 'loss_val': 0.3563650662431792, 'psi': 0.8965431789998429}
[S2] not sending this round → trigger blocked (psi=0.896)
[S3] START round=91 head_norm_before_train=2.158922 cos_to_last_merge=0.9133 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=91 local utility u=0.643661 metrics={'f1_val': 0.8251011325239456, 'auprc': 0.9844703543146673, 'loss_val': 0.5451040314011402, 'psi': 0.8888488212402343}-{'f1_val': 0.7095378198253326, 'auprc': 0.9412080562139797, 'loss_val': 1.0092600495619932, 'psi': 0.8022059143807915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=91 head_norm_before_train=2.331609 (no previous merge yet)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9538474863629662, 'auprc': 0.9634257623743037, 'loss_val': 0.35731688945572926, 'psi': 0.9576787967675012}-{'f1_val': 0.9570850316525845, 'auprc': 0.9649105492695096, 'loss_val': 0.34463302851125016, 'psi': 0.9602152386993545}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.942993 cos_to_last_merge=0.9778 (last merge round=35)
[S5] round=91 local utility u=0.666760 metrics={'f1_val': 0.6037854461101205, 'auprc': 0.8034439022809067, 'loss_val': 0.6831430204836256, 'psi': 0.683648828578435}-{'f1_val': 0.43676623050537206, 'auprc': 0.8522626485906662, 'loss_val': 1.1610036509964352, 'psi': 0.6029647977394897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=91 head_norm_before_train=2.430374 cos_to_last_merge=0.9305 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=91 local utility u=0.626741 metrics={'f1_val': 0.8220186404354348, 'auprc': 0.9433952414355032, 'loss_val': 0.3499147228439884, 'psi': 0.8705692808354621}-{'f1_val': 0.7391626921803267, 'auprc': 0.889668209690374, 'loss_val': 0.9450805820549419, 'psi': 0.7993648991843456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=91 head_norm_before_train=1.931921 cos_to_last_merge=0.9935 (last merge round=41)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6645338590763457, 'auprc': 0.8191704327000076, 'loss_val': 0.39439683074524984, 'psi': 0.7263884885258105}-{'f1_val': 0.6749294253519305, 'auprc': 0.8271492519129544, 'loss_val': 0.38067741401728694, 'psi': 0.7358173559763401}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.307083 cos_to_last_merge=0.7910 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.791
[S8] round=91 local utility u=0.000595 metrics={'f1_val': 0.9946562518404718, 'auprc': 0.9996841533057144, 'loss_val': 0.023896379908770242, 'psi': 0.9966674124265688}-{'f1_val': 0.9947116379946571, 'auprc': 0.9997088124416555, 'loss_val': 0.02549230590309662, 'psi': 0.9967105077734565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=91 head_norm_before_train=2.236159 (no previous merge yet)
[S9] round=91 local utility u=0.004727 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997369536891068, 'loss_val': 0.018217281381011127, 'psi': 0.9978910885639776}-{'f1_val': 0.9966605118138915, 'auprc': 0.9967086529075473, 'loss_val': 0.018586902469136593, 'psi': 0.9966797682513537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=91 head_norm_before_train=2.216685 cos_to_last_merge=0.9575 (last merge round=35)
[S10] round=91 local utility u=0.001246 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945740142140146, 'loss_val': 0.02663741850863527, 'psi': 0.9949423090972307}-{'f1_val': 0.9951878390193748, 'auprc': 0.9937587968946049, 'loss_val': 0.02668311775482595, 'psi': 0.9946162221694668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=91 head_norm_before_train=2.390924 (no previous merge yet)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978071101291118, 'loss_val': 0.02046337053475762, 'psi': 0.9968030489996303}-{'f1_val': 0.9965509216617638, 'auprc': 0.9978368039438339, 'loss_val': 0.020721789047310344, 'psi': 0.9970652745745919}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=2.079647 cos_to_last_merge=0.9875 (last merge round=41)
[S13] round=91 local utility u=0.507297 metrics={'f1_val': 0.7356209241491382, 'auprc': 0.8535743015061064, 'loss_val': 0.9613299083046937, 'psi': 0.7828022750919255}-{'f1_val': 0.6241744964972427, 'auprc': 0.9105045294423608, 'loss_val': 1.4780354038896137, 'psi': 0.7387065096752898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=91 head_norm_before_train=1.830241 cos_to_last_merge=0.9575 (last merge round=36)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9823672289406733, 'auprc': 0.9988552819182688, 'loss_val': 0.039323191830477465, 'psi': 0.9889624501317115}-{'f1_val': 0.9982854591839057, 'auprc': 0.9988533419306463, 'loss_val': 0.0187216682771986, 'psi': 0.9985126122826019}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.528740 (no previous merge yet)
[S15] round=91 local utility u=0.000002 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9953750701502069, 'loss_val': 0.030528784985966693, 'psi': 0.9942011857703303}-{'f1_val': 0.9934185961837458, 'auprc': 0.9953735131869437, 'loss_val': 0.030528976410590953, 'psi': 0.994200562985025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=91 head_norm_before_train=2.088933 cos_to_last_merge=0.7459 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.746
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9948368183563289, 'auprc': 0.9856541037676887, 'loss_val': 0.033003333234429603, 'psi': 0.9911637325208729}-{'f1_val': 0.9948368183563289, 'auprc': 0.9857424645549921, 'loss_val': 0.03320181347619916, 'psi': 0.9911990768357942}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.303091 cos_to_last_merge=0.7635 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.764
[S17] round=91 local utility u=0.270294 metrics={'f1_val': 0.9014589054350148, 'auprc': 0.9618454211419757, 'loss_val': 0.47545380751429367, 'psi': 0.9256135117177992}-{'f1_val': 0.8756479261253074, 'auprc': 0.9027825452592142, 'loss_val': 0.6839876502430814, 'psi': 0.8865017737788701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=92 head_norm_before_train=2.285124 (no previous merge yet)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.8339473043029669, 'auprc': 0.9676406783284014, 'loss_val': 0.32765160724939113, 'psi': 0.8874246539131407}-{'f1_val': 0.8317186407618864, 'auprc': 0.9933686316812275, 'loss_val': 0.34840537725270815, 'psi': 0.8963786371296227}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.164929 cos_to_last_merge=0.9127 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=92 local utility u=0.420555 metrics={'f1_val': 0.9104637262642681, 'auprc': 0.9915209576689442, 'loss_val': 0.23732213733790447, 'psi': 0.9428866188261386}-{'f1_val': 0.8251011325239456, 'auprc': 0.9844703543146673, 'loss_val': 0.5451040314011402, 'psi': 0.8888488212402343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=92 head_norm_before_train=2.329390 (no previous merge yet)
[S4] round=92 local utility u=0.003273 metrics={'f1_val': 0.9590735033163766, 'auprc': 0.9589302461772146, 'loss_val': 0.36864055766431975, 'psi': 0.9590162004607119}-{'f1_val': 0.9538474863629662, 'auprc': 0.9634257623743037, 'loss_val': 0.35731688945572926, 'psi': 0.9576787967675012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=92 head_norm_before_train=1.948763 cos_to_last_merge=0.9774 (last merge round=35)
[S5] round=92 local utility u=0.596370 metrics={'f1_val': 0.7105247703723575, 'auprc': 0.8838285563253623, 'loss_val': 0.3719927345346897, 'psi': 0.7798462847535594}-{'f1_val': 0.6037854461101205, 'auprc': 0.8034439022809067, 'loss_val': 0.6831430204836256, 'psi': 0.683648828578435}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=92 head_norm_before_train=2.437849 cos_to_last_merge=0.9300 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=92 local utility u=0.545595 metrics={'f1_val': 0.9451157280973832, 'auprc': 0.9803041963941873, 'loss_val': 0.1080335048489402, 'psi': 0.9591911154161048}-{'f1_val': 0.8220186404354348, 'auprc': 0.9433952414355032, 'loss_val': 0.3499147228439884, 'psi': 0.8705692808354621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=92 head_norm_before_train=1.934199 cos_to_last_merge=0.9934 (last merge round=41)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.5716388547490523, 'auprc': 0.7861705313970616, 'loss_val': 0.955452291913677, 'psi': 0.657451525408256}-{'f1_val': 0.6645338590763457, 'auprc': 0.8191704327000076, 'loss_val': 0.39439683074524984, 'psi': 0.7263884885258105}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.315531 cos_to_last_merge=0.7904 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.790
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9926457841098181, 'auprc': 0.999462480067177, 'loss_val': 0.028941369851068807, 'psi': 0.9953724624927616}-{'f1_val': 0.9946562518404718, 'auprc': 0.9996841533057144, 'loss_val': 0.023896379908770242, 'psi': 0.9966674124265688}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.238766 (no previous merge yet)
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9988168959328689, 'loss_val': 0.01854758817773273, 'psi': 0.9972720270585382}-{'f1_val': 0.9966605118138915, 'auprc': 0.9997369536891068, 'loss_val': 0.018217281381011127, 'psi': 0.9978910885639776}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.221672 cos_to_last_merge=0.9572 (last merge round=35)
[S10] round=92 local utility u=0.000223 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947215801397064, 'loss_val': 0.02663381721979349, 'psi': 0.9950013354675074}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945740142140146, 'loss_val': 0.02663741850863527, 'psi': 0.9949423090972307}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=92 head_norm_before_train=2.396213 (no previous merge yet)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977564814920646, 'loss_val': 0.020421648958853178, 'psi': 0.9967827975448115}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978071101291118, 'loss_val': 0.02046337053475762, 'psi': 0.9968030489996303}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.080493 cos_to_last_merge=0.9874 (last merge round=41)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6969465545320701, 'auprc': 0.8513471401872831, 'loss_val': 1.1561796228288719, 'psi': 0.7587067887941553}-{'f1_val': 0.7356209241491382, 'auprc': 0.8535743015061064, 'loss_val': 0.9613299083046937, 'psi': 0.7828022750919255}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=92 head_norm_before_train=1.833208 cos_to_last_merge=0.9573 (last merge round=36)
[S14] round=92 local utility u=0.046121 metrics={'f1_val': 0.9955709227491966, 'auprc': 0.9992352578659308, 'loss_val': 0.02744383016219465, 'psi': 0.9970366567958903}-{'f1_val': 0.9823672289406733, 'auprc': 0.9988552819182688, 'loss_val': 0.039323191830477465, 'psi': 0.9889624501317115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=92 head_norm_before_train=2.532705 (no previous merge yet)
[S15] round=92 local utility u=0.009080 metrics={'f1_val': 0.9959176576326709, 'auprc': 0.9954147782424212, 'loss_val': 0.027483167476039464, 'psi': 0.9957165058765711}-{'f1_val': 0.9934185961837458, 'auprc': 0.9953750701502069, 'loss_val': 0.030528784985966693, 'psi': 0.9942011857703303}
[S15] not sending this round → trigger blocked (psi=0.996)
[S16] START round=92 head_norm_before_train=2.093631 cos_to_last_merge=0.7456 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.746
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.9935888275773034, 'auprc': 0.9866800165289578, 'loss_val': 0.03408466129508753, 'psi': 0.9908253031579652}-{'f1_val': 0.9948368183563289, 'auprc': 0.9856541037676887, 'loss_val': 0.033003333234429603, 'psi': 0.9911637325208729}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=2.307593 cos_to_last_merge=0.7632 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.8888108815911168, 'auprc': 0.9014004429879404, 'loss_val': 0.6440457307712384, 'psi': 0.8938467061498462}-{'f1_val': 0.9014589054350148, 'auprc': 0.9618454211419757, 'loss_val': 0.47545380751429367, 'psi': 0.9256135117177992}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.292674 (no previous merge yet)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.7889910087388728, 'auprc': 0.867323715237618, 'loss_val': 0.5888186613982958, 'psi': 0.8203240913383709}-{'f1_val': 0.8339473043029669, 'auprc': 0.9676406783284014, 'loss_val': 0.32765160724939113, 'psi': 0.8874246539131407}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.170942 cos_to_last_merge=0.9121 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.7184348723201844, 'auprc': 0.9567389415956222, 'loss_val': 0.9842062939001752, 'psi': 0.8137565000303596}-{'f1_val': 0.9104637262642681, 'auprc': 0.9915209576689442, 'loss_val': 0.23732213733790447, 'psi': 0.9428866188261386}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=2.328969 (no previous merge yet)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9539823373276318, 'auprc': 0.9612717209932926, 'loss_val': 0.3578586349599386, 'psi': 0.9568980907938962}-{'f1_val': 0.9590735033163766, 'auprc': 0.9589302461772146, 'loss_val': 0.36864055766431975, 'psi': 0.9590162004607119}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=1.955541 cos_to_last_merge=0.9768 (last merge round=35)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.5765930626115426, 'auprc': 0.7410920681207696, 'loss_val': 0.8925619606119127, 'psi': 0.6423926648152334}-{'f1_val': 0.7105247703723575, 'auprc': 0.8838285563253623, 'loss_val': 0.3719927345346897, 'psi': 0.7798462847535594}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.447197 cos_to_last_merge=0.9293 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7142330076411465, 'auprc': 0.8600886578328535, 'loss_val': 1.0997043661639092, 'psi': 0.7725752677178293}-{'f1_val': 0.9451157280973832, 'auprc': 0.9803041963941873, 'loss_val': 0.1080335048489402, 'psi': 0.9591911154161048}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=93 head_norm_before_train=1.936751 cos_to_last_merge=0.9932 (last merge round=41)
[S7] round=93 local utility u=0.826761 metrics={'f1_val': 0.6889315187854034, 'auprc': 0.8719682670808127, 'loss_val': 0.2630785381219725, 'psi': 0.7621462181035671}-{'f1_val': 0.5716388547490523, 'auprc': 0.7861705313970616, 'loss_val': 0.955452291913677, 'psi': 0.657451525408256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=93 head_norm_before_train=2.322703 cos_to_last_merge=0.7891 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.789
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9815674059549724, 'auprc': 0.9994105130731705, 'loss_val': 0.05508854759303941, 'psi': 0.9887046488022516}-{'f1_val': 0.9926457841098181, 'auprc': 0.999462480067177, 'loss_val': 0.028941369851068807, 'psi': 0.9953724624927616}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.241215 (no previous merge yet)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9988082882803588, 'loss_val': 0.0189578769972047, 'psi': 0.9970193463306548}-{'f1_val': 0.9962421144756511, 'auprc': 0.9988168959328689, 'loss_val': 0.01854758817773273, 'psi': 0.9972720270585382}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.227102 cos_to_last_merge=0.9568 (last merge round=35)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946615373940708, 'loss_val': 0.026635601727350598, 'psi': 0.9949773183692532}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947215801397064, 'loss_val': 0.02663381721979349, 'psi': 0.9950013354675074}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.401726 (no previous merge yet)
[S11] round=93 local utility u=0.000012 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9977439470221486, 'loss_val': 0.020360774880091338, 'psi': 0.996777783756845}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977564814920646, 'loss_val': 0.020421648958853178, 'psi': 0.9967827975448115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=93 head_norm_before_train=2.084151 cos_to_last_merge=0.9872 (last merge round=41)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.5991857075364202, 'auprc': 0.8293895217325906, 'loss_val': 1.4845251863458349, 'psi': 0.6912672332148884}-{'f1_val': 0.6969465545320701, 'auprc': 0.8513471401872831, 'loss_val': 1.1561796228288719, 'psi': 0.7587067887941553}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.834888 cos_to_last_merge=0.9571 (last merge round=36)
[S14] round=93 local utility u=0.011194 metrics={'f1_val': 0.9982556529300721, 'auprc': 0.9992333286056226, 'loss_val': 0.02115819851854481, 'psi': 0.9986467232002924}-{'f1_val': 0.9955709227491966, 'auprc': 0.9992352578659308, 'loss_val': 0.02744383016219465, 'psi': 0.9970366567958903}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=93 head_norm_before_train=2.536706 (no previous merge yet)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.993000306567307, 'auprc': 0.9953526691695253, 'loss_val': 0.03085562984064372, 'psi': 0.9939412516081942}-{'f1_val': 0.9959176576326709, 'auprc': 0.9954147782424212, 'loss_val': 0.027483167476039464, 'psi': 0.9957165058765711}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.099770 cos_to_last_merge=0.7455 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.746
[S16] round=93 local utility u=0.002884 metrics={'f1_val': 0.9938082643088795, 'auprc': 0.9882886347583681, 'loss_val': 0.0344600037233673, 'psi': 0.991600412488675}-{'f1_val': 0.9935888275773034, 'auprc': 0.9866800165289578, 'loss_val': 0.03408466129508753, 'psi': 0.9908253031579652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=93 head_norm_before_train=2.307752 cos_to_last_merge=0.7632 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=93 local utility u=0.059097 metrics={'f1_val': 0.8919266838237656, 'auprc': 0.923642019986085, 'loss_val': 0.6112715865238473, 'psi': 0.9046128182886933}-{'f1_val': 0.8888108815911168, 'auprc': 0.9014004429879404, 'loss_val': 0.6440457307712384, 'psi': 0.8938467061498462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S17] sending update (kind=head size=1793 to 1 peers)
[S2] START round=94 head_norm_before_train=2.298949 (no previous merge yet)
[S2] round=94 local utility u=0.341140 metrics={'f1_val': 0.8336469665064011, 'auprc': 0.9321061979526997, 'loss_val': 0.36882098285276443, 'psi': 0.8730306590849206}-{'f1_val': 0.7889910087388728, 'auprc': 0.867323715237618, 'loss_val': 0.5888186613982958, 'psi': 0.8203240913383709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] sending update (kind=head size=1789 to 1 peers)
[S3] START round=94 head_norm_before_train=2.175856 cos_to_last_merge=0.9116 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=94 local utility u=0.425218 metrics={'f1_val': 0.8003964927597684, 'auprc': 0.9851140402491492, 'loss_val': 0.7106648118377573, 'psi': 0.8742835117555208}-{'f1_val': 0.7184348723201844, 'auprc': 0.9567389415956222, 'loss_val': 0.9842062939001752, 'psi': 0.8137565000303596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=94 head_norm_before_train=2.319149 (no previous merge yet)
[S4] round=94 local utility u=0.063506 metrics={'f1_val': 0.9620154076351994, 'auprc': 0.9781460282766355, 'loss_val': 0.32966780556157727, 'psi': 0.968467655891774}-{'f1_val': 0.9539823373276318, 'auprc': 0.9612717209932926, 'loss_val': 0.3578586349599386, 'psi': 0.9568980907938962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=94 head_norm_before_train=1.959563 cos_to_last_merge=0.9766 (last merge round=35)
[S5] round=94 local utility u=0.549766 metrics={'f1_val': 0.6789063459345933, 'auprc': 0.7740351622773822, 'loss_val': 0.5057397043780544, 'psi': 0.716957872471709}-{'f1_val': 0.5765930626115426, 'auprc': 0.7410920681207696, 'loss_val': 0.8925619606119127, 'psi': 0.6423926648152334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=94 head_norm_before_train=2.459156 cos_to_last_merge=0.9283 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.6818416952139816, 'auprc': 0.6953520162128156, 'loss_val': 1.33884723634814, 'psi': 0.6872458236135153}-{'f1_val': 0.7142330076411465, 'auprc': 0.8600886578328535, 'loss_val': 1.0997043661639092, 'psi': 0.7725752677178293}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.939270 cos_to_last_merge=0.9931 (last merge round=41)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.6715059755796096, 'auprc': 0.8187402082528904, 'loss_val': 0.3766725945691623, 'psi': 0.7303996686489219}-{'f1_val': 0.6889315187854034, 'auprc': 0.8719682670808127, 'loss_val': 0.2630785381219725, 'psi': 0.7621462181035671}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.328794 cos_to_last_merge=0.7887 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.789
[S8] round=94 local utility u=0.054294 metrics={'f1_val': 0.9947116379946571, 'auprc': 0.9996795843441393, 'loss_val': 0.02617274620313065, 'psi': 0.9966988165344499}-{'f1_val': 0.9815674059549724, 'auprc': 0.9994105130731705, 'loss_val': 0.05508854759303941, 'psi': 0.9887046488022516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=94 head_norm_before_train=2.244650 (no previous merge yet)
[S9] round=94 local utility u=0.000700 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9973926779224758, 'loss_val': 0.018312961617921793, 'psi': 0.9969533782573252}-{'f1_val': 0.9958267183641853, 'auprc': 0.9988082882803588, 'loss_val': 0.0189578769972047, 'psi': 0.9970193463306548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=94 head_norm_before_train=2.230842 cos_to_last_merge=0.9564 (last merge round=35)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9944843802822487, 'loss_val': 0.026668404258211195, 'psi': 0.9949064555245244}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946615373940708, 'loss_val': 0.026635601727350598, 'psi': 0.9949773183692532}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.407208 (no previous merge yet)
[S11] round=94 local utility u=0.000460 metrics={'f1_val': 0.9965509216617638, 'auprc': 0.9979623045538609, 'loss_val': 0.022599986414984966, 'psi': 0.9971154748186027}-{'f1_val': 0.9961336749133093, 'auprc': 0.9977439470221486, 'loss_val': 0.020360774880091338, 'psi': 0.996777783756845}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=94 head_norm_before_train=2.087336 cos_to_last_merge=0.9869 (last merge round=41)
[S13] round=94 local utility u=0.372997 metrics={'f1_val': 0.6627048654574638, 'auprc': 0.8117980703894078, 'loss_val': 1.066872129747525, 'psi': 0.7223421474302414}-{'f1_val': 0.5991857075364202, 'auprc': 0.8293895217325906, 'loss_val': 1.4845251863458349, 'psi': 0.6912672332148884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=94 head_norm_before_train=1.839255 cos_to_last_merge=0.9568 (last merge round=36)
[S14] round=94 local utility u=0.000891 metrics={'f1_val': 0.9982556529300721, 'auprc': 0.999233306456908, 'loss_val': 0.0193770585680088, 'psi': 0.9986467143408065}-{'f1_val': 0.9982556529300721, 'auprc': 0.9992333286056226, 'loss_val': 0.02115819851854481, 'psi': 0.9986467232002924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=94 head_norm_before_train=2.540668 (no previous merge yet)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.986662799494812, 'auprc': 0.9953107200315872, 'loss_val': 0.035782757889803826, 'psi': 0.990121967709522}-{'f1_val': 0.993000306567307, 'auprc': 0.9953526691695253, 'loss_val': 0.03085562984064372, 'psi': 0.9939412516081942}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.100173 cos_to_last_merge=0.7449 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.745
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9938082643088795, 'auprc': 0.9883990659904255, 'loss_val': 0.03560100369123001, 'psi': 0.9916445849814979}-{'f1_val': 0.9938082643088795, 'auprc': 0.9882886347583681, 'loss_val': 0.0344600037233673, 'psi': 0.991600412488675}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.312131 cos_to_last_merge=0.7628 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=94 local utility u=0.034573 metrics={'f1_val': 0.8939993326570053, 'auprc': 0.9349602748099728, 'loss_val': 0.5885160200736371, 'psi': 0.9103837095181923}-{'f1_val': 0.8919266838237656, 'auprc': 0.923642019986085, 'loss_val': 0.6112715865238473, 'psi': 0.9046128182886933}
[S17] not sending this round → trigger blocked (psi=0.910)
[S2] START round=95 head_norm_before_train=2.301249 (no previous merge yet)
[S2] round=95 local utility u=0.071805 metrics={'f1_val': 0.8276109090358328, 'auprc': 0.9894050404011193, 'loss_val': 0.3608916113475732, 'psi': 0.8923285615819474}-{'f1_val': 0.8336469665064011, 'auprc': 0.9321061979526997, 'loss_val': 0.36882098285276443, 'psi': 0.8730306590849206}
[S2] not sending this round → trigger blocked (psi=0.892)
[S3] START round=95 head_norm_before_train=2.181385 cos_to_last_merge=0.9111 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=95 local utility u=0.711280 metrics={'f1_val': 0.9399456629201357, 'auprc': 0.9961952953067698, 'loss_val': 0.1586442726888111, 'psi': 0.9624455158747893}-{'f1_val': 0.8003964927597684, 'auprc': 0.9851140402491492, 'loss_val': 0.7106648118377573, 'psi': 0.8742835117555208}
[S3] not sending this round → trigger blocked (psi=0.962)
[S4] START round=95 head_norm_before_train=2.313596 (no previous merge yet)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9524242067266944, 'auprc': 0.9475267643749443, 'loss_val': 0.34871552786949117, 'psi': 0.9504652297859943}-{'f1_val': 0.9620154076351994, 'auprc': 0.9781460282766355, 'loss_val': 0.32966780556157727, 'psi': 0.968467655891774}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.961831 cos_to_last_merge=0.9764 (last merge round=35)
[S5] round=95 local utility u=0.402733 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9573030380209966, 'loss_val': 0.3795998846563591, 'psi': 0.8032171920896901}-{'f1_val': 0.6789063459345933, 'auprc': 0.7740351622773822, 'loss_val': 0.5057397043780544, 'psi': 0.716957872471709}
[S5] not sending this round → trigger blocked (psi=0.803)
[S6] START round=95 head_norm_before_train=2.468496 cos_to_last_merge=0.9276 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=95 local utility u=1.000000 metrics={'f1_val': 0.9854635751170875, 'auprc': 0.9846635233035133, 'loss_val': 0.048618813267860175, 'psi': 0.9851435543916578}-{'f1_val': 0.6818416952139816, 'auprc': 0.6953520162128156, 'loss_val': 1.33884723634814, 'psi': 0.6872458236135153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=95 head_norm_before_train=1.943000 cos_to_last_merge=0.9930 (last merge round=41)
[S7] round=95 local utility u=0.006442 metrics={'f1_val': 0.6724120396415607, 'auprc': 0.8244244965309394, 'loss_val': 0.38627812839988507, 'psi': 0.7332170223973122}-{'f1_val': 0.6715059755796096, 'auprc': 0.8187402082528904, 'loss_val': 0.3766725945691623, 'psi': 0.7303996686489219}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=95 head_norm_before_train=2.332475 cos_to_last_merge=0.7882 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.788
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9840166049584727, 'auprc': 0.9994433350893903, 'loss_val': 0.04976170707512983, 'psi': 0.9901872970108396}-{'f1_val': 0.9947116379946571, 'auprc': 0.9996795843441393, 'loss_val': 0.02617274620313065, 'psi': 0.9966988165344499}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.249140 (no previous merge yet)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.99559081954223, 'loss_val': 0.018479599020563554, 'psi': 0.9962326349052268}-{'f1_val': 0.9966605118138915, 'auprc': 0.9973926779224758, 'loss_val': 0.018312961617921793, 'psi': 0.9969533782573252}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.234628 cos_to_last_merge=0.9560 (last merge round=35)
[S10] round=95 local utility u=0.000057 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9945269727711767, 'loss_val': 0.026681602878250135, 'psi': 0.9949234925200956}-{'f1_val': 0.9951878390193748, 'auprc': 0.9944843802822487, 'loss_val': 0.026668404258211195, 'psi': 0.9949064555245244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=95 head_norm_before_train=2.411804 (no previous merge yet)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.9912789488544049, 'auprc': 0.9980458323989391, 'loss_val': 0.036040337533836564, 'psi': 0.9939857022722186}-{'f1_val': 0.9965509216617638, 'auprc': 0.9979623045538609, 'loss_val': 0.022599986414984966, 'psi': 0.9971154748186027}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=2.091457 cos_to_last_merge=0.9867 (last merge round=41)
[S13] round=95 local utility u=0.120141 metrics={'f1_val': 0.6914333828526378, 'auprc': 0.8780407165689993, 'loss_val': 1.1976890272354663, 'psi': 0.7660763163391824}-{'f1_val': 0.6627048654574638, 'auprc': 0.8117980703894078, 'loss_val': 1.066872129747525, 'psi': 0.7223421474302414}
[S13] not sending this round → trigger blocked (psi=0.766)
[S14] START round=95 head_norm_before_train=1.845232 cos_to_last_merge=0.9563 (last merge round=36)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9328031460040513, 'auprc': 0.9992201423971918, 'loss_val': 0.1735171224856795, 'psi': 0.9593699445613075}-{'f1_val': 0.9982556529300721, 'auprc': 0.999233306456908, 'loss_val': 0.0193770585680088, 'psi': 0.9986467143408065}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.544564 (no previous merge yet)
[S15] round=95 local utility u=0.020010 metrics={'f1_val': 0.992581502115965, 'auprc': 0.9953583376378934, 'loss_val': 0.03141851422203162, 'psi': 0.9936922363247362}-{'f1_val': 0.986662799494812, 'auprc': 0.9953107200315872, 'loss_val': 0.035782757889803826, 'psi': 0.990121967709522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=95 head_norm_before_train=2.102175 cos_to_last_merge=0.7444 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.744
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.8850344150859315, 'auprc': 0.9763609481321037, 'loss_val': 0.6761691032830487, 'psi': 0.9215650283044003}-{'f1_val': 0.9938082643088795, 'auprc': 0.9883990659904255, 'loss_val': 0.03560100369123001, 'psi': 0.9916445849814979}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.319604 cos_to_last_merge=0.7622 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.8837516396316805, 'auprc': 0.9075510469607072, 'loss_val': 0.6660009973672988, 'psi': 0.8932714025632912}-{'f1_val': 0.8939993326570053, 'auprc': 0.9349602748099728, 'loss_val': 0.5885160200736371, 'psi': 0.9103837095181923}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.300019 (no previous merge yet)
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.676214688533207, 'auprc': 0.8591676461420072, 'loss_val': 0.870851674223574, 'psi': 0.749395871576727}-{'f1_val': 0.8276109090358328, 'auprc': 0.9894050404011193, 'loss_val': 0.3608916113475732, 'psi': 0.8923285615819474}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.186959 cos_to_last_merge=0.9106 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.7001457439287414, 'auprc': 0.8985454902611432, 'loss_val': 1.1194605150623116, 'psi': 0.7795056424617022}-{'f1_val': 0.9399456629201357, 'auprc': 0.9961952953067698, 'loss_val': 0.1586442726888111, 'psi': 0.9624455158747893}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.314049 (no previous merge yet)
[S4] round=96 local utility u=0.040497 metrics={'f1_val': 0.9556663445292836, 'auprc': 0.9625221702361761, 'loss_val': 0.33216078816761935, 'psi': 0.9584086748120406}-{'f1_val': 0.9524242067266944, 'auprc': 0.9475267643749443, 'loss_val': 0.34871552786949117, 'psi': 0.9504652297859943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=96 head_norm_before_train=1.964007 cos_to_last_merge=0.9761 (last merge round=35)
[S5] round=96 local utility u=0.482493 metrics={'f1_val': 0.8282601650863282, 'auprc': 0.9771952465142063, 'loss_val': 0.24089271582217167, 'psi': 0.8878341976574795}-{'f1_val': 0.7004932948021524, 'auprc': 0.9573030380209966, 'loss_val': 0.3795998846563591, 'psi': 0.8032171920896901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=96 head_norm_before_train=2.474767 cos_to_last_merge=0.9272 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.8207995978152096, 'auprc': 0.9334088285800228, 'loss_val': 0.6918508474358986, 'psi': 0.8658432901211349}-{'f1_val': 0.9854635751170875, 'auprc': 0.9846635233035133, 'loss_val': 0.048618813267860175, 'psi': 0.9851435543916578}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.949862 cos_to_last_merge=0.9926 (last merge round=41)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.6158795140175748, 'auprc': 0.7967685095277905, 'loss_val': 0.8099802778210686, 'psi': 0.6882351122216611}-{'f1_val': 0.6724120396415607, 'auprc': 0.8244244965309394, 'loss_val': 0.38627812839988507, 'psi': 0.7332170223973122}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.336355 cos_to_last_merge=0.7871 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.787
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.8849775793858672, 'auprc': 0.9995102665031703, 'loss_val': 0.2959944242942496, 'psi': 0.9307906542327884}-{'f1_val': 0.9840166049584727, 'auprc': 0.9994433350893903, 'loss_val': 0.04976170707512983, 'psi': 0.9901872970108396}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.254067 (no previous merge yet)
[S9] round=96 local utility u=0.000011 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955882544555161, 'loss_val': 0.018450452931948354, 'psi': 0.9962316088705413}-{'f1_val': 0.9966605118138915, 'auprc': 0.99559081954223, 'loss_val': 0.018479599020563554, 'psi': 0.9962326349052268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=96 head_norm_before_train=2.239497 cos_to_last_merge=0.9556 (last merge round=35)
[S10] round=96 local utility u=0.000167 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946349455595533, 'loss_val': 0.026671630165924637, 'psi': 0.9949666816354461}-{'f1_val': 0.9951878390193748, 'auprc': 0.9945269727711767, 'loss_val': 0.026681602878250135, 'psi': 0.9949234925200956}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=96 head_norm_before_train=2.416828 (no previous merge yet)
[S11] round=96 local utility u=0.022102 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9978283743500732, 'loss_val': 0.02031308038218258, 'psi': 0.9968115546880149}-{'f1_val': 0.9912789488544049, 'auprc': 0.9980458323989391, 'loss_val': 0.036040337533836564, 'psi': 0.9939857022722186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=96 head_norm_before_train=2.094924 cos_to_last_merge=0.9865 (last merge round=41)
[S13] round=96 local utility u=0.157166 metrics={'f1_val': 0.7330276263257348, 'auprc': 0.8268668285555743, 'loss_val': 0.9794016126435741, 'psi': 0.7705633072176705}-{'f1_val': 0.6914333828526378, 'auprc': 0.8780407165689993, 'loss_val': 1.1976890272354663, 'psi': 0.7660763163391824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=96 head_norm_before_train=1.851254 cos_to_last_merge=0.9559 (last merge round=36)
[S14] round=96 local utility u=0.003863 metrics={'f1_val': 0.9343386049549338, 'auprc': 0.9992044421701369, 'loss_val': 0.17495694993750766, 'psi': 0.9602849398410152}-{'f1_val': 0.9328031460040513, 'auprc': 0.9992201423971918, 'loss_val': 0.1735171224856795, 'psi': 0.9593699445613075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=96 head_norm_before_train=2.548430 (no previous merge yet)
[S15] round=96 local utility u=0.001616 metrics={'f1_val': 0.993000306567307, 'auprc': 0.9953756127651411, 'loss_val': 0.030751625963872344, 'psi': 0.9939504290464406}-{'f1_val': 0.992581502115965, 'auprc': 0.9953583376378934, 'loss_val': 0.03141851422203162, 'psi': 0.9936922363247362}
[S15] not sending this round → trigger blocked (psi=0.994)
[S16] START round=96 head_norm_before_train=2.106312 cos_to_last_merge=0.7441 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.744
[S16] round=96 local utility u=0.444407 metrics={'f1_val': 0.9474798624215939, 'auprc': 0.9871270104781227, 'loss_val': 0.19432564938067873, 'psi': 0.9633387216442054}-{'f1_val': 0.8850344150859315, 'auprc': 0.9763609481321037, 'loss_val': 0.6761691032830487, 'psi': 0.9215650283044003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=96 head_norm_before_train=2.324387 cos_to_last_merge=0.7621 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=96 local utility u=0.128084 metrics={'f1_val': 0.897795789222443, 'auprc': 0.9397659469313446, 'loss_val': 0.590743396708855, 'psi': 0.9145838523060036}-{'f1_val': 0.8837516396316805, 'auprc': 0.9075510469607072, 'loss_val': 0.6660009973672988, 'psi': 0.8932714025632912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=97 head_norm_before_train=2.302598 (no previous merge yet)
[S2] round=97 local utility u=1.000000 metrics={'f1_val': 0.9012237566130311, 'auprc': 0.9429133529477656, 'loss_val': 0.22439300251663385, 'psi': 0.9178995951469249}-{'f1_val': 0.676214688533207, 'auprc': 0.8591676461420072, 'loss_val': 0.870851674223574, 'psi': 0.749395871576727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=97 head_norm_before_train=2.191342 cos_to_last_merge=0.9101 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=97 local utility u=1.000000 metrics={'f1_val': 0.9530819000623059, 'auprc': 0.9875536705842703, 'loss_val': 0.16914150406442052, 'psi': 0.9668706082710916}-{'f1_val': 0.7001457439287414, 'auprc': 0.8985454902611432, 'loss_val': 1.1194605150623116, 'psi': 0.7795056424617022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=97 head_norm_before_train=2.306927 (no previous merge yet)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9560395946768904, 'auprc': 0.9460068691548715, 'loss_val': 0.32859028814255375, 'psi': 0.9520265044680829}-{'f1_val': 0.9556663445292836, 'auprc': 0.9625221702361761, 'loss_val': 0.33216078816761935, 'psi': 0.9584086748120406}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.965701 cos_to_last_merge=0.9759 (last merge round=35)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.6393525454079155, 'auprc': 0.8308005633614752, 'loss_val': 0.6632180323224646, 'psi': 0.7159317525893394}-{'f1_val': 0.8282601650863282, 'auprc': 0.9771952465142063, 'loss_val': 0.24089271582217167, 'psi': 0.8878341976574795}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.483145 cos_to_last_merge=0.9266 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.7418024454538242, 'auprc': 0.756179799522085, 'loss_val': 1.156057011226468, 'psi': 0.7475533870811286}-{'f1_val': 0.8207995978152096, 'auprc': 0.9334088285800228, 'loss_val': 0.6918508474358986, 'psi': 0.8658432901211349}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=1.954715 cos_to_last_merge=0.9923 (last merge round=41)
[S7] round=97 local utility u=1.000000 metrics={'f1_val': 0.8277590250848288, 'auprc': 0.9034196465213058, 'loss_val': 0.19323868040076317, 'psi': 0.8580232736594195}-{'f1_val': 0.6158795140175748, 'auprc': 0.7967685095277905, 'loss_val': 0.8099802778210686, 'psi': 0.6882351122216611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=97 head_norm_before_train=2.344277 cos_to_last_merge=0.7866 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.787
[S8] round=97 local utility u=0.469437 metrics={'f1_val': 0.9953935680944039, 'auprc': 0.9995435081810253, 'loss_val': 0.019715138949826867, 'psi': 0.9970535441290524}-{'f1_val': 0.8849775793858672, 'auprc': 0.9995102665031703, 'loss_val': 0.2959944242942496, 'psi': 0.9307906542327884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=97 head_norm_before_train=2.259171 (no previous merge yet)
[S9] round=97 local utility u=0.005239 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988169343721527, 'loss_val': 0.01765813838014892, 'psi': 0.997523080837196}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955882544555161, 'loss_val': 0.018450452931948354, 'psi': 0.9962316088705413}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=97 head_norm_before_train=2.243827 cos_to_last_merge=0.9553 (last merge round=35)
[S10] round=97 local utility u=0.000017 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946503415108485, 'loss_val': 0.026682920074076397, 'psi': 0.9949728400159643}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946349455595533, 'loss_val': 0.026671630165924637, 'psi': 0.9949666816354461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=97 head_norm_before_train=2.421992 (no previous merge yet)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997695753299711, 'loss_val': 0.021776802777028634, 'psi': 0.9966134040410328}-{'f1_val': 0.9961336749133093, 'auprc': 0.9978283743500732, 'loss_val': 0.02031308038218258, 'psi': 0.9968115546880149}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.098940 cos_to_last_merge=0.9863 (last merge round=41)
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.7438367084708956, 'auprc': 0.8113398698798795, 'loss_val': 1.184923783817798, 'psi': 0.7708379730344892}-{'f1_val': 0.7330276263257348, 'auprc': 0.8268668285555743, 'loss_val': 0.9794016126435741, 'psi': 0.7705633072176705}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=1.857074 cos_to_last_merge=0.9555 (last merge round=36)
[S14] round=97 local utility u=0.270374 metrics={'f1_val': 0.9982556529300721, 'auprc': 0.9992351101815649, 'loss_val': 0.01780264759284071, 'psi': 0.9986474358306693}-{'f1_val': 0.9343386049549338, 'auprc': 0.9992044421701369, 'loss_val': 0.17495694993750766, 'psi': 0.9602849398410152}
[S14] not sending this round → trigger blocked (psi=0.999)
[S15] START round=97 head_norm_before_train=2.552255 (no previous merge yet)
[S15] round=97 local utility u=0.001559 metrics={'f1_val': 0.9934185961837458, 'auprc': 0.9953936020233523, 'loss_val': 0.030197499718090277, 'psi': 0.9942085985195884}-{'f1_val': 0.993000306567307, 'auprc': 0.9953756127651411, 'loss_val': 0.030751625963872344, 'psi': 0.9939504290464406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=97 head_norm_before_train=2.109121 cos_to_last_merge=0.7437 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.744
[S16] round=97 local utility u=0.209091 metrics={'f1_val': 0.9928322505702966, 'auprc': 0.9840092582521891, 'loss_val': 0.0389050693594429, 'psi': 0.9893030536430536}-{'f1_val': 0.9474798624215939, 'auprc': 0.9871270104781227, 'loss_val': 0.19432564938067873, 'psi': 0.9633387216442054}
[S16] not sending this round → trigger blocked (psi=0.989)
[S17] START round=97 head_norm_before_train=2.326347 cos_to_last_merge=0.7618 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=97 local utility u=0.017661 metrics={'f1_val': 0.900852871048816, 'auprc': 0.9441688563718468, 'loss_val': 0.5869730445318337, 'psi': 0.9181792651780283}-{'f1_val': 0.897795789222443, 'auprc': 0.9397659469313446, 'loss_val': 0.590743396708855, 'psi': 0.9145838523060036}
[S17] not sending this round → trigger blocked (psi=0.918)
[S2] START round=98 head_norm_before_train=2.304291 (no previous merge yet)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.832246407471904, 'auprc': 0.9887227634079121, 'loss_val': 0.34708746041135763, 'psi': 0.8948369498463072}-{'f1_val': 0.9012237566130311, 'auprc': 0.9429133529477656, 'loss_val': 0.22439300251663385, 'psi': 0.9178995951469249}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.196155 cos_to_last_merge=0.9097 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=98 local utility u=0.051075 metrics={'f1_val': 0.9581309748733093, 'auprc': 0.9948798591469721, 'loss_val': 0.11926437731888892, 'psi': 0.9728305285827744}-{'f1_val': 0.9530819000623059, 'auprc': 0.9875536705842703, 'loss_val': 0.16914150406442052, 'psi': 0.9668706082710916}
[S3] not sending this round → trigger blocked (psi=0.973)
[S4] START round=98 head_norm_before_train=2.309388 (no previous merge yet)
[S4] round=98 local utility u=0.045461 metrics={'f1_val': 0.9578232118574508, 'auprc': 0.9730835438883224, 'loss_val': 0.3296006554220288, 'psi': 0.9639273446697993}-{'f1_val': 0.9560395946768904, 'auprc': 0.9460068691548715, 'loss_val': 0.32859028814255375, 'psi': 0.9520265044680829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=98 head_norm_before_train=1.967598 cos_to_last_merge=0.9758 (last merge round=35)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.565494274987534, 'auprc': 0.7344596486465991, 'loss_val': 0.9402446296657075, 'psi': 0.6330804244511601}-{'f1_val': 0.6393525454079155, 'auprc': 0.8308005633614752, 'loss_val': 0.6632180323224646, 'psi': 0.7159317525893394}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.491070 cos_to_last_merge=0.9259 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.6038601633617308, 'auprc': 0.6529906380788392, 'loss_val': 1.7298066146175979, 'psi': 0.6235123532485741}-{'f1_val': 0.7418024454538242, 'auprc': 0.756179799522085, 'loss_val': 1.156057011226468, 'psi': 0.7475533870811286}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=98 head_norm_before_train=1.958021 cos_to_last_merge=0.9921 (last merge round=41)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6476409923407929, 'auprc': 0.8086932339437594, 'loss_val': 0.4814504989733883, 'psi': 0.7120618889819794}-{'f1_val': 0.8277590250848288, 'auprc': 0.9034196465213058, 'loss_val': 0.19323868040076317, 'psi': 0.8580232736594195}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.351947 cos_to_last_merge=0.7863 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9294124250128447, 'auprc': 0.9966009557158135, 'loss_val': 0.18697463315743396, 'psi': 0.9562878372940322}-{'f1_val': 0.9953935680944039, 'auprc': 0.9995435081810253, 'loss_val': 0.019715138949826867, 'psi': 0.9970535441290524}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=2.262292 (no previous merge yet)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9988238530100699, 'loss_val': 0.018006346568423988, 'psi': 0.9975258482923628}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988169343721527, 'loss_val': 0.01765813838014892, 'psi': 0.997523080837196}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.246763 cos_to_last_merge=0.9549 (last merge round=35)
[S10] round=98 local utility u=0.000001 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946567449668899, 'loss_val': 0.026700232570708644, 'psi': 0.9949754013983808}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946503415108485, 'loss_val': 0.026682920074076397, 'psi': 0.9949728400159643}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.425947 (no previous merge yet)
[S11] round=98 local utility u=0.003131 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978581926111934, 'loss_val': 0.01993391382802176, 'psi': 0.9970714797526311}-{'f1_val': 0.9958918378685807, 'auprc': 0.997695753299711, 'loss_val': 0.021776802777028634, 'psi': 0.9966134040410328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=98 head_norm_before_train=2.107283 cos_to_last_merge=0.9858 (last merge round=41)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.7255410689742405, 'auprc': 0.8343594205846294, 'loss_val': 1.1449653172107934, 'psi': 0.7690684096183961}-{'f1_val': 0.7438367084708956, 'auprc': 0.8113398698798795, 'loss_val': 1.184923783817798, 'psi': 0.7708379730344892}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=1.859761 cos_to_last_merge=0.9553 (last merge round=36)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9974562277245294, 'auprc': 0.9974624912107513, 'loss_val': 0.020579281551336454, 'psi': 0.9974587331190181}-{'f1_val': 0.9982556529300721, 'auprc': 0.9992351101815649, 'loss_val': 0.01780264759284071, 'psi': 0.9986474358306693}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.555912 (no previous merge yet)
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.993000306567307, 'auprc': 0.9954466678228346, 'loss_val': 0.031086650684050376, 'psi': 0.993978851069518}-{'f1_val': 0.9934185961837458, 'auprc': 0.9953936020233523, 'loss_val': 0.030197499718090277, 'psi': 0.9942085985195884}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.109997 cos_to_last_merge=0.7431 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.743
[S16] round=98 local utility u=0.000000 metrics={'f1_val': 0.8646043803664069, 'auprc': 0.981304134331509, 'loss_val': 0.46834160788807244, 'psi': 0.9112842819524477}-{'f1_val': 0.9928322505702966, 'auprc': 0.9840092582521891, 'loss_val': 0.0389050693594429, 'psi': 0.9893030536430536}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=98 head_norm_before_train=2.332369 cos_to_last_merge=0.7613 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.9024110550602966, 'auprc': 0.9410169348148971, 'loss_val': 0.6161129302911954, 'psi': 0.9178534069621368}-{'f1_val': 0.900852871048816, 'auprc': 0.9441688563718468, 'loss_val': 0.5869730445318337, 'psi': 0.9181792651780283}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.306950 (no previous merge yet)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.8304349530497573, 'auprc': 0.9236914810277153, 'loss_val': 0.3860968066858216, 'psi': 0.8677375642409405}-{'f1_val': 0.832246407471904, 'auprc': 0.9887227634079121, 'loss_val': 0.34708746041135763, 'psi': 0.8948369498463072}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.868 u=0.0000 p_local=0.1639 f1=0.830 auprc=0.924 bytes=71872
[S3] START round=99 head_norm_before_train=2.200631 cos_to_last_merge=0.9093 (last merge round=41)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.9261295863447576, 'auprc': 0.9948138021997813, 'loss_val': 0.1821394248515224, 'psi': 0.9536032726867671}-{'f1_val': 0.9581309748733093, 'auprc': 0.9948798591469721, 'loss_val': 0.11926437731888892, 'psi': 0.9728305285827744}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.954 u=0.0000 p_local=0.2695 f1=0.926 auprc=0.995 bytes=73855
[S4] START round=99 head_norm_before_train=2.317497 (no previous merge yet)
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.957893657917618, 'auprc': 0.978042925599459, 'loss_val': 0.34562004892369497, 'psi': 0.9659533649903544}-{'f1_val': 0.9578232118574508, 'auprc': 0.9730835438883224, 'loss_val': 0.3296006554220288, 'psi': 0.9639273446697993}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.966 u=0.0000 p_local=0.0182 f1=0.958 auprc=0.978 bytes=77351
[S5] START round=99 head_norm_before_train=1.970038 cos_to_last_merge=0.9757 (last merge round=35)
[S5] round=99 local utility u=1.000000 metrics={'f1_val': 0.8358091095409708, 'auprc': 0.9959175082920441, 'loss_val': 0.1597202608637419, 'psi': 0.8998524690414}-{'f1_val': 0.565494274987534, 'auprc': 0.7344596486465991, 'loss_val': 0.9402446296657075, 'psi': 0.6330804244511601}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=100 psi=0.900 u=1.0000 p_local=0.4226 f1=0.836 auprc=0.996 bytes=79207
[S6] START round=99 head_norm_before_train=2.500193 cos_to_last_merge=0.9252 (last merge round=42)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=99 local utility u=1.000000 metrics={'f1_val': 0.9309104770055406, 'auprc': 0.9603642800239321, 'loss_val': 0.22319458832799707, 'psi': 0.9426919982128972}-{'f1_val': 0.6038601633617308, 'auprc': 0.6529906380788392, 'loss_val': 1.7298066146175979, 'psi': 0.6235123532485741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=100 psi=0.943 u=1.0000 p_local=0.3556 f1=0.931 auprc=0.960 bytes=73808
[S7] START round=99 head_norm_before_train=1.960642 cos_to_last_merge=0.9920 (last merge round=41)
[S7] round=99 local utility u=0.153590 metrics={'f1_val': 0.6749309388841945, 'auprc': 0.8264392824112562, 'loss_val': 0.39124888250945705, 'psi': 0.7355342762950192}-{'f1_val': 0.6476409923407929, 'auprc': 0.8086932339437594, 'loss_val': 0.4814504989733883, 'psi': 0.7120618889819794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S7] r=100 psi=0.736 u=0.1536 p_local=0.2246 f1=0.675 auprc=0.826 bytes=79235
[S8] START round=99 head_norm_before_train=2.359048 cos_to_last_merge=0.7860 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.786
[S8] round=99 local utility u=0.200776 metrics={'f1_val': 0.9759735080349061, 'auprc': 0.9994084483644163, 'loss_val': 0.07321222029030368, 'psi': 0.9853474841667103}-{'f1_val': 0.9294124250128447, 'auprc': 0.9966009557158135, 'loss_val': 0.18697463315743396, 'psi': 0.9562878372940322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=100 psi=0.985 u=0.2008 p_local=0.1173 f1=0.976 auprc=0.999 bytes=79124
[S9] START round=99 head_norm_before_train=2.263478 (no previous merge yet)
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9972443819141117, 'loss_val': 0.0186179845407974, 'psi': 0.9968940598539795}-{'f1_val': 0.9966605118138915, 'auprc': 0.9988238530100699, 'loss_val': 0.018006346568423988, 'psi': 0.9975258482923628}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.997 u=0.0000 p_local=0.0021 f1=0.997 auprc=0.997 bytes=73752
[S10] START round=99 head_norm_before_train=2.251186 cos_to_last_merge=0.9545 (last merge round=35)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.994244274559166, 'loss_val': 0.02673586091543144, 'psi': 0.9948104132352913}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946567449668899, 'loss_val': 0.026700232570708644, 'psi': 0.9949754013983808}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.994 bytes=73759
[S11] START round=99 head_norm_before_train=2.425848 (no previous merge yet)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978180629470714, 'loss_val': 0.019995838359349496, 'psi': 0.9970554278869823}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978581926111934, 'loss_val': 0.01993391382802176, 'psi': 0.9970714797526311}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0125 f1=0.997 auprc=0.998 bytes=66531
[S13] START round=99 head_norm_before_train=2.111975 cos_to_last_merge=0.9856 (last merge round=41)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.6129968936230279, 'auprc': 0.7512724448722322, 'loss_val': 1.4909607706609487, 'psi': 0.6683071141227097}-{'f1_val': 0.7255410689742405, 'auprc': 0.8343594205846294, 'loss_val': 1.1449653172107934, 'psi': 0.7690684096183961}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=100 psi=0.668 u=0.0000 p_local=0.0909 f1=0.613 auprc=0.751 bytes=73835
[S14] START round=99 head_norm_before_train=1.862773 cos_to_last_merge=0.9550 (last merge round=36)
[S14] round=99 local utility u=0.000513 metrics={'f1_val': 0.9968032263876003, 'auprc': 0.9992277617355297, 'loss_val': 0.020930669622074294, 'psi': 0.9977730405267722}-{'f1_val': 0.9974562277245294, 'auprc': 0.9974624912107513, 'loss_val': 0.020579281551336454, 'psi': 0.9974587331190181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=100 psi=0.998 u=0.0005 p_local=0.0388 f1=0.997 auprc=0.999 bytes=84623
[S15] START round=99 head_norm_before_train=2.559576 (no previous merge yet)
[S15] round=99 local utility u=0.000000 metrics={'f1_val': 0.993000306567307, 'auprc': 0.99539570395632, 'loss_val': 0.031258963062255174, 'psi': 0.9939584655229121}-{'f1_val': 0.993000306567307, 'auprc': 0.9954466678228346, 'loss_val': 0.031086650684050376, 'psi': 0.993978851069518}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=100 psi=0.994 u=0.0000 p_local=0.0032 f1=0.993 auprc=0.995 bytes=68255
[S16] START round=99 head_norm_before_train=2.112986 cos_to_last_merge=0.7427 (last merge round=1)
[S16] ⚠️ Model drifted since last merge! cos=0.743
[S16] round=99 local utility u=0.607542 metrics={'f1_val': 0.9924479692291859, 'auprc': 0.9884180245701866, 'loss_val': 0.04166130855811247, 'psi': 0.9908359913655862}-{'f1_val': 0.8646043803664069, 'auprc': 0.981304134331509, 'loss_val': 0.46834160788807244, 'psi': 0.9112842819524477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S16] r=100 psi=0.991 u=0.6075 p_local=0.2003 f1=0.992 auprc=0.988 bytes=70078
[S17] START round=99 head_norm_before_train=2.339589 cos_to_last_merge=0.7608 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.8917115701901779, 'auprc': 0.9311781125226976, 'loss_val': 0.6519639187215498, 'psi': 0.9074981871231858}-{'f1_val': 0.9024110550602966, 'auprc': 0.9410169348148971, 'loss_val': 0.6161129302911954, 'psi': 0.9178534069621368}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.907 u=0.0000 p_local=0.0491 f1=0.892 auprc=0.931 bytes=73678
[runner] rounds complete.
[runner] all agents stopped.
