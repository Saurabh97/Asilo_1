[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:39003
[S3] → join 127.0.0.1:39002
[S4] → join 127.0.0.1:39002
[S5] → join 127.0.0.1:39002
[S6] → join 127.0.0.1:39002
[S7] → join 127.0.0.1:39002
[S8] → join 127.0.0.1:39002
[S9] → join 127.0.0.1:39002
[S10] → join 127.0.0.1:39002
[S11] → join 127.0.0.1:39002
[S13] → join 127.0.0.1:39002
[S14] → join 127.0.0.1:39002
[S15] → join 127.0.0.1:39002
[S16] → join 127.0.0.1:39002
[S17] → join 127.0.0.1:39002
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.157945 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.147181 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.174125 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.146857 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.182991 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.121144 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.094231 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.153041 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.130586 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.137834 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.203588 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.135640 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.160973 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.145513 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.122510 (no previous merge yet)
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S3] + discovered S6
[S4] + discovered S3
[S3] + discovered S17
[S3] + discovered S9
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S13
[S4] + discovered S2
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S10
[S3] + discovered S4
[S3] + discovered S5
[S3] + discovered S8
[S3] + discovered S15
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S13
[S4] + discovered S9
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S10
[S4] + discovered S17
[S5] + discovered S4
[S4] + discovered S6
[S4] + discovered S7
[S4] + discovered S16
[S5] + discovered S3
[S4] + discovered S15
[S5] + discovered S2
[S6] + discovered S4
[S5] + discovered S6
[S5] + discovered S9
[S6] + discovered S3
[S5] + discovered S15
[S6] + discovered S5
[S5] + discovered S16
[S5] + discovered S7
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S10
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S14
[S6] + discovered S2
[S7] + discovered S2
[S6] + discovered S7
[S6] + discovered S14
[S6] + discovered S16
[S6] + discovered S11
[S7] + discovered S3
[S6] + discovered S17
[S7] + discovered S5
[S7] + discovered S4
[S6] + discovered S9
[S7] + discovered S6
[S6] + discovered S15
[S6] + discovered S13
[S6] + discovered S8
[S6] + discovered S10
[S7] + discovered S9
[S8] + discovered S5
[S8] + discovered S2
[S7] + discovered S13
[S8] + discovered S6
[S8] + discovered S7
[S7] + discovered S17
[S8] + discovered S3
[S7] + discovered S14
[S7] + discovered S11
[S8] + discovered S4
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S16
[S7] + discovered S10
[S8] + discovered S17
[S8] + discovered S15
[S9] + discovered S4
[S8] + discovered S14
[S9] + discovered S3
[S8] + discovered S10
[S9] + discovered S5
[S8] + discovered S16
[S9] + discovered S7
[S8] + discovered S9
[S9] + discovered S8
[S9] + discovered S6
[S9] + discovered S2
[S8] + discovered S11
[S8] + discovered S13
[S9] + discovered S13
[S9] + discovered S14
[S9] + discovered S11
[S9] + discovered S15
[S10] + discovered S7
[S10] + discovered S2
[S10] + discovered S6
[S10] + discovered S3
[S10] + discovered S5
[S10] + discovered S8
[S10] + discovered S9
[S10] + discovered S4
[S9] + discovered S16
[S9] + discovered S10
[S9] + discovered S17
[S11] + discovered S6
[S11] + discovered S7
[S10] + discovered S15
[S11] + discovered S3
[S11] + discovered S2
[S11] + discovered S4
[S10] + discovered S14
[S10] + discovered S16
[S10] + discovered S17
[S10] + discovered S11
[S11] + discovered S8
[S10] + discovered S13
[S11] + discovered S5
[S11] + discovered S9
[S11] + discovered S10
[S11] + discovered S13
[S13] + discovered S6
[S13] + discovered S9
[S13] + discovered S11
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S16
[S11] + discovered S17
[S13] + discovered S4
[S13] + discovered S5
[S13] + discovered S10
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S3
[S14] + discovered S11
[S13] + discovered S17
[S14] + discovered S9
[S13] + discovered S14
[S13] + discovered S16
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S2
[S14] + discovered S4
[S14] + discovered S5
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S13
[S14] + discovered S8
[S14] + discovered S7
[S15] + discovered S2
[S14] + discovered S17
[S15] + discovered S8
[S15] + discovered S6
[S15] + discovered S11
[S15] + discovered S9
[S15] + discovered S13
[S15] + discovered S14
[S15] + discovered S4
[S15] + discovered S7
[S15] + discovered S10
[S14] + discovered S16
[S15] + discovered S3
[S14] + discovered S15
[S15] + discovered S5
[S16] + discovered S8
[S16] + discovered S11
[S16] + discovered S5
[S15] + discovered S17
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S9
[S15] + discovered S16
[S16] + discovered S7
[S16] + discovered S14
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S2
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S6
[S17] + discovered S8
[S17] + discovered S16
[S17] + discovered S9
[S17] + discovered S5
[S17] + discovered S13
[S16] + discovered S17
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S2
[S17] + discovered S7
[S17] + discovered S4
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] ⇄ pheromone p=1.000 → S14@127.0.0.1:39014
[S3] ⇄ pheromone p=1.000 → S8@127.0.0.1:39009
[S11] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S2] ⇄ pheromone p=1.000 → S9@127.0.0.1:39010
[S16] ⇄ pheromone p=1.000 → S7@127.0.0.1:39008
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:39005
[S15] ⇄ pheromone p=1.000 → S6@127.0.0.1:39007
[S5] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S13] ⇄ pheromone p=1.000 → S4@127.0.0.1:39004
[S9] ⇄ pheromone p=1.000 → S15@127.0.0.1:39015
[S7] ⇄ pheromone p=1.000 → S2@127.0.0.1:39002
[S14] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S6] ⇄ pheromone p=1.000 → S17@127.0.0.1:39017
[S4] ⇄ pheromone p=1.000 → S10@127.0.0.1:39011
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:39016
[S2] START round=1 head_norm_before_train=1.164559 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.9917868104764036, 'loss_val': 1.3036539319756222, 'psi': 0.4817810042237015}-{'f1_val': 0.4153042022794974, 'auprc': 0.9679049772425306, 'loss_val': 1.3340597779856536, 'psi': 0.6363445122647107}
[S3] START round=1 head_norm_before_train=1.151473 (no previous merge yet)
[S3] round=1 local utility u=0.166549 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7715511721606524, 'loss_val': 1.3121517543793928, 'psi': 0.3925245082327252}-{'f1_val': 0.13984006561410703, 'auprc': 0.6723870342076611, 'loss_val': 1.3477575319571455, 'psi': 0.35285885305152864}
[S4] START round=1 head_norm_before_train=1.179459 (no previous merge yet)
[S4] round=1 local utility u=0.249726 metrics={'f1_val': 0.39862588551141653, 'auprc': 0.7530257319956432, 'loss_val': 1.3253489385844865, 'psi': 0.5403858241051072}-{'f1_val': 0.36884262337950824, 'auprc': 0.6569838903468328, 'loss_val': 1.3579753530348504, 'psi': 0.484099130166438}
[S5] START round=1 head_norm_before_train=1.158262 (no previous merge yet)
[S5] round=1 local utility u=0.059238 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.5877846920632364, 'loss_val': 1.304428009579435, 'psi': 0.3204710196824374}-{'f1_val': 0.14226190476190476, 'auprc': 0.5609027386287079, 'loss_val': 1.3422575594901711, 'psi': 0.309718238308626}
[S6] START round=1 head_norm_before_train=1.186643 (no previous merge yet)
[S6] round=1 local utility u=0.018816 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6391000677673288, 'loss_val': 1.3309786072802527, 'psi': 0.3404957963377007}-{'f1_val': 0.14142628205128205, 'auprc': 0.6389634129390289, 'loss_val': 1.3682012203932725, 'psi': 0.3404411344063808}
[S7] START round=1 head_norm_before_train=1.123726 (no previous merge yet)
[S7] round=1 local utility u=0.278562 metrics={'f1_val': 0.4248250770685169, 'auprc': 0.782398357680215, 'loss_val': 1.3398093806644562, 'psi': 0.5678543893131962}-{'f1_val': 0.37429727734860596, 'auprc': 0.7084482940904883, 'loss_val': 1.3719172757990719, 'psi': 0.5079576840453589}
[S8] START round=1 head_norm_before_train=1.100469 (no previous merge yet)
[S8] round=1 local utility u=0.012902 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6010568554590388, 'loss_val': 1.3218578273691894, 'psi': 0.3243963316193898}-{'f1_val': 0.13995598239295717, 'auprc': 0.6033021324562898, 'loss_val': 1.354397476679994, 'psi': 0.32529444241829025}
[S9] START round=1 head_norm_before_train=1.153910 (no previous merge yet)
[S9] round=1 local utility u=0.154697 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7035601660457232, 'loss_val': 1.3190752515237008, 'psi': 0.36626284070228693}-{'f1_val': 0.141397957139996, 'auprc': 0.6150641675535258, 'loss_val': 1.3629814107042855, 'psi': 0.33086444130540793}
[S10] START round=1 head_norm_before_train=1.135950 (no previous merge yet)
[S10] round=1 local utility u=0.131234 metrics={'f1_val': 0.40978787907781233, 'auprc': 0.6008799244068189, 'loss_val': 1.3160269403313383, 'psi': 0.48622469720941497}-{'f1_val': 0.3882340341581647, 'auprc': 0.5675722264491128, 'loss_val': 1.3492482153042475, 'psi': 0.459969311074544}
[S11] START round=1 head_norm_before_train=1.144226 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.39638486531124173, 'auprc': 0.7959414365175629, 'loss_val': 1.3263873726622837, 'psi': 0.5562074937937702}-{'f1_val': 0.1115175831956573, 'auprc': 0.6640053695541639, 'loss_val': 1.3609263847593918, 'psi': 0.33251269773905995}
[S13] START round=1 head_norm_before_train=1.215787 (no previous merge yet)
[S13] round=1 local utility u=0.023024 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6261352426018315, 'loss_val': 1.315486540197465, 'psi': 0.3346855545869645}-{'f1_val': 0.1403857625770531, 'auprc': 0.6223620051720742, 'loss_val': 1.3502151246143366, 'psi': 0.33317625961506153}
[S14] START round=1 head_norm_before_train=1.138165 (no previous merge yet)
[S14] round=1 local utility u=0.090696 metrics={'f1_val': 0.269205467494594, 'auprc': 0.8243850169276219, 'loss_val': 1.3485247856027283, 'psi': 0.4912772872678052}-{'f1_val': 0.3292374718065137, 'auprc': 0.651956040188862, 'loss_val': 1.372822484768775, 'psi': 0.458324899159453}
[S15] START round=1 head_norm_before_train=1.163156 (no previous merge yet)
[S15] round=1 local utility u=0.054257 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7605478584795524, 'loss_val': 1.327151161388472, 'psi': 0.388059334208756}-{'f1_val': 0.13973365136155833, 'auprc': 0.7325371691057694, 'loss_val': 1.351633851846639, 'psi': 0.3768550584592428}
[S16] START round=1 head_norm_before_train=1.153380 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9977583104666407, 'loss_val': 1.3058448713064423, 'psi': 0.4834857943061782}-{'f1_val': 0.4160710281141988, 'auprc': 0.9968417127691418, 'loss_val': 1.3462789672898685, 'psi': 0.6483793019761761}
[S17] START round=1 head_norm_before_train=1.125068 (no previous merge yet)
[S17] round=1 local utility u=0.439609 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4545285441282014, 'loss_val': 1.33757028346962, 'psi': 0.2663807956417112}-{'f1_val': 0.09277442094662638, 'auprc': 0.26594678899285273, 'loss_val': 1.3619967060141327, 'psi': 0.16204336816511694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S5] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:39015
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S6] → sending delta(kind=head bytes=1786) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S10@127.0.0.1:39011
[S5] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S6] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1790) from S14
[S4] cosine check vs S14: cos=-0.0070
[S4] DROPPED delta from S14 (cos=-0.0070 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S13
[S5] cosine check vs S13: cos=0.0073
[S5] RECEIVED delta(kind=head bytes=1789) from S4
[S5] cosine check vs S4: cos=-0.0480
[S5] DROPPED delta from S4 (cos=-0.0480 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1795) from S15
[S7] cosine check vs S15: cos=0.0652
[S9] RECEIVED delta(kind=head bytes=1786) from S6
[S9] cosine check vs S6: cos=0.0187
[S15] RECEIVED delta(kind=head bytes=1791) from S5
[S15] cosine check vs S5: cos=-0.0140
[S15] DROPPED delta from S5 (cos=-0.0140 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1792) from S10
[S15] cosine check vs S10: cos=-0.0666
[S15] DROPPED delta from S10 (cos=-0.0666 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S11
[S7] cosine check vs S11: cos=-0.0553
[S7] DROPPED delta from S11 (cos=-0.0553 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1787) from S8
[S10] cosine check vs S8: cos=-0.0293
[S10] DROPPED delta from S8 (cos=-0.0293 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1789) from S9
[S10] cosine check vs S9: cos=-0.0851
[S10] DROPPED delta from S9 (cos=-0.0851 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1792) from S3
[S5] cosine check vs S3: cos=0.0754
[S14] RECEIVED delta(kind=head bytes=1796) from S7
[S14] cosine check vs S7: cos=-0.0592
[S14] DROPPED delta from S7 (cos=-0.0592 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S8@127.0.0.1:39009
[S17] sending update (kind=head size=1787 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1787) from S17
[S8] cosine check vs S17: cos=0.0078
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.4248 head_norm=1.137669
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.896090e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.842874 delta_norm=0.789609
[S7] aggregate: ROLLBACK (f1_val pre=0.425 post=0.142 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.163552
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.264046e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.842024 delta_norm=0.826405
[S9] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.180120
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.260417e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1041 head_norm=0.764454 delta_norm=0.726042
[S5] aggregate: ROLLBACK (f1_val pre=0.142 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.117200
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.930425e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.799244 delta_norm=0.793043
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.180060 (no previous merge yet)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8427647184917284, 'loss_val': 1.2688388496246203, 'psi': 0.42217216742983144}-{'f1_val': 0.1417771333885667, 'auprc': 0.9917868104764036, 'loss_val': 1.3036539319756222, 'psi': 0.4817810042237015}
[S3] START round=2 head_norm_before_train=1.167323 (no previous merge yet)
[S3] round=2 local utility u=0.075680 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8100117379425039, 'loss_val': 1.2761729673427864, 'psi': 0.40790873454546583}-{'f1_val': 0.13984006561410703, 'auprc': 0.7715511721606524, 'loss_val': 1.3121517543793928, 'psi': 0.3925245082327252}
[S4] START round=2 head_norm_before_train=1.195779 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7553509432406622, 'loss_val': 1.283840704674401, 'psi': 0.3862763546333754}-{'f1_val': 0.39862588551141653, 'auprc': 0.7530257319956432, 'loss_val': 1.3253489385844865, 'psi': 0.5403858241051072}
[S5] START round=2 head_norm_before_train=0.764454 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.475781 metrics={'f1_val': 0.3193552853549637, 'auprc': 0.5518887210257055, 'loss_val': 1.3077388629186737, 'psi': 0.4123686596232604}-{'f1_val': 0.14226190476190476, 'auprc': 0.5877846920632364, 'loss_val': 1.304428009579435, 'psi': 0.3204710196824374}
[S6] START round=2 head_norm_before_train=1.195845 (no previous merge yet)
[S6] round=2 local utility u=0.005759 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6306925315466884, 'loss_val': 1.2942381907144178, 'psi': 0.33713278184944456}-{'f1_val': 0.14142628205128205, 'auprc': 0.6391000677673288, 'loss_val': 1.3309786072802527, 'psi': 0.3404957963377007}
[S7] START round=2 head_norm_before_train=0.842874 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7994734254381928, 'loss_val': 1.335655265112823, 'psi': 0.40502346381273213}-{'f1_val': 0.4248250770685169, 'auprc': 0.782398357680215, 'loss_val': 1.3398093806644562, 'psi': 0.5678543893131962}
[S8] START round=2 head_norm_before_train=0.799244 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.259628 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7708508722723899, 'loss_val': 1.3119835926722885, 'psi': 0.39231393834473033}-{'f1_val': 0.13995598239295717, 'auprc': 0.6010568554590388, 'loss_val': 1.3218578273691894, 'psi': 0.3243963316193898}
[S9] START round=2 head_norm_before_train=0.842024 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.226387 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8541613794574774, 'loss_val': 1.3181039127252716, 'psi': 0.4265033260669886}-{'f1_val': 0.141397957139996, 'auprc': 0.7035601660457232, 'loss_val': 1.3190752515237008, 'psi': 0.36626284070228693}
[S10] START round=2 head_norm_before_train=1.152461 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.14748658248127408, 'auprc': 0.6283119171993922, 'loss_val': 1.2774289126107397, 'psi': 0.3398167163685213}-{'f1_val': 0.40978787907781233, 'auprc': 0.6008799244068189, 'loss_val': 1.3160269403313383, 'psi': 0.48622469720941497}
[S11] START round=2 head_norm_before_train=1.160154 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7854566612830963, 'loss_val': 1.2808887685251844, 'psi': 0.3984308745371049}-{'f1_val': 0.39638486531124173, 'auprc': 0.7959414365175629, 'loss_val': 1.3263873726622837, 'psi': 0.5562074937937702}
[S13] START round=2 head_norm_before_train=1.235025 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6125814119007291, 'loss_val': 1.2826696372087507, 'psi': 0.3292640223065235}-{'f1_val': 0.1403857625770531, 'auprc': 0.6261352426018315, 'loss_val': 1.315486540197465, 'psi': 0.3346855545869645}
[S14] START round=2 head_norm_before_train=1.149269 (no previous merge yet)
[S14] round=2 local utility u=0.432078 metrics={'f1_val': 0.3940164667834618, 'auprc': 0.853890397639865, 'loss_val': 1.3217507567734803, 'psi': 0.5779660391260231}-{'f1_val': 0.269205467494594, 'auprc': 0.8243850169276219, 'loss_val': 1.3485247856027283, 'psi': 0.4912772872678052}
[S15] START round=2 head_norm_before_train=1.171984 (no previous merge yet)
[S15] round=2 local utility u=0.027477 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7691464309699194, 'loss_val': 1.2979929900256348, 'psi': 0.3914987632049028}-{'f1_val': 0.13973365136155833, 'auprc': 0.7605478584795524, 'loss_val': 1.327151161388472, 'psi': 0.388059334208756}
[S16] START round=2 head_norm_before_train=1.171822 (no previous merge yet)
[S16] round=2 local utility u=0.022335 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9966033940077152, 'loss_val': 1.2577098595667278, 'psi': 0.483023827722608}-{'f1_val': 0.14063745019920318, 'auprc': 0.9977583104666407, 'loss_val': 1.3058448713064423, 'psi': 0.4834857943061782}
[S17] START round=2 head_norm_before_train=1.134582 (no previous merge yet)
[S17] round=2 local utility u=0.241739 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.6068001594910764, 'loss_val': 1.3109070973183974, 'psi': 0.32728944178686115}-{'f1_val': 0.14094896331738438, 'auprc': 0.4545285441282014, 'loss_val': 1.33757028346962, 'psi': 0.2663807956417112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S13@127.0.0.1:39013
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S16] → sending delta(kind=head bytes=1785) to S10@127.0.0.1:39011
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:39016
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:39002
[S15] sending update (kind=head size=1791 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1785 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1785) from S16
[S10] cosine check vs S16: cos=0.0905
[S13] RECEIVED delta(kind=head bytes=1789) from S6
[S13] cosine check vs S6: cos=0.0308
[S10] RECEIVED delta(kind=head bytes=1796) from S8
[S10] cosine check vs S8: cos=0.0213
[S7] RECEIVED delta(kind=head bytes=1791) from S15
[S7] cosine check vs S15: cos=0.7192
[S10] RECEIVED delta(kind=head bytes=1803) from S5
[S10] cosine check vs S5: cos=-0.0218
[S10] DROPPED delta from S5 (cos=-0.0218 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=-0.0135
[S2] DROPPED delta from S3 (cos=-0.0135 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S9
[S6] cosine check vs S9: cos=0.7044
[S16] RECEIVED delta(kind=head bytes=1791) from S14
[S16] cosine check vs S14: cos=-0.0276
[S16] DROPPED delta from S14 (cos=-0.0276 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:39004
[S17] sending update (kind=head size=1791 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1791) from S17
[S4] cosine check vs S17: cos=-0.0382
[S4] DROPPED delta from S17 (cos=-0.0382 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=2 metric=0.1421 head_norm=0.858573
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.139680e-01
[S7] stored merged vector for next round verification (round=2)
[S7] DEBUG after merge:  round=2 metric=0.1421 head_norm=0.952496 delta_norm=0.413968
[S7] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.258152
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.593934e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.886231 delta_norm=0.859393
[S13] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1475 head_norm=1.174502
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.704772e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.723661 delta_norm=0.670477
[S10] aggregate: ROLLBACK (f1_val pre=0.147 post=0.139 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=2 metric=0.1414 head_norm=1.210363
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.295520e-01
[S6] stored merged vector for next round verification (round=2)
[S6] DEBUG after merge:  round=2 metric=0.1414 head_norm=0.955666 delta_norm=0.429552
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.201889 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.8006298700240464, 'loss_val': 1.2237081973745432, 'psi': 0.40531822804275863}-{'f1_val': 0.1417771333885667, 'auprc': 0.8427647184917284, 'loss_val': 1.2688388496246203, 'psi': 0.42217216742983144}
[S3] START round=3 head_norm_before_train=1.187994 (no previous merge yet)
[S3] round=3 local utility u=0.030251 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.817147334532375, 'loss_val': 1.2370775814664825, 'psi': 0.4107629731814142}-{'f1_val': 0.13984006561410703, 'auprc': 0.8100117379425039, 'loss_val': 1.2761729673427864, 'psi': 0.40790873454546583}
[S4] START round=3 head_norm_before_train=1.221211 (no previous merge yet)
[S4] round=3 local utility u=0.045254 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7658061854166371, 'loss_val': 1.2246988476317675, 'psi': 0.39045845150376535}-{'f1_val': 0.14022662889518414, 'auprc': 0.7553509432406622, 'loss_val': 1.283840704674401, 'psi': 0.3862763546333754}
[S5] START round=3 head_norm_before_train=0.789746 cos_to_last_merge=0.9966 (last merge round=1)
[S5] round=3 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.6370048067636238, 'loss_val': 1.2569022499069267, 'psi': 0.3401590655625924}-{'f1_val': 0.3193552853549637, 'auprc': 0.5518887210257055, 'loss_val': 1.3077388629186737, 'psi': 0.4123686596232604}
[S6] START round=3 head_norm_before_train=0.955666 cos_to_last_merge=1.0000 (last merge round=2)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6120982854544699, 'loss_val': 1.273366040610665, 'psi': 0.32969508341255716}-{'f1_val': 0.14142628205128205, 'auprc': 0.6306925315466884, 'loss_val': 1.2942381907144178, 'psi': 0.33713278184944456}
[S7] START round=3 head_norm_before_train=0.952496 cos_to_last_merge=1.0000 (last merge round=2)
[S7] round=3 local utility u=0.006054 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.8001684482206939, 'loss_val': 1.3256323649396804, 'psi': 0.40530147292573254}-{'f1_val': 0.14205682272909165, 'auprc': 0.7994734254381928, 'loss_val': 1.335655265112823, 'psi': 0.40502346381273213}
[S8] START round=3 head_norm_before_train=0.823272 cos_to_last_merge=0.9968 (last merge round=1)
[S8] round=3 local utility u=0.013225 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7660473271592978, 'loss_val': 1.2711224648122463, 'psi': 0.39039252029949345}-{'f1_val': 0.13995598239295717, 'auprc': 0.7708508722723899, 'loss_val': 1.3119835926722885, 'psi': 0.39231393834473033}
[S9] START round=3 head_norm_before_train=0.854777 cos_to_last_merge=0.9967 (last merge round=1)
[S9] round=3 local utility u=0.228405 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9898155836820818, 'loss_val': 1.2682574023555235, 'psi': 0.48076500775683034}-{'f1_val': 0.141397957139996, 'auprc': 0.8541613794574774, 'loss_val': 1.3181039127252716, 'psi': 0.4265033260669886}
[S10] START round=3 head_norm_before_train=0.723661 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6345100514198843, 'loss_val': 1.2709911417153998, 'psi': 0.33697700309298806}-{'f1_val': 0.14748658248127408, 'auprc': 0.6283119171993922, 'loss_val': 1.2774289126107397, 'psi': 0.3398167163685213}
[S11] START round=3 head_norm_before_train=1.186128 (no previous merge yet)
[S11] round=3 local utility u=0.034153 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.788205249578915, 'loss_val': 1.2208291820093413, 'psi': 0.39953030985543236}-{'f1_val': 0.14041368337311058, 'auprc': 0.7854566612830963, 'loss_val': 1.2808887685251844, 'psi': 0.3984308745371049}
[S13] START round=3 head_norm_before_train=0.886231 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6086736275689336, 'loss_val': 1.2971134426214268, 'psi': 0.3277009085738053}-{'f1_val': 0.1403857625770531, 'auprc': 0.6125814119007291, 'loss_val': 1.2826696372087507, 'psi': 0.3292640223065235}
[S14] START round=3 head_norm_before_train=1.168077 (no previous merge yet)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.856279580949666, 'loss_val': 1.2853667140751903, 'psi': 0.4267265441094887}-{'f1_val': 0.3940164667834618, 'auprc': 0.853890397639865, 'loss_val': 1.3217507567734803, 'psi': 0.5779660391260231}
[S15] START round=3 head_norm_before_train=1.191675 (no previous merge yet)
[S15] round=3 local utility u=0.017519 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7693925841222627, 'loss_val': 1.2636939293202505, 'psi': 0.3915972244658401}-{'f1_val': 0.13973365136155833, 'auprc': 0.7691464309699194, 'loss_val': 1.2979929900256348, 'psi': 0.3914987632049028}
[S16] START round=3 head_norm_before_train=1.201487 (no previous merge yet)
[S16] round=3 local utility u=0.024073 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9933168101340989, 'loss_val': 1.199704884129215, 'psi': 0.4817091941731615}-{'f1_val': 0.14063745019920318, 'auprc': 0.9966033940077152, 'loss_val': 1.2577098595667278, 'psi': 0.483023827722608}
[S17] START round=3 head_norm_before_train=1.151885 (no previous merge yet)
[S17] round=3 local utility u=0.159554 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7015715393100207, 'loss_val': 1.2761131183699208, 'psi': 0.3651979937144389}-{'f1_val': 0.14094896331738438, 'auprc': 0.6068001594910764, 'loss_val': 1.3109070973183974, 'psi': 0.32728944178686115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:39002
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:39007
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:39011
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39005
[S11] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S3
[S8] cosine check vs S3: cos=-0.0331
[S8] DROPPED delta from S3 (cos=-0.0331 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S7
[S2] cosine check vs S7: cos=-0.0238
[S2] DROPPED delta from S7 (cos=-0.0238 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] cosine check vs S15: cos=0.0377
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=-0.0384
[S5] DROPPED delta from S11 (cos=-0.0384 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S8
[S5] cosine check vs S8: cos=-0.0892
[S5] DROPPED delta from S8 (cos=-0.0892 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.0647
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] cosine check vs S4: cos=-0.0070
[S10] DROPPED delta from S4 (cos=-0.0070 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1788) from S16
[S7] cosine check vs S16: cos=0.0053
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] cosine check vs S17: cos=0.0683
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=0.977903
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.665761e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.795325 delta_norm=0.766576
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.963296
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.825132e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.786578 delta_norm=0.782513
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.238598
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.257262e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1406 head_norm=0.884095 delta_norm=0.825726
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=3 metric=0.1397 head_norm=1.218223
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.270576e-01
[S15] stored merged vector for next round verification (round=3)
[S15] DEBUG after merge:  round=3 metric=0.1397 head_norm=0.773129 delta_norm=0.727058
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=1.228539 (no previous merge yet)
[S2] round=4 local utility u=0.010034 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7879720319060358, 'loss_val': 1.1656657652198206, 'psi': 0.4002550927955544}-{'f1_val': 0.1417771333885667, 'auprc': 0.8006298700240464, 'loss_val': 1.2237081973745432, 'psi': 0.40531822804275863}
[S3] START round=4 head_norm_before_train=1.211759 (no previous merge yet)
[S3] round=4 local utility u=0.020171 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8136112963184577, 'loss_val': 1.1861279886030562, 'psi': 0.40934855789584734}-{'f1_val': 0.13984006561410703, 'auprc': 0.817147334532375, 'loss_val': 1.2370775814664825, 'psi': 0.4107629731814142}
[S4] START round=4 head_norm_before_train=1.251288 (no previous merge yet)
[S4] round=4 local utility u=0.043277 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7671433320166785, 'loss_val': 1.1421568301994893, 'psi': 0.3909933101437819}-{'f1_val': 0.14022662889518414, 'auprc': 0.7658061854166371, 'loss_val': 1.2246988476317675, 'psi': 0.39045845150376535}
[S5] START round=4 head_norm_before_train=0.823802 cos_to_last_merge=0.9876 (last merge round=1)
[S5] round=4 local utility u=0.184489 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7413649843443721, 'loss_val': 1.201003822242825, 'psi': 0.3819031365948917}-{'f1_val': 0.14226190476190476, 'auprc': 0.6370048067636238, 'loss_val': 1.2569022499069267, 'psi': 0.3401590655625924}
[S6] START round=4 head_norm_before_train=0.795325 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6121144377646656, 'loss_val': 1.2800159305736685, 'psi': 0.32970154433663545}-{'f1_val': 0.14142628205128205, 'auprc': 0.6120982854544699, 'loss_val': 1.273366040610665, 'psi': 0.32969508341255716}
[S7] START round=4 head_norm_before_train=0.786578 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7943292922811125, 'loss_val': 1.3094506811998339, 'psi': 0.4029658105499}-{'f1_val': 0.14205682272909165, 'auprc': 0.8001684482206939, 'loss_val': 1.3256323649396804, 'psi': 0.40530147292573254}
[S8] START round=4 head_norm_before_train=0.856617 cos_to_last_merge=0.9882 (last merge round=1)
[S8] round=4 local utility u=0.025657 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661179162198674, 'loss_val': 1.2200196606887617, 'psi': 0.3904207559237213}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660473271592978, 'loss_val': 1.2711224648122463, 'psi': 0.39039252029949345}
[S9] START round=4 head_norm_before_train=0.876708 cos_to_last_merge=0.9880 (last merge round=1)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9556758935741826, 'loss_val': 1.2217914220124984, 'psi': 0.4671091317136707}-{'f1_val': 0.141397957139996, 'auprc': 0.9898155836820818, 'loss_val': 1.2682574023555235, 'psi': 0.48076500775683034}
[S10] START round=4 head_norm_before_train=0.751347 cos_to_last_merge=0.9964 (last merge round=2)
[S10] round=4 local utility u=0.102074 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6793475691384095, 'loss_val': 1.2013555601512529, 'psi': 0.3549120101803982}-{'f1_val': 0.13862163754172394, 'auprc': 0.6345100514198843, 'loss_val': 1.2709911417153998, 'psi': 0.33697700309298806}
[S11] START round=4 head_norm_before_train=1.220045 (no previous merge yet)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7576427981919625, 'loss_val': 1.16253853952915, 'psi': 0.38730532930065137}-{'f1_val': 0.14041368337311058, 'auprc': 0.788205249578915, 'loss_val': 1.2208291820093413, 'psi': 0.39953030985543236}
[S13] START round=4 head_norm_before_train=0.910309 cos_to_last_merge=0.9974 (last merge round=2)
[S13] round=4 local utility u=0.123870 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6769370680768036, 'loss_val': 1.2541627908114987, 'psi': 0.35500628477695334}-{'f1_val': 0.1403857625770531, 'auprc': 0.6086736275689336, 'loss_val': 1.2971134426214268, 'psi': 0.3277009085738053}
[S14] START round=4 head_norm_before_train=1.194953 (no previous merge yet)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8131950212378994, 'loss_val': 1.2424115378522695, 'psi': 0.40949272022478206}-{'f1_val': 0.14035785288270378, 'auprc': 0.856279580949666, 'loss_val': 1.2853667140751903, 'psi': 0.4267265441094887}
[S15] START round=4 head_norm_before_train=0.773129 cos_to_last_merge=1.0000 (last merge round=3)
[S15] round=4 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7735532541995412, 'loss_val': 1.2832951174774863, 'psi': 0.3932614924967515}-{'f1_val': 0.13973365136155833, 'auprc': 0.7693925841222627, 'loss_val': 1.2636939293202505, 'psi': 0.3915972244658401}
[S16] START round=4 head_norm_before_train=0.884095 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6148625881716613, 'loss_val': 1.1974818528972224, 'psi': 0.33032750538818645}-{'f1_val': 0.14063745019920318, 'auprc': 0.9933168101340989, 'loss_val': 1.199704884129215, 'psi': 0.4817091941731615}
[S17] START round=4 head_norm_before_train=1.180157 (no previous merge yet)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.643327763679366, 'loss_val': 1.2442519991961467, 'psi': 0.341900483462177}-{'f1_val': 0.14094896331738438, 'auprc': 0.7015715393100207, 'loss_val': 1.2761131183699208, 'psi': 0.3651979937144389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:39011
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39010
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:39009
[S13] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] cosine check vs S2: cos=0.0071
[S17] RECEIVED delta(kind=head bytes=1795) from S5
[S17] cosine check vs S5: cos=-0.0793
[S17] DROPPED delta from S5 (cos=-0.0793 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S3
[S8] cosine check vs S3: cos=-0.0361
[S8] DROPPED delta from S3 (cos=-0.0361 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1793) from S13
[S4] cosine check vs S13: cos=-0.1212
[S4] DROPPED delta from S13 (cos=-0.1212 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0815
[S5] DROPPED delta from S8 (cos=-0.0815 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] cosine check vs S10: cos=0.0269
[S10] RECEIVED delta(kind=head bytes=1798) from S4
[S10] cosine check vs S4: cos=-0.0045
[S10] DROPPED delta from S4 (cos=-0.0045 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=1.232052
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.217550e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.739586 delta_norm=0.721755
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.905319
[S9] _apply_head_vector_avg (torch): Δ‖w‖=7.735245e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.778765 delta_norm=0.773524
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.260963 (no previous merge yet)
[S2] round=5 local utility u=0.023410 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7808201286877243, 'loss_val': 1.0973897238191033, 'psi': 0.3973943315082298}-{'f1_val': 0.1417771333885667, 'auprc': 0.7879720319060358, 'loss_val': 1.1656657652198206, 'psi': 0.4002550927955544}
[S3] START round=5 head_norm_before_train=1.236568 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7375800750286154, 'loss_val': 1.1009511409116775, 'psi': 0.3789360693799104}-{'f1_val': 0.13984006561410703, 'auprc': 0.8136112963184577, 'loss_val': 1.1861279886030562, 'psi': 0.40934855789584734}
[S4] START round=5 head_norm_before_train=1.281163 (no previous merge yet)
[S4] round=5 local utility u=0.893436 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7671712010186544, 'loss_val': 0.9991767751163338, 'psi': 0.5553853465591396}-{'f1_val': 0.14022662889518414, 'auprc': 0.7671433320166785, 'loss_val': 1.1421568301994893, 'psi': 0.3909933101437819}
[S5] START round=5 head_norm_before_train=0.854312 cos_to_last_merge=0.9782 (last merge round=1)
[S5] round=5 local utility u=0.908911 metrics={'f1_val': 0.4163396018254457, 'auprc': 0.7700811419269182, 'loss_val': 1.1137969720383787, 'psi': 0.5578362178660348}-{'f1_val': 0.14226190476190476, 'auprc': 0.7413649843443721, 'loss_val': 1.201003822242825, 'psi': 0.3819031365948917}
[S6] START round=5 head_norm_before_train=0.811823 cos_to_last_merge=0.9965 (last merge round=3)
[S6] round=5 local utility u=0.023956 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6132145362784704, 'loss_val': 1.2354048065845933, 'psi': 0.3301415837421574}-{'f1_val': 0.14142628205128205, 'auprc': 0.6121144377646656, 'loss_val': 1.2800159305736685, 'psi': 0.32970154433663545}
[S7] START round=5 head_norm_before_train=0.802170 cos_to_last_merge=0.9959 (last merge round=3)
[S7] round=5 local utility u=0.022628 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.79490073652316, 'loss_val': 1.265909607756632, 'psi': 0.403194388246719}-{'f1_val': 0.14205682272909165, 'auprc': 0.7943292922811125, 'loss_val': 1.3094506811998339, 'psi': 0.4029658105499}
[S8] START round=5 head_norm_before_train=0.891703 cos_to_last_merge=0.9779 (last merge round=1)
[S8] round=5 local utility u=0.049252 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7740766049598466, 'loss_val': 1.145392420462418, 'psi': 0.393604231419713}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661179162198674, 'loss_val': 1.2200196606887617, 'psi': 0.3904207559237213}
[S9] START round=5 head_norm_before_train=0.778765 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.831371000279747, 'loss_val': 1.238290422321402, 'psi': 0.4173871743958964}-{'f1_val': 0.141397957139996, 'auprc': 0.9556758935741826, 'loss_val': 1.2217914220124984, 'psi': 0.4671091317136707}
[S10] START round=5 head_norm_before_train=0.786054 cos_to_last_merge=0.9869 (last merge round=2)
[S10] round=5 local utility u=1.000000 metrics={'f1_val': 0.4171553117234075, 'auprc': 0.8244126068263911, 'loss_val': 1.0822672906331985, 'psi': 0.5800582297646009}-{'f1_val': 0.13862163754172394, 'auprc': 0.6793475691384095, 'loss_val': 1.2013555601512529, 'psi': 0.3549120101803982}
[S11] START round=5 head_norm_before_train=1.255018 (no previous merge yet)
[S11] round=5 local utility u=0.102422 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7940056540193946, 'loss_val': 1.0667839253868936, 'psi': 0.4018504716316242}-{'f1_val': 0.14041368337311058, 'auprc': 0.7576427981919625, 'loss_val': 1.16253853952915, 'psi': 0.38730532930065137}
[S13] START round=5 head_norm_before_train=0.942205 cos_to_last_merge=0.9907 (last merge round=2)
[S13] round=5 local utility u=0.057634 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.701577515263758, 'loss_val': 1.2128154127883115, 'psi': 0.3648624636517351}-{'f1_val': 0.1403857625770531, 'auprc': 0.6769370680768036, 'loss_val': 1.2541627908114987, 'psi': 0.35500628477695334}
[S14] START round=5 head_norm_before_train=0.739586 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6250467576152823, 'loss_val': 1.2511382487842866, 'psi': 0.33423341477573515}-{'f1_val': 0.14035785288270378, 'auprc': 0.8131950212378994, 'loss_val': 1.2424115378522695, 'psi': 0.40949272022478206}
[S15] START round=5 head_norm_before_train=0.801690 cos_to_last_merge=0.9973 (last merge round=3)
[S15] round=5 local utility u=0.691525 metrics={'f1_val': 0.35814683141003223, 'auprc': 0.7758130469177288, 'loss_val': 1.2175042655845267, 'psi': 0.5252133176131109}-{'f1_val': 0.13973365136155833, 'auprc': 0.7735532541995412, 'loss_val': 1.2832951174774863, 'psi': 0.3932614924967515}
[S16] START round=5 head_norm_before_train=0.916612 cos_to_last_merge=0.9973 (last merge round=3)
[S16] round=5 local utility u=0.844632 metrics={'f1_val': 0.4150731431819776, 'auprc': 0.5942978133984851, 'loss_val': 1.0931377428034454, 'psi': 0.48676301126858057}-{'f1_val': 0.14063745019920318, 'auprc': 0.6148625881716613, 'loss_val': 1.1974818528972224, 'psi': 0.33032750538818645}
[S17] START round=5 head_norm_before_train=1.208174 (no previous merge yet)
[S17] round=5 local utility u=0.146677 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7160294737561583, 'loss_val': 1.1690032221232118, 'psi': 0.37098116749289395}-{'f1_val': 0.14094896331738438, 'auprc': 0.643327763679366, 'loss_val': 1.2442519991961467, 'psi': 0.341900483462177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:39011
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S14@127.0.0.1:39014
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] cosine check vs S5: cos=-0.0792
[S17] DROPPED delta from S5 (cos=-0.0792 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1798) from S7
[S2] cosine check vs S7: cos=-0.0287
[S2] DROPPED delta from S7 (cos=-0.0287 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S11
[S5] cosine check vs S11: cos=-0.0549
[S5] DROPPED delta from S11 (cos=-0.0549 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S15
[S6] cosine check vs S15: cos=0.9122
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=-0.1235
[S4] DROPPED delta from S13 (cos=-0.1235 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0795
[S5] DROPPED delta from S8 (cos=-0.0795 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1793) from S10
[S14] cosine check vs S10: cos=0.5223
[S9] RECEIVED delta(kind=head bytes=1799) from S2
[S9] cosine check vs S2: cos=0.7873
[S10] RECEIVED delta(kind=head bytes=1793) from S4
[S10] cosine check vs S4: cos=-0.0090
[S10] DROPPED delta from S4 (cos=-0.0090 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S16] → sending delta(kind=head bytes=1807) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:39016
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1807 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] cosine check vs S17: cos=0.6658
[S7] RECEIVED delta(kind=head bytes=1807) from S16
[S7] cosine check vs S16: cos=0.5849
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[S6] sending update (kind=head size=1792 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=-0.0385
[S17] DROPPED delta from S6 (cos=-0.0385 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.801134
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.134962e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.993603 delta_norm=0.413496
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.393 → S15@127.0.0.1:39015
[S3] ⇄ pheromone p=0.356 → S8@127.0.0.1:39009
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.779360
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.916579e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.698427 delta_norm=0.391658
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.379 → S17@127.0.0.1:39017
[S10] ⇄ pheromone p=0.555 → S14@127.0.0.1:39014
[S8] ⇄ pheromone p=0.371 → S5@127.0.0.1:39005
[S2] ⇄ pheromone p=0.334 → S9@127.0.0.1:39010
[S5] ⇄ pheromone p=0.593 → S17@127.0.0.1:39017
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.825960
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.085812e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.791412 delta_norm=0.408581
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.356 → S2@127.0.0.1:39002
[S11] ⇄ pheromone p=0.434 → S5@127.0.0.1:39005
[S13] ⇄ pheromone p=0.361 → S4@127.0.0.1:39004
[S4] ⇄ pheromone p=0.540 → S10@127.0.0.1:39011
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.834282
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.755176e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.818976 delta_norm=0.175518
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.335 → S17@127.0.0.1:39017
[S15] ⇄ pheromone p=0.475 → S6@127.0.0.1:39007
[S17] ⇄ pheromone p=0.438 → S16@127.0.0.1:39016
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.4151 head_norm=0.950964
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.632007e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.4155 head_norm=0.996298 delta_norm=0.463201
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.502 → S7@127.0.0.1:39008
[S2] START round=6 head_norm_before_train=1.294078 (no previous merge yet)
[S2] round=6 local utility u=0.874415 metrics={'f1_val': 0.416476999168381, 'auprc': 0.7819253561405648, 'loss_val': 1.00007476668616, 'psi': 0.5626563419572546}-{'f1_val': 0.1417771333885667, 'auprc': 0.7808201286877243, 'loss_val': 1.0973897238191033, 'psi': 0.3973943315082298}
[S3] START round=6 head_norm_before_train=1.264139 (no previous merge yet)
[S3] round=6 local utility u=1.000000 metrics={'f1_val': 0.4225626028819525, 'auprc': 0.8500508748462968, 'loss_val': 0.9685707793406497, 'psi': 0.5935579116676903}-{'f1_val': 0.13984006561410703, 'auprc': 0.7375800750286154, 'loss_val': 1.1009511409116775, 'psi': 0.3789360693799104}
[S4] START round=6 head_norm_before_train=1.320447 (no previous merge yet)
[S4] round=6 local utility u=0.863278 metrics={'f1_val': 0.6760982776215849, 'auprc': 0.7669674609631741, 'loss_val': 0.8434307066641916, 'psi': 0.7124459509582206}-{'f1_val': 0.41419477691946305, 'auprc': 0.7671712010186544, 'loss_val': 0.9991767751163338, 'psi': 0.5553853465591396}
[S5] START round=6 head_norm_before_train=0.887759 cos_to_last_merge=0.9695 (last merge round=1)
[S5] round=6 local utility u=0.069370 metrics={'f1_val': 0.41770847824441854, 'auprc': 0.7724808212483588, 'loss_val': 0.9904692319447035, 'psi': 0.5596174154459946}-{'f1_val': 0.4163396018254457, 'auprc': 0.7700811419269182, 'loss_val': 1.1137969720383787, 'psi': 0.5578362178660348}
[S6] START round=6 head_norm_before_train=0.818976 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.016293 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6132700664560577, 'loss_val': 1.2029856919775885, 'psi': 0.33016379581319233}-{'f1_val': 0.14142628205128205, 'auprc': 0.6132145362784704, 'loss_val': 1.2354048065845933, 'psi': 0.3301415837421574}
[S7] START round=6 head_norm_before_train=0.791412 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.003239 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948589309221907, 'loss_val': 1.259306103593969, 'psi': 0.4031776660063313}-{'f1_val': 0.14205682272909165, 'auprc': 0.79490073652316, 'loss_val': 1.265909607756632, 'psi': 0.403194388246719}
[S8] START round=6 head_norm_before_train=0.926595 cos_to_last_merge=0.9678 (last merge round=1)
[S8] round=6 local utility u=1.000000 metrics={'f1_val': 0.7144593694941699, 'auprc': 0.7771084699757211, 'loss_val': 1.046528965909562, 'psi': 0.7395190096867904}-{'f1_val': 0.13995598239295717, 'auprc': 0.7740766049598466, 'loss_val': 1.145392420462418, 'psi': 0.393604231419713}
[S9] START round=6 head_norm_before_train=0.993603 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.719964436881611, 'loss_val': 1.2177356017403986, 'psi': 0.37282454903664203}-{'f1_val': 0.141397957139996, 'auprc': 0.831371000279747, 'loss_val': 1.238290422321402, 'psi': 0.4173871743958964}
[S10] START round=6 head_norm_before_train=0.821579 cos_to_last_merge=0.9745 (last merge round=2)
[S10] round=6 local utility u=0.003998 metrics={'f1_val': 0.3776832167395732, 'auprc': 0.8396027236929924, 'loss_val': 0.8830093826541664, 'psi': 0.5624510195209409}-{'f1_val': 0.4171553117234075, 'auprc': 0.8244126068263911, 'loss_val': 1.0822672906331985, 'psi': 0.5800582297646009}
[S11] START round=6 head_norm_before_train=1.285736 (no previous merge yet)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.39658602128368947, 'auprc': 0.9962493601784732, 'loss_val': 0.9385494870041398, 'psi': 0.636451356841603}-{'f1_val': 0.14041368337311058, 'auprc': 0.7940056540193946, 'loss_val': 1.0667839253868936, 'psi': 0.4018504716316242}
[S13] START round=6 head_norm_before_train=0.967182 cos_to_last_merge=0.9837 (last merge round=2)
[S13] round=6 local utility u=0.289139 metrics={'f1_val': 0.21217529156546083, 'auprc': 0.7252541650781528, 'loss_val': 1.136304566791703, 'psi': 0.4174068409705376}-{'f1_val': 0.1403857625770531, 'auprc': 0.701577515263758, 'loss_val': 1.2128154127883115, 'psi': 0.3648624636517351}
[S14] START round=6 head_norm_before_train=0.698427 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5996257217016044, 'loss_val': 1.2407836501024159, 'psi': 0.32406500041026404}-{'f1_val': 0.14035785288270378, 'auprc': 0.6250467576152823, 'loss_val': 1.2511382487842866, 'psi': 0.33423341477573515}
[S15] START round=6 head_norm_before_train=0.840852 cos_to_last_merge=0.9894 (last merge round=3)
[S15] round=6 local utility u=0.259044 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7803715808323384, 'loss_val': 1.0624660133908224, 'psi': 0.5619741360373018}-{'f1_val': 0.35814683141003223, 'auprc': 0.7758130469177288, 'loss_val': 1.2175042655845267, 'psi': 0.5252133176131109}
[S16] START round=6 head_norm_before_train=0.996298 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.41700358386742975, 'auprc': 0.5381438425089164, 'loss_val': 1.0567897848216374, 'psi': 0.46545968732402443}-{'f1_val': 0.4150731431819776, 'auprc': 0.5942978133984851, 'loss_val': 1.0931377428034454, 'psi': 0.48676301126858057}
[S17] START round=6 head_norm_before_train=1.228819 (no previous merge yet)
[S17] round=6 local utility u=0.901097 metrics={'f1_val': 0.3878999016463122, 'auprc': 0.7872007767947141, 'loss_val': 1.0620283927084344, 'psi': 0.547620251705673}-{'f1_val': 0.14094896331738438, 'auprc': 0.7160294737561583, 'loss_val': 1.1690032221232118, 'psi': 0.37098116749289395}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:39011
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:39016
[S8] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S7
[S2] cosine check vs S7: cos=0.0121
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=-0.0802
[S17] DROPPED delta from S5 (cos=-0.0802 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.9586
[S8] RECEIVED delta(kind=head bytes=1795) from S3
[S8] cosine check vs S3: cos=-0.0406
[S8] DROPPED delta from S3 (cos=-0.0406 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S6
[S17] cosine check vs S6: cos=-0.0443
[S17] DROPPED delta from S6 (cos=-0.0443 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1800) from S13
[S4] cosine check vs S13: cos=-0.1261
[S4] DROPPED delta from S13 (cos=-0.1261 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.0775
[S5] DROPPED delta from S8 (cos=-0.0775 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1803) from S2
[S9] cosine check vs S2: cos=0.9555
[S14] RECEIVED delta(kind=head bytes=1790) from S10
[S14] cosine check vs S10: cos=0.8437
[S10] RECEIVED delta(kind=head bytes=1796) from S4
[S10] cosine check vs S4: cos=-0.0148
[S10] DROPPED delta from S4 (cos=-0.0148 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S11
[S5] cosine check vs S11: cos=-0.0598
[S5] DROPPED delta from S11 (cos=-0.0598 < 0.0)
[S17] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1795) from S17
[S16] cosine check vs S17: cos=0.9115
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.724177
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.325976e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.763888 delta_norm=0.232598
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=1.006744
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.326181e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=1.150613 delta_norm=0.232618
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.4170 head_norm=1.022481
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.668175e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.4168 head_norm=1.116135 delta_norm=0.266818
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.834360
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.276971e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.855035 delta_norm=0.127697
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.4165 head_norm=1.320042
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.706676e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.4163 head_norm=0.779061 delta_norm=0.770668
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=0.779061 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.022540 metrics={'f1_val': 0.41668780995073934, 'auprc': 0.805588946989932, 'loss_val': 1.0272497735076944, 'psi': 0.5722482647664164}-{'f1_val': 0.416476999168381, 'auprc': 0.7819253561405648, 'loss_val': 1.00007476668616, 'psi': 0.5626563419572546}
[S3] START round=7 head_norm_before_train=1.292108 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6985637637017621, 'auprc': 0.9732623723987145, 'loss_val': 0.8381521480091135, 'psi': 0.8084432071805431}-{'f1_val': 0.4225626028819525, 'auprc': 0.8500508748462968, 'loss_val': 0.9685707793406497, 'psi': 0.5935579116676903}
[S4] START round=7 head_norm_before_train=1.360329 (no previous merge yet)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.37543930708630907, 'auprc': 0.7544702129358282, 'loss_val': 0.7239642079923732, 'psi': 0.5270516694261167}-{'f1_val': 0.6760982776215849, 'auprc': 0.7669674609631741, 'loss_val': 0.8434307066641916, 'psi': 0.7124459509582206}
[S5] START round=7 head_norm_before_train=0.920992 cos_to_last_merge=0.9599 (last merge round=1)
[S5] round=7 local utility u=0.197514 metrics={'f1_val': 0.4595967214606169, 'auprc': 0.7771301119138586, 'loss_val': 0.8607179129158312, 'psi': 0.5866100776419136}-{'f1_val': 0.41770847824441854, 'auprc': 0.7724808212483588, 'loss_val': 0.9904692319447035, 'psi': 0.5596174154459946}
[S6] START round=7 head_norm_before_train=0.855035 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.037514 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.613273625958419, 'loss_val': 1.1279683053316116, 'psi': 0.33016521961413686}-{'f1_val': 0.14142628205128205, 'auprc': 0.6132700664560577, 'loss_val': 1.2029856919775885, 'psi': 0.33016379581319233}
[S7] START round=7 head_norm_before_train=0.811923 cos_to_last_merge=0.9957 (last merge round=5)
[S7] round=7 local utility u=0.002660 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7778870781678052, 'loss_val': 1.203069736575738, 'psi': 0.3963889249045771}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948589309221907, 'loss_val': 1.259306103593969, 'psi': 0.4031776660063313}
[S8] START round=7 head_norm_before_train=0.954873 cos_to_last_merge=0.9591 (last merge round=1)
[S8] round=7 local utility u=0.082462 metrics={'f1_val': 0.7150331423137155, 'auprc': 0.7769381418498684, 'loss_val': 0.8845359266754004, 'psi': 0.7397951421281767}-{'f1_val': 0.7144593694941699, 'auprc': 0.7771084699757211, 'loss_val': 1.046528965909562, 'psi': 0.7395190096867904}
[S9] START round=7 head_norm_before_train=1.150613 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.254394 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8646356257508823, 'loss_val': 1.1429603516496332, 'psi': 0.43069302458435055}-{'f1_val': 0.141397957139996, 'auprc': 0.719964436881611, 'loss_val': 1.2177356017403986, 'psi': 0.37282454903664203}
[S10] START round=7 head_norm_before_train=0.866499 cos_to_last_merge=0.9575 (last merge round=2)
[S10] round=7 local utility u=0.103919 metrics={'f1_val': 0.38907715752159067, 'auprc': 0.8640343505427224, 'loss_val': 0.8168304803149229, 'psi': 0.5790600347300434}-{'f1_val': 0.3776832167395732, 'auprc': 0.8396027236929924, 'loss_val': 0.8830093826541664, 'psi': 0.5624510195209409}
[S11] START round=7 head_norm_before_train=1.323481 (no previous merge yet)
[S11] round=7 local utility u=0.058314 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.9871349385164137, 'loss_val': 0.7943756350092486, 'psi': 0.6327853169622892}-{'f1_val': 0.39658602128368947, 'auprc': 0.9962493601784732, 'loss_val': 0.9385494870041398, 'psi': 0.636451356841603}
[S13] START round=7 head_norm_before_train=0.996006 cos_to_last_merge=0.9773 (last merge round=2)
[S13] round=7 local utility u=0.540472 metrics={'f1_val': 0.38214646032388244, 'auprc': 0.7111737558837214, 'loss_val': 1.0329460150457406, 'psi': 0.513757378547818}-{'f1_val': 0.21217529156546083, 'auprc': 0.7252541650781528, 'loss_val': 1.136304566791703, 'psi': 0.4174068409705376}
[S14] START round=7 head_norm_before_train=0.763888 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.230133 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7388947415792357, 'loss_val': 1.1983249284694422, 'psi': 0.37977260836131654}-{'f1_val': 0.14035785288270378, 'auprc': 0.5996257217016044, 'loss_val': 1.2407836501024159, 'psi': 0.32406500041026404}
[S15] START round=7 head_norm_before_train=0.893659 cos_to_last_merge=0.9769 (last merge round=3)
[S15] round=7 local utility u=0.107345 metrics={'f1_val': 0.416839147538149, 'auprc': 0.78004214599528, 'loss_val': 0.8495672731940319, 'psi': 0.5621203469210014}-{'f1_val': 0.4163758395072774, 'auprc': 0.7803715808323384, 'loss_val': 1.0624660133908224, 'psi': 0.5619741360373018}
[S16] START round=7 head_norm_before_train=1.116135 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.3359273592731282, 'auprc': 0.5626057800129693, 'loss_val': 1.0383073225319892, 'psi': 0.4265987275690647}-{'f1_val': 0.41700358386742975, 'auprc': 0.5381438425089164, 'loss_val': 1.0567897848216374, 'psi': 0.46545968732402443}
[S17] START round=7 head_norm_before_train=1.260329 (no previous merge yet)
[S17] round=7 local utility u=0.159778 metrics={'f1_val': 0.39138738192265743, 'auprc': 0.8443011702125807, 'loss_val': 0.9346989865159442, 'psi': 0.5725528972386268}-{'f1_val': 0.3878999016463122, 'auprc': 0.7872007767947141, 'loss_val': 1.0620283927084344, 'psi': 0.547620251705673}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[S7] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] cosine check vs S8: cos=-0.0788
[S5] DROPPED delta from S8 (cos=-0.0788 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.5043
[S17] RECEIVED delta(kind=head bytes=1794) from S6
[S17] cosine check vs S6: cos=-0.0484
[S17] DROPPED delta from S6 (cos=-0.0484 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1794) from S5
[S17] cosine check vs S5: cos=-0.0856
[S17] DROPPED delta from S5 (cos=-0.0856 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1795) from S2
[S9] cosine check vs S2: cos=0.8453
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:39004
[S13] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=-0.1296
[S4] DROPPED delta from S13 (cos=-0.1296 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S15
[S6] cosine check vs S15: cos=0.9742
[S3] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S3
[S8] cosine check vs S3: cos=-0.0409
[S8] DROPPED delta from S3 (cos=-0.0409 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S10] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:39016
[S10] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S11
[S5] cosine check vs S11: cos=-0.0629
[S5] DROPPED delta from S11 (cos=-0.0629 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1788) from S10
[S14] cosine check vs S10: cos=0.9382
[S16] RECEIVED delta(kind=head bytes=1790) from S17
[S16] cosine check vs S17: cos=0.9662
[S17] RECEIVED delta(kind=head bytes=1792) from S14
[S17] cosine check vs S14: cos=0.2026
[S15] RECEIVED delta(kind=head bytes=1797) from S9
[S15] cosine check vs S9: cos=0.0180
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.872550
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.114964e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.907914 delta_norm=0.111496
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4167 head_norm=0.814645
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.105112e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4161 head_norm=0.715018 delta_norm=0.410511
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.784697
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.638687e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1538 head_norm=0.839091 delta_norm=0.163869
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=1.165206
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.226967e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.952125 delta_norm=0.322697
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.4168 head_norm=0.955059
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.466277e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.4168 head_norm=0.759913 delta_norm=0.746628
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3359 head_norm=1.140667
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.766221e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3972 head_norm=1.209082 delta_norm=0.176622
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=7 metric=0.3914 head_norm=1.298087
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.870453e-01
[S17] stored merged vector for next round verification (round=7)
[S17] DEBUG after merge:  round=7 metric=0.3917 head_norm=0.823625 delta_norm=0.687045
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=0.715018 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.4169384018324798, 'auprc': 0.7692110338970269, 'loss_val': 1.0457853423110617, 'psi': 0.5578474546582988}-{'f1_val': 0.41668780995073934, 'auprc': 0.805588946989932, 'loss_val': 1.0272497735076944, 'psi': 0.5722482647664164}
[S3] START round=8 head_norm_before_train=1.327034 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.46815600783814737, 'auprc': 0.9974739496111921, 'loss_val': 0.7331694305706425, 'psi': 0.6798831845473653}-{'f1_val': 0.6985637637017621, 'auprc': 0.9732623723987145, 'loss_val': 0.8381521480091135, 'psi': 0.8084432071805431}
[S4] START round=8 head_norm_before_train=1.410515 (no previous merge yet)
[S4] round=8 local utility u=0.047245 metrics={'f1_val': 0.3800888456603648, 'auprc': 0.7527538237862157, 'loss_val': 0.6522214629249699, 'psi': 0.5291548369107052}-{'f1_val': 0.37543930708630907, 'auprc': 0.7544702129358282, 'loss_val': 0.7239642079923732, 'psi': 0.5270516694261167}
[S5] START round=8 head_norm_before_train=0.957197 cos_to_last_merge=0.9477 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.948
[S5] round=8 local utility u=0.826796 metrics={'f1_val': 0.7081823739285229, 'auprc': 0.7945915677623128, 'loss_val': 0.751023252192017, 'psi': 0.7427460514620388}-{'f1_val': 0.4595967214606169, 'auprc': 0.7771301119138586, 'loss_val': 0.8607179129158312, 'psi': 0.5866100776419136}
[S6] START round=8 head_norm_before_train=0.907914 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=1.000000 metrics={'f1_val': 0.41657277187194597, 'auprc': 0.7751499232830095, 'loss_val': 1.0108943500635805, 'psi': 0.5600036324363713}-{'f1_val': 0.14142628205128205, 'auprc': 0.613273625958419, 'loss_val': 1.1279683053316116, 'psi': 0.33016521961413686}
[S7] START round=8 head_norm_before_train=0.834202 cos_to_last_merge=0.9876 (last merge round=5)
[S7] round=8 local utility u=0.851163 metrics={'f1_val': 0.4168747328879592, 'auprc': 0.7777810208468858, 'loss_val': 1.1493333408510782, 'psi': 0.5612372480715299}-{'f1_val': 0.14205682272909165, 'auprc': 0.7778870781678052, 'loss_val': 1.203069736575738, 'psi': 0.3963889249045771}
[S8] START round=8 head_norm_before_train=0.990223 cos_to_last_merge=0.9469 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.947
[S8] round=8 local utility u=0.054235 metrics={'f1_val': 0.7148398868842434, 'auprc': 0.773845134689662, 'loss_val': 0.7656265813869332, 'psi': 0.7384419860064109}-{'f1_val': 0.7150331423137155, 'auprc': 0.7769381418498684, 'loss_val': 0.8845359266754004, 'psi': 0.7397951421281767}
[S9] START round=8 head_norm_before_train=0.952125 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.064480 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8760604708287579, 'loss_val': 1.0482758321904342, 'psi': 0.4352629626155008}-{'f1_val': 0.141397957139996, 'auprc': 0.8646356257508823, 'loss_val': 1.1429603516496332, 'psi': 0.43069302458435055}
[S10] START round=8 head_norm_before_train=0.919839 cos_to_last_merge=0.9380 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=8 local utility u=0.063362 metrics={'f1_val': 0.39250353606789246, 'auprc': 0.8648931483002958, 'loss_val': 0.7132405444928175, 'psi': 0.5814593809608538}-{'f1_val': 0.38907715752159067, 'auprc': 0.8640343505427224, 'loss_val': 0.8168304803149229, 'psi': 0.5790600347300434}
[S11] START round=8 head_norm_before_train=1.369723 (no previous merge yet)
[S11] round=8 local utility u=0.290812 metrics={'f1_val': 0.4991582234910652, 'auprc': 0.9422793591324353, 'loss_val': 0.6938212288948903, 'psi': 0.6764066777476132}-{'f1_val': 0.39655223592620625, 'auprc': 0.9871349385164137, 'loss_val': 0.7943756350092486, 'psi': 0.6327853169622892}
[S13] START round=8 head_norm_before_train=1.019857 cos_to_last_merge=0.9697 (last merge round=2)
[S13] round=8 local utility u=0.079962 metrics={'f1_val': 0.37162727603385415, 'auprc': 0.7391258893563142, 'loss_val': 0.8937636021066444, 'psi': 0.5186267213628382}-{'f1_val': 0.38214646032388244, 'auprc': 0.7111737558837214, 'loss_val': 1.0329460150457406, 'psi': 0.513757378547818}
[S14] START round=8 head_norm_before_train=0.839091 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=1.000000 metrics={'f1_val': 0.6627612393407337, 'auprc': 0.7702443176466218, 'loss_val': 1.1201020206661612, 'psi': 0.7057544706630889}-{'f1_val': 0.14035785288270378, 'auprc': 0.7388947415792357, 'loss_val': 1.1983249284694422, 'psi': 0.37977260836131654}
[S15] START round=8 head_norm_before_train=0.759913 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.000000 metrics={'f1_val': 0.40930714744298147, 'auprc': 0.7783115047886744, 'loss_val': 0.8901136091152883, 'psi': 0.5569088903812587}-{'f1_val': 0.416839147538149, 'auprc': 0.78004214599528, 'loss_val': 0.8495672731940319, 'psi': 0.5621203469210014}
[S16] START round=8 head_norm_before_train=1.209082 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.225570 metrics={'f1_val': 0.41597160934210603, 'auprc': 0.539026562879736, 'loss_val': 0.996695525338732, 'psi': 0.46519359075715805}-{'f1_val': 0.3359273592731282, 'auprc': 0.5626057800129693, 'loss_val': 1.0383073225319892, 'psi': 0.4265987275690647}
[S17] START round=8 head_norm_before_train=0.823625 cos_to_last_merge=1.0000 (last merge round=7)
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.3898823292617716, 'auprc': 0.7737701189145731, 'loss_val': 0.9195492150582555, 'psi': 0.5434374451228923}-{'f1_val': 0.39138738192265743, 'auprc': 0.8443011702125807, 'loss_val': 0.9346989865159442, 'psi': 0.5725528972386268}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:39015
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1801) from S7
[S2] cosine check vs S7: cos=0.8243
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=-0.0962
[S17] DROPPED delta from S5 (cos=-0.0962 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1796) from S9
[S15] cosine check vs S9: cos=0.7241
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0781
[S5] DROPPED delta from S8 (cos=-0.0781 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=-0.0303
[S10] DROPPED delta from S4 (cos=-0.0303 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1791) from S6
[S17] cosine check vs S6: cos=-0.0842
[S17] DROPPED delta from S6 (cos=-0.0842 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S13
[S4] cosine check vs S13: cos=-0.1313
[S4] DROPPED delta from S13 (cos=-0.1313 < 0.0)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:39017
[S10] sending update (kind=head size=1792 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1792) from S10
[S14] cosine check vs S10: cos=0.9589
[S16] sending update (kind=head size=1794 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1794) from S16
[S7] cosine check vs S16: cos=0.4790
[S14] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S14
[S17] cosine check vs S14: cos=0.6135
[S5] RECEIVED delta(kind=head bytes=1805) from S11
[S5] cosine check vs S11: cos=-0.0678
[S5] DROPPED delta from S11 (cos=-0.0678 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4169 head_norm=0.748776
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.427861e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.3519 head_norm=0.765518 delta_norm=0.242786
[S2] aggregate: ROLLBACK (f1_val pre=0.417 post=0.352 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.4169 head_norm=0.853966
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.582748e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4167 head_norm=0.904137 delta_norm=0.558275
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.6628 head_norm=0.861834
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.413339e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.6923 head_norm=0.905748 delta_norm=0.141334
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4093 head_norm=0.794415
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.392231e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.7141 head_norm=0.822273 delta_norm=0.339223
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=8 metric=0.3899 head_norm=0.869818
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.806509e-01
[S17] stored merged vector for next round verification (round=8)
[S17] DEBUG after merge:  round=8 metric=0.3906 head_norm=0.777673 delta_norm=0.380651
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=0.765518 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.028717 metrics={'f1_val': 0.4167275806938775, 'auprc': 0.7773409692450272, 'loss_val': 1.011475536642256, 'psi': 0.5609729361143374}-{'f1_val': 0.4169384018324798, 'auprc': 0.7692110338970269, 'loss_val': 1.0457853423110617, 'psi': 0.5578474546582988}
[S3] START round=9 head_norm_before_train=1.365469 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.8415862044617146, 'loss_val': 0.7399265205370541, 'psi': 0.5781035523759931}-{'f1_val': 0.46815600783814737, 'auprc': 0.9974739496111921, 'loss_val': 0.7331694305706425, 'psi': 0.6798831845473653}
[S4] START round=9 head_norm_before_train=1.464311 (no previous merge yet)
[S4] round=9 local utility u=0.725613 metrics={'f1_val': 0.6565510235064399, 'auprc': 0.659288380434189, 'loss_val': 0.5793724767184727, 'psi': 0.6576459662775396}-{'f1_val': 0.3800888456603648, 'auprc': 0.7527538237862157, 'loss_val': 0.6522214629249699, 'psi': 0.5291548369107052}
[S5] START round=9 head_norm_before_train=0.995894 cos_to_last_merge=0.9304 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.930
[S5] round=9 local utility u=0.071676 metrics={'f1_val': 0.7147601806635243, 'auprc': 0.7953513063246678, 'loss_val': 0.6494170466545729, 'psi': 0.7469966309279816}-{'f1_val': 0.7081823739285229, 'auprc': 0.7945915677623128, 'loss_val': 0.751023252192017, 'psi': 0.7427460514620388}
[S6] START round=9 head_norm_before_train=0.932523 cos_to_last_merge=0.9977 (last merge round=7)
[S6] round=9 local utility u=0.250921 metrics={'f1_val': 0.48680424577352877, 'auprc': 0.7729062778452314, 'loss_val': 0.9237111146322954, 'psi': 0.6012450586022098}-{'f1_val': 0.41657277187194597, 'auprc': 0.7751499232830095, 'loss_val': 1.0108943500635805, 'psi': 0.5600036324363713}
[S7] START round=9 head_norm_before_train=0.904137 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.050160 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.7945371782095761, 'loss_val': 1.1009823140581663, 'psi': 0.5681096634428945}-{'f1_val': 0.4168747328879592, 'auprc': 0.7777810208468858, 'loss_val': 1.1493333408510782, 'psi': 0.5612372480715299}
[S8] START round=9 head_norm_before_train=1.026822 cos_to_last_merge=0.9311 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.931
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.5946463910822666, 'auprc': 0.7806882899404269, 'loss_val': 0.7239192840565325, 'psi': 0.6690631506255307}-{'f1_val': 0.7148398868842434, 'auprc': 0.773845134689662, 'loss_val': 0.7656265813869332, 'psi': 0.7384419860064109}
[S9] START round=9 head_norm_before_train=0.975354 cos_to_last_merge=0.9967 (last merge round=7)
[S9] round=9 local utility u=1.000000 metrics={'f1_val': 0.4261562994728996, 'auprc': 0.9665883435396936, 'loss_val': 0.8815808654625061, 'psi': 0.6423291170996173}-{'f1_val': 0.141397957139996, 'auprc': 0.8760604708287579, 'loss_val': 1.0482758321904342, 'psi': 0.4352629626155008}
[S10] START round=9 head_norm_before_train=0.968480 cos_to_last_merge=0.9170 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.701368637962591, 'auprc': 0.9404719658381141, 'loss_val': 0.5507565223207959, 'psi': 0.7970099691128003}-{'f1_val': 0.39250353606789246, 'auprc': 0.8648931483002958, 'loss_val': 0.7132405444928175, 'psi': 0.5814593809608538}
[S11] START round=9 head_norm_before_train=1.420769 (no previous merge yet)
[S11] round=9 local utility u=0.680180 metrics={'f1_val': 0.701890640953942, 'auprc': 0.9419649520165115, 'loss_val': 0.5489115817490754, 'psi': 0.7979203653789699}-{'f1_val': 0.4991582234910652, 'auprc': 0.9422793591324353, 'loss_val': 0.6938212288948903, 'psi': 0.6764066777476132}
[S13] START round=9 head_norm_before_train=1.057440 cos_to_last_merge=0.9576 (last merge round=2)
[S13] round=9 local utility u=0.317353 metrics={'f1_val': 0.46006128231605686, 'auprc': 0.7392563538610789, 'loss_val': 0.7900522334836338, 'psi': 0.5717393109340657}-{'f1_val': 0.37162727603385415, 'auprc': 0.7391258893563142, 'loss_val': 0.8937636021066444, 'psi': 0.5186267213628382}
[S14] START round=9 head_norm_before_train=0.905748 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.247760 metrics={'f1_val': 0.6925729222674943, 'auprc': 0.8495417099719946, 'loss_val': 1.0413438902946566, 'psi': 0.7553604373492945}-{'f1_val': 0.6627612393407337, 'auprc': 0.7702443176466218, 'loss_val': 1.1201020206661612, 'psi': 0.7057544706630889}
[S15] START round=9 head_norm_before_train=0.822273 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.870404 metrics={'f1_val': 0.6950444812861397, 'auprc': 0.799122787080199, 'loss_val': 0.9261630689553679, 'psi': 0.7366758036037635}-{'f1_val': 0.40930714744298147, 'auprc': 0.7783115047886744, 'loss_val': 0.8901136091152883, 'psi': 0.5569088903812587}
[S16] START round=9 head_norm_before_train=1.236532 cos_to_last_merge=0.9970 (last merge round=7)
[S16] round=9 local utility u=0.413264 metrics={'f1_val': 0.4935840934386502, 'auprc': 0.6077542026292643, 'loss_val': 0.8420244258587669, 'psi': 0.5392521371148957}-{'f1_val': 0.41597160934210603, 'auprc': 0.539026562879736, 'loss_val': 0.996695525338732, 'psi': 0.46519359075715805}
[S17] START round=9 head_norm_before_train=0.777673 cos_to_last_merge=1.0000 (last merge round=8)
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.35939907306847174, 'auprc': 0.7739800129648313, 'loss_val': 0.9321801079757701, 'psi': 0.5252314490270156}-{'f1_val': 0.3898823292617716, 'auprc': 0.7737701189145731, 'loss_val': 0.9195492150582555, 'psi': 0.5434374451228923}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39014
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:39005
[S9] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S6
[S17] cosine check vs S6: cos=-0.0942
[S17] DROPPED delta from S6 (cos=-0.0942 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1793) from S9
[S15] cosine check vs S9: cos=0.9092
[S9] RECEIVED delta(kind=head bytes=1797) from S2
[S9] cosine check vs S2: cos=0.4974
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.8595
[S4] RECEIVED delta(kind=head bytes=1796) from S13
[S4] cosine check vs S13: cos=-0.1313
[S4] DROPPED delta from S13 (cos=-0.1313 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=-0.0365
[S10] DROPPED delta from S4 (cos=-0.0365 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1792) from S7
[S2] cosine check vs S7: cos=0.7753
[S5] RECEIVED delta(kind=head bytes=1802) from S11
[S5] cosine check vs S11: cos=-0.0732
[S5] DROPPED delta from S11 (cos=-0.0732 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1801) from S5
[S17] cosine check vs S5: cos=-0.0830
[S17] DROPPED delta from S5 (cos=-0.0830 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S16
[S7] cosine check vs S16: cos=0.8987
[S6] RECEIVED delta(kind=head bytes=1794) from S15
[S6] cosine check vs S15: cos=0.4226
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] cosine check vs S10: cos=0.9658
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.4172 head_norm=0.920263
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.014259e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.4170 head_norm=1.070189 delta_norm=0.301426
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4868 head_norm=0.965966
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.885353e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.6201 head_norm=0.763201 delta_norm=0.488535
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4167 head_norm=0.796352
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.935302e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.3287 head_norm=0.808931 delta_norm=0.293530
[S2] aggregate: ROLLBACK (f1_val pre=0.417 post=0.329 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.6926 head_norm=0.931662
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.343581e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6926 head_norm=0.966257 delta_norm=0.134358
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4262 head_norm=1.013528
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.632673e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.3087 head_norm=0.784915 delta_norm=0.463267
[S9] aggregate: ROLLBACK (f1_val pre=0.426 post=0.309 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.6950 head_norm=0.842137
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.147036e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4217 head_norm=0.906708 delta_norm=0.214704
[S15] aggregate: ROLLBACK (f1_val pre=0.695 post=0.422 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=9 metric=0.3594 head_norm=0.823066
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.383508e-01
[S17] stored merged vector for next round verification (round=9)
[S17] DEBUG after merge:  round=9 metric=0.3775 head_norm=0.846112 delta_norm=0.238351
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=0.808931 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.884482 metrics={'f1_val': 0.7017265470597617, 'auprc': 0.7888477499984988, 'loss_val': 0.987026507028597, 'psi': 0.7365750282352566}-{'f1_val': 0.4167275806938775, 'auprc': 0.7773409692450272, 'loss_val': 1.011475536642256, 'psi': 0.5609729361143374}
[S3] START round=10 head_norm_before_train=1.403669 (no previous merge yet)
[S3] round=10 local utility u=0.716348 metrics={'f1_val': 0.5414640704358279, 'auprc': 0.9944220752252574, 'loss_val': 0.5998309987773789, 'psi': 0.7226472723515998}-{'f1_val': 0.4024484509855121, 'auprc': 0.8415862044617146, 'loss_val': 0.7399265205370541, 'psi': 0.5781035523759931}
[S4] START round=10 head_norm_before_train=1.516681 (no previous merge yet)
[S4] round=10 local utility u=0.006043 metrics={'f1_val': 0.6546213431363835, 'auprc': 0.6584648204149427, 'loss_val': 0.5532374285052114, 'psi': 0.6561587340478072}-{'f1_val': 0.6565510235064399, 'auprc': 0.659288380434189, 'loss_val': 0.5793724767184727, 'psi': 0.6576459662775396}
[S5] START round=10 head_norm_before_train=1.032208 cos_to_last_merge=0.9123 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.912
[S5] round=10 local utility u=0.336853 metrics={'f1_val': 0.7121812137495197, 'auprc': 0.9977473116110693, 'loss_val': 0.5674261856651942, 'psi': 0.8264076528941395}-{'f1_val': 0.7147601806635243, 'auprc': 0.7953513063246678, 'loss_val': 0.6494170466545729, 'psi': 0.7469966309279816}
[S6] START round=10 head_norm_before_train=0.763201 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.639856 metrics={'f1_val': 0.7001632817438127, 'auprc': 0.754905109039476, 'loss_val': 0.8701504670123693, 'psi': 0.722060012662078}-{'f1_val': 0.48680424577352877, 'auprc': 0.7729062778452314, 'loss_val': 0.9237111146322954, 'psi': 0.6012450586022098}
[S7] START round=10 head_norm_before_train=1.070189 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.002838 metrics={'f1_val': 0.41683246609844005, 'auprc': 0.7748289542010472, 'loss_val': 1.034228388265504, 'psi': 0.560031061339483}-{'f1_val': 0.4171579869317734, 'auprc': 0.7945371782095761, 'loss_val': 1.1009823140581663, 'psi': 0.5681096634428945}
[S8] START round=10 head_norm_before_train=1.069078 cos_to_last_merge=0.9121 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.912
[S8] round=10 local utility u=0.728498 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9920010316156639, 'loss_val': 0.6180254495720682, 'psi': 0.8253046960273569}-{'f1_val': 0.5946463910822666, 'auprc': 0.7806882899404269, 'loss_val': 0.7239192840565325, 'psi': 0.6690631506255307}
[S9] START round=10 head_norm_before_train=0.784915 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.793502 metrics={'f1_val': 0.6724521853384549, 'auprc': 0.9990915782536726, 'loss_val': 0.869862230890534, 'psi': 0.803107942504542}-{'f1_val': 0.4261562994728996, 'auprc': 0.9665883435396936, 'loss_val': 0.8815808654625061, 'psi': 0.6423291170996173}
[S10] START round=10 head_norm_before_train=1.017553 cos_to_last_merge=0.8958 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=10 local utility u=0.060379 metrics={'f1_val': 0.6998932897468348, 'auprc': 0.9662075661836532, 'loss_val': 0.49835237091390555, 'psi': 0.8064190003215622}-{'f1_val': 0.701368637962591, 'auprc': 0.9404719658381141, 'loss_val': 0.5507565223207959, 'psi': 0.7970099691128003}
[S11] START round=10 head_norm_before_train=1.473744 (no previous merge yet)
[S11] round=10 local utility u=0.057545 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9424884096406527, 'loss_val': 0.43605179822707063, 'psi': 0.7981958294238003}-{'f1_val': 0.701890640953942, 'auprc': 0.9419649520165115, 'loss_val': 0.5489115817490754, 'psi': 0.7979203653789699}
[S13] START round=10 head_norm_before_train=1.104626 cos_to_last_merge=0.9435 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.944
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.37188520254548757, 'auprc': 0.5964229216562611, 'loss_val': 0.8280751743014826, 'psi': 0.46170029018979697}-{'f1_val': 0.46006128231605686, 'auprc': 0.7392563538610789, 'loss_val': 0.7900522334836338, 'psi': 0.5717393109340657}
[S14] START round=10 head_norm_before_train=0.966257 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.019504 metrics={'f1_val': 0.6265833091440618, 'auprc': 0.9540252058117522, 'loss_val': 0.9198489143293789, 'psi': 0.7575600678111379}-{'f1_val': 0.6925729222674943, 'auprc': 0.8495417099719946, 'loss_val': 1.0413438902946566, 'psi': 0.7553604373492945}
[S15] START round=10 head_norm_before_train=0.906708 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.6948634570167117, 'auprc': 0.7978487427385945, 'loss_val': 0.9326318322003706, 'psi': 0.7360575713054649}-{'f1_val': 0.6950444812861397, 'auprc': 0.799122787080199, 'loss_val': 0.9261630689553679, 'psi': 0.7366758036037635}
[S16] START round=10 head_norm_before_train=1.274928 cos_to_last_merge=0.9892 (last merge round=7)
[S16] round=10 local utility u=0.551751 metrics={'f1_val': 0.5292061340645646, 'auprc': 0.8956278902583197, 'loss_val': 0.8158759405813362, 'psi': 0.6757748365420666}-{'f1_val': 0.4935840934386502, 'auprc': 0.6077542026292643, 'loss_val': 0.8420244258587669, 'psi': 0.5392521371148957}
[S17] START round=10 head_norm_before_train=0.846112 cos_to_last_merge=1.0000 (last merge round=9)
[S17] round=10 local utility u=0.032781 metrics={'f1_val': 0.3524244272541974, 'auprc': 0.8130749781243014, 'loss_val': 0.9420559308392968, 'psi': 0.536684647602239}-{'f1_val': 0.35939907306847174, 'auprc': 0.7739800129648313, 'loss_val': 0.9321801079757701, 'psi': 0.5252314490270156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:39014
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:39016
[S4] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S3
[S8] cosine check vs S3: cos=-0.0383
[S8] DROPPED delta from S3 (cos=-0.0383 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1793) from S16
[S7] cosine check vs S16: cos=0.9708
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9363
[S5] RECEIVED delta(kind=head bytes=1798) from S11
[S5] cosine check vs S11: cos=-0.0785
[S5] DROPPED delta from S11 (cos=-0.0785 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S8
[S5] cosine check vs S8: cos=-0.0800
[S5] DROPPED delta from S8 (cos=-0.0800 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.8483
[S9] RECEIVED delta(kind=head bytes=1798) from S2
[S9] cosine check vs S2: cos=0.7131
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0425
[S10] DROPPED delta from S4 (cos=-0.0425 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S10
[S14] cosine check vs S10: cos=0.9702
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=-0.0179
[S17] DROPPED delta from S6 (cos=-0.0179 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1803) from S5
[S17] cosine check vs S5: cos=-0.0699
[S17] DROPPED delta from S5 (cos=-0.0699 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] cosine check vs S9: cos=0.8722
[S17] sending update (kind=head size=1792 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1792) from S17
[S16] cosine check vs S17: cos=0.5181
[S13] ⇄ pheromone p=0.258 → S4@127.0.0.1:39004
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.6949 head_norm=0.924389
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.263113e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3893 head_norm=0.847688 delta_norm=0.226311
[S15] aggregate: ROLLBACK (f1_val pre=0.695 post=0.389 tol_abs=0.005 tol_rel=0.0)
[S15] ⇄ pheromone p=0.327 → S6@127.0.0.1:39007
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.6725 head_norm=0.827700
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.155995e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7005 head_norm=0.771044 delta_norm=0.315600
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.482 → S15@127.0.0.1:39015
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6266 head_norm=0.995890
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.307685e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6914 head_norm=1.023816 delta_norm=0.130768
[S14] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.319 → S17@127.0.0.1:39017
[S4] ⇄ pheromone p=0.371 → S10@127.0.0.1:39011
[S5] ⇄ pheromone p=0.405 → S17@127.0.0.1:39017
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.5292 head_norm=1.314738
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.719641e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.5272 head_norm=0.966344 delta_norm=0.571964
[S16] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.370 → S7@127.0.0.1:39008
[S6] ⇄ pheromone p=0.411 → S17@127.0.0.1:39017
[S8] ⇄ pheromone p=0.365 → S5@127.0.0.1:39005
[S11] ⇄ pheromone p=0.388 → S5@127.0.0.1:39005
[S3] ⇄ pheromone p=0.444 → S8@127.0.0.1:39009
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7017 head_norm=0.838532
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.903668e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.3991 head_norm=0.925544 delta_norm=0.290367
[S2] aggregate: ROLLBACK (f1_val pre=0.702 post=0.399 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.365 → S9@127.0.0.1:39010
[S10] ⇄ pheromone p=0.373 → S14@127.0.0.1:39014
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.4168 head_norm=1.085703
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.842514e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.4168 head_norm=1.191509 delta_norm=0.184251
[S7] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.235 → S2@127.0.0.1:39002
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=10 metric=0.3524 head_norm=0.890726
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.760674e-01
[S17] stored merged vector for next round verification (round=10)
[S17] DEBUG after merge:  round=10 metric=0.3522 head_norm=0.928221 delta_norm=0.176067
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.240 → S16@127.0.0.1:39016
[S2] START round=11 head_norm_before_train=0.925544 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.066815 metrics={'f1_val': 0.7020357069276371, 'auprc': 0.7921599745369079, 'loss_val': 0.8651884905721217, 'psi': 0.7380854139713453}-{'f1_val': 0.7017265470597617, 'auprc': 0.7888477499984988, 'loss_val': 0.987026507028597, 'psi': 0.7365750282352566}
[S3] START round=11 head_norm_before_train=1.441448 (no previous merge yet)
[S3] round=11 local utility u=0.553221 metrics={'f1_val': 0.700330919019862, 'auprc': 0.9986661276953401, 'loss_val': 0.4593229104415233, 'psi': 0.8196650024900533}-{'f1_val': 0.5414640704358279, 'auprc': 0.9944220752252574, 'loss_val': 0.5998309987773789, 'psi': 0.7226472723515998}
[S4] START round=11 head_norm_before_train=1.568826 (no previous merge yet)
[S4] round=11 local utility u=0.437791 metrics={'f1_val': 0.65707351815967, 'auprc': 0.9427777792331233, 'loss_val': 0.5453065478291695, 'psi': 0.7713552225890513}-{'f1_val': 0.6546213431363835, 'auprc': 0.6584648204149427, 'loss_val': 0.5532374285052114, 'psi': 0.6561587340478072}
[S5] START round=11 head_norm_before_train=1.065829 cos_to_last_merge=0.8982 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.898
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9977083094332284, 'loss_val': 0.5208919832112182, 'psi': 0.8194244297760824}-{'f1_val': 0.7121812137495197, 'auprc': 0.9977473116110693, 'loss_val': 0.5674261856651942, 'psi': 0.8264076528941395}
[S6] START round=11 head_norm_before_train=0.800568 cos_to_last_merge=0.9956 (last merge round=9)
[S6] round=11 local utility u=0.123107 metrics={'f1_val': 0.710432720071638, 'auprc': 0.7749196834348313, 'loss_val': 0.745596894075732, 'psi': 0.7362275054169154}-{'f1_val': 0.7001632817438127, 'auprc': 0.754905109039476, 'loss_val': 0.8701504670123693, 'psi': 0.722060012662078}
[S7] START round=11 head_norm_before_train=1.191509 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.325222 metrics={'f1_val': 0.5155537974171963, 'auprc': 0.7803429202848504, 'loss_val': 0.9926540352699603, 'psi': 0.6214694465642581}-{'f1_val': 0.41683246609844005, 'auprc': 0.7748289542010472, 'loss_val': 1.034228388265504, 'psi': 0.560031061339483}
[S8] START round=11 head_norm_before_train=1.109203 cos_to_last_merge=0.8928 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.893
[S8] round=11 local utility u=0.049246 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.99369347984238, 'loss_val': 0.5225047590976921, 'psi': 0.825771158927308}-{'f1_val': 0.7141738056351523, 'auprc': 0.9920010316156639, 'loss_val': 0.6180254495720682, 'psi': 0.8253046960273569}
[S9] START round=11 head_norm_before_train=0.771044 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.106002 metrics={'f1_val': 0.7011888050472792, 'auprc': 0.9987471770768022, 'loss_val': 0.8292452865629554, 'psi': 0.8202121538590884}-{'f1_val': 0.6724521853384549, 'auprc': 0.9990915782536726, 'loss_val': 0.869862230890534, 'psi': 0.803107942504542}
[S10] START round=11 head_norm_before_train=1.067146 cos_to_last_merge=0.8772 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6885969159024345, 'auprc': 0.9580829659273892, 'loss_val': 0.4426703899186404, 'psi': 0.7963913359124164}-{'f1_val': 0.6998932897468348, 'auprc': 0.9662075661836532, 'loss_val': 0.49835237091390555, 'psi': 0.8064190003215622}
[S11] START round=11 head_norm_before_train=1.529075 (no previous merge yet)
[S11] round=11 local utility u=0.118692 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9952258594616721, 'loss_val': 0.3583310124519561, 'psi': 0.8194358368242272}-{'f1_val': 0.7020007759458987, 'auprc': 0.9424884096406527, 'loss_val': 0.43605179822707063, 'psi': 0.7981958294238003}
[S13] START round=11 head_norm_before_train=1.151575 cos_to_last_merge=0.9301 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.930
[S13] round=11 local utility u=1.000000 metrics={'f1_val': 0.6945464526675461, 'auprc': 0.7394405037024413, 'loss_val': 0.6150357365597403, 'psi': 0.7125040730815042}-{'f1_val': 0.37188520254548757, 'auprc': 0.5964229216562611, 'loss_val': 0.8280751743014826, 'psi': 0.46170029018979697}
[S14] START round=11 head_norm_before_train=1.023816 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.102093 metrics={'f1_val': 0.6239357576116431, 'auprc': 0.9942149278036747, 'loss_val': 0.8203462458534564, 'psi': 0.7720474256884557}-{'f1_val': 0.6265833091440618, 'auprc': 0.9540252058117522, 'loss_val': 0.9198489143293789, 'psi': 0.7575600678111379}
[S15] START round=11 head_norm_before_train=0.847688 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.084486 metrics={'f1_val': 0.6907163700099945, 'auprc': 0.8376954708388799, 'loss_val': 0.8583171811397116, 'psi': 0.7495080103415487}-{'f1_val': 0.6948634570167117, 'auprc': 0.7978487427385945, 'loss_val': 0.9326318322003706, 'psi': 0.7360575713054649}
[S16] START round=11 head_norm_before_train=0.966344 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.000000 metrics={'f1_val': 0.48368541475359655, 'auprc': 0.8716352259679238, 'loss_val': 0.7648481250019566, 'psi': 0.6388653392393275}-{'f1_val': 0.5292061340645646, 'auprc': 0.8956278902583197, 'loss_val': 0.8158759405813362, 'psi': 0.6757748365420666}
[S17] START round=11 head_norm_before_train=0.928221 cos_to_last_merge=1.0000 (last merge round=10)
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.35204211003688723, 'auprc': 0.7175429917939522, 'loss_val': 0.9344696285962254, 'psi': 0.4982424627397133}-{'f1_val': 0.3524244272541974, 'auprc': 0.8130749781243014, 'loss_val': 0.9420559308392968, 'psi': 0.536684647602239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S8
[S5] cosine check vs S8: cos=-0.0816
[S5] DROPPED delta from S8 (cos=-0.0816 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S9
[S15] cosine check vs S9: cos=0.8321
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S14] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S14
[S17] cosine check vs S14: cos=0.9588
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:39007
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S15
[S6] cosine check vs S15: cos=0.6623
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:39005
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[S3] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0389
[S8] DROPPED delta from S3 (cos=-0.0389 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S13
[S4] cosine check vs S13: cos=-0.1311
[S4] DROPPED delta from S13 (cos=-0.1311 < 0.0)
[S7] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S6
[S17] cosine check vs S6: cos=-0.0115
[S17] DROPPED delta from S6 (cos=-0.0115 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S7
[S2] cosine check vs S7: cos=0.9260
[S10] RECEIVED delta(kind=head bytes=1799) from S4
[S10] cosine check vs S4: cos=-0.0489
[S10] DROPPED delta from S4 (cos=-0.0489 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:39010
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S11
[S5] cosine check vs S11: cos=-0.0849
[S5] DROPPED delta from S11 (cos=-0.0849 < 0.0)
[S2] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S2
[S9] cosine check vs S2: cos=0.8148
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7012 head_norm=0.809478
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.765005e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.839265 delta_norm=0.276500
[S9] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.7104 head_norm=0.845731
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.533640e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7091 head_norm=0.783496 delta_norm=0.353364
[S6] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7020 head_norm=0.952042
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.416103e-01
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7012 head_norm=1.058414 delta_norm=0.241610
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.6907 head_norm=0.873042
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.456082e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.6986 head_norm=0.805236 delta_norm=0.245608
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=11 metric=0.3520 head_norm=0.973278
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.515825e-01
[S17] stored merged vector for next round verification (round=11)
[S17] DEBUG after merge:  round=11 metric=0.3520 head_norm=1.004702 delta_norm=0.151582
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.058414 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7019057500858747, 'auprc': 0.683806774079261, 'loss_val': 0.7560275776409913, 'psi': 0.6946661596832293}-{'f1_val': 0.7020357069276371, 'auprc': 0.7921599745369079, 'loss_val': 0.8651884905721217, 'psi': 0.7380854139713453}
[S3] START round=12 head_norm_before_train=1.479435 (no previous merge yet)
[S3] round=12 local utility u=0.032699 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9986649926570471, 'loss_val': 0.3954234321442141, 'psi': 0.8198148346580718}-{'f1_val': 0.700330919019862, 'auprc': 0.9986661276953401, 'loss_val': 0.4593229104415233, 'psi': 0.8196650024900533}
[S4] START round=12 head_norm_before_train=1.617538 (no previous merge yet)
[S4] round=12 local utility u=0.011570 metrics={'f1_val': 0.652582494747556, 'auprc': 0.9469422970986958, 'loss_val': 0.5077137714372737, 'psi': 0.770326415688012}-{'f1_val': 0.65707351815967, 'auprc': 0.9427777792331233, 'loss_val': 0.5453065478291695, 'psi': 0.7713552225890513}
[S5] START round=12 head_norm_before_train=1.097941 cos_to_last_merge=0.8860 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.886
[S5] round=12 local utility u=0.034861 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9967852893120225, 'loss_val': 0.448640103397582, 'psi': 0.8190791513224136}-{'f1_val': 0.7005685100046517, 'auprc': 0.9977083094332284, 'loss_val': 0.5208919832112182, 'psi': 0.8194244297760824}
[S6] START round=12 head_norm_before_train=0.783496 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6205842955325758, 'auprc': 0.7742171403860334, 'loss_val': 0.8320368680341304, 'psi': 0.6820374334739588}-{'f1_val': 0.710432720071638, 'auprc': 0.7749196834348313, 'loss_val': 0.745596894075732, 'psi': 0.7362275054169154}
[S7] START round=12 head_norm_before_train=1.204512 cos_to_last_merge=0.9975 (last merge round=10)
[S7] round=12 local utility u=0.559456 metrics={'f1_val': 0.6896422075204052, 'auprc': 0.7766886009371594, 'loss_val': 0.9073086787245168, 'psi': 0.7244607648871069}-{'f1_val': 0.5155537974171963, 'auprc': 0.7803429202848504, 'loss_val': 0.9926540352699603, 'psi': 0.6214694465642581}
[S8] START round=12 head_norm_before_train=1.149545 cos_to_last_merge=0.8730 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.873
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.3725978128855645, 'auprc': 0.9917699456705218, 'loss_val': 0.5436827746278927, 'psi': 0.6202666659995475}-{'f1_val': 0.7138229449839267, 'auprc': 0.99369347984238, 'loss_val': 0.5225047590976921, 'psi': 0.825771158927308}
[S9] START round=12 head_norm_before_train=0.839265 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.019075 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988049130605536, 'loss_val': 0.7923228300256294, 'psi': 0.8203407658557269}-{'f1_val': 0.7011888050472792, 'auprc': 0.9987471770768022, 'loss_val': 0.8292452865629554, 'psi': 0.8202121538590884}
[S10] START round=12 head_norm_before_train=1.117412 cos_to_last_merge=0.8613 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.861
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.6666762581792283, 'auprc': 0.9464634291372229, 'loss_val': 0.40715422804027823, 'psi': 0.7785911265624261}-{'f1_val': 0.6885969159024345, 'auprc': 0.9580829659273892, 'loss_val': 0.4426703899186404, 'psi': 0.7963913359124164}
[S11] START round=12 head_norm_before_train=1.581950 (no previous merge yet)
[S11] round=12 local utility u=0.031425 metrics={'f1_val': 0.7020007759458987, 'auprc': 0.9965432423401944, 'loss_val': 0.2979834731764646, 'psi': 0.8198177625036169}-{'f1_val': 0.702242488399264, 'auprc': 0.9952258594616721, 'loss_val': 0.3583310124519561, 'psi': 0.8194358368242272}
[S13] START round=12 head_norm_before_train=1.194147 cos_to_last_merge=0.9192 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.919
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.6508483346442879, 'auprc': 0.727707962148123, 'loss_val': 0.6030914312473933, 'psi': 0.681592185645822}-{'f1_val': 0.6945464526675461, 'auprc': 0.7394405037024413, 'loss_val': 0.6150357365597403, 'psi': 0.7125040730815042}
[S14] START round=12 head_norm_before_train=1.057137 cos_to_last_merge=0.9954 (last merge round=10)
[S14] round=12 local utility u=0.066326 metrics={'f1_val': 0.6245148570506169, 'auprc': 0.9957288519170346, 'loss_val': 0.6957114720030411, 'psi': 0.7730004549971841}-{'f1_val': 0.6239357576116431, 'auprc': 0.9942149278036747, 'loss_val': 0.8203462458534564, 'psi': 0.7720474256884557}
[S15] START round=12 head_norm_before_train=0.805236 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.6953983153371612, 'auprc': 0.78183532356827, 'loss_val': 0.8108963870283215, 'psi': 0.7299731186296048}-{'f1_val': 0.6907163700099945, 'auprc': 0.8376954708388799, 'loss_val': 0.8583171811397116, 'psi': 0.7495080103415487}
[S16] START round=12 head_norm_before_train=1.008088 cos_to_last_merge=0.9980 (last merge round=10)
[S16] round=12 local utility u=0.431552 metrics={'f1_val': 0.5592095314073897, 'auprc': 0.9875892350712976, 'loss_val': 0.7027513214038399, 'psi': 0.730561412872953}-{'f1_val': 0.48368541475359655, 'auprc': 0.8716352259679238, 'loss_val': 0.7648481250019566, 'psi': 0.6388653392393275}
[S17] START round=12 head_norm_before_train=1.004702 cos_to_last_merge=1.0000 (last merge round=11)
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.34556041358936485, 'auprc': 0.6911777209672336, 'loss_val': 0.9571863260605719, 'psi': 0.48380733654051233}-{'f1_val': 0.35204211003688723, 'auprc': 0.7175429917939522, 'loss_val': 0.9344696285962254, 'psi': 0.4982424627397133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:39008
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:39015
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:39005
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:39011
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:39009
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S16
[S7] cosine check vs S16: cos=0.9113
[S8] RECEIVED delta(kind=head bytes=1802) from S3
[S8] cosine check vs S3: cos=-0.0371
[S8] DROPPED delta from S3 (cos=-0.0371 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=-0.0554
[S17] DROPPED delta from S5 (cos=-0.0554 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S7
[S2] cosine check vs S7: cos=0.9702
[S5] RECEIVED delta(kind=head bytes=1804) from S11
[S5] cosine check vs S11: cos=-0.0912
[S5] DROPPED delta from S11 (cos=-0.0912 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1795) from S9
[S15] cosine check vs S9: cos=0.8471
[S10] RECEIVED delta(kind=head bytes=1797) from S4
[S10] cosine check vs S4: cos=-0.0549
[S10] DROPPED delta from S4 (cos=-0.0549 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1797) from S14
[S17] cosine check vs S14: cos=0.9684
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7019 head_norm=1.084679
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.573872e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7016 head_norm=1.146495 delta_norm=0.157387
[S2] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.6954 head_norm=0.839043
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.377400e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.6962 head_norm=0.823977 delta_norm=0.237740
[S15] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.6896 head_norm=1.225527
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.543727e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5815 head_norm=1.113669 delta_norm=0.254373
[S7] aggregate: ROLLBACK (f1_val pre=0.690 post=0.582 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3456 head_norm=1.046683
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.368552e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3453 head_norm=1.062479 delta_norm=0.136855
[S17] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.146495 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.021266 metrics={'f1_val': 0.7016451844904732, 'auprc': 0.6656071063356966, 'loss_val': 0.6573322607488746, 'psi': 0.6872299532285626}-{'f1_val': 0.7019057500858747, 'auprc': 0.683806774079261, 'loss_val': 0.7560275776409913, 'psi': 0.6946661596832293}
[S3] START round=13 head_norm_before_train=1.518338 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9954891384248049, 'loss_val': 0.38732368382292953, 'psi': 0.8182438375260729}-{'f1_val': 0.7005813959920884, 'auprc': 0.9986649926570471, 'loss_val': 0.3954234321442141, 'psi': 0.8198148346580718}
[S4] START round=13 head_norm_before_train=1.656645 (no previous merge yet)
[S4] round=13 local utility u=0.942437 metrics={'f1_val': 0.9556700929565621, 'auprc': 0.9506003922146988, 'loss_val': 0.4523394484884181, 'psi': 0.9536422126598167}-{'f1_val': 0.652582494747556, 'auprc': 0.9469422970986958, 'loss_val': 0.5077137714372737, 'psi': 0.770326415688012}
[S5] START round=13 head_norm_before_train=1.132220 cos_to_last_merge=0.8746 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.7139425491833752, 'auprc': 0.7929127139437382, 'loss_val': 0.43111112385853306, 'psi': 0.7455306150875204}-{'f1_val': 0.7006083926626743, 'auprc': 0.9967852893120225, 'loss_val': 0.448640103397582, 'psi': 0.8190791513224136}
[S6] START round=13 head_norm_before_train=0.815136 cos_to_last_merge=0.9954 (last merge round=11)
[S6] round=13 local utility u=0.599363 metrics={'f1_val': 0.6979322865758437, 'auprc': 0.9600119363119204, 'loss_val': 0.6547834728390308, 'psi': 0.8027641464702744}-{'f1_val': 0.6205842955325758, 'auprc': 0.7742171403860334, 'loss_val': 0.8320368680341304, 'psi': 0.6820374334739588}
[S7] START round=13 head_norm_before_train=1.113669 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.41671011811102343, 'auprc': 0.7556094910244208, 'loss_val': 0.8802215250674001, 'psi': 0.5522698672763824}-{'f1_val': 0.6896422075204052, 'auprc': 0.7766886009371594, 'loss_val': 0.9073086787245168, 'psi': 0.7244607648871069}
[S8] START round=13 head_norm_before_train=1.189575 cos_to_last_merge=0.8560 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.856
[S8] round=13 local utility u=0.542231 metrics={'f1_val': 0.5375705177791952, 'auprc': 0.9948240790887775, 'loss_val': 0.4582194486752255, 'psi': 0.7204719423030281}-{'f1_val': 0.3725978128855645, 'auprc': 0.9917699456705218, 'loss_val': 0.5436827746278927, 'psi': 0.6202666659995475}
[S9] START round=13 head_norm_before_train=0.875741 cos_to_last_merge=0.9918 (last merge round=11)
[S9] round=13 local utility u=0.088785 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9973727599832687, 'loss_val': 0.6104569877034637, 'psi': 0.819767904624813}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988049130605536, 'loss_val': 0.7923228300256294, 'psi': 0.8203407658557269}
[S10] START round=13 head_norm_before_train=1.165545 cos_to_last_merge=0.8488 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.849
[S10] round=13 local utility u=0.000000 metrics={'f1_val': 0.5706380365362244, 'auprc': 0.9228427306381278, 'loss_val': 0.44420801235551904, 'psi': 0.7115199141769857}-{'f1_val': 0.6666762581792283, 'auprc': 0.9464634291372229, 'loss_val': 0.40715422804027823, 'psi': 0.7785911265624261}
[S11] START round=13 head_norm_before_train=1.628360 (no previous merge yet)
[S11] round=13 local utility u=0.019213 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9965835625774622, 'loss_val': 0.2592862574484154, 'psi': 0.8197946150099769}-{'f1_val': 0.7020007759458987, 'auprc': 0.9965432423401944, 'loss_val': 0.2979834731764646, 'psi': 0.8198177625036169}
[S13] START round=13 head_norm_before_train=1.230144 cos_to_last_merge=0.9107 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.911
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6278411726880078, 'auprc': 0.6031375976322149, 'loss_val': 0.6326381715222548, 'psi': 0.6179597426656906}-{'f1_val': 0.6508483346442879, 'auprc': 0.727707962148123, 'loss_val': 0.6030914312473933, 'psi': 0.681592185645822}
[S14] START round=13 head_norm_before_train=1.095279 cos_to_last_merge=0.9853 (last merge round=10)
[S14] round=13 local utility u=0.254586 metrics={'f1_val': 0.6927289989942433, 'auprc': 0.9935000589216059, 'loss_val': 0.5891373998173107, 'psi': 0.8130374229651883}-{'f1_val': 0.6245148570506169, 'auprc': 0.9957288519170346, 'loss_val': 0.6957114720030411, 'psi': 0.7730004549971841}
[S15] START round=13 head_norm_before_train=0.823977 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.070061 metrics={'f1_val': 0.6981915840634422, 'auprc': 0.7978301894716829, 'loss_val': 0.7355191046276969, 'psi': 0.7380470262267385}-{'f1_val': 0.6953983153371612, 'auprc': 0.78183532356827, 'loss_val': 0.8108963870283215, 'psi': 0.7299731186296048}
[S16] START round=13 head_norm_before_train=1.052621 cos_to_last_merge=0.9930 (last merge round=10)
[S16] round=13 local utility u=0.325530 metrics={'f1_val': 0.6381104458583962, 'auprc': 0.9876167037241605, 'loss_val': 0.5251785579289298, 'psi': 0.7779129490047019}-{'f1_val': 0.5592095314073897, 'auprc': 0.9875892350712976, 'loss_val': 0.7027513214038399, 'psi': 0.730561412872953}
[S17] START round=13 head_norm_before_train=1.062479 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.041293 metrics={'f1_val': 0.352139803321186, 'auprc': 0.6925006608224322, 'loss_val': 0.9180458949126505, 'psi': 0.4882841463216845}-{'f1_val': 0.34556041358936485, 'auprc': 0.6911777209672336, 'loss_val': 0.9571863260605719, 'psi': 0.48380733654051233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:39015
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:39013
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S4
[S13] cosine check vs S4: cos=-0.1282
[S13] DROPPED delta from S4 (cos=-0.1282 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S6
[S15] cosine check vs S6: cos=0.7317
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:39002
[S14] sending update (kind=head size=1795 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1795) from S14
[S10] cosine check vs S14: cos=0.9316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S9
[S2] cosine check vs S9: cos=0.8215
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39003
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1795) from S16
[S17] cosine check vs S16: cos=0.6596
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:39007
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0350
[S3] DROPPED delta from S8 (cos=-0.0350 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1798) from S15
[S9] cosine check vs S15: cos=0.9457
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:39008
[S17] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S17
[S6] cosine check vs S17: cos=0.0900
[S2] sending update (kind=head size=1800 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1800) from S2
[S7] cosine check vs S2: cos=0.9674
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.4167 head_norm=1.137491
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.489827e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.4167 head_norm=1.147263 delta_norm=0.148983
[S7] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=13 metric=0.6979 head_norm=0.849170
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.630778e-01
[S6] stored merged vector for next round verification (round=13)
[S6] DEBUG after merge:  round=13 metric=0.6975 head_norm=0.723605 delta_norm=0.663078
[S6] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.5706 head_norm=1.209656
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.198659e-01
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.5579 head_norm=1.151674 delta_norm=0.219866
[S10] aggregate: ROLLBACK (f1_val pre=0.571 post=0.558 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7014 head_norm=0.931325
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.516373e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7014 head_norm=0.885058 delta_norm=0.151637
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=13 metric=0.6982 head_norm=0.863295
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.136482e-01
[S15] stored merged vector for next round verification (round=13)
[S15] DEBUG after merge:  round=13 metric=0.6925 head_norm=0.796749 delta_norm=0.313648
[S15] aggregate: ROLLBACK (f1_val pre=0.698 post=0.692 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3521 head_norm=1.097936
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.537783e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3530 head_norm=1.001989 delta_norm=0.453778
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7016 head_norm=1.175981
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.356970e-01
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7016 head_norm=1.006209 delta_norm=0.335697
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.006209 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.079559 metrics={'f1_val': 0.7016506089258296, 'auprc': 0.6707678290492533, 'loss_val': 0.5137292870199827, 'psi': 0.689297496975199}-{'f1_val': 0.7016451844904732, 'auprc': 0.6656071063356966, 'loss_val': 0.6573322607488746, 'psi': 0.6872299532285626}
[S3] START round=14 head_norm_before_train=1.556930 (no previous merge yet)
[S3] round=14 local utility u=0.031166 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9952798425262613, 'loss_val': 0.327370944190899, 'psi': 0.8184607746057575}-{'f1_val': 0.7000803035935849, 'auprc': 0.9954891384248049, 'loss_val': 0.38732368382292953, 'psi': 0.8182438375260729}
[S4] START round=14 head_norm_before_train=1.689186 (no previous merge yet)
[S4] round=14 local utility u=0.036932 metrics={'f1_val': 0.9565121647439899, 'auprc': 0.9546738937180566, 'loss_val': 0.39574813297296485, 'psi': 0.9557768563336165}-{'f1_val': 0.9556700929565621, 'auprc': 0.9506003922146988, 'loss_val': 0.4523394484884181, 'psi': 0.9536422126598167}
[S5] START round=14 head_norm_before_train=1.165787 cos_to_last_merge=0.8619 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.862
[S5] round=14 local utility u=0.303838 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9985168794106316, 'loss_val': 0.36024779669442936, 'psi': 0.8197722081677211}-{'f1_val': 0.7139425491833752, 'auprc': 0.7929127139437382, 'loss_val': 0.43111112385853306, 'psi': 0.7455306150875204}
[S6] START round=14 head_norm_before_train=0.723605 cos_to_last_merge=1.0000 (last merge round=13)
[S6] round=14 local utility u=0.000000 metrics={'f1_val': 0.6737188867050878, 'auprc': 0.7883725293821426, 'loss_val': 0.807848983127883, 'psi': 0.7195803437759097}-{'f1_val': 0.6979322865758437, 'auprc': 0.9600119363119204, 'loss_val': 0.6547834728390308, 'psi': 0.8027641464702744}
[S7] START round=14 head_norm_before_train=1.147263 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.872956 metrics={'f1_val': 0.6896989091087014, 'auprc': 0.7773645959644513, 'loss_val': 0.8375083898073992, 'psi': 0.7247651838510014}-{'f1_val': 0.41671011811102343, 'auprc': 0.7556094910244208, 'loss_val': 0.8802215250674001, 'psi': 0.5522698672763824}
[S8] START round=14 head_norm_before_train=1.228003 cos_to_last_merge=0.8415 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.841
[S8] round=14 local utility u=1.000000 metrics={'f1_val': 0.9928717318851898, 'auprc': 0.9972297932856535, 'loss_val': 0.28814288928229004, 'psi': 0.9946149564453753}-{'f1_val': 0.5375705177791952, 'auprc': 0.9948240790887775, 'loss_val': 0.4582194486752255, 'psi': 0.7204719423030281}
[S9] START round=14 head_norm_before_train=0.885058 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.061390 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9983593674091327, 'loss_val': 0.490636782186112, 'psi': 0.8201625475951586}-{'f1_val': 0.7013646677191758, 'auprc': 0.9973727599832687, 'loss_val': 0.6104569877034637, 'psi': 0.819767904624813}
[S10] START round=14 head_norm_before_train=1.151674 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.551024 metrics={'f1_val': 0.6923417466183792, 'auprc': 0.9944570996662478, 'loss_val': 0.28722553147930346, 'psi': 0.8131878878375267}-{'f1_val': 0.5706380365362244, 'auprc': 0.9228427306381278, 'loss_val': 0.44420801235551904, 'psi': 0.7115199141769857}
[S11] START round=14 head_norm_before_train=1.669490 (no previous merge yet)
[S11] round=14 local utility u=0.021822 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9978019465846718, 'loss_val': 0.21784639318652668, 'psi': 0.8201368663860236}-{'f1_val': 0.7019353166316534, 'auprc': 0.9965835625774622, 'loss_val': 0.2592862574484154, 'psi': 0.8197946150099769}
[S13] START round=14 head_norm_before_train=1.264600 cos_to_last_merge=0.9028 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.903
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.6068324435670336, 'auprc': 0.5543074758311554, 'loss_val': 0.6935196056383052, 'psi': 0.5858224564726823}-{'f1_val': 0.6278411726880078, 'auprc': 0.6031375976322149, 'loss_val': 0.6326381715222548, 'psi': 0.6179597426656906}
[S14] START round=14 head_norm_before_train=1.134073 cos_to_last_merge=0.9744 (last merge round=10)
[S14] round=14 local utility u=0.403446 metrics={'f1_val': 0.8142284842583838, 'auprc': 0.9952718953901045, 'loss_val': 0.5165570242890829, 'psi': 0.8866458487110721}-{'f1_val': 0.6927289989942433, 'auprc': 0.9935000589216059, 'loss_val': 0.5891373998173107, 'psi': 0.8130374229651883}
[S15] START round=14 head_norm_before_train=0.796749 cos_to_last_merge=1.0000 (last merge round=13)
[S15] round=14 local utility u=0.052956 metrics={'f1_val': 0.694276043685915, 'auprc': 0.787156220059797, 'loss_val': 0.5740924812092406, 'psi': 0.7314281142354677}-{'f1_val': 0.6981915840634422, 'auprc': 0.7978301894716829, 'loss_val': 0.7355191046276969, 'psi': 0.7380470262267385}
[S16] START round=14 head_norm_before_train=1.101967 cos_to_last_merge=0.9862 (last merge round=10)
[S16] round=14 local utility u=1.000000 metrics={'f1_val': 0.9852447570777423, 'auprc': 0.9895983327007557, 'loss_val': 0.31638087098480516, 'psi': 0.9869861873269477}-{'f1_val': 0.6381104458583962, 'auprc': 0.9876167037241605, 'loss_val': 0.5251785579289298, 'psi': 0.7779129490047019}
[S17] START round=14 head_norm_before_train=1.001989 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.020916 metrics={'f1_val': 0.35358139409357164, 'auprc': 0.6958560612744393, 'loss_val': 0.8949287848793229, 'psi': 0.4904912609659188}-{'f1_val': 0.352139803321186, 'auprc': 0.6925006608224322, 'loss_val': 0.9180458949126505, 'psi': 0.4882841463216845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:39016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:39003
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:39010
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:39011
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] sending update (kind=head size=1809 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:39012
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:39008
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] → sending delta(kind=head bytes=1789) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:39013
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:39007
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1789) from S9
[S2] cosine check vs S9: cos=0.9019
[S3] RECEIVED delta(kind=head bytes=1797) from S8
[S3] cosine check vs S8: cos=-0.0325
[S3] DROPPED delta from S8 (cos=-0.0325 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=-0.0649
[S4] DROPPED delta from S10 (cos=-0.0649 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S15
[S9] cosine check vs S15: cos=0.8577
[S11] RECEIVED delta(kind=head bytes=1798) from S5
[S11] cosine check vs S5: cos=-0.1052
[S11] DROPPED delta from S5 (cos=-0.1052 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1802) from S14
[S10] cosine check vs S14: cos=0.9698
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.9210
[S7] RECEIVED delta(kind=head bytes=1792) from S2
[S7] cosine check vs S2: cos=0.9215
[S13] RECEIVED delta(kind=head bytes=1798) from S4
[S13] cosine check vs S4: cos=-0.1267
[S13] DROPPED delta from S4 (cos=-0.1267 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.9068
[S17] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S17
[S6] cosine check vs S17: cos=0.7244
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S15
[S17]  timeout peer S16
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S16
[S6]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=14 metric=0.6737 head_norm=0.754479
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.605527e-01
[S6] stored merged vector for next round verification (round=14)
[S6] DEBUG after merge:  round=14 metric=0.6296 head_norm=0.837703 delta_norm=0.360553
[S6] aggregate: ROLLBACK (f1_val pre=0.674 post=0.630 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.9852 head_norm=1.151606
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.315119e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.9391 head_norm=1.140391 delta_norm=0.231512
[S16] aggregate: ROLLBACK (f1_val pre=0.985 post=0.939 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6923 head_norm=1.193361
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.458853e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6948 head_norm=1.175406 delta_norm=0.145885
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7017 head_norm=1.057657
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.284648e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7017 head_norm=0.978913 delta_norm=0.228465
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7014 head_norm=0.949891
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.450175e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7014 head_norm=0.869308 delta_norm=0.245017
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=14 metric=0.6897 head_norm=1.175576
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.285997e-01
[S7] stored merged vector for next round verification (round=14)
[S7] DEBUG after merge:  round=14 metric=0.4167 head_norm=1.094555 delta_norm=0.228600
[S7] aggregate: ROLLBACK (f1_val pre=0.690 post=0.417 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=14 metric=0.3536 head_norm=1.046065
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.426778e-01
[S17] stored merged vector for next round verification (round=14)
[S17] DEBUG after merge:  round=14 metric=0.3536 head_norm=1.073001 delta_norm=0.242678
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=0.978913 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.134751 metrics={'f1_val': 0.7013877936722278, 'auprc': 0.730287747349608, 'loss_val': 0.42121012342158715, 'psi': 0.7129477751431799}-{'f1_val': 0.7016506089258296, 'auprc': 0.6707678290492533, 'loss_val': 0.5137292870199827, 'psi': 0.689297496975199}
[S3] START round=15 head_norm_before_train=1.593341 (no previous merge yet)
[S3] round=15 local utility u=0.021780 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.995278320453438, 'loss_val': 0.28530816132536296, 'psi': 0.8186103691966616}-{'f1_val': 0.7005813959920884, 'auprc': 0.9952798425262613, 'loss_val': 0.327370944190899, 'psi': 0.8184607746057575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=15 head_norm_before_train=1.719448 (no previous merge yet)
[S4] round=15 local utility u=0.000000 metrics={'f1_val': 0.9531202190160247, 'auprc': 0.9457217007183728, 'loss_val': 0.3766291330419981, 'psi': 0.950160811696964}-{'f1_val': 0.9565121647439899, 'auprc': 0.9546738937180566, 'loss_val': 0.39574813297296485, 'psi': 0.9557768563336165}
[S5] START round=15 head_norm_before_train=1.191797 cos_to_last_merge=0.8505 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.851
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8973204799842781, 'loss_val': 0.356985961614828, 'psi': 0.7792932275913158}-{'f1_val': 0.7006090940057808, 'auprc': 0.9985168794106316, 'loss_val': 0.36024779669442936, 'psi': 0.8197722081677211}
[S6] START round=15 head_norm_before_train=0.837703 cos_to_last_merge=1.0000 (last merge round=14)
[S6] round=15 local utility u=0.376149 metrics={'f1_val': 0.7038184341584212, 'auprc': 0.9639033230449012, 'loss_val': 0.7627407771834934, 'psi': 0.8078523897130132}-{'f1_val': 0.6737188867050878, 'auprc': 0.7883725293821426, 'loss_val': 0.807848983127883, 'psi': 0.7195803437759097}
[S7] START round=15 head_norm_before_train=1.094555 cos_to_last_merge=1.0000 (last merge round=14)
[S7] round=15 local utility u=0.061672 metrics={'f1_val': 0.6922781530481334, 'auprc': 0.7781580519239326, 'loss_val': 0.7320209530134233, 'psi': 0.7266301125984531}-{'f1_val': 0.6896989091087014, 'auprc': 0.7773645959644513, 'loss_val': 0.8375083898073992, 'psi': 0.7247651838510014}
[S8] START round=15 head_norm_before_train=1.263235 cos_to_last_merge=0.8305 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=15 local utility u=0.000000 metrics={'f1_val': 0.7155593010802939, 'auprc': 0.9918902580140148, 'loss_val': 0.27116021174335236, 'psi': 0.8260916838537822}-{'f1_val': 0.9928717318851898, 'auprc': 0.9972297932856535, 'loss_val': 0.28814288928229004, 'psi': 0.9946149564453753}
[S9] START round=15 head_norm_before_train=0.869308 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.030128 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9984455974409725, 'loss_val': 0.43063944472915366, 'psi': 0.8201970396078946}-{'f1_val': 0.7013646677191758, 'auprc': 0.9983593674091327, 'loss_val': 0.490636782186112, 'psi': 0.8201625475951586}
[S10] START round=15 head_norm_before_train=1.175406 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.046443 metrics={'f1_val': 0.699099322349742, 'auprc': 0.9973653805866386, 'loss_val': 0.2436098362281914, 'psi': 0.8184057456445006}-{'f1_val': 0.6923417466183792, 'auprc': 0.9944570996662478, 'loss_val': 0.28722553147930346, 'psi': 0.8131878878375267}
[S11] START round=15 head_norm_before_train=1.701938 (no previous merge yet)
[S11] round=15 local utility u=0.775396 metrics={'f1_val': 0.9573527113557667, 'auprc': 0.9965949438678591, 'loss_val': 0.1973888626875587, 'psi': 0.9730496043606036}-{'f1_val': 0.7016934795869249, 'auprc': 0.9978019465846718, 'loss_val': 0.21784639318652668, 'psi': 0.8201368663860236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=15 head_norm_before_train=1.290969 cos_to_last_merge=0.8962 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.896
[S13] round=15 local utility u=0.231476 metrics={'f1_val': 0.6115630185206153, 'auprc': 0.6598022238069307, 'loss_val': 0.5754354876962054, 'psi': 0.6308587006351414}-{'f1_val': 0.6068324435670336, 'auprc': 0.5543074758311554, 'loss_val': 0.6935196056383052, 'psi': 0.5858224564726823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=15 head_norm_before_train=1.175422 cos_to_last_merge=0.9634 (last merge round=10)
[S14] round=15 local utility u=0.066149 metrics={'f1_val': 0.821064374280793, 'auprc': 0.9987332465998493, 'loss_val': 0.4356575434693412, 'psi': 0.8921319232084155}-{'f1_val': 0.8142284842583838, 'auprc': 0.9952718953901045, 'loss_val': 0.5165570242890829, 'psi': 0.8866458487110721}
[S15] START round=15 head_norm_before_train=0.853913 cos_to_last_merge=0.9957 (last merge round=13)
[S15] round=15 local utility u=0.043422 metrics={'f1_val': 0.6934496505493444, 'auprc': 0.789277858211814, 'loss_val': 0.4886558869998125, 'psi': 0.7317809336143322}-{'f1_val': 0.694276043685915, 'auprc': 0.787156220059797, 'loss_val': 0.5740924812092406, 'psi': 0.7314281142354677}
[S16] START round=15 head_norm_before_train=1.140391 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.015991 metrics={'f1_val': 0.9854670376907881, 'auprc': 0.9897178196914425, 'loss_val': 0.2860913547282016, 'psi': 0.9871673504910499}-{'f1_val': 0.9852447570777423, 'auprc': 0.9895983327007557, 'loss_val': 0.31638087098480516, 'psi': 0.9869861873269477}
[S17] START round=15 head_norm_before_train=1.073001 cos_to_last_merge=1.0000 (last merge round=14)
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.35530336842134874, 'auprc': 0.6471701016740268, 'loss_val': 0.8805401884144088, 'psi': 0.4720500617224199}-{'f1_val': 0.35358139409357164, 'auprc': 0.6958560612744393, 'loss_val': 0.8949287848793229, 'psi': 0.4904912609659188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:39010
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:39004
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:39017
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S2@127.0.0.1:39002
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:39008
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:39015
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:39016
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:39011
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] ⇄ pheromone p=0.353 → S3@127.0.0.1:39003
[S2] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S4] ⇄ pheromone p=0.285 → S13@127.0.0.1:39013
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1790) from S9
[S2] cosine check vs S9: cos=0.9047
[S10] RECEIVED delta(kind=head bytes=1799) from S14
[S10] cosine check vs S14: cos=0.9848
[S15] RECEIVED delta(kind=head bytes=1798) from S6
[S15] cosine check vs S6: cos=0.5313
[S17] RECEIVED delta(kind=head bytes=1800) from S16
[S17] cosine check vs S16: cos=0.9389
[S7] RECEIVED delta(kind=head bytes=1804) from S2
[S7] cosine check vs S2: cos=0.9064
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=-0.0673
[S4] DROPPED delta from S10 (cos=-0.0673 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S7
[S16] cosine check vs S7: cos=0.9421
[S9] RECEIVED delta(kind=head bytes=1795) from S15
[S9] cosine check vs S15: cos=0.9361
[S6] ⇄ pheromone p=0.297 → S15@127.0.0.1:39015
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7014 head_norm=1.033677
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.202438e-01
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7014 head_norm=0.959871 delta_norm=0.220244
[S2] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.167 → S7@127.0.0.1:39008
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6934 head_norm=0.910446
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.301252e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6933 head_norm=0.776679 delta_norm=0.430125
[S15] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.140 → S9@127.0.0.1:39010
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=15 metric=0.9855 head_norm=1.184395
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.985996e-01
[S16] stored merged vector for next round verification (round=15)
[S16] DEBUG after merge:  round=15 metric=0.9855 head_norm=1.137025 delta_norm=0.198600
[S16] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.370 → S17@127.0.0.1:39017
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.6991 head_norm=1.215386
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.058616e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.6993 head_norm=1.208807 delta_norm=0.105862
[S10] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.220 → S4@127.0.0.1:39004
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6923 head_norm=1.123273
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.373817e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.4247 head_norm=1.052979 delta_norm=0.237382
[S7] aggregate: ROLLBACK (f1_val pre=0.692 post=0.425 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.313 → S16@127.0.0.1:39016
[S14] ⇄ pheromone p=0.230 → S10@127.0.0.1:39011
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7014 head_norm=0.933398
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.651916e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7014 head_norm=0.907074 delta_norm=0.165192
[S9] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.196 → S2@127.0.0.1:39002
[S17] RoundReady barrier timeout: have=1 need=2 — continuing
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.185 → S11@127.0.0.1:39012
[S16]  timeout peer S17
[S4]  timeout peer S13
[S8]  timeout peer S3
[S14]  timeout peer S10
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S14
[S15]  timeout peer S9
[S2]  timeout peer S7
[S10]  timeout peer S4
[S5]  timeout peer S8
[S5]  timeout peer S11
[S6]  timeout peer S15
[S7]  timeout peer S16
[S9]  timeout peer S2
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3553 head_norm=1.106477
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.038602e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3552 head_norm=1.127822 delta_norm=0.203860
[S17] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=16 head_norm_before_train=0.959871 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7013860519943325, 'auprc': 0.6842658733696507, 'loss_val': 0.3885158670255667, 'psi': 0.6945379805444598}-{'f1_val': 0.7013877936722278, 'auprc': 0.730287747349608, 'loss_val': 0.42121012342158715, 'psi': 0.7129477751431799}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=16 head_norm_before_train=1.628467 (no previous merge yet)
[S3] round=16 local utility u=0.015353 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9969403114869497, 'loss_val': 0.2591346117297277, 'psi': 0.8192298468359597}-{'f1_val': 0.7008317350254774, 'auprc': 0.995278320453438, 'loss_val': 0.28530816132536296, 'psi': 0.8186103691966616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=16 head_norm_before_train=1.746526 (no previous merge yet)
[S4] round=16 local utility u=0.042277 metrics={'f1_val': 0.952714981718052, 'auprc': 0.9597245506808619, 'loss_val': 0.3316520347572902, 'psi': 0.9555188093031759}-{'f1_val': 0.9531202190160247, 'auprc': 0.9457217007183728, 'loss_val': 0.3766291330419981, 'psi': 0.950160811696964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=16 head_norm_before_train=1.213311 cos_to_last_merge=0.8417 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7014791008847807, 'auprc': 0.8147483677959106, 'loss_val': 0.35852084530905565, 'psi': 0.7467868076492327}-{'f1_val': 0.7006083926626743, 'auprc': 0.8973204799842781, 'loss_val': 0.356985961614828, 'psi': 0.7792932275913158}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=16 head_norm_before_train=0.864617 cos_to_last_merge=0.9949 (last merge round=14)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7097365603197886, 'auprc': 0.8176515937975047, 'loss_val': 0.6654546720986511, 'psi': 0.7529025737108751}-{'f1_val': 0.7038184341584212, 'auprc': 0.9639033230449012, 'loss_val': 0.7627407771834934, 'psi': 0.8078523897130132}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=1.052979 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.42141136051554323, 'auprc': 0.7817742730262199, 'loss_val': 0.8439186812355092, 'psi': 0.565556525519814}-{'f1_val': 0.6922781530481334, 'auprc': 0.7781580519239326, 'loss_val': 0.7320209530134233, 'psi': 0.7266301125984531}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=1.292642 cos_to_last_merge=0.8221 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.822
[S8] round=16 local utility u=0.859701 metrics={'f1_val': 0.9960878102233311, 'auprc': 0.996042702996239, 'loss_val': 0.2473860335632334, 'psi': 0.9960697673324943}-{'f1_val': 0.7155593010802939, 'auprc': 0.9918902580140148, 'loss_val': 0.27116021174335236, 'psi': 0.8260916838537822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=16 head_norm_before_train=0.907074 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.025301 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988177528889572, 'loss_val': 0.38115464472618793, 'psi': 0.8203459017870884}-{'f1_val': 0.7013646677191758, 'auprc': 0.9984455974409725, 'loss_val': 0.43063944472915366, 'psi': 0.8201970396078946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=16 head_norm_before_train=1.208807 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.891845 metrics={'f1_val': 0.9920770279767339, 'auprc': 0.9974846750786381, 'loss_val': 0.21814338105968487, 'psi': 0.9942400868174955}-{'f1_val': 0.699099322349742, 'auprc': 0.9973653805866386, 'loss_val': 0.2436098362281914, 'psi': 0.8184057456445006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=16 head_norm_before_train=1.728870 (no previous merge yet)
[S11] round=16 local utility u=0.145529 metrics={'f1_val': 0.9972025417404027, 'auprc': 0.9983529203134746, 'loss_val': 0.15070311156634475, 'psi': 0.9976626931696315}-{'f1_val': 0.9573527113557667, 'auprc': 0.9965949438678591, 'loss_val': 0.1973888626875587, 'psi': 0.9730496043606036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=16 head_norm_before_train=1.315834 cos_to_last_merge=0.8899 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.890
[S13] round=16 local utility u=0.064132 metrics={'f1_val': 0.6421286646067181, 'auprc': 0.6384377656043763, 'loss_val': 0.5664725574116832, 'psi': 0.6406523050057814}-{'f1_val': 0.6115630185206153, 'auprc': 0.6598022238069307, 'loss_val': 0.5754354876962054, 'psi': 0.6308587006351414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=16 head_norm_before_train=1.211478 cos_to_last_merge=0.9539 (last merge round=10)
[S14] round=16 local utility u=0.541913 metrics={'f1_val': 0.9953256685795713, 'auprc': 0.9960336144103956, 'loss_val': 0.3893012480490293, 'psi': 0.995608846911901}-{'f1_val': 0.821064374280793, 'auprc': 0.9987332465998493, 'loss_val': 0.4356575434693412, 'psi': 0.8921319232084155}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=16 head_norm_before_train=0.776679 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.508340 metrics={'f1_val': 0.7618633136667726, 'auprc': 0.9854559800143122, 'loss_val': 0.47099210860876634, 'psi': 0.8513003802057885}-{'f1_val': 0.6934496505493444, 'auprc': 0.789277858211814, 'loss_val': 0.4886558869998125, 'psi': 0.7317809336143322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=16 head_norm_before_train=1.137025 cos_to_last_merge=1.0000 (last merge round=15)
[S16] round=16 local utility u=0.000000 metrics={'f1_val': 0.8303624373926912, 'auprc': 0.8672515539849694, 'loss_val': 0.7614409987573146, 'psi': 0.8451180840296025}-{'f1_val': 0.9854670376907881, 'auprc': 0.9897178196914425, 'loss_val': 0.2860913547282016, 'psi': 0.9871673504910499}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=16 head_norm_before_train=1.127822 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.020100 metrics={'f1_val': 0.3566248108312836, 'auprc': 0.6542490915395099, 'loss_val': 0.8695048846680147, 'psi': 0.47567452311457414}-{'f1_val': 0.35530336842134874, 'auprc': 0.6471701016740268, 'loss_val': 0.8805401884144088, 'psi': 0.4720500617224199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=17 head_norm_before_train=1.012258 cos_to_last_merge=0.9980 (last merge round=15)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7015658713512667, 'auprc': 0.6633838153655768, 'loss_val': 0.352844910831212, 'psi': 0.6862930489569907}-{'f1_val': 0.7013860519943325, 'auprc': 0.6842658733696507, 'loss_val': 0.3885158670255667, 'psi': 0.6945379805444598}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.662904 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9981215433683598, 'loss_val': 0.2633709600825422, 'psi': 0.8196122188474673}-{'f1_val': 0.7007562037352997, 'auprc': 0.9969403114869497, 'loss_val': 0.2591346117297277, 'psi': 0.8192298468359597}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=1.768286 (no previous merge yet)
[S4] round=17 local utility u=0.000000 metrics={'f1_val': 0.9475727569298679, 'auprc': 0.9436766649616727, 'loss_val': 0.3133008155587395, 'psi': 0.9460143201425899}-{'f1_val': 0.952714981718052, 'auprc': 0.9597245506808619, 'loss_val': 0.3316520347572902, 'psi': 0.9555188093031759}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=17 head_norm_before_train=1.230393 cos_to_last_merge=0.8365 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=17 local utility u=0.292051 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9985163376281344, 'loss_val': 0.3205021701930128, 'psi': 0.8197719914547222}-{'f1_val': 0.7014791008847807, 'auprc': 0.8147483677959106, 'loss_val': 0.35852084530905565, 'psi': 0.7467868076492327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=17 head_norm_before_train=0.902737 cos_to_last_merge=0.9822 (last merge round=14)
[S6] round=17 local utility u=0.238167 metrics={'f1_val': 0.6967794845029658, 'auprc': 0.9599946979869758, 'loss_val': 0.5384083732021061, 'psi': 0.8020655698965697}-{'f1_val': 0.7097365603197886, 'auprc': 0.8176515937975047, 'loss_val': 0.6654546720986511, 'psi': 0.7529025737108751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=17 head_norm_before_train=1.078156 cos_to_last_merge=0.9985 (last merge round=15)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.41455935001416266, 'auprc': 0.7774848166563626, 'loss_val': 0.842982759972279, 'psi': 0.5597295366710426}-{'f1_val': 0.42141136051554323, 'auprc': 0.7817742730262199, 'loss_val': 0.8439186812355092, 'psi': 0.565556525519814}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=1.317701 cos_to_last_merge=0.8152 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.815
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9936208146045606, 'loss_val': 0.43228639879062775, 'psi': 0.8258196264822117}-{'f1_val': 0.9960878102233311, 'auprc': 0.996042702996239, 'loss_val': 0.2473860335632334, 'psi': 0.9960697673324943}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=17 head_norm_before_train=0.965953 cos_to_last_merge=0.9969 (last merge round=15)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.6997803143171595, 'auprc': 0.8655258776356259, 'loss_val': 0.42679858076493765, 'psi': 0.7660785396445461}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988177528889572, 'loss_val': 0.38115464472618793, 'psi': 0.8203459017870884}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=17 head_norm_before_train=1.244191 cos_to_last_merge=0.9991 (last merge round=15)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9542288112943444, 'auprc': 0.9967664443194936, 'loss_val': 0.24389413805729163, 'psi': 0.9712438645044041}-{'f1_val': 0.9920770279767339, 'auprc': 0.9974846750786381, 'loss_val': 0.21814338105968487, 'psi': 0.9942400868174955}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=17 head_norm_before_train=1.755480 (no previous merge yet)
[S11] round=17 local utility u=0.005410 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979833423798309, 'loss_val': 0.13338972679272093, 'psi': 0.9969764374332489}-{'f1_val': 0.9972025417404027, 'auprc': 0.9983529203134746, 'loss_val': 0.15070311156634475, 'psi': 0.9976626931696315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=17 head_norm_before_train=1.341376 cos_to_last_merge=0.8842 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.884
[S13] round=17 local utility u=0.045423 metrics={'f1_val': 0.6331909074557757, 'auprc': 0.6787697037859867, 'loss_val': 0.5429956332250266, 'psi': 0.65142242598786}-{'f1_val': 0.6421286646067181, 'auprc': 0.6384377656043763, 'loss_val': 0.5664725574116832, 'psi': 0.6406523050057814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=17 head_norm_before_train=1.242992 cos_to_last_merge=0.9464 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.946
[S14] round=17 local utility u=0.018721 metrics={'f1_val': 0.9943440114997606, 'auprc': 0.9988156564805335, 'loss_val': 0.35431560704828025, 'psi': 0.9961326694920698}-{'f1_val': 0.9953256685795713, 'auprc': 0.9960336144103956, 'loss_val': 0.3893012480490293, 'psi': 0.995608846911901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=17 head_norm_before_train=0.830236 cos_to_last_merge=0.9961 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6865464694274808, 'auprc': 0.6898383481844473, 'loss_val': 0.6182485072582756, 'psi': 0.6878632209302674}-{'f1_val': 0.7618633136667726, 'auprc': 0.9854559800143122, 'loss_val': 0.47099210860876634, 'psi': 0.8513003802057885}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=1.178759 cos_to_last_merge=0.9989 (last merge round=15)
[S16] round=17 local utility u=0.905621 metrics={'f1_val': 0.9889833869254785, 'auprc': 0.9784915892135936, 'loss_val': 0.23564508906668222, 'psi': 0.9847866678407245}-{'f1_val': 0.8303624373926912, 'auprc': 0.8672515539849694, 'loss_val': 0.7614409987573146, 'psi': 0.8451180840296025}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=17 head_norm_before_train=1.148659 cos_to_last_merge=0.9995 (last merge round=15)
[S17] round=17 local utility u=0.102242 metrics={'f1_val': 0.36496562202430965, 'auprc': 0.6896490449145005, 'loss_val': 0.8212661138054359, 'psi': 0.494838991180386}-{'f1_val': 0.3566248108312836, 'auprc': 0.6542490915395099, 'loss_val': 0.8695048846680147, 'psi': 0.47567452311457414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=18 head_norm_before_train=1.061540 cos_to_last_merge=0.9935 (last merge round=15)
[S2] round=18 local utility u=0.005684 metrics={'f1_val': 0.7015696803571123, 'auprc': 0.6669236198777542, 'loss_val': 0.3521200655716058, 'psi': 0.6877112561653691}-{'f1_val': 0.7015658713512667, 'auprc': 0.6633838153655768, 'loss_val': 0.352844910831212, 'psi': 0.6862930489569907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=18 head_norm_before_train=1.690430 (no previous merge yet)
[S3] round=18 local utility u=0.030886 metrics={'f1_val': 0.7003512381127298, 'auprc': 0.9984512918666977, 'loss_val': 0.20105972881645617, 'psi': 0.8195912596143169}-{'f1_val': 0.7006060025002057, 'auprc': 0.9981215433683598, 'loss_val': 0.2633709600825422, 'psi': 0.8196122188474673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=18 head_norm_before_train=1.790256 (no previous merge yet)
[S4] round=18 local utility u=0.053595 metrics={'f1_val': 0.9529165708047964, 'auprc': 0.9608009634420125, 'loss_val': 0.289546910398204, 'psi': 0.9560703278596828}-{'f1_val': 0.9475727569298679, 'auprc': 0.9436766649616727, 'loss_val': 0.3133008155587395, 'psi': 0.9460143201425899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=18 head_norm_before_train=1.248273 cos_to_last_merge=0.8332 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=18 local utility u=0.000000 metrics={'f1_val': 0.7140074523840222, 'auprc': 0.7945745364171855, 'loss_val': 0.4195755398157346, 'psi': 0.7462342859972875}-{'f1_val': 0.7006090940057808, 'auprc': 0.9985163376281344, 'loss_val': 0.3205021701930128, 'psi': 0.8197719914547222}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=18 head_norm_before_train=0.947013 cos_to_last_merge=0.9654 (last merge round=14)
[S6] round=18 local utility u=0.018964 metrics={'f1_val': 0.7093606346101187, 'auprc': 0.9395975007082943, 'loss_val': 0.5147758679779368, 'psi': 0.801455381049389}-{'f1_val': 0.6967794845029658, 'auprc': 0.9599946979869758, 'loss_val': 0.5384083732021061, 'psi': 0.8020655698965697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=18 head_norm_before_train=1.104988 cos_to_last_merge=0.9951 (last merge round=15)
[S7] round=18 local utility u=1.000000 metrics={'f1_val': 0.6673075632458985, 'auprc': 0.8600068659944213, 'loss_val': 0.561040196432741, 'psi': 0.7443872843453077}-{'f1_val': 0.41455935001416266, 'auprc': 0.7774848166563626, 'loss_val': 0.842982759972279, 'psi': 0.5597295366710426}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=18 head_norm_before_train=1.341401 cos_to_last_merge=0.8105 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=18 local utility u=0.971063 metrics={'f1_val': 0.9937219377936214, 'auprc': 0.9991974467935814, 'loss_val': 0.1855094567691673, 'psi': 0.9959121413936054}-{'f1_val': 0.7139521677339791, 'auprc': 0.9936208146045606, 'loss_val': 0.43228639879062775, 'psi': 0.8258196264822117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=18 head_norm_before_train=1.023198 cos_to_last_merge=0.9904 (last merge round=15)
[S9] round=18 local utility u=0.277115 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9991991014675807, 'loss_val': 0.28309448618727595, 'psi': 0.8204984412185379}-{'f1_val': 0.6997803143171595, 'auprc': 0.8655258776356259, 'loss_val': 0.42679858076493765, 'psi': 0.7660785396445461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=18 head_norm_before_train=1.279108 cos_to_last_merge=0.9968 (last merge round=15)
[S10] round=18 local utility u=0.158563 metrics={'f1_val': 0.9951704237150173, 'auprc': 0.9967974803461984, 'loss_val': 0.1725100341426771, 'psi': 0.9958212463674897}-{'f1_val': 0.9542288112943444, 'auprc': 0.9967664443194936, 'loss_val': 0.24389413805729163, 'psi': 0.9712438645044041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=18 head_norm_before_train=1.776061 (no previous merge yet)
[S11] round=18 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.99667713503846, 'loss_val': 0.14047915313325046, 'psi': 0.9967563638711313}-{'f1_val': 0.996305167468861, 'auprc': 0.9979833423798309, 'loss_val': 0.13338972679272093, 'psi': 0.9969764374332489}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=18 head_norm_before_train=1.363801 cos_to_last_merge=0.8788 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.879
[S13] round=18 local utility u=0.105337 metrics={'f1_val': 0.672004978286043, 'auprc': 0.6597522804754739, 'loss_val': 0.5081539304856427, 'psi': 0.6671038991618153}-{'f1_val': 0.6331909074557757, 'auprc': 0.6787697037859867, 'loss_val': 0.5429956332250266, 'psi': 0.65142242598786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=18 head_norm_before_train=1.275432 cos_to_last_merge=0.9388 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=18 local utility u=0.041393 metrics={'f1_val': 0.9948287929808537, 'auprc': 0.998831733204164, 'loss_val': 0.2744873275354537, 'psi': 0.9964299690701778}-{'f1_val': 0.9943440114997606, 'auprc': 0.9988156564805335, 'loss_val': 0.35431560704828025, 'psi': 0.9961326694920698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=18 head_norm_before_train=0.886225 cos_to_last_merge=0.9875 (last merge round=15)
[S15] round=18 local utility u=0.386474 metrics={'f1_val': 0.6919432445953427, 'auprc': 0.8619910776269151, 'loss_val': 0.3941397881207326, 'psi': 0.7599623778079717}-{'f1_val': 0.6865464694274808, 'auprc': 0.6898383481844473, 'loss_val': 0.6182485072582756, 'psi': 0.6878632209302674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S16] START round=18 head_norm_before_train=1.222070 cos_to_last_merge=0.9960 (last merge round=15)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.9206871043002792, 'auprc': 0.9881882733887557, 'loss_val': 0.3827318121846852, 'psi': 0.9476875719356699}-{'f1_val': 0.9889833869254785, 'auprc': 0.9784915892135936, 'loss_val': 0.23564508906668222, 'psi': 0.9847866678407245}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.163730 cos_to_last_merge=0.9981 (last merge round=15)
[S17] round=18 local utility u=0.390162 metrics={'f1_val': 0.41427439723435544, 'auprc': 0.8180401887822695, 'loss_val': 0.7219686646929855, 'psi': 0.5757807138535211}-{'f1_val': 0.36496562202430965, 'auprc': 0.6896490449145005, 'loss_val': 0.8212661138054359, 'psi': 0.494838991180386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=19 head_norm_before_train=1.105815 cos_to_last_merge=0.9882 (last merge round=15)
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.674338229693043, 'auprc': 0.6565279840387828, 'loss_val': 0.4168436712844789, 'psi': 0.6672141314313389}-{'f1_val': 0.7015696803571123, 'auprc': 0.6669236198777542, 'loss_val': 0.3521200655716058, 'psi': 0.6877112561653691}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.667 u=0.0000 p_local=0.0695 f1=0.674 auprc=0.657 bytes=19772
[S3] START round=19 head_norm_before_train=1.716059 (no previous merge yet)
[S3] round=19 local utility u=0.716074 metrics={'f1_val': 0.9301950829634724, 'auprc': 0.9984830207464928, 'loss_val': 0.14807010119165717, 'psi': 0.9575102580766806}-{'f1_val': 0.7003512381127298, 'auprc': 0.9984512918666977, 'loss_val': 0.20105972881645617, 'psi': 0.8195912596143169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] r=20 psi=0.958 u=0.7161 p_local=0.2331 f1=0.930 auprc=0.998 bytes=25204
[S4] START round=19 head_norm_before_train=1.809167 (no previous merge yet)
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9499166026874142, 'auprc': 0.9548451917247955, 'loss_val': 0.2976016323821192, 'psi': 0.9518880383023667}-{'f1_val': 0.9529165708047964, 'auprc': 0.9608009634420125, 'loss_val': 0.289546910398204, 'psi': 0.9560703278596828}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.952 u=0.0000 p_local=0.1297 f1=0.950 auprc=0.955 bytes=25138
[S5] START round=19 head_norm_before_train=1.269676 cos_to_last_merge=0.8308 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=19 local utility u=0.318275 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9955983915193334, 'loss_val': 0.3057023383505052, 'psi': 0.8186043922053379}-{'f1_val': 0.7140074523840222, 'auprc': 0.7945745364171855, 'loss_val': 0.4195755398157346, 'psi': 0.7462342859972875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S5] r=20 psi=0.819 u=0.3183 p_local=0.1767 f1=0.701 auprc=0.996 bytes=23383
[S6] START round=19 head_norm_before_train=0.982885 cos_to_last_merge=0.9516 (last merge round=14)
[S6] round=19 local utility u=0.126823 metrics={'f1_val': 0.7074912997862376, 'auprc': 0.9912351469250602, 'loss_val': 0.40482750651983973, 'psi': 0.8209888386417666}-{'f1_val': 0.7093606346101187, 'auprc': 0.9395975007082943, 'loss_val': 0.5147758679779368, 'psi': 0.801455381049389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S6] sending update (kind=head size=1783 to 1 peers)
[S6] r=20 psi=0.821 u=0.1268 p_local=0.1804 f1=0.707 auprc=0.991 bytes=25095
[S7] START round=19 head_norm_before_train=1.129838 cos_to_last_merge=0.9909 (last merge round=15)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.3898140123145374, 'auprc': 0.7387657466292261, 'loss_val': 1.069192939443009, 'psi': 0.5293947060404129}-{'f1_val': 0.6673075632458985, 'auprc': 0.8600068659944213, 'loss_val': 0.561040196432741, 'psi': 0.7443872843453077}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.529 u=0.0000 p_local=0.2881 f1=0.390 auprc=0.739 bytes=23369
[S8] START round=19 head_norm_before_train=1.362077 cos_to_last_merge=0.8073 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=19 local utility u=0.029183 metrics={'f1_val': 0.9963530749356245, 'auprc': 0.9991952422825667, 'loss_val': 0.14292329265327927, 'psi': 0.9974899418744014}-{'f1_val': 0.9937219377936214, 'auprc': 0.9991974467935814, 'loss_val': 0.1855094567691673, 'psi': 0.9959121413936054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=20 psi=0.997 u=0.0292 p_local=0.3938 f1=0.996 auprc=0.999 bytes=26960
[S9] START round=19 head_norm_before_train=1.072385 cos_to_last_merge=0.9836 (last merge round=15)
[S9] round=19 local utility u=0.021852 metrics={'f1_val': 0.7014391336149548, 'auprc': 0.9995787587418166, 'loss_val': 0.24097547222545182, 'psi': 0.8206949836656995}-{'f1_val': 0.7013646677191758, 'auprc': 0.9991991014675807, 'loss_val': 0.28309448618727595, 'psi': 0.8204984412185379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=20 psi=0.821 u=0.0219 p_local=0.1315 f1=0.701 auprc=1.000 bytes=26916
[S10] START round=19 head_norm_before_train=1.314374 cos_to_last_merge=0.9934 (last merge round=15)
[S10] round=19 local utility u=0.020216 metrics={'f1_val': 0.993705525296829, 'auprc': 0.9970057669740808, 'loss_val': 0.1239137044548262, 'psi': 0.9950256219677297}-{'f1_val': 0.9951704237150173, 'auprc': 0.9967974803461984, 'loss_val': 0.1725100341426771, 'psi': 0.9958212463674897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=20 psi=0.995 u=0.0202 p_local=0.2107 f1=0.994 auprc=0.997 bytes=23314
[S11] START round=19 head_norm_before_train=1.797835 (no previous merge yet)
[S11] round=19 local utility u=0.030268 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980851670882354, 'loss_val': 0.08259484673095079, 'psi': 0.9971622695434479}-{'f1_val': 0.9968091830929121, 'auprc': 0.99667713503846, 'loss_val': 0.14047915313325046, 'psi': 0.9967563638711313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S11] r=20 psi=0.997 u=0.0303 p_local=0.1450 f1=0.997 auprc=0.998 bytes=28809
[S13] START round=19 head_norm_before_train=1.384294 cos_to_last_merge=0.8751 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.875
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.6347660632200316, 'auprc': 0.6690585796923263, 'loss_val': 0.5566292889387071, 'psi': 0.6484830698089494}-{'f1_val': 0.672004978286043, 'auprc': 0.6597522804754739, 'loss_val': 0.5081539304856427, 'psi': 0.6671038991618153}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.648 u=0.0000 p_local=0.1164 f1=0.635 auprc=0.669 bytes=21563
[S14] START round=19 head_norm_before_train=1.307978 cos_to_last_merge=0.9319 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=19 local utility u=0.022218 metrics={'f1_val': 0.9950697641668289, 'auprc': 0.9987821924349342, 'loss_val': 0.2313489121163218, 'psi': 0.9965547354740709}-{'f1_val': 0.9948287929808537, 'auprc': 0.998831733204164, 'loss_val': 0.2744873275354537, 'psi': 0.9964299690701778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S14] r=20 psi=0.997 u=0.0222 p_local=0.1632 f1=0.995 auprc=0.999 bytes=26916
[S15] START round=19 head_norm_before_train=0.936164 cos_to_last_merge=0.9786 (last merge round=15)
[S15] round=19 local utility u=0.083862 metrics={'f1_val': 0.7620283808272988, 'auprc': 0.8006229098541362, 'loss_val': 0.46282142418159655, 'psi': 0.7774661924380337}-{'f1_val': 0.6919432445953427, 'auprc': 0.8619910776269151, 'loss_val': 0.3941397881207326, 'psi': 0.7599623778079717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] sending update (kind=head size=1790 to 1 peers)
[S15] r=20 psi=0.777 u=0.0839 p_local=0.1881 f1=0.762 auprc=0.801 bytes=25125
[S16] START round=19 head_norm_before_train=1.266836 cos_to_last_merge=0.9921 (last merge round=15)
[S16] round=19 local utility u=0.130513 metrics={'f1_val': 0.9388257503669041, 'auprc': 0.9926072426007487, 'loss_val': 0.24379491038038015, 'psi': 0.9603383472604419}-{'f1_val': 0.9206871043002792, 'auprc': 0.9881882733887557, 'loss_val': 0.3827318121846852, 'psi': 0.9476875719356699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=20 psi=0.960 u=0.1305 p_local=0.2937 f1=0.939 auprc=0.993 bytes=21551
[S17] START round=19 head_norm_before_train=1.178215 cos_to_last_merge=0.9963 (last merge round=15)
[S17] round=19 local utility u=0.069140 metrics={'f1_val': 0.41707695228725883, 'auprc': 0.8447961710480594, 'loss_val': 0.6807712918038209, 'psi': 0.5881646397915791}-{'f1_val': 0.41427439723435544, 'auprc': 0.8180401887822695, 'loss_val': 0.7219686646929855, 'psi': 0.5757807138535211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=20 psi=0.588 u=0.0691 p_local=0.1272 f1=0.417 auprc=0.845 bytes=23326
[S2] START round=20 head_norm_before_train=1.140689 cos_to_last_merge=0.9836 (last merge round=15)
[S2] round=20 local utility u=0.148880 metrics={'f1_val': 0.7016266442895286, 'auprc': 0.6808423268247583, 'loss_val': 0.355757541686063, 'psi': 0.6933129173036205}-{'f1_val': 0.674338229693043, 'auprc': 0.6565279840387828, 'loss_val': 0.4168436712844789, 'psi': 0.6672141314313389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=20 head_norm_before_train=1.743552 (no previous merge yet)
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9291605869566077, 'auprc': 0.9980081522739015, 'loss_val': 0.17530907030897966, 'psi': 0.9566996130835252}-{'f1_val': 0.9301950829634724, 'auprc': 0.9984830207464928, 'loss_val': 0.14807010119165717, 'psi': 0.9575102580766806}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.824862 (no previous merge yet)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9402227353355119, 'auprc': 0.9287055868480082, 'loss_val': 0.2995295070197341, 'psi': 0.9356158759405104}-{'f1_val': 0.9499166026874142, 'auprc': 0.9548451917247955, 'loss_val': 0.2976016323821192, 'psi': 0.9518880383023667}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=20 head_norm_before_train=1.284599 cos_to_last_merge=0.8274 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=20 local utility u=0.008219 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9985147153779067, 'loss_val': 0.2980177704738704, 'psi': 0.8197713425546311}-{'f1_val': 0.7006083926626743, 'auprc': 0.9955983915193334, 'loss_val': 0.3057023383505052, 'psi': 0.8186043922053379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=20 head_norm_before_train=1.016097 cos_to_last_merge=0.9390 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.939
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.7095622941880861, 'auprc': 0.9629662182118047, 'loss_val': 0.416355165979344, 'psi': 0.8109238637975735}-{'f1_val': 0.7074912997862376, 'auprc': 0.9912351469250602, 'loss_val': 0.40482750651983973, 'psi': 0.8209888386417666}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.148466 cos_to_last_merge=0.9872 (last merge round=15)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.7001408712768659, 'auprc': 0.893902011307243, 'loss_val': 0.41193729486727054, 'psi': 0.7776453272890167}-{'f1_val': 0.3898140123145374, 'auprc': 0.7387657466292261, 'loss_val': 1.069192939443009, 'psi': 0.5293947060404129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=20 head_norm_before_train=1.386619 cos_to_last_merge=0.8028 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.803
[S8] round=20 local utility u=0.004956 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9976058574466308, 'loss_val': 0.1273429043473765, 'psi': 0.996764205018744}-{'f1_val': 0.9963530749356245, 'auprc': 0.9991952422825667, 'loss_val': 0.14292329265327927, 'psi': 0.9974899418744014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=20 head_norm_before_train=1.117152 cos_to_last_merge=0.9770 (last merge round=15)
[S9] round=20 local utility u=0.013975 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998721446763722, 'loss_val': 0.2100064997287167, 'psi': 0.8203073793369944}-{'f1_val': 0.7014391336149548, 'auprc': 0.9995787587418166, 'loss_val': 0.24097547222545182, 'psi': 0.8206949836656995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=20 head_norm_before_train=1.346187 cos_to_last_merge=0.9899 (last merge round=15)
[S10] round=20 local utility u=0.007601 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.9966555602153315, 'loss_val': 0.10567905396128445, 'psi': 0.9946872588013145}-{'f1_val': 0.993705525296829, 'auprc': 0.9970057669740808, 'loss_val': 0.1239137044548262, 'psi': 0.9950256219677297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=20 head_norm_before_train=1.822472 (no previous merge yet)
[S11] round=20 local utility u=0.005841 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.998127771328584, 'loss_val': 0.0726133693328317, 'psi': 0.9973366183871809}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980851670882354, 'loss_val': 0.08259484673095079, 'psi': 0.9971622695434479}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=20 head_norm_before_train=1.400453 cos_to_last_merge=0.8723 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.872
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.6290638030082493, 'auprc': 0.6698860872441565, 'loss_val': 0.5930142215956292, 'psi': 0.6453927167026121}-{'f1_val': 0.6347660632200316, 'auprc': 0.6690585796923263, 'loss_val': 0.5566292889387071, 'psi': 0.6484830698089494}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=20 head_norm_before_train=1.340142 cos_to_last_merge=0.9262 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.926
[S14] round=20 local utility u=0.028047 metrics={'f1_val': 0.9971381516314598, 'auprc': 0.9988519700059866, 'loss_val': 0.187874841907721, 'psi': 0.9978236789812706}-{'f1_val': 0.9950697641668289, 'auprc': 0.9987821924349342, 'loss_val': 0.2313489121163218, 'psi': 0.9965547354740709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=20 head_norm_before_train=0.976935 cos_to_last_merge=0.9706 (last merge round=15)
[S15] round=20 local utility u=0.918444 metrics={'f1_val': 0.9560121712074732, 'auprc': 0.962724366538825, 'loss_val': 0.27614110775030926, 'psi': 0.958697049340014}-{'f1_val': 0.7620283808272988, 'auprc': 0.8006229098541362, 'loss_val': 0.46282142418159655, 'psi': 0.7774661924380337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=20 head_norm_before_train=1.312380 cos_to_last_merge=0.9877 (last merge round=15)
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9212653908309865, 'auprc': 0.9749278566776152, 'loss_val': 0.22683009690808748, 'psi': 0.942730377169638}-{'f1_val': 0.9388257503669041, 'auprc': 0.9926072426007487, 'loss_val': 0.24379491038038015, 'psi': 0.9603383472604419}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.187597 cos_to_last_merge=0.9953 (last merge round=15)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.4130261671018022, 'auprc': 0.8434790956237725, 'loss_val': 0.6540919570830915, 'psi': 0.5852073385105903}-{'f1_val': 0.41707695228725883, 'auprc': 0.8447961710480594, 'loss_val': 0.6807712918038209, 'psi': 0.5881646397915791}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.170685 cos_to_last_merge=0.9801 (last merge round=15)
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6533376871343057, 'auprc': 0.6540934224702484, 'loss_val': 0.45859188995803263, 'psi': 0.6536399812686828}-{'f1_val': 0.7016266442895286, 'auprc': 0.6808423268247583, 'loss_val': 0.355757541686063, 'psi': 0.6933129173036205}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.773669 (no previous merge yet)
[S3] round=21 local utility u=0.142808 metrics={'f1_val': 0.9656010320726067, 'auprc': 0.9980494519844149, 'loss_val': 0.10845970607066396, 'psi': 0.9785804000373299}-{'f1_val': 0.9291605869566077, 'auprc': 0.9980081522739015, 'loss_val': 0.17530907030897966, 'psi': 0.9566996130835252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] sending update (kind=head size=1807 to 1 peers)
[S4] START round=21 head_norm_before_train=1.836916 (no previous merge yet)
[S4] round=21 local utility u=0.000504 metrics={'f1_val': 0.9399572605911901, 'auprc': 0.9298114523644951, 'loss_val': 0.30024623439495185, 'psi': 0.9358989373005121}-{'f1_val': 0.9402227353355119, 'auprc': 0.9287055868480082, 'loss_val': 0.2995295070197341, 'psi': 0.9356158759405104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] sending update (kind=head size=1792 to 1 peers)
[S5] START round=21 head_norm_before_train=1.298476 cos_to_last_merge=0.8242 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.824
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7029074852594895, 'auprc': 0.8196054538032057, 'loss_val': 0.33545451934986775, 'psi': 0.749586672676976}-{'f1_val': 0.7006090940057808, 'auprc': 0.9985147153779067, 'loss_val': 0.2980177704738704, 'psi': 0.8197713425546311}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.047599 cos_to_last_merge=0.9280 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=21 local utility u=0.040500 metrics={'f1_val': 0.7097638462982354, 'auprc': 0.9718722742294793, 'loss_val': 0.3632836439001193, 'psi': 0.8146072174707331}-{'f1_val': 0.7095622941880861, 'auprc': 0.9629662182118047, 'loss_val': 0.416355165979344, 'psi': 0.8109238637975735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=21 head_norm_before_train=1.166146 cos_to_last_merge=0.9839 (last merge round=15)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.42074268065422427, 'auprc': 0.7716503646165025, 'loss_val': 1.006739702367264, 'psi': 0.5611057542391356}-{'f1_val': 0.7001408712768659, 'auprc': 0.893902011307243, 'loss_val': 0.41193729486727054, 'psi': 0.7776453272890167}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.418676 cos_to_last_merge=0.7974 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.797
[S8] round=21 local utility u=0.007773 metrics={'f1_val': 0.9962031034001528, 'auprc': 0.9982973033661677, 'loss_val': 0.1138716563824095, 'psi': 0.9970407833865589}-{'f1_val': 0.9962031034001528, 'auprc': 0.9976058574466308, 'loss_val': 0.1273429043473765, 'psi': 0.996764205018744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=21 head_norm_before_train=1.156435 cos_to_last_merge=0.9714 (last merge round=15)
[S9] round=21 local utility u=0.837546 metrics={'f1_val': 0.9757338294983967, 'auprc': 0.9986385295011084, 'loss_val': 0.1808809768541031, 'psi': 0.9848957094994815}-{'f1_val': 0.7013646677191758, 'auprc': 0.998721446763722, 'loss_val': 0.2100064997287167, 'psi': 0.8203073793369944}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=21 head_norm_before_train=1.373119 cos_to_last_merge=0.9871 (last merge round=15)
[S10] round=21 local utility u=0.004662 metrics={'f1_val': 0.9929532433629917, 'auprc': 0.9966135131879356, 'loss_val': 0.09369771524427564, 'psi': 0.9944173512929693}-{'f1_val': 0.9933750578586366, 'auprc': 0.9966555602153315, 'loss_val': 0.10567905396128445, 'psi': 0.9946872588013145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] START round=21 head_norm_before_train=1.847519 (no previous merge yet)
[S11] round=21 local utility u=0.002860 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9966733471953775, 'loss_val': 0.06108070390903458, 'psi': 0.9966098212618792}-{'f1_val': 0.9968091830929121, 'auprc': 0.998127771328584, 'loss_val': 0.0726133693328317, 'psi': 0.9973366183871809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=21 head_norm_before_train=1.417058 cos_to_last_merge=0.8694 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.869
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6114203928559335, 'auprc': 0.6719301386744784, 'loss_val': 0.6046228552005489, 'psi': 0.6356242911833515}-{'f1_val': 0.6290638030082493, 'auprc': 0.6698860872441565, 'loss_val': 0.5930142215956292, 'psi': 0.6453927167026121}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.371516 cos_to_last_merge=0.9215 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.921
[S14] round=21 local utility u=0.015793 metrics={'f1_val': 0.9968954930164223, 'auprc': 0.9991339638807241, 'loss_val': 0.1556789754223411, 'psi': 0.997790881362143}-{'f1_val': 0.9971381516314598, 'auprc': 0.9988519700059866, 'loss_val': 0.187874841907721, 'psi': 0.9978236789812706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=21 head_norm_before_train=1.026661 cos_to_last_merge=0.9616 (last merge round=15)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7716623001764527, 'auprc': 0.8804445321596643, 'loss_val': 0.38140017834362744, 'psi': 0.8151751929697373}-{'f1_val': 0.9560121712074732, 'auprc': 0.962724366538825, 'loss_val': 0.27614110775030926, 'psi': 0.958697049340014}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.352126 cos_to_last_merge=0.9834 (last merge round=15)
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8863786271279948, 'auprc': 0.9850139382456051, 'loss_val': 0.46426432708591747, 'psi': 0.925832751575039}-{'f1_val': 0.9212653908309865, 'auprc': 0.9749278566776152, 'loss_val': 0.22683009690808748, 'psi': 0.942730377169638}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.195362 cos_to_last_merge=0.9945 (last merge round=15)
[S17] round=21 local utility u=0.011081 metrics={'f1_val': 0.41321159035161864, 'auprc': 0.8447120848599169, 'loss_val': 0.6367422019591039, 'psi': 0.585811788154938}-{'f1_val': 0.4130261671018022, 'auprc': 0.8434790956237725, 'loss_val': 0.6540919570830915, 'psi': 0.5852073385105903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=22 head_norm_before_train=1.193854 cos_to_last_merge=0.9776 (last merge round=15)
[S2] round=22 local utility u=0.164735 metrics={'f1_val': 0.6853447711832336, 'auprc': 0.6696106831878262, 'loss_val': 0.3677166202695678, 'psi': 0.6790511359850706}-{'f1_val': 0.6533376871343057, 'auprc': 0.6540934224702484, 'loss_val': 0.45859188995803263, 'psi': 0.6536399812686828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=22 head_norm_before_train=1.797971 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9983509156982892, 'loss_val': 0.12725662684359437, 'psi': 0.9756591769497773}-{'f1_val': 0.9656010320726067, 'auprc': 0.9980494519844149, 'loss_val': 0.10845970607066396, 'psi': 0.9785804000373299}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.849389 (no previous merge yet)
[S4] round=22 local utility u=0.015881 metrics={'f1_val': 0.9410247804282154, 'auprc': 0.9349227802782714, 'loss_val': 0.29022366715465914, 'psi': 0.9385839803682378}-{'f1_val': 0.9399572605911901, 'auprc': 0.9298114523644951, 'loss_val': 0.30024623439495185, 'psi': 0.9358989373005121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=22 head_norm_before_train=1.311360 cos_to_last_merge=0.8215 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=22 local utility u=0.280613 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.995950071059677, 'loss_val': 0.2894723166508296, 'psi': 0.8187454848273392}-{'f1_val': 0.7029074852594895, 'auprc': 0.8196054538032057, 'loss_val': 0.33545451934986775, 'psi': 0.749586672676976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=22 head_norm_before_train=1.076076 cos_to_last_merge=0.9189 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.7022052666664859, 'auprc': 0.8247748412677669, 'loss_val': 0.4840644684637512, 'psi': 0.7512330965069982}-{'f1_val': 0.7097638462982354, 'auprc': 0.9718722742294793, 'loss_val': 0.3632836439001193, 'psi': 0.8146072174707331}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=22 head_norm_before_train=1.178198 cos_to_last_merge=0.9815 (last merge round=15)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6729140675761356, 'auprc': 0.8517068287674469, 'loss_val': 0.49777040611866347, 'psi': 0.7444311720526601}-{'f1_val': 0.42074268065422427, 'auprc': 0.7716503646165025, 'loss_val': 1.006739702367264, 'psi': 0.5611057542391356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=22 head_norm_before_train=1.448373 cos_to_last_merge=0.7904 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.790
[S8] round=22 local utility u=0.007995 metrics={'f1_val': 0.9955298311535434, 'auprc': 0.9993037603553445, 'loss_val': 0.0968610464800333, 'psi': 0.9970394028342638}-{'f1_val': 0.9962031034001528, 'auprc': 0.9982973033661677, 'loss_val': 0.1138716563824095, 'psi': 0.9970407833865589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=22 head_norm_before_train=1.189356 cos_to_last_merge=0.9668 (last merge round=15)
[S9] round=22 local utility u=0.075673 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986065126457008, 'loss_val': 0.15765310319457243, 'psi': 0.997704352565566}-{'f1_val': 0.9757338294983967, 'auprc': 0.9986385295011084, 'loss_val': 0.1808809768541031, 'psi': 0.9848957094994815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=22 head_norm_before_train=1.399294 cos_to_last_merge=0.9845 (last merge round=15)
[S10] round=22 local utility u=0.000361 metrics={'f1_val': 0.9941140506906643, 'auprc': 0.9934558328627978, 'loss_val': 0.09046818404592101, 'psi': 0.9938507635595177}-{'f1_val': 0.9929532433629917, 'auprc': 0.9966135131879356, 'loss_val': 0.09369771524427564, 'psi': 0.9944173512929693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=22 head_norm_before_train=1.873647 (no previous merge yet)
[S11] round=22 local utility u=0.003085 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967474853346608, 'loss_val': 0.056582469154332196, 'psi': 0.9967845039896116}-{'f1_val': 0.996567470639547, 'auprc': 0.9966733471953775, 'loss_val': 0.06108070390903458, 'psi': 0.9966098212618792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=22 head_norm_before_train=1.436320 cos_to_last_merge=0.8653 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.865
[S13] round=22 local utility u=0.004172 metrics={'f1_val': 0.6141216357285574, 'auprc': 0.6702191030700602, 'loss_val': 0.6073530606501176, 'psi': 0.6365606226651586}-{'f1_val': 0.6114203928559335, 'auprc': 0.6719301386744784, 'loss_val': 0.6046228552005489, 'psi': 0.6356242911833515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=22 head_norm_before_train=1.401055 cos_to_last_merge=0.9173 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.917
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9898935292004247, 'auprc': 0.9970645886092686, 'loss_val': 0.16827624759874407, 'psi': 0.9927619529639622}-{'f1_val': 0.9968954930164223, 'auprc': 0.9991339638807241, 'loss_val': 0.1556789754223411, 'psi': 0.997790881362143}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.076436 cos_to_last_merge=0.9530 (last merge round=15)
[S15] round=22 local utility u=0.654737 metrics={'f1_val': 0.9172132440600742, 'auprc': 0.9727868690648547, 'loss_val': 0.22225884723553319, 'psi': 0.9394426940619864}-{'f1_val': 0.7716623001764527, 'auprc': 0.8804445321596643, 'loss_val': 0.38140017834362744, 'psi': 0.8151751929697373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=22 head_norm_before_train=1.389269 cos_to_last_merge=0.9790 (last merge round=15)
[S16] round=22 local utility u=0.241814 metrics={'f1_val': 0.9358846302845683, 'auprc': 0.9903659319383433, 'loss_val': 0.29372783391061585, 'psi': 0.9576771509460783}-{'f1_val': 0.8863786271279948, 'auprc': 0.9850139382456051, 'loss_val': 0.46426432708591747, 'psi': 0.925832751575039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] sending update (kind=head size=1806 to 1 peers)
[S17] START round=22 head_norm_before_train=1.207670 cos_to_last_merge=0.9934 (last merge round=15)
[S17] round=22 local utility u=0.020670 metrics={'f1_val': 0.4175272157189238, 'auprc': 0.8456570764053547, 'loss_val': 0.624131766098592, 'psi': 0.5887791599934962}-{'f1_val': 0.41321159035161864, 'auprc': 0.8447120848599169, 'loss_val': 0.6367422019591039, 'psi': 0.585811788154938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=23 head_norm_before_train=1.212934 cos_to_last_merge=0.9755 (last merge round=15)
[S2] round=23 local utility u=0.072630 metrics={'f1_val': 0.7013051431189498, 'auprc': 0.6694443984603632, 'loss_val': 0.31771974971824274, 'psi': 0.6885608452555152}-{'f1_val': 0.6853447711832336, 'auprc': 0.6696106831878262, 'loss_val': 0.3677166202695678, 'psi': 0.6790511359850706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=23 head_norm_before_train=1.824283 (no previous merge yet)
[S3] round=23 local utility u=0.122310 metrics={'f1_val': 0.9936146157610444, 'auprc': 0.9986628145593112, 'loss_val': 0.08207163989964933, 'psi': 0.9956338952803511}-{'f1_val': 0.960531351117436, 'auprc': 0.9983509156982892, 'loss_val': 0.12725662684359437, 'psi': 0.9756591769497773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=23 head_norm_before_train=1.863854 (no previous merge yet)
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9400750044385312, 'auprc': 0.9331088338471658, 'loss_val': 0.2891153002945186, 'psi': 0.9372885362019852}-{'f1_val': 0.9410247804282154, 'auprc': 0.9349227802782714, 'loss_val': 0.29022366715465914, 'psi': 0.9385839803682378}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.322011 cos_to_last_merge=0.8192 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=23 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9511332110654117, 'loss_val': 0.29809233106534, 'psi': 0.8008183200237693}-{'f1_val': 0.7006090940057808, 'auprc': 0.995950071059677, 'loss_val': 0.2894723166508296, 'psi': 0.8187454848273392}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=23 head_norm_before_train=1.098003 cos_to_last_merge=0.9124 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=23 local utility u=0.305941 metrics={'f1_val': 0.7095834129115389, 'auprc': 0.9694395682673658, 'loss_val': 0.3504461587057317, 'psi': 0.8135258750538696}-{'f1_val': 0.7022052666664859, 'auprc': 0.8247748412677669, 'loss_val': 0.4840644684637512, 'psi': 0.7512330965069982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=23 head_norm_before_train=1.187334 cos_to_last_merge=0.9797 (last merge round=15)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.4180259545950403, 'auprc': 0.7790816115490699, 'loss_val': 1.0246005607677358, 'psi': 0.5624482173766522}-{'f1_val': 0.6729140675761356, 'auprc': 0.8517068287674469, 'loss_val': 0.49777040611866347, 'psi': 0.7444311720526601}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.483121 cos_to_last_merge=0.7829 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.783
[S8] round=23 local utility u=0.005753 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.998728377291967, 'loss_val': 0.07880921192671672, 'psi': 0.9963273783076776}-{'f1_val': 0.9955298311535434, 'auprc': 0.9993037603553445, 'loss_val': 0.0968610464800333, 'psi': 0.9970394028342638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=23 head_norm_before_train=1.220566 cos_to_last_merge=0.9622 (last merge round=15)
[S9] round=23 local utility u=0.019579 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988486971549573, 'loss_val': 0.12187337452002243, 'psi': 0.9980664128683692}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986065126457008, 'loss_val': 0.15765310319457243, 'psi': 0.997704352565566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=23 head_norm_before_train=1.423437 cos_to_last_merge=0.9821 (last merge round=15)
[S10] round=23 local utility u=0.002639 metrics={'f1_val': 0.9926851410969545, 'auprc': 0.996607863902709, 'loss_val': 0.08607208736657407, 'psi': 0.9942542302192563}-{'f1_val': 0.9941140506906643, 'auprc': 0.9934558328627978, 'loss_val': 0.09046818404592101, 'psi': 0.9938507635595177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=23 head_norm_before_train=1.898808 (no previous merge yet)
[S11] round=23 local utility u=0.005820 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.996742161366517, 'loss_val': 0.04492681265030393, 'psi': 0.9967823744023541}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967474853346608, 'loss_val': 0.056582469154332196, 'psi': 0.9967845039896116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=23 head_norm_before_train=1.457797 cos_to_last_merge=0.8620 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=23 local utility u=0.000000 metrics={'f1_val': 0.5901127988503524, 'auprc': 0.6695547959367195, 'loss_val': 0.590123015149012, 'psi': 0.6218895976848993}-{'f1_val': 0.6141216357285574, 'auprc': 0.6702191030700602, 'loss_val': 0.6073530606501176, 'psi': 0.6365606226651586}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=23 head_norm_before_train=1.425985 cos_to_last_merge=0.9138 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.914
[S14] round=23 local utility u=0.040197 metrics={'f1_val': 0.9967184341784129, 'auprc': 0.9988544510083296, 'loss_val': 0.13420171090200106, 'psi': 0.9975728409103796}-{'f1_val': 0.9898935292004247, 'auprc': 0.9970645886092686, 'loss_val': 0.16827624759874407, 'psi': 0.9927619529639622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=23 head_norm_before_train=1.112186 cos_to_last_merge=0.9468 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=23 local utility u=0.248181 metrics={'f1_val': 0.9866551171109159, 'auprc': 0.9837985891400677, 'loss_val': 0.1755834779111653, 'psi': 0.9855125059225767}-{'f1_val': 0.9172132440600742, 'auprc': 0.9727868690648547, 'loss_val': 0.22225884723553319, 'psi': 0.9394426940619864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=23 head_norm_before_train=1.424228 cos_to_last_merge=0.9751 (last merge round=15)
[S16] round=23 local utility u=0.090238 metrics={'f1_val': 0.945940899912071, 'auprc': 0.9923654046592898, 'loss_val': 0.17958825028895115, 'psi': 0.9645107018109584}-{'f1_val': 0.9358846302845683, 'auprc': 0.9903659319383433, 'loss_val': 0.29372783391061585, 'psi': 0.9576771509460783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=23 head_norm_before_train=1.224864 cos_to_last_merge=0.9916 (last merge round=15)
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.4096532521246543, 'auprc': 0.8448207496638898, 'loss_val': 0.6691791854290119, 'psi': 0.5837202511403485}-{'f1_val': 0.4175272157189238, 'auprc': 0.8456570764053547, 'loss_val': 0.624131766098592, 'psi': 0.5887791599934962}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.230833 cos_to_last_merge=0.9733 (last merge round=15)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7013025448522918, 'auprc': 0.6658378123900672, 'loss_val': 0.3121631576231241, 'psi': 0.687116651867402}-{'f1_val': 0.7013051431189498, 'auprc': 0.6694443984603632, 'loss_val': 0.31771974971824274, 'psi': 0.6885608452555152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.846787 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9985369709485616, 'loss_val': 0.10770342487189583, 'psi': 0.9760359390426908}-{'f1_val': 0.9936146157610444, 'auprc': 0.9986628145593112, 'loss_val': 0.08207163989964933, 'psi': 0.9956338952803511}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.873540 (no previous merge yet)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9396249625913675, 'auprc': 0.9313659384644356, 'loss_val': 0.289511969287344, 'psi': 0.9363213529405948}-{'f1_val': 0.9400750044385312, 'auprc': 0.9331088338471658, 'loss_val': 0.2891153002945186, 'psi': 0.9372885362019852}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.334761 cos_to_last_merge=0.8170 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=24 local utility u=0.079266 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9983157390742204, 'loss_val': 0.28111137186245944, 'psi': 0.8196917520331566}-{'f1_val': 0.7006083926626743, 'auprc': 0.9511332110654117, 'loss_val': 0.29809233106534, 'psi': 0.8008183200237693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=24 head_norm_before_train=1.112358 cos_to_last_merge=0.9079 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=24 local utility u=0.190133 metrics={'f1_val': 0.7722739803216039, 'auprc': 0.9682372121840934, 'loss_val': 0.3427167163736615, 'psi': 0.8506592730665997}-{'f1_val': 0.7095834129115389, 'auprc': 0.9694395682673658, 'loss_val': 0.3504461587057317, 'psi': 0.8135258750538696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=24 head_norm_before_train=1.196193 cos_to_last_merge=0.9780 (last merge round=15)
[S7] round=24 local utility u=0.850222 metrics={'f1_val': 0.6275689555263056, 'auprc': 0.7970725287905053, 'loss_val': 0.6353865562171533, 'psi': 0.6953703848319854}-{'f1_val': 0.4180259545950403, 'auprc': 0.7790816115490699, 'loss_val': 1.0246005607677358, 'psi': 0.5624482173766522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=24 head_norm_before_train=1.518151 cos_to_last_merge=0.7780 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.778
[S8] round=24 local utility u=0.004263 metrics={'f1_val': 0.9954637732876968, 'auprc': 0.9981045903880179, 'loss_val': 0.0728341256267532, 'psi': 0.9965201001278252}-{'f1_val': 0.9947267123181514, 'auprc': 0.998728377291967, 'loss_val': 0.07880921192671672, 'psi': 0.9963273783076776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=24 head_norm_before_train=1.250410 cos_to_last_merge=0.9574 (last merge round=15)
[S9] round=24 local utility u=0.008587 metrics={'f1_val': 0.9971290324227131, 'auprc': 0.9992420254298291, 'loss_val': 0.10338410318969497, 'psi': 0.9979742296255596}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988486971549573, 'loss_val': 0.12187337452002243, 'psi': 0.9980664128683692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=24 head_norm_before_train=1.444268 cos_to_last_merge=0.9801 (last merge round=15)
[S10] round=24 local utility u=0.007122 metrics={'f1_val': 0.993560617225544, 'auprc': 0.996508337621561, 'loss_val': 0.07678244757345913, 'psi': 0.9947397053839508}-{'f1_val': 0.9926851410969545, 'auprc': 0.996607863902709, 'loss_val': 0.08607208736657407, 'psi': 0.9942542302192563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=24 head_norm_before_train=1.924722 (no previous merge yet)
[S11] round=24 local utility u=0.005199 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9980982991604682, 'loss_val': 0.0385980243504455, 'psi': 0.9973248295199346}-{'f1_val': 0.9968091830929121, 'auprc': 0.996742161366517, 'loss_val': 0.04492681265030393, 'psi': 0.9967823744023541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=24 head_norm_before_train=1.479451 cos_to_last_merge=0.8583 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.858
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6182471054185696, 'auprc': 0.6174878607533822, 'loss_val': 0.7861888064579717, 'psi': 0.6179434075524947}-{'f1_val': 0.5901127988503524, 'auprc': 0.6695547959367195, 'loss_val': 0.590123015149012, 'psi': 0.6218895976848993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.448808 cos_to_last_merge=0.9107 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.911
[S14] round=24 local utility u=0.014725 metrics={'f1_val': 0.9969180847486723, 'auprc': 0.9971520746003936, 'loss_val': 0.100841680957066, 'psi': 0.9970116806893609}-{'f1_val': 0.9967184341784129, 'auprc': 0.9988544510083296, 'loss_val': 0.13420171090200106, 'psi': 0.9975728409103796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=24 head_norm_before_train=1.145110 cos_to_last_merge=0.9409 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7931232297494198, 'auprc': 0.8475333738558362, 'loss_val': 0.3656307453159016, 'psi': 0.8148872873919863}-{'f1_val': 0.9866551171109159, 'auprc': 0.9837985891400677, 'loss_val': 0.1755834779111653, 'psi': 0.9855125059225767}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.455544 cos_to_last_merge=0.9714 (last merge round=15)
[S16] round=24 local utility u=0.091529 metrics={'f1_val': 0.9684837088591729, 'auprc': 0.9926566513446395, 'loss_val': 0.1326610700271512, 'psi': 0.9781528858533595}-{'f1_val': 0.945940899912071, 'auprc': 0.9923654046592898, 'loss_val': 0.17958825028895115, 'psi': 0.9645107018109584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=24 head_norm_before_train=1.247684 cos_to_last_merge=0.9892 (last merge round=15)
[S17] round=24 local utility u=0.034932 metrics={'f1_val': 0.41854278250796123, 'auprc': 0.845159106101264, 'loss_val': 0.6536680136968971, 'psi': 0.5891893119452823}-{'f1_val': 0.4096532521246543, 'auprc': 0.8448207496638898, 'loss_val': 0.6691791854290119, 'psi': 0.5837202511403485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=25 head_norm_before_train=1.248324 cos_to_last_merge=0.9709 (last merge round=15)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7012980599289202, 'auprc': 0.6710565659381069, 'loss_val': 0.339634917700332, 'psi': 0.6892014623325949}-{'f1_val': 0.7013025448522918, 'auprc': 0.6658378123900672, 'loss_val': 0.3121631576231241, 'psi': 0.687116651867402}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=1.870937 (no previous merge yet)
[S3] round=25 local utility u=0.012388 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983720292533379, 'loss_val': 0.08243233198785799, 'psi': 0.9759699623646013}-{'f1_val': 0.9610352511054436, 'auprc': 0.9985369709485616, 'loss_val': 0.10770342487189583, 'psi': 0.9760359390426908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=25 head_norm_before_train=1.885276 (no previous merge yet)
[S4] round=25 local utility u=0.095300 metrics={'f1_val': 0.9476407923257151, 'auprc': 0.9717160644337706, 'loss_val': 0.2680582300623443, 'psi': 0.9572709011689373}-{'f1_val': 0.9396249625913675, 'auprc': 0.9313659384644356, 'loss_val': 0.289511969287344, 'psi': 0.9363213529405948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=25 head_norm_before_train=1.347096 cos_to_last_merge=0.8149 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.707751976558859, 'auprc': 0.8034684291762705, 'loss_val': 0.3833654135597683, 'psi': 0.7460385576058237}-{'f1_val': 0.7006090940057808, 'auprc': 0.9983157390742204, 'loss_val': 0.28111137186245944, 'psi': 0.8196917520331566}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.125701 cos_to_last_merge=0.9041 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=25 local utility u=0.418334 metrics={'f1_val': 0.8949333705627249, 'auprc': 0.9894782021424765, 'loss_val': 0.30572764014562764, 'psi': 0.9327513031946255}-{'f1_val': 0.7722739803216039, 'auprc': 0.9682372121840934, 'loss_val': 0.3427167163736615, 'psi': 0.8506592730665997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=25 head_norm_before_train=1.202455 cos_to_last_merge=0.9768 (last merge round=15)
[S7] round=25 local utility u=0.007902 metrics={'f1_val': 0.6324861819817232, 'auprc': 0.7923130924824133, 'loss_val': 0.6348067520055832, 'psi': 0.6964169461819993}-{'f1_val': 0.6275689555263056, 'auprc': 0.7970725287905053, 'loss_val': 0.6353865562171533, 'psi': 0.6953703848319854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=25 head_norm_before_train=1.547191 cos_to_last_merge=0.7738 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.774
[S8] round=25 local utility u=0.003288 metrics={'f1_val': 0.9947267123181514, 'auprc': 0.9990894594351588, 'loss_val': 0.06479003954070173, 'psi': 0.9964718111649544}-{'f1_val': 0.9954637732876968, 'auprc': 0.9981045903880179, 'loss_val': 0.0728341256267532, 'psi': 0.9965201001278252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=25 head_norm_before_train=1.278453 cos_to_last_merge=0.9532 (last merge round=15)
[S9] round=25 local utility u=0.011486 metrics={'f1_val': 0.997986446824604, 'auprc': 0.9992468966087703, 'loss_val': 0.08557042238746485, 'psi': 0.9984906267382705}-{'f1_val': 0.9971290324227131, 'auprc': 0.9992420254298291, 'loss_val': 0.10338410318969497, 'psi': 0.9979742296255596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=25 head_norm_before_train=1.463646 cos_to_last_merge=0.9782 (last merge round=15)
[S10] round=25 local utility u=0.000000 metrics={'f1_val': 0.9911218836921493, 'auprc': 0.9921601017833677, 'loss_val': 0.10122552724419855, 'psi': 0.9915371709286367}-{'f1_val': 0.993560617225544, 'auprc': 0.996508337621561, 'loss_val': 0.07678244757345913, 'psi': 0.9947397053839508}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=25 head_norm_before_train=1.949352 (no previous merge yet)
[S11] round=25 local utility u=0.000944 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998209341877885, 'loss_val': 0.03546924625329222, 'psi': 0.9972119394593078}-{'f1_val': 0.9968091830929121, 'auprc': 0.9980982991604682, 'loss_val': 0.0385980243504455, 'psi': 0.9973248295199346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=25 head_norm_before_train=1.497317 cos_to_last_merge=0.8562 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=25 local utility u=0.046209 metrics={'f1_val': 0.5871111621243686, 'auprc': 0.6625341323701031, 'loss_val': 0.6420942073392508, 'psi': 0.6172803502226625}-{'f1_val': 0.6182471054185696, 'auprc': 0.6174878607533822, 'loss_val': 0.7861888064579717, 'psi': 0.6179434075524947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=25 head_norm_before_train=1.470445 cos_to_last_merge=0.9078 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=25 local utility u=0.009906 metrics={'f1_val': 0.9973057695633372, 'auprc': 0.9990042471300137, 'loss_val': 0.08891303574507119, 'psi': 0.9979851605900077}-{'f1_val': 0.9969180847486723, 'auprc': 0.9971520746003936, 'loss_val': 0.100841680957066, 'psi': 0.9970116806893609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=25 head_norm_before_train=1.182038 cos_to_last_merge=0.9343 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=25 local utility u=0.779174 metrics={'f1_val': 0.9470130182106136, 'auprc': 0.9883672918409656, 'loss_val': 0.15312341915082392, 'psi': 0.9635547276627543}-{'f1_val': 0.7931232297494198, 'auprc': 0.8475333738558362, 'loss_val': 0.3656307453159016, 'psi': 0.8148872873919863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=25 head_norm_before_train=1.484644 cos_to_last_merge=0.9682 (last merge round=15)
[S16] round=25 local utility u=0.097690 metrics={'f1_val': 0.9902858437316829, 'auprc': 0.9938140933419437, 'loss_val': 0.07156707935002299, 'psi': 0.9916971435757872}-{'f1_val': 0.9684837088591729, 'auprc': 0.9926566513446395, 'loss_val': 0.1326610700271512, 'psi': 0.9781528858533595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=25 head_norm_before_train=1.275229 cos_to_last_merge=0.9858 (last merge round=15)
[S17] round=25 local utility u=0.028451 metrics={'f1_val': 0.42786564528953724, 'auprc': 0.8527499761859738, 'loss_val': 0.6754757127423245, 'psi': 0.5978193776481119}-{'f1_val': 0.41854278250796123, 'auprc': 0.845159106101264, 'loss_val': 0.6536680136968971, 'psi': 0.5891893119452823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=26 head_norm_before_train=1.264931 cos_to_last_merge=0.9691 (last merge round=15)
[S2] round=26 local utility u=0.024510 metrics={'f1_val': 0.7015580435512438, 'auprc': 0.688454099564604, 'loss_val': 0.34436643121770183, 'psi': 0.6963164659565879}-{'f1_val': 0.7012980599289202, 'auprc': 0.6710565659381069, 'loss_val': 0.339634917700332, 'psi': 0.6892014623325949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=26 head_norm_before_train=1.895933 (no previous merge yet)
[S3] round=26 local utility u=0.129367 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986878256306246, 'loss_val': 0.045123112445579386, 'psi': 0.9981440280792084}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983720292533379, 'loss_val': 0.08243233198785799, 'psi': 0.9759699623646013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=26 head_norm_before_train=1.893693 (no previous merge yet)
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9404723991600731, 'auprc': 0.9401894385131992, 'loss_val': 0.28774241486637425, 'psi': 0.9403592149013236}-{'f1_val': 0.9476407923257151, 'auprc': 0.9717160644337706, 'loss_val': 0.2680582300623443, 'psi': 0.9572709011689373}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.360072 cos_to_last_merge=0.8134 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=26 local utility u=0.323360 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9958660556869993, 'loss_val': 0.27098091505044575, 'psi': 0.8187118786782681}-{'f1_val': 0.707751976558859, 'auprc': 0.8034684291762705, 'loss_val': 0.3833654135597683, 'psi': 0.7460385576058237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=26 head_norm_before_train=1.136634 cos_to_last_merge=0.9012 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5331074358497072, 'auprc': 0.7420511753108765, 'loss_val': 0.824881462541059, 'psi': 0.6166849316341749}-{'f1_val': 0.8949333705627249, 'auprc': 0.9894782021424765, 'loss_val': 0.30572764014562764, 'psi': 0.9327513031946255}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.208817 cos_to_last_merge=0.9757 (last merge round=15)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.5289097104445366, 'auprc': 0.7784947871404367, 'loss_val': 0.8932591505236233, 'psi': 0.6287437411228967}-{'f1_val': 0.6324861819817232, 'auprc': 0.7923130924824133, 'loss_val': 0.6348067520055832, 'psi': 0.6964169461819993}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.574536 cos_to_last_merge=0.7703 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.770
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.994352627176911, 'auprc': 0.9990542075767996, 'loss_val': 0.06281820853623576, 'psi': 0.9962332593368665}-{'f1_val': 0.9947267123181514, 'auprc': 0.9990894594351588, 'loss_val': 0.06479003954070173, 'psi': 0.9964718111649544}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.303920 cos_to_last_merge=0.9493 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=26 local utility u=0.004048 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992382642011639, 'loss_val': 0.07479916926927076, 'psi': 0.9982222396868519}-{'f1_val': 0.997986446824604, 'auprc': 0.9992468966087703, 'loss_val': 0.08557042238746485, 'psi': 0.9984906267382705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=26 head_norm_before_train=1.479592 cos_to_last_merge=0.9767 (last merge round=15)
[S10] round=26 local utility u=0.026223 metrics={'f1_val': 0.9931069676307994, 'auprc': 0.9966072162807604, 'loss_val': 0.0740310878736749, 'psi': 0.9945070670907838}-{'f1_val': 0.9911218836921493, 'auprc': 0.9921601017833677, 'loss_val': 0.10122552724419855, 'psi': 0.9915371709286367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=26 head_norm_before_train=1.970515 (no previous merge yet)
[S11] round=26 local utility u=0.001335 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981743947389907, 'loss_val': 0.03281778278563344, 'psi': 0.9972102402793246}-{'f1_val': 0.9965470045135896, 'auprc': 0.998209341877885, 'loss_val': 0.03546924625329222, 'psi': 0.9972119394593078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=26 head_norm_before_train=1.508270 cos_to_last_merge=0.8545 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5812926437532596, 'auprc': 0.6755632895507319, 'loss_val': 0.6696236962290101, 'psi': 0.6190009020722484}-{'f1_val': 0.5871111621243686, 'auprc': 0.6625341323701031, 'loss_val': 0.6420942073392508, 'psi': 0.6172803502226625}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=26 head_norm_before_train=1.494596 cos_to_last_merge=0.9048 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.905
[S14] round=26 local utility u=0.007414 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9991338174077831, 'loss_val': 0.07408168310126609, 'psi': 0.997997740986589}-{'f1_val': 0.9973057695633372, 'auprc': 0.9990042471300137, 'loss_val': 0.08891303574507119, 'psi': 0.9979851605900077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=26 head_norm_before_train=1.215643 cos_to_last_merge=0.9284 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8951676436086873, 'auprc': 0.9532308079279876, 'loss_val': 0.22767463527001672, 'psi': 0.9183929093364075}-{'f1_val': 0.9470130182106136, 'auprc': 0.9883672918409656, 'loss_val': 0.15312341915082392, 'psi': 0.9635547276627543}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.511711 cos_to_last_merge=0.9649 (last merge round=15)
[S16] round=26 local utility u=0.005923 metrics={'f1_val': 0.9909428537822442, 'auprc': 0.9939108747261836, 'loss_val': 0.06395409775423475, 'psi': 0.9921300621598199}-{'f1_val': 0.9902858437316829, 'auprc': 0.9938140933419437, 'loss_val': 0.07156707935002299, 'psi': 0.9916971435757872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=26 head_norm_before_train=1.301361 cos_to_last_merge=0.9823 (last merge round=15)
[S17] round=26 local utility u=0.669904 metrics={'f1_val': 0.6736730816289276, 'auprc': 0.8335633854964295, 'loss_val': 0.752953276112009, 'psi': 0.7376292031759284}-{'f1_val': 0.42786564528953724, 'auprc': 0.8527499761859738, 'loss_val': 0.6754757127423245, 'psi': 0.5978193776481119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=27 head_norm_before_train=1.281405 cos_to_last_merge=0.9678 (last merge round=15)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.5153902525008609, 'auprc': 0.6046049236470337, 'loss_val': 0.9614194406402802, 'psi': 0.55107612095933}-{'f1_val': 0.7015580435512438, 'auprc': 0.688454099564604, 'loss_val': 0.34436643121770183, 'psi': 0.6963164659565879}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.919785 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.960995754132836, 'auprc': 0.9983402358831627, 'loss_val': 0.11735093212480328, 'psi': 0.9759335468329667}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986878256306246, 'loss_val': 0.045123112445579386, 'psi': 0.9981440280792084}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=27 head_norm_before_train=1.901736 (no previous merge yet)
[S4] round=27 local utility u=0.080540 metrics={'f1_val': 0.9543514938278085, 'auprc': 0.9588481979948635, 'loss_val': 0.2659123441489055, 'psi': 0.9561501754946304}-{'f1_val': 0.9404723991600731, 'auprc': 0.9401894385131992, 'loss_val': 0.28774241486637425, 'psi': 0.9403592149013236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=27 head_norm_before_train=1.375575 cos_to_last_merge=0.8111 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.811
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.5711572508535803, 'auprc': 0.7893396042342441, 'loss_val': 0.8788912380371671, 'psi': 0.6584301922058458}-{'f1_val': 0.7006090940057808, 'auprc': 0.9958660556869993, 'loss_val': 0.27098091505044575, 'psi': 0.8187118786782681}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=27 head_norm_before_train=1.144368 cos_to_last_merge=0.8993 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.9633514605854988, 'auprc': 0.9881759042559313, 'loss_val': 0.27224399343177885, 'psi': 0.9732812380536717}-{'f1_val': 0.5331074358497072, 'auprc': 0.7420511753108765, 'loss_val': 0.824881462541059, 'psi': 0.6166849316341749}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=27 head_norm_before_train=1.221750 cos_to_last_merge=0.9739 (last merge round=15)
[S7] round=27 local utility u=0.332389 metrics={'f1_val': 0.6015716435516174, 'auprc': 0.784741678937466, 'loss_val': 0.6831940208094268, 'psi': 0.6748396577059569}-{'f1_val': 0.5289097104445366, 'auprc': 0.7784947871404367, 'loss_val': 0.8932591505236233, 'psi': 0.6287437411228967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=27 head_norm_before_train=1.602468 cos_to_last_merge=0.7677 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.768
[S8] round=27 local utility u=0.000968 metrics={'f1_val': 0.994352627176911, 'auprc': 0.9986758731726556, 'loss_val': 0.059746829219758865, 'psi': 0.9960819255752089}-{'f1_val': 0.994352627176911, 'auprc': 0.9990542075767996, 'loss_val': 0.06281820853623576, 'psi': 0.9962332593368665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=27 head_norm_before_train=1.327808 cos_to_last_merge=0.9457 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=27 local utility u=0.004375 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9989346046851755, 'loss_val': 0.0651388288413127, 'psi': 0.9981007758804564}-{'f1_val': 0.9975448900106438, 'auprc': 0.9992382642011639, 'loss_val': 0.07479916926927076, 'psi': 0.9982222396868519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=27 head_norm_before_train=1.494645 cos_to_last_merge=0.9753 (last merge round=15)
[S10] round=27 local utility u=0.001434 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9936945888713987, 'loss_val': 0.0735933810375255, 'psi': 0.9944587474676052}-{'f1_val': 0.9931069676307994, 'auprc': 0.9966072162807604, 'loss_val': 0.0740310878736749, 'psi': 0.9945070670907838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=27 head_norm_before_train=1.987916 (no previous merge yet)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967272672361085, 'loss_val': 0.030600150660316527, 'psi': 0.9967764167501907}-{'f1_val': 0.996567470639547, 'auprc': 0.9981743947389907, 'loss_val': 0.03281778278563344, 'psi': 0.9972102402793246}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.515231 cos_to_last_merge=0.8538 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=27 local utility u=0.102086 metrics={'f1_val': 0.6174210127675802, 'auprc': 0.6749901592105683, 'loss_val': 0.6805033622977407, 'psi': 0.6404486713447755}-{'f1_val': 0.5812926437532596, 'auprc': 0.6755632895507319, 'loss_val': 0.6696236962290101, 'psi': 0.6190009020722484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=27 head_norm_before_train=1.520947 cos_to_last_merge=0.9014 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.901
[S14] round=27 local utility u=0.005999 metrics={'f1_val': 0.998062872566559, 'auprc': 0.9990318112169372, 'loss_val': 0.06671204248478896, 'psi': 0.9984504480267102}-{'f1_val': 0.997240356705793, 'auprc': 0.9991338174077831, 'loss_val': 0.07408168310126609, 'psi': 0.997997740986589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=27 head_norm_before_train=1.242011 cos_to_last_merge=0.9240 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.6949388223837488, 'auprc': 0.7020736601104859, 'loss_val': 0.5362448991807688, 'psi': 0.6977927574744436}-{'f1_val': 0.8951676436086873, 'auprc': 0.9532308079279876, 'loss_val': 0.22767463527001672, 'psi': 0.9183929093364075}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.537018 cos_to_last_merge=0.9623 (last merge round=15)
[S16] round=27 local utility u=0.001910 metrics={'f1_val': 0.9909428537822442, 'auprc': 0.9938559884824979, 'loss_val': 0.059968498091096924, 'psi': 0.9921081076623457}-{'f1_val': 0.9909428537822442, 'auprc': 0.9939108747261836, 'loss_val': 0.06395409775423475, 'psi': 0.9921300621598199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=27 head_norm_before_train=1.322430 cos_to_last_merge=0.9792 (last merge round=15)
[S17] round=27 local utility u=0.176242 metrics={'f1_val': 0.7015240513945499, 'auprc': 0.85582550138557, 'loss_val': 0.6343622918962821, 'psi': 0.763244631390958}-{'f1_val': 0.6736730816289276, 'auprc': 0.8335633854964295, 'loss_val': 0.752953276112009, 'psi': 0.7376292031759284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=28 head_norm_before_train=1.296708 cos_to_last_merge=0.9662 (last merge round=15)
[S2] round=28 local utility u=1.000000 metrics={'f1_val': 0.7013424750120637, 'auprc': 0.7476472377692185, 'loss_val': 0.3671500875385348, 'psi': 0.7198643801149256}-{'f1_val': 0.5153902525008609, 'auprc': 0.6046049236470337, 'loss_val': 0.9614194406402802, 'psi': 0.55107612095933}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=28 head_norm_before_train=1.941819 (no previous merge yet)
[S3] round=28 local utility u=0.151137 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9985135677864978, 'loss_val': 0.036310912812390586, 'psi': 0.9980743249415577}-{'f1_val': 0.960995754132836, 'auprc': 0.9983402358831627, 'loss_val': 0.11735093212480328, 'psi': 0.9759335468329667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=28 head_norm_before_train=1.905367 (no previous merge yet)
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9448882705304191, 'auprc': 0.952878352715932, 'loss_val': 0.2782550961750773, 'psi': 0.9480843034046242}-{'f1_val': 0.9543514938278085, 'auprc': 0.9588481979948635, 'loss_val': 0.2659123441489055, 'psi': 0.9561501754946304}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.390728 cos_to_last_merge=0.8099 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=28 local utility u=1.000000 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9983795279110869, 'loss_val': 0.26012614999064876, 'psi': 0.8197172675679032}-{'f1_val': 0.5711572508535803, 'auprc': 0.7893396042342441, 'loss_val': 0.8788912380371671, 'psi': 0.6584301922058458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=28 head_norm_before_train=1.150980 cos_to_last_merge=0.8970 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6495105911188512, 'auprc': 0.810960290158845, 'loss_val': 0.5564078550337636, 'psi': 0.7140904707348488}-{'f1_val': 0.9633514605854988, 'auprc': 0.9881759042559313, 'loss_val': 0.27224399343177885, 'psi': 0.9732812380536717}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.234349 cos_to_last_merge=0.9722 (last merge round=15)
[S7] round=28 local utility u=0.214882 metrics={'f1_val': 0.642754556454088, 'auprc': 0.8019663149147067, 'loss_val': 0.5522018959655886, 'psi': 0.7064392598383354}-{'f1_val': 0.6015716435516174, 'auprc': 0.784741678937466, 'loss_val': 0.6831940208094268, 'psi': 0.6748396577059569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=28 head_norm_before_train=1.625813 cos_to_last_merge=0.7658 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.766
[S8] round=28 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9990068002227119, 'loss_val': 0.0568950343553741, 'psi': 0.9951255548383859}-{'f1_val': 0.994352627176911, 'auprc': 0.9986758731726556, 'loss_val': 0.059746829219758865, 'psi': 0.9960819255752089}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=28 head_norm_before_train=1.352322 cos_to_last_merge=0.9420 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=28 local utility u=0.000369 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9988557823178408, 'loss_val': 0.05918409267010803, 'psi': 0.9975712585897258}-{'f1_val': 0.9975448900106438, 'auprc': 0.9989346046851755, 'loss_val': 0.0651388288413127, 'psi': 0.9981007758804564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=28 head_norm_before_train=1.506175 cos_to_last_merge=0.9744 (last merge round=15)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9932428855188049, 'auprc': 0.9969871136269137, 'loss_val': 0.07373222446270934, 'psi': 0.9947405767620484}-{'f1_val': 0.9949681865317428, 'auprc': 0.9936945888713987, 'loss_val': 0.0735933810375255, 'psi': 0.9944587474676052}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=28 head_norm_before_train=2.002218 (no previous merge yet)
[S11] round=28 local utility u=0.000595 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9967224271638375, 'loss_val': 0.029396481784606472, 'psi': 0.9967744807212823}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967272672361085, 'loss_val': 0.030600150660316527, 'psi': 0.9967764167501907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=28 head_norm_before_train=1.520126 cos_to_last_merge=0.8539 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.854
[S13] round=28 local utility u=0.000000 metrics={'f1_val': 0.5993031712341704, 'auprc': 0.6864793510940284, 'loss_val': 0.678221415798686, 'psi': 0.6341736431781135}-{'f1_val': 0.6174210127675802, 'auprc': 0.6749901592105683, 'loss_val': 0.6805033622977407, 'psi': 0.6404486713447755}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=28 head_norm_before_train=1.544278 cos_to_last_merge=0.8983 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.898
[S14] round=28 local utility u=0.000182 metrics={'f1_val': 0.9966527066798861, 'auprc': 0.9991353241256726, 'loss_val': 0.058196764257540085, 'psi': 0.9976457536582009}-{'f1_val': 0.998062872566559, 'auprc': 0.9990318112169372, 'loss_val': 0.06671204248478896, 'psi': 0.9984504480267102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=28 head_norm_before_train=1.269280 cos_to_last_merge=0.9195 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=28 local utility u=0.228923 metrics={'f1_val': 0.7027602790757252, 'auprc': 0.8137664897809753, 'loss_val': 0.46040682351408146, 'psi': 0.7471627633578253}-{'f1_val': 0.6949388223837488, 'auprc': 0.7020736601104859, 'loss_val': 0.5362448991807688, 'psi': 0.6977927574744436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=28 head_norm_before_train=1.560524 cos_to_last_merge=0.9600 (last merge round=15)
[S16] round=28 local utility u=0.000635 metrics={'f1_val': 0.9907237767477616, 'auprc': 0.9939293966268739, 'loss_val': 0.05760327347245683, 'psi': 0.9920060246994065}-{'f1_val': 0.9909428537822442, 'auprc': 0.9938559884824979, 'loss_val': 0.059968498091096924, 'psi': 0.9921081076623457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=28 head_norm_before_train=1.345130 cos_to_last_merge=0.9761 (last merge round=15)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.6762475620595261, 'auprc': 0.8364484914437206, 'loss_val': 0.767747237311589, 'psi': 0.7403279338132038}-{'f1_val': 0.7015240513945499, 'auprc': 0.85582550138557, 'loss_val': 0.6343622918962821, 'psi': 0.763244631390958}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.310959 cos_to_last_merge=0.9648 (last merge round=15)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7018425549358791, 'auprc': 0.717587496421584, 'loss_val': 0.4109385365638949, 'psi': 0.7081405315301611}-{'f1_val': 0.7013424750120637, 'auprc': 0.7476472377692185, 'loss_val': 0.3671500875385348, 'psi': 0.7198643801149256}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.962338 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9988183779710132, 'loss_val': 0.03479489054337422, 'psi': 0.9979491697834576}-{'f1_val': 0.9977814963782642, 'auprc': 0.9985135677864978, 'loss_val': 0.036310912812390586, 'psi': 0.9980743249415577}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.913650 (no previous merge yet)
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9383667535706834, 'auprc': 0.9247588175690646, 'loss_val': 0.30923174228701, 'psi': 0.9329235791700359}-{'f1_val': 0.9448882705304191, 'auprc': 0.952878352715932, 'loss_val': 0.2782550961750773, 'psi': 0.9480843034046242}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.400892 cos_to_last_merge=0.8082 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9977471802145504, 'loss_val': 0.25903729870837466, 'psi': 0.8194639076834247}-{'f1_val': 0.7006090940057808, 'auprc': 0.9983795279110869, 'loss_val': 0.26012614999064876, 'psi': 0.8197172675679032}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.161189 cos_to_last_merge=0.8945 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.9448217182442555, 'auprc': 0.9654527397857089, 'loss_val': 0.3433170373786299, 'psi': 0.9530741268608369}-{'f1_val': 0.6495105911188512, 'auprc': 0.810960290158845, 'loss_val': 0.5564078550337636, 'psi': 0.7140904707348488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=29 head_norm_before_train=1.249127 cos_to_last_merge=0.9703 (last merge round=15)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5307688517275142, 'auprc': 0.7835488041702161, 'loss_val': 0.8300970817597512, 'psi': 0.6318808327045949}-{'f1_val': 0.642754556454088, 'auprc': 0.8019663149147067, 'loss_val': 0.5522018959655886, 'psi': 0.7064392598383354}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.642912 cos_to_last_merge=0.7643 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.764
[S8] round=29 local utility u=0.000531 metrics={'f1_val': 0.9942648999228464, 'auprc': 0.9962837768553535, 'loss_val': 0.058024111929676686, 'psi': 0.9950724506958493}-{'f1_val': 0.9925380579155019, 'auprc': 0.9990068002227119, 'loss_val': 0.0568950343553741, 'psi': 0.9951255548383859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=29 head_norm_before_train=1.374850 cos_to_last_merge=0.9383 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=29 local utility u=0.004802 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9988559113281861, 'loss_val': 0.05208159225584727, 'psi': 0.9978214183155398}-{'f1_val': 0.9967149094376494, 'auprc': 0.9988557823178408, 'loss_val': 0.05918409267010803, 'psi': 0.9975712585897258}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=29 head_norm_before_train=1.516368 cos_to_last_merge=0.9736 (last merge round=15)
[S10] round=29 local utility u=0.000000 metrics={'f1_val': 0.9541920394240333, 'auprc': 0.9938783711026563, 'loss_val': 0.13009456785008527, 'psi': 0.9700665720954825}-{'f1_val': 0.9932428855188049, 'auprc': 0.9969871136269137, 'loss_val': 0.07373222446270934, 'psi': 0.9947405767620484}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=29 head_norm_before_train=2.015224 (no previous merge yet)
[S11] round=29 local utility u=0.000560 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9973208960800717, 'loss_val': 0.028621769948671653, 'psi': 0.9968688408157569}-{'f1_val': 0.9968091830929121, 'auprc': 0.9967224271638375, 'loss_val': 0.029396481784606472, 'psi': 0.9967744807212823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=29 head_norm_before_train=1.524671 cos_to_last_merge=0.8530 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.853
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5884133421254655, 'auprc': 0.6553232120867355, 'loss_val': 0.6703877600729623, 'psi': 0.6151772901099735}-{'f1_val': 0.5993031712341704, 'auprc': 0.6864793510940284, 'loss_val': 0.678221415798686, 'psi': 0.6341736431781135}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=29 head_norm_before_train=1.567934 cos_to_last_merge=0.8954 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.895
[S14] round=29 local utility u=0.002519 metrics={'f1_val': 0.9970233560109115, 'auprc': 0.9974445936725952, 'loss_val': 0.05030967699978483, 'psi': 0.9971918510755851}-{'f1_val': 0.9966527066798861, 'auprc': 0.9991353241256726, 'loss_val': 0.058196764257540085, 'psi': 0.9976457536582009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=29 head_norm_before_train=1.290790 cos_to_last_merge=0.9161 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=29 local utility u=1.000000 metrics={'f1_val': 0.9834381385294445, 'auprc': 0.9744784527632494, 'loss_val': 0.12338213316271941, 'psi': 0.9798542642229664}-{'f1_val': 0.7027602790757252, 'auprc': 0.8137664897809753, 'loss_val': 0.46040682351408146, 'psi': 0.7471627633578253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=29 head_norm_before_train=1.582560 cos_to_last_merge=0.9579 (last merge round=15)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.990504773491672, 'auprc': 0.9931946354514254, 'loss_val': 0.056713393047338516, 'psi': 0.9915807182755734}-{'f1_val': 0.9907237767477616, 'auprc': 0.9939293966268739, 'loss_val': 0.05760327347245683, 'psi': 0.9920060246994065}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.368009 cos_to_last_merge=0.9725 (last merge round=15)
[S17] round=29 local utility u=0.001993 metrics={'f1_val': 0.6756828559169091, 'auprc': 0.8385897391531519, 'loss_val': 0.7667968209394747, 'psi': 0.7408456092114063}-{'f1_val': 0.6762475620595261, 'auprc': 0.8364484914437206, 'loss_val': 0.767747237311589, 'psi': 0.7403279338132038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=30 head_norm_before_train=1.325429 cos_to_last_merge=0.9635 (last merge round=15)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6087594650954293, 'auprc': 0.6449214586051354, 'loss_val': 0.679692674684131, 'psi': 0.6232242624993117}-{'f1_val': 0.7018425549358791, 'auprc': 0.717587496421584, 'loss_val': 0.4109385365638949, 'psi': 0.7081405315301611}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.981149 (no previous merge yet)
[S3] round=30 local utility u=0.000999 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.998779495619389, 'loss_val': 0.03268093670261445, 'psi': 0.9979336168428079}-{'f1_val': 0.9973696976584205, 'auprc': 0.9988183779710132, 'loss_val': 0.03479489054337422, 'psi': 0.9979491697834576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=30 head_norm_before_train=1.922970 (no previous merge yet)
[S4] round=30 local utility u=0.060008 metrics={'f1_val': 0.9415149328127497, 'auprc': 0.9505740754065237, 'loss_val': 0.2855505785863644, 'psi': 0.9451385898502593}-{'f1_val': 0.9383667535706834, 'auprc': 0.9247588175690646, 'loss_val': 0.30923174228701, 'psi': 0.9329235791700359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=30 head_norm_before_train=1.412892 cos_to_last_merge=0.8052 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=30 local utility u=0.007311 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.998014467733922, 'loss_val': 0.2452176869552221, 'psi': 0.8195708226911733}-{'f1_val': 0.7006083926626743, 'auprc': 0.9977471802145504, 'loss_val': 0.25903729870837466, 'psi': 0.8194639076834247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=30 head_norm_before_train=1.178005 cos_to_last_merge=0.8907 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.8949755411685283, 'auprc': 0.965453067946379, 'loss_val': 0.3231395726200399, 'psi': 0.9231665518796686}-{'f1_val': 0.9448217182442555, 'auprc': 0.9654527397857089, 'loss_val': 0.3433170373786299, 'psi': 0.9530741268608369}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.263877 cos_to_last_merge=0.9681 (last merge round=15)
[S7] round=30 local utility u=0.484400 metrics={'f1_val': 0.6347595630770966, 'auprc': 0.8032965419885224, 'loss_val': 0.5444842645413132, 'psi': 0.7021743546416669}-{'f1_val': 0.5307688517275142, 'auprc': 0.7835488041702161, 'loss_val': 0.8300970817597512, 'psi': 0.6318808327045949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=30 head_norm_before_train=1.658909 cos_to_last_merge=0.7642 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.764
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9989888688750805, 'loss_val': 0.052425574463542644, 'psi': 0.994682128247738}-{'f1_val': 0.9942648999228464, 'auprc': 0.9962837768553535, 'loss_val': 0.058024111929676686, 'psi': 0.9950724506958493}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.398009 cos_to_last_merge=0.9346 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=30 local utility u=0.000016 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9962693814188279, 'loss_val': 0.046769255400994456, 'psi': 0.9970346865739175}-{'f1_val': 0.9971317563071089, 'auprc': 0.9988559113281861, 'loss_val': 0.05208159225584727, 'psi': 0.9978214183155398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=30 head_norm_before_train=1.524172 cos_to_last_merge=0.9732 (last merge round=15)
[S10] round=30 local utility u=0.159778 metrics={'f1_val': 0.9943624847472301, 'auprc': 0.9969499931093403, 'loss_val': 0.06077648814043997, 'psi': 0.9953974880920742}-{'f1_val': 0.9541920394240333, 'auprc': 0.9938783711026563, 'loss_val': 0.13009456785008527, 'psi': 0.9700665720954825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=30 head_norm_before_train=2.027910 (no previous merge yet)
[S11] round=30 local utility u=0.001802 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980552272864984, 'loss_val': 0.027220845821029252, 'psi': 0.9971625732983276}-{'f1_val': 0.996567470639547, 'auprc': 0.9973208960800717, 'loss_val': 0.028621769948671653, 'psi': 0.9968688408157569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=30 head_norm_before_train=1.533462 cos_to_last_merge=0.8520 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.852
[S13] round=30 local utility u=0.146308 metrics={'f1_val': 0.6047862300379594, 'auprc': 0.6882335560357469, 'loss_val': 0.574739231482303, 'psi': 0.6381651604370744}-{'f1_val': 0.5884133421254655, 'auprc': 0.6553232120867355, 'loss_val': 0.6703877600729623, 'psi': 0.6151772901099735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=30 head_norm_before_train=1.590075 cos_to_last_merge=0.8926 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.893
[S14] round=30 local utility u=0.003614 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.998750832666869, 'loss_val': 0.04452052310638713, 'psi': 0.9974663410324021}-{'f1_val': 0.9970233560109115, 'auprc': 0.9974445936725952, 'loss_val': 0.05030967699978483, 'psi': 0.9971918510755851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=30 head_norm_before_train=1.307669 cos_to_last_merge=0.9136 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=30 local utility u=0.000000 metrics={'f1_val': 0.7434215296891071, 'auprc': 0.7675082594682998, 'loss_val': 0.49409384466991263, 'psi': 0.7530562216007842}-{'f1_val': 0.9834381385294445, 'auprc': 0.9744784527632494, 'loss_val': 0.12338213316271941, 'psi': 0.9798542642229664}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=30 head_norm_before_train=1.602179 cos_to_last_merge=0.9559 (last merge round=15)
[S16] round=30 local utility u=0.000000 metrics={'f1_val': 0.9384203727011416, 'auprc': 0.9913768361135183, 'loss_val': 0.2477558756537578, 'psi': 0.9596029580660923}-{'f1_val': 0.990504773491672, 'auprc': 0.9931946354514254, 'loss_val': 0.056713393047338516, 'psi': 0.9915807182755734}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=30 head_norm_before_train=1.390278 cos_to_last_merge=0.9690 (last merge round=15)
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.656072264508676, 'auprc': 0.8083680636070842, 'loss_val': 0.9937230733109178, 'psi': 0.7169905841480393}-{'f1_val': 0.6756828559169091, 'auprc': 0.8385897391531519, 'loss_val': 0.7667968209394747, 'psi': 0.7408456092114063}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.340827 cos_to_last_merge=0.9621 (last merge round=15)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.5857638818964637, 'auprc': 0.6588367845036821, 'loss_val': 0.9507657112136724, 'psi': 0.6149930429393511}-{'f1_val': 0.6087594650954293, 'auprc': 0.6449214586051354, 'loss_val': 0.679692674684131, 'psi': 0.6232242624993117}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.994526 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9658029912444237, 'auprc': 0.9981469440429143, 'loss_val': 0.06976308369615089, 'psi': 0.9787405723638198}-{'f1_val': 0.9973696976584205, 'auprc': 0.998779495619389, 'loss_val': 0.03268093670261445, 'psi': 0.9979336168428079}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.924633 (no previous merge yet)
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.9396956069887943, 'auprc': 0.9380945208031338, 'loss_val': 0.30734563602197273, 'psi': 0.9390551725145301}-{'f1_val': 0.9415149328127497, 'auprc': 0.9505740754065237, 'loss_val': 0.2855505785863644, 'psi': 0.9451385898502593}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.426043 cos_to_last_merge=0.8043 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9978486744078174, 'loss_val': 0.2468485164755302, 'psi': 0.8195045053607315}-{'f1_val': 0.7006083926626743, 'auprc': 0.998014467733922, 'loss_val': 0.2452176869552221, 'psi': 0.8195708226911733}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.196384 cos_to_last_merge=0.8865 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.7662369641559016, 'auprc': 0.9366386817470551, 'loss_val': 0.4050916466843767, 'psi': 0.834397651192363}-{'f1_val': 0.8949755411685283, 'auprc': 0.965453067946379, 'loss_val': 0.3231395726200399, 'psi': 0.9231665518796686}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.278694 cos_to_last_merge=0.9658 (last merge round=15)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.630900027747094, 'auprc': 0.8025024360152797, 'loss_val': 0.5495616195553307, 'psi': 0.6995409910543683}-{'f1_val': 0.6347595630770966, 'auprc': 0.8032965419885224, 'loss_val': 0.5444842645413132, 'psi': 0.7021743546416669}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.676049 cos_to_last_merge=0.7627 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.763
[S8] round=31 local utility u=0.007596 metrics={'f1_val': 0.9939988207001527, 'auprc': 0.9978366351735873, 'loss_val': 0.04690320779021392, 'psi': 0.9955339464895265}-{'f1_val': 0.9918109678295097, 'auprc': 0.9989888688750805, 'loss_val': 0.052425574463542644, 'psi': 0.994682128247738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=31 head_norm_before_train=1.420470 cos_to_last_merge=0.9313 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=31 local utility u=0.005646 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988481282449203, 'loss_val': 0.04321431385575844, 'psi': 0.9980661853043544}-{'f1_val': 0.9975448900106438, 'auprc': 0.9962693814188279, 'loss_val': 0.046769255400994456, 'psi': 0.9970346865739175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=31 head_norm_before_train=1.531202 cos_to_last_merge=0.9727 (last merge round=15)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9945412748874993, 'auprc': 0.9970160118465072, 'loss_val': 0.0682425308686858, 'psi': 0.9955311696711024}-{'f1_val': 0.9943624847472301, 'auprc': 0.9969499931093403, 'loss_val': 0.06077648814043997, 'psi': 0.9953974880920742}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=2.041372 (no previous merge yet)
[S11] round=31 local utility u=0.000215 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.997127872410058, 'loss_val': 0.02545817363712321, 'psi': 0.9969366588197704}-{'f1_val': 0.996567470639547, 'auprc': 0.9980552272864984, 'loss_val': 0.027220845821029252, 'psi': 0.9971625732983276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=31 head_norm_before_train=1.541470 cos_to_last_merge=0.8511 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=31 local utility u=0.031925 metrics={'f1_val': 0.6197649245187861, 'auprc': 0.6826019545799589, 'loss_val': 0.5838664960213314, 'psi': 0.6448997365432552}-{'f1_val': 0.6047862300379594, 'auprc': 0.6882335560357469, 'loss_val': 0.574739231482303, 'psi': 0.6381651604370744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=31 head_norm_before_train=1.607314 cos_to_last_merge=0.8907 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.891
[S14] round=31 local utility u=0.004087 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990444248801474, 'loss_val': 0.04101012010710121, 'psi': 0.9979619839755348}-{'f1_val': 0.9966100132760906, 'auprc': 0.998750832666869, 'loss_val': 0.04452052310638713, 'psi': 0.9974663410324021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=31 head_norm_before_train=1.320948 cos_to_last_merge=0.9118 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=31 local utility u=0.561340 metrics={'f1_val': 0.8315394903938417, 'auprc': 0.9039929173835222, 'loss_val': 0.30957657809123323, 'psi': 0.8605208611897139}-{'f1_val': 0.7434215296891071, 'auprc': 0.7675082594682998, 'loss_val': 0.49409384466991263, 'psi': 0.7530562216007842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=31 head_norm_before_train=1.618044 cos_to_last_merge=0.9539 (last merge round=15)
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9377774886087549, 'auprc': 0.9921319542296858, 'loss_val': 0.2624168155773675, 'psi': 0.9595192748571272}-{'f1_val': 0.9384203727011416, 'auprc': 0.9913768361135183, 'loss_val': 0.2477558756537578, 'psi': 0.9596029580660923}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.411801 cos_to_last_merge=0.9657 (last merge round=15)
[S17] round=31 local utility u=0.530829 metrics={'f1_val': 0.7160654159150099, 'auprc': 0.8865964029827592, 'loss_val': 0.5267087191766154, 'psi': 0.7842778107421097}-{'f1_val': 0.656072264508676, 'auprc': 0.8083680636070842, 'loss_val': 0.9937230733109178, 'psi': 0.7169905841480393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=32 head_norm_before_train=1.356242 cos_to_last_merge=0.9606 (last merge round=15)
[S2] round=32 local utility u=0.617849 metrics={'f1_val': 0.6907991710199143, 'auprc': 0.7492576943922621, 'loss_val': 0.6165425118623855, 'psi': 0.7141825803688534}-{'f1_val': 0.5857638818964637, 'auprc': 0.6588367845036821, 'loss_val': 0.9507657112136724, 'psi': 0.6149930429393511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=32 head_norm_before_train=2.007075 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.961289870742017, 'auprc': 0.9988282623591269, 'loss_val': 0.12259304471459218, 'psi': 0.976305227388861}-{'f1_val': 0.9658029912444237, 'auprc': 0.9981469440429143, 'loss_val': 0.06976308369615089, 'psi': 0.9787405723638198}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.928235 (no previous merge yet)
[S4] round=32 local utility u=0.010614 metrics={'f1_val': 0.9404819397923292, 'auprc': 0.9360982140978296, 'loss_val': 0.2848464564290555, 'psi': 0.9387284495145294}-{'f1_val': 0.9396956069887943, 'auprc': 0.9380945208031338, 'loss_val': 0.30734563602197273, 'psi': 0.9390551725145301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=32 head_norm_before_train=1.440420 cos_to_last_merge=0.8044 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.804
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7945776017272572, 'loss_val': 0.514582191720123, 'psi': 0.7463351725880968}-{'f1_val': 0.7006083926626743, 'auprc': 0.9978486744078174, 'loss_val': 0.2468485164755302, 'psi': 0.8195045053607315}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.214768 cos_to_last_merge=0.8818 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=32 local utility u=0.486301 metrics={'f1_val': 0.9042204297650751, 'auprc': 0.9645906667896773, 'loss_val': 0.34424667345033927, 'psi': 0.928368524574916}-{'f1_val': 0.7662369641559016, 'auprc': 0.9366386817470551, 'loss_val': 0.4050916466843767, 'psi': 0.834397651192363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=32 head_norm_before_train=1.289835 cos_to_last_merge=0.9639 (last merge round=15)
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6011764906706542, 'auprc': 0.7954867795386656, 'loss_val': 0.6148900069432822, 'psi': 0.6789006062178587}-{'f1_val': 0.630900027747094, 'auprc': 0.8025024360152797, 'loss_val': 0.5495616195553307, 'psi': 0.6995409910543683}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.696435 cos_to_last_merge=0.7605 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.761
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9935301257143457, 'auprc': 0.9884215728165298, 'loss_val': 0.04846756371271707, 'psi': 0.9914867045552194}-{'f1_val': 0.9939988207001527, 'auprc': 0.9978366351735873, 'loss_val': 0.04690320779021392, 'psi': 0.9955339464895265}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.440429 cos_to_last_merge=0.9287 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=32 local utility u=0.000000 metrics={'f1_val': 0.9938020079496261, 'auprc': 0.9988526143487433, 'loss_val': 0.04563168335956936, 'psi': 0.995822250509273}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988481282449203, 'loss_val': 0.04321431385575844, 'psi': 0.9980661853043544}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=32 head_norm_before_train=1.540377 cos_to_last_merge=0.9720 (last merge round=15)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.953732825483392, 'auprc': 0.993302105944819, 'loss_val': 0.12791444616341463, 'psi': 0.9695605376679628}-{'f1_val': 0.9945412748874993, 'auprc': 0.9970160118465072, 'loss_val': 0.0682425308686858, 'psi': 0.9955311696711024}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=2.054252 (no previous merge yet)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966975567340177, 'loss_val': 0.02502124837711651, 'psi': 0.9967645325493544}-{'f1_val': 0.9968091830929121, 'auprc': 0.997127872410058, 'loss_val': 0.02545817363712321, 'psi': 0.9969366588197704}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.547965 cos_to_last_merge=0.8512 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5968005900229734, 'auprc': 0.683466698379191, 'loss_val': 0.687241673271024, 'psi': 0.6314670333654604}-{'f1_val': 0.6197649245187861, 'auprc': 0.6826019545799589, 'loss_val': 0.5838664960213314, 'psi': 0.6448997365432552}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.623909 cos_to_last_merge=0.8891 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.889
[S14] round=32 local utility u=0.001774 metrics={'f1_val': 0.9972835715563582, 'auprc': 0.9990421003306333, 'loss_val': 0.037715030219183175, 'psi': 0.9979869830660681}-{'f1_val': 0.997240356705793, 'auprc': 0.9990444248801474, 'loss_val': 0.04101012010710121, 'psi': 0.9979619839755348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=32 head_norm_before_train=1.338012 cos_to_last_merge=0.9093 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.909
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.7033586275131611, 'auprc': 0.806368059505963, 'loss_val': 0.5230004012837229, 'psi': 0.7445624003102819}-{'f1_val': 0.8315394903938417, 'auprc': 0.9039929173835222, 'loss_val': 0.30957657809123323, 'psi': 0.8605208611897139}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=32 head_norm_before_train=1.632889 cos_to_last_merge=0.9522 (last merge round=15)
[S16] round=32 local utility u=0.265303 metrics={'f1_val': 0.9911099768967262, 'auprc': 0.9914520812055216, 'loss_val': 0.04976656846534042, 'psi': 0.9912468186202443}-{'f1_val': 0.9377774886087549, 'auprc': 0.9921319542296858, 'loss_val': 0.2624168155773675, 'psi': 0.9595192748571272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=32 head_norm_before_train=1.431906 cos_to_last_merge=0.9627 (last merge round=15)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6578309999727675, 'auprc': 0.8308418938546125, 'loss_val': 0.9225851908914606, 'psi': 0.7270353575255055}-{'f1_val': 0.7160654159150099, 'auprc': 0.8865964029827592, 'loss_val': 0.5267087191766154, 'psi': 0.7842778107421097}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.368766 cos_to_last_merge=0.9592 (last merge round=15)
[S2] round=33 local utility u=0.142004 metrics={'f1_val': 0.7128347412122338, 'auprc': 0.7796542644247744, 'loss_val': 0.5559371890777297, 'psi': 0.7395625504972501}-{'f1_val': 0.6907991710199143, 'auprc': 0.7492576943922621, 'loss_val': 0.6165425118623855, 'psi': 0.7141825803688534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=33 head_norm_before_train=2.017535 (no previous merge yet)
[S3] round=33 local utility u=0.154162 metrics={'f1_val': 0.9975267313009194, 'auprc': 0.9987581740996107, 'loss_val': 0.03148014829574116, 'psi': 0.9980193084203959}-{'f1_val': 0.961289870742017, 'auprc': 0.9988282623591269, 'loss_val': 0.12259304471459218, 'psi': 0.976305227388861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=33 head_norm_before_train=1.928944 (no previous merge yet)
[S4] round=33 local utility u=0.006761 metrics={'f1_val': 0.9406678585689621, 'auprc': 0.9394579090453445, 'loss_val': 0.28251854917570846, 'psi': 0.9401838787595151}-{'f1_val': 0.9404819397923292, 'auprc': 0.9360982140978296, 'loss_val': 0.2848464564290555, 'psi': 0.9387284495145294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=33 head_norm_before_train=1.452735 cos_to_last_merge=0.8033 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.803
[S5] round=33 local utility u=0.108402 metrics={'f1_val': 0.7176952917997117, 'auprc': 0.8109820627310103, 'loss_val': 0.3681212478840864, 'psi': 0.7550100001722311}-{'f1_val': 0.7141735531619898, 'auprc': 0.7945776017272572, 'loss_val': 0.514582191720123, 'psi': 0.7463351725880968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=33 head_norm_before_train=1.233994 cos_to_last_merge=0.8775 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=33 local utility u=0.000000 metrics={'f1_val': 0.8205219541816557, 'auprc': 0.9491489511719267, 'loss_val': 0.40713640845879284, 'psi': 0.8719727529777641}-{'f1_val': 0.9042204297650751, 'auprc': 0.9645906667896773, 'loss_val': 0.34424667345033927, 'psi': 0.928368524574916}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=33 head_norm_before_train=1.300970 cos_to_last_merge=0.9621 (last merge round=15)
[S7] round=33 local utility u=0.377166 metrics={'f1_val': 0.6746927438347188, 'auprc': 0.8315948184830765, 'loss_val': 0.4099788225336373, 'psi': 0.737453573694062}-{'f1_val': 0.6011764906706542, 'auprc': 0.7954867795386656, 'loss_val': 0.6148900069432822, 'psi': 0.6789006062178587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=33 head_norm_before_train=1.717615 cos_to_last_merge=0.7583 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.758
[S8] round=33 local utility u=0.006065 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9909536301896512, 'loss_val': 0.04235684088093766, 'psi': 0.9923418539967844}-{'f1_val': 0.9935301257143457, 'auprc': 0.9884215728165298, 'loss_val': 0.04846756371271707, 'psi': 0.9914867045552194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=33 head_norm_before_train=1.458009 cos_to_last_merge=0.9266 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=33 local utility u=0.015314 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9989030722622001, 'loss_val': 0.03761142233734641, 'psi': 0.9980881629112663}-{'f1_val': 0.9938020079496261, 'auprc': 0.9988526143487433, 'loss_val': 0.04563168335956936, 'psi': 0.995822250509273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=33 head_norm_before_train=1.549270 cos_to_last_merge=0.9713 (last merge round=15)
[S10] round=33 local utility u=0.158201 metrics={'f1_val': 0.9945412748874993, 'auprc': 0.9969067804689977, 'loss_val': 0.06717632307728166, 'psi': 0.9954874771200988}-{'f1_val': 0.953732825483392, 'auprc': 0.993302105944819, 'loss_val': 0.12791444616341463, 'psi': 0.9695605376679628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=33 head_norm_before_train=2.064964 (no previous merge yet)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966661027232092, 'loss_val': 0.026928553711850954, 'psi': 0.996751950945031}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966975567340177, 'loss_val': 0.02502124837711651, 'psi': 0.9967645325493544}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=33 head_norm_before_train=1.557378 cos_to_last_merge=0.8508 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=33 local utility u=0.113390 metrics={'f1_val': 0.6147038476565991, 'auprc': 0.7060831044484086, 'loss_val': 0.6357309173554713, 'psi': 0.651255550373323}-{'f1_val': 0.5968005900229734, 'auprc': 0.683466698379191, 'loss_val': 0.687241673271024, 'psi': 0.6314670333654604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=33 head_norm_before_train=1.641052 cos_to_last_merge=0.8874 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.887
[S14] round=33 local utility u=0.001049 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9990416873469017, 'loss_val': 0.03535697333289788, 'psi': 0.9979608889622364}-{'f1_val': 0.9972835715563582, 'auprc': 0.9990421003306333, 'loss_val': 0.037715030219183175, 'psi': 0.9979869830660681}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=33 head_norm_before_train=1.353475 cos_to_last_merge=0.9069 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.907
[S15] round=33 local utility u=1.000000 metrics={'f1_val': 0.9143110228390918, 'auprc': 0.960799777084993, 'loss_val': 0.17060075224643986, 'psi': 0.9329065245374523}-{'f1_val': 0.7033586275131611, 'auprc': 0.806368059505963, 'loss_val': 0.5230004012837229, 'psi': 0.7445624003102819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=33 head_norm_before_train=1.647797 cos_to_last_merge=0.9507 (last merge round=15)
[S16] round=33 local utility u=0.003354 metrics={'f1_val': 0.9913102210599594, 'auprc': 0.9928724134174395, 'loss_val': 0.048520620675055394, 'psi': 0.9919350980029513}-{'f1_val': 0.9911099768967262, 'auprc': 0.9914520812055216, 'loss_val': 0.04976656846534042, 'psi': 0.9912468186202443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=33 head_norm_before_train=1.447686 cos_to_last_merge=0.9602 (last merge round=15)
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.49622260378390964, 'auprc': 0.6985163624702384, 'loss_val': 1.5041036190161492, 'psi': 0.5771401072584411}-{'f1_val': 0.6578309999727675, 'auprc': 0.8308418938546125, 'loss_val': 0.9225851908914606, 'psi': 0.7270353575255055}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.378723 cos_to_last_merge=0.9580 (last merge round=15)
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.6352138284540672, 'auprc': 0.6783782093110982, 'loss_val': 0.8735271799529627, 'psi': 0.6524795807968795}-{'f1_val': 0.7128347412122338, 'auprc': 0.7796542644247744, 'loss_val': 0.5559371890777297, 'psi': 0.7395625504972501}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.026114 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9987248052090989, 'loss_val': 0.04110033184147183, 'psi': 0.997928863551274}-{'f1_val': 0.9975267313009194, 'auprc': 0.9987581740996107, 'loss_val': 0.03148014829574116, 'psi': 0.9980193084203959}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.929493 (no previous merge yet)
[S4] round=34 local utility u=0.085238 metrics={'f1_val': 0.9525996618679231, 'auprc': 0.9676864544098932, 'loss_val': 0.26831890311642015, 'psi': 0.9586343788847111}-{'f1_val': 0.9406678585689621, 'auprc': 0.9394579090453445, 'loss_val': 0.28251854917570846, 'psi': 0.9401838787595151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=34 head_norm_before_train=1.464248 cos_to_last_merge=0.8016 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=34 local utility u=0.322980 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9983402964114136, 'loss_val': 0.1817139833821816, 'psi': 0.81970115416217}-{'f1_val': 0.7176952917997117, 'auprc': 0.8109820627310103, 'loss_val': 0.3681212478840864, 'psi': 0.7550100001722311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=34 head_norm_before_train=1.253358 cos_to_last_merge=0.8732 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=34 local utility u=0.051801 metrics={'f1_val': 0.8240548408061669, 'auprc': 0.9643428647195403, 'loss_val': 0.3703138347925635, 'psi': 0.8801700503715162}-{'f1_val': 0.8205219541816557, 'auprc': 0.9491489511719267, 'loss_val': 0.40713640845879284, 'psi': 0.8719727529777641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] sending update (kind=head size=1792 to 1 peers)
[S7] START round=34 head_norm_before_train=1.310924 cos_to_last_merge=0.9605 (last merge round=15)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6539582977218986, 'auprc': 0.8088192923148267, 'loss_val': 0.4931699667514224, 'psi': 0.7159026955590699}-{'f1_val': 0.6746927438347188, 'auprc': 0.8315948184830765, 'loss_val': 0.4099788225336373, 'psi': 0.737453573694062}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=34 head_norm_before_train=1.735950 cos_to_last_merge=0.7569 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.757
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9885815803232845, 'loss_val': 0.0410650384312488, 'psi': 0.9913882287374316}-{'f1_val': 0.9932673365348732, 'auprc': 0.9909536301896512, 'loss_val': 0.04235684088093766, 'psi': 0.9923418539967844}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.474205 cos_to_last_merge=0.9246 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=34 local utility u=0.000976 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988519845637261, 'loss_val': 0.03550710173875669, 'psi': 0.9980677278318767}-{'f1_val': 0.9975448900106438, 'auprc': 0.9989030722622001, 'loss_val': 0.03761142233734641, 'psi': 0.9980881629112663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=34 head_norm_before_train=1.557897 cos_to_last_merge=0.9706 (last merge round=15)
[S10] round=34 local utility u=0.008051 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.996022452290318, 'loss_val': 0.05433002407183621, 'psi': 0.9957245258705942}-{'f1_val': 0.9945412748874993, 'auprc': 0.9969067804689977, 'loss_val': 0.06717632307728166, 'psi': 0.9954874771200988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=34 head_norm_before_train=2.074879 (no previous merge yet)
[S11] round=34 local utility u=0.002717 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980102403639158, 'loss_val': 0.024076205824728057, 'psi': 0.9971445785292945}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966661027232092, 'loss_val': 0.026928553711850954, 'psi': 0.996751950945031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=34 head_norm_before_train=1.565515 cos_to_last_merge=0.8502 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5994184421730231, 'auprc': 0.6867727046175908, 'loss_val': 0.9066667163949608, 'psi': 0.6343601471508502}-{'f1_val': 0.6147038476565991, 'auprc': 0.7060831044484086, 'loss_val': 0.6357309173554713, 'psi': 0.651255550373323}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=34 head_norm_before_train=1.653420 cos_to_last_merge=0.8862 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.886
[S14] round=34 local utility u=0.000000 metrics={'f1_val': 0.9970202894562089, 'auprc': 0.9973512366005267, 'loss_val': 0.0350163293882652, 'psi': 0.997152668313936}-{'f1_val': 0.997240356705793, 'auprc': 0.9990416873469017, 'loss_val': 0.03535697333289788, 'psi': 0.9979608889622364}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=34 head_norm_before_train=1.369144 cos_to_last_merge=0.9044 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8775171362034015, 'auprc': 0.9259812531817795, 'loss_val': 0.26727397506274064, 'psi': 0.8969027829947528}-{'f1_val': 0.9143110228390918, 'auprc': 0.960799777084993, 'loss_val': 0.17060075224643986, 'psi': 0.9329065245374523}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.659405 cos_to_last_merge=0.9492 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.949
[S16] round=34 local utility u=0.000000 metrics={'f1_val': 0.9290017524576588, 'auprc': 0.9928050557184007, 'loss_val': 0.3570439950410154, 'psi': 0.9545230737619557}-{'f1_val': 0.9913102210599594, 'auprc': 0.9928724134174395, 'loss_val': 0.048520620675055394, 'psi': 0.9919350980029513}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=34 head_norm_before_train=1.462634 cos_to_last_merge=0.9576 (last merge round=15)
[S17] round=34 local utility u=1.000000 metrics={'f1_val': 0.7622160529851914, 'auprc': 0.8715548751658823, 'loss_val': 0.5850260815027838, 'psi': 0.8059515818574677}-{'f1_val': 0.49622260378390964, 'auprc': 0.6985163624702384, 'loss_val': 1.5041036190161492, 'psi': 0.5771401072584411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=35 head_norm_before_train=1.386986 cos_to_last_merge=0.9568 (last merge round=15)
[S2] round=35 local utility u=0.041897 metrics={'f1_val': 0.6448696885421451, 'auprc': 0.6910514733987085, 'loss_val': 0.8856877178166047, 'psi': 0.6633424024847705}-{'f1_val': 0.6352138284540672, 'auprc': 0.6783782093110982, 'loss_val': 0.8735271799529627, 'psi': 0.6524795807968795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=35 head_norm_before_train=2.033220 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9612927942165166, 'auprc': 0.9987451635659597, 'loss_val': 0.10827546160184509, 'psi': 0.9762737419562938}-{'f1_val': 0.9973982357793907, 'auprc': 0.9987248052090989, 'loss_val': 0.04110033184147183, 'psi': 0.997928863551274}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.934914 (no previous merge yet)
[S4] round=35 local utility u=0.002102 metrics={'f1_val': 0.9523570090997903, 'auprc': 0.9699952255097704, 'loss_val': 0.26958538080184663, 'psi': 0.9594122956637823}-{'f1_val': 0.9525996618679231, 'auprc': 0.9676864544098932, 'loss_val': 0.26831890311642015, 'psi': 0.9586343788847111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=35 head_norm_before_train=1.477411 cos_to_last_merge=0.7998 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7945041006519699, 'loss_val': 0.6108957980374828, 'psi': 0.7464243872939424}-{'f1_val': 0.7006083926626743, 'auprc': 0.9983402964114136, 'loss_val': 0.1817139833821816, 'psi': 0.81970115416217}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.268773 cos_to_last_merge=0.8694 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.5917149333173735, 'auprc': 0.7881551635991978, 'loss_val': 0.8016909705054392, 'psi': 0.6702910254301032}-{'f1_val': 0.8240548408061669, 'auprc': 0.9643428647195403, 'loss_val': 0.3703138347925635, 'psi': 0.8801700503715162}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.320233 cos_to_last_merge=0.9589 (last merge round=15)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.445030000722909, 'auprc': 0.7782455764467552, 'loss_val': 1.1896519467290418, 'psi': 0.5783162310124474}-{'f1_val': 0.6539582977218986, 'auprc': 0.8088192923148267, 'loss_val': 0.4931699667514224, 'psi': 0.7159026955590699}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.749641 cos_to_last_merge=0.7562 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.756
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9926807282122074, 'auprc': 0.9880435380414897, 'loss_val': 0.05096498745577737, 'psi': 0.9908258521439204}-{'f1_val': 0.9932593276801964, 'auprc': 0.9885815803232845, 'loss_val': 0.0410650384312488, 'psi': 0.9913882287374316}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=35 head_norm_before_train=1.490391 cos_to_last_merge=0.9226 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=35 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9978039607136142, 'loss_val': 0.03329326267436971, 'psi': 0.997648518291832}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988519845637261, 'loss_val': 0.03550710173875669, 'psi': 0.9980677278318767}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=35 head_norm_before_train=1.569786 cos_to_last_merge=0.9697 (last merge round=15)
[S10] round=35 local utility u=0.002225 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.996144955687726, 'loss_val': 0.05024710734511366, 'psi': 0.9957735272295575}-{'f1_val': 0.9955259082574451, 'auprc': 0.996022452290318, 'loss_val': 0.05433002407183621, 'psi': 0.9957245258705942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=35 head_norm_before_train=2.085425 (no previous merge yet)
[S11] round=35 local utility u=0.001433 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9980227317492354, 'loss_val': 0.022697950009322683, 'psi': 0.9972946025554414}-{'f1_val': 0.996567470639547, 'auprc': 0.9980102403639158, 'loss_val': 0.024076205824728057, 'psi': 0.9971445785292945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=35 head_norm_before_train=1.575285 cos_to_last_merge=0.8498 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.850
[S13] round=35 local utility u=0.040770 metrics={'f1_val': 0.5756155628024563, 'auprc': 0.7306222027109573, 'loss_val': 0.8138588868210366, 'psi': 0.6376182187658568}-{'f1_val': 0.5994184421730231, 'auprc': 0.6867727046175908, 'loss_val': 0.9066667163949608, 'psi': 0.6343601471508502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=35 head_norm_before_train=1.664368 cos_to_last_merge=0.8850 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.885
[S14] round=35 local utility u=0.003778 metrics={'f1_val': 0.9974310505072961, 'auprc': 0.9986609417326526, 'loss_val': 0.03385337497974004, 'psi': 0.9979230069974387}-{'f1_val': 0.9970202894562089, 'auprc': 0.9973512366005267, 'loss_val': 0.0350163293882652, 'psi': 0.997152668313936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=35 head_norm_before_train=1.388255 cos_to_last_merge=0.9018 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.902
[S15] round=35 local utility u=0.140483 metrics={'f1_val': 0.89358666335542, 'auprc': 0.9658416406785808, 'loss_val': 0.202305452047661, 'psi': 0.9224886542846843}-{'f1_val': 0.8775171362034015, 'auprc': 0.9259812531817795, 'loss_val': 0.26727397506274064, 'psi': 0.8969027829947528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=35 head_norm_before_train=1.670696 cos_to_last_merge=0.9476 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.948
[S16] round=35 local utility u=0.344240 metrics={'f1_val': 0.9909428537822442, 'auprc': 0.9951231459712035, 'loss_val': 0.04716536959049681, 'psi': 0.992614970657828}-{'f1_val': 0.9290017524576588, 'auprc': 0.9928050557184007, 'loss_val': 0.3570439950410154, 'psi': 0.9545230737619557}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=35 head_norm_before_train=1.473090 cos_to_last_merge=0.9561 (last merge round=15)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6823105744504983, 'auprc': 0.8448734091713535, 'loss_val': 0.7326137809097336, 'psi': 0.7473357083388403}-{'f1_val': 0.7622160529851914, 'auprc': 0.8715548751658823, 'loss_val': 0.5850260815027838, 'psi': 0.8059515818574677}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.395994 cos_to_last_merge=0.9556 (last merge round=15)
[S2] round=36 local utility u=0.237795 metrics={'f1_val': 0.663238747670676, 'auprc': 0.7565806433542294, 'loss_val': 0.7168998209515325, 'psi': 0.7005755059440973}-{'f1_val': 0.6448696885421451, 'auprc': 0.6910514733987085, 'loss_val': 0.8856877178166047, 'psi': 0.6633424024847705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S2] sending update (kind=head size=1807 to 1 peers)
[S3] START round=36 head_norm_before_train=2.040334 (no previous merge yet)
[S3] round=36 local utility u=0.065439 metrics={'f1_val': 0.976010132100414, 'auprc': 0.9986606845001664, 'loss_val': 0.06544868959530505, 'psi': 0.9850703530603149}-{'f1_val': 0.9612927942165166, 'auprc': 0.9987451635659597, 'loss_val': 0.10827546160184509, 'psi': 0.9762737419562938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=36 head_norm_before_train=1.939202 (no previous merge yet)
[S4] round=36 local utility u=0.000809 metrics={'f1_val': 0.9466641497668411, 'auprc': 0.9824902833703588, 'loss_val': 0.27129588557902157, 'psi': 0.9609946032082481}-{'f1_val': 0.9523570090997903, 'auprc': 0.9699952255097704, 'loss_val': 0.26958538080184663, 'psi': 0.9594122956637823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=36 head_norm_before_train=1.486339 cos_to_last_merge=0.7995 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=36 local utility u=0.709353 metrics={'f1_val': 0.7734745811131962, 'auprc': 0.9982678774380466, 'loss_val': 0.15810175024641188, 'psi': 0.8633918996431363}-{'f1_val': 0.7143712450552575, 'auprc': 0.7945041006519699, 'loss_val': 0.6108957980374828, 'psi': 0.7464243872939424}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=36 head_norm_before_train=1.282245 cos_to_last_merge=0.8665 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=36 local utility u=0.894572 metrics={'f1_val': 0.7140783071373371, 'auprc': 0.9779294275364558, 'loss_val': 0.31605048908411626, 'psi': 0.8196187552969846}-{'f1_val': 0.5917149333173735, 'auprc': 0.7881551635991978, 'loss_val': 0.8016909705054392, 'psi': 0.6702910254301032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=36 head_norm_before_train=1.328739 cos_to_last_merge=0.9576 (last merge round=15)
[S7] round=36 local utility u=1.000000 metrics={'f1_val': 0.6986110038599445, 'auprc': 0.9287423362523526, 'loss_val': 0.28376686999497786, 'psi': 0.7906635368169077}-{'f1_val': 0.445030000722909, 'auprc': 0.7782455764467552, 'loss_val': 1.1896519467290418, 'psi': 0.5783162310124474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=36 head_norm_before_train=1.763432 cos_to_last_merge=0.7556 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.756
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9884691291878602, 'loss_val': 0.04415446389171936, 'psi': 0.9891732481595145}-{'f1_val': 0.9926807282122074, 'auprc': 0.9880435380414897, 'loss_val': 0.05096498745577737, 'psi': 0.9908258521439204}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=1.505815 cos_to_last_merge=0.9204 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9957904745348528, 'loss_val': 0.03163064932658296, 'psi': 0.996596868972576}-{'f1_val': 0.9975448900106438, 'auprc': 0.9978039607136142, 'loss_val': 0.03329326267436971, 'psi': 0.997648518291832}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.587120 cos_to_last_merge=0.9681 (last merge round=15)
[S10] round=36 local utility u=0.001476 metrics={'f1_val': 0.9948429234526912, 'auprc': 0.996490439817995, 'loss_val': 0.04423438542800585, 'psi': 0.9955019299988128}-{'f1_val': 0.9955259082574451, 'auprc': 0.996144955687726, 'loss_val': 0.05024710734511366, 'psi': 0.9957735272295575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=36 head_norm_before_train=2.095906 (no previous merge yet)
[S11] round=36 local utility u=0.000215 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.997989647652581, 'loss_val': 0.02216875210482341, 'psi': 0.9972813689167797}-{'f1_val': 0.9968091830929121, 'auprc': 0.9980227317492354, 'loss_val': 0.022697950009322683, 'psi': 0.9972946025554414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=36 head_norm_before_train=1.582491 cos_to_last_merge=0.8487 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.849
[S13] round=36 local utility u=0.149253 metrics={'f1_val': 0.630159688099539, 'auprc': 0.6718600785744998, 'loss_val': 0.6663316846052837, 'psi': 0.6468398442895233}-{'f1_val': 0.5756155628024563, 'auprc': 0.7306222027109573, 'loss_val': 0.8138588868210366, 'psi': 0.6376182187658568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=36 head_norm_before_train=1.673702 cos_to_last_merge=0.8837 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.884
[S14] round=36 local utility u=0.001867 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990407921973657, 'loss_val': 0.032578965389737945, 'psi': 0.9982069877088584}-{'f1_val': 0.9974310505072961, 'auprc': 0.9986609417326526, 'loss_val': 0.03385337497974004, 'psi': 0.9979230069974387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=36 head_norm_before_train=1.404622 cos_to_last_merge=0.8996 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.900
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.8789614164484701, 'auprc': 0.9909100303452928, 'loss_val': 0.23918549847375647, 'psi': 0.9237408620071992}-{'f1_val': 0.89358666335542, 'auprc': 0.9658416406785808, 'loss_val': 0.202305452047661, 'psi': 0.9224886542846843}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.682520 cos_to_last_merge=0.9462 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9913812303173498, 'auprc': 0.9934314013698994, 'loss_val': 0.0483552542700037, 'psi': 0.9922012987383696}-{'f1_val': 0.9909428537822442, 'auprc': 0.9951231459712035, 'loss_val': 0.04716536959049681, 'psi': 0.992614970657828}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.481791 cos_to_last_merge=0.9550 (last merge round=15)
[S17] round=36 local utility u=0.030327 metrics={'f1_val': 0.7018955078960938, 'auprc': 0.8423848943986992, 'loss_val': 0.7820041945745474, 'psi': 0.758091262497136}-{'f1_val': 0.6823105744504983, 'auprc': 0.8448734091713535, 'loss_val': 0.7326137809097336, 'psi': 0.7473357083388403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=37 head_norm_before_train=1.407970 cos_to_last_merge=0.9539 (last merge round=15)
[S2] round=37 local utility u=0.138065 metrics={'f1_val': 0.7054341794320559, 'auprc': 0.7567142255871232, 'loss_val': 0.6943424604637853, 'psi': 0.7259461978940829}-{'f1_val': 0.663238747670676, 'auprc': 0.7565806433542294, 'loss_val': 0.7168998209515325, 'psi': 0.7005755059440973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=37 head_norm_before_train=2.052164 (no previous merge yet)
[S3] round=37 local utility u=0.080124 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.998649735559066, 'loss_val': 0.03596738905634682, 'psi': 0.9981459147842022}-{'f1_val': 0.976010132100414, 'auprc': 0.9986606845001664, 'loss_val': 0.06544868959530505, 'psi': 0.9850703530603149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=37 head_norm_before_train=1.949072 (no previous merge yet)
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.952449884991471, 'auprc': 0.9673814298228174, 'loss_val': 0.27539072013672955, 'psi': 0.9584225029240094}-{'f1_val': 0.9466641497668411, 'auprc': 0.9824902833703588, 'loss_val': 0.27129588557902157, 'psi': 0.9609946032082481}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.491426 cos_to_last_merge=0.7997 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=37 local utility u=0.315420 metrics={'f1_val': 0.88528090206148, 'auprc': 0.9934039118921116, 'loss_val': 0.18350716136679984, 'psi': 0.9285301059937326}-{'f1_val': 0.7734745811131962, 'auprc': 0.9982678774380466, 'loss_val': 0.15810175024641188, 'psi': 0.8633918996431363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=37 head_norm_before_train=1.290635 cos_to_last_merge=0.8642 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.5929033072889347, 'auprc': 0.7804739463229332, 'loss_val': 0.7543029415597126, 'psi': 0.6679315629025341}-{'f1_val': 0.7140783071373371, 'auprc': 0.9779294275364558, 'loss_val': 0.31605048908411626, 'psi': 0.8196187552969846}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.334467 cos_to_last_merge=0.9568 (last merge round=15)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.6877287620892547, 'auprc': 0.8407698211592999, 'loss_val': 0.36043954972973313, 'psi': 0.7489451857172729}-{'f1_val': 0.6986110038599445, 'auprc': 0.9287423362523526, 'loss_val': 0.28376686999497786, 'psi': 0.7906635368169077}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.776011 cos_to_last_merge=0.7550 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9884727291357555, 'loss_val': 0.046846587088249986, 'psi': 0.9880992991020239}-{'f1_val': 0.9896426608072839, 'auprc': 0.9884691291878602, 'loss_val': 0.04415446389171936, 'psi': 0.9891732481595145}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=1.521377 cos_to_last_merge=0.9181 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.918
[S9] round=37 local utility u=0.003314 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.998850188381576, 'loss_val': 0.031664566769937966, 'psi': 0.9975690210152199}-{'f1_val': 0.9971344652643916, 'auprc': 0.9957904745348528, 'loss_val': 0.03163064932658296, 'psi': 0.996596868972576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=37 head_norm_before_train=1.607368 cos_to_last_merge=0.9661 (last merge round=15)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952043313883593, 'loss_val': 0.04921501188672791, 'psi': 0.9951944359669685}-{'f1_val': 0.9948429234526912, 'auprc': 0.996490439817995, 'loss_val': 0.04423438542800585, 'psi': 0.9955019299988128}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=2.106249 (no previous merge yet)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.997883235313255, 'loss_val': 0.022459029025277143, 'psi': 0.9970937765090302}-{'f1_val': 0.9968091830929121, 'auprc': 0.997989647652581, 'loss_val': 0.02216875210482341, 'psi': 0.9972813689167797}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=37 head_norm_before_train=1.588169 cos_to_last_merge=0.8480 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.848
[S13] round=37 local utility u=0.043088 metrics={'f1_val': 0.6424089508485794, 'auprc': 0.6706862092831295, 'loss_val': 0.6501296026826224, 'psi': 0.6537198542223994}-{'f1_val': 0.630159688099539, 'auprc': 0.6718600785744998, 'loss_val': 0.6663316846052837, 'psi': 0.6468398442895233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=37 head_norm_before_train=1.683718 cos_to_last_merge=0.8824 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.882
[S14] round=37 local utility u=0.000768 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9990435659986007, 'loss_val': 0.03105173438046923, 'psi': 0.9982080972293524}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990407921973657, 'loss_val': 0.032578965389737945, 'psi': 0.9982069877088584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=37 head_norm_before_train=1.417909 cos_to_last_merge=0.8980 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8171609340088779, 'auprc': 0.9165547261961526, 'loss_val': 0.3181879873571522, 'psi': 0.8569184508837877}-{'f1_val': 0.8789614164484701, 'auprc': 0.9909100303452928, 'loss_val': 0.23918549847375647, 'psi': 0.9237408620071992}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.695154 cos_to_last_merge=0.9450 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.945
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.8595646782266926, 'auprc': 0.9869736964642676, 'loss_val': 0.7739549970498765, 'psi': 0.9105282855217225}-{'f1_val': 0.9913812303173498, 'auprc': 0.9934314013698994, 'loss_val': 0.0483552542700037, 'psi': 0.9922012987383696}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.498051 cos_to_last_merge=0.9527 (last merge round=15)
[S17] round=37 local utility u=0.040168 metrics={'f1_val': 0.7156376349882086, 'auprc': 0.8386209392716699, 'loss_val': 0.7728299677579664, 'psi': 0.7648309567015932}-{'f1_val': 0.7018955078960938, 'auprc': 0.8423848943986992, 'loss_val': 0.7820041945745474, 'psi': 0.758091262497136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=38 head_norm_before_train=1.422500 cos_to_last_merge=0.9519 (last merge round=15)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6454721529220886, 'auprc': 0.7369093487427036, 'loss_val': 1.124806658720469, 'psi': 0.6820470312503346}-{'f1_val': 0.7054341794320559, 'auprc': 0.7567142255871232, 'loss_val': 0.6943424604637853, 'psi': 0.7259461978940829}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.064948 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9610069327789146, 'auprc': 0.9987075019468696, 'loss_val': 0.11370937495302227, 'psi': 0.9760871604460966}-{'f1_val': 0.9978100342676263, 'auprc': 0.998649735559066, 'loss_val': 0.03596738905634682, 'psi': 0.9981459147842022}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.961741 (no previous merge yet)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9528602829788727, 'auprc': 0.9569360562388459, 'loss_val': 0.28058386504257077, 'psi': 0.954490592282862}-{'f1_val': 0.952449884991471, 'auprc': 0.9673814298228174, 'loss_val': 0.27539072013672955, 'psi': 0.9584225029240094}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.494257 cos_to_last_merge=0.8001 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=38 local utility u=0.363243 metrics={'f1_val': 0.9964799208068884, 'auprc': 0.9977993031887117, 'loss_val': 0.1374008647141174, 'psi': 0.9970076737596177}-{'f1_val': 0.88528090206148, 'auprc': 0.9934039118921116, 'loss_val': 0.18350716136679984, 'psi': 0.9285301059937326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=38 head_norm_before_train=1.298097 cos_to_last_merge=0.8624 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.862
[S6] round=38 local utility u=0.938106 metrics={'f1_val': 0.7759979242470835, 'auprc': 0.9602659953450059, 'loss_val': 0.5160354871670332, 'psi': 0.8497051526862525}-{'f1_val': 0.5929033072889347, 'auprc': 0.7804739463229332, 'loss_val': 0.7543029415597126, 'psi': 0.6679315629025341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=38 head_norm_before_train=1.338198 cos_to_last_merge=0.9561 (last merge round=15)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6299731317885835, 'auprc': 0.7959634425922175, 'loss_val': 0.5635675164785193, 'psi': 0.6963692561100371}-{'f1_val': 0.6877287620892547, 'auprc': 0.8407698211592999, 'loss_val': 0.36043954972973313, 'psi': 0.7489451857172729}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.788311 cos_to_last_merge=0.7549 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=38 local utility u=0.017203 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.987370829217721, 'loss_val': 0.03939604261906109, 'psi': 0.9906846551660576}-{'f1_val': 0.9878503457462027, 'auprc': 0.9884727291357555, 'loss_val': 0.046846587088249986, 'psi': 0.9880992991020239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=38 head_norm_before_train=1.534186 cos_to_last_merge=0.9166 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.917
[S9] round=38 local utility u=0.002758 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9981451869646177, 'loss_val': 0.029012607254274455, 'psi': 0.9977850087922333}-{'f1_val': 0.9967149094376494, 'auprc': 0.998850188381576, 'loss_val': 0.031664566769937966, 'psi': 0.9975690210152199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=38 head_norm_before_train=1.627269 cos_to_last_merge=0.9645 (last merge round=15)
[S10] round=38 local utility u=0.005700 metrics={'f1_val': 0.9948429234526912, 'auprc': 0.9964804637814271, 'loss_val': 0.03957402682670164, 'psi': 0.9954979395841856}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952043313883593, 'loss_val': 0.04921501188672791, 'psi': 0.9951944359669685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=38 head_norm_before_train=2.114378 (no previous merge yet)
[S11] round=38 local utility u=0.001231 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979140085701366, 'loss_val': 0.021539920163282062, 'psi': 0.9972511132838019}-{'f1_val': 0.996567470639547, 'auprc': 0.997883235313255, 'loss_val': 0.022459029025277143, 'psi': 0.9970937765090302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=38 head_norm_before_train=1.592670 cos_to_last_merge=0.8478 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.848
[S13] round=38 local utility u=0.038959 metrics={'f1_val': 0.6337490472418434, 'auprc': 0.7484157296591135, 'loss_val': 0.753439780307388, 'psi': 0.6796157202087515}-{'f1_val': 0.6424089508485794, 'auprc': 0.6706862092831295, 'loss_val': 0.6501296026826224, 'psi': 0.6537198542223994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=38 head_norm_before_train=1.695399 cos_to_last_merge=0.8811 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.881
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9976943331204965, 'auprc': 0.9990390264279404, 'loss_val': 0.032024600066501804, 'psi': 0.998232210443474}-{'f1_val': 0.9976511180498535, 'auprc': 0.9990435659986007, 'loss_val': 0.03105173438046923, 'psi': 0.9982080972293524}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.431513 cos_to_last_merge=0.8961 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=38 local utility u=0.662022 metrics={'f1_val': 0.9641067172519324, 'auprc': 0.9907275345223672, 'loss_val': 0.09833804102073518, 'psi': 0.9747550441601063}-{'f1_val': 0.8171609340088779, 'auprc': 0.9165547261961526, 'loss_val': 0.3181879873571522, 'psi': 0.8569184508837877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=38 head_norm_before_train=1.707280 cos_to_last_merge=0.9440 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.944
[S16] round=38 local utility u=0.372049 metrics={'f1_val': 0.9204518501788367, 'auprc': 0.9925808870606935, 'loss_val': 0.41200154842001196, 'psi': 0.9493034649315795}-{'f1_val': 0.8595646782266926, 'auprc': 0.9869736964642676, 'loss_val': 0.7739549970498765, 'psi': 0.9105282855217225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=38 head_norm_before_train=1.517187 cos_to_last_merge=0.9502 (last merge round=15)
[S17] round=38 local utility u=0.093567 metrics={'f1_val': 0.7229423632077728, 'auprc': 0.8638083043712599, 'loss_val': 0.7050873286300718, 'psi': 0.7792887396731676}-{'f1_val': 0.7156376349882086, 'auprc': 0.8386209392716699, 'loss_val': 0.7728299677579664, 'psi': 0.7648309567015932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=39 head_norm_before_train=1.439463 cos_to_last_merge=0.9492 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.949
[S2] round=39 local utility u=0.187290 metrics={'f1_val': 0.6599703782029587, 'auprc': 0.7490158562541362, 'loss_val': 0.8735353151969986, 'psi': 0.6955885694234297}-{'f1_val': 0.6454721529220886, 'auprc': 0.7369093487427036, 'loss_val': 1.124806658720469, 'psi': 0.6820470312503346}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=40 psi=0.696 u=0.1873 p_local=0.1361 f1=0.660 auprc=0.749 bytes=39587
[S3] START round=39 head_norm_before_train=2.076262 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.9499042710922065, 'auprc': 0.9987076348338746, 'loss_val': 0.16191191044062045, 'psi': 0.9694256165888738}-{'f1_val': 0.9610069327789146, 'auprc': 0.9987075019468696, 'loss_val': 0.11370937495302227, 'psi': 0.9760871604460966}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.969 u=0.0000 p_local=0.0331 f1=0.950 auprc=0.999 bytes=41429
[S4] START round=39 head_norm_before_train=1.968854 (no previous merge yet)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9509945301594466, 'auprc': 0.9592137241750585, 'loss_val': 0.2824317137466041, 'psi': 0.9542822077656914}-{'f1_val': 0.9528602829788727, 'auprc': 0.9569360562388459, 'loss_val': 0.28058386504257077, 'psi': 0.954490592282862}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.954 u=0.0000 p_local=0.0118 f1=0.951 auprc=0.959 bytes=43124
[S5] START round=39 head_norm_before_train=1.497249 cos_to_last_merge=0.8000 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.9226314862876698, 'auprc': 0.9922509865819873, 'loss_val': 0.16570108347867232, 'psi': 0.9504792864053968}-{'f1_val': 0.9964799208068884, 'auprc': 0.9977993031887117, 'loss_val': 0.1374008647141174, 'psi': 0.9970076737596177}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.950 u=0.0000 p_local=0.2228 f1=0.923 auprc=0.992 bytes=43181
[S6] START round=39 head_norm_before_train=1.303787 cos_to_last_merge=0.8614 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=39 local utility u=0.750482 metrics={'f1_val': 0.9633564459970579, 'auprc': 0.986948904301842, 'loss_val': 0.21927113292840905, 'psi': 0.9727934293189715}-{'f1_val': 0.7759979242470835, 'auprc': 0.9602659953450059, 'loss_val': 0.5160354871670332, 'psi': 0.8497051526862525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=40 psi=0.973 u=0.7505 p_local=0.4598 f1=0.963 auprc=0.987 bytes=44842
[S7] START round=39 head_norm_before_train=1.342567 cos_to_last_merge=0.9553 (last merge round=15)
[S7] round=39 local utility u=0.056933 metrics={'f1_val': 0.6457832279475725, 'auprc': 0.7972253273727299, 'loss_val': 0.5483468176822154, 'psi': 0.7063600677176354}-{'f1_val': 0.6299731317885835, 'auprc': 0.7959634425922175, 'loss_val': 0.5635675164785193, 'psi': 0.6963692561100371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S7] r=40 psi=0.706 u=0.0569 p_local=0.1716 f1=0.646 auprc=0.797 bytes=41379
[S8] START round=39 head_norm_before_train=1.800369 cos_to_last_merge=0.7546 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.755
[S8] round=39 local utility u=0.000288 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9873087986239151, 'loss_val': 0.03863311317994519, 'psi': 0.9906598429285353}-{'f1_val': 0.9928938724649488, 'auprc': 0.987370829217721, 'loss_val': 0.03939604261906109, 'psi': 0.9906846551660576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=40 psi=0.991 u=0.0003 p_local=0.0081 f1=0.993 auprc=0.987 bytes=48557
[S9] START round=39 head_norm_before_train=1.546494 cos_to_last_merge=0.9150 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.915
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9988496787071018, 'loss_val': 0.029867053520495457, 'psi': 0.9975688171454303}-{'f1_val': 0.9975448900106438, 'auprc': 0.9981451869646177, 'loss_val': 0.029012607254274455, 'psi': 0.9977850087922333}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.998 u=0.0000 p_local=0.0073 f1=0.997 auprc=0.999 bytes=55691
[S10] START round=39 head_norm_before_train=1.647613 cos_to_last_merge=0.9628 (last merge round=15)
[S10] round=39 local utility u=0.000918 metrics={'f1_val': 0.9948429234526912, 'auprc': 0.996482148745022, 'loss_val': 0.0377421276608186, 'psi': 0.9954986135696235}-{'f1_val': 0.9948429234526912, 'auprc': 0.9964804637814271, 'loss_val': 0.03957402682670164, 'psi': 0.9954979395841856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=40 psi=0.995 u=0.0009 p_local=0.0174 f1=0.995 auprc=0.996 bytes=48489
[S11] START round=39 head_norm_before_train=2.121082 (no previous merge yet)
[S11] round=39 local utility u=0.000013 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.997840088428287, 'loss_val': 0.02129166590410149, 'psi': 0.9972215452270621}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979140085701366, 'loss_val': 0.021539920163282062, 'psi': 0.9972511132838019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S11] r=40 psi=0.997 u=0.0000 p_local=0.0024 f1=0.997 auprc=0.998 bytes=57587
[S13] START round=39 head_norm_before_train=1.596232 cos_to_last_merge=0.8473 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=39 local utility u=0.066409 metrics={'f1_val': 0.6413875603200148, 'auprc': 0.7440455632168373, 'loss_val': 0.6533424765712663, 'psi': 0.6824507614787438}-{'f1_val': 0.6337490472418434, 'auprc': 0.7484157296591135, 'loss_val': 0.753439780307388, 'psi': 0.6796157202087515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S13] r=40 psi=0.682 u=0.0664 p_local=0.0578 f1=0.641 auprc=0.744 bytes=41362
[S14] START round=39 head_norm_before_train=1.701874 cos_to_last_merge=0.8801 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.880
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9966030682544773, 'auprc': 0.9988014865628861, 'loss_val': 0.037203060890359595, 'psi': 0.9974824355778409}-{'f1_val': 0.9976943331204965, 'auprc': 0.9990390264279404, 'loss_val': 0.032024600066501804, 'psi': 0.998232210443474}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.997 u=0.0000 p_local=0.0036 f1=0.997 auprc=0.999 bytes=55658
[S15] START round=39 head_norm_before_train=1.446086 cos_to_last_merge=0.8941 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.894
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.8719098411012144, 'auprc': 0.9421077898131203, 'loss_val': 0.27635675016223704, 'psi': 0.8999890205859767}-{'f1_val': 0.9641067172519324, 'auprc': 0.9907275345223672, 'loss_val': 0.09833804102073518, 'psi': 0.9747550441601063}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.900 u=0.0000 p_local=0.2301 f1=0.872 auprc=0.942 bytes=43073
[S16] START round=39 head_norm_before_train=1.717291 cos_to_last_merge=0.9431 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.943
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.8966454538590154, 'auprc': 0.9781541421760448, 'loss_val': 0.24718802722058023, 'psi': 0.9292489291858271}-{'f1_val': 0.9204518501788367, 'auprc': 0.9925808870606935, 'loss_val': 0.41200154842001196, 'psi': 0.9493034649315795}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.929 u=0.0000 p_local=0.1056 f1=0.897 auprc=0.978 bytes=41364
[S17] START round=39 head_norm_before_train=1.536957 cos_to_last_merge=0.9476 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.948
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6780180011346226, 'auprc': 0.7074983199210957, 'loss_val': 1.1441208188165974, 'psi': 0.6898101286492119}-{'f1_val': 0.7229423632077728, 'auprc': 0.8638083043712599, 'loss_val': 0.7050873286300718, 'psi': 0.7792887396731676}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.690 u=0.0000 p_local=0.1185 f1=0.678 auprc=0.707 bytes=44927
[S2] START round=40 head_norm_before_train=1.456351 cos_to_last_merge=0.9463 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.946
[S2] round=40 local utility u=0.265211 metrics={'f1_val': 0.7095382841691222, 'auprc': 0.766343734327251, 'loss_val': 0.6925049182249322, 'psi': 0.7322604642323738}-{'f1_val': 0.6599703782029587, 'auprc': 0.7490158562541362, 'loss_val': 0.8735353151969986, 'psi': 0.6955885694234297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=40 head_norm_before_train=2.089700 (no previous merge yet)
[S3] round=40 local utility u=0.167272 metrics={'f1_val': 0.9894240174195466, 'auprc': 0.998649735920428, 'loss_val': 0.06431342822774315, 'psi': 0.9931143048198992}-{'f1_val': 0.9499042710922065, 'auprc': 0.9987076348338746, 'loss_val': 0.16191191044062045, 'psi': 0.9694256165888738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=40 head_norm_before_train=1.974249 (no previous merge yet)
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9410351976697143, 'auprc': 0.9349717946894338, 'loss_val': 0.29631559391474205, 'psi': 0.9386098364776021}-{'f1_val': 0.9509945301594466, 'auprc': 0.9592137241750585, 'loss_val': 0.2824317137466041, 'psi': 0.9542822077656914}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.503943 cos_to_last_merge=0.7994 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=40 local utility u=0.248803 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9950535149509492, 'loss_val': 0.11783022538937615, 'psi': 0.9957330199659663}-{'f1_val': 0.9226314862876698, 'auprc': 0.9922509865819873, 'loss_val': 0.16570108347867232, 'psi': 0.9504792864053968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=40 head_norm_before_train=1.310118 cos_to_last_merge=0.8608 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.861
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.704614106618753, 'auprc': 0.8092407082635845, 'loss_val': 0.5371803497891774, 'psi': 0.7464647472766857}-{'f1_val': 0.9633564459970579, 'auprc': 0.986948904301842, 'loss_val': 0.21927113292840905, 'psi': 0.9727934293189715}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=40 head_norm_before_train=1.348772 cos_to_last_merge=0.9542 (last merge round=15)
[S7] round=40 local utility u=0.021854 metrics={'f1_val': 0.6427166359574186, 'auprc': 0.8016840683562555, 'loss_val': 0.49961527793212185, 'psi': 0.7063036089169533}-{'f1_val': 0.6457832279475725, 'auprc': 0.7972253273727299, 'loss_val': 0.5483468176822154, 'psi': 0.7063600677176354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=40 head_norm_before_train=1.813562 cos_to_last_merge=0.7532 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.753
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9930564853160746, 'auprc': 0.9859450297114748, 'loss_val': 0.04451122490939918, 'psi': 0.9902119030742347}-{'f1_val': 0.9928938724649488, 'auprc': 0.9873087986239151, 'loss_val': 0.03863311317994519, 'psi': 0.9906598429285353}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.559085 cos_to_last_merge=0.9134 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=40 local utility u=0.002528 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9988469505357488, 'loss_val': 0.027304815955969824, 'psi': 0.9978178339985649}-{'f1_val': 0.9967149094376494, 'auprc': 0.9988496787071018, 'loss_val': 0.029867053520495457, 'psi': 0.9975688171454303}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=40 head_norm_before_train=1.663867 cos_to_last_merge=0.9614 (last merge round=15)
[S10] round=40 local utility u=0.002422 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9964135654386133, 'loss_val': 0.03679015829042516, 'psi': 0.9958809711299124}-{'f1_val': 0.9948429234526912, 'auprc': 0.996482148745022, 'loss_val': 0.0377421276608186, 'psi': 0.9954986135696235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=40 head_norm_before_train=2.128142 (no previous merge yet)
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9980149551571526, 'loss_val': 0.022547150230415446, 'psi': 0.9971464644465893}-{'f1_val': 0.9968091830929121, 'auprc': 0.997840088428287, 'loss_val': 0.02129166590410149, 'psi': 0.9972215452270621}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.601141 cos_to_last_merge=0.8468 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.847
[S13] round=40 local utility u=0.070544 metrics={'f1_val': 0.6560706058781883, 'auprc': 0.7241496481517475, 'loss_val': 0.5406643930250014, 'psi': 0.683302222787612}-{'f1_val': 0.6413875603200148, 'auprc': 0.7440455632168373, 'loss_val': 0.6533424765712663, 'psi': 0.6824507614787438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=40 head_norm_before_train=1.709121 cos_to_last_merge=0.8794 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.879
[S14] round=40 local utility u=0.001215 metrics={'f1_val': 0.997266076999405, 'auprc': 0.9967472953091006, 'loss_val': 0.03258929326621718, 'psi': 0.9970585643232832}-{'f1_val': 0.9966030682544773, 'auprc': 0.9988014865628861, 'loss_val': 0.037203060890359595, 'psi': 0.9974824355778409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=40 head_norm_before_train=1.461044 cos_to_last_merge=0.8921 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=40 local utility u=0.245843 metrics={'f1_val': 0.9087564577521183, 'auprc': 0.9921783167617071, 'loss_val': 0.15596281007749901, 'psi': 0.9421252013559538}-{'f1_val': 0.8719098411012144, 'auprc': 0.9421077898131203, 'loss_val': 0.27635675016223704, 'psi': 0.8999890205859767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=40 head_norm_before_train=1.727353 cos_to_last_merge=0.9422 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.942
[S16] round=40 local utility u=0.265974 metrics={'f1_val': 0.960912973487211, 'auprc': 0.9843264335016337, 'loss_val': 0.11936220795443384, 'psi': 0.9702783574929802}-{'f1_val': 0.8966454538590154, 'auprc': 0.9781541421760448, 'loss_val': 0.24718802722058023, 'psi': 0.9292489291858271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=40 head_norm_before_train=1.552944 cos_to_last_merge=0.9446 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=40 local utility u=0.051679 metrics={'f1_val': 0.6733481057026619, 'auprc': 0.7438415469731324, 'loss_val': 1.1217737080071828, 'psi': 0.7015454822108501}-{'f1_val': 0.6780180011346226, 'auprc': 0.7074983199210957, 'loss_val': 1.1441208188165974, 'psi': 0.6898101286492119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=41 head_norm_before_train=1.473596 cos_to_last_merge=0.9435 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.943
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6271085550009913, 'auprc': 0.7284094454661422, 'loss_val': 1.324038226463395, 'psi': 0.6676289111870517}-{'f1_val': 0.7095382841691222, 'auprc': 0.766343734327251, 'loss_val': 0.6925049182249322, 'psi': 0.7322604642323738}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.103874 (no previous merge yet)
[S3] round=41 local utility u=0.038616 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9986491623645283, 'loss_val': 0.035786768907630426, 'psi': 0.9979848759247678}-{'f1_val': 0.9894240174195466, 'auprc': 0.998649735920428, 'loss_val': 0.06431342822774315, 'psi': 0.9931143048198992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=41 head_norm_before_train=1.981377 (no previous merge yet)
[S4] round=41 local utility u=0.040369 metrics={'f1_val': 0.9426924151453782, 'auprc': 0.9560465704568352, 'loss_val': 0.28874426996388236, 'psi': 0.9480340772699609}-{'f1_val': 0.9410351976697143, 'auprc': 0.9349717946894338, 'loss_val': 0.29631559391474205, 'psi': 0.9386098364776021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=41 head_norm_before_train=1.510486 cos_to_last_merge=0.7989 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.9195636022396576, 'auprc': 0.9933930737326522, 'loss_val': 0.15616435608686108, 'psi': 0.9490953908368553}-{'f1_val': 0.996186023309311, 'auprc': 0.9950535149509492, 'loss_val': 0.11783022538937615, 'psi': 0.9957330199659663}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.315663 cos_to_last_merge=0.8599 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.860
[S6] round=41 local utility u=1.000000 metrics={'f1_val': 0.9601576400039211, 'auprc': 0.9656666158113562, 'loss_val': 0.21454552920085268, 'psi': 0.9623612303268951}-{'f1_val': 0.704614106618753, 'auprc': 0.8092407082635845, 'loss_val': 0.5371803497891774, 'psi': 0.7464647472766857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=41 head_norm_before_train=1.356939 cos_to_last_merge=0.9528 (last merge round=15)
[S7] round=41 local utility u=0.007110 metrics={'f1_val': 0.6513147097144592, 'auprc': 0.7993887330272176, 'loss_val': 0.5300968199384818, 'psi': 0.7105443190395625}-{'f1_val': 0.6427166359574186, 'auprc': 0.8016840683562555, 'loss_val': 0.49961527793212185, 'psi': 0.7063036089169533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=41 head_norm_before_train=1.824114 cos_to_last_merge=0.7528 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.753
[S8] round=41 local utility u=0.005966 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9880002011603731, 'loss_val': 0.03776846822350168, 'psi': 0.9909364039431185}-{'f1_val': 0.9930564853160746, 'auprc': 0.9859450297114748, 'loss_val': 0.04451122490939918, 'psi': 0.9902119030742347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=41 head_norm_before_train=1.571310 cos_to_last_merge=0.9120 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.912
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9959142699698881, 'loss_val': 0.02582038778374178, 'psi': 0.9966463871465902}-{'f1_val': 0.9971317563071089, 'auprc': 0.9988469505357488, 'loss_val': 0.027304815955969824, 'psi': 0.9978178339985649}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.680192 cos_to_last_merge=0.9600 (last merge round=15)
[S10] round=41 local utility u=0.000596 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9966508102386618, 'loss_val': 0.034993405254174624, 'psi': 0.9958441226625095}-{'f1_val': 0.9955259082574451, 'auprc': 0.9964135654386133, 'loss_val': 0.03679015829042516, 'psi': 0.9958809711299124}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=41 head_norm_before_train=2.135454 (no previous merge yet)
[S11] round=41 local utility u=0.000144 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979500466733456, 'loss_val': 0.022064064230550066, 'psi': 0.9971205010530665}-{'f1_val': 0.996567470639547, 'auprc': 0.9980149551571526, 'loss_val': 0.022547150230415446, 'psi': 0.9971464644465893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=41 head_norm_before_train=1.603899 cos_to_last_merge=0.8463 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.6866846894556462, 'auprc': 0.7134676840337262, 'loss_val': 0.7540811487110751, 'psi': 0.6973978872868782}-{'f1_val': 0.6560706058781883, 'auprc': 0.7241496481517475, 'loss_val': 0.5406643930250014, 'psi': 0.683302222787612}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=1.718394 cos_to_last_merge=0.8785 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.878
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9759037827151431, 'auprc': 0.9949375510991914, 'loss_val': 0.10349392896090617, 'psi': 0.9835172900687624}-{'f1_val': 0.997266076999405, 'auprc': 0.9967472953091006, 'loss_val': 0.03258929326621718, 'psi': 0.9970585643232832}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.477691 cos_to_last_merge=0.8900 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=41 local utility u=0.000000 metrics={'f1_val': 0.7581988654985885, 'auprc': 0.9116601361255582, 'loss_val': 0.41141636889412836, 'psi': 0.8195833737493764}-{'f1_val': 0.9087564577521183, 'auprc': 0.9921783167617071, 'loss_val': 0.15596281007749901, 'psi': 0.9421252013559538}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=41 head_norm_before_train=1.736098 cos_to_last_merge=0.9412 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.941
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9365400849060486, 'auprc': 0.9898054564031068, 'loss_val': 0.3451065135882809, 'psi': 0.9578462335048719}-{'f1_val': 0.960912973487211, 'auprc': 0.9843264335016337, 'loss_val': 0.11936220795443384, 'psi': 0.9702783574929802}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.564946 cos_to_last_merge=0.9423 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=41 local utility u=0.268629 metrics={'f1_val': 0.6900551795834194, 'auprc': 0.8222613320112808, 'loss_val': 0.9200169782513771, 'psi': 0.742937640554564}-{'f1_val': 0.6733481057026619, 'auprc': 0.7438415469731324, 'loss_val': 1.1217737080071828, 'psi': 0.7015454822108501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=42 head_norm_before_train=1.489817 cos_to_last_merge=0.9405 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.940
[S2] round=42 local utility u=0.608579 metrics={'f1_val': 0.7058604067436578, 'auprc': 0.7671395156273271, 'loss_val': 0.6955819853868912, 'psi': 0.7303720502971255}-{'f1_val': 0.6271085550009913, 'auprc': 0.7284094454661422, 'loss_val': 1.324038226463395, 'psi': 0.6676289111870517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=42 head_norm_before_train=2.117577 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9987231837170178, 'loss_val': 0.1463503533480812, 'psi': 0.9759870388695453}-{'f1_val': 0.997542018298261, 'auprc': 0.9986491623645283, 'loss_val': 0.035786768907630426, 'psi': 0.9979848759247678}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.991907 (no previous merge yet)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9409251529347769, 'auprc': 0.9366011371012148, 'loss_val': 0.29964886903348503, 'psi': 0.939195546601352}-{'f1_val': 0.9426924151453782, 'auprc': 0.9560465704568352, 'loss_val': 0.28874426996388236, 'psi': 0.9480340772699609}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.518480 cos_to_last_merge=0.7988 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=42 local utility u=0.255611 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9951267198112185, 'loss_val': 0.110757084177708, 'psi': 0.9958502425177816}-{'f1_val': 0.9195636022396576, 'auprc': 0.9933930737326522, 'loss_val': 0.15616435608686108, 'psi': 0.9490953908368553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=42 head_norm_before_train=1.323197 cos_to_last_merge=0.8585 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.859
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.6538759540688142, 'auprc': 0.7929337034755545, 'loss_val': 0.6546084609867024, 'psi': 0.7094990538315102}-{'f1_val': 0.9601576400039211, 'auprc': 0.9656666158113562, 'loss_val': 0.21454552920085268, 'psi': 0.9623612303268951}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.364412 cos_to_last_merge=0.9517 (last merge round=15)
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.6170901463127665, 'auprc': 0.7933244730277621, 'loss_val': 0.6416102623169759, 'psi': 0.6875838769987648}-{'f1_val': 0.6513147097144592, 'auprc': 0.7993887330272176, 'loss_val': 0.5300968199384818, 'psi': 0.7105443190395625}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=1.833080 cos_to_last_merge=0.7521 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.752
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9829227792597723, 'auprc': 0.9959543905777849, 'loss_val': 0.055206598491676716, 'psi': 0.9881354237869773}-{'f1_val': 0.9928938724649488, 'auprc': 0.9880002011603731, 'loss_val': 0.03776846822350168, 'psi': 0.9909364039431185}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.582842 cos_to_last_merge=0.9106 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.911
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9954695508442518, 'auprc': 0.9988523499860748, 'loss_val': 0.029125702964711276, 'psi': 0.9968226705009811}-{'f1_val': 0.9971344652643916, 'auprc': 0.9959142699698881, 'loss_val': 0.02582038778374178, 'psi': 0.9966463871465902}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.696652 cos_to_last_merge=0.9588 (last merge round=15)
[S10] round=42 local utility u=0.000062 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9964175702318439, 'loss_val': 0.0341704657105873, 'psi': 0.9957508266597824}-{'f1_val': 0.9953063309450747, 'auprc': 0.9966508102386618, 'loss_val': 0.034993405254174624, 'psi': 0.9958441226625095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=42 head_norm_before_train=2.141826 (no previous merge yet)
[S11] round=42 local utility u=0.001192 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979399102941072, 'loss_val': 0.021099210533488635, 'psi': 0.9972614739733902}-{'f1_val': 0.996567470639547, 'auprc': 0.9979500466733456, 'loss_val': 0.022064064230550066, 'psi': 0.9971205010530665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=42 head_norm_before_train=1.605352 cos_to_last_merge=0.8456 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.6348992346393663, 'auprc': 0.7007231438830069, 'loss_val': 0.5801187414439081, 'psi': 0.6612287983368226}-{'f1_val': 0.6866846894556462, 'auprc': 0.7134676840337262, 'loss_val': 0.7540811487110751, 'psi': 0.6973978872868782}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.726205 cos_to_last_merge=0.8779 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.878
[S14] round=42 local utility u=0.102425 metrics={'f1_val': 0.997286915407786, 'auprc': 0.9977896472449412, 'loss_val': 0.035499004010851334, 'psi': 0.9974880081426482}-{'f1_val': 0.9759037827151431, 'auprc': 0.9949375510991914, 'loss_val': 0.10349392896090617, 'psi': 0.9835172900687624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=42 head_norm_before_train=1.496051 cos_to_last_merge=0.8875 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=42 local utility u=1.000000 metrics={'f1_val': 0.9932240463614362, 'auprc': 0.9911726855498822, 'loss_val': 0.05885800509253344, 'psi': 0.9924035020368146}-{'f1_val': 0.7581988654985885, 'auprc': 0.9116601361255582, 'loss_val': 0.41141636889412836, 'psi': 0.8195833737493764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=42 head_norm_before_train=1.745488 cos_to_last_merge=0.9402 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.940
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9202599363249603, 'auprc': 0.9894584159897643, 'loss_val': 0.44451422780897004, 'psi': 0.9479393281908819}-{'f1_val': 0.9365400849060486, 'auprc': 0.9898054564031068, 'loss_val': 0.3451065135882809, 'psi': 0.9578462335048719}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.578693 cos_to_last_merge=0.9407 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=42 local utility u=0.137015 metrics={'f1_val': 0.6950936633865512, 'auprc': 0.8799795553661953, 'loss_val': 0.8493733285491405, 'psi': 0.7690480201784089}-{'f1_val': 0.6900551795834194, 'auprc': 0.8222613320112808, 'loss_val': 0.9200169782513771, 'psi': 0.742937640554564}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=43 head_norm_before_train=1.504946 cos_to_last_merge=0.9379 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.938
[S2] round=43 local utility u=0.077926 metrics={'f1_val': 0.7161496963475709, 'auprc': 0.8026575750374384, 'loss_val': 0.70802045558241, 'psi': 0.7507528478235179}-{'f1_val': 0.7058604067436578, 'auprc': 0.7671395156273271, 'loss_val': 0.6955819853868912, 'psi': 0.7303720502971255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=43 head_norm_before_train=2.129182 (no previous merge yet)
[S3] round=43 local utility u=0.040766 metrics={'f1_val': 0.9651428193912157, 'auprc': 0.99874251573857, 'loss_val': 0.09075641134802992, 'psi': 0.9785826979301575}-{'f1_val': 0.9608296089712303, 'auprc': 0.9987231837170178, 'loss_val': 0.1463503533480812, 'psi': 0.9759870388695453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=43 head_norm_before_train=1.998743 (no previous merge yet)
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9402684118951348, 'auprc': 0.936526655944025, 'loss_val': 0.30321175441721954, 'psi': 0.9387717095146908}-{'f1_val': 0.9409251529347769, 'auprc': 0.9366011371012148, 'loss_val': 0.29964886903348503, 'psi': 0.939195546601352}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.527760 cos_to_last_merge=0.7986 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9921837333352561, 'loss_val': 0.1130646537590507, 'psi': 0.9945851073196891}-{'f1_val': 0.9963325909888239, 'auprc': 0.9951267198112185, 'loss_val': 0.110757084177708, 'psi': 0.9958502425177816}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.335026 cos_to_last_merge=0.8564 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.856
[S6] round=43 local utility u=1.000000 metrics={'f1_val': 0.9589455106389847, 'auprc': 0.96866522055442, 'loss_val': 0.24432321219916014, 'psi': 0.9628333946051588}-{'f1_val': 0.6538759540688142, 'auprc': 0.7929337034755545, 'loss_val': 0.6546084609867024, 'psi': 0.7094990538315102}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=43 head_norm_before_train=1.370519 cos_to_last_merge=0.9507 (last merge round=15)
[S7] round=43 local utility u=0.004883 metrics={'f1_val': 0.6170300455377892, 'auprc': 0.7948497629241296, 'loss_val': 0.6360587691710001, 'psi': 0.6881579324923254}-{'f1_val': 0.6170901463127665, 'auprc': 0.7933244730277621, 'loss_val': 0.6416102623169759, 'psi': 0.6875838769987648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=43 head_norm_before_train=1.841829 cos_to_last_merge=0.7510 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.751
[S8] round=43 local utility u=0.021466 metrics={'f1_val': 0.9930564853160746, 'auprc': 0.9853608795476385, 'loss_val': 0.041295909568450764, 'psi': 0.9899782430087001}-{'f1_val': 0.9829227792597723, 'auprc': 0.9959543905777849, 'loss_val': 0.055206598491676716, 'psi': 0.9881354237869773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=43 head_norm_before_train=1.591923 cos_to_last_merge=0.9093 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.909
[S9] round=43 local utility u=0.005543 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9988520982450803, 'loss_val': 0.025530329354624154, 'psi': 0.9975717181392905}-{'f1_val': 0.9954695508442518, 'auprc': 0.9988523499860748, 'loss_val': 0.029125702964711276, 'psi': 0.9968226705009811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=43 head_norm_before_train=1.712778 cos_to_last_merge=0.9577 (last merge round=15)
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9961571867471586, 'loss_val': 0.03576257602478114, 'psi': 0.9957784196533305}-{'f1_val': 0.9953063309450747, 'auprc': 0.9964175702318439, 'loss_val': 0.0341704657105873, 'psi': 0.9957508266597824}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=2.149452 (no previous merge yet)
[S11] round=43 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979859077602778, 'loss_val': 0.02171774759478786, 'psi': 0.9971348454878394}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979399102941072, 'loss_val': 0.021099210533488635, 'psi': 0.9972614739733902}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=43 head_norm_before_train=1.607228 cos_to_last_merge=0.8456 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=43 local utility u=0.110445 metrics={'f1_val': 0.6689684696335729, 'auprc': 0.7571281310718663, 'loss_val': 0.7328600034056638, 'psi': 0.7042323342088903}-{'f1_val': 0.6348992346393663, 'auprc': 0.7007231438830069, 'loss_val': 0.5801187414439081, 'psi': 0.6612287983368226}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=43 head_norm_before_train=1.734775 cos_to_last_merge=0.8771 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.877
[S14] round=43 local utility u=0.001034 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.99886338410323, 'loss_val': 0.037639232194770236, 'psi': 0.9980162819225746}-{'f1_val': 0.997286915407786, 'auprc': 0.9977896472449412, 'loss_val': 0.035499004010851334, 'psi': 0.9974880081426482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=43 head_norm_before_train=1.512693 cos_to_last_merge=0.8854 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.6986374030045567, 'auprc': 0.7075797532875735, 'loss_val': 0.5977153269011714, 'psi': 0.7022143431177634}-{'f1_val': 0.9932240463614362, 'auprc': 0.9911726855498822, 'loss_val': 0.05885800509253344, 'psi': 0.9924035020368146}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.753894 cos_to_last_merge=0.9392 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.939
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.8625644593013928, 'auprc': 0.9848115978071563, 'loss_val': 0.7750677176446248, 'psi': 0.9114633147036982}-{'f1_val': 0.9202599363249603, 'auprc': 0.9894584159897643, 'loss_val': 0.44451422780897004, 'psi': 0.9479393281908819}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.591424 cos_to_last_merge=0.9389 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.939
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6868519884099691, 'auprc': 0.7611066333529369, 'loss_val': 1.0304492969167602, 'psi': 0.7165538463871562}-{'f1_val': 0.6950936633865512, 'auprc': 0.8799795553661953, 'loss_val': 0.8493733285491405, 'psi': 0.7690480201784089}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=44 head_norm_before_train=1.522438 cos_to_last_merge=0.9351 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.935
[S2] round=44 local utility u=0.030446 metrics={'f1_val': 0.7173135291575985, 'auprc': 0.8164064728868206, 'loss_val': 0.6953581129746405, 'psi': 0.7569507066492873}-{'f1_val': 0.7161496963475709, 'auprc': 0.8026575750374384, 'loss_val': 0.70802045558241, 'psi': 0.7507528478235179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=44 head_norm_before_train=2.139837 (no previous merge yet)
[S3] round=44 local utility u=0.127442 metrics={'f1_val': 0.9970100543679847, 'auprc': 0.9986601754441351, 'loss_val': 0.02682932619898853, 'psi': 0.9976701027984449}-{'f1_val': 0.9651428193912157, 'auprc': 0.99874251573857, 'loss_val': 0.09075641134802992, 'psi': 0.9785826979301575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=44 head_norm_before_train=2.007454 (no previous merge yet)
[S4] round=44 local utility u=0.074572 metrics={'f1_val': 0.9450863333140528, 'auprc': 0.970871953619489, 'loss_val': 0.28601116317312, 'psi': 0.9554005814362273}-{'f1_val': 0.9402684118951348, 'auprc': 0.936526655944025, 'loss_val': 0.30321175441721954, 'psi': 0.9387717095146908}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=44 head_norm_before_train=1.536842 cos_to_last_merge=0.7979 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.798
[S5] round=44 local utility u=0.026963 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9984520610438063, 'loss_val': 0.07794270540948708, 'psi': 0.9970924384031091}-{'f1_val': 0.996186023309311, 'auprc': 0.9921837333352561, 'loss_val': 0.1130646537590507, 'psi': 0.9945851073196891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=44 head_norm_before_train=1.347788 cos_to_last_merge=0.8535 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.854
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.9116861984252265, 'auprc': 0.9651182534603344, 'loss_val': 0.30296325456985934, 'psi': 0.9330590204392697}-{'f1_val': 0.9589455106389847, 'auprc': 0.96866522055442, 'loss_val': 0.24432321219916014, 'psi': 0.9628333946051588}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.378501 cos_to_last_merge=0.9495 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.950
[S7] round=44 local utility u=0.167147 metrics={'f1_val': 0.6546221560083209, 'auprc': 0.7970591047710373, 'loss_val': 0.5339456452497324, 'psi': 0.7115969355134075}-{'f1_val': 0.6170300455377892, 'auprc': 0.7948497629241296, 'loss_val': 0.6360587691710001, 'psi': 0.6881579324923254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S7] sending update (kind=head size=1808 to 1 peers)
[S8] START round=44 head_norm_before_train=1.851333 cos_to_last_merge=0.7501 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=44 local utility u=0.004898 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9881840817032181, 'loss_val': 0.036859854349198334, 'psi': 0.9907964674305885}-{'f1_val': 0.9930564853160746, 'auprc': 0.9853608795476385, 'loss_val': 0.041295909568450764, 'psi': 0.9899782430087001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=44 head_norm_before_train=1.599498 cos_to_last_merge=0.9084 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.908
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9957348975385865, 'loss_val': 0.02441738832728048, 'psi': 0.9965746381740695}-{'f1_val': 0.9967181314020974, 'auprc': 0.9988520982450803, 'loss_val': 0.025530329354624154, 'psi': 0.9975717181392905}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.728636 cos_to_last_merge=0.9565 (last merge round=15)
[S10] round=44 local utility u=0.001675 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.996380836035679, 'loss_val': 0.03308413329446556, 'psi': 0.9958678793687387}-{'f1_val': 0.9955259082574451, 'auprc': 0.9961571867471586, 'loss_val': 0.03576257602478114, 'psi': 0.9957784196533305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=44 head_norm_before_train=2.156719 (no previous merge yet)
[S11] round=44 local utility u=0.000187 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979560076363421, 'loss_val': 0.02125461439461361, 'psi': 0.997122885438265}-{'f1_val': 0.996567470639547, 'auprc': 0.9979859077602778, 'loss_val': 0.02171774759478786, 'psi': 0.9971348454878394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=44 head_norm_before_train=1.610883 cos_to_last_merge=0.8449 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.845
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6336560019345175, 'auprc': 0.7595579036127194, 'loss_val': 0.7223959603420372, 'psi': 0.6840167626057982}-{'f1_val': 0.6689684696335729, 'auprc': 0.7571281310718663, 'loss_val': 0.7328600034056638, 'psi': 0.7042323342088903}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=1.743512 cos_to_last_merge=0.8764 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.876
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9921798741192377, 'auprc': 0.9989768468707425, 'loss_val': 0.04615106909372432, 'psi': 0.9948986632198396}-{'f1_val': 0.9974515471354712, 'auprc': 0.99886338410323, 'loss_val': 0.037639232194770236, 'psi': 0.9980162819225746}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=44 head_norm_before_train=1.524848 cos_to_last_merge=0.8839 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=44 local utility u=1.000000 metrics={'f1_val': 0.9941029385030195, 'auprc': 0.9927117455009961, 'loss_val': 0.04559844765262491, 'psi': 0.99354646130221}-{'f1_val': 0.6986374030045567, 'auprc': 0.7075797532875735, 'loss_val': 0.5977153269011714, 'psi': 0.7022143431177634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=44 head_norm_before_train=1.761327 cos_to_last_merge=0.9382 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.938
[S16] round=44 local utility u=0.209117 metrics={'f1_val': 0.8927390078454335, 'auprc': 0.9893992768707234, 'loss_val': 0.5516445265773813, 'psi': 0.9314031154555493}-{'f1_val': 0.8625644593013928, 'auprc': 0.9848115978071563, 'loss_val': 0.7750677176446248, 'psi': 0.9114633147036982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=44 head_norm_before_train=1.601408 cos_to_last_merge=0.9374 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=44 local utility u=0.411841 metrics={'f1_val': 0.7069395402378313, 'auprc': 0.8916698630362343, 'loss_val': 0.7189823210968717, 'psi': 0.7808316693571926}-{'f1_val': 0.6868519884099691, 'auprc': 0.7611066333529369, 'loss_val': 1.0304492969167602, 'psi': 0.7165538463871562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=45 head_norm_before_train=1.539488 cos_to_last_merge=0.9325 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.932
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7134081314708568, 'auprc': 0.7869619455257666, 'loss_val': 0.6645089377560065, 'psi': 0.7428296570928208}-{'f1_val': 0.7173135291575985, 'auprc': 0.8164064728868206, 'loss_val': 0.6953581129746405, 'psi': 0.7569507066492873}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.150180 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9984776400696312, 'loss_val': 0.13753116423948103, 'psi': 0.9760361072675248}-{'f1_val': 0.9970100543679847, 'auprc': 0.9986601754441351, 'loss_val': 0.02682932619898853, 'psi': 0.9976701027984449}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=2.010823 (no previous merge yet)
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9394380432283471, 'auprc': 0.9415129224022851, 'loss_val': 0.3028218253094338, 'psi': 0.9402679948979222}-{'f1_val': 0.9450863333140528, 'auprc': 0.970871953619489, 'loss_val': 0.28601116317312, 'psi': 0.9554005814362273}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.549984 cos_to_last_merge=0.7966 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=45 local utility u=0.001793 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9972406106804416, 'loss_val': 0.07072184367944989, 'psi': 0.9966078582577632}-{'f1_val': 0.996186023309311, 'auprc': 0.9984520610438063, 'loss_val': 0.07794270540948708, 'psi': 0.9970924384031091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=45 head_norm_before_train=1.359218 cos_to_last_merge=0.8510 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.851
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.8236423001232682, 'auprc': 0.960506857784747, 'loss_val': 0.3592886591799335, 'psi': 0.8783881231878596}-{'f1_val': 0.9116861984252265, 'auprc': 0.9651182534603344, 'loss_val': 0.30296325456985934, 'psi': 0.9330590204392697}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=45 head_norm_before_train=1.387823 cos_to_last_merge=0.9481 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.948
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6414662984844164, 'auprc': 0.7949504369917731, 'loss_val': 0.5096975330373534, 'psi': 0.702859953887359}-{'f1_val': 0.6546221560083209, 'auprc': 0.7970591047710373, 'loss_val': 0.5339456452497324, 'psi': 0.7115969355134075}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.860557 cos_to_last_merge=0.7498 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9794510226230733, 'auprc': 0.9987283224195929, 'loss_val': 0.05847757549472646, 'psi': 0.9871619425416811}-{'f1_val': 0.9925380579155019, 'auprc': 0.9881840817032181, 'loss_val': 0.036859854349198334, 'psi': 0.9907964674305885}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=1.607898 cos_to_last_merge=0.9074 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.907
[S9] round=45 local utility u=0.004878 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.998850751903595, 'loss_val': 0.023992951416490074, 'psi': 0.9978193545457034}-{'f1_val': 0.9971344652643916, 'auprc': 0.9957348975385865, 'loss_val': 0.02441738832728048, 'psi': 0.9965746381740695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=45 head_norm_before_train=1.740605 cos_to_last_merge=0.9554 (last merge round=15)
[S10] round=45 local utility u=0.000149 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.996433128783447, 'loss_val': 0.031625143944720414, 'psi': 0.9957570500804237}-{'f1_val': 0.9955259082574451, 'auprc': 0.996380836035679, 'loss_val': 0.03308413329446556, 'psi': 0.9958678793687387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=45 head_norm_before_train=2.162752 (no previous merge yet)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978454346989593, 'loss_val': 0.02102518862016885, 'psi': 0.9970786562633119}-{'f1_val': 0.996567470639547, 'auprc': 0.9979560076363421, 'loss_val': 0.02125461439461361, 'psi': 0.997122885438265}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.617261 cos_to_last_merge=0.8445 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=45 local utility u=0.189808 metrics={'f1_val': 0.6691187097134883, 'auprc': 0.768035802527954, 'loss_val': 0.580989554144715, 'psi': 0.7086855468392745}-{'f1_val': 0.6336560019345175, 'auprc': 0.7595579036127194, 'loss_val': 0.7223959603420372, 'psi': 0.6840167626057982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=45 head_norm_before_train=1.753784 cos_to_last_merge=0.8755 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.875
[S14] round=45 local utility u=0.014420 metrics={'f1_val': 0.9951539120677446, 'auprc': 0.9989827658493566, 'loss_val': 0.03517349601863653, 'psi': 0.9966854535803894}-{'f1_val': 0.9921798741192377, 'auprc': 0.9989768468707425, 'loss_val': 0.04615106909372432, 'psi': 0.9948986632198396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=45 head_norm_before_train=1.535073 cos_to_last_merge=0.8826 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7107419620001181, 'auprc': 0.9040053731959524, 'loss_val': 0.4722375409846966, 'psi': 0.7880473264784518}-{'f1_val': 0.9941029385030195, 'auprc': 0.9927117455009961, 'loss_val': 0.04559844765262491, 'psi': 0.99354646130221}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.770311 cos_to_last_merge=0.9374 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=45 local utility u=0.217038 metrics={'f1_val': 0.9350499768367542, 'auprc': 0.9908980463513561, 'loss_val': 0.37593000175587543, 'psi': 0.9573892046425949}-{'f1_val': 0.8927390078454335, 'auprc': 0.9893992768707234, 'loss_val': 0.5516445265773813, 'psi': 0.9314031154555493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=45 head_norm_before_train=1.612962 cos_to_last_merge=0.9358 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6574423959448903, 'auprc': 0.6964697367681546, 'loss_val': 1.1745764159167633, 'psi': 0.6730533322741961}-{'f1_val': 0.7069395402378313, 'auprc': 0.8916698630362343, 'loss_val': 0.7189823210968717, 'psi': 0.7808316693571926}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.554689 cos_to_last_merge=0.9302 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.930
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.6470993421537093, 'auprc': 0.7537300343863957, 'loss_val': 1.0980233992991157, 'psi': 0.6897516190467838}-{'f1_val': 0.7134081314708568, 'auprc': 0.7869619455257666, 'loss_val': 0.6645089377560065, 'psi': 0.7428296570928208}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.160761 (no previous merge yet)
[S3] round=46 local utility u=0.057442 metrics={'f1_val': 0.9728081154881955, 'auprc': 0.9986581073102052, 'loss_val': 0.09358688676636216, 'psi': 0.9831481122169994}-{'f1_val': 0.9610750853994537, 'auprc': 0.9984776400696312, 'loss_val': 0.13753116423948103, 'psi': 0.9760361072675248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=46 head_norm_before_train=2.012543 (no previous merge yet)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9365389829603221, 'auprc': 0.9285547685882289, 'loss_val': 0.3276676203994081, 'psi': 0.9333452972114848}-{'f1_val': 0.9394380432283471, 'auprc': 0.9415129224022851, 'loss_val': 0.3028218253094338, 'psi': 0.9402679948979222}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.565167 cos_to_last_merge=0.7956 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.796
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.7180678403276399, 'auprc': 0.9897418337360038, 'loss_val': 0.26590911297285424, 'psi': 0.8267374376909855}-{'f1_val': 0.996186023309311, 'auprc': 0.9972406106804416, 'loss_val': 0.07072184367944989, 'psi': 0.9966078582577632}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.370469 cos_to_last_merge=0.8487 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.849
[S6] round=46 local utility u=0.107774 metrics={'f1_val': 0.8493597463478574, 'auprc': 0.9641232990007724, 'loss_val': 0.308895247397315, 'psi': 0.8952651674090234}-{'f1_val': 0.8236423001232682, 'auprc': 0.960506857784747, 'loss_val': 0.3592886591799335, 'psi': 0.8783881231878596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=46 head_norm_before_train=1.394818 cos_to_last_merge=0.9470 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.947
[S7] round=46 local utility u=0.018251 metrics={'f1_val': 0.6533700331820531, 'auprc': 0.7963430931180707, 'loss_val': 0.5487966196502517, 'psi': 0.7105592571564602}-{'f1_val': 0.6414662984844164, 'auprc': 0.7949504369917731, 'loss_val': 0.5096975330373534, 'psi': 0.702859953887359}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=46 head_norm_before_train=1.869092 cos_to_last_merge=0.7500 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=46 local utility u=0.034842 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9883909463378701, 'loss_val': 0.0363039579560504, 'psi': 0.9908792132844492}-{'f1_val': 0.9794510226230733, 'auprc': 0.9987283224195929, 'loss_val': 0.05847757549472646, 'psi': 0.9871619425416811}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=46 head_norm_before_train=1.616046 cos_to_last_merge=0.9064 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.906
[S9] round=46 local utility u=0.001598 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988512765077745, 'loss_val': 0.023277554760791873, 'psi': 0.998067444609496}-{'f1_val': 0.9971317563071089, 'auprc': 0.998850751903595, 'loss_val': 0.023992951416490074, 'psi': 0.9978193545457034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=46 head_norm_before_train=1.753004 cos_to_last_merge=0.9542 (last merge round=15)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9961744626506917, 'loss_val': 0.03450542372021856, 'psi': 0.9957853300147437}-{'f1_val': 0.9953063309450747, 'auprc': 0.996433128783447, 'loss_val': 0.031625143944720414, 'psi': 0.9957570500804237}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.169942 (no previous merge yet)
[S11] round=46 local utility u=0.000165 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978919564978395, 'loss_val': 0.02083519181654034, 'psi': 0.997097264982864}-{'f1_val': 0.996567470639547, 'auprc': 0.9978454346989593, 'loss_val': 0.02102518862016885, 'psi': 0.9970786562633119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=46 head_norm_before_train=1.625946 cos_to_last_merge=0.8437 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.844
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6532321719711008, 'auprc': 0.7670755094373355, 'loss_val': 0.7491216165535557, 'psi': 0.6987695069575948}-{'f1_val': 0.6691187097134883, 'auprc': 0.768035802527954, 'loss_val': 0.580989554144715, 'psi': 0.7086855468392745}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.766089 cos_to_last_merge=0.8743 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.874
[S14] round=46 local utility u=0.013493 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9989163785751596, 'loss_val': 0.022839691323766863, 'psi': 0.9981440172670002}-{'f1_val': 0.9951539120677446, 'auprc': 0.9989827658493566, 'loss_val': 0.03517349601863653, 'psi': 0.9966854535803894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=46 head_norm_before_train=1.544764 cos_to_last_merge=0.8814 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=46 local utility u=1.000000 metrics={'f1_val': 0.9934706406865853, 'auprc': 0.9951377026019139, 'loss_val': 0.05785325730734425, 'psi': 0.9941374654527168}-{'f1_val': 0.7107419620001181, 'auprc': 0.9040053731959524, 'loss_val': 0.4722375409846966, 'psi': 0.7880473264784518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=46 head_norm_before_train=1.779959 cos_to_last_merge=0.9367 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=46 local utility u=0.090265 metrics={'f1_val': 0.9406871627715536, 'auprc': 0.9938888517872064, 'loss_val': 0.23819490818162375, 'psi': 0.9619678383778147}-{'f1_val': 0.9350499768367542, 'auprc': 0.9908980463513561, 'loss_val': 0.37593000175587543, 'psi': 0.9573892046425949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=46 head_norm_before_train=1.625587 cos_to_last_merge=0.9344 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=46 local utility u=1.000000 metrics={'f1_val': 0.9017502402081197, 'auprc': 0.9770397735969534, 'loss_val': 0.25777346488185127, 'psi': 0.9318660535636532}-{'f1_val': 0.6574423959448903, 'auprc': 0.6964697367681546, 'loss_val': 1.1745764159167633, 'psi': 0.6730533322741961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=47 head_norm_before_train=1.567330 cos_to_last_merge=0.9282 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6389085158147805, 'auprc': 0.7531464687937719, 'loss_val': 1.1969353099199407, 'psi': 0.6846036970063771}-{'f1_val': 0.6470993421537093, 'auprc': 0.7537300343863957, 'loss_val': 1.0980233992991157, 'psi': 0.6897516190467838}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.168706 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9285482471549733, 'auprc': 0.998456277035357, 'loss_val': 0.1339372139489138, 'psi': 0.9565114591071269}-{'f1_val': 0.9728081154881955, 'auprc': 0.9986581073102052, 'loss_val': 0.09358688676636216, 'psi': 0.9831481122169994}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=2.019547 (no previous merge yet)
[S4] round=47 local utility u=0.169132 metrics={'f1_val': 0.9546791988949102, 'auprc': 0.9848063596523209, 'loss_val': 0.26699969055077205, 'psi': 0.9667300631978745}-{'f1_val': 0.9365389829603221, 'auprc': 0.9285547685882289, 'loss_val': 0.3276676203994081, 'psi': 0.9333452972114848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=47 head_norm_before_train=1.580274 cos_to_last_merge=0.7948 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=47 local utility u=0.946046 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9953330378640713, 'loss_val': 0.05929989702736329, 'psi': 0.9958448291312152}-{'f1_val': 0.7180678403276399, 'auprc': 0.9897418337360038, 'loss_val': 0.26590911297285424, 'psi': 0.8267374376909855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=47 head_norm_before_train=1.382470 cos_to_last_merge=0.8460 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.846
[S6] round=47 local utility u=0.386466 metrics={'f1_val': 0.9614783344370563, 'auprc': 0.9687235777969985, 'loss_val': 0.22247651139459027, 'psi': 0.9643764317810332}-{'f1_val': 0.8493597463478574, 'auprc': 0.9641232990007724, 'loss_val': 0.308895247397315, 'psi': 0.8952651674090234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=47 head_norm_before_train=1.402617 cos_to_last_merge=0.9458 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.946
[S7] round=47 local utility u=0.048476 metrics={'f1_val': 0.660202237708554, 'auprc': 0.8042584843314018, 'loss_val': 0.5165844004306185, 'psi': 0.7178247363576931}-{'f1_val': 0.6533700331820531, 'auprc': 0.7963430931180707, 'loss_val': 0.5487966196502517, 'psi': 0.7105592571564602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=47 head_norm_before_train=1.878065 cos_to_last_merge=0.7499 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.750
[S8] round=47 local utility u=0.001544 metrics={'f1_val': 0.9928938724649488, 'auprc': 0.9883588399471035, 'loss_val': 0.03525486758190602, 'psi': 0.9910798594578106}-{'f1_val': 0.9925380579155019, 'auprc': 0.9883909463378701, 'loss_val': 0.0363039579560504, 'psi': 0.9908792132844492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=47 head_norm_before_train=1.625049 cos_to_last_merge=0.9054 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.905
[S9] round=47 local utility u=0.000265 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988492748594473, 'loss_val': 0.022740739528990393, 'psi': 0.9980666439501652}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988512765077745, 'loss_val': 0.023277554760791873, 'psi': 0.998067444609496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=47 head_norm_before_train=1.763001 cos_to_last_merge=0.9532 (last merge round=15)
[S10] round=47 local utility u=0.001154 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9962613308120627, 'loss_val': 0.032458855992834, 'psi': 0.9958200772792921}-{'f1_val': 0.9955259082574451, 'auprc': 0.9961744626506917, 'loss_val': 0.03450542372021856, 'psi': 0.9957853300147437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=47 head_norm_before_train=2.174552 (no previous merge yet)
[S11] round=47 local utility u=0.000865 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979401712870359, 'loss_val': 0.02069986840363209, 'psi': 0.9972615783705616}-{'f1_val': 0.996567470639547, 'auprc': 0.9978919564978395, 'loss_val': 0.02083519181654034, 'psi': 0.997097264982864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=47 head_norm_before_train=1.635078 cos_to_last_merge=0.8426 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.843
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.637945259579213, 'auprc': 0.7814340512285436, 'loss_val': 0.7750249585734824, 'psi': 0.6953407762389452}-{'f1_val': 0.6532321719711008, 'auprc': 0.7670755094373355, 'loss_val': 0.7491216165535557, 'psi': 0.6987695069575948}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.778143 cos_to_last_merge=0.8731 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.873
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.937108613797811, 'auprc': 0.9986485232367807, 'loss_val': 0.12071788949613832, 'psi': 0.9617245775733989}-{'f1_val': 0.9976291097282272, 'auprc': 0.9989163785751596, 'loss_val': 0.022839691323766863, 'psi': 0.9981440172670002}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=1.553381 cos_to_last_merge=0.8806 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8185322936979965, 'auprc': 0.9150393217311654, 'loss_val': 0.3589116158106744, 'psi': 0.8571351049112641}-{'f1_val': 0.9934706406865853, 'auprc': 0.9951377026019139, 'loss_val': 0.05785325730734425, 'psi': 0.9941374654527168}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.788088 cos_to_last_merge=0.9359 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.936
[S16] round=47 local utility u=0.143140 metrics={'f1_val': 0.968240177492744, 'auprc': 0.9937339788004028, 'loss_val': 0.11676797141872851, 'psi': 0.9784376980158076}-{'f1_val': 0.9406871627715536, 'auprc': 0.9938888517872064, 'loss_val': 0.23819490818162375, 'psi': 0.9619678383778147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=47 head_norm_before_train=1.633885 cos_to_last_merge=0.9334 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6871081231260066, 'auprc': 0.8761809399160583, 'loss_val': 0.8535479833131563, 'psi': 0.7627372498420273}-{'f1_val': 0.9017502402081197, 'auprc': 0.9770397735969534, 'loss_val': 0.25777346488185127, 'psi': 0.9318660535636532}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.579167 cos_to_last_merge=0.9265 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=48 local utility u=0.552001 metrics={'f1_val': 0.7128158933628156, 'auprc': 0.7942977935661106, 'loss_val': 0.6598313483335803, 'psi': 0.7454086534441335}-{'f1_val': 0.6389085158147805, 'auprc': 0.7531464687937719, 'loss_val': 1.1969353099199407, 'psi': 0.6846036970063771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=48 head_norm_before_train=2.175320 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.8466886919888983, 'auprc': 0.9984837684100611, 'loss_val': 0.24296963776283304, 'psi': 0.9074067225573634}-{'f1_val': 0.9285482471549733, 'auprc': 0.998456277035357, 'loss_val': 0.1339372139489138, 'psi': 0.9565114591071269}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=2.023770 (no previous merge yet)
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9434685714885265, 'auprc': 0.957863624866334, 'loss_val': 0.29738127841805545, 'psi': 0.9492265928396495}-{'f1_val': 0.9546791988949102, 'auprc': 0.9848063596523209, 'loss_val': 0.26699969055077205, 'psi': 0.9667300631978745}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.591622 cos_to_last_merge=0.7943 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=48 local utility u=0.007001 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9984826249623744, 'loss_val': 0.054746926976309236, 'psi': 0.9971046639705363}-{'f1_val': 0.996186023309311, 'auprc': 0.9953330378640713, 'loss_val': 0.05929989702736329, 'psi': 0.9958448291312152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.392784 cos_to_last_merge=0.8439 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.844
[S6] round=48 local utility u=0.002497 metrics={'f1_val': 0.9597725357730009, 'auprc': 0.9658732670605586, 'loss_val': 0.19869722217514474, 'psi': 0.962212828288024}-{'f1_val': 0.9614783344370563, 'auprc': 0.9687235777969985, 'loss_val': 0.22247651139459027, 'psi': 0.9643764317810332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=48 head_norm_before_train=1.409940 cos_to_last_merge=0.9447 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.945
[S7] round=48 local utility u=0.148208 metrics={'f1_val': 0.672369585909546, 'auprc': 0.82883804762327, 'loss_val': 0.3669108087203704, 'psi': 0.7349569705950356}-{'f1_val': 0.660202237708554, 'auprc': 0.8042584843314018, 'loss_val': 0.5165844004306185, 'psi': 0.7178247363576931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=48 head_norm_before_train=1.887796 cos_to_last_merge=0.7491 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.749
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9825734264144133, 'auprc': 0.9988741543614084, 'loss_val': 0.055703855355895546, 'psi': 0.9890937175932113}-{'f1_val': 0.9928938724649488, 'auprc': 0.9883588399471035, 'loss_val': 0.03525486758190602, 'psi': 0.9910798594578106}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.634384 cos_to_last_merge=0.9043 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.904
[S9] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9988509139726024, 'loss_val': 0.023078486227619235, 'psi': 0.9975712444302993}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988492748594473, 'loss_val': 0.022740739528990393, 'psi': 0.9980666439501652}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=48 head_norm_before_train=1.773181 cos_to_last_merge=0.9522 (last merge round=15)
[S10] round=48 local utility u=0.000528 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9964046837420356, 'loss_val': 0.0305146680739232, 'psi': 0.9957456720638591}-{'f1_val': 0.9955259082574451, 'auprc': 0.9962613308120627, 'loss_val': 0.032458855992834, 'psi': 0.9958200772792921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=48 head_norm_before_train=2.179072 (no previous merge yet)
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979004876083662, 'loss_val': 0.021153110451124557, 'psi': 0.9971006774270748}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979401712870359, 'loss_val': 0.02069986840363209, 'psi': 0.9972615783705616}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.641751 cos_to_last_merge=0.8416 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.842
[S13] round=48 local utility u=0.039538 metrics={'f1_val': 0.6592065213934343, 'auprc': 0.7126923894050606, 'loss_val': 0.6172916363164513, 'psi': 0.6806008685980848}-{'f1_val': 0.637945259579213, 'auprc': 0.7814340512285436, 'loss_val': 0.7750249585734824, 'psi': 0.6953407762389452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=48 head_norm_before_train=1.786737 cos_to_last_merge=0.8726 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.873
[S14] round=48 local utility u=0.086774 metrics={'f1_val': 0.9568512698629685, 'auprc': 0.9988712522908781, 'loss_val': 0.06629426947862624, 'psi': 0.9736592628341324}-{'f1_val': 0.937108613797811, 'auprc': 0.9986485232367807, 'loss_val': 0.12071788949613832, 'psi': 0.9617245775733989}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=48 head_norm_before_train=1.563020 cos_to_last_merge=0.8797 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=48 local utility u=0.797857 metrics={'f1_val': 0.9949886418289325, 'auprc': 0.9906701442095003, 'loss_val': 0.04882892195663487, 'psi': 0.9932612427811597}-{'f1_val': 0.8185322936979965, 'auprc': 0.9150393217311654, 'loss_val': 0.3589116158106744, 'psi': 0.8571351049112641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=48 head_norm_before_train=1.794407 cos_to_last_merge=0.9351 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.935
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.8601461303811229, 'auprc': 0.9836093240979598, 'loss_val': 0.8365803505710836, 'psi': 0.9095314078678577}-{'f1_val': 0.968240177492744, 'auprc': 0.9937339788004028, 'loss_val': 0.11676797141872851, 'psi': 0.9784376980158076}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.639766 cos_to_last_merge=0.9324 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.932
[S17] round=48 local utility u=0.143957 metrics={'f1_val': 0.7042178535265728, 'auprc': 0.8835447823809076, 'loss_val': 0.6903847045001283, 'psi': 0.7759486250683068}-{'f1_val': 0.6871081231260066, 'auprc': 0.8761809399160583, 'loss_val': 0.8535479833131563, 'psi': 0.7627372498420273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=49 head_norm_before_train=1.591749 cos_to_last_merge=0.9247 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.925
[S2] round=49 local utility u=0.056260 metrics={'f1_val': 0.7172234865045196, 'auprc': 0.8303664284838954, 'loss_val': 0.6819620062873699, 'psi': 0.76248066329627}-{'f1_val': 0.7128158933628156, 'auprc': 0.7942977935661106, 'loss_val': 0.6598313483335803, 'psi': 0.7454086534441335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=49 head_norm_before_train=2.182433 (no previous merge yet)
[S3] round=49 local utility u=0.019062 metrics={'f1_val': 0.856888077712661, 'auprc': 0.9985955256221641, 'loss_val': 0.2663767044007477, 'psi': 0.9135710568764621}-{'f1_val': 0.8466886919888983, 'auprc': 0.9984837684100611, 'loss_val': 0.24296963776283304, 'psi': 0.9074067225573634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=49 head_norm_before_train=2.025593 (no previous merge yet)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9371506973283964, 'auprc': 0.9395920793001908, 'loss_val': 0.31286041144456306, 'psi': 0.9381272501171143}-{'f1_val': 0.9434685714885265, 'auprc': 0.957863624866334, 'loss_val': 0.29738127841805545, 'psi': 0.9492265928396495}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.600631 cos_to_last_merge=0.7938 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.991870608125553, 'loss_val': 0.0561997165339288, 'psi': 0.9943723727890537}-{'f1_val': 0.996186023309311, 'auprc': 0.9984826249623744, 'loss_val': 0.054746926976309236, 'psi': 0.9971046639705363}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.402230 cos_to_last_merge=0.8422 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.842
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.821309246151249, 'auprc': 0.9545551604754565, 'loss_val': 0.41258267938240956, 'psi': 0.8746076118809321}-{'f1_val': 0.9597725357730009, 'auprc': 0.9658732670605586, 'loss_val': 0.19869722217514474, 'psi': 0.962212828288024}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.414965 cos_to_last_merge=0.9439 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.944
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6301953595927028, 'auprc': 0.8017801250096809, 'loss_val': 0.5133406471716487, 'psi': 0.6988292657594941}-{'f1_val': 0.672369585909546, 'auprc': 0.82883804762327, 'loss_val': 0.3669108087203704, 'psi': 0.7349569705950356}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.896427 cos_to_last_merge=0.7479 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.748
[S8] round=49 local utility u=0.026904 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9882885479773942, 'loss_val': 0.034254208131154346, 'psi': 0.9912710157990755}-{'f1_val': 0.9825734264144133, 'auprc': 0.9988741543614084, 'loss_val': 0.055703855355895546, 'psi': 0.9890937175932113}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=49 head_norm_before_train=1.644121 cos_to_last_merge=0.9033 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.903
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9946367966381642, 'auprc': 0.9988518766673533, 'loss_val': 0.027918254958654548, 'psi': 0.9963228286498398}-{'f1_val': 0.9967181314020974, 'auprc': 0.9988509139726024, 'loss_val': 0.023078486227619235, 'psi': 0.9975712444302993}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.784211 cos_to_last_merge=0.9513 (last merge round=15)
[S10] round=49 local utility u=0.000530 metrics={'f1_val': 0.9953063309450747, 'auprc': 0.9964326473324047, 'loss_val': 0.0295391284592213, 'psi': 0.9957568575000068}-{'f1_val': 0.9953063309450747, 'auprc': 0.9964046837420356, 'loss_val': 0.0305146680739232, 'psi': 0.9957456720638591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=49 head_norm_before_train=2.183602 (no previous merge yet)
[S11] round=49 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978586986107195, 'loss_val': 0.021386077487986523, 'psi': 0.9970839618280161}-{'f1_val': 0.996567470639547, 'auprc': 0.9979004876083662, 'loss_val': 0.021153110451124557, 'psi': 0.9971006774270748}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=49 head_norm_before_train=1.648403 cos_to_last_merge=0.8407 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.841
[S13] round=49 local utility u=0.030842 metrics={'f1_val': 0.6480494309740217, 'auprc': 0.7770613195110652, 'loss_val': 0.6817714682778099, 'psi': 0.699654186388839}-{'f1_val': 0.6592065213934343, 'auprc': 0.7126923894050606, 'loss_val': 0.6172916363164513, 'psi': 0.6806008685980848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=49 head_norm_before_train=1.794655 cos_to_last_merge=0.8720 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.872
[S14] round=49 local utility u=0.141655 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9988727780762627, 'loss_val': 0.025025037583670796, 'psi': 0.9978635841905974}-{'f1_val': 0.9568512698629685, 'auprc': 0.9988712522908781, 'loss_val': 0.06629426947862624, 'psi': 0.9736592628341324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=49 head_norm_before_train=1.573892 cos_to_last_merge=0.8784 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.8798015743478057, 'auprc': 0.9252829073744366, 'loss_val': 0.30278558515421283, 'psi': 0.8979941075584581}-{'f1_val': 0.9949886418289325, 'auprc': 0.9906701442095003, 'loss_val': 0.04882892195663487, 'psi': 0.9932612427811597}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=1.801039 cos_to_last_merge=0.9342 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=49 local utility u=0.496515 metrics={'f1_val': 0.9150223412032719, 'auprc': 0.9928233526493047, 'loss_val': 0.2004504724748929, 'psi': 0.946142745781685}-{'f1_val': 0.8601461303811229, 'auprc': 0.9836093240979598, 'loss_val': 0.8365803505710836, 'psi': 0.9095314078678577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=49 head_norm_before_train=1.647123 cos_to_last_merge=0.9314 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.931
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6935860718915305, 'auprc': 0.8886990861650677, 'loss_val': 0.7769222117461569, 'psi': 0.7716312776009454}-{'f1_val': 0.7042178535265728, 'auprc': 0.8835447823809076, 'loss_val': 0.6903847045001283, 'psi': 0.7759486250683068}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=1.603493 cos_to_last_merge=0.9232 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.923
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.71632705657663, 'auprc': 0.8023710993519437, 'loss_val': 0.7580229939564217, 'psi': 0.7507446736867556}-{'f1_val': 0.7172234865045196, 'auprc': 0.8303664284838954, 'loss_val': 0.6819620062873699, 'psi': 0.76248066329627}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=50 head_norm_before_train=2.191115 (no previous merge yet)
[S3] round=50 local utility u=0.145649 metrics={'f1_val': 0.9001110128490581, 'auprc': 0.9986069027205033, 'loss_val': 0.23445066256184846, 'psi': 0.9395093687976361}-{'f1_val': 0.856888077712661, 'auprc': 0.9985955256221641, 'loss_val': 0.2663767044007477, 'psi': 0.9135710568764621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=50 head_norm_before_train=2.022992 (no previous merge yet)
[S4] round=50 local utility u=0.105587 metrics={'f1_val': 0.9443341524248903, 'auprc': 0.984030319381717, 'loss_val': 0.2781026921477406, 'psi': 0.960212619207621}-{'f1_val': 0.9371506973283964, 'auprc': 0.9395920793001908, 'loss_val': 0.31286041144456306, 'psi': 0.9381272501171143}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=50 head_norm_before_train=1.609616 cos_to_last_merge=0.7934 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=50 local utility u=0.012784 metrics={'f1_val': 0.996186023309311, 'auprc': 0.998391822104356, 'loss_val': 0.05106963896132989, 'psi': 0.997068342827329}-{'f1_val': 0.9960402158980539, 'auprc': 0.991870608125553, 'loss_val': 0.0561997165339288, 'psi': 0.9943723727890537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=50 head_norm_before_train=1.409280 cos_to_last_merge=0.8407 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.841
[S6] round=50 local utility u=0.552867 metrics={'f1_val': 0.9624144983160565, 'auprc': 0.9700489568283044, 'loss_val': 0.19996173796509772, 'psi': 0.9654682817209557}-{'f1_val': 0.821309246151249, 'auprc': 0.9545551604754565, 'loss_val': 0.41258267938240956, 'psi': 0.8746076118809321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=50 head_norm_before_train=1.421940 cos_to_last_merge=0.9429 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.943
[S7] round=50 local utility u=0.168822 metrics={'f1_val': 0.6660553604174846, 'auprc': 0.8120283491025139, 'loss_val': 0.4216016457171881, 'psi': 0.7244445558914963}-{'f1_val': 0.6301953595927028, 'auprc': 0.8017801250096809, 'loss_val': 0.5133406471716487, 'psi': 0.6988292657594941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=50 head_norm_before_train=1.904700 cos_to_last_merge=0.7472 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.747
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9846769408645597, 'auprc': 0.9988823313231683, 'loss_val': 0.05119620229546191, 'psi': 0.9903590970480032}-{'f1_val': 0.9932593276801964, 'auprc': 0.9882885479773942, 'loss_val': 0.034254208131154346, 'psi': 0.9912710157990755}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.653400 cos_to_last_merge=0.9023 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.902
[S9] round=50 local utility u=0.005635 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9957166424530248, 'loss_val': 0.022228702832065284, 'psi': 0.9965673361398448}-{'f1_val': 0.9946367966381642, 'auprc': 0.9988518766673533, 'loss_val': 0.027918254958654548, 'psi': 0.9963228286498398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=50 head_norm_before_train=1.794098 cos_to_last_merge=0.9504 (last merge round=15)
[S10] round=50 local utility u=0.000280 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9963812597418479, 'loss_val': 0.03014205603130466, 'psi': 0.9958680488512062}-{'f1_val': 0.9953063309450747, 'auprc': 0.9964326473324047, 'loss_val': 0.0295391284592213, 'psi': 0.9957568575000068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=50 head_norm_before_train=2.189830 (no previous merge yet)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9693509315105514, 'auprc': 0.9978928130400124, 'loss_val': 0.0867837530426242, 'psi': 0.9807676841223358}-{'f1_val': 0.996567470639547, 'auprc': 0.9978586986107195, 'loss_val': 0.021386077487986523, 'psi': 0.9970839618280161}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.654903 cos_to_last_merge=0.8396 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.840
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6258374312841646, 'auprc': 0.7432977360360151, 'loss_val': 0.8340936660545347, 'psi': 0.6728215531849049}-{'f1_val': 0.6480494309740217, 'auprc': 0.7770613195110652, 'loss_val': 0.6817714682778099, 'psi': 0.699654186388839}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.802803 cos_to_last_merge=0.8712 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.871
[S14] round=50 local utility u=0.000000 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9990361042213878, 'loss_val': 0.03060311184162866, 'psi': 0.9978409193422115}-{'f1_val': 0.9971907882668205, 'auprc': 0.9988727780762627, 'loss_val': 0.025025037583670796, 'psi': 0.9978635841905974}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=50 head_norm_before_train=1.583750 cos_to_last_merge=0.8773 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.877
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.8090923624858963, 'auprc': 0.90470392584148, 'loss_val': 0.3919340190131312, 'psi': 0.8473369878281298}-{'f1_val': 0.8798015743478057, 'auprc': 0.9252829073744366, 'loss_val': 0.30278558515421283, 'psi': 0.8979941075584581}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.808336 cos_to_last_merge=0.9335 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.934
[S16] round=50 local utility u=0.310163 metrics={'f1_val': 0.9924684365565463, 'auprc': 0.9906473152641246, 'loss_val': 0.038272203940817026, 'psi': 0.9917399880395776}-{'f1_val': 0.9150223412032719, 'auprc': 0.9928233526493047, 'loss_val': 0.2004504724748929, 'psi': 0.946142745781685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=50 head_norm_before_train=1.654568 cos_to_last_merge=0.9305 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.930
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6891329459106804, 'auprc': 0.8808244607707002, 'loss_val': 0.8435505176685636, 'psi': 0.7658095518546884}-{'f1_val': 0.6935860718915305, 'auprc': 0.8886990861650677, 'loss_val': 0.7769222117461569, 'psi': 0.7716312776009454}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.615556 cos_to_last_merge=0.9216 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.922
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.6298231016410883, 'auprc': 0.73473223253288, 'loss_val': 1.2980624381681538, 'psi': 0.6717867539978051}-{'f1_val': 0.71632705657663, 'auprc': 0.8023710993519437, 'loss_val': 0.7580229939564217, 'psi': 0.7507446736867556}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=51 head_norm_before_train=2.199790 (no previous merge yet)
[S3] round=51 local utility u=0.041583 metrics={'f1_val': 0.9037737328175796, 'auprc': 0.9975840942071118, 'loss_val': 0.17019354596488226, 'psi': 0.9412978773733924}-{'f1_val': 0.9001110128490581, 'auprc': 0.9986069027205033, 'loss_val': 0.23445066256184846, 'psi': 0.9395093687976361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=51 head_norm_before_train=2.018269 (no previous merge yet)
[S4] round=51 local utility u=0.013459 metrics={'f1_val': 0.9543425578985899, 'auprc': 0.9747134001983765, 'loss_val': 0.28328521032454645, 'psi': 0.9624908948185045}-{'f1_val': 0.9443341524248903, 'auprc': 0.984030319381717, 'loss_val': 0.2781026921477406, 'psi': 0.960212619207621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=51 head_norm_before_train=1.620229 cos_to_last_merge=0.7930 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9898699945905328, 'loss_val': 0.07606593111412908, 'psi': 0.9935721273750455}-{'f1_val': 0.996186023309311, 'auprc': 0.998391822104356, 'loss_val': 0.05106963896132989, 'psi': 0.997068342827329}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.415025 cos_to_last_merge=0.8395 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.839
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.9473028541202289, 'auprc': 0.9697984082080391, 'loss_val': 0.22800494824024004, 'psi': 0.956301075755353}-{'f1_val': 0.9624144983160565, 'auprc': 0.9700489568283044, 'loss_val': 0.19996173796509772, 'psi': 0.9654682817209557}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.433449 cos_to_last_merge=0.9414 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.941
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.5551606906336641, 'auprc': 0.7851701122337992, 'loss_val': 0.9192762913813655, 'psi': 0.6471644592737182}-{'f1_val': 0.6660553604174846, 'auprc': 0.8120283491025139, 'loss_val': 0.4216016457171881, 'psi': 0.7244445558914963}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.913108 cos_to_last_merge=0.7465 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.746
[S8] round=51 local utility u=0.012089 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9985890248666234, 'loss_val': 0.04303725318005914, 'psi': 0.9919316810517982}-{'f1_val': 0.9846769408645597, 'auprc': 0.9988823313231683, 'loss_val': 0.05119620229546191, 'psi': 0.9903590970480032}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=51 head_norm_before_train=1.660851 cos_to_last_merge=0.9012 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.901
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9954695508442518, 'auprc': 0.9988564119642517, 'loss_val': 0.02523231865226613, 'psi': 0.9968242952922518}-{'f1_val': 0.9971344652643916, 'auprc': 0.9957166424530248, 'loss_val': 0.022228702832065284, 'psi': 0.9965673361398448}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.802539 cos_to_last_merge=0.9495 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.950
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961218669866725, 'loss_val': 0.03227873228444763, 'psi': 0.9955108276403279}-{'f1_val': 0.9955259082574451, 'auprc': 0.9963812597418479, 'loss_val': 0.03014205603130466, 'psi': 0.9958680488512062}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=51 head_norm_before_train=2.192943 (no previous merge yet)
[S11] round=51 local utility u=0.113453 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974184104112747, 'loss_val': 0.021754709633580088, 'psi': 0.9969078465482382}-{'f1_val': 0.9693509315105514, 'auprc': 0.9978928130400124, 'loss_val': 0.0867837530426242, 'psi': 0.9807676841223358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=51 head_norm_before_train=1.662142 cos_to_last_merge=0.8386 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=51 local utility u=0.129123 metrics={'f1_val': 0.6569343873104255, 'auprc': 0.7225313396806292, 'loss_val': 0.7001302130682555, 'psi': 0.6831731682585069}-{'f1_val': 0.6258374312841646, 'auprc': 0.7432977360360151, 'loss_val': 0.8340936660545347, 'psi': 0.6728215531849049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=51 head_norm_before_train=1.809700 cos_to_last_merge=0.8702 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.870
[S14] round=51 local utility u=0.003373 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9990174918004997, 'loss_val': 0.02354397371615172, 'psi': 0.9978078050253831}-{'f1_val': 0.9970441294227608, 'auprc': 0.9990361042213878, 'loss_val': 0.03060311184162866, 'psi': 0.9978409193422115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=51 head_norm_before_train=1.591769 cos_to_last_merge=0.8763 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=51 local utility u=0.841898 metrics={'f1_val': 0.991132104788312, 'auprc': 0.9896625111768657, 'loss_val': 0.05525210018308151, 'psi': 0.9905442673437335}-{'f1_val': 0.8090923624858963, 'auprc': 0.90470392584148, 'loss_val': 0.3919340190131312, 'psi': 0.8473369878281298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=51 head_norm_before_train=1.814065 cos_to_last_merge=0.9328 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.933
[S16] round=51 local utility u=0.004683 metrics={'f1_val': 0.991800171236367, 'auprc': 0.9956535467513097, 'loss_val': 0.039915758597063304, 'psi': 0.9933415214423441}-{'f1_val': 0.9924684365565463, 'auprc': 0.9906473152641246, 'loss_val': 0.038272203940817026, 'psi': 0.9917399880395776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=51 head_norm_before_train=1.661999 cos_to_last_merge=0.9292 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=51 local utility u=0.096795 metrics={'f1_val': 0.6945042260779885, 'auprc': 0.8926716313192895, 'loss_val': 0.7177303143751027, 'psi': 0.7737711881745089}-{'f1_val': 0.6891329459106804, 'auprc': 0.8808244607707002, 'loss_val': 0.8435505176685636, 'psi': 0.7658095518546884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=52 head_norm_before_train=1.626249 cos_to_last_merge=0.9199 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.920
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6274682505209377, 'auprc': 0.7522868229608578, 'loss_val': 1.3699200997666172, 'psi': 0.6773956794969058}-{'f1_val': 0.6298231016410883, 'auprc': 0.73473223253288, 'loss_val': 1.2980624381681538, 'psi': 0.6717867539978051}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.207927 (no previous merge yet)
[S3] round=52 local utility u=0.268406 metrics={'f1_val': 0.9758313685171578, 'auprc': 0.9984844619022354, 'loss_val': 0.06842869836718257, 'psi': 0.9848926058711888}-{'f1_val': 0.9037737328175796, 'auprc': 0.9975840942071118, 'loss_val': 0.17019354596488226, 'psi': 0.9412978773733924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=52 head_norm_before_train=2.020950 (no previous merge yet)
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9421773227325922, 'auprc': 0.9609316795917925, 'loss_val': 0.2979213962423133, 'psi': 0.9496790654762723}-{'f1_val': 0.9543425578985899, 'auprc': 0.9747134001983765, 'loss_val': 0.28328521032454645, 'psi': 0.9624908948185045}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.629363 cos_to_last_merge=0.7925 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=52 local utility u=0.029234 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9984774578129285, 'loss_val': 0.04429507243178532, 'psi': 0.997102597110758}-{'f1_val': 0.9960402158980539, 'auprc': 0.9898699945905328, 'loss_val': 0.07606593111412908, 'psi': 0.9935721273750455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=52 head_norm_before_train=1.421635 cos_to_last_merge=0.8376 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.838
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6927537945867845, 'auprc': 0.8118366646666481, 'loss_val': 0.666874321986133, 'psi': 0.74038694261873}-{'f1_val': 0.9473028541202289, 'auprc': 0.9697984082080391, 'loss_val': 0.22800494824024004, 'psi': 0.956301075755353}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.441413 cos_to_last_merge=0.9403 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=52 local utility u=0.231794 metrics={'f1_val': 0.5996979593204984, 'auprc': 0.7940479847299464, 'loss_val': 0.7495448127113494, 'psi': 0.6774379694842776}-{'f1_val': 0.5551606906336641, 'auprc': 0.7851701122337992, 'loss_val': 0.9192762913813655, 'psi': 0.6471644592737182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=52 head_norm_before_train=1.918099 cos_to_last_merge=0.7461 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.746
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.992723354821866, 'auprc': 0.9870130715581604, 'loss_val': 0.042483120612711346, 'psi': 0.9904392415163837}-{'f1_val': 0.9874934518419147, 'auprc': 0.9985890248666234, 'loss_val': 0.04303725318005914, 'psi': 0.9919316810517982}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=1.666491 cos_to_last_merge=0.9005 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.901
[S9] round=52 local utility u=0.005519 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9988571338724278, 'loss_val': 0.02168867403673295, 'psi': 0.9975737323902295}-{'f1_val': 0.9954695508442518, 'auprc': 0.9988564119642517, 'loss_val': 0.02523231865226613, 'psi': 0.9968242952922518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=52 head_norm_before_train=1.812030 cos_to_last_merge=0.9487 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=52 local utility u=0.003389 metrics={'f1_val': 0.9955259082574451, 'auprc': 0.9964058419851766, 'loss_val': 0.02888790104972032, 'psi': 0.9958778817485376}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961218669866725, 'loss_val': 0.03227873228444763, 'psi': 0.9955108276403279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=52 head_norm_before_train=2.195730 (no previous merge yet)
[S11] round=52 local utility u=0.001293 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9975701993156505, 'loss_val': 0.021073672230008996, 'psi': 0.9971135895820075}-{'f1_val': 0.996567470639547, 'auprc': 0.9974184104112747, 'loss_val': 0.021754709633580088, 'psi': 0.9969078465482382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=52 head_norm_before_train=1.668065 cos_to_last_merge=0.8378 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.838
[S13] round=52 local utility u=0.155989 metrics={'f1_val': 0.6759519608941955, 'auprc': 0.7745874404446481, 'loss_val': 0.6584268458400399, 'psi': 0.7154061527143766}-{'f1_val': 0.6569343873104255, 'auprc': 0.7225313396806292, 'loss_val': 0.7001302130682555, 'psi': 0.6831731682585069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=52 head_norm_before_train=1.818994 cos_to_last_merge=0.8691 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.869
[S14] round=52 local utility u=0.000448 metrics={'f1_val': 0.9970013471753054, 'auprc': 0.9990186186554872, 'loss_val': 0.022651012041662262, 'psi': 0.9978082557673781}-{'f1_val': 0.9970013471753054, 'auprc': 0.9990174918004997, 'loss_val': 0.02354397371615172, 'psi': 0.9978078050253831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=52 head_norm_before_train=1.599330 cos_to_last_merge=0.8755 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.8926082546797218, 'auprc': 0.9798727600542945, 'loss_val': 0.2464876564866717, 'psi': 0.9275140568295509}-{'f1_val': 0.991132104788312, 'auprc': 0.9896625111768657, 'loss_val': 0.05525210018308151, 'psi': 0.9905442673437335}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=52 head_norm_before_train=1.820064 cos_to_last_merge=0.9322 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.8536652141634153, 'auprc': 0.9737655236240308, 'loss_val': 0.6054113896756786, 'psi': 0.9017053379476615}-{'f1_val': 0.991800171236367, 'auprc': 0.9956535467513097, 'loss_val': 0.039915758597063304, 'psi': 0.9933415214423441}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.669539 cos_to_last_merge=0.9280 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.928
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6869945567306468, 'auprc': 0.8212741045528326, 'loss_val': 0.9892185536604656, 'psi': 0.7407063758595211}-{'f1_val': 0.6945042260779885, 'auprc': 0.8926716313192895, 'loss_val': 0.7177303143751027, 'psi': 0.7737711881745089}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.636226 cos_to_last_merge=0.9185 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.918
[S2] round=53 local utility u=0.668616 metrics={'f1_val': 0.7170399300683525, 'auprc': 0.8029138423381882, 'loss_val': 0.7219993764540705, 'psi': 0.7513894949762867}-{'f1_val': 0.6274682505209377, 'auprc': 0.7522868229608578, 'loss_val': 1.3699200997666172, 'psi': 0.6773956794969058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=53 head_norm_before_train=2.215538 (no previous merge yet)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9717560599514535, 'auprc': 0.9986500378924013, 'loss_val': 0.07084380732617941, 'psi': 0.9825136511278326}-{'f1_val': 0.9758313685171578, 'auprc': 0.9984844619022354, 'loss_val': 0.06842869836718257, 'psi': 0.9848926058711888}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=2.024944 (no previous merge yet)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9411100873231776, 'auprc': 0.9507179912832637, 'loss_val': 0.3013511609422308, 'psi': 0.9449532489072121}-{'f1_val': 0.9421773227325922, 'auprc': 0.9609316795917925, 'loss_val': 0.2979213962423133, 'psi': 0.9496790654762723}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.636561 cos_to_last_merge=0.7921 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9935649471130396, 'loss_val': 0.04373680557373388, 'psi': 0.9950501083840482}-{'f1_val': 0.996186023309311, 'auprc': 0.9984774578129285, 'loss_val': 0.04429507243178532, 'psi': 0.997102597110758}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.427012 cos_to_last_merge=0.8358 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.836
[S6] round=53 local utility u=0.729907 metrics={'f1_val': 0.8235981779125158, 'auprc': 0.9596736414156799, 'loss_val': 0.43563845766241766, 'psi': 0.8780283633137814}-{'f1_val': 0.6927537945867845, 'auprc': 0.8118366646666481, 'loss_val': 0.666874321986133, 'psi': 0.74038694261873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=53 head_norm_before_train=1.446620 cos_to_last_merge=0.9396 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.940
[S7] round=53 local utility u=0.526365 metrics={'f1_val': 0.6766909448803256, 'auprc': 0.8446803818327215, 'loss_val': 0.31066903685081815, 'psi': 0.743886719661284}-{'f1_val': 0.5996979593204984, 'auprc': 0.7940479847299464, 'loss_val': 0.7495448127113494, 'psi': 0.6774379694842776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=53 head_norm_before_train=1.924729 cos_to_last_merge=0.7455 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.746
[S8] round=53 local utility u=0.008064 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9912849469333799, 'loss_val': 0.03587576062507491, 'psi': 0.9918185229914189}-{'f1_val': 0.992723354821866, 'auprc': 0.9870130715581604, 'loss_val': 0.042483120612711346, 'psi': 0.9904392415163837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=53 head_norm_before_train=1.673096 cos_to_last_merge=0.8998 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.900
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9957191976252904, 'loss_val': 0.021294336963013742, 'psi': 0.9965683582087511}-{'f1_val': 0.9967181314020974, 'auprc': 0.9988571338724278, 'loss_val': 0.02168867403673295, 'psi': 0.9975737323902295}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.821959 cos_to_last_merge=0.9480 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9963080587863711, 'loss_val': 0.029105138416307387, 'psi': 0.9955853043602074}-{'f1_val': 0.9955259082574451, 'auprc': 0.9964058419851766, 'loss_val': 0.02888790104972032, 'psi': 0.9958778817485376}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=2.200603 (no previous merge yet)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975601526490244, 'loss_val': 0.020401248516179284, 'psi': 0.9969645434433381}-{'f1_val': 0.9968091830929121, 'auprc': 0.9975701993156505, 'loss_val': 0.021073672230008996, 'psi': 0.9971135895820075}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.672697 cos_to_last_merge=0.8371 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.837
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6509193597138073, 'auprc': 0.741715412330821, 'loss_val': 0.7709664061950791, 'psi': 0.6872377807606128}-{'f1_val': 0.6759519608941955, 'auprc': 0.7745874404446481, 'loss_val': 0.6584268458400399, 'psi': 0.7154061527143766}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.827651 cos_to_last_merge=0.8682 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=53 local utility u=0.001394 metrics={'f1_val': 0.997286915407786, 'auprc': 0.9990219487730434, 'loss_val': 0.02158592200230479, 'psi': 0.997980928753889}-{'f1_val': 0.9970013471753054, 'auprc': 0.9990186186554872, 'loss_val': 0.022651012041662262, 'psi': 0.9978082557673781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=53 head_norm_before_train=1.605908 cos_to_last_merge=0.8750 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.8735405858020339, 'auprc': 0.9659415058720617, 'loss_val': 0.28304089846369984, 'psi': 0.910500953830045}-{'f1_val': 0.8926082546797218, 'auprc': 0.9798727600542945, 'loss_val': 0.2464876564866717, 'psi': 0.9275140568295509}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.826129 cos_to_last_merge=0.9316 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.932
[S16] round=53 local utility u=0.711808 metrics={'f1_val': 0.9906746390918988, 'auprc': 0.9865291019939959, 'loss_val': 0.0421436430951846, 'psi': 0.9890164242527376}-{'f1_val': 0.8536652141634153, 'auprc': 0.9737655236240308, 'loss_val': 0.6054113896756786, 'psi': 0.9017053379476615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=53 head_norm_before_train=1.679766 cos_to_last_merge=0.9266 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=53 local utility u=0.557214 metrics={'f1_val': 0.74757491155436, 'auprc': 0.921708191854749, 'loss_val': 0.5395749259350041, 'psi': 0.8172282236745156}-{'f1_val': 0.6869945567306468, 'auprc': 0.8212741045528326, 'loss_val': 0.9892185536604656, 'psi': 0.7407063758595211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=54 head_norm_before_train=1.645784 cos_to_last_merge=0.9173 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.917
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.7219327446543582, 'auprc': 0.7758870902622996, 'loss_val': 0.7951488687529712, 'psi': 0.7435144828975349}-{'f1_val': 0.7170399300683525, 'auprc': 0.8029138423381882, 'loss_val': 0.7219993764540705, 'psi': 0.7513894949762867}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=2.222324 (no previous merge yet)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.8520745436490433, 'auprc': 0.9979583934995432, 'loss_val': 0.24975374809527648, 'psi': 0.9104280835892433}-{'f1_val': 0.9717560599514535, 'auprc': 0.9986500378924013, 'loss_val': 0.07084380732617941, 'psi': 0.9825136511278326}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=2.026257 (no previous merge yet)
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9406076690295697, 'auprc': 0.9363850455821903, 'loss_val': 0.3079573796229388, 'psi': 0.938918619650618}-{'f1_val': 0.9411100873231776, 'auprc': 0.9507179912832637, 'loss_val': 0.3013511609422308, 'psi': 0.9449532489072121}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.638954 cos_to_last_merge=0.7921 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9912573398471618, 'loss_val': 0.04494269509080164, 'psi': 0.9941270654776971}-{'f1_val': 0.9960402158980539, 'auprc': 0.9935649471130396, 'loss_val': 0.04373680557373388, 'psi': 0.9950501083840482}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.429910 cos_to_last_merge=0.8350 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.835
[S6] round=54 local utility u=0.111792 metrics={'f1_val': 0.8241815185247658, 'auprc': 0.9746584752053322, 'loss_val': 0.260509160057878, 'psi': 0.8843723011969924}-{'f1_val': 0.8235981779125158, 'auprc': 0.9596736414156799, 'loss_val': 0.43563845766241766, 'psi': 0.8780283633137814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=54 head_norm_before_train=1.450864 cos_to_last_merge=0.9391 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.5981412193557565, 'auprc': 0.7942499095738327, 'loss_val': 0.7265228106533979, 'psi': 0.6765846954429869}-{'f1_val': 0.6766909448803256, 'auprc': 0.8446803818327215, 'loss_val': 0.31066903685081815, 'psi': 0.743886719661284}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.932282 cos_to_last_merge=0.7444 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.744
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9686898996127598, 'auprc': 0.9988572127528752, 'loss_val': 0.09554356141609918, 'psi': 0.9807568248688059}-{'f1_val': 0.992174240363445, 'auprc': 0.9912849469333799, 'loss_val': 0.03587576062507491, 'psi': 0.9918185229914189}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=1.679977 cos_to_last_merge=0.8991 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=54 local utility u=0.006290 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9987866657110691, 'loss_val': 0.02037894152634572, 'psi': 0.9980416002908139}-{'f1_val': 0.9971344652643916, 'auprc': 0.9957191976252904, 'loss_val': 0.021294336963013742, 'psi': 0.9965683582087511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=54 head_norm_before_train=1.831979 cos_to_last_merge=0.9474 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958852055594433, 'loss_val': 0.029734827185878873, 'psi': 0.9954161630694363}-{'f1_val': 0.9951034680760983, 'auprc': 0.9963080587863711, 'loss_val': 0.029105138416307387, 'psi': 0.9955853043602074}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=54 head_norm_before_train=2.207008 (no previous merge yet)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9976190985578202, 'loss_val': 0.020715809032700993, 'psi': 0.9969881218068564}-{'f1_val': 0.996567470639547, 'auprc': 0.9975601526490244, 'loss_val': 0.020401248516179284, 'psi': 0.9969645434433381}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.676531 cos_to_last_merge=0.8366 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.837
[S13] round=54 local utility u=0.409567 metrics={'f1_val': 0.7539578240214689, 'auprc': 0.7454890868045624, 'loss_val': 0.5813845117637654, 'psi': 0.7505703291347063}-{'f1_val': 0.6509193597138073, 'auprc': 0.741715412330821, 'loss_val': 0.7709664061950791, 'psi': 0.6872377807606128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=54 head_norm_before_train=1.833464 cos_to_last_merge=0.8678 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=54 local utility u=0.000666 metrics={'f1_val': 0.9974544106971202, 'auprc': 0.9990283489911332, 'loss_val': 0.02127753012941578, 'psi': 0.9980839860147254}-{'f1_val': 0.997286915407786, 'auprc': 0.9990219487730434, 'loss_val': 0.02158592200230479, 'psi': 0.997980928753889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=54 head_norm_before_train=1.614975 cos_to_last_merge=0.8740 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=54 local utility u=0.032130 metrics={'f1_val': 0.8975238940039943, 'auprc': 0.9397975360785, 'loss_val': 0.28424792504856755, 'psi': 0.9144333508337965}-{'f1_val': 0.8735405858020339, 'auprc': 0.9659415058720617, 'loss_val': 0.28304089846369984, 'psi': 0.910500953830045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=54 head_norm_before_train=1.832817 cos_to_last_merge=0.9309 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.931
[S16] round=54 local utility u=0.008127 metrics={'f1_val': 0.9904346065396044, 'auprc': 0.9940611089401199, 'loss_val': 0.04704473656483499, 'psi': 0.9918852074998106}-{'f1_val': 0.9906746390918988, 'auprc': 0.9865291019939959, 'loss_val': 0.0421436430951846, 'psi': 0.9890164242527376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=54 head_norm_before_train=1.689226 cos_to_last_merge=0.9255 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.7406350767978559, 'auprc': 0.9203493514744352, 'loss_val': 0.5905784814584223, 'psi': 0.8125207866684876}-{'f1_val': 0.74757491155436, 'auprc': 0.921708191854749, 'loss_val': 0.5395749259350041, 'psi': 0.8172282236745156}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=1.655529 cos_to_last_merge=0.9162 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.916
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.7235163479895979, 'auprc': 0.7756958796079725, 'loss_val': 0.8254952951129658, 'psi': 0.7443881606369478}-{'f1_val': 0.7219327446543582, 'auprc': 0.7758870902622996, 'loss_val': 0.7951488687529712, 'psi': 0.7435144828975349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=2.228764 (no previous merge yet)
[S3] round=55 local utility u=0.001368 metrics={'f1_val': 0.8525950267824309, 'auprc': 0.9984490454378313, 'loss_val': 0.25161204226893774, 'psi': 0.9109366342445911}-{'f1_val': 0.8520745436490433, 'auprc': 0.9979583934995432, 'loss_val': 0.24975374809527648, 'psi': 0.9104280835892433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=55 head_norm_before_train=2.025902 (no previous merge yet)
[S4] round=55 local utility u=0.013489 metrics={'f1_val': 0.9419447737855475, 'auprc': 0.9410384462959873, 'loss_val': 0.3029620587293704, 'psi': 0.9415822427897234}-{'f1_val': 0.9406076690295697, 'auprc': 0.9363850455821903, 'loss_val': 0.3079573796229388, 'psi': 0.938918619650618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=55 head_norm_before_train=1.645231 cos_to_last_merge=0.7918 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=55 local utility u=0.007705 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9945572596769738, 'loss_val': 0.03943192411115193, 'psi': 0.9954470334096219}-{'f1_val': 0.9960402158980539, 'auprc': 0.9912573398471618, 'loss_val': 0.04494269509080164, 'psi': 0.9941270654776971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=55 head_norm_before_train=1.436425 cos_to_last_merge=0.8339 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.834
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.5967753082415062, 'auprc': 0.7845616122884964, 'loss_val': 0.9031052301591413, 'psi': 0.6718898298603022}-{'f1_val': 0.8241815185247658, 'auprc': 0.9746584752053322, 'loss_val': 0.260509160057878, 'psi': 0.8843723011969924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.453537 cos_to_last_merge=0.9386 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.939
[S7] round=55 local utility u=0.224122 metrics={'f1_val': 0.6322986400749457, 'auprc': 0.8051302585198468, 'loss_val': 0.5158647729230188, 'psi': 0.7014312874529062}-{'f1_val': 0.5981412193557565, 'auprc': 0.7942499095738327, 'loss_val': 0.7265228106533979, 'psi': 0.6765846954429869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=55 head_norm_before_train=1.940331 cos_to_last_merge=0.7432 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.743
[S8] round=55 local utility u=0.088308 metrics={'f1_val': 0.9932593276801964, 'auprc': 0.9875887262892298, 'loss_val': 0.032539252227363015, 'psi': 0.9909910871238097}-{'f1_val': 0.9686898996127598, 'auprc': 0.9988572127528752, 'loss_val': 0.09554356141609918, 'psi': 0.9807568248688059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=55 head_norm_before_train=1.686443 cos_to_last_merge=0.8985 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.899
[S9] round=55 local utility u=0.000208 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9988546971213608, 'loss_val': 0.020166567329642157, 'psi': 0.9980688128549305}-{'f1_val': 0.9975448900106438, 'auprc': 0.9987866657110691, 'loss_val': 0.02037894152634572, 'psi': 0.9980416002908139}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=55 head_norm_before_train=1.841902 cos_to_last_merge=0.9467 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.947
[S10] round=55 local utility u=0.000226 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958795572576322, 'loss_val': 0.029265226535496326, 'psi': 0.9954139037487119}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958852055594433, 'loss_val': 0.029734827185878873, 'psi': 0.9954161630694363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=55 head_norm_before_train=2.213855 (no previous merge yet)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9946437926553063, 'auprc': 0.997614940565126, 'loss_val': 0.024715737450623058, 'psi': 0.9958322518192342}-{'f1_val': 0.996567470639547, 'auprc': 0.9976190985578202, 'loss_val': 0.020715809032700993, 'psi': 0.9969881218068564}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.680170 cos_to_last_merge=0.8361 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.6528230486793859, 'auprc': 0.7265977363246272, 'loss_val': 0.7676079677477553, 'psi': 0.6823329237374824}-{'f1_val': 0.7539578240214689, 'auprc': 0.7454890868045624, 'loss_val': 0.5813845117637654, 'psi': 0.7505703291347063}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=1.838533 cos_to_last_merge=0.8677 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=55 local utility u=0.001312 metrics={'f1_val': 0.9978627957474508, 'auprc': 0.9990363370939452, 'loss_val': 0.021127278362476246, 'psi': 0.9983322122860486}-{'f1_val': 0.9974544106971202, 'auprc': 0.9990283489911332, 'loss_val': 0.02127753012941578, 'psi': 0.9980839860147254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=55 head_norm_before_train=1.624502 cos_to_last_merge=0.8728 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.8147625415922864, 'auprc': 0.9001509502741035, 'loss_val': 0.40163041388120485, 'psi': 0.8489179050650133}-{'f1_val': 0.8975238940039943, 'auprc': 0.9397975360785, 'loss_val': 0.28424792504856755, 'psi': 0.9144333508337965}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.839939 cos_to_last_merge=0.9303 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.9584797333473468, 'auprc': 0.9937932456628563, 'loss_val': 0.1447217727565059, 'psi': 0.9726051382735506}-{'f1_val': 0.9904346065396044, 'auprc': 0.9940611089401199, 'loss_val': 0.04704473656483499, 'psi': 0.9918852074998106}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.696605 cos_to_last_merge=0.9248 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.925
[S17] round=55 local utility u=0.000000 metrics={'f1_val': 0.6903446719304372, 'auprc': 0.8044091962251256, 'loss_val': 0.9859268050265739, 'psi': 0.7359704816483126}-{'f1_val': 0.7406350767978559, 'auprc': 0.9203493514744352, 'loss_val': 0.5905784814584223, 'psi': 0.8125207866684876}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=56 head_norm_before_train=1.665298 cos_to_last_merge=0.9151 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.915
[S2] round=56 local utility u=0.070651 metrics={'f1_val': 0.7145371576768397, 'auprc': 0.8038053487224879, 'loss_val': 0.7146467078021719, 'psi': 0.7502444340950989}-{'f1_val': 0.7235163479895979, 'auprc': 0.7756958796079725, 'loss_val': 0.8254952951129658, 'psi': 0.7443881606369478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=56 head_norm_before_train=2.236175 (no previous merge yet)
[S3] round=56 local utility u=0.376473 metrics={'f1_val': 0.959400038305751, 'auprc': 0.9986479932858725, 'loss_val': 0.14009321904685304, 'psi': 0.9750992202977997}-{'f1_val': 0.8525950267824309, 'auprc': 0.9984490454378313, 'loss_val': 0.25161204226893774, 'psi': 0.9109366342445911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=56 head_norm_before_train=2.030062 (no previous merge yet)
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9406989305339307, 'auprc': 0.9309454272473461, 'loss_val': 0.30913509821377505, 'psi': 0.9367975292192968}-{'f1_val': 0.9419447737855475, 'auprc': 0.9410384462959873, 'loss_val': 0.3029620587293704, 'psi': 0.9415822427897234}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=1.654216 cos_to_last_merge=0.7916 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9899050020151369, 'loss_val': 0.04144489629592406, 'psi': 0.9935861303448872}-{'f1_val': 0.9960402158980539, 'auprc': 0.9945572596769738, 'loss_val': 0.03943192411115193, 'psi': 0.9954470334096219}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.440960 cos_to_last_merge=0.8331 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.833
[S6] round=56 local utility u=0.926076 metrics={'f1_val': 0.7804857357355975, 'auprc': 0.9131964511324224, 'loss_val': 0.5391202819794353, 'psi': 0.8335700218943275}-{'f1_val': 0.5967753082415062, 'auprc': 0.7845616122884964, 'loss_val': 0.9031052301591413, 'psi': 0.6718898298603022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=56 head_norm_before_train=1.460427 cos_to_last_merge=0.9375 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.938
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.5217406534081016, 'auprc': 0.7841910800078105, 'loss_val': 1.0116800261568335, 'psi': 0.6267208240479851}-{'f1_val': 0.6322986400749457, 'auprc': 0.8051302585198468, 'loss_val': 0.5158647729230188, 'psi': 0.7014312874529062}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.945784 cos_to_last_merge=0.7434 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.743
[S8] round=56 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.98857072939033, 'loss_val': 0.03442781744044277, 'psi': 0.990732835974199}-{'f1_val': 0.9932593276801964, 'auprc': 0.9875887262892298, 'loss_val': 0.032539252227363015, 'psi': 0.9909910871238097}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=56 head_norm_before_train=1.693724 cos_to_last_merge=0.8978 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.898
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.997587965784458, 'loss_val': 0.019967759340781193, 'psi': 0.9975621203201694}-{'f1_val': 0.9975448900106438, 'auprc': 0.9988546971213608, 'loss_val': 0.020166567329642157, 'psi': 0.9980688128549305}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.850667 cos_to_last_merge=0.9462 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=56 local utility u=0.000656 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995977687998875, 'loss_val': 0.02824712968870589, 'psi': 0.9954531560452089}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958795572576322, 'loss_val': 0.029265226535496326, 'psi': 0.9954139037487119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=56 head_norm_before_train=2.219067 (no previous merge yet)
[S11] round=56 local utility u=0.007613 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975467287300099, 'loss_val': 0.02082630201073912, 'psi': 0.9969591738757322}-{'f1_val': 0.9946437926553063, 'auprc': 0.997614940565126, 'loss_val': 0.024715737450623058, 'psi': 0.9958322518192342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=56 head_norm_before_train=1.682364 cos_to_last_merge=0.8359 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.836
[S13] round=56 local utility u=0.015657 metrics={'f1_val': 0.6686434847534618, 'auprc': 0.7094581316449358, 'loss_val': 0.7797987517878636, 'psi': 0.6849693435100515}-{'f1_val': 0.6528230486793859, 'auprc': 0.7265977363246272, 'loss_val': 0.7676079677477553, 'psi': 0.6823329237374824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=1.844522 cos_to_last_merge=0.8674 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.867
[S14] round=56 local utility u=0.000000 metrics={'f1_val': 0.9302088800206655, 'auprc': 0.9986519078443801, 'loss_val': 0.1808317062399851, 'psi': 0.9575860911501513}-{'f1_val': 0.9978627957474508, 'auprc': 0.9990363370939452, 'loss_val': 0.021127278362476246, 'psi': 0.9983322122860486}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=56 head_norm_before_train=1.633411 cos_to_last_merge=0.8718 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=56 local utility u=0.559557 metrics={'f1_val': 0.9114673472310411, 'auprc': 0.9922378061413941, 'loss_val': 0.13900657981913886, 'psi': 0.9437755307951823}-{'f1_val': 0.8147625415922864, 'auprc': 0.9001509502741035, 'loss_val': 0.40163041388120485, 'psi': 0.8489179050650133}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=56 head_norm_before_train=1.846161 cos_to_last_merge=0.9296 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.930
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.8714891711846273, 'auprc': 0.9865692312750436, 'loss_val': 0.7855037504719234, 'psi': 0.9175211952207938}-{'f1_val': 0.9584797333473468, 'auprc': 0.9937932456628563, 'loss_val': 0.1447217727565059, 'psi': 0.9726051382735506}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.706106 cos_to_last_merge=0.9238 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.924
[S17] round=56 local utility u=0.737598 metrics={'f1_val': 0.8008593352906901, 'auprc': 0.9213974067959438, 'loss_val': 0.5247828133146852, 'psi': 0.8490745638927917}-{'f1_val': 0.6903446719304372, 'auprc': 0.8044091962251256, 'loss_val': 0.9859268050265739, 'psi': 0.7359704816483126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=57 head_norm_before_train=1.674767 cos_to_last_merge=0.9140 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.914
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.6855375422507899, 'auprc': 0.760435270240708, 'loss_val': 0.7712431682062805, 'psi': 0.7154966334467572}-{'f1_val': 0.7145371576768397, 'auprc': 0.8038053487224879, 'loss_val': 0.7146467078021719, 'psi': 0.7502444340950989}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.244125 (no previous merge yet)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.8308369646833024, 'auprc': 0.9901418921758555, 'loss_val': 0.2808710582581407, 'psi': 0.8945589356803236}-{'f1_val': 0.959400038305751, 'auprc': 0.9986479932858725, 'loss_val': 0.14009321904685304, 'psi': 0.9750992202977997}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=2.035630 (no previous merge yet)
[S4] round=57 local utility u=0.022452 metrics={'f1_val': 0.9422134988374073, 'auprc': 0.9409172825582999, 'loss_val': 0.30323440939631974, 'psi': 0.9416950123257644}-{'f1_val': 0.9406989305339307, 'auprc': 0.9309454272473461, 'loss_val': 0.30913509821377505, 'psi': 0.9367975292192968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] sending update (kind=head size=1794 to 1 peers)
[S5] START round=57 head_norm_before_train=1.666730 cos_to_last_merge=0.7913 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=57 local utility u=0.012246 metrics={'f1_val': 0.996186023309311, 'auprc': 0.995955936727706, 'loss_val': 0.03597955917430968, 'psi': 0.996093988676669}-{'f1_val': 0.9960402158980539, 'auprc': 0.9899050020151369, 'loss_val': 0.04144489629592406, 'psi': 0.9935861303448872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=57 head_norm_before_train=1.446294 cos_to_last_merge=0.8324 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=57 local utility u=0.213100 metrics={'f1_val': 0.8186748363578685, 'auprc': 0.9576613022714356, 'loss_val': 0.47544851709010333, 'psi': 0.8742694227232954}-{'f1_val': 0.7804857357355975, 'auprc': 0.9131964511324224, 'loss_val': 0.5391202819794353, 'psi': 0.8335700218943275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=57 head_norm_before_train=1.466628 cos_to_last_merge=0.9364 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=57 local utility u=0.927485 metrics={'f1_val': 0.6828226291405161, 'auprc': 0.8489201015187869, 'loss_val': 0.3173884451182904, 'psi': 0.7492616180918243}-{'f1_val': 0.5217406534081016, 'auprc': 0.7841910800078105, 'loss_val': 1.0116800261568335, 'psi': 0.6267208240479851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=57 head_norm_before_train=1.953625 cos_to_last_merge=0.7429 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.743
[S8] round=57 local utility u=0.005018 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9875751956037655, 'loss_val': 0.0323105725898669, 'psi': 0.9914252199946143}-{'f1_val': 0.992174240363445, 'auprc': 0.98857072939033, 'loss_val': 0.03442781744044277, 'psi': 0.990732835974199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=57 head_norm_before_train=1.699056 cos_to_last_merge=0.8974 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.897
[S9] round=57 local utility u=0.002022 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.998854845296632, 'loss_val': 0.01972434893883489, 'psi': 0.998068872125039}-{'f1_val': 0.9975448900106438, 'auprc': 0.997587965784458, 'loss_val': 0.019967759340781193, 'psi': 0.9975621203201694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=57 head_norm_before_train=1.856780 cos_to_last_merge=0.9454 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=57 local utility u=0.000109 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959655789507498, 'loss_val': 0.027993206645981775, 'psi': 0.9954483124259589}-{'f1_val': 0.9951034680760983, 'auprc': 0.995977687998875, 'loss_val': 0.02824712968870589, 'psi': 0.9954531560452089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=57 head_norm_before_train=2.221199 (no previous merge yet)
[S11] round=57 local utility u=0.000708 metrics={'f1_val': 0.996567470639547, 'auprc': 0.99762875916987, 'loss_val': 0.019657157753731894, 'psi': 0.9969919860516763}-{'f1_val': 0.996567470639547, 'auprc': 0.9975467287300099, 'loss_val': 0.02082630201073912, 'psi': 0.9969591738757322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=57 head_norm_before_train=1.686533 cos_to_last_merge=0.8355 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=57 local utility u=0.314741 metrics={'f1_val': 0.7299241234552776, 'auprc': 0.7340683565648327, 'loss_val': 0.5918320473723352, 'psi': 0.7315818166990996}-{'f1_val': 0.6686434847534618, 'auprc': 0.7094581316449358, 'loss_val': 0.7797987517878636, 'psi': 0.6849693435100515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=57 head_norm_before_train=1.849570 cos_to_last_merge=0.8672 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.867
[S14] round=57 local utility u=0.255774 metrics={'f1_val': 0.9913383218557374, 'auprc': 0.9990072038030915, 'loss_val': 0.037126207055112416, 'psi': 0.9944058746346791}-{'f1_val': 0.9302088800206655, 'auprc': 0.9986519078443801, 'loss_val': 0.1808317062399851, 'psi': 0.9575860911501513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=57 head_norm_before_train=1.641320 cos_to_last_merge=0.8709 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.8920158948448482, 'auprc': 0.9565654131075874, 'loss_val': 0.27680462166551756, 'psi': 0.9178357021499438}-{'f1_val': 0.9114673472310411, 'auprc': 0.9922378061413941, 'loss_val': 0.13900657981913886, 'psi': 0.9437755307951823}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=1.853015 cos_to_last_merge=0.9290 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.929
[S16] round=57 local utility u=0.033402 metrics={'f1_val': 0.8760513363260789, 'auprc': 0.983007581454291, 'loss_val': 0.7353882172669488, 'psi': 0.9188338343773638}-{'f1_val': 0.8714891711846273, 'auprc': 0.9865692312750436, 'loss_val': 0.7855037504719234, 'psi': 0.9175211952207938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=57 head_norm_before_train=1.715157 cos_to_last_merge=0.9230 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.7738231973133292, 'auprc': 0.8904925470461587, 'loss_val': 0.6980400459248254, 'psi': 0.820490937206461}-{'f1_val': 0.8008593352906901, 'auprc': 0.9213974067959438, 'loss_val': 0.5247828133146852, 'psi': 0.8490745638927917}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=1.682143 cos_to_last_merge=0.9135 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=58 local utility u=0.086173 metrics={'f1_val': 0.6961595795914113, 'auprc': 0.7847801098300875, 'loss_val': 0.7356629876221209, 'psi': 0.7316077916868817}-{'f1_val': 0.6855375422507899, 'auprc': 0.760435270240708, 'loss_val': 0.7712431682062805, 'psi': 0.7154966334467572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=58 head_norm_before_train=2.251228 (no previous merge yet)
[S3] round=58 local utility u=0.084225 metrics={'f1_val': 0.8490638403310578, 'auprc': 0.9976721497662919, 'loss_val': 0.24437360700399058, 'psi': 0.9085071641051514}-{'f1_val': 0.8308369646833024, 'auprc': 0.9901418921758555, 'loss_val': 0.2808710582581407, 'psi': 0.8945589356803236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=58 head_norm_before_train=2.040997 (no previous merge yet)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9408535752703484, 'auprc': 0.9268227222841329, 'loss_val': 0.30929109368019286, 'psi': 0.9352412340758622}-{'f1_val': 0.9422134988374073, 'auprc': 0.9409172825582999, 'loss_val': 0.30323440939631974, 'psi': 0.9416950123257644}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.679496 cos_to_last_merge=0.7911 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9916484682137989, 'loss_val': 0.036100504030152004, 'psi': 0.994283516824352}-{'f1_val': 0.996186023309311, 'auprc': 0.995955936727706, 'loss_val': 0.03597955917430968, 'psi': 0.996093988676669}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.452198 cos_to_last_merge=0.8317 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.832
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6691756566643271, 'auprc': 0.8133350516388254, 'loss_val': 0.7295492335885722, 'psi': 0.7268394146541264}-{'f1_val': 0.8186748363578685, 'auprc': 0.9576613022714356, 'loss_val': 0.47544851709010333, 'psi': 0.8742694227232954}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.470391 cos_to_last_merge=0.9357 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.936
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.541057853532626, 'auprc': 0.7842721581180329, 'loss_val': 1.004644872449232, 'psi': 0.6383435753667888}-{'f1_val': 0.6828226291405161, 'auprc': 0.8489201015187869, 'loss_val': 0.3173884451182904, 'psi': 0.7492616180918243}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.959540 cos_to_last_merge=0.7422 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.742
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.713665972483988, 'auprc': 0.9853244084944223, 'loss_val': 0.5060519336689827, 'psi': 0.8223293468881617}-{'f1_val': 0.9939919029218467, 'auprc': 0.9875751956037655, 'loss_val': 0.0323105725898669, 'psi': 0.9914252199946143}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.703855 cos_to_last_merge=0.8968 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.897
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9963040129521351, 'auprc': 0.9989709375882445, 'loss_val': 0.02044907774135012, 'psi': 0.9973707828065788}-{'f1_val': 0.9975448900106438, 'auprc': 0.998854845296632, 'loss_val': 0.01972434893883489, 'psi': 0.998068872125039}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.864367 cos_to_last_merge=0.9447 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995859605767942, 'loss_val': 0.028747589452960572, 'psi': 0.9954059231528357}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959655789507498, 'loss_val': 0.027993206645981775, 'psi': 0.9954483124259589}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.225211 (no previous merge yet)
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975016962820895, 'loss_val': 0.019343122295394477, 'psi': 0.996941160896564}-{'f1_val': 0.996567470639547, 'auprc': 0.99762875916987, 'loss_val': 0.019657157753731894, 'psi': 0.9969919860516763}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.691939 cos_to_last_merge=0.8349 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.7388113754103545, 'auprc': 0.7519475040965299, 'loss_val': 0.8168429887982519, 'psi': 0.7440658268848246}-{'f1_val': 0.7299241234552776, 'auprc': 0.7340683565648327, 'loss_val': 0.5918320473723352, 'psi': 0.7315818166990996}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.855311 cos_to_last_merge=0.8665 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.866
[S14] round=58 local utility u=0.026437 metrics={'f1_val': 0.9978627957474508, 'auprc': 0.9986474794737499, 'loss_val': 0.022320670821982688, 'psi': 0.9981766692379704}-{'f1_val': 0.9913383218557374, 'auprc': 0.9990072038030915, 'loss_val': 0.037126207055112416, 'psi': 0.9944058746346791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=58 head_norm_before_train=1.650906 cos_to_last_merge=0.8699 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7699681033153583, 'auprc': 0.9080467499293283, 'loss_val': 0.4606014109226688, 'psi': 0.8251995619609462}-{'f1_val': 0.8920158948448482, 'auprc': 0.9565654131075874, 'loss_val': 0.27680462166551756, 'psi': 0.9178357021499438}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.858318 cos_to_last_merge=0.9284 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=58 local utility u=0.710905 metrics={'f1_val': 0.9918506885053113, 'auprc': 0.993493792536818, 'loss_val': 0.03983312743079319, 'psi': 0.992507930117914}-{'f1_val': 0.8760513363260789, 'auprc': 0.983007581454291, 'loss_val': 0.7353882172669488, 'psi': 0.9188338343773638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=58 head_norm_before_train=1.723021 cos_to_last_merge=0.9223 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.922
[S17] round=58 local utility u=0.468440 metrics={'f1_val': 0.8596673450190916, 'auprc': 0.950922985426905, 'loss_val': 0.45751542900658687, 'psi': 0.8961696011822169}-{'f1_val': 0.7738231973133292, 'auprc': 0.8904925470461587, 'loss_val': 0.6980400459248254, 'psi': 0.820490937206461}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=59 head_norm_before_train=1.690346 cos_to_last_merge=0.9127 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6573991232195429, 'auprc': 0.7745550447176452, 'loss_val': 0.9420142778061682, 'psi': 0.7042614918187837}-{'f1_val': 0.6961595795914113, 'auprc': 0.7847801098300875, 'loss_val': 0.7356629876221209, 'psi': 0.7316077916868817}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.704 u=0.0000 p_local=0.0725 f1=0.657 auprc=0.775 bytes=55796
[S3] START round=59 head_norm_before_train=2.258855 (no previous merge yet)
[S3] round=59 local utility u=0.342072 metrics={'f1_val': 0.9402630530460137, 'auprc': 0.9985295576341062, 'loss_val': 0.10999745880096326, 'psi': 0.9635696548812507}-{'f1_val': 0.8490638403310578, 'auprc': 0.9976721497662919, 'loss_val': 0.24437360700399058, 'psi': 0.9085071641051514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=60 psi=0.964 u=0.3421 p_local=0.1403 f1=0.940 auprc=0.999 bytes=64845
[S4] START round=59 head_norm_before_train=2.047482 (no previous merge yet)
[S4] round=59 local utility u=0.023518 metrics={'f1_val': 0.9437190212561681, 'auprc': 0.9354780236793827, 'loss_val': 0.30541274592025314, 'psi': 0.9404226222254539}-{'f1_val': 0.9408535752703484, 'auprc': 0.9268227222841329, 'loss_val': 0.30929109368019286, 'psi': 0.9352412340758622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=60 psi=0.940 u=0.0235 p_local=0.0151 f1=0.944 auprc=0.935 bytes=57511
[S5] START round=59 head_norm_before_train=1.688222 cos_to_last_merge=0.7908 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=59 local utility u=0.012249 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9988831247408315, 'loss_val': 0.0341811898942871, 'psi': 0.9972648638819193}-{'f1_val': 0.9960402158980539, 'auprc': 0.9916484682137989, 'loss_val': 0.036100504030152004, 'psi': 0.994283516824352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S5] r=60 psi=0.997 u=0.0122 p_local=0.0240 f1=0.996 auprc=0.999 bytes=62972
[S6] START round=59 head_norm_before_train=1.463121 cos_to_last_merge=0.8301 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.830
[S6] round=59 local utility u=0.780227 metrics={'f1_val': 0.8204851866157996, 'auprc': 0.9433143800722946, 'loss_val': 0.4668904714097011, 'psi': 0.8696168639983977}-{'f1_val': 0.6691756566643271, 'auprc': 0.8133350516388254, 'loss_val': 0.7295492335885722, 'psi': 0.7268394146541264}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S6] r=60 psi=0.870 u=0.7802 p_local=0.3597 f1=0.820 auprc=0.943 bytes=64643
[S7] START round=59 head_norm_before_train=1.472618 cos_to_last_merge=0.9349 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.935
[S7] round=59 local utility u=0.409154 metrics={'f1_val': 0.6106205826240227, 'auprc': 0.7969482965733959, 'loss_val': 0.6417423427981642, 'psi': 0.6851516682037719}-{'f1_val': 0.541057853532626, 'auprc': 0.7842721581180329, 'loss_val': 1.004644872449232, 'psi': 0.6383435753667888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S7] r=60 psi=0.685 u=0.4092 p_local=0.2674 f1=0.611 auprc=0.797 bytes=64844
[S8] START round=59 head_norm_before_train=1.964997 cos_to_last_merge=0.7414 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.741
[S8] round=59 local utility u=1.000000 metrics={'f1_val': 0.9867984609811391, 'auprc': 0.9988612496525309, 'loss_val': 0.04620824256894499, 'psi': 0.9916235764496958}-{'f1_val': 0.713665972483988, 'auprc': 0.9853244084944223, 'loss_val': 0.5060519336689827, 'psi': 0.8223293468881617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S8] r=60 psi=0.992 u=1.0000 p_local=0.2100 f1=0.987 auprc=0.999 bytes=68335
[S9] START round=59 head_norm_before_train=1.710038 cos_to_last_merge=0.8959 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.896
[S9] round=59 local utility u=0.000937 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9989724888955427, 'loss_val': 0.021044779805954077, 'psi': 0.9976179412208066}-{'f1_val': 0.9963040129521351, 'auprc': 0.9989709375882445, 'loss_val': 0.02044907774135012, 'psi': 0.9973707828065788}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=60 psi=0.998 u=0.0009 p_local=0.0014 f1=0.997 auprc=0.999 bytes=75481
[S10] START round=59 head_norm_before_train=1.872587 cos_to_last_merge=0.9440 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958334723588305, 'loss_val': 0.028792614371653407, 'psi': 0.9953954697891911}-{'f1_val': 0.9951034680760983, 'auprc': 0.995859605767942, 'loss_val': 0.028747589452960572, 'psi': 0.9954059231528357}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.995 u=0.0000 p_local=0.0005 f1=0.995 auprc=0.996 bytes=71900
[S11] START round=59 head_norm_before_train=2.229526 (no previous merge yet)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9973929818306771, 'loss_val': 0.020536120481135595, 'psi': 0.996897675115999}-{'f1_val': 0.996567470639547, 'auprc': 0.9975016962820895, 'loss_val': 0.019343122295394477, 'psi': 0.996941160896564}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.997 u=0.0000 p_local=0.0048 f1=0.997 auprc=0.997 bytes=73766
[S13] START round=59 head_norm_before_train=1.698429 cos_to_last_merge=0.8340 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.834
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6421280035990926, 'auprc': 0.7363285409250249, 'loss_val': 0.8414159485372941, 'psi': 0.6798082185294655}-{'f1_val': 0.7388113754103545, 'auprc': 0.7519475040965299, 'loss_val': 0.8168429887982519, 'psi': 0.7440658268848246}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.680 u=0.0000 p_local=0.0841 f1=0.642 auprc=0.736 bytes=59366
[S14] START round=59 head_norm_before_train=1.859898 cos_to_last_merge=0.8656 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.866
[S14] round=59 local utility u=0.001556 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990236834751463, 'loss_val': 0.018934587086435275, 'psi': 0.9981869392269949}-{'f1_val': 0.9978627957474508, 'auprc': 0.9986474794737499, 'loss_val': 0.022320670821982688, 'psi': 0.9981766692379704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] r=60 psi=0.998 u=0.0016 p_local=0.0430 f1=0.998 auprc=0.999 bytes=82625
[S15] START round=59 head_norm_before_train=1.660761 cos_to_last_merge=0.8688 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=59 local utility u=1.000000 metrics={'f1_val': 0.9934528766724426, 'auprc': 0.9927308646935827, 'loss_val': 0.0425374325885598, 'psi': 0.9931640718808987}-{'f1_val': 0.7699681033153583, 'auprc': 0.9080467499293283, 'loss_val': 0.4606014109226688, 'psi': 0.8251995619609462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=60 psi=0.993 u=1.0000 p_local=0.3273 f1=0.993 auprc=0.993 bytes=59249
[S16] START round=59 head_norm_before_train=1.862659 cos_to_last_merge=0.9277 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.8350786392387805, 'auprc': 0.9864044248364741, 'loss_val': 0.6866385496944261, 'psi': 0.895608953477858}-{'f1_val': 0.9918506885053113, 'auprc': 0.993493792536818, 'loss_val': 0.03983312743079319, 'psi': 0.992507930117914}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=60 psi=0.896 u=0.0000 p_local=0.1833 f1=0.835 auprc=0.986 bytes=62983
[S17] START round=59 head_norm_before_train=1.730979 cos_to_last_merge=0.9211 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.921
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6848667967142468, 'auprc': 0.7628637396786111, 'loss_val': 1.1162101067632288, 'psi': 0.7160655738999926}-{'f1_val': 0.8596673450190916, 'auprc': 0.950922985426905, 'loss_val': 0.45751542900658687, 'psi': 0.8961696011822169}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.716 u=0.0000 p_local=0.2024 f1=0.685 auprc=0.763 bytes=62935
[S2] START round=60 head_norm_before_train=1.699941 cos_to_last_merge=0.9117 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.912
[S2] round=60 local utility u=0.397906 metrics={'f1_val': 0.7148781913203284, 'auprc': 0.8567785830691926, 'loss_val': 0.7377475163845797, 'psi': 0.7716383480198741}-{'f1_val': 0.6573991232195429, 'auprc': 0.7745550447176452, 'loss_val': 0.9420142778061682, 'psi': 0.7042614918187837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=60 head_norm_before_train=2.266784 (no previous merge yet)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.9338253937362624, 'auprc': 0.9984150836318301, 'loss_val': 0.20444133838419656, 'psi': 0.9596612696944894}-{'f1_val': 0.9402630530460137, 'auprc': 0.9985295576341062, 'loss_val': 0.10999745880096326, 'psi': 0.9635696548812507}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=2.056659 (no previous merge yet)
[S4] round=60 local utility u=0.038137 metrics={'f1_val': 0.950282910627057, 'auprc': 0.9484500271862257, 'loss_val': 0.3074373543312837, 'psi': 0.9495497572507245}-{'f1_val': 0.9437190212561681, 'auprc': 0.9354780236793827, 'loss_val': 0.30541274592025314, 'psi': 0.9404226222254539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=60 head_norm_before_train=1.694893 cos_to_last_merge=0.7906 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9932492682535854, 'loss_val': 0.03466927431530375, 'psi': 0.9949238368402665}-{'f1_val': 0.996186023309311, 'auprc': 0.9988831247408315, 'loss_val': 0.0341811898942871, 'psi': 0.9972648638819193}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.472735 cos_to_last_merge=0.8283 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.828
[S6] round=60 local utility u=0.540767 metrics={'f1_val': 0.9471326555551687, 'auprc': 0.9715398816522803, 'loss_val': 0.22991843349011237, 'psi': 0.9568955459940134}-{'f1_val': 0.8204851866157996, 'auprc': 0.9433143800722946, 'loss_val': 0.4668904714097011, 'psi': 0.8696168639983977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=60 head_norm_before_train=1.475309 cos_to_last_merge=0.9344 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=60 local utility u=0.168306 metrics={'f1_val': 0.6411120965357703, 'auprc': 0.8038699740288585, 'loss_val': 0.5088437245810469, 'psi': 0.7062152475330056}-{'f1_val': 0.6106205826240227, 'auprc': 0.7969482965733959, 'loss_val': 0.6417423427981642, 'psi': 0.6851516682037719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=60 head_norm_before_train=1.968145 cos_to_last_merge=0.7405 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.741
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9878503457462027, 'auprc': 0.9937963403061933, 'loss_val': 0.042081907450857325, 'psi': 0.990228743570199}-{'f1_val': 0.9867984609811391, 'auprc': 0.9988612496525309, 'loss_val': 0.04620824256894499, 'psi': 0.9916235764496958}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=1.717224 cos_to_last_merge=0.8950 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.895
[S9] round=60 local utility u=0.000665 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9989684665081273, 'loss_val': 0.019721692880237063, 'psi': 0.9976182654445094}-{'f1_val': 0.9967149094376494, 'auprc': 0.9989724888955427, 'loss_val': 0.021044779805954077, 'psi': 0.9976179412208066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=60 head_norm_before_train=1.880201 cos_to_last_merge=0.9434 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=60 local utility u=0.000531 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959008037525233, 'loss_val': 0.027932351516989987, 'psi': 0.9954224023466682}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958334723588305, 'loss_val': 0.028792614371653407, 'psi': 0.9953954697891911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=60 head_norm_before_train=2.234642 (no previous merge yet)
[S11] round=60 local utility u=0.000495 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9976254312947808, 'loss_val': 0.02024335971672391, 'psi': 0.9969906549016405}-{'f1_val': 0.996567470639547, 'auprc': 0.9973929818306771, 'loss_val': 0.020536120481135595, 'psi': 0.996897675115999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=60 head_norm_before_train=1.703786 cos_to_last_merge=0.8335 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=60 local utility u=0.119712 metrics={'f1_val': 0.6409836248208121, 'auprc': 0.7735873746227869, 'loss_val': 0.7069015937706682, 'psi': 0.694025124741602}-{'f1_val': 0.6421280035990926, 'auprc': 0.7363285409250249, 'loss_val': 0.8414159485372941, 'psi': 0.6798082185294655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=60 head_norm_before_train=1.864536 cos_to_last_merge=0.8647 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.865
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9990246917572592, 'loss_val': 0.019181646639906586, 'psi': 0.9981890606768294}-{'f1_val': 0.9976291097282272, 'auprc': 0.9990236834751463, 'loss_val': 0.018934587086435275, 'psi': 0.9981869392269949}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.671354 cos_to_last_merge=0.8677 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.8161919996577465, 'auprc': 0.9141257637210557, 'loss_val': 0.38915951491586476, 'psi': 0.8553655052830702}-{'f1_val': 0.9934528766724426, 'auprc': 0.9927308646935827, 'loss_val': 0.0425374325885598, 'psi': 0.9931640718808987}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=1.867447 cos_to_last_merge=0.9270 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.927
[S16] round=60 local utility u=0.420762 metrics={'f1_val': 0.931815887906544, 'auprc': 0.9848943164587992, 'loss_val': 0.42100678924519586, 'psi': 0.953047259327446}-{'f1_val': 0.8350786392387805, 'auprc': 0.9864044248364741, 'loss_val': 0.6866385496944261, 'psi': 0.895608953477858}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=60 head_norm_before_train=1.738470 cos_to_last_merge=0.9202 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=60 local utility u=1.000000 metrics={'f1_val': 0.9435525095363173, 'auprc': 0.9907185653130548, 'loss_val': 0.1612550192053967, 'psi': 0.9624189318470123}-{'f1_val': 0.6848667967142468, 'auprc': 0.7628637396786111, 'loss_val': 1.1162101067632288, 'psi': 0.7160655738999926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=61 head_norm_before_train=1.709057 cos_to_last_merge=0.9106 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.911
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7222033043342422, 'auprc': 0.8111781636103517, 'loss_val': 0.8312395416145372, 'psi': 0.757793248044686}-{'f1_val': 0.7148781913203284, 'auprc': 0.8567785830691926, 'loss_val': 0.7377475163845797, 'psi': 0.7716383480198741}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.274038 (no previous merge yet)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.87690678350525, 'auprc': 0.99107190753151, 'loss_val': 0.2933051071130112, 'psi': 0.922572833115754}-{'f1_val': 0.9338253937362624, 'auprc': 0.9984150836318301, 'loss_val': 0.20444133838419656, 'psi': 0.9596612696944894}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=2.064154 (no previous merge yet)
[S4] round=61 local utility u=0.020477 metrics={'f1_val': 0.9526812794225303, 'auprc': 0.9557432844549065, 'loss_val': 0.3027526358888593, 'psi': 0.9539060814354808}-{'f1_val': 0.950282910627057, 'auprc': 0.9484500271862257, 'loss_val': 0.3074373543312837, 'psi': 0.9495497572507245}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=61 head_norm_before_train=1.702255 cos_to_last_merge=0.7900 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=61 local utility u=0.004309 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9953956139609166, 'loss_val': 0.03249043515821755, 'psi': 0.995782375123199}-{'f1_val': 0.9960402158980539, 'auprc': 0.9932492682535854, 'loss_val': 0.03466927431530375, 'psi': 0.9949238368402665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=61 head_norm_before_train=1.480623 cos_to_last_merge=0.8262 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.826
[S6] round=61 local utility u=0.064525 metrics={'f1_val': 0.9628219762563484, 'auprc': 0.9719317818195099, 'loss_val': 0.1961808429236926, 'psi': 0.966465898481613}-{'f1_val': 0.9471326555551687, 'auprc': 0.9715398816522803, 'loss_val': 0.22991843349011237, 'psi': 0.9568955459940134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=61 head_norm_before_train=1.480575 cos_to_last_merge=0.9337 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.934
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.6026697070620194, 'auprc': 0.7957378286006563, 'loss_val': 0.719727658385168, 'psi': 0.6798969556774741}-{'f1_val': 0.6411120965357703, 'auprc': 0.8038699740288585, 'loss_val': 0.5088437245810469, 'psi': 0.7062152475330056}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.972708 cos_to_last_merge=0.7398 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.740
[S8] round=61 local utility u=0.013399 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9867890973378127, 'loss_val': 0.031112496253356277, 'psi': 0.9911107806882331}-{'f1_val': 0.9878503457462027, 'auprc': 0.9937963403061933, 'loss_val': 0.042081907450857325, 'psi': 0.990228743570199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=61 head_norm_before_train=1.724728 cos_to_last_merge=0.8943 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.894
[S9] round=61 local utility u=0.000237 metrics={'f1_val': 0.9967181314020974, 'auprc': 0.9989675097760187, 'loss_val': 0.01924566532356622, 'psi': 0.9976178827516659}-{'f1_val': 0.9967181314020974, 'auprc': 0.9989684665081273, 'loss_val': 0.019721692880237063, 'psi': 0.9976182654445094}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=61 head_norm_before_train=1.885291 cos_to_last_merge=0.9426 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=61 local utility u=0.000487 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959492079358601, 'loss_val': 0.027104393919085333, 'psi': 0.995441764020003}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959008037525233, 'loss_val': 0.027932351516989987, 'psi': 0.9954224023466682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=61 head_norm_before_train=2.240425 (no previous merge yet)
[S11] round=61 local utility u=0.000079 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978144525605215, 'loss_val': 0.020528736536661978, 'psi': 0.9970539837323623}-{'f1_val': 0.996567470639547, 'auprc': 0.9976254312947808, 'loss_val': 0.02024335971672391, 'psi': 0.9969906549016405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=61 head_norm_before_train=1.707934 cos_to_last_merge=0.8328 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=61 local utility u=0.024459 metrics={'f1_val': 0.6582525734242746, 'auprc': 0.7853697858657683, 'loss_val': 0.7969442902433572, 'psi': 0.7090994584008721}-{'f1_val': 0.6409836248208121, 'auprc': 0.7735873746227869, 'loss_val': 0.7069015937706682, 'psi': 0.694025124741602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=61 head_norm_before_train=1.870213 cos_to_last_merge=0.8641 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.864
[S14] round=61 local utility u=0.000000 metrics={'f1_val': 0.9974544106971202, 'auprc': 0.9986465225844005, 'loss_val': 0.026455518704290314, 'psi': 0.9979312554520322}-{'f1_val': 0.9976319732898762, 'auprc': 0.9990246917572592, 'loss_val': 0.019181646639906586, 'psi': 0.9981890606768294}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=61 head_norm_before_train=1.681608 cos_to_last_merge=0.8666 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=61 local utility u=0.608965 metrics={'f1_val': 0.9328191667832695, 'auprc': 0.9906842712599677, 'loss_val': 0.10066748116132997, 'psi': 0.9559652085739488}-{'f1_val': 0.8161919996577465, 'auprc': 0.9141257637210557, 'loss_val': 0.38915951491586476, 'psi': 0.8553655052830702}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=61 head_norm_before_train=1.873386 cos_to_last_merge=0.9265 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=61 local utility u=0.376135 metrics={'f1_val': 0.990218050461623, 'auprc': 0.9937926179424894, 'loss_val': 0.04584403250043923, 'psi': 0.9916478774539695}-{'f1_val': 0.931815887906544, 'auprc': 0.9848943164587992, 'loss_val': 0.42100678924519586, 'psi': 0.953047259327446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=61 head_norm_before_train=1.745250 cos_to_last_merge=0.9195 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.8969751698747152, 'auprc': 0.9767064031417442, 'loss_val': 0.29608357041118144, 'psi': 0.9288676631815267}-{'f1_val': 0.9435525095363173, 'auprc': 0.9907185653130548, 'loss_val': 0.1612550192053967, 'psi': 0.9624189318470123}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=1.717611 cos_to_last_merge=0.9096 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.910
[S2] round=62 local utility u=0.087975 metrics={'f1_val': 0.7137510750348616, 'auprc': 0.8401058948535641, 'loss_val': 0.6913595177998313, 'psi': 0.7642930029623426}-{'f1_val': 0.7222033043342422, 'auprc': 0.8111781636103517, 'loss_val': 0.8312395416145372, 'psi': 0.757793248044686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=62 head_norm_before_train=2.280138 (no previous merge yet)
[S3] round=62 local utility u=0.282477 metrics={'f1_val': 0.9374569600743944, 'auprc': 0.998382994660182, 'loss_val': 0.11358472842690162, 'psi': 0.9618273739087093}-{'f1_val': 0.87690678350525, 'auprc': 0.99107190753151, 'loss_val': 0.2933051071130112, 'psi': 0.922572833115754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=62 head_norm_before_train=2.068584 (no previous merge yet)
[S4] round=62 local utility u=0.000000 metrics={'f1_val': 0.9393748328990144, 'auprc': 0.9410695754538806, 'loss_val': 0.31338243866461085, 'psi': 0.9400527299209608}-{'f1_val': 0.9526812794225303, 'auprc': 0.9557432844549065, 'loss_val': 0.3027526358888593, 'psi': 0.9539060814354808}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=62 head_norm_before_train=1.711742 cos_to_last_merge=0.7896 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9949323263405321, 'auprc': 0.9906794744264543, 'loss_val': 0.05299068932929493, 'psi': 0.993231185574901}-{'f1_val': 0.9960402158980539, 'auprc': 0.9953956139609166, 'loss_val': 0.03249043515821755, 'psi': 0.995782375123199}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=1.487023 cos_to_last_merge=0.8241 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.824
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.8191544056449394, 'auprc': 0.9469192751567858, 'loss_val': 0.45480211499860945, 'psi': 0.8702603534496779}-{'f1_val': 0.9628219762563484, 'auprc': 0.9719317818195099, 'loss_val': 0.1961808429236926, 'psi': 0.966465898481613}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.488156 cos_to_last_merge=0.9326 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.933
[S7] round=62 local utility u=0.234048 metrics={'f1_val': 0.648309406101637, 'auprc': 0.8048065786523858, 'loss_val': 0.5526767638588678, 'psi': 0.7109082751219366}-{'f1_val': 0.6026697070620194, 'auprc': 0.7957378286006563, 'loss_val': 0.719727658385168, 'psi': 0.6798969556774741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=62 head_norm_before_train=1.978339 cos_to_last_merge=0.7392 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9843251159098583, 'auprc': 0.9989008762844375, 'loss_val': 0.05469017753988579, 'psi': 0.9901554200596899}-{'f1_val': 0.9939919029218467, 'auprc': 0.9867890973378127, 'loss_val': 0.031112496253356277, 'psi': 0.9911107806882331}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=62 head_norm_before_train=1.731955 cos_to_last_merge=0.8935 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.893
[S9] round=62 local utility u=0.002609 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.998848771383509, 'loss_val': 0.01863277053804761, 'psi': 0.9980664425597898}-{'f1_val': 0.9967181314020974, 'auprc': 0.9989675097760187, 'loss_val': 0.01924566532356622, 'psi': 0.9976178827516659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=62 head_norm_before_train=1.891813 cos_to_last_merge=0.9420 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995860909743926, 'loss_val': 0.02772912777967017, 'psi': 0.9954064447432294}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959492079358601, 'loss_val': 0.027104393919085333, 'psi': 0.995441764020003}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.243537 (no previous merge yet)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975035870266645, 'loss_val': 0.02059854120225401, 'psi': 0.9969296375188196}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978144525605215, 'loss_val': 0.020528736536661978, 'psi': 0.9970539837323623}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.712591 cos_to_last_merge=0.8323 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=62 local utility u=0.294246 metrics={'f1_val': 0.7435667287096954, 'auprc': 0.8022026938940199, 'loss_val': 0.7708362626197354, 'psi': 0.7670211147834252}-{'f1_val': 0.6582525734242746, 'auprc': 0.7853697858657683, 'loss_val': 0.7969442902433572, 'psi': 0.7090994584008721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=62 head_norm_before_train=1.875717 cos_to_last_merge=0.8637 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.864
[S14] round=62 local utility u=0.002475 metrics={'f1_val': 0.9971907882668205, 'auprc': 0.9990248331511323, 'loss_val': 0.021058062639605676, 'psi': 0.9979244062205452}-{'f1_val': 0.9974544106971202, 'auprc': 0.9986465225844005, 'loss_val': 0.026455518704290314, 'psi': 0.9979312554520322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=62 head_norm_before_train=1.690048 cos_to_last_merge=0.8657 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=62 local utility u=0.011183 metrics={'f1_val': 0.9355758249185684, 'auprc': 0.9926004474305634, 'loss_val': 0.10058936181935287, 'psi': 0.9583856739233665}-{'f1_val': 0.9328191667832695, 'auprc': 0.9906842712599677, 'loss_val': 0.10066748116132997, 'psi': 0.9559652085739488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=62 head_norm_before_train=1.879797 cos_to_last_merge=0.9261 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9904189336593993, 'auprc': 0.98615950862687, 'loss_val': 0.04497687473472412, 'psi': 0.9887151636463876}-{'f1_val': 0.990218050461623, 'auprc': 0.9937926179424894, 'loss_val': 0.04584403250043923, 'psi': 0.9916478774539695}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.753136 cos_to_last_merge=0.9187 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=62 local utility u=0.000000 metrics={'f1_val': 0.6900455230653599, 'auprc': 0.7338447694549507, 'loss_val': 1.1512326741189662, 'psi': 0.7075652216211963}-{'f1_val': 0.8969751698747152, 'auprc': 0.9767064031417442, 'loss_val': 0.29608357041118144, 'psi': 0.9288676631815267}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=63 head_norm_before_train=1.725875 cos_to_last_merge=0.9082 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.908
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.7086079969839201, 'auprc': 0.7897342655594639, 'loss_val': 0.7123363332575481, 'psi': 0.7410585044141376}-{'f1_val': 0.7137510750348616, 'auprc': 0.8401058948535641, 'loss_val': 0.6913595177998313, 'psi': 0.7642930029623426}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.286579 (no previous merge yet)
[S3] round=63 local utility u=0.147011 metrics={'f1_val': 0.9768233850745706, 'auprc': 0.9984106228599243, 'loss_val': 0.05584348754840832, 'psi': 0.9854582801887121}-{'f1_val': 0.9374569600743944, 'auprc': 0.998382994660182, 'loss_val': 0.11358472842690162, 'psi': 0.9618273739087093}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=63 head_norm_before_train=2.072451 (no previous merge yet)
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.918766158084502, 'auprc': 0.9421085299594425, 'loss_val': 0.3910336127111153, 'psi': 0.9281031068344782}-{'f1_val': 0.9393748328990144, 'auprc': 0.9410695754538806, 'loss_val': 0.31338243866461085, 'psi': 0.9400527299209608}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.722933 cos_to_last_merge=0.7898 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=63 local utility u=0.029691 metrics={'f1_val': 0.9965541840087997, 'auprc': 0.9991482785736908, 'loss_val': 0.028747100202036163, 'psi': 0.9975918218347561}-{'f1_val': 0.9949323263405321, 'auprc': 0.9906794744264543, 'loss_val': 0.05299068932929493, 'psi': 0.993231185574901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=63 head_norm_before_train=1.498152 cos_to_last_merge=0.8221 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.822
[S6] round=63 local utility u=0.466384 metrics={'f1_val': 0.9302802359990757, 'auprc': 0.9637245531025332, 'loss_val': 0.23920529156791714, 'psi': 0.9436579628404587}-{'f1_val': 0.8191544056449394, 'auprc': 0.9469192751567858, 'loss_val': 0.45480211499860945, 'psi': 0.8702603534496779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=63 head_norm_before_train=1.494951 cos_to_last_merge=0.9316 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.932
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.6452302004316202, 'auprc': 0.8051325296531668, 'loss_val': 0.55577192641289, 'psi': 0.7091911321202389}-{'f1_val': 0.648309406101637, 'auprc': 0.8048065786523858, 'loss_val': 0.5526767638588678, 'psi': 0.7109082751219366}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.984640 cos_to_last_merge=0.7385 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=63 local utility u=0.023035 metrics={'f1_val': 0.9936178346089239, 'auprc': 0.9879308189974229, 'loss_val': 0.03146585696695785, 'psi': 0.9913430283643235}-{'f1_val': 0.9843251159098583, 'auprc': 0.9989008762844375, 'loss_val': 0.05469017753988579, 'psi': 0.9901554200596899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=63 head_norm_before_train=1.736944 cos_to_last_merge=0.8928 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.893
[S9] round=63 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9973947843632265, 'loss_val': 0.018461935057351823, 'psi': 0.9974848477516769}-{'f1_val': 0.9975448900106438, 'auprc': 0.998848771383509, 'loss_val': 0.01863277053804761, 'psi': 0.9980664425597898}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=63 head_norm_before_train=1.899030 cos_to_last_merge=0.9415 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9956872698157702, 'loss_val': 0.02940078557554113, 'psi': 0.995336988771967}-{'f1_val': 0.9951034680760983, 'auprc': 0.995860909743926, 'loss_val': 0.02772912777967017, 'psi': 0.9954064447432294}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=2.246350 (no previous merge yet)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974155525120046, 'loss_val': 0.02082622910966394, 'psi': 0.9968944237129556}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975035870266645, 'loss_val': 0.02059854120225401, 'psi': 0.9969296375188196}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=63 head_norm_before_train=1.716219 cos_to_last_merge=0.8317 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.832
[S13] round=63 local utility u=0.037544 metrics={'f1_val': 0.7482832670750303, 'auprc': 0.7994942008948145, 'loss_val': 0.7159216635465159, 'psi': 0.768767640602944}-{'f1_val': 0.7435667287096954, 'auprc': 0.8022026938940199, 'loss_val': 0.7708362626197354, 'psi': 0.7670211147834252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=63 head_norm_before_train=1.882598 cos_to_last_merge=0.8631 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.863
[S14] round=63 local utility u=0.002229 metrics={'f1_val': 0.9976319732898762, 'auprc': 0.9990114720576799, 'loss_val': 0.019206862922550437, 'psi': 0.9981837727969978}-{'f1_val': 0.9971907882668205, 'auprc': 0.9990248331511323, 'loss_val': 0.021058062639605676, 'psi': 0.9979244062205452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=63 head_norm_before_train=1.697065 cos_to_last_merge=0.8649 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.8990946134138977, 'auprc': 0.9424971359377577, 'loss_val': 0.29183717478478494, 'psi': 0.9164556224234417}-{'f1_val': 0.9355758249185684, 'auprc': 0.9926004474305634, 'loss_val': 0.10058936181935287, 'psi': 0.9583856739233665}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=1.884857 cos_to_last_merge=0.9256 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.926
[S16] round=63 local utility u=0.004412 metrics={'f1_val': 0.9899992570353977, 'auprc': 0.9910785188312397, 'loss_val': 0.048391455662159966, 'psi': 0.9904309617537346}-{'f1_val': 0.9904189336593993, 'auprc': 0.98615950862687, 'loss_val': 0.04497687473472412, 'psi': 0.9887151636463876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=63 head_norm_before_train=1.758960 cos_to_last_merge=0.9180 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.918
[S17] round=63 local utility u=1.000000 metrics={'f1_val': 0.8873223385199913, 'auprc': 0.9746734562397034, 'loss_val': 0.2786086715207214, 'psi': 0.9222627856078762}-{'f1_val': 0.6900455230653599, 'auprc': 0.7338447694549507, 'loss_val': 1.1512326741189662, 'psi': 0.7075652216211963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=64 head_norm_before_train=1.732163 cos_to_last_merge=0.9071 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6372653575180942, 'auprc': 0.7572222924262698, 'loss_val': 1.2851088034948968, 'psi': 0.6852481314813645}-{'f1_val': 0.7086079969839201, 'auprc': 0.7897342655594639, 'loss_val': 0.7123363332575481, 'psi': 0.7410585044141376}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.293175 (no previous merge yet)
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9985377046149834, 'loss_val': 0.15977636744319332, 'psi': 0.9759128472287315}-{'f1_val': 0.9768233850745706, 'auprc': 0.9984106228599243, 'loss_val': 0.05584348754840832, 'psi': 0.9854582801887121}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=2.075467 (no previous merge yet)
[S4] round=64 local utility u=0.070610 metrics={'f1_val': 0.9387685010935017, 'auprc': 0.9249893901563802, 'loss_val': 0.318470252876511, 'psi': 0.9332568567186531}-{'f1_val': 0.918766158084502, 'auprc': 0.9421085299594425, 'loss_val': 0.3910336127111153, 'psi': 0.9281031068344782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=64 head_norm_before_train=1.735928 cos_to_last_merge=0.7894 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9933220434020054, 'loss_val': 0.02966758488450374, 'psi': 0.9949529468996345}-{'f1_val': 0.9965541840087997, 'auprc': 0.9991482785736908, 'loss_val': 0.028747100202036163, 'psi': 0.9975918218347561}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.510457 cos_to_last_merge=0.8198 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.820
[S6] round=64 local utility u=0.008951 metrics={'f1_val': 0.9345794054330044, 'auprc': 0.9666463593415716, 'loss_val': 0.2558630245783608, 'psi': 0.9474061869964313}-{'f1_val': 0.9302802359990757, 'auprc': 0.9637245531025332, 'loss_val': 0.23920529156791714, 'psi': 0.9436579628404587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=64 head_norm_before_train=1.502315 cos_to_last_merge=0.9306 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.931
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.6325191554666251, 'auprc': 0.8012541427782134, 'loss_val': 0.5991263468745829, 'psi': 0.7000131503912603}-{'f1_val': 0.6452302004316202, 'auprc': 0.8051325296531668, 'loss_val': 0.55577192641289, 'psi': 0.7091911321202389}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=64 head_norm_before_train=1.989957 cos_to_last_merge=0.7386 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=64 local utility u=0.001566 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9907277632889964, 'loss_val': 0.03243180479568943, 'psi': 0.9920325588747843}-{'f1_val': 0.9936178346089239, 'auprc': 0.9879308189974229, 'loss_val': 0.03146585696695785, 'psi': 0.9913430283643235}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=64 head_norm_before_train=1.743193 cos_to_last_merge=0.8922 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=64 local utility u=0.001257 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991948220611166, 'loss_val': 0.01869537244161339, 'psi': 0.9979396763317323}-{'f1_val': 0.9975448900106438, 'auprc': 0.9973947843632265, 'loss_val': 0.018461935057351823, 'psi': 0.9974848477516769}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=64 head_norm_before_train=1.904372 cos_to_last_merge=0.9409 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=64 local utility u=0.000733 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957506647423077, 'loss_val': 0.028125796123784685, 'psi': 0.9953623467425821}-{'f1_val': 0.9951034680760983, 'auprc': 0.9956872698157702, 'loss_val': 0.02940078557554113, 'psi': 0.995336988771967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=64 head_norm_before_train=2.248759 (no previous merge yet)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9967249448655721, 'loss_val': 0.02261569704719547, 'psi': 0.9963824627926761}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974155525120046, 'loss_val': 0.02082622910966394, 'psi': 0.9968944237129556}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.720270 cos_to_last_merge=0.8311 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.831
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.7127979257019865, 'auprc': 0.7904369891056365, 'loss_val': 0.8803482102429853, 'psi': 0.7438535510634465}-{'f1_val': 0.7482832670750303, 'auprc': 0.7994942008948145, 'loss_val': 0.7159216635465159, 'psi': 0.768767640602944}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.890399 cos_to_last_merge=0.8625 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9974515471354712, 'auprc': 0.998646278241786, 'loss_val': 0.04239444608495402, 'psi': 0.9979294395779971}-{'f1_val': 0.9976319732898762, 'auprc': 0.9990114720576799, 'loss_val': 0.019206862922550437, 'psi': 0.9981837727969978}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=1.704510 cos_to_last_merge=0.8641 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.864
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.7889811031495981, 'auprc': 0.9073851971291731, 'loss_val': 0.4559782059091195, 'psi': 0.8363427407414281}-{'f1_val': 0.8990946134138977, 'auprc': 0.9424971359377577, 'loss_val': 0.29183717478478494, 'psi': 0.9164556224234417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.888446 cos_to_last_merge=0.9251 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=64 local utility u=0.000000 metrics={'f1_val': 0.8605700279962812, 'auprc': 0.980619175810587, 'loss_val': 0.942259598681503, 'psi': 0.9085896871220035}-{'f1_val': 0.9899992570353977, 'auprc': 0.9910785188312397, 'loss_val': 0.048391455662159966, 'psi': 0.9904309617537346}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=64 head_norm_before_train=1.761295 cos_to_last_merge=0.9173 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.8846622340097099, 'auprc': 0.9709994263896324, 'loss_val': 0.37053623645310163, 'psi': 0.919197110961679}-{'f1_val': 0.8873223385199913, 'auprc': 0.9746734562397034, 'loss_val': 0.2786086715207214, 'psi': 0.9222627856078762}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=1.736757 cos_to_last_merge=0.9065 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.907
[S2] round=65 local utility u=0.143863 metrics={'f1_val': 0.6478264351378924, 'auprc': 0.7634340982717932, 'loss_val': 1.0793841297444624, 'psi': 0.6940695003914528}-{'f1_val': 0.6372653575180942, 'auprc': 0.7572222924262698, 'loss_val': 1.2851088034948968, 'psi': 0.6852481314813645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=65 head_norm_before_train=2.299197 (no previous merge yet)
[S3] round=65 local utility u=0.081661 metrics={'f1_val': 0.9733571951960147, 'auprc': 0.9986288121037985, 'loss_val': 0.07189408366128411, 'psi': 0.9834658419591282}-{'f1_val': 0.9608296089712303, 'auprc': 0.9985377046149834, 'loss_val': 0.15977636744319332, 'psi': 0.9759128472287315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=65 head_norm_before_train=2.085462 (no previous merge yet)
[S4] round=65 local utility u=0.043572 metrics={'f1_val': 0.9425090580538672, 'auprc': 0.942727566331867, 'loss_val': 0.30698428071585276, 'psi': 0.9425964613650671}-{'f1_val': 0.9387685010935017, 'auprc': 0.9249893901563802, 'loss_val': 0.318470252876511, 'psi': 0.9332568567186531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=65 head_norm_before_train=1.745039 cos_to_last_merge=0.7891 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=65 local utility u=0.000056 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.993294395760357, 'loss_val': 0.029473374733376672, 'psi': 0.9949418878429752}-{'f1_val': 0.9960402158980539, 'auprc': 0.9933220434020054, 'loss_val': 0.02966758488450374, 'psi': 0.9949529468996345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=65 head_norm_before_train=1.523149 cos_to_last_merge=0.8180 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.818
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.8233979378681181, 'auprc': 0.9575280176016376, 'loss_val': 0.36540405763428646, 'psi': 0.8770499697615259}-{'f1_val': 0.9345794054330044, 'auprc': 0.9666463593415716, 'loss_val': 0.2558630245783608, 'psi': 0.9474061869964313}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.508417 cos_to_last_merge=0.9297 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.930
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.589906586088008, 'auprc': 0.7943646739409035, 'loss_val': 0.7924231778347216, 'psi': 0.6716898212291662}-{'f1_val': 0.6325191554666251, 'auprc': 0.8012541427782134, 'loss_val': 0.5991263468745829, 'psi': 0.7000131503912603}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.994915 cos_to_last_merge=0.7387 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9440841086431291, 'auprc': 0.9988142456462884, 'loss_val': 0.1475679368661004, 'psi': 0.9659761634443927}-{'f1_val': 0.9929024225986427, 'auprc': 0.9907277632889964, 'loss_val': 0.03243180479568943, 'psi': 0.9920325588747843}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=1.746657 cos_to_last_merge=0.8918 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9991946871017078, 'loss_val': 0.01893766254638629, 'psi': 0.9976913638193863}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991948220611166, 'loss_val': 0.01869537244161339, 'psi': 0.9979396763317323}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=1.909254 cos_to_last_merge=0.9403 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=65 local utility u=0.000307 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957903224482634, 'loss_val': 0.027630381625370085, 'psi': 0.9953782098249643}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957506647423077, 'loss_val': 0.028125796123784685, 'psi': 0.9953623467425821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=65 head_norm_before_train=2.248239 (no previous merge yet)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9966827950785984, 'loss_val': 0.023663785374113965, 'psi': 0.9963656028778866}-{'f1_val': 0.9961541414107454, 'auprc': 0.9967249448655721, 'loss_val': 0.02261569704719547, 'psi': 0.9963824627926761}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.726588 cos_to_last_merge=0.8304 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.663826602660884, 'auprc': 0.7385349539722684, 'loss_val': 0.8164956149099546, 'psi': 0.6937099431854378}-{'f1_val': 0.7127979257019865, 'auprc': 0.7904369891056365, 'loss_val': 0.8803482102429853, 'psi': 0.7438535510634465}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.896819 cos_to_last_merge=0.8621 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=65 local utility u=0.008499 metrics={'f1_val': 0.9973794582448391, 'auprc': 0.9973404342295562, 'loss_val': 0.021047228283504707, 'psi': 0.997363848638726}-{'f1_val': 0.9974515471354712, 'auprc': 0.998646278241786, 'loss_val': 0.04239444608495402, 'psi': 0.9979294395779971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=65 head_norm_before_train=1.711924 cos_to_last_merge=0.8633 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=65 local utility u=0.958698 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9909236698916194, 'loss_val': 0.030982122612907025, 'psi': 0.9939366408417476}-{'f1_val': 0.7889811031495981, 'auprc': 0.9073851971291731, 'loss_val': 0.4559782059091195, 'psi': 0.8363427407414281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=65 head_norm_before_train=1.893704 cos_to_last_merge=0.9245 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.925
[S16] round=65 local utility u=0.570310 metrics={'f1_val': 0.9422571201484787, 'auprc': 0.9864679707884451, 'loss_val': 0.3093095213211507, 'psi': 0.9599414604044652}-{'f1_val': 0.8605700279962812, 'auprc': 0.980619175810587, 'loss_val': 0.942259598681503, 'psi': 0.9085896871220035}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=65 head_norm_before_train=1.765463 cos_to_last_merge=0.9166 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.917
[S17] round=65 local utility u=0.000000 metrics={'f1_val': 0.7553714564905694, 'auprc': 0.8487512425113253, 'loss_val': 0.6752530138291225, 'psi': 0.7927233708988717}-{'f1_val': 0.8846622340097099, 'auprc': 0.9709994263896324, 'loss_val': 0.37053623645310163, 'psi': 0.919197110961679}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=66 head_norm_before_train=1.741177 cos_to_last_merge=0.9061 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=66 local utility u=0.416773 metrics={'f1_val': 0.7099113673380618, 'auprc': 0.7960729886436144, 'loss_val': 0.7162642132250249, 'psi': 0.7443760158602829}-{'f1_val': 0.6478264351378924, 'auprc': 0.7634340982717932, 'loss_val': 1.0793841297444624, 'psi': 0.6940695003914528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=66 head_norm_before_train=2.305303 (no previous merge yet)
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.8552221943825893, 'auprc': 0.99521729932825, 'loss_val': 0.2698117146203029, 'psi': 0.9112202363608535}-{'f1_val': 0.9733571951960147, 'auprc': 0.9986288121037985, 'loss_val': 0.07189408366128411, 'psi': 0.9834658419591282}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=2.095891 (no previous merge yet)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.940527153354989, 'auprc': 0.9332221799976955, 'loss_val': 0.31365563374581257, 'psi': 0.9376051640120716}-{'f1_val': 0.9425090580538672, 'auprc': 0.942727566331867, 'loss_val': 0.30698428071585276, 'psi': 0.9425964613650671}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.752182 cos_to_last_merge=0.7890 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=66 local utility u=0.000764 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9934170730862402, 'loss_val': 0.028313538885954666, 'psi': 0.9949909587733284}-{'f1_val': 0.9960402158980539, 'auprc': 0.993294395760357, 'loss_val': 0.029473374733376672, 'psi': 0.9949418878429752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=66 head_norm_before_train=1.536217 cos_to_last_merge=0.8154 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.815
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.8122842042907257, 'auprc': 0.9501331646521002, 'loss_val': 0.5054538658495746, 'psi': 0.8674237884352755}-{'f1_val': 0.8233979378681181, 'auprc': 0.9575280176016376, 'loss_val': 0.36540405763428646, 'psi': 0.8770499697615259}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.512995 cos_to_last_merge=0.9291 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.929
[S7] round=66 local utility u=0.650878 metrics={'f1_val': 0.686296003494283, 'auprc': 0.8632258285792708, 'loss_val': 0.2755880767285377, 'psi': 0.7570679335282782}-{'f1_val': 0.589906586088008, 'auprc': 0.7943646739409035, 'loss_val': 0.7924231778347216, 'psi': 0.6716898212291662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=66 head_norm_before_train=2.001138 cos_to_last_merge=0.7384 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=66 local utility u=0.192637 metrics={'f1_val': 0.9939919029218467, 'auprc': 0.9884450970042743, 'loss_val': 0.03063281402784407, 'psi': 0.9917731805548178}-{'f1_val': 0.9440841086431291, 'auprc': 0.9988142456462884, 'loss_val': 0.1475679368661004, 'psi': 0.9659761634443927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=66 head_norm_before_train=1.751105 cos_to_last_merge=0.8911 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.891
[S9] round=66 local utility u=0.001648 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991964768793038, 'loss_val': 0.01812923357283823, 'psi': 0.9979403382590072}-{'f1_val': 0.9966891482978385, 'auprc': 0.9991946871017078, 'loss_val': 0.01893766254638629, 'psi': 0.9976913638193863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=66 head_norm_before_train=1.915493 cos_to_last_merge=0.9397 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=66 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957703820054078, 'loss_val': 0.027654768950882695, 'psi': 0.9953702336478221}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957903224482634, 'loss_val': 0.027630381625370085, 'psi': 0.9953782098249643}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=66 head_norm_before_train=2.249094 (no previous merge yet)
[S11] round=66 local utility u=0.001308 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9968918728367948, 'loss_val': 0.0216742338920814, 'psi': 0.9964492339811651}-{'f1_val': 0.9961541414107454, 'auprc': 0.9966827950785984, 'loss_val': 0.023663785374113965, 'psi': 0.9963656028778866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=66 head_norm_before_train=1.731736 cos_to_last_merge=0.8299 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.830
[S13] round=66 local utility u=0.341485 metrics={'f1_val': 0.7254666039968852, 'auprc': 0.7830834476741805, 'loss_val': 0.6370116639773259, 'psi': 0.7485133414678034}-{'f1_val': 0.663826602660884, 'auprc': 0.7385349539722684, 'loss_val': 0.8164956149099546, 'psi': 0.6937099431854378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=66 head_norm_before_train=1.900993 cos_to_last_merge=0.8617 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9936569488964806, 'auprc': 0.9990312083231874, 'loss_val': 0.03383492148145127, 'psi': 0.9958066526671634}-{'f1_val': 0.9973794582448391, 'auprc': 0.9973404342295562, 'loss_val': 0.021047228283504707, 'psi': 0.997363848638726}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.719341 cos_to_last_merge=0.8626 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.863
[S15] round=66 local utility u=0.000018 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9905126578473032, 'loss_val': 0.029712559477384857, 'psi': 0.9937722360240212}-{'f1_val': 0.9959452881418331, 'auprc': 0.9909236698916194, 'loss_val': 0.030982122612907025, 'psi': 0.9939366408417476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=66 head_norm_before_train=1.900182 cos_to_last_merge=0.9241 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=66 local utility u=0.290896 metrics={'f1_val': 0.9922213645953034, 'auprc': 0.9897546987690105, 'loss_val': 0.03716323120237171, 'psi': 0.9912346982647862}-{'f1_val': 0.9422571201484787, 'auprc': 0.9864679707884451, 'loss_val': 0.3093095213211507, 'psi': 0.9599414604044652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=66 head_norm_before_train=1.771587 cos_to_last_merge=0.9161 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.916
[S17] round=66 local utility u=0.868002 metrics={'f1_val': 0.9030069519955198, 'auprc': 0.9774558266531169, 'loss_val': 0.21117639672673372, 'psi': 0.9327865018585586}-{'f1_val': 0.7553714564905694, 'auprc': 0.8487512425113253, 'loss_val': 0.6752530138291225, 'psi': 0.7927233708988717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=67 head_norm_before_train=1.742595 cos_to_last_merge=0.9063 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.624095596655843, 'auprc': 0.7563170016156024, 'loss_val': 1.48214326920527, 'psi': 0.6769841586397468}-{'f1_val': 0.7099113673380618, 'auprc': 0.7960729886436144, 'loss_val': 0.7162642132250249, 'psi': 0.7443760158602829}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.311460 (no previous merge yet)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.8548210548877788, 'auprc': 0.9958325805369539, 'loss_val': 0.2794057111274251, 'psi': 0.9112256651474488}-{'f1_val': 0.8552221943825893, 'auprc': 0.99521729932825, 'loss_val': 0.2698117146203029, 'psi': 0.9112202363608535}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=2.099220 (no previous merge yet)
[S4] round=67 local utility u=0.032000 metrics={'f1_val': 0.9422041182108236, 'auprc': 0.9487232012574287, 'loss_val': 0.3062214050917245, 'psi': 0.9448117514294656}-{'f1_val': 0.940527153354989, 'auprc': 0.9332221799976955, 'loss_val': 0.31365563374581257, 'psi': 0.9376051640120716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=67 head_norm_before_train=1.758243 cos_to_last_merge=0.7885 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=67 local utility u=0.001594 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9942162957976101, 'loss_val': 0.02752346126311514, 'psi': 0.9953106478578764}-{'f1_val': 0.9960402158980539, 'auprc': 0.9934170730862402, 'loss_val': 0.028313538885954666, 'psi': 0.9949909587733284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=67 head_norm_before_train=1.547545 cos_to_last_merge=0.8133 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.813
[S6] round=67 local utility u=0.268741 metrics={'f1_val': 0.8485660097397287, 'auprc': 0.981426286463625, 'loss_val': 0.27954241216661535, 'psi': 0.9017101204292872}-{'f1_val': 0.8122842042907257, 'auprc': 0.9501331646521002, 'loss_val': 0.5054538658495746, 'psi': 0.8674237884352755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=67 head_norm_before_train=1.520217 cos_to_last_merge=0.9282 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.928
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.6600834567123255, 'auprc': 0.8197237580561025, 'loss_val': 0.37264828872666195, 'psi': 0.7239395772498363}-{'f1_val': 0.686296003494283, 'auprc': 0.8632258285792708, 'loss_val': 0.2755880767285377, 'psi': 0.7570679335282782}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.005874 cos_to_last_merge=0.7381 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.7740687072505305, 'auprc': 0.9869750944835379, 'loss_val': 0.24613374062916832, 'psi': 0.8592312621437335}-{'f1_val': 0.9939919029218467, 'auprc': 0.9884450970042743, 'loss_val': 0.03063281402784407, 'psi': 0.9917731805548178}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=1.757066 cos_to_last_merge=0.8905 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9977739194334436, 'loss_val': 0.01795945393380688, 'psi': 0.9976365017797637}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991964768793038, 'loss_val': 0.01812923357283823, 'psi': 0.9979403382590072}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.922341 cos_to_last_merge=0.9392 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=67 local utility u=0.000422 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995832736023169, 'loss_val': 0.026998186345396115, 'psi': 0.9953951752549266}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957703820054078, 'loss_val': 0.027654768950882695, 'psi': 0.9953702336478221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=67 head_norm_before_train=2.253393 (no previous merge yet)
[S11] round=67 local utility u=0.002457 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974547668277138, 'loss_val': 0.020805607016991405, 'psi': 0.9969101094392393}-{'f1_val': 0.9961541414107454, 'auprc': 0.9968918728367948, 'loss_val': 0.0216742338920814, 'psi': 0.9964492339811651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=67 head_norm_before_train=1.735147 cos_to_last_merge=0.8295 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.829
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6907326925576807, 'auprc': 0.7962408478055072, 'loss_val': 0.7725466549367995, 'psi': 0.7329359546568113}-{'f1_val': 0.7254666039968852, 'auprc': 0.7830834476741805, 'loss_val': 0.6370116639773259, 'psi': 0.7485133414678034}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.903897 cos_to_last_merge=0.8612 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.861
[S14] round=67 local utility u=0.018187 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990433162860998, 'loss_val': 0.020021227153405503, 'psi': 0.9980639230751368}-{'f1_val': 0.9936569488964806, 'auprc': 0.9990312083231874, 'loss_val': 0.03383492148145127, 'psi': 0.9958066526671634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=67 head_norm_before_train=1.727175 cos_to_last_merge=0.8618 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.862
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9649842400107431, 'auprc': 0.988121393841519, 'loss_val': 0.06992524883446961, 'psi': 0.9742391015430535}-{'f1_val': 0.9959452881418331, 'auprc': 0.9905126578473032, 'loss_val': 0.029712559477384857, 'psi': 0.9937722360240212}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.905293 cos_to_last_merge=0.9236 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.924
[S16] round=67 local utility u=0.002114 metrics={'f1_val': 0.992432922715389, 'auprc': 0.9911707775527776, 'loss_val': 0.038453539162107774, 'psi': 0.9919280646503443}-{'f1_val': 0.9922213645953034, 'auprc': 0.9897546987690105, 'loss_val': 0.03716323120237171, 'psi': 0.9912346982647862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=67 head_norm_before_train=1.779459 cos_to_last_merge=0.9155 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.7639997155733276, 'auprc': 0.8126739288060004, 'loss_val': 0.7825615028687455, 'psi': 0.7834694008663967}-{'f1_val': 0.9030069519955198, 'auprc': 0.9774558266531169, 'loss_val': 0.21117639672673372, 'psi': 0.9327865018585586}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=1.746262 cos_to_last_merge=0.9061 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.6175014819222615, 'auprc': 0.7537877063231885, 'loss_val': 1.569344989667353, 'psi': 0.6720159716826323}-{'f1_val': 0.624095596655843, 'auprc': 0.7563170016156024, 'loss_val': 1.48214326920527, 'psi': 0.6769841586397468}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.317833 (no previous merge yet)
[S3] round=68 local utility u=0.378512 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9988242804247099, 'loss_val': 0.1663383215971301, 'psi': 0.9759204510548491}-{'f1_val': 0.8548210548877788, 'auprc': 0.9958325805369539, 'loss_val': 0.2794057111274251, 'psi': 0.9112256651474488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=68 head_norm_before_train=2.102823 (no previous merge yet)
[S4] round=68 local utility u=0.023145 metrics={'f1_val': 0.9467251882647638, 'auprc': 0.953823659773899, 'loss_val': 0.30235891055621206, 'psi': 0.9495645768684179}-{'f1_val': 0.9422041182108236, 'auprc': 0.9487232012574287, 'loss_val': 0.3062214050917245, 'psi': 0.9448117514294656}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=68 head_norm_before_train=1.767558 cos_to_last_merge=0.7879 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9918618664976314, 'loss_val': 0.02859793019276253, 'psi': 0.9943688761378849}-{'f1_val': 0.9960402158980539, 'auprc': 0.9942162957976101, 'loss_val': 0.02752346126311514, 'psi': 0.9953106478578764}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.559254 cos_to_last_merge=0.8118 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.812
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.4643929000352688, 'auprc': 0.7358127343858225, 'loss_val': 1.1567295772085502, 'psi': 0.5729608337754903}-{'f1_val': 0.8485660097397287, 'auprc': 0.981426286463625, 'loss_val': 0.27954241216661535, 'psi': 0.9017101204292872}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.526860 cos_to_last_merge=0.9274 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5657136572086228, 'auprc': 0.7798389360161408, 'loss_val': 1.0072602332662415, 'psi': 0.65136376873163}-{'f1_val': 0.6600834567123255, 'auprc': 0.8197237580561025, 'loss_val': 0.37264828872666195, 'psi': 0.7239395772498363}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=2.007593 cos_to_last_merge=0.7380 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=68 local utility u=0.777796 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9989064460492435, 'loss_val': 0.034969904275908965, 'psi': 0.9948671226377644}-{'f1_val': 0.7740687072505305, 'auprc': 0.9869750944835379, 'loss_val': 0.24613374062916832, 'psi': 0.8592312621437335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=68 head_norm_before_train=1.763642 cos_to_last_merge=0.8898 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=68 local utility u=0.002008 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9990458462435524, 'loss_val': 0.017759379408387982, 'psi': 0.9981452725038072}-{'f1_val': 0.9975448900106438, 'auprc': 0.9977739194334436, 'loss_val': 0.01795945393380688, 'psi': 0.9976365017797637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=68 head_norm_before_train=1.929452 cos_to_last_merge=0.9388 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958068101725548, 'loss_val': 0.02721614227915005, 'psi': 0.9953848049146808}-{'f1_val': 0.9951034680760983, 'auprc': 0.995832736023169, 'loss_val': 0.026998186345396115, 'psi': 0.9953951752549266}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.259201 (no previous merge yet)
[S11] round=68 local utility u=0.000168 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997467230277673, 'loss_val': 0.020507974006472376, 'psi': 0.9969150948192229}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974547668277138, 'loss_val': 0.020805607016991405, 'psi': 0.9969101094392393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=68 head_norm_before_train=1.740349 cos_to_last_merge=0.8286 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.829
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6589333486316057, 'auprc': 0.7830811992741535, 'loss_val': 0.837901176787085, 'psi': 0.7085924888886248}-{'f1_val': 0.6907326925576807, 'auprc': 0.7962408478055072, 'loss_val': 0.7725466549367995, 'psi': 0.7329359546568113}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.908486 cos_to_last_merge=0.8606 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.861
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9990414837576742, 'loss_val': 0.021576812160304028, 'psi': 0.9978430711567261}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990433162860998, 'loss_val': 0.020021227153405503, 'psi': 0.9980639230751368}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.734428 cos_to_last_merge=0.8611 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.861
[S15] round=68 local utility u=0.116512 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9906832548732445, 'loss_val': 0.030353361401582332, 'psi': 0.9938404748343976}-{'f1_val': 0.9649842400107431, 'auprc': 0.988121393841519, 'loss_val': 0.06992524883446961, 'psi': 0.9742391015430535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=68 head_norm_before_train=1.910210 cos_to_last_merge=0.9230 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=68 local utility u=0.001430 metrics={'f1_val': 0.992432922715389, 'auprc': 0.9919816282092389, 'loss_val': 0.038025146255781433, 'psi': 0.9922524049129289}-{'f1_val': 0.992432922715389, 'auprc': 0.9911707775527776, 'loss_val': 0.038453539162107774, 'psi': 0.9919280646503443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=68 head_norm_before_train=1.786952 cos_to_last_merge=0.9148 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.915
[S17] round=68 local utility u=1.000000 metrics={'f1_val': 0.9356737391745414, 'auprc': 0.9868576731098405, 'loss_val': 0.19814819918070825, 'psi': 0.956147312748661}-{'f1_val': 0.7639997155733276, 'auprc': 0.8126739288060004, 'loss_val': 0.7825615028687455, 'psi': 0.7834694008663967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=69 head_norm_before_train=1.752110 cos_to_last_merge=0.9056 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.906
[S2] round=69 local utility u=0.799954 metrics={'f1_val': 0.7105864853121057, 'auprc': 0.7994859491551394, 'loss_val': 0.6650410593606586, 'psi': 0.7461462708493192}-{'f1_val': 0.6175014819222615, 'auprc': 0.7537877063231885, 'loss_val': 1.569344989667353, 'psi': 0.6720159716826323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=69 head_norm_before_train=2.323754 (no previous merge yet)
[S3] round=69 local utility u=0.095362 metrics={'f1_val': 0.9747179186294904, 'auprc': 0.998542818882947, 'loss_val': 0.05917010777965709, 'psi': 0.984247878730873}-{'f1_val': 0.960651231474942, 'auprc': 0.9988242804247099, 'loss_val': 0.1663383215971301, 'psi': 0.9759204510548491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=69 head_norm_before_train=2.104241 (no previous merge yet)
[S4] round=69 local utility u=0.027827 metrics={'f1_val': 0.9550186442006492, 'auprc': 0.9556599964828507, 'loss_val': 0.3019748018499395, 'psi': 0.9552751851135298}-{'f1_val': 0.9467251882647638, 'auprc': 0.953823659773899, 'loss_val': 0.30235891055621206, 'psi': 0.9495645768684179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=69 head_norm_before_train=1.778465 cos_to_last_merge=0.7873 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=69 local utility u=0.002362 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9927986444000813, 'loss_val': 0.026684198570597294, 'psi': 0.9947435872988649}-{'f1_val': 0.9960402158980539, 'auprc': 0.9918618664976314, 'loss_val': 0.02859793019276253, 'psi': 0.9943688761378849}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=69 head_norm_before_train=1.566421 cos_to_last_merge=0.8107 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.811
[S6] round=69 local utility u=1.000000 metrics={'f1_val': 0.9067210350738767, 'auprc': 0.9508366127360443, 'loss_val': 0.25249724385588423, 'psi': 0.9243672661387438}-{'f1_val': 0.4643929000352688, 'auprc': 0.7358127343858225, 'loss_val': 1.1567295772085502, 'psi': 0.5729608337754903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=69 head_norm_before_train=1.532283 cos_to_last_merge=0.9267 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.927
[S7] round=69 local utility u=1.000000 metrics={'f1_val': 0.7225664437478905, 'auprc': 0.9292612718480416, 'loss_val': 0.21632801974580823, 'psi': 0.805244374987951}-{'f1_val': 0.5657136572086228, 'auprc': 0.7798389360161408, 'loss_val': 1.0072602332662415, 'psi': 0.65136376873163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=69 head_norm_before_train=2.010864 cos_to_last_merge=0.7378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9733196850875003, 'auprc': 0.9989057561870501, 'loss_val': 0.07842430807295898, 'psi': 0.9835541135273203}-{'f1_val': 0.992174240363445, 'auprc': 0.9989064460492435, 'loss_val': 0.034969904275908965, 'psi': 0.9948671226377644}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=69 head_norm_before_train=1.770369 cos_to_last_merge=0.8892 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.889
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.992684475148198, 'auprc': 0.9988043312221366, 'loss_val': 0.02961889453785346, 'psi': 0.9951324175777735}-{'f1_val': 0.9975448900106438, 'auprc': 0.9990458462435524, 'loss_val': 0.017759379408387982, 'psi': 0.9981452725038072}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=1.936599 cos_to_last_merge=0.9384 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=69 local utility u=0.000098 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957899755211331, 'loss_val': 0.026969720149254233, 'psi': 0.9953780710541122}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958068101725548, 'loss_val': 0.02721614227915005, 'psi': 0.9953848049146808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=69 head_norm_before_train=2.265686 (no previous merge yet)
[S11] round=69 local utility u=0.000809 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9978605477044539, 'loss_val': 0.02019367295500868, 'psi': 0.9970847014655098}-{'f1_val': 0.9965470045135896, 'auprc': 0.997467230277673, 'loss_val': 0.020507974006472376, 'psi': 0.9969150948192229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=69 head_norm_before_train=1.748760 cos_to_last_merge=0.8276 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=69 local utility u=0.119468 metrics={'f1_val': 0.6691698786514299, 'auprc': 0.8071861095628762, 'loss_val': 0.732699220711055, 'psi': 0.7243763710160085}-{'f1_val': 0.6589333486316057, 'auprc': 0.7830811992741535, 'loss_val': 0.837901176787085, 'psi': 0.7085924888886248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=69 head_norm_before_train=1.913704 cos_to_last_merge=0.8601 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=69 local utility u=0.000208 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9990415313033183, 'loss_val': 0.0211618624536642, 'psi': 0.9978430901749837}-{'f1_val': 0.9970441294227608, 'auprc': 0.9990414837576742, 'loss_val': 0.021576812160304028, 'psi': 0.9978430711567261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=69 head_norm_before_train=1.742060 cos_to_last_merge=0.8604 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=69 local utility u=0.002176 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9923438051920671, 'loss_val': 0.03098236576592531, 'psi': 0.9945046949619267}-{'f1_val': 0.9959452881418331, 'auprc': 0.9906832548732445, 'loss_val': 0.030353361401582332, 'psi': 0.9938404748343976}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=69 head_norm_before_train=1.913971 cos_to_last_merge=0.9225 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.923
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.875648262658475, 'auprc': 0.9800841677951948, 'loss_val': 0.7366534529586217, 'psi': 0.9174226247131629}-{'f1_val': 0.992432922715389, 'auprc': 0.9919816282092389, 'loss_val': 0.038025146255781433, 'psi': 0.9922524049129289}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.795290 cos_to_last_merge=0.9136 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.914
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.8617196752887815, 'auprc': 0.9547658449656732, 'loss_val': 0.47613089307497974, 'psi': 0.8989381431595381}-{'f1_val': 0.9356737391745414, 'auprc': 0.9868576731098405, 'loss_val': 0.19814819918070825, 'psi': 0.956147312748661}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=1.758391 cos_to_last_merge=0.9051 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.905
[S2] round=70 local utility u=0.053061 metrics={'f1_val': 0.7161652949149537, 'auprc': 0.857893742036953, 'loss_val': 0.7676143146618707, 'psi': 0.7728566737637534}-{'f1_val': 0.7105864853121057, 'auprc': 0.7994859491551394, 'loss_val': 0.6650410593606586, 'psi': 0.7461462708493192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=70 head_norm_before_train=2.329361 (no previous merge yet)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.9487997502444607, 'auprc': 0.9983850777923416, 'loss_val': 0.09869953020410702, 'psi': 0.968633881263613}-{'f1_val': 0.9747179186294904, 'auprc': 0.998542818882947, 'loss_val': 0.05917010777965709, 'psi': 0.984247878730873}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.103645 (no previous merge yet)
[S4] round=70 local utility u=0.000000 metrics={'f1_val': 0.9454454303253947, 'auprc': 0.9454662680392341, 'loss_val': 0.3070378475277514, 'psi': 0.9454537654109305}-{'f1_val': 0.9550186442006492, 'auprc': 0.9556599964828507, 'loss_val': 0.3019748018499395, 'psi': 0.9552751851135298}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=70 head_norm_before_train=1.787417 cos_to_last_merge=0.7866 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=70 local utility u=0.000303 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9930855603637542, 'loss_val': 0.02693947912729818, 'psi': 0.9948583536843341}-{'f1_val': 0.9960402158980539, 'auprc': 0.9927986444000813, 'loss_val': 0.026684198570597294, 'psi': 0.9947435872988649}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=70 head_norm_before_train=1.570387 cos_to_last_merge=0.8099 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.810
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.8245314790621099, 'auprc': 0.9602821412029994, 'loss_val': 0.38092873603411054, 'psi': 0.8788317439184656}-{'f1_val': 0.9067210350738767, 'auprc': 0.9508366127360443, 'loss_val': 0.25249724385588423, 'psi': 0.9243672661387438}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.535683 cos_to_last_merge=0.9263 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.6167651519866604, 'auprc': 0.7899830346002055, 'loss_val': 0.737037327618331, 'psi': 0.6860523050320784}-{'f1_val': 0.7225664437478905, 'auprc': 0.9292612718480416, 'loss_val': 0.21632801974580823, 'psi': 0.805244374987951}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.013942 cos_to_last_merge=0.7377 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=70 local utility u=0.070532 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9989442296885902, 'loss_val': 0.03757475721949559, 'psi': 0.9935793161382185}-{'f1_val': 0.9733196850875003, 'auprc': 0.9989057561870501, 'loss_val': 0.07842430807295898, 'psi': 0.9835541135273203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=70 head_norm_before_train=1.774314 cos_to_last_merge=0.8890 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.889
[S9] round=70 local utility u=0.016057 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991934580628775, 'loss_val': 0.02019106698541218, 'psi': 0.9974400006633947}-{'f1_val': 0.992684475148198, 'auprc': 0.9988043312221366, 'loss_val': 0.02961889453785346, 'psi': 0.9951324175777735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=70 head_norm_before_train=1.943729 cos_to_last_merge=0.9380 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=70 local utility u=0.000499 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958754473164353, 'loss_val': 0.02622785681562563, 'psi': 0.995412259772233}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957899755211331, 'loss_val': 0.026969720149254233, 'psi': 0.9953780710541122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=70 head_norm_before_train=2.272164 (no previous merge yet)
[S11] round=70 local utility u=0.001868 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979046018851738, 'loss_val': 0.01803948927546864, 'psi': 0.9972473506098168}-{'f1_val': 0.996567470639547, 'auprc': 0.9978605477044539, 'loss_val': 0.02019367295500868, 'psi': 0.9970847014655098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=70 head_norm_before_train=1.753903 cos_to_last_merge=0.8269 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6198528943802708, 'auprc': 0.7463968120565053, 'loss_val': 1.0741827753789297, 'psi': 0.6704704614507646}-{'f1_val': 0.6691698786514299, 'auprc': 0.8071861095628762, 'loss_val': 0.732699220711055, 'psi': 0.7243763710160085}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=1.918155 cos_to_last_merge=0.8599 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=70 local utility u=0.000396 metrics={'f1_val': 0.9970441294227608, 'auprc': 0.9990373334441047, 'loss_val': 0.020356605844140868, 'psi': 0.9978414110312983}-{'f1_val': 0.9970441294227608, 'auprc': 0.9990415313033183, 'loss_val': 0.0211618624536642, 'psi': 0.9978430901749837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=70 head_norm_before_train=1.749403 cos_to_last_merge=0.8597 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.860
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.8156698310488633, 'auprc': 0.9170809815759353, 'loss_val': 0.3931037071774651, 'psi': 0.8562342912596921}-{'f1_val': 0.9959452881418331, 'auprc': 0.9923438051920671, 'loss_val': 0.03098236576592531, 'psi': 0.9945046949619267}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.918846 cos_to_last_merge=0.9221 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=70 local utility u=0.310018 metrics={'f1_val': 0.9274863660173507, 'auprc': 0.9887389646396424, 'loss_val': 0.45360998746162595, 'psi': 0.9519874054662674}-{'f1_val': 0.875648262658475, 'auprc': 0.9800841677951948, 'loss_val': 0.7366534529586217, 'psi': 0.9174226247131629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=70 head_norm_before_train=1.801922 cos_to_last_merge=0.9127 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.6936573387827022, 'auprc': 0.7842469888868397, 'loss_val': 1.0732970165760445, 'psi': 0.7298931988243572}-{'f1_val': 0.8617196752887815, 'auprc': 0.9547658449656732, 'loss_val': 0.47613089307497974, 'psi': 0.8989381431595381}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=1.765738 cos_to_last_merge=0.9043 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.904
[S2] round=71 local utility u=0.039817 metrics={'f1_val': 0.7127084842618836, 'auprc': 0.8541156369643776, 'loss_val': 0.6559049208144045, 'psi': 0.7692713453428812}-{'f1_val': 0.7161652949149537, 'auprc': 0.857893742036953, 'loss_val': 0.7676143146618707, 'psi': 0.7728566737637534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=71 head_norm_before_train=2.333485 (no previous merge yet)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.8400036888693823, 'auprc': 0.9979185016349246, 'loss_val': 0.2956414988133785, 'psi': 0.9031696139755991}-{'f1_val': 0.9487997502444607, 'auprc': 0.9983850777923416, 'loss_val': 0.09869953020410702, 'psi': 0.968633881263613}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.106522 (no previous merge yet)
[S4] round=71 local utility u=0.043973 metrics={'f1_val': 0.9461273743632855, 'auprc': 0.969613746292258, 'loss_val': 0.2956258378369492, 'psi': 0.9555219231348746}-{'f1_val': 0.9454454303253947, 'auprc': 0.9454662680392341, 'loss_val': 0.3070378475277514, 'psi': 0.9454537654109305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=71 head_norm_before_train=1.788205 cos_to_last_merge=0.7867 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9926472318963403, 'loss_val': 0.02712143869487337, 'psi': 0.9946830222973685}-{'f1_val': 0.9960402158980539, 'auprc': 0.9930855603637542, 'loss_val': 0.02693947912729818, 'psi': 0.9948583536843341}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=71 head_norm_before_train=1.575639 cos_to_last_merge=0.8093 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.809
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6657940437171086, 'auprc': 0.8192114901022809, 'loss_val': 0.7775044967415482, 'psi': 0.7271610222711775}-{'f1_val': 0.8245314790621099, 'auprc': 0.9602821412029994, 'loss_val': 0.38092873603411054, 'psi': 0.8788317439184656}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.537787 cos_to_last_merge=0.9260 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=71 local utility u=1.000000 metrics={'f1_val': 0.8723184358146358, 'auprc': 0.9612219195847825, 'loss_val': 0.2110756678686938, 'psi': 0.9078798293226945}-{'f1_val': 0.6167651519866604, 'auprc': 0.7899830346002055, 'loss_val': 0.737037327618331, 'psi': 0.6860523050320784}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S7] sending update (kind=head size=1809 to 1 peers)
[S8] START round=71 head_norm_before_train=2.015659 cos_to_last_merge=0.7378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.9885656966123193, 'auprc': 0.998969078496143, 'loss_val': 0.04109508861029992, 'psi': 0.9927270493658488}-{'f1_val': 0.9900027071046373, 'auprc': 0.9989442296885902, 'loss_val': 0.03757475721949559, 'psi': 0.9935793161382185}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=1.777650 cos_to_last_merge=0.8884 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.888
[S9] round=71 local utility u=0.003758 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991960590287272, 'loss_val': 0.017673827623610038, 'psi': 0.9979401711187765}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991934580628775, 'loss_val': 0.02019106698541218, 'psi': 0.9974400006633947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=71 head_norm_before_train=1.950770 cos_to_last_merge=0.9376 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995341915678823, 'loss_val': 0.02884778056556205, 'psi': 0.9951988471171882}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958754473164353, 'loss_val': 0.02622785681562563, 'psi': 0.995412259772233}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=71 head_norm_before_train=2.276440 (no previous merge yet)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979396399323393, 'loss_val': 0.018363164381951985, 'psi': 0.9971163383566639}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979046018851738, 'loss_val': 0.01803948927546864, 'psi': 0.9972473506098168}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.757561 cos_to_last_merge=0.8263 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.826
[S13] round=71 local utility u=0.615929 metrics={'f1_val': 0.7457206553593716, 'auprc': 0.8052225621994864, 'loss_val': 0.7740083781557173, 'psi': 0.7695214180954175}-{'f1_val': 0.6198528943802708, 'auprc': 0.7463968120565053, 'loss_val': 1.0741827753789297, 'psi': 0.6704704614507646}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=71 head_norm_before_train=1.921163 cos_to_last_merge=0.8599 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=71 local utility u=0.002001 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9990353012411958, 'loss_val': 0.018549072165503094, 'psi': 0.9980607170571751}-{'f1_val': 0.9970441294227608, 'auprc': 0.9990373334441047, 'loss_val': 0.020356605844140868, 'psi': 0.9978414110312983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=71 head_norm_before_train=1.756562 cos_to_last_merge=0.8590 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.859
[S15] round=71 local utility u=0.493856 metrics={'f1_val': 0.9086884730938618, 'auprc': 0.9918994877364896, 'loss_val': 0.18795922847644622, 'psi': 0.941972878950913}-{'f1_val': 0.8156698310488633, 'auprc': 0.9170809815759353, 'loss_val': 0.3931037071774651, 'psi': 0.8562342912596921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=71 head_norm_before_train=1.923390 cos_to_last_merge=0.9216 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=71 local utility u=0.086867 metrics={'f1_val': 0.9394011308650579, 'auprc': 0.9907724813300225, 'loss_val': 0.3574660010575863, 'psi': 0.9599496710510438}-{'f1_val': 0.9274863660173507, 'auprc': 0.9887389646396424, 'loss_val': 0.45360998746162595, 'psi': 0.9519874054662674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=71 head_norm_before_train=1.803794 cos_to_last_merge=0.9125 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=71 local utility u=0.437638 metrics={'f1_val': 0.7439597463717806, 'auprc': 0.8537566565108687, 'loss_val': 0.7083645540351415, 'psi': 0.787878510427416}-{'f1_val': 0.6936573387827022, 'auprc': 0.7842469888868397, 'loss_val': 1.0732970165760445, 'psi': 0.7298931988243572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=72 head_norm_before_train=1.772431 cos_to_last_merge=0.9037 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.904
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.7130703880304872, 'auprc': 0.8571679654630343, 'loss_val': 0.7203542226886298, 'psi': 0.770709419003506}-{'f1_val': 0.7127084842618836, 'auprc': 0.8541156369643776, 'loss_val': 0.6559049208144045, 'psi': 0.7692713453428812}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.337055 (no previous merge yet)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.8033235703474862, 'auprc': 0.9983132164657621, 'loss_val': 0.4301533581039539, 'psi': 0.8813194287947965}-{'f1_val': 0.8400036888693823, 'auprc': 0.9979185016349246, 'loss_val': 0.2956414988133785, 'psi': 0.9031696139755991}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=2.108708 (no previous merge yet)
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9418519421026534, 'auprc': 0.9508157684126622, 'loss_val': 0.3006142362238344, 'psi': 0.9454374726266569}-{'f1_val': 0.9461273743632855, 'auprc': 0.969613746292258, 'loss_val': 0.2956258378369492, 'psi': 0.9555219231348746}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.791605 cos_to_last_merge=0.7867 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9921770806816596, 'loss_val': 0.027692348945579967, 'psi': 0.9944949618114962}-{'f1_val': 0.9960402158980539, 'auprc': 0.9926472318963403, 'loss_val': 0.02712143869487337, 'psi': 0.9946830222973685}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.583959 cos_to_last_merge=0.8083 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.808
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.9456662916316816, 'auprc': 0.9649496926020888, 'loss_val': 0.2148281084294348, 'psi': 0.9533796520198445}-{'f1_val': 0.6657940437171086, 'auprc': 0.8192114901022809, 'loss_val': 0.7775044967415482, 'psi': 0.7271610222711775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=72 head_norm_before_train=1.540480 cos_to_last_merge=0.9257 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.926
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.6251057523235388, 'auprc': 0.7913956493519448, 'loss_val': 0.6712851929548017, 'psi': 0.6916217111349012}-{'f1_val': 0.8723184358146358, 'auprc': 0.9612219195847825, 'loss_val': 0.2110756678686938, 'psi': 0.9078798293226945}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.020068 cos_to_last_merge=0.7374 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9843251159098583, 'auprc': 0.9989619200113259, 'loss_val': 0.05276390023029587, 'psi': 0.9901798375504453}-{'f1_val': 0.9885656966123193, 'auprc': 0.998969078496143, 'loss_val': 0.04109508861029992, 'psi': 0.9927270493658488}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=1.782490 cos_to_last_merge=0.8877 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.888
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9978388659550235, 'loss_val': 0.017428310555122013, 'psi': 0.9976624803883957}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991960590287272, 'loss_val': 0.017673827623610038, 'psi': 0.9979401711187765}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=1.953869 cos_to_last_merge=0.9369 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954142680603202, 'loss_val': 0.029285914622472858, 'psi': 0.9952277880697871}-{'f1_val': 0.9951034680760983, 'auprc': 0.995341915678823, 'loss_val': 0.02884778056556205, 'psi': 0.9951988471171882}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=72 head_norm_before_train=2.277113 (no previous merge yet)
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9975904315376675, 'loss_val': 0.018871625965354116, 'psi': 0.9967286574615142}-{'f1_val': 0.996567470639547, 'auprc': 0.9979396399323393, 'loss_val': 0.018363164381951985, 'psi': 0.9971163383566639}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.760175 cos_to_last_merge=0.8254 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.825
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6694131656414628, 'auprc': 0.7271903063766583, 'loss_val': 0.8815558869831648, 'psi': 0.692524021935541}-{'f1_val': 0.7457206553593716, 'auprc': 0.8052225621994864, 'loss_val': 0.7740083781557173, 'psi': 0.7695214180954175}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.924256 cos_to_last_merge=0.8594 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.859
[S14] round=72 local utility u=0.002266 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990384056274646, 'loss_val': 0.016491412057119074, 'psi': 0.9983084178636412}-{'f1_val': 0.9974109942678281, 'auprc': 0.9990353012411958, 'loss_val': 0.018549072165503094, 'psi': 0.9980607170571751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=72 head_norm_before_train=1.763202 cos_to_last_merge=0.8584 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=72 local utility u=0.338954 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9899677658993202, 'loss_val': 0.030378665339294637, 'psi': 0.9938124145459218}-{'f1_val': 0.9086884730938618, 'auprc': 0.9918994877364896, 'loss_val': 0.18795922847644622, 'psi': 0.941972878950913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=72 head_norm_before_train=1.928119 cos_to_last_merge=0.9211 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=72 local utility u=0.039707 metrics={'f1_val': 0.9427513677196487, 'auprc': 0.9916307922512994, 'loss_val': 0.3007276243642945, 'psi': 0.962303137532309}-{'f1_val': 0.9394011308650579, 'auprc': 0.9907724813300225, 'loss_val': 0.3574660010575863, 'psi': 0.9599496710510438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=72 head_norm_before_train=1.807757 cos_to_last_merge=0.9122 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.912
[S17] round=72 local utility u=1.000000 metrics={'f1_val': 0.9676996035758639, 'auprc': 0.9892067112177372, 'loss_val': 0.1334473291045425, 'psi': 0.9763024466326132}-{'f1_val': 0.7439597463717806, 'auprc': 0.8537566565108687, 'loss_val': 0.7083645540351415, 'psi': 0.787878510427416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=73 head_norm_before_train=1.779317 cos_to_last_merge=0.9031 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.903
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.6337948563528631, 'auprc': 0.7637800743581058, 'loss_val': 1.3062613673059942, 'psi': 0.6857889435549602}-{'f1_val': 0.7130703880304872, 'auprc': 0.8571679654630343, 'loss_val': 0.7203542226886298, 'psi': 0.770709419003506}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.341354 (no previous merge yet)
[S3] round=73 local utility u=0.287406 metrics={'f1_val': 0.8662220809788094, 'auprc': 0.9984298112992565, 'loss_val': 0.2330812642070224, 'psi': 0.9191051731069882}-{'f1_val': 0.8033235703474862, 'auprc': 0.9983132164657621, 'loss_val': 0.4301533581039539, 'psi': 0.8813194287947965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=73 head_norm_before_train=2.104947 (no previous merge yet)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9411084217558167, 'auprc': 0.9430669279841171, 'loss_val': 0.3052214257017278, 'psi': 0.9418918242471368}-{'f1_val': 0.9418519421026534, 'auprc': 0.9508157684126622, 'loss_val': 0.3006142362238344, 'psi': 0.9454374726266569}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.794881 cos_to_last_merge=0.7872 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=73 local utility u=0.001060 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9930410461505934, 'loss_val': 0.02816391461089155, 'psi': 0.9948405479990697}-{'f1_val': 0.9960402158980539, 'auprc': 0.9921770806816596, 'loss_val': 0.027692348945579967, 'psi': 0.9944949618114962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=73 head_norm_before_train=1.591506 cos_to_last_merge=0.8074 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.7589439658271382, 'auprc': 0.8824931228402981, 'loss_val': 0.6480010295156806, 'psi': 0.8083636286324022}-{'f1_val': 0.9456662916316816, 'auprc': 0.9649496926020888, 'loss_val': 0.2148281084294348, 'psi': 0.9533796520198445}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.544247 cos_to_last_merge=0.9251 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=73 local utility u=0.282267 metrics={'f1_val': 0.6800094368058043, 'auprc': 0.8012766013361183, 'loss_val': 0.46581581264021366, 'psi': 0.7285163026179299}-{'f1_val': 0.6251057523235388, 'auprc': 0.7913956493519448, 'loss_val': 0.6712851929548017, 'psi': 0.6916217111349012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=73 head_norm_before_train=2.026632 cos_to_last_merge=0.7365 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.736
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9770490004777783, 'auprc': 0.9989450130716417, 'loss_val': 0.06546933685237924, 'psi': 0.9858074055153236}-{'f1_val': 0.9843251159098583, 'auprc': 0.9989619200113259, 'loss_val': 0.05276390023029587, 'psi': 0.9901798375504453}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.788526 cos_to_last_merge=0.8870 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.887
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991952418527152, 'loss_val': 0.018856564585728746, 'psi': 0.9972905179273984}-{'f1_val': 0.9975448900106438, 'auprc': 0.9978388659550235, 'loss_val': 0.017428310555122013, 'psi': 0.9976624803883957}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=1.958638 cos_to_last_merge=0.9364 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=73 local utility u=0.002112 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958675256330041, 'loss_val': 0.02642162409189471, 'psi': 0.9954090910988606}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954142680603202, 'loss_val': 0.029285914622472858, 'psi': 0.9952277880697871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=73 head_norm_before_train=2.279786 (no previous merge yet)
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9970516836936439, 'loss_val': 0.02129753811463309, 'psi': 0.996658185795924}-{'f1_val': 0.9961541414107454, 'auprc': 0.9975904315376675, 'loss_val': 0.018871625965354116, 'psi': 0.9967286574615142}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.763921 cos_to_last_merge=0.8249 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.825
[S13] round=73 local utility u=0.010841 metrics={'f1_val': 0.6554885121144368, 'auprc': 0.7638775649045373, 'loss_val': 0.8863880712059057, 'psi': 0.698844133230477}-{'f1_val': 0.6694131656414628, 'auprc': 0.7271903063766583, 'loss_val': 0.8815558869831648, 'psi': 0.692524021935541}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=73 head_norm_before_train=1.928172 cos_to_last_merge=0.8588 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.859
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9773436860566118, 'auprc': 0.9990401759813134, 'loss_val': 0.04103435968623345, 'psi': 0.9860222820264926}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990384056274646, 'loss_val': 0.016491412057119074, 'psi': 0.9983084178636412}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.769918 cos_to_last_merge=0.8577 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.858
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.7227657663662208, 'auprc': 0.8255733337427782, 'loss_val': 0.5709960169432884, 'psi': 0.7638887933168438}-{'f1_val': 0.9963755136436562, 'auprc': 0.9899677658993202, 'loss_val': 0.030378665339294637, 'psi': 0.9938124145459218}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.933884 cos_to_last_merge=0.9207 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.921
[S16] round=73 local utility u=0.009474 metrics={'f1_val': 0.9431693244550438, 'auprc': 0.9916634125577602, 'loss_val': 0.28438576051359743, 'psi': 0.9625669596961304}-{'f1_val': 0.9427513677196487, 'auprc': 0.9916307922512994, 'loss_val': 0.3007276243642945, 'psi': 0.962303137532309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=73 head_norm_before_train=1.813865 cos_to_last_merge=0.9115 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8386928853266113, 'auprc': 0.9235064994073662, 'loss_val': 0.6012090476293965, 'psi': 0.8726183309589133}-{'f1_val': 0.9676996035758639, 'auprc': 0.9892067112177372, 'loss_val': 0.1334473291045425, 'psi': 0.9763024466326132}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=1.785751 cos_to_last_merge=0.9024 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=74 local utility u=0.035777 metrics={'f1_val': 0.6329341543930166, 'auprc': 0.7780408704600177, 'loss_val': 1.272325554917994, 'psi': 0.6909768408198171}-{'f1_val': 0.6337948563528631, 'auprc': 0.7637800743581058, 'loss_val': 1.3062613673059942, 'psi': 0.6857889435549602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=74 head_norm_before_train=2.345421 (no previous merge yet)
[S3] round=74 local utility u=0.115332 metrics={'f1_val': 0.895510494309472, 'auprc': 0.9984437300707749, 'loss_val': 0.17818958349119327, 'psi': 0.9366837886139932}-{'f1_val': 0.8662220809788094, 'auprc': 0.9984298112992565, 'loss_val': 0.2330812642070224, 'psi': 0.9191051731069882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=74 head_norm_before_train=2.103746 (no previous merge yet)
[S4] round=74 local utility u=0.058195 metrics={'f1_val': 0.9444747428349096, 'auprc': 0.9725636686560408, 'loss_val': 0.2975189825201243, 'psi': 0.9557103131633622}-{'f1_val': 0.9411084217558167, 'auprc': 0.9430669279841171, 'loss_val': 0.3052214257017278, 'psi': 0.9418918242471368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=74 head_norm_before_train=1.796868 cos_to_last_merge=0.7877 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9925685826017034, 'loss_val': 0.028390674203124633, 'psi': 0.9946515625795138}-{'f1_val': 0.9960402158980539, 'auprc': 0.9930410461505934, 'loss_val': 0.02816391461089155, 'psi': 0.9948405479990697}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.597364 cos_to_last_merge=0.8067 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.807
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.6179023644269687, 'auprc': 0.8141698338761788, 'loss_val': 0.8700524325662169, 'psi': 0.6964093522066528}-{'f1_val': 0.7589439658271382, 'auprc': 0.8824931228402981, 'loss_val': 0.6480010295156806, 'psi': 0.8083636286324022}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.548047 cos_to_last_merge=0.9246 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.925
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6743510248514842, 'auprc': 0.8007125076278412, 'loss_val': 0.4823361187997219, 'psi': 0.724895617962027}-{'f1_val': 0.6800094368058043, 'auprc': 0.8012766013361183, 'loss_val': 0.46581581264021366, 'psi': 0.7285163026179299}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.033587 cos_to_last_merge=0.7357 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.736
[S8] round=74 local utility u=0.031285 metrics={'f1_val': 0.9906464420741318, 'auprc': 0.9870933742647353, 'loss_val': 0.04892837260237338, 'psi': 0.9892252149503732}-{'f1_val': 0.9770490004777783, 'auprc': 0.9989450130716417, 'loss_val': 0.06546933685237924, 'psi': 0.9858074055153236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=74 head_norm_before_train=1.794641 cos_to_last_merge=0.8864 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.886
[S9] round=74 local utility u=0.003969 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991952487852207, 'loss_val': 0.017412687723901393, 'psi': 0.997939847021374}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991952418527152, 'loss_val': 0.018856564585728746, 'psi': 0.9972905179273984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=74 head_norm_before_train=1.961601 cos_to_last_merge=0.9357 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=74 local utility u=0.000261 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959350035544984, 'loss_val': 0.026102866082338565, 'psi': 0.9954360822674583}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958675256330041, 'loss_val': 0.02642162409189471, 'psi': 0.9954090910988606}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=74 head_norm_before_train=2.280576 (no previous merge yet)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9970448393530049, 'loss_val': 0.021971599742915876, 'psi': 0.9965104205876492}-{'f1_val': 0.9963958538641108, 'auprc': 0.9970516836936439, 'loss_val': 0.02129753811463309, 'psi': 0.996658185795924}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.766447 cos_to_last_merge=0.8242 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.824
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6634110261731596, 'auprc': 0.6993227864591474, 'loss_val': 0.8755677485479941, 'psi': 0.6777757302875547}-{'f1_val': 0.6554885121144368, 'auprc': 0.7638775649045373, 'loss_val': 0.8863880712059057, 'psi': 0.698844133230477}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=1.932832 cos_to_last_merge=0.8582 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.858
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9355213399565925, 'auprc': 0.9986434158466204, 'loss_val': 0.12737030616741707, 'psi': 0.9607701703126037}-{'f1_val': 0.9773436860566118, 'auprc': 0.9990401759813134, 'loss_val': 0.04103435968623345, 'psi': 0.9860222820264926}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.776513 cos_to_last_merge=0.8571 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.857
[S15] round=74 local utility u=1.000000 metrics={'f1_val': 0.9898696501158502, 'auprc': 0.9921550026802188, 'loss_val': 0.05891375244123875, 'psi': 0.9907837911415976}-{'f1_val': 0.7227657663662208, 'auprc': 0.8255733337427782, 'loss_val': 0.5709960169432884, 'psi': 0.7638887933168438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=74 head_norm_before_train=1.938465 cos_to_last_merge=0.9202 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=74 local utility u=0.035930 metrics={'f1_val': 0.9446327382191118, 'auprc': 0.9914217173190505, 'loss_val': 0.22058120366343875, 'psi': 0.9633483298590872}-{'f1_val': 0.9431693244550438, 'auprc': 0.9916634125577602, 'loss_val': 0.28438576051359743, 'psi': 0.9625669596961304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=74 head_norm_before_train=1.818507 cos_to_last_merge=0.9108 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.7392700566473205, 'auprc': 0.7718307311301662, 'loss_val': 1.0208247694460142, 'psi': 0.7522943264404588}-{'f1_val': 0.8386928853266113, 'auprc': 0.9235064994073662, 'loss_val': 0.6012090476293965, 'psi': 0.8726183309589133}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=1.791415 cos_to_last_merge=0.9020 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=75 local utility u=0.676108 metrics={'f1_val': 0.7355780340690101, 'auprc': 0.802235026892909, 'loss_val': 0.6085559758817732, 'psi': 0.7622408311985697}-{'f1_val': 0.6329341543930166, 'auprc': 0.7780408704600177, 'loss_val': 1.272325554917994, 'psi': 0.6909768408198171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=75 head_norm_before_train=2.350186 (no previous merge yet)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.7586183766252845, 'auprc': 0.9974354460281696, 'loss_val': 0.4940386071224688, 'psi': 0.8541452043864386}-{'f1_val': 0.895510494309472, 'auprc': 0.9984437300707749, 'loss_val': 0.17818958349119327, 'psi': 0.9366837886139932}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=2.104147 (no previous merge yet)
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9417491312533266, 'auprc': 0.9462532498217253, 'loss_val': 0.3072122504528339, 'psi': 0.943550778680686}-{'f1_val': 0.9444747428349096, 'auprc': 0.9725636686560408, 'loss_val': 0.2975189825201243, 'psi': 0.9557103131633622}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.802772 cos_to_last_merge=0.7879 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9895281019751379, 'loss_val': 0.03660685136179872, 'psi': 0.9934353703288875}-{'f1_val': 0.9960402158980539, 'auprc': 0.9925685826017034, 'loss_val': 0.028390674203124633, 'psi': 0.9946515625795138}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.601027 cos_to_last_merge=0.8061 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.806
[S6] round=75 local utility u=1.000000 metrics={'f1_val': 0.8294821768723728, 'auprc': 0.9603411182665127, 'loss_val': 0.29121547843333756, 'psi': 0.8818257534300288}-{'f1_val': 0.6179023644269687, 'auprc': 0.8141698338761788, 'loss_val': 0.8700524325662169, 'psi': 0.6964093522066528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=75 head_norm_before_train=1.550312 cos_to_last_merge=0.9243 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.6609181208715655, 'auprc': 0.7971621352983511, 'loss_val': 0.5568128631111308, 'psi': 0.7154157266422798}-{'f1_val': 0.6743510248514842, 'auprc': 0.8007125076278412, 'loss_val': 0.4823361187997219, 'psi': 0.724895617962027}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.035449 cos_to_last_merge=0.7370 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9716786568830216, 'auprc': 0.998934322333789, 'loss_val': 0.08100941490195776, 'psi': 0.9825809230633286}-{'f1_val': 0.9906464420741318, 'auprc': 0.9870933742647353, 'loss_val': 0.04892837260237338, 'psi': 0.9892252149503732}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=1.800498 cos_to_last_merge=0.8859 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.886
[S9] round=75 local utility u=0.000086 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991955354870516, 'loss_val': 0.01724165040383894, 'psi': 0.9979399617021063}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991952487852207, 'loss_val': 0.017412687723901393, 'psi': 0.997939847021374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=75 head_norm_before_train=1.965280 cos_to_last_merge=0.9351 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9956554653192452, 'loss_val': 0.027007056963147674, 'psi': 0.9953242669733571}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959350035544984, 'loss_val': 0.026102866082338565, 'psi': 0.9954360822674583}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=75 head_norm_before_train=2.282445 (no previous merge yet)
[S11] round=75 local utility u=0.001526 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9974549705037514, 'loss_val': 0.02014917299096031, 'psi': 0.9966744730479478}-{'f1_val': 0.9961541414107454, 'auprc': 0.9970448393530049, 'loss_val': 0.021971599742915876, 'psi': 0.9965104205876492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=75 head_norm_before_train=1.773867 cos_to_last_merge=0.8231 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=75 local utility u=0.139742 metrics={'f1_val': 0.6882764049960941, 'auprc': 0.780060148285231, 'loss_val': 0.9874881175784683, 'psi': 0.7249899023117488}-{'f1_val': 0.6634110261731596, 'auprc': 0.6993227864591474, 'loss_val': 0.8755677485479941, 'psi': 0.6777757302875547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=75 head_norm_before_train=1.936652 cos_to_last_merge=0.8572 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.857
[S14] round=75 local utility u=0.200032 metrics={'f1_val': 0.9866771859651037, 'auprc': 0.9986498871590659, 'loss_val': 0.03426168832493296, 'psi': 0.9914662664426885}-{'f1_val': 0.9355213399565925, 'auprc': 0.9986434158466204, 'loss_val': 0.12737030616741707, 'psi': 0.9607701703126037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=75 head_norm_before_train=1.782226 cos_to_last_merge=0.8565 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.857
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.8953362492509694, 'auprc': 0.9381048901181624, 'loss_val': 0.3321099205986344, 'psi': 0.9124437055978467}-{'f1_val': 0.9898696501158502, 'auprc': 0.9921550026802188, 'loss_val': 0.05891375244123875, 'psi': 0.9907837911415976}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=1.941024 cos_to_last_merge=0.9197 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.9429603374246779, 'auprc': 0.9917143720664751, 'loss_val': 0.2841391822982864, 'psi': 0.9624619512813968}-{'f1_val': 0.9446327382191118, 'auprc': 0.9914217173190505, 'loss_val': 0.22058120366343875, 'psi': 0.9633483298590872}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.825272 cos_to_last_merge=0.9100 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.910
[S17] round=75 local utility u=0.129759 metrics={'f1_val': 0.7570161476637913, 'auprc': 0.7886528299293841, 'loss_val': 0.9182500094060485, 'psi': 0.7696708205700284}-{'f1_val': 0.7392700566473205, 'auprc': 0.7718307311301662, 'loss_val': 1.0208247694460142, 'psi': 0.7522943264404588}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=76 head_norm_before_train=1.796089 cos_to_last_merge=0.9017 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.902
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7090841612355863, 'auprc': 0.8458910545364482, 'loss_val': 0.7229714152859984, 'psi': 0.7638069185559311}-{'f1_val': 0.7355780340690101, 'auprc': 0.802235026892909, 'loss_val': 0.6085559758817732, 'psi': 0.7622408311985697}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.355529 (no previous merge yet)
[S3] round=76 local utility u=0.538252 metrics={'f1_val': 0.8892534913941597, 'auprc': 0.9984488348227039, 'loss_val': 0.20438625486548162, 'psi': 0.9329316287655773}-{'f1_val': 0.7586183766252845, 'auprc': 0.9974354460281696, 'loss_val': 0.4940386071224688, 'psi': 0.8541452043864386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=76 head_norm_before_train=2.106880 (no previous merge yet)
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9412276445178785, 'auprc': 0.9473317522732935, 'loss_val': 0.3073690810463775, 'psi': 0.9436692876200445}-{'f1_val': 0.9417491312533266, 'auprc': 0.9462532498217253, 'loss_val': 0.3072122504528339, 'psi': 0.943550778680686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.810374 cos_to_last_merge=0.7882 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=76 local utility u=0.008319 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9922518323882326, 'loss_val': 0.02814077854075809, 'psi': 0.9945248624941254}-{'f1_val': 0.9960402158980539, 'auprc': 0.9895281019751379, 'loss_val': 0.03660685136179872, 'psi': 0.9934353703288875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=76 head_norm_before_train=1.606004 cos_to_last_merge=0.8049 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.805
[S6] round=76 local utility u=0.000000 metrics={'f1_val': 0.8240863740918978, 'auprc': 0.9598927347351602, 'loss_val': 0.4275714865718953, 'psi': 0.8784089183492028}-{'f1_val': 0.8294821768723728, 'auprc': 0.9603411182665127, 'loss_val': 0.29121547843333756, 'psi': 0.8818257534300288}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=76 head_norm_before_train=1.553289 cos_to_last_merge=0.9239 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.924
[S7] round=76 local utility u=0.028336 metrics={'f1_val': 0.6583750216100667, 'auprc': 0.8045721524586988, 'loss_val': 0.50711276307477, 'psi': 0.7168538739495196}-{'f1_val': 0.6609181208715655, 'auprc': 0.7971621352983511, 'loss_val': 0.5568128631111308, 'psi': 0.7154157266422798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=76 head_norm_before_train=2.037717 cos_to_last_merge=0.7378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=76 local utility u=0.070136 metrics={'f1_val': 0.9882077600002297, 'auprc': 0.99896415189729, 'loss_val': 0.04000137895278192, 'psi': 0.9925103167590539}-{'f1_val': 0.9716786568830216, 'auprc': 0.998934322333789, 'loss_val': 0.08100941490195776, 'psi': 0.9825809230633286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=76 head_norm_before_train=1.803405 cos_to_last_merge=0.8853 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.885
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9991977223538466, 'loss_val': 0.022040906228848453, 'psi': 0.9970423557384388}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991955354870516, 'loss_val': 0.01724165040383894, 'psi': 0.9979399617021063}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.970331 cos_to_last_merge=0.9346 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=76 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9955122042263855, 'loss_val': 0.027631621830443577, 'psi': 0.9952669625362132}-{'f1_val': 0.9951034680760983, 'auprc': 0.9956554653192452, 'loss_val': 0.027007056963147674, 'psi': 0.9953242669733571}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=76 head_norm_before_train=2.285225 (no previous merge yet)
[S11] round=76 local utility u=0.003035 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9975695352900769, 'loss_val': 0.01835260817105296, 'psi': 0.997113323971778}-{'f1_val': 0.9961541414107454, 'auprc': 0.9974549705037514, 'loss_val': 0.02014917299096031, 'psi': 0.9966744730479478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=76 head_norm_before_train=1.780887 cos_to_last_merge=0.8218 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.822
[S13] round=76 local utility u=0.232705 metrics={'f1_val': 0.7361324847098718, 'auprc': 0.7726544027814966, 'loss_val': 0.786998101637445, 'psi': 0.7507412519385217}-{'f1_val': 0.6882764049960941, 'auprc': 0.780060148285231, 'loss_val': 0.9874881175784683, 'psi': 0.7249899023117488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=76 head_norm_before_train=1.941129 cos_to_last_merge=0.8567 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.857
[S14] round=76 local utility u=0.043042 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9990462682120906, 'loss_val': 0.018702054451872833, 'psi': 0.9985583137611592}-{'f1_val': 0.9866771859651037, 'auprc': 0.9986498871590659, 'loss_val': 0.03426168832493296, 'psi': 0.9914662664426885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=76 head_norm_before_train=1.788439 cos_to_last_merge=0.8559 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.856
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.890146796923381, 'auprc': 0.9153725537897277, 'loss_val': 0.3623437841736553, 'psi': 0.9002370996699197}-{'f1_val': 0.8953362492509694, 'auprc': 0.9381048901181624, 'loss_val': 0.3321099205986344, 'psi': 0.9124437055978467}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.944644 cos_to_last_merge=0.9192 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.8550528824206702, 'auprc': 0.9848218511497691, 'loss_val': 1.0422152079671165, 'psi': 0.9069604699123098}-{'f1_val': 0.9429603374246779, 'auprc': 0.9917143720664751, 'loss_val': 0.2841391822982864, 'psi': 0.9624619512813968}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=1.830892 cos_to_last_merge=0.9095 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=76 local utility u=1.000000 metrics={'f1_val': 0.8967712842263396, 'auprc': 0.9740798872390385, 'loss_val': 0.2742166706107229, 'psi': 0.9276947254314192}-{'f1_val': 0.7570161476637913, 'auprc': 0.7886528299293841, 'loss_val': 0.9182500094060485, 'psi': 0.7696708205700284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=77 head_norm_before_train=1.801200 cos_to_last_merge=0.9012 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.901
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.6738564570847223, 'auprc': 0.7857529737153828, 'loss_val': 0.9745240844353046, 'psi': 0.7186150637369866}-{'f1_val': 0.7090841612355863, 'auprc': 0.8458910545364482, 'loss_val': 0.7229714152859984, 'psi': 0.7638069185559311}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.361103 (no previous merge yet)
[S3] round=77 local utility u=0.072158 metrics={'f1_val': 0.9079780967684641, 'auprc': 0.9983850705210462, 'loss_val': 0.17222602381148316, 'psi': 0.9441408862694969}-{'f1_val': 0.8892534913941597, 'auprc': 0.9984488348227039, 'loss_val': 0.20438625486548162, 'psi': 0.9329316287655773}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=77 head_norm_before_train=2.111290 (no previous merge yet)
[S4] round=77 local utility u=0.070655 metrics={'f1_val': 0.9439050394831451, 'auprc': 0.9839755639847759, 'loss_val': 0.29205538793250646, 'psi': 0.9599332492837973}-{'f1_val': 0.9412276445178785, 'auprc': 0.9473317522732935, 'loss_val': 0.3073690810463775, 'psi': 0.9436692876200445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=77 head_norm_before_train=1.813552 cos_to_last_merge=0.7881 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=77 local utility u=0.011348 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9988580150044549, 'loss_val': 0.02613733522893945, 'psi': 0.9972548199873685}-{'f1_val': 0.9960402158980539, 'auprc': 0.9922518323882326, 'loss_val': 0.02814077854075809, 'psi': 0.9945248624941254}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=77 head_norm_before_train=1.611734 cos_to_last_merge=0.8037 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.804
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.5911411338105019, 'auprc': 0.638899414445386, 'loss_val': 1.2066227907150613, 'psi': 0.6102444460644556}-{'f1_val': 0.8240863740918978, 'auprc': 0.9598927347351602, 'loss_val': 0.4275714865718953, 'psi': 0.8784089183492028}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.557620 cos_to_last_merge=0.9233 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.641591022979864, 'auprc': 0.8106940425693695, 'loss_val': 0.43161825635318646, 'psi': 0.7092322308156662}-{'f1_val': 0.6583750216100667, 'auprc': 0.8045721524586988, 'loss_val': 0.50711276307477, 'psi': 0.7168538739495196}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=2.036722 cos_to_last_merge=0.7384 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=77 local utility u=0.000700 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9876897125484381, 'loss_val': 0.03412514582100162, 'psi': 0.9909353141415951}-{'f1_val': 0.9882077600002297, 'auprc': 0.99896415189729, 'loss_val': 0.04000137895278192, 'psi': 0.9925103167590539}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=77 head_norm_before_train=1.804635 cos_to_last_merge=0.8849 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.885
[S9] round=77 local utility u=0.001687 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9991974552758087, 'loss_val': 0.02115832572974921, 'psi': 0.9972914032966358}-{'f1_val': 0.9956054446615002, 'auprc': 0.9991977223538466, 'loss_val': 0.022040906228848453, 'psi': 0.9970423557384388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=77 head_norm_before_train=1.976015 cos_to_last_merge=0.9342 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=77 local utility u=0.001611 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958670994763392, 'loss_val': 0.025475202897658658, 'psi': 0.9954089206361947}-{'f1_val': 0.9951034680760983, 'auprc': 0.9955122042263855, 'loss_val': 0.027631621830443577, 'psi': 0.9952669625362132}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=77 head_norm_before_train=2.289894 (no previous merge yet)
[S11] round=77 local utility u=0.000395 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9978055954335272, 'loss_val': 0.018271576048121744, 'psi': 0.9972077480291581}-{'f1_val': 0.9968091830929121, 'auprc': 0.9975695352900769, 'loss_val': 0.01835260817105296, 'psi': 0.997113323971778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=77 head_norm_before_train=1.787776 cos_to_last_merge=0.8209 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.821
[S13] round=77 local utility u=0.151881 metrics={'f1_val': 0.7577667236568953, 'auprc': 0.8171842423633122, 'loss_val': 0.7466317104213367, 'psi': 0.7815337311394621}-{'f1_val': 0.7361324847098718, 'auprc': 0.7726544027814966, 'loss_val': 0.786998101637445, 'psi': 0.7507412519385217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=77 head_norm_before_train=1.943725 cos_to_last_merge=0.8566 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.857
[S14] round=77 local utility u=0.000314 metrics={'f1_val': 0.997844401637113, 'auprc': 0.9990449375059843, 'loss_val': 0.015738747872852146, 'psi': 0.9983246159846615}-{'f1_val': 0.9982330107938716, 'auprc': 0.9990462682120906, 'loss_val': 0.018702054451872833, 'psi': 0.9985583137611592}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=77 head_norm_before_train=1.795534 cos_to_last_merge=0.8552 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.855
[S15] round=77 local utility u=0.531298 metrics={'f1_val': 0.9872609095933564, 'auprc': 0.9792996576198314, 'loss_val': 0.07421290572250169, 'psi': 0.9840764088039464}-{'f1_val': 0.890146796923381, 'auprc': 0.9153725537897277, 'loss_val': 0.3623437841736553, 'psi': 0.9002370996699197}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=77 head_norm_before_train=1.946497 cos_to_last_merge=0.9186 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.919
[S16] round=77 local utility u=0.350381 metrics={'f1_val': 0.8926754606331592, 'auprc': 0.9866214423749889, 'loss_val': 0.5725876739614747, 'psi': 0.9302538533298912}-{'f1_val': 0.8550528824206702, 'auprc': 0.9848218511497691, 'loss_val': 1.0422152079671165, 'psi': 0.9069604699123098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=77 head_norm_before_train=1.836930 cos_to_last_merge=0.9090 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=77 local utility u=0.038432 metrics={'f1_val': 0.9015025177134588, 'auprc': 0.977956351983752, 'loss_val': 0.23737008313498914, 'psi': 0.932084051421576}-{'f1_val': 0.8967712842263396, 'auprc': 0.9740798872390385, 'loss_val': 0.2742166706107229, 'psi': 0.9276947254314192}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=78 head_norm_before_train=1.805594 cos_to_last_merge=0.9007 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.901
[S2] round=78 local utility u=0.112843 metrics={'f1_val': 0.6878384620018906, 'auprc': 0.7916090204748383, 'loss_val': 0.8502984935138173, 'psi': 0.7293466853910697}-{'f1_val': 0.6738564570847223, 'auprc': 0.7857529737153828, 'loss_val': 0.9745240844353046, 'psi': 0.7186150637369866}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=78 head_norm_before_train=2.366378 (no previous merge yet)
[S3] round=78 local utility u=0.000000 metrics={'f1_val': 0.8738964759828021, 'auprc': 0.986068813585577, 'loss_val': 0.2494110443341266, 'psi': 0.9187654110239121}-{'f1_val': 0.9079780967684641, 'auprc': 0.9983850705210462, 'loss_val': 0.17222602381148316, 'psi': 0.9441408862694969}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=78 head_norm_before_train=2.113432 (no previous merge yet)
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9419019930161509, 'auprc': 0.982363088942562, 'loss_val': 0.3014579909808465, 'psi': 0.9580864313867152}-{'f1_val': 0.9439050394831451, 'auprc': 0.9839755639847759, 'loss_val': 0.29205538793250646, 'psi': 0.9599332492837973}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.816190 cos_to_last_merge=0.7879 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9908510236736755, 'loss_val': 0.02773254535252866, 'psi': 0.9939645390083026}-{'f1_val': 0.996186023309311, 'auprc': 0.9988580150044549, 'loss_val': 0.02613733522893945, 'psi': 0.9972548199873685}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=1.617007 cos_to_last_merge=0.8025 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.803
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.9557458973165018, 'auprc': 0.9387102471107822, 'loss_val': 0.21928439217678494, 'psi': 0.9489316372342139}-{'f1_val': 0.5911411338105019, 'auprc': 0.638899414445386, 'loss_val': 1.2066227907150613, 'psi': 0.6102444460644556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=78 head_norm_before_train=1.562989 cos_to_last_merge=0.9226 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.923
[S7] round=78 local utility u=0.147540 metrics={'f1_val': 0.6676753908606866, 'auprc': 0.8314553003609377, 'loss_val': 0.3553287203059519, 'psi': 0.733187354660787}-{'f1_val': 0.641591022979864, 'auprc': 0.8106940425693695, 'loss_val': 0.43161825635318646, 'psi': 0.7092322308156662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=78 head_norm_before_train=2.034434 cos_to_last_merge=0.7389 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9713448724897822, 'auprc': 0.9964740339033322, 'loss_val': 0.08211328672697961, 'psi': 0.9813965370552022}-{'f1_val': 0.9930990485370332, 'auprc': 0.9876897125484381, 'loss_val': 0.03412514582100162, 'psi': 0.9909353141415951}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.807381 cos_to_last_merge=0.8843 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=78 local utility u=0.005025 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991960590287272, 'loss_val': 0.01759735629978161, 'psi': 0.9979401711187765}-{'f1_val': 0.9960207019771873, 'auprc': 0.9991974552758087, 'loss_val': 0.02115832572974921, 'psi': 0.9972914032966358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=78 head_norm_before_train=1.982088 cos_to_last_merge=0.9339 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=78 local utility u=0.000067 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959145771461801, 'loss_val': 0.02548376216783088, 'psi': 0.995427911704131}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958670994763392, 'loss_val': 0.025475202897658658, 'psi': 0.9954089206361947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=78 head_norm_before_train=2.294233 (no previous merge yet)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976924337377278, 'loss_val': 0.02040074265654476, 'psi': 0.9970051762032448}-{'f1_val': 0.9968091830929121, 'auprc': 0.9978055954335272, 'loss_val': 0.018271576048121744, 'psi': 0.9972077480291581}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.793643 cos_to_last_merge=0.8203 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.820
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6245571220159445, 'auprc': 0.6965375955782631, 'loss_val': 1.0439709163452322, 'psi': 0.6533493114408719}-{'f1_val': 0.7577667236568953, 'auprc': 0.8171842423633122, 'loss_val': 0.7466317104213367, 'psi': 0.7815337311394621}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.946491 cos_to_last_merge=0.8567 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.857
[S14] round=78 local utility u=0.000284 metrics={'f1_val': 0.9978223933154866, 'auprc': 0.9990442853317197, 'loss_val': 0.015036018483883643, 'psi': 0.9983111501219799}-{'f1_val': 0.997844401637113, 'auprc': 0.9990449375059843, 'loss_val': 0.015738747872852146, 'psi': 0.9983246159846615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=78 head_norm_before_train=1.802239 cos_to_last_merge=0.8546 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.855
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.7014419852622074, 'auprc': 0.7329725043989171, 'loss_val': 0.7191970786353502, 'psi': 0.7140541929168913}-{'f1_val': 0.9872609095933564, 'auprc': 0.9792996576198314, 'loss_val': 0.07421290572250169, 'psi': 0.9840764088039464}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=1.947505 cos_to_last_merge=0.9179 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.8620142749671905, 'auprc': 0.9836117271856893, 'loss_val': 0.6291231617426137, 'psi': 0.9106532558545901}-{'f1_val': 0.8926754606331592, 'auprc': 0.9866214423749889, 'loss_val': 0.5725876739614747, 'psi': 0.9302538533298912}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.843187 cos_to_last_merge=0.9086 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.6770811960965972, 'auprc': 0.7719251609016591, 'loss_val': 1.3498826424367385, 'psi': 0.715018782018622}-{'f1_val': 0.9015025177134588, 'auprc': 0.977956351983752, 'loss_val': 0.23737008313498914, 'psi': 0.932084051421576}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=1.808515 cos_to_last_merge=0.9006 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.901
[S2] round=79 local utility u=0.140394 metrics={'f1_val': 0.7109465252397018, 'auprc': 0.8021513500546437, 'loss_val': 0.7397856287924922, 'psi': 0.7474284551656786}-{'f1_val': 0.6878384620018906, 'auprc': 0.7916090204748383, 'loss_val': 0.8502984935138173, 'psi': 0.7293466853910697}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=80 psi=0.747 u=0.1404 p_local=0.1320 f1=0.711 auprc=0.802 bytes=75582
[S3] START round=79 head_norm_before_train=2.371372 (no previous merge yet)
[S3] round=79 local utility u=0.425342 metrics={'f1_val': 0.9777018272502712, 'auprc': 0.9987025353815316, 'loss_val': 0.05945976695273299, 'psi': 0.9861021105027754}-{'f1_val': 0.8738964759828021, 'auprc': 0.986068813585577, 'loss_val': 0.2494110443341266, 'psi': 0.9187654110239121}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] r=80 psi=0.986 u=0.4253 p_local=0.1850 f1=0.978 auprc=0.999 bytes=82846
[S4] START round=79 head_norm_before_train=2.117383 (no previous merge yet)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.9421510822509167, 'auprc': 0.9769578551836259, 'loss_val': 0.3046007823574335, 'psi': 0.9560737914240003}-{'f1_val': 0.9419019930161509, 'auprc': 0.982363088942562, 'loss_val': 0.3014579909808465, 'psi': 0.9580864313867152}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.956 u=0.0000 p_local=0.0170 f1=0.942 auprc=0.977 bytes=75512
[S5] START round=79 head_norm_before_train=1.820285 cos_to_last_merge=0.7878 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=79 local utility u=0.013002 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9986153348448956, 'loss_val': 0.0258958034468124, 'psi': 0.9971577479235448}-{'f1_val': 0.9960402158980539, 'auprc': 0.9908510236736755, 'loss_val': 0.02773254535252866, 'psi': 0.9939645390083026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S5] r=80 psi=0.997 u=0.0130 p_local=0.0055 f1=0.996 auprc=0.999 bytes=82770
[S6] START round=79 head_norm_before_train=1.619943 cos_to_last_merge=0.8017 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.802
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.8218799744340387, 'auprc': 0.9492982633889572, 'loss_val': 0.4531119292314662, 'psi': 0.872847290016006}-{'f1_val': 0.9557458973165018, 'auprc': 0.9387102471107822, 'loss_val': 0.21928439217678494, 'psi': 0.9489316372342139}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.873 u=0.0000 p_local=0.3177 f1=0.822 auprc=0.949 bytes=80866
[S7] START round=79 head_norm_before_train=1.567870 cos_to_last_merge=0.9219 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.922
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.6260190489012957, 'auprc': 0.8011639119180114, 'loss_val': 0.5558176111534147, 'psi': 0.696076994107982}-{'f1_val': 0.6676753908606866, 'auprc': 0.8314553003609377, 'loss_val': 0.3553287203059519, 'psi': 0.733187354660787}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.696 u=0.0000 p_local=0.1081 f1=0.626 auprc=0.801 bytes=79272
[S8] START round=79 head_norm_before_train=2.035379 cos_to_last_merge=0.7389 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=79 local utility u=0.081046 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9990232434189805, 'loss_val': 0.03745590314430903, 'psi': 0.9933948938519626}-{'f1_val': 0.9713448724897822, 'auprc': 0.9964740339033322, 'loss_val': 0.08211328672697961, 'psi': 0.9813965370552022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] r=80 psi=0.993 u=0.0810 p_local=0.0455 f1=0.990 auprc=0.999 bytes=86296
[S9] START round=79 head_norm_before_train=1.812353 cos_to_last_merge=0.8838 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9991977223538467, 'loss_val': 0.01920363333371494, 'psi': 0.9974417063797824}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991960590287272, 'loss_val': 0.01759735629978161, 'psi': 0.9979401711187765}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.997 u=0.0000 p_local=0.0019 f1=0.996 auprc=0.999 bytes=97061
[S10] START round=79 head_norm_before_train=1.988276 cos_to_last_merge=0.9335 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954833961370246, 'loss_val': 0.02745809172794982, 'psi': 0.9952554393004688}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959145771461801, 'loss_val': 0.02548376216783088, 'psi': 0.995427911704131}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.995 u=0.0000 p_local=0.0004 f1=0.995 auprc=0.995 bytes=91667
[S11] START round=79 head_norm_before_train=2.298430 (no previous merge yet)
[S11] round=79 local utility u=0.002731 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9981697176621329, 'loss_val': 0.01794358554219589, 'psi': 0.9973533969206004}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976924337377278, 'loss_val': 0.02040074265654476, 'psi': 0.9970051762032448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S11] r=80 psi=0.997 u=0.0027 p_local=0.0012 f1=0.997 auprc=0.998 bytes=93542
[S13] START round=79 head_norm_before_train=1.798129 cos_to_last_merge=0.8199 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.820
[S13] round=79 local utility u=0.727633 metrics={'f1_val': 0.7724413030313682, 'auprc': 0.7804092567771902, 'loss_val': 0.7276256907874107, 'psi': 0.775628484529697}-{'f1_val': 0.6245571220159445, 'auprc': 0.6965375955782631, 'loss_val': 1.0439709163452322, 'psi': 0.6533493114408719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=80 psi=0.776 u=0.7276 p_local=0.2307 f1=0.772 auprc=0.780 bytes=80985
[S14] START round=79 head_norm_before_train=1.950988 cos_to_last_merge=0.8565 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9986849962323582, 'loss_val': 0.025880609072352585, 'psi': 0.9981539327588107}-{'f1_val': 0.9978223933154866, 'auprc': 0.9990442853317197, 'loss_val': 0.015036018483883643, 'psi': 0.9983111501219799}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0219 f1=0.998 auprc=0.999 bytes=104194
[S15] START round=79 head_norm_before_train=1.807836 cos_to_last_merge=0.8541 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.854
[S15] round=79 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9914701536491906, 'loss_val': 0.02335893787209371, 'psi': 0.9943779242322288}-{'f1_val': 0.7014419852622074, 'auprc': 0.7329725043989171, 'loss_val': 0.7191970786353502, 'psi': 0.7140541929168913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] r=80 psi=0.994 u=1.0000 p_local=0.3808 f1=0.996 auprc=0.991 bytes=79009
[S16] START round=79 head_norm_before_train=1.950836 cos_to_last_merge=0.9175 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.918
[S16] round=79 local utility u=0.694332 metrics={'f1_val': 0.9911361313038187, 'auprc': 0.9923899203996862, 'loss_val': 0.04152528867557359, 'psi': 0.9916376469421657}-{'f1_val': 0.8620142749671905, 'auprc': 0.9836117271856893, 'loss_val': 0.6291231617426137, 'psi': 0.9106532558545901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S16] r=80 psi=0.992 u=0.6943 p_local=0.2124 f1=0.991 auprc=0.992 bytes=88191
[S17] START round=79 head_norm_before_train=1.847479 cos_to_last_merge=0.9085 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=79 local utility u=1.000000 metrics={'f1_val': 0.9435707803457989, 'auprc': 0.9888857902603191, 'loss_val': 0.1542887948664058, 'psi': 0.9616967843116069}-{'f1_val': 0.6770811960965972, 'auprc': 0.7719251609016591, 'loss_val': 1.3498826424367385, 'psi': 0.715018782018622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=80 psi=0.962 u=1.0000 p_local=0.4121 f1=0.944 auprc=0.989 bytes=80939
[S2] START round=80 head_norm_before_train=1.812483 cos_to_last_merge=0.9004 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=80 local utility u=0.061172 metrics={'f1_val': 0.7095481850869858, 'auprc': 0.8194078684595879, 'loss_val': 0.6608207581515655, 'psi': 0.7534920584360266}-{'f1_val': 0.7109465252397018, 'auprc': 0.8021513500546437, 'loss_val': 0.7397856287924922, 'psi': 0.7474284551656786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=80 head_norm_before_train=2.376201 (no previous merge yet)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8028972380598518, 'auprc': 0.9982126812316061, 'loss_val': 0.4035771206802723, 'psi': 0.8810234153285534}-{'f1_val': 0.9777018272502712, 'auprc': 0.9987025353815316, 'loss_val': 0.05945976695273299, 'psi': 0.9861021105027754}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=2.117772 (no previous merge yet)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9441861948605963, 'auprc': 0.9463443720120785, 'loss_val': 0.3131997701748081, 'psi': 0.9450494657211892}-{'f1_val': 0.9421510822509167, 'auprc': 0.9769578551836259, 'loss_val': 0.3046007823574335, 'psi': 0.9560737914240003}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=1.827516 cos_to_last_merge=0.7876 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.982390371225162, 'auprc': 0.9904366077877848, 'loss_val': 0.05633592527688592, 'psi': 0.9856088658502111}-{'f1_val': 0.996186023309311, 'auprc': 0.9986153348448956, 'loss_val': 0.0258958034468124, 'psi': 0.9971577479235448}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=1.623605 cos_to_last_merge=0.8008 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.801
[S6] round=80 local utility u=0.046205 metrics={'f1_val': 0.8248141366863514, 'auprc': 0.9581717912264693, 'loss_val': 0.40492728788688276, 'psi': 0.8781571985023986}-{'f1_val': 0.8218799744340387, 'auprc': 0.9492982633889572, 'loss_val': 0.4531119292314662, 'psi': 0.872847290016006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=80 head_norm_before_train=1.573811 cos_to_last_merge=0.9211 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.921
[S7] round=80 local utility u=0.172841 metrics={'f1_val': 0.6686987505026198, 'auprc': 0.8086707771882092, 'loss_val': 0.4887348414284459, 'psi': 0.7246875611768556}-{'f1_val': 0.6260190489012957, 'auprc': 0.8011639119180114, 'loss_val': 0.5558176111534147, 'psi': 0.696076994107982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=80 head_norm_before_train=2.038726 cos_to_last_merge=0.7387 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.739
[S8] round=80 local utility u=0.012765 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9980798158587891, 'loss_val': 0.030843680628452705, 'psi': 0.9951923282644396}-{'f1_val': 0.9896426608072839, 'auprc': 0.9990232434189805, 'loss_val': 0.03745590314430903, 'psi': 0.9933948938519626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=80 head_norm_before_train=1.816703 cos_to_last_merge=0.8835 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=80 local utility u=0.001836 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9991977223538469, 'loss_val': 0.018040619165121556, 'psi': 0.9976925779202419}-{'f1_val': 0.9962710290637395, 'auprc': 0.9991977223538467, 'loss_val': 0.01920363333371494, 'psi': 0.9974417063797824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=80 head_norm_before_train=1.994420 cos_to_last_merge=0.9333 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9954834002789306, 'loss_val': 0.029230533222857007, 'psi': 0.9952554409572312}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954833961370246, 'loss_val': 0.02745809172794982, 'psi': 0.9952554393004688}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.303048 (no previous merge yet)
[S11] round=80 local utility u=0.000386 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9984330398361396, 'loss_val': 0.017962383243999156, 'psi': 0.9974587257902031}-{'f1_val': 0.9968091830929121, 'auprc': 0.9981697176621329, 'loss_val': 0.01794358554219589, 'psi': 0.9973533969206004}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=80 head_norm_before_train=1.802824 cos_to_last_merge=0.8193 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6240529001830707, 'auprc': 0.6580554414911323, 'loss_val': 1.113114873860566, 'psi': 0.6376539167062953}-{'f1_val': 0.7724413030313682, 'auprc': 0.7804092567771902, 'loss_val': 0.7276256907874107, 'psi': 0.775628484529697}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.954048 cos_to_last_merge=0.8562 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=80 local utility u=0.005175 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9990454493929483, 'loss_val': 0.016742914767304655, 'psi': 0.9983112353698347}-{'f1_val': 0.9977998904431125, 'auprc': 0.9986849962323582, 'loss_val': 0.025880609072352585, 'psi': 0.9981539327588107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=80 head_norm_before_train=1.812390 cos_to_last_merge=0.8537 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.854
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9834470812111781, 'auprc': 0.9939951571166237, 'loss_val': 0.04053056008979175, 'psi': 0.9876663115733564}-{'f1_val': 0.9963164379542544, 'auprc': 0.9914701536491906, 'loss_val': 0.02335893787209371, 'psi': 0.9943779242322288}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.954471 cos_to_last_merge=0.9171 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9421161683018655, 'auprc': 0.9903526890975016, 'loss_val': 0.35866087580743455, 'psi': 0.96141077662012}-{'f1_val': 0.9911361313038187, 'auprc': 0.9923899203996862, 'loss_val': 0.04152528867557359, 'psi': 0.9916376469421657}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=80 head_norm_before_train=1.850785 cos_to_last_merge=0.9083 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.9197339554976558, 'auprc': 0.9858692090034032, 'loss_val': 0.1635532245159506, 'psi': 0.9461880568999548}-{'f1_val': 0.9435707803457989, 'auprc': 0.9888857902603191, 'loss_val': 0.1542887948664058, 'psi': 0.9616967843116069}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=1.815471 cos_to_last_merge=0.9004 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=81 local utility u=0.016987 metrics={'f1_val': 0.7160998429977227, 'auprc': 0.8580150452143573, 'loss_val': 0.7819788963055453, 'psi': 0.7728659238843766}-{'f1_val': 0.7095481850869858, 'auprc': 0.8194078684595879, 'loss_val': 0.6608207581515655, 'psi': 0.7534920584360266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=81 head_norm_before_train=2.379787 (no previous merge yet)
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.6942722521678701, 'auprc': 0.9867704518111342, 'loss_val': 0.7597212087741594, 'psi': 0.8112715320251758}-{'f1_val': 0.8028972380598518, 'auprc': 0.9982126812316061, 'loss_val': 0.4035771206802723, 'psi': 0.8810234153285534}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=2.115119 (no previous merge yet)
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.6941681217218421, 'auprc': 0.9320794956895816, 'loss_val': 0.5410741022782386, 'psi': 0.7893326713089379}-{'f1_val': 0.9441861948605963, 'auprc': 0.9463443720120785, 'loss_val': 0.3131997701748081, 'psi': 0.9450494657211892}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.830861 cos_to_last_merge=0.7874 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=81 local utility u=0.060949 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9933891153364152, 'loss_val': 0.025195466312605705, 'psi': 0.9949797756733985}-{'f1_val': 0.982390371225162, 'auprc': 0.9904366077877848, 'loss_val': 0.05633592527688592, 'psi': 0.9856088658502111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=81 head_norm_before_train=1.628788 cos_to_last_merge=0.7998 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.800
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.8218965553316268, 'auprc': 0.9468545297239539, 'loss_val': 0.40426388249317513, 'psi': 0.8718797450885576}-{'f1_val': 0.8248141366863514, 'auprc': 0.9581717912264693, 'loss_val': 0.40492728788688276, 'psi': 0.8781571985023986}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.579486 cos_to_last_merge=0.9203 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.5793805575385244, 'auprc': 0.7898820876933645, 'loss_val': 0.9872559564714753, 'psi': 0.6635811696004604}-{'f1_val': 0.6686987505026198, 'auprc': 0.8086707771882092, 'loss_val': 0.4887348414284459, 'psi': 0.7246875611768556}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.044672 cos_to_last_merge=0.7380 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=81 local utility u=0.000000 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9990057069955929, 'loss_val': 0.034900883336335516, 'psi': 0.994253912443678}-{'f1_val': 0.9932673365348732, 'auprc': 0.9980798158587891, 'loss_val': 0.030843680628452705, 'psi': 0.9951923282644396}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=81 head_norm_before_train=1.820544 cos_to_last_merge=0.8835 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9955197327106643, 'loss_val': 0.01793309544862476, 'psi': 0.9964885722429007}-{'f1_val': 0.9966891482978385, 'auprc': 0.9991977223538469, 'loss_val': 0.018040619165121556, 'psi': 0.9976925779202419}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=1.997717 cos_to_last_merge=0.9327 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=81 local utility u=0.000813 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9956177362913959, 'loss_val': 0.028007568437114078, 'psi': 0.9953091753622173}-{'f1_val': 0.9951034680760983, 'auprc': 0.9954834002789306, 'loss_val': 0.029230533222857007, 'psi': 0.9952554409572312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=81 head_norm_before_train=2.308458 (no previous merge yet)
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.997716921046866, 'loss_val': 0.01979740083176157, 'psi': 0.9970272508024747}-{'f1_val': 0.9968091830929121, 'auprc': 0.9984330398361396, 'loss_val': 0.017962383243999156, 'psi': 0.9974587257902031}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.809623 cos_to_last_merge=0.8187 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=81 local utility u=0.520714 metrics={'f1_val': 0.7313566074563187, 'auprc': 0.7239452561638556, 'loss_val': 0.91317824921682, 'psi': 0.7283920669393336}-{'f1_val': 0.6240529001830707, 'auprc': 0.6580554414911323, 'loss_val': 1.113114873860566, 'psi': 0.6376539167062953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=81 head_norm_before_train=1.957448 cos_to_last_merge=0.8555 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9381491242467497, 'auprc': 0.9990366945858606, 'loss_val': 0.09712683263063822, 'psi': 0.9625041523823941}-{'f1_val': 0.9978217593544257, 'auprc': 0.9990454493929483, 'loss_val': 0.016742914767304655, 'psi': 0.9983112353698347}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.816638 cos_to_last_merge=0.8533 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.853
[S15] round=81 local utility u=0.000000 metrics={'f1_val': 0.7824231306877869, 'auprc': 0.8245966159896919, 'loss_val': 0.5395960464379893, 'psi': 0.799292524808549}-{'f1_val': 0.9834470812111781, 'auprc': 0.9939951571166237, 'loss_val': 0.04053056008979175, 'psi': 0.9876663115733564}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=81 head_norm_before_train=1.959173 cos_to_last_merge=0.9168 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.917
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.8370035224731635, 'auprc': 0.8705237348012306, 'loss_val': 1.275985645758694, 'psi': 0.8504116074043904}-{'f1_val': 0.9421161683018655, 'auprc': 0.9903526890975016, 'loss_val': 0.35866087580743455, 'psi': 0.96141077662012}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=1.854406 cos_to_last_merge=0.9080 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.692945838137725, 'auprc': 0.7876845793836671, 'loss_val': 1.1598199454979972, 'psi': 0.7308413346361019}-{'f1_val': 0.9197339554976558, 'auprc': 0.9858692090034032, 'loss_val': 0.1635532245159506, 'psi': 0.9461880568999548}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=1.819233 cos_to_last_merge=0.9002 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=82 local utility u=0.001687 metrics={'f1_val': 0.7160998429977227, 'auprc': 0.8591757949689521, 'loss_val': 0.7820870829784515, 'psi': 0.7733302237862145}-{'f1_val': 0.7160998429977227, 'auprc': 0.8580150452143573, 'loss_val': 0.7819788963055453, 'psi': 0.7728659238843766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=82 head_norm_before_train=2.383334 (no previous merge yet)
[S3] round=82 local utility u=0.802677 metrics={'f1_val': 0.8712076808117157, 'auprc': 0.9983029835224412, 'loss_val': 0.2505774219901837, 'psi': 0.9220458018960058}-{'f1_val': 0.6942722521678701, 'auprc': 0.9867704518111342, 'loss_val': 0.7597212087741594, 'psi': 0.8112715320251758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=82 head_norm_before_train=2.115785 (no previous merge yet)
[S4] round=82 local utility u=0.899382 metrics={'f1_val': 0.9457795707157386, 'auprc': 0.9525564352825417, 'loss_val': 0.3134105500623677, 'psi': 0.9484903165424599}-{'f1_val': 0.6941681217218421, 'auprc': 0.9320794956895816, 'loss_val': 0.5410741022782386, 'psi': 0.7893326713089379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=82 head_norm_before_train=1.835238 cos_to_last_merge=0.7872 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9906928961525497, 'loss_val': 0.0278238200547675, 'psi': 0.9939012879998523}-{'f1_val': 0.9960402158980539, 'auprc': 0.9933891153364152, 'loss_val': 0.025195466312605705, 'psi': 0.9949797756733985}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.636893 cos_to_last_merge=0.7983 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.798
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.8204222945877645, 'auprc': 0.941413968004875, 'loss_val': 0.47302711900468425, 'psi': 0.8688189639546087}-{'f1_val': 0.8218965553316268, 'auprc': 0.9468545297239539, 'loss_val': 0.40426388249317513, 'psi': 0.8718797450885576}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.582806 cos_to_last_merge=0.9199 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=82 local utility u=0.349097 metrics={'f1_val': 0.6289536157905657, 'auprc': 0.8009102380082076, 'loss_val': 0.619585725125071, 'psi': 0.6977362646776225}-{'f1_val': 0.5793805575385244, 'auprc': 0.7898820876933645, 'loss_val': 0.9872559564714753, 'psi': 0.6635811696004604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=82 head_norm_before_train=2.052143 cos_to_last_merge=0.7369 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9882508174109756, 'loss_val': 0.033313408041644996, 'psi': 0.9911597560866101}-{'f1_val': 0.9910860494090681, 'auprc': 0.9990057069955929, 'loss_val': 0.034900883336335516, 'psi': 0.994253912443678}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=1.822844 cos_to_last_merge=0.8834 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9988146422385344, 'loss_val': 0.03125061648191025, 'psi': 0.9941282595676271}-{'f1_val': 0.9971344652643916, 'auprc': 0.9955197327106643, 'loss_val': 0.01793309544862476, 'psi': 0.9964885722429007}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.001239 cos_to_last_merge=0.9322 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=82 local utility u=0.001446 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959190260439668, 'loss_val': 0.026020330264795843, 'psi': 0.9954296912632457}-{'f1_val': 0.9951034680760983, 'auprc': 0.9956177362913959, 'loss_val': 0.028007568437114078, 'psi': 0.9953091753622173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=82 head_norm_before_train=2.310851 (no previous merge yet)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9974656968634276, 'loss_val': 0.02012144014979377, 'psi': 0.9969267611290993}-{'f1_val': 0.996567470639547, 'auprc': 0.997716921046866, 'loss_val': 0.01979740083176157, 'psi': 0.9970272508024747}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.809517 cos_to_last_merge=0.8186 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=82 local utility u=0.017692 metrics={'f1_val': 0.732622995367545, 'auprc': 0.732285108718115, 'loss_val': 0.9104119060271235, 'psi': 0.7324878407077731}-{'f1_val': 0.7313566074563187, 'auprc': 0.7239452561638556, 'loss_val': 0.91317824921682, 'psi': 0.7283920669393336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=82 head_norm_before_train=1.962225 cos_to_last_merge=0.8549 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.855
[S14] round=82 local utility u=0.218062 metrics={'f1_val': 0.9975994502496334, 'auprc': 0.9990448891029069, 'loss_val': 0.01772985167665898, 'psi': 0.9981776257909427}-{'f1_val': 0.9381491242467497, 'auprc': 0.9990366945858606, 'loss_val': 0.09712683263063822, 'psi': 0.9625041523823941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=82 head_norm_before_train=1.821561 cos_to_last_merge=0.8528 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.853
[S15] round=82 local utility u=1.000000 metrics={'f1_val': 0.9949932333886315, 'auprc': 0.9960520118660633, 'loss_val': 0.03136187004448893, 'psi': 0.9954167447796043}-{'f1_val': 0.7824231306877869, 'auprc': 0.8245966159896919, 'loss_val': 0.5395960464379893, 'psi': 0.799292524808549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=82 head_norm_before_train=1.964641 cos_to_last_merge=0.9165 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=82 local utility u=1.000000 metrics={'f1_val': 0.992418866986642, 'auprc': 0.9892125961047211, 'loss_val': 0.0380230894522633, 'psi': 0.9911363586338735}-{'f1_val': 0.8370035224731635, 'auprc': 0.8705237348012306, 'loss_val': 1.275985645758694, 'psi': 0.8504116074043904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=82 head_norm_before_train=1.859018 cos_to_last_merge=0.9077 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.908
[S17] round=82 local utility u=1.000000 metrics={'f1_val': 0.9080969241982242, 'auprc': 0.9809683625003324, 'loss_val': 0.21911011475474, 'psi': 0.9372454995190674}-{'f1_val': 0.692945838137725, 'auprc': 0.7876845793836671, 'loss_val': 1.1598199454979972, 'psi': 0.7308413346361019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=83 head_norm_before_train=1.823085 cos_to_last_merge=0.8999 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7162356586160903, 'auprc': 0.8561249044559, 'loss_val': 0.8078896464459955, 'psi': 0.7721913569520141}-{'f1_val': 0.7160998429977227, 'auprc': 0.8591757949689521, 'loss_val': 0.7820870829784515, 'psi': 0.7733302237862145}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.387010 (no previous merge yet)
[S3] round=83 local utility u=0.000000 metrics={'f1_val': 0.8437917745568607, 'auprc': 0.9983556242824587, 'loss_val': 0.3187187597245783, 'psi': 0.9056173144470999}-{'f1_val': 0.8712076808117157, 'auprc': 0.9983029835224412, 'loss_val': 0.2505774219901837, 'psi': 0.9220458018960058}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=83 head_norm_before_train=2.114521 (no previous merge yet)
[S4] round=83 local utility u=0.000000 metrics={'f1_val': 0.9354911921933894, 'auprc': 0.9266841216443491, 'loss_val': 0.3473869212909852, 'psi': 0.9319683639737733}-{'f1_val': 0.9457795707157386, 'auprc': 0.9525564352825417, 'loss_val': 0.3134105500623677, 'psi': 0.9484903165424599}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=83 head_norm_before_train=1.837186 cos_to_last_merge=0.7870 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=83 local utility u=0.004772 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9931601789889559, 'loss_val': 0.02568082747129895, 'psi': 0.9948882011344148}-{'f1_val': 0.9960402158980539, 'auprc': 0.9906928961525497, 'loss_val': 0.0278238200547675, 'psi': 0.9939012879998523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=83 head_norm_before_train=1.651941 cos_to_last_merge=0.7965 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.797
[S6] round=83 local utility u=0.134841 metrics={'f1_val': 0.8272804011405807, 'auprc': 0.9569498067259532, 'loss_val': 0.29110082326529746, 'psi': 0.8791481633747297}-{'f1_val': 0.8204222945877645, 'auprc': 0.941413968004875, 'loss_val': 0.47302711900468425, 'psi': 0.8688189639546087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=83 head_norm_before_train=1.584899 cos_to_last_merge=0.9196 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.920
[S7] round=83 local utility u=0.504755 metrics={'f1_val': 0.7203996683290954, 'auprc': 0.8507228382438093, 'loss_val': 0.3081897132688753, 'psi': 0.772528936294981}-{'f1_val': 0.6289536157905657, 'auprc': 0.8009102380082076, 'loss_val': 0.619585725125071, 'psi': 0.6977362646776225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S7] sending update (kind=head size=1807 to 1 peers)
[S8] START round=83 head_norm_before_train=2.054714 cos_to_last_merge=0.7370 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=83 local utility u=0.003959 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9990193636430051, 'loss_val': 0.036962002925646026, 'psi': 0.9933933419415724}-{'f1_val': 0.9930990485370332, 'auprc': 0.9882508174109756, 'loss_val': 0.033313408041644996, 'psi': 0.9911597560866101}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=83 head_norm_before_train=1.825850 cos_to_last_merge=0.8833 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=83 local utility u=0.025557 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991964795374929, 'loss_val': 0.01787528561505786, 'psi': 0.9979403393222829}-{'f1_val': 0.9910040044536889, 'auprc': 0.9988146422385344, 'loss_val': 0.03125061648191025, 'psi': 0.9941282595676271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=83 head_norm_before_train=2.005909 cos_to_last_merge=0.9318 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=83 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.995908572568923, 'loss_val': 0.02607713408319884, 'psi': 0.9954255098732281}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959190260439668, 'loss_val': 0.026020330264795843, 'psi': 0.9954296912632457}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=83 head_norm_before_train=2.314267 (no previous merge yet)
[S11] round=83 local utility u=0.000156 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975185723765765, 'loss_val': 0.01996711979053481, 'psi': 0.9969479113343589}-{'f1_val': 0.996567470639547, 'auprc': 0.9974656968634276, 'loss_val': 0.02012144014979377, 'psi': 0.9969267611290993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=83 head_norm_before_train=1.812941 cos_to_last_merge=0.8183 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=83 local utility u=0.049682 metrics={'f1_val': 0.7368100430775677, 'auprc': 0.7486667144237544, 'loss_val': 0.8853150582939145, 'psi': 0.7415527116160424}-{'f1_val': 0.732622995367545, 'auprc': 0.732285108718115, 'loss_val': 0.9104119060271235, 'psi': 0.7324878407077731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=83 head_norm_before_train=1.967230 cos_to_last_merge=0.8545 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.854
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9980427385234248, 'auprc': 0.9961283757337647, 'loss_val': 0.015029765913200011, 'psi': 0.9972769934075607}-{'f1_val': 0.9975994502496334, 'auprc': 0.9990448891029069, 'loss_val': 0.01772985167665898, 'psi': 0.9981776257909427}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=1.825271 cos_to_last_merge=0.8525 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9959452881418331, 'auprc': 0.9900294196608084, 'loss_val': 0.030343113550169387, 'psi': 0.9935789407494232}-{'f1_val': 0.9949932333886315, 'auprc': 0.9960520118660633, 'loss_val': 0.03136187004448893, 'psi': 0.9954167447796043}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=1.968580 cos_to_last_merge=0.9163 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.6815743773358479, 'auprc': 0.8413765899009278, 'loss_val': 1.6390966035706158, 'psi': 0.7454952623618799}-{'f1_val': 0.992418866986642, 'auprc': 0.9892125961047211, 'loss_val': 0.0380230894522633, 'psi': 0.9911363586338735}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.864285 cos_to_last_merge=0.9070 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=83 local utility u=0.092066 metrics={'f1_val': 0.9347155864149393, 'auprc': 0.9865002113511008, 'loss_val': 0.21128507925823448, 'psi': 0.9554294363894038}-{'f1_val': 0.9080969241982242, 'auprc': 0.9809683625003324, 'loss_val': 0.21911011475474, 'psi': 0.9372454995190674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=84 head_norm_before_train=1.827541 cos_to_last_merge=0.8996 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.900
[S2] round=84 local utility u=0.011969 metrics={'f1_val': 0.7130829463883801, 'auprc': 0.8329350661826447, 'loss_val': 0.6954652122026564, 'psi': 0.7610237943060859}-{'f1_val': 0.7162356586160903, 'auprc': 0.8561249044559, 'loss_val': 0.8078896464459955, 'psi': 0.7721913569520141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=84 head_norm_before_train=2.390924 (no previous merge yet)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.7702659277750361, 'auprc': 0.98367508099952, 'loss_val': 0.5714422050305433, 'psi': 0.8556295890648296}-{'f1_val': 0.8437917745568607, 'auprc': 0.9983556242824587, 'loss_val': 0.3187187597245783, 'psi': 0.9056173144470999}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.116579 (no previous merge yet)
[S4] round=84 local utility u=0.111668 metrics={'f1_val': 0.9423948689392723, 'auprc': 0.973302160814396, 'loss_val': 0.30532792885028626, 'psi': 0.9547577856893218}-{'f1_val': 0.9354911921933894, 'auprc': 0.9266841216443491, 'loss_val': 0.3473869212909852, 'psi': 0.9319683639737733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=84 head_norm_before_train=1.839748 cos_to_last_merge=0.7870 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9912076965729804, 'loss_val': 0.025741413070690142, 'psi': 0.9940201787659227}-{'f1_val': 0.9960402158980539, 'auprc': 0.9931601789889559, 'loss_val': 0.02568082747129895, 'psi': 0.9948882011344148}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=1.659220 cos_to_last_merge=0.7948 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.795
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.7791601417448474, 'auprc': 0.9379662194688038, 'loss_val': 0.6304112971360841, 'psi': 0.8426825728344299}-{'f1_val': 0.8272804011405807, 'auprc': 0.9569498067259532, 'loss_val': 0.29110082326529746, 'psi': 0.8791481633747297}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.588207 cos_to_last_merge=0.9191 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.599575298259138, 'auprc': 0.7953382850749827, 'loss_val': 0.8182725837679831, 'psi': 0.6778804929854759}-{'f1_val': 0.7203996683290954, 'auprc': 0.8507228382438093, 'loss_val': 0.3081897132688753, 'psi': 0.772528936294981}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.058291 cos_to_last_merge=0.7368 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=84 local utility u=0.010490 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9989578003591291, 'loss_val': 0.03316903104115628, 'psi': 0.9951059548929528}-{'f1_val': 0.9896426608072839, 'auprc': 0.9990193636430051, 'loss_val': 0.036962002925646026, 'psi': 0.9933933419415724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=84 head_norm_before_train=1.829952 cos_to_last_merge=0.8830 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=84 local utility u=0.000726 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991988903725733, 'loss_val': 0.016429788652773156, 'psi': 0.997941303656315}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991964795374929, 'loss_val': 0.01787528561505786, 'psi': 0.9979403393222829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=84 head_norm_before_train=2.011154 cos_to_last_merge=0.9315 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958263295509417, 'loss_val': 0.026856183129989327, 'psi': 0.9953926126660356}-{'f1_val': 0.9951034680760983, 'auprc': 0.995908572568923, 'loss_val': 0.02607713408319884, 'psi': 0.9954255098732281}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.318767 (no previous merge yet)
[S11] round=84 local utility u=0.002516 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9980840794997146, 'loss_val': 0.01808164447374171, 'psi': 0.9973191416556331}-{'f1_val': 0.996567470639547, 'auprc': 0.9975185723765765, 'loss_val': 0.01996711979053481, 'psi': 0.9969479113343589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=84 head_norm_before_train=1.817739 cos_to_last_merge=0.8178 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.818
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6675624577702173, 'auprc': 0.6840412143350945, 'loss_val': 0.9545610411701966, 'psi': 0.6741539603961682}-{'f1_val': 0.7368100430775677, 'auprc': 0.7486667144237544, 'loss_val': 0.8853150582939145, 'psi': 0.7415527116160424}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.969494 cos_to_last_merge=0.8537 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.854
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9977998904431125, 'auprc': 0.9973737562468009, 'loss_val': 0.017721840594859668, 'psi': 0.9976294367645878}-{'f1_val': 0.9980427385234248, 'auprc': 0.9961283757337647, 'loss_val': 0.015029765913200011, 'psi': 0.9972769934075607}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=1.828142 cos_to_last_merge=0.8522 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.7727135735217929, 'auprc': 0.8224939249268404, 'loss_val': 0.5618550065456314, 'psi': 0.7926257140838119}-{'f1_val': 0.9959452881418331, 'auprc': 0.9900294196608084, 'loss_val': 0.030343113550169387, 'psi': 0.9935789407494232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=1.969885 cos_to_last_merge=0.9159 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.916
[S16] round=84 local utility u=1.000000 metrics={'f1_val': 0.9920353281259588, 'auprc': 0.9842237992570342, 'loss_val': 0.03925456849773722, 'psi': 0.988910716578389}-{'f1_val': 0.6815743773358479, 'auprc': 0.8413765899009278, 'loss_val': 1.6390966035706158, 'psi': 0.7454952623618799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=84 head_norm_before_train=1.868318 cos_to_last_merge=0.9064 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8606259535634186, 'auprc': 0.9419675896446622, 'loss_val': 0.6078791157053912, 'psi': 0.8931626079959161}-{'f1_val': 0.9347155864149393, 'auprc': 0.9865002113511008, 'loss_val': 0.21128507925823448, 'psi': 0.9554294363894038}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=1.830755 cos_to_last_merge=0.8991 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7013770740557478, 'auprc': 0.7928840419515132, 'loss_val': 0.7592710903929281, 'psi': 0.737979861214054}-{'f1_val': 0.7130829463883801, 'auprc': 0.8329350661826447, 'loss_val': 0.6954652122026564, 'psi': 0.7610237943060859}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.394457 (no previous merge yet)
[S3] round=85 local utility u=0.446063 metrics={'f1_val': 0.862880384875698, 'auprc': 0.9977882119068308, 'loss_val': 0.27734270697142527, 'psi': 0.9168435156881511}-{'f1_val': 0.7702659277750361, 'auprc': 0.98367508099952, 'loss_val': 0.5714422050305433, 'psi': 0.8556295890648296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=85 head_norm_before_train=2.118231 (no previous merge yet)
[S4] round=85 local utility u=0.040748 metrics={'f1_val': 0.9534877623511985, 'auprc': 0.9759840842688925, 'loss_val': 0.2984349917335181, 'psi': 0.9624862911182761}-{'f1_val': 0.9423948689392723, 'auprc': 0.973302160814396, 'loss_val': 0.30532792885028626, 'psi': 0.9547577856893218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=85 head_norm_before_train=1.845326 cos_to_last_merge=0.7865 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=85 local utility u=0.004812 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9936224825253506, 'loss_val': 0.02423231064105127, 'psi': 0.9950731225489726}-{'f1_val': 0.995895166894551, 'auprc': 0.9912076965729804, 'loss_val': 0.025741413070690142, 'psi': 0.9940201787659227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=85 head_norm_before_train=1.665684 cos_to_last_merge=0.7933 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.793
[S6] round=85 local utility u=0.187712 metrics={'f1_val': 0.8179579174577931, 'auprc': 0.9295025698480329, 'loss_val': 0.4623838010890907, 'psi': 0.862575778413889}-{'f1_val': 0.7791601417448474, 'auprc': 0.9379662194688038, 'loss_val': 0.6304112971360841, 'psi': 0.8426825728344299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S6] sending update (kind=head size=1809 to 1 peers)
[S7] START round=85 head_norm_before_train=1.592070 cos_to_last_merge=0.9185 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=85 local utility u=0.524004 metrics={'f1_val': 0.6734705203703427, 'auprc': 0.8383833849789282, 'loss_val': 0.3427718793088194, 'psi': 0.7394356662137769}-{'f1_val': 0.599575298259138, 'auprc': 0.7953382850749827, 'loss_val': 0.8182725837679831, 'psi': 0.6778804929854759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=85 head_norm_before_train=2.062283 cos_to_last_merge=0.7368 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9746695083837247, 'auprc': 0.9989691694967071, 'loss_val': 0.06772405053942103, 'psi': 0.9843893728289177}-{'f1_val': 0.9925380579155019, 'auprc': 0.9989578003591291, 'loss_val': 0.03316903104115628, 'psi': 0.9951059548929528}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=85 head_norm_before_train=1.834813 cos_to_last_merge=0.8826 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9874269136456545, 'auprc': 0.9991976262780791, 'loss_val': 0.050142286881656166, 'psi': 0.9921351986986243}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991988903725733, 'loss_val': 0.016429788652773156, 'psi': 0.997941303656315}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.014530 cos_to_last_merge=0.9309 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957779631969959, 'loss_val': 0.028621828309853815, 'psi': 0.9953732661244573}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958263295509417, 'loss_val': 0.026856183129989327, 'psi': 0.9953926126660356}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.319492 (no previous merge yet)
[S11] round=85 local utility u=0.000232 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9981127042974369, 'loss_val': 0.01770298424647283, 'psi': 0.997330591574722}-{'f1_val': 0.9968091830929121, 'auprc': 0.9980840794997146, 'loss_val': 0.01808164447374171, 'psi': 0.9973191416556331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=85 head_norm_before_train=1.825939 cos_to_last_merge=0.8171 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.817
[S13] round=85 local utility u=0.496205 metrics={'f1_val': 0.7455407809040924, 'auprc': 0.8103789149288481, 'loss_val': 0.8090338115625741, 'psi': 0.7714760345139946}-{'f1_val': 0.6675624577702173, 'auprc': 0.6840412143350945, 'loss_val': 0.9545610411701966, 'psi': 0.6741539603961682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=85 head_norm_before_train=1.971451 cos_to_last_merge=0.8535 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.854
[S14] round=85 local utility u=0.000000 metrics={'f1_val': 0.9398198802575692, 'auprc': 0.9990290166807184, 'loss_val': 0.08406039972347418, 'psi': 0.9635035348268288}-{'f1_val': 0.9977998904431125, 'auprc': 0.9973737562468009, 'loss_val': 0.017721840594859668, 'psi': 0.9976294367645878}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=85 head_norm_before_train=1.831799 cos_to_last_merge=0.8518 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.852
[S15] round=85 local utility u=0.700370 metrics={'f1_val': 0.8986503784672898, 'auprc': 0.9575067495664603, 'loss_val': 0.32177353129590075, 'psi': 0.922192926906958}-{'f1_val': 0.7727135735217929, 'auprc': 0.8224939249268404, 'loss_val': 0.5618550065456314, 'psi': 0.7926257140838119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=85 head_norm_before_train=1.971852 cos_to_last_merge=0.9155 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9832359593622282, 'auprc': 0.9867906960373378, 'loss_val': 0.06691255749883207, 'psi': 0.984657854032272}-{'f1_val': 0.9920353281259588, 'auprc': 0.9842237992570342, 'loss_val': 0.03925456849773722, 'psi': 0.988910716578389}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=1.872642 cos_to_last_merge=0.9052 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.7552094161896782, 'auprc': 0.8181701478347003, 'loss_val': 0.9538334922254176, 'psi': 0.780393708847687}-{'f1_val': 0.8606259535634186, 'auprc': 0.9419675896446622, 'loss_val': 0.6078791157053912, 'psi': 0.8931626079959161}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=1.834209 cos_to_last_merge=0.8986 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.6881864460396422, 'auprc': 0.7849478351127941, 'loss_val': 0.8637141371602604, 'psi': 0.726891001668903}-{'f1_val': 0.7013770740557478, 'auprc': 0.7928840419515132, 'loss_val': 0.7592710903929281, 'psi': 0.737979861214054}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.398680 (no previous merge yet)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.7705950551384974, 'auprc': 0.990400299702805, 'loss_val': 0.5503810296149645, 'psi': 0.8585171529642204}-{'f1_val': 0.862880384875698, 'auprc': 0.9977882119068308, 'loss_val': 0.27734270697142527, 'psi': 0.9168435156881511}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=2.118816 (no previous merge yet)
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9483255140191755, 'auprc': 0.9666926839002713, 'loss_val': 0.3101312519399082, 'psi': 0.9556723819716137}-{'f1_val': 0.9534877623511985, 'auprc': 0.9759840842688925, 'loss_val': 0.2984349917335181, 'psi': 0.9624862911182761}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=1.852087 cos_to_last_merge=0.7860 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.991365534507729, 'loss_val': 0.024544076621732813, 'psi': 0.994170343341924}-{'f1_val': 0.9960402158980539, 'auprc': 0.9936224825253506, 'loss_val': 0.02423231064105127, 'psi': 0.9950731225489726}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=1.671206 cos_to_last_merge=0.7921 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.792
[S6] round=86 local utility u=0.060521 metrics={'f1_val': 0.8220748177553854, 'auprc': 0.9525690573138362, 'loss_val': 0.43524182270528117, 'psi': 0.8742725135787657}-{'f1_val': 0.8179579174577931, 'auprc': 0.9295025698480329, 'loss_val': 0.4623838010890907, 'psi': 0.862575778413889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=86 head_norm_before_train=1.595202 cos_to_last_merge=0.9182 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.918
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6201276476378694, 'auprc': 0.7966979598917139, 'loss_val': 0.7634579688111347, 'psi': 0.6907557725394072}-{'f1_val': 0.6734705203703427, 'auprc': 0.8383833849789282, 'loss_val': 0.3427718793088194, 'psi': 0.7394356662137769}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=2.066298 cos_to_last_merge=0.7367 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=86 local utility u=0.041967 metrics={'f1_val': 0.9853820930993438, 'auprc': 0.9990070639439614, 'loss_val': 0.048178343983377274, 'psi': 0.9908320814371909}-{'f1_val': 0.9746695083837247, 'auprc': 0.9989691694967071, 'loss_val': 0.06772405053942103, 'psi': 0.9843893728289177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=86 head_norm_before_train=1.839776 cos_to_last_merge=0.8821 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.882
[S9] round=86 local utility u=0.047291 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9991987406935483, 'loss_val': 0.016271568244394935, 'psi': 0.9982064302838056}-{'f1_val': 0.9874269136456545, 'auprc': 0.9991976262780791, 'loss_val': 0.050142286881656166, 'psi': 0.9921351986986243}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=86 head_norm_before_train=2.015350 cos_to_last_merge=0.9301 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=86 local utility u=0.000007 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958247866048997, 'loss_val': 0.028747770938483647, 'psi': 0.9953919954876188}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957779631969959, 'loss_val': 0.028621828309853815, 'psi': 0.9953732661244573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=86 head_norm_before_train=2.322612 (no previous merge yet)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975975484520219, 'loss_val': 0.020172363995611182, 'psi': 0.9969672220889625}-{'f1_val': 0.9968091830929121, 'auprc': 0.9981127042974369, 'loss_val': 0.01770298424647283, 'psi': 0.997330591574722}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=1.832776 cos_to_last_merge=0.8164 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6808345315729778, 'auprc': 0.7382989262526567, 'loss_val': 0.9864819977002269, 'psi': 0.7038202894448493}-{'f1_val': 0.7455407809040924, 'auprc': 0.8103789149288481, 'loss_val': 0.8090338115625741, 'psi': 0.7714760345139946}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.975749 cos_to_last_merge=0.8532 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.853
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9347692789129906, 'auprc': 0.9990341431083472, 'loss_val': 0.13177740519204584, 'psi': 0.9604752245911332}-{'f1_val': 0.9398198802575692, 'auprc': 0.9990290166807184, 'loss_val': 0.08406039972347418, 'psi': 0.9635035348268288}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=1.836472 cos_to_last_merge=0.8513 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.851
[S15] round=86 local utility u=0.496188 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9928318323978103, 'loss_val': 0.021370087923532483, 'psi': 0.9949225957316767}-{'f1_val': 0.8986503784672898, 'auprc': 0.9575067495664603, 'loss_val': 0.32177353129590075, 'psi': 0.922192926906958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=86 head_norm_before_train=1.976434 cos_to_last_merge=0.9152 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=86 local utility u=0.030156 metrics={'f1_val': 0.9893278217611172, 'auprc': 0.991275573349665, 'loss_val': 0.0566072467287756, 'psi': 0.9901069223965363}-{'f1_val': 0.9832359593622282, 'auprc': 0.9867906960373378, 'loss_val': 0.06691255749883207, 'psi': 0.984657854032272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=86 head_norm_before_train=1.878066 cos_to_last_merge=0.9042 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=86 local utility u=0.724274 metrics={'f1_val': 0.8477401014874659, 'auprc': 0.9635770724537348, 'loss_val': 0.4966895486616758, 'psi': 0.8940748898739734}-{'f1_val': 0.7552094161896782, 'auprc': 0.8181701478347003, 'loss_val': 0.9538334922254176, 'psi': 0.780393708847687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=87 head_norm_before_train=1.838518 cos_to_last_merge=0.8981 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.898
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.7015804602392226, 'auprc': 0.7599683410363629, 'loss_val': 1.1055479874606842, 'psi': 0.7249356125580787}-{'f1_val': 0.6881864460396422, 'auprc': 0.7849478351127941, 'loss_val': 0.8637141371602604, 'psi': 0.726891001668903}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.403144 (no previous merge yet)
[S3] round=87 local utility u=0.421540 metrics={'f1_val': 0.8646235952516521, 'auprc': 0.9984795532964552, 'loss_val': 0.29571068125177213, 'psi': 0.9181659784695734}-{'f1_val': 0.7705950551384974, 'auprc': 0.990400299702805, 'loss_val': 0.5503810296149645, 'psi': 0.8585171529642204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=87 head_norm_before_train=2.119888 (no previous merge yet)
[S4] round=87 local utility u=0.038313 metrics={'f1_val': 0.9542697211244331, 'auprc': 0.9768427897384155, 'loss_val': 0.29962097979062535, 'psi': 0.9632989485700261}-{'f1_val': 0.9483255140191755, 'auprc': 0.9666926839002713, 'loss_val': 0.3101312519399082, 'psi': 0.9556723819716137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=87 head_norm_before_train=1.860336 cos_to_last_merge=0.7860 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=87 local utility u=0.003087 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9932644106503273, 'loss_val': 0.02406620513987006, 'psi': 0.9949298937989633}-{'f1_val': 0.9960402158980539, 'auprc': 0.991365534507729, 'loss_val': 0.024544076621732813, 'psi': 0.994170343341924}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=87 head_norm_before_train=1.677961 cos_to_last_merge=0.7908 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.791
[S6] round=87 local utility u=0.565142 metrics={'f1_val': 0.9623649620983176, 'auprc': 0.9683930025836867, 'loss_val': 0.19417142348039357, 'psi': 0.9647761782924652}-{'f1_val': 0.8220748177553854, 'auprc': 0.9525690573138362, 'loss_val': 0.43524182270528117, 'psi': 0.8742725135787657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=87 head_norm_before_train=1.602126 cos_to_last_merge=0.9172 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.917
[S7] round=87 local utility u=0.608807 metrics={'f1_val': 0.6967589959849253, 'auprc': 0.8882459512029374, 'loss_val': 0.28027564044984754, 'psi': 0.7733537780721301}-{'f1_val': 0.6201276476378694, 'auprc': 0.7966979598917139, 'loss_val': 0.7634579688111347, 'psi': 0.6907557725394072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=87 head_norm_before_train=2.070469 cos_to_last_merge=0.7368 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=87 local utility u=0.006013 metrics={'f1_val': 0.9917822352048012, 'auprc': 0.9881446741883892, 'loss_val': 0.0419666511617035, 'psi': 0.9903272107982364}-{'f1_val': 0.9853820930993438, 'auprc': 0.9990070639439614, 'loss_val': 0.048178343983377274, 'psi': 0.9908320814371909}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=87 head_norm_before_train=1.844650 cos_to_last_merge=0.8817 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.882
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9958701861374757, 'loss_val': 0.01670076326927566, 'psi': 0.9968750084613766}-{'f1_val': 0.9975448900106438, 'auprc': 0.9991987406935483, 'loss_val': 0.016271568244394935, 'psi': 0.9982064302838056}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.017025 cos_to_last_merge=0.9294 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=87 local utility u=0.001225 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9960033595077324, 'loss_val': 0.026832676634103925, 'psi': 0.9954634246487519}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958247866048997, 'loss_val': 0.028747770938483647, 'psi': 0.9953919954876188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=87 head_norm_before_train=2.326814 (no previous merge yet)
[S11] round=87 local utility u=0.000863 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9979821440596216, 'loss_val': 0.019723308116284654, 'psi': 0.9971333400075768}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975975484520219, 'loss_val': 0.020172363995611182, 'psi': 0.9969672220889625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=87 head_norm_before_train=1.836671 cos_to_last_merge=0.8161 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=87 local utility u=0.243203 metrics={'f1_val': 0.7276188389897719, 'auprc': 0.7645254061583767, 'loss_val': 0.8594610177215308, 'psi': 0.7423814658572139}-{'f1_val': 0.6808345315729778, 'auprc': 0.7382989262526567, 'loss_val': 0.9864819977002269, 'psi': 0.7038202894448493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=87 head_norm_before_train=1.981928 cos_to_last_merge=0.8526 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.853
[S14] round=87 local utility u=0.038321 metrics={'f1_val': 0.939858001046695, 'auprc': 0.9990400411171365, 'loss_val': 0.0856849624138721, 'psi': 0.9635308170748716}-{'f1_val': 0.9347692789129906, 'auprc': 0.9990341431083472, 'loss_val': 0.13177740519204584, 'psi': 0.9604752245911332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=87 head_norm_before_train=1.841357 cos_to_last_merge=0.8509 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.851
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9736570855241687, 'auprc': 0.9906184162055403, 'loss_val': 0.05204613476673289, 'psi': 0.9804416177967173}-{'f1_val': 0.9963164379542544, 'auprc': 0.9928318323978103, 'loss_val': 0.021370087923532483, 'psi': 0.9949225957316767}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=1.982275 cos_to_last_merge=0.9151 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9387267618144426, 'auprc': 0.9872336739732559, 'loss_val': 0.3539174897676678, 'psi': 0.9581295266779679}-{'f1_val': 0.9893278217611172, 'auprc': 0.991275573349665, 'loss_val': 0.0566072467287756, 'psi': 0.9901069223965363}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=1.883706 cos_to_last_merge=0.9038 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.7811612164486483, 'auprc': 0.9395722511401325, 'loss_val': 0.6641637235533552, 'psi': 0.844525630325242}-{'f1_val': 0.8477401014874659, 'auprc': 0.9635770724537348, 'loss_val': 0.4966895486616758, 'psi': 0.8940748898739734}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=1.843684 cos_to_last_merge=0.8976 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.898
[S2] round=88 local utility u=0.352128 metrics={'f1_val': 0.7141404915747821, 'auprc': 0.8492130666895029, 'loss_val': 0.7443871479058054, 'psi': 0.7681695216206704}-{'f1_val': 0.7015804602392226, 'auprc': 0.7599683410363629, 'loss_val': 1.1055479874606842, 'psi': 0.7249356125580787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=88 head_norm_before_train=2.407880 (no previous merge yet)
[S3] round=88 local utility u=0.128427 metrics={'f1_val': 0.9016951821696971, 'auprc': 0.998426322503249, 'loss_val': 0.2611268291763574, 'psi': 0.9403876383031179}-{'f1_val': 0.8646235952516521, 'auprc': 0.9984795532964552, 'loss_val': 0.29571068125177213, 'psi': 0.9181659784695734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=88 head_norm_before_train=2.122409 (no previous merge yet)
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9403672217906807, 'auprc': 0.9433189954868095, 'loss_val': 0.3227900173759681, 'psi': 0.9415479312691322}-{'f1_val': 0.9542697211244331, 'auprc': 0.9768427897384155, 'loss_val': 0.29962097979062535, 'psi': 0.9632989485700261}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.865730 cos_to_last_merge=0.7855 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=88 local utility u=0.000608 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9935592033728456, 'loss_val': 0.02373456712423987, 'psi': 0.9950478108879707}-{'f1_val': 0.9960402158980539, 'auprc': 0.9932644106503273, 'loss_val': 0.02406620513987006, 'psi': 0.9949298937989633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=88 head_norm_before_train=1.686237 cos_to_last_merge=0.7895 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.790
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.6108338114637322, 'auprc': 0.6814046956235935, 'loss_val': 1.0338795539867907, 'psi': 0.6390621651276767}-{'f1_val': 0.9623649620983176, 'auprc': 0.9683930025836867, 'loss_val': 0.19417142348039357, 'psi': 0.9647761782924652}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.607011 cos_to_last_merge=0.9165 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.578426014771401, 'auprc': 0.7900228724579287, 'loss_val': 1.0133723136337245, 'psi': 0.663064757846012}-{'f1_val': 0.6967589959849253, 'auprc': 0.8882459512029374, 'loss_val': 0.28027564044984754, 'psi': 0.7733537780721301}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.071856 cos_to_last_merge=0.7376 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9750080791060296, 'auprc': 0.9964499158166025, 'loss_val': 0.06516926074440696, 'psi': 0.9835848137902587}-{'f1_val': 0.9917822352048012, 'auprc': 0.9881446741883892, 'loss_val': 0.0419666511617035, 'psi': 0.9903272107982364}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=1.849564 cos_to_last_merge=0.8813 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9968841373706654, 'auprc': 0.9955440856906511, 'loss_val': 0.019148791925339453, 'psi': 0.9963481166986596}-{'f1_val': 0.9975448900106438, 'auprc': 0.9958701861374757, 'loss_val': 0.01670076326927566, 'psi': 0.9968750084613766}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.020683 cos_to_last_merge=0.9289 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=88 local utility u=0.000591 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961214185346562, 'loss_val': 0.026004725587615275, 'psi': 0.9955106482595214}-{'f1_val': 0.9951034680760983, 'auprc': 0.9960033595077324, 'loss_val': 0.026832676634103925, 'psi': 0.9954634246487519}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=88 head_norm_before_train=2.331208 (no previous merge yet)
[S11] round=88 local utility u=0.001038 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998404071375617, 'loss_val': 0.018913773324008107, 'psi': 0.997302110933975}-{'f1_val': 0.996567470639547, 'auprc': 0.9979821440596216, 'loss_val': 0.019723308116284654, 'psi': 0.9971333400075768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=88 head_norm_before_train=1.841210 cos_to_last_merge=0.8157 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6998409065890283, 'auprc': 0.7389715545726138, 'loss_val': 0.8517808027148301, 'psi': 0.7154931657824625}-{'f1_val': 0.7276188389897719, 'auprc': 0.7645254061583767, 'loss_val': 0.8594610177215308, 'psi': 0.7423814658572139}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.985603 cos_to_last_merge=0.8521 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.852
[S14] round=88 local utility u=0.128997 metrics={'f1_val': 0.9755770278306203, 'auprc': 0.9990344779245799, 'loss_val': 0.041988427787985214, 'psi': 0.9849600078682041}-{'f1_val': 0.939858001046695, 'auprc': 0.9990400411171365, 'loss_val': 0.0856849624138721, 'psi': 0.9635308170748716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=88 head_norm_before_train=1.846448 cos_to_last_merge=0.8504 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.850
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.7008305005721126, 'auprc': 0.807949808773151, 'loss_val': 0.708593115217314, 'psi': 0.743678223852528}-{'f1_val': 0.9736570855241687, 'auprc': 0.9906184162055403, 'loss_val': 0.05204613476673289, 'psi': 0.9804416177967173}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.987275 cos_to_last_merge=0.9148 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.915
[S16] round=88 local utility u=0.317410 metrics={'f1_val': 0.9917569730015601, 'auprc': 0.9878856963627043, 'loss_val': 0.03923541673272315, 'psi': 0.9902084623460177}-{'f1_val': 0.9387267618144426, 'auprc': 0.9872336739732559, 'loss_val': 0.3539174897676678, 'psi': 0.9581295266779679}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=88 head_norm_before_train=1.887805 cos_to_last_merge=0.9034 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=88 local utility u=0.393952 metrics={'f1_val': 0.8747908816110377, 'auprc': 0.9626774274716526, 'loss_val': 0.5073534638434933, 'psi': 0.9099454999552836}-{'f1_val': 0.7811612164486483, 'auprc': 0.9395722511401325, 'loss_val': 0.6641637235533552, 'psi': 0.844525630325242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=89 head_norm_before_train=1.847438 cos_to_last_merge=0.8974 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=89 local utility u=0.035806 metrics={'f1_val': 0.7209721528654774, 'auprc': 0.8236244884466742, 'loss_val': 0.6369993987608519, 'psi': 0.7620330870979561}-{'f1_val': 0.7141404915747821, 'auprc': 0.8492130666895029, 'loss_val': 0.7443871479058054, 'psi': 0.7681695216206704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=89 head_norm_before_train=2.412711 (no previous merge yet)
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.8991577187180365, 'auprc': 0.9984261865544981, 'loss_val': 0.2767166611839344, 'psi': 0.9388651058526212}-{'f1_val': 0.9016951821696971, 'auprc': 0.998426322503249, 'loss_val': 0.2611268291763574, 'psi': 0.9403876383031179}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=2.123033 (no previous merge yet)
[S4] round=89 local utility u=0.043874 metrics={'f1_val': 0.9458934196761475, 'auprc': 0.9577145275090403, 'loss_val': 0.3113855375484466, 'psi': 0.9506218628093046}-{'f1_val': 0.9403672217906807, 'auprc': 0.9433189954868095, 'loss_val': 0.3227900173759681, 'psi': 0.9415479312691322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=89 head_norm_before_train=1.868975 cos_to_last_merge=0.7853 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9935358339090017, 'loss_val': 0.023669724452216757, 'psi': 0.995038463102433}-{'f1_val': 0.9960402158980539, 'auprc': 0.9935592033728456, 'loss_val': 0.02373456712423987, 'psi': 0.9950478108879707}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=1.692481 cos_to_last_merge=0.7881 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.788
[S6] round=89 local utility u=0.658296 metrics={'f1_val': 0.7102470964067669, 'auprc': 0.8504908300588628, 'loss_val': 0.8210247682961676, 'psi': 0.7663445898676053}-{'f1_val': 0.6108338114637322, 'auprc': 0.6814046956235935, 'loss_val': 1.0338795539867907, 'psi': 0.6390621651276767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=89 head_norm_before_train=1.608864 cos_to_last_merge=0.9161 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=89 local utility u=0.858216 metrics={'f1_val': 0.6975656610494451, 'auprc': 0.8814517286128191, 'loss_val': 0.28606493820173967, 'psi': 0.7711200880747947}-{'f1_val': 0.578426014771401, 'auprc': 0.7900228724579287, 'loss_val': 1.0133723136337245, 'psi': 0.663064757846012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=89 head_norm_before_train=2.073200 cos_to_last_merge=0.7378 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.738
[S8] round=89 local utility u=0.031928 metrics={'f1_val': 0.9832726227447797, 'auprc': 0.9974705087753646, 'loss_val': 0.053962393155582086, 'psi': 0.9889517771570137}-{'f1_val': 0.9750080791060296, 'auprc': 0.9964499158166025, 'loss_val': 0.06516926074440696, 'psi': 0.9835848137902587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=89 head_norm_before_train=1.853278 cos_to_last_merge=0.8808 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9929930676079219, 'loss_val': 0.056412592084586814, 'psi': 0.9935608546415771}-{'f1_val': 0.9968841373706654, 'auprc': 0.9955440856906511, 'loss_val': 0.019148791925339453, 'psi': 0.9963481166986596}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.025338 cos_to_last_merge=0.9286 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=89 local utility u=0.000102 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961347978305877, 'loss_val': 0.025840548438267164, 'psi': 0.995515999977894}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961214185346562, 'loss_val': 0.026004725587615275, 'psi': 0.9955106482595214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=89 head_norm_before_train=2.336074 (no previous merge yet)
[S11] round=89 local utility u=0.000752 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979561452446453, 'loss_val': 0.0175164764534682, 'psi': 0.9972679679536054}-{'f1_val': 0.996567470639547, 'auprc': 0.998404071375617, 'loss_val': 0.018913773324008107, 'psi': 0.997302110933975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=89 head_norm_before_train=1.846566 cos_to_last_merge=0.8153 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=89 local utility u=0.233409 metrics={'f1_val': 0.746962193117374, 'auprc': 0.772517622841409, 'loss_val': 0.7683279992587896, 'psi': 0.757184365006988}-{'f1_val': 0.6998409065890283, 'auprc': 0.7389715545726138, 'loss_val': 0.8517808027148301, 'psi': 0.7154931657824625}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=89 head_norm_before_train=1.988050 cos_to_last_merge=0.8517 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.852
[S14] round=89 local utility u=0.078851 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9990406034045413, 'loss_val': 0.01775976501480161, 'psi': 0.9983079521421475}-{'f1_val': 0.9755770278306203, 'auprc': 0.9990344779245799, 'loss_val': 0.041988427787985214, 'psi': 0.9849600078682041}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=89 head_norm_before_train=1.851559 cos_to_last_merge=0.8500 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.850
[S15] round=89 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9982613917823904, 'loss_val': 0.019594239165324347, 'psi': 0.9975749088298163}-{'f1_val': 0.7008305005721126, 'auprc': 0.807949808773151, 'loss_val': 0.708593115217314, 'psi': 0.743678223852528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=89 head_norm_before_train=1.989270 cos_to_last_merge=0.9144 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=89 local utility u=0.006837 metrics={'f1_val': 0.9928508455745393, 'auprc': 0.9891583191801733, 'loss_val': 0.03594302621509125, 'psi': 0.9913738350167929}-{'f1_val': 0.9917569730015601, 'auprc': 0.9878856963627043, 'loss_val': 0.03923541673272315, 'psi': 0.9902084623460177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=89 head_norm_before_train=1.891420 cos_to_last_merge=0.9026 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.903
[S17] round=89 local utility u=0.310421 metrics={'f1_val': 0.9337307697985089, 'auprc': 0.9860374700489518, 'loss_val': 0.3102309102071849, 'psi': 0.9546534498986861}-{'f1_val': 0.8747908816110377, 'auprc': 0.9626774274716526, 'loss_val': 0.5073534638434933, 'psi': 0.9099454999552836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=90 head_norm_before_train=1.851220 cos_to_last_merge=0.8971 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7162094212454545, 'auprc': 0.8501837056463066, 'loss_val': 0.8154113521190667, 'psi': 0.7697991350057953}-{'f1_val': 0.7209721528654774, 'auprc': 0.8236244884466742, 'loss_val': 0.6369993987608519, 'psi': 0.7620330870979561}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.417587 (no previous merge yet)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8091126632388451, 'auprc': 0.9927251099548517, 'loss_val': 0.47258476397422844, 'psi': 0.8825576419252478}-{'f1_val': 0.8991577187180365, 'auprc': 0.9984261865544981, 'loss_val': 0.2767166611839344, 'psi': 0.9388651058526212}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=2.123398 (no previous merge yet)
[S4] round=90 local utility u=0.045923 metrics={'f1_val': 0.95420016945861, 'auprc': 0.9695249853405408, 'loss_val': 0.3048118227841227, 'psi': 0.9603300958113823}-{'f1_val': 0.9458934196761475, 'auprc': 0.9577145275090403, 'loss_val': 0.3113855375484466, 'psi': 0.9506218628093046}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=90 head_norm_before_train=1.870559 cos_to_last_merge=0.7854 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9909425044984591, 'loss_val': 0.024894177999135354, 'psi': 0.994001131338216}-{'f1_val': 0.9960402158980539, 'auprc': 0.9935358339090017, 'loss_val': 0.023669724452216757, 'psi': 0.995038463102433}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=1.699656 cos_to_last_merge=0.7870 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.787
[S6] round=90 local utility u=0.943211 metrics={'f1_val': 0.8852832277912059, 'auprc': 0.9544313058589352, 'loss_val': 0.2966417603142294, 'psi': 0.9129424590182977}-{'f1_val': 0.7102470964067669, 'auprc': 0.8504908300588628, 'loss_val': 0.8210247682961676, 'psi': 0.7663445898676053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S6] sending update (kind=head size=1808 to 1 peers)
[S7] START round=90 head_norm_before_train=1.611332 cos_to_last_merge=0.9159 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.6548516292992378, 'auprc': 0.7950054517161759, 'loss_val': 0.6527512567789063, 'psi': 0.7109131582660131}-{'f1_val': 0.6975656610494451, 'auprc': 0.8814517286128191, 'loss_val': 0.28606493820173967, 'psi': 0.7711200880747947}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.078413 cos_to_last_merge=0.7371 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=90 local utility u=0.039544 metrics={'f1_val': 0.992174240363445, 'auprc': 0.999120908220686, 'loss_val': 0.03323451660941462, 'psi': 0.9949529075063415}-{'f1_val': 0.9832726227447797, 'auprc': 0.9974705087753646, 'loss_val': 0.053962393155582086, 'psi': 0.9889517771570137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=90 head_norm_before_train=1.856386 cos_to_last_merge=0.8801 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=90 local utility u=0.018130 metrics={'f1_val': 0.9922956400163937, 'auprc': 0.9991991754861467, 'loss_val': 0.02890894660076402, 'psi': 0.9950570542042949}-{'f1_val': 0.9939393793306803, 'auprc': 0.9929930676079219, 'loss_val': 0.056412592084586814, 'psi': 0.9935608546415771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=90 head_norm_before_train=2.030579 cos_to_last_merge=0.9284 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957898261727869, 'loss_val': 0.026632401848573576, 'psi': 0.9953780113147737}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961347978305877, 'loss_val': 0.025840548438267164, 'psi': 0.995515999977894}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.333483 (no previous merge yet)
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9975908883612976, 'loss_val': 0.01932261114636813, 'psi': 0.9969768377282473}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979561452446453, 'loss_val': 0.0175164764534682, 'psi': 0.9972679679536054}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=1.851487 cos_to_last_merge=0.8147 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.815
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.7301785062218921, 'auprc': 0.7557686762621159, 'loss_val': 0.9498142642950131, 'psi': 0.7404145742379815}-{'f1_val': 0.746962193117374, 'auprc': 0.772517622841409, 'loss_val': 0.7683279992587896, 'psi': 0.757184365006988}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=1.992534 cos_to_last_merge=0.8513 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=90 local utility u=0.002088 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9989645534604779, 'loss_val': 0.015835881082389057, 'psi': 0.9985256278605141}-{'f1_val': 0.9978195179672185, 'auprc': 0.9990406034045413, 'loss_val': 0.01775976501480161, 'psi': 0.9983079521421475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=90 head_norm_before_train=1.855569 cos_to_last_merge=0.8495 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.850
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.8900496981771323, 'auprc': 0.87766396768721, 'loss_val': 0.3694920463265917, 'psi': 0.8850954059811633}-{'f1_val': 0.9971172535281002, 'auprc': 0.9982613917823904, 'loss_val': 0.019594239165324347, 'psi': 0.9975749088298163}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=1.993217 cos_to_last_merge=0.9141 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=90 local utility u=0.001224 metrics={'f1_val': 0.993070558361763, 'auprc': 0.989118687232521, 'loss_val': 0.03469426271613564, 'psi': 0.9914898099100662}-{'f1_val': 0.9928508455745393, 'auprc': 0.9891583191801733, 'loss_val': 0.03594302621509125, 'psi': 0.9913738350167929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=90 head_norm_before_train=1.896870 cos_to_last_merge=0.9017 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.902
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.9265407810996327, 'auprc': 0.9789893516709848, 'loss_val': 0.3395656619320622, 'psi': 0.9475202093281736}-{'f1_val': 0.9337307697985089, 'auprc': 0.9860374700489518, 'loss_val': 0.3102309102071849, 'psi': 0.9546534498986861}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=1.855560 cos_to_last_merge=0.8965 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.897
[S2] round=91 local utility u=0.029844 metrics={'f1_val': 0.7153817923013681, 'auprc': 0.8442997633754407, 'loss_val': 0.7331062840923137, 'psi': 0.766948980730997}-{'f1_val': 0.7162094212454545, 'auprc': 0.8501837056463066, 'loss_val': 0.8154113521190667, 'psi': 0.7697991350057953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=91 head_norm_before_train=2.422453 (no previous merge yet)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.6994345837299858, 'auprc': 0.9605822544176793, 'loss_val': 0.8574849961656305, 'psi': 0.8038936520050632}-{'f1_val': 0.8091126632388451, 'auprc': 0.9927251099548517, 'loss_val': 0.47258476397422844, 'psi': 0.8825576419252478}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=2.128632 (no previous merge yet)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9468491659360734, 'auprc': 0.9595525062463767, 'loss_val': 0.31372300306230966, 'psi': 0.9519305020601947}-{'f1_val': 0.95420016945861, 'auprc': 0.9695249853405408, 'loss_val': 0.3048118227841227, 'psi': 0.9603300958113823}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.871097 cos_to_last_merge=0.7854 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.990548469841995, 'loss_val': 0.025954513103972416, 'psi': 0.9938435174756304}-{'f1_val': 0.9960402158980539, 'auprc': 0.9909425044984591, 'loss_val': 0.024894177999135354, 'psi': 0.994001131338216}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=1.710924 cos_to_last_merge=0.7862 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.786
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.6463708927743315, 'auprc': 0.7679016838372228, 'loss_val': 0.9379444866147639, 'psi': 0.694983209199488}-{'f1_val': 0.8852832277912059, 'auprc': 0.9544313058589352, 'loss_val': 0.2966417603142294, 'psi': 0.9129424590182977}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.613784 cos_to_last_merge=0.9156 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.916
[S7] round=91 local utility u=0.141404 metrics={'f1_val': 0.6604377840544245, 'auprc': 0.8106915217015699, 'loss_val': 0.4505178845915157, 'psi': 0.7205392791132827}-{'f1_val': 0.6548516292992378, 'auprc': 0.7950054517161759, 'loss_val': 0.6527512567789063, 'psi': 0.7109131582660131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=91 head_norm_before_train=2.081879 cos_to_last_merge=0.7372 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=91 local utility u=0.003708 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.998460530799288, 'loss_val': 0.03039666136485629, 'psi': 0.9953446142406391}-{'f1_val': 0.992174240363445, 'auprc': 0.999120908220686, 'loss_val': 0.03323451660941462, 'psi': 0.9949529075063415}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=91 head_norm_before_train=1.858678 cos_to_last_merge=0.8794 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.879
[S9] round=91 local utility u=0.016385 metrics={'f1_val': 0.9971344652643916, 'auprc': 0.9961129391098555, 'loss_val': 0.015914186365443412, 'psi': 0.9967258548025771}-{'f1_val': 0.9922956400163937, 'auprc': 0.9991991754861467, 'loss_val': 0.02890894660076402, 'psi': 0.9950570542042949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=91 head_norm_before_train=2.032570 cos_to_last_merge=0.9276 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9957885014456328, 'loss_val': 0.026865110961468545, 'psi': 0.995377481423912}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957898261727869, 'loss_val': 0.026632401848573576, 'psi': 0.9953780113147737}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.334373 (no previous merge yet)
[S11] round=91 local utility u=0.001676 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9979872509965827, 'loss_val': 0.018609545345916963, 'psi': 0.9972804102543804}-{'f1_val': 0.996567470639547, 'auprc': 0.9975908883612976, 'loss_val': 0.01932261114636813, 'psi': 0.9969768377282473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=91 head_norm_before_train=1.858533 cos_to_last_merge=0.8138 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.7097178463083891, 'auprc': 0.7401339206293954, 'loss_val': 0.9787681969929479, 'psi': 0.7218842760367916}-{'f1_val': 0.7301785062218921, 'auprc': 0.7557686762621159, 'loss_val': 0.9498142642950131, 'psi': 0.7404145742379815}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.996240 cos_to_last_merge=0.8511 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=91 local utility u=0.000323 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9990166253456738, 'loss_val': 0.015345175039166787, 'psi': 0.9985464566145925}-{'f1_val': 0.9982330107938716, 'auprc': 0.9989645534604779, 'loss_val': 0.015835881082389057, 'psi': 0.9985256278605141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=91 head_norm_before_train=1.858625 cos_to_last_merge=0.8492 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.71023395031327, 'auprc': 0.7397287710890091, 'loss_val': 0.6936994411186251, 'psi': 0.7220318786235657}-{'f1_val': 0.8900496981771323, 'auprc': 0.87766396768721, 'loss_val': 0.3694920463265917, 'psi': 0.8850954059811633}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.998319 cos_to_last_merge=0.9139 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9926353730439474, 'auprc': 0.9895389975754139, 'loss_val': 0.03431232606603394, 'psi': 0.991396822856534}-{'f1_val': 0.993070558361763, 'auprc': 0.989118687232521, 'loss_val': 0.03469426271613564, 'psi': 0.9914898099100662}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=1.901028 cos_to_last_merge=0.9011 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.6740486755495971, 'auprc': 0.7209928234114849, 'loss_val': 1.5161021699036072, 'psi': 0.6928263346943522}-{'f1_val': 0.9265407810996327, 'auprc': 0.9789893516709848, 'loss_val': 0.3395656619320622, 'psi': 0.9475202093281736}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=1.859105 cos_to_last_merge=0.8961 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6715985296312423, 'auprc': 0.7819031154763528, 'loss_val': 1.0190285528530991, 'psi': 0.7157203639692865}-{'f1_val': 0.7153817923013681, 'auprc': 0.8442997633754407, 'loss_val': 0.7331062840923137, 'psi': 0.766948980730997}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.426625 (no previous merge yet)
[S3] round=92 local utility u=0.979914 metrics={'f1_val': 0.9090874670649821, 'auprc': 0.9984394018053686, 'loss_val': 0.2691454789066446, 'psi': 0.9448282409611368}-{'f1_val': 0.6994345837299858, 'auprc': 0.9605822544176793, 'loss_val': 0.8574849961656305, 'psi': 0.8038936520050632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] sending update (kind=head size=1790 to 1 peers)
[S4] START round=92 head_norm_before_train=2.136882 (no previous merge yet)
[S4] round=92 local utility u=0.007458 metrics={'f1_val': 0.9507711176918716, 'auprc': 0.9582884233759168, 'loss_val': 0.31854700390770446, 'psi': 0.9537780399654896}-{'f1_val': 0.9468491659360734, 'auprc': 0.9595525062463767, 'loss_val': 0.31372300306230966, 'psi': 0.9519305020601947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=92 head_norm_before_train=1.872295 cos_to_last_merge=0.7858 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=92 local utility u=0.001506 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9919064280407329, 'loss_val': 0.02701545126504466, 'psi': 0.9943867007551256}-{'f1_val': 0.9960402158980539, 'auprc': 0.990548469841995, 'loss_val': 0.025954513103972416, 'psi': 0.9938435174756304}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=92 head_norm_before_train=1.722906 cos_to_last_merge=0.7853 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.785
[S6] round=92 local utility u=1.000000 metrics={'f1_val': 0.8221354846337616, 'auprc': 0.9561495478558444, 'loss_val': 0.40838421072892267, 'psi': 0.8757411099225947}-{'f1_val': 0.6463708927743315, 'auprc': 0.7679016838372228, 'loss_val': 0.9379444866147639, 'psi': 0.694983209199488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1812 reason=None
[S6] sending update (kind=head size=1812 to 1 peers)
[S7] START round=92 head_norm_before_train=1.616744 cos_to_last_merge=0.9152 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=92 local utility u=0.394861 metrics={'f1_val': 0.7203707504957404, 'auprc': 0.8821898051020882, 'loss_val': 0.23488777833607125, 'psi': 0.7850983723382795}-{'f1_val': 0.6604377840544245, 'auprc': 0.8106915217015699, 'loss_val': 0.4505178845915157, 'psi': 0.7205392791132827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=92 head_norm_before_train=2.088042 cos_to_last_merge=0.7365 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.737
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9770490004777783, 'auprc': 0.9990277460881214, 'loss_val': 0.061905452263657894, 'psi': 0.9858404987219155}-{'f1_val': 0.9932673365348732, 'auprc': 0.998460530799288, 'loss_val': 0.03039666136485629, 'psi': 0.9953446142406391}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=1.861282 cos_to_last_merge=0.8787 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.879
[S9] round=92 local utility u=0.005099 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9984876635755664, 'loss_val': 0.015303532379235632, 'psi': 0.9979219994366129}-{'f1_val': 0.9971344652643916, 'auprc': 0.9961129391098555, 'loss_val': 0.015914186365443412, 'psi': 0.9967258548025771}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=92 head_norm_before_train=2.036301 cos_to_last_merge=0.9272 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=92 local utility u=0.001478 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9963034012340071, 'loss_val': 0.025454718117265518, 'psi': 0.9955834413392618}-{'f1_val': 0.9951034680760983, 'auprc': 0.9957885014456328, 'loss_val': 0.026865110961468545, 'psi': 0.995377481423912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=92 head_norm_before_train=2.333467 (no previous merge yet)
[S11] round=92 local utility u=0.000561 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9980800087204476, 'loss_val': 0.017766532717212555, 'psi': 0.9973175133439263}-{'f1_val': 0.9968091830929121, 'auprc': 0.9979872509965827, 'loss_val': 0.018609545345916963, 'psi': 0.9972804102543804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=92 head_norm_before_train=1.864942 cos_to_last_merge=0.8131 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.813
[S13] round=92 local utility u=0.298375 metrics={'f1_val': 0.7550379692725252, 'auprc': 0.7915022677412649, 'loss_val': 0.8080443592459662, 'psi': 0.7696236886600211}-{'f1_val': 0.7097178463083891, 'auprc': 0.7401339206293954, 'loss_val': 0.9787681969929479, 'psi': 0.7218842760367916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=92 head_norm_before_train=2.001377 cos_to_last_merge=0.8508 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9988116905073813, 'loss_val': 0.018509969291176275, 'psi': 0.9980706010809033}-{'f1_val': 0.9982330107938716, 'auprc': 0.9990166253456738, 'loss_val': 0.015345175039166787, 'psi': 0.9985464566145925}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=1.862872 cos_to_last_merge=0.8488 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.849
[S15] round=92 local utility u=1.000000 metrics={'f1_val': 0.9948394201977924, 'auprc': 0.9983489857143993, 'loss_val': 0.027517500226346775, 'psi': 0.9962432464044351}-{'f1_val': 0.71023395031327, 'auprc': 0.7397287710890091, 'loss_val': 0.6936994411186251, 'psi': 0.7220318786235657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=92 head_norm_before_train=2.002949 cos_to_last_merge=0.9136 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.914
[S16] round=92 local utility u=0.000000 metrics={'f1_val': 0.7464924933353496, 'auprc': 0.9018127970077583, 'loss_val': 1.3352683047903349, 'psi': 0.8086206148043131}-{'f1_val': 0.9926353730439474, 'auprc': 0.9895389975754139, 'loss_val': 0.03431232606603394, 'psi': 0.991396822856534}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=92 head_norm_before_train=1.903266 cos_to_last_merge=0.9009 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=92 local utility u=1.000000 metrics={'f1_val': 0.893707729474998, 'auprc': 0.9834947955117965, 'loss_val': 0.2647312445658576, 'psi': 0.9296225558897173}-{'f1_val': 0.6740486755495971, 'auprc': 0.7209928234114849, 'loss_val': 1.5161021699036072, 'psi': 0.6928263346943522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=93 head_norm_before_train=1.863133 cos_to_last_merge=0.8958 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.644150792237897, 'auprc': 0.7718160359635046, 'loss_val': 1.2994772103776666, 'psi': 0.69521688972814}-{'f1_val': 0.6715985296312423, 'auprc': 0.7819031154763528, 'loss_val': 1.0190285528530991, 'psi': 0.7157203639692865}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.430705 (no previous merge yet)
[S3] round=93 local utility u=0.247353 metrics={'f1_val': 0.9627615671483851, 'auprc': 0.998571609832223, 'loss_val': 0.09687991271349335, 'psi': 0.9770855842219203}-{'f1_val': 0.9090874670649821, 'auprc': 0.9984394018053686, 'loss_val': 0.2691454789066446, 'psi': 0.9448282409611368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=93 head_norm_before_train=2.144595 (no previous merge yet)
[S4] round=93 local utility u=0.014256 metrics={'f1_val': 0.9522893493769838, 'auprc': 0.9635090636908614, 'loss_val': 0.3148060823397979, 'psi': 0.956777235102535}-{'f1_val': 0.9507711176918716, 'auprc': 0.9582884233759168, 'loss_val': 0.31854700390770446, 'psi': 0.9537780399654896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=93 head_norm_before_train=1.871806 cos_to_last_merge=0.7858 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9892096871781391, 'loss_val': 0.028800477545101375, 'psi': 0.993308004410088}-{'f1_val': 0.9960402158980539, 'auprc': 0.9919064280407329, 'loss_val': 0.02701545126504466, 'psi': 0.9943867007551256}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.732816 cos_to_last_merge=0.7843 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.784
[S6] round=93 local utility u=0.550989 metrics={'f1_val': 0.9604628908235275, 'auprc': 0.9713807876365788, 'loss_val': 0.18206383525822178, 'psi': 0.964830049548748}-{'f1_val': 0.8221354846337616, 'auprc': 0.9561495478558444, 'loss_val': 0.40838421072892267, 'psi': 0.8757411099225947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=93 head_norm_before_train=1.620586 cos_to_last_merge=0.9147 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.915
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.5868148342661305, 'auprc': 0.7855921494845911, 'loss_val': 0.989711467580393, 'psi': 0.6663257603535148}-{'f1_val': 0.7203707504957404, 'auprc': 0.8821898051020882, 'loss_val': 0.23488777833607125, 'psi': 0.7850983723382795}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.094472 cos_to_last_merge=0.7355 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.736
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.9564811427385733, 'auprc': 0.9988839547356411, 'loss_val': 0.14191348924374395, 'psi': 0.9734422675374004}-{'f1_val': 0.9770490004777783, 'auprc': 0.9990277460881214, 'loss_val': 0.061905452263657894, 'psi': 0.9858404987219155}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=1.863860 cos_to_last_merge=0.8783 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=93 local utility u=0.000180 metrics={'f1_val': 0.9971317563071089, 'auprc': 0.9995776480486742, 'loss_val': 0.015734522727483075, 'psi': 0.9981101130037351}-{'f1_val': 0.9975448900106438, 'auprc': 0.9984876635755664, 'loss_val': 0.015303532379235632, 'psi': 0.9979219994366129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=93 head_norm_before_train=2.041064 cos_to_last_merge=0.9269 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9962697277648516, 'loss_val': 0.025527349116311302, 'psi': 0.9955699719515996}-{'f1_val': 0.9951034680760983, 'auprc': 0.9963034012340071, 'loss_val': 0.025454718117265518, 'psi': 0.9955834413392618}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.335901 (no previous merge yet)
[S11] round=93 local utility u=0.000214 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.998207455602837, 'loss_val': 0.017721089358386177, 'psi': 0.997368492096882}-{'f1_val': 0.9968091830929121, 'auprc': 0.9980800087204476, 'loss_val': 0.017766532717212555, 'psi': 0.9973175133439263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=93 head_norm_before_train=1.872537 cos_to_last_merge=0.8122 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.812
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.6671704426307193, 'auprc': 0.7087016093108727, 'loss_val': 0.9329122486244515, 'psi': 0.6837829093027806}-{'f1_val': 0.7550379692725252, 'auprc': 0.7915022677412649, 'loss_val': 0.8080443592459662, 'psi': 0.7696236886600211}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.004880 cos_to_last_merge=0.8508 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=93 local utility u=0.001291 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9990301115444911, 'loss_val': 0.01790917336870205, 'psi': 0.9982905507737331}-{'f1_val': 0.9975765414632514, 'auprc': 0.9988116905073813, 'loss_val': 0.018509969291176275, 'psi': 0.9980706010809033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=93 head_norm_before_train=1.867055 cos_to_last_merge=0.8485 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.848
[S15] round=93 local utility u=0.005813 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9972107961955993, 'loss_val': 0.021339952899094943, 'psi': 0.9966741812507924}-{'f1_val': 0.9948394201977924, 'auprc': 0.9983489857143993, 'loss_val': 0.027517500226346775, 'psi': 0.9962432464044351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=93 head_norm_before_train=2.005199 cos_to_last_merge=0.9131 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=93 local utility u=1.000000 metrics={'f1_val': 0.994174661766339, 'auprc': 0.9865741964428951, 'loss_val': 0.032492208304845664, 'psi': 0.9911344756369613}-{'f1_val': 0.7464924933353496, 'auprc': 0.9018127970077583, 'loss_val': 1.3352683047903349, 'psi': 0.8086206148043131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=93 head_norm_before_train=1.906017 cos_to_last_merge=0.9008 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=93 local utility u=0.290863 metrics={'f1_val': 0.9593892357628567, 'auprc': 0.9947019807282427, 'loss_val': 0.11071544136918908, 'psi': 0.9735143337490111}-{'f1_val': 0.893707729474998, 'auprc': 0.9834947955117965, 'loss_val': 0.2647312445658576, 'psi': 0.9296225558897173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] START round=94 head_norm_before_train=1.867298 cos_to_last_merge=0.8956 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=94 local utility u=0.523290 metrics={'f1_val': 0.7172390982161326, 'auprc': 0.787471746926614, 'loss_val': 0.7383944721484228, 'psi': 0.7453321577003251}-{'f1_val': 0.644150792237897, 'auprc': 0.7718160359635046, 'loss_val': 1.2994772103776666, 'psi': 0.69521688972814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=94 head_norm_before_train=2.434815 (no previous merge yet)
[S3] round=94 local utility u=0.121769 metrics={'f1_val': 0.9919008625525619, 'auprc': 0.9986287653418213, 'loss_val': 0.028349616477835172, 'psi': 0.9945920236682657}-{'f1_val': 0.9627615671483851, 'auprc': 0.998571609832223, 'loss_val': 0.09687991271349335, 'psi': 0.9770855842219203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=94 head_norm_before_train=2.148230 (no previous merge yet)
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9518700905124918, 'auprc': 0.9524066909567402, 'loss_val': 0.31835391583917355, 'psi': 0.9520847306901912}-{'f1_val': 0.9522893493769838, 'auprc': 0.9635090636908614, 'loss_val': 0.3148060823397979, 'psi': 0.956777235102535}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.873559 cos_to_last_merge=0.7858 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=94 local utility u=0.009231 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933870339859101, 'loss_val': 0.0246316619771205, 'psi': 0.9951551007724981}-{'f1_val': 0.9960402158980539, 'auprc': 0.9892096871781391, 'loss_val': 0.028800477545101375, 'psi': 0.993308004410088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=94 head_norm_before_train=1.745628 cos_to_last_merge=0.7831 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.783
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.7066567561692348, 'auprc': 0.828160484151879, 'loss_val': 0.8721003243520721, 'psi': 0.7552582473622926}-{'f1_val': 0.9604628908235275, 'auprc': 0.9713807876365788, 'loss_val': 0.18206383525822178, 'psi': 0.964830049548748}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.624708 cos_to_last_merge=0.9141 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=94 local utility u=1.000000 metrics={'f1_val': 0.995309090337122, 'auprc': 0.9986408088018541, 'loss_val': 0.12139227949800208, 'psi': 0.9966417777230149}-{'f1_val': 0.5868148342661305, 'auprc': 0.7855921494845911, 'loss_val': 0.989711467580393, 'psi': 0.6663257603535148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=94 head_norm_before_train=2.101643 cos_to_last_merge=0.7343 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.734
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.8817340724479326, 'auprc': 0.9865499019370078, 'loss_val': 0.1401553761926458, 'psi': 0.9236604042435627}-{'f1_val': 0.9564811427385733, 'auprc': 0.9988839547356411, 'loss_val': 0.14191348924374395, 'psi': 0.9734422675374004}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=1.867694 cos_to_last_merge=0.8780 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=94 local utility u=0.001373 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9994915011489387, 'loss_val': 0.01520979939103665, 'psi': 0.9983235344659618}-{'f1_val': 0.9971317563071089, 'auprc': 0.9995776480486742, 'loss_val': 0.015734522727483075, 'psi': 0.9981101130037351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=94 head_norm_before_train=2.046272 cos_to_last_merge=0.9268 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961898126781672, 'loss_val': 0.02562827097730046, 'psi': 0.9955380059169259}-{'f1_val': 0.9951034680760983, 'auprc': 0.9962697277648516, 'loss_val': 0.025527349116311302, 'psi': 0.9955699719515996}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.339835 (no previous merge yet)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9975491587801381, 'loss_val': 0.01819931847663255, 'psi': 0.9971051733678025}-{'f1_val': 0.9968091830929121, 'auprc': 0.998207455602837, 'loss_val': 0.017721089358386177, 'psi': 0.997368492096882}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=1.880920 cos_to_last_merge=0.8113 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.811
[S13] round=94 local utility u=0.199900 metrics={'f1_val': 0.7334348500313566, 'auprc': 0.7363628858298098, 'loss_val': 1.0136826933205456, 'psi': 0.7346060643507378}-{'f1_val': 0.6671704426307193, 'auprc': 0.7087016093108727, 'loss_val': 0.9329122486244515, 'psi': 0.6837829093027806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=94 head_norm_before_train=2.008985 cos_to_last_merge=0.8504 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.850
[S14] round=94 local utility u=0.001474 metrics={'f1_val': 0.9977975102598944, 'auprc': 0.9989950600729571, 'loss_val': 0.014856635493782553, 'psi': 0.9982765301851195}-{'f1_val': 0.9977975102598944, 'auprc': 0.9990301115444911, 'loss_val': 0.01790917336870205, 'psi': 0.9982905507737331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=94 head_norm_before_train=1.870119 cos_to_last_merge=0.8482 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.848
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9959021853469847, 'auprc': 0.9974809003346582, 'loss_val': 0.025972162283806083, 'psi': 0.9965336713420541}-{'f1_val': 0.9963164379542544, 'auprc': 0.9972107961955993, 'loss_val': 0.021339952899094943, 'psi': 0.9966741812507924}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.008328 cos_to_last_merge=0.9127 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.913
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9931046807840835, 'auprc': 0.986947845518987, 'loss_val': 0.034750698469254784, 'psi': 0.990641946678045}-{'f1_val': 0.994174661766339, 'auprc': 0.9865741964428951, 'loss_val': 0.032492208304845664, 'psi': 0.9911344756369613}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=1.910051 cos_to_last_merge=0.9007 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.8645486135117204, 'auprc': 0.9624770298788026, 'loss_val': 0.5170977878221881, 'psi': 0.9037199800585533}-{'f1_val': 0.9593892357628567, 'auprc': 0.9947019807282427, 'loss_val': 0.11071544136918908, 'psi': 0.9735143337490111}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=95 head_norm_before_train=1.870375 cos_to_last_merge=0.8955 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.896
[S2] round=95 local utility u=0.092099 metrics={'f1_val': 0.7161905808311884, 'auprc': 0.8572777397008294, 'loss_val': 0.7573235749465497, 'psi': 0.7726254443790448}-{'f1_val': 0.7172390982161326, 'auprc': 0.787471746926614, 'loss_val': 0.7383944721484228, 'psi': 0.7453321577003251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=95 head_norm_before_train=2.439109 (no previous merge yet)
[S3] round=95 local utility u=0.019138 metrics={'f1_val': 0.996947988970087, 'auprc': 0.9986431470059561, 'loss_val': 0.02039869063112789, 'psi': 0.9976260521844347}-{'f1_val': 0.9919008625525619, 'auprc': 0.9986287653418213, 'loss_val': 0.028349616477835172, 'psi': 0.9945920236682657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=95 head_norm_before_train=2.150962 (no previous merge yet)
[S4] round=95 local utility u=0.031047 metrics={'f1_val': 0.9526038846010594, 'auprc': 0.9676054043672361, 'loss_val': 0.3062596791069988, 'psi': 0.95860449250753}-{'f1_val': 0.9518700905124918, 'auprc': 0.9524066909567402, 'loss_val': 0.31835391583917355, 'psi': 0.9520847306901912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=95 head_norm_before_train=1.878705 cos_to_last_merge=0.7858 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9929735725557984, 'loss_val': 0.024245812560789715, 'psi': 0.9948135585611517}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933870339859101, 'loss_val': 0.0246316619771205, 'psi': 0.9951551007724981}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.754509 cos_to_last_merge=0.7823 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.782
[S6] round=95 local utility u=0.647851 metrics={'f1_val': 0.8201391071660912, 'auprc': 0.9331536437472256, 'loss_val': 0.5722715099476108, 'psi': 0.8653449217985449}-{'f1_val': 0.7066567561692348, 'auprc': 0.828160484151879, 'loss_val': 0.8721003243520721, 'psi': 0.7552582473622926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=95 head_norm_before_train=1.627904 cos_to_last_merge=0.9138 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.914
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6102326825535817, 'auprc': 0.7822286508324819, 'loss_val': 0.8700008729481302, 'psi': 0.6790310698651418}-{'f1_val': 0.995309090337122, 'auprc': 0.9986408088018541, 'loss_val': 0.12139227949800208, 'psi': 0.9966417777230149}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.102216 cos_to_last_merge=0.7344 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.734
[S8] round=95 local utility u=0.392676 metrics={'f1_val': 0.9900027071046373, 'auprc': 0.9966551527544756, 'loss_val': 0.03473000979683228, 'psi': 0.9926636853645726}-{'f1_val': 0.8817340724479326, 'auprc': 0.9865499019370078, 'loss_val': 0.1401553761926458, 'psi': 0.9236604042435627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=95 head_norm_before_train=1.872316 cos_to_last_merge=0.8776 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9901806442806981, 'auprc': 0.9992011680735613, 'loss_val': 0.04071616701877884, 'psi': 0.9937888537978433}-{'f1_val': 0.9975448900106438, 'auprc': 0.9994915011489387, 'loss_val': 0.01520979939103665, 'psi': 0.9983235344659618}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.051711 cos_to_last_merge=0.9266 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958312468620978, 'loss_val': 0.025946639741776766, 'psi': 0.995394579590498}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961898126781672, 'loss_val': 0.02562827097730046, 'psi': 0.9955380059169259}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=2.340825 (no previous merge yet)
[S11] round=95 local utility u=0.000000 metrics={'f1_val': 0.988977745765506, 'auprc': 0.9966527437592727, 'loss_val': 0.03654136786030985, 'psi': 0.9920477449630127}-{'f1_val': 0.9968091830929121, 'auprc': 0.9975491587801381, 'loss_val': 0.01819931847663255, 'psi': 0.9971051733678025}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=95 head_norm_before_train=1.888992 cos_to_last_merge=0.8104 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=95 local utility u=0.000000 metrics={'f1_val': 0.6455482989031844, 'auprc': 0.8399002210405193, 'loss_val': 1.147086322347165, 'psi': 0.7232890677581183}-{'f1_val': 0.7334348500313566, 'auprc': 0.7363628858298098, 'loss_val': 1.0136826933205456, 'psi': 0.7346060643507378}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=95 head_norm_before_train=2.012731 cos_to_last_merge=0.8497 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.850
[S14] round=95 local utility u=0.001165 metrics={'f1_val': 0.9984539900362299, 'auprc': 0.9980944535830041, 'loss_val': 0.0137628798759036, 'psi': 0.9983101754549396}-{'f1_val': 0.9977975102598944, 'auprc': 0.9989950600729571, 'loss_val': 0.014856635493782553, 'psi': 0.9982765301851195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=95 head_norm_before_train=1.874362 cos_to_last_merge=0.8478 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.848
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9885685681835217, 'auprc': 0.990445879798695, 'loss_val': 0.06937542722075944, 'psi': 0.989319492829591}-{'f1_val': 0.9959021853469847, 'auprc': 0.9974809003346582, 'loss_val': 0.025972162283806083, 'psi': 0.9965336713420541}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.012365 cos_to_last_merge=0.9124 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=95 local utility u=0.006945 metrics={'f1_val': 0.994174661766339, 'auprc': 0.9887276822525719, 'loss_val': 0.03261946484332961, 'psi': 0.9919958699608321}-{'f1_val': 0.9931046807840835, 'auprc': 0.986947845518987, 'loss_val': 0.034750698469254784, 'psi': 0.990641946678045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=95 head_norm_before_train=1.913616 cos_to_last_merge=0.9002 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.900
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.85976736582337, 'auprc': 0.9527348644380571, 'loss_val': 0.5646218106109512, 'psi': 0.8969543652692449}-{'f1_val': 0.8645486135117204, 'auprc': 0.9624770298788026, 'loss_val': 0.5170977878221881, 'psi': 0.9037199800585533}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=1.874031 cos_to_last_merge=0.8953 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=96 local utility u=0.145106 metrics={'f1_val': 0.7438084371752817, 'auprc': 0.8416675377824753, 'loss_val': 0.585989070584615, 'psi': 0.7829520774181591}-{'f1_val': 0.7161905808311884, 'auprc': 0.8572777397008294, 'loss_val': 0.7573235749465497, 'psi': 0.7726254443790448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=96 head_norm_before_train=2.443384 (no previous merge yet)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9986177784923299, 'loss_val': 0.13964070054260289, 'psi': 0.9759448767796701}-{'f1_val': 0.996947988970087, 'auprc': 0.9986431470059561, 'loss_val': 0.02039869063112789, 'psi': 0.9976260521844347}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.156582 (no previous merge yet)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9518102115949871, 'auprc': 0.9677756645531728, 'loss_val': 0.30976263270729154, 'psi': 0.9581963927782613}-{'f1_val': 0.9526038846010594, 'auprc': 0.9676054043672361, 'loss_val': 0.3062596791069988, 'psi': 0.95860449250753}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.886874 cos_to_last_merge=0.7857 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9882241185100686, 'loss_val': 0.028034375135386175, 'psi': 0.9929137769428599}-{'f1_val': 0.9960402158980539, 'auprc': 0.9929735725557984, 'loss_val': 0.024245812560789715, 'psi': 0.9948135585611517}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=1.765424 cos_to_last_merge=0.7813 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.781
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.6374713888069886, 'auprc': 0.6957584176301224, 'loss_val': 1.0720486615177964, 'psi': 0.6607862003362421}-{'f1_val': 0.8201391071660912, 'auprc': 0.9331536437472256, 'loss_val': 0.5722715099476108, 'psi': 0.8653449217985449}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.628726 cos_to_last_merge=0.9134 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=96 local utility u=0.137172 metrics={'f1_val': 0.6277194527095608, 'auprc': 0.7885812673538108, 'loss_val': 0.7196346790687292, 'psi': 0.6920641785672608}-{'f1_val': 0.6102326825535817, 'auprc': 0.7822286508324819, 'loss_val': 0.8700008729481302, 'psi': 0.6790310698651418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=96 head_norm_before_train=2.101597 cos_to_last_merge=0.7342 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.734
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9750080791060296, 'auprc': 0.9990150579877568, 'loss_val': 0.06516666253669398, 'psi': 0.9846108706587204}-{'f1_val': 0.9900027071046373, 'auprc': 0.9966551527544756, 'loss_val': 0.03473000979683228, 'psi': 0.9926636853645726}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=1.874254 cos_to_last_merge=0.8778 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=96 local utility u=0.031705 metrics={'f1_val': 0.9967149094376494, 'auprc': 0.9992011680735613, 'loss_val': 0.016512111098026243, 'psi': 0.9977094128920141}-{'f1_val': 0.9901806442806981, 'auprc': 0.9992011680735613, 'loss_val': 0.04071616701877884, 'psi': 0.9937888537978433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=96 head_norm_before_train=2.057184 cos_to_last_merge=0.9264 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=96 local utility u=0.000663 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9961546784784587, 'loss_val': 0.02559184823322795, 'psi': 0.9955239522370425}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958312468620978, 'loss_val': 0.025946639741776766, 'psi': 0.995394579590498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=96 head_norm_before_train=2.340689 (no previous merge yet)
[S11] round=96 local utility u=0.028758 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9969021971219199, 'loss_val': 0.02283230544084044, 'psi': 0.9964533636952152}-{'f1_val': 0.988977745765506, 'auprc': 0.9966527437592727, 'loss_val': 0.03654136786030985, 'psi': 0.9920477449630127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=96 head_norm_before_train=1.899265 cos_to_last_merge=0.8094 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6622448059739338, 'auprc': 0.6996930520559923, 'loss_val': 1.0875847267207233, 'psi': 0.6772241044067572}-{'f1_val': 0.6455482989031844, 'auprc': 0.8399002210405193, 'loss_val': 1.147086322347165, 'psi': 0.7232890677581183}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.017551 cos_to_last_merge=0.8491 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9982336447549325, 'auprc': 0.9981832022553093, 'loss_val': 0.013706535188933467, 'psi': 0.9982134677550832}-{'f1_val': 0.9984539900362299, 'auprc': 0.9980944535830041, 'loss_val': 0.0137628798759036, 'psi': 0.9983101754549396}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=1.878855 cos_to_last_merge=0.8474 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.847
[S15] round=96 local utility u=0.043131 metrics={'f1_val': 0.9938142430606698, 'auprc': 0.997882387390713, 'loss_val': 0.03689623415949391, 'psi': 0.9954415007926871}-{'f1_val': 0.9885685681835217, 'auprc': 0.990445879798695, 'loss_val': 0.06937542722075944, 'psi': 0.989319492829591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=96 head_norm_before_train=2.015243 cos_to_last_merge=0.9120 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.993052915221951, 'auprc': 0.9882586578414139, 'loss_val': 0.034054641103041565, 'psi': 0.9911352122697361}-{'f1_val': 0.994174661766339, 'auprc': 0.9887276822525719, 'loss_val': 0.03261946484332961, 'psi': 0.9919958699608321}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=1.920122 cos_to_last_merge=0.8989 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.899
[S17] round=96 local utility u=0.200384 metrics={'f1_val': 0.8857921257232058, 'auprc': 0.9718021703114204, 'loss_val': 0.3772038343663101, 'psi': 0.9201961435584917}-{'f1_val': 0.85976736582337, 'auprc': 0.9527348644380571, 'loss_val': 0.5646218106109512, 'psi': 0.8969543652692449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=97 head_norm_before_train=1.877709 cos_to_last_merge=0.8951 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7041507075971198, 'auprc': 0.8165811667755394, 'loss_val': 0.6550224373666385, 'psi': 0.7491228912684877}-{'f1_val': 0.7438084371752817, 'auprc': 0.8416675377824753, 'loss_val': 0.585989070584615, 'psi': 0.7829520774181591}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.447094 (no previous merge yet)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.836133694150573, 'auprc': 0.9648334260551713, 'loss_val': 0.4280616411154273, 'psi': 0.8876135869124123}-{'f1_val': 0.9608296089712303, 'auprc': 0.9986177784923299, 'loss_val': 0.13964070054260289, 'psi': 0.9759448767796701}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.165263 (no previous merge yet)
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9467908272398333, 'auprc': 0.9642744795912036, 'loss_val': 0.30374672348556553, 'psi': 0.9537842881803814}-{'f1_val': 0.9518102115949871, 'auprc': 0.9677756645531728, 'loss_val': 0.30976263270729154, 'psi': 0.9581963927782613}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.891760 cos_to_last_merge=0.7855 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=97 local utility u=0.005190 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9906686634699332, 'loss_val': 0.024987164327222356, 'psi': 0.9938915949268057}-{'f1_val': 0.9960402158980539, 'auprc': 0.9882241185100686, 'loss_val': 0.028034375135386175, 'psi': 0.9929137769428599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=97 head_norm_before_train=1.771670 cos_to_last_merge=0.7803 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.780
[S6] round=97 local utility u=0.652743 metrics={'f1_val': 0.709837841385306, 'auprc': 0.9219265210856847, 'loss_val': 0.8792660808295302, 'psi': 0.7946733132654575}-{'f1_val': 0.6374713888069886, 'auprc': 0.6957584176301224, 'loss_val': 1.0720486615177964, 'psi': 0.6607862003362421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=97 head_norm_before_train=1.628966 cos_to_last_merge=0.9134 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=97 local utility u=0.095972 metrics={'f1_val': 0.639629128202387, 'auprc': 0.7968380425405296, 'loss_val': 0.6239192675522732, 'psi': 0.702512693937644}-{'f1_val': 0.6277194527095608, 'auprc': 0.7885812673538108, 'loss_val': 0.7196346790687292, 'psi': 0.6920641785672608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=97 head_norm_before_train=2.101345 cos_to_last_merge=0.7349 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.735
[S8] round=97 local utility u=0.052870 metrics={'f1_val': 0.9934741586295472, 'auprc': 0.9873326015000671, 'loss_val': 0.03517598803466748, 'psi': 0.9910175357777552}-{'f1_val': 0.9750080791060296, 'auprc': 0.9990150579877568, 'loss_val': 0.06516666253669398, 'psi': 0.9846108706587204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=97 head_norm_before_train=1.873035 cos_to_last_merge=0.8783 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=97 local utility u=0.002926 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992025128775551, 'loss_val': 0.015644338284196327, 'psi': 0.9982079391574084}-{'f1_val': 0.9967149094376494, 'auprc': 0.9992011680735613, 'loss_val': 0.016512111098026243, 'psi': 0.9977094128920141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=97 head_norm_before_train=2.062629 cos_to_last_merge=0.9263 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=97 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9959355572527403, 'loss_val': 0.02554930066168932, 'psi': 0.9954363037467551}-{'f1_val': 0.9951034680760983, 'auprc': 0.9961546784784587, 'loss_val': 0.02559184823322795, 'psi': 0.9955239522370425}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=97 head_norm_before_train=2.343477 (no previous merge yet)
[S11] round=97 local utility u=0.002846 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972612525345452, 'loss_val': 0.020573824755544534, 'psi': 0.9968327037219719}-{'f1_val': 0.9961541414107454, 'auprc': 0.9969021971219199, 'loss_val': 0.02283230544084044, 'psi': 0.9964533636952152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=97 head_norm_before_train=1.904155 cos_to_last_merge=0.8091 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=97 local utility u=0.327808 metrics={'f1_val': 0.6772146460097522, 'auprc': 0.8763602959640728, 'loss_val': 1.051789289647983, 'psi': 0.7568729059914805}-{'f1_val': 0.6622448059739338, 'auprc': 0.6996930520559923, 'loss_val': 1.0875847267207233, 'psi': 0.6772241044067572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=97 head_norm_before_train=2.021698 cos_to_last_merge=0.8488 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9986282225138335, 'loss_val': 0.018845890443986876, 'psi': 0.9978813190227374}-{'f1_val': 0.9982336447549325, 'auprc': 0.9981832022553093, 'loss_val': 0.013706535188933467, 'psi': 0.9982134677550832}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=1.883623 cos_to_last_merge=0.8469 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.847
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.8220360134155775, 'auprc': 0.8336957207929762, 'loss_val': 0.45653859016724213, 'psi': 0.8266998963665371}-{'f1_val': 0.9938142430606698, 'auprc': 0.997882387390713, 'loss_val': 0.03689623415949391, 'psi': 0.9954415007926871}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.019689 cos_to_last_merge=0.9118 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9926353730439474, 'auprc': 0.9887970500430151, 'loss_val': 0.03522773198469367, 'psi': 0.9911000438435745}-{'f1_val': 0.993052915221951, 'auprc': 0.9882586578414139, 'loss_val': 0.034054641103041565, 'psi': 0.9911352122697361}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=1.926576 cos_to_last_merge=0.8980 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=97 local utility u=0.030987 metrics={'f1_val': 0.8843407050584358, 'auprc': 0.9754741520486958, 'loss_val': 0.31753633375199475, 'psi': 0.9207940838545398}-{'f1_val': 0.8857921257232058, 'auprc': 0.9718021703114204, 'loss_val': 0.3772038343663101, 'psi': 0.9201961435584917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=98 head_norm_before_train=1.879782 cos_to_last_merge=0.8952 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=98 local utility u=0.108369 metrics={'f1_val': 0.712954174307085, 'auprc': 0.8904127551468275, 'loss_val': 0.7125993325324079, 'psi': 0.783937606642982}-{'f1_val': 0.7041507075971198, 'auprc': 0.8165811667755394, 'loss_val': 0.6550224373666385, 'psi': 0.7491228912684877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=98 head_norm_before_train=2.450242 (no previous merge yet)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.7443715509554343, 'auprc': 0.9795411053505472, 'loss_val': 0.6960346138346469, 'psi': 0.8384393727134795}-{'f1_val': 0.836133694150573, 'auprc': 0.9648334260551713, 'loss_val': 0.4280616411154273, 'psi': 0.8876135869124123}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.169308 (no previous merge yet)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9463390279707096, 'auprc': 0.9498484273276177, 'loss_val': 0.3116705127255893, 'psi': 0.9477427877134728}-{'f1_val': 0.9467908272398333, 'auprc': 0.9642744795912036, 'loss_val': 0.30374672348556553, 'psi': 0.9537842881803814}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=1.892915 cos_to_last_merge=0.7852 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=98 local utility u=0.013378 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9976204856177431, 'loss_val': 0.023057077929700125, 'psi': 0.9970693753341718}-{'f1_val': 0.9960402158980539, 'auprc': 0.9906686634699332, 'loss_val': 0.024987164327222356, 'psi': 0.9938915949268057}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=98 head_norm_before_train=1.777633 cos_to_last_merge=0.7793 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.779
[S6] round=98 local utility u=0.443731 metrics={'f1_val': 0.8044951741614507, 'auprc': 0.9515078258296834, 'loss_val': 0.6484926148966561, 'psi': 0.8633002348287437}-{'f1_val': 0.709837841385306, 'auprc': 0.9219265210856847, 'loss_val': 0.8792660808295302, 'psi': 0.7946733132654575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=98 head_norm_before_train=1.633312 cos_to_last_merge=0.9130 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.913
[S7] round=98 local utility u=1.000000 metrics={'f1_val': 0.84982486625166, 'auprc': 0.9066830354581413, 'loss_val': 0.2080912489311215, 'psi': 0.8725681339342526}-{'f1_val': 0.639629128202387, 'auprc': 0.7968380425405296, 'loss_val': 0.6239192675522732, 'psi': 0.702512693937644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=98 head_norm_before_train=2.102964 cos_to_last_merge=0.7356 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.736
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9867984609811391, 'auprc': 0.9990729042466554, 'loss_val': 0.042580931263441174, 'psi': 0.9917082382873457}-{'f1_val': 0.9934741586295472, 'auprc': 0.9873326015000671, 'loss_val': 0.03517598803466748, 'psi': 0.9910175357777552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=1.874041 cos_to_last_merge=0.8782 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=98 local utility u=0.000459 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9994794179942774, 'loss_val': 0.015556415976100453, 'psi': 0.9983187012040973}-{'f1_val': 0.9975448900106438, 'auprc': 0.9992025128775551, 'loss_val': 0.015644338284196327, 'psi': 0.9982079391574084}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=98 head_norm_before_train=2.065801 cos_to_last_merge=0.9259 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958631652955946, 'loss_val': 0.02599228495355881, 'psi': 0.9954073469638968}-{'f1_val': 0.9951034680760983, 'auprc': 0.9959355572527403, 'loss_val': 0.02554930066168932, 'psi': 0.9954363037467551}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.348407 (no previous merge yet)
[S11] round=98 local utility u=0.000602 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9974991684796058, 'loss_val': 0.02008447593410319, 'psi': 0.9969278700999961}-{'f1_val': 0.9965470045135896, 'auprc': 0.9972612525345452, 'loss_val': 0.020573824755544534, 'psi': 0.9968327037219719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=98 head_norm_before_train=1.908220 cos_to_last_merge=0.8086 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.809
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6174187826789342, 'auprc': 0.7031380154489049, 'loss_val': 1.3169988024712085, 'psi': 0.6517064757869224}-{'f1_val': 0.6772146460097522, 'auprc': 0.8763602959640728, 'loss_val': 1.051789289647983, 'psi': 0.7568729059914805}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.024284 cos_to_last_merge=0.8487 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9894583673506845, 'auprc': 0.9990058898271982, 'loss_val': 0.0354991997117188, 'psi': 0.9932773763412899}-{'f1_val': 0.9973833833620065, 'auprc': 0.9986282225138335, 'loss_val': 0.018845890443986876, 'psi': 0.9978813190227374}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=1.888096 cos_to_last_merge=0.8466 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.847
[S15] round=98 local utility u=0.444745 metrics={'f1_val': 0.9006367235175576, 'auprc': 0.9371432128708861, 'loss_val': 0.34899444970735577, 'psi': 0.915239319258889}-{'f1_val': 0.8220360134155775, 'auprc': 0.8336957207929762, 'loss_val': 0.45653859016724213, 'psi': 0.8266998963665371}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=98 head_norm_before_train=2.024962 cos_to_last_merge=0.9116 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.912
[S16] round=98 local utility u=0.000095 metrics={'f1_val': 0.9926353730439474, 'auprc': 0.9889644374385261, 'loss_val': 0.03554072761362718, 'psi': 0.9911669988017789}-{'f1_val': 0.9926353730439474, 'auprc': 0.9887970500430151, 'loss_val': 0.03522773198469367, 'psi': 0.9911000438435745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=98 head_norm_before_train=1.931278 cos_to_last_merge=0.8973 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8635036454132334, 'auprc': 0.9732656790264187, 'loss_val': 0.38396543334448247, 'psi': 0.9074084588585075}-{'f1_val': 0.8843407050584358, 'auprc': 0.9754741520486958, 'loss_val': 0.31753633375199475, 'psi': 0.9207940838545398}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=1.883015 cos_to_last_merge=0.8951 (last merge round=15)
[S2] ⚠️ Model drifted since last merge! cos=0.895
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7172449298748769, 'auprc': 0.8617517860956689, 'loss_val': 0.7389227890800333, 'psi': 0.7750476723631937}-{'f1_val': 0.712954174307085, 'auprc': 0.8904127551468275, 'loss_val': 0.7125993325324079, 'psi': 0.783937606642982}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.775 u=0.0000 p_local=0.0837 f1=0.717 auprc=0.862 bytes=95383
[S3] START round=99 head_norm_before_train=2.452836 (no previous merge yet)
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.7299820650934751, 'auprc': 0.9863439945654626, 'loss_val': 0.7417385081662575, 'psi': 0.8325268368822701}-{'f1_val': 0.7443715509554343, 'auprc': 0.9795411053505472, 'loss_val': 0.6960346138346469, 'psi': 0.8384393727134795}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.833 u=0.0000 p_local=0.0813 f1=0.730 auprc=0.986 bytes=97236
[S4] START round=99 head_norm_before_train=2.173584 (no previous merge yet)
[S4] round=99 local utility u=0.024201 metrics={'f1_val': 0.9516962268145435, 'auprc': 0.9561657683435763, 'loss_val': 0.31436284357782573, 'psi': 0.9534840434261567}-{'f1_val': 0.9463390279707096, 'auprc': 0.9498484273276177, 'loss_val': 0.3116705127255893, 'psi': 0.9477427877134728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=100 psi=0.953 u=0.0242 p_local=0.0165 f1=0.952 auprc=0.956 bytes=93513
[S5] START round=99 head_norm_before_train=1.894276 cos_to_last_merge=0.7852 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9936902121475568, 'loss_val': 0.023926560405953166, 'psi': 0.9952763720371568}-{'f1_val': 0.9967019684784577, 'auprc': 0.9976204856177431, 'loss_val': 0.023057077929700125, 'psi': 0.9970693753341718}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.995 u=0.0000 p_local=0.0039 f1=0.996 auprc=0.994 bytes=98991
[S6] START round=99 head_norm_before_train=1.781767 cos_to_last_merge=0.7783 (last merge round=14)
[S6] ⚠️ Model drifted since last merge! cos=0.778
[S6] round=99 local utility u=0.171039 metrics={'f1_val': 0.8222716455474032, 'auprc': 0.9586054405132565, 'loss_val': 0.434365889452929, 'psi': 0.8768051635337445}-{'f1_val': 0.8044951741614507, 'auprc': 0.9515078258296834, 'loss_val': 0.6484926148966561, 'psi': 0.8633002348287437}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S6] sending update (kind=head size=1809 to 1 peers)
[S6] r=100 psi=0.877 u=0.1710 p_local=0.3668 f1=0.822 auprc=0.959 bytes=104344
[S7] START round=99 head_norm_before_train=1.640382 cos_to_last_merge=0.9122 (last merge round=15)
[S7] ⚠️ Model drifted since last merge! cos=0.912
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.575877324979873, 'auprc': 0.7793799135610282, 'loss_val': 1.1590759226712437, 'psi': 0.6572783604123351}-{'f1_val': 0.84982486625166, 'auprc': 0.9066830354581413, 'loss_val': 0.2080912489311215, 'psi': 0.8725681339342526}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.657 u=0.0000 p_local=0.3107 f1=0.576 auprc=0.779 bytes=100896
[S8] START round=99 head_norm_before_train=2.106857 cos_to_last_merge=0.7354 (last merge round=1)
[S8] ⚠️ Model drifted since last merge! cos=0.735
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9693511150000309, 'auprc': 0.9990213762579323, 'loss_val': 0.08587148843781496, 'psi': 0.9812192195031915}-{'f1_val': 0.9867984609811391, 'auprc': 0.9990729042466554, 'loss_val': 0.042580931263441174, 'psi': 0.9917082382873457}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.981 u=0.0000 p_local=0.0420 f1=0.969 auprc=0.999 bytes=104276
[S9] START round=99 head_norm_before_train=1.877422 cos_to_last_merge=0.8779 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9975448900106438, 'auprc': 0.9992064058204104, 'loss_val': 0.015576816329566753, 'psi': 0.9982094963345505}-{'f1_val': 0.9975448900106438, 'auprc': 0.9994794179942774, 'loss_val': 0.015556415976100453, 'psi': 0.9983187012040973}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.998 u=0.0000 p_local=0.0057 f1=0.998 auprc=0.999 bytes=118635
[S10] START round=99 head_norm_before_train=2.068339 cos_to_last_merge=0.9254 (last merge round=15)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9958248202379824, 'loss_val': 0.026369701961586185, 'psi': 0.9953920089408519}-{'f1_val': 0.9951034680760983, 'auprc': 0.9958631652955946, 'loss_val': 0.02599228495355881, 'psi': 0.9954073469638968}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.995 u=0.0000 p_local=0.0002 f1=0.995 auprc=0.996 bytes=106036
[S11] START round=99 head_norm_before_train=2.353846 (no previous merge yet)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9972896093781368, 'loss_val': 0.020389819780595852, 'psi': 0.9968440464594085}-{'f1_val': 0.9965470045135896, 'auprc': 0.9974991684796058, 'loss_val': 0.02008447593410319, 'psi': 0.9969278700999961}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0036 f1=0.997 auprc=0.997 bytes=116900
[S13] START round=99 head_norm_before_train=1.910221 cos_to_last_merge=0.8083 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=99 local utility u=0.699226 metrics={'f1_val': 0.7561999639906445, 'auprc': 0.781683619910397, 'loss_val': 0.9868715042298039, 'psi': 0.7663934263585455}-{'f1_val': 0.6174187826789342, 'auprc': 0.7031380154489049, 'loss_val': 1.3169988024712085, 'psi': 0.6517064757869224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S13] r=100 psi=0.766 u=0.6992 p_local=0.2250 f1=0.756 auprc=0.782 bytes=99007
[S14] START round=99 head_norm_before_train=2.028346 cos_to_last_merge=0.8484 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.848
[S14] round=99 local utility u=0.034634 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9990278530167702, 'loss_val': 0.01646389756757998, 'psi': 0.9983028519870392}-{'f1_val': 0.9894583673506845, 'auprc': 0.9990058898271982, 'loss_val': 0.0354991997117188, 'psi': 0.9932773763412899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] r=100 psi=0.998 u=0.0346 p_local=0.0129 f1=0.998 auprc=0.999 bytes=123958
[S15] START round=99 head_norm_before_train=1.892940 cos_to_last_merge=0.8461 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.846
[S15] round=99 local utility u=0.536910 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9937642709727185, 'loss_val': 0.021696986226855744, 'psi': 0.9955537094215997}-{'f1_val': 0.9006367235175576, 'auprc': 0.9371432128708861, 'loss_val': 0.34899444970735577, 'psi': 0.915239319258889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S15] r=100 psi=0.996 u=0.5369 p_local=0.2672 f1=0.997 auprc=0.994 bytes=95187
[S16] START round=99 head_norm_before_train=2.029047 cos_to_last_merge=0.9113 (last merge round=15)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9926353730439474, 'auprc': 0.9888585749705161, 'loss_val': 0.0352582017390725, 'psi': 0.9911246538145749}-{'f1_val': 0.9926353730439474, 'auprc': 0.9889644374385261, 'loss_val': 0.03554072761362718, 'psi': 0.9911669988017789}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.991 u=0.0000 p_local=0.0730 f1=0.993 auprc=0.989 bytes=104381
[S17] START round=99 head_norm_before_train=1.935439 cos_to_last_merge=0.8968 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.7616047259666983, 'auprc': 0.864934643163757, 'loss_val': 0.8425662607514282, 'psi': 0.8029366928455217}-{'f1_val': 0.8635036454132334, 'auprc': 0.9732656790264187, 'loss_val': 0.38396543334448247, 'psi': 0.9074084588585075}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.803 u=0.0000 p_local=0.1128 f1=0.762 auprc=0.865 bytes=97154
[runner] rounds complete.
[runner] all agents stopped.
