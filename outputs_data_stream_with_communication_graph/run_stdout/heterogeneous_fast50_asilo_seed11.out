[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:58303
[S3] → join 127.0.0.1:58302
[S4] → join 127.0.0.1:58302
[S5] → join 127.0.0.1:58302
[S6] → join 127.0.0.1:58302
[S7] → join 127.0.0.1:58302
[S8] → join 127.0.0.1:58302
[S9] → join 127.0.0.1:58302
[S10] → join 127.0.0.1:58302
[S11] → join 127.0.0.1:58302
[S13] → join 127.0.0.1:58302
[S14] → join 127.0.0.1:58302
[S15] → join 127.0.0.1:58302
[S16] → join 127.0.0.1:58302
[S17] → join 127.0.0.1:58302
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.180608 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.227929 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.154653 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.090814 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.123247 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.141756 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.131684 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.196279 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.204985 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.146795 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.228658 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.178700 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.173618 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.223350 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.134206 (no previous merge yet)
[S9]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3] + discovered S6
[S4] + discovered S3
[S3] + discovered S11
[S3] + discovered S8
[S3] + discovered S5
[S3] + discovered S7
[S3] + discovered S14
[S3] + discovered S17
[S3] + discovered S13
[S3] + discovered S4
[S3] + discovered S15
[S3] + discovered S16
[S4] + discovered S2
[S3] + discovered S9
[S3] + discovered S10
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S17
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S9
[S4] + discovered S5
[S5] + discovered S4
[S4] + discovered S7
[S4] + discovered S8
[S4] + discovered S13
[S4] + discovered S10
[S4] + discovered S6
[S4] + discovered S15
[S4] + discovered S16
[S6] + discovered S3
[S6] + discovered S5
[S6] + discovered S2
[S6] + discovered S4
[S5] + discovered S13
[S5] + discovered S9
[S5] + discovered S10
[S5] + discovered S14
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S17
[S5] + discovered S16
[S5] + discovered S11
[S5] + discovered S15
[S5] + discovered S8
[S7] + discovered S4
[S7] + discovered S6
[S7] + discovered S2
[S7] + discovered S5
[S7] + discovered S3
[S6] + discovered S16
[S6] + discovered S9
[S6] + discovered S11
[S6] + discovered S14
[S6] + discovered S17
[S6] + discovered S8
[S6] + discovered S15
[S6] + discovered S7
[S6] + discovered S10
[S6] + discovered S13
[S7] + discovered S9
[S7] + discovered S11
[S7] + discovered S14
[S7] + discovered S15
[S8] + discovered S4
[S8] + discovered S3
[S8] + discovered S6
[S8] + discovered S2
[S8] + discovered S5
[S7] + discovered S16
[S7] + discovered S10
[S8] + discovered S7
[S7] + discovered S8
[S7] + discovered S13
[S7] + discovered S17
[S9] + discovered S7
[S9] + discovered S2
[S8] + discovered S10
[S9] + discovered S5
[S9] + discovered S3
[S9] + discovered S4
[S9] + discovered S8
[S8] + discovered S17
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S15
[S8] + discovered S9
[S8] + discovered S16
[S9] + discovered S6
[S8] + discovered S13
[S9] + discovered S11
[S10] + discovered S4
[S10] + discovered S6
[S10] + discovered S9
[S9] + discovered S16
[S9] + discovered S17
[S10] + discovered S2
[S10] + discovered S7
[S9] + discovered S10
[S9] + discovered S15
[S9] + discovered S14
[S10] + discovered S5
[S9] + discovered S13
[S10] + discovered S8
[S10] + discovered S3
[S10] + discovered S14
[S11] + discovered S5
[S11] + discovered S7
[S10] + discovered S15
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S3
[S11] + discovered S4
[S10] + discovered S16
[S10] + discovered S11
[S11] + discovered S9
[S11] + discovered S6
[S11] + discovered S2
[S10] + discovered S17
[S10] + discovered S13
[S13] + discovered S11
[S13] + discovered S6
[S13] + discovered S10
[S13] + discovered S9
[S13] + discovered S3
[S13] + discovered S4
[S13] + discovered S7
[S13] + discovered S2
[S13] + discovered S5
[S11] + discovered S16
[S11] + discovered S13
[S11] + discovered S14
[S11] + discovered S15
[S11] + discovered S17
[S13] + discovered S8
[S14] + discovered S7
[S14] + discovered S2
[S14] + discovered S8
[S13] + discovered S15
[S13] + discovered S14
[S14] + discovered S11
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S13
[S14] + discovered S5
[S14] + discovered S6
[S14] + discovered S9
[S14] + discovered S4
[S14] + discovered S3
[S14] + discovered S10
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S3
[S15] + discovered S11
[S15] + discovered S13
[S15] + discovered S5
[S15] + discovered S14
[S15] + discovered S6
[S15] + discovered S8
[S14] + discovered S15
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S2
[S16] + discovered S13
[S16] + discovered S15
[S16] + discovered S6
[S16] + discovered S7
[S16] + discovered S8
[S16] + discovered S4
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S9
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S5
[S16] + discovered S14
[S15] + discovered S16
[S16] + discovered S11
[S17] + discovered S6
[S17] + discovered S13
[S17] + discovered S3
[S17] + discovered S11
[S17] + discovered S14
[S17] + discovered S16
[S17] + discovered S5
[S17] + discovered S10
[S16] + discovered S17
[S17] + discovered S8
[S17] + discovered S2
[S17] + discovered S15
[S17] + discovered S7
[S17] + discovered S9
[S17] + discovered S4
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] ⇄ pheromone p=1.000 → S11@127.0.0.1:58312
[S5] ⇄ pheromone p=1.000 → S16@127.0.0.1:58316
[S8] ⇄ pheromone p=1.000 → S7@127.0.0.1:58308
[S3] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S2] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S9] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:58311
[S6] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S11] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S7] ⇄ pheromone p=1.000 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=1.000 → S9@127.0.0.1:58310
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S14] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=1.000 → S6@127.0.0.1:58307
[S15] ⇄ pheromone p=1.000 → S5@127.0.0.1:58305
[S2] START round=1 head_norm_before_train=1.191655 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7740471286750301, 'loss_val': 1.2769925139677054, 'psi': 0.3946851315031521}-{'f1_val': 0.4155541938401832, 'auprc': 0.5213825008703189, 'loss_val': 1.3480483207047889, 'psi': 0.4578855166522375}
[S3] START round=1 head_norm_before_train=1.230155 (no previous merge yet)
[S3] round=1 local utility u=0.770230 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9694331213456986, 'loss_val': 1.3529977219241356, 'psi': 0.4716772879067437}-{'f1_val': 0.05677517032551098, 'auprc': 0.6318629477992252, 'loss_val': 1.3823576578760735, 'psi': 0.2868102813149967}
[S4] START round=1 head_norm_before_train=1.167971 (no previous merge yet)
[S4] round=1 local utility u=0.047864 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7851887360659046, 'loss_val': 1.2417580322676347, 'psi': 0.3982114717634723}-{'f1_val': 0.14022662889518414, 'auprc': 0.7810490033751033, 'loss_val': 1.3250670591368592, 'psi': 0.3965555786871518}
[S5] START round=1 head_norm_before_train=1.092281 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7386281068400667, 'loss_val': 1.3185056292473794, 'psi': 0.38080838559316954}-{'f1_val': 0.4247767552317834, 'auprc': 0.7696612284105844, 'loss_val': 1.3520050757351298, 'psi': 0.5627305445033037}
[S6] START round=1 head_norm_before_train=1.126975 (no previous merge yet)
[S6] round=1 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8540587384547916, 'loss_val': 1.2921140640182363, 'psi': 0.42647926461268587}-{'f1_val': 0.41613913269369174, 'auprc': 0.8281397363414633, 'loss_val': 1.3610434107165024, 'psi': 0.5809393741528004}
[S7] START round=1 head_norm_before_train=1.136431 (no previous merge yet)
[S7] round=1 local utility u=0.213872 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5685629110532977, 'loss_val': 1.3461663363104819, 'psi': 0.3126592580587741}-{'f1_val': 0.06813996316758748, 'auprc': 0.5851825536086713, 'loss_val': 1.3802673761299626, 'psi': 0.274956999344021}
[S8] START round=1 head_norm_before_train=1.153749 (no previous merge yet)
[S8] round=1 local utility u=0.030401 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7662556890744974, 'loss_val': 1.2384423730132996, 'psi': 0.3904758650655733}-{'f1_val': 0.13995598239295717, 'auprc': 0.7660457479500811, 'loss_val': 1.298615030429577, 'psi': 0.39039188861580676}
[S9] START round=1 head_norm_before_train=1.199456 (no previous merge yet)
[S9] round=1 local utility u=0.042118 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9997761397062304, 'loss_val': 1.3117829611446499, 'psi': 0.4847492301664898}-{'f1_val': 0.141397957139996, 'auprc': 0.9856730027223862, 'loss_val': 1.3537100998638756, 'psi': 0.47910797537295213}
[S10] START round=1 head_norm_before_train=1.212956 (no previous merge yet)
[S10] round=1 local utility u=0.022184 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.9760584476042551, 'loss_val': 1.2711639677034734, 'psi': 0.4735963615667364}-{'f1_val': 0.13862163754172394, 'auprc': 0.982081370874239, 'loss_val': 1.3336009730216918, 'psi': 0.47600553087472997}
[S11] START round=1 head_norm_before_train=1.148926 (no previous merge yet)
[S11] round=1 local utility u=0.420991 metrics={'f1_val': 0.21107085251421642, 'auprc': 0.7268458156918818, 'loss_val': 1.3262338307846393, 'psi': 0.41738083778528257}-{'f1_val': 0.0921497856981728, 'auprc': 0.6942403268161818, 'loss_val': 1.356873821535176, 'psi': 0.3329860021453764}
[S13] START round=1 head_norm_before_train=1.228395 (no previous merge yet)
[S13] round=1 local utility u=0.252155 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6769396634030053, 'loss_val': 1.2729211539161174, 'psi': 0.35502407538506847}-{'f1_val': 0.10392028033289531, 'auprc': 0.6091913296506237, 'loss_val': 1.3550260094045001, 'psi': 0.3060287000599867}
[S14] START round=1 head_norm_before_train=1.183564 (no previous merge yet)
[S14] round=1 local utility u=0.283275 metrics={'f1_val': 0.26668247838562287, 'auprc': 0.7090637997932482, 'loss_val': 1.3462313783235877, 'psi': 0.44363500694867297}-{'f1_val': 0.2455335726647105, 'auprc': 0.5730877591728099, 'loss_val': 1.377959278962684, 'psi': 0.3765552472679502}
[S15] START round=1 head_norm_before_train=1.186070 (no previous merge yet)
[S15] round=1 local utility u=0.083830 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7684785917449741, 'loss_val': 1.2703549126987803, 'psi': 0.3912316275149247}-{'f1_val': 0.13973365136155833, 'auprc': 0.7281182145359321, 'loss_val': 1.316934051568236, 'psi': 0.3750874766313078}
[S16] START round=1 head_norm_before_train=1.226386 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.750787118177919, 'loss_val': 1.3125698189317678, 'psi': 0.3846973173906896}-{'f1_val': 0.14063745019920318, 'auprc': 0.7883470243261994, 'loss_val': 1.3421781412453009, 'psi': 0.3997212798500017}
[S17] START round=1 head_norm_before_train=1.139849 (no previous merge yet)
[S17] round=1 local utility u=0.132287 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5916849497948207, 'loss_val': 1.2921327622054342, 'psi': 0.3212433579083589}-{'f1_val': 0.12609116785686547, 'auprc': 0.5554092070295098, 'loss_val': 1.358732466242908, 'psi': 0.2978183835259232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:58307
[S9] sending update (kind=head size=1794 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1794) from S9
[S6] cosine check vs S9: cos=-0.0357
[S6] DROPPED delta from S9 (cos=-0.0357 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S3] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:58314
[S3] sending update (kind=head size=1791 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S3
[S14] cosine check vs S3: cos=-0.0148
[S14] DROPPED delta from S3 (cos=-0.0148 < 0.0)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S2@127.0.0.1:58302
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S14] → sending delta(kind=head bytes=1790) to S3@127.0.0.1:58303
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S7] → sending delta(kind=head bytes=1782) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:58317
[S7] sending update (kind=head size=1782 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1782) from S7
[S16] cosine check vs S7: cos=-0.0115
[S16] DROPPED delta from S7 (cos=-0.0115 < 0.0)
[S8] sending update (kind=head size=1793 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S8
[S17] cosine check vs S8: cos=-0.0094
[S17] DROPPED delta from S8 (cos=-0.0094 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:58310
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S15] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:58305
[S10] sending update (kind=head size=1791 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S4
[S9] cosine check vs S4: cos=0.0893
[S6] RECEIVED delta(kind=head bytes=1791) from S10
[S6] cosine check vs S10: cos=-0.0577
[S6] DROPPED delta from S10 (cos=-0.0577 < 0.0)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S7@127.0.0.1:58308
[S17] sending update (kind=head size=1791 to 1 peers)
[S14] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:58302
[S3] RECEIVED delta(kind=head bytes=1790) from S14
[S3] cosine check vs S14: cos=-0.0148
[S3] DROPPED delta from S14 (cos=-0.0148 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1791) from S17
[S7] cosine check vs S17: cos=0.0078
[S2] RECEIVED delta(kind=head bytes=1792) from S11
[S2] cosine check vs S11: cos=-0.0789
[S2] DROPPED delta from S11 (cos=-0.0789 < 0.0)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S13
[S2] cosine check vs S13: cos=0.0314
[S15] sending update (kind=head size=1788 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S15
[S5] cosine check vs S15: cos=0.0069
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1418 head_norm=1.230414
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.654642e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.4154 head_norm=0.893042 delta_norm=0.865464
[S2] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.105770
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.219033e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.827586 delta_norm=0.821903
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.144167
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.180779e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1043 head_norm=0.824481 delta_norm=0.818078
[S7] aggregate: ROLLBACK (f1_val pre=0.142 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.212806
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.182645e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.894919 delta_norm=0.818264
[S9] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.893042 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6147697666332137, 'loss_val': 1.2429693216374247, 'psi': 0.33097418668642553}-{'f1_val': 0.1417771333885667, 'auprc': 0.7740471286750301, 'loss_val': 1.2769925139677054, 'psi': 0.3946851315031521}
[S3] START round=2 head_norm_before_train=1.241026 (no previous merge yet)
[S3] round=2 local utility u=0.054545 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9926421725201786, 'loss_val': 1.3135357504178016, 'psi': 0.4809609083765357}-{'f1_val': 0.13984006561410703, 'auprc': 0.9694331213456986, 'loss_val': 1.3529977219241356, 'psi': 0.4716772879067437}
[S4] START round=2 head_norm_before_train=1.212425 (no previous merge yet)
[S4] round=2 local utility u=0.075383 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7861839762406929, 'loss_val': 1.093977481434046, 'psi': 0.3986095678333877}-{'f1_val': 0.14022662889518414, 'auprc': 0.7851887360659046, 'loss_val': 1.2417580322676347, 'psi': 0.3982114717634723}
[S5] START round=2 head_norm_before_train=0.827586 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7301242232519436, 'loss_val': 1.3088758954984356, 'psi': 0.3774068321579203}-{'f1_val': 0.14226190476190476, 'auprc': 0.7386281068400667, 'loss_val': 1.3185056292473794, 'psi': 0.38080838559316954}
[S6] START round=2 head_norm_before_train=1.164881 (no previous merge yet)
[S6] round=2 local utility u=0.068093 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.87105887759583, 'loss_val': 1.2069276051479778, 'psi': 0.4332793202691012}-{'f1_val': 0.14142628205128205, 'auprc': 0.8540587384547916, 'loss_val': 1.2921140640182363, 'psi': 0.42647926461268587}
[S7] START round=2 head_norm_before_train=0.824481 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.197155 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6969801950716705, 'loss_val': 1.3371076221897145, 'psi': 0.3640261716661232}-{'f1_val': 0.14205682272909165, 'auprc': 0.5685629110532977, 'loss_val': 1.3461663363104819, 'psi': 0.3126592580587741}
[S8] START round=2 head_norm_before_train=1.200613 (no previous merge yet)
[S8] round=2 local utility u=0.281460 metrics={'f1_val': 0.2111721001853457, 'auprc': 0.7771097748970766, 'loss_val': 1.135381290303734, 'psi': 0.43754717007003807}-{'f1_val': 0.13995598239295717, 'auprc': 0.7662556890744974, 'loss_val': 1.2384423730132996, 'psi': 0.3904758650655733}
[S9] START round=2 head_norm_before_train=0.894919 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.006405 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9998343370331289, 'loss_val': 1.2991475449019005, 'psi': 0.48477250909724917}-{'f1_val': 0.141397957139996, 'auprc': 0.9997761397062304, 'loss_val': 1.3117829611446499, 'psi': 0.4847492301664898}
[S10] START round=2 head_norm_before_train=1.248257 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7362830070771748, 'loss_val': 1.1984144416582476, 'psi': 0.37768618535590426}-{'f1_val': 0.13862163754172394, 'auprc': 0.9760584476042551, 'loss_val': 1.2711639677034734, 'psi': 0.4735963615667364}
[S11] START round=2 head_norm_before_train=1.160006 (no previous merge yet)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7371230711434262, 'loss_val': 1.2884347176497062, 'psi': 0.37909743848123684}-{'f1_val': 0.21107085251421642, 'auprc': 0.7268458156918818, 'loss_val': 1.3262338307846393, 'psi': 0.41738083778528257}
[S13] START round=2 head_norm_before_train=1.256657 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6026412858853223, 'loss_val': 1.179032289803854, 'psi': 0.3252879719003608}-{'f1_val': 0.14041368337311058, 'auprc': 0.6769396634030053, 'loss_val': 1.2729211539161174, 'psi': 0.35502407538506847}
[S14] START round=2 head_norm_before_train=1.199315 (no previous merge yet)
[S14] round=2 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8409782397921841, 'loss_val': 1.3075518497043654, 'psi': 0.4206060076464959}-{'f1_val': 0.26668247838562287, 'auprc': 0.7090637997932482, 'loss_val': 1.3462313783235877, 'psi': 0.44363500694867297}
[S15] START round=2 head_norm_before_train=1.223978 (no previous merge yet)
[S15] round=2 local utility u=0.053645 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7764960173676698, 'loss_val': 1.1871166542178595, 'psi': 0.394438597764003}-{'f1_val': 0.13973365136155833, 'auprc': 0.7684785917449741, 'loss_val': 1.2703549126987803, 'psi': 0.3912316275149247}
[S16] START round=2 head_norm_before_train=1.239660 (no previous merge yet)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7295153612334285, 'loss_val': 1.278878953117538, 'psi': 0.3761886146128933}-{'f1_val': 0.14063745019920318, 'auprc': 0.750787118177919, 'loss_val': 1.3125698189317678, 'psi': 0.3846973173906896}
[S17] START round=2 head_norm_before_train=1.178526 (no previous merge yet)
[S17] round=2 local utility u=0.057382 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5813279592102569, 'loss_val': 1.1462970448193148, 'psi': 0.3171005616745334}-{'f1_val': 0.14094896331738438, 'auprc': 0.5916849497948207, 'loss_val': 1.2921327622054342, 'psi': 0.3212433579083589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:58317
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:58313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:58302
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:58304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:58312
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1800) from S6
[S11] cosine check vs S6: cos=0.0360
[S8] RECEIVED delta(kind=head bytes=1793) from S3
[S8] cosine check vs S3: cos=0.0323
[S17] RECEIVED delta(kind=head bytes=1799) from S7
[S17] cosine check vs S7: cos=0.7099
[S13] RECEIVED delta(kind=head bytes=1801) from S9
[S13] cosine check vs S9: cos=0.0034
[S4] RECEIVED delta(kind=head bytes=1795) from S8
[S4] cosine check vs S8: cos=-0.0061
[S4] DROPPED delta from S8 (cos=-0.0061 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1794) from S15
[S2] cosine check vs S15: cos=-0.0722
[S2] DROPPED delta from S15 (cos=-0.0722 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S4
[S14] cosine check vs S4: cos=0.0024
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[S17] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S17
[S11] cosine check vs S17: cos=-0.0475
[S11] DROPPED delta from S17 (cos=-0.0475 < 0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=2 metric=0.1404 head_norm=1.178004
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.304770e-01
[S11] stored merged vector for next round verification (round=2)
[S11] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.860947 delta_norm=0.830477
[S11] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=2 metric=0.1404 head_norm=1.297495
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.933469e-01
[S13] stored merged vector for next round verification (round=2)
[S13] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.795908 delta_norm=0.793347
[S13] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=2 metric=0.1404 head_norm=1.224712
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.849123e-01
[S14] stored merged vector for next round verification (round=2)
[S14] DEBUG after merge:  round=2 metric=0.1404 head_norm=0.887009 delta_norm=0.884912
[S14] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=2 metric=0.2112 head_norm=1.247036
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.728553e-01
[S8] stored merged vector for next round verification (round=2)
[S8] DEBUG after merge:  round=2 metric=0.4824 head_norm=0.901542 delta_norm=0.872855
[S8] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=2 metric=0.1409 head_norm=1.242348
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.379446e-01
[S17] stored merged vector for next round verification (round=2)
[S17] DEBUG after merge:  round=2 metric=0.1409 head_norm=0.966860 delta_norm=0.437945
[S17] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.940029 cos_to_last_merge=0.9935 (last merge round=1)
[S2] round=3 local utility u=0.036450 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6141293640242979, 'loss_val': 1.1681482997850334, 'psi': 0.3307180256428592}-{'f1_val': 0.1417771333885667, 'auprc': 0.6147697666332137, 'loss_val': 1.2429693216374247, 'psi': 0.33097418668642553}
[S3] START round=3 head_norm_before_train=1.262621 (no previous merge yet)
[S3] round=3 local utility u=0.024041 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9897876785819556, 'loss_val': 1.256889653872675, 'psi': 0.4798191108012465}-{'f1_val': 0.13984006561410703, 'auprc': 0.9926421725201786, 'loss_val': 1.3135357504178016, 'psi': 0.4809609083765357}
[S4] START round=3 head_norm_before_train=1.280543 (no previous merge yet)
[S4] round=3 local utility u=1.000000 metrics={'f1_val': 0.6733479423871069, 'auprc': 0.7855067259785301, 'loss_val': 0.7759353083948581, 'psi': 0.7182114558236763}-{'f1_val': 0.14022662889518414, 'auprc': 0.7861839762406929, 'loss_val': 1.093977481434046, 'psi': 0.3986095678333877}
[S5] START round=3 head_norm_before_train=0.846173 cos_to_last_merge=0.9968 (last merge round=1)
[S5] round=3 local utility u=0.017889 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7296826737021941, 'loss_val': 1.2717740944497482, 'psi': 0.3772302123380205}-{'f1_val': 0.14226190476190476, 'auprc': 0.7301242232519436, 'loss_val': 1.3088758954984356, 'psi': 0.3774068321579203}
[S6] START round=3 head_norm_before_train=1.214146 (no previous merge yet)
[S6] round=3 local utility u=1.000000 metrics={'f1_val': 0.41625250229074906, 'auprc': 0.9401995232899549, 'loss_val': 1.0339453717962668, 'psi': 0.6258313106904314}-{'f1_val': 0.14142628205128205, 'auprc': 0.87105887759583, 'loss_val': 1.2069276051479778, 'psi': 0.4332793202691012}
[S7] START round=3 head_norm_before_train=0.842494 cos_to_last_merge=0.9973 (last merge round=1)
[S7] round=3 local utility u=0.158373 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7904964581407833, 'loss_val': 1.3009104728743, 'psi': 0.4014326768937683}-{'f1_val': 0.14205682272909165, 'auprc': 0.6969801950716705, 'loss_val': 1.3371076221897145, 'psi': 0.3640261716661232}
[S8] START round=3 head_norm_before_train=0.901542 cos_to_last_merge=1.0000 (last merge round=2)
[S8] round=3 local utility u=1.000000 metrics={'f1_val': 0.6543529675650396, 'auprc': 0.776940933943141, 'loss_val': 1.0022049800937776, 'psi': 0.7033881541162801}-{'f1_val': 0.2111721001853457, 'auprc': 0.7771097748970766, 'loss_val': 1.135381290303734, 'psi': 0.43754717007003807}
[S9] START round=3 head_norm_before_train=0.917739 cos_to_last_merge=0.9971 (last merge round=1)
[S9] round=3 local utility u=0.026672 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9997992641493915, 'loss_val': 1.2456982329648998, 'psi': 0.4847584799437542}-{'f1_val': 0.141397957139996, 'auprc': 0.9998343370331289, 'loss_val': 1.2991475449019005, 'psi': 0.48477250909724917}
[S10] START round=3 head_norm_before_train=1.298646 (no previous merge yet)
[S10] round=3 local utility u=0.732450 metrics={'f1_val': 0.3539773059896899, 'auprc': 0.7526654913944424, 'loss_val': 1.074796357728206, 'psi': 0.5134525801515909}-{'f1_val': 0.13862163754172394, 'auprc': 0.7362830070771748, 'loss_val': 1.1984144416582476, 'psi': 0.37768618535590426}
[S11] START round=3 head_norm_before_train=0.860947 cos_to_last_merge=1.0000 (last merge round=2)
[S11] round=3 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6631460550308318, 'loss_val': 1.2905135767412281, 'psi': 0.3495066320361991}-{'f1_val': 0.14041368337311058, 'auprc': 0.7371230711434262, 'loss_val': 1.2884347176497062, 'psi': 0.37909743848123684}
[S13] START round=3 head_norm_before_train=0.795908 cos_to_last_merge=1.0000 (last merge round=2)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5764944782284408, 'loss_val': 1.1454666978964523, 'psi': 0.3148292488376082}-{'f1_val': 0.1403857625770531, 'auprc': 0.6026412858853223, 'loss_val': 1.179032289803854, 'psi': 0.3252879719003608}
[S14] START round=3 head_norm_before_train=0.887009 cos_to_last_merge=1.0000 (last merge round=2)
[S14] round=3 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7178331299164223, 'loss_val': 1.3044758973360011, 'psi': 0.3713479636961912}-{'f1_val': 0.14035785288270378, 'auprc': 0.8409782397921841, 'loss_val': 1.3075518497043654, 'psi': 0.4206060076464959}
[S15] START round=3 head_norm_before_train=1.283705 (no previous merge yet)
[S15] round=3 local utility u=0.932475 metrics={'f1_val': 0.41599167481162613, 'auprc': 0.7770470611597688, 'loss_val': 0.9813671448223502, 'psi': 0.5604138293508832}-{'f1_val': 0.13973365136155833, 'auprc': 0.7764960173676698, 'loss_val': 1.1871166542178595, 'psi': 0.394438597764003}
[S16] START round=3 head_norm_before_train=1.262030 (no previous merge yet)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7060745858408095, 'loss_val': 1.229264481946719, 'psi': 0.3668123044558457}-{'f1_val': 0.14063745019920318, 'auprc': 0.7295153612334285, 'loss_val': 1.278878953117538, 'psi': 0.3761886146128933}
[S17] START round=3 head_norm_before_train=0.966860 cos_to_last_merge=1.0000 (last merge round=2)
[S17] round=3 local utility u=0.966261 metrics={'f1_val': 0.39178269178899605, 'auprc': 0.6447263471562146, 'loss_val': 0.90897231386359, 'psi': 0.4929601539358835}-{'f1_val': 0.14094896331738438, 'auprc': 0.5813279592102569, 'loss_val': 1.1462970448193148, 'psi': 0.3171005616745334}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:58312
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S8] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1788) from S2
[S5] cosine check vs S2: cos=-0.0900
[S5] DROPPED delta from S2 (cos=-0.0900 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.0338
[S5] DROPPED delta from S10 (cos=-0.0338 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.0556
[S11] RECEIVED delta(kind=head bytes=1797) from S4
[S11] cosine check vs S4: cos=0.0164
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.7079
[S5] RECEIVED delta(kind=head bytes=1794) from S3
[S5] cosine check vs S3: cos=0.0972
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.0120
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0724
[S14] DROPPED delta from S7 (cos=-0.0724 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1791) from S9
[S14] cosine check vs S9: cos=0.4837
[S7] RECEIVED delta(kind=head bytes=1792) from S8
[S7] cosine check vs S8: cos=0.0502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1792 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1792) from S17
[S9] cosine check vs S17: cos=0.0506
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.881416
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.084018e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.820544 delta_norm=0.808402
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=0.914884
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.746539e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.804181 delta_norm=0.474654
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.868698
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.337507e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.4244 head_norm=0.666230 delta_norm=0.633751
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=3 metric=0.6733 head_norm=1.369933
[S4] _apply_head_vector_avg (torch): Δ‖w‖=9.303891e-01
[S4] stored merged vector for next round verification (round=3)
[S4] DEBUG after merge:  round=3 metric=0.6730 head_norm=0.941559 delta_norm=0.930389
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.952362
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.900077e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.725697 delta_norm=0.690008
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.1423 head_norm=0.875456
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.338892e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.1423 head_norm=0.813144 delta_norm=0.433889
[S5] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=1.292535
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.601502e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.2107 head_norm=0.800442 delta_norm=0.760150
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.982888 cos_to_last_merge=0.9827 (last merge round=1)
[S2] round=4 local utility u=1.000000 metrics={'f1_val': 0.4164687419666223, 'auprc': 0.7505096626536027, 'loss_val': 1.015785707304872, 'psi': 0.5500851102414145}-{'f1_val': 0.1417771333885667, 'auprc': 0.6141293640242979, 'loss_val': 1.1681482997850334, 'psi': 0.3307180256428592}
[S3] START round=4 head_norm_before_train=1.293472 (no previous merge yet)
[S3] round=4 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8813629954461973, 'loss_val': 1.2007421873096895, 'psi': 0.4364492375469432}-{'f1_val': 0.13984006561410703, 'auprc': 0.9897876785819556, 'loss_val': 1.256889653872675, 'psi': 0.4798191108012465}
[S4] START round=4 head_norm_before_train=0.941559 cos_to_last_merge=1.0000 (last merge round=3)
[S4] round=4 local utility u=0.101690 metrics={'f1_val': 0.668964666587205, 'auprc': 0.816441112979444, 'loss_val': 0.6390582855922979, 'psi': 0.7279552451441007}-{'f1_val': 0.6733479423871069, 'auprc': 0.7855067259785301, 'loss_val': 0.7759353083948581, 'psi': 0.7182114558236763}
[S5] START round=4 head_norm_before_train=0.813144 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.007911 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7305365754942581, 'loss_val': 1.2585147115409436, 'psi': 0.3775717730548461}-{'f1_val': 0.14226190476190476, 'auprc': 0.7296826737021941, 'loss_val': 1.2717740944497482, 'psi': 0.3772302123380205}
[S6] START round=4 head_norm_before_train=1.275773 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.41709547116373813, 'auprc': 0.7923491405503759, 'loss_val': 0.7407638502494391, 'psi': 0.5671969389183933}-{'f1_val': 0.41625250229074906, 'auprc': 0.9401995232899549, 'loss_val': 1.0339453717962668, 'psi': 0.6258313106904314}
[S7] START round=4 head_norm_before_train=0.666230 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6098031799909652, 'loss_val': 1.3071856527143506, 'psi': 0.32915536563384107}-{'f1_val': 0.14205682272909165, 'auprc': 0.7904964581407833, 'loss_val': 1.3009104728743, 'psi': 0.4014326768937683}
[S8] START round=4 head_norm_before_train=0.967660 cos_to_last_merge=0.9927 (last merge round=2)
[S8] round=4 local utility u=0.326101 metrics={'f1_val': 0.7149043496540917, 'auprc': 0.794558273106871, 'loss_val': 0.766163757921387, 'psi': 0.7467659190352034}-{'f1_val': 0.6543529675650396, 'auprc': 0.776940933943141, 'loss_val': 1.0022049800937776, 'psi': 0.7033881541162801}
[S9] START round=4 head_norm_before_train=0.725697 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8641985739698139, 'loss_val': 1.227879454782434, 'psi': 0.4305182038719232}-{'f1_val': 0.141397957139996, 'auprc': 0.9997992641493915, 'loss_val': 1.2456982329648998, 'psi': 0.4847584799437542}
[S10] START round=4 head_norm_before_train=1.345881 (no previous merge yet)
[S10] round=4 local utility u=1.000000 metrics={'f1_val': 0.7020690932837175, 'auprc': 0.9630315028316898, 'loss_val': 0.785372816713879, 'psi': 0.8064540571029064}-{'f1_val': 0.3539773059896899, 'auprc': 0.7526654913944424, 'loss_val': 1.074796357728206, 'psi': 0.5134525801515909}
[S11] START round=4 head_norm_before_train=0.820544 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6280330847818852, 'loss_val': 1.3080531183912405, 'psi': 0.3354614439366205}-{'f1_val': 0.14041368337311058, 'auprc': 0.6631460550308318, 'loss_val': 1.2905135767412281, 'psi': 0.3495066320361991}
[S13] START round=4 head_norm_before_train=0.849297 cos_to_last_merge=0.9940 (last merge round=2)
[S13] round=4 local utility u=1.000000 metrics={'f1_val': 0.7124413387298397, 'auprc': 0.7377507665276974, 'loss_val': 1.0089744604112603, 'psi': 0.7225651098489828}-{'f1_val': 0.1403857625770531, 'auprc': 0.5764944782284408, 'loss_val': 1.1454666978964523, 'psi': 0.3148292488376082}
[S14] START round=4 head_norm_before_train=0.804181 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7118036497385644, 'loss_val': 1.293681830194189, 'psi': 0.368936171625048}-{'f1_val': 0.14035785288270378, 'auprc': 0.7178331299164223, 'loss_val': 1.3044758973360011, 'psi': 0.3713479636961912}
[S15] START round=4 head_norm_before_train=1.348792 (no previous merge yet)
[S15] round=4 local utility u=1.000000 metrics={'f1_val': 0.6990014970655936, 'auprc': 0.8003212475201056, 'loss_val': 0.6839445577982014, 'psi': 0.7395293972473984}-{'f1_val': 0.41599167481162613, 'auprc': 0.7770470611597688, 'loss_val': 0.9813671448223502, 'psi': 0.5604138293508832}
[S16] START round=4 head_norm_before_train=0.800442 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6972146674751185, 'loss_val': 1.216775194004435, 'psi': 0.3632683371095693}-{'f1_val': 0.14063745019920318, 'auprc': 0.7060745858408095, 'loss_val': 1.229264481946719, 'psi': 0.3668123044558457}
[S17] START round=4 head_norm_before_train=1.048094 cos_to_last_merge=0.9934 (last merge round=2)
[S17] round=4 local utility u=0.000314 metrics={'f1_val': 0.35228783858720547, 'auprc': 0.727883094655067, 'loss_val': 0.9208446441423115, 'psi': 0.5025259410143501}-{'f1_val': 0.39178269178899605, 'auprc': 0.6447263471562146, 'loss_val': 0.90897231386359, 'psi': 0.4929601539358835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:58311
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:58312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[S4] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.0747
[S5] DROPPED delta from S10 (cos=-0.0747 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.5169
[S5] RECEIVED delta(kind=head bytes=1792) from S2
[S5] cosine check vs S2: cos=-0.1002
[S5] DROPPED delta from S2 (cos=-0.1002 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.8040
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.8717
[S10] RECEIVED delta(kind=head bytes=1792) from S13
[S10] cosine check vs S13: cos=-0.0719
[S10] DROPPED delta from S13 (cos=-0.0719 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.7275
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.7253
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.837261
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.572046e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.908432 delta_norm=0.257205
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.687155
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.586669e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1043 head_norm=0.805480 delta_norm=0.358667
[S7] aggregate: ROLLBACK (f1_val pre=0.142 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.760539
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.946625e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.886479 delta_norm=0.394662
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.1423 head_norm=0.834517
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.485435e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.1423 head_norm=1.073737 delta_norm=0.448544
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=4 metric=0.1406 head_norm=0.834472
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.101212e-01
[S16] stored merged vector for next round verification (round=4)
[S16] DEBUG after merge:  round=4 metric=0.1269 head_norm=0.726761 delta_norm=0.410121
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.127 tol_abs=0.005 tol_rel=0.0)
[S2] START round=5 head_norm_before_train=1.033563 cos_to_last_merge=0.9689 (last merge round=1)
[S2] round=5 local utility u=1.000000 metrics={'f1_val': 0.7135338340566132, 'auprc': 0.7545089446011684, 'loss_val': 0.788844779340557, 'psi': 0.7299238782744353}-{'f1_val': 0.4164687419666223, 'auprc': 0.7505096626536027, 'loss_val': 1.015785707304872, 'psi': 0.5500851102414145}
[S3] START round=5 head_norm_before_train=1.326086 (no previous merge yet)
[S3] round=5 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8098714924911292, 'loss_val': 1.099443490856262, 'psi': 0.407852636364916}-{'f1_val': 0.13984006561410703, 'auprc': 0.8813629954461973, 'loss_val': 1.2007421873096895, 'psi': 0.4364492375469432}
[S4] START round=5 head_norm_before_train=1.040097 cos_to_last_merge=0.9881 (last merge round=3)
[S4] round=5 local utility u=0.000000 metrics={'f1_val': 0.6679786809177082, 'auprc': 0.6581969017921544, 'loss_val': 0.5395000315895906, 'psi': 0.6640659692674866}-{'f1_val': 0.668964666587205, 'auprc': 0.816441112979444, 'loss_val': 0.6390582855922979, 'psi': 0.7279552451441007}
[S5] START round=5 head_norm_before_train=1.073737 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.044657 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7436867199341766, 'loss_val': 1.208651595489699, 'psi': 0.3828318308308135}-{'f1_val': 0.14226190476190476, 'auprc': 0.7305365754942581, 'loss_val': 1.2585147115409436, 'psi': 0.3775717730548461}
[S6] START round=5 head_norm_before_train=1.330706 (no previous merge yet)
[S6] round=5 local utility u=1.000000 metrics={'f1_val': 0.7109762577283636, 'auprc': 0.806961542933707, 'loss_val': 0.46640422964981715, 'psi': 0.7493703718105009}-{'f1_val': 0.41709547116373813, 'auprc': 0.7923491405503759, 'loss_val': 0.7407638502494391, 'psi': 0.5671969389183933}
[S7] START round=5 head_norm_before_train=0.805480 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.5879310182940322, 'loss_val': 1.3027704919828154, 'psi': 0.32040650095506784}-{'f1_val': 0.14205682272909165, 'auprc': 0.6098031799909652, 'loss_val': 1.3071856527143506, 'psi': 0.32915536563384107}
[S8] START round=5 head_norm_before_train=1.040527 cos_to_last_merge=0.9731 (last merge round=2)
[S8] round=5 local utility u=0.399514 metrics={'f1_val': 0.7113260992262341, 'auprc': 0.993772295874226, 'loss_val': 0.5433075506684972, 'psi': 0.8243045778854309}-{'f1_val': 0.7149043496540917, 'auprc': 0.794558273106871, 'loss_val': 0.766163757921387, 'psi': 0.7467659190352034}
[S9] START round=5 head_norm_before_train=0.886479 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7901486440541782, 'loss_val': 1.208060551372555, 'psi': 0.4008982319056689}-{'f1_val': 0.141397957139996, 'auprc': 0.8641985739698139, 'loss_val': 1.227879454782434, 'psi': 0.4305182038719232}
[S10] START round=5 head_norm_before_train=1.423161 (no previous merge yet)
[S10] round=5 local utility u=0.000000 metrics={'f1_val': 0.6805455699270571, 'auprc': 0.9479389668165918, 'loss_val': 0.6257304182774029, 'psi': 0.787502928682871}-{'f1_val': 0.7020690932837175, 'auprc': 0.9630315028316898, 'loss_val': 0.785372816713879, 'psi': 0.8064540571029064}
[S11] START round=5 head_norm_before_train=0.908432 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.4875233271113708, 'loss_val': 1.2833468542588702, 'psi': 0.2792575408684147}-{'f1_val': 0.14041368337311058, 'auprc': 0.6280330847818852, 'loss_val': 1.3080531183912405, 'psi': 0.3354614439366205}
[S13] START round=5 head_norm_before_train=0.896835 cos_to_last_merge=0.9816 (last merge round=2)
[S13] round=5 local utility u=0.000000 metrics={'f1_val': 0.3734508636315017, 'auprc': 0.7877188232321417, 'loss_val': 0.8396643463025224, 'psi': 0.5391580474717578}-{'f1_val': 0.7124413387298397, 'auprc': 0.7377507665276974, 'loss_val': 1.0089744604112603, 'psi': 0.7225651098489828}
[S14] START round=5 head_norm_before_train=0.828311 cos_to_last_merge=0.9953 (last merge round=3)
[S14] round=5 local utility u=0.034352 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7124180719704365, 'loss_val': 1.2268209375026582, 'psi': 0.36918194051779685}-{'f1_val': 0.14035785288270378, 'auprc': 0.7118036497385644, 'loss_val': 1.293681830194189, 'psi': 0.368936171625048}
[S15] START round=5 head_norm_before_train=1.418374 (no previous merge yet)
[S15] round=5 local utility u=0.179791 metrics={'f1_val': 0.701588966402071, 'auprc': 0.8633593522064293, 'loss_val': 0.5290013208457018, 'psi': 0.7662971207238143}-{'f1_val': 0.6990014970655936, 'auprc': 0.8003212475201056, 'loss_val': 0.6839445577982014, 'psi': 0.7395293972473984}
[S16] START round=5 head_norm_before_train=0.726761 cos_to_last_merge=1.0000 (last merge round=4)
[S16] round=5 local utility u=0.461567 metrics={'f1_val': 0.2881789453700524, 'auprc': 0.6932476888051076, 'loss_val': 1.1669901003038718, 'psi': 0.45020644274407445}-{'f1_val': 0.14063745019920318, 'auprc': 0.6972146674751185, 'loss_val': 1.216775194004435, 'psi': 0.3632683371095693}
[S17] START round=5 head_norm_before_train=1.142274 cos_to_last_merge=0.9773 (last merge round=2)
[S17] round=5 local utility u=0.042680 metrics={'f1_val': 0.3539689324515469, 'auprc': 0.7356752339406436, 'loss_val': 0.8689476123661165, 'psi': 0.5066514530471856}-{'f1_val': 0.35228783858720547, 'auprc': 0.727883094655067, 'loss_val': 0.9208446441423115, 'psi': 0.5025259410143501}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:58304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:58305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:58316
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S2
[S5] cosine check vs S2: cos=-0.0917
[S5] DROPPED delta from S2 (cos=-0.0917 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1793) from S16
[S6] cosine check vs S16: cos=-0.0621
[S6] DROPPED delta from S16 (cos=-0.0621 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S14
[S5] cosine check vs S14: cos=-0.1341
[S5] DROPPED delta from S14 (cos=-0.1341 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=0.9601
[S16] RECEIVED delta(kind=head bytes=1792) from S5
[S16] cosine check vs S5: cos=0.8026
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9285
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.5440
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S17
[S9] cosine check vs S17: cos=0.9353
[S3] ⇄ pheromone p=0.399 → S5@127.0.0.1:58305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.6680 head_norm=1.156266
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.191853e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.6662 head_norm=1.123900 delta_norm=0.619185
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.484 → S11@127.0.0.1:58312
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.816903
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.374901e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1314 head_norm=0.953391 delta_norm=0.237490
[S7] aggregate: ROLLBACK (f1_val pre=0.142 post=0.131 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.386 → S14@127.0.0.1:58314
[S6] ⇄ pheromone p=0.663 → S4@127.0.0.1:58304
[S11] ⇄ pheromone p=0.362 → S14@127.0.0.1:58314
[S15] ⇄ pheromone p=0.655 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.619 → S7@127.0.0.1:58308
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.1423 head_norm=1.091028
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.662072e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.1423 head_norm=1.274717 delta_norm=0.266207
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.340 → S16@127.0.0.1:58316
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.907972
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.440187e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=1.045386 delta_norm=0.244019
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.335 → S14@127.0.0.1:58314
[S10] ⇄ pheromone p=0.583 → S5@127.0.0.1:58305
[S14] ⇄ pheromone p=0.358 → S5@127.0.0.1:58305
[S2] ⇄ pheromone p=0.692 → S5@127.0.0.1:58305
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.2882 head_norm=0.757625
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.306999e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.3738 head_norm=0.879094 delta_norm=0.330700
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.420 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.477 → S9@127.0.0.1:58310
[S13] ⇄ pheromone p=0.508 → S10@127.0.0.1:58311
[S2] START round=6 head_norm_before_train=1.107413 cos_to_last_merge=0.9485 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.948
[S2] round=6 local utility u=0.102273 metrics={'f1_val': 0.7133311903976047, 'auprc': 0.7794434286034221, 'loss_val': 0.6578861166108092, 'psi': 0.7397760856799317}-{'f1_val': 0.7135338340566132, 'auprc': 0.7545089446011684, 'loss_val': 0.788844779340557, 'psi': 0.7299238782744353}
[S3] START round=6 head_norm_before_train=1.353569 (no previous merge yet)
[S3] round=6 local utility u=0.842389 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.8027484584459735, 'loss_val': 0.9329701715383795, 'psi': 0.5589707392676619}-{'f1_val': 0.13984006561410703, 'auprc': 0.8098714924911292, 'loss_val': 1.099443490856262, 'psi': 0.407852636364916}
[S4] START round=6 head_norm_before_train=1.123900 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.211797 metrics={'f1_val': 0.665618850480455, 'auprc': 0.8062968114846906, 'loss_val': 0.546046785734031, 'psi': 0.7218900348821493}-{'f1_val': 0.6679786809177082, 'auprc': 0.6581969017921544, 'loss_val': 0.5395000315895906, 'psi': 0.6640659692674866}
[S5] START round=6 head_norm_before_train=1.274717 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.067333 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7679879260428537, 'loss_val': 1.1468883037722488, 'psi': 0.39255231327428436}-{'f1_val': 0.14226190476190476, 'auprc': 0.7436867199341766, 'loss_val': 1.208651595489699, 'psi': 0.3828318308308135}
[S6] START round=6 head_norm_before_train=1.398618 (no previous merge yet)
[S6] round=6 local utility u=0.254549 metrics={'f1_val': 0.6970488185810503, 'auprc': 0.9648203685766981, 'loss_val': 0.3473184632725378, 'psi': 0.8041574385793094}-{'f1_val': 0.7109762577283636, 'auprc': 0.806961542933707, 'loss_val': 0.46640422964981715, 'psi': 0.7493703718105009}
[S7] START round=6 head_norm_before_train=0.953391 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.293286 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7774385759185648, 'loss_val': 1.2847212663975427, 'psi': 0.3962095240048809}-{'f1_val': 0.14205682272909165, 'auprc': 0.5879310182940322, 'loss_val': 1.3027704919828154, 'psi': 0.32040650095506784}
[S8] START round=6 head_norm_before_train=1.124002 cos_to_last_merge=0.9437 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.944
[S8] round=6 local utility u=0.619517 metrics={'f1_val': 0.8785774711081575, 'auprc': 0.9968607411844577, 'loss_val': 0.31704788578177756, 'psi': 0.9258907791386776}-{'f1_val': 0.7113260992262341, 'auprc': 0.993772295874226, 'loss_val': 0.5433075506684972, 'psi': 0.8243045778854309}
[S9] START round=6 head_norm_before_train=1.045386 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.7271751760516596, 'loss_val': 1.110789664808809, 'psi': 0.3757088447046615}-{'f1_val': 0.141397957139996, 'auprc': 0.7901486440541782, 'loss_val': 1.208060551372555, 'psi': 0.4008982319056689}
[S10] START round=6 head_norm_before_train=1.501225 (no previous merge yet)
[S10] round=6 local utility u=0.235784 metrics={'f1_val': 0.6993300513248248, 'auprc': 0.9982032484670206, 'loss_val': 0.4176627668795033, 'psi': 0.8188793301817031}-{'f1_val': 0.6805455699270571, 'auprc': 0.9479389668165918, 'loss_val': 0.6257304182774029, 'psi': 0.787502928682871}
[S11] START round=6 head_norm_before_train=0.922701 cos_to_last_merge=0.9962 (last merge round=4)
[S11] round=6 local utility u=0.078679 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5158580773687647, 'loss_val': 1.2109930069146282, 'psi': 0.29059144097137224}-{'f1_val': 0.14041368337311058, 'auprc': 0.4875233271113708, 'loss_val': 1.2833468542588702, 'psi': 0.2792575408684147}
[S13] START round=6 head_norm_before_train=0.959381 cos_to_last_merge=0.9575 (last merge round=2)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3614655016553355, 'auprc': 0.6523172292726445, 'loss_val': 0.7607842150400848, 'psi': 0.4778061927022591}-{'f1_val': 0.3734508636315017, 'auprc': 0.7877188232321417, 'loss_val': 0.8396643463025224, 'psi': 0.5391580474717578}
[S14] START round=6 head_norm_before_train=0.858879 cos_to_last_merge=0.9838 (last merge round=3)
[S14] round=6 local utility u=0.192464 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.8068375968685662, 'loss_val': 1.1251509629334981, 'psi': 0.40694975047704873}-{'f1_val': 0.14035785288270378, 'auprc': 0.7124180719704365, 'loss_val': 1.2268209375026582, 'psi': 0.36918194051779685}
[S15] START round=6 head_norm_before_train=1.483644 (no previous merge yet)
[S15] round=6 local utility u=0.000000 metrics={'f1_val': 0.6962013253746483, 'auprc': 0.7994788268876166, 'loss_val': 0.4773540662263331, 'psi': 0.7375123259798356}-{'f1_val': 0.701588966402071, 'auprc': 0.8633593522064293, 'loss_val': 0.5290013208457018, 'psi': 0.7662971207238143}
[S16] START round=6 head_norm_before_train=0.879094 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.189470 metrics={'f1_val': 0.332952252513944, 'auprc': 0.6819279347589844, 'loss_val': 1.0227315586103136, 'psi': 0.4725425254119602}-{'f1_val': 0.2881789453700524, 'auprc': 0.6932476888051076, 'loss_val': 1.1669901003038718, 'psi': 0.45020644274407445}
[S17] START round=6 head_norm_before_train=1.216692 cos_to_last_merge=0.9615 (last merge round=2)
[S17] round=6 local utility u=0.000000 metrics={'f1_val': 0.35732468092289654, 'auprc': 0.7050796329918986, 'loss_val': 0.874255828480931, 'psi': 0.4964266617504973}-{'f1_val': 0.3539689324515469, 'auprc': 0.7356752339406436, 'loss_val': 0.8689476123661165, 'psi': 0.5066514530471856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S6] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S11
[S14] cosine check vs S11: cos=0.6070
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=-0.0888
[S5] DROPPED delta from S2 (cos=-0.0888 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=0.9659
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=-0.0856
[S6] DROPPED delta from S16 (cos=-0.0856 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=-0.0904
[S14] DROPPED delta from S7 (cos=-0.0904 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.1018
[S5] DROPPED delta from S10 (cos=-0.1018 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.1328
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.8270
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.8399
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=-0.1348
[S5] DROPPED delta from S14 (cos=-0.1348 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9247
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.6656 head_norm=1.208116
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.992510e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.4901 head_norm=1.285091 delta_norm=0.399251
[S4] aggregate: ROLLBACK (f1_val pre=0.666 post=0.490 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.893998
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.076421e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.823259 delta_norm=0.407642
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1404 head_norm=0.942668
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.407730e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.028570 delta_norm=0.340773
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.1421 head_norm=0.961459
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.900280e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.1421 head_norm=1.079474 delta_norm=0.190028
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.1423 head_norm=1.294280
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.845618e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.1423 head_norm=1.010648 delta_norm=0.884562
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.3330 head_norm=0.911902
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.846220e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.3760 head_norm=1.082753 delta_norm=0.284622
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.194099 cos_to_last_merge=0.9256 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.926
[S2] round=7 local utility u=0.014690 metrics={'f1_val': 0.6990500780732465, 'auprc': 0.7690021812020529, 'loss_val': 0.5114965839767155, 'psi': 0.727030919324769}-{'f1_val': 0.7133311903976047, 'auprc': 0.7794434286034221, 'loss_val': 0.6578861166108092, 'psi': 0.7397760856799317}
[S3] START round=7 head_norm_before_train=1.390164 (no previous merge yet)
[S3] round=7 local utility u=0.894341 metrics={'f1_val': 0.6327286279954927, 'auprc': 0.8800339084513971, 'loss_val': 0.7938032544924085, 'psi': 0.7316507401778545}-{'f1_val': 0.39645225981545407, 'auprc': 0.8027484584459735, 'loss_val': 0.9329701715383795, 'psi': 0.5589707392676619}
[S4] START round=7 head_norm_before_train=1.285091 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.48857566206192304, 'auprc': 0.8459472031686192, 'loss_val': 0.5374314038047249, 'psi': 0.6315242785046016}-{'f1_val': 0.665618850480455, 'auprc': 0.8062968114846906, 'loss_val': 0.546046785734031, 'psi': 0.7218900348821493}
[S5] START round=7 head_norm_before_train=1.010648 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.873734 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.7774246463785546, 'loss_val': 1.0758318248404908, 'psi': 0.5611371255939672}-{'f1_val': 0.14226190476190476, 'auprc': 0.7679879260428537, 'loss_val': 1.1468883037722488, 'psi': 0.39255231327428436}
[S6] START round=7 head_norm_before_train=1.470434 (no previous merge yet)
[S6] round=7 local utility u=0.626776 metrics={'f1_val': 0.9339676289434191, 'auprc': 0.9128185545108953, 'loss_val': 0.3592734290238428, 'psi': 0.9255079991704096}-{'f1_val': 0.6970488185810503, 'auprc': 0.9648203685766981, 'loss_val': 0.3473184632725378, 'psi': 0.8041574385793094}
[S7] START round=7 head_norm_before_train=1.079474 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=0.031657 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7949751726241725, 'loss_val': 1.2740170796283392, 'psi': 0.403224162687124}-{'f1_val': 0.14205682272909165, 'auprc': 0.7774385759185648, 'loss_val': 1.2847212663975427, 'psi': 0.3962095240048809}
[S8] START round=7 head_norm_before_train=1.215873 cos_to_last_merge=0.9113 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.911
[S8] round=7 local utility u=0.405220 metrics={'f1_val': 0.9949140263520794, 'auprc': 0.9980117932603665, 'loss_val': 0.20808096017845717, 'psi': 0.9961531331153942}-{'f1_val': 0.8785774711081575, 'auprc': 0.9968607411844577, 'loss_val': 0.31704788578177756, 'psi': 0.9258907791386776}
[S9] START round=7 head_norm_before_train=1.060759 cos_to_last_merge=0.9984 (last merge round=5)
[S9] round=7 local utility u=1.000000 metrics={'f1_val': 0.37930173205863965, 'auprc': 0.9347746842761582, 'loss_val': 0.936936341710358, 'psi': 0.601490912945647}-{'f1_val': 0.141397957139996, 'auprc': 0.7271751760516596, 'loss_val': 1.110789664808809, 'psi': 0.3757088447046615}
[S10] START round=7 head_norm_before_train=1.571691 (no previous merge yet)
[S10] round=7 local utility u=0.075540 metrics={'f1_val': 0.6977966014023255, 'auprc': 0.9983121981025527, 'loss_val': 0.2577094723998357, 'psi': 0.8180028400824164}-{'f1_val': 0.6993300513248248, 'auprc': 0.9982032484670206, 'loss_val': 0.4176627668795033, 'psi': 0.8188793301817031}
[S11] START round=7 head_norm_before_train=1.028570 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.131633 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.581887902665718, 'loss_val': 1.1458166086264456, 'psi': 0.31700337109015353}-{'f1_val': 0.14041368337311058, 'auprc': 0.5158580773687647, 'loss_val': 1.2109930069146282, 'psi': 0.29059144097137224}
[S13] START round=7 head_norm_before_train=1.031387 cos_to_last_merge=0.9282 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.928
[S13] round=7 local utility u=0.996230 metrics={'f1_val': 0.6623209384176629, 'auprc': 0.6579722723108165, 'loss_val': 0.5904226699176831, 'psi': 0.6605814719749243}-{'f1_val': 0.3614655016553355, 'auprc': 0.6523172292726445, 'loss_val': 0.7607842150400848, 'psi': 0.4778061927022591}
[S14] START round=7 head_norm_before_train=0.823259 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.955963 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9097032578049462, 'loss_val': 1.0592360693717415, 'psi': 0.6018374651507358}-{'f1_val': 0.14035785288270378, 'auprc': 0.8068375968685662, 'loss_val': 1.1251509629334981, 'psi': 0.40694975047704873}
[S15] START round=7 head_norm_before_train=1.554530 (no previous merge yet)
[S15] round=7 local utility u=0.060535 metrics={'f1_val': 0.7005744757268405, 'auprc': 0.8008398342042129, 'loss_val': 0.3866057741284391, 'psi': 0.7406806191177895}-{'f1_val': 0.6962013253746483, 'auprc': 0.7994788268876166, 'loss_val': 0.4773540662263331, 'psi': 0.7375123259798356}
[S16] START round=7 head_norm_before_train=1.082753 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.200594 metrics={'f1_val': 0.37758226048312377, 'auprc': 0.6919552390263553, 'loss_val': 0.9194049230127953, 'psi': 0.5033314519004164}-{'f1_val': 0.332952252513944, 'auprc': 0.6819279347589844, 'loss_val': 1.0227315586103136, 'psi': 0.4725425254119602}
[S17] START round=7 head_norm_before_train=1.255254 cos_to_last_merge=0.9505 (last merge round=2)
[S17] round=7 local utility u=0.040104 metrics={'f1_val': 0.37364199980445945, 'auprc': 0.7171541327287816, 'loss_val': 0.9281744830276392, 'psi': 0.5110468529741883}-{'f1_val': 0.35732468092289654, 'auprc': 0.7050796329918986, 'loss_val': 0.874255828480931, 'psi': 0.4964266617504973}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S8] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.6634
[S14] RECEIVED delta(kind=head bytes=1794) from S11
[S14] cosine check vs S11: cos=0.7895
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=-0.1509
[S5] DROPPED delta from S14 (cos=-0.1509 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S2
[S5] cosine check vs S2: cos=-0.0959
[S5] DROPPED delta from S2 (cos=-0.0959 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.0992
[S5] DROPPED delta from S10 (cos=-0.0992 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=-0.0851
[S14] DROPPED delta from S7 (cos=-0.0851 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.7592
[S4] RECEIVED delta(kind=head bytes=1799) from S6
[S4] cosine check vs S6: cos=0.9283
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.0996
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0997
[S6] DROPPED delta from S16 (cos=-0.0997 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S3
[S5] cosine check vs S3: cos=0.7643
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=-0.0546
[S10] DROPPED delta from S13 (cos=-0.0546 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9804
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1791 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1791) from S17
[S9] cosine check vs S17: cos=0.9641
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.4886 head_norm=1.348284
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.846141e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6181 head_norm=1.408698 delta_norm=0.284614
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.1421 head_norm=1.087597
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.562957e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.1421 head_norm=1.184799 delta_norm=0.156296
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.4169 head_norm=1.030138
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.193371e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.4169 head_norm=1.062744 delta_norm=0.119337
[S5] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.3966 head_norm=0.856877
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.684410e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.3965 head_norm=0.732505 delta_norm=0.368441
[S14] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.3776 head_norm=1.106084
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.723199e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.3756 head_norm=1.001839 delta_norm=0.372320
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.3793 head_norm=1.088394
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.857110e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.3938 head_norm=1.175021 delta_norm=0.185711
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.278702 cos_to_last_merge=0.9054 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.905
[S2] round=8 local utility u=0.012542 metrics={'f1_val': 0.6995050397292019, 'auprc': 0.738114959127989, 'loss_val': 0.3964802076579121, 'psi': 0.7149490074887167}-{'f1_val': 0.6990500780732465, 'auprc': 0.7690021812020529, 'loss_val': 0.5114965839767155, 'psi': 0.727030919324769}
[S3] START round=8 head_norm_before_train=1.432548 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.5029935059708068, 'auprc': 0.8777192695816782, 'loss_val': 0.7595937583537822, 'psi': 0.6528838114151554}-{'f1_val': 0.6327286279954927, 'auprc': 0.8800339084513971, 'loss_val': 0.7938032544924085, 'psi': 0.7316507401778545}
[S4] START round=8 head_norm_before_train=1.408698 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.378787 metrics={'f1_val': 0.6131915944602128, 'auprc': 0.8521869699686203, 'loss_val': 0.5462716830564074, 'psi': 0.7087897446635758}-{'f1_val': 0.48857566206192304, 'auprc': 0.8459472031686192, 'loss_val': 0.5374314038047249, 'psi': 0.6315242785046016}
[S5] START round=8 head_norm_before_train=1.062744 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.049926 metrics={'f1_val': 0.41782980503278466, 'auprc': 0.7788834124830819, 'loss_val': 0.9856620775047218, 'psi': 0.5622512480129036}-{'f1_val': 0.41694544507090897, 'auprc': 0.7774246463785546, 'loss_val': 1.0758318248404908, 'psi': 0.5611371255939672}
[S6] START round=8 head_norm_before_train=1.520856 (no previous merge yet)
[S6] round=8 local utility u=0.193941 metrics={'f1_val': 0.9585750078879265, 'auprc': 0.9603665897530097, 'loss_val': 0.2616800368157431, 'psi': 0.9592916406339598}-{'f1_val': 0.9339676289434191, 'auprc': 0.9128185545108953, 'loss_val': 0.3592734290238428, 'psi': 0.9255079991704096}
[S7] START round=8 head_norm_before_train=1.184799 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.005694 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7908846894063691, 'loss_val': 1.250357271415019, 'psi': 0.4015879694000027}-{'f1_val': 0.14205682272909165, 'auprc': 0.7949751726241725, 'loss_val': 1.2740170796283392, 'psi': 0.403224162687124}
[S8] START round=8 head_norm_before_train=1.293633 cos_to_last_merge=0.8869 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.887
[S8] round=8 local utility u=0.031214 metrics={'f1_val': 0.9956663736194682, 'auprc': 0.9979490967565243, 'loss_val': 0.1499786329389658, 'psi': 0.9965794628742907}-{'f1_val': 0.9949140263520794, 'auprc': 0.9980117932603665, 'loss_val': 0.20808096017845717, 'psi': 0.9961531331153942}
[S9] START round=8 head_norm_before_train=1.175021 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=1.000000 metrics={'f1_val': 0.7012654965268851, 'auprc': 0.9758247991974297, 'loss_val': 0.7637150270035298, 'psi': 0.811089217595103}-{'f1_val': 0.37930173205863965, 'auprc': 0.9347746842761582, 'loss_val': 0.936936341710358, 'psi': 0.601490912945647}
[S10] START round=8 head_norm_before_train=1.633613 (no previous merge yet)
[S10] round=8 local utility u=0.916596 metrics={'f1_val': 0.9911981854914362, 'auprc': 0.997404010116826, 'loss_val': 0.18220340781312055, 'psi': 0.9936805153415922}-{'f1_val': 0.6977966014023255, 'auprc': 0.9983121981025527, 'loss_val': 0.2577094723998357, 'psi': 0.8180028400824164}
[S11] START round=8 head_norm_before_train=1.047626 cos_to_last_merge=0.9967 (last merge round=6)
[S11] round=8 local utility u=0.935323 metrics={'f1_val': 0.4223876636418746, 'auprc': 0.6007801831878732, 'loss_val': 1.0236903513768598, 'psi': 0.493744671460274}-{'f1_val': 0.14041368337311058, 'auprc': 0.581887902665718, 'loss_val': 1.1458166086264456, 'psi': 0.31700337109015353}
[S13] START round=8 head_norm_before_train=1.102819 cos_to_last_merge=0.9083 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.908
[S13] round=8 local utility u=0.151626 metrics={'f1_val': 0.6555497175723749, 'auprc': 0.7466678526235989, 'loss_val': 0.5126303548266888, 'psi': 0.6919969715928644}-{'f1_val': 0.6623209384176629, 'auprc': 0.6579722723108165, 'loss_val': 0.5904226699176831, 'psi': 0.6605814719749243}
[S14] START round=8 head_norm_before_train=0.732505 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.077935 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9401833174499585, 'loss_val': 0.9946071628624609, 'psi': 0.6140096483661784}-{'f1_val': 0.39659360338126215, 'auprc': 0.9097032578049462, 'loss_val': 1.0592360693717415, 'psi': 0.6018374651507358}
[S15] START round=8 head_norm_before_train=1.613235 (no previous merge yet)
[S15] round=8 local utility u=0.520103 metrics={'f1_val': 0.7543346300220077, 'auprc': 0.9911004165765127, 'loss_val': 0.23974258526067785, 'psi': 0.8490409446438097}-{'f1_val': 0.7005744757268405, 'auprc': 0.8008398342042129, 'loss_val': 0.3866057741284391, 'psi': 0.7406806191177895}
[S16] START round=8 head_norm_before_train=1.001839 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.112186 metrics={'f1_val': 0.4170373268032099, 'auprc': 0.6800142647036725, 'loss_val': 0.8959397061615941, 'psi': 0.522228101963395}-{'f1_val': 0.37758226048312377, 'auprc': 0.6919552390263553, 'loss_val': 0.9194049230127953, 'psi': 0.5033314519004164}
[S17] START round=8 head_norm_before_train=1.282859 cos_to_last_merge=0.9421 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.942
[S17] round=8 local utility u=0.050484 metrics={'f1_val': 0.37312441812009156, 'auprc': 0.7763424964286995, 'loss_val': 1.0016655153978635, 'psi': 0.5344116494435347}-{'f1_val': 0.37364199980445945, 'auprc': 0.7171541327287816, 'loss_val': 0.9281744830276392, 'psi': 0.5110468529741883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] → sending delta(kind=head bytes=1807) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S10] sending update (kind=head size=1803 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1807 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1807) from S6
[S4] cosine check vs S6: cos=0.9630
[S5] RECEIVED delta(kind=head bytes=1798) from S2
[S5] cosine check vs S2: cos=-0.0938
[S5] DROPPED delta from S2 (cos=-0.0938 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.3778
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=-0.0405
[S14] DROPPED delta from S7 (cos=-0.0405 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=0.9892
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=-0.0757
[S6] DROPPED delta from S16 (cos=-0.0757 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=-0.1261
[S5] DROPPED delta from S14 (cos=-0.1261 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.8285
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=-0.0530
[S10] DROPPED delta from S13 (cos=-0.0530 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S11
[S14] cosine check vs S11: cos=0.8241
[S16] RECEIVED delta(kind=head bytes=1802) from S5
[S16] cosine check vs S5: cos=0.9372
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.7176
[S5] RECEIVED delta(kind=head bytes=1803) from S10
[S5] cosine check vs S10: cos=-0.1086
[S5] DROPPED delta from S10 (cos=-0.1086 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.9821
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.7013 head_norm=1.209821
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.290791e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.7013 head_norm=1.253927 delta_norm=0.129079
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.4224 head_norm=1.081622
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.115536e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.1427 head_norm=1.213258 delta_norm=0.411554
[S11] aggregate: ROLLBACK (f1_val pre=0.422 post=0.143 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.1421 head_norm=1.192814
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.233859e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.1421 head_norm=1.269990 delta_norm=0.123386
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6132 head_norm=1.453560
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.101066e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6138 head_norm=1.488859 delta_norm=0.210107
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3966 head_norm=0.767370
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.433989e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3962 head_norm=0.759356 delta_norm=0.243399
[S14] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4170 head_norm=1.025265
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.899886e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.3756 head_norm=1.040709 delta_norm=0.189989
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.376 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.4178 head_norm=1.089576
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.813035e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.4178 head_norm=1.279876 delta_norm=0.581304
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.344789 cos_to_last_merge=0.8860 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.886
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.706011796639506, 'auprc': 0.7706927156117058, 'loss_val': 0.5643094119637643, 'psi': 0.731884164228386}-{'f1_val': 0.6995050397292019, 'auprc': 0.738114959127989, 'loss_val': 0.3964802076579121, 'psi': 0.7149490074887167}
[S3] START round=9 head_norm_before_train=1.480592 (no previous merge yet)
[S3] round=9 local utility u=0.381820 metrics={'f1_val': 0.5578328826915232, 'auprc': 0.9798254833231044, 'loss_val': 0.6313084410327268, 'psi': 0.7266299229441557}-{'f1_val': 0.5029935059708068, 'auprc': 0.8777192695816782, 'loss_val': 0.7595937583537822, 'psi': 0.6528838114151554}
[S4] START round=9 head_norm_before_train=1.488859 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.611617421061553, 'auprc': 0.8496070083529514, 'loss_val': 0.5388656832209977, 'psi': 0.7068132559781124}-{'f1_val': 0.6131915944602128, 'auprc': 0.8521869699686203, 'loss_val': 0.5462716830564074, 'psi': 0.7087897446635758}
[S5] START round=9 head_norm_before_train=1.279876 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.103461 metrics={'f1_val': 0.41823357465624633, 'auprc': 0.8019758948895416, 'loss_val': 0.8504393694578425, 'psi': 0.5717305027495645}-{'f1_val': 0.41782980503278466, 'auprc': 0.7788834124830819, 'loss_val': 0.9856620775047218, 'psi': 0.5622512480129036}
[S6] START round=9 head_norm_before_train=1.552049 (no previous merge yet)
[S6] round=9 local utility u=0.000000 metrics={'f1_val': 0.8114117129459646, 'auprc': 0.7938589669253657, 'loss_val': 0.44775755241563353, 'psi': 0.8043906145377251}-{'f1_val': 0.9585750078879265, 'auprc': 0.9603665897530097, 'loss_val': 0.2616800368157431, 'psi': 0.9592916406339598}
[S7] START round=9 head_norm_before_train=1.269990 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.690474868709818, 'loss_val': 1.1927951596568427, 'psi': 0.3614240411213822}-{'f1_val': 0.14205682272909165, 'auprc': 0.7908846894063691, 'loss_val': 1.250357271415019, 'psi': 0.4015879694000027}
[S8] START round=9 head_norm_before_train=1.354028 cos_to_last_merge=0.8697 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=9 local utility u=0.016473 metrics={'f1_val': 0.994797932540999, 'auprc': 0.9987404200750245, 'loss_val': 0.11419616934496374, 'psi': 0.9963749275546092}-{'f1_val': 0.9956663736194682, 'auprc': 0.9979490967565243, 'loss_val': 0.1499786329389658, 'psi': 0.9965794628742907}
[S9] START round=9 head_norm_before_train=1.253927 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.131856 metrics={'f1_val': 0.7017640638110727, 'auprc': 0.9996740840181162, 'loss_val': 0.5745419442663721, 'psi': 0.82092807189389}-{'f1_val': 0.7012654965268851, 'auprc': 0.9758247991974297, 'loss_val': 0.7637150270035298, 'psi': 0.811089217595103}
[S10] START round=9 head_norm_before_train=1.687821 (no previous merge yet)
[S10] round=9 local utility u=0.032764 metrics={'f1_val': 0.9941991306737105, 'auprc': 0.9979195189974422, 'loss_val': 0.13622676326817135, 'psi': 0.9956872860032031}-{'f1_val': 0.9911981854914362, 'auprc': 0.997404010116826, 'loss_val': 0.18220340781312055, 'psi': 0.9936805153415922}
[S11] START round=9 head_norm_before_train=1.213258 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.480718 metrics={'f1_val': 0.396639232794319, 'auprc': 0.9330948947495122, 'loss_val': 0.9047078228129402, 'psi': 0.6112214975763963}-{'f1_val': 0.4223876636418746, 'auprc': 0.6007801831878732, 'loss_val': 1.0236903513768598, 'psi': 0.493744671460274}
[S13] START round=9 head_norm_before_train=1.158583 cos_to_last_merge=0.8967 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.897
[S13] round=9 local utility u=0.195703 metrics={'f1_val': 0.6631143622399815, 'auprc': 0.8481731925714756, 'loss_val': 0.4711287141709022, 'psi': 0.7371378943725793}-{'f1_val': 0.6555497175723749, 'auprc': 0.7466678526235989, 'loss_val': 0.5126303548266888, 'psi': 0.6919969715928644}
[S14] START round=9 head_norm_before_train=0.759356 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.092223 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.98552572823013, 'loss_val': 0.9463860566080473, 'psi': 0.6321664533208092}-{'f1_val': 0.39656053564365834, 'auprc': 0.9401833174499585, 'loss_val': 0.9946071628624609, 'psi': 0.6140096483661784}
[S15] START round=9 head_norm_before_train=1.662774 (no previous merge yet)
[S15] round=9 local utility u=0.000000 metrics={'f1_val': 0.7392629159662953, 'auprc': 0.9418981237733353, 'loss_val': 0.2514006070137915, 'psi': 0.8203169990891113}-{'f1_val': 0.7543346300220077, 'auprc': 0.9911004165765127, 'loss_val': 0.23974258526067785, 'psi': 0.8490409446438097}
[S16] START round=9 head_norm_before_train=1.040709 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.000000 metrics={'f1_val': 0.4169627677417108, 'auprc': 0.657001226038507, 'loss_val': 0.8784403833482289, 'psi': 0.5129781510604293}-{'f1_val': 0.4170373268032099, 'auprc': 0.6800142647036725, 'loss_val': 0.8959397061615941, 'psi': 0.522228101963395}
[S17] START round=9 head_norm_before_train=1.309321 cos_to_last_merge=0.9331 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=9 local utility u=0.075332 metrics={'f1_val': 0.36488674005371474, 'auprc': 0.8111693987154591, 'loss_val': 0.9060553387968644, 'psi': 0.5433998035184125}-{'f1_val': 0.37312441812009156, 'auprc': 0.7763424964286995, 'loss_val': 1.0016655153978635, 'psi': 0.5344116494435347}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[S14] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.6939
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=0.9935
[S5] RECEIVED delta(kind=head bytes=1796) from S14
[S5] cosine check vs S14: cos=-0.0983
[S5] DROPPED delta from S14 (cos=-0.0983 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.3399
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9261
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.5496
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.1104
[S5] DROPPED delta from S10 (cos=-0.1104 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0523
[S10] DROPPED delta from S13 (cos=-0.0523 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.9870
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.1421 head_norm=1.280380
[S7] _apply_head_vector_avg (torch): Δ‖w‖=9.747034e-02
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.1421 head_norm=1.339132 delta_norm=0.097470
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.7018 head_norm=1.296309
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.081415e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7018 head_norm=1.311880 delta_norm=0.108141
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3966 head_norm=0.791236
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.210061e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3964 head_norm=0.819942 delta_norm=0.221006
[S14] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.4182 head_norm=1.302271
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.178808e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.4177 head_norm=1.159642 delta_norm=0.817881
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4170 head_norm=1.067665
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.552221e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.3755 head_norm=1.163087 delta_norm=0.255222
[S16] aggregate: ROLLBACK (f1_val pre=0.417 post=0.376 tol_abs=0.005 tol_rel=0.0)
[S2] START round=10 head_norm_before_train=1.409994 cos_to_last_merge=0.8676 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.868
[S2] round=10 local utility u=0.060091 metrics={'f1_val': 0.7014883859537877, 'auprc': 0.768691445489598, 'loss_val': 0.41098335282346293, 'psi': 0.7283696097681118}-{'f1_val': 0.706011796639506, 'auprc': 0.7706927156117058, 'loss_val': 0.5643094119637643, 'psi': 0.731884164228386}
[S3] START round=10 head_norm_before_train=1.526920 (no previous merge yet)
[S3] round=10 local utility u=0.274254 metrics={'f1_val': 0.6222458430384575, 'auprc': 0.9924999384180551, 'loss_val': 0.5073009523016228, 'psi': 0.7703474811902966}-{'f1_val': 0.5578328826915232, 'auprc': 0.9798254833231044, 'loss_val': 0.6313084410327268, 'psi': 0.7266299229441557}
[S4] START round=10 head_norm_before_train=1.530795 cos_to_last_merge=0.9964 (last merge round=8)
[S4] round=10 local utility u=0.021596 metrics={'f1_val': 0.6121511506411688, 'auprc': 0.8514736501613871, 'loss_val': 0.5044752148235961, 'psi': 0.7078801504492561}-{'f1_val': 0.611617421061553, 'auprc': 0.8496070083529514, 'loss_val': 0.5388656832209977, 'psi': 0.7068132559781124}
[S5] START round=10 head_norm_before_train=1.159642 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.267238 metrics={'f1_val': 0.4181926743009027, 'auprc': 0.98640711999571, 'loss_val': 0.8690110557414814, 'psi': 0.6454784525788255}-{'f1_val': 0.41823357465624633, 'auprc': 0.8019758948895416, 'loss_val': 0.8504393694578425, 'psi': 0.5717305027495645}
[S6] START round=10 head_norm_before_train=1.577236 (no previous merge yet)
[S6] round=10 local utility u=0.426242 metrics={'f1_val': 0.8537661239705769, 'auprc': 0.9513239002120465, 'loss_val': 0.3217943660448585, 'psi': 0.8927892344671647}-{'f1_val': 0.8114117129459646, 'auprc': 0.7938589669253657, 'loss_val': 0.44775755241563353, 'psi': 0.8043906145377251}
[S7] START round=10 head_norm_before_train=1.339132 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.710964 metrics={'f1_val': 0.416467909967687, 'auprc': 0.5882746320641974, 'loss_val': 1.1107328371616536, 'psi': 0.4851905988062911}-{'f1_val': 0.14205682272909165, 'auprc': 0.690474868709818, 'loss_val': 1.1927951596568427, 'psi': 0.3614240411213822}
[S8] START round=10 head_norm_before_train=1.402203 cos_to_last_merge=0.8578 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.858
[S8] round=10 local utility u=0.009755 metrics={'f1_val': 0.9940640971819732, 'auprc': 0.9986683289937734, 'loss_val': 0.09006629939221909, 'psi': 0.9959057899066932}-{'f1_val': 0.994797932540999, 'auprc': 0.9987404200750245, 'loss_val': 0.11419616934496374, 'psi': 0.9963749275546092}
[S9] START round=10 head_norm_before_train=1.311880 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.069456 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998904912975729, 'loss_val': 0.43092505831358274, 'psi': 0.8203807658217972}-{'f1_val': 0.7017640638110727, 'auprc': 0.9996740840181162, 'loss_val': 0.5745419442663721, 'psi': 0.82092807189389}
[S10] START round=10 head_norm_before_train=1.726949 (no previous merge yet)
[S10] round=10 local utility u=0.001758 metrics={'f1_val': 0.9943473480461396, 'auprc': 0.9948208362811684, 'loss_val': 0.12430309340265377, 'psi': 0.9945367433401511}-{'f1_val': 0.9941991306737105, 'auprc': 0.9979195189974422, 'loss_val': 0.13622676326817135, 'psi': 0.9956872860032031}
[S11] START round=10 head_norm_before_train=1.244459 cos_to_last_merge=0.9978 (last merge round=8)
[S11] round=10 local utility u=0.518793 metrics={'f1_val': 0.5477613778584305, 'auprc': 0.9379915743431775, 'loss_val': 0.7885454335635443, 'psi': 0.7038534564523293}-{'f1_val': 0.396639232794319, 'auprc': 0.9330948947495122, 'loss_val': 0.9047078228129402, 'psi': 0.6112214975763963}
[S13] START round=10 head_norm_before_train=1.204181 cos_to_last_merge=0.8869 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.887
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.6261796490413588, 'auprc': 0.9112107036101883, 'loss_val': 0.5385445321377474, 'psi': 0.7401920708688906}-{'f1_val': 0.6631143622399815, 'auprc': 0.8481731925714756, 'loss_val': 0.4711287141709022, 'psi': 0.7371378943725793}
[S14] START round=10 head_norm_before_train=0.819942 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.036549 metrics={'f1_val': 0.3963900194967479, 'auprc': 0.9934576968202702, 'loss_val': 0.8958625988886331, 'psi': 0.6352170904261568}-{'f1_val': 0.39659360338126215, 'auprc': 0.98552572823013, 'loss_val': 0.9463860566080473, 'psi': 0.6321664533208092}
[S15] START round=10 head_norm_before_train=1.716575 (no previous merge yet)
[S15] round=10 local utility u=0.171500 metrics={'f1_val': 0.7909280870998192, 'auprc': 0.9454876158661649, 'loss_val': 0.22915998427432926, 'psi': 0.8527518986063576}-{'f1_val': 0.7392629159662953, 'auprc': 0.9418981237733353, 'loss_val': 0.2514006070137915, 'psi': 0.8203169990891113}
[S16] START round=10 head_norm_before_train=1.163087 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3516493844367766, 'auprc': 0.5682197677417923, 'loss_val': 0.9278666955728712, 'psi': 0.43827753775878286}-{'f1_val': 0.4169627677417108, 'auprc': 0.657001226038507, 'loss_val': 0.8784403833482289, 'psi': 0.5129781510604293}
[S17] START round=10 head_norm_before_train=1.336050 cos_to_last_merge=0.9256 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.926
[S17] round=10 local utility u=0.136895 metrics={'f1_val': 0.39349638211538496, 'auprc': 0.8234282139386864, 'loss_val': 0.8406990571712678, 'psi': 0.5654691148447055}-{'f1_val': 0.36488674005371474, 'auprc': 0.8111693987154591, 'loss_val': 0.9060553387968644, 'psi': 0.5433998035184125}
[S11] not sending this round → trigger blocked (psi=0.704)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[S14] not sending this round → trigger blocked (psi=0.635)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → trigger blocked (psi=0.996)
[S3] not sending this round → trigger blocked (psi=0.770)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[S10] not sending this round → trigger blocked (psi=0.995)
[S9] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → trigger blocked (psi=0.645)
[S4] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.0125
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9360
[S5] RECEIVED delta(kind=head bytes=1797) from S2
[S5] cosine check vs S2: cos=-0.0859
[S5] DROPPED delta from S2 (cos=-0.0859 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.5695
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.9609
[S17] not sending this round → trigger blocked (psi=0.565)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.5478 head_norm=1.284379
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.931934e-01
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.5670 head_norm=1.407182 delta_norm=0.293193
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.439 → S14@127.0.0.1:58314
[S9] ⇄ pheromone p=0.375 → S14@127.0.0.1:58314
[S3] ⇄ pheromone p=0.407 → S5@127.0.0.1:58305
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3964 head_norm=0.851899
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.957184e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3965 head_norm=0.804720 delta_norm=0.795718
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.263 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.341 → S5@127.0.0.1:58305
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.4182 head_norm=1.184828
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.345622e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.4182 head_norm=1.318020 delta_norm=0.734562
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.283 → S16@127.0.0.1:58316
[S13] ⇄ pheromone p=0.319 → S10@127.0.0.1:58311
[S8] ⇄ pheromone p=0.304 → S7@127.0.0.1:58308
[S2] ⇄ pheromone p=0.250 → S5@127.0.0.1:58305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.6122 head_norm=1.575633
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.224866e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.6119 head_norm=1.573070 delta_norm=0.222487
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.229 → S11@127.0.0.1:58312
[S7] ⇄ pheromone p=0.297 → S14@127.0.0.1:58314
[S6] ⇄ pheromone p=0.412 → S4@127.0.0.1:58304
[S15] ⇄ pheromone p=0.322 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.188 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.206 → S9@127.0.0.1:58310
[S2] START round=11 head_norm_before_train=1.466883 cos_to_last_merge=0.8589 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.859
[S2] round=11 local utility u=0.000000 metrics={'f1_val': 0.6993023769904828, 'auprc': 0.7228758588395351, 'loss_val': 0.36545388219207975, 'psi': 0.7087317697301037}-{'f1_val': 0.7014883859537877, 'auprc': 0.768691445489598, 'loss_val': 0.41098335282346293, 'psi': 0.7283696097681118}
[S3] START round=11 head_norm_before_train=1.569432 (no previous merge yet)
[S3] round=11 local utility u=0.264705 metrics={'f1_val': 0.6927498788157274, 'auprc': 0.9916956304072492, 'loss_val': 0.3985014246145379, 'psi': 0.812328179452336}-{'f1_val': 0.6222458430384575, 'auprc': 0.9924999384180551, 'loss_val': 0.5073009523016228, 'psi': 0.7703474811902966}
[S4] START round=11 head_norm_before_train=1.573070 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.153627 metrics={'f1_val': 0.6133637439251836, 'auprc': 0.9502166153115688, 'loss_val': 0.5007260985229598, 'psi': 0.7481048924797375}-{'f1_val': 0.6121511506411688, 'auprc': 0.8514736501613871, 'loss_val': 0.5044752148235961, 'psi': 0.7078801504492561}
[S5] START round=11 head_norm_before_train=1.318020 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.000000 metrics={'f1_val': 0.43765725519202886, 'auprc': 0.8560059816819622, 'loss_val': 0.7397089996023107, 'psi': 0.6049967457880021}-{'f1_val': 0.4181926743009027, 'auprc': 0.98640711999571, 'loss_val': 0.8690110557414814, 'psi': 0.6454784525788255}
[S6] START round=11 head_norm_before_train=1.601711 (no previous merge yet)
[S6] round=11 local utility u=0.355617 metrics={'f1_val': 0.9395089558415718, 'auprc': 0.9725924609972595, 'loss_val': 0.1888230904142773, 'psi': 0.952742357903847}-{'f1_val': 0.8537661239705769, 'auprc': 0.9513239002120465, 'loss_val': 0.3217943660448585, 'psi': 0.8927892344671647}
[S7] START round=11 head_norm_before_train=1.354899 cos_to_last_merge=0.9993 (last merge round=9)
[S7] round=11 local utility u=0.065184 metrics={'f1_val': 0.4171579869317734, 'auprc': 0.5871185554768844, 'loss_val': 0.9810370326580359, 'psi': 0.4851422143498178}-{'f1_val': 0.416467909967687, 'auprc': 0.5882746320641974, 'loss_val': 1.1107328371616536, 'psi': 0.4851905988062911}
[S8] START round=11 head_norm_before_train=1.450668 cos_to_last_merge=0.8467 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.847
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9958203718844063, 'loss_val': 0.08388427762720285, 'psi': 0.9945548359357425}-{'f1_val': 0.9940640971819732, 'auprc': 0.9986683289937734, 'loss_val': 0.09006629939221909, 'psi': 0.9959057899066932}
[S9] START round=11 head_norm_before_train=1.359278 cos_to_last_merge=0.9981 (last merge round=9)
[S9] round=11 local utility u=0.041539 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.999025438053103, 'loss_val': 0.34926465940711426, 'psi': 0.8205345737424043}-{'f1_val': 0.7013646677191758, 'auprc': 0.998904912975729, 'loss_val': 0.43092505831358274, 'psi': 0.8203807658217972}
[S10] START round=11 head_norm_before_train=1.756797 (no previous merge yet)
[S10] round=11 local utility u=0.020135 metrics={'f1_val': 0.993179800984857, 'auprc': 0.9967922012941562, 'loss_val': 0.08294121571632473, 'psi': 0.9946247611085767}-{'f1_val': 0.9943473480461396, 'auprc': 0.9948208362811684, 'loss_val': 0.12430309340265377, 'psi': 0.9945367433401511}
[S11] START round=11 head_norm_before_train=1.407182 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.516932 metrics={'f1_val': 0.6926537797134557, 'auprc': 0.9440250553573238, 'loss_val': 0.6421361212216948, 'psi': 0.793202289971003}-{'f1_val': 0.5477613778584305, 'auprc': 0.9379915743431775, 'loss_val': 0.7885454335635443, 'psi': 0.7038534564523293}
[S13] START round=11 head_norm_before_train=1.237231 cos_to_last_merge=0.8764 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.876
[S13] round=11 local utility u=0.035198 metrics={'f1_val': 0.628269487959732, 'auprc': 0.9241682990474475, 'loss_val': 0.5195606332128654, 'psi': 0.7466290123948183}-{'f1_val': 0.6261796490413588, 'auprc': 0.9112107036101883, 'loss_val': 0.5385445321377474, 'psi': 0.7401920708688906}
[S14] START round=11 head_norm_before_train=0.804720 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.000000 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9959829832947278, 'loss_val': 0.9831747573930439, 'psi': 0.6363493553466484}-{'f1_val': 0.3963900194967479, 'auprc': 0.9934576968202702, 'loss_val': 0.8958625988886331, 'psi': 0.6352170904261568}
[S15] START round=11 head_norm_before_train=1.774739 (no previous merge yet)
[S15] round=11 local utility u=0.068571 metrics={'f1_val': 0.8098319987540687, 'auprc': 0.9636953611953917, 'loss_val': 0.260065017861659, 'psi': 0.8713773437305979}-{'f1_val': 0.7909280870998192, 'auprc': 0.9454876158661649, 'loss_val': 0.22915998427432926, 'psi': 0.8527518986063576}
[S16] START round=11 head_norm_before_train=1.186304 cos_to_last_merge=0.9975 (last merge round=9)
[S16] round=11 local utility u=0.117942 metrics={'f1_val': 0.3468549299139354, 'auprc': 0.6399656584256133, 'loss_val': 0.8784532072198697, 'psi': 0.4640992213186066}-{'f1_val': 0.3516493844367766, 'auprc': 0.5682197677417923, 'loss_val': 0.9278666955728712, 'psi': 0.43827753775878286}
[S17] START round=11 head_norm_before_train=1.364694 cos_to_last_merge=0.9200 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.3934677861632051, 'auprc': 0.8231936561237012, 'loss_val': 0.9583097285570333, 'psi': 0.5653581341474035}-{'f1_val': 0.39349638211538496, 'auprc': 0.8234282139386864, 'loss_val': 0.8406990571712678, 'psi': 0.5654691148447055}
[S4] not sending this round → trigger blocked (psi=0.748)
[S6] not sending this round → trigger blocked (psi=0.953)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.871)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:58314
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.485)
[S11] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1805) from S11
[S14] cosine check vs S11: cos=0.4153
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0890
[S6] DROPPED delta from S16 (cos=-0.0890 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.4046
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.1116
[S5] DROPPED delta from S10 (cos=-0.1116 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.3791
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0605
[S10] DROPPED delta from S13 (cos=-0.0605 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.3966 head_norm=0.825389
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.396886e-01
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.3966 head_norm=0.812959 delta_norm=0.439689
[S14] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.4377 head_norm=1.346952
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.126286e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7011 head_norm=1.238998 delta_norm=0.812629
[S5] aggregate: ACCEPT kept=['S3'] (k=1/1) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.515583 cos_to_last_merge=0.8506 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=12 local utility u=0.000000 metrics={'f1_val': 0.7120758607525529, 'auprc': 0.7807142364210176, 'loss_val': 0.7190994439218391, 'psi': 0.7395312110199388}-{'f1_val': 0.6993023769904828, 'auprc': 0.7228758588395351, 'loss_val': 0.36545388219207975, 'psi': 0.7087317697301037}
[S3] START round=12 head_norm_before_train=1.605204 (no previous merge yet)
[S3] round=12 local utility u=0.000000 metrics={'f1_val': 0.6896870885357436, 'auprc': 0.9926003503846258, 'loss_val': 0.38849648065003883, 'psi': 0.8108523932752965}-{'f1_val': 0.6927498788157274, 'auprc': 0.9916956304072492, 'loss_val': 0.3985014246145379, 'psi': 0.812328179452336}
[S4] START round=12 head_norm_before_train=1.617602 cos_to_last_merge=0.9978 (last merge round=10)
[S4] round=12 local utility u=0.005279 metrics={'f1_val': 0.6117566437440566, 'auprc': 0.9475717019579067, 'loss_val': 0.4725902433219758, 'psi': 0.7460826670295966}-{'f1_val': 0.6133637439251836, 'auprc': 0.9502166153115688, 'loss_val': 0.5007260985229598, 'psi': 0.7481048924797375}
[S5] START round=12 head_norm_before_train=1.238998 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.000000 metrics={'f1_val': 0.43765725519202886, 'auprc': 0.8572913729856573, 'loss_val': 0.7468652864650349, 'psi': 0.6055109023094802}-{'f1_val': 0.43765725519202886, 'auprc': 0.8560059816819622, 'loss_val': 0.7397089996023107, 'psi': 0.6049967457880021}
[S6] START round=12 head_norm_before_train=1.623394 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.9251059126766877, 'auprc': 0.9659520250688396, 'loss_val': 0.26398276000301746, 'psi': 0.9414443576335485}-{'f1_val': 0.9395089558415718, 'auprc': 0.9725924609972595, 'loss_val': 0.1888230904142773, 'psi': 0.952742357903847}
[S7] START round=12 head_norm_before_train=1.378134 cos_to_last_merge=0.9972 (last merge round=9)
[S7] round=12 local utility u=0.277880 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7345857907315111, 'loss_val': 0.8669438468244081, 'psi': 0.5440555725853733}-{'f1_val': 0.4171579869317734, 'auprc': 0.5871185554768844, 'loss_val': 0.9810370326580359, 'psi': 0.4851422143498178}
[S8] START round=12 head_norm_before_train=1.498160 cos_to_last_merge=0.8367 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=12 local utility u=0.000000 metrics={'f1_val': 0.9930990485370332, 'auprc': 0.9876798224881762, 'loss_val': 0.07044745942266768, 'psi': 0.9909313581174903}-{'f1_val': 0.9937111453033, 'auprc': 0.9958203718844063, 'loss_val': 0.08388427762720285, 'psi': 0.9945548359357425}
[S9] START round=12 head_norm_before_train=1.410503 cos_to_last_merge=0.9934 (last merge round=9)
[S9] round=12 local utility u=0.024931 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9986417084550868, 'loss_val': 0.29825190185542616, 'psi': 0.820381081903198}-{'f1_val': 0.7015406642019387, 'auprc': 0.999025438053103, 'loss_val': 0.34926465940711426, 'psi': 0.8205345737424043}
[S10] START round=12 head_norm_before_train=1.786652 (no previous merge yet)
[S10] round=12 local utility u=0.011352 metrics={'f1_val': 0.9949085473053089, 'auprc': 0.9949701995695127, 'loss_val': 0.06514467136928055, 'psi': 0.9949332082109903}-{'f1_val': 0.993179800984857, 'auprc': 0.9967922012941562, 'loss_val': 0.08294121571632473, 'psi': 0.9946247611085767}
[S11] START round=12 head_norm_before_train=1.440641 cos_to_last_merge=0.9986 (last merge round=10)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6028499294076939, 'auprc': 0.8783619507068485, 'loss_val': 0.6530027499163655, 'psi': 0.7130547379273557}-{'f1_val': 0.6926537797134557, 'auprc': 0.9440250553573238, 'loss_val': 0.6421361212216948, 'psi': 0.793202289971003}
[S13] START round=12 head_norm_before_train=1.265606 cos_to_last_merge=0.8680 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.868
[S13] round=12 local utility u=0.061211 metrics={'f1_val': 0.6347214770011219, 'auprc': 0.9396573848889209, 'loss_val': 0.4823183623371876, 'psi': 0.7566958401562416}-{'f1_val': 0.628269487959732, 'auprc': 0.9241682990474475, 'loss_val': 0.5195606332128654, 'psi': 0.7466290123948183}
[S14] START round=12 head_norm_before_train=0.812959 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.055093 metrics={'f1_val': 0.3960490692696715, 'auprc': 0.990096320657468, 'loss_val': 0.8520621131170282, 'psi': 0.6336679698247901}-{'f1_val': 0.39659360338126215, 'auprc': 0.9959829832947278, 'loss_val': 0.9831747573930439, 'psi': 0.6363493553466484}
[S15] START round=12 head_norm_before_train=1.823570 (no previous merge yet)
[S15] round=12 local utility u=0.000000 metrics={'f1_val': 0.7438352456229392, 'auprc': 0.9328974938556479, 'loss_val': 0.34844418718965886, 'psi': 0.8194601449160227}-{'f1_val': 0.8098319987540687, 'auprc': 0.9636953611953917, 'loss_val': 0.260065017861659, 'psi': 0.8713773437305979}
[S16] START round=12 head_norm_before_train=1.208770 cos_to_last_merge=0.9932 (last merge round=9)
[S16] round=12 local utility u=0.179292 metrics={'f1_val': 0.37757025399557126, 'auprc': 0.690487688262713, 'loss_val': 0.8557266062428789, 'psi': 0.5027372277024279}-{'f1_val': 0.3468549299139354, 'auprc': 0.6399656584256133, 'loss_val': 0.8784532072198697, 'psi': 0.4640992213186066}
[S17] START round=12 head_norm_before_train=1.404983 cos_to_last_merge=0.9128 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=12 local utility u=0.082586 metrics={'f1_val': 0.40260037202107024, 'auprc': 0.8250205942796314, 'loss_val': 0.8534147577788573, 'psi': 0.5715684609244946}-{'f1_val': 0.3934677861632051, 'auprc': 0.8231936561237012, 'loss_val': 0.9583097285570333, 'psi': 0.5653581341474035}
[S9] not sending this round → trigger blocked (psi=0.820)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.503)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[S13] not sending this round → trigger blocked (psi=0.757)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1803) from S14
[S5] cosine check vs S14: cos=0.1809
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.4456
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9667
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.9653
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=12 metric=0.4377 head_norm=1.266367
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.949754e-01
[S5] stored merged vector for next round verification (round=12)
[S5] DEBUG after merge:  round=12 metric=0.3772 head_norm=0.822711 delta_norm=0.694975
[S5] aggregate: ROLLBACK (f1_val pre=0.438 post=0.377 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6028 head_norm=1.472982
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.216967e-01
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6060 head_norm=1.552059 delta_norm=0.221697
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7015 head_norm=1.453858
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.909770e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7015 head_norm=1.436391 delta_norm=0.190977
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.3960 head_norm=0.846170
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.391162e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.3907 head_norm=0.968923 delta_norm=0.639116
[S14] aggregate: ROLLBACK (f1_val pre=0.396 post=0.391 tol_abs=0.005 tol_rel=0.0)
[S2] START round=13 head_norm_before_train=1.555802 cos_to_last_merge=0.8438 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.844
[S2] round=13 local utility u=0.089625 metrics={'f1_val': 0.7129656309257484, 'auprc': 0.7747774351930956, 'loss_val': 0.527377312265647, 'psi': 0.7376903526326872}-{'f1_val': 0.7120758607525529, 'auprc': 0.7807142364210176, 'loss_val': 0.7190994439218391, 'psi': 0.7395312110199388}
[S3] START round=13 head_norm_before_train=1.637643 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.5799263603173199, 'auprc': 0.9612432984406476, 'loss_val': 0.5041421863094727, 'psi': 0.732453135566651}-{'f1_val': 0.6896870885357436, 'auprc': 0.9926003503846258, 'loss_val': 0.38849648065003883, 'psi': 0.8108523932752965}
[S4] START round=13 head_norm_before_train=1.657225 cos_to_last_merge=0.9941 (last merge round=10)
[S4] round=13 local utility u=0.007683 metrics={'f1_val': 0.6112450304280973, 'auprc': 0.9514817376634394, 'loss_val': 0.46588386906879947, 'psi': 0.7473397133222341}-{'f1_val': 0.6117566437440566, 'auprc': 0.9475717019579067, 'loss_val': 0.4725902433219758, 'psi': 0.7460826670295966}
[S5] START round=13 head_norm_before_train=0.822711 cos_to_last_merge=1.0000 (last merge round=12)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.42592919401706847, 'auprc': 0.8548779146247937, 'loss_val': 0.9024609924055469, 'psi': 0.5975086822601585}-{'f1_val': 0.43765725519202886, 'auprc': 0.8572913729856573, 'loss_val': 0.7468652864650349, 'psi': 0.6055109023094802}
[S6] START round=13 head_norm_before_train=1.645498 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.6349878418075235, 'auprc': 0.8451770784745105, 'loss_val': 0.7272303439597245, 'psi': 0.7190635364743183}-{'f1_val': 0.9251059126766877, 'auprc': 0.9659520250688396, 'loss_val': 0.26398276000301746, 'psi': 0.9414443576335485}
[S7] START round=13 head_norm_before_train=1.406612 cos_to_last_merge=0.9938 (last merge round=9)
[S7] round=13 local utility u=0.025779 metrics={'f1_val': 0.39591130421197507, 'auprc': 0.7830869943009791, 'loss_val': 0.8341449093194945, 'psi': 0.5507815802475766}-{'f1_val': 0.41703542715461484, 'auprc': 0.7345857907315111, 'loss_val': 0.8669438468244081, 'psi': 0.5440555725853733}
[S8] START round=13 head_norm_before_train=1.543913 cos_to_last_merge=0.8287 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=13 local utility u=0.022047 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.99864520929151, 'loss_val': 0.05542198569795315, 'psi': 0.9949347905329811}-{'f1_val': 0.9930990485370332, 'auprc': 0.9876798224881762, 'loss_val': 0.07044745942266768, 'psi': 0.9909313581174903}
[S9] START round=13 head_norm_before_train=1.436391 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.007576 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9984277122824828, 'loss_val': 0.2824578806263038, 'psi': 0.8202954834341564}-{'f1_val': 0.7015406642019387, 'auprc': 0.9986417084550868, 'loss_val': 0.29825190185542616, 'psi': 0.820381081903198}
[S10] START round=13 head_norm_before_train=1.829112 (no previous merge yet)
[S10] round=13 local utility u=0.000096 metrics={'f1_val': 0.9937298155689185, 'auprc': 0.9945057174848839, 'loss_val': 0.05648780605326058, 'psi': 0.9940401763353046}-{'f1_val': 0.9949085473053089, 'auprc': 0.9949701995695127, 'loss_val': 0.06514467136928055, 'psi': 0.9949332082109903}
[S11] START round=13 head_norm_before_train=1.552059 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.434061 metrics={'f1_val': 0.6818697147294259, 'auprc': 0.9620967133350246, 'loss_val': 0.5102029910668926, 'psi': 0.7939605141716654}-{'f1_val': 0.6028499294076939, 'auprc': 0.8783619507068485, 'loss_val': 0.6530027499163655, 'psi': 0.7130547379273557}
[S13] START round=13 head_norm_before_train=1.291054 cos_to_last_merge=0.8615 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.862
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6281991071782338, 'auprc': 0.9246438644570145, 'loss_val': 0.5306066094474001, 'psi': 0.7467770100897462}-{'f1_val': 0.6347214770011219, 'auprc': 0.9396573848889209, 'loss_val': 0.4823183623371876, 'psi': 0.7566958401562416}
[S14] START round=13 head_norm_before_train=0.968923 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.000000 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.992828629201318, 'loss_val': 0.8993413658898264, 'psi': 0.6350876137092845}-{'f1_val': 0.3960490692696715, 'auprc': 0.990096320657468, 'loss_val': 0.8520621131170282, 'psi': 0.6336679698247901}
[S15] START round=13 head_norm_before_train=1.857407 (no previous merge yet)
[S15] round=13 local utility u=1.000000 metrics={'f1_val': 0.9939759221388862, 'auprc': 0.9976797262335898, 'loss_val': 0.04318568929140115, 'psi': 0.9954574437767676}-{'f1_val': 0.7438352456229392, 'auprc': 0.9328974938556479, 'loss_val': 0.34844418718965886, 'psi': 0.8194601449160227}
[S16] START round=13 head_norm_before_train=1.230930 cos_to_last_merge=0.9890 (last merge round=9)
[S16] round=13 local utility u=0.047697 metrics={'f1_val': 0.3758840362735059, 'auprc': 0.7311852710343253, 'loss_val': 0.8723070941322305, 'psi': 0.5180045301778337}-{'f1_val': 0.37757025399557126, 'auprc': 0.690487688262713, 'loss_val': 0.8557266062428789, 'psi': 0.5027372277024279}
[S17] START round=13 head_norm_before_train=1.444187 cos_to_last_merge=0.9043 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.3951822236546909, 'auprc': 0.8272096886172532, 'loss_val': 1.0083704688792388, 'psi': 0.5679932096397158}-{'f1_val': 0.40260037202107024, 'auprc': 0.8250205942796314, 'loss_val': 0.8534147577788573, 'psi': 0.5715684609244946}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:58312
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1807 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1807) from S4
[S11] cosine check vs S4: cos=0.9896
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=-0.0917
[S6] DROPPED delta from S16 (cos=-0.0917 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1804) from S8
[S7] cosine check vs S8: cos=0.9754
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.4319
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=-0.0727
[S5] DROPPED delta from S2 (cos=-0.0727 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S10
[S5] cosine check vs S10: cos=-0.1004
[S5] DROPPED delta from S10 (cos=-0.1004 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.8976
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.3210
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.3440
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.3966 head_norm=0.987238
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.419217e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.3964 head_norm=0.915541 delta_norm=0.241922
[S14] aggregate: ACCEPT kept=['S7', 'S9', 'S11'] (k=3/3) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=13 metric=0.4259 head_norm=0.851600
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.483933e-01
[S5] stored merged vector for next round verification (round=13)
[S5] DEBUG after merge:  round=13 metric=0.4181 head_norm=1.188054 delta_norm=0.848393
[S5] aggregate: ROLLBACK (f1_val pre=0.426 post=0.418 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.3959 head_norm=1.430127
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.844155e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.3747 head_norm=1.498725 delta_norm=0.184416
[S7] aggregate: ROLLBACK (f1_val pre=0.396 post=0.375 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.6819 head_norm=1.575647
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.324201e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.6816 head_norm=1.631798 delta_norm=0.132420
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.585706 cos_to_last_merge=0.8394 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.839
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.6138885518067688, 'auprc': 0.7448366952245853, 'loss_val': 0.6646385389146038, 'psi': 0.6662678091738954}-{'f1_val': 0.7129656309257484, 'auprc': 0.7747774351930956, 'loss_val': 0.527377312265647, 'psi': 0.7376903526326872}
[S3] START round=14 head_norm_before_train=1.667298 (no previous merge yet)
[S3] round=14 local utility u=0.496677 metrics={'f1_val': 0.7000803035935849, 'auprc': 0.9897920270672038, 'loss_val': 0.31735740759766734, 'psi': 0.8159649929830325}-{'f1_val': 0.5799263603173199, 'auprc': 0.9612432984406476, 'loss_val': 0.5041421863094727, 'psi': 0.732453135566651}
[S4] START round=14 head_norm_before_train=1.696448 cos_to_last_merge=0.9904 (last merge round=10)
[S4] round=14 local utility u=0.989773 metrics={'f1_val': 0.9423301710488747, 'auprc': 0.9438403939391258, 'loss_val': 0.4499245782603548, 'psi': 0.9429342602049751}-{'f1_val': 0.6112450304280973, 'auprc': 0.9514817376634394, 'loss_val': 0.46588386906879947, 'psi': 0.7473397133222341}
[S5] START round=14 head_norm_before_train=1.188054 cos_to_last_merge=1.0000 (last merge round=13)
[S5] round=14 local utility u=1.000000 metrics={'f1_val': 0.7004728133311429, 'auprc': 0.9091827917177451, 'loss_val': 0.6833315807514813, 'psi': 0.7839568046857838}-{'f1_val': 0.42592919401706847, 'auprc': 0.8548779146247937, 'loss_val': 0.9024609924055469, 'psi': 0.5975086822601585}
[S6] START round=14 head_norm_before_train=1.669754 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.8802776735772617, 'auprc': 0.9829450152759022, 'loss_val': 0.20597340780398443, 'psi': 0.9213446102567179}-{'f1_val': 0.6349878418075235, 'auprc': 0.8451770784745105, 'loss_val': 0.7272303439597245, 'psi': 0.7190635364743183}
[S7] START round=14 head_norm_before_train=1.498725 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.079723 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7799897131131532, 'loss_val': 0.7914187006151514, 'psi': 0.562143743506736}-{'f1_val': 0.39591130421197507, 'auprc': 0.7830869943009791, 'loss_val': 0.8341449093194945, 'psi': 0.5507815802475766}
[S8] START round=14 head_norm_before_train=1.585909 cos_to_last_merge=0.8228 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.823
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.9927318893430277, 'auprc': 0.9875004812083796, 'loss_val': 0.053573384733734485, 'psi': 0.9906393260891684}-{'f1_val': 0.9924611780272952, 'auprc': 0.99864520929151, 'loss_val': 0.05542198569795315, 'psi': 0.9949347905329811}
[S9] START round=14 head_norm_before_train=1.470563 cos_to_last_merge=0.9990 (last merge round=12)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.6230248152993643, 'auprc': 0.9231133918411872, 'loss_val': 0.40539663948083815, 'psi': 0.7430602459160934}-{'f1_val': 0.7015406642019387, 'auprc': 0.9984277122824828, 'loss_val': 0.2824578806263038, 'psi': 0.8202954834341564}
[S10] START round=14 head_norm_before_train=1.867461 (no previous merge yet)
[S10] round=14 local utility u=0.000599 metrics={'f1_val': 0.9928548469119698, 'auprc': 0.9965208764763351, 'loss_val': 0.0560860824904918, 'psi': 0.9943212587377159}-{'f1_val': 0.9937298155689185, 'auprc': 0.9945057174848839, 'loss_val': 0.05648780605326058, 'psi': 0.9940401763353046}
[S11] START round=14 head_norm_before_train=1.631798 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.6597379084474271, 'auprc': 0.9866165577174143, 'loss_val': 0.4555189795148091, 'psi': 0.7904893681554219}-{'f1_val': 0.6818697147294259, 'auprc': 0.9620967133350246, 'loss_val': 0.5102029910668926, 'psi': 0.7939605141716654}
[S13] START round=14 head_norm_before_train=1.316094 cos_to_last_merge=0.8561 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.856
[S13] round=14 local utility u=0.340566 metrics={'f1_val': 0.698320924473517, 'auprc': 0.9529257477249451, 'loss_val': 0.35505056954189107, 'psi': 0.8001628537740882}-{'f1_val': 0.6281991071782338, 'auprc': 0.9246438644570145, 'loss_val': 0.5306066094474001, 'psi': 0.7467770100897462}
[S14] START round=14 head_norm_before_train=0.915541 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.030530 metrics={'f1_val': 0.3960490692696715, 'auprc': 0.9883872969119079, 'loss_val': 0.8216911440489276, 'psi': 0.632984360326566}-{'f1_val': 0.39659360338126215, 'auprc': 0.992828629201318, 'loss_val': 0.8993413658898264, 'psi': 0.6350876137092845}
[S15] START round=14 head_norm_before_train=1.880762 (no previous merge yet)
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.8506927450037156, 'auprc': 0.9915378246562353, 'loss_val': 0.21957972099257916, 'psi': 0.9070307768647234}-{'f1_val': 0.9939759221388862, 'auprc': 0.9976797262335898, 'loss_val': 0.04318568929140115, 'psi': 0.9954574437767676}
[S16] START round=14 head_norm_before_train=1.256120 cos_to_last_merge=0.9849 (last merge round=9)
[S16] round=14 local utility u=0.188043 metrics={'f1_val': 0.43408211168492844, 'auprc': 0.7350926814123578, 'loss_val': 0.8571324433003243, 'psi': 0.5544863395759002}-{'f1_val': 0.3758840362735059, 'auprc': 0.7311852710343253, 'loss_val': 0.8723070941322305, 'psi': 0.5180045301778337}
[S17] START round=14 head_norm_before_train=1.474231 cos_to_last_merge=0.8974 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.897
[S17] round=14 local utility u=0.000000 metrics={'f1_val': 0.3954054797332352, 'auprc': 0.8258234165352476, 'loss_val': 1.0534204499037116, 'psi': 0.5675726544540401}-{'f1_val': 0.3951822236546909, 'auprc': 0.8272096886172532, 'loss_val': 1.0083704688792388, 'psi': 0.5679932096397158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:58311
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:58316
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S16] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9949
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0704
[S10] DROPPED delta from S13 (cos=-0.0704 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S16
[S6] cosine check vs S16: cos=-0.0927
[S6] DROPPED delta from S16 (cos=-0.0927 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.1122
[S5] DROPPED delta from S10 (cos=-0.1122 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] cosine check vs S14: cos=0.2839
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=0.9544
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=0.7696
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=0.3104
[S16] RECEIVED delta(kind=head bytes=1795) from S5
[S16] cosine check vs S5: cos=0.9174
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.6597 head_norm=1.659208
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.180990e-02
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.6616 head_norm=1.689764 delta_norm=0.091810
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=14 metric=0.4341 head_norm=1.284979
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.566491e-01
[S16] stored merged vector for next round verification (round=14)
[S16] DEBUG after merge:  round=14 metric=0.5410 head_norm=1.228677 delta_norm=0.256649
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9423 head_norm=1.724672
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.582837e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.9350 head_norm=1.686147 delta_norm=0.258284
[S4] aggregate: ROLLBACK (f1_val pre=0.942 post=0.935 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=14 metric=0.7005 head_norm=1.224689
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.671253e-01
[S5] stored merged vector for next round verification (round=14)
[S5] DEBUG after merge:  round=14 metric=0.5135 head_norm=0.964816 delta_norm=0.667125
[S5] aggregate: ROLLBACK (f1_val pre=0.700 post=0.514 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.3960 head_norm=0.940544
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.985737e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.3957 head_norm=1.161368 delta_norm=0.498574
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.615119 cos_to_last_merge=0.8380 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.838
[S2] round=15 local utility u=0.000000 metrics={'f1_val': 0.5545033527162704, 'auprc': 0.6807348613833215, 'loss_val': 0.9727479744672249, 'psi': 0.6049959561830909}-{'f1_val': 0.6138885518067688, 'auprc': 0.7448366952245853, 'loss_val': 0.6646385389146038, 'psi': 0.6662678091738954}
[S3] START round=15 head_norm_before_train=1.695550 (no previous merge yet)
[S3] round=15 local utility u=0.017550 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9919231695600734, 'loss_val': 0.2916577090877865, 'psi': 0.8171181054192824}-{'f1_val': 0.7000803035935849, 'auprc': 0.9897920270672038, 'loss_val': 0.31735740759766734, 'psi': 0.8159649929830325}
[S4] START round=15 head_norm_before_train=1.686147 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.017259 metrics={'f1_val': 0.9509014875788805, 'auprc': 0.935800012447543, 'loss_val': 0.442714308207042, 'psi': 0.9448608975263455}-{'f1_val': 0.9423301710488747, 'auprc': 0.9438403939391258, 'loss_val': 0.4499245782603548, 'psi': 0.9429342602049751}
[S5] START round=15 head_norm_before_train=0.964816 cos_to_last_merge=1.0000 (last merge round=14)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.43598886371055984, 'auprc': 0.8543296611903348, 'loss_val': 0.7531163867572015, 'psi': 0.6033251827024699}-{'f1_val': 0.7004728133311429, 'auprc': 0.9091827917177451, 'loss_val': 0.6833315807514813, 'psi': 0.7839568046857838}
[S6] START round=15 head_norm_before_train=1.686747 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.5954846007524356, 'auprc': 0.9281839406354437, 'loss_val': 0.9083281692267055, 'psi': 0.7285643367056389}-{'f1_val': 0.8802776735772617, 'auprc': 0.9829450152759022, 'loss_val': 0.20597340780398443, 'psi': 0.9213446102567179}
[S7] START round=15 head_norm_before_train=1.519894 cos_to_last_merge=0.9994 (last merge round=13)
[S7] round=15 local utility u=0.858849 metrics={'f1_val': 0.6989848364206181, 'auprc': 0.7867274216405725, 'loss_val': 0.7863633206270951, 'psi': 0.7340818705085999}-{'f1_val': 0.4169130971024577, 'auprc': 0.7799897131131532, 'loss_val': 0.7914187006151514, 'psi': 0.562143743506736}
[S8] START round=15 head_norm_before_train=1.624613 cos_to_last_merge=0.8180 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.818
[S8] round=15 local utility u=0.017718 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.998669318982498, 'loss_val': 0.04783910900627542, 'psi': 0.9947264708890151}-{'f1_val': 0.9927318893430277, 'auprc': 0.9875004812083796, 'loss_val': 0.053573384733734485, 'psi': 0.9906393260891684}
[S9] START round=15 head_norm_before_train=1.505312 cos_to_last_merge=0.9970 (last merge round=12)
[S9] round=15 local utility u=0.435531 metrics={'f1_val': 0.7024932145862333, 'auprc': 0.9982058379519287, 'loss_val': 0.23642242736648775, 'psi': 0.8207782639325114}-{'f1_val': 0.6230248152993643, 'auprc': 0.9231133918411872, 'loss_val': 0.40539663948083815, 'psi': 0.7430602459160934}
[S10] START round=15 head_norm_before_train=1.907691 (no previous merge yet)
[S10] round=15 local utility u=0.010942 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9933985369518643, 'loss_val': 0.03883280491917795, 'psi': 0.9944721181923706}-{'f1_val': 0.9928548469119698, 'auprc': 0.9965208764763351, 'loss_val': 0.0560860824904918, 'psi': 0.9943212587377159}
[S11] START round=15 head_norm_before_train=1.689764 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.000000 metrics={'f1_val': 0.6106180488779225, 'auprc': 0.995304907483145, 'loss_val': 0.4657111281959706, 'psi': 0.7644927923200115}-{'f1_val': 0.6597379084474271, 'auprc': 0.9866165577174143, 'loss_val': 0.4555189795148091, 'psi': 0.7904893681554219}
[S13] START round=15 head_norm_before_train=1.346051 cos_to_last_merge=0.8514 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.851
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.6036907652176354, 'auprc': 0.93366572989489, 'loss_val': 0.7003265812967262, 'psi': 0.7356807510885373}-{'f1_val': 0.698320924473517, 'auprc': 0.9529257477249451, 'loss_val': 0.35505056954189107, 'psi': 0.8001628537740882}
[S14] START round=15 head_norm_before_train=1.161368 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.009673 metrics={'f1_val': 0.3964230218922832, 'auprc': 0.9959524387965693, 'loss_val': 0.8272835401715319, 'psi': 0.6362347886539976}-{'f1_val': 0.3960490692696715, 'auprc': 0.9883872969119079, 'loss_val': 0.8216911440489276, 'psi': 0.632984360326566}
[S15] START round=15 head_norm_before_train=1.904694 (no previous merge yet)
[S15] round=15 local utility u=0.000000 metrics={'f1_val': 0.7736573161163923, 'auprc': 0.9867826952307854, 'loss_val': 0.30257059805592157, 'psi': 0.8589074677621495}-{'f1_val': 0.8506927450037156, 'auprc': 0.9915378246562353, 'loss_val': 0.21957972099257916, 'psi': 0.9070307768647234}
[S16] START round=15 head_norm_before_train=1.228677 cos_to_last_merge=1.0000 (last merge round=14)
[S16] round=15 local utility u=0.000000 metrics={'f1_val': 0.38940600494207783, 'auprc': 0.7401526031851853, 'loss_val': 0.8998119396256896, 'psi': 0.5297046442393208}-{'f1_val': 0.43408211168492844, 'auprc': 0.7350926814123578, 'loss_val': 0.8571324433003243, 'psi': 0.5544863395759002}
[S17] START round=15 head_norm_before_train=1.504114 cos_to_last_merge=0.8918 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=15 local utility u=0.000000 metrics={'f1_val': 0.3923784437934112, 'auprc': 0.8191880100691198, 'loss_val': 1.1318307581437133, 'psi': 0.5631022703036946}-{'f1_val': 0.3954054797332352, 'auprc': 0.8258234165352476, 'loss_val': 1.0534204499037116, 'psi': 0.5675726544540401}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:58314
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → trigger blocked (psi=0.945)
[S10] not sending this round → trigger blocked (psi=0.994)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.636)
[S7] not sending this round → trigger blocked (psi=0.734)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:58308
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.817)
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=0.2379
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=0.9876
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.3964 head_norm=1.177416
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.489105e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.3964 head_norm=1.072692 delta_norm=0.848910
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.099 → S5@127.0.0.1:58305
[S5] ⇄ pheromone p=0.253 → S16@127.0.0.1:58316
[S3] ⇄ pheromone p=0.238 → S5@127.0.0.1:58305
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=15 metric=0.6990 head_norm=1.537262
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.394420e-01
[S7] stored merged vector for next round verification (round=15)
[S7] DEBUG after merge:  round=15 metric=0.6721 head_norm=1.592635 delta_norm=0.139442
[S7] aggregate: ROLLBACK (f1_val pre=0.699 post=0.672 tol_abs=0.005 tol_rel=0.0)
[S7] ⇄ pheromone p=0.319 → S14@127.0.0.1:58314
[S15] ⇄ pheromone p=0.239 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.117 → S5@127.0.0.1:58305
[S11] ⇄ pheromone p=0.242 → S14@127.0.0.1:58314
[S4] ⇄ pheromone p=0.251 → S11@127.0.0.1:58312
[S2] ⇄ pheromone p=0.094 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.324 → S4@127.0.0.1:58304
[S13] ⇄ pheromone p=0.168 → S10@127.0.0.1:58311
[S9] ⇄ pheromone p=0.217 → S14@127.0.0.1:58314
[S8] ⇄ pheromone p=0.106 → S7@127.0.0.1:58308
[S17] ⇄ pheromone p=0.076 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.126 → S6@127.0.0.1:58307
[S2] START round=16 head_norm_before_train=1.646448 cos_to_last_merge=0.8372 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.837
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.5201526564098237, 'auprc': 0.6649835717496017, 'loss_val': 1.181766298270912, 'psi': 0.5780850225457348}-{'f1_val': 0.5545033527162704, 'auprc': 0.6807348613833215, 'loss_val': 0.9727479744672249, 'psi': 0.6049959561830909}
[S3] START round=16 head_norm_before_train=1.722657 (no previous merge yet)
[S3] round=16 local utility u=0.013157 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9949163616496092, 'loss_val': 0.27537174651163693, 'psi': 0.8184202669010234}-{'f1_val': 0.7005813959920884, 'auprc': 0.9919231695600734, 'loss_val': 0.2916577090877865, 'psi': 0.8171181054192824}
[S4] START round=16 head_norm_before_train=1.705566 cos_to_last_merge=0.9997 (last merge round=14)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6424221344630869, 'auprc': 0.9518654010840831, 'loss_val': 0.43147113687341954, 'psi': 0.7661994411114854}-{'f1_val': 0.9509014875788805, 'auprc': 0.935800012447543, 'loss_val': 0.442714308207042, 'psi': 0.9448608975263455}
[S5] START round=16 head_norm_before_train=0.992850 cos_to_last_merge=0.9986 (last merge round=14)
[S5] round=16 local utility u=0.913410 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.8668709230871647, 'loss_val': 0.5514026387921651, 'psi': 0.7670898623410242}-{'f1_val': 0.43598886371055984, 'auprc': 0.8543296611903348, 'loss_val': 0.7531163867572015, 'psi': 0.6033251827024699}
[S6] START round=16 head_norm_before_train=1.704688 (no previous merge yet)
[S6] round=16 local utility u=0.844714 metrics={'f1_val': 0.80008061348999, 'auprc': 0.9548438469264647, 'loss_val': 0.5264549914388867, 'psi': 0.8619859068645799}-{'f1_val': 0.5954846007524356, 'auprc': 0.9281839406354437, 'loss_val': 0.9083281692267055, 'psi': 0.7285643367056389}
[S7] START round=16 head_norm_before_train=1.592635 cos_to_last_merge=1.0000 (last merge round=15)
[S7] round=16 local utility u=0.080367 metrics={'f1_val': 0.7143650336037626, 'auprc': 0.787929198356029, 'loss_val': 0.7215167554349424, 'psi': 0.7437906995046693}-{'f1_val': 0.6989848364206181, 'auprc': 0.7867274216405725, 'loss_val': 0.7863633206270951, 'psi': 0.7340818705085999}
[S8] START round=16 head_norm_before_train=1.657915 cos_to_last_merge=0.8140 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.814
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9988580506966348, 'loss_val': 0.05482602178492129, 'psi': 0.9911967770534904}-{'f1_val': 0.9920979054933599, 'auprc': 0.998669318982498, 'loss_val': 0.04783910900627542, 'psi': 0.9947264708890151}
[S9] START round=16 head_norm_before_train=1.535032 cos_to_last_merge=0.9949 (last merge round=12)
[S9] round=16 local utility u=0.915099 metrics={'f1_val': 0.9944036913787132, 'auprc': 0.9980268259832767, 'loss_val': 0.15714957888365844, 'psi': 0.9958529452205387}-{'f1_val': 0.7024932145862333, 'auprc': 0.9982058379519287, 'loss_val': 0.23642242736648775, 'psi': 0.8207782639325114}
[S10] START round=16 head_norm_before_train=1.943083 (no previous merge yet)
[S10] round=16 local utility u=0.004333 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953781853364817, 'loss_val': 0.0361058472963202, 'psi': 0.9952639775462175}-{'f1_val': 0.9951878390193748, 'auprc': 0.9933985369518643, 'loss_val': 0.03883280491917795, 'psi': 0.9944721181923706}
[S11] START round=16 head_norm_before_train=1.716094 cos_to_last_merge=0.9995 (last merge round=14)
[S11] round=16 local utility u=0.218063 metrics={'f1_val': 0.6634820097426025, 'auprc': 0.9962811017798655, 'loss_val': 0.34969682486185405, 'psi': 0.7966016465575078}-{'f1_val': 0.6106180488779225, 'auprc': 0.995304907483145, 'loss_val': 0.4657111281959706, 'psi': 0.7644927923200115}
[S13] START round=16 head_norm_before_train=1.367677 cos_to_last_merge=0.8459 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.846
[S13] round=16 local utility u=0.198684 metrics={'f1_val': 0.631826911355817, 'auprc': 0.9504403577576656, 'loss_val': 0.5220984299866663, 'psi': 0.7592722899165565}-{'f1_val': 0.6036907652176354, 'auprc': 0.93366572989489, 'loss_val': 0.7003265812967262, 'psi': 0.7356807510885373}
[S14] START round=16 head_norm_before_train=1.072692 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.000000 metrics={'f1_val': 0.3964230218922832, 'auprc': 0.9307950192175541, 'loss_val': 0.7256921184407145, 'psi': 0.6101718208223916}-{'f1_val': 0.3964230218922832, 'auprc': 0.9959524387965693, 'loss_val': 0.8272835401715319, 'psi': 0.6362347886539976}
[S15] START round=16 head_norm_before_train=1.932167 (no previous merge yet)
[S15] round=16 local utility u=0.654127 metrics={'f1_val': 0.9499290265496545, 'auprc': 0.9935149116394905, 'loss_val': 0.07214422526839652, 'psi': 0.9673633805855888}-{'f1_val': 0.7736573161163923, 'auprc': 0.9867826952307854, 'loss_val': 0.30257059805592157, 'psi': 0.8589074677621495}
[S16] START round=16 head_norm_before_train=1.257565 cos_to_last_merge=0.9989 (last merge round=14)
[S16] round=16 local utility u=1.000000 metrics={'f1_val': 0.7808202147134503, 'auprc': 0.7665074851615219, 'loss_val': 0.7760377171933329, 'psi': 0.775095122892679}-{'f1_val': 0.38940600494207783, 'auprc': 0.7401526031851853, 'loss_val': 0.8998119396256896, 'psi': 0.5297046442393208}
[S17] START round=16 head_norm_before_train=1.531541 cos_to_last_merge=0.8856 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.886
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.38716387532249597, 'auprc': 0.8030435130689773, 'loss_val': 1.2194675448438608, 'psi': 0.5535157304210885}-{'f1_val': 0.3923784437934112, 'auprc': 0.8191880100691198, 'loss_val': 1.1318307581437133, 'psi': 0.5631022703036946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S11] → sending delta(kind=head bytes=1808) to S14@127.0.0.1:58314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[S3] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1808 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0733
[S10] DROPPED delta from S13 (cos=-0.0733 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1808) from S11
[S14] cosine check vs S11: cos=0.1607
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.6358
[S6] RECEIVED delta(kind=head bytes=1797) from S16
[S6] cosine check vs S16: cos=-0.0636
[S6] DROPPED delta from S16 (cos=-0.0636 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S3
[S5] cosine check vs S3: cos=0.7125
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.1064
[S5] DROPPED delta from S10 (cos=-0.1064 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.8425
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.9794
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.5439
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.3964 head_norm=1.099813
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.006891e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.4609 head_norm=0.998387 delta_norm=0.600689
[S14] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=16 metric=0.6424 head_norm=1.725206
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.747856e-01
[S4] stored merged vector for next round verification (round=16)
[S4] DEBUG after merge:  round=16 metric=0.6196 head_norm=1.713828 delta_norm=0.174786
[S4] aggregate: ROLLBACK (f1_val pre=0.642 post=0.620 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=16 metric=0.7006 head_norm=1.027469
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.660052e-01
[S5] stored merged vector for next round verification (round=16)
[S5] DEBUG after merge:  round=16 metric=0.7006 head_norm=1.161816 delta_norm=0.266005
[S5] aggregate: ACCEPT kept=['S15', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=16 metric=0.7808 head_norm=1.291503
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.492103e-01
[S16] stored merged vector for next round verification (round=16)
[S16] DEBUG after merge:  round=16 metric=0.7964 head_norm=1.113503 delta_norm=0.349210
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.670079 cos_to_last_merge=0.8361 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.836
[S2] round=17 local utility u=0.871004 metrics={'f1_val': 0.717516849861513, 'auprc': 0.7472734262772667, 'loss_val': 0.8708129961770196, 'psi': 0.7294194804278145}-{'f1_val': 0.5201526564098237, 'auprc': 0.6649835717496017, 'loss_val': 1.181766298270912, 'psi': 0.5780850225457348}
[S3] START round=17 head_norm_before_train=1.748127 (no previous merge yet)
[S3] round=17 local utility u=0.001761 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9950936083876563, 'loss_val': 0.2723813422458188, 'psi': 0.8184911655962424}-{'f1_val': 0.7007562037352997, 'auprc': 0.9949163616496092, 'loss_val': 0.27537174651163693, 'psi': 0.8184202669010234}
[S4] START round=17 head_norm_before_train=1.713828 cos_to_last_merge=1.0000 (last merge round=16)
[S4] round=17 local utility u=0.952852 metrics={'f1_val': 0.9550138774873754, 'auprc': 0.9509124730682292, 'loss_val': 0.39845813071178116, 'psi': 0.9533733157197171}-{'f1_val': 0.6424221344630869, 'auprc': 0.9518654010840831, 'loss_val': 0.43147113687341954, 'psi': 0.7661994411114854}
[S5] START round=17 head_norm_before_train=1.161816 cos_to_last_merge=1.0000 (last merge round=16)
[S5] round=17 local utility u=0.143325 metrics={'f1_val': 0.6979590182746016, 'auprc': 0.952392552773819, 'loss_val': 0.5056563075664725, 'psi': 0.7997324320742886}-{'f1_val': 0.7005691551769304, 'auprc': 0.8668709230871647, 'loss_val': 0.5514026387921651, 'psi': 0.7670898623410242}
[S6] START round=17 head_norm_before_train=1.720225 (no previous merge yet)
[S6] round=17 local utility u=0.192291 metrics={'f1_val': 0.8275367220336697, 'auprc': 0.960718442802181, 'loss_val': 0.3242339072576286, 'psi': 0.8808094103410742}-{'f1_val': 0.80008061348999, 'auprc': 0.9548438469264647, 'loss_val': 0.5264549914388867, 'psi': 0.8619859068645799}
[S7] START round=17 head_norm_before_train=1.611708 cos_to_last_merge=0.9996 (last merge round=15)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5500505788419446, 'auprc': 0.7825632431367887, 'loss_val': 0.7501122553007301, 'psi': 0.6430556445598823}-{'f1_val': 0.7143650336037626, 'auprc': 0.787929198356029, 'loss_val': 0.7215167554349424, 'psi': 0.7437906995046693}
[S8] START round=17 head_norm_before_train=1.683677 cos_to_last_merge=0.8098 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.810
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.9871891468768156, 'auprc': 0.9853818722409753, 'loss_val': 0.07297661709836595, 'psi': 0.9864662370224795}-{'f1_val': 0.9860892612913941, 'auprc': 0.9988580506966348, 'loss_val': 0.05482602178492129, 'psi': 0.9911967770534904}
[S9] START round=17 head_norm_before_train=1.561690 cos_to_last_merge=0.9927 (last merge round=12)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.98133153333969, 'loss_val': 0.2368602194373988, 'psi': 0.8132625617998872}-{'f1_val': 0.9944036913787132, 'auprc': 0.9980268259832767, 'loss_val': 0.15714957888365844, 'psi': 0.9958529452205387}
[S10] START round=17 head_norm_before_train=1.975004 (no previous merge yet)
[S10] round=17 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9942349144045682, 'loss_val': 0.03332993839022771, 'psi': 0.9948066691734521}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953781853364817, 'loss_val': 0.0361058472963202, 'psi': 0.9952639775462175}
[S11] START round=17 head_norm_before_train=1.741449 cos_to_last_merge=0.9985 (last merge round=14)
[S11] round=17 local utility u=0.000000 metrics={'f1_val': 0.6056022592740876, 'auprc': 0.9954401991758668, 'loss_val': 0.49886777637327157, 'psi': 0.7615374352347992}-{'f1_val': 0.6634820097426025, 'auprc': 0.9962811017798655, 'loss_val': 0.34969682486185405, 'psi': 0.7966016465575078}
[S13] START round=17 head_norm_before_train=1.394559 cos_to_last_merge=0.8392 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.839
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.5933941330652047, 'auprc': 0.9369890935277043, 'loss_val': 0.7687649301502331, 'psi': 0.7308321172502046}-{'f1_val': 0.631826911355817, 'auprc': 0.9504403577576656, 'loss_val': 0.5220984299866663, 'psi': 0.7592722899165565}
[S14] START round=17 head_norm_before_train=0.998387 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.991659 metrics={'f1_val': 0.6916913536797631, 'auprc': 0.9912456095921913, 'loss_val': 0.6953356040215556, 'psi': 0.8115130560447343}-{'f1_val': 0.3964230218922832, 'auprc': 0.9307950192175541, 'loss_val': 0.7256921184407145, 'psi': 0.6101718208223916}
[S15] START round=17 head_norm_before_train=1.956866 (no previous merge yet)
[S15] round=17 local utility u=0.162080 metrics={'f1_val': 0.9956438101891232, 'auprc': 0.9976380704539523, 'loss_val': 0.034641619089714464, 'psi': 0.9964415142950548}-{'f1_val': 0.9499290265496545, 'auprc': 0.9935149116394905, 'loss_val': 0.07214422526839652, 'psi': 0.9673633805855888}
[S16] START round=17 head_norm_before_train=1.113503 cos_to_last_merge=1.0000 (last merge round=16)
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.42584782385347125, 'auprc': 0.7569263936213977, 'loss_val': 0.7493248446457403, 'psi': 0.5582792517606419}-{'f1_val': 0.7808202147134503, 'auprc': 0.7665074851615219, 'loss_val': 0.7760377171933329, 'psi': 0.775095122892679}
[S17] START round=17 head_norm_before_train=1.563184 cos_to_last_merge=0.8799 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=17 local utility u=0.209086 metrics={'f1_val': 0.404879099983383, 'auprc': 0.832755372539652, 'loss_val': 0.996722559250508, 'psi': 0.5760296090058906}-{'f1_val': 0.38716387532249597, 'auprc': 0.8030435130689773, 'loss_val': 1.2194675448438608, 'psi': 0.5535157304210885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:58312
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=-0.1210
[S5] DROPPED delta from S2 (cos=-0.1210 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.7176
[S5] RECEIVED delta(kind=head bytes=1798) from S14
[S5] cosine check vs S14: cos=0.3738
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9608
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.6997
[S11] RECEIVED delta(kind=head bytes=1801) from S4
[S11] cosine check vs S4: cos=0.9742
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.9896
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1797 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1797) from S17
[S9] cosine check vs S17: cos=0.9540
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=17 metric=0.6056 head_norm=1.765617
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.994808e-01
[S11] stored merged vector for next round verification (round=17)
[S11] DEBUG after merge:  round=17 metric=0.6054 head_norm=1.740813 delta_norm=0.199481
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=17 metric=0.7012 head_norm=1.584351
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.410394e-01
[S9] stored merged vector for next round verification (round=17)
[S9] DEBUG after merge:  round=17 metric=0.7012 head_norm=1.570293 delta_norm=0.241039
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=17 metric=0.9550 head_norm=1.738690
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.253485e-01
[S4] stored merged vector for next round verification (round=17)
[S4] DEBUG after merge:  round=17 metric=0.9544 head_norm=1.732147 delta_norm=0.125348
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=17 metric=0.6980 head_norm=1.190691
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.819943e-01
[S5] stored merged vector for next round verification (round=17)
[S5] DEBUG after merge:  round=17 metric=0.7003 head_norm=1.041858 delta_norm=0.281994
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=17 metric=0.4258 head_norm=1.144567
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.649536e-01
[S16] stored merged vector for next round verification (round=17)
[S16] DEBUG after merge:  round=17 metric=0.4479 head_norm=1.156148 delta_norm=0.164954
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.685481 cos_to_last_merge=0.8351 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.835
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.6882019481444652, 'auprc': 0.7469438060165057, 'loss_val': 0.8291543858849713, 'psi': 0.7116986912932814}-{'f1_val': 0.717516849861513, 'auprc': 0.7472734262772667, 'loss_val': 0.8708129961770196, 'psi': 0.7294194804278145}
[S3] START round=18 head_norm_before_train=1.769526 (no previous merge yet)
[S3] round=18 local utility u=0.000760 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9951102864050565, 'loss_val': 0.2704590895834453, 'psi': 0.8184526903612235}-{'f1_val': 0.7007562037352997, 'auprc': 0.9950936083876563, 'loss_val': 0.2723813422458188, 'psi': 0.8184911655962424}
[S4] START round=18 head_norm_before_train=1.732147 cos_to_last_merge=1.0000 (last merge round=17)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.9521958653577614, 'auprc': 0.9491051664951565, 'loss_val': 0.3838039088879817, 'psi': 0.9509595858127194}-{'f1_val': 0.9550138774873754, 'auprc': 0.9509124730682292, 'loss_val': 0.39845813071178116, 'psi': 0.9533733157197171}
[S5] START round=18 head_norm_before_train=1.041858 cos_to_last_merge=1.0000 (last merge round=17)
[S5] round=18 local utility u=0.066823 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9897500960555844, 'loss_val': 0.4982525035470624, 'psi': 0.8160923975170491}-{'f1_val': 0.6979590182746016, 'auprc': 0.952392552773819, 'loss_val': 0.5056563075664725, 'psi': 0.7997324320742886}
[S6] START round=18 head_norm_before_train=1.734660 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.44080396109872705, 'auprc': 0.7438056607335327, 'loss_val': 1.0686465761316977, 'psi': 0.5620046409526493}-{'f1_val': 0.8275367220336697, 'auprc': 0.960718442802181, 'loss_val': 0.3242339072576286, 'psi': 0.8808094103410742}
[S7] START round=18 head_norm_before_train=1.633516 cos_to_last_merge=0.9988 (last merge round=15)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.42430866997614924, 'auprc': 0.7819623710531974, 'loss_val': 0.8171568626381377, 'psi': 0.5673701504069686}-{'f1_val': 0.5500505788419446, 'auprc': 0.7825632431367887, 'loss_val': 0.7501122553007301, 'psi': 0.6430556445598823}
[S8] START round=18 head_norm_before_train=1.708078 cos_to_last_merge=0.8073 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.807
[S8] round=18 local utility u=0.025087 metrics={'f1_val': 0.9853820930993438, 'auprc': 0.9988432916314018, 'loss_val': 0.05234467826843415, 'psi': 0.990766572512167}-{'f1_val': 0.9871891468768156, 'auprc': 0.9853818722409753, 'loss_val': 0.07297661709836595, 'psi': 0.9864662370224795}
[S9] START round=18 head_norm_before_train=1.570293 cos_to_last_merge=1.0000 (last merge round=17)
[S9] round=18 local utility u=0.944839 metrics={'f1_val': 0.9903686845626269, 'auprc': 0.9990993201734031, 'loss_val': 0.13539869959581174, 'psi': 0.9938609388069375}-{'f1_val': 0.7012165807733519, 'auprc': 0.98133153333969, 'loss_val': 0.2368602194373988, 'psi': 0.8132625617998872}
[S10] START round=18 head_norm_before_train=2.000107 (no previous merge yet)
[S10] round=18 local utility u=0.002727 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955331837479329, 'loss_val': 0.03177007860573017, 'psi': 0.995325976910798}-{'f1_val': 0.9951878390193748, 'auprc': 0.9942349144045682, 'loss_val': 0.03332993839022771, 'psi': 0.9948066691734521}
[S11] START round=18 head_norm_before_train=1.740813 cos_to_last_merge=1.0000 (last merge round=17)
[S11] round=18 local utility u=1.000000 metrics={'f1_val': 0.9549664622503342, 'auprc': 0.9970041809705071, 'loss_val': 0.2430117494825019, 'psi': 0.9717815497384034}-{'f1_val': 0.6056022592740876, 'auprc': 0.9954401991758668, 'loss_val': 0.49886777637327157, 'psi': 0.7615374352347992}
[S13] START round=18 head_norm_before_train=1.412036 cos_to_last_merge=0.8351 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.835
[S13] round=18 local utility u=0.237409 metrics={'f1_val': 0.6321380712963793, 'auprc': 0.9355762712781555, 'loss_val': 0.5221725007126088, 'psi': 0.7535133512890898}-{'f1_val': 0.5933941330652047, 'auprc': 0.9369890935277043, 'loss_val': 0.7687649301502331, 'psi': 0.7308321172502046}
[S14] START round=18 head_norm_before_train=1.028814 cos_to_last_merge=0.9963 (last merge round=16)
[S14] round=18 local utility u=0.042931 metrics={'f1_val': 0.6900227465294718, 'auprc': 0.9958977914013064, 'loss_val': 0.6134180149076675, 'psi': 0.8123727644782057}-{'f1_val': 0.6916913536797631, 'auprc': 0.9912456095921913, 'loss_val': 0.6953356040215556, 'psi': 0.8115130560447343}
[S15] START round=18 head_norm_before_train=1.975549 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7011955970681706, 'auprc': 0.8768725804674842, 'loss_val': 0.50440326472339, 'psi': 0.771466390427896}-{'f1_val': 0.9956438101891232, 'auprc': 0.9976380704539523, 'loss_val': 0.034641619089714464, 'psi': 0.9964415142950548}
[S16] START round=18 head_norm_before_train=1.156148 cos_to_last_merge=1.0000 (last merge round=17)
[S16] round=18 local utility u=1.000000 metrics={'f1_val': 0.8232511769833069, 'auprc': 0.8252761781736604, 'loss_val': 0.6708361721337929, 'psi': 0.8240611774594483}-{'f1_val': 0.42584782385347125, 'auprc': 0.7569263936213977, 'loss_val': 0.7493248446457403, 'psi': 0.5582792517606419}
[S17] START round=18 head_norm_before_train=1.593008 cos_to_last_merge=0.8747 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=18 local utility u=0.496746 metrics={'f1_val': 0.6036490355883153, 'auprc': 0.8236542165248724, 'loss_val': 1.1685459721917304, 'psi': 0.6916511079629382}-{'f1_val': 0.404879099983383, 'auprc': 0.832755372539652, 'loss_val': 0.996722559250508, 'psi': 0.5760296090058906}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S16@127.0.0.1:58316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:58311
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S16] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.5441
[S7] RECEIVED delta(kind=head bytes=1805) from S8
[S7] cosine check vs S8: cos=0.9907
[S6] RECEIVED delta(kind=head bytes=1804) from S16
[S6] cosine check vs S16: cos=0.0020
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.4768
[S5] RECEIVED delta(kind=head bytes=1800) from S10
[S5] cosine check vs S10: cos=-0.0964
[S5] DROPPED delta from S10 (cos=-0.0964 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1793) from S5
[S16] cosine check vs S5: cos=0.9589
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=0.5306
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=-0.0763
[S10] DROPPED delta from S13 (cos=-0.0763 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.7339
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1800 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S17
[S9] cosine check vs S17: cos=0.9861
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=18 metric=0.4243 head_norm=1.654075
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.206758e-01
[S7] stored merged vector for next round verification (round=18)
[S7] DEBUG after merge:  round=18 metric=0.4187 head_norm=1.686552 delta_norm=0.120676
[S7] aggregate: ROLLBACK (f1_val pre=0.424 post=0.419 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=18 metric=0.4408 head_norm=1.755985
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.058838e+00
[S6] stored merged vector for next round verification (round=18)
[S6] DEBUG after merge:  round=18 metric=0.4745 head_norm=1.060838 delta_norm=1.058838
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=18 metric=0.9904 head_norm=1.587975
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.350056e-01
[S9] stored merged vector for next round verification (round=18)
[S9] DEBUG after merge:  round=18 metric=0.9853 head_norm=1.599478 delta_norm=0.135006
[S9] aggregate: ROLLBACK (f1_val pre=0.990 post=0.985 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=18 metric=0.8233 head_norm=1.187244
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.715905e-01
[S16] stored merged vector for next round verification (round=18)
[S16] DEBUG after merge:  round=18 metric=0.8405 head_norm=1.118396 delta_norm=0.171591
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=18 metric=0.6900 head_norm=1.061729
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.213400e-01
[S14] stored merged vector for next round verification (round=18)
[S14] DEBUG after merge:  round=18 metric=0.6896 head_norm=1.043053 delta_norm=0.421340
[S14] aggregate: ACCEPT kept=['S11', 'S9'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=18 metric=0.7003 head_norm=1.072827
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.687308e-01
[S5] stored merged vector for next round verification (round=18)
[S5] DEBUG after merge:  round=18 metric=0.7003 head_norm=1.068582 delta_norm=0.368731
[S5] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.696318 cos_to_last_merge=0.8343 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.834
[S2] round=19 local utility u=0.033509 metrics={'f1_val': 0.718188251463767, 'auprc': 0.7416764749880997, 'loss_val': 0.9262530737510659, 'psi': 0.7275835408735001}-{'f1_val': 0.6882019481444652, 'auprc': 0.7469438060165057, 'loss_val': 0.8291543858849713, 'psi': 0.7116986912932814}
[S3] START round=19 head_norm_before_train=1.787483 (no previous merge yet)
[S3] round=19 local utility u=0.000272 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9951038034869826, 'loss_val': 0.2698951529588962, 'psi': 0.8184500971939939}-{'f1_val': 0.7006809596653347, 'auprc': 0.9951102864050565, 'loss_val': 0.2704590895834453, 'psi': 0.8184526903612235}
[S4] START round=19 head_norm_before_train=1.763790 cos_to_last_merge=0.9986 (last merge round=17)
[S4] round=19 local utility u=0.038841 metrics={'f1_val': 0.9552941773525605, 'auprc': 0.9537726855474684, 'loss_val': 0.33871351728199256, 'psi': 0.9546855806305237}-{'f1_val': 0.9521958653577614, 'auprc': 0.9491051664951565, 'loss_val': 0.3838039088879817, 'psi': 0.9509595858127194}
[S5] START round=19 head_norm_before_train=1.068582 cos_to_last_merge=1.0000 (last merge round=18)
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.989895871680132, 'loss_val': 0.5356478205103635, 'psi': 0.816151139132401}-{'f1_val': 0.700320598491359, 'auprc': 0.9897500960555844, 'loss_val': 0.4982525035470624, 'psi': 0.8160923975170491}
[S6] START round=19 head_norm_before_train=1.060838 cos_to_last_merge=1.0000 (last merge round=18)
[S6] round=19 local utility u=1.000000 metrics={'f1_val': 0.7580663098679394, 'auprc': 0.8995740681289133, 'loss_val': 0.5840180247775449, 'psi': 0.8146694131723289}-{'f1_val': 0.44080396109872705, 'auprc': 0.7438056607335327, 'loss_val': 1.0686465761316977, 'psi': 0.5620046409526493}
[S7] START round=19 head_norm_before_train=1.686552 cos_to_last_merge=1.0000 (last merge round=18)
[S7] round=19 local utility u=0.862232 metrics={'f1_val': 0.6499715417771242, 'auprc': 0.8467384858188146, 'loss_val': 0.640998314775952, 'psi': 0.7286783193938005}-{'f1_val': 0.42430866997614924, 'auprc': 0.7819623710531974, 'loss_val': 0.8171568626381377, 'psi': 0.5673701504069686}
[S8] START round=19 head_norm_before_train=1.726870 cos_to_last_merge=0.8063 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.806
[S8] round=19 local utility u=0.027780 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9985965448394198, 'loss_val': 0.03851837079533436, 'psi': 0.9949153247521451}-{'f1_val': 0.9853820930993438, 'auprc': 0.9988432916314018, 'loss_val': 0.05234467826843415, 'psi': 0.990766572512167}
[S9] START round=19 head_norm_before_train=1.599478 cos_to_last_merge=1.0000 (last merge round=18)
[S9] round=19 local utility u=0.000000 metrics={'f1_val': 0.9774282609880908, 'auprc': 0.9988698233973595, 'loss_val': 0.15145006122025073, 'psi': 0.9860048859517982}-{'f1_val': 0.9903686845626269, 'auprc': 0.9990993201734031, 'loss_val': 0.13539869959581174, 'psi': 0.9938609388069375}
[S10] START round=19 head_norm_before_train=2.026437 (no previous merge yet)
[S10] round=19 local utility u=0.000091 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953688313772835, 'loss_val': 0.031095710214081116, 'psi': 0.9952602359625382}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955331837479329, 'loss_val': 0.03177007860573017, 'psi': 0.995325976910798}
[S11] START round=19 head_norm_before_train=1.760380 cos_to_last_merge=0.9998 (last merge round=17)
[S11] round=19 local utility u=0.101503 metrics={'f1_val': 0.9784215888924677, 'auprc': 0.9968929556827026, 'loss_val': 0.18040297259749097, 'psi': 0.9858101356085617}-{'f1_val': 0.9549664622503342, 'auprc': 0.9970041809705071, 'loss_val': 0.2430117494825019, 'psi': 0.9717815497384034}
[S13] START round=19 head_norm_before_train=1.429662 cos_to_last_merge=0.8329 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.833
[S13] round=19 local utility u=0.130878 metrics={'f1_val': 0.6589238944104011, 'auprc': 0.9433853878684715, 'loss_val': 0.44455943299078665, 'psi': 0.7727084917936293}-{'f1_val': 0.6321380712963793, 'auprc': 0.9355762712781555, 'loss_val': 0.5221725007126088, 'psi': 0.7535133512890898}
[S14] START round=19 head_norm_before_train=1.043053 cos_to_last_merge=1.0000 (last merge round=18)
[S14] round=19 local utility u=0.008787 metrics={'f1_val': 0.6911189050402049, 'auprc': 0.993998470407799, 'loss_val': 0.5967229954487112, 'psi': 0.8122707311872426}-{'f1_val': 0.6900227465294718, 'auprc': 0.9958977914013064, 'loss_val': 0.6134180149076675, 'psi': 0.8123727644782057}
[S15] START round=19 head_norm_before_train=1.988013 (no previous merge yet)
[S15] round=19 local utility u=0.941690 metrics={'f1_val': 0.8995816471907147, 'auprc': 0.9957437998131569, 'loss_val': 0.16795384382960765, 'psi': 0.9380465082396915}-{'f1_val': 0.7011955970681706, 'auprc': 0.8768725804674842, 'loss_val': 0.50440326472339, 'psi': 0.771466390427896}
[S16] START round=19 head_norm_before_train=1.118396 cos_to_last_merge=1.0000 (last merge round=18)
[S16] round=19 local utility u=0.070909 metrics={'f1_val': 0.830808626522348, 'auprc': 0.8643504640643991, 'loss_val': 0.6915847674359441, 'psi': 0.8442253615391684}-{'f1_val': 0.8232511769833069, 'auprc': 0.8252761781736604, 'loss_val': 0.6708361721337929, 'psi': 0.8240611774594483}
[S17] START round=19 head_norm_before_train=1.622174 cos_to_last_merge=0.8720 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=19 local utility u=0.290958 metrics={'f1_val': 0.6684840236031051, 'auprc': 0.8370185556042732, 'loss_val': 1.015732154215458, 'psi': 0.7358978364035723}-{'f1_val': 0.6036490355883153, 'auprc': 0.8236542165248724, 'loss_val': 1.1685459721917304, 'psi': 0.6916511079629382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S3] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.8469
[S6] RECEIVED delta(kind=head bytes=1792) from S16
[S6] cosine check vs S16: cos=0.5472
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.6900
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.3950
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9890
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0784
[S10] DROPPED delta from S13 (cos=-0.0784 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S3
[S5] cosine check vs S3: cos=0.8634
[S5] RECEIVED delta(kind=head bytes=1802) from S2
[S5] cosine check vs S2: cos=-0.0883
[S5] DROPPED delta from S2 (cos=-0.0883 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1798) from S8
[S7] cosine check vs S8: cos=0.9967
[S5] RECEIVED delta(kind=head bytes=1793) from S15
[S5] cosine check vs S15: cos=0.3509
[S5] RECEIVED delta(kind=head bytes=1802) from S14
[S5] cosine check vs S14: cos=0.5063
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.0732
[S5] DROPPED delta from S10 (cos=-0.0732 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1798 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S17
[S9] cosine check vs S17: cos=0.9946
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=19 metric=0.7003 head_norm=1.096260
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.930850e-01
[S5] stored merged vector for next round verification (round=19)
[S5] DEBUG after merge:  round=19 metric=0.7003 head_norm=1.004560 delta_norm=0.193085
[S5] aggregate: ACCEPT kept=['S3', 'S15', 'S14'] (k=3/3) mode=median trim_p=0.1
[S5] r=20 psi=0.816 u=0.0000 p_local=0.2261 f1=0.700 auprc=0.990 bytes=19765
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=19 metric=0.9774 head_norm=1.621773
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.605361e-02
[S9] stored merged vector for next round verification (round=19)
[S9] DEBUG after merge:  round=19 metric=0.9612 head_norm=1.632655 delta_norm=0.086054
[S9] aggregate: ROLLBACK (f1_val pre=0.977 post=0.961 tol_abs=0.005 tol_rel=0.0)
[S9] r=20 psi=0.986 u=0.0000 p_local=0.3338 f1=0.977 auprc=0.999 bytes=17966
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=19 metric=0.7581 head_norm=1.148466
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.487680e-01
[S6] stored merged vector for next round verification (round=19)
[S6] DEBUG after merge:  round=19 metric=0.7421 head_norm=1.014333 delta_norm=0.548768
[S6] aggregate: ROLLBACK (f1_val pre=0.758 post=0.742 tol_abs=0.005 tol_rel=0.0)
[S6] r=20 psi=0.815 u=1.0000 p_local=0.4439 f1=0.758 auprc=0.900 bytes=19800
[S3] r=20 psi=0.818 u=0.0003 p_local=0.0993 f1=0.701 auprc=0.995 bytes=21584
[S2] r=20 psi=0.728 u=0.0335 p_local=0.1565 f1=0.718 auprc=0.742 bytes=17979
[S16] r=20 psi=0.844 u=0.0709 p_local=0.3281 f1=0.831 auprc=0.864 bytes=17974
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=19 metric=0.6500 head_norm=1.703549
[S7] _apply_head_vector_avg (torch): Δ‖w‖=7.344708e-02
[S7] stored merged vector for next round verification (round=19)
[S7] DEBUG after merge:  round=19 metric=0.6498 head_norm=1.724302 delta_norm=0.073447
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] r=20 psi=0.729 u=0.8622 p_local=0.3113 f1=0.650 auprc=0.847 bytes=21594
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=19 metric=0.9784 head_norm=1.787368
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.333202e-01
[S11] stored merged vector for next round verification (round=19)
[S11] DEBUG after merge:  round=19 metric=0.9811 head_norm=1.791879 delta_norm=0.133320
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] r=20 psi=0.986 u=0.1015 p_local=0.3017 f1=0.978 auprc=0.997 bytes=17999
[S8] r=20 psi=0.995 u=0.0278 p_local=0.0529 f1=0.992 auprc=0.999 bytes=23389
[S15] r=20 psi=0.938 u=0.9417 p_local=0.3740 f1=0.900 auprc=0.996 bytes=21578
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=19 metric=0.9553 head_norm=1.806247
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.166708e-01
[S4] stored merged vector for next round verification (round=19)
[S4] DEBUG after merge:  round=19 metric=0.9555 head_norm=1.422604 delta_norm=0.516671
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] r=20 psi=0.955 u=0.0388 p_local=0.2325 f1=0.955 auprc=0.954 bytes=21594
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=19 metric=0.6911 head_norm=1.075409
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.276005e-01
[S14] stored merged vector for next round verification (round=19)
[S14] DEBUG after merge:  round=19 metric=0.6910 head_norm=1.099026 delta_norm=0.427601
[S14] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S14] r=20 psi=0.812 u=0.0088 p_local=0.1760 f1=0.691 auprc=0.994 bytes=19781
[S13] r=20 psi=0.773 u=0.1309 p_local=0.1534 f1=0.659 auprc=0.943 bytes=17977
[S10] r=20 psi=0.995 u=0.0001 p_local=0.0488 f1=0.995 auprc=0.995 bytes=23374
[S17] r=20 psi=0.736 u=0.2910 p_local=0.1956 f1=0.668 auprc=0.837 bytes=21563
[S2] START round=20 head_norm_before_train=1.712110 cos_to_last_merge=0.8333 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.833
[S2] round=20 local utility u=0.000000 metrics={'f1_val': 0.7150411208627725, 'auprc': 0.7327767572729803, 'loss_val': 0.8948702645097204, 'psi': 0.7221353754268556}-{'f1_val': 0.718188251463767, 'auprc': 0.7416764749880997, 'loss_val': 0.9262530737510659, 'psi': 0.7275835408735001}
[S3] START round=20 head_norm_before_train=1.804275 (no previous merge yet)
[S3] round=20 local utility u=0.000109 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9932602092669539, 'loss_val': 0.2665796165243993, 'psi': 0.8179558969182572}-{'f1_val': 0.7006809596653347, 'auprc': 0.9951038034869826, 'loss_val': 0.2698951529588962, 'psi': 0.8184500971939939}
[S4] START round=20 head_norm_before_train=1.422604 cos_to_last_merge=1.0000 (last merge round=19)
[S4] round=20 local utility u=0.000000 metrics={'f1_val': 0.9559686545424034, 'auprc': 0.9499549113543155, 'loss_val': 0.3531591309334434, 'psi': 0.9535631572671683}-{'f1_val': 0.9552941773525605, 'auprc': 0.9537726855474684, 'loss_val': 0.33871351728199256, 'psi': 0.9546855806305237}
[S5] START round=20 head_norm_before_train=1.004560 cos_to_last_merge=1.0000 (last merge round=19)
[S5] round=20 local utility u=0.000000 metrics={'f1_val': 0.700980318587248, 'auprc': 0.8627437071456243, 'loss_val': 0.5450273940314656, 'psi': 0.7656856740105985}-{'f1_val': 0.7003213174339138, 'auprc': 0.989895871680132, 'loss_val': 0.5356478205103635, 'psi': 0.816151139132401}
[S6] START round=20 head_norm_before_train=1.014333 cos_to_last_merge=1.0000 (last merge round=19)
[S6] round=20 local utility u=0.349885 metrics={'f1_val': 0.8267310892272387, 'auprc': 0.9605845991467277, 'loss_val': 0.4792676746739116, 'psi': 0.8802724931950343}-{'f1_val': 0.7580663098679394, 'auprc': 0.8995740681289133, 'loss_val': 0.5840180247775449, 'psi': 0.8146694131723289}
[S7] START round=20 head_norm_before_train=1.724302 cos_to_last_merge=1.0000 (last merge round=19)
[S7] round=20 local utility u=0.000000 metrics={'f1_val': 0.46990932854679035, 'auprc': 0.7784534895314767, 'loss_val': 0.8309565931507377, 'psi': 0.5933269929406649}-{'f1_val': 0.6499715417771242, 'auprc': 0.8467384858188146, 'loss_val': 0.640998314775952, 'psi': 0.7286783193938005}
[S8] START round=20 head_norm_before_train=1.747898 cos_to_last_merge=0.8043 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.804
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.9886233041642136, 'loss_val': 0.04394514343851466, 'psi': 0.9912016461824074}-{'f1_val': 0.9924611780272952, 'auprc': 0.9985965448394198, 'loss_val': 0.03851837079533436, 'psi': 0.9949153247521451}
[S9] START round=20 head_norm_before_train=1.632655 cos_to_last_merge=1.0000 (last merge round=19)
[S9] round=20 local utility u=0.083955 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999472013674827, 'loss_val': 0.10073945081987215, 'psi': 0.9977851125582656}-{'f1_val': 0.9774282609880908, 'auprc': 0.9988698233973595, 'loss_val': 0.15145006122025073, 'psi': 0.9860048859517982}
[S10] START round=20 head_norm_before_train=2.046921 (no previous merge yet)
[S10] round=20 local utility u=0.000413 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954183713784629, 'loss_val': 0.030418640695387147, 'psi': 0.9952800519630101}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953688313772835, 'loss_val': 0.031095710214081116, 'psi': 0.9952602359625382}
[S11] START round=20 head_norm_before_train=1.791879 cos_to_last_merge=1.0000 (last merge round=19)
[S11] round=20 local utility u=0.044378 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9970743932591712, 'loss_val': 0.19949290088493776, 'psi': 0.9966128577849851}-{'f1_val': 0.9784215888924677, 'auprc': 0.9968929556827026, 'loss_val': 0.18040297259749097, 'psi': 0.9858101356085617}
[S13] START round=20 head_norm_before_train=1.448814 cos_to_last_merge=0.8284 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.828
[S13] round=20 local utility u=0.042179 metrics={'f1_val': 0.6675281717651278, 'auprc': 0.9375263275600427, 'loss_val': 0.3942508584968036, 'psi': 0.7755274340830938}-{'f1_val': 0.6589238944104011, 'auprc': 0.9433853878684715, 'loss_val': 0.44455943299078665, 'psi': 0.7727084917936293}
[S14] START round=20 head_norm_before_train=1.099026 cos_to_last_merge=1.0000 (last merge round=19)
[S14] round=20 local utility u=0.011269 metrics={'f1_val': 0.6921021147308503, 'auprc': 0.9955976706900969, 'loss_val': 0.584881767192407, 'psi': 0.8135003371145489}-{'f1_val': 0.6911189050402049, 'auprc': 0.993998470407799, 'loss_val': 0.5967229954487112, 'psi': 0.8122707311872426}
[S15] START round=20 head_norm_before_train=1.995949 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.9002173942340892, 'auprc': 0.9953111892426698, 'loss_val': 0.20096374463539163, 'psi': 0.9382549122375214}-{'f1_val': 0.8995816471907147, 'auprc': 0.9957437998131569, 'loss_val': 0.16795384382960765, 'psi': 0.9380465082396915}
[S16] START round=20 head_norm_before_train=1.158043 cos_to_last_merge=0.9978 (last merge round=18)
[S16] round=20 local utility u=0.137055 metrics={'f1_val': 0.820361524534165, 'auprc': 0.9118535671270264, 'loss_val': 0.4973023915248727, 'psi': 0.8569583415713096}-{'f1_val': 0.830808626522348, 'auprc': 0.8643504640643991, 'loss_val': 0.6915847674359441, 'psi': 0.8442253615391684}
[S17] START round=20 head_norm_before_train=1.647964 cos_to_last_merge=0.8699 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.6488167321054334, 'auprc': 0.8206048708365139, 'loss_val': 1.0756565838871157, 'psi': 0.7175319875978656}-{'f1_val': 0.6684840236031051, 'auprc': 0.8370185556042732, 'loss_val': 1.015732154215458, 'psi': 0.7358978364035723}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:58311
[S11] sending update (kind=head size=1804 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.3199
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0799
[S10] DROPPED delta from S13 (cos=-0.0799 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.8001
[S5] RECEIVED delta(kind=head bytes=1798) from S3
[S5] cosine check vs S3: cos=0.7947
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=0.7620
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] cosine check vs S14: cos=0.5967
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.0788
[S5] DROPPED delta from S10 (cos=-0.0788 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.7551
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=0.042 → S7@127.0.0.1:58308
[S2] ⇄ pheromone p=0.125 → S5@127.0.0.1:58305
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=20 metric=0.9560 head_norm=1.478995
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.847876e-01
[S4] stored merged vector for next round verification (round=20)
[S4] DEBUG after merge:  round=20 metric=0.9564 head_norm=1.215369 delta_norm=0.484788
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.186 → S11@127.0.0.1:58312
[S7] ⇄ pheromone p=0.249 → S14@127.0.0.1:58314
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=20 metric=0.7010 head_norm=1.035002
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.839315e-01
[S5] stored merged vector for next round verification (round=20)
[S5] DEBUG after merge:  round=20 metric=0.7003 head_norm=1.084308 delta_norm=0.283931
[S5] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.181 → S16@127.0.0.1:58316
[S11] ⇄ pheromone p=0.250 → S14@127.0.0.1:58314
[S13] ⇄ pheromone p=0.131 → S10@127.0.0.1:58311
[S9] ⇄ pheromone p=0.284 → S14@127.0.0.1:58314
[S10] ⇄ pheromone p=0.039 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.290 → S6@127.0.0.1:58307
[S3] ⇄ pheromone p=0.079 → S5@127.0.0.1:58305
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=20 metric=0.8267 head_norm=1.112139
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.694786e-01
[S6] stored merged vector for next round verification (round=20)
[S6] DEBUG after merge:  round=20 metric=0.8488 head_norm=1.100443 delta_norm=0.369479
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.425 → S4@127.0.0.1:58304
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=20 metric=0.6921 head_norm=1.127883
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.934199e-01
[S14] stored merged vector for next round verification (round=20)
[S14] DEBUG after merge:  round=20 metric=0.6917 head_norm=1.111396 delta_norm=0.393420
[S14] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.143 → S5@127.0.0.1:58305
[S15] ⇄ pheromone p=0.299 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.156 → S9@127.0.0.1:58310
[S2] START round=21 head_norm_before_train=1.729189 cos_to_last_merge=0.8320 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.832
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.7110993656874638, 'auprc': 0.7283767886561061, 'loss_val': 0.9519311001129942, 'psi': 0.7180103348749207}-{'f1_val': 0.7150411208627725, 'auprc': 0.7327767572729803, 'loss_val': 0.8948702645097204, 'psi': 0.7221353754268556}
[S3] START round=21 head_norm_before_train=1.816037 (no previous merge yet)
[S3] round=21 local utility u=0.002021 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9935734408574051, 'loss_val': 0.26149591133579486, 'psi': 0.8178830985841419}-{'f1_val': 0.7010863553524592, 'auprc': 0.9932602092669539, 'loss_val': 0.2665796165243993, 'psi': 0.8179558969182572}
[S4] START round=21 head_norm_before_train=1.215369 cos_to_last_merge=1.0000 (last merge round=20)
[S4] round=21 local utility u=0.000000 metrics={'f1_val': 0.9543738845036948, 'auprc': 0.9432077026474418, 'loss_val': 0.38752396478814133, 'psi': 0.9499074117611936}-{'f1_val': 0.9559686545424034, 'auprc': 0.9499549113543155, 'loss_val': 0.3531591309334434, 'psi': 0.9535631572671683}
[S5] START round=21 head_norm_before_train=1.084308 cos_to_last_merge=1.0000 (last merge round=20)
[S5] round=21 local utility u=0.159350 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9691385289468523, 'loss_val': 0.541554131270462, 'psi': 0.8078477706735563}-{'f1_val': 0.700980318587248, 'auprc': 0.8627437071456243, 'loss_val': 0.5450273940314656, 'psi': 0.7656856740105985}
[S6] START round=21 head_norm_before_train=1.100443 cos_to_last_merge=1.0000 (last merge round=20)
[S6] round=21 local utility u=0.000000 metrics={'f1_val': 0.6711405654616905, 'auprc': 0.8943470821585386, 'loss_val': 0.678693865006233, 'psi': 0.7604231721404298}-{'f1_val': 0.8267310892272387, 'auprc': 0.9605845991467277, 'loss_val': 0.4792676746739116, 'psi': 0.8802724931950343}
[S7] START round=21 head_norm_before_train=1.738131 cos_to_last_merge=0.9999 (last merge round=19)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.4180280601631731, 'auprc': 0.7757396265945655, 'loss_val': 0.9836951974022901, 'psi': 0.5611126867357301}-{'f1_val': 0.46990932854679035, 'auprc': 0.7784534895314767, 'loss_val': 0.8309565931507377, 'psi': 0.5933269929406649}
[S8] START round=21 head_norm_before_train=1.762945 cos_to_last_merge=0.8023 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.9853820930993438, 'auprc': 0.9973842635084613, 'loss_val': 0.05074227562737963, 'psi': 0.9901829612629909}-{'f1_val': 0.9929205408612032, 'auprc': 0.9886233041642136, 'loss_val': 0.04394514343851466, 'psi': 0.9912016461824074}
[S9] START round=21 head_norm_before_train=1.656828 cos_to_last_merge=0.9997 (last merge round=19)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9985930320748881, 'loss_val': 0.08578874072562193, 'psi': 0.9949413546274782}-{'f1_val': 0.9966605118138915, 'auprc': 0.999472013674827, 'loss_val': 0.10073945081987215, 'psi': 0.9977851125582656}
[S10] START round=21 head_norm_before_train=2.063985 (no previous merge yet)
[S10] round=21 local utility u=0.000865 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995652278892832, 'loss_val': 0.02938940659396201, 'psi': 0.9953736149687576}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954183713784629, 'loss_val': 0.030418640695387147, 'psi': 0.9952800519630101}
[S11] START round=21 head_norm_before_train=1.818591 cos_to_last_merge=0.9997 (last merge round=19)
[S11] round=21 local utility u=0.032970 metrics={'f1_val': 0.9962850284706224, 'auprc': 0.9972961359143303, 'loss_val': 0.134096355002175, 'psi': 0.9966894714481056}-{'f1_val': 0.996305167468861, 'auprc': 0.9970743932591712, 'loss_val': 0.19949290088493776, 'psi': 0.9966128577849851}
[S13] START round=21 head_norm_before_train=1.460317 cos_to_last_merge=0.8261 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.826
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5814204891621823, 'auprc': 0.7564745060211411, 'loss_val': 0.8181562077590802, 'psi': 0.6514420959057659}-{'f1_val': 0.6675281717651278, 'auprc': 0.9375263275600427, 'loss_val': 0.3942508584968036, 'psi': 0.7755274340830938}
[S14] START round=21 head_norm_before_train=1.111396 cos_to_last_merge=1.0000 (last merge round=20)
[S14] round=21 local utility u=0.006578 metrics={'f1_val': 0.6916071808883436, 'auprc': 0.9928230388046029, 'loss_val': 0.560432750722099, 'psi': 0.8120935240548472}-{'f1_val': 0.6921021147308503, 'auprc': 0.9955976706900969, 'loss_val': 0.584881767192407, 'psi': 0.8135003371145489}
[S15] START round=21 head_norm_before_train=2.007576 (no previous merge yet)
[S15] round=21 local utility u=0.018329 metrics={'f1_val': 0.90022336498052, 'auprc': 0.995015962729054, 'loss_val': 0.1634550044942767, 'psi': 0.9381404040799337}-{'f1_val': 0.9002173942340892, 'auprc': 0.9953111892426698, 'loss_val': 0.20096374463539163, 'psi': 0.9382549122375214}
[S16] START round=21 head_norm_before_train=1.207529 cos_to_last_merge=0.9921 (last merge round=18)
[S16] round=21 local utility u=0.463879 metrics={'f1_val': 0.9305681696515605, 'auprc': 0.9624659183696335, 'loss_val': 0.38262046387450077, 'psi': 0.9433272691387897}-{'f1_val': 0.820361524534165, 'auprc': 0.9118535671270264, 'loss_val': 0.4973023915248727, 'psi': 0.8569583415713096}
[S17] START round=21 head_norm_before_train=1.666009 cos_to_last_merge=0.8681 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=21 local utility u=0.057107 metrics={'f1_val': 0.6588867298017994, 'auprc': 0.8271780176946175, 'loss_val': 1.041581636461547, 'psi': 0.7262032449589266}-{'f1_val': 0.6488167321054334, 'auprc': 0.8206048708365139, 'loss_val': 1.0756565838871157, 'psi': 0.7175319875978656}
[S10] not sending this round → trigger blocked (psi=0.995)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:58316
[S11] not sending this round → trigger blocked (psi=0.997)
[S16] not sending this round → trigger blocked (psi=0.943)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → trigger blocked (psi=0.812)
[S3] not sending this round → trigger blocked (psi=0.818)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1796) from S5
[S16] cosine check vs S5: cos=0.7915
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.2373
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.9945
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=21 metric=0.9925 head_norm=1.683090
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.817193e-02
[S9] stored merged vector for next round verification (round=21)
[S9] DEBUG after merge:  round=21 metric=0.9917 head_norm=1.680982 delta_norm=0.088172
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=21 metric=0.7003 head_norm=1.109244
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.032756e+00
[S5] stored merged vector for next round verification (round=21)
[S5] DEBUG after merge:  round=21 metric=0.7006 head_norm=1.264765 delta_norm=1.032756
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=21 metric=0.9306 head_norm=1.256658
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.882718e-01
[S16] stored merged vector for next round verification (round=21)
[S16] DEBUG after merge:  round=21 metric=0.9082 head_norm=1.119844 delta_norm=0.388272
[S16] aggregate: ROLLBACK (f1_val pre=0.931 post=0.908 tol_abs=0.005 tol_rel=0.0)
[S2] START round=22 head_norm_before_train=1.751255 cos_to_last_merge=0.8305 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.830
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.6866078817319056, 'auprc': 0.7290166390047284, 'loss_val': 1.0340688323226714, 'psi': 0.7035713846410347}-{'f1_val': 0.7110993656874638, 'auprc': 0.7283767886561061, 'loss_val': 0.9519311001129942, 'psi': 0.7180103348749207}
[S3] START round=22 head_norm_before_train=1.826971 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7005813959920884, 'auprc': 0.9932789333436151, 'loss_val': 0.26664802232039375, 'psi': 0.817660410932699}-{'f1_val': 0.7007562037352997, 'auprc': 0.9935734408574051, 'loss_val': 0.26149591133579486, 'psi': 0.8178830985841419}
[S4] START round=22 head_norm_before_train=1.290456 cos_to_last_merge=0.9957 (last merge round=20)
[S4] round=22 local utility u=0.041928 metrics={'f1_val': 0.957293975651858, 'auprc': 0.9452942620631899, 'loss_val': 0.3274490061174884, 'psi': 0.9524940902163908}-{'f1_val': 0.9543738845036948, 'auprc': 0.9432077026474418, 'loss_val': 0.38752396478814133, 'psi': 0.9499074117611936}
[S5] START round=22 head_norm_before_train=1.264765 cos_to_last_merge=1.0000 (last merge round=21)
[S5] round=22 local utility u=0.100816 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9880338520451588, 'loss_val': 0.39661196395095555, 'psi': 0.8154063312784118}-{'f1_val': 0.700320598491359, 'auprc': 0.9691385289468523, 'loss_val': 0.541554131270462, 'psi': 0.8078477706735563}
[S6] START round=22 head_norm_before_train=1.200890 cos_to_last_merge=0.9829 (last merge round=20)
[S6] round=22 local utility u=0.000000 metrics={'f1_val': 0.6137344930286786, 'auprc': 0.9486037072787892, 'loss_val': 0.7014635565301641, 'psi': 0.7476821787287229}-{'f1_val': 0.6711405654616905, 'auprc': 0.8943470821585386, 'loss_val': 0.678693865006233, 'psi': 0.7604231721404298}
[S7] START round=22 head_norm_before_train=1.750201 cos_to_last_merge=0.9997 (last merge round=19)
[S7] round=22 local utility u=1.000000 metrics={'f1_val': 0.6635616686265762, 'auprc': 0.8439273958584461, 'loss_val': 0.5098777900951115, 'psi': 0.7357079595193241}-{'f1_val': 0.4180280601631731, 'auprc': 0.7757396265945655, 'loss_val': 0.9836951974022901, 'psi': 0.5611126867357301}
[S8] START round=22 head_norm_before_train=1.772829 cos_to_last_merge=0.8016 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.802
[S8] round=22 local utility u=0.030404 metrics={'f1_val': 0.9929762634442646, 'auprc': 0.9976617266197043, 'loss_val': 0.036331349854811366, 'psi': 0.9948504487144405}-{'f1_val': 0.9853820930993438, 'auprc': 0.9973842635084613, 'loss_val': 0.05074227562737963, 'psi': 0.9901829612629909}
[S9] START round=22 head_norm_before_train=1.680982 cos_to_last_merge=1.0000 (last merge round=21)
[S9] round=22 local utility u=0.021816 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987461023688923, 'loss_val': 0.06753806161976411, 'psi': 0.9974947480358918}-{'f1_val': 0.9925069029958717, 'auprc': 0.9985930320748881, 'loss_val': 0.08578874072562193, 'psi': 0.9949413546274782}
[S10] START round=22 head_norm_before_train=2.083230 (no previous merge yet)
[S10] round=22 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9934448520062316, 'loss_val': 0.028986191979563897, 'psi': 0.9944906442141175}-{'f1_val': 0.9951878390193748, 'auprc': 0.995652278892832, 'loss_val': 0.02938940659396201, 'psi': 0.9953736149687576}
[S11] START round=22 head_norm_before_train=1.846131 cos_to_last_merge=0.9989 (last merge round=19)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.8962494157174585, 'auprc': 0.9899611857081205, 'loss_val': 0.4057942730381493, 'psi': 0.9337341237137233}-{'f1_val': 0.9962850284706224, 'auprc': 0.9972961359143303, 'loss_val': 0.134096355002175, 'psi': 0.9966894714481056}
[S13] START round=22 head_norm_before_train=1.466277 cos_to_last_merge=0.8266 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=22 local utility u=0.081276 metrics={'f1_val': 0.584956282617158, 'auprc': 0.7566315517325946, 'loss_val': 0.6772905711621747, 'psi': 0.6536263902633326}-{'f1_val': 0.5814204891621823, 'auprc': 0.7564745060211411, 'loss_val': 0.8181562077590802, 'psi': 0.6514420959057659}
[S14] START round=22 head_norm_before_train=1.143484 cos_to_last_merge=0.9987 (last merge round=20)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.6487154109711719, 'auprc': 0.9965456754041262, 'loss_val': 0.5429605759182818, 'psi': 0.7878475167443537}-{'f1_val': 0.6916071808883436, 'auprc': 0.9928230388046029, 'loss_val': 0.560432750722099, 'psi': 0.8120935240548472}
[S15] START round=22 head_norm_before_train=2.025342 (no previous merge yet)
[S15] round=22 local utility u=0.077777 metrics={'f1_val': 0.9158529121554503, 'auprc': 0.9927468892881639, 'loss_val': 0.09487094286768286, 'psi': 0.9466105030085357}-{'f1_val': 0.90022336498052, 'auprc': 0.995015962729054, 'loss_val': 0.1634550044942767, 'psi': 0.9381404040799337}
[S16] START round=22 head_norm_before_train=1.119844 cos_to_last_merge=1.0000 (last merge round=21)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.877309961267734, 'auprc': 0.9849533600719947, 'loss_val': 0.49044004638121297, 'psi': 0.9203673207894383}-{'f1_val': 0.9305681696515605, 'auprc': 0.9624659183696335, 'loss_val': 0.38262046387450077, 'psi': 0.9433272691387897}
[S17] START round=22 head_norm_before_train=1.683495 cos_to_last_merge=0.8670 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.867
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.6259862428789595, 'auprc': 0.8284063167531062, 'loss_val': 1.1316809036986826, 'psi': 0.7069542724286182}-{'f1_val': 0.6588867298017994, 'auprc': 0.8271780176946175, 'loss_val': 1.041581636461547, 'psi': 0.7262032449589266}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.947)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:58312
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S5] not sending this round → trigger blocked (psi=0.815)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:58311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S13] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0824
[S10] DROPPED delta from S13 (cos=-0.0824 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.3500
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=0.5307
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9973
[S11] RECEIVED delta(kind=head bytes=1800) from S4
[S11] cosine check vs S4: cos=0.8922
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.8962 head_norm=1.871293
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.472562e-01
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.8954 head_norm=1.580724 delta_norm=0.447256
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=22 metric=0.6487 head_norm=1.178765
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.401945e-01
[S14] stored merged vector for next round verification (round=22)
[S14] DEBUG after merge:  round=22 metric=0.6439 head_norm=1.090549 delta_norm=0.540194
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=22 metric=0.6636 head_norm=1.760708
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.654412e-02
[S7] stored merged vector for next round verification (round=22)
[S7] DEBUG after merge:  round=22 metric=0.6636 head_norm=1.771749 delta_norm=0.066544
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.778012 cos_to_last_merge=0.8283 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.828
[S2] round=23 local utility u=0.111369 metrics={'f1_val': 0.7173550803835939, 'auprc': 0.7268577519368227, 'loss_val': 0.9893376493228816, 'psi': 0.7211561490048854}-{'f1_val': 0.6866078817319056, 'auprc': 0.7290166390047284, 'loss_val': 1.0340688323226714, 'psi': 0.7035713846410347}
[S3] START round=23 head_norm_before_train=1.837746 (no previous merge yet)
[S3] round=23 local utility u=0.007869 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9944790510668664, 'loss_val': 0.256011789897326, 'psi': 0.818290661442033}-{'f1_val': 0.7005813959920884, 'auprc': 0.9932789333436151, 'loss_val': 0.26664802232039375, 'psi': 0.817660410932699}
[S4] START round=23 head_norm_before_train=1.376849 cos_to_last_merge=0.9851 (last merge round=20)
[S4] round=23 local utility u=0.001313 metrics={'f1_val': 0.9549595734561035, 'auprc': 0.9444192732838151, 'loss_val': 0.30819085152638465, 'psi': 0.9507434533871881}-{'f1_val': 0.957293975651858, 'auprc': 0.9452942620631899, 'loss_val': 0.3274490061174884, 'psi': 0.9524940902163908}
[S5] START round=23 head_norm_before_train=1.291977 cos_to_last_merge=0.9990 (last merge round=21)
[S5] round=23 local utility u=0.030689 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9900006653760309, 'loss_val': 0.34113506836501734, 'psi': 0.8161930566107607}-{'f1_val': 0.7003213174339138, 'auprc': 0.9880338520451588, 'loss_val': 0.39661196395095555, 'psi': 0.8154063312784118}
[S6] START round=23 head_norm_before_train=1.320145 cos_to_last_merge=0.9527 (last merge round=20)
[S6] round=23 local utility u=0.945609 metrics={'f1_val': 0.8661871170927582, 'auprc': 0.9671175833872501, 'loss_val': 0.3805025568846208, 'psi': 0.906559303610555}-{'f1_val': 0.6137344930286786, 'auprc': 0.9486037072787892, 'loss_val': 0.7014635565301641, 'psi': 0.7476821787287229}
[S7] START round=23 head_norm_before_train=1.771749 cos_to_last_merge=1.0000 (last merge round=22)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.4036845772762189, 'auprc': 0.7757447760158366, 'loss_val': 0.9564632707647349, 'psi': 0.552508656772066}-{'f1_val': 0.6635616686265762, 'auprc': 0.8439273958584461, 'loss_val': 0.5098777900951115, 'psi': 0.7357079595193241}
[S8] START round=23 head_norm_before_train=1.785203 cos_to_last_merge=0.8004 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.800
[S8] round=23 local utility u=0.005553 metrics={'f1_val': 0.9942164279160668, 'auprc': 0.9982665029408061, 'loss_val': 0.034481249952920595, 'psi': 0.9958364579259625}-{'f1_val': 0.9929762634442646, 'auprc': 0.9976617266197043, 'loss_val': 0.036331349854811366, 'psi': 0.9948504487144405}
[S9] START round=23 head_norm_before_train=1.708225 cos_to_last_merge=0.9996 (last merge round=21)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.998237047354927, 'loss_val': 0.06473034702795612, 'psi': 0.9940413070788612}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987461023688923, 'loss_val': 0.06753806161976411, 'psi': 0.9974947480358918}
[S10] START round=23 head_norm_before_train=2.095313 (no previous merge yet)
[S10] round=23 local utility u=0.003192 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954148151324785, 'loss_val': 0.0285111470370508, 'psi': 0.9952786294646163}-{'f1_val': 0.9951878390193748, 'auprc': 0.9934448520062316, 'loss_val': 0.028986191979563897, 'psi': 0.9944906442141175}
[S11] START round=23 head_norm_before_train=1.580724 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.445706 metrics={'f1_val': 0.9954436118304585, 'auprc': 0.997226181562503, 'loss_val': 0.1313421251908904, 'psi': 0.9961566397232763}-{'f1_val': 0.8962494157174585, 'auprc': 0.9899611857081205, 'loss_val': 0.4057942730381493, 'psi': 0.9337341237137233}
[S13] START round=23 head_norm_before_train=1.464526 cos_to_last_merge=0.8275 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.827
[S13] round=23 local utility u=0.006018 metrics={'f1_val': 0.5785362005382838, 'auprc': 0.8151525601514438, 'loss_val': 0.8022979707096428, 'psi': 0.6731827443835479}-{'f1_val': 0.584956282617158, 'auprc': 0.7566315517325946, 'loss_val': 0.6772905711621747, 'psi': 0.6536263902633326}
[S14] START round=23 head_norm_before_train=1.090549 cos_to_last_merge=1.0000 (last merge round=22)
[S14] round=23 local utility u=0.115461 metrics={'f1_val': 0.6916605512049091, 'auprc': 0.993686018334884, 'loss_val': 0.5611308920359654, 'psi': 0.8124707380568991}-{'f1_val': 0.6487154109711719, 'auprc': 0.9965456754041262, 'loss_val': 0.5429605759182818, 'psi': 0.7878475167443537}
[S15] START round=23 head_norm_before_train=2.043190 (no previous merge yet)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.9008967941393231, 'auprc': 0.9937282603796924, 'loss_val': 0.17213704005217711, 'psi': 0.9380293806354709}-{'f1_val': 0.9158529121554503, 'auprc': 0.9927468892881639, 'loss_val': 0.09487094286768286, 'psi': 0.9466105030085357}
[S16] START round=23 head_norm_before_train=1.168901 cos_to_last_merge=0.9981 (last merge round=21)
[S16] round=23 local utility u=0.368293 metrics={'f1_val': 0.9732930196930765, 'auprc': 0.9814979750966875, 'loss_val': 0.3193856379007169, 'psi': 0.976575001854521}-{'f1_val': 0.877309961267734, 'auprc': 0.9849533600719947, 'loss_val': 0.49044004638121297, 'psi': 0.9203673207894383}
[S17] START round=23 head_norm_before_train=1.706114 cos_to_last_merge=0.8655 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=23 local utility u=0.133140 metrics={'f1_val': 0.6352728588102583, 'auprc': 0.8531941614986189, 'loss_val': 0.9954833745255713, 'psi': 0.7224413798856025}-{'f1_val': 0.6259862428789595, 'auprc': 0.8284063167531062, 'loss_val': 1.1316809036986826, 'psi': 0.7069542724286182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S16@127.0.0.1:58316
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] → sending delta(kind=head bytes=1805) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[S6] sending update (kind=head size=1803 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S4
[S11] cosine check vs S4: cos=0.9627
[S4] RECEIVED delta(kind=head bytes=1803) from S6
[S4] cosine check vs S6: cos=0.8372
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=-0.0853
[S10] DROPPED delta from S13 (cos=-0.0853 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=0.9990
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.8281
[S5] RECEIVED delta(kind=head bytes=1800) from S14
[S5] cosine check vs S14: cos=0.3178
[S5] RECEIVED delta(kind=head bytes=1805) from S3
[S5] cosine check vs S3: cos=0.4162
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] cosine check vs S10: cos=-0.1040
[S5] DROPPED delta from S10 (cos=-0.1040 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S2
[S5] cosine check vs S2: cos=-0.1173
[S5] DROPPED delta from S2 (cos=-0.1173 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S11
[S14] cosine check vs S11: cos=0.5109
[S16] RECEIVED delta(kind=head bytes=1804) from S5
[S16] cosine check vs S5: cos=0.8462
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1802) from S17
[S9] cosine check vs S17: cos=0.9931
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=23 metric=0.9912 head_norm=1.735070
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.020610e-01
[S9] stored merged vector for next round verification (round=23)
[S9] DEBUG after merge:  round=23 metric=0.9912 head_norm=1.736919 delta_norm=0.102061
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=23 metric=0.4037 head_norm=1.778159
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.093561e-02
[S7] stored merged vector for next round verification (round=23)
[S7] DEBUG after merge:  round=23 metric=0.4026 head_norm=1.788002 delta_norm=0.040936
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=23 metric=0.8662 head_norm=1.407504
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.956462e-01
[S6] stored merged vector for next round verification (round=23)
[S6] DEBUG after merge:  round=23 metric=0.8632 head_norm=1.259255 delta_norm=0.395646
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=23 metric=0.7003 head_norm=1.316339
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.532254e-01
[S5] stored merged vector for next round verification (round=23)
[S5] DEBUG after merge:  round=23 metric=0.7003 head_norm=1.080786 delta_norm=0.653225
[S5] aggregate: ACCEPT kept=['S14', 'S3'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=23 metric=0.9733 head_norm=1.226153
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.551469e-01
[S16] stored merged vector for next round verification (round=23)
[S16] DEBUG after merge:  round=23 metric=0.9521 head_norm=1.221463 delta_norm=0.355147
[S16] aggregate: ROLLBACK (f1_val pre=0.973 post=0.952 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=23 metric=0.6917 head_norm=1.120316
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.048461e-01
[S14] stored merged vector for next round verification (round=23)
[S14] DEBUG after merge:  round=23 metric=0.6917 head_norm=1.188965 delta_norm=0.704846
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=23 metric=0.9550 head_norm=1.438063
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.061531e-01
[S4] stored merged vector for next round verification (round=23)
[S4] DEBUG after merge:  round=23 metric=0.9556 head_norm=1.363666 delta_norm=0.406153
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9954 head_norm=1.601807
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.227471e-01
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9887 head_norm=1.505752 delta_norm=0.222747
[S11] aggregate: ROLLBACK (f1_val pre=0.995 post=0.989 tol_abs=0.005 tol_rel=0.0)
[S2] START round=24 head_norm_before_train=1.793753 cos_to_last_merge=0.8263 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.826
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.7187906290830746, 'auprc': 0.7239620525678749, 'loss_val': 0.9995279691522769, 'psi': 0.7208591984769948}-{'f1_val': 0.7173550803835939, 'auprc': 0.7268577519368227, 'loss_val': 0.9893376493228816, 'psi': 0.7211561490048854}
[S3] START round=24 head_norm_before_train=1.850993 (no previous merge yet)
[S3] round=24 local utility u=0.005337 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.9951705644020402, 'loss_val': 0.24741270897191286, 'psi': 0.8185672667761026}-{'f1_val': 0.7008317350254774, 'auprc': 0.9944790510668664, 'loss_val': 0.256011789897326, 'psi': 0.818290661442033}
[S4] START round=24 head_norm_before_train=1.363666 cos_to_last_merge=1.0000 (last merge round=23)
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9565215396769, 'auprc': 0.8989581268114705, 'loss_val': 0.32268329615702335, 'psi': 0.9334961745307282}-{'f1_val': 0.9549595734561035, 'auprc': 0.9444192732838151, 'loss_val': 0.30819085152638465, 'psi': 0.9507434533871881}
[S5] START round=24 head_norm_before_train=1.080786 cos_to_last_merge=1.0000 (last merge round=23)
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9554908312929531, 'loss_val': 0.4266255784756414, 'psi': 0.8023886916119967}-{'f1_val': 0.7003213174339138, 'auprc': 0.9900006653760309, 'loss_val': 0.34113506836501734, 'psi': 0.8161930566107607}
[S6] START round=24 head_norm_before_train=1.259255 cos_to_last_merge=1.0000 (last merge round=23)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.8238595540082464, 'auprc': 0.9651876207370665, 'loss_val': 0.4170845188553865, 'psi': 0.8803907806997744}-{'f1_val': 0.8661871170927582, 'auprc': 0.9671175833872501, 'loss_val': 0.3805025568846208, 'psi': 0.906559303610555}
[S7] START round=24 head_norm_before_train=1.788002 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=24 local utility u=0.906338 metrics={'f1_val': 0.6456427679170813, 'auprc': 0.7849718780260976, 'loss_val': 0.6232179520656516, 'psi': 0.7013744119606878}-{'f1_val': 0.4036845772762189, 'auprc': 0.7757447760158366, 'loss_val': 0.9564632707647349, 'psi': 0.552508656772066}
[S8] START round=24 head_norm_before_train=1.798722 cos_to_last_merge=0.7991 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9829227792597723, 'auprc': 0.99576476834593, 'loss_val': 0.05466313863093151, 'psi': 0.9880595748942353}-{'f1_val': 0.9942164279160668, 'auprc': 0.9982665029408061, 'loss_val': 0.034481249952920595, 'psi': 0.9958364579259625}
[S9] START round=24 head_norm_before_train=1.736919 cos_to_last_merge=1.0000 (last merge round=23)
[S9] round=24 local utility u=0.019550 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.996165443085359, 'loss_val': 0.05210479734115123, 'psi': 0.996481671993001}-{'f1_val': 0.9912441468948172, 'auprc': 0.998237047354927, 'loss_val': 0.06473034702795612, 'psi': 0.9940413070788612}
[S10] START round=24 head_norm_before_train=2.109491 (no previous merge yet)
[S10] round=24 local utility u=0.000000 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9956731735903065, 'loss_val': 0.0273399369910195, 'psi': 0.9951184349677461}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954148151324785, 'loss_val': 0.0285111470370508, 'psi': 0.9952786294646163}
[S11] START round=24 head_norm_before_train=1.505752 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977980678566732, 'loss_val': 0.1481396933178546, 'psi': 0.9970474298508231}-{'f1_val': 0.9954436118304585, 'auprc': 0.997226181562503, 'loss_val': 0.1313421251908904, 'psi': 0.9961566397232763}
[S13] START round=24 head_norm_before_train=1.481143 cos_to_last_merge=0.8226 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.823
[S13] round=24 local utility u=0.130544 metrics={'f1_val': 0.6089907572131246, 'auprc': 0.7709233931016602, 'loss_val': 0.5912497935473204, 'psi': 0.6737638115685388}-{'f1_val': 0.5785362005382838, 'auprc': 0.8151525601514438, 'loss_val': 0.8022979707096428, 'psi': 0.6731827443835479}
[S14] START round=24 head_norm_before_train=1.188965 cos_to_last_merge=1.0000 (last merge round=23)
[S14] round=24 local utility u=0.034081 metrics={'f1_val': 0.6919852790837991, 'auprc': 0.9986014284934556, 'loss_val': 0.5096642588160146, 'psi': 0.8146317388476617}-{'f1_val': 0.6916605512049091, 'auprc': 0.993686018334884, 'loss_val': 0.5611308920359654, 'psi': 0.8124707380568991}
[S15] START round=24 head_norm_before_train=2.061198 (no previous merge yet)
[S15] round=24 local utility u=0.101956 metrics={'f1_val': 0.9217498845524905, 'auprc': 0.9962105445242807, 'loss_val': 0.10079089003832686, 'psi': 0.9515341485412067}-{'f1_val': 0.9008967941393231, 'auprc': 0.9937282603796924, 'loss_val': 0.17213704005217711, 'psi': 0.9380293806354709}
[S16] START round=24 head_norm_before_train=1.221463 cos_to_last_merge=1.0000 (last merge round=23)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.8324938017253124, 'auprc': 0.9854260903889995, 'loss_val': 0.6331977937681883, 'psi': 0.8936667171907873}-{'f1_val': 0.9732930196930765, 'auprc': 0.9814979750966875, 'loss_val': 0.3193856379007169, 'psi': 0.976575001854521}
[S17] START round=24 head_norm_before_train=1.744746 cos_to_last_merge=0.8616 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.6418830065825624, 'auprc': 0.8038028581344725, 'loss_val': 1.2359505983703907, 'psi': 0.7066509472033264}-{'f1_val': 0.6352728588102583, 'auprc': 0.8531941614986189, 'loss_val': 0.9954833745255713, 'psi': 0.7224413798856025}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] → sending delta(kind=head bytes=1806) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1806 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S7
[S14] cosine check vs S7: cos=0.3756
[S10] RECEIVED delta(kind=head bytes=1806) from S13
[S10] cosine check vs S13: cos=-0.0864
[S10] DROPPED delta from S13 (cos=-0.0864 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.7492
[S5] RECEIVED delta(kind=head bytes=1801) from S14
[S5] cosine check vs S14: cos=0.4758
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.5748
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.3488
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=24 metric=0.7003 head_norm=1.110461
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.853607e-01
[S5] stored merged vector for next round verification (round=24)
[S5] DEBUG after merge:  round=24 metric=0.7003 head_norm=1.056104 delta_norm=0.185361
[S5] aggregate: ACCEPT kept=['S3', 'S14', 'S15'] (k=3/3) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=24 metric=0.6920 head_norm=1.220801
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.233774e-01
[S14] stored merged vector for next round verification (round=24)
[S14] DEBUG after merge:  round=24 metric=0.6920 head_norm=1.084018 delta_norm=0.623377
[S14] aggregate: ACCEPT kept=['S7', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.807508 cos_to_last_merge=0.8250 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.825
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.7173202529331391, 'auprc': 0.7249221528900339, 'loss_val': 1.0120407611455964, 'psi': 0.720361012915897}-{'f1_val': 0.7187906290830746, 'auprc': 0.7239620525678749, 'loss_val': 0.9995279691522769, 'psi': 0.7208591984769948}
[S3] START round=25 head_norm_before_train=1.863534 (no previous merge yet)
[S3] round=25 local utility u=0.001274 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9979364650985004, 'loss_val': 0.25225750362078336, 'psi': 0.819583161838601}-{'f1_val': 0.7008317350254774, 'auprc': 0.9951705644020402, 'loss_val': 0.24741270897191286, 'psi': 0.8185672667761026}
[S4] START round=25 head_norm_before_train=1.421834 cos_to_last_merge=0.9983 (last merge round=23)
[S4] round=25 local utility u=0.005777 metrics={'f1_val': 0.955119780378579, 'auprc': 0.8985826604887497, 'loss_val': 0.30159310333022293, 'psi': 0.9325049324226473}-{'f1_val': 0.9565215396769, 'auprc': 0.8989581268114705, 'loss_val': 0.32268329615702335, 'psi': 0.9334961745307282}
[S5] START round=25 head_norm_before_train=1.056104 cos_to_last_merge=1.0000 (last merge round=24)
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8731412546089272, 'loss_val': 0.4426730703897, 'psi': 0.7694488609383863}-{'f1_val': 0.700320598491359, 'auprc': 0.9554908312929531, 'loss_val': 0.4266255784756414, 'psi': 0.8023886916119967}
[S6] START round=25 head_norm_before_train=1.321960 cos_to_last_merge=0.9975 (last merge round=23)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.7114934591645532, 'auprc': 0.9469008290824739, 'loss_val': 0.627473897112198, 'psi': 0.8056564071317215}-{'f1_val': 0.8238595540082464, 'auprc': 0.9651876207370665, 'loss_val': 0.4170845188553865, 'psi': 0.8803907806997744}
[S7] START round=25 head_norm_before_train=1.793008 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=25 local utility u=0.000000 metrics={'f1_val': 0.4448490086459971, 'auprc': 0.7755899536062232, 'loss_val': 0.8923890043131, 'psi': 0.5771453866300875}-{'f1_val': 0.6456427679170813, 'auprc': 0.7849718780260976, 'loss_val': 0.6232179520656516, 'psi': 0.7013744119606878}
[S8] START round=25 head_norm_before_train=1.805300 cos_to_last_merge=0.7987 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.799
[S8] round=25 local utility u=0.000000 metrics={'f1_val': 0.7137538225988359, 'auprc': 0.9617651983242812, 'loss_val': 0.6349366779815534, 'psi': 0.8129583728890141}-{'f1_val': 0.9829227792597723, 'auprc': 0.99576476834593, 'loss_val': 0.05466313863093151, 'psi': 0.9880595748942353}
[S9] START round=25 head_norm_before_train=1.763031 cos_to_last_merge=0.9998 (last merge round=23)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9887042205730695, 'auprc': 0.999019320553848, 'loss_val': 0.060691916378978465, 'psi': 0.9928302605653809}-{'f1_val': 0.9966924912647621, 'auprc': 0.996165443085359, 'loss_val': 0.05210479734115123, 'psi': 0.996481671993001}
[S10] START round=25 head_norm_before_train=2.125885 (no previous merge yet)
[S10] round=25 local utility u=0.000786 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955045238636754, 'loss_val': 0.027897094911928804, 'psi': 0.995314512957095}-{'f1_val': 0.9947486092193725, 'auprc': 0.9956731735903065, 'loss_val': 0.0273399369910195, 'psi': 0.9951184349677461}
[S11] START round=25 head_norm_before_train=1.533352 cos_to_last_merge=0.9996 (last merge round=23)
[S11] round=25 local utility u=0.011517 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977179816104682, 'loss_val': 0.1248644568148457, 'psi': 0.9970153953523411}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977980678566732, 'loss_val': 0.1481396933178546, 'psi': 0.9970474298508231}
[S13] START round=25 head_norm_before_train=1.502230 cos_to_last_merge=0.8191 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.819
[S13] round=25 local utility u=0.280548 metrics={'f1_val': 0.6431965599138599, 'auprc': 0.9199034523370974, 'loss_val': 0.6823291336227576, 'psi': 0.753879316883155}-{'f1_val': 0.6089907572131246, 'auprc': 0.7709233931016602, 'loss_val': 0.5912497935473204, 'psi': 0.6737638115685388}
[S14] START round=25 head_norm_before_train=1.084018 cos_to_last_merge=1.0000 (last merge round=24)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.6912810774996447, 'auprc': 0.9940329365260011, 'loss_val': 0.5567304521538284, 'psi': 0.8123818211101873}-{'f1_val': 0.6919852790837991, 'auprc': 0.9986014284934556, 'loss_val': 0.5096642588160146, 'psi': 0.8146317388476617}
[S15] START round=25 head_norm_before_train=2.080836 (no previous merge yet)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.9017450922433617, 'auprc': 0.9965340973886465, 'loss_val': 0.14450900732323796, 'psi': 0.9396606943014757}-{'f1_val': 0.9217498845524905, 'auprc': 0.9962105445242807, 'loss_val': 0.10079089003832686, 'psi': 0.9515341485412067}
[S16] START round=25 head_norm_before_train=1.277217 cos_to_last_merge=0.9987 (last merge round=23)
[S16] round=25 local utility u=0.676006 metrics={'f1_val': 0.9900775542707734, 'auprc': 0.9826566866618492, 'loss_val': 0.21837932269908886, 'psi': 0.9871092072272036}-{'f1_val': 0.8324938017253124, 'auprc': 0.9854260903889995, 'loss_val': 0.6331977937681883, 'psi': 0.8936667171907873}
[S17] START round=25 head_norm_before_train=1.785962 cos_to_last_merge=0.8566 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=25 local utility u=0.073765 metrics={'f1_val': 0.6181805765296275, 'auprc': 0.840636712116006, 'loss_val': 1.0567070837656811, 'psi': 0.707163030764179}-{'f1_val': 0.6418830065825624, 'auprc': 0.8038028581344725, 'loss_val': 1.2359505983703907, 'psi': 0.7066509472033264}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S11@127.0.0.1:58312
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → trigger blocked (psi=0.820)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → trigger blocked (psi=0.754)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[S10] sending update (kind=head size=1792 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.8687
[S11] RECEIVED delta(kind=head bytes=1795) from S4
[S11] cosine check vs S4: cos=0.9349
[S5] RECEIVED delta(kind=head bytes=1792) from S10
[S5] cosine check vs S10: cos=-0.0848
[S5] DROPPED delta from S10 (cos=-0.0848 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S11
[S14] cosine check vs S11: cos=0.6107
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1799) from S17
[S9] cosine check vs S17: cos=0.9929
[S7] ⇄ pheromone p=0.329 → S14@127.0.0.1:58314
[S5] ⇄ pheromone p=0.087 → S16@127.0.0.1:58316
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=25 metric=0.6913 head_norm=1.107132
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.227902e-01
[S14] stored merged vector for next round verification (round=25)
[S14] DEBUG after merge:  round=25 metric=0.6913 head_norm=1.201324 delta_norm=0.622790
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.068 → S5@127.0.0.1:58305
[S13] ⇄ pheromone p=0.129 → S10@127.0.0.1:58311
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=25 metric=0.9887 head_norm=1.788395
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.083254e-01
[S9] stored merged vector for next round verification (round=25)
[S9] DEBUG after merge:  round=25 metric=0.9887 head_norm=1.799788 delta_norm=0.108325
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.098 → S14@127.0.0.1:58314
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=25 metric=0.7115 head_norm=1.392023
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.499411e-01
[S6] stored merged vector for next round verification (round=25)
[S6] DEBUG after merge:  round=25 metric=0.7211 head_norm=1.314859 delta_norm=0.349941
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.260 → S4@127.0.0.1:58304
[S2] ⇄ pheromone p=0.055 → S5@127.0.0.1:58305
[S3] ⇄ pheromone p=0.028 → S5@127.0.0.1:58305
[S8] ⇄ pheromone p=0.018 → S7@127.0.0.1:58308
[S15] ⇄ pheromone p=0.124 → S5@127.0.0.1:58305
[S10] ⇄ pheromone p=0.013 → S5@127.0.0.1:58305
[S4] ⇄ pheromone p=0.067 → S11@127.0.0.1:58312
[S16] ⇄ pheromone p=0.315 → S6@127.0.0.1:58307
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9965 head_norm=1.560883
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.772072e-01
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9965 head_norm=1.496343 delta_norm=0.277207
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.144 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=0.088 → S9@127.0.0.1:58310
[S2] START round=26 head_norm_before_train=1.826832 cos_to_last_merge=0.8234 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.823
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.710816558099579, 'auprc': 0.7241670982482562, 'loss_val': 1.0670094135331103, 'psi': 0.7161567741590499}-{'f1_val': 0.7173202529331391, 'auprc': 0.7249221528900339, 'loss_val': 1.0120407611455964, 'psi': 0.720361012915897}
[S3] START round=26 head_norm_before_train=1.877698 (no previous merge yet)
[S3] round=26 local utility u=0.014944 metrics={'f1_val': 0.7008362290767893, 'auprc': 0.9954688945567196, 'loss_val': 0.21589859385113516, 'psi': 0.8186892952687614}-{'f1_val': 0.7006809596653347, 'auprc': 0.9979364650985004, 'loss_val': 0.25225750362078336, 'psi': 0.819583161838601}
[S4] START round=26 head_norm_before_train=1.481695 cos_to_last_merge=0.9942 (last merge round=23)
[S4] round=26 local utility u=0.006273 metrics={'f1_val': 0.9553079990846309, 'auprc': 0.8956445452203827, 'loss_val': 0.28136243487362056, 'psi': 0.9314426175389316}-{'f1_val': 0.955119780378579, 'auprc': 0.8985826604887497, 'loss_val': 0.30159310333022293, 'psi': 0.9325049324226473}
[S5] START round=26 head_norm_before_train=1.094624 cos_to_last_merge=0.9982 (last merge round=24)
[S5] round=26 local utility u=0.217454 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9896334572115462, 'loss_val': 0.35724664811609763, 'psi': 0.8160461733449667}-{'f1_val': 0.700320598491359, 'auprc': 0.8731412546089272, 'loss_val': 0.4426730703897, 'psi': 0.7694488609383863}
[S6] START round=26 head_norm_before_train=1.314859 cos_to_last_merge=1.0000 (last merge round=25)
[S6] round=26 local utility u=0.527951 metrics={'f1_val': 0.845492057035117, 'auprc': 0.9645664111857462, 'loss_val': 0.42856082254968114, 'psi': 0.8931217986953686}-{'f1_val': 0.7114934591645532, 'auprc': 0.9469008290824739, 'loss_val': 0.627473897112198, 'psi': 0.8056564071317215}
[S7] START round=26 head_norm_before_train=1.798333 cos_to_last_merge=1.0000 (last merge round=23)
[S7] round=26 local utility u=1.000000 metrics={'f1_val': 0.6694572683470261, 'auprc': 0.8465124806333721, 'loss_val': 0.4400924064944014, 'psi': 0.7402793532615646}-{'f1_val': 0.4448490086459971, 'auprc': 0.7755899536062232, 'loss_val': 0.8923890043131, 'psi': 0.5771453866300875}
[S8] START round=26 head_norm_before_train=1.815797 cos_to_last_merge=0.7978 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.798
[S8] round=26 local utility u=1.000000 metrics={'f1_val': 0.9564000985241939, 'auprc': 0.9957962533936987, 'loss_val': 0.10776935601479332, 'psi': 0.9721585604719958}-{'f1_val': 0.7137538225988359, 'auprc': 0.9617651983242812, 'loss_val': 0.6349366779815534, 'psi': 0.8129583728890141}
[S9] START round=26 head_norm_before_train=1.799788 cos_to_last_merge=1.0000 (last merge round=25)
[S9] round=26 local utility u=0.035697 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994211805669079, 'loss_val': 0.04089586817123223, 'psi': 0.9980302197340488}-{'f1_val': 0.9887042205730695, 'auprc': 0.999019320553848, 'loss_val': 0.060691916378978465, 'psi': 0.9928302605653809}
[S10] START round=26 head_norm_before_train=2.142148 (no previous merge yet)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9949197629570198, 'loss_val': 0.028081477544941457, 'psi': 0.9950806085944328}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955045238636754, 'loss_val': 0.027897094911928804, 'psi': 0.995314512957095}
[S11] START round=26 head_norm_before_train=1.496343 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978056785166725, 'loss_val': 0.1396775355218593, 'psi': 0.9970504741148227}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977179816104682, 'loss_val': 0.1248644568148457, 'psi': 0.9970153953523411}
[S13] START round=26 head_norm_before_train=1.515495 cos_to_last_merge=0.8169 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.817
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.614486531333918, 'auprc': 0.7421027855161935, 'loss_val': 0.6090479883157378, 'psi': 0.6655330330068281}-{'f1_val': 0.6431965599138599, 'auprc': 0.9199034523370974, 'loss_val': 0.6823291336227576, 'psi': 0.753879316883155}
[S14] START round=26 head_norm_before_train=1.201324 cos_to_last_merge=1.0000 (last merge round=25)
[S14] round=26 local utility u=0.031775 metrics={'f1_val': 0.6911969047082253, 'auprc': 0.9949581685424068, 'loss_val': 0.49545043552278917, 'psi': 0.8127014102418979}-{'f1_val': 0.6912810774996447, 'auprc': 0.9940329365260011, 'loss_val': 0.5567304521538284, 'psi': 0.8123818211101873}
[S15] START round=26 head_norm_before_train=2.096457 (no previous merge yet)
[S15] round=26 local utility u=0.341331 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9957897681324034, 'loss_val': 0.02739601945056459, 'psi': 0.9961412154391551}-{'f1_val': 0.9017450922433617, 'auprc': 0.9965340973886465, 'loss_val': 0.14450900732323796, 'psi': 0.9396606943014757}
[S16] START round=26 head_norm_before_train=1.328494 cos_to_last_merge=0.9959 (last merge round=23)
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9365468481154021, 'auprc': 0.9909684056442277, 'loss_val': 0.24770609883624548, 'psi': 0.9583154711269324}-{'f1_val': 0.9900775542707734, 'auprc': 0.9826566866618492, 'loss_val': 0.21837932269908886, 'psi': 0.9871092072272036}
[S17] START round=26 head_norm_before_train=1.817576 cos_to_last_merge=0.8528 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.853
[S17] round=26 local utility u=0.000000 metrics={'f1_val': 0.594204181799026, 'auprc': 0.8134133322179063, 'loss_val': 1.307305706020554, 'psi': 0.6818878419665781}-{'f1_val': 0.6181805765296275, 'auprc': 0.840636712116006, 'loss_val': 1.0567070837656811, 'psi': 0.707163030764179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:58304
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[S4] not sending this round → trigger blocked (psi=0.931)
[S8] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.9993
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.5543
[S5] RECEIVED delta(kind=head bytes=1792) from S14
[S5] cosine check vs S14: cos=0.6168
[S5] RECEIVED delta(kind=head bytes=1797) from S3
[S5] cosine check vs S3: cos=0.7292
[S16] RECEIVED delta(kind=head bytes=1801) from S5
[S16] cosine check vs S5: cos=0.9252
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=0.8033
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.3184
[S14] RECEIVED delta(kind=head bytes=1801) from S7
[S14] cosine check vs S7: cos=0.4088
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=26 metric=0.9553 head_norm=1.541300
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.645858e-01
[S4] stored merged vector for next round verification (round=26)
[S4] DEBUG after merge:  round=26 metric=0.9555 head_norm=1.387996 delta_norm=0.464586
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=26 metric=0.7003 head_norm=1.136904
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.478081e-01
[S5] stored merged vector for next round verification (round=26)
[S5] DEBUG after merge:  round=26 metric=0.7003 head_norm=1.092454 delta_norm=0.147808
[S5] aggregate: ACCEPT kept=['S15', 'S14', 'S3'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=26 metric=0.6695 head_norm=1.805828
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.582451e-02
[S7] stored merged vector for next round verification (round=26)
[S7] DEBUG after merge:  round=26 metric=0.6693 head_norm=1.815222 delta_norm=0.035825
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=26 metric=0.9365 head_norm=1.373768
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.691013e-01
[S16] stored merged vector for next round verification (round=26)
[S16] DEBUG after merge:  round=26 metric=0.9320 head_norm=1.231860 delta_norm=0.269101
[S16] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=26 metric=0.6912 head_norm=1.228269
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.315454e-01
[S14] stored merged vector for next round verification (round=26)
[S14] DEBUG after merge:  round=26 metric=0.6911 head_norm=1.099123 delta_norm=0.631545
[S14] aggregate: ACCEPT kept=['S9', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.850204 cos_to_last_merge=0.8214 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.821
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.7075322376159805, 'auprc': 0.7240644987242122, 'loss_val': 1.1111173807171486, 'psi': 0.7141451420592732}-{'f1_val': 0.710816558099579, 'auprc': 0.7241670982482562, 'loss_val': 1.0670094135331103, 'psi': 0.7161567741590499}
[S3] START round=27 head_norm_before_train=1.891193 (no previous merge yet)
[S3] round=27 local utility u=0.000000 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9976997784963185, 'loss_val': 0.22276368026076124, 'psi': 0.8195336336397072}-{'f1_val': 0.7008362290767893, 'auprc': 0.9954688945567196, 'loss_val': 0.21589859385113516, 'psi': 0.8186892952687614}
[S4] START round=27 head_norm_before_train=1.387996 cos_to_last_merge=1.0000 (last merge round=26)
[S4] round=27 local utility u=0.015367 metrics={'f1_val': 0.9571722980733943, 'auprc': 0.9111016119203856, 'loss_val': 0.30818620734220614, 'psi': 0.9387440236121909}-{'f1_val': 0.9553079990846309, 'auprc': 0.8956445452203827, 'loss_val': 0.28136243487362056, 'psi': 0.9314426175389316}
[S5] START round=27 head_norm_before_train=1.092454 cos_to_last_merge=1.0000 (last merge round=26)
[S5] round=27 local utility u=0.000000 metrics={'f1_val': 0.664206871886856, 'auprc': 0.8589034208918417, 'loss_val': 0.46809920621616397, 'psi': 0.7420854914888503}-{'f1_val': 0.7003213174339138, 'auprc': 0.9896334572115462, 'loss_val': 0.35724664811609763, 'psi': 0.8160461733449667}
[S6] START round=27 head_norm_before_train=1.381716 cos_to_last_merge=0.9967 (last merge round=25)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.798424118583841, 'auprc': 0.9809685633711595, 'loss_val': 0.4416336559855975, 'psi': 0.8714418964987685}-{'f1_val': 0.845492057035117, 'auprc': 0.9645664111857462, 'loss_val': 0.42856082254968114, 'psi': 0.8931217986953686}
[S7] START round=27 head_norm_before_train=1.815222 cos_to_last_merge=1.0000 (last merge round=26)
[S7] round=27 local utility u=0.000000 metrics={'f1_val': 0.6220728957030701, 'auprc': 0.7890049670819068, 'loss_val': 0.6405337305185459, 'psi': 0.6888457242546049}-{'f1_val': 0.6694572683470261, 'auprc': 0.8465124806333721, 'loss_val': 0.4400924064944014, 'psi': 0.7402793532615646}
[S8] START round=27 head_norm_before_train=1.825271 cos_to_last_merge=0.7963 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.796
[S8] round=27 local utility u=0.145622 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9951364741502968, 'loss_val': 0.03841278432063167, 'psi': 0.9942812768420987}-{'f1_val': 0.9564000985241939, 'auprc': 0.9957962533936987, 'loss_val': 0.10776935601479332, 'psi': 0.9721585604719958}
[S9] START round=27 head_norm_before_train=1.819418 cos_to_last_merge=0.9999 (last merge round=25)
[S9] round=27 local utility u=0.002186 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994153733356363, 'loss_val': 0.03650647990561651, 'psi': 0.9980278968415403}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994211805669079, 'loss_val': 0.04089586817123223, 'psi': 0.9980302197340488}
[S10] START round=27 head_norm_before_train=2.148983 (no previous merge yet)
[S10] round=27 local utility u=0.001115 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953966713269008, 'loss_val': 0.02728192462962197, 'psi': 0.9952713719423851}-{'f1_val': 0.9951878390193748, 'auprc': 0.9949197629570198, 'loss_val': 0.028081477544941457, 'psi': 0.9950806085944328}
[S11] START round=27 head_norm_before_train=1.527349 cos_to_last_merge=0.9996 (last merge round=25)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9516863354822407, 'auprc': 0.9976816319545594, 'loss_val': 0.18200507510190056, 'psi': 0.9700844540711682}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978056785166725, 'loss_val': 0.1396775355218593, 'psi': 0.9970504741148227}
[S13] START round=27 head_norm_before_train=1.526620 cos_to_last_merge=0.8168 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.817
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5709584659028275, 'auprc': 0.7407376400056834, 'loss_val': 1.0972429610310184, 'psi': 0.6388701355439699}-{'f1_val': 0.614486531333918, 'auprc': 0.7421027855161935, 'loss_val': 0.6090479883157378, 'psi': 0.6655330330068281}
[S14] START round=27 head_norm_before_train=1.099123 cos_to_last_merge=1.0000 (last merge round=26)
[S14] round=27 local utility u=0.000000 metrics={'f1_val': 0.6919545104764272, 'auprc': 0.9948320047829466, 'loss_val': 0.5224927480304371, 'psi': 0.813105508199035}-{'f1_val': 0.6911969047082253, 'auprc': 0.9949581685424068, 'loss_val': 0.49545043552278917, 'psi': 0.8127014102418979}
[S15] START round=27 head_norm_before_train=2.111699 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.903592774729807, 'auprc': 0.9962770479649212, 'loss_val': 0.13963314494313087, 'psi': 0.9406664840238528}-{'f1_val': 0.9963755136436562, 'auprc': 0.9957897681324034, 'loss_val': 0.02739601945056459, 'psi': 0.9961412154391551}
[S16] START round=27 head_norm_before_train=1.231860 cos_to_last_merge=1.0000 (last merge round=26)
[S16] round=27 local utility u=0.077789 metrics={'f1_val': 0.9579578396568779, 'auprc': 0.9910857019542865, 'loss_val': 0.22094632108060935, 'psi': 0.9712089845758413}-{'f1_val': 0.9365468481154021, 'auprc': 0.9909684056442277, 'loss_val': 0.24770609883624548, 'psi': 0.9583154711269324}
[S17] START round=27 head_norm_before_train=1.851118 cos_to_last_merge=0.8494 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.849
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.5452793737291798, 'auprc': 0.7524881971476814, 'loss_val': 1.8304306404290935, 'psi': 0.6281629030965805}-{'f1_val': 0.594204181799026, 'auprc': 0.8134133322179063, 'loss_val': 1.307305706020554, 'psi': 0.6818878419665781}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:58308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S9
[S14] cosine check vs S9: cos=0.6066
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=0.9058
[S7] RECEIVED delta(kind=head bytes=1802) from S8
[S7] cosine check vs S8: cos=0.9997
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9439
[S5] RECEIVED delta(kind=head bytes=1797) from S10
[S5] cosine check vs S10: cos=-0.0835
[S5] DROPPED delta from S10 (cos=-0.0835 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=27 metric=0.6920 head_norm=1.129232
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.299898e-01
[S14] stored merged vector for next round verification (round=27)
[S14] DEBUG after merge:  round=27 metric=0.6920 head_norm=1.338218 delta_norm=0.729990
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=27 metric=0.7984 head_norm=1.440329
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.419063e-01
[S6] stored merged vector for next round verification (round=27)
[S6] DEBUG after merge:  round=27 metric=0.8051 head_norm=1.336618 delta_norm=0.241906
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9517 head_norm=1.561852
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.313357e-01
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9508 head_norm=1.469198 delta_norm=0.331336
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=27 metric=0.6221 head_norm=1.819985
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.342589e-02
[S7] stored merged vector for next round verification (round=27)
[S7] DEBUG after merge:  round=27 metric=0.6216 head_norm=1.827900 delta_norm=0.023426
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.873522 cos_to_last_merge=0.8197 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.820
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7093321613690707, 'auprc': 0.7233856164349225, 'loss_val': 1.1280282740152539, 'psi': 0.7149535433954115}-{'f1_val': 0.7075322376159805, 'auprc': 0.7240644987242122, 'loss_val': 1.1111173807171486, 'psi': 0.7141451420592732}
[S3] START round=28 head_norm_before_train=1.906595 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984183768715292, 'loss_val': 0.24276092249200484, 'psi': 0.8197759265478126}-{'f1_val': 0.7007562037352997, 'auprc': 0.9976997784963185, 'loss_val': 0.22276368026076124, 'psi': 0.8195336336397072}
[S4] START round=28 head_norm_before_train=1.448196 cos_to_last_merge=0.9981 (last merge round=26)
[S4] round=28 local utility u=0.063329 metrics={'f1_val': 0.9548314882454735, 'auprc': 0.9498310258279136, 'loss_val': 0.28367095230307504, 'psi': 0.9528313032784494}-{'f1_val': 0.9571722980733943, 'auprc': 0.9111016119203856, 'loss_val': 0.30818620734220614, 'psi': 0.9387440236121909}
[S5] START round=28 head_norm_before_train=1.130901 cos_to_last_merge=0.9986 (last merge round=26)
[S5] round=28 local utility u=0.358775 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9797690741218472, 'loss_val': 0.3298293756456261, 'psi': 0.8120999887435543}-{'f1_val': 0.664206871886856, 'auprc': 0.8589034208918417, 'loss_val': 0.46809920621616397, 'psi': 0.7420854914888503}
[S6] START round=28 head_norm_before_train=1.336618 cos_to_last_merge=1.0000 (last merge round=27)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6130746613371567, 'auprc': 0.9513254746837247, 'loss_val': 0.6694437965677685, 'psi': 0.748374986675784}-{'f1_val': 0.798424118583841, 'auprc': 0.9809685633711595, 'loss_val': 0.4416336559855975, 'psi': 0.8714418964987685}
[S7] START round=28 head_norm_before_train=1.827900 cos_to_last_merge=1.0000 (last merge round=27)
[S7] round=28 local utility u=0.318912 metrics={'f1_val': 0.6704089562934914, 'auprc': 0.8388551831817765, 'loss_val': 0.4422775900452966, 'psi': 0.7377874470488055}-{'f1_val': 0.6220728957030701, 'auprc': 0.7890049670819068, 'loss_val': 0.6405337305185459, 'psi': 0.6888457242546049}
[S8] START round=28 head_norm_before_train=1.836079 cos_to_last_merge=0.7949 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.795
[S8] round=28 local utility u=0.009163 metrics={'f1_val': 0.9938326055531397, 'auprc': 0.9986493560736663, 'loss_val': 0.03135348367276866, 'psi': 0.9957593057613504}-{'f1_val': 0.9937111453033, 'auprc': 0.9951364741502968, 'loss_val': 0.03841278432063167, 'psi': 0.9942812768420987}
[S9] START round=28 head_norm_before_train=1.836371 cos_to_last_merge=0.9996 (last merge round=25)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9993466759960014, 'loss_val': 0.03389870498888199, 'psi': 0.9975012878366443}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994153733356363, 'loss_val': 0.03650647990561651, 'psi': 0.9980278968415403}
[S10] START round=28 head_norm_before_train=2.155663 (no previous merge yet)
[S10] round=28 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948759163914045, 'loss_val': 0.027435065286563975, 'psi': 0.9950630699681866}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953966713269008, 'loss_val': 0.02728192462962197, 'psi': 0.9952713719423851}
[S11] START round=28 head_norm_before_train=1.469198 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.150743 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978674535127807, 'loss_val': 0.1502403554392994, 'psi': 0.997075184113266}-{'f1_val': 0.9516863354822407, 'auprc': 0.9976816319545594, 'loss_val': 0.18200507510190056, 'psi': 0.9700844540711682}
[S13] START round=28 head_norm_before_train=1.537662 cos_to_last_merge=0.8160 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=28 local utility u=1.000000 metrics={'f1_val': 0.9552852876068353, 'auprc': 0.9833304474861015, 'loss_val': 0.29874211268268325, 'psi': 0.9665033515585417}-{'f1_val': 0.5709584659028275, 'auprc': 0.7407376400056834, 'loss_val': 1.0972429610310184, 'psi': 0.6388701355439699}
[S14] START round=28 head_norm_before_train=1.338218 cos_to_last_merge=1.0000 (last merge round=27)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.6928645108093179, 'auprc': 0.9903985628545763, 'loss_val': 0.5173113984004074, 'psi': 0.8118781316274213}-{'f1_val': 0.6919545104764272, 'auprc': 0.9948320047829466, 'loss_val': 0.5224927480304371, 'psi': 0.813105508199035}
[S15] START round=28 head_norm_before_train=2.125042 (no previous merge yet)
[S15] round=28 local utility u=0.040916 metrics={'f1_val': 0.9130993348299704, 'auprc': 0.9937535326601603, 'loss_val': 0.10726967804187881, 'psi': 0.9453610139620464}-{'f1_val': 0.903592774729807, 'auprc': 0.9962770479649212, 'loss_val': 0.13963314494313087, 'psi': 0.9406664840238528}
[S16] START round=28 head_norm_before_train=1.271056 cos_to_last_merge=0.9994 (last merge round=26)
[S16] round=28 local utility u=0.070540 metrics={'f1_val': 0.9764276036128889, 'auprc': 0.9887509818197922, 'loss_val': 0.18368150142905912, 'psi': 0.9813569548956502}-{'f1_val': 0.9579578396568779, 'auprc': 0.9910857019542865, 'loss_val': 0.22094632108060935, 'psi': 0.9712089845758413}
[S17] START round=28 head_norm_before_train=1.873358 cos_to_last_merge=0.8477 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=28 local utility u=0.598238 metrics={'f1_val': 0.6267746970660606, 'auprc': 0.8124572103810689, 'loss_val': 1.3028335641748683, 'psi': 0.7010477023920639}-{'f1_val': 0.5452793737291798, 'auprc': 0.7524881971476814, 'loss_val': 1.8304306404290935, 'psi': 0.6281629030965805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:58311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] → sending delta(kind=head bytes=1807) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:58314
[S8] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1807 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=0.3625
[S11] RECEIVED delta(kind=head bytes=1807) from S4
[S11] cosine check vs S4: cos=0.9751
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=-0.0871
[S10] DROPPED delta from S13 (cos=-0.0871 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S7
[S14] cosine check vs S7: cos=0.2962
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9709
[S16] RECEIVED delta(kind=head bytes=1798) from S5
[S16] cosine check vs S5: cos=0.9592
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.5410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S17
[S9] cosine check vs S17: cos=0.9938
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=28 metric=0.6131 head_norm=1.391881
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.678412e-01
[S6] stored merged vector for next round verification (round=28)
[S6] DEBUG after merge:  round=28 metric=0.6212 head_norm=1.342247 delta_norm=0.167841
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=28 metric=0.9963 head_norm=1.853360
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.053601e-01
[S9] stored merged vector for next round verification (round=28)
[S9] DEBUG after merge:  round=28 metric=0.9963 head_norm=1.867559 delta_norm=0.105360
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=28 metric=0.6929 head_norm=1.362127
[S14] _apply_head_vector_avg (torch): Δ‖w‖=7.385973e-01
[S14] stored merged vector for next round verification (round=28)
[S14] DEBUG after merge:  round=28 metric=0.6915 head_norm=1.133857 delta_norm=0.738597
[S14] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=28 metric=0.7003 head_norm=1.169820
[S5] _apply_head_vector_avg (torch): Δ‖w‖=8.990901e-01
[S5] stored merged vector for next round verification (round=28)
[S5] DEBUG after merge:  round=28 metric=0.7003 head_norm=1.470193 delta_norm=0.899090
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=28 metric=0.6704 head_norm=1.834216
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.768866e-02
[S7] stored merged vector for next round verification (round=28)
[S7] DEBUG after merge:  round=28 metric=0.6704 head_norm=1.841023 delta_norm=0.017689
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=28 metric=0.9965 head_norm=1.498901
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.676386e-01
[S11] stored merged vector for next round verification (round=28)
[S11] DEBUG after merge:  round=28 metric=0.9965 head_norm=1.492897 delta_norm=0.167639
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=28 metric=0.9764 head_norm=1.312349
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.908278e-01
[S16] stored merged vector for next round verification (round=28)
[S16] DEBUG after merge:  round=28 metric=0.9679 head_norm=1.228395 delta_norm=0.190828
[S16] aggregate: ROLLBACK (f1_val pre=0.976 post=0.968 tol_abs=0.005 tol_rel=0.0)
[S2] START round=29 head_norm_before_train=1.895735 cos_to_last_merge=0.8185 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.818
[S2] round=29 local utility u=0.000339 metrics={'f1_val': 0.710721831149066, 'auprc': 0.7219319429119988, 'loss_val': 1.1313269590473152, 'psi': 0.7152058758542391}-{'f1_val': 0.7093321613690707, 'auprc': 0.7233856164349225, 'loss_val': 1.1280282740152539, 'psi': 0.7149535433954115}
[S3] START round=29 head_norm_before_train=1.922457 (no previous merge yet)
[S3] round=29 local utility u=0.941400 metrics={'f1_val': 0.997542018298261, 'auprc': 0.9952175517120803, 'loss_val': 0.13152461682743388, 'psi': 0.9966122316637887}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984183768715292, 'loss_val': 0.24276092249200484, 'psi': 0.8197759265478126}
[S4] START round=29 head_norm_before_train=1.505651 cos_to_last_merge=0.9940 (last merge round=26)
[S4] round=29 local utility u=0.013593 metrics={'f1_val': 0.9558517372551916, 'auprc': 0.9517294530401657, 'loss_val': 0.26830268979207683, 'psi': 0.9542028235691812}-{'f1_val': 0.9548314882454735, 'auprc': 0.9498310258279136, 'loss_val': 0.28367095230307504, 'psi': 0.9528313032784494}
[S5] START round=29 head_norm_before_train=1.470193 cos_to_last_merge=1.0000 (last merge round=28)
[S5] round=29 local utility u=0.022662 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9892609403317131, 'loss_val': 0.31298003052043355, 'psi': 0.8158967352275006}-{'f1_val': 0.700320598491359, 'auprc': 0.9797690741218472, 'loss_val': 0.3298293756456261, 'psi': 0.8120999887435543}
[S6] START round=29 head_norm_before_train=1.342247 cos_to_last_merge=1.0000 (last merge round=28)
[S6] round=29 local utility u=0.313673 metrics={'f1_val': 0.7066233113961111, 'auprc': 0.9471563681967858, 'loss_val': 0.5908830267137435, 'psi': 0.802836534116381}-{'f1_val': 0.6130746613371567, 'auprc': 0.9513254746837247, 'loss_val': 0.6694437965677685, 'psi': 0.748374986675784}
[S7] START round=29 head_norm_before_train=1.841023 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.6030991454802755, 'auprc': 0.7813728574280556, 'loss_val': 0.7157144219791394, 'psi': 0.6744086302593876}-{'f1_val': 0.6704089562934914, 'auprc': 0.8388551831817765, 'loss_val': 0.4422775900452966, 'psi': 0.7377874470488055}
[S8] START round=29 head_norm_before_train=1.847974 cos_to_last_merge=0.7939 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.794
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9941417884415487, 'auprc': 0.9988085847773746, 'loss_val': 0.03483905525809143, 'psi': 0.9960085069758791}-{'f1_val': 0.9938326055531397, 'auprc': 0.9986493560736663, 'loss_val': 0.03135348367276866, 'psi': 0.9957593057613504}
[S9] START round=29 head_norm_before_train=1.867559 cos_to_last_merge=1.0000 (last merge round=28)
[S9] round=29 local utility u=0.002645 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9990619736632497, 'loss_val': 0.03274539823078494, 'psi': 0.9978865369725856}-{'f1_val': 0.9962710290637395, 'auprc': 0.9993466759960014, 'loss_val': 0.03389870498888199, 'psi': 0.9975012878366443}
[S10] START round=29 head_norm_before_train=2.163985 (no previous merge yet)
[S10] round=29 local utility u=0.001217 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954518395951324, 'loss_val': 0.026728741997736095, 'psi': 0.9952934392496777}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948759163914045, 'loss_val': 0.027435065286563975, 'psi': 0.9950630699681866}
[S11] START round=29 head_norm_before_train=1.492897 cos_to_last_merge=1.0000 (last merge round=28)
[S11] round=29 local utility u=0.006243 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978563058341702, 'loss_val': 0.13772187525812166, 'psi': 0.9970707250418218}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978674535127807, 'loss_val': 0.1502403554392994, 'psi': 0.997075184113266}
[S13] START round=29 head_norm_before_train=1.547781 cos_to_last_merge=0.8159 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5747919008407645, 'auprc': 0.7389405090309576, 'loss_val': 1.1422230194798044, 'psi': 0.6404513441168418}-{'f1_val': 0.9552852876068353, 'auprc': 0.9833304474861015, 'loss_val': 0.29874211268268325, 'psi': 0.9665033515585417}
[S14] START round=29 head_norm_before_train=1.133857 cos_to_last_merge=1.0000 (last merge round=28)
[S14] round=29 local utility u=0.011145 metrics={'f1_val': 0.6900227465294718, 'auprc': 0.9969880455371175, 'loss_val': 0.4977383013756652, 'psi': 0.8128088661325301}-{'f1_val': 0.6928645108093179, 'auprc': 0.9903985628545763, 'loss_val': 0.5173113984004074, 'psi': 0.8118781316274213}
[S15] START round=29 head_norm_before_train=2.138033 (no previous merge yet)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7959410427404014, 'auprc': 0.9861770296266456, 'loss_val': 0.38620350649754664, 'psi': 0.8720354374948991}-{'f1_val': 0.9130993348299704, 'auprc': 0.9937535326601603, 'loss_val': 0.10726967804187881, 'psi': 0.9453610139620464}
[S16] START round=29 head_norm_before_train=1.228395 cos_to_last_merge=1.0000 (last merge round=28)
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.9067176994755657, 'auprc': 0.9935991748918807, 'loss_val': 0.3743956791042131, 'psi': 0.9414702896420917}-{'f1_val': 0.9764276036128889, 'auprc': 0.9887509818197922, 'loss_val': 0.18368150142905912, 'psi': 0.9813569548956502}
[S17] START round=29 head_norm_before_train=1.887540 cos_to_last_merge=0.8466 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.847
[S17] round=29 local utility u=0.853975 metrics={'f1_val': 0.7268778971118385, 'auprc': 0.9453742088522423, 'loss_val': 0.5942541455197704, 'psi': 0.8142764218080001}-{'f1_val': 0.6267746970660606, 'auprc': 0.8124572103810689, 'loss_val': 1.3028335641748683, 'psi': 0.7010477023920639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:58312
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:58314
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S4
[S11] cosine check vs S4: cos=0.9905
[S5] RECEIVED delta(kind=head bytes=1799) from S3
[S5] cosine check vs S3: cos=0.3157
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=-0.0968
[S5] DROPPED delta from S10 (cos=-0.0968 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S14
[S5] cosine check vs S14: cos=0.4285
[S5] RECEIVED delta(kind=head bytes=1800) from S2
[S5] cosine check vs S2: cos=-0.1064
[S5] DROPPED delta from S2 (cos=-0.1064 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1799) from S5
[S16] cosine check vs S5: cos=0.8507
[S4] RECEIVED delta(kind=head bytes=1801) from S6
[S4] cosine check vs S6: cos=0.8727
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.6076
[S14] RECEIVED delta(kind=head bytes=1802) from S11
[S14] cosine check vs S11: cos=0.6813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:58310
[S17] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S17
[S9] cosine check vs S17: cos=0.9977
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9965 head_norm=1.538088
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.066448e-01
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9965 head_norm=1.542453 delta_norm=0.106645
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=29 metric=0.9559 head_norm=1.554141
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.804101e-01
[S4] stored merged vector for next round verification (round=29)
[S4] DEBUG after merge:  round=29 metric=0.9558 head_norm=1.434601 delta_norm=0.380410
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=29 metric=0.6900 head_norm=1.164223
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.326301e-01
[S14] stored merged vector for next round verification (round=29)
[S14] DEBUG after merge:  round=29 metric=0.6896 head_norm=1.177830 delta_norm=0.332630
[S14] aggregate: ACCEPT kept=['S9', 'S11'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=29 metric=0.9971 head_norm=1.884704
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.511763e-02
[S9] stored merged vector for next round verification (round=29)
[S9] DEBUG after merge:  round=29 metric=0.9971 head_norm=1.890635 delta_norm=0.065118
[S9] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=29 metric=0.7003 head_norm=1.497086
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.578037e-01
[S5] stored merged vector for next round verification (round=29)
[S5] DEBUG after merge:  round=29 metric=0.7003 head_norm=1.185683 delta_norm=0.757804
[S5] aggregate: ACCEPT kept=['S3', 'S14'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=29 metric=0.9067 head_norm=1.269952
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.934557e-01
[S16] stored merged vector for next round verification (round=29)
[S16] DEBUG after merge:  round=29 metric=0.8918 head_norm=1.331246 delta_norm=0.393456
[S16] aggregate: ROLLBACK (f1_val pre=0.907 post=0.892 tol_abs=0.005 tol_rel=0.0)
[S2] START round=30 head_norm_before_train=1.916372 cos_to_last_merge=0.8168 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.817
[S2] round=30 local utility u=0.001112 metrics={'f1_val': 0.7117878982003985, 'auprc': 0.7211849052357217, 'loss_val': 1.1332588302564242, 'psi': 0.7155467010145278}-{'f1_val': 0.710721831149066, 'auprc': 0.7219319429119988, 'loss_val': 1.1313269590473152, 'psi': 0.7152058758542391}
[S3] START round=30 head_norm_before_train=1.938950 (no previous merge yet)
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9984219749285985, 'loss_val': 0.1920276338489802, 'psi': 0.8197773657706402}-{'f1_val': 0.997542018298261, 'auprc': 0.9952175517120803, 'loss_val': 0.13152461682743388, 'psi': 0.9966122316637887}
[S4] START round=30 head_norm_before_train=1.434601 cos_to_last_merge=1.0000 (last merge round=29)
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9530995307257939, 'auprc': 0.8955901449784323, 'loss_val': 0.31251427552518934, 'psi': 0.9300957764268493}-{'f1_val': 0.9558517372551916, 'auprc': 0.9517294530401657, 'loss_val': 0.26830268979207683, 'psi': 0.9542028235691812}
[S5] START round=30 head_norm_before_train=1.185683 cos_to_last_merge=1.0000 (last merge round=29)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.6607348304971796, 'auprc': 0.921604450016223, 'loss_val': 0.4164179752171125, 'psi': 0.765082678304797}-{'f1_val': 0.700320598491359, 'auprc': 0.9892609403317131, 'loss_val': 0.31298003052043355, 'psi': 0.8158967352275006}
[S6] START round=30 head_norm_before_train=1.410755 cos_to_last_merge=0.9969 (last merge round=28)
[S6] round=30 local utility u=0.560495 metrics={'f1_val': 0.8387316453050597, 'auprc': 0.9775058412493829, 'loss_val': 0.35359145917972457, 'psi': 0.8942413236827891}-{'f1_val': 0.7066233113961111, 'auprc': 0.9471563681967858, 'loss_val': 0.5908830267137435, 'psi': 0.802836534116381}
[S7] START round=30 head_norm_before_train=1.847490 cos_to_last_merge=1.0000 (last merge round=28)
[S7] round=30 local utility u=0.307690 metrics={'f1_val': 0.6560470230400489, 'auprc': 0.8104628397657939, 'loss_val': 0.5052906731979298, 'psi': 0.7178133497303469}-{'f1_val': 0.6030991454802755, 'auprc': 0.7813728574280556, 'loss_val': 0.7157144219791394, 'psi': 0.6744086302593876}
[S8] START round=30 head_norm_before_train=1.855823 cos_to_last_merge=0.7927 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.793
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9736060242896892, 'auprc': 0.9959305209610789, 'loss_val': 0.06276791304241029, 'psi': 0.982535822958245}-{'f1_val': 0.9941417884415487, 'auprc': 0.9988085847773746, 'loss_val': 0.03483905525809143, 'psi': 0.9960085069758791}
[S9] START round=30 head_norm_before_train=1.890635 cos_to_last_merge=1.0000 (last merge round=29)
[S9] round=30 local utility u=0.001020 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993084467552287, 'loss_val': 0.0314447748595244, 'psi': 0.9979851262093772}-{'f1_val': 0.9971029125121428, 'auprc': 0.9990619736632497, 'loss_val': 0.03274539823078494, 'psi': 0.9978865369725856}
[S10] START round=30 head_norm_before_train=2.176022 (no previous merge yet)
[S10] round=30 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947093239834849, 'loss_val': 0.027231994280008442, 'psi': 0.9949964330050187}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954518395951324, 'loss_val': 0.026728741997736095, 'psi': 0.9952934392496777}
[S11] START round=30 head_norm_before_train=1.542453 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.015955 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980425740701101, 'loss_val': 0.1063701091084357, 'psi': 0.9971452323361978}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978563058341702, 'loss_val': 0.13772187525812166, 'psi': 0.9970707250418218}
[S13] START round=30 head_norm_before_train=1.555693 cos_to_last_merge=0.8157 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=30 local utility u=0.329037 metrics={'f1_val': 0.6114181696881068, 'auprc': 0.763369161194552, 'loss_val': 0.7771916138295162, 'psi': 0.6721985662906849}-{'f1_val': 0.5747919008407645, 'auprc': 0.7389405090309576, 'loss_val': 1.1422230194798044, 'psi': 0.6404513441168418}
[S14] START round=30 head_norm_before_train=1.177830 cos_to_last_merge=1.0000 (last merge round=29)
[S14] round=30 local utility u=0.035648 metrics={'f1_val': 0.6942718189289707, 'auprc': 0.9954990775416488, 'loss_val': 0.4474693442457078, 'psi': 0.8147627223740419}-{'f1_val': 0.6900227465294718, 'auprc': 0.9969880455371175, 'loss_val': 0.4977383013756652, 'psi': 0.8128088661325301}
[S15] START round=30 head_norm_before_train=2.152285 (no previous merge yet)
[S15] round=30 local utility u=0.412429 metrics={'f1_val': 0.8961476380675775, 'auprc': 0.9966522468967876, 'loss_val': 0.1940100183673226, 'psi': 0.9363494815992615}-{'f1_val': 0.7959410427404014, 'auprc': 0.9861770296266456, 'loss_val': 0.38620350649754664, 'psi': 0.8720354374948991}
[S16] START round=30 head_norm_before_train=1.331246 cos_to_last_merge=1.0000 (last merge round=29)
[S16] round=30 local utility u=0.349128 metrics={'f1_val': 0.9891721665600306, 'auprc': 0.9891764477160094, 'loss_val': 0.15759737461650855, 'psi': 0.9891738790224222}-{'f1_val': 0.9067176994755657, 'auprc': 0.9935991748918807, 'loss_val': 0.3743956791042131, 'psi': 0.9414702896420917}
[S17] START round=30 head_norm_before_train=1.898782 cos_to_last_merge=0.8458 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6554964944192461, 'auprc': 0.8336085715076291, 'loss_val': 1.1981665442432938, 'psi': 0.7267413252545993}-{'f1_val': 0.7268778971118385, 'auprc': 0.9453742088522423, 'loss_val': 0.5942541455197704, 'psi': 0.8142764218080001}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:58314
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S11
[S14] cosine check vs S11: cos=0.7087
[S4] RECEIVED delta(kind=head bytes=1800) from S6
[S4] cosine check vs S6: cos=0.9592
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.7307
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0863
[S10] DROPPED delta from S13 (cos=-0.0863 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9354
[S5] RECEIVED delta(kind=head bytes=1799) from S2
[S5] cosine check vs S2: cos=-0.1106
[S5] DROPPED delta from S2 (cos=-0.1106 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1803) from S15
[S5] cosine check vs S15: cos=0.6497
[S5] RECEIVED delta(kind=head bytes=1799) from S14
[S5] cosine check vs S14: cos=0.6642
[S14] RECEIVED delta(kind=head bytes=1803) from S7
[S14] cosine check vs S7: cos=0.4438
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=30 metric=0.9531 head_norm=1.490597
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.120884e-01
[S4] stored merged vector for next round verification (round=30)
[S4] DEBUG after merge:  round=30 metric=0.9527 head_norm=1.468166 delta_norm=0.212088
[S4] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.034 → S6@127.0.0.1:58307
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=30 metric=0.6607 head_norm=1.212522
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.992182e-01
[S5] stored merged vector for next round verification (round=30)
[S5] DEBUG after merge:  round=30 metric=0.6677 head_norm=1.223951 delta_norm=0.399218
[S5] aggregate: ACCEPT kept=['S15', 'S14'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.096 → S15@127.0.0.1:58315
[S10] ⇄ pheromone p=0.005 → S17@127.0.0.1:58317
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=30 metric=0.8387 head_norm=1.476179
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.610601e-01
[S6] stored merged vector for next round verification (round=30)
[S6] DEBUG after merge:  round=30 metric=0.8521 head_norm=1.401111 delta_norm=0.261060
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.291 → S9@127.0.0.1:58310
[S16] ⇄ pheromone p=0.190 → S6@127.0.0.1:58307
[S13] ⇄ pheromone p=0.236 → S10@127.0.0.1:58311
[S9] ⇄ pheromone p=0.036 → S6@127.0.0.1:58307
[S15] ⇄ pheromone p=0.156 → S5@127.0.0.1:58305
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=30 metric=0.6943 head_norm=1.206599
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.266957e-01
[S14] stored merged vector for next round verification (round=30)
[S14] DEBUG after merge:  round=30 metric=0.6917 head_norm=1.173597 delta_norm=0.226696
[S14] aggregate: ACCEPT kept=['S11', 'S9', 'S7'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.034 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.292 → S8@127.0.0.1:58309
[S11] ⇄ pheromone p=0.071 → S14@127.0.0.1:58314
[S17] ⇄ pheromone p=0.242 → S9@127.0.0.1:58310
[S2] START round=31 head_norm_before_train=1.932898 cos_to_last_merge=0.8156 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.816
[S2] round=31 local utility u=0.011676 metrics={'f1_val': 0.7140634867476446, 'auprc': 0.7207094317355356, 'loss_val': 1.122133648165732, 'psi': 0.7167218647428011}-{'f1_val': 0.7117878982003985, 'auprc': 0.7211849052357217, 'loss_val': 1.1332588302564242, 'psi': 0.7155467010145278}
[S3] START round=31 head_norm_before_train=1.957223 (no previous merge yet)
[S3] round=31 local utility u=0.830234 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.998363851792001, 'loss_val': 0.09351008076172217, 'psi': 0.9759666913800666}-{'f1_val': 0.7006809596653347, 'auprc': 0.9984219749285985, 'loss_val': 0.1920276338489802, 'psi': 0.8197773657706402}
[S4] START round=31 head_norm_before_train=1.468166 cos_to_last_merge=1.0000 (last merge round=30)
[S4] round=31 local utility u=0.104019 metrics={'f1_val': 0.955554508267735, 'auprc': 0.9556796135491565, 'loss_val': 0.29947544842052587, 'psi': 0.9556045503803037}-{'f1_val': 0.9530995307257939, 'auprc': 0.8955901449784323, 'loss_val': 0.31251427552518934, 'psi': 0.9300957764268493}
[S5] START round=31 head_norm_before_train=1.223951 cos_to_last_merge=1.0000 (last merge round=30)
[S5] round=31 local utility u=0.024170 metrics={'f1_val': 0.6607669668824407, 'auprc': 0.939886434629958, 'loss_val': 0.42311657331907576, 'psi': 0.7724147539814477}-{'f1_val': 0.6607348304971796, 'auprc': 0.921604450016223, 'loss_val': 0.4164179752171125, 'psi': 0.765082678304797}
[S6] START round=31 head_norm_before_train=1.401111 cos_to_last_merge=1.0000 (last merge round=30)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8135556598295981, 'auprc': 0.946732222376672, 'loss_val': 0.4665903443030817, 'psi': 0.8668262848484276}-{'f1_val': 0.8387316453050597, 'auprc': 0.9775058412493829, 'loss_val': 0.35359145917972457, 'psi': 0.8942413236827891}
[S7] START round=31 head_norm_before_train=1.853367 cos_to_last_merge=0.9999 (last merge round=28)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.49497982059218637, 'auprc': 0.7768750049305679, 'loss_val': 0.9218375542477328, 'psi': 0.607737894327539}-{'f1_val': 0.6560470230400489, 'auprc': 0.8104628397657939, 'loss_val': 0.5052906731979298, 'psi': 0.7178133497303469}
[S8] START round=31 head_norm_before_train=1.866929 cos_to_last_merge=0.7918 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.792
[S8] round=31 local utility u=0.080088 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9982543481793262, 'loss_val': 0.03252825105034121, 'psi': 0.9957617474858095}-{'f1_val': 0.9736060242896892, 'auprc': 0.9959305209610789, 'loss_val': 0.06276791304241029, 'psi': 0.982535822958245}
[S9] START round=31 head_norm_before_train=1.907802 cos_to_last_merge=0.9999 (last merge round=29)
[S9] round=31 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9993306109732006, 'loss_val': 0.03194497091851131, 'psi': 0.9967464950377576}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993084467552287, 'loss_val': 0.0314447748595244, 'psi': 0.9979851262093772}
[S10] START round=31 head_norm_before_train=2.188834 (no previous merge yet)
[S10] round=31 local utility u=0.000969 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952869741608129, 'loss_val': 0.027026901175920576, 'psi': 0.9952274930759499}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947093239834849, 'loss_val': 0.027231994280008442, 'psi': 0.9949964330050187}
[S11] START round=31 head_norm_before_train=1.596357 cos_to_last_merge=0.9987 (last merge round=29)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9943851826643143, 'auprc': 0.9981199808525297, 'loss_val': 0.09588178514823105, 'psi': 0.9958791019396005}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980425740701101, 'loss_val': 0.1063701091084357, 'psi': 0.9971452323361978}
[S13] START round=31 head_norm_before_train=1.565231 cos_to_last_merge=0.8156 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.816
[S13] round=31 local utility u=0.030777 metrics={'f1_val': 0.6350768588850212, 'auprc': 0.7655543924277117, 'loss_val': 0.8641458208612178, 'psi': 0.6872678723020974}-{'f1_val': 0.6114181696881068, 'auprc': 0.763369161194552, 'loss_val': 0.7771916138295162, 'psi': 0.6721985662906849}
[S14] START round=31 head_norm_before_train=1.173597 cos_to_last_merge=1.0000 (last merge round=30)
[S14] round=31 local utility u=0.378139 metrics={'f1_val': 0.8161835611877943, 'auprc': 0.9953578123519811, 'loss_val': 0.42223831177775556, 'psi': 0.8878532616534691}-{'f1_val': 0.6942718189289707, 'auprc': 0.9954990775416488, 'loss_val': 0.4474693442457078, 'psi': 0.8147627223740419}
[S15] START round=31 head_norm_before_train=2.165191 (no previous merge yet)
[S15] round=31 local utility u=0.384060 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9963612643941715, 'loss_val': 0.0286122024943759, 'psi': 0.996592506790181}-{'f1_val': 0.8961476380675775, 'auprc': 0.9966522468967876, 'loss_val': 0.1940100183673226, 'psi': 0.9363494815992615}
[S16] START round=31 head_norm_before_train=1.372380 cos_to_last_merge=0.9994 (last merge round=29)
[S16] round=31 local utility u=0.003561 metrics={'f1_val': 0.9859222510928152, 'auprc': 0.9921312570697334, 'loss_val': 0.13983966188311117, 'psi': 0.9884058534835825}-{'f1_val': 0.9891721665600306, 'auprc': 0.9891764477160094, 'loss_val': 0.15759737461650855, 'psi': 0.9891738790224222}
[S17] START round=31 head_norm_before_train=1.907969 cos_to_last_merge=0.8449 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.845
[S17] round=31 local utility u=0.053911 metrics={'f1_val': 0.6300293784726119, 'auprc': 0.8651957831438785, 'loss_val': 1.0323037051211175, 'psi': 0.7240959403411185}-{'f1_val': 0.6554964944192461, 'auprc': 0.8336085715076291, 'loss_val': 1.1981665442432938, 'psi': 0.7267413252545993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:58313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1804 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9758
[S6] RECEIVED delta(kind=head bytes=1804) from S4
[S6] cosine check vs S4: cos=0.9584
[S7] RECEIVED delta(kind=head bytes=1798) from S14
[S7] cosine check vs S14: cos=0.5742
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.8186
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.8186
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=-0.0867
[S13] DROPPED delta from S10 (cos=-0.0867 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S8
[S7] cosine check vs S8: cos=0.9996
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:58311
[S17] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S17
[S10] cosine check vs S17: cos=-0.0250
[S10] DROPPED delta from S17 (cos=-0.0250 < 0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=31 metric=0.4950 head_norm=1.859156
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.772847e-01
[S7] stored merged vector for next round verification (round=31)
[S7] DEBUG after merge:  round=31 metric=0.5090 head_norm=1.590938 delta_norm=0.377285
[S7] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=31 metric=0.8136 head_norm=1.461173
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.199023e-01
[S6] stored merged vector for next round verification (round=31)
[S6] DEBUG after merge:  round=31 metric=0.8223 head_norm=1.485060 delta_norm=0.219902
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=31 metric=0.9967 head_norm=2.175297
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.791596e-01
[S15] stored merged vector for next round verification (round=31)
[S15] DEBUG after merge:  round=31 metric=0.9967 head_norm=1.638070 delta_norm=0.679160
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=31 metric=0.6608 head_norm=1.247858
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.714266e-01
[S5] stored merged vector for next round verification (round=31)
[S5] DEBUG after merge:  round=31 metric=0.6603 head_norm=1.451448 delta_norm=0.371427
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.948652 cos_to_last_merge=0.8143 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.814
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.7121242471899679, 'auprc': 0.7201638114875019, 'loss_val': 1.148219877525272, 'psi': 0.7153400729089815}-{'f1_val': 0.7140634867476446, 'auprc': 0.7207094317355356, 'loss_val': 1.122133648165732, 'psi': 0.7167218647428011}
[S3] START round=32 head_norm_before_train=1.974017 (no previous merge yet)
[S3] round=32 local utility u=0.121284 metrics={'f1_val': 0.998064654318121, 'auprc': 0.9985692873415145, 'loss_val': 0.07373449045478368, 'psi': 0.9982665075274784}-{'f1_val': 0.9610352511054436, 'auprc': 0.998363851792001, 'loss_val': 0.09351008076172217, 'psi': 0.9759666913800666}
[S4] START round=32 head_norm_before_train=1.540290 cos_to_last_merge=0.9966 (last merge round=30)
[S4] round=32 local utility u=0.014984 metrics={'f1_val': 0.9563086766862973, 'auprc': 0.9537548108180218, 'loss_val': 0.26825715473751727, 'psi': 0.955287130338987}-{'f1_val': 0.955554508267735, 'auprc': 0.9556796135491565, 'loss_val': 0.29947544842052587, 'psi': 0.9556045503803037}
[S5] START round=32 head_norm_before_train=1.451448 cos_to_last_merge=1.0000 (last merge round=31)
[S5] round=32 local utility u=0.272447 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9895363068482697, 'loss_val': 0.26449385568599026, 'psi': 0.8160068818341233}-{'f1_val': 0.6607669668824407, 'auprc': 0.939886434629958, 'loss_val': 0.42311657331907576, 'psi': 0.7724147539814477}
[S6] START round=32 head_norm_before_train=1.485060 cos_to_last_merge=1.0000 (last merge round=31)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.6909341113802926, 'auprc': 0.9537493685570367, 'loss_val': 0.6134966208471399, 'psi': 0.7960602142509903}-{'f1_val': 0.8135556598295981, 'auprc': 0.946732222376672, 'loss_val': 0.4665903443030817, 'psi': 0.8668262848484276}
[S7] START round=32 head_norm_before_train=1.590938 cos_to_last_merge=1.0000 (last merge round=31)
[S7] round=32 local utility u=0.696368 metrics={'f1_val': 0.6485807612649656, 'auprc': 0.8072234447394027, 'loss_val': 0.5417519764359506, 'psi': 0.7120378346547405}-{'f1_val': 0.49497982059218637, 'auprc': 0.7768750049305679, 'loss_val': 0.9218375542477328, 'psi': 0.607737894327539}
[S8] START round=32 head_norm_before_train=1.880382 cos_to_last_merge=0.7906 (last merge round=2)
[S8] ⚠️ Model drifted since last merge! cos=0.791
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9741065401273652, 'auprc': 0.9991692104156967, 'loss_val': 0.057999281652169186, 'psi': 0.9841316082426979}-{'f1_val': 0.9941000136901317, 'auprc': 0.9982543481793262, 'loss_val': 0.03252825105034121, 'psi': 0.9957617474858095}
[S9] START round=32 head_norm_before_train=1.923376 cos_to_last_merge=0.9998 (last merge round=29)
[S9] round=32 local utility u=0.008738 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9993794630393974, 'loss_val': 0.027089718518726966, 'psi': 0.9980135327230446}-{'f1_val': 0.9950237510807955, 'auprc': 0.9993306109732006, 'loss_val': 0.03194497091851131, 'psi': 0.9967464950377576}
[S10] START round=32 head_norm_before_train=2.196062 (no previous merge yet)
[S10] round=32 local utility u=0.000437 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995388349457462, 'loss_val': 0.026456509625936476, 'psi': 0.9952680431946097}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952869741608129, 'loss_val': 0.027026901175920576, 'psi': 0.9952274930759499}
[S11] START round=32 head_norm_before_train=1.649392 cos_to_last_merge=0.9958 (last merge round=29)
[S11] round=32 local utility u=0.018388 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976110352390845, 'loss_val': 0.06806923878059981, 'psi': 0.9967246190436194}-{'f1_val': 0.9943851826643143, 'auprc': 0.9981199808525297, 'loss_val': 0.09588178514823105, 'psi': 0.9958791019396005}
[S13] START round=32 head_norm_before_train=1.576067 cos_to_last_merge=0.8139 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.814
[S13] round=32 local utility u=0.088449 metrics={'f1_val': 0.647063873692889, 'auprc': 0.7990187457776858, 'loss_val': 0.8595639045509514, 'psi': 0.7078458225268078}-{'f1_val': 0.6350768588850212, 'auprc': 0.7655543924277117, 'loss_val': 0.8641458208612178, 'psi': 0.6872678723020974}
[S14] START round=32 head_norm_before_train=1.201584 cos_to_last_merge=0.9987 (last merge round=30)
[S14] round=32 local utility u=0.565433 metrics={'f1_val': 0.99661045654233, 'auprc': 0.993471678869373, 'loss_val': 0.3682755816115907, 'psi': 0.9953549454731473}-{'f1_val': 0.8161835611877943, 'auprc': 0.9953578123519811, 'loss_val': 0.42223831177775556, 'psi': 0.8878532616534691}
[S15] START round=32 head_norm_before_train=1.638070 cos_to_last_merge=1.0000 (last merge round=31)
[S15] round=32 local utility u=0.000000 metrics={'f1_val': 0.8113939776752909, 'auprc': 0.9879102589196003, 'loss_val': 0.32119562019253084, 'psi': 0.8820004901730146}-{'f1_val': 0.9967466683875206, 'auprc': 0.9963612643941715, 'loss_val': 0.0286122024943759, 'psi': 0.996592506790181}
[S16] START round=32 head_norm_before_train=1.408897 cos_to_last_merge=0.9980 (last merge round=29)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9394738226959349, 'auprc': 0.9945236158355231, 'loss_val': 0.20791795161256188, 'psi': 0.9614937399517701}-{'f1_val': 0.9859222510928152, 'auprc': 0.9921312570697334, 'loss_val': 0.13983966188311117, 'psi': 0.9884058534835825}
[S17] START round=32 head_norm_before_train=1.920947 cos_to_last_merge=0.8431 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6123533514140485, 'auprc': 0.8434156449183331, 'loss_val': 1.2547118024809274, 'psi': 0.7047782688157623}-{'f1_val': 0.6300293784726119, 'auprc': 0.8651957831438785, 'loss_val': 1.0323037051211175, 'psi': 0.7240959403411185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:58309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:58304
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:58315
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:58313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:58307
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S9
[S6] cosine check vs S9: cos=0.1825
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0876
[S13] DROPPED delta from S10 (cos=-0.0876 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1803) from S4
[S6] cosine check vs S4: cos=0.9837
[S4] RECEIVED delta(kind=head bytes=1799) from S11
[S4] cosine check vs S11: cos=0.9336
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.9873
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=0.6868
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1803 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9820
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=32 metric=0.6909 head_norm=1.539596
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.557640e-01
[S6] stored merged vector for next round verification (round=32)
[S6] DEBUG after merge:  round=32 metric=0.7218 head_norm=1.341425 delta_norm=0.555764
[S6] aggregate: ACCEPT kept=['S9', 'S4'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=32 metric=0.9741 head_norm=1.894026
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.031490e-01
[S8] stored merged vector for next round verification (round=32)
[S8] DEBUG after merge:  round=32 metric=0.9741 head_norm=1.740087 delta_norm=0.203149
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=32 metric=0.9563 head_norm=1.609148
[S4] _apply_head_vector_avg (torch): Δ‖w‖=3.044747e-01
[S4] stored merged vector for next round verification (round=32)
[S4] DEBUG after merge:  round=32 metric=0.9562 head_norm=1.626333 delta_norm=0.304475
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=32 metric=0.6486 head_norm=1.597188
[S7] _apply_head_vector_avg (torch): Δ‖w‖=5.844568e-01
[S7] stored merged vector for next round verification (round=32)
[S7] DEBUG after merge:  round=32 metric=0.6540 head_norm=1.301980 delta_norm=0.584457
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=32 metric=0.8114 head_norm=1.657213
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.747869e-01
[S15] stored merged vector for next round verification (round=32)
[S15] DEBUG after merge:  round=32 metric=0.8116 head_norm=1.557344 delta_norm=0.174787
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.962518 cos_to_last_merge=0.8134 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.813
[S2] round=33 local utility u=0.002241 metrics={'f1_val': 0.7128662021027699, 'auprc': 0.7203290560463782, 'loss_val': 1.1486860122338964, 'psi': 0.7158513436802132}-{'f1_val': 0.7121242471899679, 'auprc': 0.7201638114875019, 'loss_val': 1.148219877525272, 'psi': 0.7153400729089815}
[S3] START round=33 head_norm_before_train=1.990957 (no previous merge yet)
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9983883910451599, 'loss_val': 0.09767511144028004, 'psi': 0.9759765070813301}-{'f1_val': 0.998064654318121, 'auprc': 0.9985692873415145, 'loss_val': 0.07373449045478368, 'psi': 0.9982665075274784}
[S4] START round=33 head_norm_before_train=1.626333 cos_to_last_merge=1.0000 (last merge round=32)
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9551039920434238, 'auprc': 0.9330783381709664, 'loss_val': 0.27039100694624923, 'psi': 0.9462937304944409}-{'f1_val': 0.9563086766862973, 'auprc': 0.9537548108180218, 'loss_val': 0.26825715473751727, 'psi': 0.955287130338987}
[S5] START round=33 head_norm_before_train=1.471526 cos_to_last_merge=0.9996 (last merge round=31)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9783280219397519, 'loss_val': 0.29869924303596307, 'psi': 0.8116271856571922}-{'f1_val': 0.700320598491359, 'auprc': 0.9895363068482697, 'loss_val': 0.26449385568599026, 'psi': 0.8160068818341233}
[S6] START round=33 head_norm_before_train=1.341425 cos_to_last_merge=1.0000 (last merge round=32)
[S6] round=33 local utility u=0.547186 metrics={'f1_val': 0.8365103034099134, 'auprc': 0.9561988720193724, 'loss_val': 0.3999312540007815, 'psi': 0.8843857308536971}-{'f1_val': 0.6909341113802926, 'auprc': 0.9537493685570367, 'loss_val': 0.6134966208471399, 'psi': 0.7960602142509903}
[S7] START round=33 head_norm_before_train=1.301980 cos_to_last_merge=1.0000 (last merge round=32)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6238152478072343, 'auprc': 0.797253789602116, 'loss_val': 0.6427002223919357, 'psi': 0.693190664525187}-{'f1_val': 0.6485807612649656, 'auprc': 0.8072234447394027, 'loss_val': 0.5417519764359506, 'psi': 0.7120378346547405}
[S8] START round=33 head_norm_before_train=1.740087 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=33 local utility u=0.068451 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9978207412717559, 'loss_val': 0.03554540203638424, 'psi': 0.9954415658770891}-{'f1_val': 0.9741065401273652, 'auprc': 0.9991692104156967, 'loss_val': 0.057999281652169186, 'psi': 0.9841316082426979}
[S9] START round=33 head_norm_before_train=1.936854 cos_to_last_merge=0.9996 (last merge round=29)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9973679581863539, 'loss_val': 0.026564489463678325, 'psi': 0.9969626780333989}-{'f1_val': 0.9971029125121428, 'auprc': 0.9993794630393974, 'loss_val': 0.027089718518726966, 'psi': 0.9980135327230446}
[S10] START round=33 head_norm_before_train=2.199090 (no previous merge yet)
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952692919328557, 'loss_val': 0.026455127485581268, 'psi': 0.9952204201847672}-{'f1_val': 0.9951878390193748, 'auprc': 0.995388349457462, 'loss_val': 0.026456509625936476, 'psi': 0.9952680431946097}
[S11] START round=33 head_norm_before_train=1.698815 cos_to_last_merge=0.9925 (last merge round=29)
[S11] round=33 local utility u=0.000000 metrics={'f1_val': 0.992057659284118, 'auprc': 0.9976264100719039, 'loss_val': 0.09330691936696742, 'psi': 0.9942851595992324}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976110352390845, 'loss_val': 0.06806923878059981, 'psi': 0.9967246190436194}
[S13] START round=33 head_norm_before_train=1.596593 cos_to_last_merge=0.8101 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.810
[S13] round=33 local utility u=0.586635 metrics={'f1_val': 0.7507386488912278, 'auprc': 0.8842481585620174, 'loss_val': 0.5640317750340305, 'psi': 0.8041424527595437}-{'f1_val': 0.647063873692889, 'auprc': 0.7990187457776858, 'loss_val': 0.8595639045509514, 'psi': 0.7078458225268078}
[S14] START round=33 head_norm_before_train=1.233885 cos_to_last_merge=0.9958 (last merge round=30)
[S14] round=33 local utility u=0.036437 metrics={'f1_val': 0.997284015000207, 'auprc': 0.9986414942958806, 'loss_val': 0.3149526394258648, 'psi': 0.9978270067184765}-{'f1_val': 0.99661045654233, 'auprc': 0.993471678869373, 'loss_val': 0.3682755816115907, 'psi': 0.9953549454731473}
[S15] START round=33 head_norm_before_train=1.557344 cos_to_last_merge=1.0000 (last merge round=32)
[S15] round=33 local utility u=0.383823 metrics={'f1_val': 0.9041416549438878, 'auprc': 0.9970941118120175, 'loss_val': 0.13758793217854876, 'psi': 0.9413226376911397}-{'f1_val': 0.8113939776752909, 'auprc': 0.9879102589196003, 'loss_val': 0.32119562019253084, 'psi': 0.8820004901730146}
[S16] START round=33 head_norm_before_train=1.442132 cos_to_last_merge=0.9961 (last merge round=29)
[S16] round=33 local utility u=0.011833 metrics={'f1_val': 0.9401013515129069, 'auprc': 0.9945469231504495, 'loss_val': 0.1880870780432783, 'psi': 0.9618795801679239}-{'f1_val': 0.9394738226959349, 'auprc': 0.9945236158355231, 'loss_val': 0.20791795161256188, 'psi': 0.9614937399517701}
[S17] START round=33 head_norm_before_train=1.933846 cos_to_last_merge=0.8411 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.5896899410442609, 'auprc': 0.7996119474466392, 'loss_val': 1.4873843087570267, 'psi': 0.6736587436052122}-{'f1_val': 0.6123533514140485, 'auprc': 0.8434156449183331, 'loss_val': 1.2547118024809274, 'psi': 0.7047782688157623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S16] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9923
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.8527
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.8881
[S5] RECEIVED delta(kind=head bytes=1802) from S16
[S5] cosine check vs S16: cos=0.9669
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.9071
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=33 metric=0.7005 head_norm=1.489193
[S5] _apply_head_vector_avg (torch): Δ‖w‖=6.744468e-02
[S5] stored merged vector for next round verification (round=33)
[S5] DEBUG after merge:  round=33 metric=0.7003 head_norm=1.495266 delta_norm=0.067445
[S5] aggregate: ACCEPT kept=['S15', 'S16'] (k=2/2) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=33 metric=0.6238 head_norm=1.316577
[S7] _apply_head_vector_avg (torch): Δ‖w‖=4.962440e-02
[S7] stored merged vector for next round verification (round=33)
[S7] DEBUG after merge:  round=33 metric=0.6231 head_norm=1.338769 delta_norm=0.049624
[S7] aggregate: ACCEPT kept=['S14', 'S8'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=33 metric=0.9401 head_norm=1.472186
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.900159e-01
[S16] stored merged vector for next round verification (round=33)
[S16] DEBUG after merge:  round=33 metric=0.9403 head_norm=1.375248 delta_norm=0.390016
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.978179 cos_to_last_merge=0.8123 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=34 local utility u=0.021719 metrics={'f1_val': 0.7180353045880363, 'auprc': 0.7225912426978912, 'loss_val': 1.1430486775248145, 'psi': 0.7198576798319782}-{'f1_val': 0.7128662021027699, 'auprc': 0.7203290560463782, 'loss_val': 1.1486860122338964, 'psi': 0.7158513436802132}
[S3] START round=34 head_norm_before_train=2.008776 (no previous merge yet)
[S3] round=34 local utility u=0.122684 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9982983631371094, 'loss_val': 0.0703874185709974, 'psi': 0.9977756228267783}-{'f1_val': 0.9610352511054436, 'auprc': 0.9983883910451599, 'loss_val': 0.09767511144028004, 'psi': 0.9759765070813301}
[S4] START round=34 head_norm_before_train=1.680306 cos_to_last_merge=0.9995 (last merge round=32)
[S4] round=34 local utility u=0.043798 metrics={'f1_val': 0.9530414116843914, 'auprc': 0.9634275681574128, 'loss_val': 0.2614673416534825, 'psi': 0.9571958742736}-{'f1_val': 0.9551039920434238, 'auprc': 0.9330783381709664, 'loss_val': 0.27039100694624923, 'psi': 0.9462937304944409}
[S5] START round=34 head_norm_before_train=1.495266 cos_to_last_merge=1.0000 (last merge round=33)
[S5] round=34 local utility u=0.059961 metrics={'f1_val': 0.7004932948021524, 'auprc': 0.9895948712143581, 'loss_val': 0.2125787433198099, 'psi': 0.8161339253670348}-{'f1_val': 0.7004932948021524, 'auprc': 0.9783280219397519, 'loss_val': 0.29869924303596307, 'psi': 0.8116271856571922}
[S6] START round=34 head_norm_before_train=1.385462 cos_to_last_merge=0.9991 (last merge round=32)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8057193805033012, 'auprc': 0.9679390798582859, 'loss_val': 0.3969746710999938, 'psi': 0.870607260245295}-{'f1_val': 0.8365103034099134, 'auprc': 0.9561988720193724, 'loss_val': 0.3999312540007815, 'psi': 0.8843857308536971}
[S7] START round=34 head_norm_before_train=1.338769 cos_to_last_merge=1.0000 (last merge round=33)
[S7] round=34 local utility u=0.000000 metrics={'f1_val': 0.6152078218281444, 'auprc': 0.8002475367997725, 'loss_val': 0.6311712551221358, 'psi': 0.6892237078167955}-{'f1_val': 0.6238152478072343, 'auprc': 0.797253789602116, 'loss_val': 0.6427002223919357, 'psi': 0.693190664525187}
[S8] START round=34 head_norm_before_train=1.753986 cos_to_last_merge=1.0000 (last merge round=32)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9929205408612032, 'auprc': 0.988793453334156, 'loss_val': 0.04366866340423964, 'psi': 0.9912697058503843}-{'f1_val': 0.9938554489473111, 'auprc': 0.9978207412717559, 'loss_val': 0.03554540203638424, 'psi': 0.9954415658770891}
[S9] START round=34 head_norm_before_train=1.949032 cos_to_last_merge=0.9993 (last merge round=29)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.9990214933764188, 'loss_val': 0.03573964883869956, 'psi': 0.9946079535127036}-{'f1_val': 0.9966924912647621, 'auprc': 0.9973679581863539, 'loss_val': 0.026564489463678325, 'psi': 0.9969626780333989}
[S10] START round=34 head_norm_before_train=2.204309 (no previous merge yet)
[S10] round=34 local utility u=0.000129 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953011454105853, 'loss_val': 0.02629201548800617, 'psi': 0.995233161575859}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952692919328557, 'loss_val': 0.026455127485581268, 'psi': 0.9952204201847672}
[S11] START round=34 head_norm_before_train=1.736132 cos_to_last_merge=0.9897 (last merge round=29)
[S11] round=34 local utility u=0.041087 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982578122362719, 'loss_val': 0.039963497673976195, 'psi': 0.9972313276026625}-{'f1_val': 0.992057659284118, 'auprc': 0.9976264100719039, 'loss_val': 0.09330691936696742, 'psi': 0.9942851595992324}
[S13] START round=34 head_norm_before_train=1.611426 cos_to_last_merge=0.8081 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.808
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.6320415925215017, 'auprc': 0.9480763372312218, 'loss_val': 0.6725037312834152, 'psi': 0.7584554904053897}-{'f1_val': 0.7507386488912278, 'auprc': 0.8842481585620174, 'loss_val': 0.5640317750340305, 'psi': 0.8041424527595437}
[S14] START round=34 head_norm_before_train=1.269913 cos_to_last_merge=0.9920 (last merge round=30)
[S14] round=34 local utility u=0.028385 metrics={'f1_val': 0.9963677359485, 'auprc': 0.9991289899829943, 'loss_val': 0.2541472837634895, 'psi': 0.9974722375622977}-{'f1_val': 0.997284015000207, 'auprc': 0.9986414942958806, 'loss_val': 0.3149526394258648, 'psi': 0.9978270067184765}
[S15] START round=34 head_norm_before_train=1.585317 cos_to_last_merge=0.9999 (last merge round=32)
[S15] round=34 local utility u=0.322925 metrics={'f1_val': 0.9953812545551983, 'auprc': 0.9980928165229588, 'loss_val': 0.04217259763580282, 'psi': 0.9964658793423025}-{'f1_val': 0.9041416549438878, 'auprc': 0.9970941118120175, 'loss_val': 0.13758793217854876, 'psi': 0.9413226376911397}
[S16] START round=34 head_norm_before_train=1.375248 cos_to_last_merge=1.0000 (last merge round=33)
[S16] round=34 local utility u=0.158339 metrics={'f1_val': 0.9855343164075007, 'auprc': 0.9923293567277283, 'loss_val': 0.13735378126830328, 'psi': 0.9882523325355917}-{'f1_val': 0.9401013515129069, 'auprc': 0.9945469231504495, 'loss_val': 0.1880870780432783, 'psi': 0.9618795801679239}
[S17] START round=34 head_norm_before_train=1.948985 cos_to_last_merge=0.8399 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=34 local utility u=0.581856 metrics={'f1_val': 0.6533109001588928, 'auprc': 0.8972461993097662, 'loss_val': 0.9983016763563578, 'psi': 0.7508850198192423}-{'f1_val': 0.5896899410442609, 'auprc': 0.7996119474466392, 'loss_val': 1.4873843087570267, 'psi': 0.6736587436052122}
[S3]  timeout peer S2
[S2]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:58313
[S14] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S16
[S5] cosine check vs S16: cos=0.9265
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9859
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9859
[S4] RECEIVED delta(kind=head bytes=1801) from S11
[S4] cosine check vs S11: cos=0.9819
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] cosine check vs S10: cos=-0.0882
[S13] DROPPED delta from S10 (cos=-0.0882 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.8663
[S6] RECEIVED delta(kind=head bytes=1804) from S4
[S6] cosine check vs S4: cos=0.8898
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S17
[S10] cosine check vs S17: cos=-0.0244
[S10] DROPPED delta from S17 (cos=-0.0244 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=34 metric=0.6152 head_norm=1.364574
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.463779e-01
[S7] stored merged vector for next round verification (round=34)
[S7] DEBUG after merge:  round=34 metric=0.6199 head_norm=1.290017 delta_norm=0.346378
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=34 metric=0.8057 head_norm=1.420094
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.957300e-01
[S6] stored merged vector for next round verification (round=34)
[S6] DEBUG after merge:  round=34 metric=0.8047 head_norm=1.525573 delta_norm=0.395730
[S6] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=34 metric=0.9530 head_norm=1.717930
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.671913e-01
[S4] stored merged vector for next round verification (round=34)
[S4] DEBUG after merge:  round=34 metric=0.9528 head_norm=1.733526 delta_norm=0.167191
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=34 metric=0.9954 head_norm=1.634209
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.455710e-01
[S15] stored merged vector for next round verification (round=34)
[S15] DEBUG after merge:  round=34 metric=0.9956 head_norm=1.567236 delta_norm=0.145571
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=34 metric=0.7005 head_norm=1.511356
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.822198e-02
[S5] stored merged vector for next round verification (round=34)
[S5] DEBUG after merge:  round=34 metric=0.7003 head_norm=1.486948 delta_norm=0.098222
[S5] aggregate: ACCEPT kept=['S16', 'S15'] (k=2/2) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.990445 cos_to_last_merge=0.8114 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.811
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.6722488665627165, 'auprc': 0.7152875659077828, 'loss_val': 1.323105285566735, 'psi': 0.689464346300743}-{'f1_val': 0.7180353045880363, 'auprc': 0.7225912426978912, 'loss_val': 1.1430486775248145, 'psi': 0.7198576798319782}
[S3] START round=35 head_norm_before_train=2.026150 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9982660401444536, 'loss_val': 0.0859314096552206, 'psi': 0.9976534394669289}-{'f1_val': 0.9974271292865575, 'auprc': 0.9982983631371094, 'loss_val': 0.0703874185709974, 'psi': 0.9977756228267783}
[S4] START round=35 head_norm_before_train=1.733526 cos_to_last_merge=1.0000 (last merge round=34)
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.953796978136735, 'auprc': 0.8958589762996116, 'loss_val': 0.2769960365591447, 'psi': 0.9306217774018857}-{'f1_val': 0.9530414116843914, 'auprc': 0.9634275681574128, 'loss_val': 0.2614673416534825, 'psi': 0.9571958742736}
[S5] START round=35 head_norm_before_train=1.486948 cos_to_last_merge=1.0000 (last merge round=34)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9834443773137103, 'loss_val': 0.23657645768656485, 'psi': 0.8137256032354072}-{'f1_val': 0.7004932948021524, 'auprc': 0.9895948712143581, 'loss_val': 0.2125787433198099, 'psi': 0.8161339253670348}
[S6] START round=35 head_norm_before_train=1.525573 cos_to_last_merge=1.0000 (last merge round=34)
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6252745035945775, 'auprc': 0.9496425520529042, 'loss_val': 0.7839586717996636, 'psi': 0.7550217229779081}-{'f1_val': 0.8057193805033012, 'auprc': 0.9679390798582859, 'loss_val': 0.3969746710999938, 'psi': 0.870607260245295}
[S7] START round=35 head_norm_before_train=1.290017 cos_to_last_merge=1.0000 (last merge round=34)
[S7] round=35 local utility u=0.092421 metrics={'f1_val': 0.6292352494223912, 'auprc': 0.8183398970122586, 'loss_val': 0.5847709506199901, 'psi': 0.7048771084583382}-{'f1_val': 0.6152078218281444, 'auprc': 0.8002475367997725, 'loss_val': 0.6311712551221358, 'psi': 0.6892237078167955}
[S8] START round=35 head_norm_before_train=1.764369 cos_to_last_merge=0.9999 (last merge round=32)
[S8] round=35 local utility u=0.000000 metrics={'f1_val': 0.9863087021053989, 'auprc': 0.999142339441625, 'loss_val': 0.045380470863237495, 'psi': 0.9914421570398892}-{'f1_val': 0.9929205408612032, 'auprc': 0.988793453334156, 'loss_val': 0.04366866340423964, 'psi': 0.9912697058503843}
[S9] START round=35 head_norm_before_train=1.959330 cos_to_last_merge=0.9990 (last merge round=29)
[S9] round=35 local utility u=0.020201 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9994270008610091, 'loss_val': 0.024186362056703038, 'psi': 0.9975334177826474}-{'f1_val': 0.9916655936035601, 'auprc': 0.9990214933764188, 'loss_val': 0.03573964883869956, 'psi': 0.9946079535127036}
[S10] START round=35 head_norm_before_train=2.214017 (no previous merge yet)
[S10] round=35 local utility u=0.000005 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9952981246768154, 'loss_val': 0.02627226946957909, 'psi': 0.995231953282351}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953011454105853, 'loss_val': 0.02629201548800617, 'psi': 0.995233161575859}
[S11] START round=35 head_norm_before_train=1.764893 cos_to_last_merge=0.9874 (last merge round=29)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.9958246664506369, 'auprc': 0.9981845935283944, 'loss_val': 0.04113970143480726, 'psi': 0.9967686372817399}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982578122362719, 'loss_val': 0.039963497673976195, 'psi': 0.9972313276026625}
[S13] START round=35 head_norm_before_train=1.623313 cos_to_last_merge=0.8064 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.806
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.639039320641207, 'auprc': 0.8053771785386811, 'loss_val': 0.9766669685572245, 'psi': 0.7055744638001966}-{'f1_val': 0.6320415925215017, 'auprc': 0.9480763372312218, 'loss_val': 0.6725037312834152, 'psi': 0.7584554904053897}
[S14] START round=35 head_norm_before_train=1.306209 cos_to_last_merge=0.9876 (last merge round=30)
[S14] round=35 local utility u=0.021628 metrics={'f1_val': 0.9963250913548265, 'auprc': 0.998734828762361, 'loss_val': 0.20945330379063215, 'psi': 0.9972889863178402}-{'f1_val': 0.9963677359485, 'auprc': 0.9991289899829943, 'loss_val': 0.2541472837634895, 'psi': 0.9974722375622977}
[S15] START round=35 head_norm_before_train=1.567236 cos_to_last_merge=1.0000 (last merge round=34)
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.9092256581566749, 'auprc': 0.9960553706451554, 'loss_val': 0.11681643228599929, 'psi': 0.943957543152067}-{'f1_val': 0.9953812545551983, 'auprc': 0.9980928165229588, 'loss_val': 0.04217259763580282, 'psi': 0.9964658793423025}
[S16] START round=35 head_norm_before_train=1.405186 cos_to_last_merge=0.9998 (last merge round=33)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9298646660332667, 'auprc': 0.9940956694976248, 'loss_val': 0.26625948815874334, 'psi': 0.9555570674190099}-{'f1_val': 0.9855343164075007, 'auprc': 0.9923293567277283, 'loss_val': 0.13735378126830328, 'psi': 0.9882523325355917}
[S17] START round=35 head_norm_before_train=1.962964 cos_to_last_merge=0.8384 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5915877410582232, 'auprc': 0.819552351383985, 'loss_val': 1.4584634637833183, 'psi': 0.6827735851885279}-{'f1_val': 0.6533109001588928, 'auprc': 0.8972461993097662, 'loss_val': 0.9983016763563578, 'psi': 0.7508850198192423}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:58313
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S7] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=-0.0875
[S13] DROPPED delta from S10 (cos=-0.0875 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.7981
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9584
[S6] RECEIVED delta(kind=head bytes=1801) from S9
[S6] cosine check vs S9: cos=0.2962
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=35 metric=0.9863 head_norm=1.782037
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.397024e-01
[S8] stored merged vector for next round verification (round=35)
[S8] DEBUG after merge:  round=35 metric=0.9867 head_norm=1.468194 delta_norm=0.539702
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.049 → S7@127.0.0.1:58308
[S4] ⇄ pheromone p=0.028 → S6@127.0.0.1:58307
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=35 metric=0.6253 head_norm=1.555506
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.059032e+00
[S6] stored merged vector for next round verification (round=35)
[S6] DEBUG after merge:  round=35 metric=0.6336 head_norm=1.424623 delta_norm=1.059032
[S6] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.165 → S16@127.0.0.1:58316
[S11] ⇄ pheromone p=0.032 → S4@127.0.0.1:58304
[S5] ⇄ pheromone p=0.071 → S15@127.0.0.1:58315
[S15] ⇄ pheromone p=0.183 → S5@127.0.0.1:58305
[S9] ⇄ pheromone p=0.017 → S6@127.0.0.1:58307
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=35 metric=0.6292 head_norm=1.310760
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.920194e-01
[S7] stored merged vector for next round verification (round=35)
[S7] DEBUG after merge:  round=35 metric=0.6316 head_norm=1.312861 delta_norm=0.192019
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.186 → S8@127.0.0.1:58309
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:58313
[S14] ⇄ pheromone p=0.113 → S7@127.0.0.1:58308
[S17] ⇄ pheromone p=0.177 → S10@127.0.0.1:58311
[S16] ⇄ pheromone p=0.089 → S6@127.0.0.1:58307
[S2] START round=36 head_norm_before_train=1.996358 cos_to_last_merge=0.8103 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=36 local utility u=0.121632 metrics={'f1_val': 0.6991833881786732, 'auprc': 0.7209869181677786, 'loss_val': 1.258546200176939, 'psi': 0.7079048001743153}-{'f1_val': 0.6722488665627165, 'auprc': 0.7152875659077828, 'loss_val': 1.323105285566735, 'psi': 0.689464346300743}
[S3] START round=36 head_norm_before_train=2.045229 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9953874485684591, 'loss_val': 0.11788392947893912, 'psi': 0.9748000306670559}-{'f1_val': 0.9972450390152456, 'auprc': 0.9982660401444536, 'loss_val': 0.0859314096552206, 'psi': 0.9976534394669289}
[S4] START round=36 head_norm_before_train=1.761385 cos_to_last_merge=0.9999 (last merge round=34)
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9501519902434477, 'auprc': 0.888678385238248, 'loss_val': 0.28370156501707783, 'psi': 0.9255625482413679}-{'f1_val': 0.953796978136735, 'auprc': 0.8958589762996116, 'loss_val': 0.2769960365591447, 'psi': 0.9306217774018857}
[S5] START round=36 head_norm_before_train=1.502608 cos_to_last_merge=0.9996 (last merge round=34)
[S5] round=36 local utility u=0.025250 metrics={'f1_val': 0.7005802511973405, 'auprc': 0.9900892360865274, 'loss_val': 0.2060142307477314, 'psi': 0.8163838451530152}-{'f1_val': 0.7005797538498719, 'auprc': 0.9834443773137103, 'loss_val': 0.23657645768656485, 'psi': 0.8137256032354072}
[S6] START round=36 head_norm_before_train=1.424623 cos_to_last_merge=1.0000 (last merge round=35)
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9700957200012601, 'auprc': 0.991350709749111, 'loss_val': 0.22902500104758372, 'psi': 0.9785977159004005}-{'f1_val': 0.6252745035945775, 'auprc': 0.9496425520529042, 'loss_val': 0.7839586717996636, 'psi': 0.7550217229779081}
[S7] START round=36 head_norm_before_train=1.312861 cos_to_last_merge=1.0000 (last merge round=35)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6243134771407507, 'auprc': 0.8103133208676755, 'loss_val': 0.6154344987774021, 'psi': 0.6987134146315206}-{'f1_val': 0.6292352494223912, 'auprc': 0.8183398970122586, 'loss_val': 0.5847709506199901, 'psi': 0.7048771084583382}
[S8] START round=36 head_norm_before_train=1.468194 cos_to_last_merge=1.0000 (last merge round=35)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9877803895057649, 'auprc': 0.9989430446055977, 'loss_val': 0.059076400100358396, 'psi': 0.992245451545698}-{'f1_val': 0.9863087021053989, 'auprc': 0.999142339441625, 'loss_val': 0.045380470863237495, 'psi': 0.9914421570398892}
[S9] START round=36 head_norm_before_train=1.970432 cos_to_last_merge=0.9987 (last merge round=29)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.9994555594161119, 'loss_val': 0.029189889388493005, 'psi': 0.9950395915318071}-{'f1_val': 0.9962710290637395, 'auprc': 0.9994270008610091, 'loss_val': 0.024186362056703038, 'psi': 0.9975334177826474}
[S10] START round=36 head_norm_before_train=2.220663 (no previous merge yet)
[S10] round=36 local utility u=0.000133 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953740054936736, 'loss_val': 0.026234471349770045, 'psi': 0.9952623056090943}-{'f1_val': 0.9951878390193748, 'auprc': 0.9952981246768154, 'loss_val': 0.02627226946957909, 'psi': 0.995231953282351}
[S11] START round=36 head_norm_before_train=1.790254 cos_to_last_merge=0.9854 (last merge round=29)
[S11] round=36 local utility u=0.005964 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983766545050148, 'loss_val': 0.03412128248062249, 'psi': 0.9972788645101597}-{'f1_val': 0.9958246664506369, 'auprc': 0.9981845935283944, 'loss_val': 0.04113970143480726, 'psi': 0.9967686372817399}
[S13] START round=36 head_norm_before_train=1.631425 cos_to_last_merge=0.8058 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.806
[S13] round=36 local utility u=0.421944 metrics={'f1_val': 0.7261141261370149, 'auprc': 0.8606409944298563, 'loss_val': 0.8210187278070711, 'psi': 0.7799248734541515}-{'f1_val': 0.639039320641207, 'auprc': 0.8053771785386811, 'loss_val': 0.9766669685572245, 'psi': 0.7055744638001966}
[S14] START round=36 head_norm_before_train=1.342705 cos_to_last_merge=0.9831 (last merge round=30)
[S14] round=36 local utility u=0.002724 metrics={'f1_val': 0.9921369149058926, 'auprc': 0.9986777334299707, 'loss_val': 0.17870500557434743, 'psi': 0.9947532423155239}-{'f1_val': 0.9963250913548265, 'auprc': 0.998734828762361, 'loss_val': 0.20945330379063215, 'psi': 0.9972889863178402}
[S15] START round=36 head_norm_before_train=1.631299 cos_to_last_merge=0.9995 (last merge round=34)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.9963771184189517, 'loss_val': 0.1541250171976179, 'psi': 0.9397666542478984}-{'f1_val': 0.9092256581566749, 'auprc': 0.9960553706451554, 'loss_val': 0.11681643228599929, 'psi': 0.943957543152067}
[S16] START round=36 head_norm_before_train=1.436533 cos_to_last_merge=0.9991 (last merge round=33)
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9041381423035666, 'auprc': 0.9939542873160611, 'loss_val': 0.3332033303774315, 'psi': 0.9400646003085644}-{'f1_val': 0.9298646660332667, 'auprc': 0.9940956694976248, 'loss_val': 0.26625948815874334, 'psi': 0.9555570674190099}
[S17] START round=36 head_norm_before_train=1.975922 cos_to_last_merge=0.8371 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.837
[S17] round=36 local utility u=0.184879 metrics={'f1_val': 0.6123955000013133, 'auprc': 0.8665080574583437, 'loss_val': 1.3544183550678681, 'psi': 0.7140405229841255}-{'f1_val': 0.5915877410582232, 'auprc': 0.819552351383985, 'loss_val': 1.4584634637833183, 'psi': 0.6827735851885279}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:58316
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1806 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S6
[S16] cosine check vs S6: cos=0.7443
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S11] → sending delta(kind=head bytes=1810) to S4@127.0.0.1:58304
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:58313
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:58311
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1810 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=-0.0872
[S13] DROPPED delta from S10 (cos=-0.0872 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1810) from S11
[S4] cosine check vs S11: cos=0.9934
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:58308
[S13] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=-0.0872
[S10] DROPPED delta from S13 (cos=-0.0872 < 0.0)
[S14] sending update (kind=head size=1803 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1803) from S14
[S7] cosine check vs S14: cos=0.9855
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9842
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:58311
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S17
[S10] cosine check vs S17: cos=-0.0234
[S10] DROPPED delta from S17 (cos=-0.0234 < 0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=36 metric=0.9502 head_norm=1.773818
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.050938e-01
[S4] stored merged vector for next round verification (round=36)
[S4] DEBUG after merge:  round=36 metric=0.9501 head_norm=1.790657 delta_norm=0.105094
[S4] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=36 metric=0.6243 head_norm=1.335079
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.167595e-01
[S7] stored merged vector for next round verification (round=36)
[S7] DEBUG after merge:  round=36 metric=0.6258 head_norm=1.349529 delta_norm=0.116760
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=36 metric=0.9041 head_norm=1.466021
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.216787e-01
[S16] stored merged vector for next round verification (round=36)
[S16] DEBUG after merge:  round=36 metric=0.9184 head_norm=1.362355 delta_norm=0.521679
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=36 metric=0.9020 head_norm=1.697049
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.692767e-01
[S15] stored merged vector for next round verification (round=36)
[S15] DEBUG after merge:  round=36 metric=0.9020 head_norm=1.599590 delta_norm=0.169277
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=2.003335 cos_to_last_merge=0.8096 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.810
[S2] round=37 local utility u=0.079029 metrics={'f1_val': 0.7119287469807609, 'auprc': 0.7213217604008795, 'loss_val': 1.1779648954166795, 'psi': 0.7156859523488084}-{'f1_val': 0.6991833881786732, 'auprc': 0.7209869181677786, 'loss_val': 1.258546200176939, 'psi': 0.7079048001743153}
[S3] START round=37 head_norm_before_train=2.064585 (no previous merge yet)
[S3] round=37 local utility u=0.149487 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9981806268230784, 'loss_val': 0.04522890042353044, 'psi': 0.9977111921968658}-{'f1_val': 0.9610750853994537, 'auprc': 0.9953874485684591, 'loss_val': 0.11788392947893912, 'psi': 0.9748000306670559}
[S4] START round=37 head_norm_before_train=1.790657 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=37 local utility u=0.080304 metrics={'f1_val': 0.9511680699330647, 'auprc': 0.938837799861191, 'loss_val': 0.27966736850094603, 'psi': 0.9462359619043152}-{'f1_val': 0.9501519902434477, 'auprc': 0.888678385238248, 'loss_val': 0.28370156501707783, 'psi': 0.9255625482413679}
[S5] START round=37 head_norm_before_train=1.514830 cos_to_last_merge=0.9991 (last merge round=34)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.565902543148183, 'auprc': 0.8578555714343776, 'loss_val': 0.5122126762389573, 'psi': 0.6826837544626609}-{'f1_val': 0.7005802511973405, 'auprc': 0.9900892360865274, 'loss_val': 0.2060142307477314, 'psi': 0.8163838451530152}
[S6] START round=37 head_norm_before_train=1.451586 cos_to_last_merge=0.9990 (last merge round=35)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.8274014041989919, 'auprc': 0.9573223649117424, 'loss_val': 0.47110686236167454, 'psi': 0.8793697884840921}-{'f1_val': 0.9700957200012601, 'auprc': 0.991350709749111, 'loss_val': 0.22902500104758372, 'psi': 0.9785977159004005}
[S7] START round=37 head_norm_before_train=1.349529 cos_to_last_merge=1.0000 (last merge round=36)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.4934638963433767, 'auprc': 0.7822658805565115, 'loss_val': 0.874110605135898, 'psi': 0.6089846900286306}-{'f1_val': 0.6243134771407507, 'auprc': 0.8103133208676755, 'loss_val': 0.6154344987774021, 'psi': 0.6987134146315206}
[S8] START round=37 head_norm_before_train=1.499999 cos_to_last_merge=0.9998 (last merge round=35)
[S8] round=37 local utility u=0.013582 metrics={'f1_val': 0.9904283763476012, 'auprc': 0.9991887285113893, 'loss_val': 0.04853829232452465, 'psi': 0.9939325172131164}-{'f1_val': 0.9877803895057649, 'auprc': 0.9989430446055977, 'loss_val': 0.059076400100358396, 'psi': 0.992245451545698}
[S9] START round=37 head_norm_before_train=1.981580 cos_to_last_merge=0.9984 (last merge round=29)
[S9] round=37 local utility u=0.018874 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994518713488321, 'loss_val': 0.021475457530420617, 'psi': 0.9980424960468185}-{'f1_val': 0.9920956129422706, 'auprc': 0.9994555594161119, 'loss_val': 0.029189889388493005, 'psi': 0.9950395915318071}
[S10] START round=37 head_norm_before_train=2.226451 (no previous merge yet)
[S10] round=37 local utility u=0.000422 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995528873312897, 'loss_val': 0.025855543878479673, 'psi': 0.9953242527367836}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953740054936736, 'loss_val': 0.026234471349770045, 'psi': 0.9952623056090943}
[S11] START round=37 head_norm_before_train=1.813439 cos_to_last_merge=0.9836 (last merge round=29)
[S11] round=37 local utility u=0.000000 metrics={'f1_val': 0.9873043426337761, 'auprc': 0.9982151158487655, 'loss_val': 0.07035686646438427, 'psi': 0.9916686519197719}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983766545050148, 'loss_val': 0.03412128248062249, 'psi': 0.9972788645101597}
[S13] START round=37 head_norm_before_train=1.638252 cos_to_last_merge=0.8049 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.805
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.7304874732076596, 'auprc': 0.8357062011385032, 'loss_val': 0.9086897970450659, 'psi': 0.7725749643799971}-{'f1_val': 0.7261141261370149, 'auprc': 0.8606409944298563, 'loss_val': 0.8210187278070711, 'psi': 0.7799248734541515}
[S14] START round=37 head_norm_before_train=1.373784 cos_to_last_merge=0.9791 (last merge round=30)
[S14] round=37 local utility u=0.034041 metrics={'f1_val': 0.9968305862100909, 'auprc': 0.9991486722236371, 'loss_val': 0.14019760927739014, 'psi': 0.9977578206155093}-{'f1_val': 0.9921369149058926, 'auprc': 0.9986777334299707, 'loss_val': 0.17870500557434743, 'psi': 0.9947532423155239}
[S15] START round=37 head_norm_before_train=1.599590 cos_to_last_merge=1.0000 (last merge round=36)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.7603088094766848, 'auprc': 0.990732506777928, 'loss_val': 0.34507139812096305, 'psi': 0.8524782883971821}-{'f1_val': 0.9020263448005295, 'auprc': 0.9963771184189517, 'loss_val': 0.1541250171976179, 'psi': 0.9397666542478984}
[S16] START round=37 head_norm_before_train=1.362355 cos_to_last_merge=1.0000 (last merge round=36)
[S16] round=37 local utility u=0.106755 metrics={'f1_val': 0.9315337220007114, 'auprc': 0.9942477761585949, 'loss_val': 0.28494800368158774, 'psi': 0.9566193436638648}-{'f1_val': 0.9041381423035666, 'auprc': 0.9939542873160611, 'loss_val': 0.3332033303774315, 'psi': 0.9400646003085644}
[S17] START round=37 head_norm_before_train=1.989203 cos_to_last_merge=0.8357 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=37 local utility u=0.213012 metrics={'f1_val': 0.6402090523264438, 'auprc': 0.8978512564599376, 'loss_val': 1.1893058270321268, 'psi': 0.7432659339798413}-{'f1_val': 0.6123955000013133, 'auprc': 0.8665080574583437, 'loss_val': 1.3544183550678681, 'psi': 0.7140405229841255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:58307
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:58313
[S10] sending update (kind=head size=1790 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1790) from S10
[S13] cosine check vs S10: cos=-0.0881
[S13] DROPPED delta from S10 (cos=-0.0881 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.9929
[S6] RECEIVED delta(kind=head bytes=1800) from S9
[S6] cosine check vs S9: cos=0.8114
[S7] RECEIVED delta(kind=head bytes=1799) from S8
[S7] cosine check vs S8: cos=0.8293
[S6] RECEIVED delta(kind=head bytes=1797) from S4
[S6] cosine check vs S4: cos=0.6405
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9322
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:58311
[S17] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S17
[S10] cosine check vs S17: cos=-0.0231
[S10] DROPPED delta from S17 (cos=-0.0231 < 0.0)
[S6] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=37 metric=0.8274 head_norm=1.502610
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.719960e-01
[S6] stored merged vector for next round verification (round=37)
[S6] DEBUG after merge:  round=37 metric=0.8316 head_norm=1.422752 delta_norm=0.271996
[S6] aggregate: ACCEPT kept=['S9', 'S4', 'S16'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=37 metric=0.4935 head_norm=1.376808
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.845199e-01
[S7] stored merged vector for next round verification (round=37)
[S7] DEBUG after merge:  round=37 metric=0.4866 head_norm=1.370112 delta_norm=0.184520
[S7] aggregate: ROLLBACK (f1_val pre=0.493 post=0.487 tol_abs=0.005 tol_rel=0.0)
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S16
[S5]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S13
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S2] START round=38 head_norm_before_train=2.010534 cos_to_last_merge=0.8090 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.809
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.6611515977811905, 'auprc': 0.7069943743212525, 'loss_val': 1.4667198272489559, 'psi': 0.6794887083972152}-{'f1_val': 0.7119287469807609, 'auprc': 0.7213217604008795, 'loss_val': 1.1779648954166795, 'psi': 0.7156859523488084}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=38 head_norm_before_train=2.083632 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9833168046634339, 'auprc': 0.9976968877277778, 'loss_val': 0.08421024741315421, 'psi': 0.9890688378891714}-{'f1_val': 0.9973982357793907, 'auprc': 0.9981806268230784, 'loss_val': 0.04522890042353044, 'psi': 0.9977111921968658}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.797259 cos_to_last_merge=1.0000 (last merge round=36)
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9517839099706283, 'auprc': 0.8938350797605895, 'loss_val': 0.28332693640883677, 'psi': 0.9286043778866128}-{'f1_val': 0.9511680699330647, 'auprc': 0.938837799861191, 'loss_val': 0.27966736850094603, 'psi': 0.9462359619043152}
[S5] START round=38 head_norm_before_train=1.523001 cos_to_last_merge=0.9986 (last merge round=34)
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.9147458397228709, 'auprc': 0.9910999927393531, 'loss_val': 0.15909604902929356, 'psi': 0.9452875009294638}-{'f1_val': 0.565902543148183, 'auprc': 0.8578555714343776, 'loss_val': 0.5122126762389573, 'psi': 0.6826837544626609}
[S6] START round=38 head_norm_before_train=1.422752 cos_to_last_merge=1.0000 (last merge round=37)
[S6] round=38 local utility u=0.181796 metrics={'f1_val': 0.8667426607790629, 'auprc': 0.9696463428914732, 'loss_val': 0.3805335934754549, 'psi': 0.907904133624027}-{'f1_val': 0.8274014041989919, 'auprc': 0.9573223649117424, 'loss_val': 0.47110686236167454, 'psi': 0.8793697884840921}
[S7] START round=38 head_norm_before_train=1.370112 cos_to_last_merge=1.0000 (last merge round=37)
[S7] round=38 local utility u=0.602058 metrics={'f1_val': 0.6268821385455267, 'auprc': 0.812893395630867, 'loss_val': 0.5623866158749133, 'psi': 0.7012866413796628}-{'f1_val': 0.4934638963433767, 'auprc': 0.7822658805565115, 'loss_val': 0.874110605135898, 'psi': 0.6089846900286306}
[S8] START round=38 head_norm_before_train=1.548334 cos_to_last_merge=0.9992 (last merge round=35)
[S8] round=38 local utility u=0.011345 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9991550236690845, 'loss_val': 0.04118799062539534, 'psi': 0.9954630841593062}-{'f1_val': 0.9904283763476012, 'auprc': 0.9991887285113893, 'loss_val': 0.04853829232452465, 'psi': 0.9939325172131164}
[S9] START round=38 head_norm_before_train=1.991962 cos_to_last_merge=0.9982 (last merge round=29)
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9953653401191771, 'loss_val': 0.021799962396658688, 'psi': 0.9961616308065282}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994518713488321, 'loss_val': 0.021475457530420617, 'psi': 0.9980424960468185}
[S10] START round=38 head_norm_before_train=2.236155 (no previous merge yet)
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954274557215029, 'loss_val': 0.026002206678212295, 'psi': 0.9952836857002261}-{'f1_val': 0.9951878390193748, 'auprc': 0.995528873312897, 'loss_val': 0.025855543878479673, 'psi': 0.9953242527367836}
[S11] START round=38 head_norm_before_train=1.834433 cos_to_last_merge=0.9819 (last merge round=29)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.8259675101004856, 'auprc': 0.9967022515863546, 'loss_val': 0.22145410357945966, 'psi': 0.8942614066948332}-{'f1_val': 0.9873043426337761, 'auprc': 0.9982151158487655, 'loss_val': 0.07035686646438427, 'psi': 0.9916686519197719}
[S13] START round=38 head_norm_before_train=1.649117 cos_to_last_merge=0.8031 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.803
[S13] round=38 local utility u=0.017898 metrics={'f1_val': 0.6834701473167114, 'auprc': 0.8834126704904905, 'loss_val': 0.7339085522666574, 'psi': 0.7634471565862231}-{'f1_val': 0.7304874732076596, 'auprc': 0.8357062011385032, 'loss_val': 0.9086897970450659, 'psi': 0.7725749643799971}
[S14] START round=38 head_norm_before_train=1.403467 cos_to_last_merge=0.9752 (last merge round=30)
[S14] round=38 local utility u=0.011769 metrics={'f1_val': 0.9968527342645841, 'auprc': 0.99902504866821, 'loss_val': 0.11642217506109838, 'psi': 0.9977216600260345}-{'f1_val': 0.9968305862100909, 'auprc': 0.9991486722236371, 'loss_val': 0.14019760927739014, 'psi': 0.9977578206155093}
[S15] START round=38 head_norm_before_train=1.662359 cos_to_last_merge=0.9995 (last merge round=36)
[S15] round=38 local utility u=0.605319 metrics={'f1_val': 0.9196130147474966, 'auprc': 0.9958370891925211, 'loss_val': 0.10557310976716784, 'psi': 0.9501026445255064}-{'f1_val': 0.7603088094766848, 'auprc': 0.990732506777928, 'loss_val': 0.34507139812096305, 'psi': 0.8524782883971821}
[S16] START round=38 head_norm_before_train=1.392329 cos_to_last_merge=0.9997 (last merge round=36)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.9267399551873088, 'auprc': 0.994585237492231, 'loss_val': 0.28331054349833196, 'psi': 0.9538780681092778}-{'f1_val': 0.9315337220007114, 'auprc': 0.9942477761585949, 'loss_val': 0.28494800368158774, 'psi': 0.9566193436638648}
[S17] START round=38 head_norm_before_train=2.001456 cos_to_last_merge=0.8341 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6249288377305648, 'auprc': 0.9085164445516337, 'loss_val': 1.1989950671152614, 'psi': 0.7383638804589924}-{'f1_val': 0.6402090523264438, 'auprc': 0.8978512564599376, 'loss_val': 1.1893058270321268, 'psi': 0.7432659339798413}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:58311
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9883
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=-0.0891
[S10] DROPPED delta from S13 (cos=-0.0891 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S8
[S7] cosine check vs S8: cos=0.8945
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[S7] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9667
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=0.9762
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=38 metric=0.6269 head_norm=1.394921
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.577495e-01
[S7] stored merged vector for next round verification (round=38)
[S7] DEBUG after merge:  round=38 metric=0.6245 head_norm=1.456939 delta_norm=0.357750
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=38 metric=0.9267 head_norm=1.428430
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.613864e-01
[S16] stored merged vector for next round verification (round=38)
[S16] DEBUG after merge:  round=38 metric=0.9290 head_norm=1.447920 delta_norm=0.161386
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:58308
[S14] sending update (kind=head size=1799 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=0.8778
[S5] RoundReady barrier timeout: have=2 need=4 — continuing
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9883
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=38 metric=0.9969 head_norm=1.433989
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.834881e-01
[S14] stored merged vector for next round verification (round=38)
[S14] DEBUG after merge:  round=38 metric=0.9969 head_norm=1.402639 delta_norm=0.183488
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S7
[S14]  timeout peer S9
[S11]  timeout peer S4
[S16]  timeout peer S5
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S10
[S4]  timeout peer S6
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=38 metric=0.9147 head_norm=1.528323
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.563772e-01
[S5] stored merged vector for next round verification (round=38)
[S5] DEBUG after merge:  round=38 metric=0.7006 head_norm=1.619210 delta_norm=0.156377
[S5] aggregate: ROLLBACK (f1_val pre=0.915 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S2] START round=39 head_norm_before_train=2.019991 cos_to_last_merge=0.8081 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.808
[S2] round=39 local utility u=0.239098 metrics={'f1_val': 0.68665613914926, 'auprc': 0.7300776879806283, 'loss_val': 1.210800558552555, 'psi': 0.7040247586818074}-{'f1_val': 0.6611515977811905, 'auprc': 0.7069943743212525, 'loss_val': 1.4667198272489559, 'psi': 0.6794887083972152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S2] r=40 psi=0.704 u=0.2391 p_local=0.0748 f1=0.687 auprc=0.730 bytes=34187
[S3] START round=39 head_norm_before_train=2.099461 (no previous merge yet)
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.960651231474942, 'auprc': 0.9983674540618075, 'loss_val': 0.1390272801790963, 'psi': 0.9757377205096882}-{'f1_val': 0.9833168046634339, 'auprc': 0.9976968877277778, 'loss_val': 0.08421024741315421, 'psi': 0.9890688378891714}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.976 u=0.0000 p_local=0.0817 f1=0.961 auprc=0.998 bytes=37785
[S4] START round=39 head_norm_before_train=1.805189 cos_to_last_merge=0.9998 (last merge round=36)
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9513854917519495, 'auprc': 0.8952957230785208, 'loss_val': 0.28675843637769527, 'psi': 0.928949584282578}-{'f1_val': 0.9517839099706283, 'auprc': 0.8938350797605895, 'loss_val': 0.28332693640883677, 'psi': 0.9286043778866128}
[S5] START round=39 head_norm_before_train=1.619210 cos_to_last_merge=1.0000 (last merge round=38)
[S5] round=39 local utility u=0.251075 metrics={'f1_val': 0.9960411108405385, 'auprc': 0.9918036024207848, 'loss_val': 0.1468293614814354, 'psi': 0.9943461074726371}-{'f1_val': 0.9147458397228709, 'auprc': 0.9910999927393531, 'loss_val': 0.15909604902929356, 'psi': 0.9452875009294638}
[S6] START round=39 head_norm_before_train=1.484797 cos_to_last_merge=0.9982 (last merge round=37)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.8543213923770427, 'auprc': 0.9695327427183327, 'loss_val': 0.3449326359119833, 'psi': 0.9004059325135587}-{'f1_val': 0.8667426607790629, 'auprc': 0.9696463428914732, 'loss_val': 0.3805335934754549, 'psi': 0.907904133624027}
[S7] START round=39 head_norm_before_train=1.456939 cos_to_last_merge=1.0000 (last merge round=38)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5186557534878332, 'auprc': 0.7815434519518331, 'loss_val': 0.9273359486606125, 'psi': 0.6238108328734332}-{'f1_val': 0.6268821385455267, 'auprc': 0.812893395630867, 'loss_val': 0.5623866158749133, 'psi': 0.7012866413796628}
[S8] START round=39 head_norm_before_train=1.598596 cos_to_last_merge=0.9982 (last merge round=35)
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9900449566491589, 'auprc': 0.9991108597653748, 'loss_val': 0.04166314389222303, 'psi': 0.9936713178956453}-{'f1_val': 0.9930017911527874, 'auprc': 0.9991550236690845, 'loss_val': 0.04118799062539534, 'psi': 0.9954630841593062}
[S9] START round=39 head_norm_before_train=2.001643 cos_to_last_merge=0.9979 (last merge round=29)
[S9] round=39 local utility u=0.004310 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9994413197688118, 'loss_val': 0.02287941704103763, 'psi': 0.9975391453457684}-{'f1_val': 0.9966924912647621, 'auprc': 0.9953653401191771, 'loss_val': 0.021799962396658688, 'psi': 0.9961616308065282}
[S10] START round=39 head_norm_before_train=2.244763 (no previous merge yet)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953810530603335, 'loss_val': 0.026000805839727335, 'psi': 0.9952651246357582}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954274557215029, 'loss_val': 0.026002206678212295, 'psi': 0.9952836857002261}
[S11] START round=39 head_norm_before_train=1.851675 cos_to_last_merge=0.9805 (last merge round=29)
[S11] round=39 local utility u=0.571091 metrics={'f1_val': 0.9882514296402582, 'auprc': 0.998322800022914, 'loss_val': 0.05783720749451835, 'psi': 0.9922799777933204}-{'f1_val': 0.8259675101004856, 'auprc': 0.9967022515863546, 'loss_val': 0.22145410357945966, 'psi': 0.8942614066948332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S11] r=40 psi=0.992 u=0.5711 p_local=0.1278 f1=0.988 auprc=0.998 bytes=36020
[S13] START round=39 head_norm_before_train=1.659336 cos_to_last_merge=0.8016 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.802
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6401232787059883, 'auprc': 0.8097032599760345, 'loss_val': 0.7259648300292577, 'psi': 0.7079552712140067}-{'f1_val': 0.6834701473167114, 'auprc': 0.8834126704904905, 'loss_val': 0.7339085522666574, 'psi': 0.7634471565862231}
[S14] START round=39 head_norm_before_train=1.402639 cos_to_last_merge=1.0000 (last merge round=38)
[S14] round=39 local utility u=0.000000 metrics={'f1_val': 0.9968732947155414, 'auprc': 0.9987750557974485, 'loss_val': 0.12250441220913087, 'psi': 0.9976339991483043}-{'f1_val': 0.9968527342645841, 'auprc': 0.99902504866821, 'loss_val': 0.11642217506109838, 'psi': 0.9977216600260345}
[S15] START round=39 head_norm_before_train=1.719540 cos_to_last_merge=0.9984 (last merge round=36)
[S15] round=39 local utility u=0.274783 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975828790071186, 'loss_val': 0.024047110157067446, 'psi': 0.9970811526353598}-{'f1_val': 0.9196130147474966, 'auprc': 0.9958370891925211, 'loss_val': 0.10557310976716784, 'psi': 0.9501026445255064}
[S16] START round=39 head_norm_before_train=1.447920 cos_to_last_merge=1.0000 (last merge round=38)
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9225636353166637, 'auprc': 0.9954338646418482, 'loss_val': 0.29376500376721065, 'psi': 0.9517117270467375}-{'f1_val': 0.9267399551873088, 'auprc': 0.994585237492231, 'loss_val': 0.28331054349833196, 'psi': 0.9538780681092778}
[S17] START round=39 head_norm_before_train=2.012154 cos_to_last_merge=0.8337 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5390485267073066, 'auprc': 0.7476859718792254, 'loss_val': 1.6653018280786003, 'psi': 0.6225035047760741}-{'f1_val': 0.6249288377305648, 'auprc': 0.9085164445516337, 'loss_val': 1.1989950671152614, 'psi': 0.7383638804589924}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=40 psi=0.998 u=0.0000 p_local=0.0530 f1=0.997 auprc=0.999 bytes=44966
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[S4] r=40 psi=0.929 u=0.0000 p_local=0.0219 f1=0.951 auprc=0.895 bytes=39610
[S17] r=40 psi=0.623 u=0.0000 p_local=0.1186 f1=0.539 auprc=0.748 bytes=37748
[S13] r=40 psi=0.708 u=0.0000 p_local=0.1133 f1=0.640 auprc=0.810 bytes=37793
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] r=40 psi=0.952 u=0.0000 p_local=0.0503 f1=0.923 auprc=0.995 bytes=35968
[S8] r=40 psi=0.994 u=0.0000 p_local=0.0238 f1=0.990 auprc=0.999 bytes=39589
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9959
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=39 metric=0.9967 head_norm=1.761197
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.799806e-01
[S15] stored merged vector for next round verification (round=39)
[S15] DEBUG after merge:  round=39 metric=0.9967 head_norm=1.639024 delta_norm=0.179981
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=40 psi=0.997 u=0.2748 p_local=0.2270 f1=0.997 auprc=0.998 bytes=39584
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9999
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=39 metric=0.5187 head_norm=1.478359
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.643165e-01
[S7] stored merged vector for next round verification (round=39)
[S7] DEBUG after merge:  round=39 metric=0.5302 head_norm=1.410038 delta_norm=0.364316
[S7] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S7] r=40 psi=0.624 u=0.0000 p_local=0.1723 f1=0.519 auprc=0.782 bytes=35997
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0008 f1=0.995 auprc=0.995 bytes=43111
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=39 metric=0.9960 head_norm=1.622959
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.030240e-01
[S5] stored merged vector for next round verification (round=39)
[S5] DEBUG after merge:  round=39 metric=0.8775 head_norm=1.690352 delta_norm=0.103024
[S5] aggregate: ROLLBACK (f1_val pre=0.996 post=0.878 tol_abs=0.005 tol_rel=0.0)
[S5] r=40 psi=0.994 u=0.2511 p_local=0.2418 f1=0.996 auprc=0.992 bytes=39567
[S6] r=40 psi=0.900 u=0.0000 p_local=0.1992 f1=0.854 auprc=0.970 bytes=34205
[S9] r=40 psi=0.998 u=0.0043 p_local=0.0101 f1=0.996 auprc=0.999 bytes=37777
[S2] START round=40 head_norm_before_train=2.030867 cos_to_last_merge=0.8074 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=40 local utility u=0.125419 metrics={'f1_val': 0.7187602331976604, 'auprc': 0.7258098071565043, 'loss_val': 1.139783552276844, 'psi': 0.7215800627811979}-{'f1_val': 0.68665613914926, 'auprc': 0.7300776879806283, 'loss_val': 1.210800558552555, 'psi': 0.7040247586818074}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=40 head_norm_before_train=2.113751 (no previous merge yet)
[S3] round=40 local utility u=0.158039 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9983360663449197, 'loss_val': 0.04172815413658879, 'psi': 0.9976125588398358}-{'f1_val': 0.960651231474942, 'auprc': 0.9983674540618075, 'loss_val': 0.1390272801790963, 'psi': 0.9757377205096882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=40 head_norm_before_train=1.814275 cos_to_last_merge=0.9998 (last merge round=36)
[S4] round=40 local utility u=0.029442 metrics={'f1_val': 0.9519305433332963, 'auprc': 0.9107946737361547, 'loss_val': 0.2776413585894937, 'psi': 0.9354761954944397}-{'f1_val': 0.9513854917519495, 'auprc': 0.8952957230785208, 'loss_val': 0.28675843637769527, 'psi': 0.928949584282578}
[S5] START round=40 head_norm_before_train=1.690352 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6786342875845313, 'auprc': 0.9650247555828702, 'loss_val': 0.3060207686998657, 'psi': 0.7931904747838668}-{'f1_val': 0.9960411108405385, 'auprc': 0.9918036024207848, 'loss_val': 0.1468293614814354, 'psi': 0.9943461074726371}
[S6] START round=40 head_norm_before_train=1.538940 cos_to_last_merge=0.9949 (last merge round=37)
[S6] round=40 local utility u=0.000000 metrics={'f1_val': 0.7554985563777284, 'auprc': 0.9434743310730522, 'loss_val': 0.5043235793141014, 'psi': 0.830688866255858}-{'f1_val': 0.8543213923770427, 'auprc': 0.9695327427183327, 'loss_val': 0.3449326359119833, 'psi': 0.9004059325135587}
[S7] START round=40 head_norm_before_train=1.410038 cos_to_last_merge=1.0000 (last merge round=39)
[S7] round=40 local utility u=0.727913 metrics={'f1_val': 0.6561099560837726, 'auprc': 0.8328425915705581, 'loss_val': 0.45013175799062827, 'psi': 0.7268030102784868}-{'f1_val': 0.5186557534878332, 'auprc': 0.7815434519518331, 'loss_val': 0.9273359486606125, 'psi': 0.6238108328734332}
[S8] START round=40 head_norm_before_train=1.637511 cos_to_last_merge=0.9971 (last merge round=35)
[S8] round=40 local utility u=0.014678 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9988646492923134, 'loss_val': 0.03443106417036797, 'psi': 0.995859129085312}-{'f1_val': 0.9900449566491589, 'auprc': 0.9991108597653748, 'loss_val': 0.04166314389222303, 'psi': 0.9936713178956453}
[S9] START round=40 head_norm_before_train=2.007331 cos_to_last_merge=0.9976 (last merge round=29)
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9983851161930302, 'loss_val': 0.04896918890102555, 'psi': 0.9920659865354198}-{'f1_val': 0.9962710290637395, 'auprc': 0.9994413197688118, 'loss_val': 0.02287941704103763, 'psi': 0.9975391453457684}
[S10] START round=40 head_norm_before_train=2.248880 (no previous merge yet)
[S10] round=40 local utility u=0.000601 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957013125187121, 'loss_val': 0.02576053739432425, 'psi': 0.9953932284191096}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953810530603335, 'loss_val': 0.026000805839727335, 'psi': 0.9952651246357582}
[S11] START round=40 head_norm_before_train=1.867952 cos_to_last_merge=0.9793 (last merge round=29)
[S11] round=40 local utility u=0.040348 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983334761649734, 'loss_val': 0.02694767751140933, 'psi': 0.9972615931741431}-{'f1_val': 0.9882514296402582, 'auprc': 0.998322800022914, 'loss_val': 0.05783720749451835, 'psi': 0.9922799777933204}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=40 head_norm_before_train=1.666562 cos_to_last_merge=0.8008 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.801
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.599066298776393, 'auprc': 0.7012489938179031, 'loss_val': 1.2452205131237168, 'psi': 0.6399393767929971}-{'f1_val': 0.6401232787059883, 'auprc': 0.8097032599760345, 'loss_val': 0.7259648300292577, 'psi': 0.7079552712140067}
[S14] START round=40 head_norm_before_train=1.430134 cos_to_last_merge=0.9997 (last merge round=38)
[S14] round=40 local utility u=0.001651 metrics={'f1_val': 0.9957953953103202, 'auprc': 0.9984139607765703, 'loss_val': 0.11165269746404553, 'psi': 0.9968428214968204}-{'f1_val': 0.9968732947155414, 'auprc': 0.9987750557974485, 'loss_val': 0.12250441220913087, 'psi': 0.9976339991483043}
[S15] START round=40 head_norm_before_train=1.639024 cos_to_last_merge=1.0000 (last merge round=39)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.8916974870220167, 'auprc': 0.995916936517175, 'loss_val': 0.25092165906747066, 'psi': 0.9333852668200799}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975828790071186, 'loss_val': 0.024047110157067446, 'psi': 0.9970811526353598}
[S16] START round=40 head_norm_before_train=1.483946 cos_to_last_merge=0.9996 (last merge round=38)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9158588239155451, 'auprc': 0.9899213022032513, 'loss_val': 0.3061148801601983, 'psi': 0.9454838152306275}-{'f1_val': 0.9225636353166637, 'auprc': 0.9954338646418482, 'loss_val': 0.29376500376721065, 'psi': 0.9517117270467375}
[S17] START round=40 head_norm_before_train=2.025205 cos_to_last_merge=0.8329 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.4966417087406917, 'auprc': 0.7362341699177196, 'loss_val': 1.5090137275534479, 'psi': 0.5924786932115029}-{'f1_val': 0.5390485267073066, 'auprc': 0.7476859718792254, 'loss_val': 1.6653018280786003, 'psi': 0.6225035047760741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:58312
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:58308
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:58314
[S13] ⇄ pheromone p=0.091 → S10@127.0.0.1:58311
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] ⇄ pheromone p=0.040 → S6@127.0.0.1:58307
[S8] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:58317
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=40 metric=0.8917 head_norm=1.683994
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.178889e-02
[S15] stored merged vector for next round verification (round=40)
[S15] DEBUG after merge:  round=40 metric=0.8917 head_norm=1.653230 delta_norm=0.041789
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.182 → S5@127.0.0.1:58305
[S11] RECEIVED delta(kind=head bytes=1803) from S4
[S11] cosine check vs S4: cos=0.9958
[S7] RECEIVED delta(kind=head bytes=1795) from S8
[S7] cosine check vs S8: cos=0.8915
[S8] ⇄ pheromone p=0.022 → S7@127.0.0.1:58308
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1793 to 1 peers)
[S4] ⇄ pheromone p=0.023 → S11@127.0.0.1:58312
[S7] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1793) from S10
[S17] cosine check vs S10: cos=-0.0212
[S17] DROPPED delta from S10 (cos=-0.0212 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1800) from S7
[S14] cosine check vs S7: cos=0.9874
[S5] ⇄ pheromone p=0.193 → S15@127.0.0.1:58315
[S10] ⇄ pheromone p=0.001 → S17@127.0.0.1:58317
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=40 metric=0.6561 head_norm=1.423827
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.798310e-01
[S7] stored merged vector for next round verification (round=40)
[S7] DEBUG after merge:  round=40 metric=0.6546 head_norm=1.504926 delta_norm=0.379831
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.283 → S14@127.0.0.1:58314
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.159 → S16@127.0.0.1:58316
[S2] START round=41 head_norm_before_train=2.042017 cos_to_last_merge=0.8065 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.807
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.720095423844064, 'auprc': 0.7248733059115631, 'loss_val': 1.1462211556109674, 'psi': 0.7220065766710636}-{'f1_val': 0.7187602331976604, 'auprc': 0.7258098071565043, 'loss_val': 1.139783552276844, 'psi': 0.7215800627811979}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.126637 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9968332416810847, 'auprc': 0.9983912507584107, 'loss_val': 0.05639728268086438, 'psi': 0.9974564453120152}-{'f1_val': 0.9971302205031132, 'auprc': 0.9983360663449197, 'loss_val': 0.04172815413658879, 'psi': 0.9976125588398358}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.821794 cos_to_last_merge=0.9996 (last merge round=36)
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.951184355126777, 'auprc': 0.9027288105529163, 'loss_val': 0.28376030525247276, 'psi': 0.9318021372972327}-{'f1_val': 0.9519305433332963, 'auprc': 0.9107946737361547, 'loss_val': 0.2776413585894937, 'psi': 0.9354761954944397}
[S5] START round=41 head_norm_before_train=1.695573 cos_to_last_merge=1.0000 (last merge round=39)
[S5] round=41 local utility u=1.000000 metrics={'f1_val': 0.995996280939491, 'auprc': 0.9940212441819227, 'loss_val': 0.11083879314763069, 'psi': 0.9952062662364638}-{'f1_val': 0.6786342875845313, 'auprc': 0.9650247555828702, 'loss_val': 0.3060207686998657, 'psi': 0.7931904747838668}
[S6] START round=41 head_norm_before_train=1.579861 cos_to_last_merge=0.9917 (last merge round=37)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7466596208558663, 'auprc': 0.9514965458453295, 'loss_val': 0.6221620282288526, 'psi': 0.8285943908516515}-{'f1_val': 0.7554985563777284, 'auprc': 0.9434743310730522, 'loss_val': 0.5043235793141014, 'psi': 0.830688866255858}
[S7] START round=41 head_norm_before_train=1.504926 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=41 local utility u=0.000000 metrics={'f1_val': 0.6020409333225377, 'auprc': 0.7973316542246062, 'loss_val': 0.661268570054898, 'psi': 0.6801572216833651}-{'f1_val': 0.6561099560837726, 'auprc': 0.8328425915705581, 'loss_val': 0.45013175799062827, 'psi': 0.7268030102784868}
[S8] START round=41 head_norm_before_train=1.670588 cos_to_last_merge=0.9962 (last merge round=35)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9715944828492281, 'auprc': 0.9958622803445607, 'loss_val': 0.07187267299957943, 'psi': 0.9813016018473611}-{'f1_val': 0.9938554489473111, 'auprc': 0.9988646492923134, 'loss_val': 0.03443106417036797, 'psi': 0.995859129085312}
[S9] START round=41 head_norm_before_train=2.013435 cos_to_last_merge=0.9973 (last merge round=29)
[S9] round=41 local utility u=0.043857 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9994535663691867, 'loss_val': 0.019958986647947565, 'psi': 0.9980431740549603}-{'f1_val': 0.9878532334303461, 'auprc': 0.9983851161930302, 'loss_val': 0.04896918890102555, 'psi': 0.9920659865354198}
[S10] START round=41 head_norm_before_train=2.257390 (no previous merge yet)
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953906471067139, 'loss_val': 0.025960839838209782, 'psi': 0.9952689622543104}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957013125187121, 'loss_val': 0.02576053739432425, 'psi': 0.9953932284191096}
[S11] START round=41 head_norm_before_train=1.882743 cos_to_last_merge=0.9781 (last merge round=29)
[S11] round=41 local utility u=0.000307 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982964810178956, 'loss_val': 0.02622195467635154, 'psi': 0.997246795115312}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983334761649734, 'loss_val': 0.02694767751140933, 'psi': 0.9972615931741431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=41 metric=0.9965 head_norm=1.893959
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.648653e-02
[S11] stored merged vector for next round verification (round=41)
[S11] DEBUG after merge:  round=41 metric=0.9965 head_norm=1.855720 delta_norm=0.096487
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] START round=41 head_norm_before_train=1.672561 cos_to_last_merge=0.8001 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.800
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.583369744287291, 'auprc': 0.6459677146011717, 'loss_val': 1.3771466846230282, 'psi': 0.6084089324128433}-{'f1_val': 0.599066298776393, 'auprc': 0.7012489938179031, 'loss_val': 1.2452205131237168, 'psi': 0.6399393767929971}
[S14] START round=41 head_norm_before_train=1.458913 cos_to_last_merge=0.9990 (last merge round=38)
[S14] round=41 local utility u=0.013738 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9988469724259734, 'loss_val': 0.09023113296822616, 'psi': 0.9974915083134761}-{'f1_val': 0.9957953953103202, 'auprc': 0.9984139607765703, 'loss_val': 0.11165269746404553, 'psi': 0.9968428214968204}
[S15] START round=41 head_norm_before_train=1.653230 cos_to_last_merge=1.0000 (last merge round=40)
[S15] round=41 local utility u=0.432733 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9985934147178154, 'loss_val': 0.02600394929556377, 'psi': 0.9977077180039863}-{'f1_val': 0.8916974870220167, 'auprc': 0.995916936517175, 'loss_val': 0.25092165906747066, 'psi': 0.9333852668200799}
[S16] START round=41 head_norm_before_train=1.520268 cos_to_last_merge=0.9984 (last merge round=38)
[S16] round=41 local utility u=0.295608 metrics={'f1_val': 0.9813922913846016, 'auprc': 0.9955096787571648, 'loss_val': 0.12486488792335641, 'psi': 0.9870392463336269}-{'f1_val': 0.9158588239155451, 'auprc': 0.9899213022032513, 'loss_val': 0.3061148801601983, 'psi': 0.9454838152306275}
[S17] START round=41 head_norm_before_train=2.036493 cos_to_last_merge=0.8316 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=41 local utility u=0.611134 metrics={'f1_val': 0.6037862120831434, 'auprc': 0.8713812498370366, 'loss_val': 1.3350539582199694, 'psi': 0.7108242271847007}-{'f1_val': 0.4966417087406917, 'auprc': 0.7362341699177196, 'loss_val': 1.5090137275534479, 'psi': 0.5924786932115029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S16] → sending delta(kind=head bytes=1809) to S6@127.0.0.1:58307
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:58305
[S14] not sending this round → trigger blocked (psi=0.997)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S15] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=41 metric=0.9966 head_norm=1.486487
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.288239e-01
[S14] stored merged vector for next round verification (round=41)
[S14] DEBUG after merge:  round=41 metric=0.9966 head_norm=1.449782 delta_norm=0.128824
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1809 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1804) from S15
[S5] cosine check vs S15: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S17
[S10] cosine check vs S17: cos=-0.0206
[S10] DROPPED delta from S17 (cos=-0.0206 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1809) from S16
[S6] cosine check vs S16: cos=0.9790
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=41 metric=0.9960 head_norm=1.701259
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.410032e-02
[S5] stored merged vector for next round verification (round=41)
[S5] DEBUG after merge:  round=41 metric=0.9960 head_norm=1.701889 delta_norm=0.014100
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=41 metric=0.7467 head_norm=1.612868
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.649775e-01
[S6] stored merged vector for next round verification (round=41)
[S6] DEBUG after merge:  round=41 metric=0.7513 head_norm=1.574796 delta_norm=0.164977
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=2.051732 cos_to_last_merge=0.8059 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7190376346521301, 'auprc': 0.7246334891638697, 'loss_val': 1.1438743620799388, 'psi': 0.721275976456826}-{'f1_val': 0.720095423844064, 'auprc': 0.7248733059115631, 'loss_val': 1.1462211556109674, 'psi': 0.7220065766710636}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=42 head_norm_before_train=2.139710 (no previous merge yet)
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.9613297054499484, 'auprc': 0.9958883059864776, 'loss_val': 0.10775630167311459, 'psi': 0.9751531456645601}-{'f1_val': 0.9968332416810847, 'auprc': 0.9983912507584107, 'loss_val': 0.05639728268086438, 'psi': 0.9974564453120152}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.832429 cos_to_last_merge=0.9995 (last merge round=36)
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9514535090783288, 'auprc': 0.8988829905255129, 'loss_val': 0.28685947152494706, 'psi': 0.9304253016572025}-{'f1_val': 0.951184355126777, 'auprc': 0.9027288105529163, 'loss_val': 0.28376030525247276, 'psi': 0.9318021372972327}
[S5] START round=42 head_norm_before_train=1.701889 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7005797538498719, 'auprc': 0.9894206631045338, 'loss_val': 0.24455911149459927, 'psi': 0.8161161175517366}-{'f1_val': 0.995996280939491, 'auprc': 0.9940212441819227, 'loss_val': 0.11083879314763069, 'psi': 0.9952062662364638}
[S6] START round=42 head_norm_before_train=1.574796 cos_to_last_merge=1.0000 (last merge round=41)
[S6] round=42 local utility u=0.163451 metrics={'f1_val': 0.7797367893595859, 'auprc': 0.9533789558755237, 'loss_val': 0.4993697701618396, 'psi': 0.849193655965961}-{'f1_val': 0.7466596208558663, 'auprc': 0.9514965458453295, 'loss_val': 0.6221620282288526, 'psi': 0.8285943908516515}
[S7] START round=42 head_norm_before_train=1.516813 cos_to_last_merge=1.0000 (last merge round=40)
[S7] round=42 local utility u=0.012737 metrics={'f1_val': 0.60198215725548, 'auprc': 0.7975535004108835, 'loss_val': 0.63610758660902, 'psi': 0.6802106945176414}-{'f1_val': 0.6020409333225377, 'auprc': 0.7973316542246062, 'loss_val': 0.661268570054898, 'psi': 0.6801572216833651}
[S8] START round=42 head_norm_before_train=1.693562 cos_to_last_merge=0.9955 (last merge round=35)
[S8] round=42 local utility u=0.066475 metrics={'f1_val': 0.9906348967524765, 'auprc': 0.9945450234583869, 'loss_val': 0.04921292475905229, 'psi': 0.9921989474348406}-{'f1_val': 0.9715944828492281, 'auprc': 0.9958622803445607, 'loss_val': 0.07187267299957943, 'psi': 0.9813016018473611}
[S9] START round=42 head_norm_before_train=2.021514 cos_to_last_merge=0.9970 (last merge round=29)
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9946069829493691, 'auprc': 0.9994676809881449, 'loss_val': 0.024181776110141242, 'psi': 0.9965512621648793}-{'f1_val': 0.9971029125121428, 'auprc': 0.9994535663691867, 'loss_val': 0.019958986647947565, 'psi': 0.9980431740549603}
[S10] START round=42 head_norm_before_train=2.267286 (no previous merge yet)
[S10] round=42 local utility u=0.000282 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955557810900594, 'loss_val': 0.025892977166034746, 'psi': 0.9953350158476486}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953906471067139, 'loss_val': 0.025960839838209782, 'psi': 0.9952689622543104}
[S11] START round=42 head_norm_before_train=1.855720 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9982304045632082, 'loss_val': 0.03372956423387676, 'psi': 0.9960660915192292}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982964810178956, 'loss_val': 0.02622195467635154, 'psi': 0.997246795115312}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.679877 cos_to_last_merge=0.7992 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.799
[S13] round=42 local utility u=0.834983 metrics={'f1_val': 0.7039849891979548, 'auprc': 0.8346514825292514, 'loss_val': 0.9969235233431923, 'psi': 0.7562515865304735}-{'f1_val': 0.583369744287291, 'auprc': 0.6459677146011717, 'loss_val': 1.3771466846230282, 'psi': 0.6084089324128433}
[S14] START round=42 head_norm_before_train=1.449782 cos_to_last_merge=1.0000 (last merge round=41)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.9991473741126593, 'loss_val': 0.10191779495278304, 'psi': 0.9974792485084545}-{'f1_val': 0.9965878655718112, 'auprc': 0.9988469724259734, 'loss_val': 0.09023113296822616, 'psi': 0.9974915083134761}
[S15] START round=42 head_norm_before_train=1.702636 cos_to_last_merge=0.9997 (last merge round=40)
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.9840934723770813, 'auprc': 0.9961180012301026, 'loss_val': 0.045387804445277714, 'psi': 0.9889032839182899}-{'f1_val': 0.9971172535281002, 'auprc': 0.9985934147178154, 'loss_val': 0.02600394929556377, 'psi': 0.9977077180039863}
[S16] START round=42 head_norm_before_train=1.553402 cos_to_last_merge=0.9969 (last merge round=38)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.9465796774425597, 'auprc': 0.993285719383073, 'loss_val': 0.14376485494923266, 'psi': 0.965262094218765}-{'f1_val': 0.9813922913846016, 'auprc': 0.9955096787571648, 'loss_val': 0.12486488792335641, 'psi': 0.9870392463336269}
[S17] START round=42 head_norm_before_train=2.048991 cos_to_last_merge=0.8310 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=42 local utility u=0.280525 metrics={'f1_val': 0.6403509664115037, 'auprc': 0.9475194217682648, 'loss_val': 1.2218072140825262, 'psi': 0.7632183485542081}-{'f1_val': 0.6037862120831434, 'auprc': 0.8713812498370366, 'loss_val': 1.3350539582199694, 'psi': 0.7108242271847007}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.763)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=42 metric=0.9841 head_norm=1.740758
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.893753e-02
[S15] stored merged vector for next round verification (round=42)
[S15] DEBUG after merge:  round=42 metric=0.9841 head_norm=1.720879 delta_norm=0.028938
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:58314
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S17@127.0.0.1:58317
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=-0.0894
[S10] DROPPED delta from S13 (cos=-0.0894 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9751
[S10] sending update (kind=head size=1791 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[S7] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1791) from S10
[S17] cosine check vs S10: cos=-0.0203
[S17] DROPPED delta from S10 (cos=-0.0203 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S7
[S14] cosine check vs S7: cos=0.9387
[S6] sending update (kind=head size=1798 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=0.9910
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=42 metric=0.6020 head_norm=1.528418
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.033276e-01
[S7] stored merged vector for next round verification (round=42)
[S7] DEBUG after merge:  round=42 metric=0.5990 head_norm=1.611464 delta_norm=0.203328
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=2.056202 cos_to_last_merge=0.8059 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7189296833361787, 'auprc': 0.724531396736847, 'loss_val': 1.1513850402828387, 'psi': 0.721170368696446}-{'f1_val': 0.7190376346521301, 'auprc': 0.7246334891638697, 'loss_val': 1.1438743620799388, 'psi': 0.721275976456826}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.152044 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9994941989002817, 'loss_val': 0.13544342709250448, 'psi': 0.9764668339008041}-{'f1_val': 0.9613297054499484, 'auprc': 0.9958883059864776, 'loss_val': 0.10775630167311459, 'psi': 0.9751531456645601}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.841326 cos_to_last_merge=0.9993 (last merge round=36)
[S4] round=43 local utility u=0.057241 metrics={'f1_val': 0.954441542765604, 'auprc': 0.9253937509906935, 'loss_val': 0.2698379321874859, 'psi': 0.9428224260556397}-{'f1_val': 0.9514535090783288, 'auprc': 0.8988829905255129, 'loss_val': 0.28685947152494706, 'psi': 0.9304253016572025}
[S5] START round=43 head_norm_before_train=1.706776 cos_to_last_merge=1.0000 (last merge round=41)
[S5] round=43 local utility u=0.034288 metrics={'f1_val': 0.7155036299295499, 'auprc': 0.9889464317114067, 'loss_val': 0.2641031873560906, 'psi': 0.8248807506422926}-{'f1_val': 0.7005797538498719, 'auprc': 0.9894206631045338, 'loss_val': 0.24455911149459927, 'psi': 0.8161161175517366}
[S6] START round=43 head_norm_before_train=1.596454 cos_to_last_merge=0.9995 (last merge round=41)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7778812519735573, 'auprc': 0.9577605917968135, 'loss_val': 0.5917280108764945, 'psi': 0.8498329879028598}-{'f1_val': 0.7797367893595859, 'auprc': 0.9533789558755237, 'loss_val': 0.4993697701618396, 'psi': 0.849193655965961}
[S7] START round=43 head_norm_before_train=1.611464 cos_to_last_merge=1.0000 (last merge round=42)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.6011261180737956, 'auprc': 0.796790975579627, 'loss_val': 0.6672533135833502, 'psi': 0.6793920610761282}-{'f1_val': 0.60198215725548, 'auprc': 0.7975535004108835, 'loss_val': 0.63610758660902, 'psi': 0.6802106945176414}
[S8] START round=43 head_norm_before_train=1.714717 cos_to_last_merge=0.9947 (last merge round=35)
[S8] round=43 local utility u=0.000000 metrics={'f1_val': 0.9842601283770251, 'auprc': 0.9964549366686138, 'loss_val': 0.04875664613369745, 'psi': 0.9891380516936605}-{'f1_val': 0.9906348967524765, 'auprc': 0.9945450234583869, 'loss_val': 0.04921292475905229, 'psi': 0.9921989474348406}
[S9] START round=43 head_norm_before_train=2.029586 cos_to_last_merge=0.9967 (last merge round=29)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9920956129422706, 'auprc': 0.9994741158250049, 'loss_val': 0.02806950801159785, 'psi': 0.9950470140953642}-{'f1_val': 0.9946069829493691, 'auprc': 0.9994676809881449, 'loss_val': 0.024181776110141242, 'psi': 0.9965512621648793}
[S10] START round=43 head_norm_before_train=2.271583 (no previous merge yet)
[S10] round=43 local utility u=0.000406 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957944568879451, 'loss_val': 0.025796532422167298, 'psi': 0.9954304861668029}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955557810900594, 'loss_val': 0.025892977166034746, 'psi': 0.9953350158476486}
[S11] START round=43 head_norm_before_train=1.866814 cos_to_last_merge=1.0000 (last merge round=41)
[S11] round=43 local utility u=0.000190 metrics={'f1_val': 0.9946232161565767, 'auprc': 0.9982408537634082, 'loss_val': 0.03338132425893252, 'psi': 0.9960702711993092}-{'f1_val': 0.9946232161565767, 'auprc': 0.9982304045632082, 'loss_val': 0.03372956423387676, 'psi': 0.9960660915192292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=43 head_norm_before_train=1.686155 cos_to_last_merge=0.7985 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.799
[S13] round=43 local utility u=0.010395 metrics={'f1_val': 0.670938047076725, 'auprc': 0.8489723764186208, 'loss_val': 0.8208140646205814, 'psi': 0.7421517788134833}-{'f1_val': 0.7039849891979548, 'auprc': 0.8346514825292514, 'loss_val': 0.9969235233431923, 'psi': 0.7562515865304735}
[S14] START round=43 head_norm_before_train=1.473963 cos_to_last_merge=0.9998 (last merge round=41)
[S14] round=43 local utility u=0.006626 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9988389726568051, 'loss_val': 0.08906501473583525, 'psi': 0.9974883084058088}-{'f1_val': 0.9963671647723179, 'auprc': 0.9991473741126593, 'loss_val': 0.10191779495278304, 'psi': 0.9974792485084545}
[S15] START round=43 head_norm_before_train=1.720879 cos_to_last_merge=1.0000 (last merge round=42)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.9002368544678405, 'auprc': 0.9961377091467664, 'loss_val': 0.2273978829564445, 'psi': 0.9385971963394109}-{'f1_val': 0.9840934723770813, 'auprc': 0.9961180012301026, 'loss_val': 0.045387804445277714, 'psi': 0.9889032839182899}
[S16] START round=43 head_norm_before_train=1.582820 cos_to_last_merge=0.9953 (last merge round=38)
[S16] round=43 local utility u=0.153677 metrics={'f1_val': 0.9907237767477616, 'auprc': 0.9851591430366337, 'loss_val': 0.07689594944852882, 'psi': 0.9884979232633104}-{'f1_val': 0.9465796774425597, 'auprc': 0.993285719383073, 'loss_val': 0.14376485494923266, 'psi': 0.965262094218765}
[S17] START round=43 head_norm_before_train=2.060044 cos_to_last_merge=0.8301 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.830
[S17] round=43 local utility u=0.717736 metrics={'f1_val': 0.8059511561684216, 'auprc': 0.9673660196307003, 'loss_val': 0.8394769972554893, 'psi': 0.8705171015533331}-{'f1_val': 0.6403509664115037, 'auprc': 0.9475194217682648, 'loss_val': 1.2218072140825262, 'psi': 0.7632183485542081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:58311
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:58312
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S13] not sending this round → trigger blocked (psi=0.742)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=43 metric=0.9966 head_norm=1.497137
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.733223e-01
[S14] stored merged vector for next round verification (round=43)
[S14] DEBUG after merge:  round=43 metric=0.9966 head_norm=1.487963 delta_norm=0.273322
[S14] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1806 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:58315
[S17] sending update (kind=head size=1802 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.995)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9873
[S11] RECEIVED delta(kind=head bytes=1806) from S4
[S11] cosine check vs S4: cos=0.9977
[S10] RECEIVED delta(kind=head bytes=1802) from S17
[S10] cosine check vs S17: cos=-0.0199
[S10] DROPPED delta from S17 (cos=-0.0199 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=43 metric=0.9907 head_norm=1.608455
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.163404e-01
[S16] stored merged vector for next round verification (round=43)
[S16] DEBUG after merge:  round=43 metric=0.9909 head_norm=1.598237 delta_norm=0.116340
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9994
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=43 metric=0.7779 head_norm=1.619650
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.288735e-01
[S6] stored merged vector for next round verification (round=43)
[S6] DEBUG after merge:  round=43 metric=0.7807 head_norm=1.608909 delta_norm=0.128873
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=2.065503 cos_to_last_merge=0.8055 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.805
[S2] round=44 local utility u=0.000000 metrics={'f1_val': 0.718155922540718, 'auprc': 0.7257292234390139, 'loss_val': 1.1512639860856373, 'psi': 0.7211852429000364}-{'f1_val': 0.7189296833361787, 'auprc': 0.724531396736847, 'loss_val': 1.1513850402828387, 'psi': 0.721170368696446}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=44 head_norm_before_train=2.160337 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.7209642020457416, 'auprc': 0.9978657044691799, 'loss_val': 0.35178546855931986, 'psi': 0.831724803015117}-{'f1_val': 0.9611152572344858, 'auprc': 0.9994941989002817, 'loss_val': 0.13544342709250448, 'psi': 0.9764668339008041}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.847618 cos_to_last_merge=0.9991 (last merge round=36)
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9503432140338294, 'auprc': 0.894163308525188, 'loss_val': 0.29198869848020725, 'psi': 0.9278712518303729}-{'f1_val': 0.954441542765604, 'auprc': 0.9253937509906935, 'loss_val': 0.2698379321874859, 'psi': 0.9428224260556397}
[S5] START round=44 head_norm_before_train=1.712430 cos_to_last_merge=0.9998 (last merge round=41)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7029607488664021, 'auprc': 0.9899735155820825, 'loss_val': 0.20172898444263948, 'psi': 0.8177658555526743}-{'f1_val': 0.7155036299295499, 'auprc': 0.9889464317114067, 'loss_val': 0.2641031873560906, 'psi': 0.8248807506422926}
[S6] START round=44 head_norm_before_train=1.608909 cos_to_last_merge=1.0000 (last merge round=43)
[S6] round=44 local utility u=0.480303 metrics={'f1_val': 0.8752812579058933, 'auprc': 0.9887041063880868, 'loss_val': 0.3083534608833614, 'psi': 0.9206503972987707}-{'f1_val': 0.7778812519735573, 'auprc': 0.9577605917968135, 'loss_val': 0.5917280108764945, 'psi': 0.8498329879028598}
[S7] START round=44 head_norm_before_train=1.626050 cos_to_last_merge=0.9999 (last merge round=42)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.5479836402809095, 'auprc': 0.7842934373974826, 'loss_val': 0.9030790847180471, 'psi': 0.6425075591275388}-{'f1_val': 0.6011261180737956, 'auprc': 0.796790975579627, 'loss_val': 0.6672533135833502, 'psi': 0.6793920610761282}
[S8] START round=44 head_norm_before_train=1.733788 cos_to_last_merge=0.9940 (last merge round=35)
[S8] round=44 local utility u=0.031544 metrics={'f1_val': 0.9929047892228047, 'auprc': 0.997124105631574, 'loss_val': 0.03954426628632555, 'psi': 0.9945925157863125}-{'f1_val': 0.9842601283770251, 'auprc': 0.9964549366686138, 'loss_val': 0.04875664613369745, 'psi': 0.9891380516936605}
[S9] START round=44 head_norm_before_train=2.037194 cos_to_last_merge=0.9965 (last merge round=29)
[S9] round=44 local utility u=0.005090 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9913118682148387, 'loss_val': 0.020983188270307238, 'psi': 0.9945402420447929}-{'f1_val': 0.9920956129422706, 'auprc': 0.9994741158250049, 'loss_val': 0.02806950801159785, 'psi': 0.9950470140953642}
[S10] START round=44 head_norm_before_train=2.277476 (no previous merge yet)
[S10] round=44 local utility u=0.000089 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995827723146657, 'loss_val': 0.025717779761905698, 'psi': 0.9954437926702877}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957944568879451, 'loss_val': 0.025796532422167298, 'psi': 0.9954304861668029}
[S11] START round=44 head_norm_before_train=1.878917 cos_to_last_merge=0.9999 (last merge round=41)
[S11] round=44 local utility u=0.008940 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982591680982855, 'loss_val': 0.02709962831996269, 'psi': 0.9972318699474679}-{'f1_val': 0.9946232161565767, 'auprc': 0.9982408537634082, 'loss_val': 0.03338132425893252, 'psi': 0.9960702711993092}
[S11] not sending this round → trigger blocked (psi=0.997)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=44 metric=0.9965 head_norm=1.892333
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.102960e-02
[S11] stored merged vector for next round verification (round=44)
[S11] DEBUG after merge:  round=44 metric=0.9965 head_norm=1.868759 delta_norm=0.071030
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S13] START round=44 head_norm_before_train=1.692004 cos_to_last_merge=0.7978 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.798
[S13] round=44 local utility u=0.044983 metrics={'f1_val': 0.7123015740889629, 'auprc': 0.837097656989757, 'loss_val': 0.9434052126046196, 'psi': 0.7622200072492805}-{'f1_val': 0.670938047076725, 'auprc': 0.8489723764186208, 'loss_val': 0.8208140646205814, 'psi': 0.7421517788134833}
[S14] START round=44 head_norm_before_train=1.487963 cos_to_last_merge=1.0000 (last merge round=43)
[S14] round=44 local utility u=0.000000 metrics={'f1_val': 0.9966100132760906, 'auprc': 0.9988621833562584, 'loss_val': 0.11108967700525176, 'psi': 0.9975108813081577}-{'f1_val': 0.9965878655718112, 'auprc': 0.9988389726568051, 'loss_val': 0.08906501473583525, 'psi': 0.9974883084058088}
[S15] START round=44 head_norm_before_train=1.759882 cos_to_last_merge=0.9999 (last merge round=42)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.900471005325273, 'auprc': 0.9956412268713907, 'loss_val': 0.23357897983207346, 'psi': 0.93853909394372}-{'f1_val': 0.9002368544678405, 'auprc': 0.9961377091467664, 'loss_val': 0.2273978829564445, 'psi': 0.9385971963394109}
[S16] START round=44 head_norm_before_train=1.598237 cos_to_last_merge=1.0000 (last merge round=43)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9850528505073376, 'auprc': 0.9866390249592278, 'loss_val': 0.11081856230506987, 'psi': 0.9856873202880936}-{'f1_val': 0.9907237767477616, 'auprc': 0.9851591430366337, 'loss_val': 0.07689594944852882, 'psi': 0.9884979232633104}
[S17] START round=44 head_norm_before_train=2.071081 cos_to_last_merge=0.8292 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.829
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6165226435837581, 'auprc': 0.929002337844379, 'loss_val': 1.32468449380797, 'psi': 0.7415145212880064}-{'f1_val': 0.8059511561684216, 'auprc': 0.9673660196307003, 'loss_val': 0.8394769972554893, 'psi': 0.8705171015533331}
[S14]  timeout peer S11
[S5]  timeout peer S14
[S9]  timeout peer S6
[S9]  timeout peer S17
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:58308
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S17@127.0.0.1:58317
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=44 metric=0.9005 head_norm=1.797618
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.896580e-02
[S15] stored merged vector for next round verification (round=44)
[S15] DEBUG after merge:  round=44 metric=0.9005 head_norm=1.754550 delta_norm=0.058966
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S7] RECEIVED delta(kind=head bytes=1797) from S8
[S7] cosine check vs S8: cos=0.9933
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=-0.0900
[S10] DROPPED delta from S13 (cos=-0.0900 < 0.0)
[S10] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S17] RECEIVED delta(kind=head bytes=1793) from S10
[S17] cosine check vs S10: cos=-0.0196
[S17] DROPPED delta from S10 (cos=-0.0196 < 0.0)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=44 metric=0.5480 head_norm=1.637140
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.131699e-01
[S7] stored merged vector for next round verification (round=44)
[S7] DEBUG after merge:  round=44 metric=0.5463 head_norm=1.690986 delta_norm=0.113170
[S7] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.9995
[S6]  timeout peer S4
[S6]  timeout peer S9
[S13]  timeout peer S10
[S8]  timeout peer S7
[S4]  timeout peer S11
[S10]  timeout peer S17
[S7]  timeout peer S14
[S2] START round=45 head_norm_before_train=2.071544 cos_to_last_merge=0.8044 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7179915133407144, 'auprc': 0.7258616293839361, 'loss_val': 1.1533570993032949, 'psi': 0.721139559758003}-{'f1_val': 0.718155922540718, 'auprc': 0.7257292234390139, 'loss_val': 1.1512639860856373, 'psi': 0.7211852429000364}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.167909 (no previous merge yet)
[S3] round=45 local utility u=0.993923 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9992500768811595, 'loss_val': 0.026870111022732214, 'psi': 0.9981563083243984}-{'f1_val': 0.7209642020457416, 'auprc': 0.9978657044691799, 'loss_val': 0.35178546855931986, 'psi': 0.831724803015117}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=45 head_norm_before_train=1.851410 cos_to_last_merge=0.9989 (last merge round=36)
[S4] round=45 local utility u=0.060859 metrics={'f1_val': 0.9560765933562718, 'auprc': 0.9193911756102111, 'loss_val': 0.2803553554491522, 'psi': 0.9414024262578475}-{'f1_val': 0.9503432140338294, 'auprc': 0.894163308525188, 'loss_val': 0.29198869848020725, 'psi': 0.9278712518303729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=45 head_norm_before_train=1.720676 cos_to_last_merge=0.9996 (last merge round=41)
[S5] round=45 local utility u=0.039017 metrics={'f1_val': 0.7160071894413007, 'auprc': 0.989223533477745, 'loss_val': 0.19972419795317953, 'psi': 0.8252937270558784}-{'f1_val': 0.7029607488664021, 'auprc': 0.9899735155820825, 'loss_val': 0.20172898444263948, 'psi': 0.8177658555526743}
[S6] START round=45 head_norm_before_train=1.625764 cos_to_last_merge=0.9999 (last merge round=43)
[S6] round=45 local utility u=0.000000 metrics={'f1_val': 0.7791588655868165, 'auprc': 0.9569447188567111, 'loss_val': 0.525934157673248, 'psi': 0.8502732068947743}-{'f1_val': 0.8752812579058933, 'auprc': 0.9887041063880868, 'loss_val': 0.3083534608833614, 'psi': 0.9206503972987707}
[S7] START round=45 head_norm_before_train=1.690986 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=45 local utility u=0.760052 metrics={'f1_val': 0.6793028810688639, 'auprc': 0.8447884009711456, 'loss_val': 0.35237517021442005, 'psi': 0.7454970890297766}-{'f1_val': 0.5479836402809095, 'auprc': 0.7842934373974826, 'loss_val': 0.9030790847180471, 'psi': 0.6425075591275388}
[S8] START round=45 head_norm_before_train=1.750500 cos_to_last_merge=0.9933 (last merge round=35)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.8122459125317356, 'auprc': 0.9965995479303986, 'loss_val': 0.4845929370610761, 'psi': 0.8859873666912008}-{'f1_val': 0.9929047892228047, 'auprc': 0.997124105631574, 'loss_val': 0.03954426628632555, 'psi': 0.9945925157863125}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=45 head_norm_before_train=2.043458 cos_to_last_merge=0.9962 (last merge round=29)
[S9] round=45 local utility u=0.011199 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9994795591575361, 'loss_val': 0.020559262993745133, 'psi': 0.9975544411012581}-{'f1_val': 0.9966924912647621, 'auprc': 0.9913118682148387, 'loss_val': 0.020983188270307238, 'psi': 0.9945402420447929}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=45 head_norm_before_train=2.283895 (no previous merge yet)
[S10] round=45 local utility u=0.000474 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961071727634075, 'loss_val': 0.025607612649697558, 'psi': 0.9955555725169878}-{'f1_val': 0.9951878390193748, 'auprc': 0.995827723146657, 'loss_val': 0.025717779761905698, 'psi': 0.9954437926702877}
[S11] START round=45 head_norm_before_train=1.868759 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=45 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980948736936586, 'loss_val': 0.027796388228871156, 'psi': 0.9971661521856172}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982591680982855, 'loss_val': 0.02709962831996269, 'psi': 0.9972318699474679}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=45 head_norm_before_train=1.697625 cos_to_last_merge=0.7971 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.797
[S13] round=45 local utility u=0.000000 metrics={'f1_val': 0.5874680181797469, 'auprc': 0.6422707849875119, 'loss_val': 1.336325257783341, 'psi': 0.6093891249028529}-{'f1_val': 0.7123015740889629, 'auprc': 0.837097656989757, 'loss_val': 0.9434052126046196, 'psi': 0.7622200072492805}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=45 head_norm_before_train=1.509643 cos_to_last_merge=0.9997 (last merge round=43)
[S14] round=45 local utility u=0.008464 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.999031441095445, 'loss_val': 0.09453734687526827, 'psi': 0.9975652957812646}-{'f1_val': 0.9966100132760906, 'auprc': 0.9988621833562584, 'loss_val': 0.11108967700525176, 'psi': 0.9975108813081577}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=45 head_norm_before_train=1.754550 cos_to_last_merge=1.0000 (last merge round=44)
[S15] round=45 local utility u=0.037764 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.99583429061014, 'loss_val': 0.1679620570311258, 'psi': 0.9395495231243737}-{'f1_val': 0.900471005325273, 'auprc': 0.9956412268713907, 'loss_val': 0.23357897983207346, 'psi': 0.93853909394372}
[S16] START round=45 head_norm_before_train=1.622026 cos_to_last_merge=0.9999 (last merge round=43)
[S16] round=45 local utility u=0.000000 metrics={'f1_val': 0.9384109486986293, 'auprc': 0.9956779647492707, 'loss_val': 0.2003386281450328, 'psi': 0.9613177551188858}-{'f1_val': 0.9850528505073376, 'auprc': 0.9866390249592278, 'loss_val': 0.11081856230506987, 'psi': 0.9856873202880936}
[S17] START round=45 head_norm_before_train=2.080125 cos_to_last_merge=0.8284 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=45 local utility u=0.326880 metrics={'f1_val': 0.6539022242454282, 'auprc': 0.918092476857842, 'loss_val': 0.8624723674579053, 'psi': 0.7595783252903937}-{'f1_val': 0.6165226435837581, 'auprc': 0.929002337844379, 'loss_val': 1.32468449380797, 'psi': 0.7415145212880064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:58309
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:58313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[S5] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] ⇄ pheromone p=0.146 → S16@127.0.0.1:58316
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=45 metric=0.9384 head_norm=1.644820
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.502696e-02
[S16] stored merged vector for next round verification (round=45)
[S16] DEBUG after merge:  round=45 metric=0.9386 head_norm=1.634944 delta_norm=0.035027
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.057 → S6@127.0.0.1:58307
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9987
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=-0.0907
[S13] DROPPED delta from S10 (cos=-0.0907 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1803) from S7
[S8] cosine check vs S7: cos=0.9982
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0192
[S10] DROPPED delta from S17 (cos=-0.0192 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9987
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=45 metric=0.9020 head_norm=1.789020
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.352573e-02
[S15] stored merged vector for next round verification (round=45)
[S15] DEBUG after merge:  round=45 metric=0.9020 head_norm=1.758633 delta_norm=0.053526
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.102 → S5@127.0.0.1:58305
[S17] ⇄ pheromone p=0.267 → S10@127.0.0.1:58311
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:58313
[S7] ⇄ pheromone p=0.246 → S8@127.0.0.1:58309
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=45 metric=0.7160 head_norm=1.729368
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.352572e-02
[S5] stored merged vector for next round verification (round=45)
[S5] DEBUG after merge:  round=45 metric=0.7009 head_norm=1.758633 delta_norm=0.053526
[S5] aggregate: ROLLBACK (f1_val pre=0.716 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.158 → S15@127.0.0.1:58315
[S2] START round=46 head_norm_before_train=2.078882 cos_to_last_merge=0.8036 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.804
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.7169905758994436, 'auprc': 0.7261983040495041, 'loss_val': 1.1596627113590838, 'psi': 0.7206736671594678}-{'f1_val': 0.7179915133407144, 'auprc': 0.7258616293839361, 'loss_val': 1.1533570993032949, 'psi': 0.721139559758003}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.176843 (no previous merge yet)
[S3] round=46 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9962059666061487, 'loss_val': 0.1298808614956516, 'psi': 0.9751035373057256}-{'f1_val': 0.9974271292865575, 'auprc': 0.9992500768811595, 'loss_val': 0.026870111022732214, 'psi': 0.9981563083243984}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=46 head_norm_before_train=1.859226 cos_to_last_merge=0.9988 (last merge round=36)
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9550031000012301, 'auprc': 0.9152684005244314, 'loss_val': 0.2892718346086127, 'psi': 0.9391092202105107}-{'f1_val': 0.9560765933562718, 'auprc': 0.9193911756102111, 'loss_val': 0.2803553554491522, 'psi': 0.9414024262578475}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=1.758633 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=46 local utility u=0.892370 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9900717737181207, 'loss_val': 0.09948773227684193, 'psi': 0.9938289966653824}-{'f1_val': 0.7160071894413007, 'auprc': 0.989223533477745, 'loss_val': 0.19972419795317953, 'psi': 0.8252937270558784}
[S6] START round=46 head_norm_before_train=1.642507 cos_to_last_merge=0.9996 (last merge round=43)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.5996125194462911, 'auprc': 0.9537408483425636, 'loss_val': 0.8381810637290202, 'psi': 0.7412638510048001}-{'f1_val': 0.7791588655868165, 'auprc': 0.9569447188567111, 'loss_val': 0.525934157673248, 'psi': 0.8502732068947743}
[S7] START round=46 head_norm_before_train=1.700654 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.4377467426774405, 'auprc': 0.7810785776277394, 'loss_val': 1.24487938116195, 'psi': 0.5750794766575601}-{'f1_val': 0.6793028810688639, 'auprc': 0.8447884009711456, 'loss_val': 0.35237517021442005, 'psi': 0.7454970890297766}
[S8] START round=46 head_norm_before_train=1.763240 cos_to_last_merge=0.9929 (last merge round=35)
[S8] round=46 local utility u=0.774547 metrics={'f1_val': 0.9944609296138943, 'auprc': 0.9975741390012292, 'loss_val': 0.03171377852870354, 'psi': 0.9957062133688284}-{'f1_val': 0.8122459125317356, 'auprc': 0.9965995479303986, 'loss_val': 0.4845929370610761, 'psi': 0.8859873666912008}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9945 head_norm=1.775006
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.671598e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9945 head_norm=1.736947 delta_norm=0.066716
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=46 head_norm_before_train=2.049160 cos_to_last_merge=0.9960 (last merge round=29)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9984417610652974, 'loss_val': 0.047580030341551866, 'psi': 0.9920886444843267}-{'f1_val': 0.9962710290637395, 'auprc': 0.9994795591575361, 'loss_val': 0.020559262993745133, 'psi': 0.9975544411012581}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=2.287247 (no previous merge yet)
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960724061275853, 'loss_val': 0.02563528062697493, 'psi': 0.995541665862659}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961071727634075, 'loss_val': 0.025607612649697558, 'psi': 0.9955555725169878}
[S11] START round=46 head_norm_before_train=1.879769 cos_to_last_merge=1.0000 (last merge round=44)
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9948632634592205, 'auprc': 0.9984088431682223, 'loss_val': 0.0320295080537424, 'psi': 0.9962814953428212}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980948736936586, 'loss_val': 0.027796388228871156, 'psi': 0.9971661521856172}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.706247 cos_to_last_merge=0.7963 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=46 local utility u=0.334033 metrics={'f1_val': 0.6182974929040806, 'auprc': 0.7332468704326619, 'loss_val': 1.1261643325350605, 'psi': 0.6642772439155131}-{'f1_val': 0.5874680181797469, 'auprc': 0.6422707849875119, 'loss_val': 1.336325257783341, 'psi': 0.6093891249028529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=46 head_norm_before_train=1.533679 cos_to_last_merge=0.9987 (last merge round=43)
[S14] round=46 local utility u=0.005560 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9988448264983727, 'loss_val': 0.0817914539026403, 'psi': 0.9973841124532727}-{'f1_val': 0.9965878655718112, 'auprc': 0.999031441095445, 'loss_val': 0.09453734687526827, 'psi': 0.9975652957812646}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=46 head_norm_before_train=1.758633 cos_to_last_merge=1.0000 (last merge round=45)
[S15] round=46 local utility u=0.000000 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.9963544678639674, 'loss_val': 0.20304226693067684, 'psi': 0.9397575940259046}-{'f1_val': 0.9020263448005295, 'auprc': 0.99583429061014, 'loss_val': 0.1679620570311258, 'psi': 0.9395495231243737}
[S16] START round=46 head_norm_before_train=1.634944 cos_to_last_merge=1.0000 (last merge round=45)
[S16] round=46 local utility u=0.208898 metrics={'f1_val': 0.9910031911646648, 'auprc': 0.9872973027580804, 'loss_val': 0.07295345396004971, 'psi': 0.9895208358020311}-{'f1_val': 0.9384109486986293, 'auprc': 0.9956779647492707, 'loss_val': 0.2003386281450328, 'psi': 0.9613177551188858}
[S17] START round=46 head_norm_before_train=2.087120 cos_to_last_merge=0.8279 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.828
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5600028602284558, 'auprc': 0.8139800524984637, 'loss_val': 1.3961209171060622, 'psi': 0.661593737136459}-{'f1_val': 0.6539022242454282, 'auprc': 0.918092476857842, 'loss_val': 0.8624723674579053, 'psi': 0.7595783252903937}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.994)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1806) from S16
[S6] cosine check vs S16: cos=0.9987
[S2] START round=47 head_norm_before_train=2.085656 cos_to_last_merge=0.8031 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.803
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.7113701531785264, 'auprc': 0.7259892096122379, 'loss_val': 1.1351418687732666, 'psi': 0.717217775752011}-{'f1_val': 0.7169905758994436, 'auprc': 0.7261983040495041, 'loss_val': 1.1596627113590838, 'psi': 0.7206736671594678}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.185533 (no previous merge yet)
[S3] round=47 local utility u=0.158610 metrics={'f1_val': 0.9952873006695607, 'auprc': 0.9986370038328067, 'loss_val': 0.025465279739503206, 'psi': 0.9966271819348591}-{'f1_val': 0.9610352511054436, 'auprc': 0.9962059666061487, 'loss_val': 0.1298808614956516, 'psi': 0.9751035373057256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=47 head_norm_before_train=1.864343 cos_to_last_merge=0.9985 (last merge round=36)
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9524961912690496, 'auprc': 0.9094411454410584, 'loss_val': 0.2954002929529082, 'psi': 0.9352741729378531}-{'f1_val': 0.9550031000012301, 'auprc': 0.9152684005244314, 'loss_val': 0.2892718346086127, 'psi': 0.9391092202105107}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.764428 cos_to_last_merge=1.0000 (last merge round=45)
[S5] round=47 local utility u=0.004345 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9915322073934187, 'loss_val': 0.09517900248169693, 'psi': 0.9944131701355016}-{'f1_val': 0.9963338119635569, 'auprc': 0.9900717737181207, 'loss_val': 0.09948773227684193, 'psi': 0.9938289966653824}
[S6] START round=47 head_norm_before_train=1.660240 cos_to_last_merge=0.9991 (last merge round=43)
[S6] round=47 local utility u=1.000000 metrics={'f1_val': 0.8672846146190644, 'auprc': 0.9727186626500036, 'loss_val': 0.3561749780622691, 'psi': 0.9094582338314401}-{'f1_val': 0.5996125194462911, 'auprc': 0.9537408483425636, 'loss_val': 0.8381810637290202, 'psi': 0.7412638510048001}
[S7] START round=47 head_norm_before_train=1.706611 cos_to_last_merge=1.0000 (last merge round=44)
[S7] round=47 local utility u=1.000000 metrics={'f1_val': 0.695285727409584, 'auprc': 0.9239074002056566, 'loss_val': 0.2099981439210123, 'psi': 0.7867343965280131}-{'f1_val': 0.4377467426774405, 'auprc': 0.7810785776277394, 'loss_val': 1.24487938116195, 'psi': 0.5750794766575601}
[S8] START round=47 head_norm_before_train=1.736947 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.8937968428026011, 'auprc': 0.9930779872742127, 'loss_val': 0.2196139324378511, 'psi': 0.9335093005912458}-{'f1_val': 0.9944609296138943, 'auprc': 0.9975741390012292, 'loss_val': 0.03171377852870354, 'psi': 0.9957062133688284}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=2.055804 cos_to_last_merge=0.9958 (last merge round=29)
[S9] round=47 local utility u=0.033532 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9937418770345211, 'loss_val': 0.019452689201374867, 'psi': 0.9955122455726657}-{'f1_val': 0.9878532334303461, 'auprc': 0.9984417610652974, 'loss_val': 0.047580030341551866, 'psi': 0.9920886444843267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=47 head_norm_before_train=2.295267 (no previous merge yet)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959461999729146, 'loss_val': 0.025588060024408575, 'psi': 0.9954911834007907}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960724061275853, 'loss_val': 0.02563528062697493, 'psi': 0.995541665862659}
[S11] START round=47 head_norm_before_train=1.891188 cos_to_last_merge=0.9999 (last merge round=44)
[S11] round=47 local utility u=0.007634 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998372366269084, 'loss_val': 0.026754400868320045, 'psi': 0.9972771492157874}-{'f1_val': 0.9948632634592205, 'auprc': 0.9984088431682223, 'loss_val': 0.0320295080537424, 'psi': 0.9962814953428212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=47 head_norm_before_train=1.712115 cos_to_last_merge=0.7958 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.796
[S13] round=47 local utility u=0.139852 metrics={'f1_val': 0.6422412474393449, 'auprc': 0.7500903322075743, 'loss_val': 1.0406522579630293, 'psi': 0.6853808813466367}-{'f1_val': 0.6182974929040806, 'auprc': 0.7332468704326619, 'loss_val': 1.1261643325350605, 'psi': 0.6642772439155131}
[S13] not sending this round → trigger blocked (psi=0.685)
[S14] START round=47 head_norm_before_train=1.558006 cos_to_last_merge=0.9974 (last merge round=43)
[S14] round=47 local utility u=0.000474 metrics={'f1_val': 0.9961505794277568, 'auprc': 0.9973824254623807, 'loss_val': 0.07489693460595646, 'psi': 0.9966433178416063}-{'f1_val': 0.9964103030898727, 'auprc': 0.9988448264983727, 'loss_val': 0.0817914539026403, 'psi': 0.9973841124532727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=47 head_norm_before_train=1.792951 cos_to_last_merge=0.9999 (last merge round=45)
[S15] round=47 local utility u=0.376796 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978028664896321, 'loss_val': 0.022117804858550198, 'psi': 0.9971691476283652}-{'f1_val': 0.9020263448005295, 'auprc': 0.9963544678639674, 'loss_val': 0.20304226693067684, 'psi': 0.9397575940259046}
[S16] START round=47 head_norm_before_train=1.654373 cos_to_last_merge=0.9999 (last merge round=45)
[S16] round=47 local utility u=0.004950 metrics={'f1_val': 0.9921142625696234, 'auprc': 0.9931814325871043, 'loss_val': 0.08737245731035717, 'psi': 0.9925411305766157}-{'f1_val': 0.9910031911646648, 'auprc': 0.9872973027580804, 'loss_val': 0.07295345396004971, 'psi': 0.9895208358020311}
[S17] START round=47 head_norm_before_train=2.094403 cos_to_last_merge=0.8274 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=47 local utility u=0.997144 metrics={'f1_val': 0.7336656221904534, 'auprc': 0.9631998524904062, 'loss_val': 0.8914685634551508, 'psi': 0.8254793143104344}-{'f1_val': 0.5600028602284558, 'auprc': 0.8139800524984637, 'loss_val': 1.3961209171060622, 'psi': 0.661593737136459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9994
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9994
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0185
[S10] DROPPED delta from S17 (cos=-0.0185 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.9975
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.9993
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=47 metric=0.9967 head_norm=1.828825
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.311455e-02
[S15] stored merged vector for next round verification (round=47)
[S15] DEBUG after merge:  round=47 metric=0.9967 head_norm=1.799514 delta_norm=0.043115
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=47 metric=0.9963 head_norm=1.770767
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.311455e-02
[S5] stored merged vector for next round verification (round=47)
[S5] DEBUG after merge:  round=47 metric=0.9963 head_norm=1.799514 delta_norm=0.043115
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=47 metric=0.8673 head_norm=1.681774
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.561743e-02
[S6] stored merged vector for next round verification (round=47)
[S6] DEBUG after merge:  round=47 metric=0.8676 head_norm=1.667203 delta_norm=0.055617
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=2.091644 cos_to_last_merge=0.8022 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.802
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7172819842718939, 'auprc': 0.7226113751275957, 'loss_val': 1.17969940791525, 'psi': 0.7194137406141746}-{'f1_val': 0.7113701531785264, 'auprc': 0.7259892096122379, 'loss_val': 1.1351418687732666, 'psi': 0.717217775752011}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.194965 (no previous merge yet)
[S3] round=48 local utility u=0.006141 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9985182624804739, 'loss_val': 0.022853502570397508, 'psi': 0.9975823285539867}-{'f1_val': 0.9952873006695607, 'auprc': 0.9986370038328067, 'loss_val': 0.025465279739503206, 'psi': 0.9966271819348591}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=48 head_norm_before_train=1.873794 cos_to_last_merge=0.9983 (last merge round=36)
[S4] round=48 local utility u=0.085136 metrics={'f1_val': 0.951608581149011, 'auprc': 0.9624725603173621, 'loss_val': 0.2788959923643999, 'psi': 0.9559541728163514}-{'f1_val': 0.9524961912690496, 'auprc': 0.9094411454410584, 'loss_val': 0.2954002929529082, 'psi': 0.9352741729378531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=48 head_norm_before_train=1.799514 cos_to_last_merge=1.0000 (last merge round=47)
[S5] round=48 local utility u=0.012814 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9928703703320712, 'loss_val': 0.07356637296267894, 'psi': 0.9949484353109626}-{'f1_val': 0.9963338119635569, 'auprc': 0.9915322073934187, 'loss_val': 0.09517900248169693, 'psi': 0.9944131701355016}
[S6] START round=48 head_norm_before_train=1.667203 cos_to_last_merge=1.0000 (last merge round=47)
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.6276011231804827, 'auprc': 0.9564214435015991, 'loss_val': 0.7504300729211841, 'psi': 0.7591292513089292}-{'f1_val': 0.8672846146190644, 'auprc': 0.9727186626500036, 'loss_val': 0.3561749780622691, 'psi': 0.9094582338314401}
[S7] START round=48 head_norm_before_train=1.711437 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5443504783264096, 'auprc': 0.78096660501603, 'loss_val': 0.9041537773145624, 'psi': 0.6389969290022578}-{'f1_val': 0.695285727409584, 'auprc': 0.9239074002056566, 'loss_val': 0.2099981439210123, 'psi': 0.7867343965280131}
[S8] START round=48 head_norm_before_train=1.747461 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.406994 metrics={'f1_val': 0.9950789820710053, 'auprc': 0.9991284904554951, 'loss_val': 0.03147055758221047, 'psi': 0.9966987854248013}-{'f1_val': 0.8937968428026011, 'auprc': 0.9930779872742127, 'loss_val': 0.2196139324378511, 'psi': 0.9335093005912458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=48 metric=0.9951 head_norm=1.752739
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.997007e-02
[S8] stored merged vector for next round verification (round=48)
[S8] DEBUG after merge:  round=48 metric=0.9951 head_norm=1.731750 delta_norm=0.039970
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=48 head_norm_before_train=2.061805 cos_to_last_merge=0.9955 (last merge round=29)
[S9] round=48 local utility u=0.001587 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9947952022330897, 'loss_val': 0.019438085378801456, 'psi': 0.9959335756520932}-{'f1_val': 0.9966924912647621, 'auprc': 0.9937418770345211, 'loss_val': 0.019452689201374867, 'psi': 0.9955122455726657}
[S9] not sending this round → trigger blocked (psi=0.996)
[S10] START round=48 head_norm_before_train=2.304711 (no previous merge yet)
[S10] round=48 local utility u=0.001054 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996569999079202, 'loss_val': 0.025352269654457686, 'psi': 0.9957407030433056}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959461999729146, 'loss_val': 0.025588060024408575, 'psi': 0.9954911834007907}
[S11] START round=48 head_norm_before_train=1.904447 cos_to_last_merge=0.9998 (last merge round=44)
[S11] round=48 local utility u=0.000702 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983874238430439, 'loss_val': 0.025395722675438107, 'psi': 0.9972831722453713}-{'f1_val': 0.9965470045135896, 'auprc': 0.998372366269084, 'loss_val': 0.026754400868320045, 'psi': 0.9972771492157874}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=48 head_norm_before_train=1.721312 cos_to_last_merge=0.7946 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.795
[S13] round=48 local utility u=0.201180 metrics={'f1_val': 0.6888423126553639, 'auprc': 0.7739742405420562, 'loss_val': 0.989549907069178, 'psi': 0.7228950838100409}-{'f1_val': 0.6422412474393449, 'auprc': 0.7500903322075743, 'loss_val': 1.0406522579630293, 'psi': 0.6853808813466367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=48 head_norm_before_train=1.580884 cos_to_last_merge=0.9958 (last merge round=43)
[S14] round=48 local utility u=0.007676 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9988337851519276, 'loss_val': 0.06545667278758166, 'psi': 0.9973796959146946}-{'f1_val': 0.9961505794277568, 'auprc': 0.9973824254623807, 'loss_val': 0.07489693460595646, 'psi': 0.9966433178416063}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=48 head_norm_before_train=1.799514 cos_to_last_merge=1.0000 (last merge round=47)
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.900471005325273, 'auprc': 0.995791878047427, 'loss_val': 0.2205105767922167, 'psi': 0.9385993544141346}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978028664896321, 'loss_val': 0.022117804858550198, 'psi': 0.9971691476283652}
[S16] START round=48 head_norm_before_train=1.671621 cos_to_last_merge=0.9998 (last merge round=45)
[S16] round=48 local utility u=0.009628 metrics={'f1_val': 0.9918426177823569, 'auprc': 0.9910718162599806, 'loss_val': 0.06015706464501729, 'psi': 0.9915342971734065}-{'f1_val': 0.9921142625696234, 'auprc': 0.9931814325871043, 'loss_val': 0.08737245731035717, 'psi': 0.9925411305766157}
[S17] START round=48 head_norm_before_train=2.102205 cos_to_last_merge=0.8269 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.827
[S17] round=48 local utility u=0.524259 metrics={'f1_val': 0.8524412555342882, 'auprc': 0.9868322219656726, 'loss_val': 0.6265008852778037, 'psi': 0.9061976421068418}-{'f1_val': 0.7336656221904534, 'auprc': 0.9631998524904062, 'loss_val': 0.8914685634551508, 'psi': 0.8254793143104344}
[S17] not sending this round → trigger blocked (psi=0.906)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.995)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:58313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S16] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=-0.0922
[S13] DROPPED delta from S10 (cos=-0.0922 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9982
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=48 metric=0.9918 head_norm=1.689246
[S16] _apply_head_vector_avg (torch): Δ‖w‖=6.428536e-02
[S16] stored merged vector for next round verification (round=48)
[S16] DEBUG after merge:  round=48 metric=0.9918 head_norm=1.684288 delta_norm=0.064285
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=2.101068 cos_to_last_merge=0.8012 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.6789119795588068, 'auprc': 0.7152872628709954, 'loss_val': 1.372480764112144, 'psi': 0.6934620928836822}-{'f1_val': 0.7172819842718939, 'auprc': 0.7226113751275957, 'loss_val': 1.17969940791525, 'psi': 0.7194137406141746}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.204725 (no previous merge yet)
[S3] round=49 local utility u=0.002581 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9985606485566292, 'loss_val': 0.020286155846543027, 'psi': 0.997846078017704}-{'f1_val': 0.9969583726029951, 'auprc': 0.9985182624804739, 'loss_val': 0.022853502570397508, 'psi': 0.9975823285539867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=49 head_norm_before_train=1.877481 cos_to_last_merge=0.9981 (last merge round=36)
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9537323370889723, 'auprc': 0.9169248989159714, 'loss_val': 0.2978111358136482, 'psi': 0.9390093618197719}-{'f1_val': 0.951608581149011, 'auprc': 0.9624725603173621, 'loss_val': 0.2788959923643999, 'psi': 0.9559541728163514}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.807670 cos_to_last_merge=0.9999 (last merge round=47)
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9911362700417232, 'loss_val': 0.0746166718619085, 'psi': 0.9942547951948233}-{'f1_val': 0.9963338119635569, 'auprc': 0.9928703703320712, 'loss_val': 0.07356637296267894, 'psi': 0.9949484353109626}
[S6] START round=49 head_norm_before_train=1.690312 cos_to_last_merge=0.9998 (last merge round=47)
[S6] round=49 local utility u=0.062838 metrics={'f1_val': 0.6466228452171627, 'auprc': 0.9535766286991816, 'loss_val': 0.7303498361107179, 'psi': 0.7694043586099703}-{'f1_val': 0.6276011231804827, 'auprc': 0.9564214435015991, 'loss_val': 0.7504300729211841, 'psi': 0.7591292513089292}
[S7] START round=49 head_norm_before_train=1.714056 cos_to_last_merge=0.9999 (last merge round=44)
[S7] round=49 local utility u=0.415777 metrics={'f1_val': 0.6248565987399923, 'auprc': 0.7965894521442773, 'loss_val': 0.6025049974345584, 'psi': 0.6935497401017063}-{'f1_val': 0.5443504783264096, 'auprc': 0.78096660501603, 'loss_val': 0.9041537773145624, 'psi': 0.6389969290022578}
[S8] START round=49 head_norm_before_train=1.731750 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=49 local utility u=0.000000 metrics={'f1_val': 0.9924605795656339, 'auprc': 0.9960232863914732, 'loss_val': 0.03919829071112813, 'psi': 0.9938856622959695}-{'f1_val': 0.9950789820710053, 'auprc': 0.9991284904554951, 'loss_val': 0.03147055758221047, 'psi': 0.9966987854248013}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=49 head_norm_before_train=2.065868 cos_to_last_merge=0.9954 (last merge round=29)
[S9] round=49 local utility u=0.005100 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9994522221775641, 'loss_val': 0.02067951659115454, 'psi': 0.9975435063092694}-{'f1_val': 0.9966924912647621, 'auprc': 0.9947952022330897, 'loss_val': 0.019438085378801456, 'psi': 0.9959335756520932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=49 head_norm_before_train=2.307104 (no previous merge yet)
[S10] round=49 local utility u=0.000049 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966546774418087, 'loss_val': 0.02550734855091815, 'psi': 0.9957745743883484}-{'f1_val': 0.9951878390193748, 'auprc': 0.996569999079202, 'loss_val': 0.025352269654457686, 'psi': 0.9957407030433056}
[S11] START round=49 head_norm_before_train=1.918210 cos_to_last_merge=0.9997 (last merge round=44)
[S11] round=49 local utility u=0.000450 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.998367671019939, 'loss_val': 0.0244367934681511, 'psi': 0.9972752711161293}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983874238430439, 'loss_val': 0.025395722675438107, 'psi': 0.9972831722453713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=49 head_norm_before_train=1.731941 cos_to_last_merge=0.7932 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.793
[S13] round=49 local utility u=0.000000 metrics={'f1_val': 0.6046512286372456, 'auprc': 0.6095045865602342, 'loss_val': 1.3509100069306261, 'psi': 0.6065925718064411}-{'f1_val': 0.6888423126553639, 'auprc': 0.7739742405420562, 'loss_val': 0.989549907069178, 'psi': 0.7228950838100409}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=49 head_norm_before_train=1.602411 cos_to_last_merge=0.9942 (last merge round=43)
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9955431652744149, 'loss_val': 0.06145043004179772, 'psi': 0.9959055704285682}-{'f1_val': 0.9964103030898727, 'auprc': 0.9988337851519276, 'loss_val': 0.06545667278758166, 'psi': 0.9973796959146946}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.833994 cos_to_last_merge=0.9999 (last merge round=47)
[S15] round=49 local utility u=0.260715 metrics={'f1_val': 0.9604408222142897, 'auprc': 0.9975393601331987, 'loss_val': 0.0641421464222787, 'psi': 0.9752802373818532}-{'f1_val': 0.900471005325273, 'auprc': 0.995791878047427, 'loss_val': 0.2205105767922167, 'psi': 0.9385993544141346}
[S16] START round=49 head_norm_before_train=1.684288 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.9898285659876136, 'auprc': 0.995892732213538, 'loss_val': 0.07747845923984262, 'psi': 0.9922542324779834}-{'f1_val': 0.9918426177823569, 'auprc': 0.9910718162599806, 'loss_val': 0.06015706464501729, 'psi': 0.9915342971734065}
[S17] START round=49 head_norm_before_train=2.111369 cos_to_last_merge=0.8262 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.8191162307216986, 'auprc': 0.9766184452380704, 'loss_val': 0.8282035197338792, 'psi': 0.8821171165282473}-{'f1_val': 0.8524412555342882, 'auprc': 0.9868322219656726, 'loss_val': 0.6265008852778037, 'psi': 0.9061976421068418}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:58309
[S10] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1797) from S7
[S8] cosine check vs S7: cos=0.9997
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.9992
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=0.9993
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=49 metric=0.6466 head_norm=1.713585
[S6] _apply_head_vector_avg (torch): Δ‖w‖=6.233743e-02
[S6] stored merged vector for next round verification (round=49)
[S6] DEBUG after merge:  round=49 metric=0.6466 head_norm=1.700317 delta_norm=0.062337
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=2.111253 cos_to_last_merge=0.8006 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.801
[S2] round=50 local utility u=0.219476 metrics={'f1_val': 0.7184980525148621, 'auprc': 0.7116964436568716, 'loss_val': 1.160273457521129, 'psi': 0.715777408971666}-{'f1_val': 0.6789119795588068, 'auprc': 0.7152872628709954, 'loss_val': 1.372480764112144, 'psi': 0.6934620928836822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=50 head_norm_before_train=2.211469 (no previous merge yet)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9987210224831279, 'loss_val': 0.12307485408019869, 'psi': 0.9761095596565172}-{'f1_val': 0.9973696976584205, 'auprc': 0.9985606485566292, 'loss_val': 0.020286155846543027, 'psi': 0.997846078017704}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.880890 cos_to_last_merge=0.9978 (last merge round=36)
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9514780336083958, 'auprc': 0.9076705797656934, 'loss_val': 0.2878466382244624, 'psi': 0.9339550520713149}-{'f1_val': 0.9537323370889723, 'auprc': 0.9169248989159714, 'loss_val': 0.2978111358136482, 'psi': 0.9390093618197719}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.819357 cos_to_last_merge=0.9997 (last merge round=47)
[S5] round=50 local utility u=0.001881 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9896803821373266, 'loss_val': 0.06648609605475238, 'psi': 0.9936724400330648}-{'f1_val': 0.9963338119635569, 'auprc': 0.9911362700417232, 'loss_val': 0.0746166718619085, 'psi': 0.9942547951948233}
[S6] START round=50 head_norm_before_train=1.700317 cos_to_last_merge=1.0000 (last merge round=49)
[S6] round=50 local utility u=0.341844 metrics={'f1_val': 0.7180326771414711, 'auprc': 0.9678800906022953, 'loss_val': 0.5180308875753106, 'psi': 0.8179716425258008}-{'f1_val': 0.6466228452171627, 'auprc': 0.9535766286991816, 'loss_val': 0.7303498361107179, 'psi': 0.7694043586099703}
[S7] START round=50 head_norm_before_train=1.716703 cos_to_last_merge=0.9998 (last merge round=44)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.5661425252234431, 'auprc': 0.7823883926972535, 'loss_val': 0.8280891658224734, 'psi': 0.6526408722129673}-{'f1_val': 0.6248565987399923, 'auprc': 0.7965894521442773, 'loss_val': 0.6025049974345584, 'psi': 0.6935497401017063}
[S8] START round=50 head_norm_before_train=1.742302 cos_to_last_merge=1.0000 (last merge round=48)
[S8] round=50 local utility u=0.001714 metrics={'f1_val': 0.9932310084044783, 'auprc': 0.9935115310656188, 'loss_val': 0.032856789435100384, 'psi': 0.9933432174689345}-{'f1_val': 0.9924605795656339, 'auprc': 0.9960232863914732, 'loss_val': 0.03919829071112813, 'psi': 0.9938856622959695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=50 metric=0.9932 head_norm=1.762637
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.512017e-02
[S8] stored merged vector for next round verification (round=50)
[S8] DEBUG after merge:  round=50 metric=0.9932 head_norm=1.739467 delta_norm=0.035120
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=50 head_norm_before_train=2.071195 cos_to_last_merge=0.9951 (last merge round=29)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9993735788202481, 'loss_val': 0.03860417004765128, 'psi': 0.9935852005165808}-{'f1_val': 0.9962710290637395, 'auprc': 0.9994522221775641, 'loss_val': 0.02067951659115454, 'psi': 0.9975435063092694}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=2.314031 (no previous merge yet)
[S10] round=50 local utility u=0.000527 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969608833736848, 'loss_val': 0.025372049599540182, 'psi': 0.9958970567610987}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966546774418087, 'loss_val': 0.02550734855091815, 'psi': 0.9957745743883484}
[S11] START round=50 head_norm_before_train=1.931766 cos_to_last_merge=0.9996 (last merge round=44)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9948632634592205, 'auprc': 0.9984057183638582, 'loss_val': 0.028155894114210493, 'psi': 0.9962802454210755}-{'f1_val': 0.9965470045135896, 'auprc': 0.998367671019939, 'loss_val': 0.0244367934681511, 'psi': 0.9972752711161293}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.743959 cos_to_last_merge=0.7920 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.792
[S13] round=50 local utility u=0.498208 metrics={'f1_val': 0.6421692299961732, 'auprc': 0.758972558986035, 'loss_val': 1.0280049742304693, 'psi': 0.6888905615921179}-{'f1_val': 0.6046512286372456, 'auprc': 0.6095045865602342, 'loss_val': 1.3509100069306261, 'psi': 0.6065925718064411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=50 head_norm_before_train=1.621076 cos_to_last_merge=0.9927 (last merge round=43)
[S14] round=50 local utility u=0.009690 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986798129348886, 'loss_val': 0.05412443812881762, 'psi': 0.9974246445170422}-{'f1_val': 0.9961471738646706, 'auprc': 0.9955431652744149, 'loss_val': 0.06145043004179772, 'psi': 0.9959055704285682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=50 head_norm_before_train=1.864571 cos_to_last_merge=0.9997 (last merge round=47)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9337231388858398, 'auprc': 0.9975390922267838, 'loss_val': 0.09704977329451293, 'psi': 0.9592495202222173}-{'f1_val': 0.9604408222142897, 'auprc': 0.9975393601331987, 'loss_val': 0.0641421464222787, 'psi': 0.9752802373818532}
[S16] START round=50 head_norm_before_train=1.701949 cos_to_last_merge=1.0000 (last merge round=48)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8558814051029805, 'auprc': 0.9882892175893813, 'loss_val': 0.5775056087205336, 'psi': 0.9088445300975407}-{'f1_val': 0.9898285659876136, 'auprc': 0.995892732213538, 'loss_val': 0.07747845923984262, 'psi': 0.9922542324779834}
[S17] START round=50 head_norm_before_train=2.119443 cos_to_last_merge=0.8262 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.7575601575266849, 'auprc': 0.9725039341952509, 'loss_val': 0.9452544380307218, 'psi': 0.8435376681941114}-{'f1_val': 0.8191162307216986, 'auprc': 0.9766184452380704, 'loss_val': 0.8282035197338792, 'psi': 0.8821171165282473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:58313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:58315
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.818)
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] ⇄ pheromone p=0.229 → S16@127.0.0.1:58316
[S7] ⇄ pheromone p=0.250 → S8@127.0.0.1:58309
[S17] ⇄ pheromone p=0.257 → S10@127.0.0.1:58311
[S10] sending update (kind=head size=1792 to 1 peers)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=50 metric=0.8559 head_norm=1.717476
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.000263e-02
[S16] stored merged vector for next round verification (round=50)
[S16] DEBUG after merge:  round=50 metric=0.8565 head_norm=1.715065 delta_norm=0.040003
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.038 → S6@127.0.0.1:58307
[S15] ⇄ pheromone p=0.114 → S5@127.0.0.1:58305
[S15] RECEIVED delta(kind=head bytes=1803) from S5
[S15] cosine check vs S5: cos=0.9986
[S13] RECEIVED delta(kind=head bytes=1792) from S10
[S13] cosine check vs S10: cos=-0.0938
[S13] DROPPED delta from S10 (cos=-0.0938 < 0.0)
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:58313
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=50 metric=0.9963 head_norm=1.830595
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.564907e-02
[S5] stored merged vector for next round verification (round=50)
[S5] DEBUG after merge:  round=50 metric=0.9963 head_norm=1.847097 delta_norm=0.045649
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.127 → S15@127.0.0.1:58315
[S2] START round=51 head_norm_before_train=2.113724 cos_to_last_merge=0.8003 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=51 local utility u=0.015595 metrics={'f1_val': 0.6997553642342357, 'auprc': 0.7417641873799539, 'loss_val': 1.1068299435489144, 'psi': 0.716558893492523}-{'f1_val': 0.7184980525148621, 'auprc': 0.7116964436568716, 'loss_val': 1.160273457521129, 'psi': 0.715777408971666}
[S2] not sending this round → trigger blocked (psi=0.717)
[S3] START round=51 head_norm_before_train=2.216628 (no previous merge yet)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9947749452661064, 'loss_val': 0.13626875851501927, 'psi': 0.9745311287697087}-{'f1_val': 0.9610352511054436, 'auprc': 0.9987210224831279, 'loss_val': 0.12307485408019869, 'psi': 0.9761095596565172}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.889795 cos_to_last_merge=0.9974 (last merge round=36)
[S4] round=51 local utility u=0.000000 metrics={'f1_val': 0.9507710218012925, 'auprc': 0.9036740090495833, 'loss_val': 0.288367621645828, 'psi': 0.9319322167006088}-{'f1_val': 0.9514780336083958, 'auprc': 0.9076705797656934, 'loss_val': 0.2878466382244624, 'psi': 0.9339550520713149}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=51 head_norm_before_train=1.847097 cos_to_last_merge=1.0000 (last merge round=50)
[S5] round=51 local utility u=0.003131 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9896767011587558, 'loss_val': 0.060213134469710404, 'psi': 0.9936709676416364}-{'f1_val': 0.9963338119635569, 'auprc': 0.9896803821373266, 'loss_val': 0.06648609605475238, 'psi': 0.9936724400330648}
[S6] START round=51 head_norm_before_train=1.716502 cos_to_last_merge=0.9999 (last merge round=49)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.6530814607973671, 'auprc': 0.9560177984141087, 'loss_val': 0.6677023977416053, 'psi': 0.7742559958440638}-{'f1_val': 0.7180326771414711, 'auprc': 0.9678800906022953, 'loss_val': 0.5180308875753106, 'psi': 0.8179716425258008}
[S7] START round=51 head_norm_before_train=1.719412 cos_to_last_merge=0.9998 (last merge round=44)
[S7] round=51 local utility u=0.288681 metrics={'f1_val': 0.6168435750552855, 'auprc': 0.7961259966089123, 'loss_val': 0.5961467576227211, 'psi': 0.6885565436767362}-{'f1_val': 0.5661425252234431, 'auprc': 0.7823883926972535, 'loss_val': 0.8280891658224734, 'psi': 0.6526408722129673}
[S8] START round=51 head_norm_before_train=1.739467 cos_to_last_merge=1.0000 (last merge round=50)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9423273692484533, 'auprc': 0.9969582341857819, 'loss_val': 0.143498088263746, 'psi': 0.9641797152233847}-{'f1_val': 0.9932310084044783, 'auprc': 0.9935115310656188, 'loss_val': 0.032856789435100384, 'psi': 0.9933432174689345}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.077667 cos_to_last_merge=0.9949 (last merge round=29)
[S9] round=51 local utility u=0.019165 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9994907804605017, 'loss_val': 0.02590534740619721, 'psi': 0.9961599397826089}-{'f1_val': 0.9897262816474692, 'auprc': 0.9993735788202481, 'loss_val': 0.03860417004765128, 'psi': 0.9935852005165808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=51 head_norm_before_train=2.318993 (no previous merge yet)
[S10] round=51 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969604541582614, 'loss_val': 0.025375888150224627, 'psi': 0.9958968850749295}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969608833736848, 'loss_val': 0.025372049599540182, 'psi': 0.9958970567610987}
[S11] START round=51 head_norm_before_train=1.944465 cos_to_last_merge=0.9994 (last merge round=44)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9830078350099932, 'auprc': 0.9983272792921527, 'loss_val': 0.07199056044672014, 'psi': 0.989135612722857}-{'f1_val': 0.9948632634592205, 'auprc': 0.9984057183638582, 'loss_val': 0.028155894114210493, 'psi': 0.9962802454210755}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=51 head_norm_before_train=1.753168 cos_to_last_merge=0.7905 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.790
[S13] round=51 local utility u=0.000000 metrics={'f1_val': 0.6278106852917507, 'auprc': 0.6879100158493751, 'loss_val': 1.181923206479552, 'psi': 0.6518504175148003}-{'f1_val': 0.6421692299961732, 'auprc': 0.758972558986035, 'loss_val': 1.0280049742304693, 'psi': 0.6888905615921179}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=51 head_norm_before_train=1.637653 cos_to_last_merge=0.9913 (last merge round=43)
[S14] round=51 local utility u=0.000204 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9990687006059902, 'loss_val': 0.05381724127474488, 'psi': 0.9974736620963196}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986798129348886, 'loss_val': 0.05412443812881762, 'psi': 0.9974246445170422}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=51 head_norm_before_train=1.891931 cos_to_last_merge=0.9995 (last merge round=47)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8149541520312, 'auprc': 0.9941673011153043, 'loss_val': 0.38176860353051056, 'psi': 0.8866394116648417}-{'f1_val': 0.9337231388858398, 'auprc': 0.9975390922267838, 'loss_val': 0.09704977329451293, 'psi': 0.9592495202222173}
[S16] START round=51 head_norm_before_train=1.715065 cos_to_last_merge=1.0000 (last merge round=50)
[S16] round=51 local utility u=0.372502 metrics={'f1_val': 0.9281412529036204, 'auprc': 0.9938051134927869, 'loss_val': 0.2826077552683325, 'psi': 0.954406797139287}-{'f1_val': 0.8558814051029805, 'auprc': 0.9882892175893813, 'loss_val': 0.5775056087205336, 'psi': 0.9088445300975407}
[S17] START round=51 head_norm_before_train=2.129650 cos_to_last_merge=0.8254 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.825
[S17] round=51 local utility u=0.646649 metrics={'f1_val': 0.8891912461687045, 'auprc': 0.9834029504886604, 'loss_val': 0.4744406720736949, 'psi': 0.9268759278966868}-{'f1_val': 0.7575601575266849, 'auprc': 0.9725039341952509, 'loss_val': 0.9452544380307218, 'psi': 0.8435376681941114}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:58311
[S7] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=51 metric=0.8150 head_norm=1.915357
[S15] _apply_head_vector_avg (torch): Δ‖w‖=6.983852e-02
[S15] stored merged vector for next round verification (round=51)
[S15] DEBUG after merge:  round=51 metric=0.8150 head_norm=1.872154 delta_norm=0.069839
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1796) from S17
[S10] cosine check vs S17: cos=-0.0178
[S10] DROPPED delta from S17 (cos=-0.0178 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1794) from S7
[S8] cosine check vs S7: cos=0.9997
[S2] START round=52 head_norm_before_train=2.113841 cos_to_last_merge=0.8000 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.7174794379060776, 'auprc': 0.7278339478381046, 'loss_val': 1.1771290758854882, 'psi': 0.7216212418788883}-{'f1_val': 0.6997553642342357, 'auprc': 0.7417641873799539, 'loss_val': 1.1068299435489144, 'psi': 0.716558893492523}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.223370 (no previous merge yet)
[S3] round=52 local utility u=0.140928 metrics={'f1_val': 0.9885790438650237, 'auprc': 0.9987293017902386, 'loss_val': 0.03153788063258283, 'psi': 0.9926391470351097}-{'f1_val': 0.9610352511054436, 'auprc': 0.9947749452661064, 'loss_val': 0.13626875851501927, 'psi': 0.9745311287697087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=52 head_norm_before_train=1.898216 cos_to_last_merge=0.9971 (last merge round=36)
[S4] round=52 local utility u=0.027477 metrics={'f1_val': 0.9541903718998015, 'auprc': 0.9152698052637445, 'loss_val': 0.2887169263717107, 'psi': 0.9386221452453787}-{'f1_val': 0.9507710218012925, 'auprc': 0.9036740090495833, 'loss_val': 0.288367621645828, 'psi': 0.9319322167006088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=52 head_norm_before_train=1.858029 cos_to_last_merge=1.0000 (last merge round=50)
[S5] round=52 local utility u=0.011602 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919946099914656, 'loss_val': 0.04396209619323432, 'psi': 0.9945981311747203}-{'f1_val': 0.9963338119635569, 'auprc': 0.9896767011587558, 'loss_val': 0.060213134469710404, 'psi': 0.9936709676416364}
[S6] START round=52 head_norm_before_train=1.731111 cos_to_last_merge=0.9998 (last merge round=49)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.621628733361351, 'auprc': 0.9463724731224427, 'loss_val': 0.8498112650846343, 'psi': 0.7515262292657876}-{'f1_val': 0.6530814607973671, 'auprc': 0.9560177984141087, 'loss_val': 0.6677023977416053, 'psi': 0.7742559958440638}
[S7] START round=52 head_norm_before_train=1.723117 cos_to_last_merge=0.9998 (last merge round=44)
[S7] round=52 local utility u=0.187036 metrics={'f1_val': 0.6550852842697229, 'auprc': 0.806629803562591, 'loss_val': 0.48303642612487196, 'psi': 0.7157030919868701}-{'f1_val': 0.6168435750552855, 'auprc': 0.7961259966089123, 'loss_val': 0.5961467576227211, 'psi': 0.6885565436767362}
[S8] START round=52 head_norm_before_train=1.767448 cos_to_last_merge=0.9999 (last merge round=50)
[S8] round=52 local utility u=0.213295 metrics={'f1_val': 0.9942226369520374, 'auprc': 0.9978568629370819, 'loss_val': 0.030976051012920645, 'psi': 0.9956763273460552}-{'f1_val': 0.9423273692484533, 'auprc': 0.9969582341857819, 'loss_val': 0.143498088263746, 'psi': 0.9641797152233847}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=52 metric=0.9942 head_norm=1.787714
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.206594e-02
[S8] stored merged vector for next round verification (round=52)
[S8] DEBUG after merge:  round=52 metric=0.9942 head_norm=1.755209 delta_norm=0.042066
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=52 head_norm_before_train=2.084159 cos_to_last_merge=0.9946 (last merge round=29)
[S9] round=52 local utility u=0.011809 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9983937673527515, 'loss_val': 0.01797707734155251, 'psi': 0.9976192544483863}-{'f1_val': 0.9939393793306803, 'auprc': 0.9994907804605017, 'loss_val': 0.02590534740619721, 'psi': 0.9961599397826089}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=52 head_norm_before_train=2.323894 (no previous merge yet)
[S10] round=52 local utility u=0.000029 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996963393545237, 'loss_val': 0.025325829243665707, 'psi': 0.9958980608297197}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969604541582614, 'loss_val': 0.025375888150224627, 'psi': 0.9958968850749295}
[S11] START round=52 head_norm_before_train=1.955168 cos_to_last_merge=0.9993 (last merge round=44)
[S11] round=52 local utility u=0.065180 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983695690260792, 'loss_val': 0.02299174379207208, 'psi': 0.9972760303185855}-{'f1_val': 0.9830078350099932, 'auprc': 0.9983272792921527, 'loss_val': 0.07199056044672014, 'psi': 0.989135612722857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=52 head_norm_before_train=1.762046 cos_to_last_merge=0.7891 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.789
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6228705705941048, 'auprc': 0.669650483622659, 'loss_val': 1.2804151272617414, 'psi': 0.6415825358055265}-{'f1_val': 0.6278106852917507, 'auprc': 0.6879100158493751, 'loss_val': 1.181923206479552, 'psi': 0.6518504175148003}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.652038 cos_to_last_merge=0.9901 (last merge round=43)
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.996873784132359, 'loss_val': 0.05188243751829146, 'psi': 0.9968418614350161}-{'f1_val': 0.9964103030898727, 'auprc': 0.9990687006059902, 'loss_val': 0.05381724127474488, 'psi': 0.9974736620963196}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.872154 cos_to_last_merge=1.0000 (last merge round=51)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.7284940617973266, 'auprc': 0.8532026861178724, 'loss_val': 0.5480694561301628, 'psi': 0.7783775115255449}-{'f1_val': 0.8149541520312, 'auprc': 0.9941673011153043, 'loss_val': 0.38176860353051056, 'psi': 0.8866394116648417}
[S16] START round=52 head_norm_before_train=1.730626 cos_to_last_merge=1.0000 (last merge round=50)
[S16] round=52 local utility u=0.302707 metrics={'f1_val': 0.9903309560500846, 'auprc': 0.9951685077970003, 'loss_val': 0.05442305576234498, 'psi': 0.9922659767488509}-{'f1_val': 0.9281412529036204, 'auprc': 0.9938051134927869, 'loss_val': 0.2826077552683325, 'psi': 0.954406797139287}
[S17] START round=52 head_norm_before_train=2.141657 cos_to_last_merge=0.8243 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.824
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.5294954730418798, 'auprc': 0.9095043806573553, 'loss_val': 1.615493363988972, 'psi': 0.68149903608807}-{'f1_val': 0.8891912461687045, 'auprc': 0.9834029504886604, 'loss_val': 0.4744406720736949, 'psi': 0.9268759278966868}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.992)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:58313
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.716)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=52 metric=0.6216 head_norm=1.751695
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.617522e-02
[S6] stored merged vector for next round verification (round=52)
[S6] DEBUG after merge:  round=52 metric=0.6217 head_norm=1.740995 delta_norm=0.026175
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1790) from S10
[S13] cosine check vs S10: cos=-0.0946
[S13] DROPPED delta from S10 (cos=-0.0946 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S5
[S15] cosine check vs S5: cos=0.9996
[S2] START round=53 head_norm_before_train=2.121165 cos_to_last_merge=0.7996 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.7189642210569163, 'auprc': 0.7169413716785945, 'loss_val': 1.1644584365223847, 'psi': 0.7181550813055876}-{'f1_val': 0.7174794379060776, 'auprc': 0.7278339478381046, 'loss_val': 1.1771290758854882, 'psi': 0.7216212418788883}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=53 head_norm_before_train=2.231092 (no previous merge yet)
[S3] round=53 local utility u=0.033427 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9990016124373767, 'loss_val': 0.018415321667572874, 'psi': 0.9980395864425852}-{'f1_val': 0.9885790438650237, 'auprc': 0.9987293017902386, 'loss_val': 0.03153788063258283, 'psi': 0.9926391470351097}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=53 head_norm_before_train=1.907682 cos_to_last_merge=0.9968 (last merge round=36)
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9515985254613143, 'auprc': 0.9069207222154453, 'loss_val': 0.3032457982845954, 'psi': 0.9337274041629666}-{'f1_val': 0.9541903718998015, 'auprc': 0.9152698052637445, 'loss_val': 0.2887169263717107, 'psi': 0.9386221452453787}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.868362 cos_to_last_merge=0.9998 (last merge round=50)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9690157360148373, 'auprc': 0.9894645128294585, 'loss_val': 0.09608585547163172, 'psi': 0.9771952467406857}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919946099914656, 'loss_val': 0.04396209619323432, 'psi': 0.9945981311747203}
[S6] START round=53 head_norm_before_train=1.740995 cos_to_last_merge=1.0000 (last merge round=52)
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5990448091319478, 'auprc': 0.9524854246889103, 'loss_val': 0.9609119957576084, 'psi': 0.7404210553547328}-{'f1_val': 0.621628733361351, 'auprc': 0.9463724731224427, 'loss_val': 0.8498112650846343, 'psi': 0.7515262292657876}
[S7] START round=53 head_norm_before_train=1.727069 cos_to_last_merge=0.9997 (last merge round=44)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.5207802991795287, 'auprc': 0.7809771469168012, 'loss_val': 1.0032300645529475, 'psi': 0.6248590382744377}-{'f1_val': 0.6550852842697229, 'auprc': 0.806629803562591, 'loss_val': 0.48303642612487196, 'psi': 0.7157030919868701}
[S8] START round=53 head_norm_before_train=1.755209 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.989929598471134, 'auprc': 0.9989808914353444, 'loss_val': 0.03671528228280264, 'psi': 0.9935501156568183}-{'f1_val': 0.9942226369520374, 'auprc': 0.9978568629370819, 'loss_val': 0.030976051012920645, 'psi': 0.9956763273460552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=2.088719 cos_to_last_merge=0.9943 (last merge round=29)
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9992059345728661, 'loss_val': 0.04105635486288705, 'psi': 0.9931597096751266}-{'f1_val': 0.9971029125121428, 'auprc': 0.9983937673527515, 'loss_val': 0.01797707734155251, 'psi': 0.9976192544483863}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=2.332263 (no previous merge yet)
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969177764415857, 'loss_val': 0.025412881387599756, 'psi': 0.9958798139882592}-{'f1_val': 0.9951878390193748, 'auprc': 0.996963393545237, 'loss_val': 0.025325829243665707, 'psi': 0.9958980608297197}
[S11] START round=53 head_norm_before_train=1.964149 cos_to_last_merge=0.9991 (last merge round=44)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981997097387633, 'loss_val': 0.02272138069271368, 'psi': 0.997208086603659}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983695690260792, 'loss_val': 0.02299174379207208, 'psi': 0.9972760303185855}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.769133 cos_to_last_merge=0.7879 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.788
[S13] round=53 local utility u=0.072113 metrics={'f1_val': 0.6220039301804408, 'auprc': 0.6850747458455884, 'loss_val': 1.1772624928301596, 'psi': 0.6472322564464998}-{'f1_val': 0.6228705705941048, 'auprc': 0.669650483622659, 'loss_val': 1.2804151272617414, 'psi': 0.6415825358055265}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=53 head_norm_before_train=1.666419 cos_to_last_merge=0.9888 (last merge round=43)
[S14] round=53 local utility u=0.004405 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9986562810850503, 'loss_val': 0.048028679209579934, 'psi': 0.9975156888836814}-{'f1_val': 0.9968205796367875, 'auprc': 0.996873784132359, 'loss_val': 0.05188243751829146, 'psi': 0.9968418614350161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=53 head_norm_before_train=1.894233 cos_to_last_merge=1.0000 (last merge round=51)
[S15] round=53 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9967335248262492, 'loss_val': 0.02224963815022286, 'psi': 0.996741410963012}-{'f1_val': 0.7284940617973266, 'auprc': 0.8532026861178724, 'loss_val': 0.5480694561301628, 'psi': 0.7783775115255449}
[S16] START round=53 head_norm_before_train=1.745841 cos_to_last_merge=0.9999 (last merge round=50)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9885662299037621, 'loss_val': 0.05373659396385243, 'psi': 0.9903736567633228}-{'f1_val': 0.9903309560500846, 'auprc': 0.9951685077970003, 'loss_val': 0.05442305576234498, 'psi': 0.9922659767488509}
[S17] START round=53 head_norm_before_train=2.151014 cos_to_last_merge=0.8235 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.5120858761774192, 'auprc': 0.9171844263466312, 'loss_val': 2.081254285600887, 'psi': 0.674125296245104}-{'f1_val': 0.5294954730418798, 'auprc': 0.9095043806573553, 'loss_val': 1.615493363988972, 'psi': 0.68149903608807}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9993
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=53 metric=0.9967 head_norm=1.912524
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.719869e-02
[S15] stored merged vector for next round verification (round=53)
[S15] DEBUG after merge:  round=53 metric=0.9967 head_norm=1.890206 delta_norm=0.037199
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=2.128908 cos_to_last_merge=0.7988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.6841712803671778, 'auprc': 0.7476419770717543, 'loss_val': 1.1766858807564113, 'psi': 0.7095595590490085}-{'f1_val': 0.7189642210569163, 'auprc': 0.7169413716785945, 'loss_val': 1.1644584365223847, 'psi': 0.7181550813055876}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=2.239267 (no previous merge yet)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9967134310892349, 'auprc': 0.9989831002325121, 'loss_val': 0.030415440495800184, 'psi': 0.9976212987465458}-{'f1_val': 0.9973982357793907, 'auprc': 0.9990016124373767, 'loss_val': 0.018415321667572874, 'psi': 0.9980395864425852}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.916294 cos_to_last_merge=0.9966 (last merge round=36)
[S4] round=54 local utility u=0.019507 metrics={'f1_val': 0.9540925160963384, 'auprc': 0.9138267602718596, 'loss_val': 0.299914073539674, 'psi': 0.9379862137665469}-{'f1_val': 0.9515985254613143, 'auprc': 0.9069207222154453, 'loss_val': 0.3032457982845954, 'psi': 0.9337274041629666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=54 head_norm_before_train=1.877864 cos_to_last_merge=0.9996 (last merge round=50)
[S5] round=54 local utility u=0.120563 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9948728390655925, 'loss_val': 0.03730194821830205, 'psi': 0.9959703167133116}-{'f1_val': 0.9690157360148373, 'auprc': 0.9894645128294585, 'loss_val': 0.09608585547163172, 'psi': 0.9771952467406857}
[S6] START round=54 head_norm_before_train=1.760333 cos_to_last_merge=0.9999 (last merge round=52)
[S6] round=54 local utility u=1.000000 metrics={'f1_val': 0.8560196894014805, 'auprc': 0.9673717048803425, 'loss_val': 0.4015364935928921, 'psi': 0.9005604955930253}-{'f1_val': 0.5990448091319478, 'auprc': 0.9524854246889103, 'loss_val': 0.9609119957576084, 'psi': 0.7404210553547328}
[S7] START round=54 head_norm_before_train=1.730172 cos_to_last_merge=0.9997 (last merge round=44)
[S7] round=54 local utility u=0.759020 metrics={'f1_val': 0.6667131975738305, 'auprc': 0.810782466845425, 'loss_val': 0.4502024268866211, 'psi': 0.7243409052824683}-{'f1_val': 0.5207802991795287, 'auprc': 0.7809771469168012, 'loss_val': 1.0032300645529475, 'psi': 0.6248590382744377}
[S8] START round=54 head_norm_before_train=1.772996 cos_to_last_merge=0.9999 (last merge round=52)
[S8] round=54 local utility u=0.000000 metrics={'f1_val': 0.9843673129427775, 'auprc': 0.9960204763908921, 'loss_val': 0.05091209891316033, 'psi': 0.9890285783220234}-{'f1_val': 0.989929598471134, 'auprc': 0.9989808914353444, 'loss_val': 0.03671528228280264, 'psi': 0.9935501156568183}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=54 head_norm_before_train=2.092072 cos_to_last_merge=0.9941 (last merge round=29)
[S9] round=54 local utility u=0.004324 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9994918970443076, 'loss_val': 0.03835328291784883, 'psi': 0.9937827240581358}-{'f1_val': 0.9891288930766337, 'auprc': 0.9992059345728661, 'loss_val': 0.04105635486288705, 'psi': 0.9931597096751266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=54 head_norm_before_train=2.336273 (no previous merge yet)
[S10] round=54 local utility u=0.000116 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969526341927327, 'loss_val': 0.025286109009065746, 'psi': 0.9958937570887179}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969177764415857, 'loss_val': 0.025412881387599756, 'psi': 0.9958798139882592}
[S11] START round=54 head_norm_before_train=1.974002 cos_to_last_merge=0.9990 (last merge round=44)
[S11] round=54 local utility u=0.000000 metrics={'f1_val': 0.9958246664506369, 'auprc': 0.9984730063337686, 'loss_val': 0.02448345741427603, 'psi': 0.9968840024038896}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981997097387633, 'loss_val': 0.02272138069271368, 'psi': 0.997208086603659}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=54 head_norm_before_train=1.781232 cos_to_last_merge=0.7862 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.786
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.5999266152035592, 'auprc': 0.5951923249274473, 'loss_val': 1.4303471545706778, 'psi': 0.5980328990931145}-{'f1_val': 0.6220039301804408, 'auprc': 0.6850747458455884, 'loss_val': 1.1772624928301596, 'psi': 0.6472322564464998}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=1.680227 cos_to_last_merge=0.9880 (last merge round=43)
[S14] round=54 local utility u=0.000630 metrics={'f1_val': 0.9967552940827689, 'auprc': 0.9986564562811793, 'loss_val': 0.0467692306139058, 'psi': 0.9975157589621331}-{'f1_val': 0.9967552940827689, 'auprc': 0.9986562810850503, 'loss_val': 0.048028679209579934, 'psi': 0.9975156888836814}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=54 head_norm_before_train=1.890206 cos_to_last_merge=1.0000 (last merge round=53)
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9471289383954475, 'auprc': 0.998202737155547, 'loss_val': 0.07711294920571184, 'psi': 0.9675584578994874}-{'f1_val': 0.9967466683875206, 'auprc': 0.9967335248262492, 'loss_val': 0.02224963815022286, 'psi': 0.996741410963012}
[S16] START round=54 head_norm_before_train=1.760180 cos_to_last_merge=0.9997 (last merge round=50)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.9398782025207653, 'auprc': 0.9945893908480508, 'loss_val': 0.17525392758265593, 'psi': 0.9617626778516795}-{'f1_val': 0.9915786080030298, 'auprc': 0.9885662299037621, 'loss_val': 0.05373659396385243, 'psi': 0.9903736567633228}
[S17] START round=54 head_norm_before_train=2.156141 cos_to_last_merge=0.8231 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=54 local utility u=1.000000 metrics={'f1_val': 0.7459281521780464, 'auprc': 0.9808730212704008, 'loss_val': 1.0239693048334615, 'psi': 0.8399060998149882}-{'f1_val': 0.5120858761774192, 'auprc': 0.9171844263466312, 'loss_val': 2.081254285600887, 'psi': 0.674125296245104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S13@127.0.0.1:58313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[S10] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9990
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9995
[S13] RECEIVED delta(kind=head bytes=1790) from S10
[S13] cosine check vs S10: cos=-0.0946
[S13] DROPPED delta from S10 (cos=-0.0946 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0171
[S10] DROPPED delta from S17 (cos=-0.0171 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1798) from S7
[S8] cosine check vs S7: cos=0.9991
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=54 metric=0.9967 head_norm=1.885225
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.220121e-02
[S5] stored merged vector for next round verification (round=54)
[S5] DEBUG after merge:  round=54 metric=0.9967 head_norm=1.898455 delta_norm=0.042201
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=2.133926 cos_to_last_merge=0.7988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.799
[S2] round=55 local utility u=0.018028 metrics={'f1_val': 0.7115737988892985, 'auprc': 0.7138886422838371, 'loss_val': 1.2037853237972762, 'psi': 0.7124997362471139}-{'f1_val': 0.6841712803671778, 'auprc': 0.7476419770717543, 'loss_val': 1.1766858807564113, 'psi': 0.7095595590490085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=55 head_norm_before_train=2.245775 (no previous merge yet)
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9971193760541588, 'loss_val': 0.11556054901446122, 'psi': 0.9753455158044017}-{'f1_val': 0.9967134310892349, 'auprc': 0.9989831002325121, 'loss_val': 0.030415440495800184, 'psi': 0.9976212987465458}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.921728 cos_to_last_merge=0.9964 (last merge round=36)
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9536264712350977, 'auprc': 0.9080366798522473, 'loss_val': 0.30927831021563407, 'psi': 0.9353905546819575}-{'f1_val': 0.9540925160963384, 'auprc': 0.9138267602718596, 'loss_val': 0.299914073539674, 'psi': 0.9379862137665469}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.898455 cos_to_last_merge=1.0000 (last merge round=54)
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9904629011032218, 'loss_val': 0.04071383576353768, 'psi': 0.9939854476194228}-{'f1_val': 0.9967019684784577, 'auprc': 0.9948728390655925, 'loss_val': 0.03730194821830205, 'psi': 0.9959703167133116}
[S6] START round=55 head_norm_before_train=1.779042 cos_to_last_merge=0.9997 (last merge round=52)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.6737703667638679, 'auprc': 0.9290060207738431, 'loss_val': 0.8092497733654579, 'psi': 0.7758646283678581}-{'f1_val': 0.8560196894014805, 'auprc': 0.9673717048803425, 'loss_val': 0.4015364935928921, 'psi': 0.9005604955930253}
[S7] START round=55 head_norm_before_train=1.733401 cos_to_last_merge=0.9996 (last merge round=44)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.5834782084651188, 'auprc': 0.7811443750088869, 'loss_val': 0.7841216356417051, 'psi': 0.662544675082626}-{'f1_val': 0.6667131975738305, 'auprc': 0.810782466845425, 'loss_val': 0.4502024268866211, 'psi': 0.7243409052824683}
[S8] START round=55 head_norm_before_train=1.791277 cos_to_last_merge=0.9996 (last merge round=52)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9626811271079003, 'auprc': 0.993551870227425, 'loss_val': 0.11124039232778526, 'psi': 0.9750294243557103}-{'f1_val': 0.9843673129427775, 'auprc': 0.9960204763908921, 'loss_val': 0.05091209891316033, 'psi': 0.9890285783220234}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=55 metric=0.9627 head_norm=1.809240
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.546040e-02
[S8] stored merged vector for next round verification (round=55)
[S8] DEBUG after merge:  round=55 metric=0.9627 head_norm=1.770858 delta_norm=0.055460
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=55 head_norm_before_train=2.096846 cos_to_last_merge=0.9939 (last merge round=29)
[S9] round=55 local utility u=0.031948 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9994976918278584, 'loss_val': 0.017214999635304932, 'psi': 0.9980591064546813}-{'f1_val': 0.9899766087340214, 'auprc': 0.9994918970443076, 'loss_val': 0.03835328291784883, 'psi': 0.9937827240581358}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=55 head_norm_before_train=2.340239 (no previous merge yet)
[S10] round=55 local utility u=0.000067 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996960620030968, 'loss_val': 0.02517535146799396, 'psi': 0.995896951424012}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969526341927327, 'loss_val': 0.025286109009065746, 'psi': 0.9958937570887179}
[S11] START round=55 head_norm_before_train=1.982985 cos_to_last_merge=0.9988 (last merge round=44)
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9214285519924633, 'auprc': 0.9984663079024012, 'loss_val': 0.21023448863786812, 'psi': 0.9522436543564385}-{'f1_val': 0.9958246664506369, 'auprc': 0.9984730063337686, 'loss_val': 0.02448345741427603, 'psi': 0.9968840024038896}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.792913 cos_to_last_merge=0.7851 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.785
[S13] round=55 local utility u=0.459625 metrics={'f1_val': 0.6361439198703701, 'auprc': 0.7271303328836555, 'loss_val': 1.1242151261773228, 'psi': 0.6725384850756843}-{'f1_val': 0.5999266152035592, 'auprc': 0.5951923249274473, 'loss_val': 1.4303471545706778, 'psi': 0.5980328990931145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=55 head_norm_before_train=1.692894 cos_to_last_merge=0.9870 (last merge round=43)
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9959352234707468, 'auprc': 0.9986525285384427, 'loss_val': 0.04573971510386529, 'psi': 0.9970221454978252}-{'f1_val': 0.9967552940827689, 'auprc': 0.9986564562811793, 'loss_val': 0.0467692306139058, 'psi': 0.9975157589621331}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.910393 cos_to_last_merge=1.0000 (last merge round=53)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.8945540258739249, 'auprc': 0.9678409640367033, 'loss_val': 0.3303859636990414, 'psi': 0.9238688011390362}-{'f1_val': 0.9471289383954475, 'auprc': 0.998202737155547, 'loss_val': 0.07711294920571184, 'psi': 0.9675584578994874}
[S16] START round=55 head_norm_before_train=1.774364 cos_to_last_merge=0.9995 (last merge round=50)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.8439854322406295, 'auprc': 0.9915514610798256, 'loss_val': 0.7882135408797047, 'psi': 0.9030118437763079}-{'f1_val': 0.9398782025207653, 'auprc': 0.9945893908480508, 'loss_val': 0.17525392758265593, 'psi': 0.9617626778516795}
[S17] START round=55 head_norm_before_train=2.161044 cos_to_last_merge=0.8230 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=55 local utility u=0.194400 metrics={'f1_val': 0.7815434140595633, 'auprc': 0.9896015368840889, 'loss_val': 0.87504667866041, 'psi': 0.8647666631893736}-{'f1_val': 0.7459281521780464, 'auprc': 0.9808730212704008, 'loss_val': 1.0239693048334615, 'psi': 0.8399060998149882}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.865)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.062 → S15@127.0.0.1:58315
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:58313
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=55 metric=0.8440 head_norm=1.786123
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.431241e-02
[S16] stored merged vector for next round verification (round=55)
[S16] DEBUG after merge:  round=55 metric=0.8440 head_norm=1.782035 delta_norm=0.044312
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.074 → S6@127.0.0.1:58307
[S7] ⇄ pheromone p=0.246 → S8@127.0.0.1:58309
[S17] ⇄ pheromone p=0.336 → S10@127.0.0.1:58311
[S6] ⇄ pheromone p=0.235 → S16@127.0.0.1:58316
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=55 metric=0.8946 head_norm=1.932822
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.262750e-02
[S15] stored merged vector for next round verification (round=55)
[S15] DEBUG after merge:  round=55 metric=0.8944 head_norm=1.908696 delta_norm=0.042628
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.165 → S5@127.0.0.1:58305
[S2] START round=56 head_norm_before_train=2.138172 cos_to_last_merge=0.7981 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.6974020271073678, 'auprc': 0.7233381236327252, 'loss_val': 1.2270585596671741, 'psi': 0.7077764657175107}-{'f1_val': 0.7115737988892985, 'auprc': 0.7138886422838371, 'loss_val': 1.2037853237972762, 'psi': 0.7124997362471139}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.252246 (no previous merge yet)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.999429156413546, 'loss_val': 0.12846659876614147, 'psi': 0.9764408169061098}-{'f1_val': 0.9608296089712303, 'auprc': 0.9971193760541588, 'loss_val': 0.11556054901446122, 'psi': 0.9753455158044017}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.929678 cos_to_last_merge=0.9963 (last merge round=36)
[S4] round=56 local utility u=0.012781 metrics={'f1_val': 0.9536333173434479, 'auprc': 0.9131760568544379, 'loss_val': 0.2991748484486652, 'psi': 0.9374504131478438}-{'f1_val': 0.9536264712350977, 'auprc': 0.9080366798522473, 'loss_val': 0.30927831021563407, 'psi': 0.9353905546819575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=56 head_norm_before_train=1.905870 cos_to_last_merge=1.0000 (last merge round=54)
[S5] round=56 local utility u=0.002942 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9907115705439691, 'loss_val': 0.03557536954291303, 'psi': 0.9940849153957216}-{'f1_val': 0.9963338119635569, 'auprc': 0.9904629011032218, 'loss_val': 0.04071383576353768, 'psi': 0.9939854476194228}
[S6] START round=56 head_norm_before_train=1.790290 cos_to_last_merge=0.9995 (last merge round=52)
[S6] round=56 local utility u=0.579367 metrics={'f1_val': 0.8070651135653284, 'auprc': 0.9458071374891941, 'loss_val': 0.5006877188454975, 'psi': 0.8625619231348747}-{'f1_val': 0.6737703667638679, 'auprc': 0.9290060207738431, 'loss_val': 0.8092497733654579, 'psi': 0.7758646283678581}
[S7] START round=56 head_norm_before_train=1.736334 cos_to_last_merge=0.9995 (last merge round=44)
[S7] round=56 local utility u=0.730663 metrics={'f1_val': 0.6928088164478877, 'auprc': 0.8802449844721583, 'loss_val': 0.27608145615880253, 'psi': 0.767783283657596}-{'f1_val': 0.5834782084651188, 'auprc': 0.7811443750088869, 'loss_val': 0.7841216356417051, 'psi': 0.662544675082626}
[S8] START round=56 head_norm_before_train=1.770858 cos_to_last_merge=1.0000 (last merge round=55)
[S8] round=56 local utility u=0.137495 metrics={'f1_val': 0.9934815081849845, 'auprc': 0.9979787561353515, 'loss_val': 0.03433411664306177, 'psi': 0.9952804073651312}-{'f1_val': 0.9626811271079003, 'auprc': 0.993551870227425, 'loss_val': 0.11124039232778526, 'psi': 0.9750294243557103}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=56 head_norm_before_train=2.102785 cos_to_last_merge=0.9937 (last merge round=29)
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991840506832657, 'loss_val': 0.01759938081043055, 'psi': 0.997935367780592}-{'f1_val': 0.9971000495392299, 'auprc': 0.9994976918278584, 'loss_val': 0.017214999635304932, 'psi': 0.9980591064546813}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=2.343672 (no previous merge yet)
[S10] round=56 local utility u=0.000076 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969746747557519, 'loss_val': 0.025065110659834893, 'psi': 0.9959025733139255}-{'f1_val': 0.9951878390193748, 'auprc': 0.996960620030968, 'loss_val': 0.02517535146799396, 'psi': 0.995896951424012}
[S11] START round=56 head_norm_before_train=1.992271 cos_to_last_merge=0.9986 (last merge round=44)
[S11] round=56 local utility u=0.319526 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983899648594501, 'loss_val': 0.02166345417693554, 'psi': 0.9972841886519338}-{'f1_val': 0.9214285519924633, 'auprc': 0.9984663079024012, 'loss_val': 0.21023448863786812, 'psi': 0.9522436543564385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] sending update (kind=head size=1806 to 1 peers)
[S13] START round=56 head_norm_before_train=1.798741 cos_to_last_merge=0.7844 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.784
[S13] round=56 local utility u=0.514741 metrics={'f1_val': 0.7184286681970329, 'auprc': 0.8289651511258364, 'loss_val': 0.893945254864896, 'psi': 0.7626432613685543}-{'f1_val': 0.6361439198703701, 'auprc': 0.7271303328836555, 'loss_val': 1.1242151261773228, 'psi': 0.6725384850756843}
[S13] not sending this round → trigger blocked (psi=0.763)
[S14] START round=56 head_norm_before_train=1.705229 cos_to_last_merge=0.9859 (last merge round=43)
[S14] round=56 local utility u=0.001302 metrics={'f1_val': 0.9960005090247654, 'auprc': 0.9986621867398594, 'loss_val': 0.04355652887956933, 'psi': 0.997065180110803}-{'f1_val': 0.9959352234707468, 'auprc': 0.9986525285384427, 'loss_val': 0.04573971510386529, 'psi': 0.9970221454978252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=56 head_norm_before_train=1.908696 cos_to_last_merge=1.0000 (last merge round=55)
[S15] round=56 local utility u=0.496974 metrics={'f1_val': 0.9941786643056704, 'auprc': 0.9987491105933081, 'loss_val': 0.02691061297415575, 'psi': 0.9960068428207254}-{'f1_val': 0.8945540258739249, 'auprc': 0.9678409640367033, 'loss_val': 0.3303859636990414, 'psi': 0.9238688011390362}
[S16] START round=56 head_norm_before_train=1.782035 cos_to_last_merge=1.0000 (last merge round=55)
[S16] round=56 local utility u=0.699246 metrics={'f1_val': 0.9646903442508596, 'auprc': 0.9882631641767486, 'loss_val': 0.10408601329785346, 'psi': 0.9741194722212152}-{'f1_val': 0.8439854322406295, 'auprc': 0.9915514610798256, 'loss_val': 0.7882135408797047, 'psi': 0.9030118437763079}
[S17] START round=56 head_norm_before_train=2.166253 cos_to_last_merge=0.8225 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.823
[S17] round=56 local utility u=0.273416 metrics={'f1_val': 0.8374745248200401, 'auprc': 0.9899095748078645, 'loss_val': 0.6647258051625805, 'psi': 0.8984485448151699}-{'f1_val': 0.7815434140595633, 'auprc': 0.9896015368840889, 'loss_val': 0.87504667866041, 'psi': 0.8647666631893736}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S13@127.0.0.1:58313
[S6] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1791) from S10
[S13] cosine check vs S10: cos=-0.0944
[S13] DROPPED delta from S10 (cos=-0.0944 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=0.9991
[S6] RECEIVED delta(kind=head bytes=1802) from S16
[S6] cosine check vs S16: cos=0.9991
[S10] RECEIVED delta(kind=head bytes=1799) from S17
[S10] cosine check vs S17: cos=-0.0169
[S10] DROPPED delta from S17 (cos=-0.0169 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1802) from S7
[S8] cosine check vs S7: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=56 metric=0.9963 head_norm=1.914879
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.621437e-02
[S5] stored merged vector for next round verification (round=56)
[S5] DEBUG after merge:  round=56 metric=0.9963 head_norm=1.923617 delta_norm=0.016214
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=56 metric=0.9647 head_norm=1.791800
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.919323e-02
[S16] stored merged vector for next round verification (round=56)
[S16] DEBUG after merge:  round=56 metric=0.9657 head_norm=1.795199 delta_norm=0.039193
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=56 metric=0.8071 head_norm=1.799445
[S6] _apply_head_vector_avg (torch): Δ‖w‖=3.919324e-02
[S6] stored merged vector for next round verification (round=56)
[S6] DEBUG after merge:  round=56 metric=0.8077 head_norm=1.795199 delta_norm=0.039193
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=56 metric=0.9942 head_norm=1.932452
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.621436e-02
[S15] stored merged vector for next round verification (round=56)
[S15] DEBUG after merge:  round=56 metric=0.9942 head_norm=1.923617 delta_norm=0.016214
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=2.144954 cos_to_last_merge=0.7977 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.798
[S2] round=57 local utility u=0.070983 metrics={'f1_val': 0.7179792813441855, 'auprc': 0.7234246579648093, 'loss_val': 1.2088152096683082, 'psi': 0.7201574319924351}-{'f1_val': 0.6974020271073678, 'auprc': 0.7233381236327252, 'loss_val': 1.2270585596671741, 'psi': 0.7077764657175107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=57 head_norm_before_train=2.259660 (no previous merge yet)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9968147362251568, 'loss_val': 0.12721575651687222, 'psi': 0.9752236598728008}-{'f1_val': 0.9611152572344858, 'auprc': 0.999429156413546, 'loss_val': 0.12846659876614147, 'psi': 0.9764408169061098}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.939014 cos_to_last_merge=0.9960 (last merge round=36)
[S4] round=57 local utility u=0.024408 metrics={'f1_val': 0.9500477113871888, 'auprc': 0.9376767165787897, 'loss_val': 0.3023473111858749, 'psi': 0.9450993134638291}-{'f1_val': 0.9536333173434479, 'auprc': 0.9131760568544379, 'loss_val': 0.2991748484486652, 'psi': 0.9374504131478438}
[S4] not sending this round → trigger blocked (psi=0.945)
[S5] START round=57 head_norm_before_train=1.923617 cos_to_last_merge=1.0000 (last merge round=56)
[S5] round=57 local utility u=0.002100 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9925592186515646, 'loss_val': 0.03428665498196387, 'psi': 0.9945607875973564}-{'f1_val': 0.9963338119635569, 'auprc': 0.9907115705439691, 'loss_val': 0.03557536954291303, 'psi': 0.9940849153957216}
[S6] START round=57 head_norm_before_train=1.795199 cos_to_last_merge=1.0000 (last merge round=56)
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7698643860101348, 'auprc': 0.9552429055584242, 'loss_val': 0.5988703927446145, 'psi': 0.8440157938294506}-{'f1_val': 0.8070651135653284, 'auprc': 0.9458071374891941, 'loss_val': 0.5006877188454975, 'psi': 0.8625619231348747}
[S7] START round=57 head_norm_before_train=1.739057 cos_to_last_merge=0.9995 (last merge round=44)
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.6302487663282527, 'auprc': 0.7799524322740733, 'loss_val': 0.681017021806514, 'psi': 0.6901302327065809}-{'f1_val': 0.6928088164478877, 'auprc': 0.8802449844721583, 'loss_val': 0.27608145615880253, 'psi': 0.767783283657596}
[S8] START round=57 head_norm_before_train=1.785178 cos_to_last_merge=0.9999 (last merge round=55)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9719181503627253, 'auprc': 0.9990977472025739, 'loss_val': 0.0709064286343927, 'psi': 0.9827899890986649}-{'f1_val': 0.9934815081849845, 'auprc': 0.9979787561353515, 'loss_val': 0.03433411664306177, 'psi': 0.9952804073651312}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=57 metric=0.9719 head_norm=1.798690
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.135205e-02
[S8] stored merged vector for next round verification (round=57)
[S8] DEBUG after merge:  round=57 metric=0.9713 head_norm=1.768641 delta_norm=0.041352
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=57 head_norm_before_train=2.106163 cos_to_last_merge=0.9934 (last merge round=29)
[S9] round=57 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9994849691237098, 'loss_val': 0.02216631167256436, 'psi': 0.9968082382979613}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991840506832657, 'loss_val': 0.01759938081043055, 'psi': 0.997935367780592}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=57 head_norm_before_train=2.352193 (no previous merge yet)
[S10] round=57 local utility u=0.000127 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969886466474682, 'loss_val': 0.0248529992108741, 'psi': 0.9959081620706121}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969746747557519, 'loss_val': 0.025065110659834893, 'psi': 0.9959025733139255}
[S11] START round=57 head_norm_before_train=2.000388 cos_to_last_merge=0.9984 (last merge round=44)
[S11] round=57 local utility u=0.000123 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983903599707434, 'loss_val': 0.021417833220362763, 'psi': 0.9972843466964512}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983899648594501, 'loss_val': 0.02166345417693554, 'psi': 0.9972841886519338}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=57 head_norm_before_train=1.807991 cos_to_last_merge=0.7835 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.783
[S13] round=57 local utility u=0.063355 metrics={'f1_val': 0.7337330651126936, 'auprc': 0.827384608733966, 'loss_val': 0.8543204810579469, 'psi': 0.7711936825612026}-{'f1_val': 0.7184286681970329, 'auprc': 0.8289651511258364, 'loss_val': 0.893945254864896, 'psi': 0.7626432613685543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=57 head_norm_before_train=1.717751 cos_to_last_merge=0.9850 (last merge round=43)
[S14] round=57 local utility u=0.001675 metrics={'f1_val': 0.9960005090247654, 'auprc': 0.9986619014892418, 'loss_val': 0.04020642492268212, 'psi': 0.997065066010556}-{'f1_val': 0.9960005090247654, 'auprc': 0.9986621867398594, 'loss_val': 0.04355652887956933, 'psi': 0.997065180110803}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=57 head_norm_before_train=1.923617 cos_to_last_merge=1.0000 (last merge round=56)
[S15] round=57 local utility u=0.006588 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9961845453323798, 'loss_val': 0.021448979171188178, 'psi': 0.9965218191654642}-{'f1_val': 0.9941786643056704, 'auprc': 0.9987491105933081, 'loss_val': 0.02691061297415575, 'psi': 0.9960068428207254}
[S16] START round=57 head_norm_before_train=1.795199 cos_to_last_merge=1.0000 (last merge round=56)
[S16] round=57 local utility u=0.121247 metrics={'f1_val': 0.9917043959075469, 'auprc': 0.9968948413992182, 'loss_val': 0.04957182029075709, 'psi': 0.9937805741042154}-{'f1_val': 0.9646903442508596, 'auprc': 0.9882631641767486, 'loss_val': 0.10408601329785346, 'psi': 0.9741194722212152}
[S17] START round=57 head_norm_before_train=2.172549 cos_to_last_merge=0.8220 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=57 local utility u=0.000000 metrics={'f1_val': 0.7312936814255964, 'auprc': 0.9483627410706639, 'loss_val': 1.0710809375408314, 'psi': 0.8181213052836234}-{'f1_val': 0.8374745248200401, 'auprc': 0.9899095748078645, 'loss_val': 0.6647258051625805, 'psi': 0.8984485448151699}
[S16] not sending this round → trigger blocked (psi=0.994)
[S5] not sending this round → trigger blocked (psi=0.995)
[S15] not sending this round → trigger blocked (psi=0.997)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=58 head_norm_before_train=2.146367 cos_to_last_merge=0.7969 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.797
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.6821138135593342, 'auprc': 0.7238740841376784, 'loss_val': 1.3183290056454624, 'psi': 0.6988179217906718}-{'f1_val': 0.7179792813441855, 'auprc': 0.7234246579648093, 'loss_val': 1.2088152096683082, 'psi': 0.7201574319924351}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.267251 (no previous merge yet)
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.8027017385829921, 'auprc': 0.9917588263524126, 'loss_val': 0.3650338553069159, 'psi': 0.8783245736907603}-{'f1_val': 0.9608296089712303, 'auprc': 0.9968147362251568, 'loss_val': 0.12721575651687222, 'psi': 0.9752236598728008}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.950324 cos_to_last_merge=0.9958 (last merge round=36)
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9544443139375968, 'auprc': 0.915213915603225, 'loss_val': 0.3163480287179834, 'psi': 0.938752154603848}-{'f1_val': 0.9500477113871888, 'auprc': 0.9376767165787897, 'loss_val': 0.3023473111858749, 'psi': 0.9450993134638291}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.935492 cos_to_last_merge=1.0000 (last merge round=56)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9904668988178962, 'loss_val': 0.03719766593298067, 'psi': 0.9937238596638891}-{'f1_val': 0.995895166894551, 'auprc': 0.9925592186515646, 'loss_val': 0.03428665498196387, 'psi': 0.9945607875973564}
[S6] START round=58 head_norm_before_train=1.810628 cos_to_last_merge=1.0000 (last merge round=56)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6634656251829718, 'auprc': 0.9548437403463841, 'loss_val': 0.7304575793052207, 'psi': 0.7800168712483367}-{'f1_val': 0.7698643860101348, 'auprc': 0.9552429055584242, 'loss_val': 0.5988703927446145, 'psi': 0.8440157938294506}
[S7] START round=58 head_norm_before_train=1.741848 cos_to_last_merge=0.9994 (last merge round=44)
[S7] round=58 local utility u=0.428069 metrics={'f1_val': 0.6812806023142737, 'auprc': 0.8440328270607187, 'loss_val': 0.3233114883351422, 'psi': 0.7463814922128518}-{'f1_val': 0.6302487663282527, 'auprc': 0.7799524322740733, 'loss_val': 0.681017021806514, 'psi': 0.6901302327065809}
[S8] START round=58 head_norm_before_train=1.768641 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.7671528110266188, 'auprc': 0.9827511180785382, 'loss_val': 0.3193956566073729, 'psi': 0.8533921338473865}-{'f1_val': 0.9719181503627253, 'auprc': 0.9990977472025739, 'loss_val': 0.0709064286343927, 'psi': 0.9827899890986649}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.108399 cos_to_last_merge=0.9932 (last merge round=29)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9994964776577274, 'loss_val': 0.040485314810284195, 'psi': 0.9932759269090712}-{'f1_val': 0.9950237510807955, 'auprc': 0.9994849691237098, 'loss_val': 0.02216631167256436, 'psi': 0.9968082382979613}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=2.362239 (no previous merge yet)
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9964924790422798, 'loss_val': 0.025326173359872566, 'psi': 0.9957096950285367}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969886466474682, 'loss_val': 0.0248529992108741, 'psi': 0.9959081620706121}
[S11] START round=58 head_norm_before_train=2.008675 cos_to_last_merge=0.9983 (last merge round=44)
[S11] round=58 local utility u=0.000162 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983944950903669, 'loss_val': 0.021107196625685495, 'psi': 0.9972860007443005}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983903599707434, 'loss_val': 0.021417833220362763, 'psi': 0.9972843466964512}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=58 head_norm_before_train=1.816350 cos_to_last_merge=0.7826 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.783
[S13] round=58 local utility u=0.000000 metrics={'f1_val': 0.6148253267830938, 'auprc': 0.9698708294735171, 'loss_val': 1.1448105587416255, 'psi': 0.7568435278592631}-{'f1_val': 0.7337330651126936, 'auprc': 0.827384608733966, 'loss_val': 0.8543204810579469, 'psi': 0.7711936825612026}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=58 head_norm_before_train=1.730537 cos_to_last_merge=0.9841 (last merge round=43)
[S14] round=58 local utility u=0.001100 metrics={'f1_val': 0.9960005090247654, 'auprc': 0.9986638990457442, 'loss_val': 0.03801302129805773, 'psi': 0.9970658650331569}-{'f1_val': 0.9960005090247654, 'auprc': 0.9986619014892418, 'loss_val': 0.04020642492268212, 'psi': 0.997065066010556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=58 head_norm_before_train=1.945834 cos_to_last_merge=1.0000 (last merge round=56)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9006175980929763, 'auprc': 0.9960288352284987, 'loss_val': 0.2860892393937236, 'psi': 0.9387820929471853}-{'f1_val': 0.9967466683875206, 'auprc': 0.9961845453323798, 'loss_val': 0.021448979171188178, 'psi': 0.9965218191654642}
[S16] START round=58 head_norm_before_train=1.806456 cos_to_last_merge=1.0000 (last merge round=56)
[S16] round=58 local utility u=0.002285 metrics={'f1_val': 0.9922611820018111, 'auprc': 0.9965012226201406, 'loss_val': 0.04716249753929163, 'psi': 0.9939571982491429}-{'f1_val': 0.9917043959075469, 'auprc': 0.9968948413992182, 'loss_val': 0.04957182029075709, 'psi': 0.9937805741042154}
[S17] START round=58 head_norm_before_train=2.178018 cos_to_last_merge=0.8217 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.822
[S17] round=58 local utility u=0.568062 metrics={'f1_val': 0.8569321772658384, 'auprc': 0.9358289175451557, 'loss_val': 0.6511869948122566, 'psi': 0.8884908733775654}-{'f1_val': 0.7312936814255964, 'auprc': 0.9483627410706639, 'loss_val': 1.0710809375408314, 'psi': 0.8181213052836234}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:58309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:58311
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1803) from S16
[S6] cosine check vs S16: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1801) from S17
[S10] cosine check vs S17: cos=-0.0168
[S10] DROPPED delta from S17 (cos=-0.0168 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S7
[S8] cosine check vs S7: cos=0.9997
[S2] START round=59 head_norm_before_train=2.153973 cos_to_last_merge=0.7964 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=59 local utility u=0.016859 metrics={'f1_val': 0.6831465634001048, 'auprc': 0.725033591280196, 'loss_val': 1.2942860243059262, 'psi': 0.6999013745521413}-{'f1_val': 0.6821138135593342, 'auprc': 0.7238740841376784, 'loss_val': 1.3183290056454624, 'psi': 0.6988179217906718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=60 psi=0.700 u=0.0169 p_local=0.0216 f1=0.683 auprc=0.725 bytes=41371
[S3] START round=59 head_norm_before_train=2.273674 (no previous merge yet)
[S3] round=59 local utility u=0.393652 metrics={'f1_val': 0.8990037912430817, 'auprc': 0.9981462779389807, 'loss_val': 0.17470537798340177, 'psi': 0.9386607859214413}-{'f1_val': 0.8027017385829921, 'auprc': 0.9917588263524126, 'loss_val': 0.3650338553069159, 'psi': 0.8783245736907603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=60 psi=0.939 u=0.3937 p_local=0.0989 f1=0.899 auprc=0.998 bytes=48569
[S4] START round=59 head_norm_before_train=1.964053 cos_to_last_merge=0.9956 (last merge round=36)
[S4] round=59 local utility u=0.000000 metrics={'f1_val': 0.9484027821297014, 'auprc': 0.9186881829285624, 'loss_val': 0.29964963246406556, 'psi': 0.9365169424492459}-{'f1_val': 0.9544443139375968, 'auprc': 0.915213915603225, 'loss_val': 0.3163480287179834, 'psi': 0.938752154603848}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=60 psi=0.937 u=0.0000 p_local=0.0095 f1=0.948 auprc=0.919 bytes=52239
[S5] START round=59 head_norm_before_train=1.941742 cos_to_last_merge=0.9999 (last merge round=56)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9923682286136455, 'loss_val': 0.04301404547775841, 'psi': 0.9944843915821888}-{'f1_val': 0.995895166894551, 'auprc': 0.9904668988178962, 'loss_val': 0.03719766593298067, 'psi': 0.9937238596638891}
[S6] START round=59 head_norm_before_train=1.822124 cos_to_last_merge=0.9998 (last merge round=56)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.6179307372385388, 'auprc': 0.9577742689809376, 'loss_val': 0.7752149044431401, 'psi': 0.7538681499354982}-{'f1_val': 0.6634656251829718, 'auprc': 0.9548437403463841, 'loss_val': 0.7304575793052207, 'psi': 0.7800168712483367}
[S7] START round=59 head_norm_before_train=1.746353 cos_to_last_merge=0.9993 (last merge round=44)
[S7] round=59 local utility u=0.000000 metrics={'f1_val': 0.42164849629507795, 'auprc': 0.7798686748227868, 'loss_val': 1.2250755447652477, 'psi': 0.5649365677061615}-{'f1_val': 0.6812806023142737, 'auprc': 0.8440328270607187, 'loss_val': 0.3233114883351422, 'psi': 0.7463814922128518}
[S8] START round=59 head_norm_before_train=1.786133 cos_to_last_merge=1.0000 (last merge round=57)
[S8] round=59 local utility u=0.734061 metrics={'f1_val': 0.9644913336129775, 'auprc': 0.9994458706906386, 'loss_val': 0.08538941881500295, 'psi': 0.9784731484440419}-{'f1_val': 0.7671528110266188, 'auprc': 0.9827511180785382, 'loss_val': 0.3193956566073729, 'psi': 0.8533921338473865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=59 metric=0.9645 head_norm=1.801525
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.733614e-02
[S8] stored merged vector for next round verification (round=59)
[S8] DEBUG after merge:  round=59 metric=0.9638 head_norm=1.773760 delta_norm=0.037336
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S8] r=60 psi=0.978 u=0.7341 p_local=0.1862 f1=0.964 auprc=0.999 bytes=55768
[S9] START round=59 head_norm_before_train=2.112908 cos_to_last_merge=0.9930 (last merge round=29)
[S9] round=59 local utility u=0.034415 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989628516153817, 'loss_val': 0.017898595368962766, 'psi': 0.9978468881534384}-{'f1_val': 0.9891288930766337, 'auprc': 0.9994964776577274, 'loss_val': 0.040485314810284195, 'psi': 0.9932759269090712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S9] r=60 psi=0.998 u=0.0344 p_local=0.0119 f1=0.997 auprc=0.999 bytes=52173
[S10] START round=59 head_norm_before_train=2.366376 (no previous merge yet)
[S10] round=59 local utility u=0.000831 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9969772895610333, 'loss_val': 0.025118581599192377, 'psi': 0.9959036192360382}-{'f1_val': 0.9951878390193748, 'auprc': 0.9964924790422798, 'loss_val': 0.025326173359872566, 'psi': 0.9957096950285367}
[S11] START round=59 head_norm_before_train=2.017430 cos_to_last_merge=0.9981 (last merge round=44)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9839464698291427, 'auprc': 0.998257012468188, 'loss_val': 0.06155103530682096, 'psi': 0.9896706868847608}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983944950903669, 'loss_val': 0.021107196625685495, 'psi': 0.9972860007443005}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.990 u=0.0000 p_local=0.0373 f1=0.984 auprc=0.998 bytes=48645
[S13] START round=59 head_norm_before_train=1.823448 cos_to_last_merge=0.7815 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.5620529949660218, 'auprc': 0.5467620465733758, 'loss_val': 1.6335610513773704, 'psi': 0.5559366156089633}-{'f1_val': 0.6148253267830938, 'auprc': 0.9698708294735171, 'loss_val': 1.1448105587416255, 'psi': 0.7568435278592631}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.556 u=0.0000 p_local=0.1301 f1=0.562 auprc=0.547 bytes=52200
[S14] START round=59 head_norm_before_train=1.741382 cos_to_last_merge=0.9835 (last merge round=43)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9971793461379964, 'loss_val': 0.03928242030129606, 'psi': 0.9968500436935082}-{'f1_val': 0.9960005090247654, 'auprc': 0.9986638990457442, 'loss_val': 0.03801302129805773, 'psi': 0.9970658650331569}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.997 u=0.0000 p_local=0.0020 f1=0.997 auprc=0.997 bytes=59365
[S15] START round=59 head_norm_before_train=1.967814 cos_to_last_merge=0.9999 (last merge round=56)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.8727174874350656, 'auprc': 0.9912682170058317, 'loss_val': 0.26241482238834657, 'psi': 0.920137779263372}-{'f1_val': 0.9006175980929763, 'auprc': 0.9960288352284987, 'loss_val': 0.2860892393937236, 'psi': 0.9387820929471853}
[S16] START round=59 head_norm_before_train=1.818427 cos_to_last_merge=0.9999 (last merge round=56)
[S16] round=59 local utility u=0.000000 metrics={'f1_val': 0.9907532494907776, 'auprc': 0.9963382903367672, 'loss_val': 0.05206893709359732, 'psi': 0.9929872658291735}-{'f1_val': 0.9922611820018111, 'auprc': 0.9965012226201406, 'loss_val': 0.04716249753929163, 'psi': 0.9939571982491429}
[S17] START round=59 head_norm_before_train=2.184057 cos_to_last_merge=0.8211 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.8037314157263797, 'auprc': 0.922938310965302, 'loss_val': 0.8294421802283807, 'psi': 0.8514141738219487}-{'f1_val': 0.8569321772658384, 'auprc': 0.9358289175451557, 'loss_val': 0.6511869948122566, 'psi': 0.8884908733775654}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S10] → sending delta(kind=head bytes=1785) to S13@127.0.0.1:58313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=59 metric=0.6179 head_norm=1.823266
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.849713e-02
[S6] stored merged vector for next round verification (round=59)
[S6] DEBUG after merge:  round=59 metric=0.6211 head_norm=1.820625 delta_norm=0.028497
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=60 psi=0.754 u=0.0000 p_local=0.1555 f1=0.618 auprc=0.958 bytes=45000
[S16] r=60 psi=0.993 u=0.0000 p_local=0.1177 f1=0.991 auprc=0.996 bytes=48584
[S5] r=60 psi=0.994 u=0.0000 p_local=0.0261 f1=0.996 auprc=0.992 bytes=53967
[S17] r=60 psi=0.851 u=0.0000 p_local=0.2565 f1=0.804 auprc=0.923 bytes=52139
[S10] sending update (kind=head size=1785 to 1 peers)
[S15] r=60 psi=0.920 u=0.0000 p_local=0.1194 f1=0.873 auprc=0.991 bytes=50370
[S7] r=60 psi=0.565 u=0.0000 p_local=0.2441 f1=0.422 auprc=0.780 bytes=52178
[S13] RECEIVED delta(kind=head bytes=1785) from S10
[S13] cosine check vs S10: cos=-0.0944
[S13] DROPPED delta from S10 (cos=-0.0944 < 0.0)
[S10] r=60 psi=0.996 u=0.0008 p_local=0.0003 f1=0.995 auprc=0.997 bytes=61024
[S2] START round=60 head_norm_before_train=2.161342 cos_to_last_merge=0.7956 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=60 local utility u=0.156881 metrics={'f1_val': 0.7190697288584903, 'auprc': 0.726684139403486, 'loss_val': 1.2010139857574356, 'psi': 0.7221154930764886}-{'f1_val': 0.6831465634001048, 'auprc': 0.725033591280196, 'loss_val': 1.2942860243059262, 'psi': 0.6999013745521413}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=60 head_norm_before_train=2.280610 (no previous merge yet)
[S3] round=60 local utility u=0.269374 metrics={'f1_val': 0.9721870293011086, 'auprc': 0.9986393387795761, 'loss_val': 0.07653513616852761, 'psi': 0.9827679530924955}-{'f1_val': 0.8990037912430817, 'auprc': 0.9981462779389807, 'loss_val': 0.17470537798340177, 'psi': 0.9386607859214413}
[S3] not sending this round → trigger blocked (psi=0.983)
[S4] START round=60 head_norm_before_train=1.968971 cos_to_last_merge=0.9952 (last merge round=36)
[S4] round=60 local utility u=0.006638 metrics={'f1_val': 0.9521614707077566, 'auprc': 0.9169151018391658, 'loss_val': 0.30360619001934497, 'psi': 0.9380629231603203}-{'f1_val': 0.9484027821297014, 'auprc': 0.9186881829285624, 'loss_val': 0.29964963246406556, 'psi': 0.9365169424492459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=60 head_norm_before_train=1.948758 cos_to_last_merge=0.9998 (last merge round=56)
[S5] round=60 local utility u=0.003169 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9909382452683559, 'loss_val': 0.03238639378717346, 'psi': 0.993912398244073}-{'f1_val': 0.995895166894551, 'auprc': 0.9923682286136455, 'loss_val': 0.04301404547775841, 'psi': 0.9944843915821888}
[S6] START round=60 head_norm_before_train=1.820625 cos_to_last_merge=1.0000 (last merge round=59)
[S6] round=60 local utility u=0.872606 metrics={'f1_val': 0.8442858536282571, 'auprc': 0.9684299915988993, 'loss_val': 0.42010054935445673, 'psi': 0.893943508816514}-{'f1_val': 0.6179307372385388, 'auprc': 0.9577742689809376, 'loss_val': 0.7752149044431401, 'psi': 0.7538681499354982}
[S7] START round=60 head_norm_before_train=1.750489 cos_to_last_merge=0.9992 (last merge round=44)
[S7] round=60 local utility u=0.974139 metrics={'f1_val': 0.6215801538999035, 'auprc': 0.7986415025703267, 'loss_val': 0.5327067829851052, 'psi': 0.6924046933680728}-{'f1_val': 0.42164849629507795, 'auprc': 0.7798686748227868, 'loss_val': 1.2250755447652477, 'psi': 0.5649365677061615}
[S8] START round=60 head_norm_before_train=1.773760 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=60 local utility u=0.110124 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9986660147279556, 'loss_val': 0.03347090073126432, 'psi': 0.9952281152562763}-{'f1_val': 0.9644913336129775, 'auprc': 0.9994458706906386, 'loss_val': 0.08538941881500295, 'psi': 0.9784731484440419}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=60 head_norm_before_train=2.117970 cos_to_last_merge=0.9927 (last merge round=29)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9992587850766252, 'loss_val': 0.018407178054552668, 'psi': 0.9974535708982166}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989628516153817, 'loss_val': 0.017898595368962766, 'psi': 0.9978468881534384}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=2.373118 (no previous merge yet)
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965489656025958, 'loss_val': 0.0253149294926238, 'psi': 0.9957322896526631}-{'f1_val': 0.9951878390193748, 'auprc': 0.9969772895610333, 'loss_val': 0.025118581599192377, 'psi': 0.9959036192360382}
[S11] START round=60 head_norm_before_train=2.025521 cos_to_last_merge=0.9979 (last merge round=44)
[S11] round=60 local utility u=0.058205 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982897056474518, 'loss_val': 0.02084242291728235, 'psi': 0.9972440849671345}-{'f1_val': 0.9839464698291427, 'auprc': 0.998257012468188, 'loss_val': 0.06155103530682096, 'psi': 0.9896706868847608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] sending update (kind=head size=1805 to 1 peers)
[S13] START round=60 head_norm_before_train=1.826967 cos_to_last_merge=0.7816 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=60 local utility u=1.000000 metrics={'f1_val': 0.7286077784615009, 'auprc': 0.8598076444260695, 'loss_val': 0.9308057951267332, 'psi': 0.7810877248473284}-{'f1_val': 0.5620529949660218, 'auprc': 0.5467620465733758, 'loss_val': 1.6335610513773704, 'psi': 0.5559366156089633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=60 head_norm_before_train=1.751283 cos_to_last_merge=0.9828 (last merge round=43)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9970169797506441, 'loss_val': 0.03789068173664716, 'psi': 0.9966529737541812}-{'f1_val': 0.9966305087305161, 'auprc': 0.9971793461379964, 'loss_val': 0.03928242030129606, 'psi': 0.9968500436935082}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.988362 cos_to_last_merge=0.9998 (last merge round=56)
[S15] round=60 local utility u=0.502073 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9972472186509823, 'loss_val': 0.020381161292234717, 'psi': 0.9969468884929052}-{'f1_val': 0.8727174874350656, 'auprc': 0.9912682170058317, 'loss_val': 0.26241482238834657, 'psi': 0.920137779263372}
[S16] START round=60 head_norm_before_train=1.830497 cos_to_last_merge=0.9999 (last merge round=56)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9473670254480206, 'auprc': 0.9951816675072198, 'loss_val': 0.12252587349481357, 'psi': 0.9664928822717003}-{'f1_val': 0.9907532494907776, 'auprc': 0.9963382903367672, 'loss_val': 0.05206893709359732, 'psi': 0.9929872658291735}
[S17] START round=60 head_norm_before_train=2.189243 cos_to_last_merge=0.8208 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.821
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.7647266617309401, 'auprc': 0.9296092001748932, 'loss_val': 1.0528340070766966, 'psi': 0.8306796771085214}-{'f1_val': 0.8037314157263797, 'auprc': 0.922938310965302, 'loss_val': 0.8294421802283807, 'psi': 0.8514141738219487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] → sending delta(kind=head bytes=1804) to S15@127.0.0.1:58315
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] ⇄ pheromone p=0.094 → S6@127.0.0.1:58307
[S15] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1804 to 1 peers)
[S17] ⇄ pheromone p=0.205 → S10@127.0.0.1:58311
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:58313
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.9997
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=0.9993
[S15] RECEIVED delta(kind=head bytes=1804) from S5
[S15] cosine check vs S5: cos=0.9993
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=60 metric=0.9959 head_norm=1.949101
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.732492e-02
[S5] stored merged vector for next round verification (round=60)
[S5] DEBUG after merge:  round=60 metric=0.9959 head_norm=1.977425 delta_norm=0.047325
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.022 → S15@127.0.0.1:58315
[S7] ⇄ pheromone p=0.390 → S8@127.0.0.1:58309
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=60 metric=0.9967 head_norm=2.006465
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.732493e-02
[S15] stored merged vector for next round verification (round=60)
[S15] DEBUG after merge:  round=60 metric=0.9967 head_norm=1.977425 delta_norm=0.047325
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.196 → S5@127.0.0.1:58305
[S6] ⇄ pheromone p=0.299 → S16@127.0.0.1:58316
[S2] START round=61 head_norm_before_train=2.167716 cos_to_last_merge=0.7949 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.795
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7193796979508624, 'auprc': 0.7251947981909599, 'loss_val': 1.201834839246376, 'psi': 0.7217057380469014}-{'f1_val': 0.7190697288584903, 'auprc': 0.726684139403486, 'loss_val': 1.2010139857574356, 'psi': 0.7221154930764886}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.287736 (no previous merge yet)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9673444834735158, 'auprc': 0.9983811054376482, 'loss_val': 0.09831415801275789, 'psi': 0.9797591322591688}-{'f1_val': 0.9721870293011086, 'auprc': 0.9986393387795761, 'loss_val': 0.07653513616852761, 'psi': 0.9827679530924955}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.976582 cos_to_last_merge=0.9948 (last merge round=36)
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9539082840531735, 'auprc': 0.9153399047530317, 'loss_val': 0.3103970660248833, 'psi': 0.9384809323331169}-{'f1_val': 0.9521614707077566, 'auprc': 0.9169151018391658, 'loss_val': 0.30360619001934497, 'psi': 0.9380629231603203}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.977425 cos_to_last_merge=1.0000 (last merge round=60)
[S5] round=61 local utility u=0.000009 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9912216492906105, 'loss_val': 0.033217743404241246, 'psi': 0.9940257598529748}-{'f1_val': 0.995895166894551, 'auprc': 0.9909382452683559, 'loss_val': 0.03238639378717346, 'psi': 0.993912398244073}
[S6] START round=61 head_norm_before_train=1.827059 cos_to_last_merge=1.0000 (last merge round=59)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.7437389770620196, 'auprc': 0.9547167730096882, 'loss_val': 0.6393245535959956, 'psi': 0.8281300954410871}-{'f1_val': 0.8442858536282571, 'auprc': 0.9684299915988993, 'loss_val': 0.42010054935445673, 'psi': 0.893943508816514}
[S7] START round=61 head_norm_before_train=1.753559 cos_to_last_merge=0.9992 (last merge round=44)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5461115038507331, 'auprc': 0.7809207551939035, 'loss_val': 0.8575155868880663, 'psi': 0.6400352043880013}-{'f1_val': 0.6215801538999035, 'auprc': 0.7986415025703267, 'loss_val': 0.5327067829851052, 'psi': 0.6924046933680728}
[S8] START round=61 head_norm_before_train=1.791557 cos_to_last_merge=1.0000 (last merge round=59)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.967432415504873, 'auprc': 0.9993136496558891, 'loss_val': 0.08110707288942162, 'psi': 0.9801849091652794}-{'f1_val': 0.9929361822751569, 'auprc': 0.9986660147279556, 'loss_val': 0.03347090073126432, 'psi': 0.9952281152562763}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=61 metric=0.9674 head_norm=1.798757
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.295872e-02
[S8] stored merged vector for next round verification (round=61)
[S8] DEBUG after merge:  round=61 metric=0.9674 head_norm=1.775996 delta_norm=0.032959
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=61 head_norm_before_train=2.121300 cos_to_last_merge=0.9926 (last merge round=29)
[S9] round=61 local utility u=0.000220 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9995071636140991, 'loss_val': 0.018837343927856853, 'psi': 0.9975654828838834}-{'f1_val': 0.9962500947792776, 'auprc': 0.9992587850766252, 'loss_val': 0.018407178054552668, 'psi': 0.9974535708982166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=61 head_norm_before_train=2.381885 (no previous merge yet)
[S10] round=61 local utility u=0.000676 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996970332994277, 'loss_val': 0.02522737099306278, 'psi': 0.9959008366093356}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965489656025958, 'loss_val': 0.0253149294926238, 'psi': 0.9957322896526631}
[S11] START round=61 head_norm_before_train=2.033487 cos_to_last_merge=0.9977 (last merge round=44)
[S11] round=61 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9981977611952958, 'loss_val': 0.021521714074808764, 'psi': 0.9969593094261039}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982897056474518, 'loss_val': 0.02084242291728235, 'psi': 0.9972440849671345}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=61 head_norm_before_train=1.822990 cos_to_last_merge=0.7819 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=61 local utility u=0.000000 metrics={'f1_val': 0.6230780977538097, 'auprc': 0.9677841512644753, 'loss_val': 1.0944756947777499, 'psi': 0.7609605191580759}-{'f1_val': 0.7286077784615009, 'auprc': 0.8598076444260695, 'loss_val': 0.9308057951267332, 'psi': 0.7810877248473284}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=61 head_norm_before_train=1.759863 cos_to_last_merge=0.9824 (last merge round=43)
[S14] round=61 local utility u=0.001313 metrics={'f1_val': 0.9961248879791463, 'auprc': 0.9975057189337383, 'loss_val': 0.0350190535374419, 'psi': 0.996677220360983}-{'f1_val': 0.9964103030898727, 'auprc': 0.9970169797506441, 'loss_val': 0.03789068173664716, 'psi': 0.9966529737541812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=61 head_norm_before_train=1.977425 cos_to_last_merge=1.0000 (last merge round=60)
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9217498845524905, 'auprc': 0.9970663873406971, 'loss_val': 0.11661957559636534, 'psi': 0.9518764856677732}-{'f1_val': 0.9967466683875206, 'auprc': 0.9972472186509823, 'loss_val': 0.020381161292234717, 'psi': 0.9969468884929052}
[S16] START round=61 head_norm_before_train=1.842093 cos_to_last_merge=0.9997 (last merge round=56)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9425511466089622, 'auprc': 0.9950266424314053, 'loss_val': 0.16750238896816116, 'psi': 0.9635413449379394}-{'f1_val': 0.9473670254480206, 'auprc': 0.9951816675072198, 'loss_val': 0.12252587349481357, 'psi': 0.9664928822717003}
[S17] START round=61 head_norm_before_train=2.194734 cos_to_last_merge=0.8204 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=61 local utility u=0.294724 metrics={'f1_val': 0.8144351511119949, 'auprc': 0.9470720445579066, 'loss_val': 0.8140259070876044, 'psi': 0.8674899084903596}-{'f1_val': 0.7647266617309401, 'auprc': 0.9296092001748932, 'loss_val': 1.0528340070766966, 'psi': 0.8306796771085214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:58311
[S5] not sending this round → trigger blocked (psi=0.994)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:58313
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=61 metric=0.9426 head_norm=1.851083
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.268431e-02
[S16] stored merged vector for next round verification (round=61)
[S16] DEBUG after merge:  round=61 metric=0.9426 head_norm=1.838820 delta_norm=0.032684
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=-0.0954
[S13] DROPPED delta from S10 (cos=-0.0954 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1796) from S17
[S10] cosine check vs S17: cos=-0.0164
[S10] DROPPED delta from S17 (cos=-0.0164 < 0.0)
[S2] START round=62 head_norm_before_train=2.171421 cos_to_last_merge=0.7938 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.6614845831015003, 'auprc': 0.7187472110654912, 'loss_val': 1.7896890010735331, 'psi': 0.6843896342870966}-{'f1_val': 0.7193796979508624, 'auprc': 0.7251947981909599, 'loss_val': 1.201834839246376, 'psi': 0.7217057380469014}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.294472 (no previous merge yet)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.9617197846434751, 'auprc': 0.997052252995511, 'loss_val': 0.1037504360657123, 'psi': 0.9758527719842894}-{'f1_val': 0.9673444834735158, 'auprc': 0.9983811054376482, 'loss_val': 0.09831415801275789, 'psi': 0.9797591322591688}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.981721 cos_to_last_merge=0.9944 (last merge round=36)
[S4] round=62 local utility u=0.007500 metrics={'f1_val': 0.955335584808514, 'auprc': 0.9154173262198122, 'loss_val': 0.30419304016304716, 'psi': 0.9393682813730333}-{'f1_val': 0.9539082840531735, 'auprc': 0.9153399047530317, 'loss_val': 0.3103970660248833, 'psi': 0.9384809323331169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=62 head_norm_before_train=1.978665 cos_to_last_merge=1.0000 (last merge round=60)
[S5] round=62 local utility u=0.015844 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984289124309516, 'loss_val': 0.02799242031652782, 'psi': 0.9973927460594552}-{'f1_val': 0.995895166894551, 'auprc': 0.9912216492906105, 'loss_val': 0.033217743404241246, 'psi': 0.9940257598529748}
[S6] START round=62 head_norm_before_train=1.841196 cos_to_last_merge=0.9999 (last merge round=59)
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.6283127267358228, 'auprc': 0.9463999755527656, 'loss_val': 0.8234742163191958, 'psi': 0.7555476262626}-{'f1_val': 0.7437389770620196, 'auprc': 0.9547167730096882, 'loss_val': 0.6393245535959956, 'psi': 0.8281300954410871}
[S7] START round=62 head_norm_before_train=1.756154 cos_to_last_merge=0.9991 (last merge round=44)
[S7] round=62 local utility u=0.373316 metrics={'f1_val': 0.6235548832553162, 'auprc': 0.7955086667037599, 'loss_val': 0.619306657945798, 'psi': 0.6923363966346936}-{'f1_val': 0.5461115038507331, 'auprc': 0.7809207551939035, 'loss_val': 0.8575155868880663, 'psi': 0.6400352043880013}
[S8] START round=62 head_norm_before_train=1.775996 cos_to_last_merge=1.0000 (last merge round=61)
[S8] round=62 local utility u=0.061546 metrics={'f1_val': 0.982859765616602, 'auprc': 0.9988898730135013, 'loss_val': 0.04930881504846528, 'psi': 0.9892718085753618}-{'f1_val': 0.967432415504873, 'auprc': 0.9993136496558891, 'loss_val': 0.08110707288942162, 'psi': 0.9801849091652794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=62 head_norm_before_train=2.125587 cos_to_last_merge=0.9924 (last merge round=29)
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9995091253533925, 'loss_val': 0.037640486260058476, 'psi': 0.9937896153817698}-{'f1_val': 0.9962710290637395, 'auprc': 0.9995071636140991, 'loss_val': 0.018837343927856853, 'psi': 0.9975654828838834}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=2.387985 (no previous merge yet)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965501235871053, 'loss_val': 0.025303314014351805, 'psi': 0.995732752846467}-{'f1_val': 0.9951878390193748, 'auprc': 0.996970332994277, 'loss_val': 0.02522737099306278, 'psi': 0.9959008366093356}
[S11] START round=62 head_norm_before_train=2.038792 cos_to_last_merge=0.9975 (last merge round=44)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9591379256815046, 'auprc': 0.9981755002557438, 'loss_val': 0.1300189123778138, 'psi': 0.9747529555112002}-{'f1_val': 0.9961336749133093, 'auprc': 0.9981977611952958, 'loss_val': 0.021521714074808764, 'psi': 0.9969593094261039}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.817438 cos_to_last_merge=0.7819 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.5778261184364779, 'auprc': 0.5424076101126136, 'loss_val': 1.5767802744882906, 'psi': 0.5636587151069322}-{'f1_val': 0.6230780977538097, 'auprc': 0.9677841512644753, 'loss_val': 1.0944756947777499, 'psi': 0.7609605191580759}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.769049 cos_to_last_merge=0.9818 (last merge round=43)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.993922475369681, 'auprc': 0.9968781605656793, 'loss_val': 0.0372907840480244, 'psi': 0.9951047494480805}-{'f1_val': 0.9961248879791463, 'auprc': 0.9975057189337383, 'loss_val': 0.0350190535374419, 'psi': 0.996677220360983}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.994614 cos_to_last_merge=1.0000 (last merge round=60)
[S15] round=62 local utility u=0.266064 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9975927632897127, 'loss_val': 0.026090590462675225, 'psi': 0.9960890981421007}-{'f1_val': 0.9217498845524905, 'auprc': 0.9970663873406971, 'loss_val': 0.11661957559636534, 'psi': 0.9518764856677732}
[S16] START round=62 head_norm_before_train=1.838820 cos_to_last_merge=1.0000 (last merge round=61)
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9302288401664542, 'auprc': 0.9947936042936301, 'loss_val': 0.28163500025089966, 'psi': 0.9560547458173245}-{'f1_val': 0.9425511466089622, 'auprc': 0.9950266424314053, 'loss_val': 0.16750238896816116, 'psi': 0.9635413449379394}
[S17] START round=62 head_norm_before_train=2.196281 cos_to_last_merge=0.8199 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.820
[S17] round=62 local utility u=0.112447 metrics={'f1_val': 0.8321304515176711, 'auprc': 0.9541368935136805, 'loss_val': 0.7164979356066083, 'psi': 0.8809330283160748}-{'f1_val': 0.8144351511119949, 'auprc': 0.9470720445579066, 'loss_val': 0.8140259070876044, 'psi': 0.8674899084903596}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → trigger blocked (psi=0.881)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] → sending delta(kind=head bytes=1805) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:58305
[S7] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1805 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S15
[S5] cosine check vs S15: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1793) from S7
[S8] cosine check vs S7: cos=0.9997
[S15] RECEIVED delta(kind=head bytes=1805) from S5
[S15] cosine check vs S5: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=62 metric=0.9951 head_norm=2.011255
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.950228e-02
[S15] stored merged vector for next round verification (round=62)
[S15] DEBUG after merge:  round=62 metric=0.9951 head_norm=1.996671 delta_norm=0.019502
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=62 metric=0.9967 head_norm=1.982172
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.950229e-02
[S5] stored merged vector for next round verification (round=62)
[S5] DEBUG after merge:  round=62 metric=0.9967 head_norm=1.996671 delta_norm=0.019502
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=63 head_norm_before_train=2.166941 cos_to_last_merge=0.7928 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.793
[S2] round=63 local utility u=0.488360 metrics={'f1_val': 0.7205473613483505, 'auprc': 0.7240261795713077, 'loss_val': 1.1831821433155423, 'psi': 0.7219388886375333}-{'f1_val': 0.6614845831015003, 'auprc': 0.7187472110654912, 'loss_val': 1.7896890010735331, 'psi': 0.6843896342870966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=63 head_norm_before_train=2.301161 (no previous merge yet)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.9602580484078469, 'auprc': 0.9964011383612629, 'loss_val': 0.12374353047607493, 'psi': 0.9747152843892133}-{'f1_val': 0.9617197846434751, 'auprc': 0.997052252995511, 'loss_val': 0.1037504360657123, 'psi': 0.9758527719842894}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.985066 cos_to_last_merge=0.9943 (last merge round=36)
[S4] round=63 local utility u=0.024474 metrics={'f1_val': 0.9523115571767704, 'auprc': 0.9379106557198174, 'loss_val': 0.3045804981259693, 'psi': 0.9465511965939892}-{'f1_val': 0.955335584808514, 'auprc': 0.9154173262198122, 'loss_val': 0.30419304016304716, 'psi': 0.9393682813730333}
[S4] not sending this round → trigger blocked (psi=0.947)
[S5] START round=63 head_norm_before_train=1.996671 cos_to_last_merge=1.0000 (last merge round=62)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9909347994262048, 'loss_val': 0.03071673331568368, 'psi': 0.9939110199072125}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984289124309516, 'loss_val': 0.02799242031652782, 'psi': 0.9973927460594552}
[S6] START round=63 head_norm_before_train=1.855315 cos_to_last_merge=0.9998 (last merge round=59)
[S6] round=63 local utility u=0.471043 metrics={'f1_val': 0.7391415118661769, 'auprc': 0.9356499618053916, 'loss_val': 0.514111855068294, 'psi': 0.8177448918418628}-{'f1_val': 0.6283127267358228, 'auprc': 0.9463999755527656, 'loss_val': 0.8234742163191958, 'psi': 0.7555476262626}
[S7] START round=63 head_norm_before_train=1.760150 cos_to_last_merge=0.9991 (last merge round=44)
[S7] round=63 local utility u=0.217018 metrics={'f1_val': 0.6497699346405618, 'auprc': 0.8140580530348591, 'loss_val': 0.398209040772496, 'psi': 0.7154851819982807}-{'f1_val': 0.6235548832553162, 'auprc': 0.7955086667037599, 'loss_val': 0.619306657945798, 'psi': 0.6923363966346936}
[S8] START round=63 head_norm_before_train=1.788794 cos_to_last_merge=0.9999 (last merge round=61)
[S8] round=63 local utility u=0.040554 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9994106476665451, 'loss_val': 0.031688569266969537, 'psi': 0.9956727451438974}-{'f1_val': 0.982859765616602, 'auprc': 0.9988898730135013, 'loss_val': 0.04930881504846528, 'psi': 0.9892718085753618}
[S8] not sending this round → trigger blocked (psi=0.996)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9932 head_norm=1.810291
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.706735e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9932 head_norm=1.785012 delta_norm=0.037067
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=63 head_norm_before_train=2.128403 cos_to_last_merge=0.9922 (last merge round=29)
[S9] round=63 local utility u=0.031805 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995093060973229, 'loss_val': 0.016771263140260315, 'psi': 0.9980637521624671}-{'f1_val': 0.9899766087340214, 'auprc': 0.9995091253533925, 'loss_val': 0.037640486260058476, 'psi': 0.9937896153817698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=63 head_norm_before_train=2.391913 (no previous merge yet)
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965475052257284, 'loss_val': 0.02534505492533911, 'psi': 0.9957317055019161}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965501235871053, 'loss_val': 0.025303314014351805, 'psi': 0.995732752846467}
[S11] START round=63 head_norm_before_train=2.043573 cos_to_last_merge=0.9974 (last merge round=44)
[S11] round=63 local utility u=0.161157 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9975718447189413, 'loss_val': 0.026418294865541432, 'psi': 0.9965638406087249}-{'f1_val': 0.9591379256815046, 'auprc': 0.9981755002557438, 'loss_val': 0.1300189123778138, 'psi': 0.9747529555112002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=63 head_norm_before_train=1.815374 cos_to_last_merge=0.7821 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=63 local utility u=0.662502 metrics={'f1_val': 0.6315175192863715, 'auprc': 0.7422446778245688, 'loss_val': 1.1734352528884093, 'psi': 0.6758083827016503}-{'f1_val': 0.5778261184364779, 'auprc': 0.5424076101126136, 'loss_val': 1.5767802744882906, 'psi': 0.5636587151069322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=63 head_norm_before_train=1.779517 cos_to_last_merge=0.9809 (last merge round=43)
[S14] round=63 local utility u=0.012465 metrics={'f1_val': 0.9961780715067039, 'auprc': 0.9986628450510824, 'loss_val': 0.03124780204865374, 'psi': 0.9971719809244552}-{'f1_val': 0.993922475369681, 'auprc': 0.9968781605656793, 'loss_val': 0.0372907840480244, 'psi': 0.9951047494480805}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=63 head_norm_before_train=1.996671 cos_to_last_merge=1.0000 (last merge round=62)
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.929099844430396, 'auprc': 0.9975448713285475, 'loss_val': 0.10595452077590145, 'psi': 0.9564778551896566}-{'f1_val': 0.9950866547103594, 'auprc': 0.9975927632897127, 'loss_val': 0.026090590462675225, 'psi': 0.9960890981421007}
[S16] START round=63 head_norm_before_train=1.848099 cos_to_last_merge=1.0000 (last merge round=61)
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9283164343904511, 'auprc': 0.9938339491902822, 'loss_val': 0.2991613013606507, 'psi': 0.9545234403103835}-{'f1_val': 0.9302288401664542, 'auprc': 0.9947936042936301, 'loss_val': 0.28163500025089966, 'psi': 0.9560547458173245}
[S17] START round=63 head_norm_before_train=2.202784 cos_to_last_merge=0.8193 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.8160001669103392, 'auprc': 0.94639801257046, 'loss_val': 0.8075808609802921, 'psi': 0.8681593051743874}-{'f1_val': 0.8321304515176711, 'auprc': 0.9541368935136805, 'loss_val': 0.7164979356066083, 'psi': 0.8809330283160748}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.715)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9991
[S2] START round=64 head_norm_before_train=2.163331 cos_to_last_merge=0.7917 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.792
[S2] round=64 local utility u=0.000000 metrics={'f1_val': 0.6929589223675466, 'auprc': 0.7228808508389447, 'loss_val': 1.236723687812909, 'psi': 0.7049276937561059}-{'f1_val': 0.7205473613483505, 'auprc': 0.7240261795713077, 'loss_val': 1.1831821433155423, 'psi': 0.7219388886375333}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=64 head_norm_before_train=2.307665 (no previous merge yet)
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.9516095202283008, 'auprc': 0.9957700829070005, 'loss_val': 0.12601399099959476, 'psi': 0.9692737452997806}-{'f1_val': 0.9602580484078469, 'auprc': 0.9964011383612629, 'loss_val': 0.12374353047607493, 'psi': 0.9747152843892133}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=1.989461 cos_to_last_merge=0.9942 (last merge round=36)
[S4] round=64 local utility u=0.010974 metrics={'f1_val': 0.9555674895018416, 'auprc': 0.9415348656934028, 'loss_val': 0.3130417141040026, 'psi': 0.9499544399784661}-{'f1_val': 0.9523115571767704, 'auprc': 0.9379106557198174, 'loss_val': 0.3045804981259693, 'psi': 0.9465511965939892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=64 head_norm_before_train=2.000514 cos_to_last_merge=1.0000 (last merge round=62)
[S5] round=64 local utility u=0.006260 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9944174063086394, 'loss_val': 0.02864433794417761, 'psi': 0.9953040626601863}-{'f1_val': 0.995895166894551, 'auprc': 0.9909347994262048, 'loss_val': 0.03071673331568368, 'psi': 0.9939110199072125}
[S6] START round=64 head_norm_before_train=1.872804 cos_to_last_merge=0.9995 (last merge round=59)
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.6490877615816507, 'auprc': 0.946598412726906, 'loss_val': 0.8226219440319905, 'psi': 0.7680920220397529}-{'f1_val': 0.7391415118661769, 'auprc': 0.9356499618053916, 'loss_val': 0.514111855068294, 'psi': 0.8177448918418628}
[S7] START round=64 head_norm_before_train=1.764924 cos_to_last_merge=0.9990 (last merge round=44)
[S7] round=64 local utility u=0.000000 metrics={'f1_val': 0.5834791104277692, 'auprc': 0.7875095674782003, 'loss_val': 0.6633643831205108, 'psi': 0.6650912932479417}-{'f1_val': 0.6497699346405618, 'auprc': 0.8140580530348591, 'loss_val': 0.398209040772496, 'psi': 0.7154851819982807}
[S8] START round=64 head_norm_before_train=1.785012 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9367452742811062, 'auprc': 0.99956891547866, 'loss_val': 0.1404849080574627, 'psi': 0.9618747307601276}-{'f1_val': 0.9931808101287989, 'auprc': 0.9994106476665451, 'loss_val': 0.031688569266969537, 'psi': 0.9956727451438974}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=64 head_norm_before_train=2.131776 cos_to_last_merge=0.9920 (last merge round=29)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9992912469261633, 'loss_val': 0.017383168921803648, 'psi': 0.997978246277751}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995093060973229, 'loss_val': 0.016771263140260315, 'psi': 0.9980637521624671}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=2.394772 (no previous merge yet)
[S10] round=64 local utility u=0.000020 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965529438694701, 'loss_val': 0.025320555165565417, 'psi': 0.995733880959413}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965475052257284, 'loss_val': 0.02534505492533911, 'psi': 0.9957317055019161}
[S11] START round=64 head_norm_before_train=2.048311 cos_to_last_merge=0.9972 (last merge round=44)
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.984181384220388, 'auprc': 0.9985004026107827, 'loss_val': 0.06128999570132664, 'psi': 0.9899089915765459}-{'f1_val': 0.9958918378685807, 'auprc': 0.9975718447189413, 'loss_val': 0.026418294865541432, 'psi': 0.9965638406087249}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.815462 cos_to_last_merge=0.7819 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.782
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6349992697499578, 'auprc': 0.7160498480937767, 'loss_val': 1.218807741154966, 'psi': 0.6674195010874854}-{'f1_val': 0.6315175192863715, 'auprc': 0.7422446778245688, 'loss_val': 1.1734352528884093, 'psi': 0.6758083827016503}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=64 head_norm_before_train=1.787763 cos_to_last_merge=0.9803 (last merge round=43)
[S14] round=64 local utility u=0.000159 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9987417716029973, 'loss_val': 0.03256020659535874, 'psi': 0.9973428904951225}-{'f1_val': 0.9961780715067039, 'auprc': 0.9986628450510824, 'loss_val': 0.03124780204865374, 'psi': 0.9971719809244552}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=64 head_norm_before_train=2.013741 cos_to_last_merge=1.0000 (last merge round=62)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9974958142030979, 'loss_val': 0.20170790782100015, 'psi': 0.9419243753885678}-{'f1_val': 0.929099844430396, 'auprc': 0.9975448713285475, 'loss_val': 0.10595452077590145, 'psi': 0.9564778551896566}
[S16] START round=64 head_norm_before_train=1.856796 cos_to_last_merge=1.0000 (last merge round=61)
[S16] round=64 local utility u=0.312454 metrics={'f1_val': 0.9909444722813033, 'auprc': 0.9959398698627339, 'loss_val': 0.056339882046151764, 'psi': 0.9929426313138755}-{'f1_val': 0.9283164343904511, 'auprc': 0.9938339491902822, 'loss_val': 0.2991613013606507, 'psi': 0.9545234403103835}
[S17] START round=64 head_norm_before_train=2.205904 cos_to_last_merge=0.8188 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.819
[S17] round=64 local utility u=0.101379 metrics={'f1_val': 0.832029647331564, 'auprc': 0.9500750884358697, 'loss_val': 0.7120313882061916, 'psi': 0.8792478237732864}-{'f1_val': 0.8160001669103392, 'auprc': 0.94639801257046, 'loss_val': 0.8075808609802921, 'psi': 0.8681593051743874}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:58313
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0162
[S10] DROPPED delta from S17 (cos=-0.0162 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=-0.0952
[S13] DROPPED delta from S10 (cos=-0.0952 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9986
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=64 metric=0.9909 head_norm=1.864732
[S16] _apply_head_vector_avg (torch): Δ‖w‖=4.134661e-02
[S16] stored merged vector for next round verification (round=64)
[S16] DEBUG after merge:  round=64 metric=0.9909 head_norm=1.868315 delta_norm=0.041347
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=2.168998 cos_to_last_merge=0.7914 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=65 local utility u=0.095911 metrics={'f1_val': 0.7192088076417031, 'auprc': 0.7179947340866961, 'loss_val': 1.1877417592465807, 'psi': 0.7187231782197003}-{'f1_val': 0.6929589223675466, 'auprc': 0.7228808508389447, 'loss_val': 1.236723687812909, 'psi': 0.7049276937561059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=65 head_norm_before_train=2.313936 (no previous merge yet)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.782486567367204, 'auprc': 0.9932125596235415, 'loss_val': 0.44806763363996915, 'psi': 0.8667769642697389}-{'f1_val': 0.9516095202283008, 'auprc': 0.9957700829070005, 'loss_val': 0.12601399099959476, 'psi': 0.9692737452997806}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.993914 cos_to_last_merge=0.9938 (last merge round=36)
[S4] round=65 local utility u=0.032238 metrics={'f1_val': 0.9549173221269178, 'auprc': 0.9611045654331106, 'loss_val': 0.30337339890949505, 'psi': 0.957392219449395}-{'f1_val': 0.9555674895018416, 'auprc': 0.9415348656934028, 'loss_val': 0.3130417141040026, 'psi': 0.9499544399784661}
[S4] not sending this round → trigger blocked (psi=0.957)
[S5] START round=65 head_norm_before_train=2.002523 cos_to_last_merge=1.0000 (last merge round=62)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9906281021304775, 'loss_val': 0.031181001307703172, 'psi': 0.9937883409889215}-{'f1_val': 0.995895166894551, 'auprc': 0.9944174063086394, 'loss_val': 0.02864433794417761, 'psi': 0.9953040626601863}
[S6] START round=65 head_norm_before_train=1.887154 cos_to_last_merge=0.9992 (last merge round=59)
[S6] round=65 local utility u=0.945195 metrics={'f1_val': 0.8694847587470149, 'auprc': 0.9711795537287541, 'loss_val': 0.32835739118950913, 'psi': 0.9101626767397106}-{'f1_val': 0.6490877615816507, 'auprc': 0.946598412726906, 'loss_val': 0.8226219440319905, 'psi': 0.7680920220397529}
[S7] START round=65 head_norm_before_train=1.770685 cos_to_last_merge=0.9989 (last merge round=44)
[S7] round=65 local utility u=0.009938 metrics={'f1_val': 0.6014975143708181, 'auprc': 0.7903469147246904, 'loss_val': 0.7601103129187745, 'psi': 0.6770372745123671}-{'f1_val': 0.5834791104277692, 'auprc': 0.7875095674782003, 'loss_val': 0.6633643831205108, 'psi': 0.6650912932479417}
[S8] START round=65 head_norm_before_train=1.805662 cos_to_last_merge=0.9999 (last merge round=63)
[S8] round=65 local utility u=0.225831 metrics={'f1_val': 0.9945903856431277, 'auprc': 0.9989918510968785, 'loss_val': 0.03416180469909372, 'psi': 0.996350971824628}-{'f1_val': 0.9367452742811062, 'auprc': 0.99956891547866, 'loss_val': 0.1404849080574627, 'psi': 0.9618747307601276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=65 head_norm_before_train=2.136590 cos_to_last_merge=0.9918 (last merge round=29)
[S9] round=65 local utility u=0.000516 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995060602974437, 'loss_val': 0.016995378769588263, 'psi': 0.9980641716262632}-{'f1_val': 0.9971029125121428, 'auprc': 0.9992912469261633, 'loss_val': 0.017383168921803648, 'psi': 0.997978246277751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=65 head_norm_before_train=2.398530 (no previous merge yet)
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965570683666622, 'loss_val': 0.025533396148609708, 'psi': 0.9957355307582898}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965529438694701, 'loss_val': 0.025320555165565417, 'psi': 0.995733880959413}
[S11] START round=65 head_norm_before_train=2.052402 cos_to_last_merge=0.9972 (last merge round=44)
[S11] round=65 local utility u=0.057299 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983798389796714, 'loss_val': 0.020524871414262763, 'psi': 0.9972801383000223}-{'f1_val': 0.984181384220388, 'auprc': 0.9985004026107827, 'loss_val': 0.06128999570132664, 'psi': 0.9899089915765459}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=65 head_norm_before_train=1.823853 cos_to_last_merge=0.7811 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.781
[S13] round=65 local utility u=0.854609 metrics={'f1_val': 0.7531787399031968, 'auprc': 0.888873787153263, 'loss_val': 0.737138060340583, 'psi': 0.8074567588032233}-{'f1_val': 0.6349992697499578, 'auprc': 0.7160498480937767, 'loss_val': 1.218807741154966, 'psi': 0.6674195010874854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=65 head_norm_before_train=1.795357 cos_to_last_merge=0.9797 (last merge round=43)
[S14] round=65 local utility u=0.000219 metrics={'f1_val': 0.9961505794277568, 'auprc': 0.9991122758718306, 'loss_val': 0.03167524090951498, 'psi': 0.9973352580053864}-{'f1_val': 0.9964103030898727, 'auprc': 0.9987417716029973, 'loss_val': 0.03256020659535874, 'psi': 0.9973428904951225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=65 head_norm_before_train=2.030691 cos_to_last_merge=0.9999 (last merge round=62)
[S15] round=65 local utility u=0.367760 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979483259721453, 'loss_val': 0.018765637771796014, 'psi': 0.9972273314213704}-{'f1_val': 0.9048767495122143, 'auprc': 0.9974958142030979, 'loss_val': 0.20170790782100015, 'psi': 0.9419243753885678}
[S16] START round=65 head_norm_before_train=1.868315 cos_to_last_merge=1.0000 (last merge round=64)
[S16] round=65 local utility u=0.006632 metrics={'f1_val': 0.9909650639664249, 'auprc': 0.9969100884650615, 'loss_val': 0.046109324801202854, 'psi': 0.9933430737658795}-{'f1_val': 0.9909444722813033, 'auprc': 0.9959398698627339, 'loss_val': 0.056339882046151764, 'psi': 0.9929426313138755}
[S17] START round=65 head_norm_before_train=2.211238 cos_to_last_merge=0.8182 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=65 local utility u=0.201193 metrics={'f1_val': 0.8743527247596098, 'auprc': 0.9607853207674203, 'loss_val': 0.5957139824126749, 'psi': 0.9089257631627341}-{'f1_val': 0.832029647331564, 'auprc': 0.9500750884358697, 'loss_val': 0.7120313882061916, 'psi': 0.8792478237732864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:58309
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] ⇄ pheromone p=0.010 → S15@127.0.0.1:58315
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:58313
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9993
[S8] RECEIVED delta(kind=head bytes=1799) from S7
[S8] cosine check vs S7: cos=0.9994
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=0.9998
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9993
[S10] RECEIVED delta(kind=head bytes=1798) from S17
[S10] cosine check vs S17: cos=-0.0162
[S10] DROPPED delta from S17 (cos=-0.0162 < 0.0)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=65 metric=0.9910 head_norm=1.876167
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.783897e-02
[S16] stored merged vector for next round verification (round=65)
[S16] DEBUG after merge:  round=65 metric=0.9910 head_norm=1.886695 delta_norm=0.037839
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.082 → S6@127.0.0.1:58307
[S17] ⇄ pheromone p=0.159 → S10@127.0.0.1:58311
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=65 metric=0.9967 head_norm=2.045659
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.739985e-02
[S15] stored merged vector for next round verification (round=65)
[S15] DEBUG after merge:  round=65 metric=0.9967 head_norm=2.024020 delta_norm=0.027400
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.165 → S5@127.0.0.1:58305
[S7] ⇄ pheromone p=0.196 → S8@127.0.0.1:58309
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=65 metric=0.8695 head_norm=1.897920
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.704660e-02
[S6] stored merged vector for next round verification (round=65)
[S6] DEBUG after merge:  round=65 metric=0.8695 head_norm=1.883602 delta_norm=0.047047
[S6] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.347 → S16@127.0.0.1:58316
[S2] START round=66 head_norm_before_train=2.177728 cos_to_last_merge=0.7913 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=66 local utility u=0.002798 metrics={'f1_val': 0.719998582488914, 'auprc': 0.718813602720651, 'loss_val': 1.1893406446067294, 'psi': 0.7195245905816088}-{'f1_val': 0.7192088076417031, 'auprc': 0.7179947340866961, 'loss_val': 1.1877417592465807, 'psi': 0.7187231782197003}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=66 head_norm_before_train=2.319384 (no previous merge yet)
[S3] round=66 local utility u=0.439555 metrics={'f1_val': 0.8982106460578997, 'auprc': 0.9887846223826227, 'loss_val': 0.25001768832761956, 'psi': 0.9344402365877889}-{'f1_val': 0.782486567367204, 'auprc': 0.9932125596235415, 'loss_val': 0.44806763363996915, 'psi': 0.8667769642697389}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=66 head_norm_before_train=1.998278 cos_to_last_merge=0.9936 (last merge round=36)
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9505677178899632, 'auprc': 0.9370397285216088, 'loss_val': 0.3040048645074271, 'psi': 0.9451565221426215}-{'f1_val': 0.9549173221269178, 'auprc': 0.9611045654331106, 'loss_val': 0.30337339890949505, 'psi': 0.957392219449395}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=2.007804 cos_to_last_merge=0.9999 (last merge round=62)
[S5] round=66 local utility u=0.000000 metrics={'f1_val': 0.9536077032072366, 'auprc': 0.9902459267396055, 'loss_val': 0.08922252680196303, 'psi': 0.9682629926201842}-{'f1_val': 0.995895166894551, 'auprc': 0.9906281021304775, 'loss_val': 0.031181001307703172, 'psi': 0.9937883409889215}
[S6] START round=66 head_norm_before_train=1.883602 cos_to_last_merge=1.0000 (last merge round=65)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6902264264382648, 'auprc': 0.9310965520495187, 'loss_val': 0.8007462668992237, 'psi': 0.7865744766827664}-{'f1_val': 0.8694847587470149, 'auprc': 0.9711795537287541, 'loss_val': 0.32835739118950913, 'psi': 0.9101626767397106}
[S7] START round=66 head_norm_before_train=1.776203 cos_to_last_merge=0.9987 (last merge round=44)
[S7] round=66 local utility u=0.038788 metrics={'f1_val': 0.6009305486510541, 'auprc': 0.7917808395461593, 'loss_val': 0.6834346894427944, 'psi': 0.6772706650090963}-{'f1_val': 0.6014975143708181, 'auprc': 0.7903469147246904, 'loss_val': 0.7601103129187745, 'psi': 0.6770372745123671}
[S8] START round=66 head_norm_before_train=1.821290 cos_to_last_merge=0.9999 (last merge round=63)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9911512697055136, 'auprc': 0.999474263657864, 'loss_val': 0.02961144157642484, 'psi': 0.9944804672864538}-{'f1_val': 0.9945903856431277, 'auprc': 0.9989918510968785, 'loss_val': 0.03416180469909372, 'psi': 0.996350971824628}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=66 metric=0.9912 head_norm=1.842247
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.793543e-02
[S8] stored merged vector for next round verification (round=66)
[S8] DEBUG after merge:  round=66 metric=0.9912 head_norm=1.808891 delta_norm=0.047935
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=66 head_norm_before_train=2.140417 cos_to_last_merge=0.9916 (last merge round=29)
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.999500047290667, 'loss_val': 0.042125904181742634, 'psi': 0.9931271585103156}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995060602974437, 'loss_val': 0.016995378769588263, 'psi': 0.9980641716262632}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=2.402244 (no previous merge yet)
[S10] round=66 local utility u=0.000256 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965791565766281, 'loss_val': 0.025087436596274205, 'psi': 0.995744366042276}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965570683666622, 'loss_val': 0.025533396148609708, 'psi': 0.9957355307582898}
[S11] START round=66 head_norm_before_train=2.057389 cos_to_last_merge=0.9971 (last merge round=44)
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981541621386223, 'loss_val': 0.020855582891380973, 'psi': 0.9971898675636026}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983798389796714, 'loss_val': 0.020524871414262763, 'psi': 0.9972801383000223}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.832589 cos_to_last_merge=0.7804 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.780
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.7387510601005638, 'auprc': 0.8754996391972696, 'loss_val': 0.7790129745687507, 'psi': 0.7934504917392462}-{'f1_val': 0.7531787399031968, 'auprc': 0.888873787153263, 'loss_val': 0.737138060340583, 'psi': 0.8074567588032233}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=1.804361 cos_to_last_merge=0.9790 (last merge round=43)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9957150943548921, 'auprc': 0.9986587792178679, 'loss_val': 0.030564360232821105, 'psi': 0.9968925683000824}-{'f1_val': 0.9961505794277568, 'auprc': 0.9991122758718306, 'loss_val': 0.03167524090951498, 'psi': 0.9973352580053864}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.024020 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.9957570394108066, 'loss_val': 0.17809839624923446, 'psi': 0.9395186226446404}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979483259721453, 'loss_val': 0.018765637771796014, 'psi': 0.9972273314213704}
[S16] START round=66 head_norm_before_train=1.886695 cos_to_last_merge=1.0000 (last merge round=65)
[S16] round=66 local utility u=0.000000 metrics={'f1_val': 0.94715418825911, 'auprc': 0.9902584965120198, 'loss_val': 0.12191440735031008, 'psi': 0.9643959115602739}-{'f1_val': 0.9909650639664249, 'auprc': 0.9969100884650615, 'loss_val': 0.046109324801202854, 'psi': 0.9933430737658795}
[S17] START round=66 head_norm_before_train=2.219813 cos_to_last_merge=0.8175 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.818
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.8244342402887496, 'auprc': 0.9795836680570174, 'loss_val': 0.834974305028855, 'psi': 0.8864940113960567}-{'f1_val': 0.8743527247596098, 'auprc': 0.9607853207674203, 'loss_val': 0.5957139824126749, 'psi': 0.9089257631627341}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → trigger blocked (psi=0.677)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:58313
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=66 metric=0.9536 head_norm=2.011366
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.647989e-02
[S5] stored merged vector for next round verification (round=66)
[S5] DEBUG after merge:  round=66 metric=0.9536 head_norm=2.028412 delta_norm=0.026480
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=-0.0955
[S13] DROPPED delta from S10 (cos=-0.0955 < 0.0)
[S2] START round=67 head_norm_before_train=2.184743 cos_to_last_merge=0.7908 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=67 local utility u=0.094867 metrics={'f1_val': 0.7066478473549139, 'auprc': 0.7638603646620125, 'loss_val': 1.0546415240471365, 'psi': 0.7295328542777533}-{'f1_val': 0.719998582488914, 'auprc': 0.718813602720651, 'loss_val': 1.1893406446067294, 'psi': 0.7195245905816088}
[S2] not sending this round → trigger blocked (psi=0.730)
[S3] START round=67 head_norm_before_train=2.325274 (no previous merge yet)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.781585674930204, 'auprc': 0.9855560749615213, 'loss_val': 0.4832312869196813, 'psi': 0.8631738349427309}-{'f1_val': 0.8982106460578997, 'auprc': 0.9887846223826227, 'loss_val': 0.25001768832761956, 'psi': 0.9344402365877889}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.997937 cos_to_last_merge=0.9934 (last merge round=36)
[S4] round=67 local utility u=0.040495 metrics={'f1_val': 0.9519277720159466, 'auprc': 0.9579813952361933, 'loss_val': 0.29400087575193434, 'psi': 0.9543492213040452}-{'f1_val': 0.9505677178899632, 'auprc': 0.9370397285216088, 'loss_val': 0.3040048645074271, 'psi': 0.9451565221426215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=67 head_norm_before_train=2.028412 cos_to_last_merge=1.0000 (last merge round=66)
[S5] round=67 local utility u=0.168359 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9952014273850492, 'loss_val': 0.025937542924263104, 'psi': 0.9961017520410943}-{'f1_val': 0.9536077032072366, 'auprc': 0.9902459267396055, 'loss_val': 0.08922252680196303, 'psi': 0.9682629926201842}
[S6] START round=67 head_norm_before_train=1.889170 cos_to_last_merge=0.9999 (last merge round=65)
[S6] round=67 local utility u=0.317874 metrics={'f1_val': 0.7625564757215988, 'auprc': 0.9334271701168994, 'loss_val': 0.6059706661170207, 'psi': 0.830904753479719}-{'f1_val': 0.6902264264382648, 'auprc': 0.9310965520495187, 'loss_val': 0.8007462668992237, 'psi': 0.7865744766827664}
[S7] START round=67 head_norm_before_train=1.781617 cos_to_last_merge=0.9986 (last merge round=44)
[S7] round=67 local utility u=0.657455 metrics={'f1_val': 0.7523087392946352, 'auprc': 0.8252140451703431, 'loss_val': 0.3770926752811126, 'psi': 0.7814708616449184}-{'f1_val': 0.6009305486510541, 'auprc': 0.7917808395461593, 'loss_val': 0.6834346894427944, 'psi': 0.6772706650090963}
[S8] START round=67 head_norm_before_train=1.808891 cos_to_last_merge=1.0000 (last merge round=66)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9877271054023866, 'auprc': 0.999245232994838, 'loss_val': 0.03686820664080512, 'psi': 0.9923343564393672}-{'f1_val': 0.9911512697055136, 'auprc': 0.999474263657864, 'loss_val': 0.02961144157642484, 'psi': 0.9944804672864538}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.144705 cos_to_last_merge=0.9913 (last merge round=29)
[S9] round=67 local utility u=0.037394 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995093444919394, 'loss_val': 0.016711144823017183, 'psi': 0.9980654853040615}-{'f1_val': 0.9888785659900814, 'auprc': 0.999500047290667, 'loss_val': 0.042125904181742634, 'psi': 0.9931271585103156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=67 head_norm_before_train=2.411303 (no previous merge yet)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961809328414282, 'loss_val': 0.0250562985863291, 'psi': 0.9955850765481962}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965791565766281, 'loss_val': 0.025087436596274205, 'psi': 0.995744366042276}
[S11] START round=67 head_norm_before_train=2.063427 cos_to_last_merge=0.9969 (last merge round=44)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9905642480865886, 'auprc': 0.9982714791269447, 'loss_val': 0.037542849646430176, 'psi': 0.9936471405027311}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981541621386223, 'loss_val': 0.020855582891380973, 'psi': 0.9971898675636026}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=67 head_norm_before_train=1.838624 cos_to_last_merge=0.7796 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.780
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.7151877181662932, 'auprc': 0.8081767380212733, 'loss_val': 0.8442650775441602, 'psi': 0.7523833261082853}-{'f1_val': 0.7387510601005638, 'auprc': 0.8754996391972696, 'loss_val': 0.7790129745687507, 'psi': 0.7934504917392462}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.813293 cos_to_last_merge=0.9782 (last merge round=43)
[S14] round=67 local utility u=0.002334 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9986559020026039, 'loss_val': 0.030058775990320443, 'psi': 0.9973085426549652}-{'f1_val': 0.9957150943548921, 'auprc': 0.9986587792178679, 'loss_val': 0.030564360232821105, 'psi': 0.9968925683000824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=67 head_norm_before_train=2.038321 cos_to_last_merge=1.0000 (last merge round=65)
[S15] round=67 local utility u=0.014476 metrics={'f1_val': 0.9043091071080305, 'auprc': 0.9958865331636187, 'loss_val': 0.16323052257449244, 'psi': 0.9409400775302658}-{'f1_val': 0.9020263448005295, 'auprc': 0.9957570394108066, 'loss_val': 0.17809839624923446, 'psi': 0.9395186226446404}
[S16] START round=67 head_norm_before_train=1.894158 cos_to_last_merge=1.0000 (last merge round=65)
[S16] round=67 local utility u=0.157027 metrics={'f1_val': 0.9883941068874685, 'auprc': 0.9928664519096605, 'loss_val': 0.06312293169166218, 'psi': 0.9901830448963453}-{'f1_val': 0.94715418825911, 'auprc': 0.9902584965120198, 'loss_val': 0.12191440735031008, 'psi': 0.9643959115602739}
[S17] START round=67 head_norm_before_train=2.228004 cos_to_last_merge=0.8171 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.817
[S17] round=67 local utility u=0.282392 metrics={'f1_val': 0.8810655193943644, 'auprc': 0.969846804343091, 'loss_val': 0.5807664071423475, 'psi': 0.916578033373855}-{'f1_val': 0.8244342402887496, 'auprc': 0.9795836680570174, 'loss_val': 0.834974305028855, 'psi': 0.8864940113960567}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:58311
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:58309
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.9995
[S10] RECEIVED delta(kind=head bytes=1791) from S17
[S10] cosine check vs S17: cos=-0.0161
[S10] DROPPED delta from S17 (cos=-0.0161 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9995
[S8] RECEIVED delta(kind=head bytes=1800) from S7
[S8] cosine check vs S7: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=67 metric=0.7626 head_norm=1.895647
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.930782e-02
[S6] stored merged vector for next round verification (round=67)
[S6] DEBUG after merge:  round=67 metric=0.7653 head_norm=1.898723 delta_norm=0.029308
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=67 metric=0.9043 head_norm=2.052980
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.504387e-02
[S15] stored merged vector for next round verification (round=67)
[S15] DEBUG after merge:  round=67 metric=0.9043 head_norm=2.043075 delta_norm=0.015044
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=67 metric=0.9967 head_norm=2.033232
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.504387e-02
[S5] stored merged vector for next round verification (round=67)
[S5] DEBUG after merge:  round=67 metric=0.9967 head_norm=2.043075 delta_norm=0.015044
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=67 metric=0.9884 head_norm=1.902246
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.930782e-02
[S16] stored merged vector for next round verification (round=67)
[S16] DEBUG after merge:  round=67 metric=0.9888 head_norm=1.898723 delta_norm=0.029308
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=68 head_norm_before_train=2.193890 cos_to_last_merge=0.7904 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.6473599218640993, 'auprc': 0.7553428403549092, 'loss_val': 1.2639373024253338, 'psi': 0.6905530892604232}-{'f1_val': 0.7066478473549139, 'auprc': 0.7638603646620125, 'loss_val': 1.0546415240471365, 'psi': 0.7295328542777533}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.330615 (no previous merge yet)
[S3] round=68 local utility u=0.128272 metrics={'f1_val': 0.8034626527046209, 'auprc': 0.9960312859977677, 'loss_val': 0.38937456653336655, 'psi': 0.8804901060218796}-{'f1_val': 0.781585674930204, 'auprc': 0.9855560749615213, 'loss_val': 0.4832312869196813, 'psi': 0.8631738349427309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=68 head_norm_before_train=2.001343 cos_to_last_merge=0.9930 (last merge round=36)
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9505656005803814, 'auprc': 0.9429552906555719, 'loss_val': 0.29509197297771705, 'psi': 0.9475214766104576}-{'f1_val': 0.9519277720159466, 'auprc': 0.9579813952361933, 'loss_val': 0.29400087575193434, 'psi': 0.9543492213040452}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=2.043075 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9905119463431974, 'loss_val': 0.03164719165861605, 'psi': 0.9937418786740095}-{'f1_val': 0.9967019684784577, 'auprc': 0.9952014273850492, 'loss_val': 0.025937542924263104, 'psi': 0.9961017520410943}
[S6] START round=68 head_norm_before_train=1.898723 cos_to_last_merge=1.0000 (last merge round=67)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.7108002323596412, 'auprc': 0.942588701531907, 'loss_val': 0.5727275199824582, 'psi': 0.8035156200285476}-{'f1_val': 0.7625564757215988, 'auprc': 0.9334271701168994, 'loss_val': 0.6059706661170207, 'psi': 0.830904753479719}
[S7] START round=68 head_norm_before_train=1.785565 cos_to_last_merge=0.9985 (last merge round=44)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.5323541630996582, 'auprc': 0.7809453627794078, 'loss_val': 0.9826196657537616, 'psi': 0.6317906429715581}-{'f1_val': 0.7523087392946352, 'auprc': 0.8252140451703431, 'loss_val': 0.3770926752811126, 'psi': 0.7814708616449184}
[S8] START round=68 head_norm_before_train=1.830882 cos_to_last_merge=1.0000 (last merge round=66)
[S8] round=68 local utility u=0.018513 metrics={'f1_val': 0.9931113357884451, 'auprc': 0.9992456433316651, 'loss_val': 0.032148878202506954, 'psi': 0.9955650588057331}-{'f1_val': 0.9877271054023866, 'auprc': 0.999245232994838, 'loss_val': 0.03686820664080512, 'psi': 0.9923343564393672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=68 metric=0.9931 head_norm=1.845403
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.358002e-02
[S8] stored merged vector for next round verification (round=68)
[S8] DEBUG after merge:  round=68 metric=0.9931 head_norm=1.815207 delta_norm=0.043580
[S8] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S9] START round=68 head_norm_before_train=2.146505 cos_to_last_merge=0.9912 (last merge round=29)
[S9] round=68 local utility u=0.000379 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998396833060863, 'loss_val': 0.016944298083795887, 'psi': 0.9981976208297202}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995093444919394, 'loss_val': 0.016711144823017183, 'psi': 0.9980654853040615}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=68 head_norm_before_train=2.421325 (no previous merge yet)
[S10] round=68 local utility u=0.000062 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963007410190319, 'loss_val': 0.025292192115519894, 'psi': 0.9956329998192376}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961809328414282, 'loss_val': 0.0250562985863291, 'psi': 0.9955850765481962}
[S11] START round=68 head_norm_before_train=2.069390 cos_to_last_merge=0.9968 (last merge round=44)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9771771106412295, 'auprc': 0.9980428826847935, 'loss_val': 0.08720046886301201, 'psi': 0.9855234194586551}-{'f1_val': 0.9905642480865886, 'auprc': 0.9982714791269447, 'loss_val': 0.037542849646430176, 'psi': 0.9936471405027311}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.849939 cos_to_last_merge=0.7788 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.779
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.626843801129926, 'auprc': 0.6527025945689459, 'loss_val': 1.32676206230107, 'psi': 0.6371873185055339}-{'f1_val': 0.7151877181662932, 'auprc': 0.8081767380212733, 'loss_val': 0.8442650775441602, 'psi': 0.7523833261082853}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.821792 cos_to_last_merge=0.9774 (last merge round=43)
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9971154814582004, 'loss_val': 0.0306096684585065, 'psi': 0.9969385403653526}-{'f1_val': 0.9964103030898727, 'auprc': 0.9986559020026039, 'loss_val': 0.030058775990320443, 'psi': 0.9973085426549652}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=2.043075 cos_to_last_merge=1.0000 (last merge round=67)
[S15] round=68 local utility u=0.351446 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9975124660663004, 'loss_val': 0.019841413264547903, 'psi': 0.9970529874590325}-{'f1_val': 0.9043091071080305, 'auprc': 0.9958865331636187, 'loss_val': 0.16323052257449244, 'psi': 0.9409400775302658}
[S16] START round=68 head_norm_before_train=1.898723 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=68 local utility u=0.021137 metrics={'f1_val': 0.9909169059752453, 'auprc': 0.9954018594391177, 'loss_val': 0.043592195726772934, 'psi': 0.9927108873607943}-{'f1_val': 0.9883941068874685, 'auprc': 0.9928664519096605, 'loss_val': 0.06312293169166218, 'psi': 0.9901830448963453}
[S17] START round=68 head_norm_before_train=2.232798 cos_to_last_merge=0.8163 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=68 local utility u=0.000000 metrics={'f1_val': 0.827456018663058, 'auprc': 0.9825443784501616, 'loss_val': 0.816805997555795, 'psi': 0.8894913625778994}-{'f1_val': 0.8810655193943644, 'auprc': 0.969846804343091, 'loss_val': 0.5807664071423475, 'psi': 0.916578033373855}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.997)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S16] not sending this round → trigger blocked (psi=0.993)
[S2] START round=69 head_norm_before_train=2.203126 cos_to_last_merge=0.7901 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=69 local utility u=0.262313 metrics={'f1_val': 0.7168722994724974, 'auprc': 0.7461495494329279, 'loss_val': 1.1288047942194182, 'psi': 0.7285831994566696}-{'f1_val': 0.6473599218640993, 'auprc': 0.7553428403549092, 'loss_val': 1.2639373024253338, 'psi': 0.6905530892604232}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=69 head_norm_before_train=2.336121 (no previous merge yet)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.7774579904985239, 'auprc': 0.9979674225228354, 'loss_val': 0.47569121082701493, 'psi': 0.8656617633082485}-{'f1_val': 0.8034626527046209, 'auprc': 0.9960312859977677, 'loss_val': 0.38937456653336655, 'psi': 0.8804901060218796}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=2.005668 cos_to_last_merge=0.9925 (last merge round=36)
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.947390069265705, 'auprc': 0.9027193611659665, 'loss_val': 0.31385985447091536, 'psi': 0.9295217860258096}-{'f1_val': 0.9505656005803814, 'auprc': 0.9429552906555719, 'loss_val': 0.29509197297771705, 'psi': 0.9475214766104576}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=2.047574 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=69 local utility u=0.002537 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9911016051489129, 'loss_val': 0.028341877322119374, 'psi': 0.9939777421962958}-{'f1_val': 0.995895166894551, 'auprc': 0.9905119463431974, 'loss_val': 0.03164719165861605, 'psi': 0.9937418786740095}
[S6] START round=69 head_norm_before_train=1.904758 cos_to_last_merge=0.9999 (last merge round=67)
[S6] round=69 local utility u=0.336194 metrics={'f1_val': 0.8172463118131803, 'auprc': 0.9482421637700644, 'loss_val': 0.5559762893025981, 'psi': 0.8696446525959339}-{'f1_val': 0.7108002323596412, 'auprc': 0.942588701531907, 'loss_val': 0.5727275199824582, 'psi': 0.8035156200285476}
[S7] START round=69 head_norm_before_train=1.788258 cos_to_last_merge=0.9984 (last merge round=44)
[S7] round=69 local utility u=0.411538 metrics={'f1_val': 0.6143859350257832, 'auprc': 0.7910136386035072, 'loss_val': 0.6819391499454017, 'psi': 0.6850370164568728}-{'f1_val': 0.5323541630996582, 'auprc': 0.7809453627794078, 'loss_val': 0.9826196657537616, 'psi': 0.6317906429715581}
[S8] START round=69 head_norm_before_train=1.815207 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=69 local utility u=0.002776 metrics={'f1_val': 0.993467150337892, 'auprc': 0.9993177322768009, 'loss_val': 0.02894759059810586, 'psi': 0.9958073831134556}-{'f1_val': 0.9931113357884451, 'auprc': 0.9992456433316651, 'loss_val': 0.032148878202506954, 'psi': 0.9955650588057331}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=69 head_norm_before_train=2.146606 cos_to_last_merge=0.9909 (last merge round=29)
[S9] round=69 local utility u=0.001468 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998655905062387, 'loss_val': 0.01655055344485234, 'psi': 0.998454526656542}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998396833060863, 'loss_val': 0.016944298083795887, 'psi': 0.9981976208297202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=69 head_norm_before_train=2.430905 (no previous merge yet)
[S10] round=69 local utility u=0.000227 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996542626846515, 'loss_val': 0.025564074396095295, 'psi': 0.9957297541502308}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963007410190319, 'loss_val': 0.025292192115519894, 'psi': 0.9956329998192376}
[S11] START round=69 head_norm_before_train=2.075613 cos_to_last_merge=0.9966 (last merge round=44)
[S11] round=69 local utility u=0.092030 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982937319144705, 'loss_val': 0.020113306866816887, 'psi': 0.9972456954739419}-{'f1_val': 0.9771771106412295, 'auprc': 0.9980428826847935, 'loss_val': 0.08720046886301201, 'psi': 0.9855234194586551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=69 head_norm_before_train=1.865912 cos_to_last_merge=0.7774 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.777
[S13] round=69 local utility u=0.494936 metrics={'f1_val': 0.6874668671775761, 'auprc': 0.7610621322699649, 'loss_val': 1.0257069401820635, 'psi': 0.7169049732145316}-{'f1_val': 0.626843801129926, 'auprc': 0.6527025945689459, 'loss_val': 1.32676206230107, 'psi': 0.6371873185055339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=69 head_norm_before_train=1.828624 cos_to_last_merge=0.9769 (last merge round=43)
[S14] round=69 local utility u=0.000203 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9971957199931291, 'loss_val': 0.030445190598882878, 'psi': 0.9969706357793241}-{'f1_val': 0.9968205796367875, 'auprc': 0.9971154814582004, 'loss_val': 0.0306096684585065, 'psi': 0.9969385403653526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=69 head_norm_before_train=2.057791 cos_to_last_merge=1.0000 (last merge round=67)
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.7317624369544298, 'auprc': 0.9116164508878017, 'loss_val': 0.5954727111520389, 'psi': 0.8037040425277786}-{'f1_val': 0.9967466683875206, 'auprc': 0.9975124660663004, 'loss_val': 0.019841413264547903, 'psi': 0.9970529874590325}
[S16] START round=69 head_norm_before_train=1.906778 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9911361313038187, 'auprc': 0.9891812034671119, 'loss_val': 0.0443050664776622, 'psi': 0.9903541601691359}-{'f1_val': 0.9909169059752453, 'auprc': 0.9954018594391177, 'loss_val': 0.043592195726772934, 'psi': 0.9927108873607943}
[S17] START round=69 head_norm_before_train=2.239356 cos_to_last_merge=0.8158 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=69 local utility u=0.142040 metrics={'f1_val': 0.8537148511330184, 'auprc': 0.9684481404433862, 'loss_val': 0.6479908315402223, 'psi': 0.8996081668571656}-{'f1_val': 0.827456018663058, 'auprc': 0.9825443784501616, 'loss_val': 0.816805997555795, 'psi': 0.8894913625778994}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S6] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9998
[S2] START round=70 head_norm_before_train=2.210661 cos_to_last_merge=0.7897 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.790
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7188877095579128, 'auprc': 0.7326308468605426, 'loss_val': 1.1963139148726623, 'psi': 0.7243849644789647}-{'f1_val': 0.7168722994724974, 'auprc': 0.7461495494329279, 'loss_val': 1.1288047942194182, 'psi': 0.7285831994566696}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.341304 (no previous merge yet)
[S3] round=70 local utility u=0.000000 metrics={'f1_val': 0.7591754191207873, 'auprc': 0.9980586589196988, 'loss_val': 0.5305610974787599, 'psi': 0.854728715040352}-{'f1_val': 0.7774579904985239, 'auprc': 0.9979674225228354, 'loss_val': 0.47569121082701493, 'psi': 0.8656617633082485}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=70 head_norm_before_train=2.010084 cos_to_last_merge=0.9921 (last merge round=36)
[S4] round=70 local utility u=0.079728 metrics={'f1_val': 0.9518317415082197, 'auprc': 0.9435630937452826, 'loss_val': 0.30358426453571896, 'psi': 0.9485242824030449}-{'f1_val': 0.947390069265705, 'auprc': 0.9027193611659665, 'loss_val': 0.31385985447091536, 'psi': 0.9295217860258096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=70 head_norm_before_train=2.051591 cos_to_last_merge=1.0000 (last merge round=67)
[S5] round=70 local utility u=0.000011 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9908055468742835, 'loss_val': 0.02743207047018209, 'psi': 0.993859318886444}-{'f1_val': 0.995895166894551, 'auprc': 0.9911016051489129, 'loss_val': 0.028341877322119374, 'psi': 0.9939777421962958}
[S6] START round=70 head_norm_before_train=1.913935 cos_to_last_merge=0.9998 (last merge round=67)
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.751718098890514, 'auprc': 0.9606744599198085, 'loss_val': 0.653452015475763, 'psi': 0.8353006433022319}-{'f1_val': 0.8172463118131803, 'auprc': 0.9482421637700644, 'loss_val': 0.5559762893025981, 'psi': 0.8696446525959339}
[S7] START round=70 head_norm_before_train=1.791808 cos_to_last_merge=0.9983 (last merge round=44)
[S7] round=70 local utility u=0.513158 metrics={'f1_val': 0.6907319947003542, 'auprc': 0.8494605742481566, 'loss_val': 0.2890399070823123, 'psi': 0.7542234265194752}-{'f1_val': 0.6143859350257832, 'auprc': 0.7910136386035072, 'loss_val': 0.6819391499454017, 'psi': 0.6850370164568728}
[S8] START round=70 head_norm_before_train=1.833091 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9852502187375028, 'auprc': 0.9962908229121806, 'loss_val': 0.04121744644382128, 'psi': 0.9896664604073739}-{'f1_val': 0.993467150337892, 'auprc': 0.9993177322768009, 'loss_val': 0.02894759059810586, 'psi': 0.9958073831134556}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.149832 cos_to_last_merge=0.9907 (last merge round=29)
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9964354604519897, 'auprc': 0.9998096678738778, 'loss_val': 0.017026625982154233, 'psi': 0.997785143420745}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998655905062387, 'loss_val': 0.01655055344485234, 'psi': 0.998454526656542}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=2.439660 (no previous merge yet)
[S10] round=70 local utility u=0.000246 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966859637785623, 'loss_val': 0.025501673763894974, 'psi': 0.9957870889230498}-{'f1_val': 0.9951878390193748, 'auprc': 0.996542626846515, 'loss_val': 0.025564074396095295, 'psi': 0.9957297541502308}
[S11] START round=70 head_norm_before_train=2.081826 cos_to_last_merge=0.9965 (last merge round=44)
[S11] round=70 local utility u=0.000096 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9983153033487517, 'loss_val': 0.019986368342837006, 'psi': 0.9972543240476545}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982937319144705, 'loss_val': 0.020113306866816887, 'psi': 0.9972456954739419}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=70 head_norm_before_train=1.882033 cos_to_last_merge=0.7758 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.776
[S13] round=70 local utility u=0.193063 metrics={'f1_val': 0.6488253418040479, 'auprc': 0.9501644303487528, 'loss_val': 0.9750383905519284, 'psi': 0.7693609772219299}-{'f1_val': 0.6874668671775761, 'auprc': 0.7610621322699649, 'loss_val': 1.0257069401820635, 'psi': 0.7169049732145316}
[S13] not sending this round → trigger blocked (psi=0.769)
[S14] START round=70 head_norm_before_train=1.835640 cos_to_last_merge=0.9765 (last merge round=43)
[S14] round=70 local utility u=0.000403 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9972828135262373, 'loss_val': 0.029899909145952423, 'psi': 0.9970054731925674}-{'f1_val': 0.9968205796367875, 'auprc': 0.9971957199931291, 'loss_val': 0.030445190598882878, 'psi': 0.9969706357793241}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=70 head_norm_before_train=2.071726 cos_to_last_merge=1.0000 (last merge round=67)
[S15] round=70 local utility u=0.823149 metrics={'f1_val': 0.900877565646653, 'auprc': 0.9962952761616441, 'loss_val': 0.21790267027087198, 'psi': 0.9390446498526495}-{'f1_val': 0.7317624369544298, 'auprc': 0.9116164508878017, 'loss_val': 0.5954727111520389, 'psi': 0.8037040425277786}
[S16] START round=70 head_norm_before_train=1.915544 cos_to_last_merge=1.0000 (last merge round=67)
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9911361313038187, 'auprc': 0.9868422187205281, 'loss_val': 0.05483585402298745, 'psi': 0.9894185662705024}-{'f1_val': 0.9911361313038187, 'auprc': 0.9891812034671119, 'loss_val': 0.0443050664776622, 'psi': 0.9903541601691359}
[S17] START round=70 head_norm_before_train=2.240078 cos_to_last_merge=0.8154 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.8435030959737515, 'auprc': 0.9601859926627945, 'loss_val': 0.6862014346522974, 'psi': 0.8901762546493687}-{'f1_val': 0.8537148511330184, 'auprc': 0.9684481404433862, 'loss_val': 0.6479908315402223, 'psi': 0.8996081668571656}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → trigger blocked (psi=0.994)
[S7] not sending this round → trigger blocked (psi=0.754)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] ⇄ pheromone p=0.021 → S15@127.0.0.1:58315
[S6] ⇄ pheromone p=0.200 → S16@127.0.0.1:58316
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=70 metric=0.9911 head_norm=1.922791
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.173049e-02
[S16] stored merged vector for next round verification (round=70)
[S16] DEBUG after merge:  round=70 metric=0.9911 head_norm=1.918245 delta_norm=0.021730
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.046 → S6@127.0.0.1:58307
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=70 metric=0.9009 head_norm=2.085855
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.302270e-02
[S15] stored merged vector for next round verification (round=70)
[S15] DEBUG after merge:  round=70 metric=0.9009 head_norm=2.068666 delta_norm=0.023023
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.265 → S5@127.0.0.1:58305
[S2] START round=71 head_norm_before_train=2.217284 cos_to_last_merge=0.7891 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.720493212550088, 'auprc': 0.7228165927189104, 'loss_val': 1.2123680015984974, 'psi': 0.721422564617617}-{'f1_val': 0.7188877095579128, 'auprc': 0.7326308468605426, 'loss_val': 1.1963139148726623, 'psi': 0.7243849644789647}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.345741 (no previous merge yet)
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.7147127660067538, 'auprc': 0.9632366343537035, 'loss_val': 0.6979166505114586, 'psi': 0.8141223133455338}-{'f1_val': 0.7591754191207873, 'auprc': 0.9980586589196988, 'loss_val': 0.5305610974787599, 'psi': 0.854728715040352}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=2.015836 cos_to_last_merge=0.9922 (last merge round=36)
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9495730904700063, 'auprc': 0.9288824527789308, 'loss_val': 0.30093428792682153, 'psi': 0.941296835393576}-{'f1_val': 0.9518317415082197, 'auprc': 0.9435630937452826, 'loss_val': 0.30358426453571896, 'psi': 0.9485242824030449}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=2.055664 cos_to_last_merge=0.9999 (last merge round=67)
[S5] round=71 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9903814526776407, 'loss_val': 0.03908254287291011, 'psi': 0.9936896812077869}-{'f1_val': 0.995895166894551, 'auprc': 0.9908055468742835, 'loss_val': 0.02743207047018209, 'psi': 0.993859318886444}
[S6] START round=71 head_norm_before_train=1.922042 cos_to_last_merge=0.9999 (last merge round=67)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.634952984959986, 'auprc': 0.9332658992398093, 'loss_val': 0.7649152180423856, 'psi': 0.7542781506719154}-{'f1_val': 0.751718098890514, 'auprc': 0.9606744599198085, 'loss_val': 0.653452015475763, 'psi': 0.8353006433022319}
[S7] START round=71 head_norm_before_train=1.795078 cos_to_last_merge=0.9983 (last merge round=44)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5778515234217066, 'auprc': 0.7828660607404831, 'loss_val': 0.8048204786201085, 'psi': 0.6598573383492172}-{'f1_val': 0.6907319947003542, 'auprc': 0.8494605742481566, 'loss_val': 0.2890399070823123, 'psi': 0.7542234265194752}
[S8] START round=71 head_norm_before_train=1.844819 cos_to_last_merge=0.9999 (last merge round=68)
[S8] round=71 local utility u=0.034071 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9994782172540555, 'loss_val': 0.028085891647202276, 'psi': 0.9954862842492335}-{'f1_val': 0.9852502187375028, 'auprc': 0.9962908229121806, 'loss_val': 0.04121744644382128, 'psi': 0.9896664604073739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=71 head_norm_before_train=2.154676 cos_to_last_merge=0.9905 (last merge round=29)
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9997675110427852, 'loss_val': 0.01763901908959279, 'psi': 0.9975194256034263}-{'f1_val': 0.9964354604519897, 'auprc': 0.9998096678738778, 'loss_val': 0.017026625982154233, 'psi': 0.997785143420745}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=2.440039 (no previous merge yet)
[S10] round=71 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961697456926206, 'loss_val': 0.025600970981235874, 'psi': 0.995580601688673}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966859637785623, 'loss_val': 0.025501673763894974, 'psi': 0.9957870889230498}
[S11] START round=71 head_norm_before_train=2.088318 cos_to_last_merge=0.9963 (last merge round=44)
[S11] round=71 local utility u=0.000308 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984220136111692, 'loss_val': 0.0196909448866258, 'psi': 0.9972970081526215}-{'f1_val': 0.9965470045135896, 'auprc': 0.9983153033487517, 'loss_val': 0.019986368342837006, 'psi': 0.9972543240476545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=71 head_norm_before_train=1.894990 cos_to_last_merge=0.7740 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.774
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.6810838496355658, 'auprc': 0.7630527692967333, 'loss_val': 0.9744328666340172, 'psi': 0.7138714175000328}-{'f1_val': 0.6488253418040479, 'auprc': 0.9501644303487528, 'loss_val': 0.9750383905519284, 'psi': 0.7693609772219299}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=1.842259 cos_to_last_merge=0.9759 (last merge round=43)
[S14] round=71 local utility u=0.001790 metrics={'f1_val': 0.9963486998078612, 'auprc': 0.9986600460424533, 'loss_val': 0.027620448949206847, 'psi': 0.997273238301698}-{'f1_val': 0.9968205796367875, 'auprc': 0.9972828135262373, 'loss_val': 0.029899909145952423, 'psi': 0.9970054731925674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=71 head_norm_before_train=2.068666 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=71 local utility u=0.335284 metrics={'f1_val': 0.9823692600192115, 'auprc': 0.9969474686224337, 'loss_val': 0.03824121817678479, 'psi': 0.9882005434605003}-{'f1_val': 0.900877565646653, 'auprc': 0.9962952761616441, 'loss_val': 0.21790267027087198, 'psi': 0.9390446498526495}
[S16] START round=71 head_norm_before_train=1.918245 cos_to_last_merge=1.0000 (last merge round=70)
[S16] round=71 local utility u=0.019270 metrics={'f1_val': 0.9916096289815699, 'auprc': 0.9942726757064106, 'loss_val': 0.04142863888243884, 'psi': 0.9926748476715063}-{'f1_val': 0.9911361313038187, 'auprc': 0.9868422187205281, 'loss_val': 0.05483585402298745, 'psi': 0.9894185662705024}
[S17] START round=71 head_norm_before_train=2.246027 cos_to_last_merge=0.8150 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=71 local utility u=0.000000 metrics={'f1_val': 0.8185296231202888, 'auprc': 0.9475670773788422, 'loss_val': 0.8339147462883123, 'psi': 0.8701446048237101}-{'f1_val': 0.8435030959737515, 'auprc': 0.9601859926627945, 'loss_val': 0.6862014346522974, 'psi': 0.8901762546493687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S15] not sending this round → trigger blocked (psi=0.988)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=71 metric=0.9959 head_norm=2.060065
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.337783e-02
[S5] stored merged vector for next round verification (round=71)
[S5] DEBUG after merge:  round=71 metric=0.9959 head_norm=2.072868 delta_norm=0.023378
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9998
[S2] START round=72 head_norm_before_train=2.223956 cos_to_last_merge=0.7885 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=72 local utility u=0.000000 metrics={'f1_val': 0.699489627205179, 'auprc': 0.7048753237871289, 'loss_val': 1.2451487700434682, 'psi': 0.701643905837959}-{'f1_val': 0.720493212550088, 'auprc': 0.7228165927189104, 'loss_val': 1.2123680015984974, 'psi': 0.721422564617617}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=72 head_norm_before_train=2.347885 (no previous merge yet)
[S3] round=72 local utility u=0.473229 metrics={'f1_val': 0.8120948546092376, 'auprc': 0.9864275312520208, 'loss_val': 0.40532346750170317, 'psi': 0.8818279252663508}-{'f1_val': 0.7147127660067538, 'auprc': 0.9632366343537035, 'loss_val': 0.6979166505114586, 'psi': 0.8141223133455338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=72 head_norm_before_train=2.020474 cos_to_last_merge=0.9921 (last merge round=36)
[S4] round=72 local utility u=0.074359 metrics={'f1_val': 0.9519264780319312, 'auprc': 0.9709268389489167, 'loss_val': 0.29247011671959317, 'psi': 0.9595266223987254}-{'f1_val': 0.9495730904700063, 'auprc': 0.9288824527789308, 'loss_val': 0.30093428792682153, 'psi': 0.941296835393576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=72 head_norm_before_train=2.072868 cos_to_last_merge=1.0000 (last merge round=71)
[S5] round=72 local utility u=0.008844 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9916433538394559, 'loss_val': 0.025179773739244196, 'psi': 0.9941944416725129}-{'f1_val': 0.995895166894551, 'auprc': 0.9903814526776407, 'loss_val': 0.03908254287291011, 'psi': 0.9936896812077869}
[S6] START round=72 head_norm_before_train=1.935170 cos_to_last_merge=0.9998 (last merge round=67)
[S6] round=72 local utility u=0.287128 metrics={'f1_val': 0.7003336236884327, 'auprc': 0.9549793661997288, 'loss_val': 0.648083615663956, 'psi': 0.8021919206929511}-{'f1_val': 0.634952984959986, 'auprc': 0.9332658992398093, 'loss_val': 0.7649152180423856, 'psi': 0.7542781506719154}
[S7] START round=72 head_norm_before_train=1.797663 cos_to_last_merge=0.9982 (last merge round=44)
[S7] round=72 local utility u=0.401509 metrics={'f1_val': 0.6524844160396399, 'auprc': 0.8018079974971598, 'loss_val': 0.5064251273994205, 'psi': 0.7122138486226479}-{'f1_val': 0.5778515234217066, 'auprc': 0.7828660607404831, 'loss_val': 0.8048204786201085, 'psi': 0.6598573383492172}
[S8] START round=72 head_norm_before_train=1.862369 cos_to_last_merge=0.9998 (last merge round=68)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9911282975647199, 'auprc': 0.9993375287002464, 'loss_val': 0.03011842341339635, 'psi': 0.9944119900189305}-{'f1_val': 0.9928249955793521, 'auprc': 0.9994782172540555, 'loss_val': 0.028085891647202276, 'psi': 0.9954862842492335}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=2.159800 cos_to_last_merge=0.9903 (last merge round=29)
[S9] round=72 local utility u=0.003422 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995141085612516, 'loss_val': 0.016529065964190393, 'psi': 0.9980673909317863}-{'f1_val': 0.9960207019771873, 'auprc': 0.9997675110427852, 'loss_val': 0.01763901908959279, 'psi': 0.9975194256034263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=72 head_norm_before_train=2.438687 (no previous merge yet)
[S10] round=72 local utility u=0.000605 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965550203063303, 'loss_val': 0.02554677661425897, 'psi': 0.9957347115341569}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961697456926206, 'loss_val': 0.025600970981235874, 'psi': 0.995580601688673}
[S11] START round=72 head_norm_before_train=2.093317 cos_to_last_merge=0.9961 (last merge round=44)
[S11] round=72 local utility u=0.000208 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985093270729787, 'loss_val': 0.019536991073382897, 'psi': 0.9973319335373452}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984220136111692, 'loss_val': 0.0196909448866258, 'psi': 0.9972970081526215}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=72 head_norm_before_train=1.905435 cos_to_last_merge=0.7727 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.773
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6780308270734199, 'auprc': 0.687969449856658, 'loss_val': 1.2692501978356974, 'psi': 0.6820062761867152}-{'f1_val': 0.6810838496355658, 'auprc': 0.7630527692967333, 'loss_val': 0.9744328666340172, 'psi': 0.7138714175000328}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=1.849149 cos_to_last_merge=0.9754 (last merge round=43)
[S14] round=72 local utility u=0.000000 metrics={'f1_val': 0.9941427397175595, 'auprc': 0.9986344629801167, 'loss_val': 0.0333491527859164, 'psi': 0.9959394290225825}-{'f1_val': 0.9963486998078612, 'auprc': 0.9986600460424533, 'loss_val': 0.027620448949206847, 'psi': 0.997273238301698}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=72 head_norm_before_train=2.082508 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.876529221464693, 'auprc': 0.9941404159323473, 'loss_val': 0.34163287379345275, 'psi': 0.9235736992517547}-{'f1_val': 0.9823692600192115, 'auprc': 0.9969474686224337, 'loss_val': 0.03824121817678479, 'psi': 0.9882005434605003}
[S16] START round=72 head_norm_before_train=1.924765 cos_to_last_merge=1.0000 (last merge round=70)
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9657301007847676, 'auprc': 0.9883817875829158, 'loss_val': 0.09641913735073196, 'psi': 0.9747907755040269}-{'f1_val': 0.9916096289815699, 'auprc': 0.9942726757064106, 'loss_val': 0.04142863888243884, 'psi': 0.9926748476715063}
[S17] START round=72 head_norm_before_train=2.252819 cos_to_last_merge=0.8148 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.815
[S17] round=72 local utility u=0.231530 metrics={'f1_val': 0.8681643206131129, 'auprc': 0.9265116815865821, 'loss_val': 0.6054961615673315, 'psi': 0.8915032650025005}-{'f1_val': 0.8185296231202888, 'auprc': 0.9475670773788422, 'loss_val': 0.8339147462883123, 'psi': 0.8701446048237101}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.9996
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=72 metric=0.7003 head_norm=1.951161
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.693164e-02
[S6] stored merged vector for next round verification (round=72)
[S6] DEBUG after merge:  round=72 metric=0.6991 head_norm=1.937821 delta_norm=0.026932
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=2.225406 cos_to_last_merge=0.7880 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.788
[S2] round=73 local utility u=0.091477 metrics={'f1_val': 0.7191039771808443, 'auprc': 0.717091583187913, 'loss_val': 1.21652937629577, 'psi': 0.7182990195836718}-{'f1_val': 0.699489627205179, 'auprc': 0.7048753237871289, 'loss_val': 1.2451487700434682, 'psi': 0.701643905837959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=73 head_norm_before_train=2.352000 (no previous merge yet)
[S3] round=73 local utility u=0.640135 metrics={'f1_val': 0.9661385566549583, 'auprc': 0.99879700720561, 'loss_val': 0.08642489903069453, 'psi': 0.9792019368752191}-{'f1_val': 0.8120948546092376, 'auprc': 0.9864275312520208, 'loss_val': 0.40532346750170317, 'psi': 0.8818279252663508}
[S3] not sending this round → trigger blocked (psi=0.979)
[S4] START round=73 head_norm_before_train=2.026482 cos_to_last_merge=0.9921 (last merge round=36)
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9528596035618795, 'auprc': 0.9629601485678093, 'loss_val': 0.31356244951985773, 'psi': 0.9568998215642515}-{'f1_val': 0.9519264780319312, 'auprc': 0.9709268389489167, 'loss_val': 0.29247011671959317, 'psi': 0.9595266223987254}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=2.075858 cos_to_last_merge=1.0000 (last merge round=71)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9904633364404059, 'loss_val': 0.02965989993131501, 'psi': 0.9937224347128929}-{'f1_val': 0.995895166894551, 'auprc': 0.9916433538394559, 'loss_val': 0.025179773739244196, 'psi': 0.9941944416725129}
[S6] START round=73 head_norm_before_train=1.937821 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=73 local utility u=0.048930 metrics={'f1_val': 0.7296427121041122, 'auprc': 0.9561812650730709, 'loss_val': 0.7296839909747688, 'psi': 0.8202581332916957}-{'f1_val': 0.7003336236884327, 'auprc': 0.9549793661997288, 'loss_val': 0.648083615663956, 'psi': 0.8021919206929511}
[S7] START round=73 head_norm_before_train=1.801668 cos_to_last_merge=0.9981 (last merge round=44)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.6172645500796562, 'auprc': 0.7937685923305693, 'loss_val': 0.6436570846579251, 'psi': 0.6878661669800215}-{'f1_val': 0.6524844160396399, 'auprc': 0.8018079974971598, 'loss_val': 0.5064251273994205, 'psi': 0.7122138486226479}
[S8] START round=73 head_norm_before_train=1.880417 cos_to_last_merge=0.9996 (last merge round=68)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.8534276533911102, 'auprc': 0.9993482402198263, 'loss_val': 0.30393383579686173, 'psi': 0.9117958881225965}-{'f1_val': 0.9911282975647199, 'auprc': 0.9993375287002464, 'loss_val': 0.03011842341339635, 'psi': 0.9944119900189305}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.165779 cos_to_last_merge=0.9901 (last merge round=29)
[S9] round=73 local utility u=0.000405 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9995188748190336, 'loss_val': 0.01573384495730313, 'psi': 0.9980692974348991}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995141085612516, 'loss_val': 0.016529065964190393, 'psi': 0.9980673909317863}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=73 head_norm_before_train=2.444725 (no previous merge yet)
[S10] round=73 local utility u=0.000191 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966227428634126, 'loss_val': 0.025367250350510698, 'psi': 0.9957618005569899}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965550203063303, 'loss_val': 0.02554677661425897, 'psi': 0.9957347115341569}
[S11] START round=73 head_norm_before_train=2.096711 cos_to_last_merge=0.9960 (last merge round=44)
[S11] round=73 local utility u=0.000010 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985219717412358, 'loss_val': 0.019554880843736272, 'psi': 0.997336991404648}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985093270729787, 'loss_val': 0.019536991073382897, 'psi': 0.9973319335373452}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=73 head_norm_before_train=1.917272 cos_to_last_merge=0.7713 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.771
[S13] round=73 local utility u=0.208067 metrics={'f1_val': 0.6779447180610702, 'auprc': 0.7558348656949426, 'loss_val': 1.0561954593709937, 'psi': 0.7091007771146192}-{'f1_val': 0.6780308270734199, 'auprc': 0.687969449856658, 'loss_val': 1.2692501978356974, 'psi': 0.6820062761867152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=73 head_norm_before_train=1.854900 cos_to_last_merge=0.9749 (last merge round=43)
[S14] round=73 local utility u=0.010295 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986603181517347, 'loss_val': 0.027506587548215174, 'psi': 0.9974168466037806}-{'f1_val': 0.9941427397175595, 'auprc': 0.9986344629801167, 'loss_val': 0.0333491527859164, 'psi': 0.9959394290225825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=73 head_norm_before_train=2.095586 cos_to_last_merge=1.0000 (last merge round=70)
[S15] round=73 local utility u=0.185074 metrics={'f1_val': 0.9076969618858638, 'auprc': 0.9968902307185731, 'loss_val': 0.166740813730595, 'psi': 0.9433742694189475}-{'f1_val': 0.876529221464693, 'auprc': 0.9941404159323473, 'loss_val': 0.34163287379345275, 'psi': 0.9235736992517547}
[S16] START round=73 head_norm_before_train=1.932402 cos_to_last_merge=1.0000 (last merge round=70)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9441632898953132, 'auprc': 0.9881047002159491, 'loss_val': 0.1576091452855213, 'psi': 0.9617398540235675}-{'f1_val': 0.9657301007847676, 'auprc': 0.9883817875829158, 'loss_val': 0.09641913735073196, 'psi': 0.9747907755040269}
[S17] START round=73 head_norm_before_train=2.256776 cos_to_last_merge=0.8145 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.8392212695813969, 'auprc': 0.9698346565258534, 'loss_val': 0.7384470425498127, 'psi': 0.8914666243591796}-{'f1_val': 0.8681643206131129, 'auprc': 0.9265116815865821, 'loss_val': 0.6054961615673315, 'psi': 0.8915032650025005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.820)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → trigger blocked (psi=0.996)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=73 metric=0.9442 head_norm=1.940457
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.873540e-02
[S16] stored merged vector for next round verification (round=73)
[S16] DEBUG after merge:  round=73 metric=0.9440 head_norm=1.945604 delta_norm=0.028735
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=73 metric=0.9077 head_norm=2.108936
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.203573e-02
[S15] stored merged vector for next round verification (round=73)
[S15] DEBUG after merge:  round=73 metric=0.9077 head_norm=2.092346 delta_norm=0.022036
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=74 head_norm_before_train=2.221861 cos_to_last_merge=0.7870 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=74 local utility u=0.003142 metrics={'f1_val': 0.7202344888171591, 'auprc': 0.7126312991600579, 'loss_val': 1.2036477027371528, 'psi': 0.7171932129543186}-{'f1_val': 0.7191039771808443, 'auprc': 0.717091583187913, 'loss_val': 1.21652937629577, 'psi': 0.7182990195836718}
[S2] not sending this round → trigger blocked (psi=0.717)
[S3] START round=74 head_norm_before_train=2.356408 (no previous merge yet)
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9989242881031855, 'loss_val': 0.1154883932171819, 'psi': 0.9758960389807425}-{'f1_val': 0.9661385566549583, 'auprc': 0.99879700720561, 'loss_val': 0.08642489903069453, 'psi': 0.9792019368752191}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=2.031334 cos_to_last_merge=0.9919 (last merge round=36)
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9530655984594338, 'auprc': 0.9362336386557625, 'loss_val': 0.32945282273684245, 'psi': 0.9463328145379653}-{'f1_val': 0.9528596035618795, 'auprc': 0.9629601485678093, 'loss_val': 0.31356244951985773, 'psi': 0.9568998215642515}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=2.078573 cos_to_last_merge=1.0000 (last merge round=71)
[S5] round=74 local utility u=0.013861 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9969973987609297, 'loss_val': 0.02417178819849764, 'psi': 0.996599246682506}-{'f1_val': 0.995895166894551, 'auprc': 0.9904633364404059, 'loss_val': 0.02965989993131501, 'psi': 0.9937224347128929}
[S6] START round=74 head_norm_before_train=1.951947 cos_to_last_merge=1.0000 (last merge round=72)
[S6] round=74 local utility u=0.092249 metrics={'f1_val': 0.7793823196815951, 'auprc': 0.9434368426827908, 'loss_val': 0.8053909708885825, 'psi': 0.8450041288820733}-{'f1_val': 0.7296427121041122, 'auprc': 0.9561812650730709, 'loss_val': 0.7296839909747688, 'psi': 0.8202581332916957}
[S7] START round=74 head_norm_before_train=1.806973 cos_to_last_merge=0.9979 (last merge round=44)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.5392287218197898, 'auprc': 0.7817629127729554, 'loss_val': 0.8796777811115081, 'psi': 0.636242398201056}-{'f1_val': 0.6172645500796562, 'auprc': 0.7937685923305693, 'loss_val': 0.6436570846579251, 'psi': 0.6878661669800215}
[S8] START round=74 head_norm_before_train=1.896538 cos_to_last_merge=0.9993 (last merge round=68)
[S8] round=74 local utility u=0.560431 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.9994465688372987, 'loss_val': 0.02593436795213821, 'psi': 0.9960918969033061}-{'f1_val': 0.8534276533911102, 'auprc': 0.9993482402198263, 'loss_val': 0.30393383579686173, 'psi': 0.9117958881225965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=74 head_norm_before_train=2.171478 cos_to_last_merge=0.9899 (last merge round=29)
[S9] round=74 local utility u=0.000014 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9995275491716888, 'loss_val': 0.015714533055961058, 'psi': 0.9980710493922136}-{'f1_val': 0.9971029125121428, 'auprc': 0.9995188748190336, 'loss_val': 0.01573384495730313, 'psi': 0.9980692974348991}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=74 head_norm_before_train=2.453354 (no previous merge yet)
[S10] round=74 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965395050979253, 'loss_val': 0.025629302762348784, 'psi': 0.9957285054507949}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966227428634126, 'loss_val': 0.025367250350510698, 'psi': 0.9957618005569899}
[S11] START round=74 head_norm_before_train=2.101659 cos_to_last_merge=0.9958 (last merge round=44)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9823049224050256, 'auprc': 0.9987981568773848, 'loss_val': 0.07217949723089072, 'psi': 0.9889022161939693}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985219717412358, 'loss_val': 0.019554880843736272, 'psi': 0.997336991404648}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=74 head_norm_before_train=1.927820 cos_to_last_merge=0.7703 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.770
[S13] round=74 local utility u=0.173838 metrics={'f1_val': 0.6991065124060284, 'auprc': 0.8380273329960031, 'loss_val': 1.0820673485742973, 'psi': 0.7546748406420183}-{'f1_val': 0.6779447180610702, 'auprc': 0.7558348656949426, 'loss_val': 1.0561954593709937, 'psi': 0.7091007771146192}
[S13] not sending this round → trigger blocked (psi=0.755)
[S14] START round=74 head_norm_before_train=1.861008 cos_to_last_merge=0.9743 (last merge round=43)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9986545895362304, 'loss_val': 0.027109760383410907, 'psi': 0.9973080176684157}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986603181517347, 'loss_val': 0.027506587548215174, 'psi': 0.9974168466037806}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.092346 cos_to_last_merge=1.0000 (last merge round=73)
[S15] round=74 local utility u=0.334058 metrics={'f1_val': 0.9950866547103594, 'auprc': 0.9975071212920924, 'loss_val': 0.02481430121428844, 'psi': 0.9960548413430526}-{'f1_val': 0.9076969618858638, 'auprc': 0.9968902307185731, 'loss_val': 0.166740813730595, 'psi': 0.9433742694189475}
[S16] START round=74 head_norm_before_train=1.945604 cos_to_last_merge=1.0000 (last merge round=73)
[S16] round=74 local utility u=0.016470 metrics={'f1_val': 0.9454388731504579, 'auprc': 0.9887786219424634, 'loss_val': 0.13434371403328657, 'psi': 0.9627747726672602}-{'f1_val': 0.9441632898953132, 'auprc': 0.9881047002159491, 'loss_val': 0.1576091452855213, 'psi': 0.9617398540235675}
[S17] START round=74 head_norm_before_train=2.260377 cos_to_last_merge=0.8139 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.814
[S17] round=74 local utility u=0.218182 metrics={'f1_val': 0.8877878061784115, 'auprc': 0.9696733308277303, 'loss_val': 0.5929982721648723, 'psi': 0.920542016038139}-{'f1_val': 0.8392212695813969, 'auprc': 0.9698346565258534, 'loss_val': 0.7384470425498127, 'psi': 0.8914666243591796}
[S10]  timeout peer S13
[S17]  timeout peer S10
[S7]  timeout peer S8
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.996)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S16] → sending delta(kind=head bytes=1806) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[S16] sending update (kind=head size=1806 to 1 peers)
[S6] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.9999
[S6] RECEIVED delta(kind=head bytes=1806) from S16
[S6] cosine check vs S16: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=74 metric=0.9963 head_norm=2.082778
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.435040e-02
[S5] stored merged vector for next round verification (round=74)
[S5] DEBUG after merge:  round=74 metric=0.9963 head_norm=2.095757 delta_norm=0.024350
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=74 metric=0.7794 head_norm=1.961475
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.639982e-02
[S6] stored merged vector for next round verification (round=74)
[S6] DEBUG after merge:  round=74 metric=0.7794 head_norm=1.957119 delta_norm=0.016400
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=74 metric=0.9454 head_norm=1.952891
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.639982e-02
[S16] stored merged vector for next round verification (round=74)
[S16] DEBUG after merge:  round=74 metric=0.9456 head_norm=1.957119 delta_norm=0.016400
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=75 head_norm_before_train=2.227600 cos_to_last_merge=0.7864 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.6289334919318985, 'auprc': 0.7795676421243761, 'loss_val': 1.4418651604590216, 'psi': 0.6891871520088896}-{'f1_val': 0.7202344888171591, 'auprc': 0.7126312991600579, 'loss_val': 1.2036477027371528, 'psi': 0.7171932129543186}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=75 head_norm_before_train=2.361135 (no previous merge yet)
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9973947624712272, 'loss_val': 0.13658149736118808, 'psi': 0.9752842287279591}-{'f1_val': 0.9605438728991138, 'auprc': 0.9989242881031855, 'loss_val': 0.1154883932171819, 'psi': 0.9758960389807425}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=2.037971 cos_to_last_merge=0.9914 (last merge round=36)
[S4] round=75 local utility u=0.001484 metrics={'f1_val': 0.952804818710807, 'auprc': 0.9370934623489418, 'loss_val': 0.32750001092120257, 'psi': 0.9465202761660609}-{'f1_val': 0.9530655984594338, 'auprc': 0.9362336386557625, 'loss_val': 0.32945282273684245, 'psi': 0.9463328145379653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=75 head_norm_before_train=2.095757 cos_to_last_merge=1.0000 (last merge round=74)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.8977470365856066, 'auprc': 0.9901601492586282, 'loss_val': 0.1549883114121527, 'psi': 0.9347122816548152}-{'f1_val': 0.9963338119635569, 'auprc': 0.9969973987609297, 'loss_val': 0.02417178819849764, 'psi': 0.996599246682506}
[S6] START round=75 head_norm_before_train=1.957119 cos_to_last_merge=1.0000 (last merge round=74)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6195054837987564, 'auprc': 0.9402470367440185, 'loss_val': 1.0616873372723994, 'psi': 0.7478021049768613}-{'f1_val': 0.7793823196815951, 'auprc': 0.9434368426827908, 'loss_val': 0.8053909708885825, 'psi': 0.8450041288820733}
[S7] START round=75 head_norm_before_train=1.812460 cos_to_last_merge=0.9977 (last merge round=44)
[S7] round=75 local utility u=0.476466 metrics={'f1_val': 0.6300201455831699, 'auprc': 0.797498404844964, 'loss_val': 0.5187012327677046, 'psi': 0.6970114492878876}-{'f1_val': 0.5392287218197898, 'auprc': 0.7817629127729554, 'loss_val': 0.8796777811115081, 'psi': 0.636242398201056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=75 head_norm_before_train=1.908208 cos_to_last_merge=0.9992 (last merge round=68)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.983601162042385, 'auprc': 0.9980049361785805, 'loss_val': 0.04890280344488404, 'psi': 0.9893626716968632}-{'f1_val': 0.9938554489473111, 'auprc': 0.9994465688372987, 'loss_val': 0.02593436795213821, 'psi': 0.9960918969033061}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.175726 cos_to_last_merge=0.9897 (last merge round=29)
[S9] round=75 local utility u=0.001819 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9998740388415782, 'loss_val': 0.015597627408892246, 'psi': 0.9984579059906779}-{'f1_val': 0.9971000495392299, 'auprc': 0.9995275491716888, 'loss_val': 0.015714533055961058, 'psi': 0.9980710493922136}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=75 head_norm_before_train=2.456433 (no previous merge yet)
[S10] round=75 local utility u=0.000014 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965480324896715, 'loss_val': 0.025626347141770717, 'psi': 0.9957319164074934}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965395050979253, 'loss_val': 0.025629302762348784, 'psi': 0.9957285054507949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=75 head_norm_before_train=2.105997 cos_to_last_merge=0.9957 (last merge round=44)
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.8945902244161216, 'auprc': 0.9976523255037324, 'loss_val': 0.11976045713788816, 'psi': 0.9358150648511658}-{'f1_val': 0.9823049224050256, 'auprc': 0.9987981568773848, 'loss_val': 0.07217949723089072, 'psi': 0.9889022161939693}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.941177 cos_to_last_merge=0.7689 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.769
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.7161672731229255, 'auprc': 0.7560176675691637, 'loss_val': 1.1741690043784558, 'psi': 0.7321074309014208}-{'f1_val': 0.6991065124060284, 'auprc': 0.8380273329960031, 'loss_val': 1.0820673485742973, 'psi': 0.7546748406420183}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=1.867678 cos_to_last_merge=0.9739 (last merge round=43)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9987449703151896, 'loss_val': 0.028003365108373805, 'psi': 0.9973441699799994}-{'f1_val': 0.9964103030898727, 'auprc': 0.9986545895362304, 'loss_val': 0.027109760383410907, 'psi': 0.9973080176684157}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.105024 cos_to_last_merge=1.0000 (last merge round=73)
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.9099318728459405, 'auprc': 0.9974634834824744, 'loss_val': 0.16502825233254645, 'psi': 0.944944517100554}-{'f1_val': 0.9950866547103594, 'auprc': 0.9975071212920924, 'loss_val': 0.02481430121428844, 'psi': 0.9960548413430526}
[S16] START round=75 head_norm_before_train=1.957119 cos_to_last_merge=1.0000 (last merge round=74)
[S16] round=75 local utility u=0.160275 metrics={'f1_val': 0.986842741079518, 'auprc': 0.9906992346986823, 'loss_val': 0.06797948537991477, 'psi': 0.9883853385271837}-{'f1_val': 0.9454388731504579, 'auprc': 0.9887786219424634, 'loss_val': 0.13434371403328657, 'psi': 0.9627747726672602}
[S17] START round=75 head_norm_before_train=2.263981 cos_to_last_merge=0.8131 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.8184801436887419, 'auprc': 0.9716011244820482, 'loss_val': 0.8742088244527535, 'psi': 0.8797285360060645}-{'f1_val': 0.8877878061784115, 'auprc': 0.9696733308277303, 'loss_val': 0.5929982721648723, 'psi': 0.920542016038139}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.988)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.116 → S16@127.0.0.1:58316
[S16] ⇄ pheromone p=0.051 → S6@127.0.0.1:58307
[S5] ⇄ pheromone p=0.010 → S15@127.0.0.1:58315
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=75 metric=0.9099 head_norm=2.117436
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.569344e-02
[S15] stored merged vector for next round verification (round=75)
[S15] DEBUG after merge:  round=75 metric=0.9099 head_norm=2.100021 delta_norm=0.025693
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.191 → S5@127.0.0.1:58305
[S2] START round=76 head_norm_before_train=2.233567 cos_to_last_merge=0.7859 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=76 local utility u=0.363886 metrics={'f1_val': 0.7192691606659065, 'auprc': 0.7623220837934565, 'loss_val': 1.20437037213407, 'psi': 0.7364903299169265}-{'f1_val': 0.6289334919318985, 'auprc': 0.7795676421243761, 'loss_val': 1.4418651604590216, 'psi': 0.6891871520088896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=76 head_norm_before_train=2.366069 (no previous merge yet)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.7115111860776514, 'auprc': 0.9570272627630622, 'loss_val': 0.7529567285101845, 'psi': 0.8097176167518156}-{'f1_val': 0.9605438728991138, 'auprc': 0.9973947624712272, 'loss_val': 0.13658149736118808, 'psi': 0.9752842287279591}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=2.046668 cos_to_last_merge=0.9915 (last merge round=36)
[S4] round=76 local utility u=0.015103 metrics={'f1_val': 0.9518828020845242, 'auprc': 0.945241942096649, 'loss_val': 0.3162081534271805, 'psi': 0.9492264580893741}-{'f1_val': 0.952804818710807, 'auprc': 0.9370934623489418, 'loss_val': 0.32750001092120257, 'psi': 0.9465202761660609}
[S4] not sending this round → trigger blocked (psi=0.949)
[S5] START round=76 head_norm_before_train=2.099496 cos_to_last_merge=1.0000 (last merge round=74)
[S5] round=76 local utility u=0.375277 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9985924456484636, 'loss_val': 0.02345983591242507, 'psi': 0.99745815934646}-{'f1_val': 0.8977470365856066, 'auprc': 0.9901601492586282, 'loss_val': 0.1549883114121527, 'psi': 0.9347122816548152}
[S6] START round=76 head_norm_before_train=1.963102 cos_to_last_merge=1.0000 (last merge round=74)
[S6] round=76 local utility u=1.000000 metrics={'f1_val': 0.9608060274910092, 'auprc': 0.9858256893384246, 'loss_val': 0.11023342370683097, 'psi': 0.9708138922299754}-{'f1_val': 0.6195054837987564, 'auprc': 0.9402470367440185, 'loss_val': 1.0616873372723994, 'psi': 0.7478021049768613}
[S7] START round=76 head_norm_before_train=1.817260 cos_to_last_merge=0.9976 (last merge round=44)
[S7] round=76 local utility u=0.617366 metrics={'f1_val': 0.7234691613917774, 'auprc': 0.9209048168736623, 'loss_val': 0.2148826852572526, 'psi': 0.8024434235845314}-{'f1_val': 0.6300201455831699, 'auprc': 0.797498404844964, 'loss_val': 0.5187012327677046, 'psi': 0.6970114492878876}
[S7] not sending this round → trigger blocked (psi=0.802)
[S8] START round=76 head_norm_before_train=1.919827 cos_to_last_merge=0.9991 (last merge round=68)
[S8] round=76 local utility u=0.007064 metrics={'f1_val': 0.9843890238155768, 'auprc': 0.9997440882678736, 'loss_val': 0.04472010886074505, 'psi': 0.9905310495964955}-{'f1_val': 0.983601162042385, 'auprc': 0.9980049361785805, 'loss_val': 0.04890280344488404, 'psi': 0.9893626716968632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=76 head_norm_before_train=2.178453 cos_to_last_merge=0.9895 (last merge round=29)
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9916655936035601, 'auprc': 0.999877319246873, 'loss_val': 0.02870110296973816, 'psi': 0.9949502838608852}-{'f1_val': 0.9975138174234109, 'auprc': 0.9998740388415782, 'loss_val': 0.015597627408892246, 'psi': 0.9984579059906779}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=2.462010 (no previous merge yet)
[S10] round=76 local utility u=0.000038 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965517156409445, 'loss_val': 0.025560756025792608, 'psi': 0.9957333896680026}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965480324896715, 'loss_val': 0.025626347141770717, 'psi': 0.9957319164074934}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=76 head_norm_before_train=2.108846 cos_to_last_merge=0.9955 (last merge round=44)
[S11] round=76 local utility u=0.355504 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984547051732999, 'loss_val': 0.020419776256085476, 'psi': 0.9970620870173056}-{'f1_val': 0.8945902244161216, 'auprc': 0.9976523255037324, 'loss_val': 0.11976045713788816, 'psi': 0.9358150648511658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=76 head_norm_before_train=1.952701 cos_to_last_merge=0.7675 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.768
[S13] round=76 local utility u=0.284398 metrics={'f1_val': 0.6710682593146006, 'auprc': 0.960782772914958, 'loss_val': 0.9490749514454063, 'psi': 0.7869540647547435}-{'f1_val': 0.7161672731229255, 'auprc': 0.7560176675691637, 'loss_val': 1.1741690043784558, 'psi': 0.7321074309014208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=76 head_norm_before_train=1.873212 cos_to_last_merge=0.9736 (last merge round=43)
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9960005090247654, 'auprc': 0.9986606957425962, 'loss_val': 0.02630078522186112, 'psi': 0.9970645837118977}-{'f1_val': 0.9964103030898727, 'auprc': 0.9987449703151896, 'loss_val': 0.028003365108373805, 'psi': 0.9973441699799994}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=2.100021 cos_to_last_merge=1.0000 (last merge round=75)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.900877565646653, 'auprc': 0.9964332522505249, 'loss_val': 0.2591240339936862, 'psi': 0.9390998402882018}-{'f1_val': 0.9099318728459405, 'auprc': 0.9974634834824744, 'loss_val': 0.16502825233254645, 'psi': 0.944944517100554}
[S16] START round=76 head_norm_before_train=1.964234 cos_to_last_merge=1.0000 (last merge round=74)
[S16] round=76 local utility u=0.028929 metrics={'f1_val': 0.9913900784998508, 'auprc': 0.9932556659790931, 'loss_val': 0.045073857213130834, 'psi': 0.9921363134915477}-{'f1_val': 0.986842741079518, 'auprc': 0.9906992346986823, 'loss_val': 0.06797948537991477, 'psi': 0.9883853385271837}
[S17] START round=76 head_norm_before_train=2.269492 cos_to_last_merge=0.8129 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=76 local utility u=0.284152 metrics={'f1_val': 0.8796889333807136, 'auprc': 0.9407822422673895, 'loss_val': 0.580701422619145, 'psi': 0.904126256935384}-{'f1_val': 0.8184801436887419, 'auprc': 0.9716011244820482, 'loss_val': 0.8742088244527535, 'psi': 0.8797285360060645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S5] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1796) from S5
[S15] cosine check vs S5: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=76 metric=0.9608 head_norm=1.968062
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.541562e-02
[S6] stored merged vector for next round verification (round=76)
[S6] DEBUG after merge:  round=76 metric=0.9604 head_norm=1.968363 delta_norm=0.015416
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=76 metric=0.9914 head_norm=1.968786
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.541561e-02
[S16] stored merged vector for next round verification (round=76)
[S16] DEBUG after merge:  round=76 metric=0.9914 head_norm=1.968363 delta_norm=0.015416
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=2.236088 cos_to_last_merge=0.7850 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7114008882092494, 'auprc': 0.6959759156591245, 'loss_val': 1.2301201589033108, 'psi': 0.7052308991891995}-{'f1_val': 0.7192691606659065, 'auprc': 0.7623220837934565, 'loss_val': 1.20437037213407, 'psi': 0.7364903299169265}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.369229 (no previous merge yet)
[S3] round=77 local utility u=0.123659 metrics={'f1_val': 0.7218602121593661, 'auprc': 0.9892967197830328, 'loss_val': 0.6645404984546558, 'psi': 0.8288348152088327}-{'f1_val': 0.7115111860776514, 'auprc': 0.9570272627630622, 'loss_val': 0.7529567285101845, 'psi': 0.8097176167518156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=77 head_norm_before_train=2.052190 cos_to_last_merge=0.9913 (last merge round=36)
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9493586322031137, 'auprc': 0.9475567799314387, 'loss_val': 0.3146644280444657, 'psi': 0.9486378912944438}-{'f1_val': 0.9518828020845242, 'auprc': 0.945241942096649, 'loss_val': 0.3162081534271805, 'psi': 0.9492264580893741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=2.100813 cos_to_last_merge=1.0000 (last merge round=74)
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9932218557982893, 'loss_val': 0.025209652350925527, 'psi': 0.9950890294974497}-{'f1_val': 0.9967019684784577, 'auprc': 0.9985924456484636, 'loss_val': 0.02345983591242507, 'psi': 0.99745815934646}
[S6] START round=77 head_norm_before_train=1.968363 cos_to_last_merge=1.0000 (last merge round=76)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.5979275988860496, 'auprc': 0.8985171956693891, 'loss_val': 1.1201757480662817, 'psi': 0.7181634375993855}-{'f1_val': 0.9608060274910092, 'auprc': 0.9858256893384246, 'loss_val': 0.11023342370683097, 'psi': 0.9708138922299754}
[S7] START round=77 head_norm_before_train=1.821851 cos_to_last_merge=0.9975 (last merge round=44)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.5660179179927608, 'auprc': 0.7813540553869188, 'loss_val': 0.955914843239422, 'psi': 0.6521523729504239}-{'f1_val': 0.7234691613917774, 'auprc': 0.9209048168736623, 'loss_val': 0.2148826852572526, 'psi': 0.8024434235845314}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.936308 cos_to_last_merge=0.9990 (last merge round=68)
[S8] round=77 local utility u=0.034306 metrics={'f1_val': 0.9929446689102408, 'auprc': 0.9995002152130308, 'loss_val': 0.02671075990177402, 'psi': 0.9955668874313568}-{'f1_val': 0.9843890238155768, 'auprc': 0.9997440882678736, 'loss_val': 0.04472010886074505, 'psi': 0.9905310495964955}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=77 head_norm_before_train=2.181966 cos_to_last_merge=0.9893 (last merge round=29)
[S9] round=77 local utility u=0.022443 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998387818398664, 'loss_val': 0.016323673472512856, 'psi': 0.9981972602432323}-{'f1_val': 0.9916655936035601, 'auprc': 0.999877319246873, 'loss_val': 0.02870110296973816, 'psi': 0.9949502838608852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=77 head_norm_before_train=2.464708 (no previous merge yet)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965531403287562, 'loss_val': 0.025572946132214534, 'psi': 0.9957339595431274}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965517156409445, 'loss_val': 0.025560756025792608, 'psi': 0.9957333896680026}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=2.113752 cos_to_last_merge=0.9954 (last merge round=44)
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9896136096252623, 'auprc': 0.9982483397726839, 'loss_val': 0.04007220754085646, 'psi': 0.993067501684231}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984547051732999, 'loss_val': 0.020419776256085476, 'psi': 0.9970620870173056}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.959565 cos_to_last_merge=0.7669 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.767
[S13] round=77 local utility u=0.000000 metrics={'f1_val': 0.637951700615109, 'auprc': 0.6745437226525156, 'loss_val': 1.3330948901160828, 'psi': 0.6525885094300716}-{'f1_val': 0.6710682593146006, 'auprc': 0.960782772914958, 'loss_val': 0.9490749514454063, 'psi': 0.7869540647547435}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=77 head_norm_before_train=1.880191 cos_to_last_merge=0.9731 (last merge round=43)
[S14] round=77 local utility u=0.002251 metrics={'f1_val': 0.9965690443088828, 'auprc': 0.9986634836378455, 'loss_val': 0.025218026323590284, 'psi': 0.9974068200404679}-{'f1_val': 0.9960005090247654, 'auprc': 0.9986606957425962, 'loss_val': 0.02630078522186112, 'psi': 0.9970645837118977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=77 head_norm_before_train=2.112490 cos_to_last_merge=1.0000 (last merge round=75)
[S15] round=77 local utility u=0.018803 metrics={'f1_val': 0.9020263448005295, 'auprc': 0.9968319168424643, 'loss_val': 0.22960573604654677, 'psi': 0.9399485736173034}-{'f1_val': 0.900877565646653, 'auprc': 0.9964332522505249, 'loss_val': 0.2591240339936862, 'psi': 0.9390998402882018}
[S16] START round=77 head_norm_before_train=1.968363 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9910237478502633, 'auprc': 0.9931162786025481, 'loss_val': 0.048006624866910694, 'psi': 0.9918607601511772}-{'f1_val': 0.9913900784998508, 'auprc': 0.9932556659790931, 'loss_val': 0.045073857213130834, 'psi': 0.9921363134915477}
[S17] START round=77 head_norm_before_train=2.276911 cos_to_last_merge=0.8125 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.813
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8385070185122725, 'auprc': 0.9701431285941445, 'loss_val': 0.7770395113931151, 'psi': 0.8911614625450213}-{'f1_val': 0.8796889333807136, 'auprc': 0.9407822422673895, 'loss_val': 0.580701422619145, 'psi': 0.904126256935384}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=77 metric=0.9020 head_norm=2.124515
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.573716e-02
[S15] stored merged vector for next round verification (round=77)
[S15] DEBUG after merge:  round=77 metric=0.9020 head_norm=2.112638 delta_norm=0.015737
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=2.241083 cos_to_last_merge=0.7847 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=78 local utility u=0.049081 metrics={'f1_val': 0.7190697288584903, 'auprc': 0.7103265671736958, 'loss_val': 1.221023785082326, 'psi': 0.7155724641845724}-{'f1_val': 0.7114008882092494, 'auprc': 0.6959759156591245, 'loss_val': 1.2301201589033108, 'psi': 0.7052308991891995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=78 head_norm_before_train=2.373642 (no previous merge yet)
[S3] round=78 local utility u=0.543037 metrics={'f1_val': 0.8511519596893193, 'auprc': 0.9893237708653184, 'loss_val': 0.3542988021931112, 'psi': 0.906420684159719}-{'f1_val': 0.7218602121593661, 'auprc': 0.9892967197830328, 'loss_val': 0.6645404984546558, 'psi': 0.8288348152088327}
[S3] not sending this round → trigger blocked (psi=0.906)
[S4] START round=78 head_norm_before_train=2.057274 cos_to_last_merge=0.9912 (last merge round=36)
[S4] round=78 local utility u=0.018164 metrics={'f1_val': 0.950265168771433, 'auprc': 0.9595831180883936, 'loss_val': 0.3198542931547039, 'psi': 0.9539923484982171}-{'f1_val': 0.9493586322031137, 'auprc': 0.9475567799314387, 'loss_val': 0.3146644280444657, 'psi': 0.9486378912944438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=78 head_norm_before_train=2.102884 cos_to_last_merge=1.0000 (last merge round=74)
[S5] round=78 local utility u=0.007569 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9978834123919985, 'loss_val': 0.0240567316205158, 'psi': 0.9969536521349335}-{'f1_val': 0.9963338119635569, 'auprc': 0.9932218557982893, 'loss_val': 0.025209652350925527, 'psi': 0.9950890294974497}
[S6] START round=78 head_norm_before_train=1.964463 cos_to_last_merge=0.9997 (last merge round=76)
[S6] round=78 local utility u=1.000000 metrics={'f1_val': 0.881997653667423, 'auprc': 0.9716859562185249, 'loss_val': 0.24501716159113518, 'psi': 0.9178729746878638}-{'f1_val': 0.5979275988860496, 'auprc': 0.8985171956693891, 'loss_val': 1.1201757480662817, 'psi': 0.7181634375993855}
[S7] START round=78 head_norm_before_train=1.825382 cos_to_last_merge=0.9974 (last merge round=44)
[S7] round=78 local utility u=0.800620 metrics={'f1_val': 0.694564635840458, 'auprc': 0.8377063479979254, 'loss_val': 0.29501285242247, 'psi': 0.751821320703445}-{'f1_val': 0.5660179179927608, 'auprc': 0.7813540553869188, 'loss_val': 0.955914843239422, 'psi': 0.6521523729504239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=78 head_norm_before_train=1.950488 cos_to_last_merge=0.9988 (last merge round=68)
[S8] round=78 local utility u=0.001998 metrics={'f1_val': 0.9940317422932848, 'auprc': 0.9987860145897807, 'loss_val': 0.02709393773134144, 'psi': 0.9959334512118831}-{'f1_val': 0.9929446689102408, 'auprc': 0.9995002152130308, 'loss_val': 0.02671075990177402, 'psi': 0.9955668874313568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=78 head_norm_before_train=2.187083 cos_to_last_merge=0.9891 (last merge round=29)
[S9] round=78 local utility u=0.000282 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999402394149202, 'loss_val': 0.01606466994958153, 'psi': 0.9982378432732537}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998387818398664, 'loss_val': 0.016323673472512856, 'psi': 0.9981972602432323}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=78 head_norm_before_train=2.469928 (no previous merge yet)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965506121744889, 'loss_val': 0.02571493903830127, 'psi': 0.9957329482814203}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965531403287562, 'loss_val': 0.025572946132214534, 'psi': 0.9957339595431274}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.119456 cos_to_last_merge=0.9952 (last merge round=44)
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.98441640162991, 'auprc': 0.9980714957985708, 'loss_val': 0.06621902807298037, 'psi': 0.9898784392973743}-{'f1_val': 0.9896136096252623, 'auprc': 0.9982483397726839, 'loss_val': 0.04007220754085646, 'psi': 0.993067501684231}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.964739 cos_to_last_merge=0.7665 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.766
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6512967719238398, 'auprc': 0.6467428540426875, 'loss_val': 1.387553727010537, 'psi': 0.649475204771379}-{'f1_val': 0.637951700615109, 'auprc': 0.6745437226525156, 'loss_val': 1.3330948901160828, 'psi': 0.6525885094300716}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.887464 cos_to_last_merge=0.9726 (last merge round=43)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9959393798964159, 'auprc': 0.998660815388785, 'loss_val': 0.02503883137307209, 'psi': 0.9970279540933635}-{'f1_val': 0.9965690443088828, 'auprc': 0.9986634836378455, 'loss_val': 0.025218026323590284, 'psi': 0.9974068200404679}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.112638 cos_to_last_merge=1.0000 (last merge round=77)
[S15] round=78 local utility u=0.029937 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9973692533990652, 'loss_val': 0.1918456793049607, 'psi': 0.942213611931669}-{'f1_val': 0.9020263448005295, 'auprc': 0.9968319168424643, 'loss_val': 0.22960573604654677, 'psi': 0.9399485736173034}
[S16] START round=78 head_norm_before_train=1.973367 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.985705947027022, 'auprc': 0.9909338319056217, 'loss_val': 0.07027881043217137, 'psi': 0.9877971009784619}-{'f1_val': 0.9910237478502633, 'auprc': 0.9931162786025481, 'loss_val': 0.048006624866910694, 'psi': 0.9918607601511772}
[S17] START round=78 head_norm_before_train=2.280033 cos_to_last_merge=0.8122 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=78 local utility u=0.230022 metrics={'f1_val': 0.8883008782592595, 'auprc': 0.963700062083476, 'loss_val': 0.5964303077402814, 'psi': 0.9184605517889461}-{'f1_val': 0.8385070185122725, 'auprc': 0.9701431285941445, 'loss_val': 0.7770395113931151, 'psi': 0.8911614625450213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[S15] not sending this round → trigger blocked (psi=0.942)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:58316
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1797) from S6
[S16] cosine check vs S6: cos=0.9997
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=78 metric=0.9963 head_norm=2.107123
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.656004e-02
[S5] stored merged vector for next round verification (round=78)
[S5] DEBUG after merge:  round=78 metric=0.9963 head_norm=2.115772 delta_norm=0.016560
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=2.246431 cos_to_last_merge=0.7843 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=79 local utility u=0.151071 metrics={'f1_val': 0.7189741671245434, 'auprc': 0.7621935614457382, 'loss_val': 1.073909002231184, 'psi': 0.7362619248530213}-{'f1_val': 0.7190697288584903, 'auprc': 0.7103265671736958, 'loss_val': 1.221023785082326, 'psi': 0.7155724641845724}
[S2] not sending this round → trigger blocked (psi=0.736)
[S2] r=80 psi=0.736 u=0.1511 p_local=0.0916 f1=0.719 auprc=0.762 bytes=53961
[S3] START round=79 head_norm_before_train=2.378547 (no previous merge yet)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.8431027896635914, 'auprc': 0.9848077177867264, 'loss_val': 0.38867441080824033, 'psi': 0.8997847609128454}-{'f1_val': 0.8511519596893193, 'auprc': 0.9893237708653184, 'loss_val': 0.3542988021931112, 'psi': 0.906420684159719}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.900 u=0.0000 p_local=0.1651 f1=0.843 auprc=0.985 bytes=55775
[S4] START round=79 head_norm_before_train=2.063773 cos_to_last_merge=0.9911 (last merge round=36)
[S4] round=79 local utility u=0.000000 metrics={'f1_val': 0.954540410250035, 'auprc': 0.9511477545919633, 'loss_val': 0.32072777963513366, 'psi': 0.9531833479868063}-{'f1_val': 0.950265168771433, 'auprc': 0.9595831180883936, 'loss_val': 0.3198542931547039, 'psi': 0.9539923484982171}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=80 psi=0.953 u=0.0000 p_local=0.0111 f1=0.955 auprc=0.951 bytes=66658
[S5] START round=79 head_norm_before_train=2.115772 cos_to_last_merge=1.0000 (last merge round=78)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934995461646586, 'loss_val': 0.02489862281505546, 'psi': 0.9952001056439975}-{'f1_val': 0.9963338119635569, 'auprc': 0.9978834123919985, 'loss_val': 0.0240567316205158, 'psi': 0.9969536521349335}
[S6] START round=79 head_norm_before_train=1.969680 cos_to_last_merge=0.9998 (last merge round=76)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.7936035048967284, 'auprc': 0.9433169042760599, 'loss_val': 0.6772996559173986, 'psi': 0.853488864648461}-{'f1_val': 0.881997653667423, 'auprc': 0.9716859562185249, 'loss_val': 0.24501716159113518, 'psi': 0.9178729746878638}
[S7] START round=79 head_norm_before_train=1.827538 cos_to_last_merge=0.9973 (last merge round=44)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.5846091048122322, 'auprc': 0.7815886686097328, 'loss_val': 0.7779861927933542, 'psi': 0.6634009303312325}-{'f1_val': 0.694564635840458, 'auprc': 0.8377063479979254, 'loss_val': 0.29501285242247, 'psi': 0.751821320703445}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.663 u=0.0000 p_local=0.2879 f1=0.585 auprc=0.782 bytes=66570
[S8] START round=79 head_norm_before_train=1.960128 cos_to_last_merge=0.9986 (last merge round=68)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9800243004960164, 'auprc': 0.999561793439681, 'loss_val': 0.059235694922237875, 'psi': 0.9878392976734822}-{'f1_val': 0.9940317422932848, 'auprc': 0.9987860145897807, 'loss_val': 0.02709393773134144, 'psi': 0.9959334512118831}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.988 u=0.0000 p_local=0.0486 f1=0.980 auprc=1.000 bytes=68340
[S9] START round=79 head_norm_before_train=2.189198 cos_to_last_merge=0.9889 (last merge round=29)
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9941832549489744, 'auprc': 0.9999268700591085, 'loss_val': 0.02008518110489165, 'psi': 0.996480700993028}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999402394149202, 'loss_val': 0.01606466994958153, 'psi': 0.9982378432732537}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.996 u=0.0000 p_local=0.0041 f1=0.994 auprc=1.000 bytes=66567
[S10] START round=79 head_norm_before_train=2.473686 (no previous merge yet)
[S10] round=79 local utility u=0.000068 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996558023112132, 'loss_val': 0.02560031393487042, 'psi': 0.9957359126564777}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965506121744889, 'loss_val': 0.02571493903830127, 'psi': 0.9957329482814203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S10] r=80 psi=0.996 u=0.0001 p_local=0.0001 f1=0.995 auprc=0.997 bytes=75380
[S11] START round=79 head_norm_before_train=2.125106 cos_to_last_merge=0.9951 (last merge round=44)
[S11] round=79 local utility u=0.059407 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9980140343118407, 'loss_val': 0.0200153491878057, 'psi': 0.99713381643289}-{'f1_val': 0.98441640162991, 'auprc': 0.9980714957985708, 'loss_val': 0.06621902807298037, 'psi': 0.9898784392973743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=80 psi=0.997 u=0.0594 p_local=0.0523 f1=0.997 auprc=0.998 bytes=63049
[S13] START round=79 head_norm_before_train=1.970304 cos_to_last_merge=0.7656 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.766
[S13] round=79 local utility u=0.275337 metrics={'f1_val': 0.6625328842449723, 'auprc': 0.7210723892608839, 'loss_val': 1.1272852348227407, 'psi': 0.6859486862513369}-{'f1_val': 0.6512967719238398, 'auprc': 0.6467428540426875, 'loss_val': 1.387553727010537, 'psi': 0.649475204771379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S13] r=80 psi=0.686 u=0.2753 p_local=0.1379 f1=0.663 auprc=0.721 bytes=64812
[S14] START round=79 head_norm_before_train=1.894104 cos_to_last_merge=0.9720 (last merge round=43)
[S14] round=79 local utility u=0.002473 metrics={'f1_val': 0.9968080713232721, 'auprc': 0.9986573803096166, 'loss_val': 0.025294312864298393, 'psi': 0.9975477949178099}-{'f1_val': 0.9959393798964159, 'auprc': 0.998660815388785, 'loss_val': 0.02503883137307209, 'psi': 0.9970279540933635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S14] r=80 psi=0.998 u=0.0025 p_local=0.0015 f1=0.997 auprc=0.999 bytes=75557
[S15] START round=79 head_norm_before_train=2.124254 cos_to_last_merge=1.0000 (last merge round=77)
[S15] round=79 local utility u=0.030166 metrics={'f1_val': 0.9104876945584951, 'auprc': 0.9974644174783875, 'loss_val': 0.1620666429938466, 'psi': 0.945278383726452}-{'f1_val': 0.9054431842867382, 'auprc': 0.9973692533990652, 'loss_val': 0.1918456793049607, 'psi': 0.942213611931669}
[S16] START round=79 head_norm_before_train=1.979072 cos_to_last_merge=1.0000 (last merge round=76)
[S16] round=79 local utility u=0.039419 metrics={'f1_val': 0.9909725882520648, 'auprc': 0.9971250076039552, 'loss_val': 0.041613780410568, 'psi': 0.9934335559928209}-{'f1_val': 0.985705947027022, 'auprc': 0.9909338319056217, 'loss_val': 0.07027881043217137, 'psi': 0.9877971009784619}
[S17] START round=79 head_norm_before_train=2.287297 cos_to_last_merge=0.8115 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.8460549379349179, 'auprc': 0.9518554455281152, 'loss_val': 0.7169653371085724, 'psi': 0.8883751409721968}-{'f1_val': 0.8883008782592595, 'auprc': 0.963700062083476, 'loss_val': 0.5964303077402814, 'psi': 0.9184605517889461}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.888 u=0.0000 p_local=0.1039 f1=0.846 auprc=0.952 bytes=68313
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1795 to 1 peers)
[S6] r=80 psi=0.853 u=0.0000 p_local=0.3099 f1=0.794 auprc=0.943 bytes=61205
[S5] r=80 psi=0.995 u=0.0000 p_local=0.0437 f1=0.996 auprc=0.993 bytes=70170
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9997
[S5] RECEIVED delta(kind=head bytes=1795) from S15
[S5] cosine check vs S15: cos=1.0000
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=79 metric=0.9910 head_norm=1.984521
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.594700e-02
[S16] stored merged vector for next round verification (round=79)
[S16] DEBUG after merge:  round=79 metric=0.9910 head_norm=1.976944 delta_norm=0.025947
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S16] r=80 psi=0.993 u=0.0394 p_local=0.0318 f1=0.991 auprc=0.997 bytes=61190
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=79 metric=0.9105 head_norm=2.135638
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.003527e-02
[S15] stored merged vector for next round verification (round=79)
[S15] DEBUG after merge:  round=79 metric=0.9105 head_norm=2.121334 delta_norm=0.020035
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] r=80 psi=0.945 u=0.0302 p_local=0.0917 f1=0.910 auprc=0.997 bytes=64762
[S2] START round=80 head_norm_before_train=2.248861 cos_to_last_merge=0.7841 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=80 local utility u=0.132177 metrics={'f1_val': 0.6841003064325054, 'auprc': 0.8206068636808711, 'loss_val': 0.7755513067638522, 'psi': 0.7387029293318517}-{'f1_val': 0.7189741671245434, 'auprc': 0.7621935614457382, 'loss_val': 1.073909002231184, 'psi': 0.7362619248530213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=80 head_norm_before_train=2.383114 (no previous merge yet)
[S3] round=80 local utility u=0.000000 metrics={'f1_val': 0.8164876437740293, 'auprc': 0.9811391361655764, 'loss_val': 0.46189590705035155, 'psi': 0.8823482407306481}-{'f1_val': 0.8431027896635914, 'auprc': 0.9848077177867264, 'loss_val': 0.38867441080824033, 'psi': 0.8997847609128454}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=80 head_norm_before_train=2.065784 cos_to_last_merge=0.9907 (last merge round=36)
[S4] round=80 local utility u=0.000000 metrics={'f1_val': 0.9506136083339295, 'auprc': 0.9524809442537966, 'loss_val': 0.32188244996488224, 'psi': 0.9513605427018763}-{'f1_val': 0.954540410250035, 'auprc': 0.9511477545919633, 'loss_val': 0.32072777963513366, 'psi': 0.9531833479868063}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=80 head_norm_before_train=2.121212 cos_to_last_merge=1.0000 (last merge round=78)
[S5] round=80 local utility u=0.003119 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9948444308072846, 'loss_val': 0.022694997576636244, 'psi': 0.9957380595010479}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934995461646586, 'loss_val': 0.02489862281505546, 'psi': 0.9952001056439975}
[S6] START round=80 head_norm_before_train=1.975862 cos_to_last_merge=0.9997 (last merge round=76)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.7719930876799068, 'auprc': 0.9132579403772736, 'loss_val': 0.6127331934721341, 'psi': 0.8284990287588535}-{'f1_val': 0.7936035048967284, 'auprc': 0.9433169042760599, 'loss_val': 0.6772996559173986, 'psi': 0.853488864648461}
[S7] START round=80 head_norm_before_train=1.829968 cos_to_last_merge=0.9972 (last merge round=44)
[S7] round=80 local utility u=0.771619 metrics={'f1_val': 0.7111759159358545, 'auprc': 0.8704349662982034, 'loss_val': 0.26068806103901854, 'psi': 0.7748795360807941}-{'f1_val': 0.5846091048122322, 'auprc': 0.7815886686097328, 'loss_val': 0.7779861927933542, 'psi': 0.6634009303312325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=80 head_norm_before_train=1.970100 cos_to_last_merge=0.9984 (last merge round=68)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9666750063223928, 'auprc': 0.9995486992816235, 'loss_val': 0.08541904328834306, 'psi': 0.9798244835060851}-{'f1_val': 0.9800243004960164, 'auprc': 0.999561793439681, 'loss_val': 0.059235694922237875, 'psi': 0.9878392976734822}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.191474 cos_to_last_merge=0.9887 (last merge round=29)
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9908221688527771, 'auprc': 0.9999123261329894, 'loss_val': 0.025826328741999575, 'psi': 0.994458231764862}-{'f1_val': 0.9941832549489744, 'auprc': 0.9999268700591085, 'loss_val': 0.02008518110489165, 'psi': 0.996480700993028}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.478610 (no previous merge yet)
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965446183430625, 'loss_val': 0.025679232193033, 'psi': 0.9957305507488499}-{'f1_val': 0.9951878390193748, 'auprc': 0.996558023112132, 'loss_val': 0.02560031393487042, 'psi': 0.9957359126564777}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=2.127201 cos_to_last_merge=0.9949 (last merge round=44)
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9597967606521784, 'auprc': 0.9979509445162666, 'loss_val': 0.1230355187645814, 'psi': 0.9750584341978137}-{'f1_val': 0.9965470045135896, 'auprc': 0.9980140343118407, 'loss_val': 0.0200153491878057, 'psi': 0.99713381643289}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.982197 cos_to_last_merge=0.7645 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.765
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6433327119691089, 'auprc': 0.6862993115670181, 'loss_val': 1.2773974697173418, 'psi': 0.6605193518082726}-{'f1_val': 0.6625328842449723, 'auprc': 0.7210723892608839, 'loss_val': 1.1272852348227407, 'psi': 0.6859486862513369}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=1.897867 cos_to_last_merge=0.9715 (last merge round=43)
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9961780715067039, 'auprc': 0.9986572959543704, 'loss_val': 0.024891235770648928, 'psi': 0.9971697612857705}-{'f1_val': 0.9968080713232721, 'auprc': 0.9986573803096166, 'loss_val': 0.025294312864298393, 'psi': 0.9975477949178099}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=2.121334 cos_to_last_merge=1.0000 (last merge round=79)
[S15] round=80 local utility u=0.042034 metrics={'f1_val': 0.9201488100002314, 'auprc': 0.997489516823107, 'loss_val': 0.13603966781942822, 'psi': 0.9510850927293817}-{'f1_val': 0.9104876945584951, 'auprc': 0.9974644174783875, 'loss_val': 0.1620666429938466, 'psi': 0.945278383726452}
[S16] START round=80 head_norm_before_train=1.976944 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=80 local utility u=0.000000 metrics={'f1_val': 0.9915550722228358, 'auprc': 0.9924724222677404, 'loss_val': 0.041362375084394755, 'psi': 0.9919220122407977}-{'f1_val': 0.9909725882520648, 'auprc': 0.9971250076039552, 'loss_val': 0.041613780410568, 'psi': 0.9934335559928209}
[S17] START round=80 head_norm_before_train=2.291871 cos_to_last_merge=0.8116 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.812
[S17] round=80 local utility u=0.090759 metrics={'f1_val': 0.8729630221277742, 'auprc': 0.9413136961267329, 'loss_val': 0.6652699763638479, 'psi': 0.9003032917273577}-{'f1_val': 0.8460549379349179, 'auprc': 0.9518554455281152, 'loss_val': 0.7169653371085724, 'psi': 0.8883751409721968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.951)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] ⇄ pheromone p=0.082 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.025 → S6@127.0.0.1:58307
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=80 metric=0.7720 head_norm=1.987245
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.112707e-02
[S6] stored merged vector for next round verification (round=80)
[S6] DEBUG after merge:  round=80 metric=0.7720 head_norm=1.985771 delta_norm=0.021127
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.248 → S16@127.0.0.1:58316
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=1.0000
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=80 metric=0.9963 head_norm=2.127112
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.245525e-02
[S5] stored merged vector for next round verification (round=80)
[S5] DEBUG after merge:  round=80 metric=0.9963 head_norm=2.131343 delta_norm=0.012455
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.036 → S15@127.0.0.1:58315
[S2] START round=81 head_norm_before_train=2.254350 cos_to_last_merge=0.7843 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7204589655015333, 'auprc': 0.7161172344945579, 'loss_val': 1.207372606455661, 'psi': 0.7187222730987431}-{'f1_val': 0.6841003064325054, 'auprc': 0.8206068636808711, 'loss_val': 0.7755513067638522, 'psi': 0.7387029293318517}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.387545 (no previous merge yet)
[S3] round=81 local utility u=0.045896 metrics={'f1_val': 0.8208823913093524, 'auprc': 0.9898772013713151, 'loss_val': 0.422687095049488, 'psi': 0.8884803153341374}-{'f1_val': 0.8164876437740293, 'auprc': 0.9811391361655764, 'loss_val': 0.46189590705035155, 'psi': 0.8823482407306481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=81 head_norm_before_train=2.071695 cos_to_last_merge=0.9905 (last merge round=36)
[S4] round=81 local utility u=0.030224 metrics={'f1_val': 0.9510205109873868, 'auprc': 0.9660110260343449, 'loss_val': 0.30446543481977584, 'psi': 0.9570167170061701}-{'f1_val': 0.9506136083339295, 'auprc': 0.9524809442537966, 'loss_val': 0.32188244996488224, 'psi': 0.9513605427018763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=81 head_norm_before_train=2.131343 cos_to_last_merge=1.0000 (last merge round=80)
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9905258708216825, 'loss_val': 0.026243025233357063, 'psi': 0.994010635506807}-{'f1_val': 0.9963338119635569, 'auprc': 0.9948444308072846, 'loss_val': 0.022694997576636244, 'psi': 0.9957380595010479}
[S6] START round=81 head_norm_before_train=1.985771 cos_to_last_merge=1.0000 (last merge round=80)
[S6] round=81 local utility u=0.026542 metrics={'f1_val': 0.77137864220492, 'auprc': 0.9046797788380123, 'loss_val': 0.5302280553599209, 'psi': 0.8246990968581569}-{'f1_val': 0.7719930876799068, 'auprc': 0.9132579403772736, 'loss_val': 0.6127331934721341, 'psi': 0.8284990287588535}
[S7] START round=81 head_norm_before_train=1.834030 cos_to_last_merge=0.9971 (last merge round=44)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6086987344664763, 'auprc': 0.7867836965118276, 'loss_val': 0.7325053362536252, 'psi': 0.6799327192846167}-{'f1_val': 0.7111759159358545, 'auprc': 0.8704349662982034, 'loss_val': 0.26068806103901854, 'psi': 0.7748795360807941}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.981967 cos_to_last_merge=0.9982 (last merge round=68)
[S8] round=81 local utility u=0.114776 metrics={'f1_val': 0.9945903856431277, 'auprc': 0.9995599283678773, 'loss_val': 0.023393319035394034, 'psi': 0.9965782027330276}-{'f1_val': 0.9666750063223928, 'auprc': 0.9995486992816235, 'loss_val': 0.08541904328834306, 'psi': 0.9798244835060851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=81 head_norm_before_train=2.195799 cos_to_last_merge=0.9885 (last merge round=29)
[S9] round=81 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9998023115898317, 'loss_val': 0.049318147220015936, 'psi': 0.9922268765713942}-{'f1_val': 0.9908221688527771, 'auprc': 0.9999123261329894, 'loss_val': 0.025826328741999575, 'psi': 0.994458231764862}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=81 head_norm_before_train=2.486595 (no previous merge yet)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961361919042071, 'loss_val': 0.02566869576974747, 'psi': 0.9955671801733077}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965446183430625, 'loss_val': 0.025679232193033, 'psi': 0.9957305507488499}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=81 head_norm_before_train=2.129697 cos_to_last_merge=0.9947 (last merge round=44)
[S11] round=81 local utility u=0.162419 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.99821858953208, 'loss_val': 0.01950278962868674, 'psi': 0.9972156385209857}-{'f1_val': 0.9597967606521784, 'auprc': 0.9979509445162666, 'loss_val': 0.1230355187645814, 'psi': 0.9750584341978137}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=81 head_norm_before_train=1.990943 cos_to_last_merge=0.7636 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.764
[S13] round=81 local utility u=0.399630 metrics={'f1_val': 0.6929381536202136, 'auprc': 0.7510348925752511, 'loss_val': 0.9699774311985868, 'psi': 0.7161768492022287}-{'f1_val': 0.6433327119691089, 'auprc': 0.6862993115670181, 'loss_val': 1.2773974697173418, 'psi': 0.6605193518082726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=81 head_norm_before_train=1.902397 cos_to_last_merge=0.9713 (last merge round=43)
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9959352234707468, 'auprc': 0.9986513749740584, 'loss_val': 0.024788460053171504, 'psi': 0.9970216840720714}-{'f1_val': 0.9961780715067039, 'auprc': 0.9986572959543704, 'loss_val': 0.024891235770648928, 'psi': 0.9971697612857705}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=2.132576 cos_to_last_merge=1.0000 (last merge round=79)
[S15] round=81 local utility u=0.039325 metrics={'f1_val': 0.929099844430396, 'auprc': 0.9974967177741829, 'loss_val': 0.11111795376754012, 'psi': 0.9564585937679106}-{'f1_val': 0.9201488100002314, 'auprc': 0.997489516823107, 'loss_val': 0.13603966781942822, 'psi': 0.9510850927293817}
[S16] START round=81 head_norm_before_train=1.981732 cos_to_last_merge=1.0000 (last merge round=79)
[S16] round=81 local utility u=0.007670 metrics={'f1_val': 0.9924663489201326, 'auprc': 0.9947575860911787, 'loss_val': 0.03834629377258485, 'psi': 0.993382843788551}-{'f1_val': 0.9915550722228358, 'auprc': 0.9924724222677404, 'loss_val': 0.041362375084394755, 'psi': 0.9919220122407977}
[S17] START round=81 head_norm_before_train=2.296168 cos_to_last_merge=0.8111 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.840740286567738, 'auprc': 0.9851743252212926, 'loss_val': 0.7837894166280589, 'psi': 0.8985139020291599}-{'f1_val': 0.8729630221277742, 'auprc': 0.9413136961267329, 'loss_val': 0.6652699763638479, 'psi': 0.9003032917273577}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1798) from S6
[S16] cosine check vs S6: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=1.0000
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=81 metric=0.7714 head_norm=1.990533
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.598250e-02
[S6] stored merged vector for next round verification (round=81)
[S6] DEBUG after merge:  round=81 metric=0.7713 head_norm=1.988319 delta_norm=0.015983
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=81 metric=0.9291 head_norm=2.143695
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.379563e-02
[S15] stored merged vector for next round verification (round=81)
[S15] DEBUG after merge:  round=81 metric=0.9291 head_norm=2.135375 delta_norm=0.013796
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=81 metric=0.9925 head_norm=1.986230
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.598249e-02
[S16] stored merged vector for next round verification (round=81)
[S16] DEBUG after merge:  round=81 metric=0.9925 head_norm=1.988319 delta_norm=0.015982
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=2.262889 cos_to_last_merge=0.7842 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.6903402946136693, 'auprc': 0.713534021221427, 'loss_val': 1.2744162887502657, 'psi': 0.6996177852567724}-{'f1_val': 0.7204589655015333, 'auprc': 0.7161172344945579, 'loss_val': 1.207372606455661, 'psi': 0.7187222730987431}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.391843 (no previous merge yet)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.783495902212686, 'auprc': 0.9975876809130587, 'loss_val': 0.5608810539778234, 'psi': 0.869132613692835}-{'f1_val': 0.8208823913093524, 'auprc': 0.9898772013713151, 'loss_val': 0.422687095049488, 'psi': 0.8884803153341374}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=2.079088 cos_to_last_merge=0.9905 (last merge round=36)
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.949133305058059, 'auprc': 0.9498963988634626, 'loss_val': 0.3085598701346846, 'psi': 0.9494385425802204}-{'f1_val': 0.9510205109873868, 'auprc': 0.9660110260343449, 'loss_val': 0.30446543481977584, 'psi': 0.9570167170061701}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=2.136816 cos_to_last_merge=1.0000 (last merge round=80)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9903860536753677, 'loss_val': 0.028332734302145328, 'psi': 0.9939547086482812}-{'f1_val': 0.9963338119635569, 'auprc': 0.9905258708216825, 'loss_val': 0.026243025233357063, 'psi': 0.994010635506807}
[S6] START round=82 head_norm_before_train=1.988319 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=82 local utility u=0.197935 metrics={'f1_val': 0.8206221556297764, 'auprc': 0.9201907152925698, 'loss_val': 0.47635271954561115, 'psi': 0.8604495794948936}-{'f1_val': 0.77137864220492, 'auprc': 0.9046797788380123, 'loss_val': 0.5302280553599209, 'psi': 0.8246990968581569}
[S7] START round=82 head_norm_before_train=1.838712 cos_to_last_merge=0.9969 (last merge round=44)
[S7] round=82 local utility u=0.125532 metrics={'f1_val': 0.6201296540528618, 'auprc': 0.7965869608660286, 'loss_val': 0.5794367480509667, 'psi': 0.6907125767781286}-{'f1_val': 0.6086987344664763, 'auprc': 0.7867836965118276, 'loss_val': 0.7325053362536252, 'psi': 0.6799327192846167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=82 head_norm_before_train=1.994013 cos_to_last_merge=0.9980 (last merge round=68)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.8269211205862981, 'auprc': 0.9992513719886471, 'loss_val': 0.4503971780741351, 'psi': 0.8958532211472376}-{'f1_val': 0.9945903856431277, 'auprc': 0.9995599283678773, 'loss_val': 0.023393319035394034, 'psi': 0.9965782027330276}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.200976 cos_to_last_merge=0.9883 (last merge round=29)
[S9] round=82 local utility u=0.047135 metrics={'f1_val': 0.9972634903368587, 'auprc': 0.9997854373403199, 'loss_val': 0.015518105189103723, 'psi': 0.9982722691382431}-{'f1_val': 0.9871765865591023, 'auprc': 0.9998023115898317, 'loss_val': 0.049318147220015936, 'psi': 0.9922268765713942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=82 head_norm_before_train=2.494899 (no previous merge yet)
[S10] round=82 local utility u=0.000514 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965346743353518, 'loss_val': 0.02583536903978581, 'psi': 0.9957265731457656}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961361919042071, 'loss_val': 0.02566869576974747, 'psi': 0.9955671801733077}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=82 head_norm_before_train=2.133188 cos_to_last_merge=0.9946 (last merge round=44)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985423923488267, 'loss_val': 0.020259279425608564, 'psi': 0.9970971618875163}-{'f1_val': 0.9965470045135896, 'auprc': 0.99821858953208, 'loss_val': 0.01950278962868674, 'psi': 0.9972156385209857}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=2.001926 cos_to_last_merge=0.7626 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.763
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6914864379421237, 'auprc': 0.7074559510627851, 'loss_val': 1.313594021192454, 'psi': 0.6978742431903884}-{'f1_val': 0.6929381536202136, 'auprc': 0.7510348925752511, 'loss_val': 0.9699774311985868, 'psi': 0.7161768492022287}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.906508 cos_to_last_merge=0.9714 (last merge round=43)
[S14] round=82 local utility u=0.001244 metrics={'f1_val': 0.9964103030898727, 'auprc': 0.9986553606529138, 'loss_val': 0.02516199020839611, 'psi': 0.9973083261150891}-{'f1_val': 0.9959352234707468, 'auprc': 0.9986513749740584, 'loss_val': 0.024788460053171504, 'psi': 0.9970216840720714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=82 head_norm_before_train=2.135375 cos_to_last_merge=1.0000 (last merge round=81)
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.9254495356820837, 'auprc': 0.9975108740359995, 'loss_val': 0.12708586113632342, 'psi': 0.9542740710236499}-{'f1_val': 0.929099844430396, 'auprc': 0.9974967177741829, 'loss_val': 0.11111795376754012, 'psi': 0.9564585937679106}
[S16] START round=82 head_norm_before_train=1.988319 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9923476002901916, 'auprc': 0.9896205877538279, 'loss_val': 0.03969600260189717, 'psi': 0.9912567952756461}-{'f1_val': 0.9924663489201326, 'auprc': 0.9947575860911787, 'loss_val': 0.03834629377258485, 'psi': 0.993382843788551}
[S17] START round=82 head_norm_before_train=2.303617 cos_to_last_merge=0.8107 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=82 local utility u=0.098127 metrics={'f1_val': 0.8587656417807483, 'auprc': 0.9864776687726515, 'loss_val': 0.6995977234091078, 'psi': 0.9098504525775095}-{'f1_val': 0.840740286567738, 'auprc': 0.9851743252212926, 'loss_val': 0.7837894166280589, 'psi': 0.8985139020291599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → trigger blocked (psi=0.860)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=82 metric=0.9963 head_norm=2.142772
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.285595e-02
[S5] stored merged vector for next round verification (round=82)
[S5] DEBUG after merge:  round=82 metric=0.9963 head_norm=2.143195 delta_norm=0.012856
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=2.270853 cos_to_last_merge=0.7841 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=83 local utility u=0.393648 metrics={'f1_val': 0.711868940170473, 'auprc': 0.8002015493410826, 'loss_val': 0.876294485387053, 'psi': 0.7472019838387168}-{'f1_val': 0.6903402946136693, 'auprc': 0.713534021221427, 'loss_val': 1.2744162887502657, 'psi': 0.6996177852567724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=83 head_norm_before_train=2.396088 (no previous merge yet)
[S3] round=83 local utility u=0.641918 metrics={'f1_val': 0.9301521107864205, 'auprc': 0.9975844959008602, 'loss_val': 0.15697294095577233, 'psi': 0.9571250648321963}-{'f1_val': 0.783495902212686, 'auprc': 0.9975876809130587, 'loss_val': 0.5608810539778234, 'psi': 0.869132613692835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=83 head_norm_before_train=2.081711 cos_to_last_merge=0.9902 (last merge round=36)
[S4] round=83 local utility u=0.061104 metrics={'f1_val': 0.9543483575813474, 'auprc': 0.9754871902356929, 'loss_val': 0.29441405833441003, 'psi': 0.9628038906430856}-{'f1_val': 0.949133305058059, 'auprc': 0.9498963988634626, 'loss_val': 0.3085598701346846, 'psi': 0.9494385425802204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=83 head_norm_before_train=2.143195 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=83 local utility u=0.001666 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9906432019365592, 'loss_val': 0.025772825857316644, 'psi': 0.9940575679527577}-{'f1_val': 0.9963338119635569, 'auprc': 0.9903860536753677, 'loss_val': 0.028332734302145328, 'psi': 0.9939547086482812}
[S6] START round=83 head_norm_before_train=1.989942 cos_to_last_merge=0.9999 (last merge round=81)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7517853970490385, 'auprc': 0.9528306060346118, 'loss_val': 0.510722363372644, 'psi': 0.8322034806432679}-{'f1_val': 0.8206221556297764, 'auprc': 0.9201907152925698, 'loss_val': 0.47635271954561115, 'psi': 0.8604495794948936}
[S7] START round=83 head_norm_before_train=1.845500 cos_to_last_merge=0.9966 (last merge round=44)
[S7] round=83 local utility u=0.213538 metrics={'f1_val': 0.6635682221764448, 'auprc': 0.8117521643932332, 'loss_val': 0.45848868596364556, 'psi': 0.7228417990631602}-{'f1_val': 0.6201296540528618, 'auprc': 0.7965869608660286, 'loss_val': 0.5794367480509667, 'psi': 0.6907125767781286}
[S7] not sending this round → trigger blocked (psi=0.723)
[S8] START round=83 head_norm_before_train=2.005162 cos_to_last_merge=0.9978 (last merge round=68)
[S8] round=83 local utility u=0.713196 metrics={'f1_val': 0.9938406144078162, 'auprc': 0.9995296281470728, 'loss_val': 0.026356319276927435, 'psi': 0.9961162199035188}-{'f1_val': 0.8269211205862981, 'auprc': 0.9992513719886471, 'loss_val': 0.4503971780741351, 'psi': 0.8958532211472376}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=83 head_norm_before_train=2.205893 cos_to_last_merge=0.9882 (last merge round=29)
[S9] round=83 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9965685601651332, 'loss_val': 0.016808496278333345, 'psi': 0.9966429188249106}-{'f1_val': 0.9972634903368587, 'auprc': 0.9997854373403199, 'loss_val': 0.015518105189103723, 'psi': 0.9982722691382431}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=83 head_norm_before_train=2.495820 (no previous merge yet)
[S10] round=83 local utility u=0.000081 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996560059821201, 'loss_val': 0.025749932199194747, 'psi': 0.9957367273401052}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965346743353518, 'loss_val': 0.02583536903978581, 'psi': 0.9957265731457656}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=83 head_norm_before_train=2.133732 cos_to_last_merge=0.9943 (last merge round=44)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980340528941851, 'loss_val': 0.06486451884777114, 'psi': 0.9969061060041213}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985423923488267, 'loss_val': 0.020259279425608564, 'psi': 0.9970971618875163}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=83 head_norm_before_train=2.013031 cos_to_last_merge=0.7617 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.762
[S13] round=83 local utility u=0.489479 metrics={'f1_val': 0.7363920373641977, 'auprc': 0.8007941335067917, 'loss_val': 0.8840844644632333, 'psi': 0.7621528758212353}-{'f1_val': 0.6914864379421237, 'auprc': 0.7074559510627851, 'loss_val': 1.313594021192454, 'psi': 0.6978742431903884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=83 head_norm_before_train=1.911506 cos_to_last_merge=0.9712 (last merge round=43)
[S14] round=83 local utility u=0.000886 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986577254659607, 'loss_val': 0.02446160874794895, 'psi': 0.997415809529471}-{'f1_val': 0.9964103030898727, 'auprc': 0.9986553606529138, 'loss_val': 0.02516199020839611, 'psi': 0.9973083261150891}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=83 head_norm_before_train=2.146166 cos_to_last_merge=1.0000 (last merge round=81)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.9158324830172453, 'auprc': 0.997520622590428, 'loss_val': 0.15340817415874902, 'psi': 0.9485077388465184}-{'f1_val': 0.9254495356820837, 'auprc': 0.9975108740359995, 'loss_val': 0.12708586113632342, 'psi': 0.9542740710236499}
[S16] START round=83 head_norm_before_train=1.993860 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=83 local utility u=0.005307 metrics={'f1_val': 0.9927132730396965, 'auprc': 0.9917455700510158, 'loss_val': 0.03765009854319565, 'psi': 0.9923261918442242}-{'f1_val': 0.9923476002901916, 'auprc': 0.9896205877538279, 'loss_val': 0.03969600260189717, 'psi': 0.9912567952756461}
[S17] START round=83 head_norm_before_train=2.310935 cos_to_last_merge=0.8104 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=83 local utility u=0.064828 metrics={'f1_val': 0.8827269700470364, 'auprc': 0.9689668714159747, 'loss_val': 0.661177971101611, 'psi': 0.9172229305946118}-{'f1_val': 0.8587656417807483, 'auprc': 0.9864776687726515, 'loss_val': 0.6995977234091078, 'psi': 0.9098504525775095}
[S17] not sending this round → trigger blocked (psi=0.917)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:58307
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[S16] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S16
[S6] cosine check vs S16: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=1.0000
[S2] START round=84 head_norm_before_train=2.271963 cos_to_last_merge=0.7841 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=84 local utility u=0.010399 metrics={'f1_val': 0.7092168286984672, 'auprc': 0.7987379873050986, 'loss_val': 0.8351935476500395, 'psi': 0.7450252921411198}-{'f1_val': 0.711868940170473, 'auprc': 0.8002015493410826, 'loss_val': 0.876294485387053, 'psi': 0.7472019838387168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=84 head_norm_before_train=2.400435 (no previous merge yet)
[S3] round=84 local utility u=0.000000 metrics={'f1_val': 0.8583073073300429, 'auprc': 0.9900200413126907, 'loss_val': 0.3172773355529794, 'psi': 0.9109924009231021}-{'f1_val': 0.9301521107864205, 'auprc': 0.9975844959008602, 'loss_val': 0.15697294095577233, 'psi': 0.9571250648321963}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=84 head_norm_before_train=2.077481 cos_to_last_merge=0.9893 (last merge round=36)
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9535424078813786, 'auprc': 0.9358049181716201, 'loss_val': 0.33260745506545986, 'psi': 0.9464474119974752}-{'f1_val': 0.9543483575813474, 'auprc': 0.9754871902356929, 'loss_val': 0.29441405833441003, 'psi': 0.9628038906430856}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=2.147242 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=84 local utility u=0.002193 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9912178731942065, 'loss_val': 0.023110058529021347, 'psi': 0.9942874364558167}-{'f1_val': 0.9963338119635569, 'auprc': 0.9906432019365592, 'loss_val': 0.025772825857316644, 'psi': 0.9940575679527577}
[S6] START round=84 head_norm_before_train=2.000380 cos_to_last_merge=1.0000 (last merge round=81)
[S6] round=84 local utility u=0.180972 metrics={'f1_val': 0.7991591237170875, 'auprc': 0.9432345054674027, 'loss_val': 0.40423291262361666, 'psi': 0.8567892764172136}-{'f1_val': 0.7517853970490385, 'auprc': 0.9528306060346118, 'loss_val': 0.510722363372644, 'psi': 0.8322034806432679}
[S7] START round=84 head_norm_before_train=1.853859 cos_to_last_merge=0.9963 (last merge round=44)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6177844867177512, 'auprc': 0.796334521870331, 'loss_val': 0.816714982494998, 'psi': 0.6892045007787831}-{'f1_val': 0.6635682221764448, 'auprc': 0.8117521643932332, 'loss_val': 0.45848868596364556, 'psi': 0.7228417990631602}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.012851 cos_to_last_merge=0.9976 (last merge round=68)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9921395546714198, 'auprc': 0.999541774195454, 'loss_val': 0.02934381841381093, 'psi': 0.9951004424810335}-{'f1_val': 0.9938406144078162, 'auprc': 0.9995296281470728, 'loss_val': 0.026356319276927435, 'psi': 0.9961162199035188}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=2.210289 cos_to_last_merge=0.9880 (last merge round=29)
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9948647648240064, 'loss_val': 0.018167005108007166, 'psi': 0.9956959627971691}-{'f1_val': 0.9966924912647621, 'auprc': 0.9965685601651332, 'loss_val': 0.016808496278333345, 'psi': 0.9966429188249106}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.501223 (no previous merge yet)
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965509312552068, 'loss_val': 0.025820128301451032, 'psi': 0.9957330759137075}-{'f1_val': 0.9951878390193748, 'auprc': 0.996560059821201, 'loss_val': 0.025749932199194747, 'psi': 0.9957367273401052}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.137106 cos_to_last_merge=0.9941 (last merge round=44)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9868447237081882, 'auprc': 0.9980426619016786, 'loss_val': 0.07255190752332616, 'psi': 0.9913238989855844}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980340528941851, 'loss_val': 0.06486451884777114, 'psi': 0.9969061060041213}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.020255 cos_to_last_merge=0.7610 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6289506292311122, 'auprc': 0.8823827048698856, 'loss_val': 1.3787480441362696, 'psi': 0.7303234594866216}-{'f1_val': 0.7363920373641977, 'auprc': 0.8007941335067917, 'loss_val': 0.8840844644632333, 'psi': 0.7621528758212353}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.915623 cos_to_last_merge=0.9708 (last merge round=43)
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986301569541793, 'loss_val': 0.025222359351863458, 'psi': 0.9974047821247585}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986577254659607, 'loss_val': 0.02446160874794895, 'psi': 0.997415809529471}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.156925 cos_to_last_merge=1.0000 (last merge round=81)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9104876945584951, 'auprc': 0.9975179442642474, 'loss_val': 0.17024435835554763, 'psi': 0.9452997944407959}-{'f1_val': 0.9158324830172453, 'auprc': 0.997520622590428, 'loss_val': 0.15340817415874902, 'psi': 0.9485077388465184}
[S16] START round=84 head_norm_before_train=2.000010 cos_to_last_merge=1.0000 (last merge round=81)
[S16] round=84 local utility u=0.004194 metrics={'f1_val': 0.9926862628256098, 'auprc': 0.9944536961109872, 'loss_val': 0.037224572404606034, 'psi': 0.9933932361397608}-{'f1_val': 0.9927132730396965, 'auprc': 0.9917455700510158, 'loss_val': 0.03765009854319565, 'psi': 0.9923261918442242}
[S17] START round=84 head_norm_before_train=2.311139 cos_to_last_merge=0.8104 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8795275941897474, 'auprc': 0.9608218885452552, 'loss_val': 0.6700188834922851, 'psi': 0.9120453119319505}-{'f1_val': 0.8827269700470364, 'auprc': 0.9689668714159747, 'loss_val': 0.661177971101611, 'psi': 0.9172229305946118}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[S5] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=84 metric=0.9105 head_norm=2.167491
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.453600e-02
[S15] stored merged vector for next round verification (round=84)
[S15] DEBUG after merge:  round=84 metric=0.9105 head_norm=2.157341 delta_norm=0.014536
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1794) from S16
[S6] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9999
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=84 metric=0.9927 head_norm=2.005374
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.516533e-02
[S16] stored merged vector for next round verification (round=84)
[S16] DEBUG after merge:  round=84 metric=0.9927 head_norm=2.005041 delta_norm=0.015165
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=84 metric=0.7992 head_norm=2.004823
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.427774e-02
[S6] stored merged vector for next round verification (round=84)
[S6] DEBUG after merge:  round=84 metric=0.7992 head_norm=2.003706 delta_norm=0.014278
[S6] aggregate: ACCEPT kept=['S16', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=2.275805 cos_to_last_merge=0.7841 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.7204589655015333, 'auprc': 0.7283365179295669, 'loss_val': 1.193530636520634, 'psi': 0.7236099864727468}-{'f1_val': 0.7092168286984672, 'auprc': 0.7987379873050986, 'loss_val': 0.8351935476500395, 'psi': 0.7450252921411198}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=85 head_norm_before_train=2.404558 (no previous merge yet)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.8511519596893193, 'auprc': 0.9864667463782277, 'loss_val': 0.37114601671583547, 'psi': 0.9052778743648827}-{'f1_val': 0.8583073073300429, 'auprc': 0.9900200413126907, 'loss_val': 0.3172773355529794, 'psi': 0.9109924009231021}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=2.078118 cos_to_last_merge=0.9888 (last merge round=36)
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9535616493736735, 'auprc': 0.9265149976608561, 'loss_val': 0.33083963388922627, 'psi': 0.9427429886885466}-{'f1_val': 0.9535424078813786, 'auprc': 0.9358049181716201, 'loss_val': 0.33260745506545986, 'psi': 0.9464474119974752}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=2.147026 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9910134637124675, 'loss_val': 0.05063114488737012, 'psi': 0.994205672663121}-{'f1_val': 0.9963338119635569, 'auprc': 0.9912178731942065, 'loss_val': 0.023110058529021347, 'psi': 0.9942874364558167}
[S6] START round=85 head_norm_before_train=2.003706 cos_to_last_merge=1.0000 (last merge round=84)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.5995736357459612, 'auprc': 0.9019581800958165, 'loss_val': 0.9363166454511526, 'psi': 0.7205274534859034}-{'f1_val': 0.7991591237170875, 'auprc': 0.9432345054674027, 'loss_val': 0.40423291262361666, 'psi': 0.8567892764172136}
[S7] START round=85 head_norm_before_train=1.860680 cos_to_last_merge=0.9960 (last merge round=44)
[S7] round=85 local utility u=0.119017 metrics={'f1_val': 0.6295593546168949, 'auprc': 0.7985020064624413, 'loss_val': 0.6558335164910614, 'psi': 0.6971364153551135}-{'f1_val': 0.6177844867177512, 'auprc': 0.796334521870331, 'loss_val': 0.816714982494998, 'psi': 0.6892045007787831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=85 head_norm_before_train=2.024019 cos_to_last_merge=0.9974 (last merge round=68)
[S8] round=85 local utility u=0.003022 metrics={'f1_val': 0.9927475182363883, 'auprc': 0.9997398626946415, 'loss_val': 0.02754202610602991, 'psi': 0.9955444560196895}-{'f1_val': 0.9921395546714198, 'auprc': 0.999541774195454, 'loss_val': 0.02934381841381093, 'psi': 0.9951004424810335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S8] sending update (kind=head size=1789 to 1 peers)
[S9] START round=85 head_norm_before_train=2.212568 cos_to_last_merge=0.9878 (last merge round=29)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9856836147752347, 'auprc': 0.9997097018627065, 'loss_val': 0.05641710224391495, 'psi': 0.9912940496102234}-{'f1_val': 0.9962500947792776, 'auprc': 0.9948647648240064, 'loss_val': 0.018167005108007166, 'psi': 0.9956959627971691}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=2.508369 (no previous merge yet)
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966079521659867, 'loss_val': 0.02600739430560991, 'psi': 0.9957558842780195}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965509312552068, 'loss_val': 0.025820128301451032, 'psi': 0.9957330759137075}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.140806 cos_to_last_merge=0.9941 (last merge round=44)
[S11] round=85 local utility u=0.053589 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984033470211675, 'loss_val': 0.02218954057247814, 'psi': 0.9970415437564526}-{'f1_val': 0.9868447237081882, 'auprc': 0.9980426619016786, 'loss_val': 0.07255190752332616, 'psi': 0.9913238989855844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=85 head_norm_before_train=2.020874 cos_to_last_merge=0.7607 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=85 local utility u=0.364706 metrics={'f1_val': 0.7224376205061107, 'auprc': 0.8088165820487636, 'loss_val': 0.9895594756895191, 'psi': 0.7569892051231719}-{'f1_val': 0.6289506292311122, 'auprc': 0.8823827048698856, 'loss_val': 1.3787480441362696, 'psi': 0.7303234594866216}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=85 head_norm_before_train=1.920294 cos_to_last_merge=0.9704 (last merge round=43)
[S14] round=85 local utility u=0.000700 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.998663087128046, 'loss_val': 0.02378553313926646, 'psi': 0.9974043687969943}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986301569541793, 'loss_val': 0.025222359351863458, 'psi': 0.9974047821247585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=85 head_norm_before_train=2.157341 cos_to_last_merge=1.0000 (last merge round=84)
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9088167532657039, 'auprc': 0.9975225587966889, 'loss_val': 0.1838947129890903, 'psi': 0.9442990754780979}-{'f1_val': 0.9104876945584951, 'auprc': 0.9975179442642474, 'loss_val': 0.17024435835554763, 'psi': 0.9452997944407959}
[S16] START round=85 head_norm_before_train=2.005041 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.9922687299933257, 'auprc': 0.9948880023606432, 'loss_val': 0.04225373141856081, 'psi': 0.9933164389402527}-{'f1_val': 0.9926862628256098, 'auprc': 0.9944536961109872, 'loss_val': 0.037224572404606034, 'psi': 0.9933932361397608}
[S17] START round=85 head_norm_before_train=2.307637 cos_to_last_merge=0.8105 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.811
[S17] round=85 local utility u=0.009465 metrics={'f1_val': 0.8822875893145606, 'auprc': 0.9554193582535044, 'loss_val': 0.6514403718318778, 'psi': 0.9115402968901382}-{'f1_val': 0.8795275941897474, 'auprc': 0.9608218885452552, 'loss_val': 0.6700188834922851, 'psi': 0.9120453119319505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] ⇄ pheromone p=0.012 → S15@127.0.0.1:58315
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=85 metric=0.9088 head_norm=2.167319
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.338131e-02
[S15] stored merged vector for next round verification (round=85)
[S15] DEBUG after merge:  round=85 metric=0.9088 head_norm=2.157155 delta_norm=0.013381
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.030 → S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.010 → S6@127.0.0.1:58307
[S6] ⇄ pheromone p=0.133 → S16@127.0.0.1:58316
[S2] START round=86 head_norm_before_train=2.278806 cos_to_last_merge=0.7837 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7191039771808443, 'auprc': 0.7264920166125656, 'loss_val': 1.2256151638032522, 'psi': 0.7220591929535328}-{'f1_val': 0.7204589655015333, 'auprc': 0.7283365179295669, 'loss_val': 1.193530636520634, 'psi': 0.7236099864727468}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.408835 (no previous merge yet)
[S3] round=86 local utility u=0.448397 metrics={'f1_val': 0.9537611605132761, 'auprc': 0.9971213205950946, 'loss_val': 0.12197136547069096, 'psi': 0.9711052245460035}-{'f1_val': 0.8511519596893193, 'auprc': 0.9864667463782277, 'loss_val': 0.37114601671583547, 'psi': 0.9052778743648827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=86 head_norm_before_train=2.084951 cos_to_last_merge=0.9888 (last merge round=36)
[S4] round=86 local utility u=0.027929 metrics={'f1_val': 0.9522143697214958, 'auprc': 0.9458868420700497, 'loss_val': 0.32501283723451274, 'psi': 0.9496833586609174}-{'f1_val': 0.9535616493736735, 'auprc': 0.9265149976608561, 'loss_val': 0.33083963388922627, 'psi': 0.9427429886885466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=86 head_norm_before_train=2.146404 cos_to_last_merge=1.0000 (last merge round=82)
[S5] round=86 local utility u=0.013073 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9913923691524049, 'loss_val': 0.022990355329842938, 'psi': 0.9940940477976925}-{'f1_val': 0.9963338119635569, 'auprc': 0.9910134637124675, 'loss_val': 0.05063114488737012, 'psi': 0.994205672663121}
[S6] START round=86 head_norm_before_train=2.007866 cos_to_last_merge=0.9999 (last merge round=84)
[S6] round=86 local utility u=0.908201 metrics={'f1_val': 0.8259094925354213, 'auprc': 0.947359481732643, 'loss_val': 0.6141328810467198, 'psi': 0.8744894882143099}-{'f1_val': 0.5995736357459612, 'auprc': 0.9019581800958165, 'loss_val': 0.9363166454511526, 'psi': 0.7205274534859034}
[S7] START round=86 head_norm_before_train=1.863944 cos_to_last_merge=0.9959 (last merge round=44)
[S7] round=86 local utility u=0.082226 metrics={'f1_val': 0.633783843220902, 'auprc': 0.7992986118011693, 'loss_val': 0.5191192244568275, 'psi': 0.699989750653009}-{'f1_val': 0.6295593546168949, 'auprc': 0.7985020064624413, 'loss_val': 0.6558335164910614, 'psi': 0.6971364153551135}
[S7] not sending this round → trigger blocked (psi=0.700)
[S8] START round=86 head_norm_before_train=2.037096 cos_to_last_merge=0.9971 (last merge round=68)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.8714561658914953, 'auprc': 0.9961433618115803, 'loss_val': 0.3082940231969491, 'psi': 0.9213310442595293}-{'f1_val': 0.9927475182363883, 'auprc': 0.9997398626946415, 'loss_val': 0.02754202610602991, 'psi': 0.9955444560196895}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=86 head_norm_before_train=2.215696 cos_to_last_merge=0.9876 (last merge round=29)
[S9] round=86 local utility u=0.051064 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9998237220420375, 'loss_val': 0.018155505127903794, 'psi': 0.9976921062550587}-{'f1_val': 0.9856836147752347, 'auprc': 0.9997097018627065, 'loss_val': 0.05641710224391495, 'psi': 0.9912940496102234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=86 head_norm_before_train=2.514506 (no previous merge yet)
[S10] round=86 local utility u=0.000048 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966229892490874, 'loss_val': 0.025957250973835385, 'psi': 0.9957618991112598}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966079521659867, 'loss_val': 0.02600739430560991, 'psi': 0.9957558842780195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] sending update (kind=head size=1791 to 1 peers)
[S11] START round=86 head_norm_before_train=2.145429 cos_to_last_merge=0.9940 (last merge round=44)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.8797889830712038, 'auprc': 0.9976938981290414, 'loss_val': 0.12469545449585907, 'psi': 0.9269509490943388}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984033470211675, 'loss_val': 0.02218954057247814, 'psi': 0.9970415437564526}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=86 head_norm_before_train=2.018859 cos_to_last_merge=0.7611 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.7054538009244671, 'auprc': 0.7700789402226801, 'loss_val': 1.0654872315412596, 'psi': 0.7313038566437523}-{'f1_val': 0.7224376205061107, 'auprc': 0.8088165820487636, 'loss_val': 0.9895594756895191, 'psi': 0.7569892051231719}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=86 head_norm_before_train=1.926077 cos_to_last_merge=0.9699 (last merge round=43)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9964139853618799, 'auprc': 0.9986982395298223, 'loss_val': 0.023700187165785633, 'psi': 0.9973276870290568}-{'f1_val': 0.9965652232429598, 'auprc': 0.998663087128046, 'loss_val': 0.02378553313926646, 'psi': 0.9974043687969943}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.157155 cos_to_last_merge=1.0000 (last merge round=85)
[S15] round=86 local utility u=0.002152 metrics={'f1_val': 0.9093748942537687, 'auprc': 0.9975215062912275, 'loss_val': 0.18293620458357787, 'psi': 0.9446335390687521}-{'f1_val': 0.9088167532657039, 'auprc': 0.9975225587966889, 'loss_val': 0.1838947129890903, 'psi': 0.9442990754780979}
[S16] START round=86 head_norm_before_train=2.009510 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9933740356384436, 'auprc': 0.9894281636071065, 'loss_val': 0.039467791682860284, 'psi': 0.9917956868259088}-{'f1_val': 0.9922687299933257, 'auprc': 0.9948880023606432, 'loss_val': 0.04225373141856081, 'psi': 0.9933164389402527}
[S17] START round=86 head_norm_before_train=2.311662 cos_to_last_merge=0.8103 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8471778544566871, 'auprc': 0.9607381198608551, 'loss_val': 0.7323376391085487, 'psi': 0.8926019606183544}-{'f1_val': 0.8822875893145606, 'auprc': 0.9554193582535044, 'loss_val': 0.6514403718318778, 'psi': 0.9115402968901382}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:58305
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S6
[S16] cosine check vs S6: cos=0.9998
[S5] RECEIVED delta(kind=head bytes=1802) from S15
[S5] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1802) from S5
[S15] cosine check vs S5: cos=1.0000
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=86 metric=0.9094 head_norm=2.167138
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.433131e-02
[S15] stored merged vector for next round verification (round=86)
[S15] DEBUG after merge:  round=86 metric=0.9094 head_norm=2.157222 delta_norm=0.014331
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=86 metric=0.9959 head_norm=2.147355
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.433132e-02
[S5] stored merged vector for next round verification (round=86)
[S5] DEBUG after merge:  round=86 metric=0.9959 head_norm=2.157222 delta_norm=0.014331
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.281409 cos_to_last_merge=0.7831 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=87 local utility u=0.004842 metrics={'f1_val': 0.7192747485734483, 'auprc': 0.726531055757148, 'loss_val': 1.2170720476717518, 'psi': 0.7221772714469281}-{'f1_val': 0.7191039771808443, 'auprc': 0.7264920166125656, 'loss_val': 1.2256151638032522, 'psi': 0.7220591929535328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=87 head_norm_before_train=2.413280 (no previous merge yet)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.9524204410966135, 'auprc': 0.9967073703911338, 'loss_val': 0.12387383731797574, 'psi': 0.9701352128144216}-{'f1_val': 0.9537611605132761, 'auprc': 0.9971213205950946, 'loss_val': 0.12197136547069096, 'psi': 0.9711052245460035}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=2.092044 cos_to_last_merge=0.9885 (last merge round=36)
[S4] round=87 local utility u=0.004021 metrics={'f1_val': 0.9522143697214958, 'auprc': 0.9492317532803997, 'loss_val': 0.32700492742555576, 'psi': 0.9510213231450573}-{'f1_val': 0.9522143697214958, 'auprc': 0.9458868420700497, 'loss_val': 0.32501283723451274, 'psi': 0.9496833586609174}
[S4] not sending this round → trigger blocked (psi=0.951)
[S5] START round=87 head_norm_before_train=2.157222 cos_to_last_merge=1.0000 (last merge round=86)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9910371393796902, 'loss_val': 0.02683794976833789, 'psi': 0.9942151429300101}-{'f1_val': 0.995895166894551, 'auprc': 0.9913923691524049, 'loss_val': 0.022990355329842938, 'psi': 0.9940940477976925}
[S6] START round=87 head_norm_before_train=2.017135 cos_to_last_merge=0.9998 (last merge round=84)
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.5977087786725374, 'auprc': 0.721196585097329, 'loss_val': 1.497474768385987, 'psi': 0.647103901242454}-{'f1_val': 0.8259094925354213, 'auprc': 0.947359481732643, 'loss_val': 0.6141328810467198, 'psi': 0.8744894882143099}
[S7] START round=87 head_norm_before_train=1.865387 cos_to_last_merge=0.9958 (last merge round=44)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.6175170156264722, 'auprc': 0.7924531675318798, 'loss_val': 0.6869700475007431, 'psi': 0.6874914763886353}-{'f1_val': 0.633783843220902, 'auprc': 0.7992986118011693, 'loss_val': 0.5191192244568275, 'psi': 0.699989750653009}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.040308 cos_to_last_merge=0.9970 (last merge round=68)
[S8] round=87 local utility u=0.512072 metrics={'f1_val': 0.9929361822751569, 'auprc': 0.9996066105550199, 'loss_val': 0.023420433670941557, 'psi': 0.9956043535871021}-{'f1_val': 0.8714561658914953, 'auprc': 0.9961433618115803, 'loss_val': 0.3082940231969491, 'psi': 0.9213310442595293}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=87 head_norm_before_train=2.218844 cos_to_last_merge=0.9874 (last merge round=29)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9966369297438783, 'loss_val': 0.016314702957291337, 'psi': 0.996916519404837}-{'f1_val': 0.9962710290637395, 'auprc': 0.9998237220420375, 'loss_val': 0.018155505127903794, 'psi': 0.9976921062550587}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.514959 (no previous merge yet)
[S10] round=87 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996596702293534, 'loss_val': 0.0259451381193863, 'psi': 0.9957513843290384}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966229892490874, 'loss_val': 0.025957250973835385, 'psi': 0.9957618991112598}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=87 head_norm_before_train=2.149337 cos_to_last_merge=0.9939 (last merge round=44)
[S11] round=87 local utility u=0.353470 metrics={'f1_val': 0.9866082674881352, 'auprc': 0.9982563899106213, 'loss_val': 0.06035840394367536, 'psi': 0.9912675164571296}-{'f1_val': 0.8797889830712038, 'auprc': 0.9976938981290414, 'loss_val': 0.12469545449585907, 'psi': 0.9269509490943388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=87 head_norm_before_train=2.026008 cos_to_last_merge=0.7609 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.6837853689816114, 'auprc': 0.7261775733966284, 'loss_val': 1.0892968744907883, 'psi': 0.7007422507476182}-{'f1_val': 0.7054538009244671, 'auprc': 0.7700789402226801, 'loss_val': 1.0654872315412596, 'psi': 0.7313038566437523}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=1.932385 cos_to_last_merge=0.9695 (last merge round=43)
[S14] round=87 local utility u=0.000000 metrics={'f1_val': 0.9967978715641003, 'auprc': 0.9975100116535291, 'loss_val': 0.07915659919205122, 'psi': 0.9970827275998717}-{'f1_val': 0.9964139853618799, 'auprc': 0.9986982395298223, 'loss_val': 0.023700187165785633, 'psi': 0.9973276870290568}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=87 head_norm_before_train=2.157222 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=87 local utility u=0.000814 metrics={'f1_val': 0.9093748942537687, 'auprc': 0.9975183661001279, 'loss_val': 0.18129879239342409, 'psi': 0.9446322829923124}-{'f1_val': 0.9093748942537687, 'auprc': 0.9975215062912275, 'loss_val': 0.18293620458357787, 'psi': 0.9446335390687521}
[S16] START round=87 head_norm_before_train=2.013830 cos_to_last_merge=1.0000 (last merge round=84)
[S16] round=87 local utility u=0.004125 metrics={'f1_val': 0.9926862628256098, 'auprc': 0.9930745620634817, 'loss_val': 0.03803034452653614, 'psi': 0.9928415825207586}-{'f1_val': 0.9933740356384436, 'auprc': 0.9894281636071065, 'loss_val': 0.039467791682860284, 'psi': 0.9917956868259088}
[S17] START round=87 head_norm_before_train=2.316703 cos_to_last_merge=0.8104 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=87 local utility u=0.147548 metrics={'f1_val': 0.8841770453839419, 'auprc': 0.9610999843289727, 'loss_val': 0.6603220777803007, 'psi': 0.9149462209619542}-{'f1_val': 0.8471778544566871, 'auprc': 0.9607381198608551, 'loss_val': 0.7323376391085487, 'psi': 0.8926019606183544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:58307
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.945)
[S16] sending update (kind=head size=1801 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1801) from S16
[S6] cosine check vs S16: cos=0.9998
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=87 metric=0.9927 head_norm=2.019709
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.009495e-02
[S16] stored merged vector for next round verification (round=87)
[S16] DEBUG after merge:  round=87 metric=0.9927 head_norm=2.018322 delta_norm=0.020095
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.283257 cos_to_last_merge=0.7822 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=88 local utility u=0.128411 metrics={'f1_val': 0.7191634987280932, 'auprc': 0.7691882423561263, 'loss_val': 1.0875546913189935, 'psi': 0.7391733961793064}-{'f1_val': 0.7192747485734483, 'auprc': 0.726531055757148, 'loss_val': 1.2170720476717518, 'psi': 0.7221772714469281}
[S2] not sending this round → trigger blocked (psi=0.739)
[S3] START round=88 head_norm_before_train=2.417761 (no previous merge yet)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.9481177685953066, 'auprc': 0.996072574055968, 'loss_val': 0.1321644482192304, 'psi': 0.9672996907795712}-{'f1_val': 0.9524204410966135, 'auprc': 0.9967073703911338, 'loss_val': 0.12387383731797574, 'psi': 0.9701352128144216}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=2.096043 cos_to_last_merge=0.9881 (last merge round=36)
[S4] round=88 local utility u=0.003517 metrics={'f1_val': 0.9534654388671397, 'auprc': 0.9486437447092895, 'loss_val': 0.3257131669197882, 'psi': 0.9515367612039995}-{'f1_val': 0.9522143697214958, 'auprc': 0.9492317532803997, 'loss_val': 0.32700492742555576, 'psi': 0.9510213231450573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=88 head_norm_before_train=2.159425 cos_to_last_merge=1.0000 (last merge round=86)
[S5] round=88 local utility u=0.000955 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9912102016273937, 'loss_val': 0.02281570618519365, 'psi': 0.9940211807876881}-{'f1_val': 0.9963338119635569, 'auprc': 0.9910371393796902, 'loss_val': 0.02683794976833789, 'psi': 0.9942151429300101}
[S6] START round=88 head_norm_before_train=2.023757 cos_to_last_merge=0.9999 (last merge round=84)
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.8528406396862427, 'auprc': 0.9143508119905519, 'loss_val': 0.31717138850788645, 'psi': 0.8774447086079663}-{'f1_val': 0.5977087786725374, 'auprc': 0.721196585097329, 'loss_val': 1.497474768385987, 'psi': 0.647103901242454}
[S7] START round=88 head_norm_before_train=1.866224 cos_to_last_merge=0.9958 (last merge round=44)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5666219978919281, 'auprc': 0.7820913525058993, 'loss_val': 0.9478202689274021, 'psi': 0.6528097397375165}-{'f1_val': 0.6175170156264722, 'auprc': 0.7924531675318798, 'loss_val': 0.6869700475007431, 'psi': 0.6874914763886353}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.049101 cos_to_last_merge=0.9969 (last merge round=68)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9907147162646456, 'auprc': 0.9998069626156072, 'loss_val': 0.03010078148154421, 'psi': 0.9943516148050302}-{'f1_val': 0.9929361822751569, 'auprc': 0.9996066105550199, 'loss_val': 0.023420433670941557, 'psi': 0.9956043535871021}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.221399 cos_to_last_merge=0.9873 (last merge round=29)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939084002655105, 'loss_val': 0.01720903238900725, 'psi': 0.9955788548650615}-{'f1_val': 0.9971029125121428, 'auprc': 0.9966369297438783, 'loss_val': 0.016314702957291337, 'psi': 0.996916519404837}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.517372 (no previous merge yet)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961759012873452, 'loss_val': 0.026085948486978594, 'psi': 0.9955830639265629}-{'f1_val': 0.9951878390193748, 'auprc': 0.996596702293534, 'loss_val': 0.0259451381193863, 'psi': 0.9957513843290384}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=2.153856 cos_to_last_merge=0.9937 (last merge round=44)
[S11] round=88 local utility u=0.049565 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9985785538012977, 'loss_val': 0.01934769253616149, 'psi': 0.9971116264685047}-{'f1_val': 0.9866082674881352, 'auprc': 0.9982563899106213, 'loss_val': 0.06035840394367536, 'psi': 0.9912675164571296}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=88 head_norm_before_train=2.032840 cos_to_last_merge=0.7611 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=88 local utility u=0.000000 metrics={'f1_val': 0.6305660524363543, 'auprc': 0.6482844634460956, 'loss_val': 1.4233190868809744, 'psi': 0.6376534168402508}-{'f1_val': 0.6837853689816114, 'auprc': 0.7261775733966284, 'loss_val': 1.0892968744907883, 'psi': 0.7007422507476182}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=88 head_norm_before_train=1.937331 cos_to_last_merge=0.9690 (last merge round=43)
[S14] round=88 local utility u=0.026835 metrics={'f1_val': 0.9961471738646706, 'auprc': 0.9986777365691841, 'loss_val': 0.025086052040919297, 'psi': 0.997159398946476}-{'f1_val': 0.9967978715641003, 'auprc': 0.9975100116535291, 'loss_val': 0.07915659919205122, 'psi': 0.9970827275998717}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=88 head_norm_before_train=2.167363 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9076969618858638, 'auprc': 0.9975186751990401, 'loss_val': 0.18927745108334612, 'psi': 0.9436256472111344}-{'f1_val': 0.9093748942537687, 'auprc': 0.9975183661001279, 'loss_val': 0.18129879239342409, 'psi': 0.9446322829923124}
[S16] START round=88 head_norm_before_train=2.018322 cos_to_last_merge=1.0000 (last merge round=87)
[S16] round=88 local utility u=0.001166 metrics={'f1_val': 0.9924663489201326, 'auprc': 0.9941578471266427, 'loss_val': 0.0376278094892679, 'psi': 0.9931429482027366}-{'f1_val': 0.9926862628256098, 'auprc': 0.9930745620634817, 'loss_val': 0.03803034452653614, 'psi': 0.9928415825207586}
[S17] START round=88 head_norm_before_train=2.321637 cos_to_last_merge=0.8103 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=88 local utility u=0.025898 metrics={'f1_val': 0.8862256319875355, 'auprc': 0.9710617942404448, 'loss_val': 0.6507023164421059, 'psi': 0.9201600968886992}-{'f1_val': 0.8841770453839419, 'auprc': 0.9610999843289727, 'loss_val': 0.6603220777803007, 'psi': 0.9149462209619542}
[S17] not sending this round → trigger blocked (psi=0.920)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → trigger blocked (psi=0.993)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9999
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=88 metric=0.8528 head_norm=2.026391
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.982593e-02
[S6] stored merged vector for next round verification (round=88)
[S6] DEBUG after merge:  round=88 metric=0.8515 head_norm=2.022955 delta_norm=0.019826
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=2.285755 cos_to_last_merge=0.7817 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=89 local utility u=0.035712 metrics={'f1_val': 0.7186753538128581, 'auprc': 0.7739469507110157, 'loss_val': 1.0274778310031114, 'psi': 0.7407839925721211}-{'f1_val': 0.7191634987280932, 'auprc': 0.7691882423561263, 'loss_val': 1.0875546913189935, 'psi': 0.7391733961793064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=89 head_norm_before_train=2.421990 (no previous merge yet)
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.6709176594826536, 'auprc': 0.9834871622286574, 'loss_val': 0.9259243056644616, 'psi': 0.7959454605810551}-{'f1_val': 0.9481177685953066, 'auprc': 0.996072574055968, 'loss_val': 0.1321644482192304, 'psi': 0.9672996907795712}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=2.100881 cos_to_last_merge=0.9878 (last merge round=36)
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9522143697214958, 'auprc': 0.932830788145057, 'loss_val': 0.328811983882613, 'psi': 0.9444609370909203}-{'f1_val': 0.9534654388671397, 'auprc': 0.9486437447092895, 'loss_val': 0.3257131669197882, 'psi': 0.9515367612039995}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=2.161742 cos_to_last_merge=1.0000 (last merge round=86)
[S5] round=89 local utility u=0.008822 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9951072873926168, 'loss_val': 0.021704764476375888, 'psi': 0.9960640960441214}-{'f1_val': 0.995895166894551, 'auprc': 0.9912102016273937, 'loss_val': 0.02281570618519365, 'psi': 0.9940211807876881}
[S6] START round=89 head_norm_before_train=2.022955 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.7996948540713187, 'auprc': 0.9014686901093926, 'loss_val': 0.6641864802414248, 'psi': 0.8404043884865482}-{'f1_val': 0.8528406396862427, 'auprc': 0.9143508119905519, 'loss_val': 0.31717138850788645, 'psi': 0.8774447086079663}
[S7] START round=89 head_norm_before_train=1.866919 cos_to_last_merge=0.9958 (last merge round=44)
[S7] round=89 local utility u=0.870742 metrics={'f1_val': 0.7034384997972896, 'auprc': 0.8646442911194829, 'loss_val': 0.2748938496278764, 'psi': 0.7679208163261668}-{'f1_val': 0.5666219978919281, 'auprc': 0.7820913525058993, 'loss_val': 0.9478202689274021, 'psi': 0.6528097397375165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=89 head_norm_before_train=2.057753 cos_to_last_merge=0.9967 (last merge round=68)
[S8] round=89 local utility u=0.000000 metrics={'f1_val': 0.9811625030339974, 'auprc': 0.9995070863597834, 'loss_val': 0.05020001712977995, 'psi': 0.9885003363643119}-{'f1_val': 0.9907147162646456, 'auprc': 0.9998069626156072, 'loss_val': 0.03010078148154421, 'psi': 0.9943516148050302}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=89 head_norm_before_train=2.223419 cos_to_last_merge=0.9871 (last merge round=29)
[S9] round=89 local utility u=0.000206 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939465122707891, 'loss_val': 0.01691065005810403, 'psi': 0.9955940996671729}-{'f1_val': 0.9966924912647621, 'auprc': 0.9939084002655105, 'loss_val': 0.01720903238900725, 'psi': 0.9955788548650615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=89 head_norm_before_train=2.519686 (no previous merge yet)
[S10] round=89 local utility u=0.000580 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965436216792991, 'loss_val': 0.026028680419661835, 'psi': 0.9957301520833445}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961759012873452, 'loss_val': 0.026085948486978594, 'psi': 0.9955830639265629}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=89 head_norm_before_train=2.158824 cos_to_last_merge=0.9937 (last merge round=44)
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9741783713875223, 'auprc': 0.9984130093498599, 'loss_val': 0.10158416359002112, 'psi': 0.9838722265724573}-{'f1_val': 0.9961336749133093, 'auprc': 0.9985785538012977, 'loss_val': 0.01934769253616149, 'psi': 0.9971116264685047}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.037262 cos_to_last_merge=0.7609 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.761
[S13] round=89 local utility u=0.742769 metrics={'f1_val': 0.7283762856725637, 'auprc': 0.804835085858542, 'loss_val': 0.9942936528433498, 'psi': 0.7589598057469551}-{'f1_val': 0.6305660524363543, 'auprc': 0.6482844634460956, 'loss_val': 1.4233190868809744, 'psi': 0.6376534168402508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=89 head_norm_before_train=1.941402 cos_to_last_merge=0.9687 (last merge round=43)
[S14] round=89 local utility u=0.002005 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9985836049122645, 'loss_val': 0.02343761455022513, 'psi': 0.9973861613079925}-{'f1_val': 0.9961471738646706, 'auprc': 0.9986777365691841, 'loss_val': 0.025086052040919297, 'psi': 0.997159398946476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=89 head_norm_before_train=2.177286 cos_to_last_merge=1.0000 (last merge round=86)
[S15] round=89 local utility u=0.001601 metrics={'f1_val': 0.9082574443353278, 'auprc': 0.9975188471693043, 'loss_val': 0.18943800409864253, 'psi': 0.9439620054689184}-{'f1_val': 0.9076969618858638, 'auprc': 0.9975186751990401, 'loss_val': 0.18927745108334612, 'psi': 0.9436256472111344}
[S16] START round=89 head_norm_before_train=2.024879 cos_to_last_merge=1.0000 (last merge round=87)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9913900784998508, 'auprc': 0.9952565445901048, 'loss_val': 0.041928594384889765, 'psi': 0.9929366649359525}-{'f1_val': 0.9924663489201326, 'auprc': 0.9941578471266427, 'loss_val': 0.0376278094892679, 'psi': 0.9931429482027366}
[S17] START round=89 head_norm_before_train=2.325349 cos_to_last_merge=0.8097 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.810
[S17] round=89 local utility u=0.000000 metrics={'f1_val': 0.8842098491242524, 'auprc': 0.9730007433073418, 'loss_val': 0.6717439127087651, 'psi': 0.9197262067974881}-{'f1_val': 0.8862256319875355, 'auprc': 0.9710617942404448, 'loss_val': 0.6507023164421059, 'psi': 0.9201600968886992}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=89 metric=0.9914 head_norm=2.031585
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.527339e-02
[S16] stored merged vector for next round verification (round=89)
[S16] DEBUG after merge:  round=89 metric=0.9914 head_norm=2.028932 delta_norm=0.015273
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S5
[S15] cosine check vs S5: cos=0.9999
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=89 metric=0.9967 head_norm=2.163834
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.639286e-02
[S5] stored merged vector for next round verification (round=89)
[S5] DEBUG after merge:  round=89 metric=0.9967 head_norm=2.175297 delta_norm=0.016393
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=89 metric=0.9083 head_norm=2.186823
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.608867e-02
[S15] stored merged vector for next round verification (round=89)
[S15] DEBUG after merge:  round=89 metric=0.9083 head_norm=2.174777 delta_norm=0.016089
[S15] aggregate: ACCEPT kept=['S5', 'S5'] (k=2/2) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=2.289205 cos_to_last_merge=0.7811 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.6357432643468166, 'auprc': 0.7866037225384046, 'loss_val': 1.291203522203285, 'psi': 0.6960874476234518}-{'f1_val': 0.7186753538128581, 'auprc': 0.7739469507110157, 'loss_val': 1.0274778310031114, 'psi': 0.7407839925721211}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.425582 (no previous merge yet)
[S3] round=90 local utility u=1.000000 metrics={'f1_val': 0.890903827747991, 'auprc': 0.9962788122479501, 'loss_val': 0.23701769163449432, 'psi': 0.9330538215479747}-{'f1_val': 0.6709176594826536, 'auprc': 0.9834871622286574, 'loss_val': 0.9259243056644616, 'psi': 0.7959454605810551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=90 head_norm_before_train=2.103212 cos_to_last_merge=0.9872 (last merge round=36)
[S4] round=90 local utility u=0.019021 metrics={'f1_val': 0.9504213985830785, 'auprc': 0.9419906943326016, 'loss_val': 0.30749257082987785, 'psi': 0.9470491168828877}-{'f1_val': 0.9522143697214958, 'auprc': 0.932830788145057, 'loss_val': 0.328811983882613, 'psi': 0.9444609370909203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=90 head_norm_before_train=2.175297 cos_to_last_merge=1.0000 (last merge round=89)
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9918620742110015, 'loss_val': 0.022914047013575432, 'psi': 0.9945451168625347}-{'f1_val': 0.9967019684784577, 'auprc': 0.9951072873926168, 'loss_val': 0.021704764476375888, 'psi': 0.9960640960441214}
[S6] START round=90 head_norm_before_train=2.026132 cos_to_last_merge=1.0000 (last merge round=88)
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.7499346507752525, 'auprc': 0.9004014520572563, 'loss_val': 0.8206537833460088, 'psi': 0.810121371288054}-{'f1_val': 0.7996948540713187, 'auprc': 0.9014686901093926, 'loss_val': 0.6641864802414248, 'psi': 0.8404043884865482}
[S7] START round=90 head_norm_before_train=1.866946 cos_to_last_merge=0.9958 (last merge round=44)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.6708972945970003, 'auprc': 0.803313957720254, 'loss_val': 0.42118210176381393, 'psi': 0.7238639598463019}-{'f1_val': 0.7034384997972896, 'auprc': 0.8646442911194829, 'loss_val': 0.2748938496278764, 'psi': 0.7679208163261668}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.065982 cos_to_last_merge=0.9965 (last merge round=68)
[S8] round=90 local utility u=0.035859 metrics={'f1_val': 0.9896849108621378, 'auprc': 0.9995675051123186, 'loss_val': 0.029798229281724643, 'psi': 0.9936379485622102}-{'f1_val': 0.9811625030339974, 'auprc': 0.9995070863597834, 'loss_val': 0.05020001712977995, 'psi': 0.9885003363643119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S8] sending update (kind=head size=1790 to 1 peers)
[S9] START round=90 head_norm_before_train=2.224180 cos_to_last_merge=0.9870 (last merge round=29)
[S9] round=90 local utility u=0.010886 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998329420940854, 'loss_val': 0.015259753537102625, 'psi': 0.9981949243449199}-{'f1_val': 0.9966924912647621, 'auprc': 0.9939465122707891, 'loss_val': 0.01691065005810403, 'psi': 0.9955940996671729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=90 head_norm_before_train=2.526346 (no previous merge yet)
[S10] round=90 local utility u=0.000005 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965433102787652, 'loss_val': 0.026018060963543012, 'psi': 0.9957300275231309}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965436216792991, 'loss_val': 0.026028680419661835, 'psi': 0.9957301520833445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=90 head_norm_before_train=2.162735 cos_to_last_merge=0.9936 (last merge round=44)
[S11] round=90 local utility u=0.108305 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985044265486618, 'loss_val': 0.019460421877698555, 'psi': 0.9973299733276184}-{'f1_val': 0.9741783713875223, 'auprc': 0.9984130093498599, 'loss_val': 0.10158416359002112, 'psi': 0.9838722265724573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=90 head_norm_before_train=2.045415 cos_to_last_merge=0.7603 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.760
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.6477973246073114, 'auprc': 0.6961692708776466, 'loss_val': 1.1387833505027505, 'psi': 0.6671461031154455}-{'f1_val': 0.7283762856725637, 'auprc': 0.804835085858542, 'loss_val': 0.9942936528433498, 'psi': 0.7589598057469551}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=1.945759 cos_to_last_merge=0.9685 (last merge round=43)
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.99661045654233, 'auprc': 0.9967984939725267, 'loss_val': 0.027071180293894128, 'psi': 0.9966856715144088}-{'f1_val': 0.9965878655718112, 'auprc': 0.9985836049122645, 'loss_val': 0.02343761455022513, 'psi': 0.9973861613079925}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.174777 cos_to_last_merge=1.0000 (last merge round=89)
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9974965847251174, 'loss_val': 0.20376604128785505, 'psi': 0.9422645444620898}-{'f1_val': 0.9082574443353278, 'auprc': 0.9975188471693043, 'loss_val': 0.18943800409864253, 'psi': 0.9439620054689184}
[S16] START round=90 head_norm_before_train=2.028932 cos_to_last_merge=1.0000 (last merge round=89)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9911706024717784, 'auprc': 0.9960018402658226, 'loss_val': 0.04922218543521881, 'psi': 0.9931030975893961}-{'f1_val': 0.9913900784998508, 'auprc': 0.9952565445901048, 'loss_val': 0.041928594384889765, 'psi': 0.9929366649359525}
[S17] START round=90 head_norm_before_train=2.332102 cos_to_last_merge=0.8092 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8396704220328424, 'auprc': 0.9565175689208293, 'loss_val': 0.771183514863336, 'psi': 0.8864092807880372}-{'f1_val': 0.8842098491242524, 'auprc': 0.9730007433073418, 'loss_val': 0.6717439127087651, 'psi': 0.9197262067974881}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.246 → S16@127.0.0.1:58316
[S5] ⇄ pheromone p=0.007 → S15@127.0.0.1:58315
[S16] ⇄ pheromone p=0.004 → S6@127.0.0.1:58307
[S15] ⇄ pheromone p=0.010 → S5@127.0.0.1:58305
[S2] START round=91 head_norm_before_train=2.291542 cos_to_last_merge=0.7802 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=91 local utility u=0.301232 metrics={'f1_val': 0.7191634987280932, 'auprc': 0.765327619258587, 'loss_val': 1.1254328073986741, 'psi': 0.7376291469402907}-{'f1_val': 0.6357432643468166, 'auprc': 0.7866037225384046, 'loss_val': 1.291203522203285, 'psi': 0.6960874476234518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=91 head_norm_before_train=2.429695 (no previous merge yet)
[S3] round=91 local utility u=0.263867 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9995000672890214, 'loss_val': 0.1399755822566695, 'psi': 0.9764450781552808}-{'f1_val': 0.890903827747991, 'auprc': 0.9962788122479501, 'loss_val': 0.23701769163449432, 'psi': 0.9330538215479747}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=91 head_norm_before_train=2.107806 cos_to_last_merge=0.9871 (last merge round=36)
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9494310053009893, 'auprc': 0.9376892202240945, 'loss_val': 0.3122414913084782, 'psi': 0.9447342912702315}-{'f1_val': 0.9504213985830785, 'auprc': 0.9419906943326016, 'loss_val': 0.30749257082987785, 'psi': 0.9470491168828877}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=2.178229 cos_to_last_merge=1.0000 (last merge round=89)
[S5] round=91 local utility u=0.012198 metrics={'f1_val': 0.9970695586110643, 'auprc': 0.9995112452000985, 'loss_val': 0.025879900370260098, 'psi': 0.998046233246678}-{'f1_val': 0.9963338119635569, 'auprc': 0.9918620742110015, 'loss_val': 0.022914047013575432, 'psi': 0.9945451168625347}
[S6] START round=91 head_norm_before_train=2.033600 cos_to_last_merge=0.9999 (last merge round=88)
[S6] round=91 local utility u=0.471274 metrics={'f1_val': 0.8357364612461039, 'auprc': 0.8954448635333195, 'loss_val': 0.37804715417188955, 'psi': 0.8596198221609901}-{'f1_val': 0.7499346507752525, 'auprc': 0.9004014520572563, 'loss_val': 0.8206537833460088, 'psi': 0.810121371288054}
[S7] START round=91 head_norm_before_train=1.867341 cos_to_last_merge=0.9958 (last merge round=44)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.660082917870367, 'auprc': 0.8027678236791898, 'loss_val': 0.46948821326691603, 'psi': 0.7171568801938961}-{'f1_val': 0.6708972945970003, 'auprc': 0.803313957720254, 'loss_val': 0.42118210176381393, 'psi': 0.7238639598463019}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.079483 cos_to_last_merge=0.9962 (last merge round=68)
[S8] round=91 local utility u=0.018313 metrics={'f1_val': 0.9951212911203298, 'auprc': 0.9997894464777688, 'loss_val': 0.02645554828222364, 'psi': 0.9969885532633054}-{'f1_val': 0.9896849108621378, 'auprc': 0.9995675051123186, 'loss_val': 0.029798229281724643, 'psi': 0.9936379485622102}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=91 head_norm_before_train=2.224829 cos_to_last_merge=0.9869 (last merge round=29)
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9871765865591023, 'auprc': 0.9996919108706748, 'loss_val': 0.054073609997958884, 'psi': 0.9921827162837313}-{'f1_val': 0.9971029125121428, 'auprc': 0.9998329420940854, 'loss_val': 0.015259753537102625, 'psi': 0.9981949243449199}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.527959 (no previous merge yet)
[S10] round=91 local utility u=0.000103 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965504844450361, 'loss_val': 0.025834490801075624, 'psi': 0.9957328971896393}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965433102787652, 'loss_val': 0.026018060963543012, 'psi': 0.9957300275231309}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=91 head_norm_before_train=2.167590 cos_to_last_merge=0.9936 (last merge round=44)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984849981296986, 'loss_val': 0.019574553918932393, 'psi': 0.9973222019600332}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985044265486618, 'loss_val': 0.019460421877698555, 'psi': 0.9973299733276184}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=2.049731 cos_to_last_merge=0.7597 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.760
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6434347373740334, 'auprc': 0.6727415646239349, 'loss_val': 1.273024955971189, 'psi': 0.655157468273994}-{'f1_val': 0.6477973246073114, 'auprc': 0.6961692708776466, 'loss_val': 1.1387833505027505, 'psi': 0.6671461031154455}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=1.949306 cos_to_last_merge=0.9684 (last merge round=43)
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9949240521091356, 'auprc': 0.9951406125132312, 'loss_val': 0.028018732280260927, 'psi': 0.9950106762707738}-{'f1_val': 0.99661045654233, 'auprc': 0.9967984939725267, 'loss_val': 0.027071180293894128, 'psi': 0.9966856715144088}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=2.184329 cos_to_last_merge=1.0000 (last merge round=89)
[S15] round=91 local utility u=0.000088 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975145229982662, 'loss_val': 0.2036437979061102, 'psi': 0.9422717197713494}-{'f1_val': 0.9054431842867382, 'auprc': 0.9974965847251174, 'loss_val': 0.20376604128785505, 'psi': 0.9422645444620898}
[S16] START round=91 head_norm_before_train=2.035587 cos_to_last_merge=1.0000 (last merge round=89)
[S16] round=91 local utility u=0.000367 metrics={'f1_val': 0.9911706024717784, 'auprc': 0.9966673320138775, 'loss_val': 0.05048535122882709, 'psi': 0.993369294288618}-{'f1_val': 0.9911706024717784, 'auprc': 0.9960018402658226, 'loss_val': 0.04922218543521881, 'psi': 0.9931030975893961}
[S17] START round=91 head_norm_before_train=2.339123 cos_to_last_merge=0.8090 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.8308636953871331, 'auprc': 0.9082259292162198, 'loss_val': 0.8050893277955743, 'psi': 0.8618085889187678}-{'f1_val': 0.8396704220328424, 'auprc': 0.9565175689208293, 'loss_val': 0.771183514863336, 'psi': 0.8864092807880372}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:58315
[S6] sending update (kind=head size=1801 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S15
[S5] cosine check vs S15: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1795) from S5
[S15] cosine check vs S5: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1801) from S6
[S16] cosine check vs S6: cos=0.9999
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=91 metric=0.9971 head_norm=2.178517
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.053028e-02
[S5] stored merged vector for next round verification (round=91)
[S5] DEBUG after merge:  round=91 metric=0.9971 head_norm=2.186113 delta_norm=0.010530
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=91 metric=0.9054 head_norm=2.193734
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.053030e-02
[S15] stored merged vector for next round verification (round=91)
[S15] DEBUG after merge:  round=91 metric=0.9054 head_norm=2.186113 delta_norm=0.010530
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=91 metric=0.9912 head_norm=2.040930
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.490222e-02
[S16] stored merged vector for next round verification (round=91)
[S16] DEBUG after merge:  round=91 metric=0.9912 head_norm=2.039808 delta_norm=0.014902
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=91 metric=0.8357 head_norm=2.038794
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.490222e-02
[S6] stored merged vector for next round verification (round=91)
[S6] DEBUG after merge:  round=91 metric=0.8365 head_norm=2.039808 delta_norm=0.014902
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=92 head_norm_before_train=2.289019 cos_to_last_merge=0.7783 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=92 local utility u=0.273128 metrics={'f1_val': 0.7089353891726621, 'auprc': 0.8137964436645748, 'loss_val': 0.6632139090083012, 'psi': 0.7508798109694272}-{'f1_val': 0.7191634987280932, 'auprc': 0.765327619258587, 'loss_val': 1.1254328073986741, 'psi': 0.7376291469402907}
[S2] not sending this round → trigger blocked (psi=0.751)
[S3] START round=92 head_norm_before_train=2.433795 (no previous merge yet)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9607804860280988, 'auprc': 0.999119385547236, 'loss_val': 0.1597986022108637, 'psi': 0.9761160458357537}-{'f1_val': 0.9610750853994537, 'auprc': 0.9995000672890214, 'loss_val': 0.1399755822566695, 'psi': 0.9764450781552808}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=2.113593 cos_to_last_merge=0.9867 (last merge round=36)
[S4] round=92 local utility u=0.037187 metrics={'f1_val': 0.9520700606974017, 'auprc': 0.9557771247420894, 'loss_val': 0.3079651026352854, 'psi': 0.9535528863152769}-{'f1_val': 0.9494310053009893, 'auprc': 0.9376892202240945, 'loss_val': 0.3122414913084782, 'psi': 0.9447342912702315}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=92 head_norm_before_train=2.186113 cos_to_last_merge=1.0000 (last merge round=91)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.8931791376573283, 'auprc': 0.9897947882891307, 'loss_val': 0.16624436032409382, 'psi': 0.9318253979100493}-{'f1_val': 0.9970695586110643, 'auprc': 0.9995112452000985, 'loss_val': 0.025879900370260098, 'psi': 0.998046233246678}
[S6] START round=92 head_norm_before_train=2.039808 cos_to_last_merge=1.0000 (last merge round=91)
[S6] round=92 local utility u=0.180940 metrics={'f1_val': 0.8404337223465318, 'auprc': 0.9707420415065432, 'loss_val': 0.2702419345579137, 'psi': 0.8925570500105363}-{'f1_val': 0.8357364612461039, 'auprc': 0.8954448635333195, 'loss_val': 0.37804715417188955, 'psi': 0.8596198221609901}
[S7] START round=92 head_norm_before_train=1.872747 cos_to_last_merge=0.9956 (last merge round=44)
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.6470052614481807, 'auprc': 0.8014740449156481, 'loss_val': 0.6859786036427202, 'psi': 0.7087927748351677}-{'f1_val': 0.660082917870367, 'auprc': 0.8027678236791898, 'loss_val': 0.46948821326691603, 'psi': 0.7171568801938961}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.086378 cos_to_last_merge=0.9961 (last merge round=68)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.8247164503507796, 'auprc': 0.9996203112907284, 'loss_val': 0.4832083132503062, 'psi': 0.8946779947267591}-{'f1_val': 0.9951212911203298, 'auprc': 0.9997894464777688, 'loss_val': 0.02645554828222364, 'psi': 0.9969885532633054}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=92 head_norm_before_train=2.225522 cos_to_last_merge=0.9867 (last merge round=29)
[S9] round=92 local utility u=0.047491 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9998899445482402, 'loss_val': 0.01678105301485741, 'psi': 0.9979714725781534}-{'f1_val': 0.9871765865591023, 'auprc': 0.9996919108706748, 'loss_val': 0.054073609997958884, 'psi': 0.9921827162837313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=92 head_norm_before_train=2.533460 (no previous merge yet)
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965490100476682, 'loss_val': 0.025924180941257844, 'psi': 0.9957323074306921}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965504844450361, 'loss_val': 0.025834490801075624, 'psi': 0.9957328971896393}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.168592 cos_to_last_merge=0.9935 (last merge round=44)
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9804962123013751, 'auprc': 0.9983432642337295, 'loss_val': 0.08045645821042463, 'psi': 0.9876350330743169}-{'f1_val': 0.9965470045135896, 'auprc': 0.9984849981296986, 'loss_val': 0.019574553918932393, 'psi': 0.9973222019600332}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.057114 cos_to_last_merge=0.7590 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.759
[S13] round=92 local utility u=0.009152 metrics={'f1_val': 0.6550229173502076, 'auprc': 0.672614470042037, 'loss_val': 1.3238680444062079, 'psi': 0.6620595384269394}-{'f1_val': 0.6434347373740334, 'auprc': 0.6727415646239349, 'loss_val': 1.273024955971189, 'psi': 0.655157468273994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=92 head_norm_before_train=1.953789 cos_to_last_merge=0.9682 (last merge round=43)
[S14] round=92 local utility u=0.012296 metrics={'f1_val': 0.9966305087305161, 'auprc': 0.9986634397509663, 'loss_val': 0.0242331025343397, 'psi': 0.9974436811386962}-{'f1_val': 0.9949240521091356, 'auprc': 0.9951406125132312, 'loss_val': 0.028018732280260927, 'psi': 0.9950106762707738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=92 head_norm_before_train=2.186113 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=92 local utility u=0.000465 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975180874929392, 'loss_val': 0.20272467186642806, 'psi': 0.9422731455692186}-{'f1_val': 0.9054431842867382, 'auprc': 0.9975145229982662, 'loss_val': 0.2036437979061102, 'psi': 0.9422717197713494}
[S16] START round=92 head_norm_before_train=2.039808 cos_to_last_merge=1.0000 (last merge round=91)
[S16] round=92 local utility u=0.001694 metrics={'f1_val': 0.9911706024717784, 'auprc': 0.9967054447433574, 'loss_val': 0.04721240125903742, 'psi': 0.9933845393804099}-{'f1_val': 0.9911706024717784, 'auprc': 0.9966673320138775, 'loss_val': 0.05048535122882709, 'psi': 0.993369294288618}
[S17] START round=92 head_norm_before_train=2.340828 cos_to_last_merge=0.8088 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.809
[S17] round=92 local utility u=0.128135 metrics={'f1_val': 0.8633483260893472, 'auprc': 0.8949063380671993, 'loss_val': 0.7037673934324316, 'psi': 0.8759715308804881}-{'f1_val': 0.8308636953871331, 'auprc': 0.9082259292162198, 'loss_val': 0.8050893277955743, 'psi': 0.8618085889187678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:58307
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S16@127.0.0.1:58316
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=1.0000
[S16] RECEIVED delta(kind=head bytes=1800) from S6
[S16] cosine check vs S6: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1796) from S16
[S6] cosine check vs S16: cos=1.0000
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=92 metric=0.8404 head_norm=2.047054
[S6] _apply_head_vector_avg (torch): Δ‖w‖=5.606636e-03
[S6] stored merged vector for next round verification (round=92)
[S6] DEBUG after merge:  round=92 metric=0.8408 head_norm=2.046085 delta_norm=0.005607
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=92 metric=0.9912 head_norm=2.045132
[S16] _apply_head_vector_avg (torch): Δ‖w‖=5.606619e-03
[S16] stored merged vector for next round verification (round=92)
[S16] DEBUG after merge:  round=92 metric=0.9912 head_norm=2.046085 delta_norm=0.005607
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=2.292698 cos_to_last_merge=0.7775 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.6742796180048195, 'auprc': 0.813903749667521, 'loss_val': 0.7932688653740855, 'psi': 0.7301292706699001}-{'f1_val': 0.7089353891726621, 'auprc': 0.8137964436645748, 'loss_val': 0.6632139090083012, 'psi': 0.7508798109694272}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.437871 (no previous merge yet)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.990496193785766, 'loss_val': 0.16206793256154503, 'psi': 0.9728435287539787}-{'f1_val': 0.9607804860280988, 'auprc': 0.999119385547236, 'loss_val': 0.1597986022108637, 'psi': 0.9761160458357537}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=2.117932 cos_to_last_merge=0.9864 (last merge round=36)
[S4] round=93 local utility u=0.000000 metrics={'f1_val': 0.9509741838081462, 'auprc': 0.9465037557229552, 'loss_val': 0.3280216216809207, 'psi': 0.9491860125740699}-{'f1_val': 0.9520700606974017, 'auprc': 0.9557771247420894, 'loss_val': 0.3079651026352854, 'psi': 0.9535528863152769}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=93 head_norm_before_train=2.184619 cos_to_last_merge=1.0000 (last merge round=91)
[S5] round=93 local utility u=0.383792 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9932683523460806, 'loss_val': 0.02801002784004703, 'psi': 0.9951076281165663}-{'f1_val': 0.8931791376573283, 'auprc': 0.9897947882891307, 'loss_val': 0.16624436032409382, 'psi': 0.9318253979100493}
[S6] START round=93 head_norm_before_train=2.046085 cos_to_last_merge=1.0000 (last merge round=92)
[S6] round=93 local utility u=0.000000 metrics={'f1_val': 0.7134867386494868, 'auprc': 0.9165352187674284, 'loss_val': 0.9984002134150963, 'psi': 0.7947061306966634}-{'f1_val': 0.8404337223465318, 'auprc': 0.9707420415065432, 'loss_val': 0.2702419345579137, 'psi': 0.8925570500105363}
[S7] START round=93 head_norm_before_train=1.880879 cos_to_last_merge=0.9953 (last merge round=44)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.6054441348803983, 'auprc': 0.7972499129272829, 'loss_val': 0.924579908605239, 'psi': 0.6821664460991521}-{'f1_val': 0.6470052614481807, 'auprc': 0.8014740449156481, 'loss_val': 0.6859786036427202, 'psi': 0.7087927748351677}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.095006 cos_to_last_merge=0.9958 (last merge round=68)
[S8] round=93 local utility u=0.741808 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9997376402778975, 'loss_val': 0.020656190804557037, 'psi': 0.996796026657901}-{'f1_val': 0.8247164503507796, 'auprc': 0.9996203112907284, 'loss_val': 0.4832083132503062, 'psi': 0.8946779947267591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=93 head_norm_before_train=2.225531 cos_to_last_merge=0.9866 (last merge round=29)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9998857374592167, 'loss_val': 0.01758778323612153, 'psi': 0.997969789742544}-{'f1_val': 0.9966924912647621, 'auprc': 0.9998899445482402, 'loss_val': 0.01678105301485741, 'psi': 0.9979714725781534}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.540826 (no previous merge yet)
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965611223204482, 'loss_val': 0.02598247643765808, 'psi': 0.9957371523398042}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965490100476682, 'loss_val': 0.025924180941257844, 'psi': 0.9957323074306921}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.168111 cos_to_last_merge=0.9934 (last merge round=44)
[S11] round=93 local utility u=0.076086 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9983728048108783, 'loss_val': 0.02219719143035882, 'psi': 0.9970293268723369}-{'f1_val': 0.9804962123013751, 'auprc': 0.9983432642337295, 'loss_val': 0.08045645821042463, 'psi': 0.9876350330743169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=93 head_norm_before_train=2.069733 cos_to_last_merge=0.7579 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.758
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.5984309848117153, 'auprc': 0.5983304534083219, 'loss_val': 1.6484468103827212, 'psi': 0.598390772250358}-{'f1_val': 0.6550229173502076, 'auprc': 0.672614470042037, 'loss_val': 1.3238680444062079, 'psi': 0.6620595384269394}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.955288 cos_to_last_merge=0.9679 (last merge round=43)
[S14] round=93 local utility u=0.000910 metrics={'f1_val': 0.9965690443088828, 'auprc': 0.9986592192589091, 'loss_val': 0.02203131073989947, 'psi': 0.9974051142888933}-{'f1_val': 0.9966305087305161, 'auprc': 0.9986634397509663, 'loss_val': 0.0242331025343397, 'psi': 0.9974436811386962}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=93 head_norm_before_train=2.195450 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9975163155897142, 'loss_val': 0.2190884200556891, 'psi': 0.9419325759432143}-{'f1_val': 0.9054431842867382, 'auprc': 0.9975180874929392, 'loss_val': 0.20272467186642806, 'psi': 0.9422731455692186}
[S16] START round=93 head_norm_before_train=2.046085 cos_to_last_merge=1.0000 (last merge round=92)
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9054481395038032, 'auprc': 0.9840017139170942, 'loss_val': 0.4052851692457875, 'psi': 0.9368695692691196}-{'f1_val': 0.9911706024717784, 'auprc': 0.9967054447433574, 'loss_val': 0.04721240125903742, 'psi': 0.9933845393804099}
[S17] START round=93 head_norm_before_train=2.338815 cos_to_last_merge=0.8082 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8336690416943354, 'auprc': 0.9101923411248092, 'loss_val': 0.7979731479095464, 'psi': 0.8642783614665249}-{'f1_val': 0.8633483260893472, 'auprc': 0.8949063380671993, 'loss_val': 0.7037673934324316, 'psi': 0.8759715308804881}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:58315
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S5
[S15] cosine check vs S5: cos=1.0000
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=93 metric=0.9963 head_norm=2.184699
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.278297e-03
[S5] stored merged vector for next round verification (round=93)
[S5] DEBUG after merge:  round=93 metric=0.9963 head_norm=2.190061 delta_norm=0.009278
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=2.301368 cos_to_last_merge=0.7776 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=94 local utility u=0.000000 metrics={'f1_val': 0.7192432001444127, 'auprc': 0.7187996602861997, 'loss_val': 1.2226817890888124, 'psi': 0.7190657842011274}-{'f1_val': 0.6742796180048195, 'auprc': 0.813903749667521, 'loss_val': 0.7932688653740855, 'psi': 0.7301292706699001}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=94 head_norm_before_train=2.439220 (no previous merge yet)
[S3] round=94 local utility u=0.059040 metrics={'f1_val': 0.9656778248971544, 'auprc': 0.997432424965762, 'loss_val': 0.09241399371103248, 'psi': 0.9783796649245974}-{'f1_val': 0.9610750853994537, 'auprc': 0.990496193785766, 'loss_val': 0.16206793256154503, 'psi': 0.9728435287539787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=94 head_norm_before_train=2.120929 cos_to_last_merge=0.9863 (last merge round=36)
[S4] round=94 local utility u=0.027716 metrics={'f1_val': 0.9523795622092324, 'auprc': 0.95945634720966, 'loss_val': 0.31987903144617585, 'psi': 0.9552102762094035}-{'f1_val': 0.9509741838081462, 'auprc': 0.9465037557229552, 'loss_val': 0.3280216216809207, 'psi': 0.9491860125740699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=94 head_norm_before_train=2.190061 cos_to_last_merge=1.0000 (last merge round=93)
[S5] round=94 local utility u=0.009495 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9980884756954134, 'loss_val': 0.025688602604596003, 'psi': 0.9972565713652399}-{'f1_val': 0.9963338119635569, 'auprc': 0.9932683523460806, 'loss_val': 0.02801002784004703, 'psi': 0.9951076281165663}
[S6] START round=94 head_norm_before_train=2.051084 cos_to_last_merge=0.9999 (last merge round=92)
[S6] round=94 local utility u=0.707809 metrics={'f1_val': 0.8485746463445809, 'auprc': 0.9095381085734899, 'loss_val': 0.37231827998713696, 'psi': 0.8729600312361445}-{'f1_val': 0.7134867386494868, 'auprc': 0.9165352187674284, 'loss_val': 0.9984002134150963, 'psi': 0.7947061306966634}
[S7] START round=94 head_norm_before_train=1.887209 cos_to_last_merge=0.9950 (last merge round=44)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5885223110655167, 'auprc': 0.7960174176639585, 'loss_val': 1.0146029006983404, 'psi': 0.6715203537048934}-{'f1_val': 0.6054441348803983, 'auprc': 0.7972499129272829, 'loss_val': 0.924579908605239, 'psi': 0.6821664460991521}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.106259 cos_to_last_merge=0.9956 (last merge round=68)
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9719655945468716, 'auprc': 0.9994501690546301, 'loss_val': 0.07364611946369044, 'psi': 0.9829594243499751}-{'f1_val': 0.9948349509112366, 'auprc': 0.9997376402778975, 'loss_val': 0.020656190804557037, 'psi': 0.996796026657901}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=2.226638 cos_to_last_merge=0.9864 (last merge round=29)
[S9] round=94 local utility u=0.003761 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9999678881584941, 'loss_val': 0.015241167447101066, 'psi': 0.9984954457174442}-{'f1_val': 0.9966924912647621, 'auprc': 0.9998857374592167, 'loss_val': 0.01758778323612153, 'psi': 0.997969789742544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=94 head_norm_before_train=2.545940 (no previous merge yet)
[S10] round=94 local utility u=0.000068 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966175778889318, 'loss_val': 0.02601600916339788, 'psi': 0.9957597345671976}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965611223204482, 'loss_val': 0.02598247643765808, 'psi': 0.9957371523398042}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=94 head_norm_before_train=2.170412 cos_to_last_merge=0.9933 (last merge round=44)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9591518491923418, 'auprc': 0.9982345407212002, 'loss_val': 0.1225491346997964, 'psi': 0.9747849258038852}-{'f1_val': 0.9961336749133093, 'auprc': 0.9983728048108783, 'loss_val': 0.02219719143035882, 'psi': 0.9970293268723369}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.078062 cos_to_last_merge=0.7571 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.757
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.5803299223912339, 'auprc': 0.558430012704591, 'loss_val': 1.6874778660137963, 'psi': 0.5715699585165768}-{'f1_val': 0.5984309848117153, 'auprc': 0.5983304534083219, 'loss_val': 1.6484468103827212, 'psi': 0.598390772250358}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=1.957374 cos_to_last_merge=0.9677 (last merge round=43)
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9965915478438183, 'auprc': 0.9986436443224008, 'loss_val': 0.022277878397798535, 'psi': 0.9974123864352513}-{'f1_val': 0.9965690443088828, 'auprc': 0.9986592192589091, 'loss_val': 0.02203131073989947, 'psi': 0.9974051142888933}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.204431 cos_to_last_merge=1.0000 (last merge round=91)
[S15] round=94 local utility u=0.006033 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975187514115393, 'loss_val': 0.21042806470390377, 'psi': 0.9422734111366586}-{'f1_val': 0.9048767495122143, 'auprc': 0.9975163155897142, 'loss_val': 0.2190884200556891, 'psi': 0.9419325759432143}
[S16] START round=94 head_norm_before_train=2.050084 cos_to_last_merge=1.0000 (last merge round=92)
[S16] round=94 local utility u=0.459465 metrics={'f1_val': 0.9913900784998508, 'auprc': 0.9966499849957473, 'loss_val': 0.039950922127112654, 'psi': 0.9934940410982094}-{'f1_val': 0.9054481395038032, 'auprc': 0.9840017139170942, 'loss_val': 0.4052851692457875, 'psi': 0.9368695692691196}
[S17] START round=94 head_norm_before_train=2.340848 cos_to_last_merge=0.8082 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=94 local utility u=0.213594 metrics={'f1_val': 0.8739258923060607, 'auprc': 0.9418433294889331, 'loss_val': 0.7072791388208495, 'psi': 0.9010928671792096}-{'f1_val': 0.8336690416943354, 'auprc': 0.9101923411248092, 'loss_val': 0.7979731479095464, 'psi': 0.8642783614665249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S5] not sending this round → trigger blocked (psi=0.997)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:58316
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:58305
[S6] sending update (kind=head size=1803 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1799) from S15
[S5] cosine check vs S15: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9999
[S16] RECEIVED delta(kind=head bytes=1803) from S6
[S16] cosine check vs S6: cos=0.9999
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=94 metric=0.9054 head_norm=2.213216
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.771188e-02
[S15] stored merged vector for next round verification (round=94)
[S15] DEBUG after merge:  round=94 metric=0.9054 head_norm=2.198932 delta_norm=0.017712
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=94 metric=0.9914 head_norm=2.054809
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.188580e-02
[S16] stored merged vector for next round verification (round=94)
[S16] DEBUG after merge:  round=94 metric=0.9914 head_norm=2.056273 delta_norm=0.011886
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=94 metric=0.8486 head_norm=2.057804
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.188581e-02
[S6] stored merged vector for next round verification (round=94)
[S6] DEBUG after merge:  round=94 metric=0.8481 head_norm=2.056273 delta_norm=0.011886
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=95 head_norm_before_train=2.310106 cos_to_last_merge=0.7777 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=95 local utility u=0.091279 metrics={'f1_val': 0.7204110283398314, 'auprc': 0.7420496731670996, 'loss_val': 1.1168809887657267, 'psi': 0.7290664862707387}-{'f1_val': 0.7192432001444127, 'auprc': 0.7187996602861997, 'loss_val': 1.2226817890888124, 'psi': 0.7190657842011274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=95 head_norm_before_train=2.439684 (no previous merge yet)
[S3] round=95 local utility u=0.042646 metrics={'f1_val': 0.9755679071198273, 'auprc': 0.9989568811310925, 'loss_val': 0.07103526893074485, 'psi': 0.9849234967243334}-{'f1_val': 0.9656778248971544, 'auprc': 0.997432424965762, 'loss_val': 0.09241399371103248, 'psi': 0.9783796649245974}
[S3] not sending this round → trigger blocked (psi=0.985)
[S4] START round=95 head_norm_before_train=2.123964 cos_to_last_merge=0.9858 (last merge round=36)
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9524882905432228, 'auprc': 0.9545055212518808, 'loss_val': 0.3258508449495917, 'psi': 0.953295182826686}-{'f1_val': 0.9523795622092324, 'auprc': 0.95945634720966, 'loss_val': 0.31987903144617585, 'psi': 0.9552102762094035}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=2.192520 cos_to_last_merge=1.0000 (last merge round=93)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.9297935391536222, 'auprc': 0.9905037708560893, 'loss_val': 0.11679676657917064, 'psi': 0.954077631834609}-{'f1_val': 0.9967019684784577, 'auprc': 0.9980884756954134, 'loss_val': 0.025688602604596003, 'psi': 0.9972565713652399}
[S6] START round=95 head_norm_before_train=2.056273 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.7283038960141004, 'auprc': 0.865370066982709, 'loss_val': 0.9522284112981273, 'psi': 0.7831303644015439}-{'f1_val': 0.8485746463445809, 'auprc': 0.9095381085734899, 'loss_val': 0.37231827998713696, 'psi': 0.8729600312361445}
[S7] START round=95 head_norm_before_train=1.891515 cos_to_last_merge=0.9948 (last merge round=44)
[S7] round=95 local utility u=0.620485 metrics={'f1_val': 0.6815067958489223, 'auprc': 0.8364259064928048, 'loss_val': 0.45276510940661324, 'psi': 0.7434744401064752}-{'f1_val': 0.5885223110655167, 'auprc': 0.7960174176639585, 'loss_val': 1.0146029006983404, 'psi': 0.6715203537048934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=95 head_norm_before_train=2.114022 cos_to_last_merge=0.9953 (last merge round=68)
[S8] round=95 local utility u=0.090028 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9996500536610515, 'loss_val': 0.02260067714730808, 'psi': 0.9958804077288299}-{'f1_val': 0.9719655945468716, 'auprc': 0.9994501690546301, 'loss_val': 0.07364611946369044, 'psi': 0.9829594243499751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=95 head_norm_before_train=2.230319 cos_to_last_merge=0.9863 (last merge round=29)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9999601691704586, 'loss_val': 0.02983508673211007, 'psi': 0.9947305558050739}-{'f1_val': 0.9975138174234109, 'auprc': 0.9999678881584941, 'loss_val': 0.015241167447101066, 'psi': 0.9984954457174442}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.546976 (no previous merge yet)
[S10] round=95 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9966182926326542, 'loss_val': 0.026043191584866062, 'psi': 0.9957600204646866}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966175778889318, 'loss_val': 0.02601600916339788, 'psi': 0.9957597345671976}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=95 head_norm_before_train=2.172363 cos_to_last_merge=0.9932 (last merge round=44)
[S11] round=95 local utility u=0.160135 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9984668155492149, 'loss_val': 0.024867849208629198, 'psi': 0.9970669311676715}-{'f1_val': 0.9591518491923418, 'auprc': 0.9982345407212002, 'loss_val': 0.1225491346997964, 'psi': 0.9747849258038852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=95 head_norm_before_train=2.079681 cos_to_last_merge=0.7570 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.757
[S13] round=95 local utility u=1.000000 metrics={'f1_val': 0.731277379140362, 'auprc': 0.8703200701262065, 'loss_val': 1.012601847734163, 'psi': 0.7868944555346997}-{'f1_val': 0.5803299223912339, 'auprc': 0.558430012704591, 'loss_val': 1.6874778660137963, 'psi': 0.5715699585165768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=95 head_norm_before_train=1.961229 cos_to_last_merge=0.9674 (last merge round=43)
[S14] round=95 local utility u=0.000000 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986449434838027, 'loss_val': 0.022872930617492945, 'psi': 0.9974106967366079}-{'f1_val': 0.9965915478438183, 'auprc': 0.9986436443224008, 'loss_val': 0.022277878397798535, 'psi': 0.9974123864352513}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=95 head_norm_before_train=2.198932 cos_to_last_merge=1.0000 (last merge round=94)
[S15] round=95 local utility u=0.000509 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975220978825918, 'loss_val': 0.20941956118968122, 'psi': 0.9422747497250796}-{'f1_val': 0.9054431842867382, 'auprc': 0.9975187514115393, 'loss_val': 0.21042806470390377, 'psi': 0.9422734111366586}
[S16] START round=95 head_norm_before_train=2.056273 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9915550722228358, 'auprc': 0.9909694614911206, 'loss_val': 0.03978994785037181, 'psi': 0.9913208279301498}-{'f1_val': 0.9913900784998508, 'auprc': 0.9966499849957473, 'loss_val': 0.039950922127112654, 'psi': 0.9934940410982094}
[S17] START round=95 head_norm_before_train=2.345530 cos_to_last_merge=0.8083 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=95 local utility u=0.060150 metrics={'f1_val': 0.8827595901144729, 'auprc': 0.9577418161710504, 'loss_val': 0.6876763027267212, 'psi': 0.9127524805371039}-{'f1_val': 0.8739258923060607, 'auprc': 0.9418433294889331, 'loss_val': 0.7072791388208495, 'psi': 0.9010928671792096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:58305
[S16] ⇄ pheromone p=0.075 → S6@127.0.0.1:58307
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=95 metric=0.9298 head_norm=2.195278
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.437007e-02
[S5] stored merged vector for next round verification (round=95)
[S5] DEBUG after merge:  round=95 metric=0.9313 head_norm=2.204219 delta_norm=0.014370
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.054 → S15@127.0.0.1:58315
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] ⇄ pheromone p=0.251 → S16@127.0.0.1:58316
[S5] RECEIVED delta(kind=head bytes=1797) from S15
[S5] cosine check vs S15: cos=1.0000
[S15] ⇄ pheromone p=0.005 → S5@127.0.0.1:58305
[S2] START round=96 head_norm_before_train=2.313875 cos_to_last_merge=0.7772 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=96 local utility u=0.254287 metrics={'f1_val': 0.6977518440780143, 'auprc': 0.8186313579203043, 'loss_val': 0.7020975492317557, 'psi': 0.7461036496149303}-{'f1_val': 0.7204110283398314, 'auprc': 0.7420496731670996, 'loss_val': 1.1168809887657267, 'psi': 0.7290664862707387}
[S2] not sending this round → trigger blocked (psi=0.746)
[S3] START round=96 head_norm_before_train=2.438578 (no previous merge yet)
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.9736205097240056, 'auprc': 0.9975904952578374, 'loss_val': 0.07703855809880175, 'psi': 0.9832085039375383}-{'f1_val': 0.9755679071198273, 'auprc': 0.9989568811310925, 'loss_val': 0.07103526893074485, 'psi': 0.9849234967243334}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=2.131535 cos_to_last_merge=0.9858 (last merge round=36)
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9526304553765205, 'auprc': 0.9476333805583352, 'loss_val': 0.3414164028405591, 'psi': 0.9506316254492464}-{'f1_val': 0.9524882905432228, 'auprc': 0.9545055212518808, 'loss_val': 0.3258508449495917, 'psi': 0.953295182826686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.204219 cos_to_last_merge=1.0000 (last merge round=95)
[S5] round=96 local utility u=0.259939 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.998961267044844, 'loss_val': 0.023742829594796927, 'psi': 0.9976056879050121}-{'f1_val': 0.9297935391536222, 'auprc': 0.9905037708560893, 'loss_val': 0.11679676657917064, 'psi': 0.954077631834609}
[S6] START round=96 head_norm_before_train=2.059978 cos_to_last_merge=1.0000 (last merge round=94)
[S6] round=96 local utility u=0.605848 metrics={'f1_val': 0.8070350035571823, 'auprc': 0.9252623101692908, 'loss_val': 0.3925961617264766, 'psi': 0.8543259262020257}-{'f1_val': 0.7283038960141004, 'auprc': 0.865370066982709, 'loss_val': 0.9522284112981273, 'psi': 0.7831303644015439}
[S7] START round=96 head_norm_before_train=1.893224 cos_to_last_merge=0.9947 (last merge round=44)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.5512870303811886, 'auprc': 0.7842371301407136, 'loss_val': 1.201370162010563, 'psi': 0.6444670702849986}-{'f1_val': 0.6815067958489223, 'auprc': 0.8364259064928048, 'loss_val': 0.45276510940661324, 'psi': 0.7434744401064752}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.122037 cos_to_last_merge=0.9951 (last merge round=68)
[S8] round=96 local utility u=0.002787 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9997454302508321, 'loss_val': 0.0217083435130037, 'psi': 0.9963581803144118}-{'f1_val': 0.9933673104406822, 'auprc': 0.9996500536610515, 'loss_val': 0.02260067714730808, 'psi': 0.9958804077288299}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=96 head_norm_before_train=2.233412 cos_to_last_merge=0.9861 (last merge round=29)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9999284177593593, 'loss_val': 0.042019623190023836, 'psi': 0.992788571779905}-{'f1_val': 0.9912441468948172, 'auprc': 0.9999601691704586, 'loss_val': 0.02983508673211007, 'psi': 0.9947305558050739}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.552507 (no previous merge yet)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961303323942787, 'loss_val': 0.02626296469829599, 'psi': 0.9955648363693363}-{'f1_val': 0.9951878390193748, 'auprc': 0.9966182926326542, 'loss_val': 0.026043191584866062, 'psi': 0.9957600204646866}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.174846 cos_to_last_merge=0.9931 (last merge round=44)
[S11] round=96 local utility u=0.002593 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.998559188270047, 'loss_val': 0.019958830245086844, 'psi': 0.9971038802560044}-{'f1_val': 0.9961336749133093, 'auprc': 0.9984668155492149, 'loss_val': 0.024867849208629198, 'psi': 0.9970669311676715}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=96 head_norm_before_train=2.080056 cos_to_last_merge=0.7569 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.757
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6321826443725106, 'auprc': 0.6236111040962732, 'loss_val': 1.4248020567931101, 'psi': 0.6287540282620157}-{'f1_val': 0.731277379140362, 'auprc': 0.8703200701262065, 'loss_val': 1.012601847734163, 'psi': 0.7868944555346997}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.965644 cos_to_last_merge=0.9670 (last merge round=43)
[S14] round=96 local utility u=0.000831 metrics={'f1_val': 0.9965878655718112, 'auprc': 0.9986366036352912, 'loss_val': 0.021185678316902386, 'psi': 0.9974073607972032}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986449434838027, 'loss_val': 0.022872930617492945, 'psi': 0.9974106967366079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=96 head_norm_before_train=2.207606 cos_to_last_merge=1.0000 (last merge round=94)
[S15] round=96 local utility u=0.001713 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975233000824191, 'loss_val': 0.20599807778713136, 'psi': 0.9422752306050105}-{'f1_val': 0.9054431842867382, 'auprc': 0.9975220978825918, 'loss_val': 0.20941956118968122, 'psi': 0.9422747497250796}
[S16] START round=96 head_norm_before_train=2.060658 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.9859877023705691, 'loss_val': 0.057941901957596624, 'psi': 0.9895625972400321}-{'f1_val': 0.9915550722228358, 'auprc': 0.9909694614911206, 'loss_val': 0.03978994785037181, 'psi': 0.9913208279301498}
[S17] START round=96 head_norm_before_train=2.351741 cos_to_last_merge=0.8083 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=96 local utility u=0.009575 metrics={'f1_val': 0.8842098491242524, 'auprc': 0.9603405509790945, 'loss_val': 0.6850246853862564, 'psi': 0.9146621298661892}-{'f1_val': 0.8827595901144729, 'auprc': 0.9577418161710504, 'loss_val': 0.6876763027267212, 'psi': 0.9127524805371039}
[S17] not sending this round → trigger blocked (psi=0.915)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] → sending delta(kind=head bytes=1806) to S16@127.0.0.1:58316
[S15] not sending this round → trigger blocked (psi=0.942)
[S6] sending update (kind=head size=1806 to 1 peers)
[S5] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1806) from S6
[S16] cosine check vs S6: cos=0.9999
[S15] RECEIVED delta(kind=head bytes=1801) from S5
[S15] cosine check vs S5: cos=1.0000
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=96 metric=0.9967 head_norm=2.207246
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.146570e-03
[S5] stored merged vector for next round verification (round=96)
[S5] DEBUG after merge:  round=96 metric=0.9967 head_norm=2.207420 delta_norm=0.005147
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.318117 cos_to_last_merge=0.7767 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.6892176375912011, 'auprc': 0.802754631074645, 'loss_val': 0.7191975703283445, 'psi': 0.7346324349845788}-{'f1_val': 0.6977518440780143, 'auprc': 0.8186313579203043, 'loss_val': 0.7020975492317557, 'psi': 0.7461036496149303}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.435130 (no previous merge yet)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.8509972546281338, 'auprc': 0.9945178038793099, 'loss_val': 0.3002617027644336, 'psi': 0.9084054743286043}-{'f1_val': 0.9736205097240056, 'auprc': 0.9975904952578374, 'loss_val': 0.07703855809880175, 'psi': 0.9832085039375383}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=2.137206 cos_to_last_merge=0.9859 (last merge round=36)
[S4] round=97 local utility u=0.032683 metrics={'f1_val': 0.9539936965819678, 'auprc': 0.9647224162667187, 'loss_val': 0.33549750103751624, 'psi': 0.9582851844558682}-{'f1_val': 0.9526304553765205, 'auprc': 0.9476333805583352, 'loss_val': 0.3414164028405591, 'psi': 0.9506316254492464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=97 head_norm_before_train=2.207420 cos_to_last_merge=1.0000 (last merge round=96)
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9332128375366509, 'auprc': 0.9902378939594181, 'loss_val': 0.12392673545722102, 'psi': 0.9560228601057578}-{'f1_val': 0.9967019684784577, 'auprc': 0.998961267044844, 'loss_val': 0.023742829594796927, 'psi': 0.9976056879050121}
[S6] START round=97 head_norm_before_train=2.067945 cos_to_last_merge=0.9999 (last merge round=94)
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.8221920646695462, 'auprc': 0.9210181451593505, 'loss_val': 0.616464833898001, 'psi': 0.861722496865468}-{'f1_val': 0.8070350035571823, 'auprc': 0.9252623101692908, 'loss_val': 0.3925961617264766, 'psi': 0.8543259262020257}
[S7] START round=97 head_norm_before_train=1.892184 cos_to_last_merge=0.9947 (last merge round=44)
[S7] round=97 local utility u=1.000000 metrics={'f1_val': 0.8013790410244614, 'auprc': 0.8371002561436413, 'loss_val': 0.3196978851786542, 'psi': 0.8156675270721334}-{'f1_val': 0.5512870303811886, 'auprc': 0.7842371301407136, 'loss_val': 1.201370162010563, 'psi': 0.6444670702849986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=97 head_norm_before_train=2.130962 cos_to_last_merge=0.9949 (last merge round=68)
[S8] round=97 local utility u=0.000000 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9996001396876592, 'loss_val': 0.025147861335000247, 'psi': 0.9963592248675275}-{'f1_val': 0.9941000136901317, 'auprc': 0.9997454302508321, 'loss_val': 0.0217083435130037, 'psi': 0.9963581803144118}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=97 head_norm_before_train=2.236391 cos_to_last_merge=0.9859 (last merge round=29)
[S9] round=97 local utility u=0.040320 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9999013244785889, 'loss_val': 0.015743789825650632, 'psi': 0.9982222772987213}-{'f1_val': 0.9880286744602689, 'auprc': 0.9999284177593593, 'loss_val': 0.042019623190023836, 'psi': 0.992788571779905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=97 head_norm_before_train=2.553605 (no previous merge yet)
[S10] round=97 local utility u=0.000701 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965816766333864, 'loss_val': 0.026214419953638816, 'psi': 0.9957453740649793}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961303323942787, 'loss_val': 0.02626296469829599, 'psi': 0.9955648363693363}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=97 head_norm_before_train=2.179678 cos_to_last_merge=0.9930 (last merge round=44)
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.988427823133291, 'auprc': 0.9985508356906712, 'loss_val': 0.047071263413059825, 'psi': 0.9924770281562432}-{'f1_val': 0.9961336749133093, 'auprc': 0.998559188270047, 'loss_val': 0.019958830245086844, 'psi': 0.9971038802560044}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.083532 cos_to_last_merge=0.7568 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.757
[S13] round=97 local utility u=0.000000 metrics={'f1_val': 0.6040548621470446, 'auprc': 0.5654571430000843, 'loss_val': 1.705805571127952, 'psi': 0.5886157744882605}-{'f1_val': 0.6321826443725106, 'auprc': 0.6236111040962732, 'loss_val': 1.4248020567931101, 'psi': 0.6287540282620157}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=97 head_norm_before_train=1.971223 cos_to_last_merge=0.9666 (last merge round=43)
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9967816477249961, 'auprc': 0.9985753701941384, 'loss_val': 0.025014506402117054, 'psi': 0.9974991367126531}-{'f1_val': 0.9965878655718112, 'auprc': 0.9986366036352912, 'loss_val': 0.021185678316902386, 'psi': 0.9974073607972032}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=2.216292 cos_to_last_merge=1.0000 (last merge round=94)
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9974933000963035, 'loss_val': 0.22222842917629665, 'psi': 0.94192336974585}-{'f1_val': 0.9054431842867382, 'auprc': 0.9975233000824191, 'loss_val': 0.20599807778713136, 'psi': 0.9422752306050105}
[S16] START round=97 head_norm_before_train=2.063642 cos_to_last_merge=1.0000 (last merge round=94)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.8301091486944611, 'auprc': 0.9901838178932527, 'loss_val': 1.102071216056131, 'psi': 0.8941390163739777}-{'f1_val': 0.9919458604863408, 'auprc': 0.9859877023705691, 'loss_val': 0.057941901957596624, 'psi': 0.9895625972400321}
[S17] START round=97 head_norm_before_train=2.355063 cos_to_last_merge=0.8079 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.8814144577452936, 'auprc': 0.9627387620952905, 'loss_val': 0.7014371821245328, 'psi': 0.9139441794852923}-{'f1_val': 0.8842098491242524, 'auprc': 0.9603405509790945, 'loss_val': 0.6850246853862564, 'psi': 0.9146621298661892}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=97 metric=0.9049 head_norm=2.224930
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.265279e-02
[S15] stored merged vector for next round verification (round=97)
[S15] DEBUG after merge:  round=97 metric=0.9049 head_norm=2.216069 delta_norm=0.012653
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=97 metric=0.8301 head_norm=2.066228
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.394557e-02
[S16] stored merged vector for next round verification (round=97)
[S16] DEBUG after merge:  round=97 metric=0.8301 head_norm=2.067040 delta_norm=0.013946
[S16] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.322781 cos_to_last_merge=0.7761 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7186099287910397, 'auprc': 0.7778002874756715, 'loss_val': 1.0083844014356902, 'psi': 0.7422860722648925}-{'f1_val': 0.6892176375912011, 'auprc': 0.802754631074645, 'loss_val': 0.7191975703283445, 'psi': 0.7346324349845788}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.435365 (no previous merge yet)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.8454975384465768, 'auprc': 0.9949094493380958, 'loss_val': 0.31517556274904734, 'psi': 0.9052623028031844}-{'f1_val': 0.8509972546281338, 'auprc': 0.9945178038793099, 'loss_val': 0.3002617027644336, 'psi': 0.9084054743286043}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=2.143405 cos_to_last_merge=0.9860 (last merge round=36)
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9528916319263459, 'auprc': 0.9388351984000556, 'loss_val': 0.35496298017302, 'psi': 0.9472690585158298}-{'f1_val': 0.9539936965819678, 'auprc': 0.9647224162667187, 'loss_val': 0.33549750103751624, 'psi': 0.9582851844558682}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.211650 cos_to_last_merge=1.0000 (last merge round=96)
[S5] round=98 local utility u=0.253438 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9984848898947782, 'loss_val': 0.02272719199446453, 'psi': 0.997415137044986}-{'f1_val': 0.9332128375366509, 'auprc': 0.9902378939594181, 'loss_val': 0.12392673545722102, 'psi': 0.9560228601057578}
[S6] START round=98 head_norm_before_train=2.077625 cos_to_last_merge=0.9999 (last merge round=94)
[S6] round=98 local utility u=0.000000 metrics={'f1_val': 0.7640283563993235, 'auprc': 0.9017549309628519, 'loss_val': 0.9065260010191182, 'psi': 0.8191189862247349}-{'f1_val': 0.8221920646695462, 'auprc': 0.9210181451593505, 'loss_val': 0.616464833898001, 'psi': 0.861722496865468}
[S7] START round=98 head_norm_before_train=1.892768 cos_to_last_merge=0.9946 (last merge round=44)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.5897040815104233, 'auprc': 0.7926694921984082, 'loss_val': 0.9109368657599562, 'psi': 0.6708902457856173}-{'f1_val': 0.8013790410244614, 'auprc': 0.8371002561436413, 'loss_val': 0.3196978851786542, 'psi': 0.8156675270721334}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.135914 cos_to_last_merge=0.9948 (last merge round=68)
[S8] round=98 local utility u=0.000371 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9995933114475486, 'loss_val': 0.0243851743929934, 'psi': 0.9963564935714833}-{'f1_val': 0.9941986149874398, 'auprc': 0.9996001396876592, 'loss_val': 0.025147861335000247, 'psi': 0.9963592248675275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=98 head_norm_before_train=2.240012 cos_to_last_merge=0.9858 (last merge round=29)
[S9] round=98 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9938964419353867, 'loss_val': 0.01707429185682828, 'psi': 0.995574071533012}-{'f1_val': 0.9971029125121428, 'auprc': 0.9999013244785889, 'loss_val': 0.015743789825650632, 'psi': 0.9982222772987213}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=98 head_norm_before_train=2.558103 (no previous merge yet)
[S10] round=98 local utility u=0.000059 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.996562496208476, 'loss_val': 0.02603967712133134, 'psi': 0.9957377018950153}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965816766333864, 'loss_val': 0.026214419953638816, 'psi': 0.9957453740649793}
[S10] not sending this round → trigger blocked (psi=0.996)
[S11] START round=98 head_norm_before_train=2.184551 cos_to_last_merge=0.9929 (last merge round=44)
[S11] round=98 local utility u=0.038506 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9985887415832645, 'loss_val': 0.01888804944398727, 'psi': 0.9973636993414595}-{'f1_val': 0.988427823133291, 'auprc': 0.9985508356906712, 'loss_val': 0.047071263413059825, 'psi': 0.9924770281562432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=98 head_norm_before_train=2.089552 cos_to_last_merge=0.7562 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.756
[S13] round=98 local utility u=0.435155 metrics={'f1_val': 0.6373440745501089, 'auprc': 0.6624424780098436, 'loss_val': 1.3261866400591422, 'psi': 0.6473834359340027}-{'f1_val': 0.6040548621470446, 'auprc': 0.5654571430000843, 'loss_val': 1.705805571127952, 'psi': 0.5886157744882605}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=98 head_norm_before_train=1.975286 cos_to_last_merge=0.9665 (last merge round=43)
[S14] round=98 local utility u=0.000648 metrics={'f1_val': 0.9969981421187261, 'auprc': 0.9978628108172892, 'loss_val': 0.022880315835261886, 'psi': 0.9973440095981514}-{'f1_val': 0.9967816477249961, 'auprc': 0.9985753701941384, 'loss_val': 0.025014506402117054, 'psi': 0.9974991367126531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=98 head_norm_before_train=2.216069 cos_to_last_merge=1.0000 (last merge round=97)
[S15] round=98 local utility u=0.000130 metrics={'f1_val': 0.9048767495122143, 'auprc': 0.9974948060259243, 'loss_val': 0.22197274269549563, 'psi': 0.9419239721176984}-{'f1_val': 0.9048767495122143, 'auprc': 0.9974933000963035, 'loss_val': 0.22222842917629665, 'psi': 0.94192336974585}
[S16] START round=98 head_norm_before_train=2.067040 cos_to_last_merge=1.0000 (last merge round=97)
[S16] round=98 local utility u=1.000000 metrics={'f1_val': 0.9917745098305579, 'auprc': 0.9867692723885957, 'loss_val': 0.052709969927001624, 'psi': 0.989772414853773}-{'f1_val': 0.8301091486944611, 'auprc': 0.9901838178932527, 'loss_val': 1.102071216056131, 'psi': 0.8941390163739777}
[S17] START round=98 head_norm_before_train=2.359836 cos_to_last_merge=0.8075 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8749653004284251, 'auprc': 0.9668970481631673, 'loss_val': 0.7259596920178925, 'psi': 0.911737999522322}-{'f1_val': 0.8814144577452936, 'auprc': 0.9627387620952905, 'loss_val': 0.7014371821245328, 'psi': 0.9139441794852923}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:58315
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:58305
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:58307
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S15
[S5] cosine check vs S15: cos=1.0000
[S15] RECEIVED delta(kind=head bytes=1799) from S5
[S15] cosine check vs S5: cos=1.0000
[S6] RECEIVED delta(kind=head bytes=1798) from S16
[S6] cosine check vs S16: cos=0.9998
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=98 metric=0.9049 head_norm=2.224435
[S15] _apply_head_vector_avg (torch): Δ‖w‖=9.998123e-03
[S15] stored merged vector for next round verification (round=98)
[S15] DEBUG after merge:  round=98 metric=0.9049 head_norm=2.220382 delta_norm=0.009998
[S15] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=98 metric=0.9967 head_norm=2.216367
[S5] _apply_head_vector_avg (torch): Δ‖w‖=9.998123e-03
[S5] stored merged vector for next round verification (round=98)
[S5] DEBUG after merge:  round=98 metric=0.9967 head_norm=2.220382 delta_norm=0.009998
[S5] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=99 head_norm_before_train=2.328140 cos_to_last_merge=0.7758 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7204589655015333, 'auprc': 0.7411945609407349, 'loss_val': 1.2116516789630463, 'psi': 0.728753203677214}-{'f1_val': 0.7186099287910397, 'auprc': 0.7778002874756715, 'loss_val': 1.0083844014356902, 'psi': 0.7422860722648925}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.729 u=0.0000 p_local=0.0618 f1=0.720 auprc=0.741 bytes=66541
[S3] START round=99 head_norm_before_train=2.437983 (no previous merge yet)
[S3] round=99 local utility u=0.037165 metrics={'f1_val': 0.8545015564464967, 'auprc': 0.996057386378535, 'loss_val': 0.29831274666317964, 'psi': 0.911123888419312}-{'f1_val': 0.8454975384465768, 'auprc': 0.9949094493380958, 'loss_val': 0.31517556274904734, 'psi': 0.9052623028031844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S3] r=100 psi=0.911 u=0.0372 p_local=0.0611 f1=0.855 auprc=0.996 bytes=66565
[S4] START round=99 head_norm_before_train=2.146689 cos_to_last_merge=0.9857 (last merge round=36)
[S4] round=99 local utility u=0.059432 metrics={'f1_val': 0.9510653933883144, 'auprc': 0.9692231947616473, 'loss_val': 0.31630538441903533, 'psi': 0.9583285139376476}-{'f1_val': 0.9528916319263459, 'auprc': 0.9388351984000556, 'loss_val': 0.35496298017302, 'psi': 0.9472690585158298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=100 psi=0.958 u=0.0594 p_local=0.0210 f1=0.951 auprc=0.969 bytes=82864
[S5] START round=99 head_norm_before_train=2.220382 cos_to_last_merge=1.0000 (last merge round=98)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9694295150113231, 'auprc': 0.9909918499482359, 'loss_val': 0.061665130923771544, 'psi': 0.9780544489860882}-{'f1_val': 0.9967019684784577, 'auprc': 0.9984848898947782, 'loss_val': 0.02272719199446453, 'psi': 0.997415137044986}
[S6] START round=99 head_norm_before_train=2.085995 cos_to_last_merge=0.9998 (last merge round=94)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.5964022436996099, 'auprc': 0.7941403545171613, 'loss_val': 1.4921598646163832, 'psi': 0.6754974880266305}-{'f1_val': 0.7640283563993235, 'auprc': 0.9017549309628519, 'loss_val': 0.9065260010191182, 'psi': 0.8191189862247349}
[S7] START round=99 head_norm_before_train=1.895357 cos_to_last_merge=0.9945 (last merge round=44)
[S7] round=99 local utility u=0.228668 metrics={'f1_val': 0.6225741233941771, 'auprc': 0.7969645591560318, 'loss_val': 0.6637063221338011, 'psi': 0.692330297698919}-{'f1_val': 0.5897040815104233, 'auprc': 0.7926694921984082, 'loss_val': 0.9109368657599562, 'psi': 0.6708902457856173}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S7] r=100 psi=0.692 u=0.2287 p_local=0.2525 f1=0.623 auprc=0.797 bytes=79148
[S8] START round=99 head_norm_before_train=2.144772 cos_to_last_merge=0.9945 (last merge round=68)
[S8] round=99 local utility u=0.001438 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9996150843877187, 'loss_val': 0.021575340091901686, 'psi': 0.9963652027475514}-{'f1_val': 0.9941986149874398, 'auprc': 0.9995933114475486, 'loss_val': 0.0243851743929934, 'psi': 0.9963564935714833}
[S8] not sending this round → trigger blocked (psi=0.996)
[S8] r=100 psi=0.996 u=0.0014 p_local=0.0605 f1=0.994 auprc=1.000 bytes=82678
[S9] START round=99 head_norm_before_train=2.244560 cos_to_last_merge=0.9857 (last merge round=29)
[S9] round=99 local utility u=0.010658 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9998327410116636, 'loss_val': 0.01603000632823956, 'psi': 0.9981948439119511}-{'f1_val': 0.9966924912647621, 'auprc': 0.9938964419353867, 'loss_val': 0.01707429185682828, 'psi': 0.995574071533012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S9] r=100 psi=0.998 u=0.0107 p_local=0.0106 f1=0.997 auprc=1.000 bytes=80967
[S10] START round=99 head_norm_before_train=2.565058 (no previous merge yet)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965702491412984, 'loss_val': 0.026150053641652644, 'psi': 0.9957408030681443}-{'f1_val': 0.9951878390193748, 'auprc': 0.996562496208476, 'loss_val': 0.02603967712133134, 'psi': 0.9957377018950153}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.997 bytes=86134
[S11] START round=99 head_norm_before_train=2.189797 cos_to_last_merge=0.9928 (last merge round=44)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9984805915799051, 'loss_val': 0.019522070841883045, 'psi': 0.9973204393401158}-{'f1_val': 0.9965470045135896, 'auprc': 0.9985887415832645, 'loss_val': 0.01888804944398727, 'psi': 0.9973636993414595}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.997 u=0.0000 p_local=0.0338 f1=0.997 auprc=0.998 bytes=75647
[S13] START round=99 head_norm_before_train=2.094157 cos_to_last_merge=0.7559 (last merge round=2)
[S13] ⚠️ Model drifted since last merge! cos=0.756
[S13] round=99 local utility u=0.852488 metrics={'f1_val': 0.7189304954249117, 'auprc': 0.9590547809023169, 'loss_val': 1.0005663005074763, 'psi': 0.8149802096158738}-{'f1_val': 0.6373440745501089, 'auprc': 0.6624424780098436, 'loss_val': 1.3261866400591422, 'psi': 0.6473834359340027}
[S13] not sending this round → trigger blocked (psi=0.815)
[S13] r=100 psi=0.815 u=0.8525 p_local=0.3474 f1=0.719 auprc=0.959 bytes=77422
[S14] START round=99 head_norm_before_train=1.978985 cos_to_last_merge=0.9663 (last merge round=43)
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9968205796367875, 'auprc': 0.9977381804400817, 'loss_val': 0.023449408633934753, 'psi': 0.9971876199581051}-{'f1_val': 0.9969981421187261, 'auprc': 0.9978628108172892, 'loss_val': 0.022880315835261886, 'psi': 0.9973440095981514}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.997 u=0.0000 p_local=0.0013 f1=0.997 auprc=0.998 bytes=88156
[S15] START round=99 head_norm_before_train=2.220382 cos_to_last_merge=1.0000 (last merge round=98)
[S15] round=99 local utility u=0.006440 metrics={'f1_val': 0.9054431842867382, 'auprc': 0.9975061734110156, 'loss_val': 0.21252464000149413, 'psi': 0.9422683799364491}-{'f1_val': 0.9048767495122143, 'auprc': 0.9974948060259243, 'loss_val': 0.22197274269549563, 'psi': 0.9419239721176984}
[S16] START round=99 head_norm_before_train=2.070600 cos_to_last_merge=1.0000 (last merge round=97)
[S16] round=99 local utility u=0.010564 metrics={'f1_val': 0.9926284446526763, 'auprc': 0.9888498613069296, 'loss_val': 0.04294800173419781, 'psi': 0.9911170113143776}-{'f1_val': 0.9917745098305579, 'auprc': 0.9867692723885957, 'loss_val': 0.052709969927001624, 'psi': 0.989772414853773}
[S17] START round=99 head_norm_before_train=2.366645 cos_to_last_merge=0.8071 (last merge round=2)
[S17] ⚠️ Model drifted since last merge! cos=0.807
[S17] round=99 local utility u=0.000000 metrics={'f1_val': 0.811159278695767, 'auprc': 0.952220481954746, 'loss_val': 0.9514738712418883, 'psi': 0.8675837599993586}-{'f1_val': 0.8749653004284251, 'auprc': 0.9668970481631673, 'loss_val': 0.7259596920178925, 'psi': 0.911737999522322}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=100 psi=0.868 u=0.0000 p_local=0.0301 f1=0.811 auprc=0.952 bytes=80911
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → trigger blocked (psi=0.942)
[S16] not sending this round → trigger blocked (psi=0.991)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=99 metric=0.5964 head_norm=2.093125
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.585940e-02
[S6] stored merged vector for next round verification (round=99)
[S6] DEBUG after merge:  round=99 metric=0.5964 head_norm=2.081732 delta_norm=0.025859
[S6] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S6] r=100 psi=0.675 u=0.0000 p_local=0.1648 f1=0.596 auprc=0.794 bytes=75612
[S16] r=100 psi=0.991 u=0.0106 p_local=0.1928 f1=0.993 auprc=0.989 bytes=75570
[S15] r=100 psi=0.942 u=0.0064 p_local=0.0033 f1=0.905 auprc=0.998 bytes=79160
[S5] r=100 psi=0.978 u=0.0000 p_local=0.0892 f1=0.969 auprc=0.991 bytes=88161
[runner] rounds complete.
[runner] all agents stopped.
