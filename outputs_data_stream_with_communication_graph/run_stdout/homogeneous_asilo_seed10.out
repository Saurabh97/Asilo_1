[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:44603
[S3] → join 127.0.0.1:44602
[S4] → join 127.0.0.1:44602
[S5] → join 127.0.0.1:44602
[S6] → join 127.0.0.1:44602
[S7] → join 127.0.0.1:44602
[S8] → join 127.0.0.1:44602
[S9] → join 127.0.0.1:44602
[S10] → join 127.0.0.1:44602
[S11] → join 127.0.0.1:44602
[S13] → join 127.0.0.1:44602
[S14] → join 127.0.0.1:44602
[S15] → join 127.0.0.1:44602
[S16] → join 127.0.0.1:44602
[S17] → join 127.0.0.1:44602
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.123384 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.149415 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.220997 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.160429 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.151775 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.147590 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.174752 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.161708 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.202381 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.131136 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.143210 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.121417 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.214255 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.173661 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.184974 (no previous merge yet)
[S10]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3] + discovered S17
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S16
[S3] + discovered S11
[S3] + discovered S6
[S3] + discovered S10
[S3] + discovered S9
[S3] + discovered S13
[S3] + discovered S4
[S4] + discovered S2
[S3] + discovered S5
[S4] + discovered S3
[S3] + discovered S8
[S3] + discovered S14
[S4] + discovered S8
[S4] + discovered S14
[S4] + discovered S5
[S4] + discovered S16
[S4] + discovered S13
[S4] + discovered S9
[S5] + discovered S2
[S4] + discovered S17
[S5] + discovered S4
[S4] + discovered S10
[S4] + discovered S11
[S5] + discovered S3
[S4] + discovered S7
[S4] + discovered S6
[S4] + discovered S15
[S6] + discovered S3
[S6] + discovered S4
[S5] + discovered S10
[S5] + discovered S11
[S6] + discovered S5
[S5] + discovered S16
[S5] + discovered S9
[S5] + discovered S6
[S5] + discovered S7
[S5] + discovered S14
[S5] + discovered S13
[S5] + discovered S15
[S6] + discovered S2
[S5] + discovered S17
[S5] + discovered S8
[S6] + discovered S9
[S7] + discovered S2
[S7] + discovered S6
[S7] + discovered S3
[S6] + discovered S10
[S6] + discovered S8
[S7] + discovered S4
[S7] + discovered S5
[S6] + discovered S17
[S6] + discovered S16
[S6] + discovered S11
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S14
[S6] + discovered S7
[S7] + discovered S10
[S7] + discovered S13
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S8
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S9
[S8] + discovered S4
[S8] + discovered S6
[S8] + discovered S5
[S8] + discovered S7
[S8] + discovered S2
[S8] + discovered S3
[S7] + discovered S11
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S13
[S9] + discovered S4
[S8] + discovered S11
[S9] + discovered S6
[S9] + discovered S2
[S9] + discovered S7
[S9] + discovered S8
[S8] + discovered S9
[S9] + discovered S3
[S8] + discovered S17
[S9] + discovered S5
[S8] + discovered S10
[S8] + discovered S15
[S9] + discovered S10
[S10] + discovered S3
[S9] + discovered S16
[S10] + discovered S6
[S10] + discovered S9
[S10] + discovered S4
[S10] + discovered S8
[S10] + discovered S5
[S9] + discovered S11
[S9] + discovered S14
[S9] + discovered S17
[S9] + discovered S13
[S9] + discovered S15
[S10] + discovered S2
[S10] + discovered S7
[S11] + discovered S7
[S11] + discovered S2
[S11] + discovered S4
[S11] + discovered S3
[S10] + discovered S17
[S11] + discovered S9
[S10] + discovered S16
[S11] + discovered S8
[S11] + discovered S10
[S11] + discovered S5
[S11] + discovered S6
[S10] + discovered S13
[S10] + discovered S15
[S10] + discovered S14
[S10] + discovered S11
[S13] + discovered S4
[S11] + discovered S14
[S13] + discovered S8
[S13] + discovered S9
[S11] + discovered S17
[S13] + discovered S10
[S13] + discovered S3
[S13] + discovered S6
[S11] + discovered S15
[S13] + discovered S11
[S13] + discovered S5
[S11] + discovered S13
[S13] + discovered S7
[S13] + discovered S2
[S11] + discovered S16
[S14] + discovered S2
[S14] + discovered S13
[S14] + discovered S11
[S14] + discovered S6
[S14] + discovered S9
[S13] + discovered S15
[S13] + discovered S14
[S13] + discovered S16
[S13] + discovered S17
[S14] + discovered S3
[S14] + discovered S7
[S14] + discovered S10
[S14] + discovered S5
[S14] + discovered S4
[S14] + discovered S8
[S15] + discovered S9
[S15] + discovered S10
[S15] + discovered S2
[S15] + discovered S3
[S14] + discovered S16
[S15] + discovered S13
[S15] + discovered S11
[S15] + discovered S5
[S15] + discovered S8
[S14] + discovered S17
[S15] + discovered S4
[S15] + discovered S6
[S15] + discovered S14
[S14] + discovered S15
[S15] + discovered S7
[S16] + discovered S13
[S16] + discovered S9
[S16] + discovered S15
[S16] + discovered S5
[S16] + discovered S11
[S16] + discovered S6
[S16] + discovered S4
[S16] + discovered S10
[S16] + discovered S3
[S16] + discovered S2
[S15] + discovered S17
[S15] + discovered S16
[S16] + discovered S14
[S16] + discovered S7
[S16] + discovered S8
[S17] + discovered S11
[S17] + discovered S16
[S17] + discovered S13
[S17] + discovered S2
[S17] + discovered S6
[S17] + discovered S15
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S8
[S17] + discovered S3
[S17] + discovered S4
[S16] + discovered S17
[S17] + discovered S5
[S17] + discovered S14
[S17] + discovered S7
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:44605
[S14] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S11] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S16] ⇄ pheromone p=1.000 → S15@127.0.0.1:44615
[S7] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S6] ⇄ pheromone p=1.000 → S4@127.0.0.1:44604
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S10] ⇄ pheromone p=1.000 → S9@127.0.0.1:44610
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S13] ⇄ pheromone p=1.000 → S14@127.0.0.1:44614
[S15] ⇄ pheromone p=1.000 → S8@127.0.0.1:44609
[S17] ⇄ pheromone p=1.000 → S16@127.0.0.1:44616
[S2] START round=1 head_norm_before_train=1.126762 (no previous merge yet)
[S2] round=1 local utility u=0.171108 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7756344027806644, 'loss_val': 1.3285866124474528, 'psi': 0.3953200411454058}-{'f1_val': 0.1417771333885667, 'auprc': 0.671993469857566, 'loss_val': 1.3598798578442095, 'psi': 0.3538636679761665}
[S3] START round=1 head_norm_before_train=1.149673 (no previous merge yet)
[S3] round=1 local utility u=0.435217 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9761055549890012, 'loss_val': 1.3288930453719208, 'psi': 0.47434626136406477}-{'f1_val': 0.13984006561410703, 'auprc': 0.6983596269541983, 'loss_val': 1.3660900302060692, 'psi': 0.3632478901501436}
[S4] START round=1 head_norm_before_train=1.213356 (no previous merge yet)
[S4] round=1 local utility u=0.342662 metrics={'f1_val': 0.16824471959213402, 'auprc': 0.7619971336236158, 'loss_val': 1.3527559903879531, 'psi': 0.40574568520472676}-{'f1_val': 0.05572213893053473, 'auprc': 0.7692788135817634, 'loss_val': 1.3847889793786816, 'psi': 0.34114480879102627}
[S5] START round=1 head_norm_before_train=1.169334 (no previous merge yet)
[S5] round=1 local utility u=0.003652 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7709443805274804, 'loss_val': 1.2908667382866583, 'psi': 0.393734895068135}-{'f1_val': 0.14226190476190476, 'auprc': 0.7822656783499665, 'loss_val': 1.3321346861889773, 'psi': 0.39826341419712946}
[S6] START round=1 head_norm_before_train=1.156304 (no previous merge yet)
[S6] round=1 local utility u=0.037777 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8333779275372762, 'loss_val': 1.3202850901137855, 'psi': 0.4182069402456797}-{'f1_val': 0.14142628205128205, 'auprc': 0.8182548182286681, 'loss_val': 1.3504691547544936, 'psi': 0.41215769652223644}
[S7] START round=1 head_norm_before_train=1.144720 (no previous merge yet)
[S7] round=1 local utility u=0.135079 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.6700738030094363, 'loss_val': 1.3289643167191327, 'psi': 0.35326361484122953}-{'f1_val': 0.14239871640593663, 'auprc': 0.590236750661919, 'loss_val': 1.3616615933151657, 'psi': 0.32153393010832965}
[S8] START round=1 head_norm_before_train=1.181316 (no previous merge yet)
[S8] round=1 local utility u=0.236085 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7709316316808607, 'loss_val': 1.3182026290970617, 'psi': 0.3923462421081186}-{'f1_val': 0.13995598239295717, 'auprc': 0.6228961464888891, 'loss_val': 1.3462669041408053, 'psi': 0.33313204803132995}
[S9] START round=1 head_norm_before_train=1.165684 (no previous merge yet)
[S9] round=1 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9996916511247836, 'loss_val': 1.302392845039959, 'psi': 0.4847154347339111}-{'f1_val': 0.4014082105837425, 'auprc': 0.9679665470090659, 'loss_val': 1.3493692436103484, 'psi': 0.6280315451538718}
[S10] START round=1 head_norm_before_train=1.206340 (no previous merge yet)
[S10] round=1 local utility u=0.527540 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7658860700601187, 'loss_val': 1.3323506258967277, 'psi': 0.38952741054908185}-{'f1_val': 0.05403440755997092, 'auprc': 0.5971224899333307, 'loss_val': 1.373615586196679, 'psi': 0.27126964050931485}
[S11] START round=1 head_norm_before_train=1.134131 (no previous merge yet)
[S11] round=1 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7231337673067492, 'loss_val': 1.3396448513323185, 'psi': 0.37350171694656603}-{'f1_val': 0.3563854884580592, 'auprc': 0.6444772125404308, 'loss_val': 1.371165827128796, 'psi': 0.4716221780910078}
[S13] START round=1 head_norm_before_train=1.147460 (no previous merge yet)
[S13] round=1 local utility u=0.090283 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6367629414028134, 'loss_val': 1.320571663268663, 'psi': 0.33893663410735725}-{'f1_val': 0.1403857625770531, 'auprc': 0.5891174026449907, 'loss_val': 1.3582016331937892, 'psi': 0.31987841860422817}
[S14] START round=1 head_norm_before_train=1.123773 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.531590365801769, 'loss_val': 1.3454530170501853, 'psi': 0.29685085805032985}-{'f1_val': 0.5366519345055263, 'auprc': 0.6134664205706857, 'loss_val': 1.3675929154539719, 'psi': 0.56737772893159}
[S15] START round=1 head_norm_before_train=1.218875 (no previous merge yet)
[S15] round=1 local utility u=1.000000 metrics={'f1_val': 0.4219089768608865, 'auprc': 0.5355693101950276, 'loss_val': 1.3527301393495657, 'psi': 0.467373110194543}-{'f1_val': 0.103651869669801, 'auprc': 0.19772055282978793, 'loss_val': 1.3824299727192177, 'psi': 0.14127934293379577}
[S16] START round=1 head_norm_before_train=1.184257 (no previous merge yet)
[S16] round=1 local utility u=0.143490 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.652195055489581, 'loss_val': 1.3295846422676427, 'psi': 0.3452604923153543}-{'f1_val': 0.14063745019920318, 'auprc': 0.5663375976517974, 'loss_val': 1.358991473053375, 'psi': 0.31091750918024086}
[S17] START round=1 head_norm_before_train=1.193098 (no previous merge yet)
[S17] round=1 local utility u=0.866671 metrics={'f1_val': 0.39066524832694083, 'auprc': 0.6280835532111373, 'loss_val': 1.34048194248795, 'psi': 0.4856325702806194}-{'f1_val': 0.09754189944134078, 'auprc': 0.6485956028880603, 'loss_val': 1.3766207575937546, 'psi': 0.3179633808200286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S5@127.0.0.1:44605
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S3] → sending delta(kind=head bytes=1789) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S4] → sending delta(kind=head bytes=1786) to S11@127.0.0.1:44612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S17@127.0.0.1:44617
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:44610
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S6] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1782 reason=None
[S5] → sending delta(kind=head bytes=1782) to S8@127.0.0.1:44609
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:44608
[S5] sending update (kind=head size=1782 to 1 peers)
[S3] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S4] sending update (kind=head size=1786 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=-0.0059
[S5] DROPPED delta from S10 (cos=-0.0059 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1782) from S5
[S8] cosine check vs S5: cos=-0.0432
[S8] DROPPED delta from S5 (cos=-0.0432 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1792) from S13
[S7] cosine check vs S13: cos=-0.0508
[S7] DROPPED delta from S13 (cos=-0.0508 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S8
[S16] cosine check vs S8: cos=-0.0312
[S16] DROPPED delta from S8 (cos=-0.0312 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1796) from S15
[S8] cosine check vs S15: cos=0.0647
[S17] RECEIVED delta(kind=head bytes=1789) from S16
[S17] cosine check vs S16: cos=0.0319
[S5] RECEIVED delta(kind=head bytes=1788) from S2
[S5] cosine check vs S2: cos=0.0757
[S11] RECEIVED delta(kind=head bytes=1786) from S4
[S11] cosine check vs S4: cos=0.0024
[S8] RECEIVED delta(kind=head bytes=1789) from S6
[S8] cosine check vs S6: cos=0.0514
[S5] RECEIVED delta(kind=head bytes=1789) from S3
[S5] cosine check vs S3: cos=-0.0586
[S5] DROPPED delta from S3 (cos=-0.0586 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1791) from S7
[S9] cosine check vs S7: cos=0.0195
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S17] → sending delta(kind=head bytes=1787) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1787 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1787) from S17
[S16] cosine check vs S17: cos=0.0319
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.180165
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.164595e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1552 head_norm=0.832503 delta_norm=0.816460
[S9] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.148508
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.358960e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.837872 delta_norm=0.835896
[S11] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=1 metric=0.1400 head_norm=1.198315
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.097837e-01
[S8] stored merged vector for next round verification (round=1)
[S8] DEBUG after merge:  round=1 metric=0.1400 head_norm=0.766416 delta_norm=0.709784
[S8] aggregate: ACCEPT kept=['S15', 'S6'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=1 metric=0.1406 head_norm=1.202382
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.394246e-01
[S16] stored merged vector for next round verification (round=1)
[S16] DEBUG after merge:  round=1 metric=0.1039 head_norm=0.866674 delta_norm=0.839425
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=1 metric=0.1423 head_norm=1.187266
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.911779e-01
[S5] stored merged vector for next round verification (round=1)
[S5] DEBUG after merge:  round=1 metric=0.1423 head_norm=0.853456 delta_norm=0.791178
[S5] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.3907 head_norm=1.210699
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.394246e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1203 head_norm=0.866674 delta_norm=0.839425
[S17] aggregate: ROLLBACK (f1_val pre=0.391 post=0.120 tol_abs=0.005 tol_rel=0.0)
[S2] START round=2 head_norm_before_train=1.139779 (no previous merge yet)
[S2] round=2 local utility u=0.003723 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7646753192006327, 'loss_val': 1.2882636808535881, 'psi': 0.39093640771339316}-{'f1_val': 0.1417771333885667, 'auprc': 0.7756344027806644, 'loss_val': 1.3285866124474528, 'psi': 0.3953200411454058}
[S3] START round=2 head_norm_before_train=1.159297 (no previous merge yet)
[S3] round=2 local utility u=0.018406 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9758557501480316, 'loss_val': 1.2913325511457043, 'psi': 0.4742463394276769}-{'f1_val': 0.13984006561410703, 'auprc': 0.9761055549890012, 'loss_val': 1.3288930453719208, 'psi': 0.47434626136406477}
[S4] START round=2 head_norm_before_train=1.217551 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7511833630595277, 'loss_val': 1.3179119692333487, 'psi': 0.38460932256092156}-{'f1_val': 0.16824471959213402, 'auprc': 0.7619971336236158, 'loss_val': 1.3527559903879531, 'psi': 0.40574568520472676}
[S5] START round=2 head_norm_before_train=0.853456 cos_to_last_merge=1.0000 (last merge round=1)
[S5] round=2 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700316118387538, 'loss_val': 1.2886770201171764, 'psi': 0.3933697875926444}-{'f1_val': 0.14226190476190476, 'auprc': 0.7709443805274804, 'loss_val': 1.2908667382866583, 'psi': 0.393734895068135}
[S6] START round=2 head_norm_before_train=1.171125 (no previous merge yet)
[S6] round=2 local utility u=0.017584 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.833734980380173, 'loss_val': 1.2861874746168303, 'psi': 0.4183497613828384}-{'f1_val': 0.14142628205128205, 'auprc': 0.8333779275372762, 'loss_val': 1.3202850901137855, 'psi': 0.4182069402456797}
[S7] START round=2 head_norm_before_train=1.151757 (no previous merge yet)
[S7] round=2 local utility u=0.067747 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7056065313985617, 'loss_val': 1.30006841113675, 'psi': 0.36747670619687967}-{'f1_val': 0.14205682272909165, 'auprc': 0.6700738030094363, 'loss_val': 1.3289643167191327, 'psi': 0.35326361484122953}
[S8] START round=2 head_norm_before_train=0.766416 cos_to_last_merge=1.0000 (last merge round=1)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7707238221313442, 'loss_val': 1.323689280829007, 'psi': 0.392263118288312}-{'f1_val': 0.13995598239295717, 'auprc': 0.7709316316808607, 'loss_val': 1.3182026290970617, 'psi': 0.3923462421081186}
[S9] START round=2 head_norm_before_train=0.832503 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658145447780051, 'loss_val': 1.3051804394206585, 'psi': 0.4311645921951997}-{'f1_val': 0.141397957139996, 'auprc': 0.9996916511247836, 'loss_val': 1.302392845039959, 'psi': 0.4847154347339111}
[S10] START round=2 head_norm_before_train=1.217655 (no previous merge yet)
[S10] round=2 local utility u=0.039139 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7748821062771554, 'loss_val': 1.2810606284214265, 'psi': 0.39312582503589655}-{'f1_val': 0.13862163754172394, 'auprc': 0.7658860700601187, 'loss_val': 1.3323506258967277, 'psi': 0.38952741054908185}
[S11] START round=2 head_norm_before_train=0.837872 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.014596 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7329404440212364, 'loss_val': 1.3398728653602539, 'psi': 0.3774243876323609}-{'f1_val': 0.14041368337311058, 'auprc': 0.7231337673067492, 'loss_val': 1.3396448513323185, 'psi': 0.37350171694656603}
[S13] START round=2 head_norm_before_train=1.162364 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5881366753042265, 'loss_val': 1.277077798378214, 'psi': 0.3194861276679225}-{'f1_val': 0.1403857625770531, 'auprc': 0.6367629414028134, 'loss_val': 1.320571663268663, 'psi': 0.33893663410735725}
[S14] START round=2 head_norm_before_train=1.136147 (no previous merge yet)
[S14] round=2 local utility u=0.029382 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.543164313020313, 'loss_val': 1.3214118048457701, 'psi': 0.30148043693774745}-{'f1_val': 0.14035785288270378, 'auprc': 0.531590365801769, 'loss_val': 1.3454530170501853, 'psi': 0.29685085805032985}
[S15] START round=2 head_norm_before_train=1.226540 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.743405017178691, 'loss_val': 1.3271011968737132, 'psi': 0.3812021976884114}-{'f1_val': 0.4219089768608865, 'auprc': 0.5355693101950276, 'loss_val': 1.3527301393495657, 'psi': 0.467373110194543}
[S16] START round=2 head_norm_before_train=0.866674 cos_to_last_merge=1.0000 (last merge round=1)
[S16] round=2 local utility u=0.000000 metrics={'f1_val': 0.10386473429951691, 'auprc': 0.6682368517180588, 'loss_val': 1.339044441014846, 'psi': 0.3296135812669337}-{'f1_val': 0.14063745019920318, 'auprc': 0.652195055489581, 'loss_val': 1.3295846422676427, 'psi': 0.3452604923153543}
[S17] START round=2 head_norm_before_train=0.866674 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.3920824669297259, 'auprc': 0.6173916442436668, 'loss_val': 1.3349335062642462, 'psi': 0.48220613785530225}-{'f1_val': 0.39066524832694083, 'auprc': 0.6280835532111373, 'loss_val': 1.34048194248795, 'psi': 0.4856325702806194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S2] → sending delta(kind=head bytes=1786) to S16@127.0.0.1:44616
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S7] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:44611
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:44611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:44605
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S14] → sending delta(kind=head bytes=1787) to S3@127.0.0.1:44603
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1787 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1786 to 1 peers)
[S7] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S3] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S10
[S5] cosine check vs S10: cos=-0.0516
[S5] DROPPED delta from S10 (cos=-0.0516 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1791) from S6
[S5] cosine check vs S6: cos=-0.0044
[S5] DROPPED delta from S6 (cos=-0.0044 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1787) from S14
[S3] cosine check vs S14: cos=-0.0690
[S3] DROPPED delta from S14 (cos=-0.0690 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] cosine check vs S11: cos=-0.0057
[S14] DROPPED delta from S11 (cos=-0.0057 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1791) from S7
[S10] cosine check vs S7: cos=0.0381
[S10] RECEIVED delta(kind=head bytes=1793) from S3
[S10] cosine check vs S3: cos=-0.0320
[S10] DROPPED delta from S3 (cos=-0.0320 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1786) from S2
[S16] cosine check vs S2: cos=0.0761
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.239415
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.343142e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.866678 delta_norm=0.834314
[S10] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1039 head_norm=0.887742
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.037939e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1486 head_norm=0.757500 delta_norm=0.703794
[S16] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.161972 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7442963024232974, 'loss_val': 1.2338149808473793, 'psi': 0.382784801002459}-{'f1_val': 0.1417771333885667, 'auprc': 0.7646753192006327, 'loss_val': 1.2882636808535881, 'psi': 0.39093640771339316}
[S3] START round=3 head_norm_before_train=1.178695 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.791403051024546, 'loss_val': 1.257636888659862, 'psi': 0.4004652597782826}-{'f1_val': 0.13984006561410703, 'auprc': 0.9758557501480316, 'loss_val': 1.2913325511457043, 'psi': 0.4742463394276769}
[S4] START round=3 head_norm_before_train=1.233512 (no previous merge yet)
[S4] round=3 local utility u=0.041760 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7630939523541296, 'loss_val': 1.270124637085856, 'psi': 0.38937355827876236}-{'f1_val': 0.14022662889518414, 'auprc': 0.7511833630595277, 'loss_val': 1.3179119692333487, 'psi': 0.38460932256092156}
[S5] START round=3 head_norm_before_train=0.871910 cos_to_last_merge=0.9972 (last merge round=1)
[S5] round=3 local utility u=0.025693 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7701144997669662, 'loss_val': 1.2375400220076975, 'psi': 0.39340294276392934}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700316118387538, 'loss_val': 1.2886770201171764, 'psi': 0.3933697875926444}
[S6] START round=3 head_norm_before_train=1.194249 (no previous merge yet)
[S6] round=3 local utility u=0.020144 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8339019503940645, 'loss_val': 1.2464006498683273, 'psi': 0.418416549388395}-{'f1_val': 0.14142628205128205, 'auprc': 0.833734980380173, 'loss_val': 1.2861874746168303, 'psi': 0.4183497613828384}
[S7] START round=3 head_norm_before_train=1.165449 (no previous merge yet)
[S7] round=3 local utility u=0.138850 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7885308506184433, 'loss_val': 1.2711416013882602, 'psi': 0.40064643388483234}-{'f1_val': 0.14205682272909165, 'auprc': 0.7056065313985617, 'loss_val': 1.30006841113675, 'psi': 0.36747670619687967}
[S8] START round=3 head_norm_before_train=0.789658 cos_to_last_merge=0.9961 (last merge round=1)
[S8] round=3 local utility u=0.009735 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.76760932647823, 'loss_val': 1.2948766163204501, 'psi': 0.39101732002706635}-{'f1_val': 0.13995598239295717, 'auprc': 0.7707238221313442, 'loss_val': 1.323689280829007, 'psi': 0.392263118288312}
[S9] START round=3 head_norm_before_train=0.852078 cos_to_last_merge=0.9968 (last merge round=1)
[S9] round=3 local utility u=0.033224 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8658708888948763, 'loss_val': 1.2389010374930225, 'psi': 0.4311871298419481}-{'f1_val': 0.141397957139996, 'auprc': 0.8658145447780051, 'loss_val': 1.3051804394206585, 'psi': 0.4311645921951997}
[S10] START round=3 head_norm_before_train=0.866678 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6052587759396173, 'loss_val': 1.277497821044807, 'psi': 0.3252764929008813}-{'f1_val': 0.13862163754172394, 'auprc': 0.7748821062771554, 'loss_val': 1.2810606284214265, 'psi': 0.39312582503589655}
[S11] START round=3 head_norm_before_train=0.853943 cos_to_last_merge=0.9965 (last merge round=1)
[S11] round=3 local utility u=0.072078 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7658338549014719, 'loss_val': 1.294397113111001, 'psi': 0.39058175198445516}-{'f1_val': 0.14041368337311058, 'auprc': 0.7329404440212364, 'loss_val': 1.3398728653602539, 'psi': 0.3774243876323609}
[S13] START round=3 head_norm_before_train=1.186830 (no previous merge yet)
[S13] round=3 local utility u=0.809002 metrics={'f1_val': 0.3986614932782816, 'auprc': 0.5910089313577133, 'loss_val': 1.2173455371556843, 'psi': 0.4756004685100542}-{'f1_val': 0.1403857625770531, 'auprc': 0.5881366753042265, 'loss_val': 1.277077798378214, 'psi': 0.3194861276679225}
[S14] START round=3 head_norm_before_train=1.157987 (no previous merge yet)
[S14] round=3 local utility u=0.323982 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7502957539436247, 'loss_val': 1.2948428412284487, 'psi': 0.38433301330707215}-{'f1_val': 0.14035785288270378, 'auprc': 0.543164313020313, 'loss_val': 1.3214118048457701, 'psi': 0.30148043693774745}
[S15] START round=3 head_norm_before_train=1.236815 (no previous merge yet)
[S15] round=3 local utility u=0.045107 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7622018699238053, 'loss_val': 1.2932772151489842, 'psi': 0.38872093878645714}-{'f1_val': 0.13973365136155833, 'auprc': 0.743405017178691, 'loss_val': 1.3271011968737132, 'psi': 0.3812021976884114}
[S16] START round=3 head_norm_before_train=0.757500 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.069577 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6356405701845457, 'loss_val': 1.3227369210370323, 'psi': 0.33863869819334014}-{'f1_val': 0.10386473429951691, 'auprc': 0.6682368517180588, 'loss_val': 1.339044441014846, 'psi': 0.3296135812669337}
[S17] START round=3 head_norm_before_train=0.883541 cos_to_last_merge=0.9961 (last merge round=1)
[S17] round=3 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5935920264766466, 'loss_val': 1.2816829672990613, 'psi': 0.32200618858108926}-{'f1_val': 0.3920824669297259, 'auprc': 0.6173916442436668, 'loss_val': 1.3349335062642462, 'psi': 0.48220613785530225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:44609
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] → sending delta(kind=head bytes=1790) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1783 reason=None
[S4] → sending delta(kind=head bytes=1783) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S13] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44614
[S11] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1792 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S4] sending update (kind=head size=1783 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1789 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1789) from S15
[S8] cosine check vs S15: cos=0.4413
[S14] RECEIVED delta(kind=head bytes=1802) from S9
[S14] cosine check vs S9: cos=0.0730
[S16] RECEIVED delta(kind=head bytes=1790) from S11
[S16] cosine check vs S11: cos=-0.0084
[S16] DROPPED delta from S11 (cos=-0.0084 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S8
[S4] cosine check vs S8: cos=-0.0276
[S4] DROPPED delta from S8 (cos=-0.0276 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1798) from S16
[S15] cosine check vs S16: cos=-0.1195
[S15] DROPPED delta from S16 (cos=-0.1195 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.0099
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=-0.0151
[S4] DROPPED delta from S6 (cos=-0.0151 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=-0.0285
[S15] DROPPED delta from S14 (cos=-0.0285 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=0.0542
[S14] RECEIVED delta(kind=head bytes=1792) from S13
[S14] cosine check vs S13: cos=0.0059
[S5] RECEIVED delta(kind=head bytes=1783) from S4
[S5] cosine check vs S4: cos=-0.1126
[S5] DROPPED delta from S4 (cos=-0.1126 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1414 head_norm=0.882557
[S9] _apply_head_vector_avg (torch): Δ‖w‖=6.121901e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.646347 delta_norm=0.612190
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=3 metric=0.1400 head_norm=0.823946
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.797200e-01
[S8] stored merged vector for next round verification (round=3)
[S8] DEBUG after merge:  round=3 metric=0.1400 head_norm=0.890501 delta_norm=0.579720
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.184438
[S14] _apply_head_vector_avg (torch): Δ‖w‖=6.831354e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.713498 delta_norm=0.683135
[S14] aggregate: ACCEPT kept=['S9', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=3 metric=0.1406 head_norm=0.776748
[S16] _apply_head_vector_avg (torch): Δ‖w‖=7.046713e-01
[S16] stored merged vector for next round verification (round=3)
[S16] DEBUG after merge:  round=3 metric=0.1043 head_norm=0.711088 delta_norm=0.704671
[S16] aggregate: ROLLBACK (f1_val pre=0.141 post=0.104 tol_abs=0.005 tol_rel=0.0)
[S2] START round=4 head_norm_before_train=1.192356 (no previous merge yet)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.635250299622843, 'loss_val': 1.184047093606301, 'psi': 0.33916639988227726}-{'f1_val': 0.1417771333885667, 'auprc': 0.7442963024232974, 'loss_val': 1.2338149808473793, 'psi': 0.382784801002459}
[S3] START round=4 head_norm_before_train=1.204848 (no previous merge yet)
[S3] round=4 local utility u=0.045062 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.811083676246084, 'loss_val': 1.2265546675953525, 'psi': 0.4083375098668979}-{'f1_val': 0.13984006561410703, 'auprc': 0.791403051024546, 'loss_val': 1.257636888659862, 'psi': 0.4004652597782826}
[S4] START round=4 head_norm_before_train=1.259342 (no previous merge yet)
[S4] round=4 local utility u=0.039245 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7643273831262316, 'loss_val': 1.1953349434248965, 'psi': 0.38986693058760313}-{'f1_val': 0.14022662889518414, 'auprc': 0.7630939523541296, 'loss_val': 1.270124637085856, 'psi': 0.38937355827876236}
[S5] START round=4 head_norm_before_train=0.897874 cos_to_last_merge=0.9901 (last merge round=1)
[S5] round=4 local utility u=0.035029 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7711024098228318, 'loss_val': 1.1704452355181576, 'psi': 0.39379810678627564}-{'f1_val': 0.14226190476190476, 'auprc': 0.7701144997669662, 'loss_val': 1.2375400220076975, 'psi': 0.39340294276392934}
[S6] START round=4 head_norm_before_train=1.224989 (no previous merge yet)
[S6] round=4 local utility u=0.019943 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8339500661067403, 'loss_val': 1.206658673369984, 'psi': 0.41843579567346534}-{'f1_val': 0.14142628205128205, 'auprc': 0.8339019503940645, 'loss_val': 1.2464006498683273, 'psi': 0.418416549388395}
[S7] START round=4 head_norm_before_train=1.183671 (no previous merge yet)
[S7] round=4 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7776559130682074, 'loss_val': 1.2445258038198137, 'psi': 0.39629645886473797}-{'f1_val': 0.14205682272909165, 'auprc': 0.7885308506184433, 'loss_val': 1.2711416013882602, 'psi': 0.40064643388483234}
[S8] START round=4 head_norm_before_train=0.890501 cos_to_last_merge=1.0000 (last merge round=3)
[S8] round=4 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7581437791298953, 'loss_val': 1.2870839024302914, 'psi': 0.38723110108773245}-{'f1_val': 0.13995598239295717, 'auprc': 0.76760932647823, 'loss_val': 1.2948766163204501, 'psi': 0.39101732002706635}
[S9] START round=4 head_norm_before_train=0.646347 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=0.001759 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656707412984793, 'loss_val': 1.2347831130630402, 'psi': 0.43110707080338934}-{'f1_val': 0.141397957139996, 'auprc': 0.8658708888948763, 'loss_val': 1.2389010374930225, 'psi': 0.4311871298419481}
[S10] START round=4 head_norm_before_train=0.894173 cos_to_last_merge=0.9970 (last merge round=2)
[S10] round=4 local utility u=0.011512 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5927981105467642, 'loss_val': 1.2170916720574383, 'psi': 0.32029222674374}-{'f1_val': 0.13862163754172394, 'auprc': 0.6052587759396173, 'loss_val': 1.277497821044807, 'psi': 0.3252764929008813}
[S11] START round=4 head_norm_before_train=0.880304 cos_to_last_merge=0.9866 (last merge round=1)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6840510156482412, 'loss_val': 1.2358163354719527, 'psi': 0.35786861628316285}-{'f1_val': 0.14041368337311058, 'auprc': 0.7658338549014719, 'loss_val': 1.294397113111001, 'psi': 0.39058175198445516}
[S13] START round=4 head_norm_before_train=1.217509 (no previous merge yet)
[S13] round=4 local utility u=0.101851 metrics={'f1_val': 0.4164711099175653, 'auprc': 0.5931546902053892, 'loss_val': 1.1269381524643678, 'psi': 0.48714454203269486}-{'f1_val': 0.3986614932782816, 'auprc': 0.5910089313577133, 'loss_val': 1.2173455371556843, 'psi': 0.4756004685100542}
[S14] START round=4 head_norm_before_train=0.713498 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7151440208703461, 'loss_val': 1.307564297955004, 'psi': 0.37027232007776073}-{'f1_val': 0.14035785288270378, 'auprc': 0.7502957539436247, 'loss_val': 1.2948428412284487, 'psi': 0.38433301330707215}
[S15] START round=4 head_norm_before_train=1.256681 (no previous merge yet)
[S15] round=4 local utility u=0.029705 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7680776463884568, 'loss_val': 1.2514949251122902, 'psi': 0.39107124937231774}-{'f1_val': 0.13973365136155833, 'auprc': 0.7622018699238053, 'loss_val': 1.2932772151489842, 'psi': 0.38872093878645714}
[S16] START round=4 head_norm_before_train=0.711088 cos_to_last_merge=1.0000 (last merge round=3)
[S16] round=4 local utility u=0.537111 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9925562063040705, 'loss_val': 1.3192609263817034, 'psi': 0.48140495264115013}-{'f1_val': 0.14063745019920318, 'auprc': 0.6356405701845457, 'loss_val': 1.3227369210370323, 'psi': 0.33863869819334014}
[S17] START round=4 head_norm_before_train=0.910583 cos_to_last_merge=0.9854 (last merge round=1)
[S17] round=4 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5602670044893874, 'loss_val': 1.2021008005190241, 'psi': 0.30867617978618556}-{'f1_val': 0.14094896331738438, 'auprc': 0.5935920264766466, 'loss_val': 1.2816829672990613, 'psi': 0.32200618858108926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44609
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:44614
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S15@127.0.0.1:44615
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] sending update (kind=head size=1791 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S4
[S5] cosine check vs S4: cos=-0.1136
[S5] DROPPED delta from S4 (cos=-0.1136 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S13
[S14] cosine check vs S13: cos=0.4070
[S14] RECEIVED delta(kind=head bytes=1799) from S9
[S14] cosine check vs S9: cos=0.3298
[S14] RECEIVED delta(kind=head bytes=1792) from S3
[S14] cosine check vs S3: cos=-0.0747
[S14] DROPPED delta from S3 (cos=-0.0747 < 0.0)
[S16] sending update (kind=head size=1799 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1799) from S16
[S15] cosine check vs S16: cos=-0.0103
[S15] DROPPED delta from S16 (cos=-0.0103 < 0.0)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S10
[S9] cosine check vs S10: cos=0.2491
[S4] RECEIVED delta(kind=head bytes=1793) from S6
[S4] cosine check vs S6: cos=-0.0158
[S4] DROPPED delta from S6 (cos=-0.0158 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.7063
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] cosine check vs S15: cos=0.8910
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.1414 head_norm=0.678193
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.638871e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.608713 delta_norm=0.263887
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=4 metric=0.1400 head_norm=0.912808
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.126296e-01
[S8] stored merged vector for next round verification (round=4)
[S8] DEBUG after merge:  round=4 metric=0.1723 head_norm=1.067770 delta_norm=0.312630
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.742165
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.452557e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.625838 delta_norm=0.345256
[S14] aggregate: ACCEPT kept=['S13', 'S9'] (k=2/2) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=1.225881 (no previous merge yet)
[S2] round=5 local utility u=0.199149 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7441330356603829, 'loss_val': 1.1123978074906362, 'psi': 0.38271949429729324}-{'f1_val': 0.1417771333885667, 'auprc': 0.635250299622843, 'loss_val': 1.184047093606301, 'psi': 0.33916639988227726}
[S3] START round=5 head_norm_before_train=1.231787 (no previous merge yet)
[S3] round=5 local utility u=0.310957 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9983354324771588, 'loss_val': 1.166396306523552, 'psi': 0.48323821235932773}-{'f1_val': 0.13984006561410703, 'auprc': 0.811083676246084, 'loss_val': 1.2265546675953525, 'psi': 0.4083375098668979}
[S4] START round=5 head_norm_before_train=1.296207 (no previous merge yet)
[S4] round=5 local utility u=0.085915 metrics={'f1_val': 0.149634009009009, 'auprc': 0.7655460264465505, 'loss_val': 1.0836054048214574, 'psi': 0.3959988159840256}-{'f1_val': 0.14022662889518414, 'auprc': 0.7643273831262316, 'loss_val': 1.1953349434248965, 'psi': 0.38986693058760313}
[S5] START round=5 head_norm_before_train=0.930504 cos_to_last_merge=0.9801 (last merge round=1)
[S5] round=5 local utility u=0.874818 metrics={'f1_val': 0.41694544507090897, 'auprc': 0.777788535468715, 'loss_val': 1.0889684590792985, 'psi': 0.5612826812300313}-{'f1_val': 0.14226190476190476, 'auprc': 0.7711024098228318, 'loss_val': 1.1704452355181576, 'psi': 0.39379810678627564}
[S6] START round=5 head_norm_before_train=1.252171 (no previous merge yet)
[S6] round=5 local utility u=0.855090 metrics={'f1_val': 0.4150420236907487, 'auprc': 0.8338102891138935, 'loss_val': 1.1377532313065495, 'psi': 0.5825493298600066}-{'f1_val': 0.14142628205128205, 'auprc': 0.8339500661067403, 'loss_val': 1.206658673369984, 'psi': 0.41843579567346534}
[S7] START round=5 head_norm_before_train=1.207852 (no previous merge yet)
[S7] round=5 local utility u=0.015101 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7777080281736681, 'loss_val': 1.2144806962301076, 'psi': 0.39631730490692224}-{'f1_val': 0.14205682272909165, 'auprc': 0.7776559130682074, 'loss_val': 1.2445258038198137, 'psi': 0.39629645886473797}
[S8] START round=5 head_norm_before_train=1.067770 cos_to_last_merge=1.0000 (last merge round=4)
[S8] round=5 local utility u=0.012867 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.753595482830923, 'loss_val': 1.2477050855424767, 'psi': 0.38541178256814357}-{'f1_val': 0.13995598239295717, 'auprc': 0.7581437791298953, 'loss_val': 1.2870839024302914, 'psi': 0.38723110108773245}
[S9] START round=5 head_norm_before_train=0.608713 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865598758342518, 'loss_val': 1.241225132504706, 'psi': 0.4310782776210048}-{'f1_val': 0.141397957139996, 'auprc': 0.8656707412984793, 'loss_val': 1.2347831130630402, 'psi': 0.43110707080338934}
[S10] START round=5 head_norm_before_train=0.923777 cos_to_last_merge=0.9908 (last merge round=2)
[S10] round=5 local utility u=0.038150 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.5885273621521484, 'loss_val': 1.1279803063586424, 'psi': 0.3185839273858937}-{'f1_val': 0.13862163754172394, 'auprc': 0.5927981105467642, 'loss_val': 1.2170916720574383, 'psi': 0.32029222674374}
[S11] START round=5 head_norm_before_train=0.914881 cos_to_last_merge=0.9724 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6222988550338346, 'loss_val': 1.1816506522784933, 'psi': 0.33316775203740023}-{'f1_val': 0.14041368337311058, 'auprc': 0.6840510156482412, 'loss_val': 1.2358163354719527, 'psi': 0.35786861628316285}
[S13] START round=5 head_norm_before_train=1.254510 (no previous merge yet)
[S13] round=5 local utility u=0.133569 metrics={'f1_val': 0.41643344272875704, 'auprc': 0.6378846010231982, 'loss_val': 0.9937629521856436, 'psi': 0.5050139060465335}-{'f1_val': 0.4164711099175653, 'auprc': 0.5931546902053892, 'loss_val': 1.1269381524643678, 'psi': 0.48714454203269486}
[S14] START round=5 head_norm_before_train=0.625838 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.020707 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7263524456463738, 'loss_val': 1.2997760849575581, 'psi': 0.37475568998817177}-{'f1_val': 0.14035785288270378, 'auprc': 0.7151440208703461, 'loss_val': 1.307564297955004, 'psi': 0.37027232007776073}
[S15] START round=5 head_norm_before_train=1.281610 (no previous merge yet)
[S15] round=5 local utility u=0.028019 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7666232361974735, 'loss_val': 1.1910937597207085, 'psi': 0.3904894852959244}-{'f1_val': 0.13973365136155833, 'auprc': 0.7680776463884568, 'loss_val': 1.2514949251122902, 'psi': 0.39107124937231774}
[S16] START round=5 head_norm_before_train=0.722229 cos_to_last_merge=0.9958 (last merge round=3)
[S16] round=5 local utility u=0.027041 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9939538554504825, 'loss_val': 1.2693725335380348, 'psi': 0.481964012299715}-{'f1_val': 0.14063745019920318, 'auprc': 0.9925562063040705, 'loss_val': 1.3192609263817034, 'psi': 0.48140495264115013}
[S17] START round=5 head_norm_before_train=0.942088 cos_to_last_merge=0.9706 (last merge round=1)
[S17] round=5 local utility u=0.077496 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5719431698576303, 'loss_val': 1.082136991565741, 'psi': 0.3133466459334827}-{'f1_val': 0.14094896331738438, 'auprc': 0.5602670044893874, 'loss_val': 1.2021008005190241, 'psi': 0.30867617978618556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:44615
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S6] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S9@127.0.0.1:44610
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1789 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1790 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=0.4294
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.7859
[S4] RECEIVED delta(kind=head bytes=1796) from S8
[S4] cosine check vs S8: cos=-0.0265
[S4] DROPPED delta from S8 (cos=-0.0265 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=-0.1153
[S5] DROPPED delta from S4 (cos=-0.1153 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1790) from S6
[S4] cosine check vs S6: cos=-0.0181
[S4] DROPPED delta from S6 (cos=-0.0181 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1791) from S15
[S8] cosine check vs S15: cos=0.9690
[S15] RECEIVED delta(kind=head bytes=1794) from S14
[S15] cosine check vs S14: cos=0.0657
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=-0.0747
[S14] DROPPED delta from S3 (cos=-0.0747 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S13
[S14] cosine check vs S13: cos=0.6907
[S15] RECEIVED delta(kind=head bytes=1789) from S16
[S15] cosine check vs S16: cos=-0.0158
[S15] DROPPED delta from S16 (cos=-0.0158 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1790) from S10
[S9] cosine check vs S10: cos=0.4827
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.7435
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.4295
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.1414 head_norm=0.635584
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.643139e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.632616 delta_norm=0.164314
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.332 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=0.338 → S16@127.0.0.1:44616
[S4] ⇄ pheromone p=0.385 → S5@127.0.0.1:44605
[S2] ⇄ pheromone p=0.382 → S16@127.0.0.1:44616
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=5 metric=0.1397 head_norm=1.308816
[S15] _apply_head_vector_avg (torch): Δ‖w‖=7.118981e-01
[S15] stored merged vector for next round verification (round=5)
[S15] DEBUG after merge:  round=5 metric=0.1397 head_norm=0.750335 delta_norm=0.711898
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.426 → S8@127.0.0.1:44609
[S3] ⇄ pheromone p=0.435 → S14@127.0.0.1:44614
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.653150
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.810109e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.901647 delta_norm=0.481011
[S14] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.376 → S15@127.0.0.1:44615
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=5 metric=0.1406 head_norm=0.744276
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.632821e-01
[S16] stored merged vector for next round verification (round=5)
[S16] DEBUG after merge:  round=5 metric=0.1406 head_norm=0.696391 delta_norm=0.163282
[S16] aggregate: ACCEPT kept=['S2', 'S7', 'S17'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.440 → S15@127.0.0.1:44615
[S7] ⇄ pheromone p=0.366 → S16@127.0.0.1:44616
[S10] ⇄ pheromone p=0.384 → S9@127.0.0.1:44610
[S6] ⇄ pheromone p=0.509 → S4@127.0.0.1:44604
[S5] ⇄ pheromone p=0.512 → S9@127.0.0.1:44610
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=5 metric=0.1400 head_norm=1.086088
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.856180e-01
[S8] stored merged vector for next round verification (round=5)
[S8] DEBUG after merge:  round=5 metric=0.2042 head_norm=1.188208 delta_norm=0.185618
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.351 → S4@127.0.0.1:44604
[S13] ⇄ pheromone p=0.482 → S14@127.0.0.1:44614
[S17] ⇄ pheromone p=0.414 → S16@127.0.0.1:44616
[S2] START round=6 head_norm_before_train=1.247302 (no previous merge yet)
[S2] round=6 local utility u=0.876704 metrics={'f1_val': 0.4094537671937748, 'auprc': 0.7562937188544088, 'loss_val': 1.0015309127662129, 'psi': 0.5481897478580284}-{'f1_val': 0.1417771333885667, 'auprc': 0.7441330356603829, 'loss_val': 1.1123978074906362, 'psi': 0.38271949429729324}
[S3] START round=6 head_norm_before_train=1.252696 (no previous merge yet)
[S3] round=6 local utility u=0.044688 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9981446562855738, 'loss_val': 1.0764487113575714, 'psi': 0.4831619018826938}-{'f1_val': 0.13984006561410703, 'auprc': 0.9983354324771588, 'loss_val': 1.166396306523552, 'psi': 0.48323821235932773}
[S4] START round=6 head_norm_before_train=1.339225 (no previous merge yet)
[S4] round=6 local utility u=0.877827 metrics={'f1_val': 0.4254729469096524, 'auprc': 0.7493276869109503, 'loss_val': 0.934330578182054, 'psi': 0.5550148429101716}-{'f1_val': 0.149634009009009, 'auprc': 0.7655460264465505, 'loss_val': 1.0836054048214574, 'psi': 0.3959988159840256}
[S5] START round=6 head_norm_before_train=0.957667 cos_to_last_merge=0.9715 (last merge round=1)
[S5] round=6 local utility u=0.053817 metrics={'f1_val': 0.4179091272005397, 'auprc': 0.7775608468234563, 'loss_val': 0.9864328876091458, 'psi': 0.5617698150497064}-{'f1_val': 0.41694544507090897, 'auprc': 0.777788535468715, 'loss_val': 1.0889684590792985, 'psi': 0.5612826812300313}
[S6] START round=6 head_norm_before_train=1.280116 (no previous merge yet)
[S6] round=6 local utility u=0.086505 metrics={'f1_val': 0.41705570454086727, 'auprc': 0.8397212413496704, 'loss_val': 0.9945572221944895, 'psi': 0.5861219192643885}-{'f1_val': 0.4150420236907487, 'auprc': 0.8338102891138935, 'loss_val': 1.1377532313065495, 'psi': 0.5825493298600066}
[S7] START round=6 head_norm_before_train=1.227098 (no previous merge yet)
[S7] round=6 local utility u=0.000000 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7558645709397874, 'loss_val': 1.1616927133977202, 'psi': 0.38757992201337}-{'f1_val': 0.14205682272909165, 'auprc': 0.7777080281736681, 'loss_val': 1.2144806962301076, 'psi': 0.39631730490692224}
[S8] START round=6 head_norm_before_train=1.188208 cos_to_last_merge=1.0000 (last merge round=5)
[S8] round=6 local utility u=0.874315 metrics={'f1_val': 0.41549694000722615, 'auprc': 0.7666293664196371, 'loss_val': 1.191422892162827, 'psi': 0.5559499105721906}-{'f1_val': 0.13995598239295717, 'auprc': 0.753595482830923, 'loss_val': 1.2477050855424767, 'psi': 0.38541178256814357}
[S9] START round=6 head_norm_before_train=0.632616 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.025554 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8653648379590402, 'loss_val': 1.1894156199154642, 'psi': 0.4309847094676137}-{'f1_val': 0.141397957139996, 'auprc': 0.865598758342518, 'loss_val': 1.241225132504706, 'psi': 0.4310782776210048}
[S10] START round=6 head_norm_before_train=0.957642 cos_to_last_merge=0.9821 (last merge round=2)
[S10] round=6 local utility u=0.931857 metrics={'f1_val': 0.41694859683592245, 'auprc': 0.6027522220110059, 'loss_val': 0.976902306592393, 'psi': 0.49127004690595577}-{'f1_val': 0.13862163754172394, 'auprc': 0.5885273621521484, 'loss_val': 1.1279803063586424, 'psi': 0.3185839273858937}
[S11] START round=6 head_norm_before_train=0.949390 cos_to_last_merge=0.9585 (last merge round=1)
[S11] round=6 local utility u=1.000000 metrics={'f1_val': 0.42273739039721175, 'auprc': 0.8138788652289213, 'loss_val': 1.0979494381697505, 'psi': 0.5791939803298956}-{'f1_val': 0.14041368337311058, 'auprc': 0.6222988550338346, 'loss_val': 1.1816506522784933, 'psi': 0.33316775203740023}
[S13] START round=6 head_norm_before_train=1.289214 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3723786932669206, 'auprc': 0.5870950710843791, 'loss_val': 0.9011660702814721, 'psi': 0.458265244393904}-{'f1_val': 0.41643344272875704, 'auprc': 0.6378846010231982, 'loss_val': 0.9937629521856436, 'psi': 0.5050139060465335}
[S14] START round=6 head_norm_before_train=0.901647 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.028256 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7294940850490171, 'loss_val': 1.2526891336334978, 'psi': 0.3760123457492291}-{'f1_val': 0.14035785288270378, 'auprc': 0.7263524456463738, 'loss_val': 1.2997760849575581, 'psi': 0.37475568998817177}
[S15] START round=6 head_norm_before_train=0.750335 cos_to_last_merge=1.0000 (last merge round=5)
[S15] round=6 local utility u=0.016708 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7734764354865888, 'loss_val': 1.1782372103972367, 'psi': 0.39323076501157056}-{'f1_val': 0.13973365136155833, 'auprc': 0.7666232361974735, 'loss_val': 1.1910937597207085, 'psi': 0.3904894852959244}
[S16] START round=6 head_norm_before_train=0.696391 cos_to_last_merge=1.0000 (last merge round=5)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8603051021512459, 'loss_val': 1.2412598904888925, 'psi': 0.4285045109800203}-{'f1_val': 0.14063745019920318, 'auprc': 0.9939538554504825, 'loss_val': 1.2693725335380348, 'psi': 0.481964012299715}
[S17] START round=6 head_norm_before_train=0.975969 cos_to_last_merge=0.9543 (last merge round=1)
[S17] round=6 local utility u=0.925060 metrics={'f1_val': 0.39202413421260673, 'auprc': 0.6533563163252588, 'loss_val': 0.9827082337215506, 'psi': 0.4965570070576676}-{'f1_val': 0.14094896331738438, 'auprc': 0.5719431698576303, 'loss_val': 1.082136991565741, 'psi': 0.3133466459334827}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:44604
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:44610
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44615
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S15] → sending delta(kind=head bytes=1790) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[S5] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1798) from S5
[S9] cosine check vs S5: cos=0.7268
[S9] RECEIVED delta(kind=head bytes=1793) from S10
[S9] cosine check vs S10: cos=0.5901
[S4] RECEIVED delta(kind=head bytes=1797) from S8
[S4] cosine check vs S8: cos=-0.0247
[S4] DROPPED delta from S8 (cos=-0.0247 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1802) from S6
[S4] cosine check vs S6: cos=-0.0217
[S4] DROPPED delta from S6 (cos=-0.0217 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=-0.1169
[S5] DROPPED delta from S4 (cos=-0.1169 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.0089
[S8] RECEIVED delta(kind=head bytes=1790) from S15
[S8] cosine check vs S15: cos=0.8934
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] cosine check vs S14: cos=0.4342
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=0.5269
[S14] RECEIVED delta(kind=head bytes=1797) from S3
[S14] cosine check vs S3: cos=-0.0471
[S14] DROPPED delta from S3 (cos=-0.0471 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1797) from S9
[S14] cosine check vs S9: cos=0.0882
[S17] sending update (kind=head size=1801 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1801) from S17
[S16] cosine check vs S17: cos=0.5553
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.922159
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.412515e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.588331 delta_norm=0.541251
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.1414 head_norm=0.654061
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.218613e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.665537 delta_norm=0.121861
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=6 metric=0.1397 head_norm=0.787471
[S15] _apply_head_vector_avg (torch): Δ‖w‖=4.582230e-01
[S15] stored merged vector for next round verification (round=6)
[S15] DEBUG after merge:  round=6 metric=0.1397 head_norm=0.724759 delta_norm=0.458223
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=6 metric=0.4155 head_norm=1.204656
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.066756e-01
[S8] stored merged vector for next round verification (round=6)
[S8] DEBUG after merge:  round=6 metric=0.4159 head_norm=0.970362 delta_norm=0.306676
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=6 metric=0.1406 head_norm=0.722484
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.003063e-01
[S16] stored merged vector for next round verification (round=6)
[S16] DEBUG after merge:  round=6 metric=0.1406 head_norm=0.618580 delta_norm=0.300306
[S16] aggregate: ACCEPT kept=['S11', 'S2', 'S17'] (k=3/3) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.281359 (no previous merge yet)
[S2] round=7 local utility u=0.930786 metrics={'f1_val': 0.6881718591622492, 'auprc': 0.7625730761243792, 'loss_val': 0.8311061061905083, 'psi': 0.7179323459471012}-{'f1_val': 0.4094537671937748, 'auprc': 0.7562937188544088, 'loss_val': 1.0015309127662129, 'psi': 0.5481897478580284}
[S3] START round=7 head_norm_before_train=1.279666 (no previous merge yet)
[S3] round=7 local utility u=0.846990 metrics={'f1_val': 0.39645225981545407, 'auprc': 0.9974891704573963, 'loss_val': 0.9201761359429265, 'psi': 0.636867024072231}-{'f1_val': 0.13984006561410703, 'auprc': 0.9981446562855738, 'loss_val': 1.0764487113575714, 'psi': 0.4831619018826938}
[S4] START round=7 head_norm_before_train=1.380734 (no previous merge yet)
[S4] round=7 local utility u=0.789352 metrics={'f1_val': 0.6641908866142606, 'auprc': 0.7426463634312335, 'loss_val': 0.767889832963336, 'psi': 0.6955730773410498}-{'f1_val': 0.4254729469096524, 'auprc': 0.7493276869109503, 'loss_val': 0.934330578182054, 'psi': 0.5550148429101716}
[S5] START round=7 head_norm_before_train=0.987803 cos_to_last_merge=0.9619 (last merge round=1)
[S5] round=7 local utility u=0.055187 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7775709858962074, 'loss_val': 0.8741581157667697, 'psi': 0.5615808204857566}-{'f1_val': 0.4179091272005397, 'auprc': 0.7775608468234563, 'loss_val': 0.9864328876091458, 'psi': 0.5617698150497064}
[S6] START round=7 head_norm_before_train=1.309151 (no previous merge yet)
[S6] round=7 local utility u=0.184040 metrics={'f1_val': 0.4171352566691459, 'auprc': 0.905168554558394, 'loss_val': 0.82329719336124, 'psi': 0.6123485758248451}-{'f1_val': 0.41705570454086727, 'auprc': 0.8397212413496704, 'loss_val': 0.9945572221944895, 'psi': 0.5861219192643885}
[S7] START round=7 head_norm_before_train=1.239992 (no previous merge yet)
[S7] round=7 local utility u=0.711032 metrics={'f1_val': 0.41606030461571797, 'auprc': 0.6530246564246076, 'loss_val': 1.0751304200745864, 'psi': 0.5108460453392738}-{'f1_val': 0.14205682272909165, 'auprc': 0.7558645709397874, 'loss_val': 1.1616927133977202, 'psi': 0.38757992201337}
[S8] START round=7 head_norm_before_train=0.970362 cos_to_last_merge=1.0000 (last merge round=6)
[S8] round=7 local utility u=0.589935 metrics={'f1_val': 0.6069502126589634, 'auprc': 0.7572039323018189, 'loss_val': 1.1319961477303058, 'psi': 0.6670517005161056}-{'f1_val': 0.41549694000722615, 'auprc': 0.7666293664196371, 'loss_val': 1.191422892162827, 'psi': 0.5559499105721906}
[S9] START round=7 head_norm_before_train=0.665537 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.039469 metrics={'f1_val': 0.141397957139996, 'auprc': 0.865244078737899, 'loss_val': 1.110114888263026, 'psi': 0.4309364057791572}-{'f1_val': 0.141397957139996, 'auprc': 0.8653648379590402, 'loss_val': 1.1894156199154642, 'psi': 0.4309847094676137}
[S10] START round=7 head_norm_before_train=1.001654 cos_to_last_merge=0.9700 (last merge round=2)
[S10] round=7 local utility u=0.071487 metrics={'f1_val': 0.3881444117674303, 'auprc': 0.6570386916308687, 'loss_val': 0.8239625832268787, 'psi': 0.49570212371280564}-{'f1_val': 0.41694859683592245, 'auprc': 0.6027522220110059, 'loss_val': 0.976902306592393, 'psi': 0.49127004690595577}
[S11] START round=7 head_norm_before_train=0.978868 cos_to_last_merge=0.9471 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=7 local utility u=0.299809 metrics={'f1_val': 0.4152176962830677, 'auprc': 0.9794975769732157, 'loss_val': 0.9500684171626532, 'psi': 0.6409296485591269}-{'f1_val': 0.42273739039721175, 'auprc': 0.8138788652289213, 'loss_val': 1.0979494381697505, 'psi': 0.5791939803298956}
[S13] START round=7 head_norm_before_train=1.325083 (no previous merge yet)
[S13] round=7 local utility u=0.310731 metrics={'f1_val': 0.3802723881768218, 'auprc': 0.7378857267596266, 'loss_val': 0.7794372882536362, 'psi': 0.5233177236099437}-{'f1_val': 0.3723786932669206, 'auprc': 0.5870950710843791, 'loss_val': 0.9011660702814721, 'psi': 0.458265244393904}
[S14] START round=7 head_norm_before_train=0.588331 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.015932 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7323750127730151, 'loss_val': 1.2294687715765458, 'psi': 0.3771647168388283}-{'f1_val': 0.14035785288270378, 'auprc': 0.7294940850490171, 'loss_val': 1.2526891336334978, 'psi': 0.3760123457492291}
[S15] START round=7 head_norm_before_train=0.724759 cos_to_last_merge=1.0000 (last merge round=6)
[S15] round=7 local utility u=0.565555 metrics={'f1_val': 0.32023677151454616, 'auprc': 0.776823874772193, 'loss_val': 1.1401887432523252, 'psi': 0.5028716128176048}-{'f1_val': 0.13973365136155833, 'auprc': 0.7734764354865888, 'loss_val': 1.1782372103972367, 'psi': 0.39323076501157056}
[S16] START round=7 head_norm_before_train=0.618580 cos_to_last_merge=1.0000 (last merge round=6)
[S16] round=7 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.6483415159702779, 'loss_val': 1.2021291174937019, 'psi': 0.3437190765076331}-{'f1_val': 0.14063745019920318, 'auprc': 0.8603051021512459, 'loss_val': 1.2412598904888925, 'psi': 0.4285045109800203}
[S17] START round=7 head_norm_before_train=1.017447 cos_to_last_merge=0.9343 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.934
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.35691296464188577, 'auprc': 0.6888118347643424, 'loss_val': 0.9245882338467396, 'psi': 0.4896725126908684}-{'f1_val': 0.39202413421260673, 'auprc': 0.6533563163252588, 'loss_val': 0.9827082337215506, 'psi': 0.4965570070576676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S10] → sending delta(kind=head bytes=1789) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:44609
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S7] → sending delta(kind=head bytes=1792) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S9] → sending delta(kind=head bytes=1790) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:44615
[S14] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1790 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S7] sending update (kind=head size=1792 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=-0.1172
[S5] DROPPED delta from S4 (cos=-0.1172 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1799) from S5
[S9] cosine check vs S5: cos=0.7094
[S8] RECEIVED delta(kind=head bytes=1791) from S15
[S8] cosine check vs S15: cos=0.6940
[S9] RECEIVED delta(kind=head bytes=1789) from S10
[S9] cosine check vs S10: cos=0.6364
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.6851
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=-0.0834
[S14] DROPPED delta from S3 (cos=-0.0834 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1792) from S7
[S16] cosine check vs S7: cos=0.3770
[S4] RECEIVED delta(kind=head bytes=1791) from S8
[S4] cosine check vs S8: cos=-0.0133
[S4] DROPPED delta from S8 (cos=-0.0133 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.7278
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=0.5915
[S16] RECEIVED delta(kind=head bytes=1797) from S11
[S16] cosine check vs S11: cos=0.2778
[S14] RECEIVED delta(kind=head bytes=1790) from S9
[S14] cosine check vs S9: cos=0.5979
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=-0.0231
[S4] DROPPED delta from S6 (cos=-0.0231 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.1414 head_norm=0.687893
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.082714e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.1414 head_norm=0.702666 delta_norm=0.108271
[S9] aggregate: ACCEPT kept=['S5', 'S10'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=7 metric=0.3202 head_norm=0.758961
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.623054e-01
[S15] stored merged vector for next round verification (round=7)
[S15] DEBUG after merge:  round=7 metric=0.3110 head_norm=0.640439 delta_norm=0.262305
[S15] aggregate: ROLLBACK (f1_val pre=0.320 post=0.311 tol_abs=0.005 tol_rel=0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=7 metric=0.6070 head_norm=0.995654
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.600115e-01
[S8] stored merged vector for next round verification (round=7)
[S8] DEBUG after merge:  round=7 metric=0.6826 head_norm=0.808743 delta_norm=0.360012
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1404 head_norm=0.617989
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.625291e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1404 head_norm=0.664155 delta_norm=0.162529
[S14] aggregate: ACCEPT kept=['S13', 'S9'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=7 metric=0.1406 head_norm=0.655230
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.442339e-01
[S16] stored merged vector for next round verification (round=7)
[S16] DEBUG after merge:  round=7 metric=0.1406 head_norm=0.620586 delta_norm=0.244234
[S16] aggregate: ACCEPT kept=['S7', 'S2', 'S11'] (k=3/3) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.324105 (no previous merge yet)
[S2] round=8 local utility u=0.000000 metrics={'f1_val': 0.7011152882510776, 'auprc': 0.6472518169812227, 'loss_val': 0.7332151963567431, 'psi': 0.6795698997431356}-{'f1_val': 0.6881718591622492, 'auprc': 0.7625730761243792, 'loss_val': 0.8311061061905083, 'psi': 0.7179323459471012}
[S3] START round=8 head_norm_before_train=1.314319 (no previous merge yet)
[S3] round=8 local utility u=0.256234 metrics={'f1_val': 0.4611551928442641, 'auprc': 0.9978488572904208, 'loss_val': 0.7970043642805236, 'psi': 0.6758326586227268}-{'f1_val': 0.39645225981545407, 'auprc': 0.9974891704573963, 'loss_val': 0.9201761359429265, 'psi': 0.636867024072231}
[S4] START round=8 head_norm_before_train=1.426401 (no previous merge yet)
[S4] round=8 local utility u=0.007136 metrics={'f1_val': 0.6469428842847138, 'auprc': 0.7399884185963863, 'loss_val': 0.6421562344896005, 'psi': 0.6841610980093829}-{'f1_val': 0.6641908866142606, 'auprc': 0.7426463634312335, 'loss_val': 0.767889832963336, 'psi': 0.6955730773410498}
[S5] START round=8 head_norm_before_train=1.028311 cos_to_last_merge=0.9491 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.949
[S5] round=8 local utility u=0.889052 metrics={'f1_val': 0.6826532802611569, 'auprc': 0.7943369080471782, 'loss_val': 0.7367469937399544, 'psi': 0.7273267313755654}-{'f1_val': 0.4175873768787894, 'auprc': 0.7775709858962074, 'loss_val': 0.8741581157667697, 'psi': 0.5615808204857566}
[S6] START round=8 head_norm_before_train=1.348769 (no previous merge yet)
[S6] round=8 local utility u=0.624410 metrics={'f1_val': 0.5685282746944152, 'auprc': 0.9727824944765517, 'loss_val': 0.6856777747795997, 'psi': 0.7302299626072699}-{'f1_val': 0.4171352566691459, 'auprc': 0.905168554558394, 'loss_val': 0.82329719336124, 'psi': 0.6123485758248451}
[S7] START round=8 head_norm_before_train=1.261469 (no previous merge yet)
[S7] round=8 local utility u=0.099931 metrics={'f1_val': 0.4174407689569767, 'auprc': 0.6706599622527256, 'loss_val': 0.9364576337928638, 'psi': 0.5187284462752763}-{'f1_val': 0.41606030461571797, 'auprc': 0.6530246564246076, 'loss_val': 1.0751304200745864, 'psi': 0.5108460453392738}
[S8] START round=8 head_norm_before_train=0.808743 cos_to_last_merge=1.0000 (last merge round=7)
[S8] round=8 local utility u=0.027884 metrics={'f1_val': 0.6003570956138566, 'auprc': 0.7704881403959121, 'loss_val': 1.0765219495128646, 'psi': 0.6684095135266788}-{'f1_val': 0.6069502126589634, 'auprc': 0.7572039323018189, 'loss_val': 1.1319961477303058, 'psi': 0.6670517005161056}
[S9] START round=8 head_norm_before_train=0.702666 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.049789 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8656365597179554, 'loss_val': 1.0117134938412875, 'psi': 0.4310933981711798}-{'f1_val': 0.141397957139996, 'auprc': 0.865244078737899, 'loss_val': 1.110114888263026, 'psi': 0.4309364057791572}
[S10] START round=8 head_norm_before_train=1.055869 cos_to_last_merge=0.9545 (last merge round=2)
[S10] round=8 local utility u=0.256208 metrics={'f1_val': 0.3880107694010869, 'auprc': 0.7988834474676749, 'loss_val': 0.7362789714933007, 'psi': 0.5523598406277221}-{'f1_val': 0.3881444117674303, 'auprc': 0.6570386916308687, 'loss_val': 0.8239625832268787, 'psi': 0.49570212371280564}
[S11] START round=8 head_norm_before_train=1.018101 cos_to_last_merge=0.9319 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=8 local utility u=0.054291 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9985306384969237, 'loss_val': 0.78639152504121, 'psi': 0.6373233880442691}-{'f1_val': 0.4152176962830677, 'auprc': 0.9794975769732157, 'loss_val': 0.9500684171626532, 'psi': 0.6409296485591269}
[S13] START round=8 head_norm_before_train=1.358526 (no previous merge yet)
[S13] round=8 local utility u=0.608668 metrics={'f1_val': 0.5738480159031294, 'auprc': 0.7395615581935108, 'loss_val': 0.7285825013490522, 'psi': 0.640133432819282}-{'f1_val': 0.3802723881768218, 'auprc': 0.7378857267596266, 'loss_val': 0.7794372882536362, 'psi': 0.5233177236099437}
[S14] START round=8 head_norm_before_train=0.664155 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.397829 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.9685865807215768, 'loss_val': 1.1424450177415961, 'psi': 0.471649344018253}-{'f1_val': 0.14035785288270378, 'auprc': 0.7323750127730151, 'loss_val': 1.2294687715765458, 'psi': 0.3771647168388283}
[S15] START round=8 head_norm_before_train=0.640439 cos_to_last_merge=1.0000 (last merge round=7)
[S15] round=8 local utility u=0.353303 metrics={'f1_val': 0.41691903018686227, 'auprc': 0.7994793951999611, 'loss_val': 1.0816435427227216, 'psi': 0.5699431761921019}-{'f1_val': 0.32023677151454616, 'auprc': 0.776823874772193, 'loss_val': 1.1401887432523252, 'psi': 0.5028716128176048}
[S16] START round=8 head_norm_before_train=0.620586 cos_to_last_merge=1.0000 (last merge round=7)
[S16] round=8 local utility u=0.569897 metrics={'f1_val': 0.4173069283424069, 'auprc': 0.44642292830941754, 'loss_val': 1.1165966545610957, 'psi': 0.4289533283292112}-{'f1_val': 0.14063745019920318, 'auprc': 0.6483415159702779, 'loss_val': 1.2021291174937019, 'psi': 0.3437190765076331}
[S17] START round=8 head_norm_before_train=1.064268 cos_to_last_merge=0.9111 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.911
[S17] round=8 local utility u=0.178440 metrics={'f1_val': 0.35243618488830136, 'auprc': 0.8136328439568499, 'loss_val': 0.9153101367056966, 'psi': 0.5369148485157208}-{'f1_val': 0.35691296464188577, 'auprc': 0.6888118347643424, 'loss_val': 0.9245882338467396, 'psi': 0.4896725126908684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:44610
[S3] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=-0.0672
[S14] DROPPED delta from S3 (cos=-0.0672 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.4929
[S16] RECEIVED delta(kind=head bytes=1796) from S11
[S16] cosine check vs S11: cos=0.4116
[S14] RECEIVED delta(kind=head bytes=1805) from S13
[S14] cosine check vs S13: cos=0.7967
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=0.6634
[S4] RECEIVED delta(kind=head bytes=1795) from S6
[S4] cosine check vs S6: cos=-0.0268
[S4] DROPPED delta from S6 (cos=-0.0268 < 0.0)
[S16] RECEIVED delta(kind=head bytes=1798) from S7
[S16] cosine check vs S7: cos=0.5088
[S9] RECEIVED delta(kind=head bytes=1802) from S5
[S9] cosine check vs S5: cos=0.6962
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.8813
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S16@127.0.0.1:44616
[S17] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1799) from S17
[S16] cosine check vs S17: cos=0.4550
[S15] RECEIVED delta(kind=head bytes=1803) from S16
[S15] cosine check vs S16: cos=0.2039
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:44609
[S4] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S15
[S8] cosine check vs S15: cos=0.7756
[S4] RECEIVED delta(kind=head bytes=1795) from S8
[S4] cosine check vs S8: cos=0.0146
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=-0.1170
[S5] DROPPED delta from S4 (cos=-0.1170 < 0.0)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=8 metric=0.6004 head_norm=0.840978
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.656624e-01
[S8] stored merged vector for next round verification (round=8)
[S8] DEBUG after merge:  round=8 metric=0.3729 head_norm=0.715200 delta_norm=0.265662
[S8] aggregate: ROLLBACK (f1_val pre=0.600 post=0.373 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.6469 head_norm=1.481458
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.464156e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.6469 head_norm=0.857066 delta_norm=0.846416
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.1404 head_norm=0.694270
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.138023e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.1404 head_norm=0.722916 delta_norm=0.113802
[S14] aggregate: ACCEPT kept=['S9', 'S13'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=8 metric=0.4173 head_norm=0.662014
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.290326e-01
[S16] stored merged vector for next round verification (round=8)
[S16] DEBUG after merge:  round=8 metric=0.4174 head_norm=0.631979 delta_norm=0.229033
[S16] aggregate: ACCEPT kept=['S11', 'S7', 'S17'] (k=3/3) mode=median trim_p=0.1
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=8 metric=0.1414 head_norm=0.733967
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.025094e-01
[S9] stored merged vector for next round verification (round=8)
[S9] DEBUG after merge:  round=8 metric=0.4158 head_norm=0.745326 delta_norm=0.102509
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=8 metric=0.4169 head_norm=0.675966
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.497256e-01
[S15] stored merged vector for next round verification (round=8)
[S15] DEBUG after merge:  round=8 metric=0.4169 head_norm=0.561056 delta_norm=0.249726
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.372866 (no previous merge yet)
[S2] round=9 local utility u=0.066653 metrics={'f1_val': 0.7010364462786205, 'auprc': 0.6467780384649506, 'loss_val': 0.5980143131025819, 'psi': 0.6793330831531526}-{'f1_val': 0.7011152882510776, 'auprc': 0.6472518169812227, 'loss_val': 0.7332151963567431, 'psi': 0.6795698997431356}
[S3] START round=9 head_norm_before_train=1.356514 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.4024484509855121, 'auprc': 0.6970985321003781, 'loss_val': 0.7940054793370985, 'psi': 0.5203084834314584}-{'f1_val': 0.4611551928442641, 'auprc': 0.9978488572904208, 'loss_val': 0.7970043642805236, 'psi': 0.6758326586227268}
[S4] START round=9 head_norm_before_train=0.857066 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6726571708535902, 'auprc': 0.661167530737482, 'loss_val': 0.6680241102784737, 'psi': 0.6680613148071469}-{'f1_val': 0.6469428842847138, 'auprc': 0.7399884185963863, 'loss_val': 0.6421562344896005, 'psi': 0.6841610980093829}
[S5] START round=9 head_norm_before_train=1.076232 cos_to_last_merge=0.9340 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=9 local utility u=0.000000 metrics={'f1_val': 0.6642215494971225, 'auprc': 0.7941674526102682, 'loss_val': 0.6760685961221404, 'psi': 0.7161999107423809}-{'f1_val': 0.6826532802611569, 'auprc': 0.7943369080471782, 'loss_val': 0.7367469937399544, 'psi': 0.7273267313755654}
[S6] START round=9 head_norm_before_train=1.390799 (no previous merge yet)
[S6] round=9 local utility u=0.549297 metrics={'f1_val': 0.7110236829497456, 'auprc': 0.9926496772848009, 'loss_val': 0.5016574599894603, 'psi': 0.8236740806837677}-{'f1_val': 0.5685282746944152, 'auprc': 0.9727824944765517, 'loss_val': 0.6856777747795997, 'psi': 0.7302299626072699}
[S7] START round=9 head_norm_before_train=1.292881 (no previous merge yet)
[S7] round=9 local utility u=0.205013 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7819429723811452, 'loss_val': 0.857848537839754, 'psi': 0.562998445245227}-{'f1_val': 0.4174407689569767, 'auprc': 0.6706599622527256, 'loss_val': 0.9364576337928638, 'psi': 0.5187284462752763}
[S8] START round=9 head_norm_before_train=0.715200 cos_to_last_merge=1.0000 (last merge round=8)
[S8] round=9 local utility u=0.000000 metrics={'f1_val': 0.3726652774371328, 'auprc': 0.7764114384979572, 'loss_val': 1.001227803646749, 'psi': 0.5341637418614626}-{'f1_val': 0.6003570956138566, 'auprc': 0.7704881403959121, 'loss_val': 1.0765219495128646, 'psi': 0.6684095135266788}
[S9] START round=9 head_norm_before_train=0.745326 cos_to_last_merge=1.0000 (last merge round=8)
[S9] round=9 local utility u=0.942523 metrics={'f1_val': 0.43610168042805614, 'auprc': 0.8655256134296433, 'loss_val': 0.8945571979846481, 'psi': 0.607871253628691}-{'f1_val': 0.141397957139996, 'auprc': 0.8656365597179554, 'loss_val': 1.0117134938412875, 'psi': 0.4310933981711798}
[S10] START round=9 head_norm_before_train=1.109209 cos_to_last_merge=0.9384 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=9 local utility u=1.000000 metrics={'f1_val': 0.691738922613278, 'auprc': 0.9387505384873678, 'loss_val': 0.6422915711263201, 'psi': 0.7905435689629139}-{'f1_val': 0.3880107694010869, 'auprc': 0.7988834474676749, 'loss_val': 0.7362789714933007, 'psi': 0.5523598406277221}
[S11] START round=9 head_norm_before_train=1.066856 cos_to_last_merge=0.9141 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=9 local utility u=0.743524 metrics={'f1_val': 0.6173799116197932, 'auprc': 0.9966247505276675, 'loss_val': 0.6187941558473901, 'psi': 0.7690778471829429}-{'f1_val': 0.39651855440916606, 'auprc': 0.9985306384969237, 'loss_val': 0.78639152504121, 'psi': 0.6373233880442691}
[S13] START round=9 head_norm_before_train=1.388685 (no previous merge yet)
[S13] round=9 local utility u=0.460006 metrics={'f1_val': 0.7110450895345974, 'auprc': 0.7423173340133042, 'loss_val': 0.640020975802305, 'psi': 0.7235539873260801}-{'f1_val': 0.5738480159031294, 'auprc': 0.7395615581935108, 'loss_val': 0.7285825013490522, 'psi': 0.640133432819282}
[S14] START round=9 head_norm_before_train=0.722916 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=1.000000 metrics={'f1_val': 0.5342010035602607, 'auprc': 0.9960440011049352, 'loss_val': 1.025762068674101, 'psi': 0.7189382025781306}-{'f1_val': 0.14035785288270378, 'auprc': 0.9685865807215768, 'loss_val': 1.1424450177415961, 'psi': 0.471649344018253}
[S15] START round=9 head_norm_before_train=0.561056 cos_to_last_merge=1.0000 (last merge round=8)
[S15] round=9 local utility u=0.030794 metrics={'f1_val': 0.4164751552795031, 'auprc': 0.7994867215443147, 'loss_val': 1.0174140470167192, 'psi': 0.5696797817854277}-{'f1_val': 0.41691903018686227, 'auprc': 0.7994793951999611, 'loss_val': 1.0816435427227216, 'psi': 0.5699431761921019}
[S16] START round=9 head_norm_before_train=0.631979 cos_to_last_merge=1.0000 (last merge round=8)
[S16] round=9 local utility u=0.065437 metrics={'f1_val': 0.41727255530994717, 'auprc': 0.45960453744546936, 'loss_val': 1.0250612492421036, 'psi': 0.434205348164156}-{'f1_val': 0.4173069283424069, 'auprc': 0.44642292830941754, 'loss_val': 1.1165966545610957, 'psi': 0.4289533283292112}
[S17] START round=9 head_norm_before_train=1.107755 cos_to_last_merge=0.8887 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3459990557686633, 'auprc': 0.7806404676511415, 'loss_val': 0.9217940495607927, 'psi': 0.5198556205216546}-{'f1_val': 0.35243618488830136, 'auprc': 0.8136328439568499, 'loss_val': 0.9153101367056966, 'psi': 0.5369148485157208}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] → sending delta(kind=head bytes=1795) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:44610
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:44614
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1795 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=0.4503
[S8] RECEIVED delta(kind=head bytes=1801) from S15
[S8] cosine check vs S15: cos=0.8144
[S15] RECEIVED delta(kind=head bytes=1795) from S16
[S15] cosine check vs S16: cos=0.4375
[S16] RECEIVED delta(kind=head bytes=1797) from S2
[S16] cosine check vs S2: cos=0.3603
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.5046
[S4] RECEIVED delta(kind=head bytes=1798) from S6
[S4] cosine check vs S6: cos=0.0086
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.5380
[S9] RECEIVED delta(kind=head bytes=1796) from S10
[S9] cosine check vs S10: cos=0.6811
[S15] RECEIVED delta(kind=head bytes=1795) from S14
[S15] cosine check vs S14: cos=0.8625
[S14] RECEIVED delta(kind=head bytes=1805) from S13
[S14] cosine check vs S13: cos=0.8337
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=9 metric=0.3727 head_norm=0.753709
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.187992e-01
[S8] stored merged vector for next round verification (round=9)
[S8] DEBUG after merge:  round=9 metric=0.3727 head_norm=0.645198 delta_norm=0.218799
[S8] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.6727 head_norm=0.923028
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.473997e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.6663 head_norm=0.854060 delta_norm=0.847400
[S4] aggregate: ROLLBACK (f1_val pre=0.673 post=0.666 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=9 metric=0.4165 head_norm=0.600191
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.613993e-01
[S15] stored merged vector for next round verification (round=9)
[S15] DEBUG after merge:  round=9 metric=0.4091 head_norm=0.558554 delta_norm=0.161399
[S15] aggregate: ROLLBACK (f1_val pre=0.416 post=0.409 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.5342 head_norm=0.760344
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.613951e-02
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.6856 head_norm=0.769824 delta_norm=0.096140
[S14] aggregate: ACCEPT kept=['S9', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.4361 head_norm=0.785791
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.237452e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.4358 head_norm=0.893856 delta_norm=0.423745
[S9] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=9 metric=0.4173 head_norm=0.678849
[S16] _apply_head_vector_avg (torch): Δ‖w‖=2.135081e-01
[S16] stored merged vector for next round verification (round=9)
[S16] DEBUG after merge:  round=9 metric=0.4171 head_norm=0.672352 delta_norm=0.213508
[S16] aggregate: ACCEPT kept=['S2', 'S11', 'S7'] (k=3/3) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.425014 (no previous merge yet)
[S2] round=10 local utility u=0.044100 metrics={'f1_val': 0.7012929998565405, 'auprc': 0.6620509905565939, 'loss_val': 0.5571730293599976, 'psi': 0.6855961961365619}-{'f1_val': 0.7010364462786205, 'auprc': 0.6467780384649506, 'loss_val': 0.5980143131025819, 'psi': 0.6793330831531526}
[S3] START round=10 head_norm_before_train=1.405476 (no previous merge yet)
[S3] round=10 local utility u=0.672962 metrics={'f1_val': 0.4528023873081105, 'auprc': 0.9993540694139424, 'loss_val': 0.6569711861730176, 'psi': 0.6714230601504433}-{'f1_val': 0.4024484509855121, 'auprc': 0.6970985321003781, 'loss_val': 0.7940054793370985, 'psi': 0.5203084834314584}
[S4] START round=10 head_norm_before_train=0.854060 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=1.000000 metrics={'f1_val': 0.9348075558774084, 'auprc': 0.9313048977454057, 'loss_val': 0.7812967957919321, 'psi': 0.9334064926246073}-{'f1_val': 0.6726571708535902, 'auprc': 0.661167530737482, 'loss_val': 0.6680241102784737, 'psi': 0.6680613148071469}
[S5] START round=10 head_norm_before_train=1.121188 cos_to_last_merge=0.9203 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.920
[S5] round=10 local utility u=0.161512 metrics={'f1_val': 0.7010639315836553, 'auprc': 0.7921367750729955, 'loss_val': 0.5680066015589363, 'psi': 0.7374930689793915}-{'f1_val': 0.6642215494971225, 'auprc': 0.7941674526102682, 'loss_val': 0.6760685961221404, 'psi': 0.7161999107423809}
[S6] START round=10 head_norm_before_train=1.429346 (no previous merge yet)
[S6] round=10 local utility u=0.000000 metrics={'f1_val': 0.4350454360200048, 'auprc': 0.7532475795115288, 'loss_val': 0.7036412287379902, 'psi': 0.5623262934166144}-{'f1_val': 0.7110236829497456, 'auprc': 0.9926496772848009, 'loss_val': 0.5016574599894603, 'psi': 0.8236740806837677}
[S7] START round=10 head_norm_before_train=1.326646 (no previous merge yet)
[S7] round=10 local utility u=0.020612 metrics={'f1_val': 0.4169130971024577, 'auprc': 0.7781083296874568, 'loss_val': 0.8043866245546766, 'psi': 0.5613911901364574}-{'f1_val': 0.41703542715461484, 'auprc': 0.7819429723811452, 'loss_val': 0.857848537839754, 'psi': 0.562998445245227}
[S8] START round=10 head_norm_before_train=0.645198 cos_to_last_merge=1.0000 (last merge round=9)
[S8] round=10 local utility u=1.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.7923106791668988, 'loss_val': 0.8987320789257918, 'psi': 0.7452955723071469}-{'f1_val': 0.3726652774371328, 'auprc': 0.7764114384979572, 'loss_val': 1.001227803646749, 'psi': 0.5341637418614626}
[S9] START round=10 head_norm_before_train=0.893856 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9976433575973294, 'loss_val': 0.7367954205059427, 'psi': 0.8200709323302059}-{'f1_val': 0.43610168042805614, 'auprc': 0.8655256134296433, 'loss_val': 0.8945571979846481, 'psi': 0.607871253628691}
[S10] START round=10 head_norm_before_train=1.157416 cos_to_last_merge=0.9238 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=10 local utility u=0.176003 metrics={'f1_val': 0.701464774226574, 'auprc': 0.9926983114115805, 'loss_val': 0.5104848628421472, 'psi': 0.8179581891005767}-{'f1_val': 0.691738922613278, 'auprc': 0.9387505384873678, 'loss_val': 0.6422915711263201, 'psi': 0.7905435689629139}
[S11] START round=10 head_norm_before_train=1.118444 cos_to_last_merge=0.8951 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=10 local utility u=0.327352 metrics={'f1_val': 0.7020664967782734, 'auprc': 0.9984037192182563, 'loss_val': 0.477546013878986, 'psi': 0.8206013857542666}-{'f1_val': 0.6173799116197932, 'auprc': 0.9966247505276675, 'loss_val': 0.6187941558473901, 'psi': 0.7690778471829429}
[S13] START round=10 head_norm_before_train=1.416231 (no previous merge yet)
[S13] round=10 local utility u=0.028724 metrics={'f1_val': 0.7126326316239505, 'auprc': 0.7390263204952481, 'loss_val': 0.582226157400138, 'psi': 0.7231901071724696}-{'f1_val': 0.7110450895345974, 'auprc': 0.7423173340133042, 'loss_val': 0.640020975802305, 'psi': 0.7235539873260801}
[S14] START round=10 head_norm_before_train=0.769824 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.319098 metrics={'f1_val': 0.6205043883534955, 'auprc': 0.9947236256201237, 'loss_val': 0.9014242785662493, 'psi': 0.7701920832601468}-{'f1_val': 0.5342010035602607, 'auprc': 0.9960440011049352, 'loss_val': 1.025762068674101, 'psi': 0.7189382025781306}
[S15] START round=10 head_norm_before_train=0.558554 cos_to_last_merge=1.0000 (last merge round=9)
[S15] round=10 local utility u=0.000000 metrics={'f1_val': 0.3843923301979377, 'auprc': 0.7994410370001361, 'loss_val': 0.9613554947810583, 'psi': 0.5504118129188171}-{'f1_val': 0.4164751552795031, 'auprc': 0.7994867215443147, 'loss_val': 1.0174140470167192, 'psi': 0.5696797817854277}
[S16] START round=10 head_norm_before_train=0.672352 cos_to_last_merge=1.0000 (last merge round=9)
[S16] round=10 local utility u=0.351026 metrics={'f1_val': 0.42525600272094854, 'auprc': 0.6619345169598148, 'loss_val': 0.9778990171218459, 'psi': 0.5199274084164951}-{'f1_val': 0.41727255530994717, 'auprc': 0.45960453744546936, 'loss_val': 1.0250612492421036, 'psi': 0.434205348164156}
[S17] START round=10 head_norm_before_train=1.146379 cos_to_last_merge=0.8689 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=10 local utility u=0.000000 metrics={'f1_val': 0.3389731763131577, 'auprc': 0.761215587111107, 'loss_val': 0.9370165627381085, 'psi': 0.5078701406323374}-{'f1_val': 0.3459990557686633, 'auprc': 0.7806404676511415, 'loss_val': 0.9217940495607927, 'psi': 0.5198556205216546}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S16@127.0.0.1:44616
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:44605
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[S14] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=-0.0476
[S5] DROPPED delta from S4 (cos=-0.0476 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] cosine check vs S8: cos=0.2962
[S9] RECEIVED delta(kind=head bytes=1797) from S10
[S9] cosine check vs S10: cos=0.9269
[S14] RECEIVED delta(kind=head bytes=1801) from S3
[S14] cosine check vs S3: cos=-0.0600
[S14] DROPPED delta from S3 (cos=-0.0600 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=0.3169
[S16] RECEIVED delta(kind=head bytes=1798) from S2
[S16] cosine check vs S2: cos=0.5032
[S15] RECEIVED delta(kind=head bytes=1796) from S16
[S15] cosine check vs S16: cos=0.5915
[S14] RECEIVED delta(kind=head bytes=1805) from S13
[S14] cosine check vs S13: cos=0.8437
[S16] RECEIVED delta(kind=head bytes=1801) from S11
[S16] cosine check vs S11: cos=0.5133
[S14] RECEIVED delta(kind=head bytes=1801) from S9
[S14] cosine check vs S9: cos=0.4275
[S16] RECEIVED delta(kind=head bytes=1797) from S7
[S16] cosine check vs S7: cos=0.5825
[S15] RECEIVED delta(kind=head bytes=1792) from S14
[S15] cosine check vs S14: cos=0.8133
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] ⇄ pheromone p=0.361 → S4@127.0.0.1:44604
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=10 metric=0.3844 head_norm=0.601233
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.360881e-01
[S15] stored merged vector for next round verification (round=10)
[S15] DEBUG after merge:  round=10 metric=0.3838 head_norm=0.587435 delta_norm=0.136088
[S15] aggregate: ACCEPT kept=['S16', 'S14'] (k=2/2) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.249 → S8@127.0.0.1:44609
[S3] ⇄ pheromone p=0.400 → S14@127.0.0.1:44614
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.7017 head_norm=0.936990
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.184199e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.7016 head_norm=0.861463 delta_norm=0.218420
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.472 → S14@127.0.0.1:44614
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=10 metric=0.4253 head_norm=0.717127
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.348302e-01
[S16] stored merged vector for next round verification (round=10)
[S16] DEBUG after merge:  round=10 metric=0.4309 head_norm=0.724357 delta_norm=0.134830
[S16] aggregate: ACCEPT kept=['S2', 'S11', 'S7'] (k=3/3) mode=median trim_p=0.1
[S16] ⇄ pheromone p=0.298 → S15@127.0.0.1:44615
[S10] ⇄ pheromone p=0.438 → S9@127.0.0.1:44610
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.6205 head_norm=0.814180
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.449267e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.6205 head_norm=0.824549 delta_norm=0.144927
[S14] aggregate: ACCEPT kept=['S13', 'S9'] (k=2/2) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.402 → S15@127.0.0.1:44615
[S5] ⇄ pheromone p=0.324 → S9@127.0.0.1:44610
[S8] ⇄ pheromone p=0.451 → S4@127.0.0.1:44604
[S2] ⇄ pheromone p=0.312 → S16@127.0.0.1:44616
[S13] ⇄ pheromone p=0.347 → S14@127.0.0.1:44614
[S11] ⇄ pheromone p=0.415 → S16@127.0.0.1:44616
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.9348 head_norm=0.901579
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.799959e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.9359 head_norm=0.644244 delta_norm=0.479996
[S4] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.480 → S5@127.0.0.1:44605
[S7] ⇄ pheromone p=0.243 → S16@127.0.0.1:44616
[S17] ⇄ pheromone p=0.234 → S16@127.0.0.1:44616
[S2] START round=11 head_norm_before_train=1.473254 (no previous merge yet)
[S2] round=11 local utility u=0.022294 metrics={'f1_val': 0.7015730791798309, 'auprc': 0.6473338364885397, 'loss_val': 0.47011481389451165, 'psi': 0.6798773821033144}-{'f1_val': 0.7012929998565405, 'auprc': 0.6620509905565939, 'loss_val': 0.5571730293599976, 'psi': 0.6855961961365619}
[S3] START round=11 head_norm_before_train=1.451781 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.4038388831837816, 'auprc': 0.9642229670868453, 'loss_val': 0.7180199506242501, 'psi': 0.6279925167450071}-{'f1_val': 0.4528023873081105, 'auprc': 0.9993540694139424, 'loss_val': 0.6569711861730176, 'psi': 0.6714230601504433}
[S4] START round=11 head_norm_before_train=0.644244 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.000000 metrics={'f1_val': 0.9361320366801239, 'auprc': 0.9306696969570547, 'loss_val': 0.7956499934740381, 'psi': 0.9339471007908962}-{'f1_val': 0.9348075558774084, 'auprc': 0.9313048977454057, 'loss_val': 0.7812967957919321, 'psi': 0.9334064926246073}
[S5] START round=11 head_norm_before_train=1.160697 cos_to_last_merge=0.9092 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.909
[S5] round=11 local utility u=0.025188 metrics={'f1_val': 0.7060526830272391, 'auprc': 0.7916074527656731, 'loss_val': 0.5459753094994436, 'psi': 0.7402745909226127}-{'f1_val': 0.7010639315836553, 'auprc': 0.7921367750729955, 'loss_val': 0.5680066015589363, 'psi': 0.7374930689793915}
[S6] START round=11 head_norm_before_train=1.471956 (no previous merge yet)
[S6] round=11 local utility u=1.000000 metrics={'f1_val': 0.7106339552115712, 'auprc': 0.9752321827746222, 'loss_val': 0.35133864435734863, 'psi': 0.8164732462367916}-{'f1_val': 0.4350454360200048, 'auprc': 0.7532475795115288, 'loss_val': 0.7036412287379902, 'psi': 0.5623262934166144}
[S7] START round=11 head_norm_before_train=1.351843 (no previous merge yet)
[S7] round=11 local utility u=0.514267 metrics={'f1_val': 0.5829639929916011, 'auprc': 0.7813082450377387, 'loss_val': 0.7817568010249382, 'psi': 0.6623016938100561}-{'f1_val': 0.4169130971024577, 'auprc': 0.7781083296874568, 'loss_val': 0.8043866245546766, 'psi': 0.5613911901364574}
[S8] START round=11 head_norm_before_train=0.691410 cos_to_last_merge=0.9913 (last merge round=9)
[S8] round=11 local utility u=0.000000 metrics={'f1_val': 0.3729983462200504, 'auprc': 0.8650691238169607, 'loss_val': 0.8691250292206196, 'psi': 0.5698266572588145}-{'f1_val': 0.7139521677339791, 'auprc': 0.7923106791668988, 'loss_val': 0.8987320789257918, 'psi': 0.7452955723071469}
[S9] START round=11 head_norm_before_train=0.861463 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.083013 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9987856512441134, 'loss_val': 0.5722490298250341, 'psi': 0.8203330611291508}-{'f1_val': 0.7016893154854569, 'auprc': 0.9976433575973294, 'loss_val': 0.7367954205059427, 'psi': 0.8200709323302059}
[S10] START round=11 head_norm_before_train=1.202200 cos_to_last_merge=0.9125 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=11 local utility u=0.000000 metrics={'f1_val': 0.6653714636858691, 'auprc': 0.9654091354476695, 'loss_val': 0.46529878489822585, 'psi': 0.7853865323905893}-{'f1_val': 0.701464774226574, 'auprc': 0.9926983114115805, 'loss_val': 0.5104848628421472, 'psi': 0.8179581891005767}
[S11] START round=11 head_norm_before_train=1.172992 cos_to_last_merge=0.8760 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.876
[S11] round=11 local utility u=0.061899 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.998194538164718, 'loss_val': 0.352334126759088, 'psi': 0.8204390052448793}-{'f1_val': 0.7020664967782734, 'auprc': 0.9984037192182563, 'loss_val': 0.477546013878986, 'psi': 0.8206013857542666}
[S13] START round=11 head_norm_before_train=1.443522 (no previous merge yet)
[S13] round=11 local utility u=0.028543 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.7503216298053028, 'loss_val': 0.5621922801816848, 'psi': 0.7280248133466145}-{'f1_val': 0.7126326316239505, 'auprc': 0.7390263204952481, 'loss_val': 0.582226157400138, 'psi': 0.7231901071724696}
[S14] START round=11 head_norm_before_train=0.824549 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.073335 metrics={'f1_val': 0.6204752500914243, 'auprc': 0.9955886882423581, 'loss_val': 0.7571750561970089, 'psi': 0.7705206253517978}-{'f1_val': 0.6205043883534955, 'auprc': 0.9947236256201237, 'loss_val': 0.9014242785662493, 'psi': 0.7701920832601468}
[S15] START round=11 head_norm_before_train=0.587435 cos_to_last_merge=1.0000 (last merge round=10)
[S15] round=11 local utility u=0.000000 metrics={'f1_val': 0.4336187231008853, 'auprc': 0.6659491832044113, 'loss_val': 0.9703928880604635, 'psi': 0.5265509071422957}-{'f1_val': 0.3843923301979377, 'auprc': 0.7994410370001361, 'loss_val': 0.9613554947810583, 'psi': 0.5504118129188171}
[S16] START round=11 head_norm_before_train=0.724357 cos_to_last_merge=1.0000 (last merge round=10)
[S16] round=11 local utility u=0.099658 metrics={'f1_val': 0.43525436414180135, 'auprc': 0.6957365766520333, 'loss_val': 0.9399784231308058, 'psi': 0.5394472491458941}-{'f1_val': 0.42525600272094854, 'auprc': 0.6619345169598148, 'loss_val': 0.9778990171218459, 'psi': 0.5199274084164951}
[S17] START round=11 head_norm_before_train=1.181581 cos_to_last_merge=0.8520 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=11 local utility u=0.000000 metrics={'f1_val': 0.33415063946469914, 'auprc': 0.7551752975466222, 'loss_val': 0.9929301521856952, 'psi': 0.5025605026974683}-{'f1_val': 0.3389731763131577, 'auprc': 0.761215587111107, 'loss_val': 0.9370165627381085, 'psi': 0.5078701406323374}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S16@127.0.0.1:44616
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S15@127.0.0.1:44615
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:44604
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1796) from S6
[S4] cosine check vs S6: cos=0.5511
[S16] RECEIVED delta(kind=head bytes=1796) from S7
[S16] cosine check vs S7: cos=0.5858
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=0.4709
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.5133
[S15] RECEIVED delta(kind=head bytes=1791) from S14
[S15] cosine check vs S14: cos=0.7871
[S16] RECEIVED delta(kind=head bytes=1803) from S11
[S16] cosine check vs S11: cos=0.5076
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:44615
[S16] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S16@127.0.0.1:44616
[S15] RECEIVED delta(kind=head bytes=1794) from S16
[S15] cosine check vs S16: cos=0.6466
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:44614
[S2] sending update (kind=head size=1803 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1803) from S2
[S16] cosine check vs S2: cos=0.5520
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1800) from S13
[S14] cosine check vs S13: cos=0.8413
[S14] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=11 metric=0.6205 head_norm=0.872916
[S14] _apply_head_vector_avg (torch): Δ‖w‖=9.249315e-02
[S14] stored merged vector for next round verification (round=11)
[S14] DEBUG after merge:  round=11 metric=0.6204 head_norm=0.857166 delta_norm=0.092493
[S14] aggregate: ACCEPT kept=['S9', 'S13'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.7014 head_norm=0.915974
[S9] _apply_head_vector_avg (torch): Δ‖w‖=5.350624e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.7013 head_norm=0.921236 delta_norm=0.535062
[S9] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=11 metric=0.4336 head_norm=0.631320
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.342539e-01
[S15] stored merged vector for next round verification (round=11)
[S15] DEBUG after merge:  round=11 metric=0.4369 head_norm=0.626888 delta_norm=0.134254
[S15] aggregate: ACCEPT kept=['S14', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.9361 head_norm=0.701152
[S4] _apply_head_vector_avg (torch): Δ‖w‖=6.329080e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.6450 head_norm=0.991765 delta_norm=0.632908
[S4] aggregate: ROLLBACK (f1_val pre=0.936 post=0.645 tol_abs=0.005 tol_rel=0.0)
[S16] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=11 metric=0.4353 head_norm=0.774495
[S16] _apply_head_vector_avg (torch): Δ‖w‖=1.069442e-01
[S16] stored merged vector for next round verification (round=11)
[S16] DEBUG after merge:  round=11 metric=0.4354 head_norm=0.768124 delta_norm=0.106944
[S16] aggregate: ACCEPT kept=['S7', 'S11', 'S2'] (k=3/3) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.504919 (no previous merge yet)
[S2] round=12 local utility u=0.053411 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6617112060353454, 'loss_val': 0.406412142907144, 'psi': 0.6856271178372872}-{'f1_val': 0.7015730791798309, 'auprc': 0.6473338364885397, 'loss_val': 0.47011481389451165, 'psi': 0.6798773821033144}
[S3] START round=12 head_norm_before_train=1.491776 (no previous merge yet)
[S3] round=12 local utility u=1.000000 metrics={'f1_val': 0.7010863553524592, 'auprc': 0.9988751801670461, 'loss_val': 0.381519766309075, 'psi': 0.820201885278294}-{'f1_val': 0.4038388831837816, 'auprc': 0.9642229670868453, 'loss_val': 0.7180199506242501, 'psi': 0.6279925167450071}
[S4] START round=12 head_norm_before_train=0.991765 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.101846 metrics={'f1_val': 0.9507490971822232, 'auprc': 0.9528617876756844, 'loss_val': 0.7462369801382888, 'psi': 0.9515941733796077}-{'f1_val': 0.9361320366801239, 'auprc': 0.9306696969570547, 'loss_val': 0.7956499934740381, 'psi': 0.9339471007908962}
[S5] START round=12 head_norm_before_train=1.196213 cos_to_last_merge=0.8991 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.899
[S5] round=12 local utility u=0.026622 metrics={'f1_val': 0.7008569501491988, 'auprc': 0.7882734909125955, 'loss_val': 0.45155416318370706, 'psi': 0.7358235664545574}-{'f1_val': 0.7060526830272391, 'auprc': 0.7916074527656731, 'loss_val': 0.5459753094994436, 'psi': 0.7402745909226127}
[S6] START round=12 head_norm_before_train=1.508883 (no previous merge yet)
[S6] round=12 local utility u=0.000000 metrics={'f1_val': 0.6183352575553521, 'auprc': 0.8024135689590419, 'loss_val': 0.5191121169987992, 'psi': 0.691966582116828}-{'f1_val': 0.7106339552115712, 'auprc': 0.9752321827746222, 'loss_val': 0.35133864435734863, 'psi': 0.8164732462367916}
[S7] START round=12 head_norm_before_train=1.376771 (no previous merge yet)
[S7] round=12 local utility u=0.244204 metrics={'f1_val': 0.6612767392655253, 'auprc': 0.7785041119603817, 'loss_val': 0.7548129845260848, 'psi': 0.7081676883434679}-{'f1_val': 0.5829639929916011, 'auprc': 0.7813082450377387, 'loss_val': 0.7817568010249382, 'psi': 0.6623016938100561}
[S8] START round=12 head_norm_before_train=0.749390 cos_to_last_merge=0.9727 (last merge round=9)
[S8] round=12 local utility u=1.000000 metrics={'f1_val': 0.7137586021136586, 'auprc': 0.9936937370488571, 'loss_val': 0.6280962228637582, 'psi': 0.825732656087738}-{'f1_val': 0.3729983462200504, 'auprc': 0.8650691238169607, 'loss_val': 0.8691250292206196, 'psi': 0.5698266572588145}
[S9] START round=12 head_norm_before_train=0.921236 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.041840 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9986136342580209, 'loss_val': 0.4880521763580343, 'psi': 0.8202642543347138}-{'f1_val': 0.7013646677191758, 'auprc': 0.9987856512441134, 'loss_val': 0.5722490298250341, 'psi': 0.8203330611291508}
[S10] START round=12 head_norm_before_train=1.245612 cos_to_last_merge=0.9034 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=12 local utility u=0.200628 metrics={'f1_val': 0.6997185165696, 'auprc': 0.9896531870385404, 'loss_val': 0.34285698011647686, 'psi': 0.8156923847571762}-{'f1_val': 0.6653714636858691, 'auprc': 0.9654091354476695, 'loss_val': 0.46529878489822585, 'psi': 0.7853865323905893}
[S11] START round=12 head_norm_before_train=1.223577 cos_to_last_merge=0.8592 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.859
[S11] round=12 local utility u=0.788327 metrics={'f1_val': 0.9554452909198413, 'auprc': 0.9983321212099876, 'loss_val': 0.2971535327689389, 'psi': 0.9726000230358999}-{'f1_val': 0.7019353166316534, 'auprc': 0.998194538164718, 'loss_val': 0.352334126759088, 'psi': 0.8204390052448793}
[S13] START round=12 head_norm_before_train=1.464866 (no previous merge yet)
[S13] round=12 local utility u=0.000000 metrics={'f1_val': 0.7131602690408223, 'auprc': 0.7558712350799157, 'loss_val': 0.588491546480327, 'psi': 0.7302446554564597}-{'f1_val': 0.7131602690408223, 'auprc': 0.7503216298053028, 'loss_val': 0.5621922801816848, 'psi': 0.7280248133466145}
[S14] START round=12 head_norm_before_train=0.857166 cos_to_last_merge=1.0000 (last merge round=11)
[S14] round=12 local utility u=0.032918 metrics={'f1_val': 0.6205637456666455, 'auprc': 0.9929285584963159, 'loss_val': 0.6838896709916086, 'psi': 0.7695096707985136}-{'f1_val': 0.6204752500914243, 'auprc': 0.9955886882423581, 'loss_val': 0.7571750561970089, 'psi': 0.7705206253517978}
[S15] START round=12 head_norm_before_train=0.626888 cos_to_last_merge=1.0000 (last merge round=11)
[S15] round=12 local utility u=0.029211 metrics={'f1_val': 0.43677143455768613, 'auprc': 0.6652949899489382, 'loss_val': 0.9289238174666956, 'psi': 0.528180856714187}-{'f1_val': 0.4336187231008853, 'auprc': 0.6659491832044113, 'loss_val': 0.9703928880604635, 'psi': 0.5265509071422957}
[S16] START round=12 head_norm_before_train=0.768124 cos_to_last_merge=1.0000 (last merge round=11)
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.3501058036266056, 'auprc': 0.714627276668126, 'loss_val': 0.9635179550731459, 'psi': 0.4959143928432137}-{'f1_val': 0.43525436414180135, 'auprc': 0.6957365766520333, 'loss_val': 0.9399784231308058, 'psi': 0.5394472491458941}
[S17] START round=12 head_norm_before_train=1.208637 cos_to_last_merge=0.8382 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.3336800087671442, 'auprc': 0.6886169339548978, 'loss_val': 1.0262282956076918, 'psi': 0.4756547788422456}-{'f1_val': 0.33415063946469914, 'auprc': 0.7551752975466222, 'loss_val': 0.9929301521856952, 'psi': 0.5025605026974683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S16@127.0.0.1:44616
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:44610
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S16@127.0.0.1:44616
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:44604
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:44609
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S5] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=0.3614
[S15] RECEIVED delta(kind=head bytes=1796) from S14
[S15] cosine check vs S14: cos=0.7844
[S4] RECEIVED delta(kind=head bytes=1798) from S8
[S4] cosine check vs S8: cos=0.3002
[S8] RECEIVED delta(kind=head bytes=1796) from S4
[S8] cosine check vs S4: cos=0.3002
[S16] RECEIVED delta(kind=head bytes=1795) from S11
[S16] cosine check vs S11: cos=0.5086
[S9] RECEIVED delta(kind=head bytes=1795) from S10
[S9] cosine check vs S10: cos=0.4388
[S8] RECEIVED delta(kind=head bytes=1799) from S15
[S8] cosine check vs S15: cos=0.7060
[S16] RECEIVED delta(kind=head bytes=1802) from S7
[S16] cosine check vs S7: cos=0.5849
[S9] RECEIVED delta(kind=head bytes=1792) from S5
[S9] cosine check vs S5: cos=0.8832
[S9] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=12 metric=0.7014 head_norm=0.976241
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.914116e-01
[S9] stored merged vector for next round verification (round=12)
[S9] DEBUG after merge:  round=12 metric=0.7014 head_norm=0.917241 delta_norm=0.191412
[S9] aggregate: ACCEPT kept=['S10', 'S5'] (k=2/2) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.6206 head_norm=0.909286
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.334284e-01
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.6203 head_norm=0.778061 delta_norm=0.533428
[S14] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=12 metric=0.9507 head_norm=1.029221
[S4] _apply_head_vector_avg (torch): Δ‖w‖=5.496347e-01
[S4] stored merged vector for next round verification (round=12)
[S4] DEBUG after merge:  round=12 metric=0.6482 head_norm=0.741856 delta_norm=0.549635
[S4] aggregate: ROLLBACK (f1_val pre=0.951 post=0.648 tol_abs=0.005 tol_rel=0.0)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=12 metric=0.4368 head_norm=0.669911
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.828045e-01
[S15] stored merged vector for next round verification (round=12)
[S15] DEBUG after merge:  round=12 metric=0.4368 head_norm=0.746868 delta_norm=0.282805
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=12 metric=0.7138 head_norm=0.803492
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.438508e-01
[S8] stored merged vector for next round verification (round=12)
[S8] DEBUG after merge:  round=12 metric=0.7137 head_norm=0.657540 delta_norm=0.343851
[S8] aggregate: ACCEPT kept=['S4', 'S15'] (k=2/2) mode=median trim_p=0.1
[S16] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=12 metric=0.3501 head_norm=0.817023
[S16] _apply_head_vector_avg (torch): Δ‖w‖=3.032298e-01
[S16] stored merged vector for next round verification (round=12)
[S16] DEBUG after merge:  round=12 metric=0.4147 head_norm=0.831847 delta_norm=0.303230
[S16] aggregate: ACCEPT kept=['S11', 'S7'] (k=2/2) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.540580 (no previous merge yet)
[S2] round=13 local utility u=0.033536 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6710282594030836, 'loss_val': 0.3657256146988392, 'psi': 0.6891973825849547}-{'f1_val': 0.7015710590385817, 'auprc': 0.6617112060353454, 'loss_val': 0.406412142907144, 'psi': 0.6856271178372872}
[S3] START round=13 head_norm_before_train=1.523649 (no previous merge yet)
[S3] round=13 local utility u=0.026060 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986375127081837, 'loss_val': 0.32625425909882594, 'psi': 0.8198635808824744}-{'f1_val': 0.7010863553524592, 'auprc': 0.9988751801670461, 'loss_val': 0.381519766309075, 'psi': 0.820201885278294}
[S4] START round=13 head_norm_before_train=0.741856 cos_to_last_merge=1.0000 (last merge round=12)
[S4] round=13 local utility u=0.012422 metrics={'f1_val': 0.9510055476350359, 'auprc': 0.9511931970640938, 'loss_val': 0.7179267462746299, 'psi': 0.951080607406659}-{'f1_val': 0.9507490971822232, 'auprc': 0.9528617876756844, 'loss_val': 0.7462369801382888, 'psi': 0.9515941733796077}
[S5] START round=13 head_norm_before_train=1.226773 cos_to_last_merge=0.8907 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.891
[S5] round=13 local utility u=0.020019 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.7904856278172474, 'loss_val': 0.4166620801086536, 'psi': 0.7365592867245035}-{'f1_val': 0.7008569501491988, 'auprc': 0.7882734909125955, 'loss_val': 0.45155416318370706, 'psi': 0.7358235664545574}
[S6] START round=13 head_norm_before_train=1.541178 (no previous merge yet)
[S6] round=13 local utility u=0.000000 metrics={'f1_val': 0.5894619040085356, 'auprc': 0.7816122924092967, 'loss_val': 0.6503236504367876, 'psi': 0.66632205936884}-{'f1_val': 0.6183352575553521, 'auprc': 0.8024135689590419, 'loss_val': 0.5191121169987992, 'psi': 0.691966582116828}
[S7] START round=13 head_norm_before_train=1.402974 (no previous merge yet)
[S7] round=13 local utility u=0.044431 metrics={'f1_val': 0.6599367087048287, 'auprc': 0.7835342800924885, 'loss_val': 0.6730007363883944, 'psi': 0.7093757372598926}-{'f1_val': 0.6612767392655253, 'auprc': 0.7785041119603817, 'loss_val': 0.7548129845260848, 'psi': 0.7081676883434679}
[S8] START round=13 head_norm_before_train=0.657540 cos_to_last_merge=1.0000 (last merge round=12)
[S8] round=13 local utility u=0.000000 metrics={'f1_val': 0.7138869500399027, 'auprc': 0.9924285739657583, 'loss_val': 0.6557138717973855, 'psi': 0.8253035996102449}-{'f1_val': 0.7137586021136586, 'auprc': 0.9936937370488571, 'loss_val': 0.6280962228637582, 'psi': 0.825732656087738}
[S9] START round=13 head_norm_before_train=0.917241 cos_to_last_merge=1.0000 (last merge round=12)
[S9] round=13 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9009420591538173, 'loss_val': 0.4509405594568749, 'psi': 0.7811511137860649}-{'f1_val': 0.7013646677191758, 'auprc': 0.9986136342580209, 'loss_val': 0.4880521763580343, 'psi': 0.8202642543347138}
[S10] START round=13 head_norm_before_train=1.287757 cos_to_last_merge=0.8955 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=13 local utility u=0.777170 metrics={'f1_val': 0.9431210380026455, 'auprc': 0.9905085122834634, 'loss_val': 0.25149894436907416, 'psi': 0.9620760277149726}-{'f1_val': 0.6997185165696, 'auprc': 0.9896531870385404, 'loss_val': 0.34285698011647686, 'psi': 0.8156923847571762}
[S11] START round=13 head_norm_before_train=1.274547 cos_to_last_merge=0.8449 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.845
[S11] round=13 local utility u=0.040414 metrics={'f1_val': 0.9575857740575427, 'auprc': 0.9980290491802167, 'loss_val': 0.22825976987579727, 'psi': 0.9737630841066124}-{'f1_val': 0.9554452909198413, 'auprc': 0.9983321212099876, 'loss_val': 0.2971535327689389, 'psi': 0.9726000230358999}
[S13] START round=13 head_norm_before_train=1.484996 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.7106471833078825, 'auprc': 0.7450700175395628, 'loss_val': 0.5762231869644279, 'psi': 0.7244163170005546}-{'f1_val': 0.7131602690408223, 'auprc': 0.7558712350799157, 'loss_val': 0.588491546480327, 'psi': 0.7302446554564597}
[S14] START round=13 head_norm_before_train=0.778061 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=1.000000 metrics={'f1_val': 0.9800278378984069, 'auprc': 0.9970867074140843, 'loss_val': 0.6339590804830365, 'psi': 0.9868513857046778}-{'f1_val': 0.6205637456666455, 'auprc': 0.9929285584963159, 'loss_val': 0.6838896709916086, 'psi': 0.7695096707985136}
[S15] START round=13 head_norm_before_train=0.746868 cos_to_last_merge=1.0000 (last merge round=12)
[S15] round=13 local utility u=0.803757 metrics={'f1_val': 0.6986252939208907, 'auprc': 0.6641879209524183, 'loss_val': 0.889211841441083, 'psi': 0.6848503447335017}-{'f1_val': 0.43677143455768613, 'auprc': 0.6652949899489382, 'loss_val': 0.9289238174666956, 'psi': 0.528180856714187}
[S16] START round=13 head_norm_before_train=0.831847 cos_to_last_merge=1.0000 (last merge round=12)
[S16] round=13 local utility u=0.288966 metrics={'f1_val': 0.42895607369620403, 'auprc': 0.7398784220357774, 'loss_val': 0.9344418482087771, 'psi': 0.5533250130320333}-{'f1_val': 0.3501058036266056, 'auprc': 0.714627276668126, 'loss_val': 0.9635179550731459, 'psi': 0.4959143928432137}
[S17] START round=13 head_norm_before_train=1.234218 cos_to_last_merge=0.8259 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.826
[S17] round=13 local utility u=0.091913 metrics={'f1_val': 0.33881874466987516, 'auprc': 0.7229611756747318, 'loss_val': 0.9762679688936006, 'psi': 0.4924757170718178}-{'f1_val': 0.3336800087671442, 'auprc': 0.6886169339548978, 'loss_val': 1.0262282956076918, 'psi': 0.4756547788422456}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44612
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S3] sending update (kind=head size=1808 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:44614
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:44604
[S16] sending update (kind=head size=1798 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S16
[S11] cosine check vs S16: cos=0.6200
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.8075
[S4] RECEIVED delta(kind=head bytes=1799) from S5
[S4] cosine check vs S5: cos=0.0279
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.9019
[S9] RECEIVED delta(kind=head bytes=1797) from S14
[S9] cosine check vs S14: cos=0.8278
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=13 metric=0.7139 head_norm=0.711063
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.704174e-01
[S8] stored merged vector for next round verification (round=13)
[S8] DEBUG after merge:  round=13 metric=0.7139 head_norm=0.731545 delta_norm=0.170417
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=13 metric=0.9576 head_norm=1.321494
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.190877e-01
[S11] stored merged vector for next round verification (round=13)
[S11] DEBUG after merge:  round=13 metric=0.9576 head_norm=0.991841 delta_norm=0.519088
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.7013 head_norm=0.978135
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.745536e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.7013 head_norm=0.863865 delta_norm=0.274554
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=13 metric=0.9510 head_norm=0.789170
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.313216e-01
[S4] stored merged vector for next round verification (round=13)
[S4] DEBUG after merge:  round=13 metric=0.3900 head_norm=0.749923 delta_norm=0.731322
[S4] aggregate: ROLLBACK (f1_val pre=0.951 post=0.390 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=13 metric=0.9800 head_norm=0.828575
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.512641e-01
[S14] stored merged vector for next round verification (round=13)
[S14] DEBUG after merge:  round=13 metric=0.9971 head_norm=0.767466 delta_norm=0.251264
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.575946 (no previous merge yet)
[S2] round=14 local utility u=0.020850 metrics={'f1_val': 0.7013120848906231, 'auprc': 0.6700565856825774, 'loss_val': 0.32112293898043937, 'psi': 0.6888098852074048}-{'f1_val': 0.7013101313728686, 'auprc': 0.6710282594030836, 'loss_val': 0.3657256146988392, 'psi': 0.6891973825849547}
[S3] START round=14 head_norm_before_train=1.555086 (no previous merge yet)
[S3] round=14 local utility u=0.008534 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9988735178830976, 'loss_val': 0.3114224746655175, 'psi': 0.8201107547343839}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986375127081837, 'loss_val': 0.32625425909882594, 'psi': 0.8198635808824744}
[S4] START round=14 head_norm_before_train=0.749923 cos_to_last_merge=1.0000 (last merge round=13)
[S4] round=14 local utility u=0.000000 metrics={'f1_val': 0.9545444892186778, 'auprc': 0.947040537048614, 'loss_val': 0.8781775952308253, 'psi': 0.9515429083506523}-{'f1_val': 0.9510055476350359, 'auprc': 0.9511931970640938, 'loss_val': 0.7179267462746299, 'psi': 0.951080607406659}
[S5] START round=14 head_norm_before_train=1.253652 cos_to_last_merge=0.8828 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.883
[S5] round=14 local utility u=0.060207 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.8123395374792343, 'loss_val': 0.361808820921545, 'psi': 0.7453008505892983}-{'f1_val': 0.7006083926626743, 'auprc': 0.7904856278172474, 'loss_val': 0.4166620801086536, 'psi': 0.7365592867245035}
[S6] START round=14 head_norm_before_train=1.568707 (no previous merge yet)
[S6] round=14 local utility u=1.000000 metrics={'f1_val': 0.7955130548539138, 'auprc': 0.9870196761473604, 'loss_val': 0.25169095077774545, 'psi': 0.8721157033712924}-{'f1_val': 0.5894619040085356, 'auprc': 0.7816122924092967, 'loss_val': 0.6503236504367876, 'psi': 0.66632205936884}
[S7] START round=14 head_norm_before_train=1.427878 (no previous merge yet)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.634037728093724, 'auprc': 0.7989188602427365, 'loss_val': 0.6783489848373941, 'psi': 0.6999901809533291}-{'f1_val': 0.6599367087048287, 'auprc': 0.7835342800924885, 'loss_val': 0.6730007363883944, 'psi': 0.7093757372598926}
[S8] START round=14 head_norm_before_train=0.731545 cos_to_last_merge=1.0000 (last merge round=13)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.8401085226376415, 'loss_val': 0.631616731801892, 'psi': 0.7645868722937541}-{'f1_val': 0.7138869500399027, 'auprc': 0.9924285739657583, 'loss_val': 0.6557138717973855, 'psi': 0.8253035996102449}
[S9] START round=14 head_norm_before_train=0.863865 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.174598 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988096702502719, 'loss_val': 0.39579327331258213, 'psi': 0.8203426687316142}-{'f1_val': 0.7012904835408967, 'auprc': 0.9009420591538173, 'loss_val': 0.4509405594568749, 'psi': 0.7811511137860649}
[S10] START round=14 head_norm_before_train=1.328921 cos_to_last_merge=0.8888 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=14 local utility u=0.177844 metrics={'f1_val': 0.9922748809267548, 'auprc': 0.9970963600412077, 'loss_val': 0.21049833922120978, 'psi': 0.9942034725725359}-{'f1_val': 0.9431210380026455, 'auprc': 0.9905085122834634, 'loss_val': 0.25149894436907416, 'psi': 0.9620760277149726}
[S11] START round=14 head_norm_before_train=0.991841 cos_to_last_merge=1.0000 (last merge round=13)
[S11] round=14 local utility u=0.000000 metrics={'f1_val': 0.9089587769433963, 'auprc': 0.9905688941110342, 'loss_val': 0.4271082736680163, 'psi': 0.9416028238104515}-{'f1_val': 0.9575857740575427, 'auprc': 0.9980290491802167, 'loss_val': 0.22825976987579727, 'psi': 0.9737630841066124}
[S13] START round=14 head_norm_before_train=1.501930 (no previous merge yet)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.5810928810740836, 'auprc': 0.722925318046834, 'loss_val': 0.640783939841923, 'psi': 0.6378258558631837}-{'f1_val': 0.7106471833078825, 'auprc': 0.7450700175395628, 'loss_val': 0.5762231869644279, 'psi': 0.7244163170005546}
[S14] START round=14 head_norm_before_train=0.767466 cos_to_last_merge=1.0000 (last merge round=13)
[S14] round=14 local utility u=0.110738 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9956520966517021, 'loss_val': 0.5139019807940391, 'psi': 0.9968498656211481}-{'f1_val': 0.9800278378984069, 'auprc': 0.9970867074140843, 'loss_val': 0.6339590804830365, 'psi': 0.9868513857046778}
[S15] START round=14 head_norm_before_train=0.785964 cos_to_last_merge=0.9910 (last merge round=12)
[S15] round=14 local utility u=0.058387 metrics={'f1_val': 0.6205851999481902, 'auprc': 0.8118877617624103, 'loss_val': 0.7472961754146592, 'psi': 0.6971062246738782}-{'f1_val': 0.6986252939208907, 'auprc': 0.6641879209524183, 'loss_val': 0.889211841441083, 'psi': 0.6848503447335017}
[S16] START round=14 head_norm_before_train=0.871810 cos_to_last_merge=0.9959 (last merge round=12)
[S16] round=14 local utility u=0.000000 metrics={'f1_val': 0.3910211861825341, 'auprc': 0.7459808146062475, 'loss_val': 0.887454230882169, 'psi': 0.5330050375520194}-{'f1_val': 0.42895607369620403, 'auprc': 0.7398784220357774, 'loss_val': 0.9344418482087771, 'psi': 0.5533250130320333}
[S17] START round=14 head_norm_before_train=1.256253 cos_to_last_merge=0.8163 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.816
[S17] round=14 local utility u=0.253534 metrics={'f1_val': 0.35128646312201794, 'auprc': 0.8523715771111849, 'loss_val': 0.9322365630030386, 'psi': 0.5517205087176847}-{'f1_val': 0.33881874466987516, 'auprc': 0.7229611756747318, 'loss_val': 0.9762679688936006, 'psi': 0.4924757170718178}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:44611
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] → sending delta(kind=head bytes=1805) to S14@127.0.0.1:44614
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:44604
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:44610
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1795) from S5
[S4] cosine check vs S5: cos=0.7972
[S9] RECEIVED delta(kind=head bytes=1797) from S14
[S9] cosine check vs S14: cos=0.8104
[S14] RECEIVED delta(kind=head bytes=1805) from S15
[S14] cosine check vs S15: cos=0.9231
[S10] RECEIVED delta(kind=head bytes=1800) from S9
[S10] cosine check vs S9: cos=0.5918
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=14 metric=0.9545 head_norm=0.776063
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.053139e-01
[S4] stored merged vector for next round verification (round=14)
[S4] DEBUG after merge:  round=14 metric=0.3919 head_norm=0.977898 delta_norm=0.405314
[S4] aggregate: ROLLBACK (f1_val pre=0.955 post=0.392 tol_abs=0.005 tol_rel=0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.9923 head_norm=1.370275
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.552241e-01
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.9668 head_norm=1.028897 delta_norm=0.555224
[S10] aggregate: ROLLBACK (f1_val pre=0.992 post=0.967 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=14 metric=0.7014 head_norm=0.925285
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.739423e-01
[S9] stored merged vector for next round verification (round=14)
[S9] DEBUG after merge:  round=14 metric=0.7014 head_norm=0.834594 delta_norm=0.273942
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9976 head_norm=0.828874
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.630494e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9968 head_norm=0.815059 delta_norm=0.163049
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.605333 (no previous merge yet)
[S2] round=15 local utility u=0.014468 metrics={'f1_val': 0.7013101313728686, 'auprc': 0.6725358135184174, 'loss_val': 0.29961233939283194, 'psi': 0.6898004042310881}-{'f1_val': 0.7013120848906231, 'auprc': 0.6700565856825774, 'loss_val': 0.32112293898043937, 'psi': 0.6888098852074048}
[S3] START round=15 head_norm_before_train=1.584826 (no previous merge yet)
[S3] round=15 local utility u=0.014832 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9986625094222152, 'loss_val': 0.27959750858179894, 'psi': 0.8198735795680869}-{'f1_val': 0.7009355793019081, 'auprc': 0.9988735178830976, 'loss_val': 0.3114224746655175, 'psi': 0.8201107547343839}
[S4] START round=15 head_norm_before_train=0.977898 cos_to_last_merge=1.0000 (last merge round=14)
[S4] round=15 local utility u=0.013678 metrics={'f1_val': 0.9566962869685841, 'auprc': 0.965463706290751, 'loss_val': 0.9190025463974911, 'psi': 0.9602032546974508}-{'f1_val': 0.9545444892186778, 'auprc': 0.947040537048614, 'loss_val': 0.8781775952308253, 'psi': 0.9515429083506523}
[S5] START round=15 head_norm_before_train=1.280177 cos_to_last_merge=0.8752 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=15 local utility u=0.296159 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9979345630549363, 'loss_val': 0.3262804792796312, 'psi': 0.819539281625443}-{'f1_val': 0.7006083926626743, 'auprc': 0.8123395374792343, 'loss_val': 0.361808820921545, 'psi': 0.7453008505892983}
[S6] START round=15 head_norm_before_train=1.592896 (no previous merge yet)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.6194480855772242, 'auprc': 0.8060459384967205, 'loss_val': 0.5286950251963501, 'psi': 0.6940872267450227}-{'f1_val': 0.7955130548539138, 'auprc': 0.9870196761473604, 'loss_val': 0.25169095077774545, 'psi': 0.8721157033712924}
[S7] START round=15 head_norm_before_train=1.450060 (no previous merge yet)
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.42199684911208163, 'auprc': 0.767341880323156, 'loss_val': 0.8575270003480274, 'psi': 0.5601348615965114}-{'f1_val': 0.634037728093724, 'auprc': 0.7989188602427365, 'loss_val': 0.6783489848373941, 'psi': 0.6999901809533291}
[S8] START round=15 head_norm_before_train=0.789153 cos_to_last_merge=0.9955 (last merge round=13)
[S8] round=15 local utility u=0.336910 metrics={'f1_val': 0.7138229449839267, 'auprc': 0.9982467791165928, 'loss_val': 0.42971509717356227, 'psi': 0.8275924786369931}-{'f1_val': 0.7142391053978291, 'auprc': 0.8401085226376415, 'loss_val': 0.631616731801892, 'psi': 0.7645868722937541}
[S9] START round=15 head_norm_before_train=0.834594 cos_to_last_merge=1.0000 (last merge round=14)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980703109290348, 'loss_val': 0.39330280345133606, 'psi': 0.820002414496152}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988096702502719, 'loss_val': 0.39579327331258213, 'psi': 0.8203426687316142}
[S10] START round=15 head_norm_before_train=1.028897 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9926684512508086, 'auprc': 0.9971864683740489, 'loss_val': 0.26766153428042344, 'psi': 0.9944756581001047}-{'f1_val': 0.9922748809267548, 'auprc': 0.9970963600412077, 'loss_val': 0.21049833922120978, 'psi': 0.9942034725725359}
[S11] START round=15 head_norm_before_train=1.032876 cos_to_last_merge=0.9993 (last merge round=13)
[S11] round=15 local utility u=0.289528 metrics={'f1_val': 0.974192820281264, 'auprc': 0.9977888633978396, 'loss_val': 0.26111688441092834, 'psi': 0.9836312375278942}-{'f1_val': 0.9089587769433963, 'auprc': 0.9905688941110342, 'loss_val': 0.4271082736680163, 'psi': 0.9416028238104515}
[S13] START round=15 head_norm_before_train=1.516262 (no previous merge yet)
[S13] round=15 local utility u=0.380885 metrics={'f1_val': 0.6867858011615999, 'auprc': 0.7488065340807881, 'loss_val': 0.5908159413844435, 'psi': 0.7115940943292751}-{'f1_val': 0.5810928810740836, 'auprc': 0.722925318046834, 'loss_val': 0.640783939841923, 'psi': 0.6378258558631837}
[S14] START round=15 head_norm_before_train=0.815059 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.030343 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9954877151594353, 'loss_val': 0.4527396301502503, 'psi': 0.9967857568936863}-{'f1_val': 0.9976483782674455, 'auprc': 0.9956520966517021, 'loss_val': 0.5139019807940391, 'psi': 0.9968498656211481}
[S15] START round=15 head_norm_before_train=0.833536 cos_to_last_merge=0.9721 (last merge round=12)
[S15] round=15 local utility u=0.240673 metrics={'f1_val': 0.6907600916009692, 'auprc': 0.7987606187802825, 'loss_val': 0.647617206041745, 'psi': 0.7339603024726946}-{'f1_val': 0.6205851999481902, 'auprc': 0.8118877617624103, 'loss_val': 0.7472961754146592, 'psi': 0.6971062246738782}
[S16] START round=15 head_norm_before_train=0.919481 cos_to_last_merge=0.9853 (last merge round=12)
[S16] round=15 local utility u=0.568481 metrics={'f1_val': 0.5482087804378284, 'auprc': 0.779946020198893, 'loss_val': 0.7955138598811434, 'psi': 0.6409036763422542}-{'f1_val': 0.3910211861825341, 'auprc': 0.7459808146062475, 'loss_val': 0.887454230882169, 'psi': 0.5330050375520194}
[S17] START round=15 head_norm_before_train=1.275505 cos_to_last_merge=0.8081 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.808
[S17] round=15 local utility u=0.050967 metrics={'f1_val': 0.3532160952819635, 'auprc': 0.8817776091234135, 'loss_val': 0.9300978493242723, 'psi': 0.5646407008185436}-{'f1_val': 0.35128646312201794, 'auprc': 0.8523715771111849, 'loss_val': 0.9322365630030386, 'psi': 0.5517205087176847}
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S17
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S16
[S8]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S7
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S15
[S14]  timeout peer S16
[S14]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S2
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:44609
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:44610
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:44614
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:44615
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:44612
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] → sending delta(kind=head bytes=1790) to S4@127.0.0.1:44604
[S4] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S5] sending update (kind=head size=1790 to 1 peers)
[S15] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1796) from S15
[S14] cosine check vs S15: cos=0.9572
[S4] RECEIVED delta(kind=head bytes=1790) from S5
[S4] cosine check vs S5: cos=0.9406
[S9] RECEIVED delta(kind=head bytes=1791) from S14
[S9] cosine check vs S14: cos=0.8638
[S8] RECEIVED delta(kind=head bytes=1797) from S4
[S8] cosine check vs S4: cos=0.3034
[S15] RECEIVED delta(kind=head bytes=1796) from S8
[S15] cosine check vs S8: cos=0.6496
[S11] RECEIVED delta(kind=head bytes=1798) from S16
[S11] cosine check vs S16: cos=0.8101
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=15 metric=0.7138 head_norm=0.846607
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.450947e-01
[S8] stored merged vector for next round verification (round=15)
[S8] DEBUG after merge:  round=15 metric=0.7150 head_norm=0.742581 delta_norm=0.545095
[S8] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.317 → S15@127.0.0.1:44615
[S5] ⇄ pheromone p=0.182 → S4@127.0.0.1:44604
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.6908 head_norm=0.883607
[S15] _apply_head_vector_avg (torch): Δ‖w‖=3.624876e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.6965 head_norm=0.785720 delta_norm=0.362488
[S15] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S15] ⇄ pheromone p=0.245 → S14@127.0.0.1:44614
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=15 metric=0.9567 head_norm=0.990135
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.514288e-01
[S4] stored merged vector for next round verification (round=15)
[S4] DEBUG after merge:  round=15 metric=0.1658 head_norm=1.130775 delta_norm=0.251429
[S4] aggregate: ROLLBACK (f1_val pre=0.957 post=0.166 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.172 → S8@127.0.0.1:44609
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=15 metric=0.7013 head_norm=0.892783
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.308390e-01
[S9] stored merged vector for next round verification (round=15)
[S9] DEBUG after merge:  round=15 metric=0.7013 head_norm=0.853379 delta_norm=0.230839
[S9] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.194 → S10@127.0.0.1:44611
[S14] CommDone barrier timeout: have=1 need=2 — continuing
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9977 head_norm=0.875228
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.286863e-01
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9977 head_norm=0.869962 delta_norm=0.128686
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.293 → S9@127.0.0.1:44610
[S16] CommDone barrier timeout: have=1 need=3 — continuing
[S16] ⇄ pheromone p=0.256 → S11@127.0.0.1:44612
[S2] START round=16 head_norm_before_train=1.633572 (no previous merge yet)
[S2] round=16 local utility u=0.012547 metrics={'f1_val': 0.701230889339113, 'auprc': 0.6789141508439311, 'loss_val': 0.2931778619030831, 'psi': 0.6923041939410403}-{'f1_val': 0.7013101313728686, 'auprc': 0.6725358135184174, 'loss_val': 0.29961233939283194, 'psi': 0.6898004042310881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=16 head_norm_before_train=1.610692 (no previous merge yet)
[S3] round=16 local utility u=0.005899 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983310178003801, 'loss_val': 0.26635456441621275, 'psi': 0.8196960086202754}-{'f1_val': 0.7006809596653347, 'auprc': 0.9986625094222152, 'loss_val': 0.27959750858179894, 'psi': 0.8198735795680869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=16 head_norm_before_train=1.130775 cos_to_last_merge=1.0000 (last merge round=15)
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.6638689408684605, 'auprc': 0.9511273720667119, 'loss_val': 0.8715084799093052, 'psi': 0.7787723133477611}-{'f1_val': 0.9566962869685841, 'auprc': 0.965463706290751, 'loss_val': 0.9190025463974911, 'psi': 0.9602032546974508}
[S5] START round=16 head_norm_before_train=1.305133 cos_to_last_merge=0.8680 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.868
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.7096180239148043, 'auprc': 0.7932332839991212, 'loss_val': 0.38232682227926396, 'psi': 0.743064127948531}-{'f1_val': 0.7006090940057808, 'auprc': 0.9979345630549363, 'loss_val': 0.3262804792796312, 'psi': 0.819539281625443}
[S6] START round=16 head_norm_before_train=1.613632 (no previous merge yet)
[S6] round=16 local utility u=0.105988 metrics={'f1_val': 0.640577544596743, 'auprc': 0.8123681142867217, 'loss_val': 0.46246244488030386, 'psi': 0.7092937724727344}-{'f1_val': 0.6194480855772242, 'auprc': 0.8060459384967205, 'loss_val': 0.5286950251963501, 'psi': 0.6940872267450227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=16 head_norm_before_train=1.471627 (no previous merge yet)
[S7] round=16 local utility u=0.971148 metrics={'f1_val': 0.6638162925820505, 'auprc': 0.8244579856713369, 'loss_val': 0.5374951813774733, 'psi': 0.728072969817765}-{'f1_val': 0.42199684911208163, 'auprc': 0.767341880323156, 'loss_val': 0.8575270003480274, 'psi': 0.5601348615965114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=16 head_norm_before_train=0.742581 cos_to_last_merge=1.0000 (last merge round=15)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7139540394217572, 'auprc': 0.9947141872507443, 'loss_val': 0.5316131346480408, 'psi': 0.8262580985533521}-{'f1_val': 0.7138229449839267, 'auprc': 0.9982467791165928, 'loss_val': 0.42971509717356227, 'psi': 0.8275924786369931}
[S9] START round=16 head_norm_before_train=0.853379 cos_to_last_merge=1.0000 (last merge round=15)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9980496905558136, 'loss_val': 0.39932005682960203, 'psi': 0.8199941663468635}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980703109290348, 'loss_val': 0.39330280345133606, 'psi': 0.820002414496152}
[S10] START round=16 head_norm_before_train=1.069135 cos_to_last_merge=0.9991 (last merge round=14)
[S10] round=16 local utility u=0.019186 metrics={'f1_val': 0.992682502444211, 'auprc': 0.9944366959572939, 'loss_val': 0.2211248568328046, 'psi': 0.9933841798494442}-{'f1_val': 0.9926684512508086, 'auprc': 0.9971864683740489, 'loss_val': 0.26766153428042344, 'psi': 0.9944756581001047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=16 head_norm_before_train=1.076279 cos_to_last_merge=0.9975 (last merge round=13)
[S11] round=16 local utility u=0.000000 metrics={'f1_val': 0.9218692084910994, 'auprc': 0.9976872142590111, 'loss_val': 0.29199929423354126, 'psi': 0.9521964107982641}-{'f1_val': 0.974192820281264, 'auprc': 0.9977888633978396, 'loss_val': 0.26111688441092834, 'psi': 0.9836312375278942}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9219 head_norm=1.114740
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.350099e-01
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9209 head_norm=0.992374 delta_norm=0.335010
[S11] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S13] START round=16 head_norm_before_train=1.526487 (no previous merge yet)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.6215834973187888, 'auprc': 0.7612285814423161, 'loss_val': 0.5990087634729133, 'psi': 0.6774415309681998}-{'f1_val': 0.6867858011615999, 'auprc': 0.7488065340807881, 'loss_val': 0.5908159413844435, 'psi': 0.7115940943292751}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=16 head_norm_before_train=0.869962 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.031483 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9955864348401278, 'loss_val': 0.3851442706889692, 'psi': 0.996332622031378}-{'f1_val': 0.9976511180498535, 'auprc': 0.9954877151594353, 'loss_val': 0.4527396301502503, 'psi': 0.9967857568936863}
[S15] START round=16 head_norm_before_train=0.785720 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.370091 metrics={'f1_val': 0.6948310584692783, 'auprc': 0.9903032329523717, 'loss_val': 0.5064889684935967, 'psi': 0.8130199282625157}-{'f1_val': 0.6907600916009692, 'auprc': 0.7987606187802825, 'loss_val': 0.647617206041745, 'psi': 0.7339603024726946}
[S16] START round=16 head_norm_before_train=0.975413 cos_to_last_merge=0.9706 (last merge round=12)
[S16] round=16 local utility u=0.156454 metrics={'f1_val': 0.5323705159965103, 'auprc': 0.856649713256447, 'loss_val': 0.6176879243512641, 'psi': 0.662082194900485}-{'f1_val': 0.5482087804378284, 'auprc': 0.779946020198893, 'loss_val': 0.7955138598811434, 'psi': 0.6409036763422542}
[S17] START round=16 head_norm_before_train=1.294018 cos_to_last_merge=0.8011 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.801
[S17] round=16 local utility u=0.000000 metrics={'f1_val': 0.3530289445322021, 'auprc': 0.8320214947760002, 'loss_val': 0.9497200993956477, 'psi': 0.5446259646297213}-{'f1_val': 0.3532160952819635, 'auprc': 0.8817776091234135, 'loss_val': 0.9300978493242723, 'psi': 0.5646407008185436}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:44614
[S15] sending update (kind=head size=1797 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.8953
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14]  timeout peer S3
[S14]  timeout peer S9
[S14]  timeout peer S13
[S9]  timeout peer S5
[S9]  timeout peer S10
[S4]  timeout peer S6
[S4]  timeout peer S8
[S15]  timeout peer S14
[S15]  timeout peer S16
[S5]  timeout peer S4
[S8]  timeout peer S15
[S16]  timeout peer S2
[S16]  timeout peer S7
[S16]  timeout peer S11
[S16]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=16 metric=0.9968 head_norm=0.925557
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.061405e-01
[S14] stored merged vector for next round verification (round=16)
[S14] DEBUG after merge:  round=16 metric=0.9966 head_norm=0.855885 delta_norm=0.206141
[S14] aggregate: ACCEPT kept=['S15'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.656036 (no previous merge yet)
[S2] round=17 local utility u=0.012110 metrics={'f1_val': 0.701230889339113, 'auprc': 0.689254513752643, 'loss_val': 0.299979837679151, 'psi': 0.6964403391045251}-{'f1_val': 0.701230889339113, 'auprc': 0.6789141508439311, 'loss_val': 0.2931778619030831, 'psi': 0.6923041939410403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=17 head_norm_before_train=1.638826 (no previous merge yet)
[S3] round=17 local utility u=0.013705 metrics={'f1_val': 0.7006809596653347, 'auprc': 0.9987007608919275, 'loss_val': 0.24050421112995277, 'psi': 0.8198888801559718}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983310178003801, 'loss_val': 0.26635456441621275, 'psi': 0.8196960086202754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=17 head_norm_before_train=1.141005 cos_to_last_merge=0.9939 (last merge round=15)
[S4] round=17 local utility u=0.955899 metrics={'f1_val': 0.9463983868742358, 'auprc': 0.9506051182024299, 'loss_val': 0.6533213877015189, 'psi': 0.9480810794055134}-{'f1_val': 0.6638689408684605, 'auprc': 0.9511273720667119, 'loss_val': 0.8715084799093052, 'psi': 0.7787723133477611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=17 head_norm_before_train=1.325019 cos_to_last_merge=0.8623 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.862
[S5] round=17 local utility u=0.207224 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9254493850143906, 'loss_val': 0.31046874626993776, 'psi': 0.7905447896033608}-{'f1_val': 0.7096180239148043, 'auprc': 0.7932332839991212, 'loss_val': 0.38232682227926396, 'psi': 0.743064127948531}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=17 head_norm_before_train=1.635270 (no previous merge yet)
[S6] round=17 local utility u=0.709944 metrics={'f1_val': 0.809368786749731, 'auprc': 0.9298273215832441, 'loss_val': 0.40769970821865664, 'psi': 0.8575522006831362}-{'f1_val': 0.640577544596743, 'auprc': 0.8123681142867217, 'loss_val': 0.46246244488030386, 'psi': 0.7092937724727344}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=17 head_norm_before_train=1.487878 (no previous merge yet)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.4064533540298504, 'auprc': 0.7730183535752533, 'loss_val': 0.9749348079677207, 'psi': 0.5530793538480115}-{'f1_val': 0.6638162925820505, 'auprc': 0.8244579856713369, 'loss_val': 0.5374951813774733, 'psi': 0.728072969817765}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=17 head_norm_before_train=0.789117 cos_to_last_merge=0.9954 (last merge round=15)
[S8] round=17 local utility u=0.047074 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.994187950466553, 'loss_val': 0.4375966994348999, 'psi': 0.8262186434253187}-{'f1_val': 0.7139540394217572, 'auprc': 0.9947141872507443, 'loss_val': 0.5316131346480408, 'psi': 0.8262580985533521}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] START round=17 head_norm_before_train=0.910003 cos_to_last_merge=0.9960 (last merge round=15)
[S9] round=17 local utility u=0.031260 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998585200671803, 'loss_val': 0.33885151383965545, 'psi': 0.8202528809002267}-{'f1_val': 0.7012904835408967, 'auprc': 0.9980496905558136, 'loss_val': 0.39932005682960203, 'psi': 0.8199941663468635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=17 head_norm_before_train=1.125402 cos_to_last_merge=0.9962 (last merge round=14)
[S10] round=17 local utility u=0.022637 metrics={'f1_val': 0.9930734810403055, 'auprc': 0.9965263677491317, 'loss_val': 0.18446487899688407, 'psi': 0.994454635723836}-{'f1_val': 0.992682502444211, 'auprc': 0.9944366959572939, 'loss_val': 0.2211248568328046, 'psi': 0.9933841798494442}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] START round=17 head_norm_before_train=0.992374 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.116267 metrics={'f1_val': 0.9608885736798384, 'auprc': 0.9977797411917038, 'loss_val': 0.29385867951063005, 'psi': 0.9756450406845846}-{'f1_val': 0.9218692084910994, 'auprc': 0.9976872142590111, 'loss_val': 0.29199929423354126, 'psi': 0.9521964107982641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=17 head_norm_before_train=1.536439 (no previous merge yet)
[S13] round=17 local utility u=0.201205 metrics={'f1_val': 0.6869936239672916, 'auprc': 0.7427625751716467, 'loss_val': 0.5336623745857834, 'psi': 0.7093012044490337}-{'f1_val': 0.6215834973187888, 'auprc': 0.7612285814423161, 'loss_val': 0.5990087634729133, 'psi': 0.6774415309681998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=17 head_norm_before_train=0.855885 cos_to_last_merge=1.0000 (last merge round=16)
[S14] round=17 local utility u=0.004974 metrics={'f1_val': 0.9974830777164877, 'auprc': 0.9954503087058242, 'loss_val': 0.37870599213411754, 'psi': 0.9966699701122222}-{'f1_val': 0.9968300801588782, 'auprc': 0.9955864348401278, 'loss_val': 0.3851442706889692, 'psi': 0.996332622031378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=17 head_norm_before_train=0.832712 cos_to_last_merge=0.9974 (last merge round=15)
[S15] round=17 local utility u=0.000000 metrics={'f1_val': 0.6986184249994525, 'auprc': 0.8004755473139571, 'loss_val': 0.48414319737891814, 'psi': 0.7393612739252544}-{'f1_val': 0.6948310584692783, 'auprc': 0.9903032329523717, 'loss_val': 0.5064889684935967, 'psi': 0.8130199282625157}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=17 head_norm_before_train=1.028352 cos_to_last_merge=0.9571 (last merge round=12)
[S16] round=17 local utility u=0.699327 metrics={'f1_val': 0.6744469416064218, 'auprc': 0.9783487248669892, 'loss_val': 0.43658974886798024, 'psi': 0.7960076549106487}-{'f1_val': 0.5323705159965103, 'auprc': 0.856649713256447, 'loss_val': 0.6176879243512641, 'psi': 0.662082194900485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=17 head_norm_before_train=1.304998 cos_to_last_merge=0.7974 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.797
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.3445264783600188, 'auprc': 0.8375876935237949, 'loss_val': 1.0146098746722667, 'psi': 0.5417509644255293}-{'f1_val': 0.3530289445322021, 'auprc': 0.8320214947760002, 'loss_val': 0.9497200993956477, 'psi': 0.5446259646297213}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.675582 (no previous merge yet)
[S2] round=18 local utility u=0.007596 metrics={'f1_val': 0.701230889339113, 'auprc': 0.6923698190341155, 'loss_val': 0.2941336868999151, 'psi': 0.6976864612171141}-{'f1_val': 0.701230889339113, 'auprc': 0.689254513752643, 'loss_val': 0.299979837679151, 'psi': 0.6964403391045251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=18 head_norm_before_train=1.660398 (no previous merge yet)
[S3] round=18 local utility u=0.008529 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9983610345429056, 'loss_val': 0.22197736077848707, 'psi': 0.8197080153172855}-{'f1_val': 0.7006809596653347, 'auprc': 0.9987007608919275, 'loss_val': 0.24050421112995277, 'psi': 0.8198888801559718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=18 head_norm_before_train=1.168632 cos_to_last_merge=0.9780 (last merge round=15)
[S4] round=18 local utility u=0.000000 metrics={'f1_val': 0.6621792530146123, 'auprc': 0.933891877217089, 'loss_val': 0.5423851429824945, 'psi': 0.770864302695603}-{'f1_val': 0.9463983868742358, 'auprc': 0.9506051182024299, 'loss_val': 0.6533213877015189, 'psi': 0.9480810794055134}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=18 head_norm_before_train=1.342611 cos_to_last_merge=0.8577 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.858
[S5] round=18 local utility u=0.115538 metrics={'f1_val': 0.7006090940057808, 'auprc': 0.9976847571631485, 'loss_val': 0.29610265728305923, 'psi': 0.8194393592687279}-{'f1_val': 0.7006083926626743, 'auprc': 0.9254493850143906, 'loss_val': 0.31046874626993776, 'psi': 0.7905447896033608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=18 head_norm_before_train=1.656986 (no previous merge yet)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7458056502415429, 'auprc': 0.8065636874864703, 'loss_val': 0.5517675326073606, 'psi': 0.7701088651395138}-{'f1_val': 0.809368786749731, 'auprc': 0.9298273215832441, 'loss_val': 0.40769970821865664, 'psi': 0.8575522006831362}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.499024 (no previous merge yet)
[S7] round=18 local utility u=1.000000 metrics={'f1_val': 0.6726773845130398, 'auprc': 0.8668433735230454, 'loss_val': 0.4696008263555347, 'psi': 0.7503437801170421}-{'f1_val': 0.4064533540298504, 'auprc': 0.7730183535752533, 'loss_val': 0.9749348079677207, 'psi': 0.5530793538480115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=18 head_norm_before_train=0.846659 cos_to_last_merge=0.9832 (last merge round=15)
[S8] round=18 local utility u=0.193024 metrics={'f1_val': 0.7612502979489563, 'auprc': 0.9947284648247056, 'loss_val': 0.33523723073404155, 'psi': 0.854641564699256}-{'f1_val': 0.7142391053978291, 'auprc': 0.994187950466553, 'loss_val': 0.4375966994348999, 'psi': 0.8262186434253187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=18 head_norm_before_train=0.967978 cos_to_last_merge=0.9872 (last merge round=15)
[S9] round=18 local utility u=0.017036 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9982652548417817, 'loss_val': 0.30382044418939014, 'psi': 0.8201249025682182}-{'f1_val': 0.7013646677191758, 'auprc': 0.998585200671803, 'loss_val': 0.33885151383965545, 'psi': 0.8202528809002267}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=18 head_norm_before_train=1.180462 cos_to_last_merge=0.9925 (last merge round=14)
[S10] round=18 local utility u=0.009684 metrics={'f1_val': 0.992869746824563, 'auprc': 0.9944201553788324, 'loss_val': 0.1575556407352531, 'psi': 0.9934899102462706}-{'f1_val': 0.9930734810403055, 'auprc': 0.9965263677491317, 'loss_val': 0.18446487899688407, 'psi': 0.994454635723836}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=18 head_norm_before_train=1.027899 cos_to_last_merge=0.9993 (last merge round=16)
[S11] round=18 local utility u=0.042443 metrics={'f1_val': 0.9669727119307798, 'auprc': 0.9977709130186365, 'loss_val': 0.24545170033602334, 'psi': 0.9792919923659225}-{'f1_val': 0.9608885736798384, 'auprc': 0.9977797411917038, 'loss_val': 0.29385867951063005, 'psi': 0.9756450406845846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] sending update (kind=head size=1788 to 1 peers)
[S13] START round=18 head_norm_before_train=1.548208 (no previous merge yet)
[S13] round=18 local utility u=0.082548 metrics={'f1_val': 0.7113104823159138, 'auprc': 0.7235155723049459, 'loss_val': 0.45672713891360617, 'psi': 0.7161925183115266}-{'f1_val': 0.6869936239672916, 'auprc': 0.7427625751716467, 'loss_val': 0.5336623745857834, 'psi': 0.7093012044490337}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S13] sending update (kind=head size=1810 to 1 peers)
[S14] START round=18 head_norm_before_train=0.909723 cos_to_last_merge=0.9978 (last merge round=16)
[S14] round=18 local utility u=0.041524 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9951585034592403, 'loss_val': 0.2933258497344143, 'psi': 0.9964076154071719}-{'f1_val': 0.9974830777164877, 'auprc': 0.9954503087058242, 'loss_val': 0.37870599213411754, 'psi': 0.9966699701122222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] sending update (kind=head size=1789 to 1 peers)
[S15] START round=18 head_norm_before_train=0.882070 cos_to_last_merge=0.9913 (last merge round=15)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.6975663991359801, 'auprc': 0.7994701101623979, 'loss_val': 0.4972016559306109, 'psi': 0.7383278835465472}-{'f1_val': 0.6986184249994525, 'auprc': 0.8004755473139571, 'loss_val': 0.48414319737891814, 'psi': 0.7393612739252544}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.074822 cos_to_last_merge=0.9463 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.946
[S16] round=18 local utility u=0.562064 metrics={'f1_val': 0.8740014885009059, 'auprc': 0.9848634655740559, 'loss_val': 0.5293333892849816, 'psi': 0.9183462793301659}-{'f1_val': 0.6744469416064218, 'auprc': 0.9783487248669892, 'loss_val': 0.43658974886798024, 'psi': 0.7960076549106487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=18 head_norm_before_train=1.314181 cos_to_last_merge=0.7931 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.793
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.3803123288918645, 'auprc': 0.7348561391628916, 'loss_val': 1.099764236083733, 'psi': 0.5221298530002754}-{'f1_val': 0.3445264783600188, 'auprc': 0.8375876935237949, 'loss_val': 1.0146098746722667, 'psi': 0.5417509644255293}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.694832 (no previous merge yet)
[S2] round=19 local utility u=0.007540 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7014362027169124, 'loss_val': 0.3062526474773212, 'psi': 0.7013130146902328}-{'f1_val': 0.701230889339113, 'auprc': 0.6923698190341155, 'loss_val': 0.2941336868999151, 'psi': 0.6976864612171141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S2] r=20 psi=0.701 u=0.0075 p_local=0.0547 f1=0.701 auprc=0.701 bytes=28780
[S3] START round=19 head_norm_before_train=1.681721 (no previous merge yet)
[S3] round=19 local utility u=0.014753 metrics={'f1_val': 0.7009355793019081, 'auprc': 0.9986932436673628, 'loss_val': 0.19544455923663875, 'psi': 0.82003864504809}-{'f1_val': 0.7006060025002057, 'auprc': 0.9983610345429056, 'loss_val': 0.22197736077848707, 'psi': 0.8197080153172855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] r=20 psi=0.820 u=0.0148 p_local=0.1055 f1=0.701 auprc=0.999 bytes=28781
[S4] START round=19 head_norm_before_train=1.205554 cos_to_last_merge=0.9587 (last merge round=15)
[S4] round=19 local utility u=0.046450 metrics={'f1_val': 0.6686555379803075, 'auprc': 0.9262940536942987, 'loss_val': 0.4655486531944223, 'psi': 0.771710944265904}-{'f1_val': 0.6621792530146123, 'auprc': 0.933891877217089, 'loss_val': 0.5423851429824945, 'psi': 0.770864302695603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=20 psi=0.772 u=0.0465 p_local=0.2021 f1=0.669 auprc=0.926 bytes=23327
[S5] START round=19 head_norm_before_train=1.363278 cos_to_last_merge=0.8525 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.7012226875234144, 'auprc': 0.7931372556144494, 'loss_val': 0.3282795461111785, 'psi': 0.7379885147598284}-{'f1_val': 0.7006090940057808, 'auprc': 0.9976847571631485, 'loss_val': 0.29610265728305923, 'psi': 0.8194393592687279}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.738 u=0.0000 p_local=0.1197 f1=0.701 auprc=0.793 bytes=26935
[S6] START round=19 head_norm_before_train=1.677137 (no previous merge yet)
[S6] round=19 local utility u=0.567175 metrics={'f1_val': 0.8226147251180896, 'auprc': 0.9597408367137137, 'loss_val': 0.33780278087084925, 'psi': 0.8774651697563393}-{'f1_val': 0.7458056502415429, 'auprc': 0.8065636874864703, 'loss_val': 0.5517675326073606, 'psi': 0.7701088651395138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S6] r=20 psi=0.877 u=0.5672 p_local=0.3627 f1=0.823 auprc=0.960 bytes=25143
[S7] START round=19 head_norm_before_train=1.507817 (no previous merge yet)
[S7] round=19 local utility u=0.000000 metrics={'f1_val': 0.40818177192730787, 'auprc': 0.778367183090437, 'loss_val': 1.0209127303584538, 'psi': 0.5562559363925595}-{'f1_val': 0.6726773845130398, 'auprc': 0.8668433735230454, 'loss_val': 0.4696008263555347, 'psi': 0.7503437801170421}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=20 psi=0.556 u=0.0000 p_local=0.3218 f1=0.408 auprc=0.778 bytes=23351
[S8] START round=19 head_norm_before_train=0.904611 cos_to_last_merge=0.9681 (last merge round=15)
[S8] round=19 local utility u=0.741943 metrics={'f1_val': 0.9948531060745154, 'auprc': 0.9978046848383115, 'loss_val': 0.262197617788622, 'psi': 0.9960337375800338}-{'f1_val': 0.7612502979489563, 'auprc': 0.9947284648247056, 'loss_val': 0.33523723073404155, 'psi': 0.854641564699256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] sending update (kind=head size=1794 to 1 peers)
[S8] r=20 psi=0.996 u=0.7419 p_local=0.3153 f1=0.995 auprc=0.998 bytes=21538
[S9] START round=19 head_norm_before_train=1.019273 cos_to_last_merge=0.9770 (last merge round=15)
[S9] round=19 local utility u=0.011985 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9978167525883729, 'loss_val': 0.27806001382621864, 'psi': 0.8199009911598872}-{'f1_val': 0.7013646677191758, 'auprc': 0.9982652548417817, 'loss_val': 0.30382044418939014, 'psi': 0.8201249025682182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=20 psi=0.820 u=0.0120 p_local=0.0885 f1=0.701 auprc=0.998 bytes=23358
[S10] START round=19 head_norm_before_train=1.230554 cos_to_last_merge=0.9883 (last merge round=14)
[S10] round=19 local utility u=0.012006 metrics={'f1_val': 0.9919953528678485, 'auprc': 0.9960087955293335, 'loss_val': 0.13306330935089933, 'psi': 0.9936007299324425}-{'f1_val': 0.992869746824563, 'auprc': 0.9944201553788324, 'loss_val': 0.1575556407352531, 'psi': 0.9934899102462706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S10] r=20 psi=0.994 u=0.0120 p_local=0.1284 f1=0.992 auprc=0.996 bytes=28720
[S11] START round=19 head_norm_before_train=1.080510 cos_to_last_merge=0.9963 (last merge round=16)
[S11] round=19 local utility u=0.000000 metrics={'f1_val': 0.9597563510868503, 'auprc': 0.9961262992063126, 'loss_val': 0.23158442291046458, 'psi': 0.9743043303346353}-{'f1_val': 0.9669727119307798, 'auprc': 0.9977709130186365, 'loss_val': 0.24545170033602334, 'psi': 0.9792919923659225}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=20 psi=0.974 u=0.0000 p_local=0.1383 f1=0.960 auprc=0.996 bytes=23354
[S13] START round=19 head_norm_before_train=1.559367 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.586453431956744, 'auprc': 0.7500614426624401, 'loss_val': 0.5813127252096736, 'psi': 0.6518966362390225}-{'f1_val': 0.7113104823159138, 'auprc': 0.7235155723049459, 'loss_val': 0.45672713891360617, 'psi': 0.7161925183115266}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.652 u=0.0000 p_local=0.1177 f1=0.586 auprc=0.750 bytes=21609
[S14] START round=19 head_norm_before_train=0.969442 cos_to_last_merge=0.9920 (last merge round=16)
[S14] round=19 local utility u=0.036606 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9951571353623554, 'loss_val': 0.2201095957338637, 'psi': 0.9964070681684181}-{'f1_val': 0.997240356705793, 'auprc': 0.9951585034592403, 'loss_val': 0.2933258497344143, 'psi': 0.9964076154071719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S14] r=20 psi=0.996 u=0.0366 p_local=0.1378 f1=0.997 auprc=0.995 bytes=30493
[S15] START round=19 head_norm_before_train=0.937169 cos_to_last_merge=0.9825 (last merge round=15)
[S15] round=19 local utility u=0.595651 metrics={'f1_val': 0.7690440483353533, 'auprc': 0.9900583122942442, 'loss_val': 0.3065306256149801, 'psi': 0.8574497539189097}-{'f1_val': 0.6975663991359801, 'auprc': 0.7994701101623979, 'loss_val': 0.4972016559306109, 'psi': 0.7383278835465472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S15] sending update (kind=head size=1789 to 1 peers)
[S15] r=20 psi=0.857 u=0.5957 p_local=0.2573 f1=0.769 auprc=0.990 bytes=25133
[S16] START round=19 head_norm_before_train=1.120291 cos_to_last_merge=0.9369 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=19 local utility u=0.267322 metrics={'f1_val': 0.9245997760480098, 'auprc': 0.9965719572488381, 'loss_val': 0.33340468654140687, 'psi': 0.9533886485283412}-{'f1_val': 0.8740014885009059, 'auprc': 0.9848634655740559, 'loss_val': 0.5293333892849816, 'psi': 0.9183462793301659}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S16] r=20 psi=0.953 u=0.2673 p_local=0.3539 f1=0.925 auprc=0.997 bytes=25145
[S17] START round=19 head_norm_before_train=1.324299 cos_to_last_merge=0.7889 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.789
[S17] round=19 local utility u=0.007985 metrics={'f1_val': 0.34045899186575695, 'auprc': 0.82189677558185, 'loss_val': 1.105795846562951, 'psi': 0.5330341053521942}-{'f1_val': 0.3803123288918645, 'auprc': 0.7348561391628916, 'loss_val': 1.099764236083733, 'psi': 0.5221298530002754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=20 psi=0.533 u=0.0080 p_local=0.0587 f1=0.340 auprc=0.822 bytes=14388
[S2] START round=20 head_norm_before_train=1.712903 (no previous merge yet)
[S2] round=20 local utility u=0.004338 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7013401503162262, 'loss_val': 0.2972886552582716, 'psi': 0.7012745937299583}-{'f1_val': 0.701230889339113, 'auprc': 0.7014362027169124, 'loss_val': 0.3062526474773212, 'psi': 0.7013130146902328}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=20 head_norm_before_train=1.701119 (no previous merge yet)
[S3] round=20 local utility u=0.003859 metrics={'f1_val': 0.7006060025002057, 'auprc': 0.9986862390123328, 'loss_val': 0.18572828558986645, 'psi': 0.8198380971050565}-{'f1_val': 0.7009355793019081, 'auprc': 0.9986932436673628, 'loss_val': 0.19544455923663875, 'psi': 0.82003864504809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=20 head_norm_before_train=1.246310 cos_to_last_merge=0.9400 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=20 local utility u=0.920911 metrics={'f1_val': 0.9550821654789149, 'auprc': 0.9534708995242088, 'loss_val': 0.4238173040488663, 'psi': 0.9544376590970325}-{'f1_val': 0.6686555379803075, 'auprc': 0.9262940536942987, 'loss_val': 0.4655486531944223, 'psi': 0.771710944265904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=20 head_norm_before_train=1.381917 cos_to_last_merge=0.8484 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=20 local utility u=0.325150 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9960961877933299, 'loss_val': 0.28316982608307406, 'psi': 0.8188035107149365}-{'f1_val': 0.7012226875234144, 'auprc': 0.7931372556144494, 'loss_val': 0.3282795461111785, 'psi': 0.7379885147598284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=20 head_norm_before_train=1.694885 (no previous merge yet)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.43605219468355294, 'auprc': 0.7886653130427179, 'loss_val': 0.8513214298547727, 'psi': 0.5770974420272189}-{'f1_val': 0.8226147251180896, 'auprc': 0.9597408367137137, 'loss_val': 0.33780278087084925, 'psi': 0.8774651697563393}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.517317 (no previous merge yet)
[S7] round=20 local utility u=1.000000 metrics={'f1_val': 0.6957694375365825, 'auprc': 0.958381629753111, 'loss_val': 0.32495165924810426, 'psi': 0.800814314423194}-{'f1_val': 0.40818177192730787, 'auprc': 0.778367183090437, 'loss_val': 1.0209127303584538, 'psi': 0.5562559363925595}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S7] sending update (kind=head size=1793 to 1 peers)
[S8] START round=20 head_norm_before_train=0.956477 cos_to_last_merge=0.9543 (last merge round=15)
[S8] round=20 local utility u=0.031394 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.998247363730717, 'loss_val': 0.2114553258653027, 'psi': 0.997282593756284}-{'f1_val': 0.9948531060745154, 'auprc': 0.9978046848383115, 'loss_val': 0.262197617788622, 'psi': 0.9960337375800338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=20 head_norm_before_train=1.065426 cos_to_last_merge=0.9681 (last merge round=15)
[S9] round=20 local utility u=0.030649 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9983454861737189, 'loss_val': 0.21834749442349452, 'psi': 0.8201124845940256}-{'f1_val': 0.7012904835408967, 'auprc': 0.9978167525883729, 'loss_val': 0.27806001382621864, 'psi': 0.8199009911598872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=20 head_norm_before_train=1.278196 cos_to_last_merge=0.9836 (last merge round=14)
[S10] round=20 local utility u=0.004600 metrics={'f1_val': 0.992934687421342, 'auprc': 0.992269127121858, 'loss_val': 0.1182807992535436, 'psi': 0.9926684633015485}-{'f1_val': 0.9919953528678485, 'auprc': 0.9960087955293335, 'loss_val': 0.13306330935089933, 'psi': 0.9936007299324425}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=20 head_norm_before_train=1.126026 cos_to_last_merge=0.9926 (last merge round=16)
[S11] round=20 local utility u=0.123415 metrics={'f1_val': 0.9933548163775702, 'auprc': 0.9974694945208844, 'loss_val': 0.19037526022448995, 'psi': 0.9950006876348959}-{'f1_val': 0.9597563510868503, 'auprc': 0.9961262992063126, 'loss_val': 0.23158442291046458, 'psi': 0.9743043303346353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=20 head_norm_before_train=1.571148 (no previous merge yet)
[S13] round=20 local utility u=0.072727 metrics={'f1_val': 0.6258571985084779, 'auprc': 0.6972752156927812, 'loss_val': 0.5139236195038448, 'psi': 0.6544244053821993}-{'f1_val': 0.586453431956744, 'auprc': 0.7500614426624401, 'loss_val': 0.5813127252096736, 'psi': 0.6518966362390225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=20 head_norm_before_train=1.029779 cos_to_last_merge=0.9843 (last merge round=16)
[S14] round=20 local utility u=0.023186 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9951556743891377, 'loss_val': 0.17373418570187926, 'psi': 0.9964064837791309}-{'f1_val': 0.997240356705793, 'auprc': 0.9951571353623554, 'loss_val': 0.2201095957338637, 'psi': 0.9964070681684181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=20 head_norm_before_train=0.990413 cos_to_last_merge=0.9729 (last merge round=15)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7527219502641807, 'auprc': 0.967877200047684, 'loss_val': 0.2991629821171107, 'psi': 0.838784050177582}-{'f1_val': 0.7690440483353533, 'auprc': 0.9900583122942442, 'loss_val': 0.3065306256149801, 'psi': 0.8574497539189097}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.164978 cos_to_last_merge=0.9280 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.928
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9084375065656707, 'auprc': 0.9966299302376092, 'loss_val': 0.41577689257506795, 'psi': 0.943714476034446}-{'f1_val': 0.9245997760480098, 'auprc': 0.9965719572488381, 'loss_val': 0.33340468654140687, 'psi': 0.9533886485283412}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.335055 cos_to_last_merge=0.7858 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.786
[S17] round=20 local utility u=0.003890 metrics={'f1_val': 0.3408501960444408, 'auprc': 0.8128157462634054, 'loss_val': 1.0731208932999008, 'psi': 0.5296364161320266}-{'f1_val': 0.34045899186575695, 'auprc': 0.82189677558185, 'loss_val': 1.105795846562951, 'psi': 0.5330341053521942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=21 head_norm_before_train=1.728292 (no previous merge yet)
[S2] round=21 local utility u=0.005480 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7017961142208369, 'loss_val': 0.28769695308671933, 'psi': 0.7014569792918026}-{'f1_val': 0.701230889339113, 'auprc': 0.7013401503162262, 'loss_val': 0.2972886552582716, 'psi': 0.7012745937299583}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=21 head_norm_before_train=1.722788 (no previous merge yet)
[S3] round=21 local utility u=0.797747 metrics={'f1_val': 0.960531351117436, 'auprc': 0.9984919086094147, 'loss_val': 0.149203463530611, 'psi': 0.9757155741142276}-{'f1_val': 0.7006060025002057, 'auprc': 0.9986862390123328, 'loss_val': 0.18572828558986645, 'psi': 0.8198380971050565}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=21 head_norm_before_train=1.280678 cos_to_last_merge=0.9255 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=21 local utility u=0.017697 metrics={'f1_val': 0.9507615143147479, 'auprc': 0.964362346896259, 'loss_val': 0.39517276457527134, 'psi': 0.9562018473473524}-{'f1_val': 0.9550821654789149, 'auprc': 0.9534708995242088, 'loss_val': 0.4238173040488663, 'psi': 0.9544376590970325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=21 head_norm_before_train=1.399022 cos_to_last_merge=0.8453 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.994767770373819, 'loss_val': 0.27972746212412625, 'psi': 0.8182721437471322}-{'f1_val': 0.7006083926626743, 'auprc': 0.9960961877933299, 'loss_val': 0.28316982608307406, 'psi': 0.8188035107149365}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.711009 (no previous merge yet)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.8628606241306014, 'auprc': 0.9670562826409411, 'loss_val': 0.302878241245427, 'psi': 0.9045388875347373}-{'f1_val': 0.43605219468355294, 'auprc': 0.7886653130427179, 'loss_val': 0.8513214298547727, 'psi': 0.5770974420272189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=21 head_norm_before_train=1.527364 (no previous merge yet)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.37735482833139083, 'auprc': 0.7750475976748662, 'loss_val': 1.2792470187932916, 'psi': 0.536431936068781}-{'f1_val': 0.6957694375365825, 'auprc': 0.958381629753111, 'loss_val': 0.32495165924810426, 'psi': 0.800814314423194}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.009452 cos_to_last_merge=0.9410 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.941
[S8] round=21 local utility u=0.000000 metrics={'f1_val': 0.7623803814686497, 'auprc': 0.9975865641021116, 'loss_val': 0.21295474903964393, 'psi': 0.8564628545220345}-{'f1_val': 0.9966394137733288, 'auprc': 0.998247363730717, 'loss_val': 0.2114553258653027, 'psi': 0.997282593756284}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=21 head_norm_before_train=1.101674 cos_to_last_merge=0.9613 (last merge round=15)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9978748954627116, 'loss_val': 0.21813732824489113, 'psi': 0.8199242483096227}-{'f1_val': 0.7012904835408967, 'auprc': 0.9983454861737189, 'loss_val': 0.21834749442349452, 'psi': 0.8201124845940256}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.325141 cos_to_last_merge=0.9783 (last merge round=14)
[S10] round=21 local utility u=0.013542 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9935649529369268, 'loss_val': 0.10414659634179536, 'psi': 0.9940929574925648}-{'f1_val': 0.992934687421342, 'auprc': 0.992269127121858, 'loss_val': 0.1182807992535436, 'psi': 0.9926684633015485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=21 head_norm_before_train=1.169310 cos_to_last_merge=0.9885 (last merge round=16)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9511895569141933, 'auprc': 0.9944398131738472, 'loss_val': 0.264213986678438, 'psi': 0.9684896594180548}-{'f1_val': 0.9933548163775702, 'auprc': 0.9974694945208844, 'loss_val': 0.19037526022448995, 'psi': 0.9950006876348959}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=21 head_norm_before_train=1.580768 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6122775848703674, 'auprc': 0.6311415975280411, 'loss_val': 0.5634928117091638, 'psi': 0.6198231899334369}-{'f1_val': 0.6258571985084779, 'auprc': 0.6972752156927812, 'loss_val': 0.5139236195038448, 'psi': 0.6544244053821993}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.085825 cos_to_last_merge=0.9769 (last merge round=16)
[S14] round=21 local utility u=0.012354 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9951545668812769, 'loss_val': 0.14756508754917183, 'psi': 0.9962603316471098}-{'f1_val': 0.997240356705793, 'auprc': 0.9951556743891377, 'loss_val': 0.17373418570187926, 'psi': 0.9964064837791309}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=21 head_norm_before_train=1.033988 cos_to_last_merge=0.9645 (last merge round=15)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.6984653477235443, 'auprc': 0.7997497512247402, 'loss_val': 0.4620453336726801, 'psi': 0.7389791091240228}-{'f1_val': 0.7527219502641807, 'auprc': 0.967877200047684, 'loss_val': 0.2991629821171107, 'psi': 0.838784050177582}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.209561 cos_to_last_merge=0.9195 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.920
[S16] round=21 local utility u=0.382166 metrics={'f1_val': 0.9913884943638537, 'auprc': 0.9932648273233631, 'loss_val': 0.13905525864666188, 'psi': 0.9921390275476574}-{'f1_val': 0.9084375065656707, 'auprc': 0.9966299302376092, 'loss_val': 0.41577689257506795, 'psi': 0.943714476034446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=21 head_norm_before_train=1.346462 cos_to_last_merge=0.7846 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.785
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3416564854408471, 'auprc': 0.8052654241605601, 'loss_val': 1.1182364569935355, 'psi': 0.5271000609287323}-{'f1_val': 0.3408501960444408, 'auprc': 0.8128157462634054, 'loss_val': 1.0731208932999008, 'psi': 0.5296364161320266}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.739509 (no previous merge yet)
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7005078676491292, 'loss_val': 0.2949976986413513, 'psi': 0.7009416806631195}-{'f1_val': 0.701230889339113, 'auprc': 0.7017961142208369, 'loss_val': 0.28769695308671933, 'psi': 0.7014569792918026}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.751089 (no previous merge yet)
[S3] round=22 local utility u=0.143911 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9986923617023992, 'loss_val': 0.08548407354642364, 'psi': 0.9981458425079182}-{'f1_val': 0.960531351117436, 'auprc': 0.9984919086094147, 'loss_val': 0.149203463530611, 'psi': 0.9757155741142276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=22 head_norm_before_train=1.307169 cos_to_last_merge=0.9152 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9464353546851418, 'auprc': 0.9677877082905977, 'loss_val': 0.3921984356371657, 'psi': 0.9549762961273242}-{'f1_val': 0.9507615143147479, 'auprc': 0.964362346896259, 'loss_val': 0.39517276457527134, 'psi': 0.9562018473473524}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.415530 cos_to_last_merge=0.8421 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.970824597328201, 'loss_val': 0.2775361072387182, 'psi': 0.808694874528885}-{'f1_val': 0.7006083926626743, 'auprc': 0.994767770373819, 'loss_val': 0.27972746212412625, 'psi': 0.8182721437471322}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.722654 (no previous merge yet)
[S6] round=22 local utility u=0.351029 metrics={'f1_val': 0.959326770469958, 'auprc': 0.9664511188640155, 'loss_val': 0.17780066434206276, 'psi': 0.962176509827581}-{'f1_val': 0.8628606241306014, 'auprc': 0.9670562826409411, 'loss_val': 0.302878241245427, 'psi': 0.9045388875347373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=22 head_norm_before_train=1.534722 (no previous merge yet)
[S7] round=22 local utility u=0.096243 metrics={'f1_val': 0.3967991114802616, 'auprc': 0.7742761493529375, 'loss_val': 1.2011113736248062, 'psi': 0.547789926629332}-{'f1_val': 0.37735482833139083, 'auprc': 0.7750475976748662, 'loss_val': 1.2792470187932916, 'psi': 0.536431936068781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=22 head_norm_before_train=1.058999 cos_to_last_merge=0.9291 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.929
[S8] round=22 local utility u=0.722929 metrics={'f1_val': 0.9951824671081219, 'auprc': 0.9983800600081485, 'loss_val': 0.1662894773541855, 'psi': 0.9964615042681325}-{'f1_val': 0.7623803814686497, 'auprc': 0.9975865641021116, 'loss_val': 0.21295474903964393, 'psi': 0.8564628545220345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=22 head_norm_before_train=1.133645 cos_to_last_merge=0.9561 (last merge round=15)
[S9] round=22 local utility u=0.899010 metrics={'f1_val': 0.9925069029958717, 'auprc': 0.9981717815134337, 'loss_val': 0.16830667201601315, 'psi': 0.9947728544028964}-{'f1_val': 0.7012904835408967, 'auprc': 0.9978748954627116, 'loss_val': 0.21813732824489113, 'psi': 0.8199242483096227}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] sending update (kind=head size=1792 to 1 peers)
[S10] START round=22 head_norm_before_train=1.370709 cos_to_last_merge=0.9736 (last merge round=14)
[S10] round=22 local utility u=0.013382 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9936022028418199, 'loss_val': 0.07799920377829647, 'psi': 0.9941583452157645}-{'f1_val': 0.9944449605296568, 'auprc': 0.9935649529369268, 'loss_val': 0.10414659634179536, 'psi': 0.9940929574925648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=22 head_norm_before_train=1.216987 cos_to_last_merge=0.9838 (last merge round=16)
[S11] round=22 local utility u=0.199417 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997526354935396, 'loss_val': 0.14533263406495875, 'psi': 0.996793642455475}-{'f1_val': 0.9511895569141933, 'auprc': 0.9944398131738472, 'loss_val': 0.264213986678438, 'psi': 0.9684896594180548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=22 head_norm_before_train=1.593994 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5953271332590463, 'auprc': 0.620087444860734, 'loss_val': 0.6255246036490767, 'psi': 0.6052312578997213}-{'f1_val': 0.6122775848703674, 'auprc': 0.6311415975280411, 'loss_val': 0.5634928117091638, 'psi': 0.6198231899334369}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.133341 cos_to_last_merge=0.9709 (last merge round=16)
[S14] round=22 local utility u=0.010391 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9933847417297457, 'loss_val': 0.12046913410210168, 'psi': 0.9954519447872252}-{'f1_val': 0.9969975081576651, 'auprc': 0.9951545668812769, 'loss_val': 0.14756508754917183, 'psi': 0.9962603316471098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=22 head_norm_before_train=1.076488 cos_to_last_merge=0.9569 (last merge round=15)
[S15] round=22 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9971717560775089, 'loss_val': 0.1453931982306485, 'psi': 0.9969167034635159}-{'f1_val': 0.6984653477235443, 'auprc': 0.7997497512247402, 'loss_val': 0.4620453336726801, 'psi': 0.7389791091240228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=22 head_norm_before_train=1.253782 cos_to_last_merge=0.9110 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.911
[S16] round=22 local utility u=0.018765 metrics={'f1_val': 0.9915212706861152, 'auprc': 0.9951520582479788, 'loss_val': 0.10798446227664153, 'psi': 0.9929735857108607}-{'f1_val': 0.9913884943638537, 'auprc': 0.9932648273233631, 'loss_val': 0.13905525864666188, 'psi': 0.9921390275476574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=22 head_norm_before_train=1.358933 cos_to_last_merge=0.7811 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.781
[S17] round=22 local utility u=0.387263 metrics={'f1_val': 0.4523980546100842, 'auprc': 0.8229645665507878, 'loss_val': 1.0612575948173901, 'psi': 0.6006246593863657}-{'f1_val': 0.3416564854408471, 'auprc': 0.8052654241605601, 'loss_val': 1.1182364569935355, 'psi': 0.5271000609287323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=23 head_norm_before_train=1.751766 (no previous merge yet)
[S2] round=23 local utility u=0.035556 metrics={'f1_val': 0.701230889339113, 'auprc': 0.7369536066281698, 'loss_val': 0.3332228564452726, 'psi': 0.7155199762547357}-{'f1_val': 0.701230889339113, 'auprc': 0.7005078676491292, 'loss_val': 0.2949976986413513, 'psi': 0.7009416806631195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=23 head_norm_before_train=1.782176 (no previous merge yet)
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9733111151174647, 'auprc': 0.9985814317938835, 'loss_val': 0.09026431269003998, 'psi': 0.9834192417880322}-{'f1_val': 0.9977814963782642, 'auprc': 0.9986923617023992, 'loss_val': 0.08548407354642364, 'psi': 0.9981458425079182}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.333087 cos_to_last_merge=0.9061 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=23 local utility u=0.001349 metrics={'f1_val': 0.952422087097455, 'auprc': 0.9532747918542279, 'loss_val': 0.3818817480483984, 'psi': 0.9527631690001641}-{'f1_val': 0.9464353546851418, 'auprc': 0.9677877082905977, 'loss_val': 0.3921984356371657, 'psi': 0.9549762961273242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=23 head_norm_before_train=1.429109 cos_to_last_merge=0.8405 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.840
[S5] round=23 local utility u=0.042189 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9955916024533964, 'loss_val': 0.2674600344283654, 'psi': 0.8186016765789632}-{'f1_val': 0.7006083926626743, 'auprc': 0.970824597328201, 'loss_val': 0.2775361072387182, 'psi': 0.808694874528885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=23 head_norm_before_train=1.735502 (no previous merge yet)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.8202632209288219, 'auprc': 0.9552066324587007, 'loss_val': 0.4562087782811149, 'psi': 0.8742405855407734}-{'f1_val': 0.959326770469958, 'auprc': 0.9664511188640155, 'loss_val': 0.17780066434206276, 'psi': 0.962176509827581}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.544454 (no previous merge yet)
[S7] round=23 local utility u=1.000000 metrics={'f1_val': 0.6831901897875776, 'auprc': 0.8829151320705694, 'loss_val': 0.37693621804126004, 'psi': 0.7630801667007743}-{'f1_val': 0.3967991114802616, 'auprc': 0.7742761493529375, 'loss_val': 1.2011113736248062, 'psi': 0.547789926629332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] START round=23 head_norm_before_train=1.102546 cos_to_last_merge=0.9188 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.919
[S8] round=23 local utility u=0.011571 metrics={'f1_val': 0.9932673365348732, 'auprc': 0.9988854371548879, 'loss_val': 0.13317345270678502, 'psi': 0.995514576782879}-{'f1_val': 0.9951824671081219, 'auprc': 0.9983800600081485, 'loss_val': 0.1662894773541855, 'psi': 0.9964615042681325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=23 head_norm_before_train=1.160897 cos_to_last_merge=0.9522 (last merge round=15)
[S9] round=23 local utility u=0.024349 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9982698517916215, 'loss_val': 0.14747989232230618, 'psi': 0.9975696882239343}-{'f1_val': 0.9925069029958717, 'auprc': 0.9981717815134337, 'loss_val': 0.16830667201601315, 'psi': 0.9947728544028964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=23 head_norm_before_train=1.413391 cos_to_last_merge=0.9696 (last merge round=14)
[S10] round=23 local utility u=0.004540 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9934190712400831, 'loss_val': 0.06837049308446268, 'psi': 0.9940850925750698}-{'f1_val': 0.9945291067983943, 'auprc': 0.9936022028418199, 'loss_val': 0.07799920377829647, 'psi': 0.9941583452157645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=23 head_norm_before_train=1.257235 cos_to_last_merge=0.9795 (last merge round=16)
[S11] round=23 local utility u=0.000000 metrics={'f1_val': 0.9503285344842303, 'auprc': 0.993160152899724, 'loss_val': 0.24901745455964167, 'psi': 0.9674611818504278}-{'f1_val': 0.996305167468861, 'auprc': 0.997526354935396, 'loss_val': 0.14533263406495875, 'psi': 0.996793642455475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=23 head_norm_before_train=1.608783 (no previous merge yet)
[S13] round=23 local utility u=0.078370 metrics={'f1_val': 0.6153691576932386, 'auprc': 0.6273802010441347, 'loss_val': 0.6109152728928084, 'psi': 0.620173575033597}-{'f1_val': 0.5953271332590463, 'auprc': 0.620087444860734, 'loss_val': 0.6255246036490767, 'psi': 0.6052312578997213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=23 head_norm_before_train=1.176162 cos_to_last_merge=0.9653 (last merge round=16)
[S14] round=23 local utility u=0.013771 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9947276239681033, 'loss_val': 0.09941700327104272, 'psi': 0.9962352636107172}-{'f1_val': 0.9968300801588782, 'auprc': 0.9933847417297457, 'loss_val': 0.12046913410210168, 'psi': 0.9954519447872252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=23 head_norm_before_train=1.114107 cos_to_last_merge=0.9514 (last merge round=15)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7000425947034489, 'auprc': 0.7071381530754172, 'loss_val': 0.4927581904921352, 'psi': 0.7028808180522361}-{'f1_val': 0.9967466683875206, 'auprc': 0.9971717560775089, 'loss_val': 0.1453931982306485, 'psi': 0.9969167034635159}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.293240 cos_to_last_merge=0.9029 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.903
[S16] round=23 local utility u=0.004690 metrics={'f1_val': 0.9911588184027604, 'auprc': 0.9958583422492522, 'loss_val': 0.09854935569484763, 'psi': 0.9930386279413571}-{'f1_val': 0.9915212706861152, 'auprc': 0.9951520582479788, 'loss_val': 0.10798446227664153, 'psi': 0.9929735857108607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=23 head_norm_before_train=1.372211 cos_to_last_merge=0.7777 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.778
[S17] round=23 local utility u=0.000000 metrics={'f1_val': 0.34429527121673187, 'auprc': 0.8240547054697576, 'loss_val': 1.03828376241408, 'psi': 0.5361990449179421}-{'f1_val': 0.4523980546100842, 'auprc': 0.8229645665507878, 'loss_val': 1.0612575948173901, 'psi': 0.6006246593863657}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=24 head_norm_before_train=1.763872 (no previous merge yet)
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.46170867846568997, 'auprc': 0.6169835778050976, 'loss_val': 1.30557249745858, 'psi': 0.523818638201453}-{'f1_val': 0.701230889339113, 'auprc': 0.7369536066281698, 'loss_val': 0.3332228564452726, 'psi': 0.7155199762547357}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=1.811888 (no previous merge yet)
[S3] round=24 local utility u=0.091193 metrics={'f1_val': 0.9977814963782642, 'auprc': 0.9988841997458976, 'loss_val': 0.05560891953243382, 'psi': 0.9982225777253175}-{'f1_val': 0.9733111151174647, 'auprc': 0.9985814317938835, 'loss_val': 0.09026431269003998, 'psi': 0.9834192417880322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=24 head_norm_before_train=1.358450 cos_to_last_merge=0.8980 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.898
[S4] round=24 local utility u=0.000000 metrics={'f1_val': 0.9372687088512472, 'auprc': 0.9639938446193214, 'loss_val': 0.32688512177947826, 'psi': 0.9479587631584768}-{'f1_val': 0.952422087097455, 'auprc': 0.9532747918542279, 'loss_val': 0.3818817480483984, 'psi': 0.9527631690001641}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=24 head_norm_before_train=1.445100 cos_to_last_merge=0.8386 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.839
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.7004648585521847, 'auprc': 0.9561698710196915, 'loss_val': 0.2800079471258153, 'psi': 0.8027468635391874}-{'f1_val': 0.7006083926626743, 'auprc': 0.9955916024533964, 'loss_val': 0.2674600344283654, 'psi': 0.8186016765789632}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.745193 (no previous merge yet)
[S6] round=24 local utility u=0.632843 metrics={'f1_val': 0.9642696595660671, 'auprc': 0.9899517018797308, 'loss_val': 0.1587973515611999, 'psi': 0.9745424764915327}-{'f1_val': 0.8202632209288219, 'auprc': 0.9552066324587007, 'loss_val': 0.4562087782811149, 'psi': 0.8742405855407734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=24 head_norm_before_train=1.550330 (no previous merge yet)
[S7] round=24 local utility u=0.000000 metrics={'f1_val': 0.4603182971266213, 'auprc': 0.7781951337684919, 'loss_val': 0.9545716449661268, 'psi': 0.5874690317833695}-{'f1_val': 0.6831901897875776, 'auprc': 0.8829151320705694, 'loss_val': 0.37693621804126004, 'psi': 0.7630801667007743}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=24 head_norm_before_train=1.141922 cos_to_last_merge=0.9097 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.910
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.7961764033410784, 'auprc': 0.9970528289923819, 'loss_val': 0.17588583042986794, 'psi': 0.8765269736015998}-{'f1_val': 0.9932673365348732, 'auprc': 0.9988854371548879, 'loss_val': 0.13317345270678502, 'psi': 0.995514576782879}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.187421 cos_to_last_merge=0.9485 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.9912441468948172, 'auprc': 0.9980598229733642, 'loss_val': 0.13690769474612113, 'psi': 0.993970417326236}-{'f1_val': 0.9971029125121428, 'auprc': 0.9982698517916215, 'loss_val': 0.14747989232230618, 'psi': 0.9975696882239343}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.448846 cos_to_last_merge=0.9663 (last merge round=14)
[S10] round=24 local utility u=0.003311 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9934560474643013, 'loss_val': 0.06185944414924488, 'psi': 0.9940998830647572}-{'f1_val': 0.9945291067983943, 'auprc': 0.9934190712400831, 'loss_val': 0.06837049308446268, 'psi': 0.9940850925750698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=24 head_norm_before_train=1.290143 cos_to_last_merge=0.9758 (last merge round=16)
[S11] round=24 local utility u=0.209974 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9975147778620508, 'loss_val': 0.11799215289056328, 'psi': 0.9967890116261369}-{'f1_val': 0.9503285344842303, 'auprc': 0.993160152899724, 'loss_val': 0.24901745455964167, 'psi': 0.9674611818504278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=24 head_norm_before_train=1.627597 (no previous merge yet)
[S13] round=24 local utility u=0.070187 metrics={'f1_val': 0.6334255401361039, 'auprc': 0.6222404813883534, 'loss_val': 0.5634609735060032, 'psi': 0.6289515166370037}-{'f1_val': 0.6153691576932386, 'auprc': 0.6273802010441347, 'loss_val': 0.6109152728928084, 'psi': 0.620173575033597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=24 head_norm_before_train=1.214724 cos_to_last_merge=0.9603 (last merge round=16)
[S14] round=24 local utility u=0.006133 metrics={'f1_val': 0.9970728011695729, 'auprc': 0.9950786462398471, 'loss_val': 0.08719967485119286, 'psi': 0.9962751391976825}-{'f1_val': 0.997240356705793, 'auprc': 0.9947276239681033, 'loss_val': 0.09941700327104272, 'psi': 0.9962352636107172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=24 head_norm_before_train=1.142663 cos_to_last_merge=0.9471 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=24 local utility u=1.000000 metrics={'f1_val': 0.9079852484137796, 'auprc': 0.9911117114563246, 'loss_val': 0.19132971392896386, 'psi': 0.9412358336307975}-{'f1_val': 0.7000425947034489, 'auprc': 0.7071381530754172, 'loss_val': 0.4927581904921352, 'psi': 0.7028808180522361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=24 head_norm_before_train=1.326682 cos_to_last_merge=0.8963 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.896
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9781575641192937, 'auprc': 0.9967373579961385, 'loss_val': 0.12737066982398457, 'psi': 0.9855894816700316}-{'f1_val': 0.9911588184027604, 'auprc': 0.9958583422492522, 'loss_val': 0.09854935569484763, 'psi': 0.9930386279413571}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.386435 cos_to_last_merge=0.7763 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.776
[S17] round=24 local utility u=0.000000 metrics={'f1_val': 0.3600502847833612, 'auprc': 0.8020773760372425, 'loss_val': 1.0978092187469843, 'psi': 0.5368611212849137}-{'f1_val': 0.34429527121673187, 'auprc': 0.8240547054697576, 'loss_val': 1.03828376241408, 'psi': 0.5361990449179421}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=25 head_norm_before_train=1.772206 (no previous merge yet)
[S2] round=25 local utility u=1.000000 metrics={'f1_val': 0.700962939952021, 'auprc': 0.7401274704137445, 'loss_val': 0.3767993004479268, 'psi': 0.7166287521367103}-{'f1_val': 0.46170867846568997, 'auprc': 0.6169835778050976, 'loss_val': 1.30557249745858, 'psi': 0.523818638201453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=25 head_norm_before_train=1.840952 (no previous merge yet)
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9742375226641142, 'auprc': 0.9990658280918299, 'loss_val': 0.06996404672478408, 'psi': 0.9841688448352005}-{'f1_val': 0.9977814963782642, 'auprc': 0.9988841997458976, 'loss_val': 0.05560891953243382, 'psi': 0.9982225777253175}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.383373 cos_to_last_merge=0.8905 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=25 local utility u=0.000000 metrics={'f1_val': 0.941937841566806, 'auprc': 0.9586665684260687, 'loss_val': 0.34965367547499426, 'psi': 0.948629332310511}-{'f1_val': 0.9372687088512472, 'auprc': 0.9639938446193214, 'loss_val': 0.32688512177947826, 'psi': 0.9479587631584768}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=25 head_norm_before_train=1.459953 cos_to_last_merge=0.8366 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.837
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.7073362980126601, 'auprc': 0.8112235153801606, 'loss_val': 0.349174309391606, 'psi': 0.7488911849596602}-{'f1_val': 0.7004648585521847, 'auprc': 0.9561698710196915, 'loss_val': 0.2800079471258153, 'psi': 0.8027468635391874}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.752970 (no previous merge yet)
[S6] round=25 local utility u=0.000000 metrics={'f1_val': 0.5555622166061528, 'auprc': 0.8684193841473213, 'loss_val': 0.8588745191879431, 'psi': 0.6807050836226203}-{'f1_val': 0.9642696595660671, 'auprc': 0.9899517018797308, 'loss_val': 0.1587973515611999, 'psi': 0.9745424764915327}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=25 head_norm_before_train=1.554947 (no previous merge yet)
[S7] round=25 local utility u=1.000000 metrics={'f1_val': 0.683015997831727, 'auprc': 0.8759643519606026, 'loss_val': 0.3903280817935245, 'psi': 0.7601953394832772}-{'f1_val': 0.4603182971266213, 'auprc': 0.7781951337684919, 'loss_val': 0.9545716449661268, 'psi': 0.5874690317833695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=25 head_norm_before_train=1.177476 cos_to_last_merge=0.9022 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.902
[S8] round=25 local utility u=0.630114 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9989838334637156, 'loss_val': 0.10001399928640528, 'psi': 0.99515565566403}-{'f1_val': 0.7961764033410784, 'auprc': 0.9970528289923819, 'loss_val': 0.17588583042986794, 'psi': 0.8765269736015998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] sending update (kind=head size=1791 to 1 peers)
[S9] START round=25 head_norm_before_train=1.216099 cos_to_last_merge=0.9443 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=25 local utility u=0.034167 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9987268983007341, 'loss_val': 0.10570953744480376, 'psi': 0.9977507890438316}-{'f1_val': 0.9912441468948172, 'auprc': 0.9980598229733642, 'loss_val': 0.13690769474612113, 'psi': 0.993970417326236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S9] sending update (kind=head size=1786 to 1 peers)
[S10] START round=25 head_norm_before_train=1.483868 cos_to_last_merge=0.9628 (last merge round=14)
[S10] round=25 local utility u=0.002385 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9954526793457221, 'loss_val': 0.05650032966390931, 'psi': 0.9942406966308324}-{'f1_val': 0.9945291067983943, 'auprc': 0.9934560474643013, 'loss_val': 0.06185944414924488, 'psi': 0.9940998830647572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=25 head_norm_before_train=1.321672 cos_to_last_merge=0.9721 (last merge round=16)
[S11] round=25 local utility u=0.006189 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961239979193115, 'loss_val': 0.102893284061993, 'psi': 0.9963778018758783}-{'f1_val': 0.996305167468861, 'auprc': 0.9975147778620508, 'loss_val': 0.11799215289056328, 'psi': 0.9967890116261369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=25 head_norm_before_train=1.647125 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5822043822137264, 'auprc': 0.6008083085530791, 'loss_val': 0.7380978656852717, 'psi': 0.5896459527494675}-{'f1_val': 0.6334255401361039, 'auprc': 0.6222404813883534, 'loss_val': 0.5634609735060032, 'psi': 0.6289515166370037}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.248965 cos_to_last_merge=0.9562 (last merge round=16)
[S14] round=25 local utility u=0.004103 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9951395702776217, 'loss_val': 0.07771978943821667, 'psi': 0.9961538762063755}-{'f1_val': 0.9970728011695729, 'auprc': 0.9950786462398471, 'loss_val': 0.08719967485119286, 'psi': 0.9962751391976825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=25 head_norm_before_train=1.166760 cos_to_last_merge=0.9436 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=25 local utility u=0.218401 metrics={'f1_val': 0.97109665166662, 'auprc': 0.9914982218950135, 'loss_val': 0.13435538520012014, 'psi': 0.9792572797579774}-{'f1_val': 0.9079852484137796, 'auprc': 0.9911117114563246, 'loss_val': 0.19132971392896386, 'psi': 0.9412358336307975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=25 head_norm_before_train=1.357124 cos_to_last_merge=0.8912 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.891
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.9401426293844414, 'auprc': 0.991234154485655, 'loss_val': 0.17624801527751377, 'psi': 0.9605792394249268}-{'f1_val': 0.9781575641192937, 'auprc': 0.9967373579961385, 'loss_val': 0.12737066982398457, 'psi': 0.9855894816700316}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.402957 cos_to_last_merge=0.7739 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.774
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.2294031175039849, 'auprc': 0.7935328100648533, 'loss_val': 1.6517750377181335, 'psi': 0.4550549945283323}-{'f1_val': 0.3600502847833612, 'auprc': 0.8020773760372425, 'loss_val': 1.0978092187469843, 'psi': 0.5368611212849137}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.780558 (no previous merge yet)
[S2] round=26 local utility u=0.000000 metrics={'f1_val': 0.5734036001918301, 'auprc': 0.6407658454150664, 'loss_val': 0.865522430797077, 'psi': 0.6003484982811247}-{'f1_val': 0.700962939952021, 'auprc': 0.7401274704137445, 'loss_val': 0.3767993004479268, 'psi': 0.7166287521367103}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=26 head_norm_before_train=1.868515 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9720076763056362, 'auprc': 0.9988121133521166, 'loss_val': 0.06834465450537892, 'psi': 0.9827294511242284}-{'f1_val': 0.9742375226641142, 'auprc': 0.9990658280918299, 'loss_val': 0.06996404672478408, 'psi': 0.9841688448352005}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.411850 cos_to_last_merge=0.8821 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=26 local utility u=0.038862 metrics={'f1_val': 0.9503242342066595, 'auprc': 0.9605499309721396, 'loss_val': 0.3278972073917073, 'psi': 0.9544145129128515}-{'f1_val': 0.941937841566806, 'auprc': 0.9586665684260687, 'loss_val': 0.34965367547499426, 'psi': 0.948629332310511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=26 head_norm_before_train=1.472154 cos_to_last_merge=0.8338 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.834
[S5] round=26 local utility u=0.091092 metrics={'f1_val': 0.7009667515429574, 'auprc': 0.864336649323168, 'loss_val': 0.2881133605199543, 'psi': 0.7663147106550416}-{'f1_val': 0.7073362980126601, 'auprc': 0.8112235153801606, 'loss_val': 0.349174309391606, 'psi': 0.7488911849596602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=26 head_norm_before_train=1.756943 (no previous merge yet)
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.8248640780462005, 'auprc': 0.9684871475388195, 'loss_val': 0.31841204845987736, 'psi': 0.8823133058432482}-{'f1_val': 0.5555622166061528, 'auprc': 0.8684193841473213, 'loss_val': 0.8588745191879431, 'psi': 0.6807050836226203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=26 head_norm_before_train=1.562200 (no previous merge yet)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.40070991044029186, 'auprc': 0.778960973660286, 'loss_val': 1.2026941897447576, 'psi': 0.5520103357282895}-{'f1_val': 0.683015997831727, 'auprc': 0.8759643519606026, 'loss_val': 0.3903280817935245, 'psi': 0.7601953394832772}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.208985 cos_to_last_merge=0.8962 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.896
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.7150705803838704, 'auprc': 0.9867130364823266, 'loss_val': 0.19949023987367634, 'psi': 0.8237275628232529}-{'f1_val': 0.9926035371309061, 'auprc': 0.9989838334637156, 'loss_val': 0.10001399928640528, 'psi': 0.99515565566403}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.244657 cos_to_last_merge=0.9398 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9987570638215889, 'loss_val': 0.08835370985633044, 'psi': 0.9960166493789752}-{'f1_val': 0.9971000495392299, 'auprc': 0.9987268983007341, 'loss_val': 0.10570953744480376, 'psi': 0.9977507890438316}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.516249 cos_to_last_merge=0.9596 (last merge round=14)
[S10] round=26 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9950363321909426, 'loss_val': 0.05594455757444011, 'psi': 0.9936799826215417}-{'f1_val': 0.9934327081542391, 'auprc': 0.9954526793457221, 'loss_val': 0.05650032966390931, 'psi': 0.9942406966308324}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=26 head_norm_before_train=1.358366 cos_to_last_merge=0.9677 (last merge round=16)
[S11] round=26 local utility u=0.010573 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976318762305003, 'loss_val': 0.08627029518515729, 'psi': 0.9969809532003538}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961239979193115, 'loss_val': 0.102893284061993, 'psi': 0.9963778018758783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=26 head_norm_before_train=1.664603 (no previous merge yet)
[S13] round=26 local utility u=0.123689 metrics={'f1_val': 0.6020453464605058, 'auprc': 0.6041605585761417, 'loss_val': 0.6198233329671171, 'psi': 0.6028914313067602}-{'f1_val': 0.5822043822137264, 'auprc': 0.6008083085530791, 'loss_val': 0.7380978656852717, 'psi': 0.5896459527494675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=26 head_norm_before_train=1.277914 cos_to_last_merge=0.9527 (last merge round=16)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9917991843863939, 'auprc': 0.9951439387944412, 'loss_val': 0.08286879483285742, 'psi': 0.9931370861496127}-{'f1_val': 0.9968300801588782, 'auprc': 0.9951395702776217, 'loss_val': 0.07771978943821667, 'psi': 0.9961538762063755}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.192827 cos_to_last_merge=0.9404 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.7992725929875126, 'loss_val': 0.48630998936085873, 'psi': 0.7402592234967792}-{'f1_val': 0.97109665166662, 'auprc': 0.9914982218950135, 'loss_val': 0.13435538520012014, 'psi': 0.9792572797579774}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.382034 cos_to_last_merge=0.8871 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.887
[S16] round=26 local utility u=0.167253 metrics={'f1_val': 0.9876197218970606, 'auprc': 0.989390177050373, 'loss_val': 0.12107346657705031, 'psi': 0.9883279039583857}-{'f1_val': 0.9401426293844414, 'auprc': 0.991234154485655, 'loss_val': 0.17624801527751377, 'psi': 0.9605792394249268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=26 head_norm_before_train=1.421632 cos_to_last_merge=0.7719 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.772
[S17] round=26 local utility u=0.030383 metrics={'f1_val': 0.3024675109809659, 'auprc': 0.7970279548618333, 'loss_val': 2.0398800531624977, 'psi': 0.5002916885333129}-{'f1_val': 0.2294031175039849, 'auprc': 0.7935328100648533, 'loss_val': 1.6517750377181335, 'psi': 0.4550549945283323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=27 head_norm_before_train=1.786154 (no previous merge yet)
[S2] round=27 local utility u=0.000000 metrics={'f1_val': 0.5208199530876809, 'auprc': 0.618707087944689, 'loss_val': 1.2255928689628246, 'psi': 0.5599748070304842}-{'f1_val': 0.5734036001918301, 'auprc': 0.6407658454150664, 'loss_val': 0.865522430797077, 'psi': 0.6003484982811247}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=27 head_norm_before_train=1.893152 (no previous merge yet)
[S3] round=27 local utility u=0.083118 metrics={'f1_val': 0.997542018298261, 'auprc': 0.999046059515018, 'loss_val': 0.05601614255826041, 'psi': 0.9981436347849637}-{'f1_val': 0.9720076763056362, 'auprc': 0.9988121133521166, 'loss_val': 0.06834465450537892, 'psi': 0.9827294511242284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=27 head_norm_before_train=1.436242 cos_to_last_merge=0.8750 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9370894881139067, 'auprc': 0.9611487774986331, 'loss_val': 0.2919339857817832, 'psi': 0.9467132038677973}-{'f1_val': 0.9503242342066595, 'auprc': 0.9605499309721396, 'loss_val': 0.3278972073917073, 'psi': 0.9544145129128515}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.480248 cos_to_last_merge=0.8303 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.830
[S5] round=27 local utility u=0.228855 metrics={'f1_val': 0.7003603281361598, 'auprc': 0.9957810164107905, 'loss_val': 0.22109869851695138, 'psi': 0.8185286034460121}-{'f1_val': 0.7009667515429574, 'auprc': 0.864336649323168, 'loss_val': 0.2881133605199543, 'psi': 0.7663147106550416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=27 head_norm_before_train=1.764663 (no previous merge yet)
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.5947731751084936, 'auprc': 0.8401594513695508, 'loss_val': 0.9838665148217641, 'psi': 0.6929276856129165}-{'f1_val': 0.8248640780462005, 'auprc': 0.9684871475388195, 'loss_val': 0.31841204845987736, 'psi': 0.8823133058432482}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.568816 (no previous merge yet)
[S7] round=27 local utility u=1.000000 metrics={'f1_val': 0.6739612846931828, 'auprc': 0.7937236979963851, 'loss_val': 0.5152430716985908, 'psi': 0.7218662500144637}-{'f1_val': 0.40070991044029186, 'auprc': 0.778960973660286, 'loss_val': 1.2026941897447576, 'psi': 0.5520103357282895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=27 head_norm_before_train=1.239731 cos_to_last_merge=0.8912 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.891
[S8] round=27 local utility u=0.910913 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9989503530274131, 'loss_val': 0.07957464696413498, 'psi': 0.9951422634895088}-{'f1_val': 0.7150705803838704, 'auprc': 0.9867130364823266, 'loss_val': 0.19949023987367634, 'psi': 0.8237275628232529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=27 head_norm_before_train=1.273297 cos_to_last_merge=0.9350 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=27 local utility u=0.012907 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9964972546344935, 'loss_val': 0.07323920643867063, 'psi': 0.9968606493610831}-{'f1_val': 0.9941897064172326, 'auprc': 0.9987570638215889, 'loss_val': 0.08835370985633044, 'psi': 0.9960166493789752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=27 head_norm_before_train=1.544289 cos_to_last_merge=0.9563 (last merge round=14)
[S10] round=27 local utility u=0.000000 metrics={'f1_val': 0.9909039558358865, 'auprc': 0.9956152159717616, 'loss_val': 0.06281238261946329, 'psi': 0.9927884598902366}-{'f1_val': 0.9927757495752743, 'auprc': 0.9950363321909426, 'loss_val': 0.05594455757444011, 'psi': 0.9936799826215417}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=27 head_norm_before_train=1.398289 cos_to_last_merge=0.9625 (last merge round=16)
[S11] round=27 local utility u=0.007041 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977587084352268, 'loss_val': 0.07256943583635717, 'psi': 0.9970316860822445}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976318762305003, 'loss_val': 0.08627029518515729, 'psi': 0.9969809532003538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=27 head_norm_before_train=1.679720 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5764030367593107, 'auprc': 0.6302349589242643, 'loss_val': 0.7392185245325766, 'psi': 0.5979358056252921}-{'f1_val': 0.6020453464605058, 'auprc': 0.6041605585761417, 'loss_val': 0.6198233329671171, 'psi': 0.6028914313067602}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.305455 cos_to_last_merge=0.9496 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.950
[S14] round=27 local utility u=0.024729 metrics={'f1_val': 0.9968300801588782, 'auprc': 0.9951469989128328, 'loss_val': 0.06360550263830643, 'psi': 0.99615684766046}-{'f1_val': 0.9917991843863939, 'auprc': 0.9951439387944412, 'loss_val': 0.08286879483285742, 'psi': 0.9931370861496127}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=27 head_norm_before_train=1.218735 cos_to_last_merge=0.9367 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=27 local utility u=1.000000 metrics={'f1_val': 0.9951406099747689, 'auprc': 0.9872222461199509, 'loss_val': 0.11346481381234975, 'psi': 0.9919732644328417}-{'f1_val': 0.7009169771696235, 'auprc': 0.7992725929875126, 'loss_val': 0.48630998936085873, 'psi': 0.7402592234967792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=27 head_norm_before_train=1.405295 cos_to_last_merge=0.8837 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.884
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.8272070226230633, 'auprc': 0.8849265802543936, 'loss_val': 0.8637310365828444, 'psi': 0.8502948456755954}-{'f1_val': 0.9876197218970606, 'auprc': 0.989390177050373, 'loss_val': 0.12107346657705031, 'psi': 0.9883279039583857}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.441288 cos_to_last_merge=0.7704 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.770
[S17] round=27 local utility u=1.000000 metrics={'f1_val': 0.6330286245474581, 'auprc': 0.9019255552619923, 'loss_val': 0.9856012707319898, 'psi': 0.7405873968332718}-{'f1_val': 0.3024675109809659, 'auprc': 0.7970279548618333, 'loss_val': 2.0398800531624977, 'psi': 0.5002916885333129}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=28 head_norm_before_train=1.788824 (no previous merge yet)
[S2] round=28 local utility u=1.000000 metrics={'f1_val': 0.7011014114923848, 'auprc': 0.7369436967592617, 'loss_val': 0.40267177244146235, 'psi': 0.7154383255991356}-{'f1_val': 0.5208199530876809, 'auprc': 0.618707087944689, 'loss_val': 1.2255928689628246, 'psi': 0.5599748070304842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=28 head_norm_before_train=1.916211 (no previous merge yet)
[S3] round=28 local utility u=0.003841 metrics={'f1_val': 0.9978389274664787, 'auprc': 0.9988964750810811, 'loss_val': 0.049665906371543375, 'psi': 0.9982619465123197}-{'f1_val': 0.997542018298261, 'auprc': 0.999046059515018, 'loss_val': 0.05601614255826041, 'psi': 0.9981436347849637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S4] START round=28 head_norm_before_train=1.457819 cos_to_last_merge=0.8689 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.869
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.913997899586031, 'auprc': 0.9480413383218138, 'loss_val': 0.3142679236132165, 'psi': 0.9276152750803441}-{'f1_val': 0.9370894881139067, 'auprc': 0.9611487774986331, 'loss_val': 0.2919339857817832, 'psi': 0.9467132038677973}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.492870 cos_to_last_merge=0.8271 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.827
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.7033843837012554, 'auprc': 0.9550035425199794, 'loss_val': 0.25488307817421807, 'psi': 0.804032047228745}-{'f1_val': 0.7003603281361598, 'auprc': 0.9957810164107905, 'loss_val': 0.22109869851695138, 'psi': 0.8185286034460121}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.776501 (no previous merge yet)
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.9619401743283196, 'auprc': 0.9910812097173765, 'loss_val': 0.1435357883940472, 'psi': 0.9735965884839424}-{'f1_val': 0.5947731751084936, 'auprc': 0.8401594513695508, 'loss_val': 0.9838665148217641, 'psi': 0.6929276856129165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=28 head_norm_before_train=1.574547 (no previous merge yet)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.4206579121121147, 'auprc': 0.7791031014046825, 'loss_val': 1.0176308969613943, 'psi': 0.5640359878291419}-{'f1_val': 0.6739612846931828, 'auprc': 0.7937236979963851, 'loss_val': 0.5152430716985908, 'psi': 0.7218662500144637}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.267658 cos_to_last_merge=0.8870 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.887
[S8] round=28 local utility u=0.002618 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9987450882872838, 'loss_val': 0.0728103764826132, 'psi': 0.9949689675862549}-{'f1_val': 0.9926035371309061, 'auprc': 0.9989503530274131, 'loss_val': 0.07957464696413498, 'psi': 0.9951422634895088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=28 head_norm_before_train=1.301928 cos_to_last_merge=0.9295 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9925154678702236, 'auprc': 0.9987845063438323, 'loss_val': 0.06607461694553401, 'psi': 0.9950230832596672}-{'f1_val': 0.9971029125121428, 'auprc': 0.9964972546344935, 'loss_val': 0.07323920643867063, 'psi': 0.9968606493610831}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.568813 cos_to_last_merge=0.9530 (last merge round=14)
[S10] round=28 local utility u=0.000442 metrics={'f1_val': 0.990768674291531, 'auprc': 0.9955722282830091, 'loss_val': 0.06098783740768801, 'psi': 0.9926900958881222}-{'f1_val': 0.9909039558358865, 'auprc': 0.9956152159717616, 'loss_val': 0.06281238261946329, 'psi': 0.9927884598902366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=28 head_norm_before_train=1.436912 cos_to_last_merge=0.9574 (last merge round=16)
[S11] round=28 local utility u=0.004780 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975395172525077, 'loss_val': 0.062352765285940956, 'psi': 0.9969440096091569}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977587084352268, 'loss_val': 0.07256943583635717, 'psi': 0.9970316860822445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=28 head_norm_before_train=1.693530 (no previous merge yet)
[S13] round=28 local utility u=0.072218 metrics={'f1_val': 0.582436165310449, 'auprc': 0.6331480765667103, 'loss_val': 0.6397214752310397, 'psi': 0.6027209298129534}-{'f1_val': 0.5764030367593107, 'auprc': 0.6302349589242643, 'loss_val': 0.7392185245325766, 'psi': 0.5979358056252921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=28 head_norm_before_train=1.329133 cos_to_last_merge=0.9470 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.947
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9944834033762937, 'loss_val': 0.062053204665178115, 'psi': 0.9957457003169676}-{'f1_val': 0.9968300801588782, 'auprc': 0.9951469989128328, 'loss_val': 0.06360550263830643, 'psi': 0.99615684766046}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.237653 cos_to_last_merge=0.9337 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.9838400227958107, 'auprc': 0.9859886867066123, 'loss_val': 0.147375023808675, 'psi': 0.9846994883601314}-{'f1_val': 0.9951406099747689, 'auprc': 0.9872222461199509, 'loss_val': 0.11346481381234975, 'psi': 0.9919732644328417}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.425953 cos_to_last_merge=0.8808 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.881
[S16] round=28 local utility u=1.000000 metrics={'f1_val': 0.9916770402665274, 'auprc': 0.994686740373607, 'loss_val': 0.060260549707004354, 'psi': 0.9928809203093593}-{'f1_val': 0.8272070226230633, 'auprc': 0.8849265802543936, 'loss_val': 0.8637310365828444, 'psi': 0.8502948456755954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=28 head_norm_before_train=1.460706 cos_to_last_merge=0.7690 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.769
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.5868151538522205, 'auprc': 0.8724479760237167, 'loss_val': 0.992772882672442, 'psi': 0.701068282720819}-{'f1_val': 0.6330286245474581, 'auprc': 0.9019255552619923, 'loss_val': 0.9856012707319898, 'psi': 0.7405873968332718}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=29 head_norm_before_train=1.793477 (no previous merge yet)
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7049240193615169, 'auprc': 0.6867752312819613, 'loss_val': 0.34577818869659055, 'psi': 0.6976645041296947}-{'f1_val': 0.7011014114923848, 'auprc': 0.7369436967592617, 'loss_val': 0.40267177244146235, 'psi': 0.7154383255991356}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=1.937529 (no previous merge yet)
[S3] round=29 local utility u=0.000000 metrics={'f1_val': 0.9399269866700216, 'auprc': 0.9992023005884545, 'loss_val': 0.1433705652634281, 'psi': 0.9636371122373948}-{'f1_val': 0.9978389274664787, 'auprc': 0.9988964750810811, 'loss_val': 0.049665906371543375, 'psi': 0.9982619465123197}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=29 head_norm_before_train=1.481933 cos_to_last_merge=0.8625 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.863
[S4] round=29 local utility u=0.047432 metrics={'f1_val': 0.9311094039838236, 'auprc': 0.9370710177326688, 'loss_val': 0.2891623609474853, 'psi': 0.9334940494833617}-{'f1_val': 0.913997899586031, 'auprc': 0.9480413383218138, 'loss_val': 0.3142679236132165, 'psi': 0.9276152750803441}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=29 head_norm_before_train=1.507108 cos_to_last_merge=0.8249 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.825
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.7141735531619898, 'auprc': 0.7938473747734622, 'loss_val': 0.5122695812962387, 'psi': 0.7460430818065789}-{'f1_val': 0.7033843837012554, 'auprc': 0.9550035425199794, 'loss_val': 0.25488307817421807, 'psi': 0.804032047228745}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.785657 (no previous merge yet)
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.7004200923683586, 'auprc': 0.9422225472814084, 'loss_val': 0.6954361948253401, 'psi': 0.7971410743335785}-{'f1_val': 0.9619401743283196, 'auprc': 0.9910812097173765, 'loss_val': 0.1435357883940472, 'psi': 0.9735965884839424}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.579495 (no previous merge yet)
[S7] round=29 local utility u=0.998729 metrics={'f1_val': 0.6694596734329197, 'auprc': 0.7881606474073131, 'loss_val': 0.5401568664931453, 'psi': 0.716940063022677}-{'f1_val': 0.4206579121121147, 'auprc': 0.7791031014046825, 'loss_val': 1.0176308969613943, 'psi': 0.5640359878291419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=29 head_norm_before_train=1.292668 cos_to_last_merge=0.8835 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.883
[S8] round=29 local utility u=0.004626 metrics={'f1_val': 0.9933593890417576, 'auprc': 0.9983420707580072, 'loss_val': 0.06779552483856324, 'psi': 0.9953524617282574}-{'f1_val': 0.9924515537855688, 'auprc': 0.9987450882872838, 'loss_val': 0.0728103764826132, 'psi': 0.9949689675862549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=29 head_norm_before_train=1.330496 cos_to_last_merge=0.9242 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=29 local utility u=0.014195 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9973291113778084, 'loss_val': 0.055852563352941365, 'psi': 0.9966942619893671}-{'f1_val': 0.9925154678702236, 'auprc': 0.9987845063438323, 'loss_val': 0.06607461694553401, 'psi': 0.9950230832596672}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=29 head_norm_before_train=1.591733 cos_to_last_merge=0.9502 (last merge round=14)
[S10] round=29 local utility u=0.008353 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9927988510894146, 'loss_val': 0.04810433019435822, 'psi': 0.9927949167339867}-{'f1_val': 0.990768674291531, 'auprc': 0.9955722282830091, 'loss_val': 0.06098783740768801, 'psi': 0.9926900958881222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] START round=29 head_norm_before_train=1.473928 cos_to_last_merge=0.9525 (last merge round=16)
[S11] round=29 local utility u=0.002698 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997552725923321, 'loss_val': 0.05554577892048904, 'psi': 0.996804190850645}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975395172525077, 'loss_val': 0.062352765285940956, 'psi': 0.9969440096091569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=29 head_norm_before_train=1.707252 (no previous merge yet)
[S13] round=29 local utility u=0.028243 metrics={'f1_val': 0.5913749136141664, 'auprc': 0.6669108280702691, 'loss_val': 0.7381559987050903, 'psi': 0.6215892793966075}-{'f1_val': 0.582436165310449, 'auprc': 0.6331480765667103, 'loss_val': 0.6397214752310397, 'psi': 0.6027209298129534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=29 head_norm_before_train=1.351767 cos_to_last_merge=0.9447 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.945
[S14] round=29 local utility u=0.002201 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9949711000500702, 'loss_val': 0.059114302801020924, 'psi': 0.9959407789864783}-{'f1_val': 0.9965872316107504, 'auprc': 0.9944834033762937, 'loss_val': 0.062053204665178115, 'psi': 0.9957457003169676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=29 head_norm_before_train=1.255184 cos_to_last_merge=0.9314 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.7253086716171117, 'auprc': 0.8790994744300665, 'loss_val': 0.39814499645694024, 'psi': 0.7868249927422937}-{'f1_val': 0.9838400227958107, 'auprc': 0.9859886867066123, 'loss_val': 0.147375023808675, 'psi': 0.9846994883601314}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.443317 cos_to_last_merge=0.8784 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.878
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8125209711278679, 'auprc': 0.9376756624024775, 'loss_val': 0.6472443827117428, 'psi': 0.8625828476377118}-{'f1_val': 0.9916770402665274, 'auprc': 0.994686740373607, 'loss_val': 0.060260549707004354, 'psi': 0.9928809203093593}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.482849 cos_to_last_merge=0.7679 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.768
[S17] round=29 local utility u=0.465182 metrics={'f1_val': 0.7358412839186093, 'auprc': 0.8701272803030935, 'loss_val': 0.9496034247551733, 'psi': 0.7895556824724029}-{'f1_val': 0.5868151538522205, 'auprc': 0.8724479760237167, 'loss_val': 0.992772882672442, 'psi': 0.701068282720819}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=30 head_norm_before_train=1.797467 (no previous merge yet)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.6072647337658981, 'auprc': 0.6787457551866237, 'loss_val': 0.6114734347889222, 'psi': 0.6358571423341883}-{'f1_val': 0.7049240193615169, 'auprc': 0.6867752312819613, 'loss_val': 0.34577818869659055, 'psi': 0.6976645041296947}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=30 head_norm_before_train=1.956673 (no previous merge yet)
[S3] round=30 local utility u=0.220002 metrics={'f1_val': 0.996718896605481, 'auprc': 0.9987664429896186, 'loss_val': 0.042809511048822226, 'psi': 0.997537915159136}-{'f1_val': 0.9399269866700216, 'auprc': 0.9992023005884545, 'loss_val': 0.1433705652634281, 'psi': 0.9636371122373948}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=30 head_norm_before_train=1.502048 cos_to_last_merge=0.8574 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.857
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9092752264921009, 'auprc': 0.9514965407660291, 'loss_val': 0.33695477565141957, 'psi': 0.9261637522016722}-{'f1_val': 0.9311094039838236, 'auprc': 0.9370710177326688, 'loss_val': 0.2891623609474853, 'psi': 0.9334940494833617}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.521106 cos_to_last_merge=0.8231 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=30 local utility u=0.346980 metrics={'f1_val': 0.7080842304113051, 'auprc': 0.9541944984562455, 'loss_val': 0.2628146052876317, 'psi': 0.8065283376292813}-{'f1_val': 0.7141735531619898, 'auprc': 0.7938473747734622, 'loss_val': 0.5122695812962387, 'psi': 0.7460430818065789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=30 head_norm_before_train=1.794140 (no previous merge yet)
[S6] round=30 local utility u=0.535613 metrics={'f1_val': 0.8231384004149451, 'auprc': 0.9622611543142482, 'loss_val': 0.42063486961812685, 'psi': 0.8787875019746664}-{'f1_val': 0.7004200923683586, 'auprc': 0.9422225472814084, 'loss_val': 0.6954361948253401, 'psi': 0.7971410743335785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=30 head_norm_before_train=1.586355 (no previous merge yet)
[S7] round=30 local utility u=0.029058 metrics={'f1_val': 0.6722400716180437, 'auprc': 0.7950393261625296, 'loss_val': 0.5193602001439208, 'psi': 0.7213597734358381}-{'f1_val': 0.6694596734329197, 'auprc': 0.7881606474073131, 'loss_val': 0.5401568664931453, 'psi': 0.716940063022677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=30 head_norm_before_train=1.313374 cos_to_last_merge=0.8804 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.880
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9987275862183901, 'loss_val': 0.06428687551454274, 'psi': 0.9948290918968345}-{'f1_val': 0.9933593890417576, 'auprc': 0.9983420707580072, 'loss_val': 0.06779552483856324, 'psi': 0.9953524617282574}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.356558 cos_to_last_merge=0.9198 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9988110075655687, 'loss_val': 0.056689225706739614, 'psi': 0.9938739468425151}-{'f1_val': 0.9962710290637395, 'auprc': 0.9973291113778084, 'loss_val': 0.055852563352941365, 'psi': 0.9966942619893671}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.612724 cos_to_last_merge=0.9477 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=30 local utility u=0.006101 metrics={'f1_val': 0.9941077514882151, 'auprc': 0.9926409423644652, 'loss_val': 0.04332223812922478, 'psi': 0.9935210278387151}-{'f1_val': 0.9927922938303682, 'auprc': 0.9927988510894146, 'loss_val': 0.04810433019435822, 'psi': 0.9927949167339867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=30 head_norm_before_train=1.507399 cos_to_last_merge=0.9480 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=30 local utility u=0.000000 metrics={'f1_val': 0.9943832894246155, 'auprc': 0.9973866992956815, 'loss_val': 0.05597275562318116, 'psi': 0.9955846533730419}-{'f1_val': 0.996305167468861, 'auprc': 0.997552725923321, 'loss_val': 0.05554577892048904, 'psi': 0.996804190850645}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=30 head_norm_before_train=1.718529 (no previous merge yet)
[S13] round=30 local utility u=0.141711 metrics={'f1_val': 0.6120264759583759, 'auprc': 0.6790279225827751, 'loss_val': 0.6149937569240304, 'psi': 0.6388270546081356}-{'f1_val': 0.5913749136141664, 'auprc': 0.6669108280702691, 'loss_val': 0.7381559987050903, 'psi': 0.6215892793966075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S13] sending update (kind=head size=1807 to 1 peers)
[S14] START round=30 head_norm_before_train=1.372461 cos_to_last_merge=0.9426 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=30 local utility u=0.002785 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9951742542859275, 'loss_val': 0.05415328337677107, 'psi': 0.9960220406808212}-{'f1_val': 0.9965872316107504, 'auprc': 0.9949711000500702, 'loss_val': 0.059114302801020924, 'psi': 0.9959407789864783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=30 head_norm_before_train=1.273440 cos_to_last_merge=0.9291 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=30 local utility u=0.168286 metrics={'f1_val': 0.7593771449623825, 'auprc': 0.9118531204539533, 'loss_val': 0.3642448836833907, 'psi': 0.8203675351590107}-{'f1_val': 0.7253086716171117, 'auprc': 0.8790994744300665, 'loss_val': 0.39814499645694024, 'psi': 0.7868249927422937}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=30 head_norm_before_train=1.460651 cos_to_last_merge=0.8762 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.876
[S16] round=30 local utility u=0.631736 metrics={'f1_val': 0.9325728084508278, 'auprc': 0.9894459550290209, 'loss_val': 0.2593945558735306, 'psi': 0.955322067082105}-{'f1_val': 0.8125209711278679, 'auprc': 0.9376756624024775, 'loss_val': 0.6472443827117428, 'psi': 0.8625828476377118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.509898 cos_to_last_merge=0.7663 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.766
[S17] round=30 local utility u=0.000000 metrics={'f1_val': 0.6176703110471758, 'auprc': 0.8837495225311442, 'loss_val': 0.979953176714364, 'psi': 0.7241019956407633}-{'f1_val': 0.7358412839186093, 'auprc': 0.8701272803030935, 'loss_val': 0.9496034247551733, 'psi': 0.7895556824724029}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=31 head_norm_before_train=1.805231 (no previous merge yet)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.59802467534577, 'auprc': 0.6440754830922083, 'loss_val': 0.6845668502367918, 'psi': 0.6164449984443453}-{'f1_val': 0.6072647337658981, 'auprc': 0.6787457551866237, 'loss_val': 0.6114734347889222, 'psi': 0.6358571423341883}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=1.973875 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.9724549131111073, 'auprc': 0.999121343770212, 'loss_val': 0.06793442597097583, 'psi': 0.9831214853747492}-{'f1_val': 0.996718896605481, 'auprc': 0.9987664429896186, 'loss_val': 0.042809511048822226, 'psi': 0.997537915159136}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.516947 cos_to_last_merge=0.8538 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.854
[S4] round=31 local utility u=0.008599 metrics={'f1_val': 0.9131469508485052, 'auprc': 0.9436673337493594, 'loss_val': 0.3194991593915123, 'psi': 0.9253551040088469}-{'f1_val': 0.9092752264921009, 'auprc': 0.9514965407660291, 'loss_val': 0.33695477565141957, 'psi': 0.9261637522016722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=31 head_norm_before_train=1.530659 cos_to_last_merge=0.8215 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.822
[S5] round=31 local utility u=0.010319 metrics={'f1_val': 0.7129690087435515, 'auprc': 0.9555116621162862, 'loss_val': 0.2754376853524139, 'psi': 0.8099860700926453}-{'f1_val': 0.7080842304113051, 'auprc': 0.9541944984562455, 'loss_val': 0.2628146052876317, 'psi': 0.8065283376292813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=31 head_norm_before_train=1.799809 (no previous merge yet)
[S6] round=31 local utility u=0.000000 metrics={'f1_val': 0.8026716699262775, 'auprc': 0.9580184183488922, 'loss_val': 0.48329611622185314, 'psi': 0.8648103692953233}-{'f1_val': 0.8231384004149451, 'auprc': 0.9622611543142482, 'loss_val': 0.42063486961812685, 'psi': 0.8787875019746664}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=31 head_norm_before_train=1.595643 (no previous merge yet)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4744982117092773, 'auprc': 0.7794643034088529, 'loss_val': 0.9833412059566431, 'psi': 0.5964846483891075}-{'f1_val': 0.6722400716180437, 'auprc': 0.7950393261625296, 'loss_val': 0.5193602001439208, 'psi': 0.7213597734358381}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.335004 cos_to_last_merge=0.8773 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.877
[S8] round=31 local utility u=0.002388 metrics={'f1_val': 0.9926187643933835, 'auprc': 0.998037136996812, 'loss_val': 0.05977185158463262, 'psi': 0.9947861134347549}-{'f1_val': 0.9922300956824643, 'auprc': 0.9987275862183901, 'loss_val': 0.06428687551454274, 'psi': 0.9948290918968345}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=31 head_norm_before_train=1.380187 cos_to_last_merge=0.9160 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.916
[S9] round=31 local utility u=0.018725 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9988043231920747, 'loss_val': 0.04686218622057346, 'psi': 0.9966355409541938}-{'f1_val': 0.990582573027146, 'auprc': 0.9988110075655687, 'loss_val': 0.056689225706739614, 'psi': 0.9938739468425151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=31 head_norm_before_train=1.633382 cos_to_last_merge=0.9454 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.945
[S10] round=31 local utility u=0.002170 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9949767127761023, 'loss_val': 0.04193957863952983, 'psi': 0.9940503100029845}-{'f1_val': 0.9941077514882151, 'auprc': 0.9926409423644652, 'loss_val': 0.04332223812922478, 'psi': 0.9935210278387151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=31 head_norm_before_train=1.537642 cos_to_last_merge=0.9441 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=31 local utility u=0.011396 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976036914944942, 'loss_val': 0.04536294478184922, 'psi': 0.9968245770791142}-{'f1_val': 0.9943832894246155, 'auprc': 0.9973866992956815, 'loss_val': 0.05597275562318116, 'psi': 0.9955846533730419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=31 head_norm_before_train=1.727841 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.6099809329464287, 'auprc': 0.7098438061352305, 'loss_val': 0.7055107525020672, 'psi': 0.6499260822219495}-{'f1_val': 0.6120264759583759, 'auprc': 0.6790279225827751, 'loss_val': 0.6149937569240304, 'psi': 0.6388270546081356}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.389430 cos_to_last_merge=0.9407 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.941
[S14] round=31 local utility u=0.002836 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9951354210939237, 'loss_val': 0.050826576804729635, 'psi': 0.9962526733321686}-{'f1_val': 0.9965872316107504, 'auprc': 0.9951742542859275, 'loss_val': 0.05415328337677107, 'psi': 0.9960220406808212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=31 head_norm_before_train=1.295920 cos_to_last_merge=0.9262 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=31 local utility u=0.476607 metrics={'f1_val': 0.896914298458416, 'auprc': 0.9198692609519025, 'loss_val': 0.2603014995073683, 'psi': 0.9060962834558106}-{'f1_val': 0.7593771449623825, 'auprc': 0.9118531204539533, 'loss_val': 0.3642448836833907, 'psi': 0.8203675351590107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=31 head_norm_before_train=1.477336 cos_to_last_merge=0.8742 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.874
[S16] round=31 local utility u=0.288795 metrics={'f1_val': 0.9916044831403286, 'auprc': 0.9970893694823119, 'loss_val': 0.05892579884431437, 'psi': 0.9937984376771218}-{'f1_val': 0.9325728084508278, 'auprc': 0.9894459550290209, 'loss_val': 0.2593945558735306, 'psi': 0.955322067082105}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=31 head_norm_before_train=1.538313 cos_to_last_merge=0.7647 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.765
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.5840884899614106, 'auprc': 0.8240124902022941, 'loss_val': 1.1638002000678813, 'psi': 0.680058090057764}-{'f1_val': 0.6176703110471758, 'auprc': 0.8837495225311442, 'loss_val': 0.979953176714364, 'psi': 0.7241019956407633}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.812495 (no previous merge yet)
[S2] round=32 local utility u=0.618409 metrics={'f1_val': 0.7073592245579944, 'auprc': 0.7356989902951474, 'loss_val': 0.37862667161594454, 'psi': 0.7186951308528555}-{'f1_val': 0.59802467534577, 'auprc': 0.6440754830922083, 'loss_val': 0.6845668502367918, 'psi': 0.6164449984443453}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=32 head_norm_before_train=1.989407 (no previous merge yet)
[S3] round=32 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.999417661728208, 'loss_val': 0.11488716237460443, 'psi': 0.9764121159309554}-{'f1_val': 0.9724549131111073, 'auprc': 0.999121343770212, 'loss_val': 0.06793442597097583, 'psi': 0.9831214853747492}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=32 head_norm_before_train=1.530737 cos_to_last_merge=0.8507 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=32 local utility u=0.156424 metrics={'f1_val': 0.9346091597132767, 'auprc': 0.9834611774914812, 'loss_val': 0.25480619406359095, 'psi': 0.9541499668245585}-{'f1_val': 0.9131469508485052, 'auprc': 0.9436673337493594, 'loss_val': 0.3194991593915123, 'psi': 0.9253551040088469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=32 head_norm_before_train=1.540645 cos_to_last_merge=0.8204 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.820
[S5] round=32 local utility u=0.000000 metrics={'f1_val': 0.7142397364216113, 'auprc': 0.7936615218795967, 'loss_val': 0.6012841829814636, 'psi': 0.7460084506048055}-{'f1_val': 0.7129690087435515, 'auprc': 0.9555116621162862, 'loss_val': 0.2754376853524139, 'psi': 0.8099860700926453}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=32 head_norm_before_train=1.809076 (no previous merge yet)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.7261514988549314, 'auprc': 0.9498439488112488, 'loss_val': 0.6270351860791891, 'psi': 0.8156284788374584}-{'f1_val': 0.8026716699262775, 'auprc': 0.9580184183488922, 'loss_val': 0.48329611622185314, 'psi': 0.8648103692953233}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.604353 (no previous merge yet)
[S7] round=32 local utility u=0.858465 metrics={'f1_val': 0.669245148314145, 'auprc': 0.8010507220827148, 'loss_val': 0.49965268642265576, 'psi': 0.7219673778215729}-{'f1_val': 0.4744982117092773, 'auprc': 0.7794643034088529, 'loss_val': 0.9833412059566431, 'psi': 0.5964846483891075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=32 head_norm_before_train=1.359415 cos_to_last_merge=0.8735 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.874
[S8] round=32 local utility u=0.000000 metrics={'f1_val': 0.9935252750776847, 'auprc': 0.9888770688563135, 'loss_val': 0.06568235049300518, 'psi': 0.9916659925891362}-{'f1_val': 0.9926187643933835, 'auprc': 0.998037136996812, 'loss_val': 0.05977185158463262, 'psi': 0.9947861134347549}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=32 head_norm_before_train=1.400505 cos_to_last_merge=0.9128 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.913
[S9] round=32 local utility u=0.001683 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9947237142335201, 'loss_val': 0.042733362820135574, 'psi': 0.9961512332006938}-{'f1_val': 0.99518968612894, 'auprc': 0.9988043231920747, 'loss_val': 0.04686218622057346, 'psi': 0.9966355409541938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=32 head_norm_before_train=1.647902 cos_to_last_merge=0.9431 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9954915577126917, 'loss_val': 0.04299420125672836, 'psi': 0.993993420909814}-{'f1_val': 0.9934327081542391, 'auprc': 0.9949767127761023, 'loss_val': 0.04193957863952983, 'psi': 0.9940503100029845}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=1.563297 cos_to_last_merge=0.9409 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=32 local utility u=0.002384 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976368063772293, 'loss_val': 0.0421449732397767, 'psi': 0.9969829252590454}-{'f1_val': 0.996305167468861, 'auprc': 0.9976036914944942, 'loss_val': 0.04536294478184922, 'psi': 0.9968245770791142}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=32 head_norm_before_train=1.736808 (no previous merge yet)
[S13] round=32 local utility u=0.060148 metrics={'f1_val': 0.6117555355706882, 'auprc': 0.6931537408397137, 'loss_val': 0.545792724675982, 'psi': 0.6443148176782985}-{'f1_val': 0.6099809329464287, 'auprc': 0.7098438061352305, 'loss_val': 0.7055107525020672, 'psi': 0.6499260822219495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=32 head_norm_before_train=1.404052 cos_to_last_merge=0.9393 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.939
[S14] round=32 local utility u=0.000147 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9951393689211436, 'loss_val': 0.050544935743309996, 'psi': 0.9962542524630564}-{'f1_val': 0.9969975081576651, 'auprc': 0.9951354210939237, 'loss_val': 0.050826576804729635, 'psi': 0.9962526733321686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=32 head_norm_before_train=1.318274 cos_to_last_merge=0.9230 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=32 local utility u=0.187911 metrics={'f1_val': 0.906472577651874, 'auprc': 0.989928600172009, 'loss_val': 0.1520081602192238, 'psi': 0.939854986659928}-{'f1_val': 0.896914298458416, 'auprc': 0.9198692609519025, 'loss_val': 0.2603014995073683, 'psi': 0.9060962834558106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=32 head_norm_before_train=1.492158 cos_to_last_merge=0.8722 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.872
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.991142829765774, 'auprc': 0.9884545211649292, 'loss_val': 0.05716614945987659, 'psi': 0.990067506325436}-{'f1_val': 0.9916044831403286, 'auprc': 0.9970893694823119, 'loss_val': 0.05892579884431437, 'psi': 0.9937984376771218}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.569780 cos_to_last_merge=0.7633 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.763
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.550477848817021, 'auprc': 0.8582434651870179, 'loss_val': 1.1687728191602254, 'psi': 0.6735840953650198}-{'f1_val': 0.5840884899614106, 'auprc': 0.8240124902022941, 'loss_val': 1.1638002000678813, 'psi': 0.680058090057764}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=33 head_norm_before_train=1.822239 (no previous merge yet)
[S2] round=33 local utility u=0.000000 metrics={'f1_val': 0.6575934695564896, 'auprc': 0.7053939954881516, 'loss_val': 0.39064139799549774, 'psi': 0.6767136799291544}-{'f1_val': 0.7073592245579944, 'auprc': 0.7356989902951474, 'loss_val': 0.37862667161594454, 'psi': 0.7186951308528555}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=33 head_norm_before_train=2.004677 (no previous merge yet)
[S3] round=33 local utility u=0.101423 metrics={'f1_val': 0.9834363840689774, 'auprc': 0.9992286980239657, 'loss_val': 0.045642174129080615, 'psi': 0.9897533096509727}-{'f1_val': 0.9610750853994537, 'auprc': 0.999417661728208, 'loss_val': 0.11488716237460443, 'psi': 0.9764121159309554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=33 head_norm_before_train=1.544650 cos_to_last_merge=0.8475 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.848
[S4] round=33 local utility u=0.010844 metrics={'f1_val': 0.9406106975650397, 'auprc': 0.9838682122968142, 'loss_val': 0.2703480920086142, 'psi': 0.9579137034577495}-{'f1_val': 0.9346091597132767, 'auprc': 0.9834611774914812, 'loss_val': 0.25480619406359095, 'psi': 0.9541499668245585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=33 head_norm_before_train=1.553000 cos_to_last_merge=0.8190 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.819
[S5] round=33 local utility u=1.000000 metrics={'f1_val': 0.9463792290118221, 'auprc': 0.9935378387195286, 'loss_val': 0.17304994851390829, 'psi': 0.9652426728949047}-{'f1_val': 0.7142397364216113, 'auprc': 0.7936615218795967, 'loss_val': 0.6012841829814636, 'psi': 0.7460084506048055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=33 head_norm_before_train=1.817536 (no previous merge yet)
[S6] round=33 local utility u=0.890852 metrics={'f1_val': 0.9592498703057553, 'auprc': 0.9563038528085982, 'loss_val': 0.2633001646782776, 'psi': 0.9580714633068924}-{'f1_val': 0.7261514988549314, 'auprc': 0.9498439488112488, 'loss_val': 0.6270351860791891, 'psi': 0.8156284788374584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=33 head_norm_before_train=1.610660 (no previous merge yet)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.4920008915093702, 'auprc': 0.7802209060305965, 'loss_val': 0.9492497995866451, 'psi': 0.6072888973178607}-{'f1_val': 0.669245148314145, 'auprc': 0.8010507220827148, 'loss_val': 0.49965268642265576, 'psi': 0.7219673778215729}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.382414 cos_to_last_merge=0.8697 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.870
[S8] round=33 local utility u=0.001909 metrics={'f1_val': 0.9881372834100528, 'auprc': 0.9988942753074138, 'loss_val': 0.05958707676055265, 'psi': 0.9924400801689972}-{'f1_val': 0.9935252750776847, 'auprc': 0.9888770688563135, 'loss_val': 0.06568235049300518, 'psi': 0.9916659925891362}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=33 head_norm_before_train=1.420331 cos_to_last_merge=0.9098 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.910
[S9] round=33 local utility u=0.002200 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9951693305641396, 'loss_val': 0.03967046400306516, 'psi': 0.9963294797329415}-{'f1_val': 0.9971029125121428, 'auprc': 0.9947237142335201, 'loss_val': 0.042733362820135574, 'psi': 0.9961512332006938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=33 head_norm_before_train=1.662465 cos_to_last_merge=0.9405 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.941
[S10] round=33 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9937718909500778, 'loss_val': 0.04496937463469246, 'psi': 0.9931742061251957}-{'f1_val': 0.992994663041229, 'auprc': 0.9954915577126917, 'loss_val': 0.04299420125672836, 'psi': 0.993993420909814}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=33 head_norm_before_train=1.587129 cos_to_last_merge=0.9379 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=33 local utility u=0.000428 metrics={'f1_val': 0.996305167468861, 'auprc': 0.997629750058883, 'loss_val': 0.039816524992856116, 'psi': 0.9968350005048698}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976368063772293, 'loss_val': 0.0421449732397767, 'psi': 0.9969829252590454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=33 head_norm_before_train=1.744358 (no previous merge yet)
[S13] round=33 local utility u=0.000000 metrics={'f1_val': 0.6032159640153116, 'auprc': 0.7194841999943044, 'loss_val': 0.7824120283680654, 'psi': 0.6497232584069088}-{'f1_val': 0.6117555355706882, 'auprc': 0.6931537408397137, 'loss_val': 0.545792724675982, 'psi': 0.6443148176782985}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=33 head_norm_before_train=1.417349 cos_to_last_merge=0.9380 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.938
[S14] round=33 local utility u=0.000000 metrics={'f1_val': 0.996124188334813, 'auprc': 0.9951651323260285, 'loss_val': 0.046753621337271054, 'psi': 0.9957405659312992}-{'f1_val': 0.9969975081576651, 'auprc': 0.9951393689211436, 'loss_val': 0.050544935743309996, 'psi': 0.9962542524630564}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=33 head_norm_before_train=1.338227 cos_to_last_merge=0.9200 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=33 local utility u=0.323606 metrics={'f1_val': 0.9960143947672967, 'auprc': 0.9966496660838644, 'loss_val': 0.06220967495854497, 'psi': 0.9962685032939238}-{'f1_val': 0.906472577651874, 'auprc': 0.989928600172009, 'loss_val': 0.1520081602192238, 'psi': 0.939854986659928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=33 head_norm_before_train=1.507041 cos_to_last_merge=0.8703 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.870
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8606821209463782, 'auprc': 0.9927007140277266, 'loss_val': 0.6384921174985326, 'psi': 0.9134895581789175}-{'f1_val': 0.991142829765774, 'auprc': 0.9884545211649292, 'loss_val': 0.05716614945987659, 'psi': 0.990067506325436}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.601340 cos_to_last_merge=0.7620 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=33 local utility u=0.338511 metrics={'f1_val': 0.616313024777405, 'auprc': 0.8760567945788645, 'loss_val': 0.9402019701244536, 'psi': 0.7202105326979888}-{'f1_val': 0.550477848817021, 'auprc': 0.8582434651870179, 'loss_val': 1.1687728191602254, 'psi': 0.6735840953650198}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=34 head_norm_before_train=1.833928 (no previous merge yet)
[S2] round=34 local utility u=0.206323 metrics={'f1_val': 0.7094132102394908, 'auprc': 0.7349385799848569, 'loss_val': 0.3775475135892112, 'psi': 0.7196233581376372}-{'f1_val': 0.6575934695564896, 'auprc': 0.7053939954881516, 'loss_val': 0.39064139799549774, 'psi': 0.6767136799291544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=34 head_norm_before_train=2.020144 (no previous merge yet)
[S3] round=34 local utility u=0.052568 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9990941283956835, 'loss_val': 0.02634478913122814, 'psi': 0.9983236719188491}-{'f1_val': 0.9834363840689774, 'auprc': 0.9992286980239657, 'loss_val': 0.045642174129080615, 'psi': 0.9897533096509727}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=34 head_norm_before_train=1.562041 cos_to_last_merge=0.8436 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.844
[S4] round=34 local utility u=0.000000 metrics={'f1_val': 0.9490501436948703, 'auprc': 0.9591862128800135, 'loss_val': 0.2967284090485231, 'psi': 0.9531045713689276}-{'f1_val': 0.9406106975650397, 'auprc': 0.9838682122968142, 'loss_val': 0.2703480920086142, 'psi': 0.9579137034577495}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=34 head_norm_before_train=1.560949 cos_to_last_merge=0.8179 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=34 local utility u=0.177084 metrics={'f1_val': 0.9964799208068884, 'auprc': 0.9969656001594716, 'loss_val': 0.12976994636791112, 'psi': 0.9966741925479217}-{'f1_val': 0.9463792290118221, 'auprc': 0.9935378387195286, 'loss_val': 0.17304994851390829, 'psi': 0.9652426728949047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=34 head_norm_before_train=1.824262 (no previous merge yet)
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8223795166477608, 'auprc': 0.952819835722088, 'loss_val': 0.44134542725848136, 'psi': 0.8745556442774916}-{'f1_val': 0.9592498703057553, 'auprc': 0.9563038528085982, 'loss_val': 0.2633001646782776, 'psi': 0.9580714633068924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.615031 (no previous merge yet)
[S7] round=34 local utility u=1.000000 metrics={'f1_val': 0.6922329565522514, 'auprc': 0.9044911020605108, 'loss_val': 0.2930623955191657, 'psi': 0.7771362147555552}-{'f1_val': 0.4920008915093702, 'auprc': 0.7802209060305965, 'loss_val': 0.9492497995866451, 'psi': 0.6072888973178607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=34 head_norm_before_train=1.404547 cos_to_last_merge=0.8665 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.866
[S8] round=34 local utility u=0.011743 metrics={'f1_val': 0.9931569338135257, 'auprc': 0.9952914528011297, 'loss_val': 0.05541034976586881, 'psi': 0.9940107414085673}-{'f1_val': 0.9881372834100528, 'auprc': 0.9988942753074138, 'loss_val': 0.05958707676055265, 'psi': 0.9924400801689972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=34 head_norm_before_train=1.437437 cos_to_last_merge=0.9073 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.907
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9988221263257624, 'loss_val': 0.041665320389395175, 'psi': 0.9956418057209502}-{'f1_val': 0.9971029125121428, 'auprc': 0.9951693305641396, 'loss_val': 0.03967046400306516, 'psi': 0.9963294797329415}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.676404 cos_to_last_merge=0.9384 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9853371059373331, 'auprc': 0.9958740432567601, 'loss_val': 0.05872331908313974, 'psi': 0.989551880865104}-{'f1_val': 0.9927757495752743, 'auprc': 0.9937718909500778, 'loss_val': 0.04496937463469246, 'psi': 0.9931742061251957}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=1.610573 cos_to_last_merge=0.9351 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=34 local utility u=0.002409 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976914980834076, 'loss_val': 0.03663438442435811, 'psi': 0.9970048019415167}-{'f1_val': 0.996305167468861, 'auprc': 0.997629750058883, 'loss_val': 0.039816524992856116, 'psi': 0.9968350005048698}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=34 head_norm_before_train=1.751032 (no previous merge yet)
[S13] round=34 local utility u=0.076350 metrics={'f1_val': 0.6036930932127644, 'auprc': 0.7227805636127979, 'loss_val': 0.6424641268211927, 'psi': 0.6513280813727778}-{'f1_val': 0.6032159640153116, 'auprc': 0.7194841999943044, 'loss_val': 0.7824120283680654, 'psi': 0.6497232584069088}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=34 head_norm_before_train=1.432011 cos_to_last_merge=0.9366 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.937
[S14] round=34 local utility u=0.004042 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9967809883296644, 'loss_val': 0.046295627847860135, 'psi': 0.9966647342983159}-{'f1_val': 0.996124188334813, 'auprc': 0.9951651323260285, 'loss_val': 0.046753621337271054, 'psi': 0.9957405659312992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=34 head_norm_before_train=1.355718 cos_to_last_merge=0.9177 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.8988825321818553, 'auprc': 0.9634117555420465, 'loss_val': 0.23601304061753506, 'psi': 0.9246942215259318}-{'f1_val': 0.9960143947672967, 'auprc': 0.9966496660838644, 'loss_val': 0.06220967495854497, 'psi': 0.9962685032939238}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.519567 cos_to_last_merge=0.8686 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.869
[S16] round=34 local utility u=0.687968 metrics={'f1_val': 0.9913583318001885, 'auprc': 0.9959477578670086, 'loss_val': 0.05635392093958259, 'psi': 0.9931941022269165}-{'f1_val': 0.8606821209463782, 'auprc': 0.9927007140277266, 'loss_val': 0.6384921174985326, 'psi': 0.9134895581789175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=34 head_norm_before_train=1.628592 cos_to_last_merge=0.7614 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=34 local utility u=0.000000 metrics={'f1_val': 0.5745203629355897, 'auprc': 0.8503424683574812, 'loss_val': 1.0485286136859928, 'psi': 0.6848492051043462}-{'f1_val': 0.616313024777405, 'auprc': 0.8760567945788645, 'loss_val': 0.9402019701244536, 'psi': 0.7202105326979888}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=35 head_norm_before_train=1.845543 (no previous merge yet)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.668169824529951, 'auprc': 0.6898349554765583, 'loss_val': 1.206689398919998, 'psi': 0.6768358769085939}-{'f1_val': 0.7094132102394908, 'auprc': 0.7349385799848569, 'loss_val': 0.3775475135892112, 'psi': 0.7196233581376372}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=35 head_norm_before_train=2.034266 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9993510258728772, 'loss_val': 0.02680035364674108, 'psi': 0.9981966879210854}-{'f1_val': 0.9978100342676263, 'auprc': 0.9990941283956835, 'loss_val': 0.02634478913122814, 'psi': 0.9983236719188491}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.579942 cos_to_last_merge=0.8395 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=35 local utility u=0.014645 metrics={'f1_val': 0.9401486259384029, 'auprc': 0.9838625052805309, 'loss_val': 0.28805856186312345, 'psi': 0.9576341776752542}-{'f1_val': 0.9490501436948703, 'auprc': 0.9591862128800135, 'loss_val': 0.2967284090485231, 'psi': 0.9531045713689276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=35 head_norm_before_train=1.567157 cos_to_last_merge=0.8165 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.817
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.7144364317802219, 'auprc': 0.7937247604262054, 'loss_val': 0.5176863787750009, 'psi': 0.7461517632386152}-{'f1_val': 0.9964799208068884, 'auprc': 0.9969656001594716, 'loss_val': 0.12976994636791112, 'psi': 0.9966741925479217}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.832342 (no previous merge yet)
[S6] round=35 local utility u=0.201421 metrics={'f1_val': 0.8518850110305547, 'auprc': 0.9674882521068336, 'loss_val': 0.259541960822763, 'psi': 0.8981263074610663}-{'f1_val': 0.8223795166477608, 'auprc': 0.952819835722088, 'loss_val': 0.44134542725848136, 'psi': 0.8745556442774916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=35 head_norm_before_train=1.620611 (no previous merge yet)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.540641472315835, 'auprc': 0.7813299870388224, 'loss_val': 0.7968684489654491, 'psi': 0.63691687820503}-{'f1_val': 0.6922329565522514, 'auprc': 0.9044911020605108, 'loss_val': 0.2930623955191657, 'psi': 0.7771362147555552}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.422616 cos_to_last_merge=0.8646 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.865
[S8] round=35 local utility u=0.005025 metrics={'f1_val': 0.992609664509753, 'auprc': 0.9981445335021674, 'loss_val': 0.05063617104631545, 'psi': 0.9948236121067188}-{'f1_val': 0.9931569338135257, 'auprc': 0.9952914528011297, 'loss_val': 0.05541034976586881, 'psi': 0.9940107414085673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=35 head_norm_before_train=1.454107 cos_to_last_merge=0.9050 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.905
[S9] round=35 local utility u=0.006335 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9964638618470829, 'loss_val': 0.0369143786567256, 'psi': 0.9961979659251454}-{'f1_val': 0.9935215919844088, 'auprc': 0.9988221263257624, 'loss_val': 0.041665320389395175, 'psi': 0.9956418057209502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=35 head_norm_before_train=1.687039 cos_to_last_merge=0.9368 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=35 local utility u=0.029979 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9932379408206939, 'loss_val': 0.03943151568000617, 'psi': 0.9933548012208211}-{'f1_val': 0.9853371059373331, 'auprc': 0.9958740432567601, 'loss_val': 0.05872331908313974, 'psi': 0.989551880865104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=35 head_norm_before_train=1.631571 cos_to_last_merge=0.9326 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=35 local utility u=0.000841 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976671377685741, 'loss_val': 0.034878590104791746, 'psi': 0.9969950578155834}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976914980834076, 'loss_val': 0.03663438442435811, 'psi': 0.9970048019415167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=35 head_norm_before_train=1.759868 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5957125296817487, 'auprc': 0.7452666328616004, 'loss_val': 0.773599996680615, 'psi': 0.6555341709536894}-{'f1_val': 0.6036930932127644, 'auprc': 0.7227805636127979, 'loss_val': 0.6424641268211927, 'psi': 0.6513280813727778}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=1.445092 cos_to_last_merge=0.9351 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.935
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9969111843083606, 'loss_val': 0.04612622078739354, 'psi': 0.996571026787414}-{'f1_val': 0.9965872316107504, 'auprc': 0.9967809883296644, 'loss_val': 0.046295627847860135, 'psi': 0.9966647342983159}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.372172 cos_to_last_merge=0.9158 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=35 local utility u=0.000000 metrics={'f1_val': 0.8989122355697321, 'auprc': 0.9252666281667077, 'loss_val': 0.253888254915882, 'psi': 0.9094539926085223}-{'f1_val': 0.8988825321818553, 'auprc': 0.9634117555420465, 'loss_val': 0.23601304061753506, 'psi': 0.9246942215259318}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=35 head_norm_before_train=1.531471 cos_to_last_merge=0.8670 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.867
[S16] round=35 local utility u=0.004458 metrics={'f1_val': 0.9920356851944144, 'auprc': 0.9951218741961462, 'loss_val': 0.04902439309416604, 'psi': 0.9932701607951071}-{'f1_val': 0.9913583318001885, 'auprc': 0.9959477578670086, 'loss_val': 0.05635392093958259, 'psi': 0.9931941022269165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=35 head_norm_before_train=1.655290 cos_to_last_merge=0.7616 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.762
[S17] round=35 local utility u=0.013399 metrics={'f1_val': 0.5758263032827494, 'auprc': 0.8559901205576981, 'loss_val': 1.0465091716954484, 'psi': 0.6878918301927288}-{'f1_val': 0.5745203629355897, 'auprc': 0.8503424683574812, 'loss_val': 1.0485286136859928, 'psi': 0.6848492051043462}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=36 head_norm_before_train=1.858468 (no previous merge yet)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.5751766223730872, 'auprc': 0.7942292741528499, 'loss_val': 1.0124159476520296, 'psi': 0.6627976830849923}-{'f1_val': 0.668169824529951, 'auprc': 0.6898349554765583, 'loss_val': 1.206689398919998, 'psi': 0.6768358769085939}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.048111 (no previous merge yet)
[S3] round=36 local utility u=0.000000 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9993443149649994, 'loss_val': 0.027288948935446793, 'psi': 0.9981940035579343}-{'f1_val': 0.9974271292865575, 'auprc': 0.9993510258728772, 'loss_val': 0.02680035364674108, 'psi': 0.9981966879210854}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=36 head_norm_before_train=1.593943 cos_to_last_merge=0.8364 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.836
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9410213156777635, 'auprc': 0.9762937045048019, 'loss_val': 0.3113707611005173, 'psi': 0.9551302712085789}-{'f1_val': 0.9401486259384029, 'auprc': 0.9838625052805309, 'loss_val': 0.28805856186312345, 'psi': 0.9576341776752542}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.573015 cos_to_last_merge=0.8148 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.815
[S5] round=36 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9968274895933715, 'loss_val': 0.11234559706431897, 'psi': 0.9965305504306429}-{'f1_val': 0.7144364317802219, 'auprc': 0.7937247604262054, 'loss_val': 0.5176863787750009, 'psi': 0.7461517632386152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=36 head_norm_before_train=1.846971 (no previous merge yet)
[S6] round=36 local utility u=0.000000 metrics={'f1_val': 0.8231312863614778, 'auprc': 0.9634580816266718, 'loss_val': 0.418554746506606, 'psi': 0.8792620044675554}-{'f1_val': 0.8518850110305547, 'auprc': 0.9674882521068336, 'loss_val': 0.259541960822763, 'psi': 0.8981263074610663}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=36 head_norm_before_train=1.624782 (no previous merge yet)
[S7] round=36 local utility u=0.024231 metrics={'f1_val': 0.5443708869860975, 'auprc': 0.7809772913091307, 'loss_val': 0.7697251252010058, 'psi': 0.6390134487153107}-{'f1_val': 0.540641472315835, 'auprc': 0.7813299870388224, 'loss_val': 0.7968684489654491, 'psi': 0.63691687820503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=36 head_norm_before_train=1.439521 cos_to_last_merge=0.8631 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.863
[S8] round=36 local utility u=0.001090 metrics={'f1_val': 0.9927976282173978, 'auprc': 0.9979474014720104, 'loss_val': 0.04899193182524831, 'psi': 0.9948575375192429}-{'f1_val': 0.992609664509753, 'auprc': 0.9981445335021674, 'loss_val': 0.05063617104631545, 'psi': 0.9948236121067188}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=36 head_norm_before_train=1.469625 cos_to_last_merge=0.9029 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.903
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9884538934865174, 'auprc': 0.9987265338851248, 'loss_val': 0.051884728691561695, 'psi': 0.9925629496459603}-{'f1_val': 0.9960207019771873, 'auprc': 0.9964638618470829, 'loss_val': 0.0369143786567256, 'psi': 0.9961979659251454}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.699188 cos_to_last_merge=0.9354 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=36 local utility u=0.005874 metrics={'f1_val': 0.9945291067983943, 'auprc': 0.9947516766358954, 'loss_val': 0.0388038911611481, 'psi': 0.9946181347333948}-{'f1_val': 0.9934327081542391, 'auprc': 0.9932379408206939, 'loss_val': 0.03943151568000617, 'psi': 0.9933548012208211}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=36 head_norm_before_train=1.651264 cos_to_last_merge=0.9302 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9975315261085931, 'loss_val': 0.03455234883971617, 'psi': 0.9966928153914228}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976671377685741, 'loss_val': 0.034878590104791746, 'psi': 0.9969950578155834}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.770552 (no previous merge yet)
[S13] round=36 local utility u=0.154248 metrics={'f1_val': 0.6339100946203224, 'auprc': 0.7396132741471212, 'loss_val': 0.6773293136199717, 'psi': 0.6761913664310419}-{'f1_val': 0.5957125296817487, 'auprc': 0.7452666328616004, 'loss_val': 0.773599996680615, 'psi': 0.6555341709536894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=36 head_norm_before_train=1.455312 cos_to_last_merge=0.9342 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=36 local utility u=0.001002 metrics={'f1_val': 0.9963671647723179, 'auprc': 0.995577773849793, 'loss_val': 0.040259248195693265, 'psi': 0.9960514084033079}-{'f1_val': 0.9963442551067831, 'auprc': 0.9969111843083606, 'loss_val': 0.04612622078739354, 'psi': 0.996571026787414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=36 head_norm_before_train=1.389756 cos_to_last_merge=0.9139 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=36 local utility u=0.169917 metrics={'f1_val': 0.9047826866443809, 'auprc': 0.9936730157998886, 'loss_val': 0.1544966538743492, 'psi': 0.940338818306584}-{'f1_val': 0.8989122355697321, 'auprc': 0.9252666281667077, 'loss_val': 0.253888254915882, 'psi': 0.9094539926085223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=36 head_norm_before_train=1.544437 cos_to_last_merge=0.8652 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.9920356851944144, 'auprc': 0.9945583788368625, 'loss_val': 0.048968945655549094, 'psi': 0.9930447626513936}-{'f1_val': 0.9920356851944144, 'auprc': 0.9951218741961462, 'loss_val': 0.04902439309416604, 'psi': 0.9932701607951071}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.675195 cos_to_last_merge=0.7604 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=36 local utility u=0.296636 metrics={'f1_val': 0.6508198420737363, 'auprc': 0.8584457361954484, 'loss_val': 0.9105652209357038, 'psi': 0.7338701997224211}-{'f1_val': 0.5758263032827494, 'auprc': 0.8559901205576981, 'loss_val': 1.0465091716954484, 'psi': 0.6878918301927288}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=37 head_norm_before_train=1.870947 (no previous merge yet)
[S2] round=37 local utility u=0.281171 metrics={'f1_val': 0.667114507793077, 'auprc': 0.6644575244146312, 'loss_val': 0.6123856311679609, 'psi': 0.6660517144416986}-{'f1_val': 0.5751766223730872, 'auprc': 0.7942292741528499, 'loss_val': 1.0124159476520296, 'psi': 0.6627976830849923}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=37 head_norm_before_train=2.060934 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9599010897287521, 'auprc': 0.9995423272424675, 'loss_val': 0.17183469893047054, 'psi': 0.9757575847342382}-{'f1_val': 0.9974271292865575, 'auprc': 0.9993443149649994, 'loss_val': 0.027288948935446793, 'psi': 0.9981940035579343}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.604697 cos_to_last_merge=0.8342 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.834
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.9463463513491722, 'auprc': 0.9636048935173368, 'loss_val': 0.3117267838127455, 'psi': 0.953249768216438}-{'f1_val': 0.9410213156777635, 'auprc': 0.9762937045048019, 'loss_val': 0.3113707611005173, 'psi': 0.9551302712085789}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.577954 cos_to_last_merge=0.8136 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.814
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.7143712450552575, 'auprc': 0.7934493506762977, 'loss_val': 0.5287869555495338, 'psi': 0.7460024873036737}-{'f1_val': 0.9963325909888239, 'auprc': 0.9968274895933715, 'loss_val': 0.11234559706431897, 'psi': 0.9965305504306429}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.866980 (no previous merge yet)
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7511441673600113, 'auprc': 0.9409812806849684, 'loss_val': 0.7254094928957002, 'psi': 0.8270790126899942}-{'f1_val': 0.8231312863614778, 'auprc': 0.9634580816266718, 'loss_val': 0.418554746506606, 'psi': 0.8792620044675554}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.636291 (no previous merge yet)
[S7] round=37 local utility u=0.327030 metrics={'f1_val': 0.6122798218050217, 'auprc': 0.7943490561367189, 'loss_val': 0.5632343604850524, 'psi': 0.6851075155377007}-{'f1_val': 0.5443708869860975, 'auprc': 0.7809772913091307, 'loss_val': 0.7697251252010058, 'psi': 0.6390134487153107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=37 head_norm_before_train=1.454557 cos_to_last_merge=0.8619 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.862
[S8] round=37 local utility u=0.002265 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9980402675554233, 'loss_val': 0.0459653015212175, 'psi': 0.9950171817138418}-{'f1_val': 0.9927976282173978, 'auprc': 0.9979474014720104, 'loss_val': 0.04899193182524831, 'psi': 0.9948575375192429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=37 head_norm_before_train=1.483117 cos_to_last_merge=0.9013 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.901
[S9] round=37 local utility u=0.027350 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936631912473183, 'loss_val': 0.03388978743824016, 'psi': 0.995727024006213}-{'f1_val': 0.9884538934865174, 'auprc': 0.9987265338851248, 'loss_val': 0.051884728691561695, 'psi': 0.9925629496459603}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=37 head_norm_before_train=1.712149 cos_to_last_merge=0.9336 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9927973295932149, 'loss_val': 0.03907495790986143, 'psi': 0.9942316352489108}-{'f1_val': 0.9945291067983943, 'auprc': 0.9947516766358954, 'loss_val': 0.0388038911611481, 'psi': 0.9946181347333948}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=1.668910 cos_to_last_merge=0.9280 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=37 local utility u=0.001229 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9976703692390904, 'loss_val': 0.03251163527444799, 'psi': 0.9967483526436217}-{'f1_val': 0.9961336749133093, 'auprc': 0.9975315261085931, 'loss_val': 0.03455234883971617, 'psi': 0.9966928153914228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=37 head_norm_before_train=1.781258 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.5811438427570293, 'auprc': 0.7711223802944455, 'loss_val': 0.8651356937860847, 'psi': 0.6571352577719958}-{'f1_val': 0.6339100946203224, 'auprc': 0.7396132741471212, 'loss_val': 0.6773293136199717, 'psi': 0.6761913664310419}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=1.466681 cos_to_last_merge=0.9333 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.933
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9953333535280537, 'auprc': 0.9951352289114318, 'loss_val': 0.052219416410599274, 'psi': 0.995254103681405}-{'f1_val': 0.9963671647723179, 'auprc': 0.995577773849793, 'loss_val': 0.040259248195693265, 'psi': 0.9960514084033079}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=1.408729 cos_to_last_merge=0.9119 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.912
[S15] round=37 local utility u=0.108470 metrics={'f1_val': 0.932677406855414, 'auprc': 0.9927451087773547, 'loss_val': 0.10214202948878467, 'psi': 0.9567044876241902}-{'f1_val': 0.9047826866443809, 'auprc': 0.9936730157998886, 'loss_val': 0.1544966538743492, 'psi': 0.940338818306584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=37 head_norm_before_train=1.559145 cos_to_last_merge=0.8633 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.863
[S16] round=37 local utility u=0.005484 metrics={'f1_val': 0.9920356851944144, 'auprc': 0.9971437516726558, 'loss_val': 0.0457574013107846, 'psi': 0.994078911785711}-{'f1_val': 0.9920356851944144, 'auprc': 0.9945583788368625, 'loss_val': 0.048968945655549094, 'psi': 0.9930447626513936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=37 head_norm_before_train=1.693927 cos_to_last_merge=0.7588 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.5721197719977154, 'auprc': 0.8752592001785219, 'loss_val': 1.0727629453013907, 'psi': 0.6933755432700379}-{'f1_val': 0.6508198420737363, 'auprc': 0.8584457361954484, 'loss_val': 0.9105652209357038, 'psi': 0.7338701997224211}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=38 head_norm_before_train=1.882729 (no previous merge yet)
[S2] round=38 local utility u=0.468068 metrics={'f1_val': 0.7148410329568842, 'auprc': 0.8187596893494485, 'loss_val': 0.42551557505210985, 'psi': 0.7564084955139099}-{'f1_val': 0.667114507793077, 'auprc': 0.6644575244146312, 'loss_val': 0.6123856311679609, 'psi': 0.6660517144416986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=38 head_norm_before_train=2.071336 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9505331087975875, 'auprc': 0.9987806590367712, 'loss_val': 0.12246381317213324, 'psi': 0.969832128893261}-{'f1_val': 0.9599010897287521, 'auprc': 0.9995423272424675, 'loss_val': 0.17183469893047054, 'psi': 0.9757575847342382}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.615168 cos_to_last_merge=0.8323 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.832
[S4] round=38 local utility u=0.000000 metrics={'f1_val': 0.9416650589271589, 'auprc': 0.9705886007295649, 'loss_val': 0.3217258984326341, 'psi': 0.9532344756481214}-{'f1_val': 0.9463463513491722, 'auprc': 0.9636048935173368, 'loss_val': 0.3117267838127455, 'psi': 0.953249768216438}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=38 head_norm_before_train=1.581818 cos_to_last_merge=0.8126 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=38 local utility u=1.000000 metrics={'f1_val': 0.9844795176506735, 'auprc': 0.9912733661562485, 'loss_val': 0.13265914310972743, 'psi': 0.9871970570529036}-{'f1_val': 0.7143712450552575, 'auprc': 0.7934493506762977, 'loss_val': 0.5287869555495338, 'psi': 0.7460024873036737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=38 head_norm_before_train=1.880666 (no previous merge yet)
[S6] round=38 local utility u=0.201063 metrics={'f1_val': 0.8013982414656036, 'auprc': 0.9550110366108339, 'loss_val': 0.6668967142552524, 'psi': 0.8628433595236957}-{'f1_val': 0.7511441673600113, 'auprc': 0.9409812806849684, 'loss_val': 0.7254094928957002, 'psi': 0.8270790126899942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=38 head_norm_before_train=1.649057 (no previous merge yet)
[S7] round=38 local utility u=0.000000 metrics={'f1_val': 0.6062987782937803, 'auprc': 0.7924664854315278, 'loss_val': 0.623901017432826, 'psi': 0.6807658611488793}-{'f1_val': 0.6122798218050217, 'auprc': 0.7943490561367189, 'loss_val': 0.5632343604850524, 'psi': 0.6851075155377007}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=38 head_norm_before_train=1.468509 cos_to_last_merge=0.8607 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.861
[S8] round=38 local utility u=0.000000 metrics={'f1_val': 0.9927976282173978, 'auprc': 0.9978983816901703, 'loss_val': 0.047724617825317624, 'psi': 0.9948379296065069}-{'f1_val': 0.9930017911527874, 'auprc': 0.9980402675554233, 'loss_val': 0.0459653015212175, 'psi': 0.9950171817138418}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=38 head_norm_before_train=1.495306 cos_to_last_merge=0.8998 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.900
[S9] round=38 local utility u=0.005135 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9967657239922165, 'loss_val': 0.031425912962225654, 'psi': 0.996817840852241}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936631912473183, 'loss_val': 0.03388978743824016, 'psi': 0.995727024006213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=38 head_norm_before_train=1.725284 cos_to_last_merge=0.9320 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=38 local utility u=0.001043 metrics={'f1_val': 0.9943272539091932, 'auprc': 0.993828186858697, 'loss_val': 0.0349186589060299, 'psi': 0.9941276270889947}-{'f1_val': 0.9951878390193748, 'auprc': 0.9927973295932149, 'loss_val': 0.03907495790986143, 'psi': 0.9942316352489108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=38 head_norm_before_train=1.685895 cos_to_last_merge=0.9260 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9977863995973456, 'loss_val': 0.0317103080698939, 'psi': 0.9966496625600867}-{'f1_val': 0.9961336749133093, 'auprc': 0.9976703692390904, 'loss_val': 0.03251163527444799, 'psi': 0.9967483526436217}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.793319 (no previous merge yet)
[S13] round=38 local utility u=0.194146 metrics={'f1_val': 0.6422383510402845, 'auprc': 0.7332162890842628, 'loss_val': 0.7296926082117611, 'psi': 0.6786295262578759}-{'f1_val': 0.5811438427570293, 'auprc': 0.7711223802944455, 'loss_val': 0.8651356937860847, 'psi': 0.6571352577719958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=38 head_norm_before_train=1.477568 cos_to_last_merge=0.9323 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.932
[S14] round=38 local utility u=0.011883 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9951307123360777, 'loss_val': 0.040889798461208916, 'psi': 0.9964972466354665}-{'f1_val': 0.9953333535280537, 'auprc': 0.9951352289114318, 'loss_val': 0.052219416410599274, 'psi': 0.995254103681405}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=38 head_norm_before_train=1.427522 cos_to_last_merge=0.9097 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.910
[S15] round=38 local utility u=0.101732 metrics={'f1_val': 0.9673408819556311, 'auprc': 0.997879551593996, 'loss_val': 0.12206219239969424, 'psi': 0.979556349810977}-{'f1_val': 0.932677406855414, 'auprc': 0.9927451087773547, 'loss_val': 0.10214202948878467, 'psi': 0.9567044876241902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=38 head_norm_before_train=1.574930 cos_to_last_merge=0.8613 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.861
[S16] round=38 local utility u=0.000691 metrics={'f1_val': 0.991816385127412, 'auprc': 0.9976285748522883, 'loss_val': 0.044514697954336255, 'psi': 0.9941412610173626}-{'f1_val': 0.9920356851944144, 'auprc': 0.9971437516726558, 'loss_val': 0.0457574013107846, 'psi': 0.994078911785711}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=38 head_norm_before_train=1.712511 cos_to_last_merge=0.7586 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=38 local utility u=0.103312 metrics={'f1_val': 0.6177861487160092, 'auprc': 0.837992276435336, 'loss_val': 1.0283364008968054, 'psi': 0.70586859980374}-{'f1_val': 0.5721197719977154, 'auprc': 0.8752592001785219, 'loss_val': 1.0727629453013907, 'psi': 0.6933755432700379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=39 head_norm_before_train=1.893688 (no previous merge yet)
[S2] round=39 local utility u=0.026060 metrics={'f1_val': 0.7096599747858277, 'auprc': 0.8640768473744769, 'loss_val': 0.4782607549732048, 'psi': 0.7714267238212873}-{'f1_val': 0.7148410329568842, 'auprc': 0.8187596893494485, 'loss_val': 0.42551557505210985, 'psi': 0.7564084955139099}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S2] r=40 psi=0.771 u=0.0261 p_local=0.1824 f1=0.710 auprc=0.864 bytes=46765
[S3] START round=39 head_norm_before_train=2.080474 (no previous merge yet)
[S3] round=39 local utility u=0.152175 metrics={'f1_val': 0.9905793551420383, 'auprc': 0.9991640848789769, 'loss_val': 0.05954203655059158, 'psi': 0.9940132470368137}-{'f1_val': 0.9505331087975875, 'auprc': 0.9987806590367712, 'loss_val': 0.12246381317213324, 'psi': 0.969832128893261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S3] r=40 psi=0.994 u=0.1522 p_local=0.0517 f1=0.991 auprc=0.999 bytes=46812
[S4] START round=39 head_norm_before_train=1.626110 cos_to_last_merge=0.8299 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.830
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9457886172870583, 'auprc': 0.9586509800925278, 'loss_val': 0.3142303684557006, 'psi': 0.9509335624092461}-{'f1_val': 0.9416650589271589, 'auprc': 0.9705886007295649, 'loss_val': 0.3217258984326341, 'psi': 0.9532344756481214}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.951 u=0.0000 p_local=0.0151 f1=0.946 auprc=0.959 bytes=39535
[S5] START round=39 head_norm_before_train=1.586734 cos_to_last_merge=0.8116 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.812
[S5] round=39 local utility u=0.051209 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9936149732232485, 'loss_val': 0.10838475219930273, 'psi': 0.9952455438825937}-{'f1_val': 0.9844795176506735, 'auprc': 0.9912733661562485, 'loss_val': 0.13265914310972743, 'psi': 0.9871970570529036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S5] r=40 psi=0.995 u=0.0512 p_local=0.3530 f1=0.996 auprc=0.994 bytes=46704
[S6] START round=39 head_norm_before_train=1.890252 (no previous merge yet)
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.748367516732136, 'auprc': 0.9426473986142636, 'loss_val': 0.6554736352851878, 'psi': 0.826079469484987}-{'f1_val': 0.8013982414656036, 'auprc': 0.9550110366108339, 'loss_val': 0.6668967142552524, 'psi': 0.8628433595236957}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.826 u=0.0000 p_local=0.1517 f1=0.748 auprc=0.943 bytes=41343
[S7] START round=39 head_norm_before_train=1.660182 (no previous merge yet)
[S7] round=39 local utility u=0.000000 metrics={'f1_val': 0.5635279941520643, 'auprc': 0.7840885720087317, 'loss_val': 0.801748259469308, 'psi': 0.6517522252947313}-{'f1_val': 0.6062987782937803, 'auprc': 0.7924664854315278, 'loss_val': 0.623901017432826, 'psi': 0.6807658611488793}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=40 psi=0.652 u=0.0000 p_local=0.2033 f1=0.564 auprc=0.784 bytes=43141
[S8] START round=39 head_norm_before_train=1.482785 cos_to_last_merge=0.8592 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.859
[S8] round=39 local utility u=0.000000 metrics={'f1_val': 0.9881372834100528, 'auprc': 0.9987042034174405, 'loss_val': 0.050210727826371086, 'psi': 0.9923640514130079}-{'f1_val': 0.9927976282173978, 'auprc': 0.9978983816901703, 'loss_val': 0.047724617825317624, 'psi': 0.9948379296065069}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=40 psi=0.992 u=0.0000 p_local=0.0270 f1=0.988 auprc=0.999 bytes=44918
[S9] START round=39 head_norm_before_train=1.508243 cos_to_last_merge=0.8983 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.898
[S9] round=39 local utility u=0.002923 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9984415280441081, 'loss_val': 0.0306079814516059, 'psi': 0.9974881624729977}-{'f1_val': 0.9968525854255906, 'auprc': 0.9967657239922165, 'loss_val': 0.031425912962225654, 'psi': 0.996817840852241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S9] r=40 psi=0.997 u=0.0029 p_local=0.0123 f1=0.997 auprc=0.998 bytes=46688
[S10] START round=39 head_norm_before_train=1.738242 cos_to_last_merge=0.9304 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9934327081542391, 'auprc': 0.9945466715575813, 'loss_val': 0.03577373143008313, 'psi': 0.993878293515576}-{'f1_val': 0.9943272539091932, 'auprc': 0.993828186858697, 'loss_val': 0.0349186589060299, 'psi': 0.9941276270889947}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.994 u=0.0000 p_local=0.0053 f1=0.993 auprc=0.995 bytes=52115
[S11] START round=39 head_norm_before_train=1.702815 cos_to_last_merge=0.9241 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=39 local utility u=0.002705 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977004490377402, 'loss_val': 0.029973820190476626, 'psi': 0.9970083823232498}-{'f1_val': 0.9958918378685807, 'auprc': 0.9977863995973456, 'loss_val': 0.0317103080698939, 'psi': 0.9966496625600867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S11] r=40 psi=0.997 u=0.0027 p_local=0.0062 f1=0.997 auprc=0.998 bytes=50322
[S13] START round=39 head_norm_before_train=1.805479 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6395973817304632, 'auprc': 0.7296208324774252, 'loss_val': 0.8113691275085807, 'psi': 0.675606762029248}-{'f1_val': 0.6422383510402845, 'auprc': 0.7332162890842628, 'loss_val': 0.7296926082117611, 'psi': 0.6786295262578759}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.676 u=0.0000 p_local=0.0639 f1=0.640 auprc=0.730 bytes=41444
[S14] START round=39 head_norm_before_train=1.490128 cos_to_last_merge=0.9311 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.931
[S14] round=39 local utility u=0.004356 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986171317043917, 'loss_val': 0.03771181306387663, 'psi': 0.9973991916482069}-{'f1_val': 0.9974082695017256, 'auprc': 0.9951307123360777, 'loss_val': 0.040889798461208916, 'psi': 0.9964972466354665}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=40 psi=0.997 u=0.0044 p_local=0.0056 f1=0.997 auprc=0.999 bytes=57437
[S15] START round=39 head_norm_before_train=1.443982 cos_to_last_merge=0.9080 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.908
[S15] round=39 local utility u=0.000000 metrics={'f1_val': 0.7659571497777491, 'auprc': 0.9121954420472862, 'loss_val': 0.40180733234174926, 'psi': 0.8244524666855639}-{'f1_val': 0.9673408819556311, 'auprc': 0.997879551593996, 'loss_val': 0.12206219239969424, 'psi': 0.979556349810977}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=40 psi=0.824 u=0.0000 p_local=0.1231 f1=0.766 auprc=0.912 bytes=44908
[S16] START round=39 head_norm_before_train=1.588145 cos_to_last_merge=0.8594 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.859
[S16] round=39 local utility u=0.000000 metrics={'f1_val': 0.9922353369773327, 'auprc': 0.9959689219134623, 'loss_val': 0.04371173448976209, 'psi': 0.9937287709517846}-{'f1_val': 0.991816385127412, 'auprc': 0.9976285748522883, 'loss_val': 0.044514697954336255, 'psi': 0.9941412610173626}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=40 psi=0.994 u=0.0000 p_local=0.0975 f1=0.992 auprc=0.996 bytes=44892
[S17] START round=39 head_norm_before_train=1.730412 cos_to_last_merge=0.7585 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.5979943918864039, 'auprc': 0.8448696110431455, 'loss_val': 1.030205172682587, 'psi': 0.6967444795491006}-{'f1_val': 0.6177861487160092, 'auprc': 0.837992276435336, 'loss_val': 1.0283364008968054, 'psi': 0.70586859980374}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=40 psi=0.697 u=0.0000 p_local=0.0923 f1=0.598 auprc=0.845 bytes=30602
[S2] START round=40 head_norm_before_train=1.910468 (no previous merge yet)
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.7310044239177238, 'auprc': 0.7665567570398788, 'loss_val': 0.6890789884184052, 'psi': 0.7452253571665859}-{'f1_val': 0.7096599747858277, 'auprc': 0.8640768473744769, 'loss_val': 0.4782607549732048, 'psi': 0.7714267238212873}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.091168 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.9880233336605706, 'auprc': 0.9992871023289102, 'loss_val': 0.053568708619129074, 'psi': 0.9925288411279064}-{'f1_val': 0.9905793551420383, 'auprc': 0.9991640848789769, 'loss_val': 0.05954203655059158, 'psi': 0.9940132470368137}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.637204 cos_to_last_merge=0.8275 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.827
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9490303661288668, 'auprc': 0.9454345024991513, 'loss_val': 0.3130799236091746, 'psi': 0.9475920206769806}-{'f1_val': 0.9457886172870583, 'auprc': 0.9586509800925278, 'loss_val': 0.3142303684557006, 'psi': 0.9509335624092461}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.592277 cos_to_last_merge=0.8104 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.810
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.7144364317802219, 'auprc': 0.7956376121928518, 'loss_val': 0.4915074861511812, 'psi': 0.7469169039452739}-{'f1_val': 0.9963325909888239, 'auprc': 0.9936149732232485, 'loss_val': 0.10838475219930273, 'psi': 0.9952455438825937}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.901541 (no previous merge yet)
[S6] round=40 local utility u=0.529850 metrics={'f1_val': 0.8673739448725748, 'auprc': 0.9614649405196696, 'loss_val': 0.36626478408948143, 'psi': 0.9050103431314127}-{'f1_val': 0.748367516732136, 'auprc': 0.9426473986142636, 'loss_val': 0.6554736352851878, 'psi': 0.826079469484987}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=40 head_norm_before_train=1.667772 (no previous merge yet)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5328426896300634, 'auprc': 0.7820015844501947, 'loss_val': 0.8681474659044284, 'psi': 0.632506247558116}-{'f1_val': 0.5635279941520643, 'auprc': 0.7840885720087317, 'loss_val': 0.801748259469308, 'psi': 0.6517522252947313}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.496874 cos_to_last_merge=0.8569 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.857
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.8853170754443603, 'auprc': 0.9850091255999398, 'loss_val': 0.13801426961817398, 'psi': 0.9251938955065921}-{'f1_val': 0.9881372834100528, 'auprc': 0.9987042034174405, 'loss_val': 0.050210727826371086, 'psi': 0.9923640514130079}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=1.519534 cos_to_last_merge=0.8970 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.897
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9965500264676299, 'loss_val': 0.029393264012103692, 'psi': 0.9967315618424063}-{'f1_val': 0.9968525854255906, 'auprc': 0.9984415280441081, 'loss_val': 0.0306079814516059, 'psi': 0.9974881624729977}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.749896 cos_to_last_merge=0.9285 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=40 local utility u=0.000000 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9950222764514541, 'loss_val': 0.03763589866914832, 'psi': 0.9938057084053191}-{'f1_val': 0.9934327081542391, 'auprc': 0.9945466715575813, 'loss_val': 0.03577373143008313, 'psi': 0.993878293515576}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=40 head_norm_before_train=1.718191 cos_to_last_merge=0.9225 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.922
[S11] round=40 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9977204058603695, 'loss_val': 0.031078730801604813, 'psi': 0.9966232650652962}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977004490377402, 'loss_val': 0.029973820190476626, 'psi': 0.9970083823232498}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=40 head_norm_before_train=1.811235 (no previous merge yet)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.5825995730456948, 'auprc': 0.7790645112101422, 'loss_val': 0.7874159290961251, 'psi': 0.6611855483114737}-{'f1_val': 0.6395973817304632, 'auprc': 0.7296208324774252, 'loss_val': 0.8113691275085807, 'psi': 0.675606762029248}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=40 head_norm_before_train=1.502437 cos_to_last_merge=0.9300 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.930
[S14] round=40 local utility u=0.001374 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9985859856921262, 'loss_val': 0.034871063188747234, 'psi': 0.9973867332433006}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986171317043917, 'loss_val': 0.03771181306387663, 'psi': 0.9973991916482069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=40 head_norm_before_train=1.458867 cos_to_last_merge=0.9062 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.906
[S15] round=40 local utility u=0.987828 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9907810418011197, 'loss_val': 0.044064533911341075, 'psi': 0.9941022794930006}-{'f1_val': 0.7659571497777491, 'auprc': 0.9121954420472862, 'loss_val': 0.40180733234174926, 'psi': 0.8244524666855639}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=40 head_norm_before_train=1.600292 cos_to_last_merge=0.8577 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.858
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.9801607748641359, 'auprc': 0.9906486129793699, 'loss_val': 0.07729048115465909, 'psi': 0.9843559101102295}-{'f1_val': 0.9922353369773327, 'auprc': 0.9959689219134623, 'loss_val': 0.04371173448976209, 'psi': 0.9937287709517846}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.747759 cos_to_last_merge=0.7594 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.5984284754917878, 'auprc': 0.8398807552148813, 'loss_val': 1.0402769306046433, 'psi': 0.6950093873810252}-{'f1_val': 0.5979943918864039, 'auprc': 0.8448696110431455, 'loss_val': 1.030205172682587, 'psi': 0.6967444795491006}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.928210 (no previous merge yet)
[S2] round=41 local utility u=0.000000 metrics={'f1_val': 0.6599511447221, 'auprc': 0.7718170999542467, 'loss_val': 1.0597878651057153, 'psi': 0.7046975268149587}-{'f1_val': 0.7310044239177238, 'auprc': 0.7665567570398788, 'loss_val': 0.6890789884184052, 'psi': 0.7452253571665859}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=41 head_norm_before_train=2.101673 (no previous merge yet)
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9542342208330266, 'auprc': 0.9991332530426896, 'loss_val': 0.15865967089592467, 'psi': 0.9721938337168918}-{'f1_val': 0.9880233336605706, 'auprc': 0.9992871023289102, 'loss_val': 0.053568708619129074, 'psi': 0.9925288411279064}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.650097 cos_to_last_merge=0.8248 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=41 local utility u=0.021705 metrics={'f1_val': 0.9483358231927209, 'auprc': 0.9600125029626195, 'loss_val': 0.3092373745618572, 'psi': 0.9530064951006803}-{'f1_val': 0.9490303661288668, 'auprc': 0.9454345024991513, 'loss_val': 0.3130799236091746, 'psi': 0.9475920206769806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=41 head_norm_before_train=1.596342 cos_to_last_merge=0.8093 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=41 local utility u=0.400231 metrics={'f1_val': 0.7189810747236044, 'auprc': 0.9902203997565135, 'loss_val': 0.302062350990803, 'psi': 0.827476804736768}-{'f1_val': 0.7144364317802219, 'auprc': 0.7956376121928518, 'loss_val': 0.4915074861511812, 'psi': 0.7469169039452739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=41 head_norm_before_train=1.913680 (no previous merge yet)
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.609079721230477, 'auprc': 0.9381342291860338, 'loss_val': 0.8171260715688327, 'psi': 0.7407015244126998}-{'f1_val': 0.8673739448725748, 'auprc': 0.9614649405196696, 'loss_val': 0.36626478408948143, 'psi': 0.9050103431314127}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.677294 (no previous merge yet)
[S7] round=41 local utility u=0.230803 metrics={'f1_val': 0.5821493210207024, 'auprc': 0.7873312576083185, 'loss_val': 0.7183696909743702, 'psi': 0.6642220956557489}-{'f1_val': 0.5328426896300634, 'auprc': 0.7820015844501947, 'loss_val': 0.8681474659044284, 'psi': 0.632506247558116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=41 head_norm_before_train=1.509366 cos_to_last_merge=0.8553 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.855
[S8] round=41 local utility u=0.356232 metrics={'f1_val': 0.9839737891748364, 'auprc': 0.9987658585170969, 'loss_val': 0.05875983048197232, 'psi': 0.9898906169117405}-{'f1_val': 0.8853170754443603, 'auprc': 0.9850091255999398, 'loss_val': 0.13801426961817398, 'psi': 0.9251938955065921}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=41 head_norm_before_train=1.531720 cos_to_last_merge=0.8955 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.895
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9949583222499775, 'loss_val': 0.028391686763917373, 'psi': 0.9962450764072767}-{'f1_val': 0.9968525854255906, 'auprc': 0.9965500264676299, 'loss_val': 0.029393264012103692, 'psi': 0.9967315618424063}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.758041 cos_to_last_merge=0.9269 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=41 local utility u=0.000000 metrics={'f1_val': 0.9927757495752743, 'auprc': 0.9953138458221011, 'loss_val': 0.039672286727165315, 'psi': 0.993790988074005}-{'f1_val': 0.992994663041229, 'auprc': 0.9950222764514541, 'loss_val': 0.03763589866914832, 'psi': 0.9938057084053191}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=41 head_norm_before_train=1.729874 cos_to_last_merge=0.9212 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.921
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9958477977727174, 'loss_val': 0.12053633059365734, 'psi': 0.9960316039555341}-{'f1_val': 0.9958918378685807, 'auprc': 0.9977204058603695, 'loss_val': 0.031078730801604813, 'psi': 0.9966232650652962}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.812420 (no previous merge yet)
[S13] round=41 local utility u=0.282727 metrics={'f1_val': 0.6559585915468578, 'auprc': 0.7765907615740201, 'loss_val': 0.6546947980867504, 'psi': 0.7042114595577227}-{'f1_val': 0.5825995730456948, 'auprc': 0.7790645112101422, 'loss_val': 0.7874159290961251, 'psi': 0.6611855483114737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=41 head_norm_before_train=1.516183 cos_to_last_merge=0.9287 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.929
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9969925245166984, 'loss_val': 0.034042143863756175, 'psi': 0.9966035628707492}-{'f1_val': 0.9965872316107504, 'auprc': 0.9985859856921262, 'loss_val': 0.034871063188747234, 'psi': 0.9973867332433006}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=1.471792 cos_to_last_merge=0.9048 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=41 local utility u=0.012431 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9969570119724196, 'loss_val': 0.0403120026265251, 'psi': 0.9968308058214802}-{'f1_val': 0.9963164379542544, 'auprc': 0.9907810418011197, 'loss_val': 0.044064533911341075, 'psi': 0.9941022794930006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=41 head_norm_before_train=1.612722 cos_to_last_merge=0.8561 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=41 local utility u=0.061818 metrics={'f1_val': 0.9922353369773327, 'auprc': 0.9962422087732412, 'loss_val': 0.042882750079854114, 'psi': 0.9938380856956961}-{'f1_val': 0.9801607748641359, 'auprc': 0.9906486129793699, 'loss_val': 0.07729048115465909, 'psi': 0.9843559101102295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=41 head_norm_before_train=1.767056 cos_to_last_merge=0.7600 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=41 local utility u=0.060181 metrics={'f1_val': 0.6010869385975511, 'auprc': 0.8768220628841775, 'loss_val': 1.046690243156232, 'psi': 0.7113809883122018}-{'f1_val': 0.5984284754917878, 'auprc': 0.8398807552148813, 'loss_val': 1.0402769306046433, 'psi': 0.6950093873810252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=42 head_norm_before_train=1.941726 (no previous merge yet)
[S2] round=42 local utility u=0.541202 metrics={'f1_val': 0.7123695428364747, 'auprc': 0.8435032329270934, 'loss_val': 0.5069519965119994, 'psi': 0.7648230188727222}-{'f1_val': 0.6599511447221, 'auprc': 0.7718170999542467, 'loss_val': 1.0597878651057153, 'psi': 0.7046975268149587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=42 head_norm_before_train=2.111815 (no previous merge yet)
[S3] round=42 local utility u=0.027029 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9993349742478423, 'loss_val': 0.1430652343729153, 'psi': 0.9760603134386052}-{'f1_val': 0.9542342208330266, 'auprc': 0.9991332530426896, 'loss_val': 0.15865967089592467, 'psi': 0.9721938337168918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=42 head_norm_before_train=1.660677 cos_to_last_merge=0.8229 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.823
[S4] round=42 local utility u=0.000000 metrics={'f1_val': 0.9412671858750774, 'auprc': 0.9718663109512454, 'loss_val': 0.32361554620335947, 'psi': 0.9535068359055446}-{'f1_val': 0.9483358231927209, 'auprc': 0.9600125029626195, 'loss_val': 0.3092373745618572, 'psi': 0.9530064951006803}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=42 head_norm_before_train=1.600129 cos_to_last_merge=0.8085 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=42 local utility u=0.388224 metrics={'f1_val': 0.8255192096671429, 'auprc': 0.9911754467613272, 'loss_val': 0.16770836047734855, 'psi': 0.8917817045048166}-{'f1_val': 0.7189810747236044, 'auprc': 0.9902203997565135, 'loss_val': 0.302062350990803, 'psi': 0.827476804736768}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=42 head_norm_before_train=1.928707 (no previous merge yet)
[S6] round=42 local utility u=0.773430 metrics={'f1_val': 0.810788005903266, 'auprc': 0.9550508598598954, 'loss_val': 0.5312660703187028, 'psi': 0.8684931474859178}-{'f1_val': 0.609079721230477, 'auprc': 0.9381342291860338, 'loss_val': 0.8171260715688327, 'psi': 0.7407015244126998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=42 head_norm_before_train=1.688015 (no previous merge yet)
[S7] round=42 local utility u=0.093099 metrics={'f1_val': 0.6036631121919438, 'auprc': 0.7920329293061018, 'loss_val': 0.6753595503325016, 'psi': 0.679011039037607}-{'f1_val': 0.5821493210207024, 'auprc': 0.7873312576083185, 'loss_val': 0.7183696909743702, 'psi': 0.6642220956557489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=42 head_norm_before_train=1.520257 cos_to_last_merge=0.8535 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.854
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.7231051650891481, 'auprc': 0.9841049430917699, 'loss_val': 0.23967395076800674, 'psi': 0.8275050762901968}-{'f1_val': 0.9839737891748364, 'auprc': 0.9987658585170969, 'loss_val': 0.05875983048197232, 'psi': 0.9898906169117405}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=1.544189 cos_to_last_merge=0.8940 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.894
[S9] round=42 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9984366223911604, 'loss_val': 0.03261773454228022, 'psi': 0.9969870701427765}-{'f1_val': 0.9971029125121428, 'auprc': 0.9949583222499775, 'loss_val': 0.028391686763917373, 'psi': 0.9962450764072767}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=42 head_norm_before_train=1.768109 cos_to_last_merge=0.9257 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=42 local utility u=0.000431 metrics={'f1_val': 0.992994663041229, 'auprc': 0.9949306812562582, 'loss_val': 0.038973566068855214, 'psi': 0.9937690703272406}-{'f1_val': 0.9927757495752743, 'auprc': 0.9953138458221011, 'loss_val': 0.039672286727165315, 'psi': 0.993790988074005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=42 head_norm_before_train=1.739220 cos_to_last_merge=0.9201 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.920
[S11] round=42 local utility u=0.047401 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9977628472699067, 'loss_val': 0.029906132444280104, 'psi': 0.9966402416291111}-{'f1_val': 0.9961541414107454, 'auprc': 0.9958477977727174, 'loss_val': 0.12053633059365734, 'psi': 0.9960316039555341}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=42 head_norm_before_train=1.816540 (no previous merge yet)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.63455347666204, 'auprc': 0.741821275261437, 'loss_val': 0.7787767359953056, 'psi': 0.6774605961017988}-{'f1_val': 0.6559585915468578, 'auprc': 0.7765907615740201, 'loss_val': 0.6546947980867504, 'psi': 0.7042114595577227}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=42 head_norm_before_train=1.528640 cos_to_last_merge=0.9275 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.927
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9969141215360611, 'loss_val': 0.033860277442216466, 'psi': 0.9965722016784943}-{'f1_val': 0.9963442551067831, 'auprc': 0.9969925245166984, 'loss_val': 0.034042143863756175, 'psi': 0.9966035628707492}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.481787 cos_to_last_merge=0.9039 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.904
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.702030562915726, 'auprc': 0.9123849754407755, 'loss_val': 0.4317893941941491, 'psi': 0.7861723279257458}-{'f1_val': 0.9967466683875206, 'auprc': 0.9969570119724196, 'loss_val': 0.0403120026265251, 'psi': 0.9968308058214802}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.622734 cos_to_last_merge=0.8547 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.855
[S16] round=42 local utility u=0.001994 metrics={'f1_val': 0.991816385127412, 'auprc': 0.9981272598041226, 'loss_val': 0.042035735278017225, 'psi': 0.9943407349980963}-{'f1_val': 0.9922353369773327, 'auprc': 0.9962422087732412, 'loss_val': 0.042882750079854114, 'psi': 0.9938380856956961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=42 head_norm_before_train=1.788146 cos_to_last_merge=0.7604 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6021502458233526, 'auprc': 0.7874243042195456, 'loss_val': 0.909519292054001, 'psi': 0.6762598691818298}-{'f1_val': 0.6010869385975511, 'auprc': 0.8768220628841775, 'loss_val': 1.046690243156232, 'psi': 0.7113809883122018}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.955482 (no previous merge yet)
[S2] round=43 local utility u=0.010258 metrics={'f1_val': 0.7111470629076334, 'auprc': 0.8576013855870376, 'loss_val': 0.521395979428116, 'psi': 0.7697287919793951}-{'f1_val': 0.7123695428364747, 'auprc': 0.8435032329270934, 'loss_val': 0.5069519965119994, 'psi': 0.7648230188727222}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=43 head_norm_before_train=2.122583 (no previous merge yet)
[S3] round=43 local utility u=0.005922 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.9995016598873738, 'loss_val': 0.13343542568201622, 'psi': 0.9762984293376877}-{'f1_val': 0.9605438728991138, 'auprc': 0.9993349742478423, 'loss_val': 0.1430652343729153, 'psi': 0.9760603134386052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=43 head_norm_before_train=1.668739 cos_to_last_merge=0.8213 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.821
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9396146262434074, 'auprc': 0.9616874289908449, 'loss_val': 0.3334265890802355, 'psi': 0.9484437473423825}-{'f1_val': 0.9412671858750774, 'auprc': 0.9718663109512454, 'loss_val': 0.32361554620335947, 'psi': 0.9535068359055446}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=1.604518 cos_to_last_merge=0.8076 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.808
[S5] round=43 local utility u=0.566060 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9967837575938714, 'loss_val': 0.07729295247608169, 'psi': 0.9965130576308429}-{'f1_val': 0.8255192096671429, 'auprc': 0.9911754467613272, 'loss_val': 0.16770836047734855, 'psi': 0.8917817045048166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=43 head_norm_before_train=1.940359 (no previous merge yet)
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.7305983737372111, 'auprc': 0.9334109042986396, 'loss_val': 0.6369436360426834, 'psi': 0.8117233859617825}-{'f1_val': 0.810788005903266, 'auprc': 0.9550508598598954, 'loss_val': 0.5312660703187028, 'psi': 0.8684931474859178}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.698724 (no previous merge yet)
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.5557051874607616, 'auprc': 0.7834584213425593, 'loss_val': 0.8703884155823999, 'psi': 0.6468064810134807}-{'f1_val': 0.6036631121919438, 'auprc': 0.7920329293061018, 'loss_val': 0.6753595503325016, 'psi': 0.679011039037607}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=1.528932 cos_to_last_merge=0.8524 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=43 local utility u=0.927320 metrics={'f1_val': 0.9920979054933599, 'auprc': 0.9986802987118406, 'loss_val': 0.04271719633509452, 'psi': 0.9947308627807522}-{'f1_val': 0.7231051650891481, 'auprc': 0.9841049430917699, 'loss_val': 0.23967395076800674, 'psi': 0.8275050762901968}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=43 head_norm_before_train=1.554727 cos_to_last_merge=0.8931 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.893
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9936641219663829, 'loss_val': 0.0275286101431289, 'psi': 0.9954811435454105}-{'f1_val': 0.9960207019771873, 'auprc': 0.9984366223911604, 'loss_val': 0.03261773454228022, 'psi': 0.9969870701427765}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.775853 cos_to_last_merge=0.9248 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=43 local utility u=0.000000 metrics={'f1_val': 0.9925733077310497, 'auprc': 0.9944913246216682, 'loss_val': 0.03815827734638411, 'psi': 0.9933405144872971}-{'f1_val': 0.992994663041229, 'auprc': 0.9949306812562582, 'loss_val': 0.038973566068855214, 'psi': 0.9937690703272406}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=43 head_norm_before_train=1.749955 cos_to_last_merge=0.9189 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.919
[S11] round=43 local utility u=0.002584 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975490063789487, 'loss_val': 0.028028347968860903, 'psi': 0.9969478052597333}-{'f1_val': 0.9958918378685807, 'auprc': 0.9977628472699067, 'loss_val': 0.029906132444280104, 'psi': 0.9966402416291111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=43 head_norm_before_train=1.822601 (no previous merge yet)
[S13] round=43 local utility u=0.091559 metrics={'f1_val': 0.6800893049898842, 'auprc': 0.7398997836763413, 'loss_val': 0.8631090071735205, 'psi': 0.7040134964644671}-{'f1_val': 0.63455347666204, 'auprc': 0.741821275261437, 'loss_val': 0.7787767359953056, 'psi': 0.6774605961017988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=43 head_norm_before_train=1.538157 cos_to_last_merge=0.9268 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.927
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9955147221350316, 'loss_val': 0.03323714177217447, 'psi': 0.9960124419180825}-{'f1_val': 0.9963442551067831, 'auprc': 0.9969141215360611, 'loss_val': 0.033860277442216466, 'psi': 0.9965722016784943}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.491076 cos_to_last_merge=0.9029 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.903
[S15] round=43 local utility u=1.000000 metrics={'f1_val': 0.9974872712555476, 'auprc': 0.9945432026159785, 'loss_val': 0.045535611786770486, 'psi': 0.9963096437997199}-{'f1_val': 0.702030562915726, 'auprc': 0.9123849754407755, 'loss_val': 0.4317893941941491, 'psi': 0.7861723279257458}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=43 head_norm_before_train=1.633059 cos_to_last_merge=0.8534 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.853
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9952873963043336, 'loss_val': 0.04219854701938622, 'psi': 0.9933288494343595}-{'f1_val': 0.991816385127412, 'auprc': 0.9981272598041226, 'loss_val': 0.042035735278017225, 'psi': 0.9943407349980963}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.805296 cos_to_last_merge=0.7608 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=43 local utility u=0.028540 metrics={'f1_val': 0.5970734132014277, 'auprc': 0.9080551326427793, 'loss_val': 1.1838714365336163, 'psi': 0.7214661009779684}-{'f1_val': 0.6021502458233526, 'auprc': 0.7874243042195456, 'loss_val': 0.909519292054001, 'psi': 0.6762598691818298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=44 head_norm_before_train=1.972307 (no previous merge yet)
[S2] round=44 local utility u=0.003219 metrics={'f1_val': 0.7166484712136459, 'auprc': 0.8540515868535177, 'loss_val': 0.537317905595731, 'psi': 0.7716097174695946}-{'f1_val': 0.7111470629076334, 'auprc': 0.8576013855870376, 'loss_val': 0.521395979428116, 'psi': 0.7697287919793951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=44 head_norm_before_train=2.133320 (no previous merge yet)
[S3] round=44 local utility u=0.065055 metrics={'f1_val': 0.973095079493352, 'auprc': 0.9995013550339349, 'loss_val': 0.07691735001392838, 'psi': 0.9836575897095852}-{'f1_val': 0.9608296089712303, 'auprc': 0.9995016598873738, 'loss_val': 0.13343542568201622, 'psi': 0.9762984293376877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S3] sending update (kind=head size=1805 to 1 peers)
[S4] START round=44 head_norm_before_train=1.676004 cos_to_last_merge=0.8201 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.820
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9384824011073344, 'auprc': 0.9530892385381374, 'loss_val': 0.33584663799467646, 'psi': 0.9443251360796556}-{'f1_val': 0.9396146262434074, 'auprc': 0.9616874289908449, 'loss_val': 0.3334265890802355, 'psi': 0.9484437473423825}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.612559 cos_to_last_merge=0.8062 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.806
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.7179434863457569, 'auprc': 0.9905252386900328, 'loss_val': 0.2728165334559385, 'psi': 0.8269761872834673}-{'f1_val': 0.9963325909888239, 'auprc': 0.9967837575938714, 'loss_val': 0.07729295247608169, 'psi': 0.9965130576308429}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.951250 (no previous merge yet)
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.5308432016244458, 'auprc': 0.9042000338450092, 'loss_val': 1.1292563100252324, 'psi': 0.6801859345126712}-{'f1_val': 0.7305983737372111, 'auprc': 0.9334109042986396, 'loss_val': 0.6369436360426834, 'psi': 0.8117233859617825}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.710724 (no previous merge yet)
[S7] round=44 local utility u=0.794185 metrics={'f1_val': 0.6858761942850358, 'auprc': 0.8591841674025407, 'loss_val': 0.2902212693613588, 'psi': 0.7551993835320377}-{'f1_val': 0.5557051874607616, 'auprc': 0.7834584213425593, 'loss_val': 0.8703884155823999, 'psi': 0.6468064810134807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=44 head_norm_before_train=1.534357 cos_to_last_merge=0.8521 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.9906502235932722, 'auprc': 0.9986160963160204, 'loss_val': 0.04446796886987973, 'psi': 0.9938365726823715}-{'f1_val': 0.9920979054933599, 'auprc': 0.9986802987118406, 'loss_val': 0.04271719633509452, 'psi': 0.9947308627807522}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=1.565277 cos_to_last_merge=0.8919 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.892
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.998925806250826, 'loss_val': 0.050983409128685965, 'psi': 0.9921320663066068}-{'f1_val': 0.9966924912647621, 'auprc': 0.9936641219663829, 'loss_val': 0.0275286101431289, 'psi': 0.9954811435454105}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.783130 cos_to_last_merge=0.9240 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9941077514882151, 'auprc': 0.9906177268705343, 'loss_val': 0.038524989234062675, 'psi': 0.9927117416411427}-{'f1_val': 0.9925733077310497, 'auprc': 0.9944913246216682, 'loss_val': 0.03815827734638411, 'psi': 0.9933405144872971}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=1.762152 cos_to_last_merge=0.9176 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.918
[S11] round=44 local utility u=0.000003 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9975086586286201, 'loss_val': 0.027901276729453, 'psi': 0.9969316661596018}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975490063789487, 'loss_val': 0.028028347968860903, 'psi': 0.9969478052597333}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=44 head_norm_before_train=1.829607 (no previous merge yet)
[S13] round=44 local utility u=0.123135 metrics={'f1_val': 0.6707346010765088, 'auprc': 0.7259036402227346, 'loss_val': 0.5187215892899428, 'psi': 0.6928022167349992}-{'f1_val': 0.6800893049898842, 'auprc': 0.7398997836763413, 'loss_val': 0.8631090071735205, 'psi': 0.7040134964644671}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=44 head_norm_before_train=1.546887 cos_to_last_merge=0.9262 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.926
[S14] round=44 local utility u=0.004082 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9965588157174898, 'loss_val': 0.03212569551449241, 'psi': 0.996822031181595}-{'f1_val': 0.9963442551067831, 'auprc': 0.9955147221350316, 'loss_val': 0.03323714177217447, 'psi': 0.9960124419180825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=44 head_norm_before_train=1.499257 cos_to_last_merge=0.9018 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.902
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.8994977443294843, 'auprc': 0.9160282456102513, 'loss_val': 0.2778103542961665, 'psi': 0.9061099448417911}-{'f1_val': 0.9974872712555476, 'auprc': 0.9945432026159785, 'loss_val': 0.045535611786770486, 'psi': 0.9963096437997199}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.642832 cos_to_last_merge=0.8521 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.852
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9918037267651041, 'auprc': 0.9916664228849829, 'loss_val': 0.042535188165197926, 'psi': 0.9917488052130556}-{'f1_val': 0.9920231515210434, 'auprc': 0.9952873963043336, 'loss_val': 0.04219854701938622, 'psi': 0.9933288494343595}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.821458 cos_to_last_merge=0.7607 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.761
[S17] round=44 local utility u=0.024324 metrics={'f1_val': 0.5886819207825462, 'auprc': 0.9527634532562033, 'loss_val': 1.2189999805996552, 'psi': 0.7343145337720091}-{'f1_val': 0.5970734132014277, 'auprc': 0.9080551326427793, 'loss_val': 1.1838714365336163, 'psi': 0.7214661009779684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=45 head_norm_before_train=1.989069 (no previous merge yet)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.7098453657536152, 'auprc': 0.8596145755758896, 'loss_val': 0.5686928957317511, 'psi': 0.769753049682525}-{'f1_val': 0.7166484712136459, 'auprc': 0.8540515868535177, 'loss_val': 0.537317905595731, 'psi': 0.7716097174695946}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.144003 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.896925068578775, 'auprc': 0.9966930910905198, 'loss_val': 0.2575687939801651, 'psi': 0.936832277583473}-{'f1_val': 0.973095079493352, 'auprc': 0.9995013550339349, 'loss_val': 0.07691735001392838, 'psi': 0.9836575897095852}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.681531 cos_to_last_merge=0.8193 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.819
[S4] round=45 local utility u=0.035680 metrics={'f1_val': 0.9401667532601357, 'auprc': 0.9701190656939704, 'loss_val': 0.3256816425414567, 'psi': 0.9521476782336695}-{'f1_val': 0.9384824011073344, 'auprc': 0.9530892385381374, 'loss_val': 0.33584663799467646, 'psi': 0.9443251360796556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=45 head_norm_before_train=1.625848 cos_to_last_merge=0.8033 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.803
[S5] round=45 local utility u=0.939914 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9935512862573432, 'loss_val': 0.0715219999176709, 'psi': 0.995132128488524}-{'f1_val': 0.7179434863457569, 'auprc': 0.9905252386900328, 'loss_val': 0.2728165334559385, 'psi': 0.8269761872834673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=45 head_norm_before_train=1.960114 (no previous merge yet)
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.8265829465441963, 'auprc': 0.9613551077290211, 'loss_val': 0.5370578293456185, 'psi': 0.8804918110181261}-{'f1_val': 0.5308432016244458, 'auprc': 0.9042000338450092, 'loss_val': 1.1292563100252324, 'psi': 0.6801859345126712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=45 head_norm_before_train=1.720197 (no previous merge yet)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6391190928492891, 'auprc': 0.8018074591852682, 'loss_val': 0.5837797758463132, 'psi': 0.7041944393836808}-{'f1_val': 0.6858761942850358, 'auprc': 0.8591841674025407, 'loss_val': 0.2902212693613588, 'psi': 0.7551993835320377}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.538991 cos_to_last_merge=0.8522 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=45 local utility u=0.009307 metrics={'f1_val': 0.9933434229799246, 'auprc': 0.9985062911854712, 'loss_val': 0.04168411988730554, 'psi': 0.9954085702621434}-{'f1_val': 0.9906502235932722, 'auprc': 0.9986160963160204, 'loss_val': 0.04446796886987973, 'psi': 0.9938365726823715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=45 head_norm_before_train=1.573171 cos_to_last_merge=0.8911 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.891
[S9] round=45 local utility u=0.028079 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9917610711334314, 'loss_val': 0.02786784091022934, 'psi': 0.9947199232122299}-{'f1_val': 0.9876029063437939, 'auprc': 0.998925806250826, 'loss_val': 0.050983409128685965, 'psi': 0.9921320663066068}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=45 head_norm_before_train=1.792062 cos_to_last_merge=0.9223 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=45 local utility u=0.005163 metrics={'f1_val': 0.9934082608615626, 'auprc': 0.9945570717466241, 'loss_val': 0.03581917195376512, 'psi': 0.9938677852155873}-{'f1_val': 0.9941077514882151, 'auprc': 0.9906177268705343, 'loss_val': 0.038524989234062675, 'psi': 0.9927117416411427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=45 head_norm_before_train=1.774840 cos_to_last_merge=0.9164 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.916
[S11] round=45 local utility u=0.000076 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976987844915474, 'loss_val': 0.0268687611551723, 'psi': 0.9968626142779355}-{'f1_val': 0.9965470045135896, 'auprc': 0.9975086586286201, 'loss_val': 0.027901276729453, 'psi': 0.9969316661596018}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=45 head_norm_before_train=1.833743 (no previous merge yet)
[S13] round=45 local utility u=0.000504 metrics={'f1_val': 0.7206529861238602, 'auprc': 0.7392505369386813, 'loss_val': 0.8572654174376401, 'psi': 0.7280920064497887}-{'f1_val': 0.6707346010765088, 'auprc': 0.7259036402227346, 'loss_val': 0.5187215892899428, 'psi': 0.6928022167349992}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S13] sending update (kind=head size=1809 to 1 peers)
[S14] START round=45 head_norm_before_train=1.555543 cos_to_last_merge=0.9254 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.925
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9919535831054036, 'auprc': 0.9965596184895467, 'loss_val': 0.04356109226208068, 'psi': 0.9937959972590609}-{'f1_val': 0.9969975081576651, 'auprc': 0.9965588157174898, 'loss_val': 0.03212569551449241, 'psi': 0.996822031181595}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.507780 cos_to_last_merge=0.9007 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.901
[S15] round=45 local utility u=0.458820 metrics={'f1_val': 0.9755805906229662, 'auprc': 0.9974159093886532, 'loss_val': 0.06083079959022813, 'psi': 0.9843147181292411}-{'f1_val': 0.8994977443294843, 'auprc': 0.9160282456102513, 'loss_val': 0.2778103542961665, 'psi': 0.9061099448417911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=45 head_norm_before_train=1.653088 cos_to_last_merge=0.8509 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.851
[S16] round=45 local utility u=0.005013 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9941916229648102, 'loss_val': 0.041400660073108546, 'psi': 0.9928905400985502}-{'f1_val': 0.9918037267651041, 'auprc': 0.9916664228849829, 'loss_val': 0.042535188165197926, 'psi': 0.9917488052130556}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] sending update (kind=head size=1789 to 1 peers)
[S17] START round=45 head_norm_before_train=1.835987 cos_to_last_merge=0.7599 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.760
[S17] round=45 local utility u=0.030122 metrics={'f1_val': 0.6008690864141564, 'auprc': 0.9423668414537074, 'loss_val': 1.200689535061196, 'psi': 0.7374681884299767}-{'f1_val': 0.5886819207825462, 'auprc': 0.9527634532562033, 'loss_val': 1.2189999805996552, 'psi': 0.7343145337720091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=46 head_norm_before_train=2.006804 (no previous merge yet)
[S2] round=46 local utility u=0.199599 metrics={'f1_val': 0.7997712150465244, 'auprc': 0.8138805465831856, 'loss_val': 0.5718483234315821, 'psi': 0.8054149476611889}-{'f1_val': 0.7098453657536152, 'auprc': 0.8596145755758896, 'loss_val': 0.5686928957317511, 'psi': 0.769753049682525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=46 head_norm_before_train=2.153325 (no previous merge yet)
[S3] round=46 local utility u=0.073834 metrics={'f1_val': 0.9081665033354771, 'auprc': 0.9983906351493279, 'loss_val': 0.1824420785399214, 'psi': 0.9442561560610174}-{'f1_val': 0.896925068578775, 'auprc': 0.9966930910905198, 'loss_val': 0.2575687939801651, 'psi': 0.936832277583473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=46 head_norm_before_train=1.683963 cos_to_last_merge=0.8190 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.819
[S4] round=46 local utility u=0.025827 metrics={'f1_val': 0.9443126754825996, 'auprc': 0.9744991594858097, 'loss_val': 0.3120439096435394, 'psi': 0.9563872690838837}-{'f1_val': 0.9401667532601357, 'auprc': 0.9701190656939704, 'loss_val': 0.3256816425414567, 'psi': 0.9521476782336695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=46 head_norm_before_train=1.636434 cos_to_last_merge=0.8011 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.801
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.7144364317802219, 'auprc': 0.9050073649825522, 'loss_val': 0.4392144479966223, 'psi': 0.790664805061154}-{'f1_val': 0.996186023309311, 'auprc': 0.9935512862573432, 'loss_val': 0.0715219999176709, 'psi': 0.995132128488524}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.965215 (no previous merge yet)
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.6235373395022045, 'auprc': 0.952930719616906, 'loss_val': 0.7183164729361136, 'psi': 0.7552946915480852}-{'f1_val': 0.8265829465441963, 'auprc': 0.9613551077290211, 'loss_val': 0.5370578293456185, 'psi': 0.8804918110181261}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.726106 (no previous merge yet)
[S7] round=46 local utility u=0.000000 metrics={'f1_val': 0.6302690393226503, 'auprc': 0.7969560873212125, 'loss_val': 0.5951284261071395, 'psi': 0.6969438585220752}-{'f1_val': 0.6391190928492891, 'auprc': 0.8018074591852682, 'loss_val': 0.5837797758463132, 'psi': 0.7041944393836808}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=46 head_norm_before_train=1.545382 cos_to_last_merge=0.8522 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=46 local utility u=0.001238 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9986511917998716, 'loss_val': 0.038668000784003564, 'psi': 0.995368962797228}-{'f1_val': 0.9933434229799246, 'auprc': 0.9985062911854712, 'loss_val': 0.04168411988730554, 'psi': 0.9954085702621434}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=46 head_norm_before_train=1.579425 cos_to_last_merge=0.8905 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=46 local utility u=0.007673 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9960634796351109, 'loss_val': 0.026390461681133643, 'psi': 0.9965369431093987}-{'f1_val': 0.9966924912647621, 'auprc': 0.9917610711334314, 'loss_val': 0.02786784091022934, 'psi': 0.9947199232122299}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=46 head_norm_before_train=1.801692 cos_to_last_merge=0.9201 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9921658203291814, 'loss_val': 0.03779071899817549, 'psi': 0.9928046191637647}-{'f1_val': 0.9934082608615626, 'auprc': 0.9945570717466241, 'loss_val': 0.03581917195376512, 'psi': 0.9938677852155873}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=1.784617 cos_to_last_merge=0.9153 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.915
[S11] round=46 local utility u=0.000431 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977673423774883, 'loss_val': 0.026213339111142694, 'psi': 0.996890037432312}-{'f1_val': 0.996305167468861, 'auprc': 0.9976987844915474, 'loss_val': 0.0268687611551723, 'psi': 0.9968626142779355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=46 head_norm_before_train=1.836802 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.7215712620508409, 'auprc': 0.7306982396835525, 'loss_val': 0.9164370158957451, 'psi': 0.7252220531039255}-{'f1_val': 0.7206529861238602, 'auprc': 0.7392505369386813, 'loss_val': 0.8572654174376401, 'psi': 0.7280920064497887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=1.565008 cos_to_last_merge=0.9247 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.925
[S14] round=46 local utility u=0.016592 metrics={'f1_val': 0.9957493401849709, 'auprc': 0.9958823352665858, 'loss_val': 0.031119581899457474, 'psi': 0.9958025382176168}-{'f1_val': 0.9919535831054036, 'auprc': 0.9965596184895467, 'loss_val': 0.04356109226208068, 'psi': 0.9937959972590609}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=46 head_norm_before_train=1.516990 cos_to_last_merge=0.9000 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.900
[S15] round=46 local utility u=0.065836 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.991623360964043, 'loss_val': 0.03619722043019783, 'psi': 0.9944392071581698}-{'f1_val': 0.9755805906229662, 'auprc': 0.9974159093886532, 'loss_val': 0.06083079959022813, 'psi': 0.9843147181292411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=46 head_norm_before_train=1.663419 cos_to_last_merge=0.8497 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.850
[S16] round=46 local utility u=0.000398 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9942626336856246, 'loss_val': 0.0408184359564373, 'psi': 0.9929189443868759}-{'f1_val': 0.9920231515210434, 'auprc': 0.9941916229648102, 'loss_val': 0.041400660073108546, 'psi': 0.9928905400985502}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=46 head_norm_before_train=1.851068 cos_to_last_merge=0.7587 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.759
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.5688123736130754, 'auprc': 0.866699967996081, 'loss_val': 1.3284530265285917, 'psi': 0.6879674113662776}-{'f1_val': 0.6008690864141564, 'auprc': 0.9423668414537074, 'loss_val': 1.200689535061196, 'psi': 0.7374681884299767}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=47 head_norm_before_train=2.016345 (no previous merge yet)
[S2] round=47 local utility u=0.000000 metrics={'f1_val': 0.6889212077468808, 'auprc': 0.8223190391983691, 'loss_val': 0.6321482922519581, 'psi': 0.7422803403274763}-{'f1_val': 0.7997712150465244, 'auprc': 0.8138805465831856, 'loss_val': 0.5718483234315821, 'psi': 0.8054149476611889}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=47 head_norm_before_train=2.163207 (no previous merge yet)
[S3] round=47 local utility u=0.340196 metrics={'f1_val': 0.9972450390152456, 'auprc': 0.9991863984268485, 'loss_val': 0.038909156169481575, 'psi': 0.9980215827798868}-{'f1_val': 0.9081665033354771, 'auprc': 0.9983906351493279, 'loss_val': 0.1824420785399214, 'psi': 0.9442561560610174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=47 head_norm_before_train=1.689148 cos_to_last_merge=0.8182 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.818
[S4] round=47 local utility u=0.018223 metrics={'f1_val': 0.9505643015821466, 'auprc': 0.971964776861144, 'loss_val': 0.30550543381197814, 'psi': 0.9591244916937456}-{'f1_val': 0.9443126754825996, 'auprc': 0.9744991594858097, 'loss_val': 0.3120439096435394, 'psi': 0.9563872690838837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=47 head_norm_before_train=1.642746 cos_to_last_merge=0.7998 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.800
[S5] round=47 local utility u=1.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9951864020616967, 'loss_val': 0.05787382370669241, 'psi': 0.9957861748102653}-{'f1_val': 0.7144364317802219, 'auprc': 0.9050073649825522, 'loss_val': 0.4392144479966223, 'psi': 0.790664805061154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=47 head_norm_before_train=1.965782 (no previous merge yet)
[S6] round=47 local utility u=0.476711 metrics={'f1_val': 0.7551679206611778, 'auprc': 0.9544536041239876, 'loss_val': 0.5592461492321832, 'psi': 0.8348821940463017}-{'f1_val': 0.6235373395022045, 'auprc': 0.952930719616906, 'loss_val': 0.7183164729361136, 'psi': 0.7552946915480852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=47 head_norm_before_train=1.730597 (no previous merge yet)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.6093284399856652, 'auprc': 0.791286252897549, 'loss_val': 0.6618586748619312, 'psi': 0.6821115651504187}-{'f1_val': 0.6302690393226503, 'auprc': 0.7969560873212125, 'loss_val': 0.5951284261071395, 'psi': 0.6969438585220752}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.552401 cos_to_last_merge=0.8519 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.852
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9988156107265291, 'loss_val': 0.03927547591183924, 'psi': 0.9948643017000902}-{'f1_val': 0.9931808101287989, 'auprc': 0.9986511917998716, 'loss_val': 0.038668000784003564, 'psi': 0.995368962797228}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=47 head_norm_before_train=1.583915 cos_to_last_merge=0.8903 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9922651407836713, 'auprc': 0.9988273522798867, 'loss_val': 0.03501735061936448, 'psi': 0.9948900253821575}-{'f1_val': 0.9968525854255906, 'auprc': 0.9960634796351109, 'loss_val': 0.026390461681133643, 'psi': 0.9965369431093987}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.811886 cos_to_last_merge=0.9177 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=47 local utility u=0.000739 metrics={'f1_val': 0.992354394265095, 'auprc': 0.9949302521323048, 'loss_val': 0.03934925889224073, 'psi': 0.9933847374119789}-{'f1_val': 0.9932304850534869, 'auprc': 0.9921658203291814, 'loss_val': 0.03779071899817549, 'psi': 0.9928046191637647}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=47 head_norm_before_train=1.795454 cos_to_last_merge=0.9142 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.914
[S11] round=47 local utility u=0.000354 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977202879331712, 'loss_val': 0.026815318590776537, 'psi': 0.9970163178814222}-{'f1_val': 0.996305167468861, 'auprc': 0.9977673423774883, 'loss_val': 0.026213339111142694, 'psi': 0.996890037432312}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S11] sending update (kind=head size=1791 to 1 peers)
[S13] START round=47 head_norm_before_train=1.839944 (no previous merge yet)
[S13] round=47 local utility u=0.000000 metrics={'f1_val': 0.6504273178445306, 'auprc': 0.7765489049759929, 'loss_val': 0.6654263873337368, 'psi': 0.7008759526971156}-{'f1_val': 0.7215712620508409, 'auprc': 0.7306982396835525, 'loss_val': 0.9164370158957451, 'psi': 0.7252220531039255}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=47 head_norm_before_train=1.574787 cos_to_last_merge=0.9240 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.924
[S14] round=47 local utility u=0.004111 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9970230720347154, 'loss_val': 0.02988929676664595, 'psi': 0.996615781877956}-{'f1_val': 0.9957493401849709, 'auprc': 0.9958823352665858, 'loss_val': 0.031119581899457474, 'psi': 0.9958025382176168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=47 head_norm_before_train=1.527394 cos_to_last_merge=0.8991 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.899
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9010457098677005, 'auprc': 0.9793530297715378, 'loss_val': 0.2395889657672546, 'psi': 0.9323686378292355}-{'f1_val': 0.9963164379542544, 'auprc': 0.991623360964043, 'loss_val': 0.03619722043019783, 'psi': 0.9944392071581698}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.671326 cos_to_last_merge=0.8485 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.849
[S16] round=47 local utility u=0.000439 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9944152775879375, 'loss_val': 0.04039802890740239, 'psi': 0.992980001947801}-{'f1_val': 0.9920231515210434, 'auprc': 0.9942626336856246, 'loss_val': 0.0408184359564373, 'psi': 0.9929189443868759}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=47 head_norm_before_train=1.863897 cos_to_last_merge=0.7582 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=47 local utility u=0.093453 metrics={'f1_val': 0.5773091294983155, 'auprc': 0.9126506417604183, 'loss_val': 1.3303792263108791, 'psi': 0.7114457344031566}-{'f1_val': 0.5688123736130754, 'auprc': 0.866699967996081, 'loss_val': 1.3284530265285917, 'psi': 0.6879674113662776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=48 head_norm_before_train=2.025239 (no previous merge yet)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.6723126830942343, 'auprc': 0.8125410628353527, 'loss_val': 0.6870529667169196, 'psi': 0.7284040349906817}-{'f1_val': 0.6889212077468808, 'auprc': 0.8223190391983691, 'loss_val': 0.6321482922519581, 'psi': 0.7422803403274763}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=48 head_norm_before_train=2.172993 (no previous merge yet)
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.985892249404232, 'auprc': 0.9995068698408658, 'loss_val': 0.046578368486043784, 'psi': 0.9913380975788855}-{'f1_val': 0.9972450390152456, 'auprc': 0.9991863984268485, 'loss_val': 0.038909156169481575, 'psi': 0.9980215827798868}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.696590 cos_to_last_merge=0.8171 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9407508479159031, 'auprc': 0.9722572038049426, 'loss_val': 0.3268661201743836, 'psi': 0.9533533902715189}-{'f1_val': 0.9505643015821466, 'auprc': 0.971964776861144, 'loss_val': 0.30550543381197814, 'psi': 0.9591244916937456}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=1.649073 cos_to_last_merge=0.7986 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=48 local utility u=0.005227 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9969481191522632, 'loss_val': 0.0527041550335486, 'psi': 0.9964908616464919}-{'f1_val': 0.996186023309311, 'auprc': 0.9951864020616967, 'loss_val': 0.05787382370669241, 'psi': 0.9957861748102653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=48 head_norm_before_train=1.968231 (no previous merge yet)
[S6] round=48 local utility u=0.359666 metrics={'f1_val': 0.8365934791419801, 'auprc': 0.9720371772752086, 'loss_val': 0.381217901982352, 'psi': 0.8907709583952714}-{'f1_val': 0.7551679206611778, 'auprc': 0.9544536041239876, 'loss_val': 0.5592461492321832, 'psi': 0.8348821940463017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=48 head_norm_before_train=1.733561 (no previous merge yet)
[S7] round=48 local utility u=0.000000 metrics={'f1_val': 0.5854138779301558, 'auprc': 0.7870916085539958, 'loss_val': 0.7730462954760394, 'psi': 0.6660849701796918}-{'f1_val': 0.6093284399856652, 'auprc': 0.791286252897549, 'loss_val': 0.6618586748619312, 'psi': 0.6821115651504187}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=48 head_norm_before_train=1.561645 cos_to_last_merge=0.8512 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.851
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9918431215757397, 'auprc': 0.9986937071825159, 'loss_val': 0.04077519813226299, 'psi': 0.9945833558184503}-{'f1_val': 0.9922300956824643, 'auprc': 0.9988156107265291, 'loss_val': 0.03927547591183924, 'psi': 0.9948643017000902}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=1.589721 cos_to_last_merge=0.8899 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.890
[S9] round=48 local utility u=0.011322 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936711081870916, 'loss_val': 0.025930463849476955, 'psi': 0.9957301907821223}-{'f1_val': 0.9922651407836713, 'auprc': 0.9988273522798867, 'loss_val': 0.03501735061936448, 'psi': 0.9948900253821575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=48 head_norm_before_train=1.822364 cos_to_last_merge=0.9154 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.992354394265095, 'auprc': 0.9931906493639253, 'loss_val': 0.039539346859637114, 'psi': 0.9926888963046271}-{'f1_val': 0.992354394265095, 'auprc': 0.9949302521323048, 'loss_val': 0.03934925889224073, 'psi': 0.9933847374119789}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=1.805883 cos_to_last_merge=0.9133 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.913
[S11] round=48 local utility u=0.000000 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.997942227130597, 'loss_val': 0.026137285869895818, 'psi': 0.9967119935733872}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977202879331712, 'loss_val': 0.026815318590776537, 'psi': 0.9970163178814222}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=48 head_norm_before_train=1.842986 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6215553484899554, 'auprc': 0.730825393786889, 'loss_val': 0.9179268377100646, 'psi': 0.6652633666087289}-{'f1_val': 0.6504273178445306, 'auprc': 0.7765489049759929, 'loss_val': 0.6654263873337368, 'psi': 0.7008759526971156}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=1.581631 cos_to_last_merge=0.9234 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.923
[S14] round=48 local utility u=0.000212 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9969541985949208, 'loss_val': 0.030717350252623007, 'psi': 0.9967340184044186}-{'f1_val': 0.9963442551067831, 'auprc': 0.9970230720347154, 'loss_val': 0.02988929676664595, 'psi': 0.996615781877956}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=48 head_norm_before_train=1.539590 cos_to_last_merge=0.8978 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.898
[S15] round=48 local utility u=0.000000 metrics={'f1_val': 0.8258899273248899, 'auprc': 0.9176606021513484, 'loss_val': 0.32163515062699005, 'psi': 0.8625981972554733}-{'f1_val': 0.9010457098677005, 'auprc': 0.9793530297715378, 'loss_val': 0.2395889657672546, 'psi': 0.9323686378292355}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=48 head_norm_before_train=1.680697 cos_to_last_merge=0.8474 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.847
[S16] round=48 local utility u=0.002705 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9960687316806147, 'loss_val': 0.03994925376848578, 'psi': 0.9936413835848719}-{'f1_val': 0.9920231515210434, 'auprc': 0.9944152775879375, 'loss_val': 0.04039802890740239, 'psi': 0.992980001947801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=48 head_norm_before_train=1.875986 cos_to_last_merge=0.7580 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=48 local utility u=0.110773 metrics={'f1_val': 0.616006924401021, 'auprc': 0.8256077572049368, 'loss_val': 1.079890766235959, 'psi': 0.6998472575225874}-{'f1_val': 0.5773091294983155, 'auprc': 0.9126506417604183, 'loss_val': 1.3303792263108791, 'psi': 0.7114457344031566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=49 head_norm_before_train=2.034519 (no previous merge yet)
[S2] round=49 local utility u=0.000000 metrics={'f1_val': 0.669079466654757, 'auprc': 0.7571628055704034, 'loss_val': 1.2580570132161522, 'psi': 0.7043128022210156}-{'f1_val': 0.6723126830942343, 'auprc': 0.8125410628353527, 'loss_val': 0.6870529667169196, 'psi': 0.7284040349906817}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=49 head_norm_before_train=2.181444 (no previous merge yet)
[S3] round=49 local utility u=0.002007 metrics={'f1_val': 0.9871725261700923, 'auprc': 0.9993798162827228, 'loss_val': 0.049865626350636315, 'psi': 0.9920554422151445}-{'f1_val': 0.985892249404232, 'auprc': 0.9995068698408658, 'loss_val': 0.046578368486043784, 'psi': 0.9913380975788855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=49 head_norm_before_train=1.704677 cos_to_last_merge=0.8157 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.816
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9391491857239125, 'auprc': 0.9556724835315594, 'loss_val': 0.3415718502979344, 'psi': 0.9457585048469712}-{'f1_val': 0.9407508479159031, 'auprc': 0.9722572038049426, 'loss_val': 0.3268661201743836, 'psi': 0.9533533902715189}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.657969 cos_to_last_merge=0.7968 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9909149409578417, 'loss_val': 0.06647063228194762, 'psi': 0.9940775903687233}-{'f1_val': 0.996186023309311, 'auprc': 0.9969481191522632, 'loss_val': 0.0527041550335486, 'psi': 0.9964908616464919}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.973890 (no previous merge yet)
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5994061158858124, 'auprc': 0.8980634800075398, 'loss_val': 0.9650593700038054, 'psi': 0.7188690615345034}-{'f1_val': 0.8365934791419801, 'auprc': 0.9720371772752086, 'loss_val': 0.381217901982352, 'psi': 0.8907709583952714}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.738741 (no previous merge yet)
[S7] round=49 local utility u=0.279013 metrics={'f1_val': 0.6315532733718012, 'auprc': 0.802857320418777, 'loss_val': 0.5391528905817847, 'psi': 0.7000748921905915}-{'f1_val': 0.5854138779301558, 'auprc': 0.7870916085539958, 'loss_val': 0.7730462954760394, 'psi': 0.6660849701796918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=49 head_norm_before_train=1.569081 cos_to_last_merge=0.8501 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.850
[S8] round=49 local utility u=0.006598 metrics={'f1_val': 0.9933673104406822, 'auprc': 0.9988294958788795, 'loss_val': 0.03713238126816815, 'psi': 0.9955521846159611}-{'f1_val': 0.9918431215757397, 'auprc': 0.9986937071825159, 'loss_val': 0.04077519813226299, 'psi': 0.9945833558184503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=49 head_norm_before_train=1.596873 cos_to_last_merge=0.8892 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.889
[S9] round=49 local utility u=0.002689 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9951903342054335, 'loss_val': 0.025109417244938714, 'psi': 0.9963378811894591}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936711081870916, 'loss_val': 0.025930463849476955, 'psi': 0.9957301907821223}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=49 head_norm_before_train=1.832922 cos_to_last_merge=0.9140 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=49 local utility u=0.001838 metrics={'f1_val': 0.9925733077310497, 'auprc': 0.9929273497862345, 'loss_val': 0.036387903632669, 'psi': 0.9927149245531236}-{'f1_val': 0.992354394265095, 'auprc': 0.9931906493639253, 'loss_val': 0.039539346859637114, 'psi': 0.9926888963046271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=49 head_norm_before_train=1.816145 cos_to_last_merge=0.9124 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=49 local utility u=0.001563 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9979736655531795, 'loss_val': 0.024556883668545325, 'psi': 0.9968696711692574}-{'f1_val': 0.9958918378685807, 'auprc': 0.997942227130597, 'loss_val': 0.026137285869895818, 'psi': 0.9967119935733872}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=49 head_norm_before_train=1.847061 (no previous merge yet)
[S13] round=49 local utility u=0.366801 metrics={'f1_val': 0.7377057916695884, 'auprc': 0.7141401006948841, 'loss_val': 0.8311724035905614, 'psi': 0.7282795152797067}-{'f1_val': 0.6215553484899554, 'auprc': 0.730825393786889, 'loss_val': 0.9179268377100646, 'psi': 0.6652633666087289}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=49 head_norm_before_train=1.588222 cos_to_last_merge=0.9226 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.923
[S14] round=49 local utility u=0.000000 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9977523987101073, 'loss_val': 0.03697172575516223, 'psi': 0.9970400934298189}-{'f1_val': 0.9965872316107504, 'auprc': 0.9969541985949208, 'loss_val': 0.030717350252623007, 'psi': 0.9967340184044186}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=49 head_norm_before_train=1.553072 cos_to_last_merge=0.8962 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.896
[S15] round=49 local utility u=0.419869 metrics={'f1_val': 0.9033321865438193, 'auprc': 0.9913586400092715, 'loss_val': 0.1676443340138209, 'psi': 0.9385427679300002}-{'f1_val': 0.8258899273248899, 'auprc': 0.9176606021513484, 'loss_val': 0.32163515062699005, 'psi': 0.8625981972554733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=49 head_norm_before_train=1.690881 cos_to_last_merge=0.8463 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.846
[S16] round=49 local utility u=0.000126 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9963814333242011, 'loss_val': 0.03944204412203448, 'psi': 0.9936471087076302}-{'f1_val': 0.9920231515210434, 'auprc': 0.9960687316806147, 'loss_val': 0.03994925376848578, 'psi': 0.9936413835848719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S16] sending update (kind=head size=1790 to 1 peers)
[S17] START round=49 head_norm_before_train=1.889093 cos_to_last_merge=0.7579 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.758
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.5911314106361278, 'auprc': 0.7811597686560485, 'loss_val': 1.2692377916247395, 'psi': 0.6671427538440962}-{'f1_val': 0.616006924401021, 'auprc': 0.8256077572049368, 'loss_val': 1.079890766235959, 'psi': 0.6998472575225874}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=50 head_norm_before_train=2.041892 (no previous merge yet)
[S2] round=50 local utility u=0.607181 metrics={'f1_val': 0.7037764209932331, 'auprc': 0.8661679295190261, 'loss_val': 0.5788920581528898, 'psi': 0.7687330244035503}-{'f1_val': 0.669079466654757, 'auprc': 0.7571628055704034, 'loss_val': 1.2580570132161522, 'psi': 0.7043128022210156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=50 head_norm_before_train=2.187739 (no previous merge yet)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9739827570337951, 'auprc': 0.99915209395808, 'loss_val': 0.06387323633427015, 'psi': 0.984050491803509}-{'f1_val': 0.9871725261700923, 'auprc': 0.9993798162827228, 'loss_val': 0.049865626350636315, 'psi': 0.9920554422151445}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.714681 cos_to_last_merge=0.8138 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=50 local utility u=0.020082 metrics={'f1_val': 0.9391842671679683, 'auprc': 0.9677842422551304, 'loss_val': 0.337953522591364, 'psi': 0.9506242572028332}-{'f1_val': 0.9391491857239125, 'auprc': 0.9556724835315594, 'loss_val': 0.3415718502979344, 'psi': 0.9457585048469712}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=50 head_norm_before_train=1.665088 cos_to_last_merge=0.7955 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=50 local utility u=0.002120 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9909053863106496, 'loss_val': 0.06220162392189022, 'psi': 0.9940737685098464}-{'f1_val': 0.996186023309311, 'auprc': 0.9909149409578417, 'loss_val': 0.06647063228194762, 'psi': 0.9940775903687233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=50 head_norm_before_train=1.982486 (no previous merge yet)
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8668878084013767, 'auprc': 0.9632361865892477, 'loss_val': 0.4301111279359044, 'psi': 0.9054271596765251}-{'f1_val': 0.5994061158858124, 'auprc': 0.8980634800075398, 'loss_val': 0.9650593700038054, 'psi': 0.7188690615345034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=50 head_norm_before_train=1.744976 (no previous merge yet)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.6116736743973911, 'auprc': 0.7948107809824088, 'loss_val': 0.6930782968393561, 'psi': 0.6849285170313981}-{'f1_val': 0.6315532733718012, 'auprc': 0.802857320418777, 'loss_val': 0.5391528905817847, 'psi': 0.7000748921905915}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.577803 cos_to_last_merge=0.8492 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.849
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9935326376274699, 'auprc': 0.9982529150537275, 'loss_val': 0.04127769769397134, 'psi': 0.9954207485979729}-{'f1_val': 0.9933673104406822, 'auprc': 0.9988294958788795, 'loss_val': 0.03713238126816815, 'psi': 0.9955521846159611}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=50 head_norm_before_train=1.603353 cos_to_last_merge=0.8887 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.889
[S9] round=50 local utility u=0.000844 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9984112025924106, 'loss_val': 0.028092172230835103, 'psi': 0.9971270984752079}-{'f1_val': 0.9971029125121428, 'auprc': 0.9951903342054335, 'loss_val': 0.025109417244938714, 'psi': 0.9963378811894591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=50 head_norm_before_train=1.839177 cos_to_last_merge=0.9123 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=50 local utility u=0.001653 metrics={'f1_val': 0.992354394265095, 'auprc': 0.9946420840401033, 'loss_val': 0.036912430234554705, 'psi': 0.9932694701750984}-{'f1_val': 0.9925733077310497, 'auprc': 0.9929273497862345, 'loss_val': 0.036387903632669, 'psi': 0.9927149245531236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=50 head_norm_before_train=1.824738 cos_to_last_merge=0.9116 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.912
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9509888295289037, 'auprc': 0.997736344066964, 'loss_val': 0.21350169757816667, 'psi': 0.9696878353441278}-{'f1_val': 0.9961336749133093, 'auprc': 0.9979736655531795, 'loss_val': 0.024556883668545325, 'psi': 0.9968696711692574}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.849288 (no previous merge yet)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6179761151278912, 'auprc': 0.6862158446342248, 'loss_val': 0.9383390109595031, 'psi': 0.6452720069304246}-{'f1_val': 0.7377057916695884, 'auprc': 0.7141401006948841, 'loss_val': 0.8311724035905614, 'psi': 0.7282795152797067}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=1.596003 cos_to_last_merge=0.9218 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.922
[S14] round=50 local utility u=0.005827 metrics={'f1_val': 0.9965652232429598, 'auprc': 0.9986487160446029, 'loss_val': 0.028007125017700252, 'psi': 0.9973986203636171}-{'f1_val': 0.9965652232429598, 'auprc': 0.9977523987101073, 'loss_val': 0.03697172575516223, 'psi': 0.9970400934298189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] sending update (kind=head size=1792 to 1 peers)
[S15] START round=50 head_norm_before_train=1.565571 cos_to_last_merge=0.8947 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.895
[S15] round=50 local utility u=0.359469 metrics={'f1_val': 0.9974872712555476, 'auprc': 0.9982995495546043, 'loss_val': 0.03445863755175444, 'psi': 0.9978121825751702}-{'f1_val': 0.9033321865438193, 'auprc': 0.9913586400092715, 'loss_val': 0.1676443340138209, 'psi': 0.9385427679300002}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=50 head_norm_before_train=1.701706 cos_to_last_merge=0.8451 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.845
[S16] round=50 local utility u=0.000131 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9963614673044794, 'loss_val': 0.03912098002353101, 'psi': 0.9936391222997416}-{'f1_val': 0.9918242256299163, 'auprc': 0.9963814333242011, 'loss_val': 0.03944204412203448, 'psi': 0.9936471087076302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=50 head_norm_before_train=1.901565 cos_to_last_merge=0.7575 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=50 local utility u=0.125415 metrics={'f1_val': 0.5824193874712464, 'auprc': 0.9142550742173216, 'loss_val': 1.365420792822448, 'psi': 0.7151536621696766}-{'f1_val': 0.5911314106361278, 'auprc': 0.7811597686560485, 'loss_val': 1.2692377916247395, 'psi': 0.6671427538440962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=51 head_norm_before_train=2.047625 (no previous merge yet)
[S2] round=51 local utility u=0.007070 metrics={'f1_val': 0.7107597966005115, 'auprc': 0.860015399970525, 'loss_val': 0.5881942371084719, 'psi': 0.770462037948517}-{'f1_val': 0.7037764209932331, 'auprc': 0.8661679295190261, 'loss_val': 0.5788920581528898, 'psi': 0.7687330244035503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=51 head_norm_before_train=2.193533 (no previous merge yet)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.999759209066573, 'loss_val': 0.21193109251450215, 'psi': 0.960841208797263}-{'f1_val': 0.9739827570337951, 'auprc': 0.99915209395808, 'loss_val': 0.06387323633427015, 'psi': 0.984050491803509}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.723121 cos_to_last_merge=0.8121 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=51 local utility u=0.020740 metrics={'f1_val': 0.9433033497923142, 'auprc': 0.9684575586308452, 'loss_val': 0.323207536271797, 'psi': 0.9533650333277266}-{'f1_val': 0.9391842671679683, 'auprc': 0.9677842422551304, 'loss_val': 0.337953522591364, 'psi': 0.9506242572028332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=51 head_norm_before_train=1.674765 cos_to_last_merge=0.7939 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.794
[S5] round=51 local utility u=0.002976 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9909483899391478, 'loss_val': 0.05637960422348714, 'psi': 0.9940909699612457}-{'f1_val': 0.996186023309311, 'auprc': 0.9909053863106496, 'loss_val': 0.06220162392189022, 'psi': 0.9940737685098464}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=51 head_norm_before_train=1.990891 (no previous merge yet)
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.6806099757730326, 'auprc': 0.9385571838055304, 'loss_val': 0.7435703477492008, 'psi': 0.7837888589860318}-{'f1_val': 0.8668878084013767, 'auprc': 0.9632361865892477, 'loss_val': 0.4301111279359044, 'psi': 0.9054271596765251}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.752644 (no previous merge yet)
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6121431365345498, 'auprc': 0.7947287590257601, 'loss_val': 0.7111194066838721, 'psi': 0.6851773855310339}-{'f1_val': 0.6116736743973911, 'auprc': 0.7948107809824088, 'loss_val': 0.6930782968393561, 'psi': 0.6849285170313981}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=1.587503 cos_to_last_merge=0.8483 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.848
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9857167178610293, 'auprc': 0.99865874892284, 'loss_val': 0.04637427176346208, 'psi': 0.9908935302857536}-{'f1_val': 0.9935326376274699, 'auprc': 0.9982529150537275, 'loss_val': 0.04127769769397134, 'psi': 0.9954207485979729}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=1.610264 cos_to_last_merge=0.8881 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.888
[S9] round=51 local utility u=0.001684 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9984100092890004, 'loss_val': 0.024743797830885393, 'psi': 0.9971289381710755}-{'f1_val': 0.9962710290637395, 'auprc': 0.9984112025924106, 'loss_val': 0.028092172230835103, 'psi': 0.9971270984752079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=51 head_norm_before_train=1.845970 cos_to_last_merge=0.9100 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=51 local utility u=0.001811 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9929099321744086, 'loss_val': 0.03335137021026487, 'psi': 0.9931022639018555}-{'f1_val': 0.992354394265095, 'auprc': 0.9946420840401033, 'loss_val': 0.036912430234554705, 'psi': 0.9932694701750984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=51 head_norm_before_train=1.833699 cos_to_last_merge=0.9108 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.911
[S11] round=51 local utility u=0.228685 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9978059124304033, 'loss_val': 0.02575774205826963, 'psi': 0.9966574676933098}-{'f1_val': 0.9509888295289037, 'auprc': 0.997736344066964, 'loss_val': 0.21350169757816667, 'psi': 0.9696878353441278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=51 head_norm_before_train=1.851693 (no previous merge yet)
[S13] round=51 local utility u=0.688542 metrics={'f1_val': 0.7645876558538793, 'auprc': 0.7495234133331086, 'loss_val': 0.6308474196909838, 'psi': 0.758561958845571}-{'f1_val': 0.6179761151278912, 'auprc': 0.6862158446342248, 'loss_val': 0.9383390109595031, 'psi': 0.6452720069304246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=51 head_norm_before_train=1.603901 cos_to_last_merge=0.9208 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.921
[S14] round=51 local utility u=0.000559 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986611737599516, 'loss_val': 0.02705939327095207, 'psi': 0.9974168084704308}-{'f1_val': 0.9965652232429598, 'auprc': 0.9986487160446029, 'loss_val': 0.028007125017700252, 'psi': 0.9973986203636171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=51 head_norm_before_train=1.578078 cos_to_last_merge=0.8933 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.8894499945423602, 'auprc': 0.916099287254905, 'loss_val': 0.3030003055743383, 'psi': 0.9001097116273781}-{'f1_val': 0.9974872712555476, 'auprc': 0.9982995495546043, 'loss_val': 0.03445863755175444, 'psi': 0.9978121825751702}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.709936 cos_to_last_merge=0.8441 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.844
[S16] round=51 local utility u=0.000380 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9965012152169714, 'loss_val': 0.03877938870791213, 'psi': 0.9936950214647384}-{'f1_val': 0.9918242256299163, 'auprc': 0.9963614673044794, 'loss_val': 0.03912098002353101, 'psi': 0.9936391222997416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=51 head_norm_before_train=1.914224 cos_to_last_merge=0.7573 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=51 local utility u=0.470498 metrics={'f1_val': 0.6634600975819426, 'auprc': 0.9144825736770937, 'loss_val': 0.9113524140736298, 'psi': 0.7638690880200031}-{'f1_val': 0.5824193874712464, 'auprc': 0.9142550742173216, 'loss_val': 1.365420792822448, 'psi': 0.7151536621696766}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=52 head_norm_before_train=2.056027 (no previous merge yet)
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.7118387825754944, 'auprc': 0.8485226953338209, 'loss_val': 0.7183196857355169, 'psi': 0.7665123476788249}-{'f1_val': 0.7107597966005115, 'auprc': 0.860015399970525, 'loss_val': 0.5881942371084719, 'psi': 0.770462037948517}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.198538 (no previous merge yet)
[S3] round=52 local utility u=0.114291 metrics={'f1_val': 0.9610844420559312, 'auprc': 0.9996428892840932, 'loss_val': 0.14013171507637875, 'psi': 0.976507820947196}-{'f1_val': 0.9348958752843897, 'auprc': 0.999759209066573, 'loss_val': 0.21193109251450215, 'psi': 0.960841208797263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=52 head_norm_before_train=1.729274 cos_to_last_merge=0.8112 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.811
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9493420274192662, 'auprc': 0.9449441139546344, 'loss_val': 0.3226583280976056, 'psi': 0.9475828620334135}-{'f1_val': 0.9433033497923142, 'auprc': 0.9684575586308452, 'loss_val': 0.323207536271797, 'psi': 0.9533650333277266}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.681803 cos_to_last_merge=0.7927 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.793
[S5] round=52 local utility u=0.009727 metrics={'f1_val': 0.996114022052857, 'auprc': 0.9965268803370235, 'loss_val': 0.053228803633739316, 'psi': 0.9962791653665236}-{'f1_val': 0.996186023309311, 'auprc': 0.9909483899391478, 'loss_val': 0.05637960422348714, 'psi': 0.9940909699612457}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=52 head_norm_before_train=1.997668 (no previous merge yet)
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.6273049214622417, 'auprc': 0.9293909773233664, 'loss_val': 0.8209806163744522, 'psi': 0.7481393438066917}-{'f1_val': 0.6806099757730326, 'auprc': 0.9385571838055304, 'loss_val': 0.7435703477492008, 'psi': 0.7837888589860318}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.762629 (no previous merge yet)
[S7] round=52 local utility u=0.114292 metrics={'f1_val': 0.6206129529324994, 'auprc': 0.8017375551653256, 'loss_val': 0.5543809438886154, 'psi': 0.69306279382563}-{'f1_val': 0.6121431365345498, 'auprc': 0.7947287590257601, 'loss_val': 0.7111194066838721, 'psi': 0.6851773855310339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=52 head_norm_before_train=1.597089 cos_to_last_merge=0.8472 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.847
[S8] round=52 local utility u=0.022968 metrics={'f1_val': 0.9917351758735767, 'auprc': 0.9988755809473684, 'loss_val': 0.03719935594988929, 'psi': 0.9945913379030934}-{'f1_val': 0.9857167178610293, 'auprc': 0.99865874892284, 'loss_val': 0.04637427176346208, 'psi': 0.9908935302857536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=52 head_norm_before_train=1.617965 cos_to_last_merge=0.8873 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.887
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9963993343708688, 'loss_val': 0.02381583763261924, 'psi': 0.9968214812556332}-{'f1_val': 0.9962748907591257, 'auprc': 0.9984100092890004, 'loss_val': 0.024743797830885393, 'psi': 0.9971289381710755}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=1.853108 cos_to_last_merge=0.9084 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=52 local utility u=0.001345 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9944087218637513, 'loss_val': 0.033842337134150545, 'psi': 0.9935703004519365}-{'f1_val': 0.9932304850534869, 'auprc': 0.9929099321744086, 'loss_val': 0.03335137021026487, 'psi': 0.9931022639018555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=52 head_norm_before_train=1.840520 cos_to_last_merge=0.9102 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=52 local utility u=0.000805 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9979961528504602, 'loss_val': 0.02471765763533955, 'psi': 0.9967335638613325}-{'f1_val': 0.9958918378685807, 'auprc': 0.9978059124304033, 'loss_val': 0.02575774205826963, 'psi': 0.9966574676933098}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=52 head_norm_before_train=1.855147 (no previous merge yet)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6924350550384599, 'auprc': 0.7177107232223833, 'loss_val': 0.7909105555552427, 'psi': 0.7025453223120293}-{'f1_val': 0.7645876558538793, 'auprc': 0.7495234133331086, 'loss_val': 0.6308474196909838, 'psi': 0.758561958845571}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=1.611751 cos_to_last_merge=0.9199 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.920
[S14] round=52 local utility u=0.000598 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986541733941205, 'loss_val': 0.025841434949182066, 'psi': 0.9974140083240984}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986611737599516, 'loss_val': 0.02705939327095207, 'psi': 0.9974168084704308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=52 head_norm_before_train=1.590514 cos_to_last_merge=0.8920 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.892
[S15] round=52 local utility u=0.575934 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9959319454879589, 'loss_val': 0.03440998535083431, 'psi': 0.9964207792276959}-{'f1_val': 0.8894499945423602, 'auprc': 0.916099287254905, 'loss_val': 0.3030003055743383, 'psi': 0.9001097116273781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=52 head_norm_before_train=1.717165 cos_to_last_merge=0.8430 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.843
[S16] round=52 local utility u=0.000191 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9965288207340719, 'loss_val': 0.03848049534476962, 'psi': 0.9937060636715785}-{'f1_val': 0.9918242256299163, 'auprc': 0.9965012152169714, 'loss_val': 0.03877938870791213, 'psi': 0.9936950214647384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=52 head_norm_before_train=1.924950 cos_to_last_merge=0.7569 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=52 local utility u=0.000000 metrics={'f1_val': 0.6142147685673448, 'auprc': 0.9420098012459175, 'loss_val': 1.2842789229919735, 'psi': 0.7453327816387739}-{'f1_val': 0.6634600975819426, 'auprc': 0.9144825736770937, 'loss_val': 0.9113524140736298, 'psi': 0.7638690880200031}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=2.067067 (no previous merge yet)
[S2] round=53 local utility u=0.000753 metrics={'f1_val': 0.7116909015367031, 'auprc': 0.8510650733174019, 'loss_val': 0.7235536047467717, 'psi': 0.7674405702489826}-{'f1_val': 0.7118387825754944, 'auprc': 0.8485226953338209, 'loss_val': 0.7183196857355169, 'psi': 0.7665123476788249}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=53 head_norm_before_train=2.203905 (no previous merge yet)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.9285482471549733, 'auprc': 0.9983078806266451, 'loss_val': 0.14777988764563485, 'psi': 0.956452100543642}-{'f1_val': 0.9610844420559312, 'auprc': 0.9996428892840932, 'loss_val': 0.14013171507637875, 'psi': 0.976507820947196}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.733841 cos_to_last_merge=0.8108 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.811
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9423052038709494, 'auprc': 0.9603304774867074, 'loss_val': 0.3310254965513718, 'psi': 0.9495153133172526}-{'f1_val': 0.9493420274192662, 'auprc': 0.9449441139546344, 'loss_val': 0.3226583280976056, 'psi': 0.9475828620334135}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=1.689186 cos_to_last_merge=0.7916 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.7969736540627501, 'auprc': 0.988488385679214, 'loss_val': 0.15245193238940372, 'psi': 0.8735795467093357}-{'f1_val': 0.996114022052857, 'auprc': 0.9965268803370235, 'loss_val': 0.053228803633739316, 'psi': 0.9962791653665236}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=2.005394 (no previous merge yet)
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.8711966626853791, 'auprc': 0.9705923366617721, 'loss_val': 0.2730409415076744, 'psi': 0.9109549322759363}-{'f1_val': 0.6273049214622417, 'auprc': 0.9293909773233664, 'loss_val': 0.8209806163744522, 'psi': 0.7481393438066917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=53 head_norm_before_train=1.771089 (no previous merge yet)
[S7] round=53 local utility u=0.072079 metrics={'f1_val': 0.6318112767898657, 'auprc': 0.8057642807078249, 'loss_val': 0.48949245348935133, 'psi': 0.7013924783570493}-{'f1_val': 0.6206129529324994, 'auprc': 0.8017375551653256, 'loss_val': 0.5543809438886154, 'psi': 0.69306279382563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=53 head_norm_before_train=1.605696 cos_to_last_merge=0.8460 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=53 local utility u=0.000000 metrics={'f1_val': 0.9923946006913721, 'auprc': 0.9958344826715543, 'loss_val': 0.04745821748833802, 'psi': 0.9937705534834449}-{'f1_val': 0.9917351758735767, 'auprc': 0.9988755809473684, 'loss_val': 0.03719935594988929, 'psi': 0.9945913379030934}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=53 head_norm_before_train=1.625451 cos_to_last_merge=0.8864 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.886
[S9] round=53 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9959875483702955, 'loss_val': 0.02368946902014538, 'psi': 0.9966567668554038}-{'f1_val': 0.9971029125121428, 'auprc': 0.9963993343708688, 'loss_val': 0.02381583763261924, 'psi': 0.9968214812556332}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=53 head_norm_before_train=1.857267 cos_to_last_merge=0.9072 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=53 local utility u=0.000361 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9945227758727875, 'loss_val': 0.03346195156829893, 'psi': 0.9936159220555509}-{'f1_val': 0.9930113528440598, 'auprc': 0.9944087218637513, 'loss_val': 0.033842337134150545, 'psi': 0.9935703004519365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=53 head_norm_before_train=1.846708 cos_to_last_merge=0.9096 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.910
[S11] round=53 local utility u=0.000984 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9979310117024525, 'loss_val': 0.024128796622400073, 'psi': 0.9968648895274282}-{'f1_val': 0.9958918378685807, 'auprc': 0.9979961528504602, 'loss_val': 0.02471765763533955, 'psi': 0.9967335638613325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=53 head_norm_before_train=1.861946 (no previous merge yet)
[S13] round=53 local utility u=0.000000 metrics={'f1_val': 0.6466779185940937, 'auprc': 0.7144217737754126, 'loss_val': 0.8502550991443074, 'psi': 0.6737754606666213}-{'f1_val': 0.6924350550384599, 'auprc': 0.7177107232223833, 'loss_val': 0.7909105555552427, 'psi': 0.7025453223120293}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=53 head_norm_before_train=1.619867 cos_to_last_merge=0.9192 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.919
[S14] round=53 local utility u=0.001699 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986483281262153, 'loss_val': 0.024754847801792653, 'psi': 0.997644631300752}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986541733941205, 'loss_val': 0.025841434949182066, 'psi': 0.9974140083240984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=53 head_norm_before_train=1.601302 cos_to_last_merge=0.8909 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.891
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9916657590419178, 'loss_val': 0.035349264582266164, 'psi': 0.9947143046492795}-{'f1_val': 0.9967466683875206, 'auprc': 0.9959319454879589, 'loss_val': 0.03440998535083431, 'psi': 0.9964207792276959}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=1.725709 cos_to_last_merge=0.8420 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.842
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9649507554215395, 'auprc': 0.9904289442701316, 'loss_val': 0.10830233543066974, 'psi': 0.9751420309609764}-{'f1_val': 0.9918242256299163, 'auprc': 0.9965288207340719, 'loss_val': 0.03848049534476962, 'psi': 0.9937060636715785}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.935415 cos_to_last_merge=0.7569 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=53 local utility u=0.168655 metrics={'f1_val': 0.6499079405415088, 'auprc': 0.875832532578952, 'loss_val': 0.9625960905397439, 'psi': 0.7402777773564861}-{'f1_val': 0.6142147685673448, 'auprc': 0.9420098012459175, 'loss_val': 1.2842789229919735, 'psi': 0.7453327816387739}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=54 head_norm_before_train=2.077856 (no previous merge yet)
[S2] round=54 local utility u=0.106593 metrics={'f1_val': 0.7192866189528186, 'auprc': 0.8613337998267796, 'loss_val': 0.5867473024411214, 'psi': 0.776105491302403}-{'f1_val': 0.7116909015367031, 'auprc': 0.8510650733174019, 'loss_val': 0.7235536047467717, 'psi': 0.7674405702489826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=54 head_norm_before_train=2.208994 (no previous merge yet)
[S3] round=54 local utility u=0.000000 metrics={'f1_val': 0.9116833462149403, 'auprc': 0.9977276284350091, 'loss_val': 0.17903402876873453, 'psi': 0.9461010591029677}-{'f1_val': 0.9285482471549733, 'auprc': 0.9983078806266451, 'loss_val': 0.14777988764563485, 'psi': 0.956452100543642}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=54 head_norm_before_train=1.738626 cos_to_last_merge=0.8102 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.810
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9400141151636664, 'auprc': 0.9662174652133048, 'loss_val': 0.3365221085228782, 'psi': 0.9504954551835217}-{'f1_val': 0.9423052038709494, 'auprc': 0.9603304774867074, 'loss_val': 0.3310254965513718, 'psi': 0.9495153133172526}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.694840 cos_to_last_merge=0.7908 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.791
[S5] round=54 local utility u=0.659605 metrics={'f1_val': 0.996114022052857, 'auprc': 0.996594183181861, 'loss_val': 0.05240103157041013, 'psi': 0.9963060865044586}-{'f1_val': 0.7969736540627501, 'auprc': 0.988488385679214, 'loss_val': 0.15245193238940372, 'psi': 0.8735795467093357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=54 head_norm_before_train=2.015698 (no previous merge yet)
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.7763102562075571, 'auprc': 0.9564963435228391, 'loss_val': 0.5417217282556789, 'psi': 0.8483846911336699}-{'f1_val': 0.8711966626853791, 'auprc': 0.9705923366617721, 'loss_val': 0.2730409415076744, 'psi': 0.9109549322759363}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.777291 (no previous merge yet)
[S7] round=54 local utility u=0.000000 metrics={'f1_val': 0.6283610642819341, 'auprc': 0.802350141042373, 'loss_val': 0.6031329479821447, 'psi': 0.6979566949861096}-{'f1_val': 0.6318112767898657, 'auprc': 0.8057642807078249, 'loss_val': 0.48949245348935133, 'psi': 0.7013924783570493}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=54 head_norm_before_train=1.610417 cos_to_last_merge=0.8459 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=54 local utility u=0.007655 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9984935197983231, 'loss_val': 0.03662403632820596, 'psi': 0.9944839886170351}-{'f1_val': 0.9923946006913721, 'auprc': 0.9958344826715543, 'loss_val': 0.04745821748833802, 'psi': 0.9937705534834449}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=54 head_norm_before_train=1.633184 cos_to_last_merge=0.8855 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.885
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952357743428697, 'loss_val': 0.02298193784387362, 'psi': 0.9963560572444335}-{'f1_val': 0.9971029125121428, 'auprc': 0.9959875483702955, 'loss_val': 0.02368946902014538, 'psi': 0.9966567668554038}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.864012 cos_to_last_merge=0.9065 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=54 local utility u=0.000170 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9928595604900746, 'loss_val': 0.03207768367525664, 'psi': 0.9933452063080906}-{'f1_val': 0.9930113528440598, 'auprc': 0.9945227758727875, 'loss_val': 0.03346195156829893, 'psi': 0.9936159220555509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S10] sending update (kind=head size=1807 to 1 peers)
[S11] START round=54 head_norm_before_train=1.850514 cos_to_last_merge=0.9090 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=54 local utility u=0.000086 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978862622833312, 'loss_val': 0.02382340027865665, 'psi': 0.9968469897597797}-{'f1_val': 0.9961541414107454, 'auprc': 0.9979310117024525, 'loss_val': 0.024128796622400073, 'psi': 0.9968648895274282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=54 head_norm_before_train=1.872555 (no previous merge yet)
[S13] round=54 local utility u=0.251485 metrics={'f1_val': 0.6950933224000428, 'auprc': 0.7713154990094004, 'loss_val': 0.808459560250662, 'psi': 0.7255821930437859}-{'f1_val': 0.6466779185940937, 'auprc': 0.7144217737754126, 'loss_val': 0.8502550991443074, 'psi': 0.6737754606666213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=54 head_norm_before_train=1.627884 cos_to_last_merge=0.9188 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.919
[S14] round=54 local utility u=0.000264 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.998647603486527, 'loss_val': 0.024223927568798112, 'psi': 0.9976443414448767}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986483281262153, 'loss_val': 0.024754847801792653, 'psi': 0.997644631300752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=54 head_norm_before_train=1.609181 cos_to_last_merge=0.8902 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.890
[S15] round=54 local utility u=0.000000 metrics={'f1_val': 0.9015999056608139, 'auprc': 0.9811513369573501, 'loss_val': 0.25121355873822604, 'psi': 0.9334204781794284}-{'f1_val': 0.9967466683875206, 'auprc': 0.9916657590419178, 'loss_val': 0.035349264582266164, 'psi': 0.9947143046492795}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=54 head_norm_before_train=1.734738 cos_to_last_merge=0.8411 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.841
[S16] round=54 local utility u=0.114182 metrics={'f1_val': 0.9916349822409676, 'auprc': 0.9915890696594255, 'loss_val': 0.04352495387785516, 'psi': 0.9916166172083507}-{'f1_val': 0.9649507554215395, 'auprc': 0.9904289442701316, 'loss_val': 0.10830233543066974, 'psi': 0.9751420309609764}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=54 head_norm_before_train=1.947228 cos_to_last_merge=0.7566 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.757
[S17] round=54 local utility u=0.000000 metrics={'f1_val': 0.5507475451909021, 'auprc': 0.7740486491271171, 'loss_val': 1.6315490741625158, 'psi': 0.6400679867653881}-{'f1_val': 0.6499079405415088, 'auprc': 0.875832532578952, 'loss_val': 0.9625960905397439, 'psi': 0.7402777773564861}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=55 head_norm_before_train=2.088709 (no previous merge yet)
[S2] round=55 local utility u=0.018148 metrics={'f1_val': 0.7212198406422574, 'auprc': 0.8631349095076922, 'loss_val': 0.5674538030749682, 'psi': 0.7779858681884313}-{'f1_val': 0.7192866189528186, 'auprc': 0.8613337998267796, 'loss_val': 0.5867473024411214, 'psi': 0.776105491302403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=55 head_norm_before_train=2.215423 (no previous merge yet)
[S3] round=55 local utility u=0.302384 metrics={'f1_val': 0.9915903889157899, 'auprc': 0.9987544876125677, 'loss_val': 0.05678797518104666, 'psi': 0.994456028394501}-{'f1_val': 0.9116833462149403, 'auprc': 0.9977276284350091, 'loss_val': 0.17903402876873453, 'psi': 0.9461010591029677}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=55 head_norm_before_train=1.744452 cos_to_last_merge=0.8094 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.809
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9397818076169813, 'auprc': 0.9673601800535266, 'loss_val': 0.3386104699018639, 'psi': 0.9508131565915994}-{'f1_val': 0.9400141151636664, 'auprc': 0.9662174652133048, 'loss_val': 0.3365221085228782, 'psi': 0.9504954551835217}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.701323 cos_to_last_merge=0.7901 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=55 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.98975012540148, 'loss_val': 0.07947087451046143, 'psi': 0.9935241796994244}-{'f1_val': 0.996114022052857, 'auprc': 0.996594183181861, 'loss_val': 0.05240103157041013, 'psi': 0.9963060865044586}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=55 head_norm_before_train=2.022784 (no previous merge yet)
[S6] round=55 local utility u=0.000000 metrics={'f1_val': 0.7667763172891804, 'auprc': 0.9455242706906182, 'loss_val': 0.5741214099353467, 'psi': 0.8382754986497555}-{'f1_val': 0.7763102562075571, 'auprc': 0.9564963435228391, 'loss_val': 0.5417217282556789, 'psi': 0.8483846911336699}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=55 head_norm_before_train=1.782494 (no previous merge yet)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.6263797419208196, 'auprc': 0.8018993830194012, 'loss_val': 0.5982444853833527, 'psi': 0.6965875983602523}-{'f1_val': 0.6283610642819341, 'auprc': 0.802350141042373, 'loss_val': 0.6031329479821447, 'psi': 0.6979566949861096}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.615980 cos_to_last_merge=0.8455 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.846
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9749558475859136, 'auprc': 0.9955281546448285, 'loss_val': 0.06226795086716497, 'psi': 0.9831847704094796}-{'f1_val': 0.9918109678295097, 'auprc': 0.9984935197983231, 'loss_val': 0.03662403632820596, 'psi': 0.9944839886170351}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=1.642281 cos_to_last_merge=0.8844 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.884
[S9] round=55 local utility u=0.003160 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9980439937717795, 'loss_val': 0.022604923707928985, 'psi': 0.997231086487415}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952357743428697, 'loss_val': 0.02298193784387362, 'psi': 0.9963560572444335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=55 head_norm_before_train=1.872170 cos_to_last_merge=0.9058 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=55 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9944095300409816, 'loss_val': 0.03320204863951813, 'psi': 0.9935706237228286}-{'f1_val': 0.9936689701867679, 'auprc': 0.9928595604900746, 'loss_val': 0.03207768367525664, 'psi': 0.9933452063080906}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=55 head_norm_before_train=1.855972 cos_to_last_merge=0.9085 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=55 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9978308402611401, 'loss_val': 0.023737926588904, 'psi': 0.9968248209509033}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978862622833312, 'loss_val': 0.02382340027865665, 'psi': 0.9968469897597797}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=55 head_norm_before_train=1.884550 (no previous merge yet)
[S13] round=55 local utility u=0.045276 metrics={'f1_val': 0.7307754619710264, 'auprc': 0.7320226620597311, 'loss_val': 0.8141220673053328, 'psi': 0.7312743420065082}-{'f1_val': 0.6950933224000428, 'auprc': 0.7713154990094004, 'loss_val': 0.808459560250662, 'psi': 0.7255821930437859}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=55 head_norm_before_train=1.636374 cos_to_last_merge=0.9182 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.918
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9971432857297993, 'auprc': 0.9969338502928483, 'loss_val': 0.025130351091827666, 'psi': 0.9970595115550189}-{'f1_val': 0.9969755000837764, 'auprc': 0.998647603486527, 'loss_val': 0.024223927568798112, 'psi': 0.9976443414448767}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.616347 cos_to_last_merge=0.8894 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.889
[S15] round=55 local utility u=0.082865 metrics={'f1_val': 0.9075278105822634, 'auprc': 0.9895776541927706, 'loss_val': 0.1463293712555694, 'psi': 0.9403477480264663}-{'f1_val': 0.9015999056608139, 'auprc': 0.9811513369573501, 'loss_val': 0.25121355873822604, 'psi': 0.9334204781794284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=55 head_norm_before_train=1.744070 cos_to_last_merge=0.8402 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.840
[S16] round=55 local utility u=0.007877 metrics={'f1_val': 0.9922938586518524, 'auprc': 0.9939567265023311, 'loss_val': 0.03882759129430521, 'psi': 0.9929590057920439}-{'f1_val': 0.9916349822409676, 'auprc': 0.9915890696594255, 'loss_val': 0.04352495387785516, 'psi': 0.9916166172083507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=55 head_norm_before_train=1.959072 cos_to_last_merge=0.7564 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=55 local utility u=0.938952 metrics={'f1_val': 0.7027167643794788, 'auprc': 0.8811713124303429, 'loss_val': 0.9868284397816143, 'psi': 0.7740985835998244}-{'f1_val': 0.5507475451909021, 'auprc': 0.7740486491271171, 'loss_val': 1.6315490741625158, 'psi': 0.6400679867653881}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=56 head_norm_before_train=2.090198 (no previous merge yet)
[S2] round=56 local utility u=0.014057 metrics={'f1_val': 0.7218153524906268, 'auprc': 0.8661608324068305, 'loss_val': 0.5519910433342778, 'psi': 0.7795535444571082}-{'f1_val': 0.7212198406422574, 'auprc': 0.8631349095076922, 'loss_val': 0.5674538030749682, 'psi': 0.7779858681884313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=56 head_norm_before_train=2.222066 (no previous merge yet)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.949325095333508, 'auprc': 0.9971513217602358, 'loss_val': 0.19972372088866694, 'psi': 0.968455585904199}-{'f1_val': 0.9915903889157899, 'auprc': 0.9987544876125677, 'loss_val': 0.05678797518104666, 'psi': 0.994456028394501}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.754438 cos_to_last_merge=0.8075 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=56 local utility u=0.000762 metrics={'f1_val': 0.9411423177063286, 'auprc': 0.9633685091014206, 'loss_val': 0.3332754220301765, 'psi': 0.9500327942643654}-{'f1_val': 0.9397818076169813, 'auprc': 0.9673601800535266, 'loss_val': 0.3386104699018639, 'psi': 0.9508131565915994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=56 head_norm_before_train=1.704736 cos_to_last_merge=0.7897 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=56 local utility u=0.030515 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9972020248716988, 'loss_val': 0.04255159758363518, 'psi': 0.9966803645419738}-{'f1_val': 0.9960402158980539, 'auprc': 0.98975012540148, 'loss_val': 0.07947087451046143, 'psi': 0.9935241796994244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=56 head_norm_before_train=2.029715 (no previous merge yet)
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.6512414147134027, 'auprc': 0.9354892721833789, 'loss_val': 0.988397076860479, 'psi': 0.7649405577013932}-{'f1_val': 0.7667763172891804, 'auprc': 0.9455242706906182, 'loss_val': 0.5741214099353467, 'psi': 0.8382754986497555}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.787743 (no previous merge yet)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.5560058642912049, 'auprc': 0.7860876803553599, 'loss_val': 0.9318670191926166, 'psi': 0.6480385907168669}-{'f1_val': 0.6263797419208196, 'auprc': 0.8018993830194012, 'loss_val': 0.5982444853833527, 'psi': 0.6965875983602523}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.623496 cos_to_last_merge=0.8445 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.845
[S8] round=56 local utility u=0.073213 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9988804684460608, 'loss_val': 0.0395698825581543, 'psi': 0.9958927805635331}-{'f1_val': 0.9749558475859136, 'auprc': 0.9955281546448285, 'loss_val': 0.06226795086716497, 'psi': 0.9831847704094796}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=56 head_norm_before_train=1.650263 cos_to_last_merge=0.8835 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.998776452729451, 'loss_val': 0.024691812967913847, 'psi': 0.9971230022780928}-{'f1_val': 0.9966891482978385, 'auprc': 0.9980439937717795, 'loss_val': 0.022604923707928985, 'psi': 0.997231086487415}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.880918 cos_to_last_merge=0.9052 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9929506385230868, 'loss_val': 0.03302142065716459, 'psi': 0.9929870671156706}-{'f1_val': 0.9930113528440598, 'auprc': 0.9944095300409816, 'loss_val': 0.03320204863951813, 'psi': 0.9935706237228286}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=1.863350 cos_to_last_merge=0.9078 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.908
[S11] round=56 local utility u=0.000623 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980284434309892, 'loss_val': 0.02308538016427274, 'psi': 0.9969038622188429}-{'f1_val': 0.9961541414107454, 'auprc': 0.9978308402611401, 'loss_val': 0.023737926588904, 'psi': 0.9968248209509033}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=56 head_norm_before_train=1.894516 (no previous merge yet)
[S13] round=56 local utility u=0.012983 metrics={'f1_val': 0.7338278673702908, 'auprc': 0.7414959385132602, 'loss_val': 0.8348901314606452, 'psi': 0.7368950958274786}-{'f1_val': 0.7307754619710264, 'auprc': 0.7320226620597311, 'loss_val': 0.8141220673053328, 'psi': 0.7312743420065082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=56 head_norm_before_train=1.642768 cos_to_last_merge=0.9175 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.917
[S14] round=56 local utility u=0.000062 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9986460679587992, 'loss_val': 0.02534887755275651, 'psi': 0.9972649802475895}-{'f1_val': 0.9971432857297993, 'auprc': 0.9969338502928483, 'loss_val': 0.025130351091827666, 'psi': 0.9970595115550189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=56 head_norm_before_train=1.624323 cos_to_last_merge=0.8886 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.889
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9010457098677005, 'auprc': 0.9704067551108341, 'loss_val': 0.26482533306606326, 'psi': 0.928790127964954}-{'f1_val': 0.9075278105822634, 'auprc': 0.9895776541927706, 'loss_val': 0.1463293712555694, 'psi': 0.9403477480264663}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.750219 cos_to_last_merge=0.8394 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=56 local utility u=0.003023 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9963028759557331, 'loss_val': 0.03819511059186207, 'psi': 0.9937350412949193}-{'f1_val': 0.9922938586518524, 'auprc': 0.9939567265023311, 'loss_val': 0.03882759129430521, 'psi': 0.9929590057920439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=56 head_norm_before_train=1.970776 cos_to_last_merge=0.7559 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.5631095748608924, 'auprc': 0.8548335550288414, 'loss_val': 1.665883097431006, 'psi': 0.6797991669280721}-{'f1_val': 0.7027167643794788, 'auprc': 0.8811713124303429, 'loss_val': 0.9868284397816143, 'psi': 0.7740985835998244}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=57 head_norm_before_train=2.095938 (no previous merge yet)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.7115719637246632, 'auprc': 0.8714422958738172, 'loss_val': 0.6950764838489122, 'psi': 0.7755200965843247}-{'f1_val': 0.7218153524906268, 'auprc': 0.8661608324068305, 'loss_val': 0.5519910433342778, 'psi': 0.7795535444571082}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=57 head_norm_before_train=2.227764 (no previous merge yet)
[S3] round=57 local utility u=0.000000 metrics={'f1_val': 0.7878289131853581, 'auprc': 0.9789712605447829, 'loss_val': 0.4869300488110417, 'psi': 0.864285852129128}-{'f1_val': 0.949325095333508, 'auprc': 0.9971513217602358, 'loss_val': 0.19972372088866694, 'psi': 0.968455585904199}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=57 head_norm_before_train=1.762791 cos_to_last_merge=0.8059 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.806
[S4] round=57 local utility u=0.003884 metrics={'f1_val': 0.9429026873307818, 'auprc': 0.9605718753491788, 'loss_val': 0.32767916147013165, 'psi': 0.9499703625381405}-{'f1_val': 0.9411423177063286, 'auprc': 0.9633685091014206, 'loss_val': 0.3332754220301765, 'psi': 0.9500327942643654}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=57 head_norm_before_train=1.709692 cos_to_last_merge=0.7890 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.789
[S5] round=57 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9937272847141339, 'loss_val': 0.042212480710979446, 'psi': 0.9952025278712402}-{'f1_val': 0.9963325909888239, 'auprc': 0.9972020248716988, 'loss_val': 0.04255159758363518, 'psi': 0.9966803645419738}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=57 head_norm_before_train=2.034884 (no previous merge yet)
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.8711556566386831, 'auprc': 0.9692173859830916, 'loss_val': 0.24894665349523665, 'psi': 0.9103803483764464}-{'f1_val': 0.6512414147134027, 'auprc': 0.9354892721833789, 'loss_val': 0.988397076860479, 'psi': 0.7649405577013932}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=57 head_norm_before_train=1.793523 (no previous merge yet)
[S7] round=57 local utility u=0.677299 metrics={'f1_val': 0.66632617868871, 'auprc': 0.8283137864824112, 'loss_val': 0.36586910174274745, 'psi': 0.7311212218061904}-{'f1_val': 0.5560058642912049, 'auprc': 0.7860876803553599, 'loss_val': 0.9318670191926166, 'psi': 0.6480385907168669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=57 head_norm_before_train=1.627472 cos_to_last_merge=0.8443 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=57 local utility u=0.004164 metrics={'f1_val': 0.9940863284942748, 'auprc': 0.9989939978809874, 'loss_val': 0.03269521542527994, 'psi': 0.9960493962489598}-{'f1_val': 0.9939009886418481, 'auprc': 0.9988804684460608, 'loss_val': 0.0395698825581543, 'psi': 0.9958927805635331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=57 head_norm_before_train=1.657280 cos_to_last_merge=0.8827 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.883
[S9] round=57 local utility u=0.000050 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9987785441211336, 'loss_val': 0.02459810671086764, 'psi': 0.9971238388347659}-{'f1_val': 0.9960207019771873, 'auprc': 0.998776452729451, 'loss_val': 0.024691812967913847, 'psi': 0.9971230022780928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=57 head_norm_before_train=1.890021 cos_to_last_merge=0.9043 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=57 local utility u=0.000174 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9929180059996531, 'loss_val': 0.03257514107165148, 'psi': 0.9929740141062972}-{'f1_val': 0.9930113528440598, 'auprc': 0.9929506385230868, 'loss_val': 0.03302142065716459, 'psi': 0.9929870671156706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=57 head_norm_before_train=1.871866 cos_to_last_merge=0.9071 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.907
[S11] round=57 local utility u=0.000165 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9980954095720624, 'loss_val': 0.022955828675044698, 'psi': 0.9969306486752723}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980284434309892, 'loss_val': 0.02308538016427274, 'psi': 0.9969038622188429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] START round=57 head_norm_before_train=1.904354 (no previous merge yet)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6884378469437435, 'auprc': 0.6711030956998758, 'loss_val': 1.1212904788087539, 'psi': 0.6815039464461965}-{'f1_val': 0.7338278673702908, 'auprc': 0.7414959385132602, 'loss_val': 0.8348901314606452, 'psi': 0.7368950958274786}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=1.649333 cos_to_last_merge=0.9168 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.917
[S14] round=57 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9969491090972227, 'loss_val': 0.026159873469003052, 'psi': 0.9965861967029589}-{'f1_val': 0.9963442551067831, 'auprc': 0.9986460679587992, 'loss_val': 0.02534887755275651, 'psi': 0.9972649802475895}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=57 head_norm_before_train=1.632919 cos_to_last_merge=0.8877 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.888
[S15] round=57 local utility u=0.449186 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9978426933594193, 'loss_val': 0.025191258159703616, 'psi': 0.9974074294606279}-{'f1_val': 0.9010457098677005, 'auprc': 0.9704067551108341, 'loss_val': 0.26482533306606326, 'psi': 0.928790127964954}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=57 head_norm_before_train=1.756145 cos_to_last_merge=0.8386 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9963691897413015, 'loss_val': 0.03785963518876931, 'psi': 0.9936422112744704}-{'f1_val': 0.9920231515210434, 'auprc': 0.9963028759557331, 'loss_val': 0.03819511059186207, 'psi': 0.9937350412949193}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.980960 cos_to_last_merge=0.7556 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.756
[S17] round=57 local utility u=0.510341 metrics={'f1_val': 0.6367561368538596, 'auprc': 0.8780118074797185, 'loss_val': 1.1566148260032902, 'psi': 0.7332584051042031}-{'f1_val': 0.5631095748608924, 'auprc': 0.8548335550288414, 'loss_val': 1.665883097431006, 'psi': 0.6797991669280721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=58 head_norm_before_train=2.100508 (no previous merge yet)
[S2] round=58 local utility u=0.112449 metrics={'f1_val': 0.712350608219512, 'auprc': 0.902507408976245, 'loss_val': 0.5680454317653343, 'psi': 0.7884133285222052}-{'f1_val': 0.7115719637246632, 'auprc': 0.8714422958738172, 'loss_val': 0.6950764838489122, 'psi': 0.7755200965843247}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=58 head_norm_before_train=2.234057 (no previous merge yet)
[S3] round=58 local utility u=0.543814 metrics={'f1_val': 0.9098215701472295, 'auprc': 0.9984998667137435, 'loss_val': 0.18984375113675986, 'psi': 0.9452928887738351}-{'f1_val': 0.7878289131853581, 'auprc': 0.9789712605447829, 'loss_val': 0.4869300488110417, 'psi': 0.864285852129128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=58 head_norm_before_train=1.769439 cos_to_last_merge=0.8046 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.805
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9450191375026737, 'auprc': 0.9357834883143322, 'loss_val': 0.335079984375399, 'psi': 0.9413248778273372}-{'f1_val': 0.9429026873307818, 'auprc': 0.9605718753491788, 'loss_val': 0.32767916147013165, 'psi': 0.9499703625381405}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.714887 cos_to_last_merge=0.7881 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.7145680792825414, 'auprc': 0.9887270188709475, 'loss_val': 0.40099240458436897, 'psi': 0.8242316551179039}-{'f1_val': 0.996186023309311, 'auprc': 0.9937272847141339, 'loss_val': 0.042212480710979446, 'psi': 0.9952025278712402}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=2.039541 (no previous merge yet)
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.8400588751338736, 'auprc': 0.9576330370337736, 'loss_val': 0.4617412140643746, 'psi': 0.8870885398938335}-{'f1_val': 0.8711556566386831, 'auprc': 0.9692173859830916, 'loss_val': 0.24894665349523665, 'psi': 0.9103803483764464}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.800557 (no previous merge yet)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.5918398909587469, 'auprc': 0.7940073422456574, 'loss_val': 0.7501599720483307, 'psi': 0.6727068714735112}-{'f1_val': 0.66632617868871, 'auprc': 0.8283137864824112, 'loss_val': 0.36586910174274745, 'psi': 0.7311212218061904}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.631566 cos_to_last_merge=0.8442 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.7490586031876569, 'auprc': 0.9859169285303939, 'loss_val': 0.23876527165217376, 'psi': 0.8438019333247517}-{'f1_val': 0.9940863284942748, 'auprc': 0.9989939978809874, 'loss_val': 0.03269521542527994, 'psi': 0.9960493962489598}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=1.665008 cos_to_last_merge=0.8818 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.882
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9987710653474658, 'loss_val': 0.03503779532459877, 'psi': 0.9941108288111997}-{'f1_val': 0.9960207019771873, 'auprc': 0.9987785441211336, 'loss_val': 0.02459810671086764, 'psi': 0.9971238388347659}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.893564 cos_to_last_merge=0.9030 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.903
[S10] round=58 local utility u=0.001495 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9946558846677479, 'loss_val': 0.033483776308744696, 'psi': 0.9935377301653201}-{'f1_val': 0.9930113528440598, 'auprc': 0.9929180059996531, 'loss_val': 0.03257514107165148, 'psi': 0.9929740141062972}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=58 head_norm_before_train=1.879329 cos_to_last_merge=0.9064 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=58 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9978403488765275, 'loss_val': 0.027008382922957184, 'psi': 0.9966835218263979}-{'f1_val': 0.9961541414107454, 'auprc': 0.9980954095720624, 'loss_val': 0.022955828675044698, 'psi': 0.9969306486752723}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=58 head_norm_before_train=1.912186 (no previous merge yet)
[S13] round=58 local utility u=0.283537 metrics={'f1_val': 0.7308151192393867, 'auprc': 0.7062647892408886, 'loss_val': 0.9139658145247603, 'psi': 0.7209949872399875}-{'f1_val': 0.6884378469437435, 'auprc': 0.6711030956998758, 'loss_val': 1.1212904788087539, 'psi': 0.6815039464461965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=58 head_norm_before_train=1.655370 cos_to_last_merge=0.9163 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.916
[S14] round=58 local utility u=0.002436 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9986455196593618, 'loss_val': 0.026376735836513617, 'psi': 0.9972647609278146}-{'f1_val': 0.9963442551067831, 'auprc': 0.9969491090972227, 'loss_val': 0.026159873469003052, 'psi': 0.9965861967029589}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=58 head_norm_before_train=1.641762 cos_to_last_merge=0.8870 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.887
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9937297109356377, 'loss_val': 0.2443553419683662, 'psi': 0.9391493284471748}-{'f1_val': 0.9971172535281002, 'auprc': 0.9978426933594193, 'loss_val': 0.025191258159703616, 'psi': 0.9974074294606279}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.763441 cos_to_last_merge=0.8378 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.838
[S16] round=58 local utility u=0.000019 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9963708935508391, 'loss_val': 0.0378266464714358, 'psi': 0.9936428927982854}-{'f1_val': 0.9918242256299163, 'auprc': 0.9963691897413015, 'loss_val': 0.03785963518876931, 'psi': 0.9936422112744704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=58 head_norm_before_train=1.992986 cos_to_last_merge=0.7551 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6138465632637363, 'auprc': 0.8391886984193322, 'loss_val': 1.3831619314421157, 'psi': 0.7039834173259747}-{'f1_val': 0.6367561368538596, 'auprc': 0.8780118074797185, 'loss_val': 1.1566148260032902, 'psi': 0.7332584051042031}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=2.102597 (no previous merge yet)
[S2] round=59 local utility u=0.007407 metrics={'f1_val': 0.709886229687553, 'auprc': 0.9152748211680231, 'loss_val': 0.5767475990357778, 'psi': 0.792041666279741}-{'f1_val': 0.712350608219512, 'auprc': 0.902507408976245, 'loss_val': 0.5680454317653343, 'psi': 0.7884133285222052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S2] r=60 psi=0.792 u=0.0074 p_local=0.0528 f1=0.710 auprc=0.915 bytes=68339
[S3] START round=59 head_norm_before_train=2.239618 (no previous merge yet)
[S3] round=59 local utility u=0.047525 metrics={'f1_val': 0.9322238418813434, 'auprc': 0.9919939246091918, 'loss_val': 0.20968952855810832, 'psi': 0.9561318749724828}-{'f1_val': 0.9098215701472295, 'auprc': 0.9984998667137435, 'loss_val': 0.18984375113675986, 'psi': 0.9452928887738351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S3] r=60 psi=0.956 u=0.0475 p_local=0.1328 f1=0.932 auprc=0.992 bytes=64808
[S4] START round=59 head_norm_before_train=1.775473 cos_to_last_merge=0.8036 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=59 local utility u=0.034707 metrics={'f1_val': 0.9467994792668728, 'auprc': 0.952768012128861, 'loss_val': 0.32730203141406217, 'psi': 0.949186892411668}-{'f1_val': 0.9450191375026737, 'auprc': 0.9357834883143322, 'loss_val': 0.335079984375399, 'psi': 0.9413248778273372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=60 psi=0.949 u=0.0347 p_local=0.0099 f1=0.947 auprc=0.953 bytes=55746
[S5] START round=59 head_norm_before_train=1.723026 cos_to_last_merge=0.7867 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.787
[S5] round=59 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9970772601703051, 'loss_val': 0.0405796151544262, 'psi': 0.9966304586614163}-{'f1_val': 0.7145680792825414, 'auprc': 0.9887270188709475, 'loss_val': 0.40099240458436897, 'psi': 0.8242316551179039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S5] r=60 psi=0.997 u=1.0000 p_local=0.2795 f1=0.996 auprc=0.997 bytes=68281
[S6] START round=59 head_norm_before_train=2.045663 (no previous merge yet)
[S6] round=59 local utility u=0.000000 metrics={'f1_val': 0.681993587759117, 'auprc': 0.9212619882504787, 'loss_val': 0.8015706535028981, 'psi': 0.7777009479556617}-{'f1_val': 0.8400588751338736, 'auprc': 0.9576330370337736, 'loss_val': 0.4617412140643746, 'psi': 0.8870885398938335}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=60 psi=0.778 u=0.0000 p_local=0.2356 f1=0.682 auprc=0.921 bytes=55739
[S7] START round=59 head_norm_before_train=1.807791 (no previous merge yet)
[S7] round=59 local utility u=0.130251 metrics={'f1_val': 0.6181474172658259, 'auprc': 0.7974385149537752, 'loss_val': 0.6577958077247141, 'psi': 0.6898638563410056}-{'f1_val': 0.5918398909587469, 'auprc': 0.7940073422456574, 'loss_val': 0.7501599720483307, 'psi': 0.6727068714735112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S7] r=60 psi=0.690 u=0.1303 p_local=0.1365 f1=0.618 auprc=0.797 bytes=57572
[S8] START round=59 head_norm_before_train=1.635199 cos_to_last_merge=0.8441 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=59 local utility u=0.799822 metrics={'f1_val': 0.9790487355341038, 'auprc': 0.9988219266782713, 'loss_val': 0.05777722837703707, 'psi': 0.9869580119917708}-{'f1_val': 0.7490586031876569, 'auprc': 0.9859169285303939, 'loss_val': 0.23876527165217376, 'psi': 0.8438019333247517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S8] r=60 psi=0.987 u=0.7998 p_local=0.1765 f1=0.979 auprc=0.999 bytes=62906
[S9] START round=59 head_norm_before_train=1.672465 cos_to_last_merge=0.8811 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.881
[S9] round=59 local utility u=0.022897 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9972778417236371, 'loss_val': 0.021357527353719256, 'psi': 0.9971728841967405}-{'f1_val': 0.9910040044536889, 'auprc': 0.9987710653474658, 'loss_val': 0.03503779532459877, 'psi': 0.9941108288111997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=60 psi=0.997 u=0.0229 p_local=0.0056 f1=0.997 auprc=0.997 bytes=62858
[S10] START round=59 head_norm_before_train=1.899635 cos_to_last_merge=0.9019 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.902
[S10] round=59 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9928642903420182, 'loss_val': 0.03248121126774703, 'psi': 0.9929525278432432}-{'f1_val': 0.9927922938303682, 'auprc': 0.9946558846677479, 'loss_val': 0.033483776308744696, 'psi': 0.9935377301653201}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=60 psi=0.993 u=0.0000 p_local=0.0006 f1=0.993 auprc=0.993 bytes=71930
[S11] START round=59 head_norm_before_train=1.881631 cos_to_last_merge=0.9057 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.906
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9941942077612611, 'auprc': 0.9967372184119907, 'loss_val': 0.08920461220630638, 'psi': 0.9952114120215529}-{'f1_val': 0.9959123037929781, 'auprc': 0.9978403488765275, 'loss_val': 0.027008382922957184, 'psi': 0.9966835218263979}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.995 u=0.0000 p_local=0.0082 f1=0.994 auprc=0.997 bytes=73709
[S13] START round=59 head_norm_before_train=1.916373 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6606970263328715, 'auprc': 0.681368005218106, 'loss_val': 0.8536607031235763, 'psi': 0.6689654178869653}-{'f1_val': 0.7308151192393867, 'auprc': 0.7062647892408886, 'loss_val': 0.9139658145247603, 'psi': 0.7209949872399875}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.669 u=0.0000 p_local=0.1010 f1=0.661 auprc=0.681 bytes=59460
[S14] START round=59 head_norm_before_train=1.662375 cos_to_last_merge=0.9159 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.916
[S14] round=59 local utility u=0.001974 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986489460897224, 'loss_val': 0.023896167222106017, 'psi': 0.9974119174023391}-{'f1_val': 0.9963442551067831, 'auprc': 0.9986455196593618, 'loss_val': 0.026376735836513617, 'psi': 0.9972647609278146}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S14] r=60 psi=0.997 u=0.0020 p_local=0.0014 f1=0.997 auprc=0.999 bytes=80786
[S15] START round=59 head_norm_before_train=1.651584 cos_to_last_merge=0.8862 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.886
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.9011925060467738, 'auprc': 0.980289755269105, 'loss_val': 0.273242517719616, 'psi': 0.9328314057357063}-{'f1_val': 0.9027624067881995, 'auprc': 0.9937297109356377, 'loss_val': 0.2443553419683662, 'psi': 0.9391493284471748}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.933 u=0.0000 p_local=0.1218 f1=0.901 auprc=0.980 bytes=62904
[S16] START round=59 head_norm_before_train=1.771487 cos_to_last_merge=0.8370 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.837
[S16] round=59 local utility u=0.000723 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9964451411735356, 'loss_val': 0.037796013369757034, 'psi': 0.9937919473820402}-{'f1_val': 0.9918242256299163, 'auprc': 0.9963708935508391, 'loss_val': 0.0378266464714358, 'psi': 0.9936428927982854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=60 psi=0.994 u=0.0007 p_local=0.0101 f1=0.992 auprc=0.996 bytes=71795
[S17] START round=59 head_norm_before_train=2.001666 cos_to_last_merge=0.7548 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=59 local utility u=0.000000 metrics={'f1_val': 0.6020249220366998, 'auprc': 0.8249801377853911, 'loss_val': 1.5150033823492615, 'psi': 0.6912070083361763}-{'f1_val': 0.6138465632637363, 'auprc': 0.8391886984193322, 'loss_val': 1.3831619314421157, 'psi': 0.7039834173259747}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=60 psi=0.691 u=0.0000 p_local=0.1753 f1=0.602 auprc=0.825 bytes=50419
[S2] START round=60 head_norm_before_train=2.105702 (no previous merge yet)
[S2] round=60 local utility u=0.031640 metrics={'f1_val': 0.7108189741932999, 'auprc': 0.9248737067413514, 'loss_val': 0.5478605991148052, 'psi': 0.7964408672125205}-{'f1_val': 0.709886229687553, 'auprc': 0.9152748211680231, 'loss_val': 0.5767475990357778, 'psi': 0.792041666279741}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=60 head_norm_before_train=2.244739 (no previous merge yet)
[S3] round=60 local utility u=0.000000 metrics={'f1_val': 0.8205971763480023, 'auprc': 0.9979612073698471, 'loss_val': 0.44982290979882744, 'psi': 0.8915427887567402}-{'f1_val': 0.9322238418813434, 'auprc': 0.9919939246091918, 'loss_val': 0.20968952855810832, 'psi': 0.9561318749724828}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=60 head_norm_before_train=1.776388 cos_to_last_merge=0.8037 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=60 local utility u=0.001630 metrics={'f1_val': 0.944891002800933, 'auprc': 0.9589700967964606, 'loss_val': 0.33119769544341915, 'psi': 0.950522640399144}-{'f1_val': 0.9467994792668728, 'auprc': 0.952768012128861, 'loss_val': 0.32730203141406217, 'psi': 0.949186892411668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=60 head_norm_before_train=1.726995 cos_to_last_merge=0.7856 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.786
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.7145680792825414, 'auprc': 0.9889254368555833, 'loss_val': 0.4248532215937057, 'psi': 0.8243110223117582}-{'f1_val': 0.9963325909888239, 'auprc': 0.9970772601703051, 'loss_val': 0.0405796151544262, 'psi': 0.9966304586614163}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=2.051253 (no previous merge yet)
[S6] round=60 local utility u=0.887644 metrics={'f1_val': 0.8705403423829692, 'auprc': 0.970865076687333, 'loss_val': 0.3063723981956021, 'psi': 0.9106702361047148}-{'f1_val': 0.681993587759117, 'auprc': 0.9212619882504787, 'loss_val': 0.8015706535028981, 'psi': 0.7777009479556617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=60 head_norm_before_train=1.813841 (no previous merge yet)
[S7] round=60 local utility u=0.079326 metrics={'f1_val': 0.6339775174215712, 'auprc': 0.8029021750181884, 'loss_val': 0.6105156108018555, 'psi': 0.7015473804602181}-{'f1_val': 0.6181474172658259, 'auprc': 0.7974385149537752, 'loss_val': 0.6577958077247141, 'psi': 0.6898638563410056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=60 head_norm_before_train=1.638663 cos_to_last_merge=0.8439 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=60 local utility u=0.041398 metrics={'f1_val': 0.9896426608072839, 'auprc': 0.9987160427440431, 'loss_val': 0.03822771146325476, 'psi': 0.9932720135819877}-{'f1_val': 0.9790487355341038, 'auprc': 0.9988219266782713, 'loss_val': 0.05777722837703707, 'psi': 0.9869580119917708}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=60 head_norm_before_train=1.679987 cos_to_last_merge=0.8803 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9957112967374491, 'loss_val': 0.021216282845633785, 'psi': 0.9965462662022653}-{'f1_val': 0.9971029125121428, 'auprc': 0.9972778417236371, 'loss_val': 0.021357527353719256, 'psi': 0.9971728841967405}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=1.904034 cos_to_last_merge=0.9005 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.901
[S10] round=60 local utility u=0.000215 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9928276569952152, 'loss_val': 0.0319418285664104, 'psi': 0.9929378745045221}-{'f1_val': 0.9930113528440598, 'auprc': 0.9928642903420182, 'loss_val': 0.03248121126774703, 'psi': 0.9929525278432432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] START round=60 head_norm_before_train=1.884669 cos_to_last_merge=0.9050 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=60 local utility u=0.031424 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9975346724031344, 'loss_val': 0.040507945470469604, 'psi': 0.996706353807701}-{'f1_val': 0.9941942077612611, 'auprc': 0.9967372184119907, 'loss_val': 0.08920461220630638, 'psi': 0.9952114120215529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=60 head_norm_before_train=1.921743 (no previous merge yet)
[S13] round=60 local utility u=0.134278 metrics={'f1_val': 0.723774136103378, 'auprc': 0.6884542790243069, 'loss_val': 0.9848255185836825, 'psi': 0.7096461932717495}-{'f1_val': 0.6606970263328715, 'auprc': 0.681368005218106, 'loss_val': 0.8536607031235763, 'psi': 0.6689654178869653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=60 head_norm_before_train=1.669408 cos_to_last_merge=0.9154 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=60 local utility u=0.000512 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986505959772769, 'loss_val': 0.022877590771538885, 'psi': 0.997412577357361}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986489460897224, 'loss_val': 0.023896167222106017, 'psi': 0.9974119174023391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=60 head_norm_before_train=1.660656 cos_to_last_merge=0.8853 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=60 local utility u=0.296267 metrics={'f1_val': 0.9610425064738557, 'auprc': 0.9985504776775774, 'loss_val': 0.09459037872792425, 'psi': 0.9760456949553444}-{'f1_val': 0.9011925060467738, 'auprc': 0.980289755269105, 'loss_val': 0.273242517719616, 'psi': 0.9328314057357063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=60 head_norm_before_train=1.779734 cos_to_last_merge=0.8363 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=60 local utility u=0.000027 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.996444055583829, 'loss_val': 0.0377378707855255, 'psi': 0.9937915131461577}-{'f1_val': 0.9920231515210434, 'auprc': 0.9964451411735356, 'loss_val': 0.037796013369757034, 'psi': 0.9937919473820402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=60 head_norm_before_train=2.006249 cos_to_last_merge=0.7550 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=60 local utility u=1.000000 metrics={'f1_val': 0.8000963579622093, 'auprc': 0.8515438861220492, 'loss_val': 0.7654194990894108, 'psi': 0.8206753692261453}-{'f1_val': 0.6020249220366998, 'auprc': 0.8249801377853911, 'loss_val': 1.5150033823492615, 'psi': 0.6912070083361763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=61 head_norm_before_train=2.111367 (no previous merge yet)
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7124871166268845, 'auprc': 0.9161218091018113, 'loss_val': 0.5518659120660256, 'psi': 0.7939409936168552}-{'f1_val': 0.7108189741932999, 'auprc': 0.9248737067413514, 'loss_val': 0.5478605991148052, 'psi': 0.7964408672125205}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.249758 (no previous merge yet)
[S3] round=61 local utility u=0.247785 metrics={'f1_val': 0.8845900009071865, 'auprc': 0.988212451924366, 'loss_val': 0.3089628381241348, 'psi': 0.9260389813140584}-{'f1_val': 0.8205971763480023, 'auprc': 0.9979612073698471, 'loss_val': 0.44982290979882744, 'psi': 0.8915427887567402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=61 head_norm_before_train=1.777860 cos_to_last_merge=0.8036 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9443302314034207, 'auprc': 0.938892213189582, 'loss_val': 0.3408735883981454, 'psi': 0.9421550241178852}-{'f1_val': 0.944891002800933, 'auprc': 0.9589700967964606, 'loss_val': 0.33119769544341915, 'psi': 0.950522640399144}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.729434 cos_to_last_merge=0.7848 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=61 local utility u=1.000000 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9970733440642944, 'loss_val': 0.03873269984492928, 'psi': 0.9966288922190121}-{'f1_val': 0.7145680792825414, 'auprc': 0.9889254368555833, 'loss_val': 0.4248532215937057, 'psi': 0.8243110223117582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=61 head_norm_before_train=2.058262 (no previous merge yet)
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.6411753425732007, 'auprc': 0.9448806886555645, 'loss_val': 0.7914867602575744, 'psi': 0.7626574810061463}-{'f1_val': 0.8705403423829692, 'auprc': 0.970865076687333, 'loss_val': 0.3063723981956021, 'psi': 0.9106702361047148}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.819468 (no previous merge yet)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.621980052638698, 'auprc': 0.7996887437828408, 'loss_val': 0.6171706718996766, 'psi': 0.6930635290963552}-{'f1_val': 0.6339775174215712, 'auprc': 0.8029021750181884, 'loss_val': 0.6105156108018555, 'psi': 0.7015473804602181}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.642282 cos_to_last_merge=0.8437 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.844
[S8] round=61 local utility u=0.006446 metrics={'f1_val': 0.9927720833909908, 'auprc': 0.9984591307212414, 'loss_val': 0.043342107999626615, 'psi': 0.995046902323091}-{'f1_val': 0.9896426608072839, 'auprc': 0.9987160427440431, 'loss_val': 0.03822771146325476, 'psi': 0.9932720135819877}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=61 head_norm_before_train=1.687229 cos_to_last_merge=0.8796 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9966891482978385, 'auprc': 0.9963326945156108, 'loss_val': 0.021139064024257113, 'psi': 0.9965465667849475}-{'f1_val': 0.9971029125121428, 'auprc': 0.9957112967374491, 'loss_val': 0.021216282845633785, 'psi': 0.9965462662022653}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.908135 cos_to_last_merge=0.8995 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.900
[S10] round=61 local utility u=0.001910 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9948935617537963, 'loss_val': 0.033005098628729565, 'psi': 0.9936328009997394}-{'f1_val': 0.9930113528440598, 'auprc': 0.9928276569952152, 'loss_val': 0.0319418285664104, 'psi': 0.9929378745045221}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=61 head_norm_before_train=1.887659 cos_to_last_merge=0.9046 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.905
[S11] round=61 local utility u=0.009087 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9979316596457796, 'loss_val': 0.024431305182360558, 'psi': 0.9969557643396284}-{'f1_val': 0.9961541414107454, 'auprc': 0.9975346724031344, 'loss_val': 0.040507945470469604, 'psi': 0.996706353807701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=61 head_norm_before_train=1.926779 (no previous merge yet)
[S13] round=61 local utility u=0.066726 metrics={'f1_val': 0.7214761932202629, 'auprc': 0.7119887522036172, 'loss_val': 0.9081888827888598, 'psi': 0.7176812168136046}-{'f1_val': 0.723774136103378, 'auprc': 0.6884542790243069, 'loss_val': 0.9848255185836825, 'psi': 0.7096461932717495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=61 head_norm_before_train=1.675043 cos_to_last_merge=0.9151 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=61 local utility u=0.001017 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986470584818528, 'loss_val': 0.023162326483484715, 'psi': 0.9976441234430069}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986505959772769, 'loss_val': 0.022877590771538885, 'psi': 0.997412577357361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=61 head_norm_before_train=1.668582 cos_to_last_merge=0.8846 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.885
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9911155652765576, 'loss_val': 0.2324596860235369, 'psi': 0.9381036701835428}-{'f1_val': 0.9610425064738557, 'auprc': 0.9985504776775774, 'loss_val': 0.09459037872792425, 'psi': 0.9760456949553444}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=1.788046 cos_to_last_merge=0.8355 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.836
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.995973400794731, 'loss_val': 0.03741977596262772, 'psi': 0.9936032512305184}-{'f1_val': 0.9920231515210434, 'auprc': 0.996444055583829, 'loss_val': 0.0377378707855255, 'psi': 0.9937915131461577}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=2.011250 cos_to_last_merge=0.7548 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.755
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.6014784485210968, 'auprc': 0.8920422205550744, 'loss_val': 1.4888997846799892, 'psi': 0.7177039573346878}-{'f1_val': 0.8000963579622093, 'auprc': 0.8515438861220492, 'loss_val': 0.7654194990894108, 'psi': 0.8206753692261453}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=2.115907 (no previous merge yet)
[S2] round=62 local utility u=0.072167 metrics={'f1_val': 0.7901434622457356, 'auprc': 0.8298074139305848, 'loss_val': 0.614526712348263, 'psi': 0.8060090429196753}-{'f1_val': 0.7124871166268845, 'auprc': 0.9161218091018113, 'loss_val': 0.5518659120660256, 'psi': 0.7939409936168552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=62 head_norm_before_train=2.254390 (no previous merge yet)
[S3] round=62 local utility u=0.188194 metrics={'f1_val': 0.9230170571765399, 'auprc': 0.9985521021276027, 'loss_val': 0.19415647608917244, 'psi': 0.953231075156965}-{'f1_val': 0.8845900009071865, 'auprc': 0.988212451924366, 'loss_val': 0.3089628381241348, 'psi': 0.9260389813140584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=62 head_norm_before_train=1.777493 cos_to_last_merge=0.8038 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=62 local utility u=0.048590 metrics={'f1_val': 0.9504262807784478, 'auprc': 0.952160206589691, 'loss_val': 0.3200733867839198, 'psi': 0.9511198511029452}-{'f1_val': 0.9443302314034207, 'auprc': 0.938892213189582, 'loss_val': 0.3408735883981454, 'psi': 0.9421550241178852}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=62 head_norm_before_train=1.732154 cos_to_last_merge=0.7842 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=62 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9901552556327772, 'loss_val': 0.04892750840232425, 'psi': 0.9936862317919433}-{'f1_val': 0.9963325909888239, 'auprc': 0.9970733440642944, 'loss_val': 0.03873269984492928, 'psi': 0.9966288922190121}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=62 head_norm_before_train=2.062050 (no previous merge yet)
[S6] round=62 local utility u=0.770992 metrics={'f1_val': 0.8231345726526611, 'auprc': 0.9659284209422333, 'loss_val': 0.4044004502695634, 'psi': 0.88025211196849}-{'f1_val': 0.6411753425732007, 'auprc': 0.9448806886555645, 'loss_val': 0.7914867602575744, 'psi': 0.7626574810061463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=62 head_norm_before_train=1.823525 (no previous merge yet)
[S7] round=62 local utility u=0.140590 metrics={'f1_val': 0.6368368489970917, 'auprc': 0.8083420994165882, 'loss_val': 0.4510909457833712, 'psi': 0.7054389491648902}-{'f1_val': 0.621980052638698, 'auprc': 0.7996887437828408, 'loss_val': 0.6171706718996766, 'psi': 0.6930635290963552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=62 head_norm_before_train=1.646960 cos_to_last_merge=0.8432 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.843
[S8] round=62 local utility u=0.010946 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9993630518453748, 'loss_val': 0.03187651902202088, 'psi': 0.9961798434097873}-{'f1_val': 0.9927720833909908, 'auprc': 0.9984591307212414, 'loss_val': 0.043342107999626615, 'psi': 0.995046902323091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=62 head_norm_before_train=1.693979 cos_to_last_merge=0.8789 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.879
[S9] round=62 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9986651164343425, 'loss_val': 0.026720207623573723, 'psi': 0.9959798704240765}-{'f1_val': 0.9966891482978385, 'auprc': 0.9963326945156108, 'loss_val': 0.021139064024257113, 'psi': 0.9965465667849475}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=62 head_norm_before_train=1.914220 cos_to_last_merge=0.8991 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.899
[S10] round=62 local utility u=0.000024 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9943309076319131, 'loss_val': 0.03258343713458565, 'psi': 0.9935391747592012}-{'f1_val': 0.9927922938303682, 'auprc': 0.9948935617537963, 'loss_val': 0.033005098628729565, 'psi': 0.9936328009997394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=62 head_norm_before_train=1.892312 cos_to_last_merge=0.9044 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.9674961470988809, 'auprc': 0.9979429251366427, 'loss_val': 0.09881077226790966, 'psi': 0.9796748583139856}-{'f1_val': 0.996305167468861, 'auprc': 0.9979316596457796, 'loss_val': 0.024431305182360558, 'psi': 0.9969557643396284}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=62 head_norm_before_train=1.933274 (no previous merge yet)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.616111773440005, 'auprc': 0.8427468098866362, 'loss_val': 1.0353159724338517, 'psi': 0.7067657880186575}-{'f1_val': 0.7214761932202629, 'auprc': 0.7119887522036172, 'loss_val': 0.9081888827888598, 'psi': 0.7176812168136046}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=1.680926 cos_to_last_merge=0.9149 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986143994922616, 'loss_val': 0.023799287855732567, 'psi': 0.9976442646915037}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986470584818528, 'loss_val': 0.023162326483484715, 'psi': 0.9976441234430069}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.676756 cos_to_last_merge=0.8838 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.884
[S15] round=62 local utility u=0.000000 metrics={'f1_val': 0.9011925060467738, 'auprc': 0.9247402232879, 'loss_val': 0.2992469704934035, 'psi': 0.9106115929432244}-{'f1_val': 0.9027624067881995, 'auprc': 0.9911155652765576, 'loss_val': 0.2324596860235369, 'psi': 0.9381036701835428}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=62 head_norm_before_train=1.793869 cos_to_last_merge=0.8350 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.835
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9947121445031661, 'loss_val': 0.037128663347672466, 'psi': 0.9930987487138925}-{'f1_val': 0.9920231515210434, 'auprc': 0.995973400794731, 'loss_val': 0.03741977596262772, 'psi': 0.9936032512305184}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=2.018466 cos_to_last_merge=0.7545 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=62 local utility u=0.050309 metrics={'f1_val': 0.6049957673223518, 'auprc': 0.915086609237897, 'loss_val': 1.4785186130301655, 'psi': 0.7290321040885699}-{'f1_val': 0.6014784485210968, 'auprc': 0.8920422205550744, 'loss_val': 1.4888997846799892, 'psi': 0.7177039573346878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=63 head_norm_before_train=2.122662 (no previous merge yet)
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.700839539415807, 'auprc': 0.8966216249968113, 'loss_val': 0.6109107332133836, 'psi': 0.7791523736482087}-{'f1_val': 0.7901434622457356, 'auprc': 0.8298074139305848, 'loss_val': 0.614526712348263, 'psi': 0.8060090429196753}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.259197 (no previous merge yet)
[S3] round=63 local utility u=0.248685 metrics={'f1_val': 0.9824830513399452, 'auprc': 0.998579847390883, 'loss_val': 0.053665800175056864, 'psi': 0.9889217697603203}-{'f1_val': 0.9230170571765399, 'auprc': 0.9985521021276027, 'loss_val': 0.19415647608917244, 'psi': 0.953231075156965}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=63 head_norm_before_train=1.776804 cos_to_last_merge=0.8041 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.94658216345781, 'auprc': 0.9506720322558408, 'loss_val': 0.3308908428930984, 'psi': 0.9482181109770224}-{'f1_val': 0.9504262807784478, 'auprc': 0.952160206589691, 'loss_val': 0.3200733867839198, 'psi': 0.9511198511029452}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=1.735369 cos_to_last_merge=0.7835 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.784
[S5] round=63 local utility u=0.013188 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9944534844891708, 'loss_val': 0.03632022745711083, 'psi': 0.9954930077812549}-{'f1_val': 0.9960402158980539, 'auprc': 0.9901552556327772, 'loss_val': 0.04892750840232425, 'psi': 0.9936862317919433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=63 head_norm_before_train=2.065942 (no previous merge yet)
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.6545229652350133, 'auprc': 0.9447163328755238, 'loss_val': 0.7585564185078133, 'psi': 0.7706003122912175}-{'f1_val': 0.8231345726526611, 'auprc': 0.9659284209422333, 'loss_val': 0.4044004502695634, 'psi': 0.88025211196849}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.827976 (no previous merge yet)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5929446345676308, 'auprc': 0.79411328200211, 'loss_val': 0.7245617494846734, 'psi': 0.6734120935414225}-{'f1_val': 0.6368368489970917, 'auprc': 0.8083420994165882, 'loss_val': 0.4510909457833712, 'psi': 0.7054389491648902}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.654576 cos_to_last_merge=0.8422 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.842
[S8] round=63 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9990583432225973, 'loss_val': 0.033690807786220724, 'psi': 0.9950942695603803}-{'f1_val': 0.994057704452729, 'auprc': 0.9993630518453748, 'loss_val': 0.03187651902202088, 'psi': 0.9961798434097873}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=63 head_norm_before_train=1.699854 cos_to_last_merge=0.8782 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=63 local utility u=0.006468 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.995189497643923, 'loss_val': 0.0208360951025017, 'psi': 0.9963375465648548}-{'f1_val': 0.9941897064172326, 'auprc': 0.9986651164343425, 'loss_val': 0.026720207623573723, 'psi': 0.9959798704240765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=63 head_norm_before_train=1.921898 cos_to_last_merge=0.8979 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.898
[S10] round=63 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9944124082622161, 'loss_val': 0.03384204588424447, 'psi': 0.9934403396031073}-{'f1_val': 0.9930113528440598, 'auprc': 0.9943309076319131, 'loss_val': 0.03258343713458565, 'psi': 0.9935391747592012}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=63 head_norm_before_train=1.897426 cos_to_last_merge=0.9042 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=63 local utility u=0.122353 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977261713778416, 'loss_val': 0.026307894678369054, 'psi': 0.9968735690324533}-{'f1_val': 0.9674961470988809, 'auprc': 0.9979429251366427, 'loss_val': 0.09881077226790966, 'psi': 0.9796748583139856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=63 head_norm_before_train=1.935529 (no previous merge yet)
[S13] round=63 local utility u=0.075013 metrics={'f1_val': 0.6617376056541728, 'auprc': 0.7505113266201189, 'loss_val': 0.8823381980118218, 'psi': 0.6972470940405513}-{'f1_val': 0.616111773440005, 'auprc': 0.8427468098866362, 'loss_val': 1.0353159724338517, 'psi': 0.7067657880186575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=63 head_norm_before_train=1.686507 cos_to_last_merge=0.9143 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.914
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986891267724691, 'loss_val': 0.023118269452329063, 'psi': 0.9974279896754379}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986143994922616, 'loss_val': 0.023799287855732567, 'psi': 0.9976442646915037}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.685368 cos_to_last_merge=0.8831 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.883
[S15] round=63 local utility u=0.144873 metrics={'f1_val': 0.9042894240815549, 'auprc': 0.9895083678490854, 'loss_val': 0.22238605392059277, 'psi': 0.9383770015885671}-{'f1_val': 0.9011925060467738, 'auprc': 0.9247402232879, 'loss_val': 0.2992469704934035, 'psi': 0.9106115929432244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=63 head_norm_before_train=1.798005 cos_to_last_merge=0.8343 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.834
[S16] round=63 local utility u=0.000000 metrics={'f1_val': 0.9924409270521872, 'auprc': 0.993435825806377, 'loss_val': 0.036569293086349916, 'psi': 0.9928388865538631}-{'f1_val': 0.9920231515210434, 'auprc': 0.9947121445031661, 'loss_val': 0.037128663347672466, 'psi': 0.9930987487138925}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=63 head_norm_before_train=2.026036 cos_to_last_merge=0.7539 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.754
[S17] round=63 local utility u=0.727295 metrics={'f1_val': 0.7591199575286376, 'auprc': 0.8835479961365594, 'loss_val': 0.854058433322979, 'psi': 0.8088911729718062}-{'f1_val': 0.6049957673223518, 'auprc': 0.915086609237897, 'loss_val': 1.4785186130301655, 'psi': 0.7290321040885699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=64 head_norm_before_train=2.131109 (no previous merge yet)
[S2] round=64 local utility u=0.067703 metrics={'f1_val': 0.7096511747647785, 'auprc': 0.9226691173164996, 'loss_val': 0.6065171050576338, 'psi': 0.7948583517854669}-{'f1_val': 0.700839539415807, 'auprc': 0.8966216249968113, 'loss_val': 0.6109107332133836, 'psi': 0.7791523736482087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=64 head_norm_before_train=2.264665 (no previous merge yet)
[S3] round=64 local utility u=0.000000 metrics={'f1_val': 0.9660926864666685, 'auprc': 0.9988120594365003, 'loss_val': 0.07561819580269276, 'psi': 0.9791804356546012}-{'f1_val': 0.9824830513399452, 'auprc': 0.998579847390883, 'loss_val': 0.053665800175056864, 'psi': 0.9889217697603203}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=64 head_norm_before_train=1.777846 cos_to_last_merge=0.8041 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=64 local utility u=0.000307 metrics={'f1_val': 0.9419982665163684, 'auprc': 0.9617197109921615, 'loss_val': 0.3359168034869973, 'psi': 0.9498868443066857}-{'f1_val': 0.94658216345781, 'auprc': 0.9506720322558408, 'loss_val': 0.3308908428930984, 'psi': 0.9482181109770224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=64 head_norm_before_train=1.738738 cos_to_last_merge=0.7829 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.783
[S5] round=64 local utility u=0.001632 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9955240159276465, 'loss_val': 0.036268764206687024, 'psi': 0.9959212203566452}-{'f1_val': 0.996186023309311, 'auprc': 0.9944534844891708, 'loss_val': 0.03632022745711083, 'psi': 0.9954930077812549}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=64 head_norm_before_train=2.070547 (no previous merge yet)
[S6] round=64 local utility u=0.046513 metrics={'f1_val': 0.668237393782433, 'auprc': 0.9536518061214914, 'loss_val': 0.7746224391043577, 'psi': 0.7824031587180563}-{'f1_val': 0.6545229652350133, 'auprc': 0.9447163328755238, 'loss_val': 0.7585564185078133, 'psi': 0.7706003122912175}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=64 head_norm_before_train=1.832197 (no previous merge yet)
[S7] round=64 local utility u=0.244531 metrics={'f1_val': 0.6395872545727863, 'auprc': 0.8054928801478021, 'loss_val': 0.5494939759612506, 'psi': 0.7059495048027926}-{'f1_val': 0.5929446345676308, 'auprc': 0.79411328200211, 'loss_val': 0.7245617494846734, 'psi': 0.6734120935414225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=64 head_norm_before_train=1.661819 cos_to_last_merge=0.8411 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.841
[S8] round=64 local utility u=0.001318 metrics={'f1_val': 0.9932955872009759, 'auprc': 0.9990030610776648, 'loss_val': 0.035953800313497555, 'psi': 0.9955785767516514}-{'f1_val': 0.9924515537855688, 'auprc': 0.9990583432225973, 'loss_val': 0.033690807786220724, 'psi': 0.9950942695603803}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=64 head_norm_before_train=1.705109 cos_to_last_merge=0.8777 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.878
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9948404278005787, 'loss_val': 0.02088531665030741, 'psi': 0.9961979186275172}-{'f1_val': 0.9971029125121428, 'auprc': 0.995189497643923, 'loss_val': 0.0208360951025017, 'psi': 0.9963375465648548}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.930366 cos_to_last_merge=0.8960 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.896
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9925733077310497, 'auprc': 0.994823406905395, 'loss_val': 0.03476372061494394, 'psi': 0.9934733474007877}-{'f1_val': 0.9927922938303682, 'auprc': 0.9944124082622161, 'loss_val': 0.03384204588424447, 'psi': 0.9934403396031073}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=1.903105 cos_to_last_merge=0.9039 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.904
[S11] round=64 local utility u=0.001139 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977627792965292, 'loss_val': 0.024139338670742114, 'psi': 0.9968882121999283}-{'f1_val': 0.996305167468861, 'auprc': 0.9977261713778416, 'loss_val': 0.026307894678369054, 'psi': 0.9968735690324533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=64 head_norm_before_train=1.937272 (no previous merge yet)
[S13] round=64 local utility u=0.228613 metrics={'f1_val': 0.7144413372243545, 'auprc': 0.8061953716731506, 'loss_val': 0.9083871122264853, 'psi': 0.751142951003873}-{'f1_val': 0.6617376056541728, 'auprc': 0.7505113266201189, 'loss_val': 0.8823381980118218, 'psi': 0.6972470940405513}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=64 head_norm_before_train=1.691733 cos_to_last_merge=0.9139 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.914
[S14] round=64 local utility u=0.000242 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986798093419252, 'loss_val': 0.022606354478189088, 'psi': 0.9974242627032203}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986891267724691, 'loss_val': 0.023118269452329063, 'psi': 0.9974279896754379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=64 head_norm_before_train=1.693946 cos_to_last_merge=0.8824 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9017661709628013, 'auprc': 0.9641182893368688, 'loss_val': 0.2852242097541219, 'psi': 0.9267070183124283}-{'f1_val': 0.9042894240815549, 'auprc': 0.9895083678490854, 'loss_val': 0.22238605392059277, 'psi': 0.9383770015885671}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=1.801808 cos_to_last_merge=0.8338 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.834
[S16] round=64 local utility u=0.000169 metrics={'f1_val': 0.9924409270521872, 'auprc': 0.9934557816224279, 'loss_val': 0.036291944152267226, 'psi': 0.9928468688802835}-{'f1_val': 0.9924409270521872, 'auprc': 0.993435825806377, 'loss_val': 0.036569293086349916, 'psi': 0.9928388865538631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=64 head_norm_before_train=2.035042 cos_to_last_merge=0.7533 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.6099713225352321, 'auprc': 0.928329103389457, 'loss_val': 1.5255108655911866, 'psi': 0.737314434876922}-{'f1_val': 0.7591199575286376, 'auprc': 0.8835479961365594, 'loss_val': 0.854058433322979, 'psi': 0.8088911729718062}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=2.132915 (no previous merge yet)
[S2] round=65 local utility u=0.279360 metrics={'f1_val': 0.8050319672691006, 'auprc': 0.8779152947135964, 'loss_val': 0.48581948410047926, 'psi': 0.8341852982468989}-{'f1_val': 0.7096511747647785, 'auprc': 0.9226691173164996, 'loss_val': 0.6065171050576338, 'psi': 0.7948583517854669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=65 head_norm_before_train=2.269233 (no previous merge yet)
[S3] round=65 local utility u=0.000000 metrics={'f1_val': 0.687727438776663, 'auprc': 0.9851399799877713, 'loss_val': 0.8566692057112011, 'psi': 0.8066924552611063}-{'f1_val': 0.9660926864666685, 'auprc': 0.9988120594365003, 'loss_val': 0.07561819580269276, 'psi': 0.9791804356546012}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=65 head_norm_before_train=1.783658 cos_to_last_merge=0.8032 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.803
[S4] round=65 local utility u=0.029705 metrics={'f1_val': 0.9457523711004537, 'auprc': 0.9698199842856648, 'loss_val': 0.3233316138520069, 'psi': 0.9553794163745382}-{'f1_val': 0.9419982665163684, 'auprc': 0.9617197109921615, 'loss_val': 0.3359168034869973, 'psi': 0.9498868443066857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=65 head_norm_before_train=1.740853 cos_to_last_merge=0.7824 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9913097139156225, 'loss_val': 0.04168167802451881, 'psi': 0.9942354995518357}-{'f1_val': 0.996186023309311, 'auprc': 0.9955240159276465, 'loss_val': 0.036268764206687024, 'psi': 0.9959212203566452}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=2.075227 (no previous merge yet)
[S6] round=65 local utility u=0.815020 metrics={'f1_val': 0.853519108743523, 'auprc': 0.9806719363103285, 'loss_val': 0.33733316657355755, 'psi': 0.9043802397702452}-{'f1_val': 0.668237393782433, 'auprc': 0.9536518061214914, 'loss_val': 0.7746224391043577, 'psi': 0.7824031587180563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=65 head_norm_before_train=1.838320 (no previous merge yet)
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5849870929071658, 'auprc': 0.7918334737207828, 'loss_val': 0.9111177140538158, 'psi': 0.6677256452326126}-{'f1_val': 0.6395872545727863, 'auprc': 0.8054928801478021, 'loss_val': 0.5494939759612506, 'psi': 0.7059495048027926}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=1.668401 cos_to_last_merge=0.8402 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.840
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.929915228614868, 'auprc': 0.9991277371577113, 'loss_val': 0.14405514348623105, 'psi': 0.9576002320320054}-{'f1_val': 0.9932955872009759, 'auprc': 0.9990030610776648, 'loss_val': 0.035953800313497555, 'psi': 0.9955785767516514}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=1.711337 cos_to_last_merge=0.8771 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.877
[S9] round=65 local utility u=0.003506 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9969646294922785, 'loss_val': 0.02024646950790091, 'psi': 0.9970475993041971}-{'f1_val': 0.9971029125121428, 'auprc': 0.9948404278005787, 'loss_val': 0.02088531665030741, 'psi': 0.9961979186275172}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S9] sending update (kind=head size=1788 to 1 peers)
[S10] START round=65 head_norm_before_train=1.938836 cos_to_last_merge=0.8945 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.894
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9929902721364495, 'loss_val': 0.03389036067653311, 'psi': 0.9928714851528007}-{'f1_val': 0.9925733077310497, 'auprc': 0.994823406905395, 'loss_val': 0.03476372061494394, 'psi': 0.9934733474007877}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=1.908589 cos_to_last_merge=0.9035 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=65 local utility u=0.000556 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983120740354847, 'loss_val': 0.023768354367058417, 'psi': 0.9970173144606411}-{'f1_val': 0.996305167468861, 'auprc': 0.9977627792965292, 'loss_val': 0.024139338670742114, 'psi': 0.9968882121999283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=65 head_norm_before_train=1.938787 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.6411843938023986, 'auprc': 0.6972931009756648, 'loss_val': 1.1407450129613195, 'psi': 0.6636278766717051}-{'f1_val': 0.7144413372243545, 'auprc': 0.8061953716731506, 'loss_val': 0.9083871122264853, 'psi': 0.751142951003873}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=1.696787 cos_to_last_merge=0.9136 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.914
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9963442551067831, 'auprc': 0.9984623432559572, 'loss_val': 0.024291372458466746, 'psi': 0.9971914903664527}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986798093419252, 'loss_val': 0.022606354478189088, 'psi': 0.9974242627032203}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.702069 cos_to_last_merge=0.8816 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=65 local utility u=0.466861 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9977228137150359, 'loss_val': 0.02442245233309144, 'psi': 0.9973594776028745}-{'f1_val': 0.9017661709628013, 'auprc': 0.9641182893368688, 'loss_val': 0.2852242097541219, 'psi': 0.9267070183124283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=65 head_norm_before_train=1.807242 cos_to_last_merge=0.8332 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=65 local utility u=0.000668 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9943433413248153, 'loss_val': 0.036429224990106736, 'psi': 0.9930829272056797}-{'f1_val': 0.9924409270521872, 'auprc': 0.9934557816224279, 'loss_val': 0.036291944152267226, 'psi': 0.9928468688802835}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=65 head_norm_before_train=2.044834 cos_to_last_merge=0.7531 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=65 local utility u=0.185994 metrics={'f1_val': 0.6230908042342642, 'auprc': 0.9690295507031662, 'loss_val': 1.3543411802464016, 'psi': 0.761466302821825}-{'f1_val': 0.6099713225352321, 'auprc': 0.928329103389457, 'loss_val': 1.5255108655911866, 'psi': 0.737314434876922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=66 head_norm_before_train=2.136340 (no previous merge yet)
[S2] round=66 local utility u=0.000000 metrics={'f1_val': 0.7107254297437736, 'auprc': 0.9037463188005501, 'loss_val': 0.5499809891775607, 'psi': 0.7879337853664843}-{'f1_val': 0.8050319672691006, 'auprc': 0.8779152947135964, 'loss_val': 0.48581948410047926, 'psi': 0.8341852982468989}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=66 head_norm_before_train=2.273762 (no previous merge yet)
[S3] round=66 local utility u=0.781454 metrics={'f1_val': 0.8614796131187885, 'auprc': 0.9902769551813129, 'loss_val': 0.3516855293661432, 'psi': 0.9129985499437983}-{'f1_val': 0.687727438776663, 'auprc': 0.9851399799877713, 'loss_val': 0.8566692057112011, 'psi': 0.8066924552611063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=66 head_norm_before_train=1.789598 cos_to_last_merge=0.8023 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9410436748248063, 'auprc': 0.9636237711824179, 'loss_val': 0.3375721903231469, 'psi': 0.950075713367851}-{'f1_val': 0.9457523711004537, 'auprc': 0.9698199842856648, 'loss_val': 0.3233316138520069, 'psi': 0.9553794163745382}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.745412 cos_to_last_merge=0.7814 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=66 local utility u=0.004516 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9923195830316469, 'loss_val': 0.035679923128301864, 'psi': 0.9946394471982454}-{'f1_val': 0.996186023309311, 'auprc': 0.9913097139156225, 'loss_val': 0.04168167802451881, 'psi': 0.9942354995518357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=66 head_norm_before_train=2.081391 (no previous merge yet)
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.6008411157997419, 'auprc': 0.9018280457898995, 'loss_val': 1.0059028381901243, 'psi': 0.7212358877958049}-{'f1_val': 0.853519108743523, 'auprc': 0.9806719363103285, 'loss_val': 0.33733316657355755, 'psi': 0.9043802397702452}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.844160 (no previous merge yet)
[S7] round=66 local utility u=0.807626 metrics={'f1_val': 0.6950673344676634, 'auprc': 0.8864407771959382, 'loss_val': 0.240168970091793, 'psi': 0.7716167115589734}-{'f1_val': 0.5849870929071658, 'auprc': 0.7918334737207828, 'loss_val': 0.9111177140538158, 'psi': 0.6677256452326126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=66 head_norm_before_train=1.674992 cos_to_last_merge=0.8394 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.839
[S8] round=66 local utility u=0.248561 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9994685355976682, 'loss_val': 0.03186999160391598, 'psi': 0.9961280074241761}-{'f1_val': 0.929915228614868, 'auprc': 0.9991277371577113, 'loss_val': 0.14405514348623105, 'psi': 0.9576002320320054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=66 head_norm_before_train=1.716753 cos_to_last_merge=0.8765 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.876
[S9] round=66 local utility u=0.001544 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998713907439747, 'loss_val': 0.019751360632560225, 'psi': 0.9974818700642336}-{'f1_val': 0.9971029125121428, 'auprc': 0.9969646294922785, 'loss_val': 0.02024646950790091, 'psi': 0.9970475993041971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=66 head_norm_before_train=1.945920 cos_to_last_merge=0.8936 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.894
[S10] round=66 local utility u=0.000825 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9932829656600517, 'loss_val': 0.03311750286447653, 'psi': 0.9929885625622416}-{'f1_val': 0.9927922938303682, 'auprc': 0.9929902721364495, 'loss_val': 0.03389036067653311, 'psi': 0.9928714851528007}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=66 head_norm_before_train=1.910864 cos_to_last_merge=0.9030 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.903
[S11] round=66 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9976266634294976, 'loss_val': 0.023677698560190866, 'psi': 0.996598047647586}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983120740354847, 'loss_val': 0.023768354367058417, 'psi': 0.9970173144606411}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=66 head_norm_before_train=1.941939 (no previous merge yet)
[S13] round=66 local utility u=0.632813 metrics={'f1_val': 0.730681405577482, 'auprc': 0.79275260118104, 'loss_val': 0.6984798612164994, 'psi': 0.7555098838189052}-{'f1_val': 0.6411843938023986, 'auprc': 0.6972931009756648, 'loss_val': 1.1407450129613195, 'psi': 0.6636278766717051}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=66 head_norm_before_train=1.702721 cos_to_last_merge=0.9133 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.913
[S14] round=66 local utility u=0.002552 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986530798583941, 'loss_val': 0.021218412892414124, 'psi': 0.9974135709098079}-{'f1_val': 0.9963442551067831, 'auprc': 0.9984623432559572, 'loss_val': 0.024291372458466746, 'psi': 0.9971914903664527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=66 head_norm_before_train=1.710171 cos_to_last_merge=0.8809 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.881
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9646177840347826, 'auprc': 0.9937978689547864, 'loss_val': 0.0615639387114344, 'psi': 0.9762898180027841}-{'f1_val': 0.9971172535281002, 'auprc': 0.9977228137150359, 'loss_val': 0.02442245233309144, 'psi': 0.9973594776028745}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=1.813819 cos_to_last_merge=0.8327 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.833
[S16] round=66 local utility u=0.002453 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9960890676335532, 'loss_val': 0.03675963084382545, 'psi': 0.9937812177291748}-{'f1_val': 0.9922426511262559, 'auprc': 0.9943433413248153, 'loss_val': 0.036429224990106736, 'psi': 0.9930829272056797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=66 head_norm_before_train=2.050800 cos_to_last_merge=0.7529 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=66 local utility u=1.000000 metrics={'f1_val': 0.8637397303335732, 'auprc': 0.9414949432909292, 'loss_val': 0.651078094203043, 'psi': 0.8948418155165155}-{'f1_val': 0.6230908042342642, 'auprc': 0.9690295507031662, 'loss_val': 1.3543411802464016, 'psi': 0.761466302821825}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=67 head_norm_before_train=2.139794 (no previous merge yet)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7067658525197655, 'auprc': 0.8864058282595115, 'loss_val': 0.5441932697562639, 'psi': 0.7786218428156639}-{'f1_val': 0.7107254297437736, 'auprc': 0.9037463188005501, 'loss_val': 0.5499809891775607, 'psi': 0.7879337853664843}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.279594 (no previous merge yet)
[S3] round=67 local utility u=0.421265 metrics={'f1_val': 0.9576401306280063, 'auprc': 0.9987491229222873, 'loss_val': 0.11153496528661648, 'psi': 0.9740837275457188}-{'f1_val': 0.8614796131187885, 'auprc': 0.9902769551813129, 'loss_val': 0.3516855293661432, 'psi': 0.9129985499437983}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=67 head_norm_before_train=1.796597 cos_to_last_merge=0.8012 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=67 local utility u=0.015901 metrics={'f1_val': 0.9419044793539278, 'auprc': 0.971052529291039, 'loss_val': 0.33322149437896, 'psi': 0.9535636993287723}-{'f1_val': 0.9410436748248063, 'auprc': 0.9636237711824179, 'loss_val': 0.3375721903231469, 'psi': 0.950075713367851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=67 head_norm_before_train=1.755149 cos_to_last_merge=0.7799 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=67 local utility u=0.003843 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9940724594450783, 'loss_val': 0.033251829985007954, 'psi': 0.9953405977636179}-{'f1_val': 0.996186023309311, 'auprc': 0.9923195830316469, 'loss_val': 0.035679923128301864, 'psi': 0.9946394471982454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=67 head_norm_before_train=2.088756 (no previous merge yet)
[S6] round=67 local utility u=0.824403 metrics={'f1_val': 0.784723052137111, 'auprc': 0.939745843112641, 'loss_val': 0.574141771592488, 'psi': 0.846732168527323}-{'f1_val': 0.6008411157997419, 'auprc': 0.9018280457898995, 'loss_val': 1.0059028381901243, 'psi': 0.7212358877958049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=67 head_norm_before_train=1.847133 (no previous merge yet)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.47608004276954774, 'auprc': 0.7782285344691637, 'loss_val': 1.211717557526386, 'psi': 0.5969394394493941}-{'f1_val': 0.6950673344676634, 'auprc': 0.8864407771959382, 'loss_val': 0.240168970091793, 'psi': 0.7716167115589734}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=1.680025 cos_to_last_merge=0.8390 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.839
[S8] round=67 local utility u=0.000641 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9995004305621918, 'loss_val': 0.031624338318835446, 'psi': 0.9962347948965141}-{'f1_val': 0.9939009886418481, 'auprc': 0.9994685355976682, 'loss_val': 0.03186999160391598, 'psi': 0.9961280074241761}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=67 head_norm_before_train=1.722217 cos_to_last_merge=0.8760 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.876
[S9] round=67 local utility u=0.001349 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987242487043911, 'loss_val': 0.01973863246763642, 'psi': 0.9977514469890422}-{'f1_val': 0.9966605118138915, 'auprc': 0.998713907439747, 'loss_val': 0.019751360632560225, 'psi': 0.9974818700642336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=67 head_norm_before_train=1.949265 cos_to_last_merge=0.8927 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.893
[S10] round=67 local utility u=0.002255 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9948711331385265, 'loss_val': 0.033371966463568714, 'psi': 0.9936238295536315}-{'f1_val': 0.9927922938303682, 'auprc': 0.9932829656600517, 'loss_val': 0.03311750286447653, 'psi': 0.9929885625622416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=67 head_norm_before_train=1.914525 cos_to_last_merge=0.9025 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=67 local utility u=0.001413 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9979124876602007, 'loss_val': 0.02315997572545126, 'psi': 0.9968574799105275}-{'f1_val': 0.9959123037929781, 'auprc': 0.9976266634294976, 'loss_val': 0.023677698560190866, 'psi': 0.996598047647586}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=67 head_norm_before_train=1.941872 (no previous merge yet)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.7309284977188163, 'auprc': 0.790398753145406, 'loss_val': 0.7678473921629304, 'psi': 0.7547165998894522}-{'f1_val': 0.730681405577482, 'auprc': 0.79275260118104, 'loss_val': 0.6984798612164994, 'psi': 0.7555098838189052}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=67 head_norm_before_train=1.708095 cos_to_last_merge=0.9126 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.913
[S14] round=67 local utility u=0.001002 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986530509187955, 'loss_val': 0.021675136645666, 'psi': 0.9976597252621173}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986530798583941, 'loss_val': 0.021218412892414124, 'psi': 0.9974135709098079}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=67 head_norm_before_train=1.718201 cos_to_last_merge=0.8802 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.880
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9006175980929763, 'auprc': 0.9165614459975018, 'loss_val': 0.3196694951656573, 'psi': 0.9069951372547865}-{'f1_val': 0.9646177840347826, 'auprc': 0.9937978689547864, 'loss_val': 0.0615639387114344, 'psi': 0.9762898180027841}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=1.820890 cos_to_last_merge=0.8322 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=67 local utility u=0.000000 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9961206553965863, 'loss_val': 0.0369280065199068, 'psi': 0.9935427975365843}-{'f1_val': 0.9922426511262559, 'auprc': 0.9960890676335532, 'loss_val': 0.03675963084382545, 'psi': 0.9937812177291748}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=67 head_norm_before_train=2.058394 cos_to_last_merge=0.7527 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.753
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6857157013201207, 'auprc': 0.8155533148931893, 'loss_val': 1.127122392786465, 'psi': 0.737650746749348}-{'f1_val': 0.8637397303335732, 'auprc': 0.9414949432909292, 'loss_val': 0.651078094203043, 'psi': 0.8948418155165155}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=2.140258 (no previous merge yet)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7085280437058245, 'auprc': 0.8646585716323181, 'loss_val': 0.6301388713026157, 'psi': 0.770980254876422}-{'f1_val': 0.7067658525197655, 'auprc': 0.8864058282595115, 'loss_val': 0.5441932697562639, 'psi': 0.7786218428156639}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.286021 (no previous merge yet)
[S3] round=68 local utility u=0.000000 metrics={'f1_val': 0.9208822284304294, 'auprc': 0.99848038449669, 'loss_val': 0.177715052488915, 'psi': 0.9519214908569337}-{'f1_val': 0.9576401306280063, 'auprc': 0.9987491229222873, 'loss_val': 0.11153496528661648, 'psi': 0.9740837275457188}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=68 head_norm_before_train=1.803548 cos_to_last_merge=0.8003 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9415672156207007, 'auprc': 0.9633213096208664, 'loss_val': 0.33615832144469954, 'psi': 0.9502688532207669}-{'f1_val': 0.9419044793539278, 'auprc': 0.971052529291039, 'loss_val': 0.33322149437896, 'psi': 0.9535636993287723}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.766561 cos_to_last_merge=0.7784 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.778
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9936575505268851, 'loss_val': 0.032385627955644355, 'psi': 0.9951746341963407}-{'f1_val': 0.996186023309311, 'auprc': 0.9940724594450783, 'loss_val': 0.033251829985007954, 'psi': 0.9953405977636179}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=2.097701 (no previous merge yet)
[S6] round=68 local utility u=0.000000 metrics={'f1_val': 0.6006504648666126, 'auprc': 0.8931838526910136, 'loss_val': 1.05078233102237, 'psi': 0.717663819996373}-{'f1_val': 0.784723052137111, 'auprc': 0.939745843112641, 'loss_val': 0.574141771592488, 'psi': 0.846732168527323}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=68 head_norm_before_train=1.847382 (no previous merge yet)
[S7] round=68 local utility u=1.000000 metrics={'f1_val': 0.7319712115421009, 'auprc': 0.8901761205712284, 'loss_val': 0.22187969766143256, 'psi': 0.7952531751537519}-{'f1_val': 0.47608004276954774, 'auprc': 0.7782285344691637, 'loss_val': 1.211717557526386, 'psi': 0.5969394394493941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=68 head_norm_before_train=1.687255 cos_to_last_merge=0.8382 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.838
[S8] round=68 local utility u=0.000000 metrics={'f1_val': 0.9824874841148288, 'auprc': 0.9986496215348881, 'loss_val': 0.05204657409374207, 'psi': 0.9889523390828525}-{'f1_val': 0.994057704452729, 'auprc': 0.9995004305621918, 'loss_val': 0.031624338318835446, 'psi': 0.9962347948965141}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=68 head_norm_before_train=1.728316 cos_to_last_merge=0.8755 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.875
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9952140550151931, 'loss_val': 0.02011225951110176, 'psi': 0.9963473695133629}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987242487043911, 'loss_val': 0.01973863246763642, 'psi': 0.9977514469890422}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=1.954646 cos_to_last_merge=0.8922 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.892
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9948446608352314, 'loss_val': 0.033701941129606214, 'psi': 0.9936132406323135}-{'f1_val': 0.9927922938303682, 'auprc': 0.9948711331385265, 'loss_val': 0.033371966463568714, 'psi': 0.9936238295536315}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=1.919948 cos_to_last_merge=0.9020 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9976703991507776, 'loss_val': 0.02328130984376322, 'psi': 0.9966155419360979}-{'f1_val': 0.9961541414107454, 'auprc': 0.9979124876602007, 'loss_val': 0.02315997572545126, 'psi': 0.9968574799105275}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=68 head_norm_before_train=1.942678 (no previous merge yet)
[S13] round=68 local utility u=0.000000 metrics={'f1_val': 0.6814404841460813, 'auprc': 0.813021816325386, 'loss_val': 1.0614778319218587, 'psi': 0.7340730170178031}-{'f1_val': 0.7309284977188163, 'auprc': 0.790398753145406, 'loss_val': 0.7678473921629304, 'psi': 0.7547165998894522}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=68 head_norm_before_train=1.712920 cos_to_last_merge=0.9120 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.912
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986543971410501, 'loss_val': 0.021542383497913587, 'psi': 0.9974140978228703}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986530509187955, 'loss_val': 0.021675136645666, 'psi': 0.9976597252621173}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.725928 cos_to_last_merge=0.8794 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.879
[S15] round=68 local utility u=0.094463 metrics={'f1_val': 0.9028906345848492, 'auprc': 0.9473274314255707, 'loss_val': 0.2366799769988441, 'psi': 0.9206653533211379}-{'f1_val': 0.9006175980929763, 'auprc': 0.9165614459975018, 'loss_val': 0.3196694951656573, 'psi': 0.9069951372547865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=68 head_norm_before_train=1.825531 cos_to_last_merge=0.8314 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=68 local utility u=0.000005 metrics={'f1_val': 0.9918242256299163, 'auprc': 0.9961359832695721, 'loss_val': 0.036964213091225114, 'psi': 0.9935489286857786}-{'f1_val': 0.9918242256299163, 'auprc': 0.9961206553965863, 'loss_val': 0.0369280065199068, 'psi': 0.9935427975365843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=68 head_norm_before_train=2.063799 cos_to_last_merge=0.7525 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=68 local utility u=0.026816 metrics={'f1_val': 0.6791355934838323, 'auprc': 0.8676529708623022, 'loss_val': 1.190307917640496, 'psi': 0.7545425444352203}-{'f1_val': 0.6857157013201207, 'auprc': 0.8155533148931893, 'loss_val': 1.127122392786465, 'psi': 0.737650746749348}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=69 head_norm_before_train=2.142245 (no previous merge yet)
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7361597702990003, 'auprc': 0.8004651341376268, 'loss_val': 0.8383296125011529, 'psi': 0.7618819158344509}-{'f1_val': 0.7085280437058245, 'auprc': 0.8646585716323181, 'loss_val': 0.6301388713026157, 'psi': 0.770980254876422}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.291646 (no previous merge yet)
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.9041829502372453, 'auprc': 0.9972547472737459, 'loss_val': 0.2186585741836442, 'psi': 0.9414116690518455}-{'f1_val': 0.9208822284304294, 'auprc': 0.99848038449669, 'loss_val': 0.177715052488915, 'psi': 0.9519214908569337}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.806993 cos_to_last_merge=0.8003 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=69 local utility u=0.000951 metrics={'f1_val': 0.9440585628008556, 'auprc': 0.9582842920965519, 'loss_val': 0.3340926053600478, 'psi': 0.9497488545191342}-{'f1_val': 0.9415672156207007, 'auprc': 0.9633213096208664, 'loss_val': 0.33615832144469954, 'psi': 0.9502688532207669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=69 head_norm_before_train=1.778794 cos_to_last_merge=0.7768 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.777
[S5] round=69 local utility u=0.006344 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9975068558350261, 'loss_val': 0.031246068491109537, 'psi': 0.996714356319597}-{'f1_val': 0.996186023309311, 'auprc': 0.9936575505268851, 'loss_val': 0.032385627955644355, 'psi': 0.9951746341963407}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=69 head_norm_before_train=2.104059 (no previous merge yet)
[S6] round=69 local utility u=0.261723 metrics={'f1_val': 0.6282301457731042, 'auprc': 0.9376982582683104, 'loss_val': 0.8263567345435392, 'psi': 0.7520173907711867}-{'f1_val': 0.6006504648666126, 'auprc': 0.8931838526910136, 'loss_val': 1.05078233102237, 'psi': 0.717663819996373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=69 head_norm_before_train=1.848680 (no previous merge yet)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.5882336351649685, 'auprc': 0.787014555212942, 'loss_val': 0.8108674160761882, 'psi': 0.667746003184158}-{'f1_val': 0.7319712115421009, 'auprc': 0.8901761205712284, 'loss_val': 0.22187969766143256, 'psi': 0.7952531751537519}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.692771 cos_to_last_merge=0.8374 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=69 local utility u=0.027368 metrics={'f1_val': 0.9892104968014376, 'auprc': 0.9987360734575728, 'loss_val': 0.03790848922432311, 'psi': 0.9930207274638917}-{'f1_val': 0.9824874841148288, 'auprc': 0.9986496215348881, 'loss_val': 0.05204657409374207, 'psi': 0.9889523390828525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=69 head_norm_before_train=1.734980 cos_to_last_merge=0.8749 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.875
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9987793903249655, 'loss_val': 0.037791328893457175, 'psi': 0.9938548611897212}-{'f1_val': 0.9971029125121428, 'auprc': 0.9952140550151931, 'loss_val': 0.02011225951110176, 'psi': 0.9963473695133629}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=1.961466 cos_to_last_merge=0.8913 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9932238382690217, 'loss_val': 0.03239876974018496, 'psi': 0.9930963470140446}-{'f1_val': 0.9927922938303682, 'auprc': 0.9948446608352314, 'loss_val': 0.033701941129606214, 'psi': 0.9936132406323135}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=1.926711 cos_to_last_merge=0.9016 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.902
[S11] round=69 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9975675724662153, 'loss_val': 0.024177280900305936, 'psi': 0.996574411262273}-{'f1_val': 0.9959123037929781, 'auprc': 0.9976703991507776, 'loss_val': 0.02328130984376322, 'psi': 0.9966155419360979}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=69 head_norm_before_train=1.944642 (no previous merge yet)
[S13] round=69 local utility u=0.056164 metrics={'f1_val': 0.7350118289048795, 'auprc': 0.7227735715503494, 'loss_val': 0.9998333489902612, 'psi': 0.7301165259630675}-{'f1_val': 0.6814404841460813, 'auprc': 0.813021816325386, 'loss_val': 1.0614778319218587, 'psi': 0.7340730170178031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=69 head_norm_before_train=1.718124 cos_to_last_merge=0.9115 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.911
[S14] round=69 local utility u=0.000225 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986560601103197, 'loss_val': 0.021096732021838552, 'psi': 0.9974147630105781}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986543971410501, 'loss_val': 0.021542383497913587, 'psi': 0.9974140978228703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=69 head_norm_before_train=1.733610 cos_to_last_merge=0.8787 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.879
[S15] round=69 local utility u=0.447561 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9888893203113527, 'loss_val': 0.026798954781939693, 'psi': 0.9933455908970937}-{'f1_val': 0.9028906345848492, 'auprc': 0.9473274314255707, 'loss_val': 0.2366799769988441, 'psi': 0.9206653533211379}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=69 head_norm_before_train=1.830482 cos_to_last_merge=0.8308 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.831
[S16] round=69 local utility u=0.001436 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9961846202000539, 'loss_val': 0.036748370034975865, 'psi': 0.9938194387557752}-{'f1_val': 0.9918242256299163, 'auprc': 0.9961359832695721, 'loss_val': 0.036964213091225114, 'psi': 0.9935489286857786}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=69 head_norm_before_train=2.070770 cos_to_last_merge=0.7522 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6374166330952998, 'auprc': 0.9619551908034609, 'loss_val': 1.4049685923789808, 'psi': 0.7672320561785643}-{'f1_val': 0.6791355934838323, 'auprc': 0.8676529708623022, 'loss_val': 1.190307917640496, 'psi': 0.7545425444352203}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.143472 (no previous merge yet)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.6016236878261375, 'auprc': 0.7807075407576887, 'loss_val': 1.320543210208555, 'psi': 0.673257228998758}-{'f1_val': 0.7361597702990003, 'auprc': 0.8004651341376268, 'loss_val': 0.8383296125011529, 'psi': 0.7618819158344509}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.297497 (no previous merge yet)
[S3] round=70 local utility u=0.122605 metrics={'f1_val': 0.9317301414218997, 'auprc': 0.9982798441204563, 'loss_val': 0.1418071665826346, 'psi': 0.9583500225013224}-{'f1_val': 0.9041829502372453, 'auprc': 0.9972547472737459, 'loss_val': 0.2186585741836442, 'psi': 0.9414116690518455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=70 head_norm_before_train=1.807532 cos_to_last_merge=0.8007 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=70 local utility u=0.002622 metrics={'f1_val': 0.9490833264188561, 'auprc': 0.9485810040174582, 'loss_val': 0.32988685907861337, 'psi': 0.948882397458297}-{'f1_val': 0.9440585628008556, 'auprc': 0.9582842920965519, 'loss_val': 0.3340926053600478, 'psi': 0.9497488545191342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=70 head_norm_before_train=1.786764 cos_to_last_merge=0.7753 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.775
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.989658656106286, 'loss_val': 0.045850561205957, 'psi': 0.9934875919813468}-{'f1_val': 0.996186023309311, 'auprc': 0.9975068558350261, 'loss_val': 0.031246068491109537, 'psi': 0.996714356319597}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=2.108868 (no previous merge yet)
[S6] round=70 local utility u=0.712286 metrics={'f1_val': 0.8040232842554443, 'auprc': 0.9516664853041705, 'loss_val': 0.4984479548102191, 'psi': 0.8630805646749349}-{'f1_val': 0.6282301457731042, 'auprc': 0.9376982582683104, 'loss_val': 0.8263567345435392, 'psi': 0.7520173907711867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=70 head_norm_before_train=1.850281 (no previous merge yet)
[S7] round=70 local utility u=0.628299 metrics={'f1_val': 0.6812654510907121, 'auprc': 0.8428232523272103, 'loss_val': 0.279887034603584, 'psi': 0.7458885715853114}-{'f1_val': 0.5882336351649685, 'auprc': 0.787014555212942, 'loss_val': 0.8108674160761882, 'psi': 0.667746003184158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=70 head_norm_before_train=1.697734 cos_to_last_merge=0.8369 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.837
[S8] round=70 local utility u=0.017901 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9992072168913592, 'loss_val': 0.028207138330526967, 'psi': 0.9956778871348282}-{'f1_val': 0.9892104968014376, 'auprc': 0.9987360734575728, 'loss_val': 0.03790848922432311, 'psi': 0.9930207274638917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=70 head_norm_before_train=1.741741 cos_to_last_merge=0.8743 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.874
[S9] round=70 local utility u=0.022134 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9952319296531751, 'loss_val': 0.020565113857137135, 'psi': 0.9962043231166244}-{'f1_val': 0.9905718417662249, 'auprc': 0.9987793903249655, 'loss_val': 0.037791328893457175, 'psi': 0.9938548611897212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=70 head_norm_before_train=1.968684 cos_to_last_merge=0.8907 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=70 local utility u=0.000105 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9933312796960803, 'loss_val': 0.032511847881146465, 'psi': 0.993139323584868}-{'f1_val': 0.9930113528440598, 'auprc': 0.9932238382690217, 'loss_val': 0.03239876974018496, 'psi': 0.9930963470140446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=70 head_norm_before_train=1.934036 cos_to_last_merge=0.9011 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=70 local utility u=0.000000 metrics={'f1_val': 0.9470168987702531, 'auprc': 0.9901118480214179, 'loss_val': 0.3435644907089012, 'psi': 0.964254878470719}-{'f1_val': 0.9959123037929781, 'auprc': 0.9975675724662153, 'loss_val': 0.024177280900305936, 'psi': 0.996574411262273}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=70 head_norm_before_train=1.948075 (no previous merge yet)
[S13] round=70 local utility u=0.344756 metrics={'f1_val': 0.7558410964790931, 'auprc': 0.8054667813448939, 'loss_val': 0.6833757441496189, 'psi': 0.7756913704254135}-{'f1_val': 0.7350118289048795, 'auprc': 0.7227735715503494, 'loss_val': 0.9998333489902612, 'psi': 0.7301165259630675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=70 head_norm_before_train=1.724600 cos_to_last_merge=0.9110 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.911
[S14] round=70 local utility u=0.000130 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986562098116445, 'loss_val': 0.02083643213351998, 'psi': 0.9974148228911079}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986560601103197, 'loss_val': 0.021096732021838552, 'psi': 0.9974147630105781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=70 head_norm_before_train=1.740767 cos_to_last_merge=0.8780 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.878
[S15] round=70 local utility u=0.000000 metrics={'f1_val': 0.9115868110382656, 'auprc': 0.9941840270760034, 'loss_val': 0.15099615092335614, 'psi': 0.9446256974533607}-{'f1_val': 0.9963164379542544, 'auprc': 0.9888893203113527, 'loss_val': 0.026798954781939693, 'psi': 0.9933455908970937}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=70 head_norm_before_train=1.835005 cos_to_last_merge=0.8304 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=70 local utility u=0.000000 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9961791240300621, 'loss_val': 0.036741949234406136, 'psi': 0.9938172402877784}-{'f1_val': 0.9922426511262559, 'auprc': 0.9961846202000539, 'loss_val': 0.036748370034975865, 'psi': 0.9938194387557752}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=70 head_norm_before_train=2.077075 cos_to_last_merge=0.7521 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=70 local utility u=0.172038 metrics={'f1_val': 0.6465569007253256, 'auprc': 0.9899766272507963, 'loss_val': 1.1997975088060648, 'psi': 0.7839247913355138}-{'f1_val': 0.6374166330952998, 'auprc': 0.9619551908034609, 'loss_val': 1.4049685923789808, 'psi': 0.7672320561785643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=71 head_norm_before_train=2.145547 (no previous merge yet)
[S2] round=71 local utility u=0.771833 metrics={'f1_val': 0.7245594616516357, 'auprc': 0.8376703828422856, 'loss_val': 0.685379861565118, 'psi': 0.7698038301278955}-{'f1_val': 0.6016236878261375, 'auprc': 0.7807075407576887, 'loss_val': 1.320543210208555, 'psi': 0.673257228998758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=71 head_norm_before_train=2.303389 (no previous merge yet)
[S3] round=71 local utility u=0.069066 metrics={'f1_val': 0.9487309632079886, 'auprc': 0.9986754211126287, 'loss_val': 0.1068671495023332, 'psi': 0.9687087463698447}-{'f1_val': 0.9317301414218997, 'auprc': 0.9982798441204563, 'loss_val': 0.1418071665826346, 'psi': 0.9583500225013224}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=71 head_norm_before_train=1.808345 cos_to_last_merge=0.8008 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9397724514754406, 'auprc': 0.9660347870545547, 'loss_val': 0.3413327801105122, 'psi': 0.9502773857070863}-{'f1_val': 0.9490833264188561, 'auprc': 0.9485810040174582, 'loss_val': 0.32988685907861337, 'psi': 0.948882397458297}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.791168 cos_to_last_merge=0.7745 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.774
[S5] round=71 local utility u=0.016186 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9953350943974572, 'loss_val': 0.03138176101949213, 'psi': 0.9958456517445695}-{'f1_val': 0.9960402158980539, 'auprc': 0.989658656106286, 'loss_val': 0.045850561205957, 'psi': 0.9934875919813468}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=71 head_norm_before_train=2.113827 (no previous merge yet)
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6567108511967327, 'auprc': 0.9328749180183766, 'loss_val': 0.6860792828682354, 'psi': 0.7671764779253902}-{'f1_val': 0.8040232842554443, 'auprc': 0.9516664853041705, 'loss_val': 0.4984479548102191, 'psi': 0.8630805646749349}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.852460 (no previous merge yet)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.6241474274526579, 'auprc': 0.797705682779763, 'loss_val': 0.6368027194041357, 'psi': 0.6935707295834999}-{'f1_val': 0.6812654510907121, 'auprc': 0.8428232523272103, 'loss_val': 0.279887034603584, 'psi': 0.7458885715853114}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.704156 cos_to_last_merge=0.8364 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.836
[S8] round=71 local utility u=0.002839 metrics={'f1_val': 0.994057704452729, 'auprc': 0.9994637953090171, 'loss_val': 0.027694752201032166, 'psi': 0.9962201407952442}-{'f1_val': 0.9933250006304741, 'auprc': 0.9992072168913592, 'loss_val': 0.028207138330526967, 'psi': 0.9956778871348282}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=71 head_norm_before_train=1.746727 cos_to_last_merge=0.8737 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.874
[S9] round=71 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9936738921169286, 'loss_val': 0.020624270942593642, 'psi': 0.9957313043540571}-{'f1_val': 0.9968525854255906, 'auprc': 0.9952319296531751, 'loss_val': 0.020565113857137135, 'psi': 0.9962043231166244}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=71 head_norm_before_train=1.973778 cos_to_last_merge=0.8901 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.890
[S10] round=71 local utility u=0.001385 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9949442797445797, 'loss_val': 0.033266054454932546, 'psi': 0.9936530881960528}-{'f1_val': 0.9930113528440598, 'auprc': 0.9933312796960803, 'loss_val': 0.032511847881146465, 'psi': 0.993139323584868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=71 head_norm_before_train=1.938678 cos_to_last_merge=0.9008 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=71 local utility u=0.313297 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9972682942788567, 'loss_val': 0.0343146474291965, 'psi': 0.9967049640081569}-{'f1_val': 0.9470168987702531, 'auprc': 0.9901118480214179, 'loss_val': 0.3435644907089012, 'psi': 0.964254878470719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=71 head_norm_before_train=1.953822 (no previous merge yet)
[S13] round=71 local utility u=0.000000 metrics={'f1_val': 0.7358398115579079, 'auprc': 0.7571970648149321, 'loss_val': 0.8035294418353733, 'psi': 0.7443827128607177}-{'f1_val': 0.7558410964790931, 'auprc': 0.8054667813448939, 'loss_val': 0.6833757441496189, 'psi': 0.7756913704254135}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=71 head_norm_before_train=1.730056 cos_to_last_merge=0.9104 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.910
[S14] round=71 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986420509565401, 'loss_val': 0.023666843799295678, 'psi': 0.9976553252772151}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986562098116445, 'loss_val': 0.02083643213351998, 'psi': 0.9974148228911079}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=71 head_norm_before_train=1.748176 cos_to_last_merge=0.8773 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.877
[S15] round=71 local utility u=0.196765 metrics={'f1_val': 0.9640639500241348, 'auprc': 0.9944458651529662, 'loss_val': 0.07311505722878756, 'psi': 0.9762167160756674}-{'f1_val': 0.9115868110382656, 'auprc': 0.9941840270760034, 'loss_val': 0.15099615092335614, 'psi': 0.9446256974533607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=71 head_norm_before_train=1.840804 cos_to_last_merge=0.8299 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.830
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.9922426511262559, 'auprc': 0.9961767281350831, 'loss_val': 0.03678966405568185, 'psi': 0.9938162819297868}-{'f1_val': 0.9922426511262559, 'auprc': 0.9961791240300621, 'loss_val': 0.036741949234406136, 'psi': 0.9938172402877784}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=2.083463 cos_to_last_merge=0.7520 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=71 local utility u=0.573356 metrics={'f1_val': 0.7565116510894394, 'auprc': 0.9875587441247281, 'loss_val': 0.7055609368106819, 'psi': 0.8489304883035549}-{'f1_val': 0.6465569007253256, 'auprc': 0.9899766272507963, 'loss_val': 1.1997975088060648, 'psi': 0.7839247913355138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=72 head_norm_before_train=2.149191 (no previous merge yet)
[S2] round=72 local utility u=0.016351 metrics={'f1_val': 0.7115954394014906, 'auprc': 0.8684383528080295, 'loss_val': 0.667197555199458, 'psi': 0.7743326047641061}-{'f1_val': 0.7245594616516357, 'auprc': 0.8376703828422856, 'loss_val': 0.685379861565118, 'psi': 0.7698038301278955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S2] sending update (kind=head size=1794 to 1 peers)
[S3] START round=72 head_norm_before_train=2.309343 (no previous merge yet)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.9475848400174219, 'auprc': 0.9988437950628852, 'loss_val': 0.13749240313685587, 'psi': 0.9680884220356073}-{'f1_val': 0.9487309632079886, 'auprc': 0.9986754211126287, 'loss_val': 0.1068671495023332, 'psi': 0.9687087463698447}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=1.811008 cos_to_last_merge=0.8003 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=72 local utility u=0.001847 metrics={'f1_val': 0.9399928703883405, 'auprc': 0.9666692353957327, 'loss_val': 0.34086441484678454, 'psi': 0.9506634163912973}-{'f1_val': 0.9397724514754406, 'auprc': 0.9660347870545547, 'loss_val': 0.3413327801105122, 'psi': 0.9502773857070863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=72 head_norm_before_train=1.792744 cos_to_last_merge=0.7743 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.774
[S5] round=72 local utility u=0.001650 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9962803920463937, 'loss_val': 0.0309178752321116, 'psi': 0.9962237708041441}-{'f1_val': 0.996186023309311, 'auprc': 0.9953350943974572, 'loss_val': 0.03138176101949213, 'psi': 0.9958456517445695}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=72 head_norm_before_train=2.122193 (no previous merge yet)
[S6] round=72 local utility u=0.903615 metrics={'f1_val': 0.8717329888998744, 'auprc': 0.9709489150012975, 'loss_val': 0.28320388174792716, 'psi': 0.9114193593404436}-{'f1_val': 0.6567108511967327, 'auprc': 0.9328749180183766, 'loss_val': 0.6860792828682354, 'psi': 0.7671764779253902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=72 head_norm_before_train=1.855288 (no previous merge yet)
[S7] round=72 local utility u=0.059904 metrics={'f1_val': 0.6279212125937759, 'auprc': 0.8016495698154031, 'loss_val': 0.5514684072274293, 'psi': 0.6974125554824268}-{'f1_val': 0.6241474274526579, 'auprc': 0.797705682779763, 'loss_val': 0.6368027194041357, 'psi': 0.6935707295834999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=72 head_norm_before_train=1.710997 cos_to_last_merge=0.8357 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.836
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9943863538992247, 'auprc': 0.999248002288161, 'loss_val': 0.04551187633606154, 'psi': 0.9963310132547992}-{'f1_val': 0.994057704452729, 'auprc': 0.9994637953090171, 'loss_val': 0.027694752201032166, 'psi': 0.9962201407952442}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=72 head_norm_before_train=1.752288 cos_to_last_merge=0.8731 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9931013102599968, 'loss_val': 0.020077456272859687, 'psi': 0.9955022716112845}-{'f1_val': 0.9971029125121428, 'auprc': 0.9936738921169286, 'loss_val': 0.020624270942593642, 'psi': 0.9957313043540571}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=1.976890 cos_to_last_merge=0.8892 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.889
[S10] round=72 local utility u=0.000306 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9949352899984432, 'loss_val': 0.03262639410504777, 'psi': 0.9936494922975981}-{'f1_val': 0.9927922938303682, 'auprc': 0.9949442797445797, 'loss_val': 0.033266054454932546, 'psi': 0.9936530881960528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=72 head_norm_before_train=1.942145 cos_to_last_merge=0.9006 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.901
[S11] round=72 local utility u=0.000439 metrics={'f1_val': 0.9963294104943571, 'auprc': 0.9975910291589821, 'loss_val': 0.0344054426328843, 'psi': 0.9968340579602071}-{'f1_val': 0.9963294104943571, 'auprc': 0.9972682942788567, 'loss_val': 0.0343146474291965, 'psi': 0.9967049640081569}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=72 head_norm_before_train=1.958158 (no previous merge yet)
[S13] round=72 local utility u=0.021784 metrics={'f1_val': 0.7474520298796443, 'auprc': 0.7664186494393859, 'loss_val': 0.8572990335856516, 'psi': 0.7550386777035409}-{'f1_val': 0.7358398115579079, 'auprc': 0.7571970648149321, 'loss_val': 0.8035294418353733, 'psi': 0.7443827128607177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=72 head_norm_before_train=1.735033 cos_to_last_merge=0.9099 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.910
[S14] round=72 local utility u=0.001366 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9989990099047814, 'loss_val': 0.019543068925679516, 'psi': 0.9975519429283628}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986420509565401, 'loss_val': 0.023666843799295678, 'psi': 0.9976553252772151}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=72 head_norm_before_train=1.754878 cos_to_last_merge=0.8768 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.877
[S15] round=72 local utility u=0.000000 metrics={'f1_val': 0.9011831863444748, 'auprc': 0.9268369829624377, 'loss_val': 0.29574313713075917, 'psi': 0.9114447049916599}-{'f1_val': 0.9640639500241348, 'auprc': 0.9944458651529662, 'loss_val': 0.07311505722878756, 'psi': 0.9762167160756674}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=72 head_norm_before_train=1.844672 cos_to_last_merge=0.8292 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.829
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9963787497971937, 'loss_val': 0.03678137408523739, 'psi': 0.9937653908315035}-{'f1_val': 0.9922426511262559, 'auprc': 0.9961767281350831, 'loss_val': 0.03678966405568185, 'psi': 0.9938162819297868}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=2.090600 cos_to_last_merge=0.7518 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.6391971327475645, 'auprc': 0.9649521064885958, 'loss_val': 1.3857060590926025, 'psi': 0.769499122243977}-{'f1_val': 0.7565116510894394, 'auprc': 0.9875587441247281, 'loss_val': 0.7055609368106819, 'psi': 0.8489304883035549}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.153850 (no previous merge yet)
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.711889329160549, 'auprc': 0.8564008915734229, 'loss_val': 0.7094557291829614, 'psi': 0.7696939541256986}-{'f1_val': 0.7115954394014906, 'auprc': 0.8684383528080295, 'loss_val': 0.667197555199458, 'psi': 0.7743326047641061}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.315162 (no previous merge yet)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.7766827764436642, 'auprc': 0.9631344059450712, 'loss_val': 0.6565260513514927, 'psi': 0.8512634282442271}-{'f1_val': 0.9475848400174219, 'auprc': 0.9988437950628852, 'loss_val': 0.13749240313685587, 'psi': 0.9680884220356073}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.815701 cos_to_last_merge=0.7994 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=73 local utility u=0.000000 metrics={'f1_val': 0.9407508479159031, 'auprc': 0.9619920512526342, 'loss_val': 0.3412241001239094, 'psi': 0.9492473292505955}-{'f1_val': 0.9399928703883405, 'auprc': 0.9666692353957327, 'loss_val': 0.34086441484678454, 'psi': 0.9506634163912973}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=73 head_norm_before_train=1.798787 cos_to_last_merge=0.7737 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.774
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9920696978533009, 'loss_val': 0.031262199180209865, 'psi': 0.9945394931269069}-{'f1_val': 0.996186023309311, 'auprc': 0.9962803920463937, 'loss_val': 0.0309178752321116, 'psi': 0.9962237708041441}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=2.129708 (no previous merge yet)
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.8064439710475693, 'auprc': 0.9608668081743891, 'loss_val': 0.5641555024817907, 'psi': 0.8682131058982971}-{'f1_val': 0.8717329888998744, 'auprc': 0.9709489150012975, 'loss_val': 0.28320388174792716, 'psi': 0.9114193593404436}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.859637 (no previous merge yet)
[S7] round=73 local utility u=0.057057 metrics={'f1_val': 0.638449431387901, 'auprc': 0.8056698731003757, 'loss_val': 0.5125839755232982, 'psi': 0.7053376080728909}-{'f1_val': 0.6279212125937759, 'auprc': 0.8016495698154031, 'loss_val': 0.5514684072274293, 'psi': 0.6974125554824268}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=73 head_norm_before_train=1.716458 cos_to_last_merge=0.8350 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.835
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.979235269732088, 'auprc': 0.9881117238553985, 'loss_val': 0.08777916336455531, 'psi': 0.9827858513814122}-{'f1_val': 0.9943863538992247, 'auprc': 0.999248002288161, 'loss_val': 0.04551187633606154, 'psi': 0.9963310132547992}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=1.757332 cos_to_last_merge=0.8728 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=73 local utility u=0.005016 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9987763332337241, 'loss_val': 0.02057731243987316, 'psi': 0.9971229544798019}-{'f1_val': 0.9971029125121428, 'auprc': 0.9931013102599968, 'loss_val': 0.020077456272859687, 'psi': 0.9955022716112845}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=73 head_norm_before_train=1.980564 cos_to_last_merge=0.8873 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.887
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.993193148367621, 'loss_val': 0.0306985912705328, 'psi': 0.9932155503791404}-{'f1_val': 0.9927922938303682, 'auprc': 0.9949352899984432, 'loss_val': 0.03262639410504777, 'psi': 0.9936494922975981}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=1.945746 cos_to_last_merge=0.9003 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=73 local utility u=0.000000 metrics={'f1_val': 0.8213393562584652, 'auprc': 0.9965801936516128, 'loss_val': 0.2505577251613851, 'psi': 0.8914356912157242}-{'f1_val': 0.9963294104943571, 'auprc': 0.9975910291589821, 'loss_val': 0.0344054426328843, 'psi': 0.9968340579602071}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=73 head_norm_before_train=1.960702 (no previous merge yet)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.7410741173531719, 'auprc': 0.7315738614398192, 'loss_val': 1.0383266506527948, 'psi': 0.7372740149878307}-{'f1_val': 0.7474520298796443, 'auprc': 0.7664186494393859, 'loss_val': 0.8572990335856516, 'psi': 0.7550386777035409}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=73 head_norm_before_train=1.741074 cos_to_last_merge=0.9094 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.909
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986525500889607, 'loss_val': 0.021774191876774273, 'psi': 0.9976595249301834}-{'f1_val': 0.9965872316107504, 'auprc': 0.9989990099047814, 'loss_val': 0.019543068925679516, 'psi': 0.9975519429283628}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.761334 cos_to_last_merge=0.8764 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=73 local utility u=0.000000 metrics={'f1_val': 0.9000604636137368, 'auprc': 0.9201321251927064, 'loss_val': 0.32784786746021954, 'psi': 0.9080891282453246}-{'f1_val': 0.9011831863444748, 'auprc': 0.9268369829624377, 'loss_val': 0.29574313713075917, 'psi': 0.9114447049916599}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=73 head_norm_before_train=1.848272 cos_to_last_merge=0.8284 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.828
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9963558935585073, 'loss_val': 0.03686274744161227, 'psi': 0.9937562483360289}-{'f1_val': 0.9920231515210434, 'auprc': 0.9963787497971937, 'loss_val': 0.03678137408523739, 'psi': 0.9937653908315035}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=2.097530 cos_to_last_merge=0.7518 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.646603747702546, 'auprc': 0.84091092078809, 'loss_val': 1.350092907367117, 'psi': 0.7243266169367637}-{'f1_val': 0.6391971327475645, 'auprc': 0.9649521064885958, 'loss_val': 1.3857060590926025, 'psi': 0.769499122243977}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=74 head_norm_before_train=2.159616 (no previous merge yet)
[S2] round=74 local utility u=0.012717 metrics={'f1_val': 0.7117151573594552, 'auprc': 0.8675875700894322, 'loss_val': 0.7165373490497956, 'psi': 0.774064122451446}-{'f1_val': 0.711889329160549, 'auprc': 0.8564008915734229, 'loss_val': 0.7094557291829614, 'psi': 0.7696939541256986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=74 head_norm_before_train=2.320051 (no previous merge yet)
[S3] round=74 local utility u=0.366735 metrics={'f1_val': 0.8381031644475512, 'auprc': 0.9945368540453274, 'loss_val': 0.3857849602614128, 'psi': 0.9006766402866617}-{'f1_val': 0.7766827764436642, 'auprc': 0.9631344059450712, 'loss_val': 0.6565260513514927, 'psi': 0.8512634282442271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=74 head_norm_before_train=1.822834 cos_to_last_merge=0.7981 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9412274168909067, 'auprc': 0.9569617677078102, 'loss_val': 0.3424747708197549, 'psi': 0.947521157217668}-{'f1_val': 0.9407508479159031, 'auprc': 0.9619920512526342, 'loss_val': 0.3412241001239094, 'psi': 0.9492473292505955}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=1.806548 cos_to_last_merge=0.7728 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.773
[S5] round=74 local utility u=0.004202 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9941516861978484, 'loss_val': 0.029103905925274984, 'psi': 0.995372288464726}-{'f1_val': 0.996186023309311, 'auprc': 0.9920696978533009, 'loss_val': 0.031262199180209865, 'psi': 0.9945394931269069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=74 head_norm_before_train=2.135197 (no previous merge yet)
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.7901233471030435, 'auprc': 0.9521401329223037, 'loss_val': 0.5986634744748976, 'psi': 0.8549300614307476}-{'f1_val': 0.8064439710475693, 'auprc': 0.9608668081743891, 'loss_val': 0.5641555024817907, 'psi': 0.8682131058982971}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.864498 (no previous merge yet)
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.6166688752423217, 'auprc': 0.7962340898286374, 'loss_val': 0.7201857627342535, 'psi': 0.688494961076848}-{'f1_val': 0.638449431387901, 'auprc': 0.8056698731003757, 'loss_val': 0.5125839755232982, 'psi': 0.7053376080728909}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=1.721925 cos_to_last_merge=0.8346 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.835
[S8] round=74 local utility u=0.078280 metrics={'f1_val': 0.9930245652882546, 'auprc': 0.9992211117333403, 'loss_val': 0.04728275881089018, 'psi': 0.9955031838662889}-{'f1_val': 0.979235269732088, 'auprc': 0.9881117238553985, 'loss_val': 0.08777916336455531, 'psi': 0.9827858513814122}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=74 head_norm_before_train=1.759983 cos_to_last_merge=0.8728 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.99518968612894, 'auprc': 0.9987645737130542, 'loss_val': 0.022645366114179652, 'psi': 0.9966196411625856}-{'f1_val': 0.9960207019771873, 'auprc': 0.9987763332337241, 'loss_val': 0.02057731243987316, 'psi': 0.9971229544798019}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=1.982979 cos_to_last_merge=0.8858 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.886
[S10] round=74 local utility u=0.000168 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9932445260650886, 'loss_val': 0.030515966207943314, 'psi': 0.9932361014581275}-{'f1_val': 0.9932304850534869, 'auprc': 0.993193148367621, 'loss_val': 0.0306985912705328, 'psi': 0.9932155503791404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=74 head_norm_before_train=1.950041 cos_to_last_merge=0.9000 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=74 local utility u=0.639421 metrics={'f1_val': 0.9958918378685807, 'auprc': 0.9981118960618022, 'loss_val': 0.023625527747614464, 'psi': 0.9967798611458694}-{'f1_val': 0.8213393562584652, 'auprc': 0.9965801936516128, 'loss_val': 0.2505577251613851, 'psi': 0.8914356912157242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=74 head_norm_before_train=1.965796 (no previous merge yet)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6366780909729948, 'auprc': 0.7832543216241061, 'loss_val': 0.910106202705951, 'psi': 0.6953085832334394}-{'f1_val': 0.7410741173531719, 'auprc': 0.7315738614398192, 'loss_val': 1.0383266506527948, 'psi': 0.7372740149878307}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=74 head_norm_before_train=1.747354 cos_to_last_merge=0.9091 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.909
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9965872316107504, 'auprc': 0.9986526502278121, 'loss_val': 0.020215256550980606, 'psi': 0.9974133990575751}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986525500889607, 'loss_val': 0.021774191876774273, 'psi': 0.9976595249301834}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=1.768008 cos_to_last_merge=0.8759 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.876
[S15] round=74 local utility u=0.554884 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9943292314109062, 'loss_val': 0.020787601305413992, 'psi': 0.9957796935968748}-{'f1_val': 0.9000604636137368, 'auprc': 0.9201321251927064, 'loss_val': 0.32784786746021954, 'psi': 0.9080891282453246}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=74 head_norm_before_train=1.852886 cos_to_last_merge=0.8277 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.828
[S16] round=74 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9963520093999413, 'loss_val': 0.03703743400681039, 'psi': 0.9937546946726026}-{'f1_val': 0.9920231515210434, 'auprc': 0.9963558935585073, 'loss_val': 0.03686274744161227, 'psi': 0.9937562483360289}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=74 head_norm_before_train=2.103789 cos_to_last_merge=0.7516 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.752
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.6580455545037078, 'auprc': 0.807581423413147, 'loss_val': 1.3458510242433432, 'psi': 0.7178599020674835}-{'f1_val': 0.646603747702546, 'auprc': 0.84091092078809, 'loss_val': 1.350092907367117, 'psi': 0.7243266169367637}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.163420 (no previous merge yet)
[S2] round=75 local utility u=0.323314 metrics={'f1_val': 0.7282398248833509, 'auprc': 0.9705096234277665, 'loss_val': 0.4778226351865775, 'psi': 0.8251477443011173}-{'f1_val': 0.7117151573594552, 'auprc': 0.8675875700894322, 'loss_val': 0.7165373490497956, 'psi': 0.774064122451446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=75 head_norm_before_train=2.325139 (no previous merge yet)
[S3] round=75 local utility u=0.509675 metrics={'f1_val': 0.9569289292894955, 'auprc': 0.998748958175322, 'loss_val': 0.09202588410443312, 'psi': 0.973656940843826}-{'f1_val': 0.8381031644475512, 'auprc': 0.9945368540453274, 'loss_val': 0.3857849602614128, 'psi': 0.9006766402866617}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=75 head_norm_before_train=1.829566 cos_to_last_merge=0.7972 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=75 local utility u=0.005714 metrics={'f1_val': 0.9421264848597984, 'auprc': 0.9586807507965066, 'loss_val': 0.3415985885506963, 'psi': 0.9487481912344817}-{'f1_val': 0.9412274168909067, 'auprc': 0.9569617677078102, 'loss_val': 0.3424747708197549, 'psi': 0.947521157217668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=75 head_norm_before_train=1.818018 cos_to_last_merge=0.7715 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.991759676037497, 'loss_val': 0.031481163468239856, 'psi': 0.9943279999538313}-{'f1_val': 0.996186023309311, 'auprc': 0.9941516861978484, 'loss_val': 0.029103905925274984, 'psi': 0.995372288464726}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=2.138109 (no previous merge yet)
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6161949696256588, 'auprc': 0.7589735462374072, 'loss_val': 1.0540401289048182, 'psi': 0.6733064002703582}-{'f1_val': 0.7901233471030435, 'auprc': 0.9521401329223037, 'loss_val': 0.5986634744748976, 'psi': 0.8549300614307476}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.868271 (no previous merge yet)
[S7] round=75 local utility u=0.058186 metrics={'f1_val': 0.6342348595750016, 'auprc': 0.7962140651357229, 'loss_val': 0.7091496174659606, 'psi': 0.6990265417992901}-{'f1_val': 0.6166688752423217, 'auprc': 0.7962340898286374, 'loss_val': 0.7201857627342535, 'psi': 0.688494961076848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=75 head_norm_before_train=1.724887 cos_to_last_merge=0.8344 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.834
[S8] round=75 local utility u=0.004230 metrics={'f1_val': 0.9927378939946618, 'auprc': 0.9990911276542027, 'loss_val': 0.036713751990752726, 'psi': 0.9952791874584782}-{'f1_val': 0.9930245652882546, 'auprc': 0.9992211117333403, 'loss_val': 0.04728275881089018, 'psi': 0.9955031838662889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=75 head_norm_before_train=1.764324 cos_to_last_merge=0.8725 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.873
[S9] round=75 local utility u=0.000954 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9945187605898013, 'loss_val': 0.019480042490634644, 'psi': 0.9960692517432062}-{'f1_val': 0.99518968612894, 'auprc': 0.9987645737130542, 'loss_val': 0.022645366114179652, 'psi': 0.9966196411625856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=75 head_norm_before_train=1.987999 cos_to_last_merge=0.8848 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.885
[S10] round=75 local utility u=0.000360 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9950086140346893, 'loss_val': 0.03245953930654112, 'psi': 0.9936788219120967}-{'f1_val': 0.9932304850534869, 'auprc': 0.9932445260650886, 'loss_val': 0.030515966207943314, 'psi': 0.9932361014581275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=75 head_norm_before_train=1.955829 cos_to_last_merge=0.8997 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.900
[S11] round=75 local utility u=0.000514 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9975689451975606, 'loss_val': 0.0234484277543193, 'psi': 0.9968106785603408}-{'f1_val': 0.9958918378685807, 'auprc': 0.9981118960618022, 'loss_val': 0.023625527747614464, 'psi': 0.9967798611458694}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=75 head_norm_before_train=1.968974 (no previous merge yet)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.6376188160435814, 'auprc': 0.7730690093595295, 'loss_val': 0.989467939332115, 'psi': 0.6917988933699606}-{'f1_val': 0.6366780909729948, 'auprc': 0.7832543216241061, 'loss_val': 0.910106202705951, 'psi': 0.6953085832334394}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=1.751240 cos_to_last_merge=0.9086 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.909
[S14] round=75 local utility u=0.001420 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9986526052126753, 'loss_val': 0.019836600792064042, 'psi': 0.9976595469796692}-{'f1_val': 0.9965872316107504, 'auprc': 0.9986526502278121, 'loss_val': 0.020215256550980606, 'psi': 0.9974133990575751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=75 head_norm_before_train=1.774359 cos_to_last_merge=0.8754 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.9964514311198632, 'loss_val': 0.23654060718906275, 'psi': 0.9408247232151472}-{'f1_val': 0.9967466683875206, 'auprc': 0.9943292314109062, 'loss_val': 0.020787601305413992, 'psi': 0.9957796935968748}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=1.858612 cos_to_last_merge=0.8271 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.827
[S16] round=75 local utility u=0.000012 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.9963242152542632, 'loss_val': 0.03693096864071053, 'psi': 0.9937435770143312}-{'f1_val': 0.9920231515210434, 'auprc': 0.9963520093999413, 'loss_val': 0.03703743400681039, 'psi': 0.9937546946726026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=75 head_norm_before_train=2.108608 cos_to_last_merge=0.7510 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=75 local utility u=0.000000 metrics={'f1_val': 0.5759859687455849, 'auprc': 0.8475145938247456, 'loss_val': 1.681415988023551, 'psi': 0.6845974187772492}-{'f1_val': 0.6580455545037078, 'auprc': 0.807581423413147, 'loss_val': 1.3458510242433432, 'psi': 0.7178599020674835}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=76 head_norm_before_train=2.168374 (no previous merge yet)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.7098500720610357, 'auprc': 0.9768249062370447, 'loss_val': 0.5483840000860494, 'psi': 0.8166400057314394}-{'f1_val': 0.7282398248833509, 'auprc': 0.9705096234277665, 'loss_val': 0.4778226351865775, 'psi': 0.8251477443011173}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=76 head_norm_before_train=2.330192 (no previous merge yet)
[S3] round=76 local utility u=0.000000 metrics={'f1_val': 0.960365708577172, 'auprc': 0.9989694424719245, 'loss_val': 0.18043407920104618, 'psi': 0.975807202135073}-{'f1_val': 0.9569289292894955, 'auprc': 0.998748958175322, 'loss_val': 0.09202588410443312, 'psi': 0.973656940843826}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=76 head_norm_before_train=1.837857 cos_to_last_merge=0.7959 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=76 local utility u=0.000000 metrics={'f1_val': 0.9407684602201944, 'auprc': 0.9535686770193503, 'loss_val': 0.34803625444230774, 'psi': 0.9458885469398568}-{'f1_val': 0.9421264848597984, 'auprc': 0.9586807507965066, 'loss_val': 0.3415985885506963, 'psi': 0.9487481912344817}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=76 head_norm_before_train=1.823105 cos_to_last_merge=0.7704 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=76 local utility u=0.000636 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9918139030642811, 'loss_val': 0.031245988674177525, 'psi': 0.994437175211299}-{'f1_val': 0.9960402158980539, 'auprc': 0.991759676037497, 'loss_val': 0.031481163468239856, 'psi': 0.9943279999538313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=76 head_norm_before_train=2.141853 (no previous merge yet)
[S6] round=76 local utility u=1.000000 metrics={'f1_val': 0.8669064547766119, 'auprc': 0.9574734170690248, 'loss_val': 0.37513550642840393, 'psi': 0.903133239693577}-{'f1_val': 0.6161949696256588, 'auprc': 0.7589735462374072, 'loss_val': 1.0540401289048182, 'psi': 0.6733064002703582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=76 head_norm_before_train=1.875601 (no previous merge yet)
[S7] round=76 local utility u=0.000000 metrics={'f1_val': 0.6008843788361303, 'auprc': 0.7908476189967092, 'loss_val': 0.8805755109583342, 'psi': 0.6768696749003619}-{'f1_val': 0.6342348595750016, 'auprc': 0.7962140651357229, 'loss_val': 0.7091496174659606, 'psi': 0.6990265417992901}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=76 head_norm_before_train=1.729019 cos_to_last_merge=0.8341 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.834
[S8] round=76 local utility u=0.007754 metrics={'f1_val': 0.9938554489473111, 'auprc': 0.999308923232306, 'loss_val': 0.028564771046519943, 'psi': 0.9960368386613091}-{'f1_val': 0.9927378939946618, 'auprc': 0.9990911276542027, 'loss_val': 0.036713751990752726, 'psi': 0.9952791874584782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=76 head_norm_before_train=1.769138 cos_to_last_merge=0.8722 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.872
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9929867328578279, 'loss_val': 0.019543431958835115, 'psi': 0.9954564406504168}-{'f1_val': 0.9971029125121428, 'auprc': 0.9945187605898013, 'loss_val': 0.019480042490634644, 'psi': 0.9960692517432062}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.994180 cos_to_last_merge=0.8843 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=76 local utility u=0.000235 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9950613904265482, 'loss_val': 0.032147085492707804, 'psi': 0.9936999324688401}-{'f1_val': 0.9927922938303682, 'auprc': 0.9950086140346893, 'loss_val': 0.03245953930654112, 'psi': 0.9936788219120967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=76 head_norm_before_train=1.962435 cos_to_last_merge=0.8993 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=76 local utility u=0.000544 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977541730087108, 'loss_val': 0.024366274039784228, 'psi': 0.997029871911638}-{'f1_val': 0.996305167468861, 'auprc': 0.9975689451975606, 'loss_val': 0.0234484277543193, 'psi': 0.9968106785603408}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=76 head_norm_before_train=1.971881 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6204830065296606, 'auprc': 0.7134790238521436, 'loss_val': 1.1193747399432532, 'psi': 0.6576814134586538}-{'f1_val': 0.6376188160435814, 'auprc': 0.7730690093595295, 'loss_val': 0.989467939332115, 'psi': 0.6917988933699606}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=1.754362 cos_to_last_merge=0.9081 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9990089874550043, 'loss_val': 0.026416626783067432, 'psi': 0.9970503400755053}-{'f1_val': 0.9969975081576651, 'auprc': 0.9986526052126753, 'loss_val': 0.019836600792064042, 'psi': 0.9976595469796692}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.781326 cos_to_last_merge=0.8748 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.875
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.8746451232455267, 'auprc': 0.9177573424096158, 'loss_val': 0.36154985924906613, 'psi': 0.8918900109111623}-{'f1_val': 0.9037402512786699, 'auprc': 0.9964514311198632, 'loss_val': 0.23654060718906275, 'psi': 0.9408247232151472}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=1.863803 cos_to_last_merge=0.8267 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.827
[S16] round=76 local utility u=0.000000 metrics={'f1_val': 0.9920231515210434, 'auprc': 0.995301572858847, 'loss_val': 0.03657344181130517, 'psi': 0.9933345200561648}-{'f1_val': 0.9920231515210434, 'auprc': 0.9963242152542632, 'loss_val': 0.03693096864071053, 'psi': 0.9937435770143312}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=76 head_norm_before_train=2.114632 cos_to_last_merge=0.7506 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.751
[S17] round=76 local utility u=0.566766 metrics={'f1_val': 0.6493992207669088, 'auprc': 0.9366996256188294, 'loss_val': 1.255919344196763, 'psi': 0.7643193827076771}-{'f1_val': 0.5759859687455849, 'auprc': 0.8475145938247456, 'loss_val': 1.681415988023551, 'psi': 0.6845974187772492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] sending update (kind=head size=1795 to 1 peers)
[S2] START round=77 head_norm_before_train=2.176395 (no previous merge yet)
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7095593954613092, 'auprc': 0.9456598388542099, 'loss_val': 0.5769708216232832, 'psi': 0.8039995728184695}-{'f1_val': 0.7098500720610357, 'auprc': 0.9768249062370447, 'loss_val': 0.5483840000860494, 'psi': 0.8166400057314394}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.334962 (no previous merge yet)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.7231305125902593, 'auprc': 0.989507949825244, 'loss_val': 0.6785983653602597, 'psi': 0.8296814874842532}-{'f1_val': 0.960365708577172, 'auprc': 0.9989694424719245, 'loss_val': 0.18043407920104618, 'psi': 0.975807202135073}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.844120 cos_to_last_merge=0.7945 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=77 local utility u=0.024319 metrics={'f1_val': 0.9543599516963897, 'auprc': 0.9374825357207223, 'loss_val': 0.33268821134066656, 'psi': 0.9476089853061227}-{'f1_val': 0.9407684602201944, 'auprc': 0.9535686770193503, 'loss_val': 0.34803625444230774, 'psi': 0.9458885469398568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=77 head_norm_before_train=1.824443 cos_to_last_merge=0.7701 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9911585890050709, 'loss_val': 0.032479108433108764, 'psi': 0.9941750495876149}-{'f1_val': 0.996186023309311, 'auprc': 0.9918139030642811, 'loss_val': 0.031245988674177525, 'psi': 0.994437175211299}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=2.146237 (no previous merge yet)
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6617992439399369, 'auprc': 0.9516708127661058, 'loss_val': 0.664922943373711, 'psi': 0.7777478714704045}-{'f1_val': 0.8669064547766119, 'auprc': 0.9574734170690248, 'loss_val': 0.37513550642840393, 'psi': 0.903133239693577}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.880967 (no previous merge yet)
[S7] round=77 local utility u=0.674105 metrics={'f1_val': 0.6865405874614141, 'auprc': 0.8640979632304965, 'loss_val': 0.26605416774256735, 'psi': 0.7575635377690471}-{'f1_val': 0.6008843788361303, 'auprc': 0.7908476189967092, 'loss_val': 0.8805755109583342, 'psi': 0.6768696749003619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=77 head_norm_before_train=1.735827 cos_to_last_merge=0.8335 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=77 local utility u=0.003686 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9995483574959829, 'loss_val': 0.025580743937456556, 'psi': 0.9964996641798303}-{'f1_val': 0.9938554489473111, 'auprc': 0.999308923232306, 'loss_val': 0.028564771046519943, 'psi': 0.9960368386613091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=77 head_norm_before_train=1.774814 cos_to_last_merge=0.8717 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.872
[S9] round=77 local utility u=0.002614 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9946528283661065, 'loss_val': 0.019314530597440264, 'psi': 0.9961228788537283}-{'f1_val': 0.9971029125121428, 'auprc': 0.9929867328578279, 'loss_val': 0.019543431958835115, 'psi': 0.9954564406504168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=77 head_norm_before_train=2.000827 cos_to_last_merge=0.8840 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.884
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.993401762700207, 'loss_val': 0.031428046571460075, 'psi': 0.9931675167865187}-{'f1_val': 0.9927922938303682, 'auprc': 0.9950613904265482, 'loss_val': 0.032147085492707804, 'psi': 0.9936999324688401}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=1.968928 cos_to_last_merge=0.8989 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.899
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976923906117723, 'loss_val': 0.023130801094227674, 'psi': 0.9968600567260255}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977541730087108, 'loss_val': 0.024366274039784228, 'psi': 0.997029871911638}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.977543 (no previous merge yet)
[S13] round=77 local utility u=0.786829 metrics={'f1_val': 0.7594302487435627, 'auprc': 0.825166856657589, 'loss_val': 0.7144641481530741, 'psi': 0.7857248919091733}-{'f1_val': 0.6204830065296606, 'auprc': 0.7134790238521436, 'loss_val': 1.1193747399432532, 'psi': 0.6576814134586538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=77 head_norm_before_train=1.757448 cos_to_last_merge=0.9081 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9957445751558393, 'auprc': 0.9989850206510625, 'loss_val': 0.02713139092738058, 'psi': 0.9970407533539285}-{'f1_val': 0.9957445751558393, 'auprc': 0.9990089874550043, 'loss_val': 0.026416626783067432, 'psi': 0.9970503400755053}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.788253 cos_to_last_merge=0.8742 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=77 local utility u=0.100799 metrics={'f1_val': 0.9011925060467738, 'auprc': 0.9208403393055431, 'loss_val': 0.32848557743267276, 'psi': 0.9090516393502815}-{'f1_val': 0.8746451232455267, 'auprc': 0.9177573424096158, 'loss_val': 0.36154985924906613, 'psi': 0.8918900109111623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=77 head_norm_before_train=1.868181 cos_to_last_merge=0.8264 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9922938586518524, 'auprc': 0.9939997437970423, 'loss_val': 0.036280108538932224, 'psi': 0.9929762127099284}-{'f1_val': 0.9920231515210434, 'auprc': 0.995301572858847, 'loss_val': 0.03657344181130517, 'psi': 0.9933345200561648}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=2.122170 cos_to_last_merge=0.7503 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.750
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6140211708113342, 'auprc': 0.9674080948076771, 'loss_val': 1.403237891565249, 'psi': 0.7553759404098714}-{'f1_val': 0.6493992207669088, 'auprc': 0.9366996256188294, 'loss_val': 1.255919344196763, 'psi': 0.7643193827076771}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.183600 (no previous merge yet)
[S2] round=78 local utility u=0.000000 metrics={'f1_val': 0.7082879587272488, 'auprc': 0.9264271180842477, 'loss_val': 0.5620380260634916, 'psi': 0.7955436224700484}-{'f1_val': 0.7095593954613092, 'auprc': 0.9456598388542099, 'loss_val': 0.5769708216232832, 'psi': 0.8039995728184695}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=78 head_norm_before_train=2.338808 (no previous merge yet)
[S3] round=78 local utility u=0.658942 metrics={'f1_val': 0.8712633201919047, 'auprc': 0.9980369113636769, 'loss_val': 0.2750986561790819, 'psi': 0.9219727566606135}-{'f1_val': 0.7231305125902593, 'auprc': 0.989507949825244, 'loss_val': 0.6785983653602597, 'psi': 0.8296814874842532}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=78 head_norm_before_train=1.846932 cos_to_last_merge=0.7942 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9436519753705277, 'auprc': 0.9574844563504438, 'loss_val': 0.34085044794215374, 'psi': 0.9491849677624942}-{'f1_val': 0.9543599516963897, 'auprc': 0.9374825357207223, 'loss_val': 0.33268821134066656, 'psi': 0.9476089853061227}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.822058 cos_to_last_merge=0.7701 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=78 local utility u=0.010051 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9970341532923627, 'loss_val': 0.030003286230718927, 'psi': 0.9965252753025317}-{'f1_val': 0.996186023309311, 'auprc': 0.9911585890050709, 'loss_val': 0.032479108433108764, 'psi': 0.9941750495876149}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=78 head_norm_before_train=2.151068 (no previous merge yet)
[S6] round=78 local utility u=0.480518 metrics={'f1_val': 0.7861348843557989, 'auprc': 0.9559941751254363, 'loss_val': 0.4628710068801043, 'psi': 0.8540786006636538}-{'f1_val': 0.6617992439399369, 'auprc': 0.9516708127661058, 'loss_val': 0.664922943373711, 'psi': 0.7777478714704045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=78 head_norm_before_train=1.883325 (no previous merge yet)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5801011746217228, 'auprc': 0.7825053644887752, 'loss_val': 0.9321375584862132, 'psi': 0.6610628505685439}-{'f1_val': 0.6865405874614141, 'auprc': 0.8640979632304965, 'loss_val': 0.26605416774256735, 'psi': 0.7575635377690471}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.743114 cos_to_last_merge=0.8328 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9992042608804352, 'loss_val': 0.030953078368725153, 'psi': 0.9952438266307178}-{'f1_val': 0.9944672019690619, 'auprc': 0.9995483574959829, 'loss_val': 0.025580743937456556, 'psi': 0.9964996641798303}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=1.778929 cos_to_last_merge=0.8712 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.871
[S9] round=78 local utility u=0.002895 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9987819081337806, 'loss_val': 0.019417544225366467, 'psi': 0.9971251844398246}-{'f1_val': 0.9971029125121428, 'auprc': 0.9946528283661065, 'loss_val': 0.019314530597440264, 'psi': 0.9961228788537283}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=78 head_norm_before_train=2.006770 cos_to_last_merge=0.8832 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.883
[S10] round=78 local utility u=0.001623 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9950494855326505, 'loss_val': 0.03180987438129602, 'psi': 0.9936951705112811}-{'f1_val': 0.9930113528440598, 'auprc': 0.993401762700207, 'loss_val': 0.031428046571460075, 'psi': 0.9931675167865187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=78 head_norm_before_train=1.974918 cos_to_last_merge=0.8985 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=78 local utility u=0.000423 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9977559730369765, 'loss_val': 0.022475660985632438, 'psi': 0.9968854896961072}-{'f1_val': 0.996305167468861, 'auprc': 0.9976923906117723, 'loss_val': 0.023130801094227674, 'psi': 0.9968600567260255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=78 head_norm_before_train=1.981974 (no previous merge yet)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6385425326177795, 'auprc': 0.7032077005204883, 'loss_val': 1.168157092129134, 'psi': 0.664408599778863}-{'f1_val': 0.7594302487435627, 'auprc': 0.825166856657589, 'loss_val': 0.7144641481530741, 'psi': 0.7857248919091733}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=1.762342 cos_to_last_merge=0.9079 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=78 local utility u=0.006959 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9987388829614272, 'loss_val': 0.020011816710400605, 'psi': 0.9976959811131176}-{'f1_val': 0.9957445751558393, 'auprc': 0.9989850206510625, 'loss_val': 0.02713139092738058, 'psi': 0.9970407533539285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=78 head_norm_before_train=1.794834 cos_to_last_merge=0.8737 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.874
[S15] round=78 local utility u=0.557706 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9980808759198249, 'loss_val': 0.020344630001203887, 'psi': 0.99750270248479}-{'f1_val': 0.9011925060467738, 'auprc': 0.9208403393055431, 'loss_val': 0.32848557743267276, 'psi': 0.9090516393502815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=78 head_norm_before_train=1.872582 cos_to_last_merge=0.8261 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.9922938586518524, 'auprc': 0.9926814399026118, 'loss_val': 0.03588397500222595, 'psi': 0.9924488911521562}-{'f1_val': 0.9922938586518524, 'auprc': 0.9939997437970423, 'loss_val': 0.036280108538932224, 'psi': 0.9929762127099284}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=2.130746 cos_to_last_merge=0.7500 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.750
[S17] round=78 local utility u=0.509408 metrics={'f1_val': 0.7477142425926062, 'auprc': 0.8990523951685129, 'loss_val': 0.981513975271653, 'psi': 0.8082495036229689}-{'f1_val': 0.6140211708113342, 'auprc': 0.9674080948076771, 'loss_val': 1.403237891565249, 'psi': 0.7553759404098714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=79 head_norm_before_train=2.190838 (no previous merge yet)
[S2] round=79 local utility u=0.020280 metrics={'f1_val': 0.7090133400716973, 'auprc': 0.9375022510619984, 'loss_val': 0.5590564737297444, 'psi': 0.8004089044678178}-{'f1_val': 0.7082879587272488, 'auprc': 0.9264271180842477, 'loss_val': 0.5620380260634916, 'psi': 0.7955436224700484}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S2] r=80 psi=0.800 u=0.0203 p_local=0.0619 f1=0.709 auprc=0.938 bytes=84503
[S3] START round=79 head_norm_before_train=2.343745 (no previous merge yet)
[S3] round=79 local utility u=0.324140 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9994414601839231, 'loss_val': 0.16990221441201223, 'psi': 0.9764216353132416}-{'f1_val': 0.8712633201919047, 'auprc': 0.9980369113636769, 'loss_val': 0.2750986561790819, 'psi': 0.9219727566606135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S3] r=80 psi=0.976 u=0.3241 p_local=0.2607 f1=0.961 auprc=0.999 bytes=84587
[S4] START round=79 head_norm_before_train=1.849208 cos_to_last_merge=0.7940 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=79 local utility u=0.002122 metrics={'f1_val': 0.9417477516588183, 'auprc': 0.9621103647413823, 'loss_val': 0.33905954445336733, 'psi': 0.949892796891844}-{'f1_val': 0.9436519753705277, 'auprc': 0.9574844563504438, 'loss_val': 0.34085044794215374, 'psi': 0.9491849677624942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=80 psi=0.950 u=0.0021 p_local=0.0050 f1=0.942 auprc=0.962 bytes=75562
[S5] START round=79 head_norm_before_train=1.821685 cos_to_last_merge=0.7698 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.770
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9913442019773573, 'loss_val': 0.031237974252207017, 'psi': 0.9941618103297754}-{'f1_val': 0.996186023309311, 'auprc': 0.9970341532923627, 'loss_val': 0.030003286230718927, 'psi': 0.9965252753025317}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.994 u=0.0000 p_local=0.0097 f1=0.996 auprc=0.991 bytes=88077
[S6] START round=79 head_norm_before_train=2.153508 (no previous merge yet)
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.660673001734317, 'auprc': 0.9552221264419433, 'loss_val': 0.5562394753286979, 'psi': 0.7784926516173676}-{'f1_val': 0.7861348843557989, 'auprc': 0.9559941751254363, 'loss_val': 0.4628710068801043, 'psi': 0.8540786006636538}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.778 u=0.0000 p_local=0.2695 f1=0.661 auprc=0.955 bytes=73716
[S7] START round=79 head_norm_before_train=1.884768 (no previous merge yet)
[S7] round=79 local utility u=0.911496 metrics={'f1_val': 0.743611370350612, 'auprc': 0.848975115024685, 'loss_val': 0.28961587502533376, 'psi': 0.7857568682202412}-{'f1_val': 0.5801011746217228, 'auprc': 0.7825053644887752, 'loss_val': 0.9321375584862132, 'psi': 0.6610628505685439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=80 psi=0.786 u=0.9115 p_local=0.3259 f1=0.744 auprc=0.849 bytes=77403
[S8] START round=79 head_norm_before_train=1.748927 cos_to_last_merge=0.8320 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9922069265978078, 'auprc': 0.9992166404563841, 'loss_val': 0.030116506655792245, 'psi': 0.9950108121412384}-{'f1_val': 0.9926035371309061, 'auprc': 0.9992042608804352, 'loss_val': 0.030953078368725153, 'psi': 0.9952438266307178}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.995 u=0.0000 p_local=0.0129 f1=0.992 auprc=0.999 bytes=86302
[S9] START round=79 head_norm_before_train=1.783880 cos_to_last_merge=0.8708 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.871
[S9] round=79 local utility u=0.000000 metrics={'f1_val': 0.9893026945281196, 'auprc': 0.9987876796553447, 'loss_val': 0.04243695373758818, 'psi': 0.9930966885790096}-{'f1_val': 0.9960207019771873, 'auprc': 0.9987819081337806, 'loss_val': 0.019417544225366467, 'psi': 0.9971251844398246}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=80 psi=0.993 u=0.0000 p_local=0.0019 f1=0.989 auprc=0.999 bytes=79023
[S10] START round=79 head_norm_before_train=2.009703 cos_to_last_merge=0.8818 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.882
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9951577765136895, 'loss_val': 0.03224031502056659, 'psi': 0.9937384869036967}-{'f1_val': 0.9927922938303682, 'auprc': 0.9950494855326505, 'loss_val': 0.03180987438129602, 'psi': 0.9936951705112811}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.994 u=0.0000 p_local=0.0004 f1=0.993 auprc=0.995 bytes=93534
[S11] START round=79 head_norm_before_train=1.978191 cos_to_last_merge=0.8981 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=79 local utility u=0.000423 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997490010485407, 'loss_val': 0.0222831896669698, 'psi': 0.9969242069023165}-{'f1_val': 0.996305167468861, 'auprc': 0.9977559730369765, 'loss_val': 0.022475660985632438, 'psi': 0.9968854896961072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] r=80 psi=0.997 u=0.0004 p_local=0.0536 f1=0.997 auprc=0.997 bytes=97087
[S13] START round=79 head_norm_before_train=1.986624 (no previous merge yet)
[S13] round=79 local utility u=0.368949 metrics={'f1_val': 0.6770908396037837, 'auprc': 0.7809151378983673, 'loss_val': 0.8946720230697769, 'psi': 0.7186205589216171}-{'f1_val': 0.6385425326177795, 'auprc': 0.7032077005204883, 'loss_val': 1.168157092129134, 'psi': 0.664408599778863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] r=80 psi=0.719 u=0.3689 p_local=0.1967 f1=0.677 auprc=0.781 bytes=77454
[S14] START round=79 head_norm_before_train=1.767337 cos_to_last_merge=0.9076 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=79 local utility u=0.000191 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9987575879053407, 'loss_val': 0.019686797971760515, 'psi': 0.9977034630906829}-{'f1_val': 0.9970007132142444, 'auprc': 0.9987388829614272, 'loss_val': 0.020011816710400605, 'psi': 0.9976959811131176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S14] r=80 psi=0.998 u=0.0002 p_local=0.0014 f1=0.997 auprc=0.999 bytes=100544
[S15] START round=79 head_norm_before_train=1.800928 cos_to_last_merge=0.8731 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.9456900769083229, 'auprc': 0.997263256542742, 'loss_val': 0.09112195248809928, 'psi': 0.9663193487620905}-{'f1_val': 0.9971172535281002, 'auprc': 0.9980808759198249, 'loss_val': 0.020344630001203887, 'psi': 0.99750270248479}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.966 u=0.0000 p_local=0.1635 f1=0.946 auprc=0.997 bytes=79102
[S16] START round=79 head_norm_before_train=1.873976 cos_to_last_merge=0.8256 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=79 local utility u=0.002770 metrics={'f1_val': 0.9924409270521872, 'auprc': 0.9941247081008767, 'loss_val': 0.03555546773770109, 'psi': 0.9931144394716631}-{'f1_val': 0.9922938586518524, 'auprc': 0.9926814399026118, 'loss_val': 0.03588397500222595, 'psi': 0.9924488911521562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S16] r=80 psi=0.993 u=0.0028 p_local=0.0007 f1=0.992 auprc=0.994 bytes=86157
[S17] START round=79 head_norm_before_train=2.139700 cos_to_last_merge=0.7498 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.750
[S17] round=79 local utility u=0.075832 metrics={'f1_val': 0.8107331969784132, 'auprc': 0.8004379071041849, 'loss_val': 0.9121210906615129, 'psi': 0.8066150810287219}-{'f1_val': 0.7477142425926062, 'auprc': 0.8990523951685129, 'loss_val': 0.981513975271653, 'psi': 0.8082495036229689}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] r=80 psi=0.807 u=0.0758 p_local=0.2009 f1=0.811 auprc=0.800 bytes=70215
[S2] START round=80 head_norm_before_train=2.199271 (no previous merge yet)
[S2] round=80 local utility u=0.132184 metrics={'f1_val': 0.7462791309380651, 'auprc': 0.9369902617198791, 'loss_val': 0.5167478742474462, 'psi': 0.8225635832507907}-{'f1_val': 0.7090133400716973, 'auprc': 0.9375022510619984, 'loss_val': 0.5590564737297444, 'psi': 0.8004089044678178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=80 head_norm_before_train=2.348979 (no previous merge yet)
[S3] round=80 local utility u=0.019322 metrics={'f1_val': 0.9585403338841174, 'auprc': 0.9996833938382794, 'loss_val': 0.11677550344807093, 'psi': 0.9749975578657821}-{'f1_val': 0.9610750853994537, 'auprc': 0.9994414601839231, 'loss_val': 0.16990221441201223, 'psi': 0.9764216353132416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=80 head_norm_before_train=1.853698 cos_to_last_merge=0.7933 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=80 local utility u=0.017288 metrics={'f1_val': 0.9441011413905197, 'auprc': 0.9663774523952527, 'loss_val': 0.3314046073335428, 'psi': 0.9530116657924129}-{'f1_val': 0.9417477516588183, 'auprc': 0.9621103647413823, 'loss_val': 0.33905954445336733, 'psi': 0.949892796891844}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=80 head_norm_before_train=1.827203 cos_to_last_merge=0.7690 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=80 local utility u=0.011182 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977914922526047, 'loss_val': 0.029090136665820346, 'psi': 0.9968282108866284}-{'f1_val': 0.9960402158980539, 'auprc': 0.9913442019773573, 'loss_val': 0.031237974252207017, 'psi': 0.9941618103297754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=80 head_norm_before_train=2.158926 (no previous merge yet)
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6071155622700095, 'auprc': 0.9430780863454746, 'loss_val': 0.8394908807521001, 'psi': 0.7415005719001955}-{'f1_val': 0.660673001734317, 'auprc': 0.9552221264419433, 'loss_val': 0.5562394753286979, 'psi': 0.7784926516173676}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.887545 (no previous merge yet)
[S7] round=80 local utility u=0.000000 metrics={'f1_val': 0.581974411142254, 'auprc': 0.7812705149252785, 'loss_val': 0.9495808429322623, 'psi': 0.6616928526554637}-{'f1_val': 0.743611370350612, 'auprc': 0.848975115024685, 'loss_val': 0.28961587502533376, 'psi': 0.7857568682202412}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=80 head_norm_before_train=1.752902 cos_to_last_merge=0.8316 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.9889241575992487, 'auprc': 0.9989841157151971, 'loss_val': 0.03443309486087644, 'psi': 0.992948140845628}-{'f1_val': 0.9922069265978078, 'auprc': 0.9992166404563841, 'loss_val': 0.030116506655792245, 'psi': 0.9950108121412384}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=1.788796 cos_to_last_merge=0.8703 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.870
[S9] round=80 local utility u=0.024789 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9931990806105272, 'loss_val': 0.020432727802718615, 'psi': 0.9952951270030682}-{'f1_val': 0.9893026945281196, 'auprc': 0.9987876796553447, 'loss_val': 0.04243695373758818, 'psi': 0.9930966885790096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=80 head_norm_before_train=2.014642 cos_to_last_merge=0.8810 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=80 local utility u=0.000000 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9935183974918387, 'loss_val': 0.03105557294785816, 'psi': 0.9932141707031714}-{'f1_val': 0.9927922938303682, 'auprc': 0.9951577765136895, 'loss_val': 0.03224031502056659, 'psi': 0.9937384869036967}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=80 head_norm_before_train=1.982385 cos_to_last_merge=0.8977 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.898
[S11] round=80 local utility u=0.000399 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976143211222448, 'loss_val': 0.02185806530703048, 'psi': 0.9969739311570517}-{'f1_val': 0.9965470045135896, 'auprc': 0.997490010485407, 'loss_val': 0.0222831896669698, 'psi': 0.9969242069023165}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=80 head_norm_before_train=1.988623 (no previous merge yet)
[S13] round=80 local utility u=0.207380 metrics={'f1_val': 0.7278205655049103, 'auprc': 0.8099889482075184, 'loss_val': 0.8715114951215159, 'psi': 0.7606879185859535}-{'f1_val': 0.6770908396037837, 'auprc': 0.7809151378983673, 'loss_val': 0.8946720230697769, 'psi': 0.7186205589216171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=80 head_norm_before_train=1.769073 cos_to_last_merge=0.9073 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=80 local utility u=0.000555 metrics={'f1_val': 0.9969755000837764, 'auprc': 0.9986643972492555, 'loss_val': 0.018146622238161717, 'psi': 0.9976510589499681}-{'f1_val': 0.9970007132142444, 'auprc': 0.9987575879053407, 'loss_val': 0.019686797971760515, 'psi': 0.9977034630906829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=80 head_norm_before_train=1.806514 cos_to_last_merge=0.8727 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.873
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.8894671893977758, 'auprc': 0.918035675975182, 'loss_val': 0.3557382144014226, 'psi': 0.9008945840287382}-{'f1_val': 0.9456900769083229, 'auprc': 0.997263256542742, 'loss_val': 0.09112195248809928, 'psi': 0.9663193487620905}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=1.877944 cos_to_last_merge=0.8252 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=80 local utility u=0.003728 metrics={'f1_val': 0.992683828688057, 'auprc': 0.9963327859542339, 'loss_val': 0.03618186039776102, 'psi': 0.9941434115945278}-{'f1_val': 0.9924409270521872, 'auprc': 0.9941247081008767, 'loss_val': 0.03555546773770109, 'psi': 0.9931144394716631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=80 head_norm_before_train=2.147923 cos_to_last_merge=0.7495 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.6027273117492578, 'auprc': 0.8425305667827637, 'loss_val': 1.6879396172960617, 'psi': 0.6986486137626602}-{'f1_val': 0.8107331969784132, 'auprc': 0.8004379071041849, 'loss_val': 0.9121210906615129, 'psi': 0.8066150810287219}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=81 head_norm_before_train=2.204986 (no previous merge yet)
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.6606200545643217, 'auprc': 0.8146601762507877, 'loss_val': 0.9891356370683864, 'psi': 0.7222361032389081}-{'f1_val': 0.7462791309380651, 'auprc': 0.9369902617198791, 'loss_val': 0.5167478742474462, 'psi': 0.8225635832507907}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.353552 (no previous merge yet)
[S3] round=81 local utility u=0.168207 metrics={'f1_val': 0.9978100342676263, 'auprc': 0.9993403505378482, 'loss_val': 0.01495026017617666, 'psi': 0.9984221607757151}-{'f1_val': 0.9585403338841174, 'auprc': 0.9996833938382794, 'loss_val': 0.11677550344807093, 'psi': 0.9749975578657821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=81 head_norm_before_train=1.853862 cos_to_last_merge=0.7938 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9431709390725158, 'auprc': 0.9551724925235163, 'loss_val': 0.335011193924255, 'psi': 0.947971560452916}-{'f1_val': 0.9441011413905197, 'auprc': 0.9663774523952527, 'loss_val': 0.3314046073335428, 'psi': 0.9530116657924129}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.834191 cos_to_last_merge=0.7682 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.768
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9913797467904819, 'loss_val': 0.033085157719289875, 'psi': 0.9941760282550252}-{'f1_val': 0.996186023309311, 'auprc': 0.9977914922526047, 'loss_val': 0.029090136665820346, 'psi': 0.9968282108866284}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.166421 (no previous merge yet)
[S6] round=81 local utility u=1.000000 metrics={'f1_val': 0.8671712069192136, 'auprc': 0.9700161722600462, 'loss_val': 0.2945456875188485, 'psi': 0.9083091930555467}-{'f1_val': 0.6071155622700095, 'auprc': 0.9430780863454746, 'loss_val': 0.8394908807521001, 'psi': 0.7415005719001955}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=81 head_norm_before_train=1.892278 (no previous merge yet)
[S7] round=81 local utility u=0.801003 metrics={'f1_val': 0.6955283207171683, 'auprc': 0.8671949359294634, 'loss_val': 0.2866724174540376, 'psi': 0.7641949668020863}-{'f1_val': 0.581974411142254, 'auprc': 0.7812705149252785, 'loss_val': 0.9495808429322623, 'psi': 0.6616928526554637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=81 head_norm_before_train=1.755621 cos_to_last_merge=0.8317 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=81 local utility u=0.009865 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9993286782054999, 'loss_val': 0.0325989052649766, 'psi': 0.9947722177293493}-{'f1_val': 0.9889241575992487, 'auprc': 0.9989841157151971, 'loss_val': 0.03443309486087644, 'psi': 0.992948140845628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=81 head_norm_before_train=1.793729 cos_to_last_merge=0.8698 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.870
[S9] round=81 local utility u=0.006739 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9988025738722113, 'loss_val': 0.019734757674122156, 'psi': 0.9971334507351968}-{'f1_val': 0.9966924912647621, 'auprc': 0.9931990806105272, 'loss_val': 0.020432727802718615, 'psi': 0.9952951270030682}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=81 head_norm_before_train=2.020519 cos_to_last_merge=0.8807 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=81 local utility u=0.000198 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9935142985518284, 'loss_val': 0.030647197404791812, 'psi': 0.9932125311271673}-{'f1_val': 0.9930113528440598, 'auprc': 0.9935183974918387, 'loss_val': 0.03105557294785816, 'psi': 0.9932141707031714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=81 head_norm_before_train=1.984925 cos_to_last_merge=0.8973 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=81 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9976804997446691, 'loss_val': 0.023477544328049226, 'psi': 0.9968553003791842}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976143211222448, 'loss_val': 0.02185806530703048, 'psi': 0.9969739311570517}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=81 head_norm_before_train=1.992409 (no previous merge yet)
[S13] round=81 local utility u=0.000000 metrics={'f1_val': 0.7391019425297629, 'auprc': 0.7301205770355573, 'loss_val': 1.0150030893564388, 'psi': 0.7355093963320807}-{'f1_val': 0.7278205655049103, 'auprc': 0.8099889482075184, 'loss_val': 0.8715114951215159, 'psi': 0.7606879185859535}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=81 head_norm_before_train=1.771482 cos_to_last_merge=0.9071 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9971159911926768, 'loss_val': 0.019847120670919156, 'psi': 0.9968991154692896}-{'f1_val': 0.9969755000837764, 'auprc': 0.9986643972492555, 'loss_val': 0.018146622238161717, 'psi': 0.9976510589499681}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.812395 cos_to_last_merge=0.8722 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=81 local utility u=0.042533 metrics={'f1_val': 0.9016001089992542, 'auprc': 0.9157744688120265, 'loss_val': 0.3366852922379592, 'psi': 0.9072698529243632}-{'f1_val': 0.8894671893977758, 'auprc': 0.918035675975182, 'loss_val': 0.3557382144014226, 'psi': 0.9008945840287382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S15] sending update (kind=head size=1808 to 1 peers)
[S16] START round=81 head_norm_before_train=1.883244 cos_to_last_merge=0.8248 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=81 local utility u=0.000000 metrics={'f1_val': 0.992683828688057, 'auprc': 0.9963051162352369, 'loss_val': 0.03613955468203797, 'psi': 0.9941323437069289}-{'f1_val': 0.992683828688057, 'auprc': 0.9963327859542339, 'loss_val': 0.03618186039776102, 'psi': 0.9941434115945278}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=81 head_norm_before_train=2.153803 cos_to_last_merge=0.7494 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=81 local utility u=0.108630 metrics={'f1_val': 0.6049670975572232, 'auprc': 0.9082124774052154, 'loss_val': 1.6811643820072735, 'psi': 0.7262652494964201}-{'f1_val': 0.6027273117492578, 'auprc': 0.8425305667827637, 'loss_val': 1.6879396172960617, 'psi': 0.6986486137626602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=82 head_norm_before_train=2.206506 (no previous merge yet)
[S2] round=82 local utility u=0.000000 metrics={'f1_val': 0.6391434163989013, 'auprc': 0.7982797007045357, 'loss_val': 1.1871776067041055, 'psi': 0.7027979301211551}-{'f1_val': 0.6606200545643217, 'auprc': 0.8146601762507877, 'loss_val': 0.9891356370683864, 'psi': 0.7222361032389081}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=82 head_norm_before_train=2.357853 (no previous merge yet)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9987203572996683, 'loss_val': 0.015560679842201289, 'psi': 0.9979099615149196}-{'f1_val': 0.9978100342676263, 'auprc': 0.9993403505378482, 'loss_val': 0.01495026017617666, 'psi': 0.9984221607757151}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.854573 cos_to_last_merge=0.7943 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=82 local utility u=0.002965 metrics={'f1_val': 0.9438041872930862, 'auprc': 0.95559333287981, 'loss_val': 0.33414302266385526, 'psi': 0.9485198455277757}-{'f1_val': 0.9431709390725158, 'auprc': 0.9551724925235163, 'loss_val': 0.335011193924255, 'psi': 0.947971560452916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=82 head_norm_before_train=1.842062 cos_to_last_merge=0.7674 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=82 local utility u=0.005589 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9933749391812559, 'loss_val': 0.0287673173028596, 'psi': 0.995061589658089}-{'f1_val': 0.9960402158980539, 'auprc': 0.9913797467904819, 'loss_val': 0.033085157719289875, 'psi': 0.9941760282550252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=82 head_norm_before_train=2.173159 (no previous merge yet)
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.8053091393445553, 'auprc': 0.9576632320461124, 'loss_val': 0.41270519083205476, 'psi': 0.8662507764251781}-{'f1_val': 0.8671712069192136, 'auprc': 0.9700161722600462, 'loss_val': 0.2945456875188485, 'psi': 0.9083091930555467}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.896763 (no previous merge yet)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.5374410962301588, 'auprc': 0.7707909246077513, 'loss_val': 1.2804913985490118, 'psi': 0.6307810275811958}-{'f1_val': 0.6955283207171683, 'auprc': 0.8671949359294634, 'loss_val': 0.2866724174540376, 'psi': 0.7641949668020863}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.754837 cos_to_last_merge=0.8324 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=82 local utility u=0.006574 metrics={'f1_val': 0.9941417884415487, 'auprc': 0.9992747120687122, 'loss_val': 0.03373240540864449, 'psi': 0.9961949578924141}-{'f1_val': 0.9917345774119155, 'auprc': 0.9993286782054999, 'loss_val': 0.0325989052649766, 'psi': 0.9947722177293493}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=82 head_norm_before_train=1.798077 cos_to_last_merge=0.8696 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.870
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9988130791511922, 'loss_val': 0.03880116316151755, 'psi': 0.9933610006489585}-{'f1_val': 0.9960207019771873, 'auprc': 0.9988025738722113, 'loss_val': 0.019734757674122156, 'psi': 0.9971334507351968}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.026805 cos_to_last_merge=0.8807 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.881
[S10] round=82 local utility u=0.001912 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9950253862021445, 'loss_val': 0.031357387041641455, 'psi': 0.9938169661872938}-{'f1_val': 0.9930113528440598, 'auprc': 0.9935142985518284, 'loss_val': 0.030647197404791812, 'psi': 0.9932125311271673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=82 head_norm_before_train=1.988796 cos_to_last_merge=0.8970 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=82 local utility u=0.001049 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978797673862521, 'loss_val': 0.02197643836042425, 'psi': 0.9969350074358174}-{'f1_val': 0.996305167468861, 'auprc': 0.9976804997446691, 'loss_val': 0.023477544328049226, 'psi': 0.9968553003791842}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=82 head_norm_before_train=1.999581 (no previous merge yet)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6451804345488716, 'auprc': 0.7223950583379136, 'loss_val': 1.0631148262001209, 'psi': 0.6760662840644884}-{'f1_val': 0.7391019425297629, 'auprc': 0.7301205770355573, 'loss_val': 1.0150030893564388, 'psi': 0.7355093963320807}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=82 head_norm_before_train=1.776037 cos_to_last_merge=0.9068 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.907
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9970990258681117, 'loss_val': 0.020167530254108453, 'psi': 0.9968923293394635}-{'f1_val': 0.996754531653698, 'auprc': 0.9971159911926768, 'loss_val': 0.019847120670919156, 'psi': 0.9968991154692896}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=1.818355 cos_to_last_merge=0.8717 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.872
[S15] round=82 local utility u=0.171543 metrics={'f1_val': 0.9075278105822634, 'auprc': 0.9715702693131838, 'loss_val': 0.19655288946418964, 'psi': 0.9331447940746316}-{'f1_val': 0.9016001089992542, 'auprc': 0.9157744688120265, 'loss_val': 0.3366852922379592, 'psi': 0.9072698529243632}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=82 head_norm_before_train=1.888072 cos_to_last_merge=0.8245 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.825
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.992683828688057, 'auprc': 0.9943299896199991, 'loss_val': 0.03553558977548333, 'psi': 0.9933422930608339}-{'f1_val': 0.992683828688057, 'auprc': 0.9963051162352369, 'loss_val': 0.03613955468203797, 'psi': 0.9941323437069289}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=2.159274 cos_to_last_merge=0.7492 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=82 local utility u=1.000000 metrics={'f1_val': 0.8726454200432686, 'auprc': 0.8834147725360137, 'loss_val': 0.7073738702151674, 'psi': 0.8769531610403667}-{'f1_val': 0.6049670975572232, 'auprc': 0.9082124774052154, 'loss_val': 1.6811643820072735, 'psi': 0.7262652494964201}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=83 head_norm_before_train=2.210214 (no previous merge yet)
[S2] round=83 local utility u=0.596451 metrics={'f1_val': 0.7046378534317437, 'auprc': 0.876832029213877, 'loss_val': 0.6228983584833004, 'psi': 0.773515523744597}-{'f1_val': 0.6391434163989013, 'auprc': 0.7982797007045357, 'loss_val': 1.1871776067041055, 'psi': 0.7027979301211551}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=83 head_norm_before_train=2.362222 (no previous merge yet)
[S3] round=83 local utility u=0.001141 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9993601027425347, 'loss_val': 0.015197643558565366, 'psi': 0.9981658596920662}-{'f1_val': 0.9973696976584205, 'auprc': 0.9987203572996683, 'loss_val': 0.015560679842201289, 'psi': 0.9979099615149196}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=83 head_norm_before_train=1.858801 cos_to_last_merge=0.7937 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=83 local utility u=0.016567 metrics={'f1_val': 0.9455146840796705, 'auprc': 0.9609014251924226, 'loss_val': 0.32719541249938483, 'psi': 0.9516693805247713}-{'f1_val': 0.9438041872930862, 'auprc': 0.95559333287981, 'loss_val': 0.33414302266385526, 'psi': 0.9485198455277757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=83 head_norm_before_train=1.848007 cos_to_last_merge=0.7665 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=83 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9917632874853584, 'loss_val': 0.02839050950063385, 'psi': 0.99441692897973}-{'f1_val': 0.996186023309311, 'auprc': 0.9933749391812559, 'loss_val': 0.0287673173028596, 'psi': 0.995061589658089}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=83 head_norm_before_train=2.183382 (no previous merge yet)
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7638929188518399, 'auprc': 0.942300359280806, 'loss_val': 0.6824625072971096, 'psi': 0.8352558950234263}-{'f1_val': 0.8053091393445553, 'auprc': 0.9576632320461124, 'loss_val': 0.41270519083205476, 'psi': 0.8662507764251781}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.899197 (no previous merge yet)
[S7] round=83 local utility u=1.000000 metrics={'f1_val': 0.693108904691541, 'auprc': 0.8626230926962635, 'loss_val': 0.2632143069165818, 'psi': 0.76091457989343}-{'f1_val': 0.5374410962301588, 'auprc': 0.7707909246077513, 'loss_val': 1.2804913985490118, 'psi': 0.6307810275811958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=83 head_norm_before_train=1.757225 cos_to_last_merge=0.8327 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.833
[S8] round=83 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9992610986307496, 'loss_val': 0.03672110886655452, 'psi': 0.9947451858994492}-{'f1_val': 0.9941417884415487, 'auprc': 0.9992747120687122, 'loss_val': 0.03373240540864449, 'psi': 0.9961949578924141}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=83 head_norm_before_train=1.801847 cos_to_last_merge=0.8693 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=83 local utility u=0.021560 metrics={'f1_val': 0.99644216417821, 'auprc': 0.9935748963694191, 'loss_val': 0.020261454421567293, 'psi': 0.9952952570546936}-{'f1_val': 0.9897262816474692, 'auprc': 0.9988130791511922, 'loss_val': 0.03880116316151755, 'psi': 0.9933610006489585}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=83 head_norm_before_train=2.033568 cos_to_last_merge=0.8803 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=83 local utility u=0.000298 metrics={'f1_val': 0.9932060207052873, 'auprc': 0.995203654411557, 'loss_val': 0.03246396156622079, 'psi': 0.9940050741877953}-{'f1_val': 0.9930113528440598, 'auprc': 0.9950253862021445, 'loss_val': 0.031357387041641455, 'psi': 0.9938169661872938}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=83 head_norm_before_train=1.993153 cos_to_last_merge=0.8966 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.897
[S11] round=83 local utility u=0.000804 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9976961130002608, 'loss_val': 0.021268370480909026, 'psi': 0.9970066479082581}-{'f1_val': 0.996305167468861, 'auprc': 0.9978797673862521, 'loss_val': 0.02197643836042425, 'psi': 0.9969350074358174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=83 head_norm_before_train=2.005943 (no previous merge yet)
[S13] round=83 local utility u=0.377338 metrics={'f1_val': 0.7513310348115692, 'auprc': 0.7472649647794418, 'loss_val': 1.0199513206957576, 'psi': 0.7497046067987182}-{'f1_val': 0.6451804345488716, 'auprc': 0.7223950583379136, 'loss_val': 1.0631148262001209, 'psi': 0.6760662840644884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S13] sending update (kind=head size=1806 to 1 peers)
[S14] START round=83 head_norm_before_train=1.781677 cos_to_last_merge=0.9065 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.906
[S14] round=83 local utility u=0.001514 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970707654098127, 'loss_val': 0.01851339211308535, 'psi': 0.9970268110585241}-{'f1_val': 0.996754531653698, 'auprc': 0.9970990258681117, 'loss_val': 0.020167530254108453, 'psi': 0.9968923293394635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=83 head_norm_before_train=1.823523 cos_to_last_merge=0.8712 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=83 local utility u=0.317006 metrics={'f1_val': 0.9753780493476981, 'auprc': 0.9960394119457878, 'loss_val': 0.043049481735317134, 'psi': 0.983642594386934}-{'f1_val': 0.9075278105822634, 'auprc': 0.9715702693131838, 'loss_val': 0.19655288946418964, 'psi': 0.9331447940746316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=83 head_norm_before_train=1.892147 cos_to_last_merge=0.8243 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.992683828688057, 'auprc': 0.9943662582441597, 'loss_val': 0.03570400042893886, 'psi': 0.9933568005104981}-{'f1_val': 0.992683828688057, 'auprc': 0.9943299896199991, 'loss_val': 0.03553558977548333, 'psi': 0.9933422930608339}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=2.163990 cos_to_last_merge=0.7489 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.7113680611944148, 'auprc': 0.9301581480564329, 'loss_val': 1.1300391750705419, 'psi': 0.798884095939222}-{'f1_val': 0.8726454200432686, 'auprc': 0.8834147725360137, 'loss_val': 0.7073738702151674, 'psi': 0.8769531610403667}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=84 head_norm_before_train=2.214556 (no previous merge yet)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7106967467907294, 'auprc': 0.8558416503639289, 'loss_val': 0.721454079483618, 'psi': 0.7687547082200092}-{'f1_val': 0.7046378534317437, 'auprc': 0.876832029213877, 'loss_val': 0.6228983584833004, 'psi': 0.773515523744597}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.366105 (no previous merge yet)
[S3] round=84 local utility u=0.002241 metrics={'f1_val': 0.9976528558298854, 'auprc': 0.9998857617211636, 'loss_val': 0.01399242367391733, 'psi': 0.9985460181863967}-{'f1_val': 0.9973696976584205, 'auprc': 0.9993601027425347, 'loss_val': 0.015197643558565366, 'psi': 0.9981658596920662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=84 head_norm_before_train=1.863801 cos_to_last_merge=0.7929 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9450805326701895, 'auprc': 0.9445998752919762, 'loss_val': 0.3438780379254354, 'psi': 0.9448882697189042}-{'f1_val': 0.9455146840796705, 'auprc': 0.9609014251924226, 'loss_val': 0.32719541249938483, 'psi': 0.9516693805247713}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.858535 cos_to_last_merge=0.7654 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=84 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9915871989116539, 'loss_val': 0.030300663085610705, 'psi': 0.9943464935502482}-{'f1_val': 0.996186023309311, 'auprc': 0.9917632874853584, 'loss_val': 0.02839050950063385, 'psi': 0.99441692897973}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=84 head_norm_before_train=2.190961 (no previous merge yet)
[S6] round=84 local utility u=0.583829 metrics={'f1_val': 0.8787252138796037, 'auprc': 0.9648063682679152, 'loss_val': 0.2713155137815734, 'psi': 0.9131576756349283}-{'f1_val': 0.7638929188518399, 'auprc': 0.942300359280806, 'loss_val': 0.6824625072971096, 'psi': 0.8352558950234263}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=84 head_norm_before_train=1.900484 (no previous merge yet)
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.6078255325070536, 'auprc': 0.792119444151531, 'loss_val': 0.722434225535393, 'psi': 0.6815430971648446}-{'f1_val': 0.693108904691541, 'auprc': 0.8626230926962635, 'loss_val': 0.2632143069165818, 'psi': 0.76091457989343}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=1.761141 cos_to_last_merge=0.8324 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9682762164430995, 'auprc': 0.9990980409527506, 'loss_val': 0.0964104394946784, 'psi': 0.9806049462469599}-{'f1_val': 0.9917345774119155, 'auprc': 0.9992610986307496, 'loss_val': 0.03672110886655452, 'psi': 0.9947451858994492}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=1.805180 cos_to_last_merge=0.8691 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=84 local utility u=0.001155 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9935643235795589, 'loss_val': 0.020381888984438632, 'psi': 0.9955372806871778}-{'f1_val': 0.99644216417821, 'auprc': 0.9935748963694191, 'loss_val': 0.020261454421567293, 'psi': 0.9952952570546936}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=84 head_norm_before_train=2.040421 cos_to_last_merge=0.8798 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.880
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9952005230346072, 'loss_val': 0.03250522073106971, 'psi': 0.9937555855120638}-{'f1_val': 0.9932060207052873, 'auprc': 0.995203654411557, 'loss_val': 0.03246396156622079, 'psi': 0.9940050741877953}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=1.998221 cos_to_last_merge=0.8962 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9978955175525923, 'loss_val': 0.021659637433344307, 'psi': 0.9969413075023534}-{'f1_val': 0.9965470045135896, 'auprc': 0.9976961130002608, 'loss_val': 0.021268370480909026, 'psi': 0.9970066479082581}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.011120 (no previous merge yet)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.643218543785866, 'auprc': 0.6901078965464553, 'loss_val': 1.202531589795188, 'psi': 0.6619742848901017}-{'f1_val': 0.7513310348115692, 'auprc': 0.7472649647794418, 'loss_val': 1.0199513206957576, 'psi': 0.7497046067987182}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=84 head_norm_before_train=1.784804 cos_to_last_merge=0.9059 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.906
[S14] round=84 local utility u=0.003644 metrics={'f1_val': 0.9973862616479148, 'auprc': 0.9986616016906648, 'loss_val': 0.018330756775380642, 'psi': 0.9978963976650148}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970707654098127, 'loss_val': 0.01851339211308535, 'psi': 0.9970268110585241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=84 head_norm_before_train=1.828978 cos_to_last_merge=0.8707 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.871
[S15] round=84 local utility u=0.061634 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9917010146069513, 'loss_val': 0.032397590118612825, 'psi': 0.9944702686153332}-{'f1_val': 0.9753780493476981, 'auprc': 0.9960394119457878, 'loss_val': 0.043049481735317134, 'psi': 0.983642594386934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=84 head_norm_before_train=1.897417 cos_to_last_merge=0.8240 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.824
[S16] round=84 local utility u=0.002688 metrics={'f1_val': 0.992683828688057, 'auprc': 0.9963175896913581, 'loss_val': 0.03618228289530569, 'psi': 0.9941373330893775}-{'f1_val': 0.992683828688057, 'auprc': 0.9943662582441597, 'loss_val': 0.03570400042893886, 'psi': 0.9933568005104981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=84 head_norm_before_train=2.168763 cos_to_last_merge=0.7488 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.6152206113701841, 'auprc': 0.9450604145030814, 'loss_val': 1.6329845620011783, 'psi': 0.7471565326233431}-{'f1_val': 0.7113680611944148, 'auprc': 0.9301581480564329, 'loss_val': 1.1300391750705419, 'psi': 0.798884095939222}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.218707 (no previous merge yet)
[S2] round=85 local utility u=0.454936 metrics={'f1_val': 0.7940609955348836, 'auprc': 0.9112044914947367, 'loss_val': 0.4778562218799935, 'psi': 0.8409183939188248}-{'f1_val': 0.7106967467907294, 'auprc': 0.8558416503639289, 'loss_val': 0.721454079483618, 'psi': 0.7687547082200092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S2] sending update (kind=head size=1795 to 1 peers)
[S3] START round=85 head_norm_before_train=2.369870 (no previous merge yet)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9997308571620038, 'loss_val': 0.015208221650849542, 'psi': 0.998331284332436}-{'f1_val': 0.9976528558298854, 'auprc': 0.9998857617211636, 'loss_val': 0.01399242367391733, 'psi': 0.9985460181863967}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.868839 cos_to_last_merge=0.7922 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9378391634649832, 'auprc': 0.9408740180991819, 'loss_val': 0.36296006741226183, 'psi': 0.9390531053186627}-{'f1_val': 0.9450805326701895, 'auprc': 0.9445998752919762, 'loss_val': 0.3438780379254354, 'psi': 0.9448882697189042}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.864066 cos_to_last_merge=0.7645 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.765
[S5] round=85 local utility u=0.010456 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9975276488349798, 'loss_val': 0.027209789335603543, 'psi': 0.9967226735195786}-{'f1_val': 0.996186023309311, 'auprc': 0.9915871989116539, 'loss_val': 0.030300663085610705, 'psi': 0.9943464935502482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=85 head_norm_before_train=2.198797 (no previous merge yet)
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6006589790885359, 'auprc': 0.9032213844970735, 'loss_val': 1.0541632322778818, 'psi': 0.7216839412519509}-{'f1_val': 0.8787252138796037, 'auprc': 0.9648063682679152, 'loss_val': 0.2713155137815734, 'psi': 0.9131576756349283}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.900499 (no previous merge yet)
[S7] round=85 local utility u=0.475896 metrics={'f1_val': 0.6867822467155426, 'auprc': 0.8226419254339441, 'loss_val': 0.3359509038410645, 'psi': 0.7411261182029032}-{'f1_val': 0.6078255325070536, 'auprc': 0.792119444151531, 'loss_val': 0.722434225535393, 'psi': 0.6815430971648446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=85 head_norm_before_train=1.766155 cos_to_last_merge=0.8319 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.832
[S8] round=85 local utility u=0.034797 metrics={'f1_val': 0.978148910724434, 'auprc': 0.9950582660800987, 'loss_val': 0.07393418734461006, 'psi': 0.9849126528666999}-{'f1_val': 0.9682762164430995, 'auprc': 0.9990980409527506, 'loss_val': 0.0964104394946784, 'psi': 0.9806049462469599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=85 head_norm_before_train=1.807595 cos_to_last_merge=0.8689 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=85 local utility u=0.008018 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9988250880888356, 'loss_val': 0.02012882431172558, 'psi': 0.9976415864908885}-{'f1_val': 0.9968525854255906, 'auprc': 0.9935643235795589, 'loss_val': 0.020381888984438632, 'psi': 0.9955372806871778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=85 head_norm_before_train=2.047157 cos_to_last_merge=0.8795 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.879
[S10] round=85 local utility u=0.000972 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9949753568910237, 'loss_val': 0.031199150054828588, 'psi': 0.9937969544628453}-{'f1_val': 0.9927922938303682, 'auprc': 0.9952005230346072, 'loss_val': 0.03250522073106971, 'psi': 0.9937555855120638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=85 head_norm_before_train=2.003654 cos_to_last_merge=0.8958 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=85 local utility u=0.001048 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977911927776949, 'loss_val': 0.020702089941845796, 'psi': 0.9970446798192317}-{'f1_val': 0.996305167468861, 'auprc': 0.9978955175525923, 'loss_val': 0.021659637433344307, 'psi': 0.9969413075023534}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=85 head_norm_before_train=2.014360 (no previous merge yet)
[S13] round=85 local utility u=0.056961 metrics={'f1_val': 0.6606762905891618, 'auprc': 0.6910799175430701, 'loss_val': 1.1962725791499547, 'psi': 0.6728377413707252}-{'f1_val': 0.643218543785866, 'auprc': 0.6901078965464553, 'loss_val': 1.202531589795188, 'psi': 0.6619742848901017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=85 head_norm_before_train=1.788814 cos_to_last_merge=0.9057 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.906
[S14] round=85 local utility u=0.000804 metrics={'f1_val': 0.9972183481640888, 'auprc': 0.9986627666636566, 'loss_val': 0.015718719670208988, 'psi': 0.9977961155639159}-{'f1_val': 0.9973862616479148, 'auprc': 0.9986616016906648, 'loss_val': 0.018330756775380642, 'psi': 0.9978963976650148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=85 head_norm_before_train=1.834825 cos_to_last_merge=0.8702 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9033126073276389, 'auprc': 0.9322170367637366, 'loss_val': 0.3109951212059368, 'psi': 0.9148743791020779}-{'f1_val': 0.9963164379542544, 'auprc': 0.9917010146069513, 'loss_val': 0.032397590118612825, 'psi': 0.9944702686153332}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=1.900716 cos_to_last_merge=0.8234 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=85 local utility u=0.000000 metrics={'f1_val': 0.992683828688057, 'auprc': 0.996429696177191, 'loss_val': 0.036611212304475914, 'psi': 0.9941821756837106}-{'f1_val': 0.992683828688057, 'auprc': 0.9963175896913581, 'loss_val': 0.03618228289530569, 'psi': 0.9941373330893775}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=85 head_norm_before_train=2.174310 cos_to_last_merge=0.7487 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.749
[S17] round=85 local utility u=1.000000 metrics={'f1_val': 0.8915774220533328, 'auprc': 0.9344410594403554, 'loss_val': 0.645914377854234, 'psi': 0.9087228770081418}-{'f1_val': 0.6152206113701841, 'auprc': 0.9450604145030814, 'loss_val': 1.6329845620011783, 'psi': 0.7471565326233431}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=86 head_norm_before_train=2.222515 (no previous merge yet)
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.7113457604396863, 'auprc': 0.899363033001545, 'loss_val': 0.6654720081187804, 'psi': 0.7865526694644298}-{'f1_val': 0.7940609955348836, 'auprc': 0.9112044914947367, 'loss_val': 0.4778562218799935, 'psi': 0.8409183939188248}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.368907 (no previous merge yet)
[S3] round=86 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9996551495361092, 'loss_val': 0.170384852884134, 'psi': 0.9765071110541159}-{'f1_val': 0.9973982357793907, 'auprc': 0.9997308571620038, 'loss_val': 0.015208221650849542, 'psi': 0.998331284332436}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=86 head_norm_before_train=1.871692 cos_to_last_merge=0.7915 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=86 local utility u=0.026460 metrics={'f1_val': 0.9451314006009304, 'auprc': 0.9416834832885693, 'loss_val': 0.35622095022009365, 'psi': 0.943752233675986}-{'f1_val': 0.9378391634649832, 'auprc': 0.9408740180991819, 'loss_val': 0.36296006741226183, 'psi': 0.9390531053186627}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=86 head_norm_before_train=1.868056 cos_to_last_merge=0.7639 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9912295387687731, 'loss_val': 0.029192689485565075, 'psi': 0.9941159450463416}-{'f1_val': 0.996186023309311, 'auprc': 0.9975276488349798, 'loss_val': 0.027209789335603543, 'psi': 0.9967226735195786}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.201531 (no previous merge yet)
[S6] round=86 local utility u=1.000000 metrics={'f1_val': 0.8681631311540112, 'auprc': 0.9719495129045289, 'loss_val': 0.2633057727875467, 'psi': 0.9096776838542182}-{'f1_val': 0.6006589790885359, 'auprc': 0.9032213844970735, 'loss_val': 1.0541632322778818, 'psi': 0.7216839412519509}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=86 head_norm_before_train=1.901800 (no previous merge yet)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.6295963998413305, 'auprc': 0.8006676041162142, 'loss_val': 0.49042878117206884, 'psi': 0.698024881551284}-{'f1_val': 0.6867822467155426, 'auprc': 0.8226419254339441, 'loss_val': 0.3359509038410645, 'psi': 0.7411261182029032}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.771430 cos_to_last_merge=0.8314 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.831
[S8] round=86 local utility u=0.069417 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9993692371014957, 'loss_val': 0.031665574991747256, 'psi': 0.9950003438779178}-{'f1_val': 0.978148910724434, 'auprc': 0.9950582660800987, 'loss_val': 0.07393418734461006, 'psi': 0.9849126528666999}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] sending update (kind=head size=1804 to 1 peers)
[S9] START round=86 head_norm_before_train=1.810751 cos_to_last_merge=0.8688 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=86 local utility u=0.000316 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9987963582303399, 'loss_val': 0.019411620027396933, 'psi': 0.9976300945474903}-{'f1_val': 0.9968525854255906, 'auprc': 0.9988250880888356, 'loss_val': 0.02012882431172558, 'psi': 0.9976415864908885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=86 head_norm_before_train=2.048599 cos_to_last_merge=0.8782 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.878
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9952047844185614, 'loss_val': 0.0320890700358793, 'psi': 0.9937572900656455}-{'f1_val': 0.9930113528440598, 'auprc': 0.9949753568910237, 'loss_val': 0.031199150054828588, 'psi': 0.9937969544628453}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=86 head_norm_before_train=2.005788 cos_to_last_merge=0.8955 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.896
[S11] round=86 local utility u=0.000750 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9981971473081702, 'loss_val': 0.020543559018361742, 'psi': 0.9972193413069963}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977911927776949, 'loss_val': 0.020702089941845796, 'psi': 0.9970446798192317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=86 head_norm_before_train=2.021294 (no previous merge yet)
[S13] round=86 local utility u=0.109693 metrics={'f1_val': 0.669905525461613, 'auprc': 0.7043534374515186, 'loss_val': 1.0720825136438852, 'psi': 0.6836846902575752}-{'f1_val': 0.6606762905891618, 'auprc': 0.6910799175430701, 'loss_val': 1.1962725791499547, 'psi': 0.6728377413707252}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=86 head_norm_before_train=1.794506 cos_to_last_merge=0.9053 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.905
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9568172478224787, 'auprc': 0.9989977493218741, 'loss_val': 0.054624774997166406, 'psi': 0.9736894484222369}-{'f1_val': 0.9972183481640888, 'auprc': 0.9986627666636566, 'loss_val': 0.015718719670208988, 'psi': 0.9977961155639159}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=1.840635 cos_to_last_merge=0.8697 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.870
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9017470055005479, 'auprc': 0.9176440721610423, 'loss_val': 0.33171354746252346, 'psi': 0.9081058321647456}-{'f1_val': 0.9033126073276389, 'auprc': 0.9322170367637366, 'loss_val': 0.3109951212059368, 'psi': 0.9148743791020779}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=1.903983 cos_to_last_merge=0.8227 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.823
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9922660531569132, 'auprc': 0.9963062459740344, 'loss_val': 0.03702668079585693, 'psi': 0.9938821302837617}-{'f1_val': 0.992683828688057, 'auprc': 0.996429696177191, 'loss_val': 0.036611212304475914, 'psi': 0.9941821756837106}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=2.176936 cos_to_last_merge=0.7481 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.8271008627453937, 'auprc': 0.9395716990438929, 'loss_val': 0.7561034795640804, 'psi': 0.8720891972647934}-{'f1_val': 0.8915774220533328, 'auprc': 0.9344410594403554, 'loss_val': 0.645914377854234, 'psi': 0.9087228770081418}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=87 head_norm_before_train=2.226793 (no previous merge yet)
[S2] round=87 local utility u=0.000000 metrics={'f1_val': 0.6963889884578037, 'auprc': 0.884683796447638, 'loss_val': 0.6791612577733762, 'psi': 0.7717069116537374}-{'f1_val': 0.7113457604396863, 'auprc': 0.899363033001545, 'loss_val': 0.6654720081187804, 'psi': 0.7865526694644298}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=87 head_norm_before_train=2.368110 (no previous merge yet)
[S3] round=87 local utility u=0.073195 metrics={'f1_val': 0.9722030359318138, 'auprc': 0.9993917871858312, 'loss_val': 0.08997225792055469, 'psi': 0.9830785364334208}-{'f1_val': 0.9610750853994537, 'auprc': 0.9996551495361092, 'loss_val': 0.170384852884134, 'psi': 0.9765071110541159}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=87 head_norm_before_train=1.870688 cos_to_last_merge=0.7921 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=87 local utility u=0.060800 metrics={'f1_val': 0.9495832157581061, 'auprc': 0.9653935784299645, 'loss_val': 0.33246304470111093, 'psi': 0.9559073608268496}-{'f1_val': 0.9451314006009304, 'auprc': 0.9416834832885693, 'loss_val': 0.35622095022009365, 'psi': 0.943752233675986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=87 head_norm_before_train=1.871204 cos_to_last_merge=0.7635 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9910168528666597, 'loss_val': 0.02965120955056057, 'psi': 0.9940308706854963}-{'f1_val': 0.9960402158980539, 'auprc': 0.9912295387687731, 'loss_val': 0.029192689485565075, 'psi': 0.9941159450463416}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=2.203921 (no previous merge yet)
[S6] round=87 local utility u=0.454709 metrics={'f1_val': 0.9873208687192148, 'auprc': 0.9845130498730702, 'loss_val': 0.10652441247734475, 'psi': 0.986197741180757}-{'f1_val': 0.8681631311540112, 'auprc': 0.9719495129045289, 'loss_val': 0.2633057727875467, 'psi': 0.9096776838542182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=87 head_norm_before_train=1.905803 (no previous merge yet)
[S7] round=87 local utility u=0.126401 metrics={'f1_val': 0.6546005647196487, 'auprc': 0.8093275057747485, 'loss_val': 0.41363106311623216, 'psi': 0.7164913411416887}-{'f1_val': 0.6295963998413305, 'auprc': 0.8006676041162142, 'loss_val': 0.49042878117206884, 'psi': 0.698024881551284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=87 head_norm_before_train=1.777325 cos_to_last_merge=0.8307 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.831
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9884946976640797, 'auprc': 0.9993380016274603, 'loss_val': 0.03797403346289261, 'psi': 0.992832019249432}-{'f1_val': 0.9920877483955324, 'auprc': 0.9993692371014957, 'loss_val': 0.031665574991747256, 'psi': 0.9950003438779178}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=1.813997 cos_to_last_merge=0.8684 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.868
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9970014745437636, 'loss_val': 0.019093688023741763, 'psi': 0.9968160845763627}-{'f1_val': 0.9968525854255906, 'auprc': 0.9987963582303399, 'loss_val': 0.019411620027396933, 'psi': 0.9976300945474903}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.052639 cos_to_last_merge=0.8772 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.877
[S10] round=87 local utility u=0.001645 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.995669436312571, 'loss_val': 0.03150733477986091, 'psi': 0.9940745862314644}-{'f1_val': 0.9927922938303682, 'auprc': 0.9952047844185614, 'loss_val': 0.0320890700358793, 'psi': 0.9937572900656455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=87 head_norm_before_train=2.009446 cos_to_last_merge=0.8952 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=87 local utility u=0.000293 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9983749723641562, 'loss_val': 0.020490709059323677, 'psi': 0.9972904713293906}-{'f1_val': 0.996567470639547, 'auprc': 0.9981971473081702, 'loss_val': 0.020543559018361742, 'psi': 0.9972193413069963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=87 head_norm_before_train=2.026193 (no previous merge yet)
[S13] round=87 local utility u=0.141555 metrics={'f1_val': 0.7164336403236706, 'auprc': 0.7076604275107138, 'loss_val': 1.0780615530538964, 'psi': 0.7129243551984878}-{'f1_val': 0.669905525461613, 'auprc': 0.7043534374515186, 'loss_val': 1.0720825136438852, 'psi': 0.6836846902575752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=87 head_norm_before_train=1.799672 cos_to_last_merge=0.9051 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.905
[S14] round=87 local utility u=0.129538 metrics={'f1_val': 0.9959175922875732, 'auprc': 0.9969595982975132, 'loss_val': 0.024036925713865735, 'psi': 0.9963343946915492}-{'f1_val': 0.9568172478224787, 'auprc': 0.9989977493218741, 'loss_val': 0.054624774997166406, 'psi': 0.9736894484222369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=87 head_norm_before_train=1.846450 cos_to_last_merge=0.8693 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=87 local utility u=0.298240 metrics={'f1_val': 0.9250565596332688, 'auprc': 0.991171899498619, 'loss_val': 0.09567485360756281, 'psi': 0.9515026955794089}-{'f1_val': 0.9017470055005479, 'auprc': 0.9176440721610423, 'loss_val': 0.33171354746252346, 'psi': 0.9081058321647456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=87 head_norm_before_train=1.907681 cos_to_last_merge=0.8221 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9920466912526451, 'auprc': 0.9964099660216594, 'loss_val': 0.03741343958590037, 'psi': 0.9937920011602508}-{'f1_val': 0.9922660531569132, 'auprc': 0.9963062459740344, 'loss_val': 0.03702668079585693, 'psi': 0.9938821302837617}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=2.180520 cos_to_last_merge=0.7478 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.6269357426979818, 'auprc': 0.9598638554524349, 'loss_val': 1.5607707011655785, 'psi': 0.760106987799763}-{'f1_val': 0.8271008627453937, 'auprc': 0.9395716990438929, 'loss_val': 0.7561034795640804, 'psi': 0.8720891972647934}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.230075 (no previous merge yet)
[S2] round=88 local utility u=0.000000 metrics={'f1_val': 0.6079833993813692, 'auprc': 0.7784512805740746, 'loss_val': 1.6258197010867952, 'psi': 0.6761705518584514}-{'f1_val': 0.6963889884578037, 'auprc': 0.884683796447638, 'loss_val': 0.6791612577733762, 'psi': 0.7717069116537374}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=88 head_norm_before_train=2.369941 (no previous merge yet)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.6962379015986183, 'auprc': 0.9768405010960444, 'loss_val': 0.74468835723992, 'psi': 0.8084789413975888}-{'f1_val': 0.9722030359318138, 'auprc': 0.9993917871858312, 'loss_val': 0.08997225792055469, 'psi': 0.9830785364334208}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.869671 cos_to_last_merge=0.7928 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9455179691010338, 'auprc': 0.9606443895130005, 'loss_val': 0.34585414156809213, 'psi': 0.9515685372658205}-{'f1_val': 0.9495832157581061, 'auprc': 0.9653935784299645, 'loss_val': 0.33246304470111093, 'psi': 0.9559073608268496}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.875430 cos_to_last_merge=0.7632 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.763
[S5] round=88 local utility u=0.007424 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9948999334598394, 'loss_val': 0.027327604353729464, 'psi': 0.9956715873695223}-{'f1_val': 0.9960402158980539, 'auprc': 0.9910168528666597, 'loss_val': 0.02965120955056057, 'psi': 0.9940308706854963}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=88 head_norm_before_train=2.207355 (no previous merge yet)
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.6505291346159692, 'auprc': 0.9321296642934418, 'loss_val': 0.7873380981382802, 'psi': 0.7631693464869582}-{'f1_val': 0.9873208687192148, 'auprc': 0.9845130498730702, 'loss_val': 0.10652441247734475, 'psi': 0.986197741180757}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.911125 (no previous merge yet)
[S7] round=88 local utility u=0.262006 metrics={'f1_val': 0.6993383076691941, 'auprc': 0.8505854177635943, 'loss_val': 0.2818185155142595, 'psi': 0.7598371517069542}-{'f1_val': 0.6546005647196487, 'auprc': 0.8093275057747485, 'loss_val': 0.41363106311623216, 'psi': 0.7164913411416887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=88 head_norm_before_train=1.783681 cos_to_last_merge=0.8301 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9676181907443638, 'auprc': 0.9989829208402561, 'loss_val': 0.08713494578135353, 'psi': 0.9801640827827207}-{'f1_val': 0.9884946976640797, 'auprc': 0.9993380016274603, 'loss_val': 0.03797403346289261, 'psi': 0.992832019249432}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=1.816782 cos_to_last_merge=0.8680 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.868
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9947734239942433, 'auprc': 0.9987350821395586, 'loss_val': 0.022956212236595226, 'psi': 0.9963580872523694}-{'f1_val': 0.9966924912647621, 'auprc': 0.9970014745437636, 'loss_val': 0.019093688023741763, 'psi': 0.9968160845763627}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=2.054821 cos_to_last_merge=0.8753 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.875
[S10] round=88 local utility u=0.000365 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9958102504246695, 'loss_val': 0.031199279374908125, 'psi': 0.9941309118763038}-{'f1_val': 0.9930113528440598, 'auprc': 0.995669436312571, 'loss_val': 0.03150733477986091, 'psi': 0.9940745862314644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=88 head_norm_before_train=2.014478 cos_to_last_merge=0.8948 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.895
[S11] round=88 local utility u=0.000196 metrics={'f1_val': 0.996567470639547, 'auprc': 0.998522117072053, 'loss_val': 0.020540249466441673, 'psi': 0.9973493292125495}-{'f1_val': 0.996567470639547, 'auprc': 0.9983749723641562, 'loss_val': 0.020490709059323677, 'psi': 0.9972904713293906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=88 head_norm_before_train=2.028774 (no previous merge yet)
[S13] round=88 local utility u=0.143724 metrics={'f1_val': 0.7479422834626319, 'auprc': 0.7397334356637918, 'loss_val': 1.075883650890779, 'psi': 0.7446587443430959}-{'f1_val': 0.7164336403236706, 'auprc': 0.7076604275107138, 'loss_val': 1.0780615530538964, 'psi': 0.7129243551984878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=88 head_norm_before_train=1.806034 cos_to_last_merge=0.9047 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.905
[S14] round=88 local utility u=0.006861 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9970643584660006, 'loss_val': 0.018115548525956673, 'psi': 0.9971249191850553}-{'f1_val': 0.9959175922875732, 'auprc': 0.9969595982975132, 'loss_val': 0.024036925713865735, 'psi': 0.9963343946915492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] sending update (kind=head size=1791 to 1 peers)
[S15] START round=88 head_norm_before_train=1.851738 cos_to_last_merge=0.8688 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.869
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9202683179329775, 'auprc': 0.9965073396295265, 'loss_val': 0.11748350219435826, 'psi': 0.950763926611597}-{'f1_val': 0.9250565596332688, 'auprc': 0.991171899498619, 'loss_val': 0.09567485360756281, 'psi': 0.9515026955794089}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=1.912627 cos_to_last_merge=0.8216 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.822
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9920466912526451, 'auprc': 0.9963210963175149, 'loss_val': 0.037443788544632574, 'psi': 0.993756453278593}-{'f1_val': 0.9920466912526451, 'auprc': 0.9964099660216594, 'loss_val': 0.03741343958590037, 'psi': 0.9937920011602508}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.183407 cos_to_last_merge=0.7477 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=88 local utility u=0.902535 metrics={'f1_val': 0.7954721438256338, 'auprc': 0.977143563321272, 'loss_val': 0.8187574437389737, 'psi': 0.8681407116238891}-{'f1_val': 0.6269357426979818, 'auprc': 0.9598638554524349, 'loss_val': 1.5607707011655785, 'psi': 0.760106987799763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] START round=89 head_norm_before_train=2.229733 (no previous merge yet)
[S2] round=89 local utility u=0.990290 metrics={'f1_val': 0.7053291138192146, 'auprc': 0.8999976760899118, 'loss_val': 0.5939533526219207, 'psi': 0.7831965387274935}-{'f1_val': 0.6079833993813692, 'auprc': 0.7784512805740746, 'loss_val': 1.6258197010867952, 'psi': 0.6761705518584514}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=89 head_norm_before_train=2.372478 (no previous merge yet)
[S3] round=89 local utility u=1.000000 metrics={'f1_val': 0.9836091889242733, 'auprc': 0.9990818022026853, 'loss_val': 0.0525811425652339, 'psi': 0.9897982342356381}-{'f1_val': 0.6962379015986183, 'auprc': 0.9768405010960444, 'loss_val': 0.74468835723992, 'psi': 0.8084789413975888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=89 head_norm_before_train=1.872491 cos_to_last_merge=0.7925 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=89 local utility u=0.000000 metrics={'f1_val': 0.9458419326436758, 'auprc': 0.9604560023411314, 'loss_val': 0.34753768052975686, 'psi': 0.951687560522658}-{'f1_val': 0.9455179691010338, 'auprc': 0.9606443895130005, 'loss_val': 0.34585414156809213, 'psi': 0.9515685372658205}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=89 head_norm_before_train=1.882766 cos_to_last_merge=0.7626 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.763
[S5] round=89 local utility u=0.000000 metrics={'f1_val': 0.8208111094921828, 'auprc': 0.9886971381967131, 'loss_val': 0.18534782628268426, 'psi': 0.887965520973995}-{'f1_val': 0.996186023309311, 'auprc': 0.9948999334598394, 'loss_val': 0.027327604353729464, 'psi': 0.9956715873695223}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=89 head_norm_before_train=2.208194 (no previous merge yet)
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.6313694713686034, 'auprc': 0.9205552638179666, 'loss_val': 0.7525115092548178, 'psi': 0.7470437883483487}-{'f1_val': 0.6505291346159692, 'auprc': 0.9321296642934418, 'loss_val': 0.7873380981382802, 'psi': 0.7631693464869582}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.915938 (no previous merge yet)
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.6149251779103133, 'auprc': 0.7914108423075085, 'loss_val': 0.8042156483239493, 'psi': 0.6855194436691914}-{'f1_val': 0.6993383076691941, 'auprc': 0.8505854177635943, 'loss_val': 0.2818185155142595, 'psi': 0.7598371517069542}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=1.788388 cos_to_last_merge=0.8298 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=89 local utility u=0.102564 metrics={'f1_val': 0.9922724065265219, 'auprc': 0.9990938203223151, 'loss_val': 0.03026478970338003, 'psi': 0.9950009720448392}-{'f1_val': 0.9676181907443638, 'auprc': 0.9989829208402561, 'loss_val': 0.08713494578135353, 'psi': 0.9801640827827207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] sending update (kind=head size=1805 to 1 peers)
[S9] START round=89 head_norm_before_train=1.819970 cos_to_last_merge=0.8676 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.868
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9991150564483319, 'loss_val': 0.02378653973635333, 'psi': 0.996260016097023}-{'f1_val': 0.9947734239942433, 'auprc': 0.9987350821395586, 'loss_val': 0.022956212236595226, 'psi': 0.9963580872523694}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.057704 cos_to_last_merge=0.8742 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=89 local utility u=0.000179 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9957694914115853, 'loss_val': 0.030719178920552235, 'psi': 0.9941146082710701}-{'f1_val': 0.9930113528440598, 'auprc': 0.9958102504246695, 'loss_val': 0.031199279374908125, 'psi': 0.9941309118763038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=89 head_norm_before_train=2.015829 cos_to_last_merge=0.8944 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=89 local utility u=0.000019 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9985622182071537, 'loss_val': 0.020623116289976946, 'psi': 0.9973653696665897}-{'f1_val': 0.996567470639547, 'auprc': 0.998522117072053, 'loss_val': 0.020540249466441673, 'psi': 0.9973493292125495}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=89 head_norm_before_train=2.033306 (no previous merge yet)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.6211681854231547, 'auprc': 0.6617478243369512, 'loss_val': 1.3212385760083547, 'psi': 0.6374000409886733}-{'f1_val': 0.7479422834626319, 'auprc': 0.7397334356637918, 'loss_val': 1.075883650890779, 'psi': 0.7446587443430959}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=89 head_norm_before_train=1.810902 cos_to_last_merge=0.9042 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.904
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970674465533789, 'loss_val': 0.018305855174819686, 'psi': 0.9970254835159507}-{'f1_val': 0.9971652929977585, 'auprc': 0.9970643584660006, 'loss_val': 0.018115548525956673, 'psi': 0.9971249191850553}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=1.856825 cos_to_last_merge=0.8685 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=89 local utility u=0.136386 metrics={'f1_val': 0.9581115245894447, 'auprc': 0.9975091094173234, 'loss_val': 0.07477571031013516, 'psi': 0.9738705585205962}-{'f1_val': 0.9202683179329775, 'auprc': 0.9965073396295265, 'loss_val': 0.11748350219435826, 'psi': 0.950763926611597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=89 head_norm_before_train=1.917067 cos_to_last_merge=0.8213 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=89 local utility u=0.001328 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9962594686146484, 'loss_val': 0.03710912630413066, 'psi': 0.993982384895566}-{'f1_val': 0.9920466912526451, 'auprc': 0.9963210963175149, 'loss_val': 0.037443788544632574, 'psi': 0.993756453278593}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=89 head_norm_before_train=2.186811 cos_to_last_merge=0.7475 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.748
[S17] round=89 local utility u=0.424386 metrics={'f1_val': 0.9064982540053075, 'auprc': 0.9594381052096458, 'loss_val': 0.5830254368507138, 'psi': 0.9276741944870428}-{'f1_val': 0.7954721438256338, 'auprc': 0.977143563321272, 'loss_val': 0.8187574437389737, 'psi': 0.8681407116238891}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=90 head_norm_before_train=2.232691 (no previous merge yet)
[S2] round=90 local utility u=0.000000 metrics={'f1_val': 0.7132924759923602, 'auprc': 0.8613494778289797, 'loss_val': 0.7437522092597871, 'psi': 0.772515276727008}-{'f1_val': 0.7053291138192146, 'auprc': 0.8999976760899118, 'loss_val': 0.5939533526219207, 'psi': 0.7831965387274935}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=90 head_norm_before_train=2.376056 (no previous merge yet)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9996827621777707, 'loss_val': 0.14759721144622553, 'psi': 0.9764942555343745}-{'f1_val': 0.9836091889242733, 'auprc': 0.9990818022026853, 'loss_val': 0.0525811425652339, 'psi': 0.9897982342356381}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.875208 cos_to_last_merge=0.7919 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=90 local utility u=0.002272 metrics={'f1_val': 0.9511190898053755, 'auprc': 0.9500906239273224, 'loss_val': 0.3435597071960109, 'psi': 0.9507077034541542}-{'f1_val': 0.9458419326436758, 'auprc': 0.9604560023411314, 'loss_val': 0.34753768052975686, 'psi': 0.951687560522658}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=90 head_norm_before_train=1.888236 cos_to_last_merge=0.7620 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=90 local utility u=0.619033 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9976303866379053, 'loss_val': 0.02633145089807581, 'psi': 0.9967637686407487}-{'f1_val': 0.8208111094921828, 'auprc': 0.9886971381967131, 'loss_val': 0.18534782628268426, 'psi': 0.887965520973995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=90 head_norm_before_train=2.212603 (no previous merge yet)
[S6] round=90 local utility u=1.000000 metrics={'f1_val': 0.8797733096896708, 'auprc': 0.9811303860537923, 'loss_val': 0.2071555755258986, 'psi': 0.9203161402353194}-{'f1_val': 0.6313694713686034, 'auprc': 0.9205552638179666, 'loss_val': 0.7525115092548178, 'psi': 0.7470437883483487}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=90 head_norm_before_train=1.919043 (no previous merge yet)
[S7] round=90 local utility u=0.388310 metrics={'f1_val': 0.6616833334990908, 'auprc': 0.8174235218392047, 'loss_val': 0.38618253045950385, 'psi': 0.7239794088351363}-{'f1_val': 0.6149251779103133, 'auprc': 0.7914108423075085, 'loss_val': 0.8042156483239493, 'psi': 0.6855194436691914}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=90 head_norm_before_train=1.793063 cos_to_last_merge=0.8297 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.830
[S8] round=90 local utility u=0.003079 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.999133427826502, 'loss_val': 0.028602423841901033, 'psi': 0.9954544458222733}-{'f1_val': 0.9922724065265219, 'auprc': 0.9990938203223151, 'loss_val': 0.03026478970338003, 'psi': 0.9950009720448392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=90 head_norm_before_train=1.822997 cos_to_last_merge=0.8673 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=90 local utility u=0.004851 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9960833482127659, 'loss_val': 0.01900463991035827, 'psi': 0.9964488340439637}-{'f1_val': 0.994356655862817, 'auprc': 0.9991150564483319, 'loss_val': 0.02378653973635333, 'psi': 0.996260016097023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=90 head_norm_before_train=2.062139 cos_to_last_merge=0.8737 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=90 local utility u=0.000310 metrics={'f1_val': 0.9930113528440598, 'auprc': 0.9959235318402491, 'loss_val': 0.030561921650007047, 'psi': 0.9941762244425356}-{'f1_val': 0.9930113528440598, 'auprc': 0.9957694914115853, 'loss_val': 0.030719178920552235, 'psi': 0.9941146082710701}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=90 head_norm_before_train=2.017079 cos_to_last_merge=0.8941 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=90 local utility u=0.000000 metrics={'f1_val': 0.9959123037929781, 'auprc': 0.9984594038378634, 'loss_val': 0.021212985667378767, 'psi': 0.9969311438109323}-{'f1_val': 0.996567470639547, 'auprc': 0.9985622182071537, 'loss_val': 0.020623116289976946, 'psi': 0.9973653696665897}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=90 head_norm_before_train=2.038867 (no previous merge yet)
[S13] round=90 local utility u=0.430748 metrics={'f1_val': 0.6908191336909323, 'auprc': 0.765220565593652, 'loss_val': 1.1880656306265187, 'psi': 0.7205797064520202}-{'f1_val': 0.6211681854231547, 'auprc': 0.6617478243369512, 'loss_val': 1.3212385760083547, 'psi': 0.6374000409886733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=90 head_norm_before_train=1.813475 cos_to_last_merge=0.9037 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.904
[S14] round=90 local utility u=0.001868 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9987252257446563, 'loss_val': 0.019561746374048176, 'psi': 0.9976905182264092}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970674465533789, 'loss_val': 0.018305855174819686, 'psi': 0.9970254835159507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=90 head_norm_before_train=1.862027 cos_to_last_merge=0.8681 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=90 local utility u=0.144700 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9978329543684059, 'loss_val': 0.020381085710793254, 'psi': 0.9974035338642224}-{'f1_val': 0.9581115245894447, 'auprc': 0.9975091094173234, 'loss_val': 0.07477571031013516, 'psi': 0.9738705585205962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=90 head_norm_before_train=1.920649 cos_to_last_merge=0.8212 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=90 local utility u=0.000447 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9964108055499861, 'loss_val': 0.03666903766178815, 'psi': 0.9940429196697012}-{'f1_val': 0.9924643290828444, 'auprc': 0.9962594686146484, 'loss_val': 0.03710912630413066, 'psi': 0.993982384895566}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=90 head_norm_before_train=2.192627 cos_to_last_merge=0.7474 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.7391341924865744, 'auprc': 0.9740850193530955, 'loss_val': 0.9707754646470453, 'psi': 0.8331145232331829}-{'f1_val': 0.9064982540053075, 'auprc': 0.9594381052096458, 'loss_val': 0.5830254368507138, 'psi': 0.9276741944870428}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.234607 (no previous merge yet)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.7160549122568046, 'auprc': 0.8436739117278039, 'loss_val': 0.8976584347181421, 'psi': 0.7671025120452044}-{'f1_val': 0.7132924759923602, 'auprc': 0.8613494778289797, 'loss_val': 0.7437522092597871, 'psi': 0.772515276727008}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=91 head_norm_before_train=2.380172 (no previous merge yet)
[S3] round=91 local utility u=0.175019 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9997062474916132, 'loss_val': 0.01580838143982083, 'psi': 0.9983214404642797}-{'f1_val': 0.9610352511054436, 'auprc': 0.9996827621777707, 'loss_val': 0.14759721144622553, 'psi': 0.9764942555343745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=91 head_norm_before_train=1.876413 cos_to_last_merge=0.7914 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=91 local utility u=0.028968 metrics={'f1_val': 0.9480846373934939, 'auprc': 0.9716683042661917, 'loss_val': 0.3321505704372632, 'psi': 0.957518104142573}-{'f1_val': 0.9511190898053755, 'auprc': 0.9500906239273224, 'loss_val': 0.3435597071960109, 'psi': 0.9507077034541542}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S4] sending update (kind=head size=1808 to 1 peers)
[S5] START round=91 head_norm_before_train=1.890978 cos_to_last_merge=0.7615 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9915354242212092, 'loss_val': 0.027763927264984504, 'psi': 0.9943257836740703}-{'f1_val': 0.996186023309311, 'auprc': 0.9976303866379053, 'loss_val': 0.02633145089807581, 'psi': 0.9967637686407487}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.215540 (no previous merge yet)
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.5978069999106097, 'auprc': 0.6469272567699452, 'loss_val': 1.6079970989747978, 'psi': 0.6174551026543439}-{'f1_val': 0.8797733096896708, 'auprc': 0.9811303860537923, 'loss_val': 0.2071555755258986, 'psi': 0.9203161402353194}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.921693 (no previous merge yet)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.6108860199871619, 'auprc': 0.7974737369546906, 'loss_val': 0.6815990387793169, 'psi': 0.6855211067741733}-{'f1_val': 0.6616833334990908, 'auprc': 0.8174235218392047, 'loss_val': 0.38618253045950385, 'psi': 0.7239794088351363}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=1.799512 cos_to_last_merge=0.8290 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.829
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9670629894173319, 'auprc': 0.9991559552998124, 'loss_val': 0.08833221710437249, 'psi': 0.9799001757703242}-{'f1_val': 0.9930017911527874, 'auprc': 0.999133427826502, 'loss_val': 0.028602423841901033, 'psi': 0.9954544458222733}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=91 head_norm_before_train=1.825747 cos_to_last_merge=0.8672 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=91 local utility u=0.004014 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987342426931444, 'loss_val': 0.01873779921559538, 'psi': 0.9974900041655926}-{'f1_val': 0.9966924912647621, 'auprc': 0.9960833482127659, 'loss_val': 0.01900463991035827, 'psi': 0.9964488340439637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=91 head_norm_before_train=2.067497 cos_to_last_merge=0.8737 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.996197459026566, 'loss_val': 0.03136987778241582, 'psi': 0.9941543599088473}-{'f1_val': 0.9930113528440598, 'auprc': 0.9959235318402491, 'loss_val': 0.030561921650007047, 'psi': 0.9941762244425356}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=91 head_norm_before_train=2.020308 cos_to_last_merge=0.8937 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.894
[S11] round=91 local utility u=0.000901 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9983084102064393, 'loss_val': 0.02040890082727654, 'psi': 0.997015848929023}-{'f1_val': 0.9959123037929781, 'auprc': 0.9984594038378634, 'loss_val': 0.021212985667378767, 'psi': 0.9969311438109323}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=91 head_norm_before_train=2.042874 (no previous merge yet)
[S13] round=91 local utility u=0.192551 metrics={'f1_val': 0.7426768193785216, 'auprc': 0.74249567595974, 'loss_val': 1.045935175042044, 'psi': 0.742604362011009}-{'f1_val': 0.6908191336909323, 'auprc': 0.765220565593652, 'loss_val': 1.1880656306265187, 'psi': 0.7205797064520202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=91 head_norm_before_train=1.817084 cos_to_last_merge=0.9033 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=91 local utility u=0.000000 metrics={'f1_val': 0.9965909138827574, 'auprc': 0.9985494585295795, 'loss_val': 0.0200326651878896, 'psi': 0.9973743317414863}-{'f1_val': 0.9970007132142444, 'auprc': 0.9987252257446563, 'loss_val': 0.019561746374048176, 'psi': 0.9976905182264092}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=91 head_norm_before_train=1.867231 cos_to_last_merge=0.8677 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.868
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.9143298520397746, 'auprc': 0.9931000313305577, 'loss_val': 0.13593391842033203, 'psi': 0.9458379237560878}-{'f1_val': 0.9971172535281002, 'auprc': 0.9978329543684059, 'loss_val': 0.020381085710793254, 'psi': 0.9974035338642224}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=1.924815 cos_to_last_merge=0.8210 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=91 local utility u=0.000000 metrics={'f1_val': 0.9927343791035232, 'auprc': 0.9933393075775482, 'loss_val': 0.03544280505967986, 'psi': 0.9929763504931332}-{'f1_val': 0.9924643290828444, 'auprc': 0.9964108055499861, 'loss_val': 0.03666903766178815, 'psi': 0.9940429196697012}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=91 head_norm_before_train=2.198938 cos_to_last_merge=0.7474 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.7189269101294737, 'auprc': 0.9686603835946308, 'loss_val': 1.14121612889971, 'psi': 0.8188202995155366}-{'f1_val': 0.7391341924865744, 'auprc': 0.9740850193530955, 'loss_val': 0.9707754646470453, 'psi': 0.8331145232331829}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.240220 (no previous merge yet)
[S2] round=92 local utility u=0.271140 metrics={'f1_val': 0.7074686871780456, 'auprc': 0.9204037535745162, 'loss_val': 0.5340513602231913, 'psi': 0.7926427137366339}-{'f1_val': 0.7160549122568046, 'auprc': 0.8436739117278039, 'loss_val': 0.8976584347181421, 'psi': 0.7671025120452044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=92 head_norm_before_train=2.384151 (no previous merge yet)
[S3] round=92 local utility u=0.000000 metrics={'f1_val': 0.9610352511054436, 'auprc': 0.9997586200583564, 'loss_val': 0.13720837894453536, 'psi': 0.9765245986866087}-{'f1_val': 0.9973982357793907, 'auprc': 0.9997062474916132, 'loss_val': 0.01580838143982083, 'psi': 0.9983214404642797}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=92 head_norm_before_train=1.876273 cos_to_last_merge=0.7914 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9399284993527156, 'auprc': 0.9628384377778707, 'loss_val': 0.35304494063887976, 'psi': 0.9490924747227776}-{'f1_val': 0.9480846373934939, 'auprc': 0.9716683042661917, 'loss_val': 0.3321505704372632, 'psi': 0.957518104142573}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.891693 cos_to_last_merge=0.7612 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=92 local utility u=0.003998 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9938823800292157, 'loss_val': 0.026808870454762452, 'psi': 0.9952645659972729}-{'f1_val': 0.996186023309311, 'auprc': 0.9915354242212092, 'loss_val': 0.027763927264984504, 'psi': 0.9943257836740703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=92 head_norm_before_train=2.219608 (no previous merge yet)
[S6] round=92 local utility u=0.098507 metrics={'f1_val': 0.5960193776703638, 'auprc': 0.6733685212574887, 'loss_val': 1.4795815799616738, 'psi': 0.6269590351052138}-{'f1_val': 0.5978069999106097, 'auprc': 0.6469272567699452, 'loss_val': 1.6079970989747978, 'psi': 0.6174551026543439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=92 head_norm_before_train=1.924280 (no previous merge yet)
[S7] round=92 local utility u=0.139137 metrics={'f1_val': 0.6372157669824062, 'auprc': 0.802443188692359, 'loss_val': 0.576211750145938, 'psi': 0.7033067356663874}-{'f1_val': 0.6108860199871619, 'auprc': 0.7974737369546906, 'loss_val': 0.6815990387793169, 'psi': 0.6855211067741733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=92 head_norm_before_train=1.805079 cos_to_last_merge=0.8282 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=92 local utility u=0.095829 metrics={'f1_val': 0.9920360116327993, 'auprc': 0.9966994293189508, 'loss_val': 0.03914354498853131, 'psi': 0.9939013787072599}-{'f1_val': 0.9670629894173319, 'auprc': 0.9991559552998124, 'loss_val': 0.08833221710437249, 'psi': 0.9799001757703242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=92 head_norm_before_train=1.828752 cos_to_last_merge=0.8672 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=92 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9987305835468396, 'loss_val': 0.0189138655624686, 'psi': 0.9973383448190684}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987342426931444, 'loss_val': 0.01873779921559538, 'psi': 0.9974900041655926}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=92 head_norm_before_train=2.073276 cos_to_last_merge=0.8738 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=92 local utility u=0.000032 metrics={'f1_val': 0.9927922938303682, 'auprc': 0.9962333826016554, 'loss_val': 0.03141309676224482, 'psi': 0.994168729338883}-{'f1_val': 0.9927922938303682, 'auprc': 0.996197459026566, 'loss_val': 0.03136987778241582, 'psi': 0.9941543599088473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=92 head_norm_before_train=2.024241 cos_to_last_merge=0.8934 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=92 local utility u=0.000369 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.998587855430872, 'loss_val': 0.020508363941210184, 'psi': 0.9971276270187961}-{'f1_val': 0.9961541414107454, 'auprc': 0.9983084102064393, 'loss_val': 0.02040890082727654, 'psi': 0.997015848929023}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=92 head_norm_before_train=2.046371 (no previous merge yet)
[S13] round=92 local utility u=0.371196 metrics={'f1_val': 0.7600807413899402, 'auprc': 0.838835381030367, 'loss_val': 0.6969856679451335, 'psi': 0.791582597246111}-{'f1_val': 0.7426768193785216, 'auprc': 0.74249567595974, 'loss_val': 1.045935175042044, 'psi': 0.742604362011009}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=92 head_norm_before_train=1.822061 cos_to_last_merge=0.9030 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=92 local utility u=0.001605 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.998584317470257, 'loss_val': 0.019386573233558343, 'psi': 0.9976341549166494}-{'f1_val': 0.9965909138827574, 'auprc': 0.9985494585295795, 'loss_val': 0.0200326651878896, 'psi': 0.9973743317414863}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=92 head_norm_before_train=1.872274 cos_to_last_merge=0.8674 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=92 local utility u=0.000000 metrics={'f1_val': 0.9027624067881995, 'auprc': 0.9465069042848944, 'loss_val': 0.313438490061127, 'psi': 0.9202602057868775}-{'f1_val': 0.9143298520397746, 'auprc': 0.9931000313305577, 'loss_val': 0.13593391842033203, 'psi': 0.9458379237560878}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=92 head_norm_before_train=1.927729 cos_to_last_merge=0.8209 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=92 local utility u=0.001140 metrics={'f1_val': 0.992683828688057, 'auprc': 0.994298812495021, 'loss_val': 0.035737316880759325, 'psi': 0.9933298222108427}-{'f1_val': 0.9927343791035232, 'auprc': 0.9933393075775482, 'loss_val': 0.03544280505967986, 'psi': 0.9929763504931332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=92 head_norm_before_train=2.204677 cos_to_last_merge=0.7473 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=92 local utility u=0.000000 metrics={'f1_val': 0.7051030382238721, 'auprc': 0.9696192491027217, 'loss_val': 1.1030975148431015, 'psi': 0.8109095225754119}-{'f1_val': 0.7189269101294737, 'auprc': 0.9686603835946308, 'loss_val': 1.14121612889971, 'psi': 0.8188202995155366}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=93 head_norm_before_train=2.241915 (no previous merge yet)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.6335315460468245, 'auprc': 0.796599976192278, 'loss_val': 1.2625208610520848, 'psi': 0.6987589181050059}-{'f1_val': 0.7074686871780456, 'auprc': 0.9204037535745162, 'loss_val': 0.5340513602231913, 'psi': 0.7926427137366339}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=93 head_norm_before_train=2.387156 (no previous merge yet)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9949821506515709, 'loss_val': 0.1899513817423025, 'psi': 0.9746379115003007}-{'f1_val': 0.9610352511054436, 'auprc': 0.9997586200583564, 'loss_val': 0.13720837894453536, 'psi': 0.9765245986866087}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.877616 cos_to_last_merge=0.7915 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=93 local utility u=0.000729 metrics={'f1_val': 0.9391403492914009, 'auprc': 0.9648937777311324, 'loss_val': 0.3530247289500053, 'psi': 0.9494417206672934}-{'f1_val': 0.9399284993527156, 'auprc': 0.9628384377778707, 'loss_val': 0.35304494063887976, 'psi': 0.9490924747227776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=93 head_norm_before_train=1.890606 cos_to_last_merge=0.7607 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9903513500870743, 'loss_val': 0.028557854795919196, 'psi': 0.9937646695736622}-{'f1_val': 0.996186023309311, 'auprc': 0.9938823800292157, 'loss_val': 0.026808870454762452, 'psi': 0.9952645659972729}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.221951 (no previous merge yet)
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.9623495781342506, 'auprc': 0.9397251106085469, 'loss_val': 0.18412716468110724, 'psi': 0.9532997911239691}-{'f1_val': 0.5960193776703638, 'auprc': 0.6733685212574887, 'loss_val': 1.4795815799616738, 'psi': 0.6269590351052138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=93 head_norm_before_train=1.927666 (no previous merge yet)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.6202275780238055, 'auprc': 0.7929829935605632, 'loss_val': 0.8151547134051074, 'psi': 0.6893297442385086}-{'f1_val': 0.6372157669824062, 'auprc': 0.802443188692359, 'loss_val': 0.576211750145938, 'psi': 0.7033067356663874}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=1.808506 cos_to_last_merge=0.8282 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=93 local utility u=0.015619 metrics={'f1_val': 0.993914489706644, 'auprc': 0.9992314616082787, 'loss_val': 0.026773456697604812, 'psi': 0.9960412784672978}-{'f1_val': 0.9920360116327993, 'auprc': 0.9966994293189508, 'loss_val': 0.03914354498853131, 'psi': 0.9939013787072599}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=93 head_norm_before_train=1.832304 cos_to_last_merge=0.8671 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=93 local utility u=0.001510 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.998724931167717, 'loss_val': 0.01853176457858277, 'psi': 0.9976015237224412}-{'f1_val': 0.9964101856672208, 'auprc': 0.9987305835468396, 'loss_val': 0.0189138655624686, 'psi': 0.9973383448190684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=93 head_norm_before_train=2.078095 cos_to_last_merge=0.8738 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.874
[S10] round=93 local utility u=0.000697 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9952730705022621, 'loss_val': 0.029766706744630323, 'psi': 0.994047519232997}-{'f1_val': 0.9927922938303682, 'auprc': 0.9962333826016554, 'loss_val': 0.03141309676224482, 'psi': 0.994168729338883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=93 head_norm_before_train=2.029491 cos_to_last_merge=0.8931 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986114389070007, 'loss_val': 0.02067622102814334, 'psi': 0.9971370604092475}-{'f1_val': 0.9961541414107454, 'auprc': 0.998587855430872, 'loss_val': 0.020508363941210184, 'psi': 0.9971276270187961}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=93 head_norm_before_train=2.050966 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.712202772022404, 'auprc': 0.6894993607823543, 'loss_val': 1.2202009084574392, 'psi': 0.7031214075263841}-{'f1_val': 0.7600807413899402, 'auprc': 0.838835381030367, 'loss_val': 0.6969856679451335, 'psi': 0.791582597246111}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=1.825867 cos_to_last_merge=0.9025 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9986598581473398, 'loss_val': 0.0286697780949651, 'psi': 0.9976643711874826}-{'f1_val': 0.9970007132142444, 'auprc': 0.998584317470257, 'loss_val': 0.019386573233558343, 'psi': 0.9976341549166494}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=1.876867 cos_to_last_merge=0.8671 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=93 local utility u=0.454592 metrics={'f1_val': 0.9853631716626432, 'auprc': 0.9978616241439641, 'loss_val': 0.053922275560387645, 'psi': 0.9903625526551716}-{'f1_val': 0.9027624067881995, 'auprc': 0.9465069042848944, 'loss_val': 0.313438490061127, 'psi': 0.9202602057868775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=93 head_norm_before_train=1.932209 cos_to_last_merge=0.8207 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=93 local utility u=0.001121 metrics={'f1_val': 0.9922492709393801, 'auprc': 0.9962010115271647, 'loss_val': 0.03659437040318643, 'psi': 0.9938299671744939}-{'f1_val': 0.992683828688057, 'auprc': 0.994298812495021, 'loss_val': 0.035737316880759325, 'psi': 0.9933298222108427}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=93 head_norm_before_train=2.210616 cos_to_last_merge=0.7473 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=93 local utility u=0.119449 metrics={'f1_val': 0.7349248405825869, 'auprc': 0.95277451583827, 'loss_val': 0.9925966143402561, 'psi': 0.8220647106848602}-{'f1_val': 0.7051030382238721, 'auprc': 0.9696192491027217, 'loss_val': 1.1030975148431015, 'psi': 0.8109095225754119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=94 head_norm_before_train=2.242491 (no previous merge yet)
[S2] round=94 local utility u=0.247766 metrics={'f1_val': 0.6600892673957508, 'auprc': 0.818408404311675, 'loss_val': 0.9917606370859203, 'psi': 0.7234169221621205}-{'f1_val': 0.6335315460468245, 'auprc': 0.796599976192278, 'loss_val': 1.2625208610520848, 'psi': 0.6987589181050059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] sending update (kind=head size=1796 to 1 peers)
[S3] START round=94 head_norm_before_train=2.388124 (no previous merge yet)
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9901814453211425, 'loss_val': 0.19371143628548873, 'psi': 0.9727176293681292}-{'f1_val': 0.9610750853994537, 'auprc': 0.9949821506515709, 'loss_val': 0.1899513817423025, 'psi': 0.9746379115003007}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.875735 cos_to_last_merge=0.7928 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=94 local utility u=0.034375 metrics={'f1_val': 0.9443209481352457, 'auprc': 0.970730613462446, 'loss_val': 0.33286842764164193, 'psi': 0.9548848142661258}-{'f1_val': 0.9391403492914009, 'auprc': 0.9648937777311324, 'loss_val': 0.3530247289500053, 'psi': 0.9494417206672934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=94 head_norm_before_train=1.892185 cos_to_last_merge=0.7597 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=94 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.99016867591624, 'loss_val': 0.03034137148667004, 'psi': 0.9936915999053284}-{'f1_val': 0.9960402158980539, 'auprc': 0.9903513500870743, 'loss_val': 0.028557854795919196, 'psi': 0.9937646695736622}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=94 head_norm_before_train=2.224439 (no previous merge yet)
[S6] round=94 local utility u=0.000000 metrics={'f1_val': 0.9299298271993575, 'auprc': 0.959741065382788, 'loss_val': 0.21755092648158447, 'psi': 0.9418543224727297}-{'f1_val': 0.9623495781342506, 'auprc': 0.9397251106085469, 'loss_val': 0.18412716468110724, 'psi': 0.9532997911239691}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=94 head_norm_before_train=1.930794 (no previous merge yet)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.5987773520838858, 'auprc': 0.7916152887004241, 'loss_val': 0.8902780725256167, 'psi': 0.6759125267305011}-{'f1_val': 0.6202275780238055, 'auprc': 0.7929829935605632, 'loss_val': 0.8151547134051074, 'psi': 0.6893297442385086}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=1.811437 cos_to_last_merge=0.8283 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=94 local utility u=0.000000 metrics={'f1_val': 0.9781096655332426, 'auprc': 0.9992913155069307, 'loss_val': 0.05176867533237278, 'psi': 0.9865823255227179}-{'f1_val': 0.993914489706644, 'auprc': 0.9992314616082787, 'loss_val': 0.026773456697604812, 'psi': 0.9960412784672978}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=94 head_norm_before_train=1.835984 cos_to_last_merge=0.8667 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.867
[S9] round=94 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9968070354912945, 'loss_val': 0.018776998068525372, 'psi': 0.9968343654518721}-{'f1_val': 0.9968525854255906, 'auprc': 0.998724931167717, 'loss_val': 0.01853176457858277, 'psi': 0.9976015237224412}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=94 head_norm_before_train=2.080066 cos_to_last_merge=0.8725 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.872
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9943896130956327, 'loss_val': 0.029700096837034617, 'psi': 0.9936941362703451}-{'f1_val': 0.9932304850534869, 'auprc': 0.9952730705022621, 'loss_val': 0.029766706744630323, 'psi': 0.994047519232997}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.032458 cos_to_last_merge=0.8928 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984274988667203, 'loss_val': 0.020386418593815115, 'psi': 0.9970634843931354}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986114389070007, 'loss_val': 0.02067622102814334, 'psi': 0.9971370604092475}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.053914 (no previous merge yet)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6473502093462077, 'auprc': 0.6758803160981215, 'loss_val': 1.2620951632702677, 'psi': 0.6587622520469731}-{'f1_val': 0.712202772022404, 'auprc': 0.6894993607823543, 'loss_val': 1.2202009084574392, 'psi': 0.7031214075263841}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=1.827861 cos_to_last_merge=0.9024 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.902
[S14] round=94 local utility u=0.006662 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9987398894286293, 'loss_val': 0.017042752718388322, 'psi': 0.9978420928288751}-{'f1_val': 0.9970007132142444, 'auprc': 0.9986598581473398, 'loss_val': 0.0286697780949651, 'psi': 0.9976643711874826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] sending update (kind=head size=1794 to 1 peers)
[S15] START round=94 head_norm_before_train=1.881279 cos_to_last_merge=0.8669 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.867
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9092049287684978, 'auprc': 0.9733671197644034, 'loss_val': 0.18717850829547017, 'psi': 0.93486980516686}-{'f1_val': 0.9853631716626432, 'auprc': 0.9978616241439641, 'loss_val': 0.053922275560387645, 'psi': 0.9903625526551716}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=1.937466 cos_to_last_merge=0.8205 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9918315055070132, 'auprc': 0.9962678164534297, 'loss_val': 0.03708009296940971, 'psi': 0.9936060298855798}-{'f1_val': 0.9922492709393801, 'auprc': 0.9962010115271647, 'loss_val': 0.03659437040318643, 'psi': 0.9938299671744939}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.217101 cos_to_last_merge=0.7472 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=94 local utility u=0.379037 metrics={'f1_val': 0.8337018867406512, 'auprc': 0.9320759402393125, 'loss_val': 0.7650881834696095, 'psi': 0.8730515081401157}-{'f1_val': 0.7349248405825869, 'auprc': 0.95277451583827, 'loss_val': 0.9925966143402561, 'psi': 0.8220647106848602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] sending update (kind=head size=1794 to 1 peers)
[S2] START round=95 head_norm_before_train=2.245820 (no previous merge yet)
[S2] round=95 local utility u=0.247755 metrics={'f1_val': 0.6870827276342031, 'auprc': 0.8520897203690714, 'loss_val': 0.7592554419534846, 'psi': 0.7530855247281504}-{'f1_val': 0.6600892673957508, 'auprc': 0.818408404311675, 'loss_val': 0.9917606370859203, 'psi': 0.7234169221621205}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] START round=95 head_norm_before_train=2.390984 (no previous merge yet)
[S3] round=95 local utility u=0.029545 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.9981699932122786, 'loss_val': 0.1585870212767384, 'psi': 0.9759130485245837}-{'f1_val': 0.9610750853994537, 'auprc': 0.9901814453211425, 'loss_val': 0.19371143628548873, 'psi': 0.9727176293681292}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=95 head_norm_before_train=1.876699 cos_to_last_merge=0.7929 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9435064183710394, 'auprc': 0.9646438295502635, 'loss_val': 0.3369266828136946, 'psi': 0.951961382842729}-{'f1_val': 0.9443209481352457, 'auprc': 0.970730613462446, 'loss_val': 0.33286842764164193, 'psi': 0.9548848142661258}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.896899 cos_to_last_merge=0.7589 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.759
[S5] round=95 local utility u=0.006457 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9931774079160024, 'loss_val': 0.027327656475878242, 'psi': 0.9949825771519876}-{'f1_val': 0.9960402158980539, 'auprc': 0.99016867591624, 'loss_val': 0.03034137148667004, 'psi': 0.9936915999053284}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=95 head_norm_before_train=2.230062 (no previous merge yet)
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.5981600686685818, 'auprc': 0.7043809550964562, 'loss_val': 1.4209114947971646, 'psi': 0.6406484232397316}-{'f1_val': 0.9299298271993575, 'auprc': 0.959741065382788, 'loss_val': 0.21755092648158447, 'psi': 0.9418543224727297}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.933748 (no previous merge yet)
[S7] round=95 local utility u=0.221419 metrics={'f1_val': 0.6256126419199808, 'auprc': 0.7998070078806614, 'loss_val': 0.6330272584383444, 'psi': 0.695290388304253}-{'f1_val': 0.5987773520838858, 'auprc': 0.7916152887004241, 'loss_val': 0.8902780725256167, 'psi': 0.6759125267305011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=95 head_norm_before_train=1.813383 cos_to_last_merge=0.8283 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=95 local utility u=0.026163 metrics={'f1_val': 0.9864681279937945, 'auprc': 0.998932500820377, 'loss_val': 0.04851714340696978, 'psi': 0.9914538771244275}-{'f1_val': 0.9781096655332426, 'auprc': 0.9992913155069307, 'loss_val': 0.05176867533237278, 'psi': 0.9865823255227179}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=95 head_norm_before_train=1.840670 cos_to_last_merge=0.8662 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.866
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9963338379600061, 'loss_val': 0.01854298274999498, 'psi': 0.9966450864393568}-{'f1_val': 0.9968525854255906, 'auprc': 0.9968070354912945, 'loss_val': 0.018776998068525372, 'psi': 0.9968343654518721}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.084417 cos_to_last_merge=0.8714 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.871
[S10] round=95 local utility u=0.002724 metrics={'f1_val': 0.9934252160563725, 'auprc': 0.9960529026137654, 'loss_val': 0.030410281132576836, 'psi': 0.9944762906793296}-{'f1_val': 0.9932304850534869, 'auprc': 0.9943896130956327, 'loss_val': 0.029700096837034617, 'psi': 0.9936941362703451}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=95 head_norm_before_train=2.032867 cos_to_last_merge=0.8924 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=95 local utility u=0.000093 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9984952905354018, 'loss_val': 0.020403549710853588, 'psi': 0.997090601060608}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984274988667203, 'loss_val': 0.020386418593815115, 'psi': 0.9970634843931354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=95 head_norm_before_train=2.056026 (no previous merge yet)
[S13] round=95 local utility u=0.487588 metrics={'f1_val': 0.6732215597100146, 'auprc': 0.8688127043666547, 'loss_val': 1.0209443101941431, 'psi': 0.7514580175726706}-{'f1_val': 0.6473502093462077, 'auprc': 0.6758803160981215, 'loss_val': 1.2620951632702677, 'psi': 0.6587622520469731}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=95 head_norm_before_train=1.830163 cos_to_last_merge=0.9023 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.902
[S14] round=95 local utility u=0.000180 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9986606172998903, 'loss_val': 0.017448843473083404, 'psi': 0.997910843480653}-{'f1_val': 0.9972435617623723, 'auprc': 0.9987398894286293, 'loss_val': 0.017042752718388322, 'psi': 0.9978420928288751}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] sending update (kind=head size=1793 to 1 peers)
[S15] START round=95 head_norm_before_train=1.886485 cos_to_last_merge=0.8665 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=95 local utility u=0.206454 metrics={'f1_val': 0.95098074433832, 'auprc': 0.9936899173169614, 'loss_val': 0.08589457423759826, 'psi': 0.9680644135297767}-{'f1_val': 0.9092049287684978, 'auprc': 0.9733671197644034, 'loss_val': 0.18717850829547017, 'psi': 0.93486980516686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=95 head_norm_before_train=1.940352 cos_to_last_merge=0.8200 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=95 local utility u=0.000034 metrics={'f1_val': 0.9918315055070132, 'auprc': 0.9964421333870656, 'loss_val': 0.03753437218092332, 'psi': 0.9936757566590342}-{'f1_val': 0.9918315055070132, 'auprc': 0.9962678164534297, 'loss_val': 0.03708009296940971, 'psi': 0.9936060298855798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=95 head_norm_before_train=2.219825 cos_to_last_merge=0.7467 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.747
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.7610840861311253, 'auprc': 0.9282506310843022, 'loss_val': 0.9487356676425436, 'psi': 0.8279507041123961}-{'f1_val': 0.8337018867406512, 'auprc': 0.9320759402393125, 'loss_val': 0.7650881834696095, 'psi': 0.8730515081401157}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=96 head_norm_before_train=2.250387 (no previous merge yet)
[S2] round=96 local utility u=0.392412 metrics={'f1_val': 0.7108703458056702, 'auprc': 0.986286053677985, 'loss_val': 0.5197471482908482, 'psi': 0.8210366289545962}-{'f1_val': 0.6870827276342031, 'auprc': 0.8520897203690714, 'loss_val': 0.7592554419534846, 'psi': 0.7530855247281504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=96 head_norm_before_train=2.395105 (no previous merge yet)
[S3] round=96 local utility u=0.013514 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9988162838228554, 'loss_val': 0.13373795405424094, 'psi': 0.9761956678698336}-{'f1_val': 0.9610750853994537, 'auprc': 0.9981699932122786, 'loss_val': 0.1585870212767384, 'psi': 0.9759130485245837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=96 head_norm_before_train=1.878529 cos_to_last_merge=0.7928 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=96 local utility u=0.011826 metrics={'f1_val': 0.9464820908703372, 'auprc': 0.9649146673729674, 'loss_val': 0.33194208653161955, 'psi': 0.9538551214713893}-{'f1_val': 0.9435064183710394, 'auprc': 0.9646438295502635, 'loss_val': 0.3369266828136946, 'psi': 0.951961382842729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=96 head_norm_before_train=1.901247 cos_to_last_merge=0.7584 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.758
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9922853418147758, 'loss_val': 0.02678892528139032, 'psi': 0.994625750711497}-{'f1_val': 0.996186023309311, 'auprc': 0.9931774079160024, 'loss_val': 0.027327656475878242, 'psi': 0.9949825771519876}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.234457 (no previous merge yet)
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.5975282897330799, 'auprc': 0.651661361060192, 'loss_val': 1.597660453572421, 'psi': 0.6191815182639248}-{'f1_val': 0.5981600686685818, 'auprc': 0.7043809550964562, 'loss_val': 1.4209114947971646, 'psi': 0.6406484232397316}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=1.935475 (no previous merge yet)
[S7] round=96 local utility u=0.127488 metrics={'f1_val': 0.6337462968188388, 'auprc': 0.8100136188220557, 'loss_val': 0.4574721704365982, 'psi': 0.7042532256201255}-{'f1_val': 0.6256126419199808, 'auprc': 0.7998070078806614, 'loss_val': 0.6330272584383444, 'psi': 0.695290388304253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=96 head_norm_before_train=1.815605 cos_to_last_merge=0.8280 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=96 local utility u=0.033612 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9996388031678788, 'loss_val': 0.033358404969665835, 'psi': 0.9967311065595281}-{'f1_val': 0.9864681279937945, 'auprc': 0.998932500820377, 'loss_val': 0.04851714340696978, 'psi': 0.9914538771244275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=96 head_norm_before_train=1.845803 cos_to_last_merge=0.8658 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.866
[S9] round=96 local utility u=0.001648 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.997376455827977, 'loss_val': 0.018374128962057857, 'psi': 0.997062133586545}-{'f1_val': 0.9968525854255906, 'auprc': 0.9963338379600061, 'loss_val': 0.01854298274999498, 'psi': 0.9966450864393568}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=96 head_norm_before_train=2.085550 cos_to_last_merge=0.8700 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.870
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9956623795952615, 'loss_val': 0.028833944212221678, 'psi': 0.9942032428701967}-{'f1_val': 0.9934252160563725, 'auprc': 0.9960529026137654, 'loss_val': 0.030410281132576836, 'psi': 0.9944762906793296}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.036172 cos_to_last_merge=0.8921 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9986102085662341, 'loss_val': 0.0210292123501485, 'psi': 0.9971365682729408}-{'f1_val': 0.9961541414107454, 'auprc': 0.9984952905354018, 'loss_val': 0.020403549710853588, 'psi': 0.997090601060608}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.059873 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.610152458659637, 'auprc': 0.6595855359334065, 'loss_val': 1.4139542664528335, 'psi': 0.6299256895691447}-{'f1_val': 0.6732215597100146, 'auprc': 0.8688127043666547, 'loss_val': 1.0209443101941431, 'psi': 0.7514580175726706}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=1.830529 cos_to_last_merge=0.9030 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9940522555841613, 'auprc': 0.9986350636582104, 'loss_val': 0.031067504575084816, 'psi': 0.9958853788137809}-{'f1_val': 0.9974109942678281, 'auprc': 0.9986606172998903, 'loss_val': 0.017448843473083404, 'psi': 0.997910843480653}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=1.891479 cos_to_last_merge=0.8661 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=96 local utility u=0.172922 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9952116231782588, 'loss_val': 0.019211307189953484, 'psi': 0.9961326503038159}-{'f1_val': 0.95098074433832, 'auprc': 0.9936899173169614, 'loss_val': 0.08589457423759826, 'psi': 0.9680644135297767}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=96 head_norm_before_train=1.944610 cos_to_last_merge=0.8196 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.820
[S16] round=96 local utility u=0.001204 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9957583366215996, 'loss_val': 0.03687210600174308, 'psi': 0.9937819320983465}-{'f1_val': 0.9918315055070132, 'auprc': 0.9964421333870656, 'loss_val': 0.03753437218092332, 'psi': 0.9936757566590342}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S16] sending update (kind=head size=1791 to 1 peers)
[S17] START round=96 head_norm_before_train=2.223471 cos_to_last_merge=0.7464 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.746
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.7399307736493556, 'auprc': 0.9427358133986904, 'loss_val': 1.0252227905167535, 'psi': 0.8210527895490896}-{'f1_val': 0.7610840861311253, 'auprc': 0.9282506310843022, 'loss_val': 0.9487356676425436, 'psi': 0.8279507041123961}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.254503 (no previous merge yet)
[S2] round=97 local utility u=0.000000 metrics={'f1_val': 0.7097813334511816, 'auprc': 0.9810630813459986, 'loss_val': 0.6006206875733973, 'psi': 0.8182940326091084}-{'f1_val': 0.7108703458056702, 'auprc': 0.986286053677985, 'loss_val': 0.5197471482908482, 'psi': 0.8210366289545962}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=97 head_norm_before_train=2.399788 (no previous merge yet)
[S3] round=97 local utility u=0.027249 metrics={'f1_val': 0.9661730702897104, 'auprc': 0.9991820350164169, 'loss_val': 0.1106844769008125, 'psi': 0.9793766561803929}-{'f1_val': 0.9611152572344858, 'auprc': 0.9988162838228554, 'loss_val': 0.13373795405424094, 'psi': 0.9761956678698336}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=97 head_norm_before_train=1.879666 cos_to_last_merge=0.7924 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9456436939388865, 'auprc': 0.9596918759145212, 'loss_val': 0.34152899442278306, 'psi': 0.9512629667291403}-{'f1_val': 0.9464820908703372, 'auprc': 0.9649146673729674, 'loss_val': 0.33194208653161955, 'psi': 0.9538551214713893}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=1.907631 cos_to_last_merge=0.7577 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.758
[S5] round=97 local utility u=0.006123 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9953606289509491, 'loss_val': 0.025530063518164458, 'psi': 0.9960319397520178}-{'f1_val': 0.996186023309311, 'auprc': 0.9922853418147758, 'loss_val': 0.02678892528139032, 'psi': 0.994625750711497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=97 head_norm_before_train=2.237126 (no previous merge yet)
[S6] round=97 local utility u=1.000000 metrics={'f1_val': 0.8046889910890427, 'auprc': 0.9089987834472459, 'loss_val': 0.5992027414166797, 'psi': 0.8464129080323239}-{'f1_val': 0.5975282897330799, 'auprc': 0.651661361060192, 'loss_val': 1.597660453572421, 'psi': 0.6191815182639248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=97 head_norm_before_train=1.937440 (no previous merge yet)
[S7] round=97 local utility u=0.253041 metrics={'f1_val': 0.6872173954173179, 'auprc': 0.8328050531309599, 'loss_val': 0.3405901524118955, 'psi': 0.7454524585027746}-{'f1_val': 0.6337462968188388, 'auprc': 0.8100136188220557, 'loss_val': 0.4574721704365982, 'psi': 0.7042532256201255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=97 head_norm_before_train=1.819056 cos_to_last_merge=0.8279 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=97 local utility u=0.003509 metrics={'f1_val': 0.9952266913301999, 'auprc': 0.9997280946351441, 'loss_val': 0.02921192927197878, 'psi': 0.9970272526521776}-{'f1_val': 0.994792642153961, 'auprc': 0.9996388031678788, 'loss_val': 0.033358404969665835, 'psi': 0.9967311065595281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=97 head_norm_before_train=1.849966 cos_to_last_merge=0.8654 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.865
[S9] round=97 local utility u=0.000000 metrics={'f1_val': 0.9910040044536889, 'auprc': 0.9987241068964705, 'loss_val': 0.03171380313970382, 'psi': 0.9940920454308015}-{'f1_val': 0.9968525854255906, 'auprc': 0.997376455827977, 'loss_val': 0.018374128962057857, 'psi': 0.997062133586545}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=97 head_norm_before_train=2.088610 cos_to_last_merge=0.8693 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=97 local utility u=0.000771 metrics={'f1_val': 0.9936689701867679, 'auprc': 0.9951175697132104, 'loss_val': 0.028287542774043304, 'psi': 0.994248409997345}-{'f1_val': 0.9932304850534869, 'auprc': 0.9956623795952615, 'loss_val': 0.028833944212221678, 'psi': 0.9942032428701967}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=97 head_norm_before_train=2.038475 cos_to_last_merge=0.8917 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.892
[S11] round=97 local utility u=0.000000 metrics={'f1_val': 0.9954312449678927, 'auprc': 0.9985642407104512, 'loss_val': 0.021437671425721117, 'psi': 0.996684443264916}-{'f1_val': 0.9961541414107454, 'auprc': 0.9986102085662341, 'loss_val': 0.0210292123501485, 'psi': 0.9971365682729408}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=97 head_norm_before_train=2.063843 (no previous merge yet)
[S13] round=97 local utility u=0.714179 metrics={'f1_val': 0.7463447626122539, 'auprc': 0.7638258440034903, 'loss_val': 1.115471283407879, 'psi': 0.7533371951687484}-{'f1_val': 0.610152458659637, 'auprc': 0.6595855359334065, 'loss_val': 1.4139542664528335, 'psi': 0.6299256895691447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=97 head_norm_before_train=1.831800 cos_to_last_merge=0.9035 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=97 local utility u=0.000000 metrics={'f1_val': 0.9580016685592121, 'auprc': 0.9986968912948829, 'loss_val': 0.049853664417580136, 'psi': 0.9742797576534804}-{'f1_val': 0.9940522555841613, 'auprc': 0.9986350636582104, 'loss_val': 0.031067504575084816, 'psi': 0.9958853788137809}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=97 head_norm_before_train=1.895837 cos_to_last_merge=0.8658 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.866
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.9618640069797617, 'auprc': 0.992792541415121, 'loss_val': 0.067238342678218, 'psi': 0.9742354207539055}-{'f1_val': 0.9967466683875206, 'auprc': 0.9952116231782588, 'loss_val': 0.019211307189953484, 'psi': 0.9961326503038159}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=1.947067 cos_to_last_merge=0.8194 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9941788207110233, 'loss_val': 0.03635114366588832, 'psi': 0.993150125734116}-{'f1_val': 0.9924643290828444, 'auprc': 0.9957583366215996, 'loss_val': 0.03687210600174308, 'psi': 0.9937819320983465}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.228885 cos_to_last_merge=0.7463 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.746
[S17] round=97 local utility u=0.037614 metrics={'f1_val': 0.7405903927766109, 'auprc': 0.9622987467865274, 'loss_val': 1.0126404220004117, 'psi': 0.8292737343805774}-{'f1_val': 0.7399307736493556, 'auprc': 0.9427358133986904, 'loss_val': 1.0252227905167535, 'psi': 0.8210527895490896}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=98 head_norm_before_train=2.258982 (no previous merge yet)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7100410651053514, 'auprc': 0.9408347961234853, 'loss_val': 0.6242827307374423, 'psi': 0.8023585575126049}-{'f1_val': 0.7097813334511816, 'auprc': 0.9810630813459986, 'loss_val': 0.6006206875733973, 'psi': 0.8182940326091084}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.404800 (no previous merge yet)
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.9601039212368431, 'auprc': 0.998350721947106, 'loss_val': 0.1063245114607604, 'psi': 0.9754026415209482}-{'f1_val': 0.9661730702897104, 'auprc': 0.9991820350164169, 'loss_val': 0.1106844769008125, 'psi': 0.9793766561803929}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=1.882977 cos_to_last_merge=0.7919 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=98 local utility u=0.007192 metrics={'f1_val': 0.9536823632450209, 'auprc': 0.946263708755269, 'loss_val': 0.33509313142791164, 'psi': 0.9507149014491201}-{'f1_val': 0.9456436939388865, 'auprc': 0.9596918759145212, 'loss_val': 0.34152899442278306, 'psi': 0.9512629667291403}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=98 head_norm_before_train=1.915091 cos_to_last_merge=0.7567 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9910508062141072, 'loss_val': 0.030154655158216106, 'psi': 0.9940444520244753}-{'f1_val': 0.9964794802860635, 'auprc': 0.9953606289509491, 'loss_val': 0.025530063518164458, 'psi': 0.9960319397520178}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.234739 (no previous merge yet)
[S6] round=98 local utility u=0.282472 metrics={'f1_val': 0.8655926554371645, 'auprc': 0.9162104126601852, 'loss_val': 0.42131636147412727, 'psi': 0.8858397583263727}-{'f1_val': 0.8046889910890427, 'auprc': 0.9089987834472459, 'loss_val': 0.5992027414166797, 'psi': 0.8464129080323239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=98 head_norm_before_train=1.939219 (no previous merge yet)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6179304212519181, 'auprc': 0.7988635575862661, 'loss_val': 0.6124484094109072, 'psi': 0.6903036757856573}-{'f1_val': 0.6872173954173179, 'auprc': 0.8328050531309599, 'loss_val': 0.3405901524118955, 'psi': 0.7454524585027746}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=1.821169 cos_to_last_merge=0.8277 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9939122747783468, 'auprc': 0.9994068195253679, 'loss_val': 0.026421338085303232, 'psi': 0.9961100926771552}-{'f1_val': 0.9952266913301999, 'auprc': 0.9997280946351441, 'loss_val': 0.02921192927197878, 'psi': 0.9970272526521776}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=98 head_norm_before_train=1.852780 cos_to_last_merge=0.8652 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.865
[S9] round=98 local utility u=0.017467 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9940452516879681, 'loss_val': 0.01783374569252137, 'psi': 0.9957296519305416}-{'f1_val': 0.9910040044536889, 'auprc': 0.9987241068964705, 'loss_val': 0.03171380313970382, 'psi': 0.9940920454308015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=98 head_norm_before_train=2.093166 cos_to_last_merge=0.8692 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=98 local utility u=0.000000 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.9957207715564909, 'loss_val': 0.02887124275314065, 'psi': 0.9942265996546884}-{'f1_val': 0.9936689701867679, 'auprc': 0.9951175697132104, 'loss_val': 0.028287542774043304, 'psi': 0.994248409997345}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=98 head_norm_before_train=2.039869 cos_to_last_merge=0.8913 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=98 local utility u=0.002482 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9987995368740502, 'loss_val': 0.021517285147514227, 'psi': 0.9972122995960673}-{'f1_val': 0.9954312449678927, 'auprc': 0.9985642407104512, 'loss_val': 0.021437671425721117, 'psi': 0.996684443264916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=98 head_norm_before_train=2.069307 (no previous merge yet)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.7294417942512562, 'auprc': 0.7023497904249998, 'loss_val': 1.2087639506107006, 'psi': 0.7186049927207536}-{'f1_val': 0.7463447626122539, 'auprc': 0.7638258440034903, 'loss_val': 1.115471283407879, 'psi': 0.7533371951687484}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=1.833243 cos_to_last_merge=0.9035 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.904
[S14] round=98 local utility u=0.137289 metrics={'f1_val': 0.9980403583402068, 'auprc': 0.9987630050127962, 'loss_val': 0.015706525336223253, 'psi': 0.9983294170092426}-{'f1_val': 0.9580016685592121, 'auprc': 0.9986968912948829, 'loss_val': 0.049853664417580136, 'psi': 0.9742797576534804}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=98 head_norm_before_train=1.900619 cos_to_last_merge=0.8654 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.8965396866476267, 'auprc': 0.9114134868214605, 'loss_val': 0.3718365245508513, 'psi': 0.9024892067171602}-{'f1_val': 0.9618640069797617, 'auprc': 0.992792541415121, 'loss_val': 0.067238342678218, 'psi': 0.9742354207539055}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=1.948804 cos_to_last_merge=0.8189 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.819
[S16] round=98 local utility u=0.001887 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9955385316811558, 'loss_val': 0.036656646848203606, 'psi': 0.993694010122169}-{'f1_val': 0.9924643290828444, 'auprc': 0.9941788207110233, 'loss_val': 0.03635114366588832, 'psi': 0.993150125734116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=98 head_norm_before_train=2.235498 cos_to_last_merge=0.7461 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.746
[S17] round=98 local utility u=0.071794 metrics={'f1_val': 0.7533396827893637, 'auprc': 0.9590849020633914, 'loss_val': 0.935906473797784, 'psi': 0.8356377704989748}-{'f1_val': 0.7405903927766109, 'auprc': 0.9622987467865274, 'loss_val': 1.0126404220004117, 'psi': 0.8292737343805774}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=99 head_norm_before_train=2.263325 (no previous merge yet)
[S2] round=99 local utility u=0.265324 metrics={'f1_val': 0.7991639040865967, 'auprc': 0.8829710877907457, 'loss_val': 0.4547815834253599, 'psi': 0.8326867775682563}-{'f1_val': 0.7100410651053514, 'auprc': 0.9408347961234853, 'loss_val': 0.6242827307374423, 'psi': 0.8023585575126049}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] sending update (kind=head size=1793 to 1 peers)
[S2] r=100 psi=0.833 u=0.2653 p_local=0.1709 f1=0.799 auprc=0.883 bytes=100665
[S3] START round=99 head_norm_before_train=2.408749 (no previous merge yet)
[S3] round=99 local utility u=0.101614 metrics={'f1_val': 0.9878880744530758, 'auprc': 0.9983342938830038, 'loss_val': 0.06975139967642598, 'psi': 0.9920665622250471}-{'f1_val': 0.9601039212368431, 'auprc': 0.998350721947106, 'loss_val': 0.1063245114607604, 'psi': 0.9754026415209482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S3] r=100 psi=0.992 u=0.1016 p_local=0.0597 f1=0.988 auprc=0.998 bytes=104360
[S4] START round=99 head_norm_before_train=1.887552 cos_to_last_merge=0.7912 (last merge round=15)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9403689585046024, 'auprc': 0.9638641169226083, 'loss_val': 0.3395858460091165, 'psi': 0.9497670218718048}-{'f1_val': 0.9536823632450209, 'auprc': 0.946263708755269, 'loss_val': 0.33509313142791164, 'psi': 0.9507149014491201}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.950 u=0.0000 p_local=0.0070 f1=0.940 auprc=0.964 bytes=95407
[S5] START round=99 head_norm_before_train=1.922502 cos_to_last_merge=0.7555 (last merge round=1)
[S5] ⚠️ Model drifted since last merge! cos=0.756
[S5] round=99 local utility u=0.012318 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9967953559594802, 'loss_val': 0.025387706171199734, 'psi': 0.9966058305554302}-{'f1_val': 0.9960402158980539, 'auprc': 0.9910508062141072, 'loss_val': 0.030154655158216106, 'psi': 0.9940444520244753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=100 psi=0.997 u=0.0123 p_local=0.0209 f1=0.996 auprc=0.997 bytes=104257
[S6] START round=99 head_norm_before_train=2.236656 (no previous merge yet)
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.8383057342206748, 'auprc': 0.9394361875579823, 'loss_val': 0.5042709486780315, 'psi': 0.8787579155555978}-{'f1_val': 0.8655926554371645, 'auprc': 0.9162104126601852, 'loss_val': 0.42131636147412727, 'psi': 0.8858397583263727}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.879 u=0.0000 p_local=0.2847 f1=0.838 auprc=0.939 bytes=89880
[S7] START round=99 head_norm_before_train=1.940758 (no previous merge yet)
[S7] round=99 local utility u=0.066775 metrics={'f1_val': 0.6334424287297691, 'auprc': 0.798866973480976, 'loss_val': 0.5719812694536424, 'psi': 0.6996122466302519}-{'f1_val': 0.6179304212519181, 'auprc': 0.7988635575862661, 'loss_val': 0.6124484094109072, 'psi': 0.6903036757856573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S7] r=100 psi=0.700 u=0.0668 p_local=0.1159 f1=0.633 auprc=0.799 bytes=97196
[S8] START round=99 head_norm_before_train=1.823294 cos_to_last_merge=0.8275 (last merge round=15)
[S8] ⚠️ Model drifted since last merge! cos=0.828
[S8] round=99 local utility u=0.000000 metrics={'f1_val': 0.9877803895057649, 'auprc': 0.9990273651423881, 'loss_val': 0.04151227391911521, 'psi': 0.9922791797604141}-{'f1_val': 0.9939122747783468, 'auprc': 0.9994068195253679, 'loss_val': 0.026421338085303232, 'psi': 0.9961100926771552}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=100 psi=0.992 u=0.0000 p_local=0.0144 f1=0.988 auprc=0.999 bytes=106105
[S9] START round=99 head_norm_before_train=1.854291 cos_to_last_merge=0.8652 (last merge round=15)
[S9] ⚠️ Model drifted since last merge! cos=0.865
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9939028526505729, 'loss_val': 0.018323989752796883, 'psi': 0.9955766358190865}-{'f1_val': 0.9968525854255906, 'auprc': 0.9940452516879681, 'loss_val': 0.01783374569252137, 'psi': 0.9957296519305416}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.996 u=0.0000 p_local=0.0036 f1=0.997 auprc=0.994 bytes=98769
[S10] START round=99 head_norm_before_train=2.098882 cos_to_last_merge=0.8688 (last merge round=14)
[S10] ⚠️ Model drifted since last merge! cos=0.869
[S10] round=99 local utility u=0.000086 metrics={'f1_val': 0.9932304850534869, 'auprc': 0.995788776513019, 'loss_val': 0.02890280393804567, 'psi': 0.9942538016372997}-{'f1_val': 0.9932304850534869, 'auprc': 0.9957207715564909, 'loss_val': 0.02887124275314065, 'psi': 0.9942265996546884}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S10] r=100 psi=0.994 u=0.0001 p_local=0.0004 f1=0.993 auprc=0.996 bytes=116925
[S11] START round=99 head_norm_before_train=2.042614 cos_to_last_merge=0.8910 (last merge round=16)
[S11] ⚠️ Model drifted since last merge! cos=0.891
[S11] round=99 local utility u=0.000219 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9989398887531298, 'loss_val': 0.021501113639707345, 'psi': 0.9972684403476991}-{'f1_val': 0.9961541414107454, 'auprc': 0.9987995368740502, 'loss_val': 0.021517285147514227, 'psi': 0.9972122995960673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=100 psi=0.997 u=0.0002 p_local=0.0011 f1=0.996 auprc=0.999 bytes=120443
[S13] START round=99 head_norm_before_train=2.073777 (no previous merge yet)
[S13] round=99 local utility u=0.275893 metrics={'f1_val': 0.7117893102984958, 'auprc': 0.8055157938742105, 'loss_val': 0.8605605974705133, 'psi': 0.7492799037287816}-{'f1_val': 0.7294417942512562, 'auprc': 0.7023497904249998, 'loss_val': 1.2087639506107006, 'psi': 0.7186049927207536}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S13] r=100 psi=0.749 u=0.2759 p_local=0.2312 f1=0.712 auprc=0.806 bytes=99039
[S14] START round=99 head_norm_before_train=1.835353 cos_to_last_merge=0.9030 (last merge round=16)
[S14] ⚠️ Model drifted since last merge! cos=0.903
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9976291097282272, 'auprc': 0.9990828868928845, 'loss_val': 0.014727913599601983, 'psi': 0.9982106205940902}-{'f1_val': 0.9980403583402068, 'auprc': 0.9987630050127962, 'loss_val': 0.015706525336223253, 'psi': 0.9983294170092426}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.998 u=0.0000 p_local=0.0245 f1=0.998 auprc=0.999 bytes=120291
[S15] START round=99 head_norm_before_train=1.905565 cos_to_last_merge=0.8650 (last merge round=15)
[S15] ⚠️ Model drifted since last merge! cos=0.865
[S15] round=99 local utility u=0.390596 metrics={'f1_val': 0.9458428224592702, 'auprc': 0.995578224193189, 'loss_val': 0.1389569123128204, 'psi': 0.9657369831528377}-{'f1_val': 0.8965396866476267, 'auprc': 0.9114134868214605, 'loss_val': 0.3718365245508513, 'psi': 0.9024892067171602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=100 psi=0.966 u=0.3906 p_local=0.1525 f1=0.946 auprc=0.996 bytes=98910
[S16] START round=99 head_norm_before_train=1.951822 cos_to_last_merge=0.8185 (last merge round=12)
[S16] ⚠️ Model drifted since last merge! cos=0.818
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9924643290828444, 'auprc': 0.9956630640896516, 'loss_val': 0.03736718663430441, 'psi': 0.9937438230855673}-{'f1_val': 0.9924643290828444, 'auprc': 0.9955385316811558, 'loss_val': 0.036656646848203606, 'psi': 0.993694010122169}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.994 u=0.0000 p_local=0.0006 f1=0.992 auprc=0.996 bytes=102301
[S17] START round=99 head_norm_before_train=2.239571 cos_to_last_merge=0.7456 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.746
[S17] round=99 local utility u=0.160001 metrics={'f1_val': 0.796270975592603, 'auprc': 0.9475818135118617, 'loss_val': 0.8389822863213444, 'psi': 0.8567953107603065}-{'f1_val': 0.7533396827893637, 'auprc': 0.9590849020633914, 'loss_val': 0.935906473797784, 'psi': 0.8356377704989748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] r=100 psi=0.857 u=0.1600 p_local=0.1200 f1=0.796 auprc=0.948 bytes=88204
[runner] rounds complete.
[runner] all agents stopped.
