[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:62403
[S3] → join 127.0.0.1:62402
[S4] → join 127.0.0.1:62402
[S5] → join 127.0.0.1:62402
[S6] → join 127.0.0.1:62402
[S7] → join 127.0.0.1:62402
[S8] → join 127.0.0.1:62402
[S9] → join 127.0.0.1:62402
[S10] → join 127.0.0.1:62402
[S11] → join 127.0.0.1:62402
[S13] → join 127.0.0.1:62402
[S14] → join 127.0.0.1:62402
[S15] → join 127.0.0.1:62402
[S16] → join 127.0.0.1:62402
[S17] → join 127.0.0.1:62402
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.119186 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.205126 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.147262 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.169905 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.211809 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.124729 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.174537 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.192444 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.105946 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.119875 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.182335 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.175550 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.199485 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.156879 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.156669 (no previous merge yet)
[S14]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S11]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S10
[S3] + discovered S15
[S3] + discovered S11
[S3] + discovered S13
[S3] + discovered S9
[S3] + discovered S14
[S3] + discovered S16
[S3] + discovered S17
[S3] + discovered S8
[S3] + discovered S4
[S3] + discovered S6
[S3] + discovered S7
[S4] + discovered S2
[S4] + discovered S3
[S5] + discovered S3
[S4] + discovered S17
[S4] + discovered S15
[S4] + discovered S6
[S4] + discovered S11
[S4] + discovered S7
[S4] + discovered S14
[S4] + discovered S10
[S4] + discovered S8
[S4] + discovered S16
[S4] + discovered S5
[S5] + discovered S2
[S4] + discovered S9
[S5] + discovered S4
[S4] + discovered S13
[S5] + discovered S7
[S5] + discovered S14
[S6] + discovered S4
[S5] + discovered S11
[S5] + discovered S16
[S6] + discovered S2
[S5] + discovered S15
[S5] + discovered S17
[S6] + discovered S3
[S5] + discovered S8
[S5] + discovered S13
[S5] + discovered S6
[S6] + discovered S5
[S5] + discovered S10
[S5] + discovered S9
[S7] + discovered S6
[S7] + discovered S5
[S6] + discovered S11
[S7] + discovered S2
[S7] + discovered S4
[S6] + discovered S10
[S6] + discovered S15
[S6] + discovered S16
[S6] + discovered S14
[S6] + discovered S13
[S6] + discovered S9
[S6] + discovered S7
[S6] + discovered S8
[S6] + discovered S17
[S7] + discovered S3
[S8] + discovered S5
[S8] + discovered S6
[S8] + discovered S3
[S8] + discovered S7
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S9
[S7] + discovered S8
[S7] + discovered S14
[S7] + discovered S11
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S15
[S7] + discovered S17
[S7] + discovered S16
[S9] + discovered S6
[S9] + discovered S8
[S8] + discovered S16
[S8] + discovered S17
[S8] + discovered S9
[S9] + discovered S2
[S9] + discovered S7
[S8] + discovered S15
[S8] + discovered S11
[S8] + discovered S13
[S8] + discovered S14
[S8] + discovered S10
[S9] + discovered S4
[S9] + discovered S5
[S9] + discovered S3
[S10] + discovered S9
[S9] + discovered S17
[S10] + discovered S2
[S10] + discovered S5
[S9] + discovered S14
[S9] + discovered S13
[S9] + discovered S10
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S16
[S10] + discovered S6
[S10] + discovered S3
[S10] + discovered S7
[S10] + discovered S8
[S10] + discovered S4
[S10] + discovered S13
[S10] + discovered S15
[S11] + discovered S3
[S11] + discovered S4
[S11] + discovered S5
[S10] + discovered S11
[S11] + discovered S6
[S10] + discovered S17
[S11] + discovered S9
[S11] + discovered S8
[S11] + discovered S7
[S11] + discovered S10
[S11] + discovered S2
[S10] + discovered S16
[S10] + discovered S14
[S13] + discovered S5
[S13] + discovered S2
[S11] + discovered S16
[S13] + discovered S3
[S13] + discovered S11
[S13] + discovered S7
[S13] + discovered S8
[S13] + discovered S9
[S13] + discovered S4
[S13] + discovered S10
[S11] + discovered S14
[S13] + discovered S6
[S11] + discovered S13
[S11] + discovered S15
[S11] + discovered S17
[S14] + discovered S11
[S14] + discovered S4
[S14] + discovered S8
[S14] + discovered S5
[S13] + discovered S17
[S14] + discovered S3
[S14] + discovered S10
[S14] + discovered S6
[S13] + discovered S15
[S14] + discovered S9
[S13] + discovered S14
[S14] + discovered S13
[S13] + discovered S16
[S14] + discovered S7
[S14] + discovered S2
[S15] + discovered S8
[S15] + discovered S14
[S14] + discovered S15
[S15] + discovered S11
[S15] + discovered S2
[S15] + discovered S6
[S14] + discovered S16
[S14] + discovered S17
[S15] + discovered S10
[S15] + discovered S13
[S15] + discovered S7
[S15] + discovered S4
[S15] + discovered S3
[S15] + discovered S9
[S15] + discovered S5
[S16] + discovered S11
[S15] + discovered S16
[S16] + discovered S3
[S16] + discovered S8
[S16] + discovered S4
[S16] + discovered S9
[S16] + discovered S7
[S15] + discovered S17
[S16] + discovered S2
[S16] + discovered S5
[S16] + discovered S6
[S16] + discovered S15
[S16] + discovered S14
[S16] + discovered S13
[S16] + discovered S10
[S17] + discovered S5
[S17] + discovered S15
[S17] + discovered S13
[S17] + discovered S7
[S17] + discovered S4
[S17] + discovered S16
[S17] + discovered S2
[S16] + discovered S17
[S17] + discovered S10
[S17] + discovered S9
[S17] + discovered S14
[S17] + discovered S11
[S17] + discovered S6
[S17] + discovered S8
[S17] + discovered S3
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S6] ⇄ pheromone p=1.000 → S15@127.0.0.1:62415
[S10] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S4] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S3] ⇄ pheromone p=1.000 → S2@127.0.0.1:62402
[S14] ⇄ pheromone p=1.000 → S11@127.0.0.1:62412
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S7] ⇄ pheromone p=1.000 → S6@127.0.0.1:62407
[S11] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S13] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S5] ⇄ pheromone p=1.000 → S9@127.0.0.1:62410
[S16] ⇄ pheromone p=1.000 → S4@127.0.0.1:62404
[S9] ⇄ pheromone p=1.000 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=1.000 → S5@127.0.0.1:62405
[S2] START round=1 head_norm_before_train=1.123804 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.16699266503667481, 'auprc': 0.6053301477180278, 'loss_val': 1.305392469186668, 'psi': 0.342327658109216}-{'f1_val': 0.2988861280936346, 'auprc': 0.6003500495396601, 'loss_val': 1.3475337212082514, 'psi': 0.41947169667204476}
[S3] START round=1 head_norm_before_train=1.197438 (no previous merge yet)
[S3] round=1 local utility u=0.565857 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9850810422241505, 'loss_val': 1.3127054440705181, 'psi': 0.4779364562581244}-{'f1_val': 0.17822308207434762, 'auprc': 0.5528689111025872, 'loss_val': 1.3780810128886887, 'psi': 0.3280814136856435}
[S4] START round=1 head_norm_before_train=1.154358 (no previous merge yet)
[S4] round=1 local utility u=0.015593 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7582369431263275, 'loss_val': 1.322498437828708, 'psi': 0.3874307545876415}-{'f1_val': 0.14022662889518414, 'auprc': 0.7587212530229623, 'loss_val': 1.3551379221440805, 'psi': 0.38762447854629545}
[S5] START round=1 head_norm_before_train=1.195674 (no previous merge yet)
[S5] round=1 local utility u=0.038125 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7330744865222869, 'loss_val': 1.2509626677305994, 'psi': 0.37858693746605765}-{'f1_val': 0.14226190476190476, 'auprc': 0.7286922299652292, 'loss_val': 1.3140665777393967, 'psi': 0.3768340348432345}
[S6] START round=1 head_norm_before_train=1.213850 (no previous merge yet)
[S6] round=1 local utility u=1.000000 metrics={'f1_val': 0.4006736677058834, 'auprc': 0.9535482258889794, 'loss_val': 1.334889845837731, 'psi': 0.6218234909791218}-{'f1_val': 0.10398230088495575, 'auprc': 0.5916105204823325, 'loss_val': 1.3723192227915322, 'psi': 0.29903358872390645}
[S7] START round=1 head_norm_before_train=1.133314 (no previous merge yet)
[S7] round=1 local utility u=0.193326 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7698474221860068, 'loss_val': 1.285218140693579, 'psi': 0.39317306251185774}-{'f1_val': 0.14205682272909165, 'auprc': 0.6544450675198697, 'loss_val': 1.3256635878010286, 'psi': 0.3470121206454029}
[S8] START round=1 head_norm_before_train=1.175280 (no previous merge yet)
[S8] round=1 local utility u=0.014622 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6625110576993641, 'loss_val': 1.3120869385958287, 'psi': 0.34897801251551996}-{'f1_val': 0.13995598239295717, 'auprc': 0.6634493035285165, 'loss_val': 1.344146594081847, 'psi': 0.3493533108471809}
[S9] START round=1 head_norm_before_train=1.208023 (no previous merge yet)
[S9] round=1 local utility u=0.069554 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6852294655040543, 'loss_val': 1.2421685815090624, 'psi': 0.35893056048561933}-{'f1_val': 0.141397957139996, 'auprc': 0.6677806144824436, 'loss_val': 1.3289307272142645, 'psi': 0.3519510200769751}
[S10] START round=1 head_norm_before_train=1.119004 (no previous merge yet)
[S10] round=1 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7433878635122612, 'loss_val': 1.3222184638772276, 'psi': 0.38052812792993884}-{'f1_val': 0.1480675081226588, 'auprc': 0.742701723979063, 'loss_val': 1.3533142800477427, 'psi': 0.38592119446522044}
[S11] START round=1 head_norm_before_train=1.122028 (no previous merge yet)
[S11] round=1 local utility u=1.000000 metrics={'f1_val': 0.4150663577634667, 'auprc': 0.7045240602124906, 'loss_val': 1.3445578530561155, 'psi': 0.5308494387430762}-{'f1_val': 0.10359570269677702, 'auprc': 0.41515937405454434, 'loss_val': 1.382867221269145, 'psi': 0.22822117123988395}
[S13] START round=1 head_norm_before_train=1.185505 (no previous merge yet)
[S13] round=1 local utility u=0.377785 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.5728903110893131, 'loss_val': 1.318527179910133, 'psi': 0.3133875819819571}-{'f1_val': 0.1403857625770531, 'auprc': 0.3295934945818893, 'loss_val': 1.3442059618692097, 'psi': 0.21606885537898757}
[S14] START round=1 head_norm_before_train=1.176078 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.5802037250074394, 'loss_val': 1.333587577513529, 'psi': 0.31629620173259804}-{'f1_val': 0.31179687371316567, 'auprc': 0.37994724319324097, 'loss_val': 1.3566659789318711, 'psi': 0.3390570215051958}
[S15] START round=1 head_norm_before_train=1.213333 (no previous merge yet)
[S15] round=1 local utility u=0.408006 metrics={'f1_val': 0.4218198474858389, 'auprc': 0.7462231242756515, 'loss_val': 1.3081890495323565, 'psi': 0.551581158201764}-{'f1_val': 0.3899842329997225, 'auprc': 0.5467136691464689, 'loss_val': 1.3346597982777306, 'psi': 0.45267600745842107}
[S16] START round=1 head_norm_before_train=1.159348 (no previous merge yet)
[S16] round=1 local utility u=0.348926 metrics={'f1_val': 0.10386473429951691, 'auprc': 0.7914330012851196, 'loss_val': 1.3402148409798962, 'psi': 0.378892041093758}-{'f1_val': 0.10386473429951691, 'auprc': 0.5695984629057992, 'loss_val': 1.3725624407803705, 'psi': 0.2901582257420298}
[S17] START round=1 head_norm_before_train=1.158934 (no previous merge yet)
[S17] round=1 local utility u=0.140602 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8793774611749978, 'loss_val': 1.3364935194583623, 'psi': 0.43632036246042977}-{'f1_val': 0.14094896331738438, 'auprc': 0.7937687509390183, 'loss_val': 1.3608706535003543, 'psi': 0.402076878366038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:62412
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S8@127.0.0.1:62409
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] → sending delta(kind=head bytes=1793) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S6] → sending delta(kind=head bytes=1792) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S3] → sending delta(kind=head bytes=1790) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:62411
[S4] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S6] sending update (kind=head size=1792 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S9] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1790 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1790) from S3
[S17] cosine check vs S3: cos=-0.0827
[S17] DROPPED delta from S3 (cos=-0.0827 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1798) from S5
[S10] cosine check vs S5: cos=-0.0692
[S10] DROPPED delta from S5 (cos=-0.0692 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1789) from S13
[S8] cosine check vs S13: cos=-0.0045
[S8] DROPPED delta from S13 (cos=-0.0045 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1792) from S6
[S17] cosine check vs S6: cos=0.0146
[S11] RECEIVED delta(kind=head bytes=1790) from S7
[S11] cosine check vs S7: cos=-0.0279
[S11] DROPPED delta from S7 (cos=-0.0279 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1791) from S8
[S2] cosine check vs S8: cos=0.0811
[S11] RECEIVED delta(kind=head bytes=1789) from S4
[S11] cosine check vs S4: cos=0.0689
[S4] RECEIVED delta(kind=head bytes=1793) from S9
[S4] cosine check vs S9: cos=-0.0156
[S4] DROPPED delta from S9 (cos=-0.0156 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S16] → sending delta(kind=head bytes=1784) to S13@127.0.0.1:62413
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S11] → sending delta(kind=head bytes=1786) to S17@127.0.0.1:62417
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1784 reason=None
[S17] → sending delta(kind=head bytes=1784) to S7@127.0.0.1:62408
[S11] sending update (kind=head size=1786 to 1 peers)
[S16] sending update (kind=head size=1784 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1784) from S16
[S13] cosine check vs S16: cos=-0.0871
[S13] DROPPED delta from S16 (cos=-0.0871 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1786) from S11
[S17] cosine check vs S11: cos=-0.0829
[S17] DROPPED delta from S11 (cos=-0.0829 < 0.0)
[S17] sending update (kind=head size=1784 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1784) from S17
[S7] cosine check vs S17: cos=0.0522
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:62405
[S15] sending update (kind=head size=1791 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S15
[S5] cosine check vs S15: cos=-0.0629
[S5] DROPPED delta from S15 (cos=-0.0629 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.166960
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.040255e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.847161 delta_norm=0.804025
[S7] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=1 metric=0.1670 head_norm=1.137522
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.872477e-01
[S2] stored merged vector for next round verification (round=1)
[S2] DEBUG after merge:  round=1 metric=0.1670 head_norm=0.853859 delta_norm=0.787248
[S2] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.4151 head_norm=1.133236
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.856351e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.841738 delta_norm=0.785635
[S11] aggregate: ROLLBACK (f1_val pre=0.415 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.168966
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.403966e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.852733 delta_norm=0.840397
[S17] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=0.853859 cos_to_last_merge=1.0000 (last merge round=1)
[S2] round=2 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6029534081702501, 'loss_val': 1.2909268321038119, 'psi': 0.32624764330124006}-{'f1_val': 0.16699266503667481, 'auprc': 0.6053301477180278, 'loss_val': 1.305392469186668, 'psi': 0.342327658109216}
[S3] START round=2 head_norm_before_train=1.221492 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8878696256995573, 'loss_val': 1.2329875630838116, 'psi': 0.4390518896482871}-{'f1_val': 0.13984006561410703, 'auprc': 0.9850810422241505, 'loss_val': 1.3127054440705181, 'psi': 0.4779364562581244}
[S4] START round=2 head_norm_before_train=1.169301 (no previous merge yet)
[S4] round=2 local utility u=0.053638 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7793904883408438, 'loss_val': 1.2786822389910595, 'psi': 0.395892172673448}-{'f1_val': 0.14022662889518414, 'auprc': 0.7582369431263275, 'loss_val': 1.322498437828708, 'psi': 0.3874307545876415}
[S5] START round=2 head_norm_before_train=1.238597 (no previous merge yet)
[S5] round=2 local utility u=0.100805 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7700564729374838, 'loss_val': 1.1602983623052459, 'psi': 0.3933797320321364}-{'f1_val': 0.14226190476190476, 'auprc': 0.7330744865222869, 'loss_val': 1.2509626677305994, 'psi': 0.37858693746605765}
[S6] START round=2 head_norm_before_train=1.224891 (no previous merge yet)
[S6] round=2 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.9536839375928478, 'loss_val': 1.295215274311985, 'psi': 0.46632934426790834}-{'f1_val': 0.4006736677058834, 'auprc': 0.9535482258889794, 'loss_val': 1.334889845837731, 'psi': 0.6218234909791218}
[S7] START round=2 head_norm_before_train=0.847161 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.007708 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7704488695876015, 'loss_val': 1.2716062404797857, 'psi': 0.39341364147249563}-{'f1_val': 0.14205682272909165, 'auprc': 0.7698474221860068, 'loss_val': 1.285218140693579, 'psi': 0.39317306251185774}
[S8] START round=2 head_norm_before_train=1.184784 (no previous merge yet)
[S8] round=2 local utility u=0.019233 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.6641711536438849, 'loss_val': 1.2786013782123495, 'psi': 0.3496420508933283}-{'f1_val': 0.13995598239295717, 'auprc': 0.6625110576993641, 'loss_val': 1.3120869385958287, 'psi': 0.34897801251551996}
[S9] START round=2 head_norm_before_train=1.251969 (no previous merge yet)
[S9] round=2 local utility u=0.043397 metrics={'f1_val': 0.141397957139996, 'auprc': 0.6722747055860033, 'loss_val': 1.1165103803875518, 'psi': 0.35374865651839893}-{'f1_val': 0.141397957139996, 'auprc': 0.6852294655040543, 'loss_val': 1.2421685815090624, 'psi': 0.35893056048561933}
[S10] START round=2 head_norm_before_train=1.141520 (no previous merge yet)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6757243391989244, 'loss_val': 1.2862934254643585, 'psi': 0.3534627182046041}-{'f1_val': 0.13862163754172394, 'auprc': 0.7433878635122612, 'loss_val': 1.3222184638772276, 'psi': 0.38052812792993884}
[S11] START round=2 head_norm_before_train=0.841738 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7506474468886096, 'loss_val': 1.316246379167579, 'psi': 0.3845071887793102}-{'f1_val': 0.4150663577634667, 'auprc': 0.7045240602124906, 'loss_val': 1.3445578530561155, 'psi': 0.5308494387430762}
[S13] START round=2 head_norm_before_train=1.198006 (no previous merge yet)
[S13] round=2 local utility u=0.097887 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.6297810819954139, 'loss_val': 1.2934248493750211, 'psi': 0.33614389034439746}-{'f1_val': 0.1403857625770531, 'auprc': 0.5728903110893131, 'loss_val': 1.318527179910133, 'psi': 0.3133875819819571}
[S14] START round=2 head_norm_before_train=1.185156 (no previous merge yet)
[S14] round=2 local utility u=0.238779 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7299905668622358, 'loss_val': 1.3053891841240588, 'psi': 0.3762109384745166}-{'f1_val': 0.14035785288270378, 'auprc': 0.5802037250074394, 'loss_val': 1.333587577513529, 'psi': 0.31629620173259804}
[S15] START round=2 head_norm_before_train=1.230557 (no previous merge yet)
[S15] round=2 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7539717669704035, 'loss_val': 1.2691810405479411, 'psi': 0.3854288976050964}-{'f1_val': 0.4218198474858389, 'auprc': 0.7462231242756515, 'loss_val': 1.3081890495323565, 'psi': 0.551581158201764}
[S16] START round=2 head_norm_before_train=1.170211 (no previous merge yet)
[S16] round=2 local utility u=0.195430 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8353994272335792, 'loss_val': 1.3018900614911182, 'psi': 0.41854224101295356}-{'f1_val': 0.10386473429951691, 'auprc': 0.7914330012851196, 'loss_val': 1.3402148409798962, 'psi': 0.378892041093758}
[S17] START round=2 head_norm_before_train=0.852733 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.7792383903310367, 'loss_val': 1.344777400192678, 'psi': 0.39626473412284535}-{'f1_val': 0.14094896331738438, 'auprc': 0.8793774611749978, 'loss_val': 1.3364935194583623, 'psi': 0.43632036246042977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S15@127.0.0.1:62415
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S14] → sending delta(kind=head bytes=1791) to S16@127.0.0.1:62416
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:62411
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S8] → sending delta(kind=head bytes=1794) to S15@127.0.0.1:62415
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S7] sending update (kind=head size=1797 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S14] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S4] sending update (kind=head size=1795 to 1 peers)
[S16] RECEIVED delta(kind=head bytes=1791) from S14
[S16] cosine check vs S14: cos=0.0411
[S4] RECEIVED delta(kind=head bytes=1797) from S7
[S4] cosine check vs S7: cos=-0.0007
[S4] DROPPED delta from S7 (cos=-0.0007 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1788) from S16
[S10] cosine check vs S16: cos=0.0041
[S15] RECEIVED delta(kind=head bytes=1789) from S13
[S15] cosine check vs S13: cos=-0.0528
[S15] DROPPED delta from S13 (cos=-0.0528 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0065
[S3] DROPPED delta from S5 (cos=-0.0065 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1794) from S8
[S15] cosine check vs S8: cos=-0.0564
[S15] DROPPED delta from S8 (cos=-0.0564 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S4
[S10] cosine check vs S4: cos=-0.0122
[S10] DROPPED delta from S4 (cos=-0.0122 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1795) from S9
[S10] cosine check vs S9: cos=-0.0381
[S10] DROPPED delta from S9 (cos=-0.0381 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=1.170616
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.343091e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.837748 delta_norm=0.834309
[S10] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S16] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S16] DEBUG before merge: round=2 metric=0.1406 head_norm=1.193920
[S16] _apply_head_vector_avg (torch): Δ‖w‖=8.309646e-01
[S16] stored merged vector for next round verification (round=2)
[S16] DEBUG after merge:  round=2 metric=0.1672 head_norm=0.865822 delta_norm=0.830965
[S16] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=0.877088 cos_to_last_merge=0.9964 (last merge round=1)
[S2] round=3 local utility u=0.041195 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6099717181273097, 'loss_val': 1.2295911694984227, 'psi': 0.3290549672840639}-{'f1_val': 0.1417771333885667, 'auprc': 0.6029534081702501, 'loss_val': 1.2909268321038119, 'psi': 0.32624764330124006}
[S3] START round=3 head_norm_before_train=1.267047 (no previous merge yet)
[S3] round=3 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.7969640999959826, 'loss_val': 1.0656857777326045, 'psi': 0.4026896793668573}-{'f1_val': 0.13984006561410703, 'auprc': 0.8878696256995573, 'loss_val': 1.2329875630838116, 'psi': 0.4390518896482871}
[S4] START round=3 head_norm_before_train=1.193893 (no previous merge yet)
[S4] round=3 local utility u=0.017298 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7693993886356847, 'loss_val': 1.2141125628977045, 'psi': 0.3918957327913844}-{'f1_val': 0.14022662889518414, 'auprc': 0.7793904883408438, 'loss_val': 1.2786822389910595, 'psi': 0.395892172673448}
[S5] START round=3 head_norm_before_train=1.283371 (no previous merge yet)
[S5] round=3 local utility u=0.925011 metrics={'f1_val': 0.41795135763108626, 'auprc': 0.7773674874159251, 'loss_val': 0.9863463324008589, 'psi': 0.5617178095450218}-{'f1_val': 0.14226190476190476, 'auprc': 0.7700564729374838, 'loss_val': 1.1602983623052459, 'psi': 0.3933797320321364}
[S6] START round=3 head_norm_before_train=1.243531 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7733460749787086, 'loss_val': 1.259995741209978, 'psi': 0.39419419922225263}-{'f1_val': 0.14142628205128205, 'auprc': 0.9536839375928478, 'loss_val': 1.295215274311985, 'psi': 0.46632934426790834}
[S7] START round=3 head_norm_before_train=0.880749 cos_to_last_merge=0.9949 (last merge round=1)
[S7] round=3 local utility u=0.025856 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7727216717696557, 'loss_val': 1.2267131395988327, 'psi': 0.39432276234531727}-{'f1_val': 0.14205682272909165, 'auprc': 0.7704488695876015, 'loss_val': 1.2716062404797857, 'psi': 0.39341364147249563}
[S8] START round=3 head_norm_before_train=1.202114 (no previous merge yet)
[S8] round=3 local utility u=0.138884 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7450529316691465, 'loss_val': 1.2434786915833562, 'psi': 0.38199476210343297}-{'f1_val': 0.13995598239295717, 'auprc': 0.6641711536438849, 'loss_val': 1.2786013782123495, 'psi': 0.3496420508933283}
[S9] START round=3 head_norm_before_train=1.314373 (no previous merge yet)
[S9] round=3 local utility u=0.255395 metrics={'f1_val': 0.18889371980676328, 'auprc': 0.6691565678092241, 'loss_val': 0.8813399099014754, 'psi': 0.3809988590077476}-{'f1_val': 0.141397957139996, 'auprc': 0.6722747055860033, 'loss_val': 1.1165103803875518, 'psi': 0.35374865651839893}
[S10] START round=3 head_norm_before_train=0.837748 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6020533113946186, 'loss_val': 1.2790493141626498, 'psi': 0.3239943070828818}-{'f1_val': 0.13862163754172394, 'auprc': 0.6757243391989244, 'loss_val': 1.2862934254643585, 'psi': 0.3534627182046041}
[S11] START round=3 head_norm_before_train=0.863867 cos_to_last_merge=0.9966 (last merge round=1)
[S11] round=3 local utility u=0.016341 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7437141413608004, 'loss_val': 1.2627649825196245, 'psi': 0.38173386656818653}-{'f1_val': 0.14041368337311058, 'auprc': 0.7506474468886096, 'loss_val': 1.316246379167579, 'psi': 0.3845071887793102}
[S13] START round=3 head_norm_before_train=1.215591 (no previous merge yet)
[S13] round=3 local utility u=0.079008 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.67304329710728, 'loss_val': 1.2651964395089692, 'psi': 0.35344877638914385}-{'f1_val': 0.1403857625770531, 'auprc': 0.6297810819954139, 'loss_val': 1.2934248493750211, 'psi': 0.33614389034439746}
[S14] START round=3 head_norm_before_train=1.206173 (no previous merge yet)
[S14] round=3 local utility u=0.020420 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7319529925932785, 'loss_val': 1.2704354665039461, 'psi': 0.3769959087669337}-{'f1_val': 0.14035785288270378, 'auprc': 0.7299905668622358, 'loss_val': 1.3053891841240588, 'psi': 0.3762109384745166}
[S15] START round=3 head_norm_before_train=1.258235 (no previous merge yet)
[S15] round=3 local utility u=0.044244 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7673458622999075, 'loss_val': 1.2208158468649168, 'psi': 0.390778535736898}-{'f1_val': 0.13973365136155833, 'auprc': 0.7539717669704035, 'loss_val': 1.2691810405479411, 'psi': 0.3854288976050964}
[S16] START round=3 head_norm_before_train=0.865822 cos_to_last_merge=1.0000 (last merge round=2)
[S16] round=3 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.7256701913291258, 'loss_val': 1.3035465167855915, 'psi': 0.37465054665117226}-{'f1_val': 0.14063745019920318, 'auprc': 0.8353994272335792, 'loss_val': 1.3018900614911182, 'psi': 0.41854224101295356}
[S17] START round=3 head_norm_before_train=0.865664 cos_to_last_merge=0.9970 (last merge round=1)
[S17] round=3 local utility u=0.010465 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.777419806789566, 'loss_val': 1.3183916111659886, 'psi': 0.39553730070625703}-{'f1_val': 0.14094896331738438, 'auprc': 0.7792383903310367, 'loss_val': 1.344777400192678, 'psi': 0.39626473412284535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S6@127.0.0.1:62407
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[S7] sending update (kind=head size=1799 to 1 peers)
[S9] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1803) from S13
[S9] cosine check vs S13: cos=0.1097
[S6] RECEIVED delta(kind=head bytes=1799) from S7
[S6] cosine check vs S7: cos=-0.0442
[S6] DROPPED delta from S7 (cos=-0.0442 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1801) from S4
[S5] cosine check vs S4: cos=0.0318
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] cosine check vs S14: cos=0.0640
[S14] RECEIVED delta(kind=head bytes=1795) from S9
[S14] cosine check vs S9: cos=-0.0534
[S14] DROPPED delta from S9 (cos=-0.0534 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S11
[S9] cosine check vs S11: cos=-0.0325
[S9] DROPPED delta from S11 (cos=-0.0325 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1795) from S8
[S6] cosine check vs S8: cos=0.0152
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0422
[S14] DROPPED delta from S15 (cos=-0.0422 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=-0.0327
[S6] DROPPED delta from S2 (cos=-0.0327 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0280
[S9] DROPPED delta from S5 (cos=-0.0280 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S17
[S5] cosine check vs S17: cos=0.0101
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=3 metric=0.1414 head_norm=1.264216
[S6] _apply_head_vector_avg (torch): Δ‖w‖=8.723046e-01
[S6] stored merged vector for next round verification (round=3)
[S6] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.885672 delta_norm=0.872305
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=3 metric=0.1404 head_norm=0.896398
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.396156e-01
[S11] stored merged vector for next round verification (round=3)
[S11] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.786099 delta_norm=0.739616
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=3 metric=0.1889 head_norm=1.379649
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.751312e-01
[S9] stored merged vector for next round verification (round=3)
[S9] DEBUG after merge:  round=3 metric=0.1414 head_norm=0.976382 delta_norm=0.875131
[S9] aggregate: ROLLBACK (f1_val pre=0.189 post=0.141 tol_abs=0.005 tol_rel=0.0)
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=3 metric=0.4180 head_norm=1.332626
[S5] _apply_head_vector_avg (torch): Δ‖w‖=7.620981e-01
[S5] stored merged vector for next round verification (round=3)
[S5] DEBUG after merge:  round=3 metric=0.4180 head_norm=0.782819 delta_norm=0.762098
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.907708 cos_to_last_merge=0.9874 (last merge round=1)
[S2] round=4 local utility u=0.028923 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.6133851877678053, 'loss_val': 1.1819859623860218, 'psi': 0.33042035514026213}-{'f1_val': 0.1417771333885667, 'auprc': 0.6099717181273097, 'loss_val': 1.2295911694984227, 'psi': 0.3290549672840639}
[S3] START round=4 head_norm_before_train=1.320540 (no previous merge yet)
[S3] round=4 local utility u=0.752534 metrics={'f1_val': 0.3936147342284453, 'auprc': 0.7188624562497288, 'loss_val': 0.8489610962262606, 'psi': 0.5237138230369587}-{'f1_val': 0.13984006561410703, 'auprc': 0.7969640999959826, 'loss_val': 1.0656857777326045, 'psi': 0.4026896793668573}
[S4] START round=4 head_norm_before_train=1.226282 (no previous merge yet)
[S4] round=4 local utility u=0.035791 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7662525804625984, 'loss_val': 1.1330899957921343, 'psi': 0.39063700952214986}-{'f1_val': 0.14022662889518414, 'auprc': 0.7693993886356847, 'loss_val': 1.2141125628977045, 'psi': 0.3918957327913844}
[S5] START round=4 head_norm_before_train=0.782819 cos_to_last_merge=1.0000 (last merge round=3)
[S5] round=4 local utility u=0.041685 metrics={'f1_val': 0.4173865207428088, 'auprc': 0.7774075912513214, 'loss_val': 0.8997071744855455, 'psi': 0.5613949489462138}-{'f1_val': 0.41795135763108626, 'auprc': 0.7773674874159251, 'loss_val': 0.9863463324008589, 'psi': 0.5617178095450218}
[S6] START round=4 head_norm_before_train=0.885672 cos_to_last_merge=1.0000 (last merge round=3)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7544289316440348, 'loss_val': 1.261129760123068, 'psi': 0.38662734188838316}-{'f1_val': 0.14142628205128205, 'auprc': 0.7733460749787086, 'loss_val': 1.259995741209978, 'psi': 0.39419419922225263}
[S7] START round=4 head_norm_before_train=0.914541 cos_to_last_merge=0.9857 (last merge round=1)
[S7] round=4 local utility u=0.051092 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7761550498492885, 'loss_val': 1.1348291698522939, 'psi': 0.39569611357717044}-{'f1_val': 0.14205682272909165, 'auprc': 0.7727216717696557, 'loss_val': 1.2267131395988327, 'psi': 0.39432276234531727}
[S8] START round=4 head_norm_before_train=1.221646 (no previous merge yet)
[S8] round=4 local utility u=0.128553 metrics={'f1_val': 0.1629452314051978, 'auprc': 0.7682225388195856, 'loss_val': 1.1938166867976534, 'psi': 0.40505615437095294}-{'f1_val': 0.13995598239295717, 'auprc': 0.7450529316691465, 'loss_val': 1.2434786915833562, 'psi': 0.38199476210343297}
[S9] START round=4 head_norm_before_train=0.976382 cos_to_last_merge=1.0000 (last merge round=3)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7016893154854569, 'auprc': 0.9975200704043088, 'loss_val': 0.6923623241045819, 'psi': 0.8200216174529977}-{'f1_val': 0.18889371980676328, 'auprc': 0.6691565678092241, 'loss_val': 0.8813399099014754, 'psi': 0.3809988590077476}
[S10] START round=4 head_norm_before_train=0.868914 cos_to_last_merge=0.9969 (last merge round=2)
[S10] round=4 local utility u=0.034228 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6023056993645498, 'loss_val': 1.211351014740188, 'psi': 0.3240952622708543}-{'f1_val': 0.13862163754172394, 'auprc': 0.6020533113946186, 'loss_val': 1.2790493141626498, 'psi': 0.3239943070828818}
[S11] START round=4 head_norm_before_train=0.786099 cos_to_last_merge=1.0000 (last merge round=3)
[S11] round=4 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5806029705483795, 'loss_val': 1.2464693221560912, 'psi': 0.31648939824321815}-{'f1_val': 0.14041368337311058, 'auprc': 0.7437141413608004, 'loss_val': 1.2627649825196245, 'psi': 0.38173386656818653}
[S13] START round=4 head_norm_before_train=1.238919 (no previous merge yet)
[S13] round=4 local utility u=0.068869 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7083962094320514, 'loss_val': 1.233516483307297, 'psi': 0.3675899413190524}-{'f1_val': 0.1403857625770531, 'auprc': 0.67304329710728, 'loss_val': 1.2651964395089692, 'psi': 0.35344877638914385}
[S14] START round=4 head_norm_before_train=1.235491 (no previous merge yet)
[S14] round=4 local utility u=0.021467 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7320368999547096, 'loss_val': 1.2277539687594354, 'psi': 0.3770294717115061}-{'f1_val': 0.14035785288270378, 'auprc': 0.7319529925932785, 'loss_val': 1.2704354665039461, 'psi': 0.3769959087669337}
[S15] START round=4 head_norm_before_train=1.293724 (no previous merge yet)
[S15] round=4 local utility u=0.547285 metrics={'f1_val': 0.3113447736391547, 'auprc': 0.774671427236111, 'loss_val': 1.1778893197365778, 'psi': 0.4966754350779372}-{'f1_val': 0.13973365136155833, 'auprc': 0.7673458622999075, 'loss_val': 1.2208158468649168, 'psi': 0.390778535736898}
[S16] START round=4 head_norm_before_train=0.886554 cos_to_last_merge=0.9966 (last merge round=2)
[S16] round=4 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.47021473005101516, 'loss_val': 1.26304739124771, 'psi': 0.272468362139928}-{'f1_val': 0.14063745019920318, 'auprc': 0.7256701913291258, 'loss_val': 1.3035465167855915, 'psi': 0.37465054665117226}
[S17] START round=4 head_norm_before_train=0.887331 cos_to_last_merge=0.9890 (last merge round=1)
[S17] round=4 local utility u=0.072319 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.8114206792314949, 'loss_val': 1.2757556227245925, 'psi': 0.40913764968302857}-{'f1_val': 0.14094896331738438, 'auprc': 0.777419806789566, 'loss_val': 1.3183916111659886, 'psi': 0.39553730070625703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:62405
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S14] → sending delta(kind=head bytes=1789) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:62405
[S13] sending update (kind=head size=1794 to 1 peers)
[S4] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1794 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] sending update (kind=head size=1789 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1801 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S15
[S14] cosine check vs S15: cos=-0.0425
[S14] DROPPED delta from S15 (cos=-0.0425 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S5
[S9] cosine check vs S5: cos=-0.0760
[S9] DROPPED delta from S5 (cos=-0.0760 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1794) from S13
[S9] cosine check vs S13: cos=0.6667
[S14] RECEIVED delta(kind=head bytes=1792) from S9
[S14] cosine check vs S9: cos=-0.0492
[S14] DROPPED delta from S9 (cos=-0.0492 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1797) from S8
[S6] cosine check vs S8: cos=0.6827
[S2] RECEIVED delta(kind=head bytes=1794) from S3
[S2] cosine check vs S3: cos=-0.0981
[S2] DROPPED delta from S3 (cos=-0.0981 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1798) from S4
[S5] cosine check vs S4: cos=0.3989
[S6] RECEIVED delta(kind=head bytes=1801) from S7
[S6] cosine check vs S7: cos=-0.0851
[S6] DROPPED delta from S7 (cos=-0.0851 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1789) from S14
[S11] cosine check vs S14: cos=0.7983
[S6] RECEIVED delta(kind=head bytes=1792) from S2
[S6] cosine check vs S2: cos=0.4411
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.0696
[S17] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1792) from S17
[S5] cosine check vs S17: cos=0.2934
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=4 metric=0.1414 head_norm=0.908592
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.163879e-01
[S6] stored merged vector for next round verification (round=4)
[S6] DEBUG after merge:  round=4 metric=0.1414 head_norm=0.865222 delta_norm=0.416388
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=4 metric=0.4174 head_norm=0.850667
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.240463e-01
[S5] stored merged vector for next round verification (round=4)
[S5] DEBUG after merge:  round=4 metric=0.4174 head_norm=0.712773 delta_norm=0.424046
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=4 metric=0.7017 head_norm=1.061561
[S9] _apply_head_vector_avg (torch): Δ‖w‖=4.826894e-01
[S9] stored merged vector for next round verification (round=4)
[S9] DEBUG after merge:  round=4 metric=0.4364 head_norm=1.060780 delta_norm=0.482689
[S9] aggregate: ROLLBACK (f1_val pre=0.702 post=0.436 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=4 metric=0.1402 head_norm=1.258630
[S4] _apply_head_vector_avg (torch): Δ‖w‖=7.494926e-01
[S4] stored merged vector for next round verification (round=4)
[S4] DEBUG after merge:  round=4 metric=0.1402 head_norm=0.800731 delta_norm=0.749493
[S4] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=4 metric=0.1404 head_norm=0.816372
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.937418e-01
[S11] stored merged vector for next round verification (round=4)
[S11] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.990241 delta_norm=0.393742
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.941940 cos_to_last_merge=0.9763 (last merge round=1)
[S2] round=5 local utility u=0.113580 metrics={'f1_val': 0.1671142578125, 'auprc': 0.6134832076347801, 'loss_val': 1.1071431616828131, 'psi': 0.34566183774141207}-{'f1_val': 0.1417771333885667, 'auprc': 0.6133851877678053, 'loss_val': 1.1819859623860218, 'psi': 0.33042035514026213}
[S3] START round=5 head_norm_before_train=1.383726 (no previous merge yet)
[S3] round=5 local utility u=0.192893 metrics={'f1_val': 0.4051806344461505, 'auprc': 0.8179450842605739, 'loss_val': 0.8298178553179416, 'psi': 0.5702864143719198}-{'f1_val': 0.3936147342284453, 'auprc': 0.7188624562497288, 'loss_val': 0.8489610962262606, 'psi': 0.5237138230369587}
[S4] START round=5 head_norm_before_train=0.800731 cos_to_last_merge=1.0000 (last merge round=4)
[S4] round=5 local utility u=0.727809 metrics={'f1_val': 0.39599439770419564, 'auprc': 0.7394038660431987, 'loss_val': 1.1315332960730042, 'psi': 0.5333581850397969}-{'f1_val': 0.14022662889518414, 'auprc': 0.7662525804625984, 'loss_val': 1.1330899957921343, 'psi': 0.39063700952214986}
[S5] START round=5 head_norm_before_train=0.712773 cos_to_last_merge=1.0000 (last merge round=4)
[S5] round=5 local utility u=0.910159 metrics={'f1_val': 0.7146937595824697, 'auprc': 0.7703103603225046, 'loss_val': 0.8419417835294385, 'psi': 0.7369403998784837}-{'f1_val': 0.4173865207428088, 'auprc': 0.7774075912513214, 'loss_val': 0.8997071744855455, 'psi': 0.5613949489462138}
[S6] START round=5 head_norm_before_train=0.865222 cos_to_last_merge=1.0000 (last merge round=4)
[S6] round=5 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7365550789312072, 'loss_val': 1.2541047052507504, 'psi': 0.3794778008032521}-{'f1_val': 0.14142628205128205, 'auprc': 0.7544289316440348, 'loss_val': 1.261129760123068, 'psi': 0.38662734188838316}
[S7] START round=5 head_norm_before_train=0.947121 cos_to_last_merge=0.9733 (last merge round=1)
[S7] round=5 local utility u=0.945095 metrics={'f1_val': 0.41703542715461484, 'auprc': 0.7887316681514573, 'loss_val': 0.9322413315060327, 'psi': 0.5657139235533518}-{'f1_val': 0.14205682272909165, 'auprc': 0.7761550498492885, 'loss_val': 1.1348291698522939, 'psi': 0.39569611357717044}
[S8] START round=5 head_norm_before_train=1.246053 (no previous merge yet)
[S8] round=5 local utility u=1.000000 metrics={'f1_val': 0.7150331423137155, 'auprc': 0.7702362766131733, 'loss_val': 1.1086693644168337, 'psi': 0.7371143960334986}-{'f1_val': 0.1629452314051978, 'auprc': 0.7682225388195856, 'loss_val': 1.1938166867976534, 'psi': 0.40505615437095294}
[S9] START round=5 head_norm_before_train=1.060780 cos_to_last_merge=1.0000 (last merge round=4)
[S9] round=5 local utility u=0.078846 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.9988390973221594, 'loss_val': 0.5366803994984835, 'psi': 0.8203544395603692}-{'f1_val': 0.7016893154854569, 'auprc': 0.9975200704043088, 'loss_val': 0.6923623241045819, 'psi': 0.8200216174529977}
[S10] START round=5 head_norm_before_train=0.906459 cos_to_last_merge=0.9887 (last merge round=2)
[S10] round=5 local utility u=0.902330 metrics={'f1_val': 0.41615846728099787, 'auprc': 0.609590355871491, 'loss_val': 1.0937667964258189, 'psi': 0.49353122271719513}-{'f1_val': 0.13862163754172394, 'auprc': 0.6023056993645498, 'loss_val': 1.211351014740188, 'psi': 0.3240952622708543}
[S11] START round=5 head_norm_before_train=0.990241 cos_to_last_merge=1.0000 (last merge round=4)
[S11] round=5 local utility u=0.027264 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5869362513196872, 'loss_val': 1.2109417771964044, 'psi': 0.31902271055174125}-{'f1_val': 0.14041368337311058, 'auprc': 0.5806029705483795, 'loss_val': 1.2464693221560912, 'psi': 0.31648939824321815}
[S13] START round=5 head_norm_before_train=1.260783 (no previous merge yet)
[S13] round=5 local utility u=0.028477 metrics={'f1_val': 0.1403857625770531, 'auprc': 0.7106990046173951, 'loss_val': 1.1834715574869754, 'psi': 0.3685110593931899}-{'f1_val': 0.1403857625770531, 'auprc': 0.7083962094320514, 'loss_val': 1.233516483307297, 'psi': 0.3675899413190524}
[S14] START round=5 head_norm_before_train=1.266791 (no previous merge yet)
[S14] round=5 local utility u=0.036565 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7324627764439731, 'loss_val': 1.155902370162892, 'psi': 0.3771998223072115}-{'f1_val': 0.14035785288270378, 'auprc': 0.7320368999547096, 'loss_val': 1.2277539687594354, 'psi': 0.3770294717115061}
[S15] START round=5 head_norm_before_train=1.317229 (no previous merge yet)
[S15] round=5 local utility u=0.353169 metrics={'f1_val': 0.416839147538149, 'auprc': 0.7770528569362086, 'loss_val': 1.1116626261091438, 'psi': 0.5609246312973728}-{'f1_val': 0.3113447736391547, 'auprc': 0.774671427236111, 'loss_val': 1.1778893197365778, 'psi': 0.4966754350779372}
[S16] START round=5 head_norm_before_train=0.914107 cos_to_last_merge=0.9884 (last merge round=2)
[S16] round=5 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.4427878682163707, 'loss_val': 1.2195296661162305, 'psi': 0.2614976174060702}-{'f1_val': 0.14063745019920318, 'auprc': 0.47021473005101516, 'loss_val': 1.26304739124771, 'psi': 0.272468362139928}
[S17] START round=5 head_norm_before_train=0.919001 cos_to_last_merge=0.9762 (last merge round=1)
[S17] round=5 local utility u=0.000000 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5913530271195488, 'loss_val': 1.2029141741308953, 'psi': 0.32111058883825017}-{'f1_val': 0.14094896331738438, 'auprc': 0.8114206792314949, 'loss_val': 1.2757556227245925, 'psi': 0.40913764968302857}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S2] → sending delta(kind=head bytes=1792) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1785 reason=None
[S11] → sending delta(kind=head bytes=1785) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[S15] sending update (kind=head size=1795 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1802 to 1 peers)
[S4] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1785 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1797) from S14
[S11] cosine check vs S14: cos=0.9525
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0632
[S9] DROPPED delta from S5 (cos=-0.0632 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.0398
[S14] DROPPED delta from S9 (cos=-0.0398 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1796) from S3
[S2] cosine check vs S3: cos=-0.0888
[S2] DROPPED delta from S3 (cos=-0.0888 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1799) from S4
[S5] cosine check vs S4: cos=0.5422
[S4] RECEIVED delta(kind=head bytes=1800) from S10
[S4] cosine check vs S10: cos=0.5884
[S6] RECEIVED delta(kind=head bytes=1798) from S8
[S6] cosine check vs S8: cos=0.8889
[S6] RECEIVED delta(kind=head bytes=1792) from S2
[S6] cosine check vs S2: cos=0.7269
[S9] RECEIVED delta(kind=head bytes=1800) from S13
[S9] cosine check vs S13: cos=0.8814
[S14] RECEIVED delta(kind=head bytes=1795) from S15
[S14] cosine check vs S15: cos=-0.0403
[S14] DROPPED delta from S15 (cos=-0.0403 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1785) from S11
[S9] cosine check vs S11: cos=-0.0156
[S9] DROPPED delta from S11 (cos=-0.0156 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1802) from S7
[S6] cosine check vs S7: cos=-0.0822
[S6] DROPPED delta from S7 (cos=-0.0822 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=0.887625
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.338032e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.933791 delta_norm=0.233803
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.410 → S15@127.0.0.1:62415
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=5 metric=0.3960 head_norm=0.832986
[S4] _apply_head_vector_avg (torch): Δ‖w‖=4.064959e-01
[S4] stored merged vector for next round verification (round=5)
[S4] DEBUG after merge:  round=5 metric=0.1402 head_norm=0.792910 delta_norm=0.406496
[S4] aggregate: ROLLBACK (f1_val pre=0.396 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S4] ⇄ pheromone p=0.488 → S5@127.0.0.1:62405
[S10] ⇄ pheromone p=0.514 → S4@127.0.0.1:62404
[S8] ⇄ pheromone p=0.569 → S6@127.0.0.1:62407
[S2] ⇄ pheromone p=0.360 → S6@127.0.0.1:62407
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=5 metric=0.7014 head_norm=1.139566
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.037821e-01
[S9] stored merged vector for next round verification (round=5)
[S9] DEBUG after merge:  round=5 metric=0.7013 head_norm=1.176445 delta_norm=0.303782
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.546 → S14@127.0.0.1:62414
[S15] ⇄ pheromone p=0.525 → S14@127.0.0.1:62414
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=5 metric=0.7147 head_norm=0.789287
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.885629e-01
[S5] stored merged vector for next round verification (round=5)
[S5] DEBUG after merge:  round=5 metric=0.5808 head_norm=0.712348 delta_norm=0.388563
[S5] aggregate: ROLLBACK (f1_val pre=0.715 post=0.581 tol_abs=0.005 tol_rel=0.0)
[S5] ⇄ pheromone p=0.648 → S9@127.0.0.1:62410
[S3] ⇄ pheromone p=0.533 → S2@127.0.0.1:62402
[S13] ⇄ pheromone p=0.395 → S9@127.0.0.1:62410
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=5 metric=0.1404 head_norm=1.012221
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.292895e-01
[S11] stored merged vector for next round verification (round=5)
[S11] DEBUG after merge:  round=5 metric=0.1404 head_norm=1.144229 delta_norm=0.229290
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.417 → S9@127.0.0.1:62410
[S14] ⇄ pheromone p=0.365 → S11@127.0.0.1:62412
[S7] ⇄ pheromone p=0.545 → S6@127.0.0.1:62407
[S17] ⇄ pheromone p=0.352 → S5@127.0.0.1:62405
[S16] ⇄ pheromone p=0.376 → S4@127.0.0.1:62404
[S2] START round=6 head_norm_before_train=0.969896 cos_to_last_merge=0.9665 (last merge round=1)
[S2] round=6 local utility u=1.000000 metrics={'f1_val': 0.41621717441564343, 'auprc': 0.775845833687711, 'loss_val': 1.0240340013288116, 'psi': 0.5600686381244705}-{'f1_val': 0.1671142578125, 'auprc': 0.6134832076347801, 'loss_val': 1.1071431616828131, 'psi': 0.34566183774141207}
[S3] START round=6 head_norm_before_train=1.456674 (no previous merge yet)
[S3] round=6 local utility u=0.000000 metrics={'f1_val': 0.4059544683010684, 'auprc': 0.6802210506752182, 'loss_val': 0.939718379577673, 'psi': 0.5156611012507283}-{'f1_val': 0.4051806344461505, 'auprc': 0.8179450842605739, 'loss_val': 0.8298178553179416, 'psi': 0.5702864143719198}
[S4] START round=6 head_norm_before_train=0.792910 cos_to_last_merge=1.0000 (last merge round=5)
[S4] round=6 local utility u=0.125556 metrics={'f1_val': 0.41419477691946305, 'auprc': 0.7681196522394069, 'loss_val': 1.0757701826590398, 'psi': 0.5557647270474406}-{'f1_val': 0.39599439770419564, 'auprc': 0.7394038660431987, 'loss_val': 1.1315332960730042, 'psi': 0.5333581850397969}
[S5] START round=6 head_norm_before_train=0.712348 cos_to_last_merge=1.0000 (last merge round=5)
[S5] round=6 local utility u=0.000000 metrics={'f1_val': 0.7008168588441903, 'auprc': 0.6437557462218074, 'loss_val': 0.7942306638332389, 'psi': 0.6779924137952371}-{'f1_val': 0.7146937595824697, 'auprc': 0.7703103603225046, 'loss_val': 0.8419417835294385, 'psi': 0.7369403998784837}
[S6] START round=6 head_norm_before_train=0.933791 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7145898457368638, 'loss_val': 1.235629541541116, 'psi': 0.3706917075255147}-{'f1_val': 0.14142628205128205, 'auprc': 0.7365550789312072, 'loss_val': 1.2541047052507504, 'psi': 0.3794778008032521}
[S7] START round=6 head_norm_before_train=1.008388 cos_to_last_merge=0.9494 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.949
[S7] round=6 local utility u=0.735791 metrics={'f1_val': 0.6484968453500453, 'auprc': 0.7812381292299574, 'loss_val': 0.826946754872475, 'psi': 0.7015933589020101}-{'f1_val': 0.41703542715461484, 'auprc': 0.7887316681514573, 'loss_val': 0.9322413315060327, 'psi': 0.5657139235533518}
[S8] START round=6 head_norm_before_train=1.278504 (no previous merge yet)
[S8] round=6 local utility u=0.000000 metrics={'f1_val': 0.37307134877987713, 'auprc': 0.7710354467840812, 'loss_val': 0.9806382209322271, 'psi': 0.5322569879815588}-{'f1_val': 0.7150331423137155, 'auprc': 0.7702362766131733, 'loss_val': 1.1086693644168337, 'psi': 0.7371143960334986}
[S9] START round=6 head_norm_before_train=1.176445 cos_to_last_merge=1.0000 (last merge round=5)
[S9] round=6 local utility u=0.062579 metrics={'f1_val': 0.7013646677191758, 'auprc': 0.998578871356093, 'loss_val': 0.41074098304422924, 'psi': 0.8202503491739428}-{'f1_val': 0.7013646677191758, 'auprc': 0.9988390973221594, 'loss_val': 0.5366803994984835, 'psi': 0.8203544395603692}
[S10] START round=6 head_norm_before_train=0.945530 cos_to_last_merge=0.9783 (last merge round=2)
[S10] round=6 local utility u=0.225597 metrics={'f1_val': 0.43166551288747956, 'auprc': 0.6659726654221446, 'loss_val': 0.9047613290576847, 'psi': 0.5253883739013456}-{'f1_val': 0.41615846728099787, 'auprc': 0.609590355871491, 'loss_val': 1.0937667964258189, 'psi': 0.49353122271719513}
[S11] START round=6 head_norm_before_train=1.144229 cos_to_last_merge=1.0000 (last merge round=5)
[S11] round=6 local utility u=0.177412 metrics={'f1_val': 0.18409037788065502, 'auprc': 0.5878269839781446, 'loss_val': 1.1208509110242133, 'psi': 0.3455850203196509}-{'f1_val': 0.14041368337311058, 'auprc': 0.5869362513196872, 'loss_val': 1.2109417771964044, 'psi': 0.31902271055174125}
[S13] START round=6 head_norm_before_train=1.286080 (no previous merge yet)
[S13] round=6 local utility u=0.774281 metrics={'f1_val': 0.40867053241326157, 'auprc': 0.6656995100971548, 'loss_val': 1.1096187176264107, 'psi': 0.5114821234868189}-{'f1_val': 0.1403857625770531, 'auprc': 0.7106990046173951, 'loss_val': 1.1834715574869754, 'psi': 0.3685110593931899}
[S14] START round=6 head_norm_before_train=1.303486 (no previous merge yet)
[S14] round=6 local utility u=0.701615 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.6437324032699092, 'loss_val': 1.023697657201579, 'psi': 0.49542928269415865}-{'f1_val': 0.14035785288270378, 'auprc': 0.7324627764439731, 'loss_val': 1.155902370162892, 'psi': 0.3771998223072115}
[S15] START round=6 head_norm_before_train=1.344325 (no previous merge yet)
[S15] round=6 local utility u=0.076819 metrics={'f1_val': 0.4163758395072774, 'auprc': 0.7770564909118584, 'loss_val': 0.9552563539665742, 'psi': 0.5606481000691098}-{'f1_val': 0.416839147538149, 'auprc': 0.7770528569362086, 'loss_val': 1.1116626261091438, 'psi': 0.5609246312973728}
[S16] START round=6 head_norm_before_train=0.942767 cos_to_last_merge=0.9783 (last merge round=2)
[S16] round=6 local utility u=0.045052 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.44965132457112494, 'loss_val': 1.1500158524247706, 'psi': 0.2642429999479719}-{'f1_val': 0.14063745019920318, 'auprc': 0.4427878682163707, 'loss_val': 1.2195296661162305, 'psi': 0.2614976174060702}
[S17] START round=6 head_norm_before_train=0.957246 cos_to_last_merge=0.9601 (last merge round=1)
[S17] round=6 local utility u=0.544540 metrics={'f1_val': 0.3044005816410672, 'auprc': 0.5807627040920771, 'loss_val': 1.0627722015860497, 'psi': 0.41494543062147116}-{'f1_val': 0.14094896331738438, 'auprc': 0.5913530271195488, 'loss_val': 1.2029141741308953, 'psi': 0.32111058883825017}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] → sending delta(kind=head bytes=1797) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:62412
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S6@127.0.0.1:62407
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S11] → sending delta(kind=head bytes=1788) to S9@127.0.0.1:62410
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1788 to 1 peers)
[S16] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S9] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1788) from S11
[S9] cosine check vs S11: cos=-0.0159
[S9] DROPPED delta from S11 (cos=-0.0159 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S10
[S4] cosine check vs S10: cos=0.8683
[S9] RECEIVED delta(kind=head bytes=1799) from S13
[S9] cosine check vs S13: cos=0.9368
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=-0.0360
[S14] DROPPED delta from S15 (cos=-0.0360 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S4
[S5] cosine check vs S4: cos=0.6399
[S14] RECEIVED delta(kind=head bytes=1794) from S9
[S14] cosine check vs S9: cos=-0.0350
[S14] DROPPED delta from S9 (cos=-0.0350 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1797) from S16
[S4] cosine check vs S16: cos=0.5172
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] cosine check vs S14: cos=0.9812
[S6] RECEIVED delta(kind=head bytes=1794) from S7
[S6] cosine check vs S7: cos=-0.0852
[S6] DROPPED delta from S7 (cos=-0.0852 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S2
[S6] cosine check vs S2: cos=0.8171
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.3328
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=6 metric=0.7008 head_norm=0.778610
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.265846e-01
[S5] stored merged vector for next round verification (round=6)
[S5] DEBUG after merge:  round=6 metric=0.7008 head_norm=0.664096 delta_norm=0.326585
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.1414 head_norm=0.950890
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.960514e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1414 head_norm=0.930219 delta_norm=0.296051
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=6 metric=0.1841 head_norm=1.161393
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.535009e-01
[S11] stored merged vector for next round verification (round=6)
[S11] DEBUG after merge:  round=6 metric=0.1404 head_norm=1.249317 delta_norm=0.153501
[S11] aggregate: ROLLBACK (f1_val pre=0.184 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=6 metric=0.4142 head_norm=0.820390
[S4] _apply_head_vector_avg (torch): Δ‖w‖=2.642673e-01
[S4] stored merged vector for next round verification (round=6)
[S4] DEBUG after merge:  round=6 metric=0.1402 head_norm=0.792303 delta_norm=0.264267
[S4] aggregate: ROLLBACK (f1_val pre=0.414 post=0.140 tol_abs=0.005 tol_rel=0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=6 metric=0.7014 head_norm=1.257179
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.304103e-01
[S9] stored merged vector for next round verification (round=6)
[S9] DEBUG after merge:  round=6 metric=0.7014 head_norm=1.265630 delta_norm=0.230410
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=7 head_norm_before_train=1.000858 cos_to_last_merge=0.9558 (last merge round=1)
[S2] round=7 local utility u=0.007122 metrics={'f1_val': 0.41702121792426877, 'auprc': 0.7536648334714642, 'loss_val': 0.9480721670019915, 'psi': 0.5516786641431469}-{'f1_val': 0.41621717441564343, 'auprc': 0.775845833687711, 'loss_val': 1.0240340013288116, 'psi': 0.5600686381244705}
[S3] START round=7 head_norm_before_train=1.519453 (no previous merge yet)
[S3] round=7 local utility u=1.000000 metrics={'f1_val': 0.6868444032883061, 'auprc': 0.9933280169185574, 'loss_val': 0.41383544092513863, 'psi': 0.8094378487404066}-{'f1_val': 0.4059544683010684, 'auprc': 0.6802210506752182, 'loss_val': 0.939718379577673, 'psi': 0.5156611012507283}
[S4] START round=7 head_norm_before_train=0.792303 cos_to_last_merge=1.0000 (last merge round=6)
[S4] round=7 local utility u=0.000000 metrics={'f1_val': 0.3723629996854576, 'auprc': 0.761474217351727, 'loss_val': 0.9890356588025158, 'psi': 0.5280074867519654}-{'f1_val': 0.41419477691946305, 'auprc': 0.7681196522394069, 'loss_val': 1.0757701826590398, 'psi': 0.5557647270474406}
[S5] START round=7 head_norm_before_train=0.664096 cos_to_last_merge=1.0000 (last merge round=6)
[S5] round=7 local utility u=0.154364 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.7221872406379208, 'loss_val': 0.7193164258054122, 'psi': 0.709216857084934}-{'f1_val': 0.7008168588441903, 'auprc': 0.6437557462218074, 'loss_val': 0.7942306638332389, 'psi': 0.6779924137952371}
[S6] START round=7 head_norm_before_train=0.930219 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6541500558634952, 'loss_val': 1.1978772609531754, 'psi': 0.3465157915761673}-{'f1_val': 0.14142628205128205, 'auprc': 0.7145898457368638, 'loss_val': 1.235629541541116, 'psi': 0.3706917075255147}
[S7] START round=7 head_norm_before_train=1.076238 cos_to_last_merge=0.9189 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.919
[S7] round=7 local utility u=0.366068 metrics={'f1_val': 0.6927078194689794, 'auprc': 0.8861515164839249, 'loss_val': 0.6748162776225018, 'psi': 0.7700852982749576}-{'f1_val': 0.6484968453500453, 'auprc': 0.7812381292299574, 'loss_val': 0.826946754872475, 'psi': 0.7015933589020101}
[S8] START round=7 head_norm_before_train=1.312772 (no previous merge yet)
[S8] round=7 local utility u=0.441444 metrics={'f1_val': 0.3728657005221765, 'auprc': 0.9990876309943127, 'loss_val': 0.7806726025236864, 'psi': 0.623354472711031}-{'f1_val': 0.37307134877987713, 'auprc': 0.7710354467840812, 'loss_val': 0.9806382209322271, 'psi': 0.5322569879815588}
[S9] START round=7 head_norm_before_train=1.265630 cos_to_last_merge=1.0000 (last merge round=6)
[S9] round=7 local utility u=0.039312 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.9981868947135546, 'loss_val': 0.33049642398915, 'psi': 0.8200490480099599}-{'f1_val': 0.7013646677191758, 'auprc': 0.998578871356093, 'loss_val': 0.41074098304422924, 'psi': 0.8202503491739428}
[S10] START round=7 head_norm_before_train=0.983161 cos_to_last_merge=0.9668 (last merge round=2)
[S10] round=7 local utility u=1.000000 metrics={'f1_val': 0.6953923605228091, 'auprc': 0.9422272530611662, 'loss_val': 0.7135794207490923, 'psi': 0.7941263175381519}-{'f1_val': 0.43166551288747956, 'auprc': 0.6659726654221446, 'loss_val': 0.9047613290576847, 'psi': 0.5253883739013456}
[S11] START round=7 head_norm_before_train=1.249317 cos_to_last_merge=1.0000 (last merge round=6)
[S11] round=7 local utility u=0.663083 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.5676446104026441, 'loss_val': 1.008706793370476, 'psi': 0.4649689768065573}-{'f1_val': 0.18409037788065502, 'auprc': 0.5878269839781446, 'loss_val': 1.1208509110242133, 'psi': 0.3455850203196509}
[S13] START round=7 head_norm_before_train=1.315035 (no previous merge yet)
[S13] round=7 local utility u=0.997745 metrics={'f1_val': 0.6888776782733803, 'auprc': 0.7202489558165887, 'loss_val': 0.9590208846524548, 'psi': 0.7014261892906637}-{'f1_val': 0.40867053241326157, 'auprc': 0.6656995100971548, 'loss_val': 1.1096187176264107, 'psi': 0.5114821234868189}
[S14] START round=7 head_norm_before_train=1.349028 (no previous merge yet)
[S14] round=7 local utility u=0.449246 metrics={'f1_val': 0.3964292957175209, 'auprc': 0.8937495632238077, 'loss_val': 0.8744694399824334, 'psi': 0.5953574027200357}-{'f1_val': 0.39656053564365834, 'auprc': 0.6437324032699092, 'loss_val': 1.023697657201579, 'psi': 0.49542928269415865}
[S15] START round=7 head_norm_before_train=1.381415 (no previous merge yet)
[S15] round=7 local utility u=0.125872 metrics={'f1_val': 0.4166966901809296, 'auprc': 0.8019446468916123, 'loss_val': 0.7801025819221199, 'psi': 0.5707958728652027}-{'f1_val': 0.4163758395072774, 'auprc': 0.7770564909118584, 'loss_val': 0.9552563539665742, 'psi': 0.5606481000691098}
[S16] START round=7 head_norm_before_train=0.979091 cos_to_last_merge=0.9655 (last merge round=2)
[S16] round=7 local utility u=0.857410 metrics={'f1_val': 0.417656138684398, 'auprc': 0.4411993626935169, 'loss_val': 1.0719529693599743, 'psi': 0.42707342828804556}-{'f1_val': 0.14063745019920318, 'auprc': 0.44965132457112494, 'loss_val': 1.1500158524247706, 'psi': 0.2642429999479719}
[S17] START round=7 head_norm_before_train=1.003470 cos_to_last_merge=0.9404 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.940
[S17] round=7 local utility u=0.641457 metrics={'f1_val': 0.35567966732572953, 'auprc': 0.8915712498153658, 'loss_val': 1.0199581967943259, 'psi': 0.570036300321584}-{'f1_val': 0.3044005816410672, 'auprc': 0.5807627040920771, 'loss_val': 1.0627722015860497, 'psi': 0.41494543062147116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S13] → sending delta(kind=head bytes=1791) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] → sending delta(kind=head bytes=1802) to S4@127.0.0.1:62404
[S9] sending update (kind=head size=1796 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1791 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1796) from S8
[S6] cosine check vs S8: cos=0.8248
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] cosine check vs S2: cos=0.9402
[S14] RECEIVED delta(kind=head bytes=1796) from S9
[S14] cosine check vs S9: cos=-0.0369
[S14] DROPPED delta from S9 (cos=-0.0369 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9874
[S6] RECEIVED delta(kind=head bytes=1798) from S7
[S6] cosine check vs S7: cos=-0.0659
[S6] DROPPED delta from S7 (cos=-0.0659 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1791) from S13
[S9] cosine check vs S13: cos=0.9585
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8708
[S9] RECEIVED delta(kind=head bytes=1800) from S5
[S9] cosine check vs S5: cos=-0.0751
[S9] DROPPED delta from S5 (cos=-0.0751 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S3
[S2] cosine check vs S3: cos=-0.0725
[S2] DROPPED delta from S3 (cos=-0.0725 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1793) from S11
[S9] cosine check vs S11: cos=-0.0205
[S9] DROPPED delta from S11 (cos=-0.0205 < 0.0)
[S16] sending update (kind=head size=1802 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1802) from S16
[S4] cosine check vs S16: cos=0.7184
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:62405
[S15] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] RECEIVED delta(kind=head bytes=1799) from S17
[S5] cosine check vs S17: cos=0.5814
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=-0.0321
[S14] DROPPED delta from S15 (cos=-0.0321 < 0.0)
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=7 metric=0.3724 head_norm=0.820497
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.700254e-01
[S4] stored merged vector for next round verification (round=7)
[S4] DEBUG after merge:  round=7 metric=0.6834 head_norm=0.834910 delta_norm=0.170025
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=7 metric=0.7013 head_norm=1.346280
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.940506e-01
[S9] stored merged vector for next round verification (round=7)
[S9] DEBUG after merge:  round=7 metric=0.7013 head_norm=1.333620 delta_norm=0.194051
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=7 metric=0.3965 head_norm=1.270227
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.237414e-01
[S11] stored merged vector for next round verification (round=7)
[S11] DEBUG after merge:  round=7 metric=0.3965 head_norm=1.330232 delta_norm=0.123741
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=7 metric=0.7006 head_norm=0.741151
[S5] _apply_head_vector_avg (torch): Δ‖w‖=4.326386e-01
[S5] stored merged vector for next round verification (round=7)
[S5] DEBUG after merge:  round=7 metric=0.7006 head_norm=0.800191 delta_norm=0.432639
[S5] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.1414 head_norm=0.948104
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.574557e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1414 head_norm=1.008083 delta_norm=0.157456
[S6] aggregate: ACCEPT kept=['S8', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=8 head_norm_before_train=1.042261 cos_to_last_merge=0.9423 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.942
[S2] round=8 local utility u=0.976518 metrics={'f1_val': 0.7138517135585695, 'auprc': 0.7722806611866772, 'loss_val': 0.8318659078202172, 'psi': 0.7372232926098126}-{'f1_val': 0.41702121792426877, 'auprc': 0.7536648334714642, 'loss_val': 0.9480721670019915, 'psi': 0.5516786641431469}
[S3] START round=8 head_norm_before_train=1.564257 (no previous merge yet)
[S3] round=8 local utility u=0.000000 metrics={'f1_val': 0.6782150171750794, 'auprc': 0.9893648971537152, 'loss_val': 0.3922456828628103, 'psi': 0.8026749691665338}-{'f1_val': 0.6868444032883061, 'auprc': 0.9933280169185574, 'loss_val': 0.41383544092513863, 'psi': 0.8094378487404066}
[S4] START round=8 head_norm_before_train=0.834910 cos_to_last_merge=1.0000 (last merge round=7)
[S4] round=8 local utility u=0.046955 metrics={'f1_val': 0.37621006055715933, 'auprc': 0.7632961353337159, 'loss_val': 0.9236746772373836, 'psi': 0.5310444904677819}-{'f1_val': 0.3723629996854576, 'auprc': 0.761474217351727, 'loss_val': 0.9890356588025158, 'psi': 0.5280074867519654}
[S5] START round=8 head_norm_before_train=0.800191 cos_to_last_merge=1.0000 (last merge round=7)
[S5] round=8 local utility u=0.135456 metrics={'f1_val': 0.7005699347162762, 'auprc': 0.7820623559584751, 'loss_val': 0.6280292184433942, 'psi': 0.7331669032131557}-{'f1_val': 0.7005699347162762, 'auprc': 0.7221872406379208, 'loss_val': 0.7193164258054122, 'psi': 0.709216857084934}
[S6] START round=8 head_norm_before_train=1.008083 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.956946 metrics={'f1_val': 0.388797212138138, 'auprc': 0.7670031426013938, 'loss_val': 1.1067708044144489, 'psi': 0.5400795843234403}-{'f1_val': 0.14142628205128205, 'auprc': 0.6541500558634952, 'loss_val': 1.1978772609531754, 'psi': 0.3465157915761673}
[S7] START round=8 head_norm_before_train=1.134337 cos_to_last_merge=0.8909 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.891
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.6385515082361244, 'auprc': 0.8180975957239462, 'loss_val': 0.6559503604362589, 'psi': 0.7103699432312531}-{'f1_val': 0.6927078194689794, 'auprc': 0.8861515164839249, 'loss_val': 0.6748162776225018, 'psi': 0.7700852982749576}
[S8] START round=8 head_norm_before_train=1.347538 (no previous merge yet)
[S8] round=8 local utility u=0.000000 metrics={'f1_val': 0.3731380036306732, 'auprc': 0.8862311974748207, 'loss_val': 0.7394556002836147, 'psi': 0.5783752811683323}-{'f1_val': 0.3728657005221765, 'auprc': 0.9990876309943127, 'loss_val': 0.7806726025236864, 'psi': 0.623354472711031}
[S9] START round=8 head_norm_before_train=1.333620 cos_to_last_merge=1.0000 (last merge round=7)
[S9] round=8 local utility u=0.025039 metrics={'f1_val': 0.7012904835408967, 'auprc': 0.998175516298203, 'loss_val': 0.280384919077755, 'psi': 0.8200444966438193}-{'f1_val': 0.7012904835408967, 'auprc': 0.9981868947135546, 'loss_val': 0.33049642398915, 'psi': 0.8200490480099599}
[S10] START round=8 head_norm_before_train=1.027120 cos_to_last_merge=0.9520 (last merge round=2)
[S10] round=8 local utility u=0.153184 metrics={'f1_val': 0.694491226730184, 'auprc': 0.9963409753524087, 'loss_val': 0.5641460931070307, 'psi': 0.8152311261790739}-{'f1_val': 0.6953923605228091, 'auprc': 0.9422272530611662, 'loss_val': 0.7135794207490923, 'psi': 0.7941263175381519}
[S11] START round=8 head_norm_before_train=1.330232 cos_to_last_merge=1.0000 (last merge round=7)
[S11] round=8 local utility u=0.326541 metrics={'f1_val': 0.39655223592620625, 'auprc': 0.7406370887963922, 'loss_val': 0.8748047045666992, 'psi': 0.5341861770742806}-{'f1_val': 0.39651855440916606, 'auprc': 0.5676446104026441, 'loss_val': 1.008706793370476, 'psi': 0.4649689768065573}
[S13] START round=8 head_norm_before_train=1.349046 (no previous merge yet)
[S13] round=8 local utility u=0.000000 metrics={'f1_val': 0.6330868294092972, 'auprc': 0.6641493911975982, 'loss_val': 0.8608370819670244, 'psi': 0.6455118541246176}-{'f1_val': 0.6888776782733803, 'auprc': 0.7202489558165887, 'loss_val': 0.9590208846524548, 'psi': 0.7014261892906637}
[S14] START round=8 head_norm_before_train=1.398636 (no previous merge yet)
[S14] round=8 local utility u=0.186594 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9671622895599643, 'loss_val': 0.7221097175961442, 'psi': 0.6247814584711404}-{'f1_val': 0.3964292957175209, 'auprc': 0.8937495632238077, 'loss_val': 0.8744694399824334, 'psi': 0.5953574027200357}
[S15] START round=8 head_norm_before_train=1.421788 (no previous merge yet)
[S15] round=8 local utility u=0.324971 metrics={'f1_val': 0.4172633847281815, 'auprc': 0.9772821721712129, 'loss_val': 0.6595742093098669, 'psi': 0.6412708997053941}-{'f1_val': 0.4166966901809296, 'auprc': 0.8019446468916123, 'loss_val': 0.7801025819221199, 'psi': 0.5707958728652027}
[S16] START round=8 head_norm_before_train=1.022126 cos_to_last_merge=0.9516 (last merge round=2)
[S16] round=8 local utility u=0.045168 metrics={'f1_val': 0.41476271417117905, 'auprc': 0.4684110463151956, 'loss_val': 1.0458911749317126, 'psi': 0.43622204702878564}-{'f1_val': 0.417656138684398, 'auprc': 0.4411993626935169, 'loss_val': 1.0719529693599743, 'psi': 0.42707342828804556}
[S17] START round=8 head_norm_before_train=1.051504 cos_to_last_merge=0.9197 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=8 local utility u=0.000000 metrics={'f1_val': 0.35317697866335995, 'auprc': 0.8553014762461917, 'loss_val': 0.8972671463857117, 'psi': 0.5540267776964927}-{'f1_val': 0.35567966732572953, 'auprc': 0.8915712498153658, 'loss_val': 1.0199581967943259, 'psi': 0.570036300321584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] → sending delta(kind=head bytes=1793) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] → sending delta(kind=head bytes=1792) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S4@127.0.0.1:62404
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S6] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1792 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0270
[S14] DROPPED delta from S15 (cos=-0.0270 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] cosine check vs S14: cos=0.9894
[S9] RECEIVED delta(kind=head bytes=1792) from S11
[S9] cosine check vs S11: cos=-0.0254
[S9] DROPPED delta from S11 (cos=-0.0254 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1799) from S2
[S6] cosine check vs S2: cos=0.9036
[S15] RECEIVED delta(kind=head bytes=1793) from S6
[S15] cosine check vs S6: cos=-0.0284
[S15] DROPPED delta from S6 (cos=-0.0284 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1795) from S16
[S4] cosine check vs S16: cos=0.7927
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.3036
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8419
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0750
[S9] DROPPED delta from S5 (cos=-0.0750 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S9
[S14] cosine check vs S9: cos=-0.0421
[S14] DROPPED delta from S9 (cos=-0.0421 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.3888 head_norm=1.030566
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.339494e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.4151 head_norm=1.032626 delta_norm=0.233949
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=8 metric=0.3762 head_norm=0.866965
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.361177e-01
[S4] stored merged vector for next round verification (round=8)
[S4] DEBUG after merge:  round=8 metric=0.3791 head_norm=0.882639 delta_norm=0.136118
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=8 metric=0.7006 head_norm=0.867581
[S5] _apply_head_vector_avg (torch): Δ‖w‖=5.117828e-01
[S5] stored merged vector for next round verification (round=8)
[S5] DEBUG after merge:  round=8 metric=0.7006 head_norm=0.700172 delta_norm=0.511783
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=8 metric=0.3966 head_norm=1.356327
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.117282e-01
[S11] stored merged vector for next round verification (round=8)
[S11] DEBUG after merge:  round=8 metric=0.3966 head_norm=1.398025 delta_norm=0.111728
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.086293 cos_to_last_merge=0.9279 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.928
[S2] round=9 local utility u=0.000000 metrics={'f1_val': 0.5723081104506637, 'auprc': 0.7712392639562264, 'loss_val': 0.8071008542412225, 'psi': 0.6518805718528888}-{'f1_val': 0.7138517135585695, 'auprc': 0.7722806611866772, 'loss_val': 0.8318659078202172, 'psi': 0.7372232926098126}
[S3] START round=9 head_norm_before_train=1.610625 (no previous merge yet)
[S3] round=9 local utility u=0.000000 metrics={'f1_val': 0.5276080144754843, 'auprc': 0.8745589301034957, 'loss_val': 0.589268821817196, 'psi': 0.6663883807266888}-{'f1_val': 0.6782150171750794, 'auprc': 0.9893648971537152, 'loss_val': 0.3922456828628103, 'psi': 0.8026749691665338}
[S4] START round=9 head_norm_before_train=0.882639 cos_to_last_merge=1.0000 (last merge round=8)
[S4] round=9 local utility u=0.022659 metrics={'f1_val': 0.37734115261125645, 'auprc': 0.7582253580386732, 'loss_val': 0.8699303530349304, 'psi': 0.5296948347822232}-{'f1_val': 0.37621006055715933, 'auprc': 0.7632961353337159, 'loss_val': 0.9236746772373836, 'psi': 0.5310444904677819}
[S5] START round=9 head_norm_before_train=0.700172 cos_to_last_merge=1.0000 (last merge round=8)
[S5] round=9 local utility u=0.194300 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.920322281934065, 'loss_val': 0.6527167184521531, 'psi': 0.7883217032339742}-{'f1_val': 0.7005699347162762, 'auprc': 0.7820623559584751, 'loss_val': 0.6280292184433942, 'psi': 0.7331669032131557}
[S6] START round=9 head_norm_before_train=1.032626 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.154164 metrics={'f1_val': 0.4168551858772006, 'auprc': 0.7762404908390592, 'loss_val': 0.9945028221383783, 'psi': 0.5606093078619441}-{'f1_val': 0.388797212138138, 'auprc': 0.7670031426013938, 'loss_val': 1.1067708044144489, 'psi': 0.5400795843234403}
[S7] START round=9 head_norm_before_train=1.178656 cos_to_last_merge=0.8736 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.874
[S7] round=9 local utility u=0.000000 metrics={'f1_val': 0.4718824730981308, 'auprc': 0.7818230241760975, 'loss_val': 0.8454582577238838, 'psi': 0.5958586935293175}-{'f1_val': 0.6385515082361244, 'auprc': 0.8180975957239462, 'loss_val': 0.6559503604362589, 'psi': 0.7103699432312531}
[S8] START round=9 head_norm_before_train=1.383053 (no previous merge yet)
[S8] round=9 local utility u=0.204408 metrics={'f1_val': 0.3729322731464855, 'auprc': 0.9976130829196211, 'loss_val': 0.6635511232520156, 'psi': 0.6228045970557398}-{'f1_val': 0.3731380036306732, 'auprc': 0.8862311974748207, 'loss_val': 0.7394556002836147, 'psi': 0.5783752811683323}
[S9] START round=9 head_norm_before_train=1.403661 cos_to_last_merge=0.9958 (last merge round=7)
[S9] round=9 local utility u=0.779907 metrics={'f1_val': 0.9473732068862923, 'auprc': 0.9981599403064267, 'loss_val': 0.19702142633838426, 'psi': 0.967687900254346}-{'f1_val': 0.7012904835408967, 'auprc': 0.998175516298203, 'loss_val': 0.280384919077755, 'psi': 0.8200444966438193}
[S10] START round=9 head_norm_before_train=1.075814 cos_to_last_merge=0.9355 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=9 local utility u=0.065623 metrics={'f1_val': 0.7001272827785663, 'auprc': 0.9974917142934994, 'loss_val': 0.47016798430684015, 'psi': 0.8190730553845396}-{'f1_val': 0.694491226730184, 'auprc': 0.9963409753524087, 'loss_val': 0.5641460931070307, 'psi': 0.8152311261790739}
[S11] START round=9 head_norm_before_train=1.398025 cos_to_last_merge=1.0000 (last merge round=8)
[S11] round=9 local utility u=0.764623 metrics={'f1_val': 0.5612112131295612, 'auprc': 0.8900599917629965, 'loss_val': 0.7817808815671999, 'psi': 0.6927507245829354}-{'f1_val': 0.39655223592620625, 'auprc': 0.7406370887963922, 'loss_val': 0.8748047045666992, 'psi': 0.5341861770742806}
[S13] START round=9 head_norm_before_train=1.385885 (no previous merge yet)
[S13] round=9 local utility u=0.134278 metrics={'f1_val': 0.6508445929362503, 'auprc': 0.6796344840909343, 'loss_val': 0.7452820845761503, 'psi': 0.6623605493981239}-{'f1_val': 0.6330868294092972, 'auprc': 0.6641493911975982, 'loss_val': 0.8608370819670244, 'psi': 0.6455118541246176}
[S14] START round=9 head_norm_before_train=1.447168 (no previous merge yet)
[S14] round=9 local utility u=0.083772 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.996846476978961, 'loss_val': 0.6438169665764009, 'psi': 0.6366749121777794}-{'f1_val': 0.39652757107859105, 'auprc': 0.9671622895599643, 'loss_val': 0.7221097175961442, 'psi': 0.6247814584711404}
[S15] START round=9 head_norm_before_train=1.457362 (no previous merge yet)
[S15] round=9 local utility u=0.891198 metrics={'f1_val': 0.7015350953509861, 'auprc': 0.9873859427568662, 'loss_val': 0.6131206248830536, 'psi': 0.8158754343133381}-{'f1_val': 0.4172633847281815, 'auprc': 0.9772821721712129, 'loss_val': 0.6595742093098669, 'psi': 0.6412708997053941}
[S16] START round=9 head_norm_before_train=1.070661 cos_to_last_merge=0.9367 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.937
[S16] round=9 local utility u=0.083592 metrics={'f1_val': 0.32119492969065117, 'auprc': 0.6960020301643965, 'loss_val': 1.0000734084405618, 'psi': 0.4711177698801493}-{'f1_val': 0.41476271417117905, 'auprc': 0.4684110463151956, 'loss_val': 1.0458911749317126, 'psi': 0.43622204702878564}
[S17] START round=9 head_norm_before_train=1.102303 cos_to_last_merge=0.8961 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=9 local utility u=0.000000 metrics={'f1_val': 0.3518424223898232, 'auprc': 0.818951535201101, 'loss_val': 0.9164118306485688, 'psi': 0.5386860675143343}-{'f1_val': 0.35317697866335995, 'auprc': 0.8553014762461917, 'loss_val': 0.8972671463857117, 'psi': 0.5540267776964927}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S11@127.0.0.1:62412
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1795) from S11
[S9] cosine check vs S11: cos=-0.0331
[S9] DROPPED delta from S11 (cos=-0.0331 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1797) from S13
[S9] cosine check vs S13: cos=0.9504
[S4] RECEIVED delta(kind=head bytes=1801) from S10
[S4] cosine check vs S10: cos=0.8221
[S14] sending update (kind=head size=1793 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1793) from S14
[S11] cosine check vs S14: cos=0.9911
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:62414
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S9@127.0.0.1:62410
[S15] sending update (kind=head size=1799 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=-0.0210
[S14] DROPPED delta from S15 (cos=-0.0210 < 0.0)
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1794) from S5
[S9] cosine check vs S5: cos=-0.1220
[S9] DROPPED delta from S5 (cos=-0.1220 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S6
[S15] cosine check vs S6: cos=-0.0183
[S15] DROPPED delta from S6 (cos=-0.0183 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:62414
[S9] sending update (kind=head size=1806 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1806) from S9
[S14] cosine check vs S9: cos=-0.0476
[S14] DROPPED delta from S9 (cos=-0.0476 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:62407
[S8] sending update (kind=head size=1802 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1802) from S8
[S6] cosine check vs S8: cos=0.7721
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:62405
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[S16] sending update (kind=head size=1800 to 1 peers)
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.8196
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1793) from S4
[S5] cosine check vs S4: cos=0.7321
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.4169 head_norm=1.059457
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.523024e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.4169 head_norm=1.169532 delta_norm=0.452302
[S6] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S5] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=9 metric=0.7003 head_norm=0.762657
[S5] _apply_head_vector_avg (torch): Δ‖w‖=3.161315e-01
[S5] stored merged vector for next round verification (round=9)
[S5] DEBUG after merge:  round=9 metric=0.7003 head_norm=0.782875 delta_norm=0.316132
[S5] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=9 metric=0.9474 head_norm=1.471417
[S9] _apply_head_vector_avg (torch): Δ‖w‖=2.291497e-01
[S9] stored merged vector for next round verification (round=9)
[S9] DEBUG after merge:  round=9 metric=0.7012 head_norm=1.428478 delta_norm=0.229150
[S9] aggregate: ROLLBACK (f1_val pre=0.947 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=9 metric=0.5612 head_norm=1.427969
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.030842e-01
[S11] stored merged vector for next round verification (round=9)
[S11] DEBUG after merge:  round=9 metric=0.6437 head_norm=1.458427 delta_norm=0.103084
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=9 metric=0.3773 head_norm=0.918705
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.233328e-01
[S4] stored merged vector for next round verification (round=9)
[S4] DEBUG after merge:  round=9 metric=0.3784 head_norm=0.928608 delta_norm=0.123333
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.132340 cos_to_last_merge=0.9129 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.913
[S2] round=10 local utility u=0.000000 metrics={'f1_val': 0.5770508234377663, 'auprc': 0.7784140738059477, 'loss_val': 0.9472740135464043, 'psi': 0.6575961235850389}-{'f1_val': 0.5723081104506637, 'auprc': 0.7712392639562264, 'loss_val': 0.8071008542412225, 'psi': 0.6518805718528888}
[S3] START round=10 head_norm_before_train=1.654008 (no previous merge yet)
[S3] round=10 local utility u=0.851226 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9947823426508606, 'loss_val': 0.28637551530730554, 'psi': 0.818366659301524}-{'f1_val': 0.5276080144754843, 'auprc': 0.8745589301034957, 'loss_val': 0.589268821817196, 'psi': 0.6663883807266888}
[S4] START round=10 head_norm_before_train=0.928608 cos_to_last_merge=1.0000 (last merge round=9)
[S4] round=10 local utility u=0.002912 metrics={'f1_val': 0.37620696183214736, 'auprc': 0.7500494403921563, 'loss_val': 0.8327733712744804, 'psi': 0.525743953256151}-{'f1_val': 0.37734115261125645, 'auprc': 0.7582253580386732, 'loss_val': 0.8699303530349304, 'psi': 0.5296948347822232}
[S5] START round=10 head_norm_before_train=0.782875 cos_to_last_merge=1.0000 (last merge round=9)
[S5] round=10 local utility u=0.095922 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.983311701770872, 'loss_val': 0.6498401211767786, 'psi': 0.813517471168697}-{'f1_val': 0.7003213174339138, 'auprc': 0.920322281934065, 'loss_val': 0.6527167184521531, 'psi': 0.7883217032339742}
[S6] START round=10 head_norm_before_train=1.169532 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.954052 metrics={'f1_val': 0.7099883597132532, 'auprc': 0.7630210252978147, 'loss_val': 0.8055389898084252, 'psi': 0.7312014259470778}-{'f1_val': 0.4168551858772006, 'auprc': 0.7762404908390592, 'loss_val': 0.9945028221383783, 'psi': 0.5606093078619441}
[S7] START round=10 head_norm_before_train=1.222072 cos_to_last_merge=0.8589 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.859
[S7] round=10 local utility u=0.432931 metrics={'f1_val': 0.5804356846731167, 'auprc': 0.7933491565966339, 'loss_val': 0.6654936536187294, 'psi': 0.6656010734425235}-{'f1_val': 0.4718824730981308, 'auprc': 0.7818230241760975, 'loss_val': 0.8454582577238838, 'psi': 0.5958586935293175}
[S8] START round=10 head_norm_before_train=1.422083 (no previous merge yet)
[S8] round=10 local utility u=0.000000 metrics={'f1_val': 0.40603620947824903, 'auprc': 0.8665713114946386, 'loss_val': 0.5583357650629253, 'psi': 0.5902502502848048}-{'f1_val': 0.3729322731464855, 'auprc': 0.9976130829196211, 'loss_val': 0.6635511232520156, 'psi': 0.6228045970557398}
[S9] START round=10 head_norm_before_train=1.428478 cos_to_last_merge=1.0000 (last merge round=9)
[S9] round=10 local utility u=0.158505 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974197233751991, 'loss_val': 0.1735150150084313, 'psi': 0.9969641964384145}-{'f1_val': 0.9473732068862923, 'auprc': 0.9981599403064267, 'loss_val': 0.19702142633838426, 'psi': 0.967687900254346}
[S10] START round=10 head_norm_before_train=1.124616 cos_to_last_merge=0.9197 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=10 local utility u=0.041371 metrics={'f1_val': 0.6999475952406476, 'auprc': 0.9975586259767575, 'loss_val': 0.3865491881834411, 'psi': 0.8189920075350916}-{'f1_val': 0.7001272827785663, 'auprc': 0.9974917142934994, 'loss_val': 0.47016798430684015, 'psi': 0.8190730553845396}
[S11] START round=10 head_norm_before_train=1.458427 cos_to_last_merge=1.0000 (last merge round=9)
[S11] round=10 local utility u=0.357170 metrics={'f1_val': 0.6348128115945739, 'auprc': 0.9355837228315353, 'loss_val': 0.6456219923618499, 'psi': 0.7551211760893586}-{'f1_val': 0.5612112131295612, 'auprc': 0.8900599917629965, 'loss_val': 0.7817808815671999, 'psi': 0.6927507245829354}
[S13] START round=10 head_norm_before_train=1.421637 (no previous merge yet)
[S13] round=10 local utility u=0.113810 metrics={'f1_val': 0.6280482728641579, 'auprc': 0.7597091546463004, 'loss_val': 0.6211091578659445, 'psi': 0.6807126255770148}-{'f1_val': 0.6508445929362503, 'auprc': 0.6796344840909343, 'loss_val': 0.7452820845761503, 'psi': 0.6623605493981239}
[S14] START round=10 head_norm_before_train=1.495385 (no previous merge yet)
[S14] round=10 local utility u=0.923252 metrics={'f1_val': 0.6914078309057526, 'auprc': 0.9948749633400018, 'loss_val': 0.560481305847297, 'psi': 0.8127946838794523}-{'f1_val': 0.39656053564365834, 'auprc': 0.996846476978961, 'loss_val': 0.6438169665764009, 'psi': 0.6366749121777794}
[S15] START round=10 head_norm_before_train=1.487249 (no previous merge yet)
[S15] round=10 local utility u=0.016113 metrics={'f1_val': 0.701553214785838, 'auprc': 0.9857767757986324, 'loss_val': 0.5761756976637921, 'psi': 0.8152426391909557}-{'f1_val': 0.7015350953509861, 'auprc': 0.9873859427568662, 'loss_val': 0.6131206248830536, 'psi': 0.8158754343133381}
[S16] START round=10 head_norm_before_train=1.121991 cos_to_last_merge=0.9218 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.922
[S16] round=10 local utility u=0.060367 metrics={'f1_val': 0.39915326256615924, 'auprc': 0.5446305128047567, 'loss_val': 0.8929743981222978, 'psi': 0.4573441626615983}-{'f1_val': 0.32119492969065117, 'auprc': 0.6960020301643965, 'loss_val': 1.0000734084405618, 'psi': 0.4711177698801493}
[S17] START round=10 head_norm_before_train=1.147068 cos_to_last_merge=0.8753 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=10 local utility u=0.035386 metrics={'f1_val': 0.3523344285044445, 'auprc': 0.8398184601405498, 'loss_val': 0.91119283631243, 'psi': 0.5473280411588867}-{'f1_val': 0.3518424223898232, 'auprc': 0.818951535201101, 'loss_val': 0.9164118306485688, 'psi': 0.5386860675143343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S4] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] → sending delta(kind=head bytes=1805) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:62412
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] → sending delta(kind=head bytes=1796) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] → sending delta(kind=head bytes=1800) to S4@127.0.0.1:62404
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:62402
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S3] sending update (kind=head size=1802 to 1 peers)
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] sending update (kind=head size=1796 to 1 peers)
[S16] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S7] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1805 to 1 peers)
[S9] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1794 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1793) from S5
[S9] cosine check vs S5: cos=-0.1148
[S9] DROPPED delta from S5 (cos=-0.1148 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1802) from S11
[S9] cosine check vs S11: cos=-0.0400
[S9] DROPPED delta from S11 (cos=-0.0400 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1794) from S4
[S5] cosine check vs S4: cos=0.8795
[S6] RECEIVED delta(kind=head bytes=1804) from S7
[S6] cosine check vs S7: cos=-0.0905
[S6] DROPPED delta from S7 (cos=-0.0905 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8122
[S4] RECEIVED delta(kind=head bytes=1800) from S16
[S4] cosine check vs S16: cos=0.8302
[S14] RECEIVED delta(kind=head bytes=1798) from S9
[S14] cosine check vs S9: cos=-0.0510
[S14] DROPPED delta from S9 (cos=-0.0510 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=-0.0161
[S14] DROPPED delta from S15 (cos=-0.0161 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1802) from S3
[S2] cosine check vs S3: cos=-0.0579
[S2] DROPPED delta from S3 (cos=-0.0579 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1805) from S13
[S9] cosine check vs S13: cos=0.9728
[S11] RECEIVED delta(kind=head bytes=1796) from S14
[S11] cosine check vs S14: cos=0.9924
[S15] RECEIVED delta(kind=head bytes=1796) from S6
[S15] cosine check vs S6: cos=-0.0260
[S15] DROPPED delta from S6 (cos=-0.0260 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.3428
[S8] ⇄ pheromone p=0.264 → S6@127.0.0.1:62407
[S2] ⇄ pheromone p=0.326 → S6@127.0.0.1:62407
[S13] ⇄ pheromone p=0.339 → S9@127.0.0.1:62410
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=10 metric=0.7003 head_norm=0.839145
[S5] _apply_head_vector_avg (torch): Δ‖w‖=2.596010e-01
[S5] stored merged vector for next round verification (round=10)
[S5] DEBUG after merge:  round=10 metric=0.7003 head_norm=0.771318 delta_norm=0.259601
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S5] ⇄ pheromone p=0.296 → S9@127.0.0.1:62410
[S3] ⇄ pheromone p=0.447 → S2@127.0.0.1:62402
[S7] ⇄ pheromone p=0.363 → S6@127.0.0.1:62407
[S10] ⇄ pheromone p=0.328 → S4@127.0.0.1:62404
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=10 metric=0.3762 head_norm=0.969029
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.139940e-01
[S4] stored merged vector for next round verification (round=10)
[S4] DEBUG after merge:  round=10 metric=0.3762 head_norm=0.973353 delta_norm=0.113994
[S4] aggregate: ACCEPT kept=['S10', 'S16'] (k=2/2) mode=median trim_p=0.1
[S4] ⇄ pheromone p=0.180 → S5@127.0.0.1:62405
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=10 metric=0.9967 head_norm=1.481717
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.716358e-01
[S9] stored merged vector for next round verification (round=10)
[S9] DEBUG after merge:  round=10 metric=0.9967 head_norm=1.458930 delta_norm=0.171636
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S9] ⇄ pheromone p=0.348 → S14@127.0.0.1:62414
[S6] ⇄ pheromone p=0.472 → S15@127.0.0.1:62415
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=10 metric=0.6348 head_norm=1.491888
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.677319e-02
[S11] stored merged vector for next round verification (round=10)
[S11] DEBUG after merge:  round=10 metric=0.6933 head_norm=1.514784 delta_norm=0.096773
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.455 → S9@127.0.0.1:62410
[S14] ⇄ pheromone p=0.445 → S11@127.0.0.1:62412
[S16] ⇄ pheromone p=0.246 → S4@127.0.0.1:62404
[S15] ⇄ pheromone p=0.379 → S14@127.0.0.1:62414
[S17] ⇄ pheromone p=0.233 → S5@127.0.0.1:62405
[S2] START round=11 head_norm_before_train=1.174949 cos_to_last_merge=0.8988 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.899
[S2] round=11 local utility u=0.107896 metrics={'f1_val': 0.6140398848128186, 'auprc': 0.7798303383900165, 'loss_val': 0.9576657306767297, 'psi': 0.6803560662436978}-{'f1_val': 0.5770508234377663, 'auprc': 0.7784140738059477, 'loss_val': 0.9472740135464043, 'psi': 0.6575961235850389}
[S3] START round=11 head_norm_before_train=1.691158 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.6995835245689681, 'auprc': 0.9927802151194671, 'loss_val': 0.29737996956802043, 'psi': 0.8168622007891677}-{'f1_val': 0.7007562037352997, 'auprc': 0.9947823426508606, 'loss_val': 0.28637551530730554, 'psi': 0.818366659301524}
[S4] START round=11 head_norm_before_train=0.973353 cos_to_last_merge=1.0000 (last merge round=10)
[S4] round=11 local utility u=0.189390 metrics={'f1_val': 0.37560836290860805, 'auprc': 0.8646436903259682, 'loss_val': 0.7941843882054375, 'psi': 0.5712224938755521}-{'f1_val': 0.37620696183214736, 'auprc': 0.7500494403921563, 'loss_val': 0.8327733712744804, 'psi': 0.525743953256151}
[S5] START round=11 head_norm_before_train=0.771318 cos_to_last_merge=1.0000 (last merge round=10)
[S5] round=11 local utility u=0.038736 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9927261917978873, 'loss_val': 0.6006123719142848, 'psi': 0.8172832671795032}-{'f1_val': 0.7003213174339138, 'auprc': 0.983311701770872, 'loss_val': 0.6498401211767786, 'psi': 0.813517471168697}
[S6] START round=11 head_norm_before_train=1.198813 cos_to_last_merge=0.9986 (last merge round=9)
[S6] round=11 local utility u=0.000000 metrics={'f1_val': 0.6209367628278805, 'auprc': 0.7946819481080517, 'loss_val': 0.6707300821571268, 'psi': 0.690434836939949}-{'f1_val': 0.7099883597132532, 'auprc': 0.7630210252978147, 'loss_val': 0.8055389898084252, 'psi': 0.7312014259470778}
[S7] START round=11 head_norm_before_train=1.267073 cos_to_last_merge=0.8462 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.846
[S7] round=11 local utility u=0.175852 metrics={'f1_val': 0.6226727780776591, 'auprc': 0.7993473450264983, 'loss_val': 0.5852060645821036, 'psi': 0.6933426048571948}-{'f1_val': 0.5804356846731167, 'auprc': 0.7933491565966339, 'loss_val': 0.6654936536187294, 'psi': 0.6656010734425235}
[S8] START round=11 head_norm_before_train=1.461843 (no previous merge yet)
[S8] round=11 local utility u=1.000000 metrics={'f1_val': 0.7141738056351523, 'auprc': 0.9943454267570835, 'loss_val': 0.4314961728885212, 'psi': 0.8262424540839248}-{'f1_val': 0.40603620947824903, 'auprc': 0.8665713114946386, 'loss_val': 0.5583357650629253, 'psi': 0.5902502502848048}
[S9] START round=11 head_norm_before_train=1.458930 cos_to_last_merge=1.0000 (last merge round=10)
[S9] round=11 local utility u=0.002590 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9978934846005296, 'loss_val': 0.16228881883528432, 'psi': 0.9964068933621834}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974197233751991, 'loss_val': 0.1735150150084313, 'psi': 0.9969641964384145}
[S10] START round=11 head_norm_before_train=1.175889 cos_to_last_merge=0.9046 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=11 local utility u=0.014442 metrics={'f1_val': 0.6931974611235692, 'auprc': 0.9977234176505433, 'loss_val': 0.3176580893194879, 'psi': 0.8150078437343589}-{'f1_val': 0.6999475952406476, 'auprc': 0.9975586259767575, 'loss_val': 0.3865491881834411, 'psi': 0.8189920075350916}
[S11] START round=11 head_norm_before_train=1.514784 cos_to_last_merge=1.0000 (last merge round=10)
[S11] round=11 local utility u=0.252142 metrics={'f1_val': 0.7018246587012323, 'auprc': 0.9399758026748153, 'loss_val': 0.556585649280648, 'psi': 0.7970851162906656}-{'f1_val': 0.6348128115945739, 'auprc': 0.9355837228315353, 'loss_val': 0.6456219923618499, 'psi': 0.7551211760893586}
[S13] START round=11 head_norm_before_train=1.456155 (no previous merge yet)
[S13] round=11 local utility u=0.127618 metrics={'f1_val': 0.640308683598555, 'auprc': 0.7905176372332942, 'loss_val': 0.5318606427951078, 'psi': 0.7003922650524507}-{'f1_val': 0.6280482728641579, 'auprc': 0.7597091546463004, 'loss_val': 0.6211091578659445, 'psi': 0.6807126255770148}
[S14] START round=11 head_norm_before_train=1.543418 (no previous merge yet)
[S14] round=11 local utility u=0.043740 metrics={'f1_val': 0.6922370269115006, 'auprc': 0.9971581872559461, 'loss_val': 0.48482637785437765, 'psi': 0.8142054910492788}-{'f1_val': 0.6914078309057526, 'auprc': 0.9948749633400018, 'loss_val': 0.560481305847297, 'psi': 0.8127946838794523}
[S15] START round=11 head_norm_before_train=1.522847 (no previous merge yet)
[S15] round=11 local utility u=0.048393 metrics={'f1_val': 0.7013127984932164, 'auprc': 0.9837899862245841, 'loss_val': 0.471987533158107, 'psi': 0.8143036735857634}-{'f1_val': 0.701553214785838, 'auprc': 0.9857767757986324, 'loss_val': 0.5761756976637921, 'psi': 0.8152426391909557}
[S16] START round=11 head_norm_before_train=1.172521 cos_to_last_merge=0.9084 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.908
[S16] round=11 local utility u=0.804439 metrics={'f1_val': 0.5443746645592438, 'auprc': 0.7656134010285061, 'loss_val': 0.8183725957635253, 'psi': 0.6328701591469487}-{'f1_val': 0.39915326256615924, 'auprc': 0.5446305128047567, 'loss_val': 0.8929743981222978, 'psi': 0.4573441626615983}
[S17] START round=11 head_norm_before_train=1.181539 cos_to_last_merge=0.8580 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.858
[S17] round=11 local utility u=0.010392 metrics={'f1_val': 0.35923632389487936, 'auprc': 0.8336983851117, 'loss_val': 0.9134608158176979, 'psi': 0.5490211483816076}-{'f1_val': 0.3523344285044445, 'auprc': 0.8398184601405498, 'loss_val': 0.91119283631243, 'psi': 0.5473280411588867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:62405
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] → sending delta(kind=head bytes=1803) to S6@127.0.0.1:62407
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] → sending delta(kind=head bytes=1798) to S4@127.0.0.1:62404
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:62414
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:62410
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:62405
[S2] sending update (kind=head size=1798 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S5] sending update (kind=head size=1795 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1803 to 1 peers)
[S4] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1800) from S11
[S9] cosine check vs S11: cos=-0.0438
[S9] DROPPED delta from S11 (cos=-0.0438 < 0.0)
[S9] RECEIVED delta(kind=head bytes=1796) from S13
[S9] cosine check vs S13: cos=0.9829
[S9] RECEIVED delta(kind=head bytes=1795) from S5
[S9] cosine check vs S5: cos=-0.0998
[S9] DROPPED delta from S5 (cos=-0.0998 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1804) from S14
[S11] cosine check vs S14: cos=0.9936
[S5] RECEIVED delta(kind=head bytes=1796) from S4
[S5] cosine check vs S4: cos=0.7563
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.7956
[S6] RECEIVED delta(kind=head bytes=1800) from S8
[S6] cosine check vs S8: cos=0.9415
[S6] RECEIVED delta(kind=head bytes=1803) from S7
[S6] cosine check vs S7: cos=-0.0931
[S6] DROPPED delta from S7 (cos=-0.0931 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1798) from S16
[S4] cosine check vs S16: cos=0.8345
[S4] RECEIVED delta(kind=head bytes=1799) from S10
[S4] cosine check vs S10: cos=0.8077
[S14] RECEIVED delta(kind=head bytes=1800) from S9
[S14] cosine check vs S9: cos=-0.0546
[S14] DROPPED delta from S9 (cos=-0.0546 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=-0.0117
[S14] DROPPED delta from S15 (cos=-0.0117 < 0.0)
[S17] sending update (kind=head size=1800 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S17
[S5] cosine check vs S17: cos=0.5797
[S6] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=11 metric=0.6209 head_norm=1.229158
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.191941e-01
[S6] stored merged vector for next round verification (round=11)
[S6] DEBUG after merge:  round=11 metric=0.7096 head_norm=1.214924 delta_norm=0.119194
[S6] aggregate: ACCEPT kept=['S2', 'S8'] (k=2/2) mode=median trim_p=0.1
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=11 metric=0.9954 head_norm=1.503933
[S9] _apply_head_vector_avg (torch): Δ‖w‖=1.387456e-01
[S9] stored merged vector for next round verification (round=11)
[S9] DEBUG after merge:  round=11 metric=0.9942 head_norm=1.489411 delta_norm=0.138746
[S9] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7018 head_norm=1.549847
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.079242e-02
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7018 head_norm=1.566259 delta_norm=0.090792
[S11] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=11 metric=0.3756 head_norm=1.017828
[S4] _apply_head_vector_avg (torch): Δ‖w‖=1.061316e-01
[S4] stored merged vector for next round verification (round=11)
[S4] DEBUG after merge:  round=11 metric=0.3759 head_norm=1.016499 delta_norm=0.106132
[S4] aggregate: ACCEPT kept=['S16', 'S10'] (k=2/2) mode=median trim_p=0.1
[S5] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S5] DEBUG before merge: round=11 metric=0.7003 head_norm=0.831164
[S5] _apply_head_vector_avg (torch): Δ‖w‖=1.754424e-01
[S5] stored merged vector for next round verification (round=11)
[S5] DEBUG after merge:  round=11 metric=0.7003 head_norm=0.801297 delta_norm=0.175442
[S5] aggregate: ACCEPT kept=['S4', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=12 head_norm_before_train=1.217163 cos_to_last_merge=0.8855 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.885
[S2] round=12 local utility u=0.363692 metrics={'f1_val': 0.7139050869287071, 'auprc': 0.7805741477165284, 'loss_val': 0.8317034014188248, 'psi': 0.7405727112438356}-{'f1_val': 0.6140398848128186, 'auprc': 0.7798303383900165, 'loss_val': 0.9576657306767297, 'psi': 0.6803560662436978}
[S3] START round=12 head_norm_before_train=1.721148 (no previous merge yet)
[S3] round=12 local utility u=0.029205 metrics={'f1_val': 0.7008317350254774, 'auprc': 0.996217194400683, 'loss_val': 0.2567706804915173, 'psi': 0.8189859187755597}-{'f1_val': 0.6995835245689681, 'auprc': 0.9927802151194671, 'loss_val': 0.29737996956802043, 'psi': 0.8168622007891677}
[S4] START round=12 head_norm_before_train=1.016499 cos_to_last_merge=1.0000 (last merge round=11)
[S4] round=12 local utility u=0.038722 metrics={'f1_val': 0.38553234716447576, 'auprc': 0.8568845860806588, 'loss_val': 0.7530072289907496, 'psi': 0.574073242730949}-{'f1_val': 0.37560836290860805, 'auprc': 0.8646436903259682, 'loss_val': 0.7941843882054375, 'psi': 0.5712224938755521}
[S5] START round=12 head_norm_before_train=0.801297 cos_to_last_merge=1.0000 (last merge round=11)
[S5] round=12 local utility u=0.013451 metrics={'f1_val': 0.7003221706489986, 'auprc': 0.9978995255896896, 'loss_val': 0.5892348778786616, 'psi': 0.8193531126252751}-{'f1_val': 0.7003213174339138, 'auprc': 0.9927261917978873, 'loss_val': 0.6006123719142848, 'psi': 0.8172832671795032}
[S6] START round=12 head_norm_before_train=1.214924 cos_to_last_merge=1.0000 (last merge round=11)
[S6] round=12 local utility u=0.304021 metrics={'f1_val': 0.708276017717507, 'auprc': 0.79392526683623, 'loss_val': 0.5844539738567706, 'psi': 0.7425357173649962}-{'f1_val': 0.6209367628278805, 'auprc': 0.7946819481080517, 'loss_val': 0.6707300821571268, 'psi': 0.690434836939949}
[S7] START round=12 head_norm_before_train=1.307703 cos_to_last_merge=0.8366 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.837
[S7] round=12 local utility u=0.000000 metrics={'f1_val': 0.5952340888407671, 'auprc': 0.7970731186122195, 'loss_val': 0.6199258510884902, 'psi': 0.6759697007493481}-{'f1_val': 0.6226727780776591, 'auprc': 0.7993473450264983, 'loss_val': 0.5852060645821036, 'psi': 0.6933426048571948}
[S8] START round=12 head_norm_before_train=1.497765 (no previous merge yet)
[S8] round=12 local utility u=0.066724 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.9975216298833558, 'loss_val': 0.3068044151352384, 'psi': 0.8274356159569425}-{'f1_val': 0.7141738056351523, 'auprc': 0.9943454267570835, 'loss_val': 0.4314961728885212, 'psi': 0.8262424540839248}
[S9] START round=12 head_norm_before_train=1.489411 cos_to_last_merge=1.0000 (last merge round=11)
[S9] round=12 local utility u=0.009642 metrics={'f1_val': 0.994583549332968, 'auprc': 0.997879956895482, 'loss_val': 0.13797045126569302, 'psi': 0.9959021123579737}-{'f1_val': 0.9954158325366191, 'auprc': 0.9978934846005296, 'loss_val': 0.16228881883528432, 'psi': 0.9964068933621834}
[S10] START round=12 head_norm_before_train=1.226339 cos_to_last_merge=0.8914 (last merge round=2)
[S10] ⚠️ Model drifted since last merge! cos=0.891
[S10] round=12 local utility u=0.000000 metrics={'f1_val': 0.5703839404534966, 'auprc': 0.8990963480121474, 'loss_val': 0.403536310771609, 'psi': 0.701868903476957}-{'f1_val': 0.6931974611235692, 'auprc': 0.9977234176505433, 'loss_val': 0.3176580893194879, 'psi': 0.8150078437343589}
[S11] START round=12 head_norm_before_train=1.566259 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.107793 metrics={'f1_val': 0.7017589383281313, 'auprc': 0.9882135491290904, 'loss_val': 0.48531819351985506, 'psi': 0.816340782648515}-{'f1_val': 0.7018246587012323, 'auprc': 0.9399758026748153, 'loss_val': 0.556585649280648, 'psi': 0.7970851162906656}
[S13] START round=12 head_norm_before_train=1.487743 (no previous merge yet)
[S13] round=12 local utility u=0.299704 metrics={'f1_val': 0.6856661403969676, 'auprc': 0.8877829530354105, 'loss_val': 0.4963924664392151, 'psi': 0.7665128654523448}-{'f1_val': 0.640308683598555, 'auprc': 0.7905176372332942, 'loss_val': 0.5318606427951078, 'psi': 0.7003922650524507}
[S14] START round=12 head_norm_before_train=1.587702 (no previous merge yet)
[S14] round=12 local utility u=0.962377 metrics={'f1_val': 0.997010762750862, 'auprc': 0.9964872928513663, 'loss_val': 0.38670219910880427, 'psi': 0.9968013747910637}-{'f1_val': 0.6922370269115006, 'auprc': 0.9971581872559461, 'loss_val': 0.48482637785437765, 'psi': 0.8142054910492788}
[S15] START round=12 head_norm_before_train=1.565068 (no previous merge yet)
[S15] round=12 local utility u=0.051578 metrics={'f1_val': 0.7013127984932164, 'auprc': 0.9873164277679718, 'loss_val': 0.37941045140110463, 'psi': 0.8157142502031185}-{'f1_val': 0.7013127984932164, 'auprc': 0.9837899862245841, 'loss_val': 0.471987533158107, 'psi': 0.8143036735857634}
[S16] START round=12 head_norm_before_train=1.219516 cos_to_last_merge=0.8965 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.897
[S16] round=12 local utility u=0.000000 metrics={'f1_val': 0.43437859877355445, 'auprc': 0.7495387103961728, 'loss_val': 0.8772080320961932, 'psi': 0.5604426434226017}-{'f1_val': 0.5443746645592438, 'auprc': 0.7656134010285061, 'loss_val': 0.8183725957635253, 'psi': 0.6328701591469487}
[S17] START round=12 head_norm_before_train=1.209453 cos_to_last_merge=0.8437 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=12 local utility u=0.000000 metrics={'f1_val': 0.34833581416287973, 'auprc': 0.8035030679490286, 'loss_val': 0.9509145498548982, 'psi': 0.5304027156773393}-{'f1_val': 0.35923632389487936, 'auprc': 0.8336983851117, 'loss_val': 0.9134608158176979, 'psi': 0.5490211483816076}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:62403
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] → sending delta(kind=head bytes=1803) to S15@127.0.0.1:62415
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:62417
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:62408
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S4] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=-0.0529
[S3] DROPPED delta from S2 (cos=-0.0529 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1800) from S9
[S11] cosine check vs S9: cos=-0.0512
[S11] DROPPED delta from S9 (cos=-0.0512 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S4
[S10] cosine check vs S4: cos=0.8066
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.6779
[S6] RECEIVED delta(kind=head bytes=1801) from S15
[S6] cosine check vs S15: cos=-0.0248
[S6] DROPPED delta from S15 (cos=-0.0248 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1803) from S14
[S15] cosine check vs S14: cos=-0.0094
[S15] DROPPED delta from S14 (cos=-0.0094 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1797) from S6
[S7] cosine check vs S6: cos=-0.0861
[S7] DROPPED delta from S6 (cos=-0.0861 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S11
[S14] cosine check vs S11: cos=0.9947
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=12 metric=0.5704 head_norm=1.269142
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.756611e-01
[S10] stored merged vector for next round verification (round=12)
[S10] DEBUG after merge:  round=12 metric=0.5695 head_norm=1.109761 delta_norm=0.375661
[S10] aggregate: ACCEPT kept=['S4'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=12 metric=0.9970 head_norm=1.623378
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.359584e-02
[S14] stored merged vector for next round verification (round=12)
[S14] DEBUG after merge:  round=12 metric=0.9972 head_norm=1.609922 delta_norm=0.083596
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=12 metric=0.3483 head_norm=1.234078
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.536929e-01
[S17] stored merged vector for next round verification (round=12)
[S17] DEBUG after merge:  round=12 metric=0.3484 head_norm=0.958930 delta_norm=0.453693
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.261037 cos_to_last_merge=0.8730 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.873
[S2] round=13 local utility u=0.052418 metrics={'f1_val': 0.7136350793330258, 'auprc': 0.7778370542233063, 'loss_val': 0.7170368189768392, 'psi': 0.7393158692891381}-{'f1_val': 0.7139050869287071, 'auprc': 0.7805741477165284, 'loss_val': 0.8317034014188248, 'psi': 0.7405727112438356}
[S3] START round=13 head_norm_before_train=1.743207 (no previous merge yet)
[S3] round=13 local utility u=0.000000 metrics={'f1_val': 0.6020795983214718, 'auprc': 0.9921545099711204, 'loss_val': 0.3615243655438806, 'psi': 0.7581095629813313}-{'f1_val': 0.7008317350254774, 'auprc': 0.996217194400683, 'loss_val': 0.2567706804915173, 'psi': 0.8189859187755597}
[S4] START round=13 head_norm_before_train=1.065204 cos_to_last_merge=0.9964 (last merge round=11)
[S4] round=13 local utility u=0.000000 metrics={'f1_val': 0.37491746027121636, 'auprc': 0.8531973579856584, 'loss_val': 0.7109305484667006, 'psi': 0.5662294193569932}-{'f1_val': 0.38553234716447576, 'auprc': 0.8568845860806588, 'loss_val': 0.7530072289907496, 'psi': 0.574073242730949}
[S5] START round=13 head_norm_before_train=0.853125 cos_to_last_merge=0.9918 (last merge round=11)
[S5] round=13 local utility u=0.051891 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9967250743353364, 'loss_val': 0.4819247320768227, 'psi': 0.8188828201944829}-{'f1_val': 0.7003221706489986, 'auprc': 0.9978995255896896, 'loss_val': 0.5892348778786616, 'psi': 0.8193531126252751}
[S6] START round=13 head_norm_before_train=1.248364 cos_to_last_merge=0.9989 (last merge round=11)
[S6] round=13 local utility u=0.045281 metrics={'f1_val': 0.7082494834376265, 'auprc': 0.791971278537181, 'loss_val': 0.4878703350737203, 'psi': 0.7417382014774483}-{'f1_val': 0.708276017717507, 'auprc': 0.79392526683623, 'loss_val': 0.5844539738567706, 'psi': 0.7425357173649962}
[S7] START round=13 head_norm_before_train=1.335790 cos_to_last_merge=0.8315 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.831
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5575988475400168, 'auprc': 0.7906222813496534, 'loss_val': 0.7664840780628637, 'psi': 0.6508082210638715}-{'f1_val': 0.5952340888407671, 'auprc': 0.7970731186122195, 'loss_val': 0.6199258510884902, 'psi': 0.6759697007493481}
[S8] START round=13 head_norm_before_train=1.529660 (no previous merge yet)
[S8] round=13 local utility u=0.183968 metrics={'f1_val': 0.7621919360036086, 'auprc': 0.997525566576249, 'loss_val': 0.22776160617856206, 'psi': 0.8563253882326647}-{'f1_val': 0.7140449400060004, 'auprc': 0.9975216298833558, 'loss_val': 0.3068044151352384, 'psi': 0.8274356159569425}
[S9] START round=13 head_norm_before_train=1.544071 cos_to_last_merge=0.9978 (last merge round=11)
[S9] round=13 local utility u=0.030321 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959992082996239, 'loss_val': 0.08414861155133521, 'psi': 0.9963959904081844}-{'f1_val': 0.994583549332968, 'auprc': 0.997879956895482, 'loss_val': 0.13797045126569302, 'psi': 0.9959021123579737}
[S10] START round=13 head_norm_before_train=1.109761 cos_to_last_merge=1.0000 (last merge round=12)
[S10] round=13 local utility u=0.554475 metrics={'f1_val': 0.6909014810029908, 'auprc': 0.9975055848847942, 'loss_val': 0.312918761887961, 'psi': 0.8135431225557122}-{'f1_val': 0.5703839404534966, 'auprc': 0.8990963480121474, 'loss_val': 0.403536310771609, 'psi': 0.701868903476957}
[S11] START round=13 head_norm_before_train=1.600724 cos_to_last_merge=0.9993 (last merge round=11)
[S11] round=13 local utility u=0.000000 metrics={'f1_val': 0.6482376181988834, 'auprc': 0.9948900917221962, 'loss_val': 0.49278572219297273, 'psi': 0.7868986076082085}-{'f1_val': 0.7017589383281313, 'auprc': 0.9882135491290904, 'loss_val': 0.48531819351985506, 'psi': 0.816340782648515}
[S13] START round=13 head_norm_before_train=1.508009 (no previous merge yet)
[S13] round=13 local utility u=0.000000 metrics={'f1_val': 0.6136340912251035, 'auprc': 0.862176362747683, 'loss_val': 0.5894587003464243, 'psi': 0.7130509998341352}-{'f1_val': 0.6856661403969676, 'auprc': 0.8877829530354105, 'loss_val': 0.4963924664392151, 'psi': 0.7665128654523448}
[S14] START round=13 head_norm_before_train=1.609922 cos_to_last_merge=1.0000 (last merge round=12)
[S14] round=13 local utility u=0.071786 metrics={'f1_val': 0.996399766873988, 'auprc': 0.9971577508379352, 'loss_val': 0.24147650636337992, 'psi': 0.996702960459567}-{'f1_val': 0.997010762750862, 'auprc': 0.9964872928513663, 'loss_val': 0.38670219910880427, 'psi': 0.9968013747910637}
[S15] START round=13 head_norm_before_train=1.606520 (no previous merge yet)
[S15] round=13 local utility u=0.000000 metrics={'f1_val': 0.6972292378503685, 'auprc': 0.9854690061826951, 'loss_val': 0.3507206769124141, 'psi': 0.8125251451832991}-{'f1_val': 0.7013127984932164, 'auprc': 0.9873164277679718, 'loss_val': 0.37941045140110463, 'psi': 0.8157142502031185}
[S16] START round=13 head_norm_before_train=1.268176 cos_to_last_merge=0.8847 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.885
[S16] round=13 local utility u=0.596132 metrics={'f1_val': 0.568380578629708, 'auprc': 0.8194933958125218, 'loss_val': 0.6988205364695421, 'psi': 0.6688257055028335}-{'f1_val': 0.43437859877355445, 'auprc': 0.7495387103961728, 'loss_val': 0.8772080320961932, 'psi': 0.5604426434226017}
[S17] START round=13 head_norm_before_train=0.958930 cos_to_last_merge=1.0000 (last merge round=12)
[S17] round=13 local utility u=0.000000 metrics={'f1_val': 0.33899756514757473, 'auprc': 0.8048506991851762, 'loss_val': 0.9872140675306521, 'psi': 0.5253388187626153}-{'f1_val': 0.34833581416287973, 'auprc': 0.8035030679490286, 'loss_val': 0.9509145498548982, 'psi': 0.5304027156773393}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:62415
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:62412
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:62417
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:62408
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S3@127.0.0.1:62403
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S9
[S11] cosine check vs S9: cos=-0.0559
[S11] DROPPED delta from S9 (cos=-0.0559 < 0.0)
[S17] RECEIVED delta(kind=head bytes=1800) from S5
[S17] cosine check vs S5: cos=0.8610
[S7] RECEIVED delta(kind=head bytes=1799) from S6
[S7] cosine check vs S6: cos=-0.0893
[S7] DROPPED delta from S6 (cos=-0.0893 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1801) from S2
[S3] cosine check vs S2: cos=-0.0489
[S3] DROPPED delta from S2 (cos=-0.0489 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=-0.0109
[S15] DROPPED delta from S14 (cos=-0.0109 < 0.0)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=13 metric=0.3390 head_norm=0.984173
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.519158e-01
[S17] stored merged vector for next round verification (round=13)
[S17] DEBUG after merge:  round=13 metric=0.3402 head_norm=0.911193 delta_norm=0.251916
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[S2] START round=14 head_norm_before_train=1.300552 cos_to_last_merge=0.8623 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.862
[S2] round=14 local utility u=0.056559 metrics={'f1_val': 0.699768428218017, 'auprc': 0.7767213194185074, 'loss_val': 0.517372542410171, 'psi': 0.7305495846982131}-{'f1_val': 0.7136350793330258, 'auprc': 0.7778370542233063, 'loss_val': 0.7170368189768392, 'psi': 0.7393158692891381}
[S3] START round=14 head_norm_before_train=1.771012 (no previous merge yet)
[S3] round=14 local utility u=0.391861 metrics={'f1_val': 0.7005769689796157, 'auprc': 0.9984883180497562, 'loss_val': 0.18778844174483814, 'psi': 0.8197415086076719}-{'f1_val': 0.6020795983214718, 'auprc': 0.9921545099711204, 'loss_val': 0.3615243655438806, 'psi': 0.7581095629813313}
[S4] START round=14 head_norm_before_train=1.116993 cos_to_last_merge=0.9895 (last merge round=11)
[S4] round=14 local utility u=0.137157 metrics={'f1_val': 0.37621872114973887, 'auprc': 0.9368195285359674, 'loss_val': 0.6952900804298374, 'psi': 0.6004590441042303}-{'f1_val': 0.37491746027121636, 'auprc': 0.8531973579856584, 'loss_val': 0.7109305484667006, 'psi': 0.5662294193569932}
[S5] START round=14 head_norm_before_train=0.904917 cos_to_last_merge=0.9769 (last merge round=11)
[S5] round=14 local utility u=0.021596 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.991848804577582, 'loss_val': 0.42410426292278364, 'psi': 0.816932312291381}-{'f1_val': 0.7003213174339138, 'auprc': 0.9967250743353364, 'loss_val': 0.4819247320768227, 'psi': 0.8188828201944829}
[S6] START round=14 head_norm_before_train=1.286915 cos_to_last_merge=0.9959 (last merge round=11)
[S6] round=14 local utility u=0.236152 metrics={'f1_val': 0.6989321045481681, 'auprc': 0.9392403169342839, 'loss_val': 0.40146964252400247, 'psi': 0.7950553895026145}-{'f1_val': 0.7082494834376265, 'auprc': 0.791971278537181, 'loss_val': 0.4878703350737203, 'psi': 0.7417382014774483}
[S7] START round=14 head_norm_before_train=1.358080 cos_to_last_merge=0.8281 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.828
[S7] round=14 local utility u=0.779275 metrics={'f1_val': 0.6953922197737894, 'auprc': 0.8896452373485946, 'loss_val': 0.33176387249397365, 'psi': 0.7730934268037115}-{'f1_val': 0.5575988475400168, 'auprc': 0.7906222813496534, 'loss_val': 0.7664840780628637, 'psi': 0.6508082210638715}
[S8] START round=14 head_norm_before_train=1.564455 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.9983316842324828, 'loss_val': 0.19136926806612364, 'psi': 0.8278372333987469}-{'f1_val': 0.7621919360036086, 'auprc': 0.997525566576249, 'loss_val': 0.22776160617856206, 'psi': 0.8563253882326647}
[S9] START round=14 head_norm_before_train=1.602072 cos_to_last_merge=0.9926 (last merge round=11)
[S9] round=14 local utility u=0.013576 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981560217659318, 'loss_val': 0.06346681424698233, 'psi': 0.9972587157947076}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959992082996239, 'loss_val': 0.08414861155133521, 'psi': 0.9963959904081844}
[S10] START round=14 head_norm_before_train=1.141274 cos_to_last_merge=0.9990 (last merge round=12)
[S10] round=14 local utility u=0.842140 metrics={'f1_val': 0.9709843643225853, 'auprc': 0.9964489943260757, 'loss_val': 0.30596680034896706, 'psi': 0.9811702163239814}-{'f1_val': 0.6909014810029908, 'auprc': 0.9975055848847942, 'loss_val': 0.312918761887961, 'psi': 0.8135431225557122}
[S11] START round=14 head_norm_before_train=1.633899 cos_to_last_merge=0.9976 (last merge round=11)
[S11] round=14 local utility u=0.230255 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9960599938447634, 'loss_val': 0.3579706475255932, 'psi': 0.8195851875168974}-{'f1_val': 0.6482376181988834, 'auprc': 0.9948900917221962, 'loss_val': 0.49278572219297273, 'psi': 0.7868986076082085}
[S13] START round=14 head_norm_before_train=1.527809 (no previous merge yet)
[S13] round=14 local utility u=0.236935 metrics={'f1_val': 0.670587998480737, 'auprc': 0.8554742487221688, 'loss_val': 0.4372057619563408, 'psi': 0.7445424985773097}-{'f1_val': 0.6136340912251035, 'auprc': 0.862176362747683, 'loss_val': 0.5894587003464243, 'psi': 0.7130509998341352}
[S14] START round=14 head_norm_before_train=1.645531 cos_to_last_merge=0.9995 (last merge round=12)
[S14] round=14 local utility u=0.037130 metrics={'f1_val': 0.9972037544220943, 'auprc': 0.9971576892089692, 'loss_val': 0.1720393082296748, 'psi': 0.9971853283368443}-{'f1_val': 0.996399766873988, 'auprc': 0.9971577508379352, 'loss_val': 0.24147650636337992, 'psi': 0.996702960459567}
[S15] START round=14 head_norm_before_train=1.644073 (no previous merge yet)
[S15] round=14 local utility u=0.038627 metrics={'f1_val': 0.7006350233641774, 'auprc': 0.9868560559078257, 'loss_val': 0.2980627341912421, 'psi': 0.8151234363816366}-{'f1_val': 0.6972292378503685, 'auprc': 0.9854690061826951, 'loss_val': 0.3507206769124141, 'psi': 0.8125251451832991}
[S16] START round=14 head_norm_before_train=1.311214 cos_to_last_merge=0.8747 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.875
[S16] round=14 local utility u=0.173774 metrics={'f1_val': 0.5837060766109321, 'auprc': 0.8838265325644364, 'loss_val': 0.6362259304441261, 'psi': 0.7037542589923338}-{'f1_val': 0.568380578629708, 'auprc': 0.8194933958125218, 'loss_val': 0.6988205364695421, 'psi': 0.6688257055028335}
[S17] START round=14 head_norm_before_train=0.911193 cos_to_last_merge=1.0000 (last merge round=13)
[S17] round=14 local utility u=0.037820 metrics={'f1_val': 0.3419624552604027, 'auprc': 0.8148672691100217, 'loss_val': 0.959413204729047, 'psi': 0.5311243808002503}-{'f1_val': 0.33899756514757473, 'auprc': 0.8048506991851762, 'loss_val': 0.9872140675306521, 'psi': 0.5253388187626153}
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S6
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S11
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S13
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S6
[S9]  timeout peer S7
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S14]  timeout peer S2
[S14]  timeout peer S3
[S14]  timeout peer S4
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S16
[S14]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S7
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S10
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S8
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S11]  timeout peer S2
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S11]  timeout peer S13
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S6
[S7]  timeout peer S8
[S7]  timeout peer S9
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S14
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S3
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S8
[S5]  timeout peer S9
[S5]  timeout peer S10
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S5
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S8]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S5
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:62412
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] sending update (kind=head size=1805 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:62417
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1803 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S9] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S5
[S17] cosine check vs S5: cos=0.9432
[S3] RECEIVED delta(kind=head bytes=1803) from S2
[S3] cosine check vs S2: cos=-0.0427
[S3] DROPPED delta from S2 (cos=-0.0427 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S11
[S14] cosine check vs S11: cos=0.9909
[S11] RECEIVED delta(kind=head bytes=1797) from S9
[S11] cosine check vs S9: cos=-0.0587
[S11] DROPPED delta from S9 (cos=-0.0587 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1792) from S4
[S10] cosine check vs S4: cos=0.9106
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:62408
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=-0.0922
[S7] DROPPED delta from S6 (cos=-0.0922 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S6@127.0.0.1:62407
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S15@127.0.0.1:62415
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1797) from S14
[S15] cosine check vs S14: cos=-0.0080
[S15] DROPPED delta from S14 (cos=-0.0080 < 0.0)
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=14 metric=0.9972 head_norm=1.682897
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.130949e-01
[S14] stored merged vector for next round verification (round=14)
[S14] DEBUG after merge:  round=14 metric=0.9970 head_norm=1.668725 delta_norm=0.113095
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S15] sending update (kind=head size=1799 to 1 peers)
[S6] RECEIVED delta(kind=head bytes=1799) from S15
[S6] cosine check vs S15: cos=-0.0202
[S6] DROPPED delta from S15 (cos=-0.0202 < 0.0)
[S9] CommDone barrier timeout: have=1 need=2 — continuing
[S6] CommDone barrier timeout: have=1 need=2 — continuing
[S2] START round=15 head_norm_before_train=1.342924 cos_to_last_merge=0.8512 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.851
[S2] round=15 local utility u=0.061716 metrics={'f1_val': 0.6995103141566394, 'auprc': 0.7919170740971996, 'loss_val': 0.43797819295372237, 'psi': 0.7364730181328636}-{'f1_val': 0.699768428218017, 'auprc': 0.7767213194185074, 'loss_val': 0.517372542410171, 'psi': 0.7305495846982131}
[S3] START round=15 head_norm_before_train=1.808142 (no previous merge yet)
[S3] round=15 local utility u=0.780212 metrics={'f1_val': 0.9522165639571257, 'auprc': 0.9986872522073131, 'loss_val': 0.13779950581209344, 'psi': 0.9708048392572006}-{'f1_val': 0.7005769689796157, 'auprc': 0.9984883180497562, 'loss_val': 0.18778844174483814, 'psi': 0.8197415086076719}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=15 head_norm_before_train=1.169451 cos_to_last_merge=0.9818 (last merge round=11)
[S4] round=15 local utility u=0.535875 metrics={'f1_val': 0.6692409033499703, 'auprc': 0.656422706499971, 'loss_val': 0.5404826874559815, 'psi': 0.6641136246099706}-{'f1_val': 0.37621872114973887, 'auprc': 0.9368195285359674, 'loss_val': 0.6952900804298374, 'psi': 0.6004590441042303}
[S5] START round=15 head_norm_before_train=0.952401 cos_to_last_merge=0.9620 (last merge round=11)
[S5] round=15 local utility u=0.000000 metrics={'f1_val': 0.6827753940477412, 'auprc': 0.756541912411264, 'loss_val': 0.46982990176179446, 'psi': 0.7122820013931503}-{'f1_val': 0.7003213174339138, 'auprc': 0.991848804577582, 'loss_val': 0.42410426292278364, 'psi': 0.816932312291381}
[S6] START round=15 head_norm_before_train=1.321927 cos_to_last_merge=0.9923 (last merge round=11)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7074444286310667, 'auprc': 0.7844268594043579, 'loss_val': 0.44121717399162336, 'psi': 0.7382374009403831}-{'f1_val': 0.6989321045481681, 'auprc': 0.9392403169342839, 'loss_val': 0.40146964252400247, 'psi': 0.7950553895026145}
[S7] START round=15 head_norm_before_train=1.374633 cos_to_last_merge=0.8242 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.824
[S7] round=15 local utility u=0.000000 metrics={'f1_val': 0.6204760206113941, 'auprc': 0.7954170476925263, 'loss_val': 0.5592424799826132, 'psi': 0.6904524314438469}-{'f1_val': 0.6953922197737894, 'auprc': 0.8896452373485946, 'loss_val': 0.33176387249397365, 'psi': 0.7730934268037115}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=15 head_norm_before_train=1.596672 (no previous merge yet)
[S8] round=15 local utility u=0.003445 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.9993718696392733, 'loss_val': 0.1893200286867065, 'psi': 0.8284253545682878}-{'f1_val': 0.7141742661762565, 'auprc': 0.9983316842324828, 'loss_val': 0.19136926806612364, 'psi': 0.8278372333987469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=15 head_norm_before_train=1.646476 cos_to_last_merge=0.9878 (last merge round=11)
[S9] round=15 local utility u=0.000167 metrics={'f1_val': 0.9950291346206774, 'auprc': 0.998533138026702, 'loss_val': 0.05447659283460433, 'psi': 0.9964307359830873}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981560217659318, 'loss_val': 0.06346681424698233, 'psi': 0.9972587157947076}
[S10] START round=15 head_norm_before_train=1.172496 cos_to_last_merge=0.9968 (last merge round=12)
[S10] round=15 local utility u=0.000000 metrics={'f1_val': 0.9434846453035843, 'auprc': 0.991802639922453, 'loss_val': 0.3023242970301291, 'psi': 0.9628118431511318}-{'f1_val': 0.9709843643225853, 'auprc': 0.9964489943260757, 'loss_val': 0.30596680034896706, 'psi': 0.9811702163239814}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.9435 head_norm=1.202859
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.620058e-01
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.8528 head_norm=1.156977 delta_norm=0.262006
[S10] aggregate: ROLLBACK (f1_val pre=0.943 post=0.853 tol_abs=0.005 tol_rel=0.0)
[S11] START round=15 head_norm_before_train=1.662144 cos_to_last_merge=0.9956 (last merge round=11)
[S11] round=15 local utility u=0.018960 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9967107564000053, 'loss_val': 0.3220025590353935, 'psi': 0.8198454925389942}-{'f1_val': 0.7019353166316534, 'auprc': 0.9960599938447634, 'loss_val': 0.3579706475255932, 'psi': 0.8195851875168974}
[S13] START round=15 head_norm_before_train=1.546734 (no previous merge yet)
[S13] round=15 local utility u=0.000000 metrics={'f1_val': 0.5998864540507031, 'auprc': 0.8003264027414438, 'loss_val': 0.6871279691551451, 'psi': 0.6800624335269994}-{'f1_val': 0.670587998480737, 'auprc': 0.8554742487221688, 'loss_val': 0.4372057619563408, 'psi': 0.7445424985773097}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=15 head_norm_before_train=1.668725 cos_to_last_merge=1.0000 (last merge round=14)
[S14] round=15 local utility u=0.027008 metrics={'f1_val': 0.9971287107253277, 'auprc': 0.9971568063925205, 'loss_val': 0.11757019066857319, 'psi': 0.9971399489922048}-{'f1_val': 0.9972037544220943, 'auprc': 0.9971576892089692, 'loss_val': 0.1720393082296748, 'psi': 0.9971853283368443}
[S15] START round=15 head_norm_before_train=1.679141 (no previous merge yet)
[S15] round=15 local utility u=0.030644 metrics={'f1_val': 0.7012465667944086, 'auprc': 0.986984001183489, 'loss_val': 0.24082736280894002, 'psi': 0.8155415405500408}-{'f1_val': 0.7006350233641774, 'auprc': 0.9868560559078257, 'loss_val': 0.2980627341912421, 'psi': 0.8151234363816366}
[S16] START round=15 head_norm_before_train=1.354000 cos_to_last_merge=0.8650 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.865
[S16] round=15 local utility u=0.861675 metrics={'f1_val': 0.8288033325155353, 'auprc': 0.9142563647545565, 'loss_val': 0.47474961348562594, 'psi': 0.8629845454111438}-{'f1_val': 0.5837060766109321, 'auprc': 0.8838265325644364, 'loss_val': 0.6362259304441261, 'psi': 0.7037542589923338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=15 head_norm_before_train=0.941816 cos_to_last_merge=0.9985 (last merge round=13)
[S17] round=15 local utility u=0.138542 metrics={'f1_val': 0.37413217155591966, 'auprc': 0.822966358778059, 'loss_val': 0.8996443800099058, 'psi': 0.5536658464447755}-{'f1_val': 0.3419624552604027, 'auprc': 0.8148672691100217, 'loss_val': 0.959413204729047, 'psi': 0.5311243808002503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] sending update (kind=head size=1799 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=15 metric=0.3741 head_norm=0.980520
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.816941e-01
[S17] stored merged vector for next round verification (round=15)
[S17] DEBUG after merge:  round=15 metric=0.3737 head_norm=0.949332 delta_norm=0.181694
[S17] aggregate: ACCEPT kept=['S5'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:62414
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S3@127.0.0.1:62403
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:62407
[S2] sending update (kind=head size=1806 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1795 to 1 peers)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:62411
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:62415
[S6] RECEIVED delta(kind=head bytes=1798) from S15
[S6] cosine check vs S15: cos=-0.0186
[S6] DROPPED delta from S15 (cos=-0.0186 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1806) from S2
[S3] cosine check vs S2: cos=-0.0364
[S3] DROPPED delta from S2 (cos=-0.0364 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1795) from S11
[S14] cosine check vs S11: cos=0.9946
[S4] sending update (kind=head size=1803 to 1 peers)
[S11] ⇄ pheromone p=0.221 → S14@127.0.0.1:62414
[S15] ⇄ pheromone p=0.146 → S6@127.0.0.1:62407
[S2] ⇄ pheromone p=0.181 → S3@127.0.0.1:62403
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=-0.0113
[S15] DROPPED delta from S14 (cos=-0.0113 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1803) from S4
[S10] cosine check vs S4: cos=0.9716
[S4] ⇄ pheromone p=0.208 → S10@127.0.0.1:62411
[S14] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=15 metric=0.9971 head_norm=1.701381
[S14] _apply_head_vector_avg (torch): Δ‖w‖=8.823793e-02
[S14] stored merged vector for next round verification (round=15)
[S14] DEBUG after merge:  round=15 metric=0.9971 head_norm=1.692327 delta_norm=0.088238
[S14] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.269 → S15@127.0.0.1:62415
[S14]  timeout peer S9
[S14]  timeout peer S15
[S9]  timeout peer S5
[S9]  timeout peer S11
[S9]  timeout peer S13
[S6]  timeout peer S2
[S6]  timeout peer S7
[S6]  timeout peer S8
[S4]  timeout peer S10
[S4]  timeout peer S16
[S15]  timeout peer S6
[S11]  timeout peer S14
[S5]  timeout peer S4
[S5]  timeout peer S17
[S2]  timeout peer S3
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=16 head_norm_before_train=1.388325 cos_to_last_merge=0.8395 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.840
[S2] round=16 local utility u=0.008357 metrics={'f1_val': 0.6996883241866798, 'auprc': 0.7777143305783747, 'loss_val': 0.3797232912730495, 'psi': 0.7308987267433578}-{'f1_val': 0.6995103141566394, 'auprc': 0.7919170740971996, 'loss_val': 0.43797819295372237, 'psi': 0.7364730181328636}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=16 head_norm_before_train=1.842228 (no previous merge yet)
[S3] round=16 local utility u=0.089534 metrics={'f1_val': 0.9726102525776552, 'auprc': 0.9983209926496953, 'loss_val': 0.07999488059058614, 'psi': 0.9828945486064713}-{'f1_val': 0.9522165639571257, 'auprc': 0.9986872522073131, 'loss_val': 0.13779950581209344, 'psi': 0.9708048392572006}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=16 head_norm_before_train=1.210489 cos_to_last_merge=0.9755 (last merge round=11)
[S4] round=16 local utility u=1.000000 metrics={'f1_val': 0.9376137517497545, 'auprc': 0.9051929658502832, 'loss_val': 0.549123641246354, 'psi': 0.924645437389966}-{'f1_val': 0.6692409033499703, 'auprc': 0.656422706499971, 'loss_val': 0.5404826874559815, 'psi': 0.6641136246099706}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=16 head_norm_before_train=1.001261 cos_to_last_merge=0.9474 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.947
[S5] round=16 local utility u=0.129387 metrics={'f1_val': 0.700320598491359, 'auprc': 0.7835321863261748, 'loss_val': 0.397297002630699, 'psi': 0.7336052336252854}-{'f1_val': 0.6827753940477412, 'auprc': 0.756541912411264, 'loss_val': 0.46982990176179446, 'psi': 0.7122820013931503}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=16 head_norm_before_train=1.349469 cos_to_last_merge=0.9889 (last merge round=11)
[S6] round=16 local utility u=0.000000 metrics={'f1_val': 0.7069492151754729, 'auprc': 0.778307918035241, 'loss_val': 0.48463439181102375, 'psi': 0.7354926963193802}-{'f1_val': 0.7074444286310667, 'auprc': 0.7844268594043579, 'loss_val': 0.44121717399162336, 'psi': 0.7382374009403831}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=16 head_norm_before_train=1.388507 cos_to_last_merge=0.8202 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.820
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.5507492286534813, 'auprc': 0.7843138453333115, 'loss_val': 0.764060185720174, 'psi': 0.6441750753254134}-{'f1_val': 0.6204760206113941, 'auprc': 0.7954170476925263, 'loss_val': 0.5592424799826132, 'psi': 0.6904524314438469}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=16 head_norm_before_train=1.634588 (no previous merge yet)
[S8] round=16 local utility u=0.888585 metrics={'f1_val': 0.9966394137733288, 'auprc': 0.9991279285324932, 'loss_val': 0.10448847180971346, 'psi': 0.9976348196769945}-{'f1_val': 0.7144610111876308, 'auprc': 0.9993718696392733, 'loss_val': 0.1893200286867065, 'psi': 0.8284253545682878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] sending update (kind=head size=1801 to 1 peers)
[S9] START round=16 head_norm_before_train=1.686932 cos_to_last_merge=0.9836 (last merge round=11)
[S9] round=16 local utility u=0.000000 metrics={'f1_val': 0.9901297741397954, 'auprc': 0.9982104453801257, 'loss_val': 0.055534543180628566, 'psi': 0.9933620426359275}-{'f1_val': 0.9950291346206774, 'auprc': 0.998533138026702, 'loss_val': 0.05447659283460433, 'psi': 0.9964307359830873}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=16 head_norm_before_train=1.156977 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.080863 metrics={'f1_val': 0.9634502639494976, 'auprc': 0.9934856653175416, 'loss_val': 0.2654416297213655, 'psi': 0.9754644244967152}-{'f1_val': 0.9434846453035843, 'auprc': 0.991802639922453, 'loss_val': 0.3023242970301291, 'psi': 0.9628118431511318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=16 metric=0.9635 head_norm=1.189213
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.590789e-01
[S10] stored merged vector for next round verification (round=16)
[S10] DEBUG after merge:  round=16 metric=0.7009 head_norm=1.189306 delta_norm=0.159079
[S10] aggregate: ROLLBACK (f1_val pre=0.963 post=0.701 tol_abs=0.005 tol_rel=0.0)
[S11] START round=16 head_norm_before_train=1.687843 cos_to_last_merge=0.9935 (last merge round=11)
[S11] round=16 local utility u=0.016398 metrics={'f1_val': 0.7018701185892477, 'auprc': 0.9894124264578795, 'loss_val': 0.26691976697819925, 'psi': 0.8168870417367005}-{'f1_val': 0.7019353166316534, 'auprc': 0.9967107564000053, 'loss_val': 0.3220025590353935, 'psi': 0.8198454925389942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=16 head_norm_before_train=1.568540 (no previous merge yet)
[S13] round=16 local utility u=0.076770 metrics={'f1_val': 0.6124871814707711, 'auprc': 0.7882102056243334, 'loss_val': 0.5728443512878865, 'psi': 0.682776391132196}-{'f1_val': 0.5998864540507031, 'auprc': 0.8003264027414438, 'loss_val': 0.6871279691551451, 'psi': 0.6800624335269994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=16 head_norm_before_train=1.692327 cos_to_last_merge=1.0000 (last merge round=15)
[S14] round=16 local utility u=0.005693 metrics={'f1_val': 0.9975484281783746, 'auprc': 0.9970663806659332, 'loss_val': 0.1084317655470979, 'psi': 0.997355609173398}-{'f1_val': 0.9971287107253277, 'auprc': 0.9971568063925205, 'loss_val': 0.11757019066857319, 'psi': 0.9971399489922048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=16 head_norm_before_train=1.711961 (no previous merge yet)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6994071583812779, 'auprc': 0.9832518699084443, 'loss_val': 0.3121774146870804, 'psi': 0.8129450429921444}-{'f1_val': 0.7012465667944086, 'auprc': 0.986984001183489, 'loss_val': 0.24082736280894002, 'psi': 0.8155415405500408}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=16 head_norm_before_train=1.396359 cos_to_last_merge=0.8556 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.856
[S16] round=16 local utility u=0.104720 metrics={'f1_val': 0.8333997566736246, 'auprc': 0.9494436038753429, 'loss_val': 0.398450289544249, 'psi': 0.8798172955543119}-{'f1_val': 0.8288033325155353, 'auprc': 0.9142563647545565, 'loss_val': 0.47474961348562594, 'psi': 0.8629845454111438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=16 head_norm_before_train=0.949332 cos_to_last_merge=1.0000 (last merge round=15)
[S17] round=16 local utility u=0.048994 metrics={'f1_val': 0.387271211936271, 'auprc': 0.8261385151653028, 'loss_val': 0.8900068674210999, 'psi': 0.5628181332278837}-{'f1_val': 0.37413217155591966, 'auprc': 0.822966358778059, 'loss_val': 0.8996443800099058, 'psi': 0.5536658464447755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S17] sending update (kind=head size=1790 to 1 peers)
[S2] START round=17 head_norm_before_train=1.431609 cos_to_last_merge=0.8283 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.828
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.6998661722620363, 'auprc': 0.7573721339031729, 'loss_val': 0.3603281336747974, 'psi': 0.722868556918491}-{'f1_val': 0.6996883241866798, 'auprc': 0.7777143305783747, 'loss_val': 0.3797232912730495, 'psi': 0.7308987267433578}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=17 head_norm_before_train=1.878428 (no previous merge yet)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9422269032483463, 'auprc': 0.9988673119220188, 'loss_val': 0.14431023584301958, 'psi': 0.9648830667178154}-{'f1_val': 0.9726102525776552, 'auprc': 0.9983209926496953, 'loss_val': 0.07999488059058614, 'psi': 0.9828945486064713}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=1.238395 cos_to_last_merge=0.9713 (last merge round=11)
[S4] round=17 local utility u=0.147811 metrics={'f1_val': 0.9535732968305611, 'auprc': 0.9292319504077964, 'loss_val': 0.421375805081135, 'psi': 0.9438367582614552}-{'f1_val': 0.9376137517497545, 'auprc': 0.9051929658502832, 'loss_val': 0.549123641246354, 'psi': 0.924645437389966}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=17 head_norm_before_train=1.043780 cos_to_last_merge=0.9343 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.934
[S5] round=17 local utility u=0.154911 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8716404296197645, 'loss_val': 0.3518005916455291, 'psi': 0.7688485309427212}-{'f1_val': 0.700320598491359, 'auprc': 0.7835321863261748, 'loss_val': 0.397297002630699, 'psi': 0.7336052336252854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=17 head_norm_before_train=1.373782 cos_to_last_merge=0.9850 (last merge round=11)
[S6] round=17 local utility u=0.283935 metrics={'f1_val': 0.6993912712536436, 'auprc': 0.9281507393338737, 'loss_val': 0.3209456544999021, 'psi': 0.7908950584857357}-{'f1_val': 0.7069492151754729, 'auprc': 0.778307918035241, 'loss_val': 0.48463439181102375, 'psi': 0.7354926963193802}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=17 head_norm_before_train=1.399446 cos_to_last_merge=0.8192 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.819
[S7] round=17 local utility u=0.226987 metrics={'f1_val': 0.5990063255293469, 'auprc': 0.7940371798861089, 'loss_val': 0.6287987510454085, 'psi': 0.6770186672720517}-{'f1_val': 0.5507492286534813, 'auprc': 0.7843138453333115, 'loss_val': 0.764060185720174, 'psi': 0.6441750753254134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=17 head_norm_before_train=1.667293 (no previous merge yet)
[S8] round=17 local utility u=0.000000 metrics={'f1_val': 0.8981590417177172, 'auprc': 0.9991468418575026, 'loss_val': 0.12883370939226796, 'psi': 0.9385541617736313}-{'f1_val': 0.9966394137733288, 'auprc': 0.9991279285324932, 'loss_val': 0.10448847180971346, 'psi': 0.9976348196769945}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=17 head_norm_before_train=1.723778 cos_to_last_merge=0.9798 (last merge round=11)
[S9] round=17 local utility u=0.026096 metrics={'f1_val': 0.9958601375429889, 'auprc': 0.9985403414103733, 'loss_val': 0.03871390886999129, 'psi': 0.9969322190899426}-{'f1_val': 0.9901297741397954, 'auprc': 0.9982104453801257, 'loss_val': 0.055534543180628566, 'psi': 0.9933620426359275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=17 head_norm_before_train=1.189306 cos_to_last_merge=1.0000 (last merge round=16)
[S10] round=17 local utility u=0.099517 metrics={'f1_val': 0.9930181913547045, 'auprc': 0.9942713112608204, 'loss_val': 0.24617283120563793, 'psi': 0.9935194393171508}-{'f1_val': 0.9634502639494976, 'auprc': 0.9934856653175416, 'loss_val': 0.2654416297213655, 'psi': 0.9754644244967152}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] sending update (kind=head size=1803 to 1 peers)
[S11] START round=17 head_norm_before_train=1.713784 cos_to_last_merge=0.9912 (last merge round=11)
[S11] round=17 local utility u=0.664967 metrics={'f1_val': 0.9412090920039491, 'auprc': 0.9967110306048269, 'loss_val': 0.39491459383119937, 'psi': 0.9634098674443001}-{'f1_val': 0.7018701185892477, 'auprc': 0.9894124264578795, 'loss_val': 0.26691976697819925, 'psi': 0.8168870417367005}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] START round=17 head_norm_before_train=1.587396 (no previous merge yet)
[S13] round=17 local utility u=0.000000 metrics={'f1_val': 0.6206589967341052, 'auprc': 0.7979602575220817, 'loss_val': 0.6527782992315598, 'psi': 0.6915795010492958}-{'f1_val': 0.6124871814707711, 'auprc': 0.7882102056243334, 'loss_val': 0.5728443512878865, 'psi': 0.682776391132196}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=17 head_norm_before_train=1.720242 cos_to_last_merge=0.9996 (last merge round=15)
[S14] round=17 local utility u=0.015384 metrics={'f1_val': 0.9983050875260411, 'auprc': 0.9987769394686252, 'loss_val': 0.08733507342840438, 'psi': 0.9984938283030748}-{'f1_val': 0.9975484281783746, 'auprc': 0.9970663806659332, 'loss_val': 0.1084317655470979, 'psi': 0.997355609173398}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=17 head_norm_before_train=1.746483 (no previous merge yet)
[S15] round=17 local utility u=0.154981 metrics={'f1_val': 0.7350399795250808, 'auprc': 0.9885738750602637, 'loss_val': 0.23197924080971744, 'psi': 0.836453537739154}-{'f1_val': 0.6994071583812779, 'auprc': 0.9832518699084443, 'loss_val': 0.3121774146870804, 'psi': 0.8129450429921444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=17 head_norm_before_train=1.437455 cos_to_last_merge=0.8476 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.848
[S16] round=17 local utility u=0.000000 metrics={'f1_val': 0.8424841629219051, 'auprc': 0.8759776487190193, 'loss_val': 0.6860964645534722, 'psi': 0.8558815572407508}-{'f1_val': 0.8333997566736246, 'auprc': 0.9494436038753429, 'loss_val': 0.398450289544249, 'psi': 0.8798172955543119}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=17 head_norm_before_train=0.990302 cos_to_last_merge=0.9978 (last merge round=15)
[S17] round=17 local utility u=0.000000 metrics={'f1_val': 0.37552181256810746, 'auprc': 0.8288966078078162, 'loss_val': 0.8979743264121821, 'psi': 0.556871730663991}-{'f1_val': 0.387271211936271, 'auprc': 0.8261385151653028, 'loss_val': 0.8900068674210999, 'psi': 0.5628181332278837}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=18 head_norm_before_train=1.473570 cos_to_last_merge=0.8191 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.819
[S2] round=18 local utility u=0.037796 metrics={'f1_val': 0.6997924934250046, 'auprc': 0.7897956177816098, 'loss_val': 0.38156468503006014, 'psi': 0.7357937431676467}-{'f1_val': 0.6998661722620363, 'auprc': 0.7573721339031729, 'loss_val': 0.3603281336747974, 'psi': 0.722868556918491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] sending update (kind=head size=1804 to 1 peers)
[S3] START round=18 head_norm_before_train=1.905288 (no previous merge yet)
[S3] round=18 local utility u=0.070871 metrics={'f1_val': 0.9608604911886242, 'auprc': 0.9983166095793914, 'loss_val': 0.11271833647589057, 'psi': 0.975842938544931}-{'f1_val': 0.9422269032483463, 'auprc': 0.9988673119220188, 'loss_val': 0.14431023584301958, 'psi': 0.9648830667178154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] sending update (kind=head size=1806 to 1 peers)
[S4] START round=18 head_norm_before_train=1.264628 cos_to_last_merge=0.9672 (last merge round=11)
[S4] round=18 local utility u=0.019857 metrics={'f1_val': 0.946115920430195, 'auprc': 0.9590433904824611, 'loss_val': 0.42635224170783703, 'psi': 0.9512869084511015}-{'f1_val': 0.9535732968305611, 'auprc': 0.9292319504077964, 'loss_val': 0.421375805081135, 'psi': 0.9438367582614552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=18 head_norm_before_train=1.085856 cos_to_last_merge=0.9223 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.922
[S5] round=18 local utility u=0.186429 metrics={'f1_val': 0.700320598491359, 'auprc': 0.984066497736235, 'loss_val': 0.31622134392706897, 'psi': 0.8138189581893094}-{'f1_val': 0.700320598491359, 'auprc': 0.8716404296197645, 'loss_val': 0.3518005916455291, 'psi': 0.7688485309427212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=18 head_norm_before_train=1.394096 cos_to_last_merge=0.9817 (last merge round=11)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.7053166863126814, 'auprc': 0.780292894558096, 'loss_val': 0.4692171903668789, 'psi': 0.7353071696108473}-{'f1_val': 0.6993912712536436, 'auprc': 0.9281507393338737, 'loss_val': 0.3209456544999021, 'psi': 0.7908950584857357}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.410322 cos_to_last_merge=0.8180 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.818
[S7] round=18 local utility u=0.008930 metrics={'f1_val': 0.5981112150362748, 'auprc': 0.7975757097456555, 'loss_val': 0.6161842098243832, 'psi': 0.6778970129200271}-{'f1_val': 0.5990063255293469, 'auprc': 0.7940371798861089, 'loss_val': 0.6287987510454085, 'psi': 0.6770186672720517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=18 head_norm_before_train=1.700223 (no previous merge yet)
[S8] round=18 local utility u=0.321987 metrics={'f1_val': 0.9963743336862869, 'auprc': 0.9992552044500558, 'loss_val': 0.0744761075836447, 'psi': 0.9975266819917944}-{'f1_val': 0.8981590417177172, 'auprc': 0.9991468418575026, 'loss_val': 0.12883370939226796, 'psi': 0.9385541617736313}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=18 head_norm_before_train=1.755484 cos_to_last_merge=0.9766 (last merge round=11)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.99328400274958, 'loss_val': 0.034982248229705575, 'psi': 0.9953290958586893}-{'f1_val': 0.9958601375429889, 'auprc': 0.9985403414103733, 'loss_val': 0.03871390886999129, 'psi': 0.9969322190899426}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=18 head_norm_before_train=1.221124 cos_to_last_merge=0.9992 (last merge round=16)
[S10] round=18 local utility u=0.023375 metrics={'f1_val': 0.9935068639572467, 'auprc': 0.9968016803910906, 'loss_val': 0.2099469491751407, 'psi': 0.9948247905307843}-{'f1_val': 0.9930181913547045, 'auprc': 0.9942713112608204, 'loss_val': 0.24617283120563793, 'psi': 0.9935194393171508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=18 head_norm_before_train=1.738759 cos_to_last_merge=0.9893 (last merge round=11)
[S11] round=18 local utility u=0.159988 metrics={'f1_val': 0.9588053434165477, 'auprc': 0.9980999042643437, 'loss_val': 0.18468224813509485, 'psi': 0.974523167755666}-{'f1_val': 0.9412090920039491, 'auprc': 0.9967110306048269, 'loss_val': 0.39491459383119937, 'psi': 0.9634098674443001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=18 head_norm_before_train=1.600571 (no previous merge yet)
[S13] round=18 local utility u=0.077019 metrics={'f1_val': 0.6069564983630067, 'auprc': 0.8662185528245969, 'loss_val': 0.6213001006517271, 'psi': 0.7106613201476428}-{'f1_val': 0.6206589967341052, 'auprc': 0.7979602575220817, 'loss_val': 0.6527782992315598, 'psi': 0.6915795010492958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=18 head_norm_before_train=1.747446 cos_to_last_merge=0.9987 (last merge round=15)
[S14] round=18 local utility u=0.002051 metrics={'f1_val': 0.9976516241010662, 'auprc': 0.9971065033719102, 'loss_val': 0.07430032853142701, 'psi': 0.9974335758094037}-{'f1_val': 0.9983050875260411, 'auprc': 0.9987769394686252, 'loss_val': 0.08733507342840438, 'psi': 0.9984938283030748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=18 head_norm_before_train=1.777753 (no previous merge yet)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7009847512884262, 'auprc': 0.9817395453564374, 'loss_val': 0.33216563668960475, 'psi': 0.8132866689156306}-{'f1_val': 0.7350399795250808, 'auprc': 0.9885738750602637, 'loss_val': 0.23197924080971744, 'psi': 0.836453537739154}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=18 head_norm_before_train=1.478928 cos_to_last_merge=0.8392 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.839
[S16] round=18 local utility u=0.897602 metrics={'f1_val': 0.9902630276371658, 'auprc': 0.9952016061314721, 'loss_val': 0.13523793546083587, 'psi': 0.9922384590348884}-{'f1_val': 0.8424841629219051, 'auprc': 0.8759776487190193, 'loss_val': 0.6860964645534722, 'psi': 0.8558815572407508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=18 head_norm_before_train=1.032514 cos_to_last_merge=0.9926 (last merge round=15)
[S17] round=18 local utility u=0.000000 metrics={'f1_val': 0.371187851509109, 'auprc': 0.8224728333536022, 'loss_val': 0.9292618459834492, 'psi': 0.5517018442469063}-{'f1_val': 0.37552181256810746, 'auprc': 0.8288966078078162, 'loss_val': 0.8979743264121821, 'psi': 0.556871730663991}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=19 head_norm_before_train=1.511328 cos_to_last_merge=0.8119 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.812
[S2] round=19 local utility u=0.000000 metrics={'f1_val': 0.6996078256430083, 'auprc': 0.6631674709596306, 'loss_val': 0.3379845676978985, 'psi': 0.6850316837696573}-{'f1_val': 0.6997924934250046, 'auprc': 0.7897956177816098, 'loss_val': 0.38156468503006014, 'psi': 0.7357937431676467}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=20 psi=0.685 u=0.0000 p_local=0.0810 f1=0.700 auprc=0.663 bytes=23384
[S3] START round=19 head_norm_before_train=1.927415 (no previous merge yet)
[S3] round=19 local utility u=0.000000 metrics={'f1_val': 0.7774977653700177, 'auprc': 0.998691628085944, 'loss_val': 0.4074073912522135, 'psi': 0.8659753104563883}-{'f1_val': 0.9608604911886242, 'auprc': 0.9983166095793914, 'loss_val': 0.11271833647589057, 'psi': 0.975842938544931}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=20 psi=0.866 u=0.0000 p_local=0.1714 f1=0.777 auprc=0.999 bytes=17983
[S4] START round=19 head_norm_before_train=1.289628 cos_to_last_merge=0.9635 (last merge round=11)
[S4] round=19 local utility u=0.043545 metrics={'f1_val': 0.9482924531424604, 'auprc': 0.9571299851511468, 'loss_val': 0.3465816246218822, 'psi': 0.9518274659459349}-{'f1_val': 0.946115920430195, 'auprc': 0.9590433904824611, 'loss_val': 0.42635224170783703, 'psi': 0.9512869084511015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S4] r=20 psi=0.952 u=0.0435 p_local=0.2183 f1=0.948 auprc=0.957 bytes=30543
[S5] START round=19 head_norm_before_train=1.120746 cos_to_last_merge=0.9134 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.913
[S5] round=19 local utility u=0.000000 metrics={'f1_val': 0.6647997972410087, 'auprc': 0.855686093942077, 'loss_val': 0.3883084386111843, 'psi': 0.741154315921436}-{'f1_val': 0.700320598491359, 'auprc': 0.984066497736235, 'loss_val': 0.31622134392706897, 'psi': 0.8138189581893094}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=20 psi=0.741 u=0.0000 p_local=0.1086 f1=0.665 auprc=0.856 bytes=28766
[S6] START round=19 head_norm_before_train=1.413746 cos_to_last_merge=0.9793 (last merge round=11)
[S6] round=19 local utility u=0.307012 metrics={'f1_val': 0.6984551909274044, 'auprc': 0.9390733901075203, 'loss_val': 0.2903658331632775, 'psi': 0.7947024705994508}-{'f1_val': 0.7053166863126814, 'auprc': 0.780292894558096, 'loss_val': 0.4692171903668789, 'psi': 0.7353071696108473}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S6] r=20 psi=0.795 u=0.3070 p_local=0.1917 f1=0.698 auprc=0.939 bytes=16174
[S7] START round=19 head_norm_before_train=1.425953 cos_to_last_merge=0.8165 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.817
[S7] round=19 local utility u=0.200168 metrics={'f1_val': 0.6438313568044669, 'auprc': 0.8034706780809571, 'loss_val': 0.5078541165373391, 'psi': 0.707687085315063}-{'f1_val': 0.5981112150362748, 'auprc': 0.7975757097456555, 'loss_val': 0.6161842098243832, 'psi': 0.6778970129200271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S7] r=20 psi=0.708 u=0.2002 p_local=0.1762 f1=0.644 auprc=0.803 bytes=23396
[S8] START round=19 head_norm_before_train=1.722105 (no previous merge yet)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9946453664677153, 'auprc': 0.995781158295131, 'loss_val': 0.07515879524102692, 'psi': 0.9950996831986816}-{'f1_val': 0.9963743336862869, 'auprc': 0.9992552044500558, 'loss_val': 0.0744761075836447, 'psi': 0.9975266819917944}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=20 psi=0.995 u=0.0000 p_local=0.2243 f1=0.995 auprc=0.996 bytes=23370
[S9] START round=19 head_norm_before_train=1.778794 cos_to_last_merge=0.9743 (last merge round=11)
[S9] round=19 local utility u=0.005483 metrics={'f1_val': 0.9956098104564366, 'auprc': 0.9985480141449488, 'loss_val': 0.033311886588951505, 'psi': 0.9967850919318414}-{'f1_val': 0.9966924912647621, 'auprc': 0.99328400274958, 'loss_val': 0.034982248229705575, 'psi': 0.9953290958586893}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S9] r=20 psi=0.997 u=0.0055 p_local=0.0541 f1=0.996 auprc=0.999 bytes=30554
[S10] START round=19 head_norm_before_train=1.260443 cos_to_last_merge=0.9964 (last merge round=16)
[S10] round=19 local utility u=0.021598 metrics={'f1_val': 0.9935109650886941, 'auprc': 0.9966938256013976, 'loss_val': 0.16645138224621991, 'psi': 0.9947841092937755}-{'f1_val': 0.9935068639572467, 'auprc': 0.9968016803910906, 'loss_val': 0.2099469491751407, 'psi': 0.9948247905307843}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S10] r=20 psi=0.995 u=0.0216 p_local=0.1578 f1=0.994 auprc=0.997 bytes=25201
[S11] START round=19 head_norm_before_train=1.758187 cos_to_last_merge=0.9877 (last merge round=11)
[S11] round=19 local utility u=0.120375 metrics={'f1_val': 0.996960829744628, 'auprc': 0.9965195623910675, 'loss_val': 0.1681243559480022, 'psi': 0.9967843228032038}-{'f1_val': 0.9588053434165477, 'auprc': 0.9980999042643437, 'loss_val': 0.18468224813509485, 'psi': 0.974523167755666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S11] r=20 psi=0.997 u=0.1204 p_local=0.2271 f1=0.997 auprc=0.997 bytes=28733
[S13] START round=19 head_norm_before_train=1.612204 (no previous merge yet)
[S13] round=19 local utility u=0.000000 metrics={'f1_val': 0.5857974604480508, 'auprc': 0.8959425427269504, 'loss_val': 0.8004256779950631, 'psi': 0.7098554933596106}-{'f1_val': 0.6069564983630067, 'auprc': 0.8662185528245969, 'loss_val': 0.6213001006517271, 'psi': 0.7106613201476428}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=20 psi=0.710 u=0.0000 p_local=0.0981 f1=0.586 auprc=0.896 bytes=25167
[S14] START round=19 head_norm_before_train=1.774917 cos_to_last_merge=0.9973 (last merge round=15)
[S14] round=19 local utility u=0.000000 metrics={'f1_val': 0.9760625973894429, 'auprc': 0.9970369946338543, 'loss_val': 0.08024511199336921, 'psi': 0.9844523562872074}-{'f1_val': 0.9976516241010662, 'auprc': 0.9971065033719102, 'loss_val': 0.07430032853142701, 'psi': 0.9974335758094037}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=20 psi=0.984 u=0.0000 p_local=0.1129 f1=0.976 auprc=0.997 bytes=30561
[S15] START round=19 head_norm_before_train=1.803964 (no previous merge yet)
[S15] round=19 local utility u=0.588169 metrics={'f1_val': 0.8612771191199944, 'auprc': 0.9894557734961105, 'loss_val': 0.14073138938067764, 'psi': 0.9125485808704408}-{'f1_val': 0.7009847512884262, 'auprc': 0.9817395453564374, 'loss_val': 0.33216563668960475, 'psi': 0.8132866689156306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] r=20 psi=0.913 u=0.5882 p_local=0.1971 f1=0.861 auprc=0.989 bytes=26964
[S16] START round=19 head_norm_before_train=1.518681 cos_to_last_merge=0.8319 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.832
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.9392423256823085, 'auprc': 0.993921524722146, 'loss_val': 0.2028963631614025, 'psi': 0.9611140052982435}-{'f1_val': 0.9902630276371658, 'auprc': 0.9952016061314721, 'loss_val': 0.13523793546083587, 'psi': 0.9922384590348884}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.961 u=0.0000 p_local=0.3276 f1=0.939 auprc=0.994 bytes=23368
[S17] START round=19 head_norm_before_train=1.074088 cos_to_last_merge=0.9855 (last merge round=15)
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.3649475941840351, 'auprc': 0.8115905025185401, 'loss_val': 1.0021501658082665, 'psi': 0.5436047575178371}-{'f1_val': 0.371187851509109, 'auprc': 0.8224728333536022, 'loss_val': 0.9292618459834492, 'psi': 0.5517018442469063}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=20 psi=0.544 u=0.0000 p_local=0.0504 f1=0.365 auprc=0.812 bytes=17960
[S2] START round=20 head_norm_before_train=1.536427 cos_to_last_merge=0.8063 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.806
[S2] round=20 local utility u=0.000751 metrics={'f1_val': 0.699327367306577, 'auprc': 0.66096359588387, 'loss_val': 0.3281876260104991, 'psi': 0.6839818587374942}-{'f1_val': 0.6996078256430083, 'auprc': 0.6631674709596306, 'loss_val': 0.3379845676978985, 'psi': 0.6850316837696573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=20 head_norm_before_train=1.952091 (no previous merge yet)
[S3] round=20 local utility u=0.829541 metrics={'f1_val': 0.9947523743726271, 'auprc': 0.9987770611472323, 'loss_val': 0.05210910313239002, 'psi': 0.9963622490824692}-{'f1_val': 0.7774977653700177, 'auprc': 0.998691628085944, 'loss_val': 0.4074073912522135, 'psi': 0.8659753104563883}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=20 head_norm_before_train=1.317624 cos_to_last_merge=0.9592 (last merge round=11)
[S4] round=20 local utility u=0.055159 metrics={'f1_val': 0.9518500158832524, 'auprc': 0.9693269649642973, 'loss_val': 0.29419916931220313, 'psi': 0.9588407955156704}-{'f1_val': 0.9482924531424604, 'auprc': 0.9571299851511468, 'loss_val': 0.3465816246218822, 'psi': 0.9518274659459349}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=20 head_norm_before_train=1.147636 cos_to_last_merge=0.9069 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.907
[S5] round=20 local utility u=0.139412 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8574364390320556, 'loss_val': 0.32785986233161557, 'psi': 0.7631669347076376}-{'f1_val': 0.6647997972410087, 'auprc': 0.855686093942077, 'loss_val': 0.3883084386111843, 'psi': 0.741154315921436}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=20 head_norm_before_train=1.429004 cos_to_last_merge=0.9772 (last merge round=11)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6416523152554378, 'auprc': 0.7941861410961736, 'loss_val': 0.44236709807566776, 'psi': 0.7026658455917321}-{'f1_val': 0.6984551909274044, 'auprc': 0.9390733901075203, 'loss_val': 0.2903658331632775, 'psi': 0.7947024705994508}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.437846 cos_to_last_merge=0.8140 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.814
[S7] round=20 local utility u=0.429559 metrics={'f1_val': 0.6952677275534271, 'auprc': 0.9091981438913541, 'loss_val': 0.2745364145931598, 'psi': 0.7808398940885979}-{'f1_val': 0.6438313568044669, 'auprc': 0.8034706780809571, 'loss_val': 0.5078541165373391, 'psi': 0.707687085315063}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=20 head_norm_before_train=1.740425 (no previous merge yet)
[S8] round=20 local utility u=0.000000 metrics={'f1_val': 0.9908197349150198, 'auprc': 0.999081251663883, 'loss_val': 0.09433198793464874, 'psi': 0.9941243416145651}-{'f1_val': 0.9946453664677153, 'auprc': 0.995781158295131, 'loss_val': 0.07515879524102692, 'psi': 0.9950996831986816}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=20 head_norm_before_train=1.796620 cos_to_last_merge=0.9726 (last merge round=11)
[S9] round=20 local utility u=0.000979 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9959993108926616, 'loss_val': 0.030011417758399713, 'psi': 0.9963960314453995}-{'f1_val': 0.9956098104564366, 'auprc': 0.9985480141449488, 'loss_val': 0.033311886588951505, 'psi': 0.9967850919318414}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S9] sending update (kind=head size=1806 to 1 peers)
[S10] START round=20 head_norm_before_train=1.304398 cos_to_last_merge=0.9916 (last merge round=16)
[S10] round=20 local utility u=0.012731 metrics={'f1_val': 0.9933750578586366, 'auprc': 0.9965040391412034, 'loss_val': 0.1396038927059055, 'psi': 0.9946266503716632}-{'f1_val': 0.9935109650886941, 'auprc': 0.9966938256013976, 'loss_val': 0.16645138224621991, 'psi': 0.9947841092937755}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=20 head_norm_before_train=1.782729 cos_to_last_merge=0.9858 (last merge round=11)
[S11] round=20 local utility u=0.000000 metrics={'f1_val': 0.9807062211936182, 'auprc': 0.9980188738757586, 'loss_val': 0.12163785233876222, 'psi': 0.9876312822664743}-{'f1_val': 0.996960829744628, 'auprc': 0.9965195623910675, 'loss_val': 0.1681243559480022, 'psi': 0.9967843228032038}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=20 head_norm_before_train=1.621325 (no previous merge yet)
[S13] round=20 local utility u=0.036876 metrics={'f1_val': 0.6184384985415269, 'auprc': 0.8111700927274594, 'loss_val': 0.6682027095670972, 'psi': 0.6955311362159}-{'f1_val': 0.5857974604480508, 'auprc': 0.8959425427269504, 'loss_val': 0.8004256779950631, 'psi': 0.7098554933596106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=20 head_norm_before_train=1.800964 cos_to_last_merge=0.9956 (last merge round=15)
[S14] round=20 local utility u=0.078250 metrics={'f1_val': 0.9967999159800798, 'auprc': 0.9974344528752574, 'loss_val': 0.0493619368612785, 'psi': 0.9970537307381508}-{'f1_val': 0.9760625973894429, 'auprc': 0.9970369946338543, 'loss_val': 0.08024511199336921, 'psi': 0.9844523562872074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=20 head_norm_before_train=1.825671 (no previous merge yet)
[S15] round=20 local utility u=0.000000 metrics={'f1_val': 0.7763584414203107, 'auprc': 0.9875743941808208, 'loss_val': 0.23522739659199773, 'psi': 0.8608448225245148}-{'f1_val': 0.8612771191199944, 'auprc': 0.9894557734961105, 'loss_val': 0.14073138938067764, 'psi': 0.9125485808704408}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=20 head_norm_before_train=1.555781 cos_to_last_merge=0.8259 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.826
[S16] round=20 local utility u=0.000000 metrics={'f1_val': 0.9175022471651475, 'auprc': 0.9959575029163462, 'loss_val': 0.29827649313756877, 'psi': 0.9488843494656269}-{'f1_val': 0.9392423256823085, 'auprc': 0.993921524722146, 'loss_val': 0.2028963631614025, 'psi': 0.9611140052982435}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=20 head_norm_before_train=1.110875 cos_to_last_merge=0.9782 (last merge round=15)
[S17] round=20 local utility u=0.000000 metrics={'f1_val': 0.36365001565906097, 'auprc': 0.8097818221609147, 'loss_val': 1.060054819147289, 'psi': 0.5421027382598025}-{'f1_val': 0.3649475941840351, 'auprc': 0.8115905025185401, 'loss_val': 1.0021501658082665, 'psi': 0.5436047575178371}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=21 head_norm_before_train=1.560022 cos_to_last_merge=0.8004 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.800
[S2] round=21 local utility u=0.000000 metrics={'f1_val': 0.6998661722620363, 'auprc': 0.6614707148156707, 'loss_val': 0.34174871749793917, 'psi': 0.68450798928349}-{'f1_val': 0.699327367306577, 'auprc': 0.66096359588387, 'loss_val': 0.3281876260104991, 'psi': 0.6839818587374942}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=21 head_norm_before_train=1.972646 (no previous merge yet)
[S3] round=21 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9987802920112145, 'loss_val': 0.11360312062104819, 'psi': 0.9761812711451773}-{'f1_val': 0.9947523743726271, 'auprc': 0.9987770611472323, 'loss_val': 0.05210910313239002, 'psi': 0.9963622490824692}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=21 head_norm_before_train=1.349497 cos_to_last_merge=0.9543 (last merge round=11)
[S4] round=21 local utility u=0.042448 metrics={'f1_val': 0.9547471514100144, 'auprc': 0.9816265611927618, 'loss_val': 0.2635843663328912, 'psi': 0.9654989153231134}-{'f1_val': 0.9518500158832524, 'auprc': 0.9693269649642973, 'loss_val': 0.29419916931220313, 'psi': 0.9588407955156704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=21 head_norm_before_train=1.180158 cos_to_last_merge=0.9002 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.900
[S5] round=21 local utility u=0.000000 metrics={'f1_val': 0.5803598065039004, 'auprc': 0.83605262366107, 'loss_val': 0.5669346488011073, 'psi': 0.6826369333667682}-{'f1_val': 0.700320598491359, 'auprc': 0.8574364390320556, 'loss_val': 0.32785986233161557, 'psi': 0.7631669347076376}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=21 head_norm_before_train=1.442819 cos_to_last_merge=0.9749 (last merge round=11)
[S6] round=21 local utility u=1.000000 metrics={'f1_val': 0.9534543371058957, 'auprc': 0.9541219921778235, 'loss_val': 0.31480673847866775, 'psi': 0.9537213991346668}-{'f1_val': 0.6416523152554378, 'auprc': 0.7941861410961736, 'loss_val': 0.44236709807566776, 'psi': 0.7026658455917321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=21 head_norm_before_train=1.452796 cos_to_last_merge=0.8114 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.811
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6133896780183143, 'auprc': 0.7959517814945972, 'loss_val': 0.5900771270879528, 'psi': 0.6864145194088275}-{'f1_val': 0.6952677275534271, 'auprc': 0.9091981438913541, 'loss_val': 0.2745364145931598, 'psi': 0.7808398940885979}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=21 head_norm_before_train=1.766466 (no previous merge yet)
[S8] round=21 local utility u=0.029898 metrics={'f1_val': 0.9937709050739206, 'auprc': 0.9991657409562327, 'loss_val': 0.05249691720412288, 'psi': 0.9959288394268454}-{'f1_val': 0.9908197349150198, 'auprc': 0.999081251663883, 'loss_val': 0.09433198793464874, 'psi': 0.9941243416145651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=21 head_norm_before_train=1.815723 cos_to_last_merge=0.9707 (last merge round=11)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9951655063899485, 'auprc': 0.9985364943018544, 'loss_val': 0.029908450431809164, 'psi': 0.9965139015547109}-{'f1_val': 0.9966605118138915, 'auprc': 0.9959993108926616, 'loss_val': 0.030011417758399713, 'psi': 0.9963960314453995}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=21 head_norm_before_train=1.343065 cos_to_last_merge=0.9869 (last merge round=16)
[S10] round=21 local utility u=0.000000 metrics={'f1_val': 0.9939399217230747, 'auprc': 0.9879095777992557, 'loss_val': 0.15825653887101454, 'psi': 0.9915277841535471}-{'f1_val': 0.9933750578586366, 'auprc': 0.9965040391412034, 'loss_val': 0.1396038927059055, 'psi': 0.9946266503716632}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=21 head_norm_before_train=1.808730 cos_to_last_merge=0.9836 (last merge round=11)
[S11] round=21 local utility u=0.057066 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978922450089297, 'loss_val': 0.10217069914408627, 'psi': 0.9970851007117256}-{'f1_val': 0.9807062211936182, 'auprc': 0.9980188738757586, 'loss_val': 0.12163785233876222, 'psi': 0.9876312822664743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=21 head_norm_before_train=1.629978 (no previous merge yet)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.6262926375170741, 'auprc': 0.7307496266804095, 'loss_val': 0.6188184343429562, 'psi': 0.6680754331824084}-{'f1_val': 0.6184384985415269, 'auprc': 0.8111700927274594, 'loss_val': 0.6682027095670972, 'psi': 0.6955311362159}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=21 head_norm_before_train=1.828093 cos_to_last_merge=0.9938 (last merge round=15)
[S14] round=21 local utility u=0.003606 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9974475737097797, 'loss_val': 0.043374843684173416, 'psi': 0.997177534378511}-{'f1_val': 0.9967999159800798, 'auprc': 0.9974344528752574, 'loss_val': 0.0493619368612785, 'psi': 0.9970537307381508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=21 head_norm_before_train=1.845656 (no previous merge yet)
[S15] round=21 local utility u=0.691160 metrics={'f1_val': 0.9850653998978838, 'auprc': 0.9876551036082651, 'loss_val': 0.10539072124723833, 'psi': 0.9861012813820362}-{'f1_val': 0.7763584414203107, 'auprc': 0.9875743941808208, 'loss_val': 0.23522739659199773, 'psi': 0.8608448225245148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=21 head_norm_before_train=1.589736 cos_to_last_merge=0.8212 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.821
[S16] round=21 local utility u=0.000000 metrics={'f1_val': 0.8682976005116306, 'auprc': 0.9961367331674102, 'loss_val': 0.48485579088919795, 'psi': 0.9194332535739425}-{'f1_val': 0.9175022471651475, 'auprc': 0.9959575029163462, 'loss_val': 0.29827649313756877, 'psi': 0.9488843494656269}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=21 head_norm_before_train=1.144489 cos_to_last_merge=0.9721 (last merge round=15)
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.3549275831262403, 'auprc': 0.7895299622716513, 'loss_val': 1.163079253410723, 'psi': 0.5287685347844047}-{'f1_val': 0.36365001565906097, 'auprc': 0.8097818221609147, 'loss_val': 1.060054819147289, 'psi': 0.5421027382598025}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=22 head_norm_before_train=1.582172 cos_to_last_merge=0.7959 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.796
[S2] round=22 local utility u=0.000000 metrics={'f1_val': 0.7133940315004181, 'auprc': 0.7772530772192502, 'loss_val': 0.8656165663973535, 'psi': 0.738937649787951}-{'f1_val': 0.6998661722620363, 'auprc': 0.6614707148156707, 'loss_val': 0.34174871749793917, 'psi': 0.68450798928349}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=22 head_norm_before_train=1.991479 (no previous merge yet)
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.7983350996385592, 'auprc': 0.9962555076948869, 'loss_val': 0.49690109181063713, 'psi': 0.8775032628610904}-{'f1_val': 0.9611152572344858, 'auprc': 0.9987802920112145, 'loss_val': 0.11360312062104819, 'psi': 0.9761812711451773}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.380818 cos_to_last_merge=0.9497 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.950
[S4] round=22 local utility u=0.004257 metrics={'f1_val': 0.9540572517628567, 'auprc': 0.9832948436329166, 'loss_val': 0.2559353379124307, 'psi': 0.9657522885108807}-{'f1_val': 0.9547471514100144, 'auprc': 0.9816265611927618, 'loss_val': 0.2635843663328912, 'psi': 0.9654989153231134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=22 head_norm_before_train=1.210150 cos_to_last_merge=0.8937 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.894
[S5] round=22 local utility u=0.000000 metrics={'f1_val': 0.42065082004288035, 'auprc': 0.7835688496084543, 'loss_val': 1.000418439562792, 'psi': 0.56581803186911}-{'f1_val': 0.5803598065039004, 'auprc': 0.83605262366107, 'loss_val': 0.5669346488011073, 'psi': 0.6826369333667682}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=22 head_norm_before_train=1.457793 cos_to_last_merge=0.9726 (last merge round=11)
[S6] round=22 local utility u=0.018944 metrics={'f1_val': 0.9502104587271539, 'auprc': 0.9585815112590941, 'loss_val': 0.27083453339411434, 'psi': 0.9535588797399299}-{'f1_val': 0.9534543371058957, 'auprc': 0.9541219921778235, 'loss_val': 0.31480673847866775, 'psi': 0.9537213991346668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=22 head_norm_before_train=1.462146 cos_to_last_merge=0.8088 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.809
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.497825735062165, 'auprc': 0.7802663004407164, 'loss_val': 0.862345780666701, 'psi': 0.6108019612135855}-{'f1_val': 0.6133896780183143, 'auprc': 0.7959517814945972, 'loss_val': 0.5900771270879528, 'psi': 0.6864145194088275}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=22 head_norm_before_train=1.791264 (no previous merge yet)
[S8] round=22 local utility u=0.004405 metrics={'f1_val': 0.9952032626987092, 'auprc': 0.9989697091780082, 'loss_val': 0.05169333154303765, 'psi': 0.9967098412904287}-{'f1_val': 0.9937709050739206, 'auprc': 0.9991657409562327, 'loss_val': 0.05249691720412288, 'psi': 0.9959288394268454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=22 head_norm_before_train=1.834821 cos_to_last_merge=0.9688 (last merge round=11)
[S9] round=22 local utility u=0.000000 metrics={'f1_val': 0.9939393793306803, 'auprc': 0.9985487425268473, 'loss_val': 0.03259904304239816, 'psi': 0.9957831246091472}-{'f1_val': 0.9951655063899485, 'auprc': 0.9985364943018544, 'loss_val': 0.029908450431809164, 'psi': 0.9965139015547109}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=22 head_norm_before_train=1.371622 cos_to_last_merge=0.9830 (last merge round=16)
[S10] round=22 local utility u=0.036958 metrics={'f1_val': 0.9941677348444804, 'auprc': 0.9963332861469114, 'loss_val': 0.1109794666488436, 'psi': 0.9950339553654528}-{'f1_val': 0.9939399217230747, 'auprc': 0.9879095777992557, 'loss_val': 0.15825653887101454, 'psi': 0.9915277841535471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=22 head_norm_before_train=1.831936 cos_to_last_merge=0.9815 (last merge round=11)
[S11] round=22 local utility u=0.003836 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973792333515284, 'loss_val': 0.09296044463458873, 'psi': 0.9968798960487651}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978922450089297, 'loss_val': 0.10217069914408627, 'psi': 0.9970851007117256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=22 head_norm_before_train=1.635689 (no previous merge yet)
[S13] round=22 local utility u=0.000000 metrics={'f1_val': 0.5786303220362261, 'auprc': 0.7730808608792412, 'loss_val': 0.8237314809312574, 'psi': 0.6564105375734322}-{'f1_val': 0.6262926375170741, 'auprc': 0.7307496266804095, 'loss_val': 0.6188184343429562, 'psi': 0.6680754331824084}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=22 head_norm_before_train=1.852030 cos_to_last_merge=0.9920 (last merge round=15)
[S14] round=22 local utility u=0.000000 metrics={'f1_val': 0.9849863067475871, 'auprc': 0.9970521907118365, 'loss_val': 0.057348241737770936, 'psi': 0.9898126603332869}-{'f1_val': 0.9969975081576651, 'auprc': 0.9974475737097797, 'loss_val': 0.043374843684173416, 'psi': 0.997177534378511}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=22 head_norm_before_train=1.863931 (no previous merge yet)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7009191843683342, 'auprc': 0.7994543763257214, 'loss_val': 0.5264229829421142, 'psi': 0.7403332611512892}-{'f1_val': 0.9850653998978838, 'auprc': 0.9876551036082651, 'loss_val': 0.10539072124723833, 'psi': 0.9861012813820362}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=1.622187 cos_to_last_merge=0.8172 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.817
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8552506933524608, 'auprc': 0.9958276382988352, 'loss_val': 0.5811854656685312, 'psi': 0.9114814713310107}-{'f1_val': 0.8682976005116306, 'auprc': 0.9961367331674102, 'loss_val': 0.48485579088919795, 'psi': 0.9194332535739425}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.176332 cos_to_last_merge=0.9669 (last merge round=15)
[S17] round=22 local utility u=0.000000 metrics={'f1_val': 0.14226059717904202, 'auprc': 0.6643944810723938, 'loss_val': 2.27614342413515, 'psi': 0.35111415073638275}-{'f1_val': 0.3549275831262403, 'auprc': 0.7895299622716513, 'loss_val': 1.163079253410723, 'psi': 0.5287685347844047}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=23 head_norm_before_train=1.602069 cos_to_last_merge=0.7938 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.794
[S2] round=23 local utility u=0.055690 metrics={'f1_val': 0.6996078256430083, 'auprc': 0.6629246554864686, 'loss_val': 0.32853465042543945, 'psi': 0.6849345575803925}-{'f1_val': 0.7133940315004181, 'auprc': 0.7772530772192502, 'loss_val': 0.8656165663973535, 'psi': 0.738937649787951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=23 head_norm_before_train=2.015383 (no previous merge yet)
[S3] round=23 local utility u=0.588356 metrics={'f1_val': 0.933219774554506, 'auprc': 0.9987072660758556, 'loss_val': 0.13685290034230754, 'psi': 0.9594147711630459}-{'f1_val': 0.7983350996385592, 'auprc': 0.9962555076948869, 'loss_val': 0.49690109181063713, 'psi': 0.8775032628610904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=23 head_norm_before_train=1.403006 cos_to_last_merge=0.9465 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.946
[S4] round=23 local utility u=0.000000 metrics={'f1_val': 0.9341996055794601, 'auprc': 0.9325606199768914, 'loss_val': 0.3077630724924317, 'psi': 0.9335440113384327}-{'f1_val': 0.9540572517628567, 'auprc': 0.9832948436329166, 'loss_val': 0.2559353379124307, 'psi': 0.9657522885108807}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=23 head_norm_before_train=1.237261 cos_to_last_merge=0.8883 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.888
[S5] round=23 local utility u=1.000000 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9893671844179597, 'loss_val': 0.2986738330114918, 'psi': 0.8159396642275321}-{'f1_val': 0.42065082004288035, 'auprc': 0.7835688496084543, 'loss_val': 1.000418439562792, 'psi': 0.56581803186911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=23 head_norm_before_train=1.472486 cos_to_last_merge=0.9703 (last merge round=11)
[S6] round=23 local utility u=0.000000 metrics={'f1_val': 0.6393881432954581, 'auprc': 0.7705430819762491, 'loss_val': 0.5266558512390569, 'psi': 0.6918501187677746}-{'f1_val': 0.9502104587271539, 'auprc': 0.9585815112590941, 'loss_val': 0.27083453339411434, 'psi': 0.9535588797399299}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=23 head_norm_before_train=1.474001 cos_to_last_merge=0.8048 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.805
[S7] round=23 local utility u=0.052599 metrics={'f1_val': 0.5122829394643207, 'auprc': 0.7817201405197174, 'loss_val': 0.8482527822507562, 'psi': 0.6200578198864795}-{'f1_val': 0.497825735062165, 'auprc': 0.7802663004407164, 'loss_val': 0.862345780666701, 'psi': 0.6108019612135855}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=23 head_norm_before_train=1.815903 (no previous merge yet)
[S8] round=23 local utility u=0.002845 metrics={'f1_val': 0.9948349509112366, 'auprc': 0.9989849738393186, 'loss_val': 0.04383923542590269, 'psi': 0.9964949600824694}-{'f1_val': 0.9952032626987092, 'auprc': 0.9989697091780082, 'loss_val': 0.05169333154303765, 'psi': 0.9967098412904287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=23 head_norm_before_train=1.853650 cos_to_last_merge=0.9670 (last merge round=11)
[S9] round=23 local utility u=0.010114 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9968800325741114, 'loss_val': 0.026345998623104137, 'psi': 0.9970137605369302}-{'f1_val': 0.9939393793306803, 'auprc': 0.9985487425268473, 'loss_val': 0.03259904304239816, 'psi': 0.9957831246091472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=23 head_norm_before_train=1.391232 cos_to_last_merge=0.9801 (last merge round=16)
[S10] round=23 local utility u=0.001641 metrics={'f1_val': 0.9935109650886941, 'auprc': 0.9964618961275006, 'loss_val': 0.10414262702480163, 'psi': 0.9946913375042167}-{'f1_val': 0.9941677348444804, 'auprc': 0.9963332861469114, 'loss_val': 0.1109794666488436, 'psi': 0.9950339553654528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=23 head_norm_before_train=1.853383 cos_to_last_merge=0.9796 (last merge round=11)
[S11] round=23 local utility u=0.011761 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981296376946366, 'loss_val': 0.07169010297854718, 'psi': 0.9971800577860084}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973792333515284, 'loss_val': 0.09296044463458873, 'psi': 0.9968798960487651}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=23 head_norm_before_train=1.640897 (no previous merge yet)
[S13] round=23 local utility u=0.458635 metrics={'f1_val': 0.6702348258218229, 'auprc': 0.7728435631914339, 'loss_val': 0.4553759413157686, 'psi': 0.7112783207696673}-{'f1_val': 0.5786303220362261, 'auprc': 0.7730808608792412, 'loss_val': 0.8237314809312574, 'psi': 0.6564105375734322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=23 head_norm_before_train=1.871076 cos_to_last_merge=0.9904 (last merge round=15)
[S14] round=23 local utility u=0.051173 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.999227944943267, 'loss_val': 0.03621259055339054, 'psi': 0.9981513600396628}-{'f1_val': 0.9849863067475871, 'auprc': 0.9970521907118365, 'loss_val': 0.057348241737770936, 'psi': 0.9898126603332869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=23 head_norm_before_train=1.878859 (no previous merge yet)
[S15] round=23 local utility u=1.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9976186287714374, 'loss_val': 0.04720648271075024, 'psi': 0.9970954525410873}-{'f1_val': 0.7009191843683342, 'auprc': 0.7994543763257214, 'loss_val': 0.5264229829421142, 'psi': 0.7403332611512892}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=23 head_norm_before_train=1.653185 cos_to_last_merge=0.8136 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.814
[S16] round=23 local utility u=0.378286 metrics={'f1_val': 0.9272007775131785, 'auprc': 0.9967667396697786, 'loss_val': 0.2591303968839677, 'psi': 0.9550271623758186}-{'f1_val': 0.8552506933524608, 'auprc': 0.9958276382988352, 'loss_val': 0.5811854656685312, 'psi': 0.9114814713310107}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=23 head_norm_before_train=1.202302 cos_to_last_merge=0.9620 (last merge round=15)
[S17] round=23 local utility u=1.000000 metrics={'f1_val': 0.2981910381718831, 'auprc': 0.7819914683578563, 'loss_val': 1.4043956901228807, 'psi': 0.4917112102462724}-{'f1_val': 0.14226059717904202, 'auprc': 0.6643944810723938, 'loss_val': 2.27614342413515, 'psi': 0.35111415073638275}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=24 head_norm_before_train=1.619134 cos_to_last_merge=0.7914 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.791
[S2] round=24 local utility u=0.000000 metrics={'f1_val': 0.678956170298796, 'auprc': 0.6519489627596289, 'loss_val': 0.4032096531170825, 'psi': 0.6681532872831291}-{'f1_val': 0.6996078256430083, 'auprc': 0.6629246554864686, 'loss_val': 0.32853465042543945, 'psi': 0.6849345575803925}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=24 head_norm_before_train=2.040445 (no previous merge yet)
[S3] round=24 local utility u=0.000000 metrics={'f1_val': 0.6915363298598123, 'auprc': 0.9625777987019082, 'loss_val': 0.7508578862379303, 'psi': 0.7999529173966506}-{'f1_val': 0.933219774554506, 'auprc': 0.9987072660758556, 'loss_val': 0.13685290034230754, 'psi': 0.9594147711630459}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=24 head_norm_before_train=1.424247 cos_to_last_merge=0.9434 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.943
[S4] round=24 local utility u=0.108717 metrics={'f1_val': 0.9489770327236206, 'auprc': 0.959796725677732, 'loss_val': 0.2607017246367303, 'psi': 0.9533049099052652}-{'f1_val': 0.9341996055794601, 'auprc': 0.9325606199768914, 'loss_val': 0.3077630724924317, 'psi': 0.9335440113384327}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=24 head_norm_before_train=1.254815 cos_to_last_merge=0.8844 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.884
[S5] round=24 local utility u=0.000000 metrics={'f1_val': 0.6516028802316225, 'auprc': 0.8377253308210535, 'loss_val': 0.40267593421319214, 'psi': 0.7260518604673949}-{'f1_val': 0.7003213174339138, 'auprc': 0.9893671844179597, 'loss_val': 0.2986738330114918, 'psi': 0.8159396642275321}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=24 head_norm_before_train=1.484814 cos_to_last_merge=0.9683 (last merge round=11)
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.613774152695035, 'auprc': 0.7600581210043815, 'loss_val': 0.47664329802350835, 'psi': 0.6722877400187737}-{'f1_val': 0.6393881432954581, 'auprc': 0.7705430819762491, 'loss_val': 0.5266558512390569, 'psi': 0.6918501187677746}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.483771 cos_to_last_merge=0.8031 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=24 local utility u=0.148426 metrics={'f1_val': 0.55754361361277, 'auprc': 0.7856315346844525, 'loss_val': 0.8346983950524183, 'psi': 0.648778782041443}-{'f1_val': 0.5122829394643207, 'auprc': 0.7817201405197174, 'loss_val': 0.8482527822507562, 'psi': 0.6200578198864795}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=24 head_norm_before_train=1.839085 (no previous merge yet)
[S8] round=24 local utility u=0.000000 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.999026677877827, 'loss_val': 0.045364577705512436, 'psi': 0.9951727934296745}-{'f1_val': 0.9948349509112366, 'auprc': 0.9989849738393186, 'loss_val': 0.04383923542590269, 'psi': 0.9964949600824694}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=24 head_norm_before_train=1.870139 cos_to_last_merge=0.9653 (last merge round=11)
[S9] round=24 local utility u=0.000000 metrics={'f1_val': 0.994356655862817, 'auprc': 0.9985423402066834, 'loss_val': 0.029148476683715004, 'psi': 0.9960309296003635}-{'f1_val': 0.9971029125121428, 'auprc': 0.9968800325741114, 'loss_val': 0.026345998623104137, 'psi': 0.9970137605369302}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=24 head_norm_before_train=1.412664 cos_to_last_merge=0.9774 (last merge round=16)
[S10] round=24 local utility u=0.004811 metrics={'f1_val': 0.9947486092193725, 'auprc': 0.9937384338666079, 'loss_val': 0.0937766339524158, 'psi': 0.9943445390782666}-{'f1_val': 0.9935109650886941, 'auprc': 0.9964618961275006, 'loss_val': 0.10414262702480163, 'psi': 0.9946913375042167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=24 head_norm_before_train=1.875477 cos_to_last_merge=0.9775 (last merge round=11)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9973024689855972, 'loss_val': 0.07978459796965397, 'psi': 0.9969942174998575}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981296376946366, 'loss_val': 0.07169010297854718, 'psi': 0.9971800577860084}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=24 head_norm_before_train=1.644342 (no previous merge yet)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.6190166558770994, 'auprc': 0.8335188155422248, 'loss_val': 0.6050935202042512, 'psi': 0.7048175197431497}-{'f1_val': 0.6702348258218229, 'auprc': 0.7728435631914339, 'loss_val': 0.4553759413157686, 'psi': 0.7112783207696673}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=24 head_norm_before_train=1.888595 cos_to_last_merge=0.9890 (last merge round=15)
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.997068988321415, 'loss_val': 0.034449031828570634, 'psi': 0.9974182661584782}-{'f1_val': 0.9974336367705932, 'auprc': 0.999227944943267, 'loss_val': 0.03621259055339054, 'psi': 0.9981513600396628}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.891104 (no previous merge yet)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7727050911592781, 'auprc': 0.9654274500361533, 'loss_val': 0.32646009619389765, 'psi': 0.8497940347100281}-{'f1_val': 0.9967466683875206, 'auprc': 0.9976186287714374, 'loss_val': 0.04720648271075024, 'psi': 0.9970954525410873}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.681627 cos_to_last_merge=0.8105 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.810
[S16] round=24 local utility u=0.291917 metrics={'f1_val': 0.9919819197308503, 'auprc': 0.9945781228187391, 'loss_val': 0.057417006934966305, 'psi': 0.9930204009660059}-{'f1_val': 0.9272007775131785, 'auprc': 0.9967667396697786, 'loss_val': 0.2591303968839677, 'psi': 0.9550271623758186}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=24 head_norm_before_train=1.224602 cos_to_last_merge=0.9578 (last merge round=15)
[S17] round=24 local utility u=0.528939 metrics={'f1_val': 0.38848633350038075, 'auprc': 0.8213755942795614, 'loss_val': 1.0064412456075091, 'psi': 0.561642037812053}-{'f1_val': 0.2981910381718831, 'auprc': 0.7819914683578563, 'loss_val': 1.4043956901228807, 'psi': 0.4917112102462724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=25 head_norm_before_train=1.634917 cos_to_last_merge=0.7891 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.789
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.5881709047732512, 'auprc': 0.6225652217650052, 'loss_val': 0.7786578584674156, 'psi': 0.6019286315699528}-{'f1_val': 0.678956170298796, 'auprc': 0.6519489627596289, 'loss_val': 0.4032096531170825, 'psi': 0.6681532872831291}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=25 head_norm_before_train=2.062724 (no previous merge yet)
[S3] round=25 local utility u=1.000000 metrics={'f1_val': 0.9388396087070392, 'auprc': 0.9986156521362768, 'loss_val': 0.1333671865311139, 'psi': 0.9627500260787343}-{'f1_val': 0.6915363298598123, 'auprc': 0.9625777987019082, 'loss_val': 0.7508578862379303, 'psi': 0.7999529173966506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=25 head_norm_before_train=1.444902 cos_to_last_merge=0.9402 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.940
[S4] round=25 local utility u=0.051521 metrics={'f1_val': 0.9523604988493886, 'auprc': 0.9827047285263336, 'loss_val': 0.24668507402217812, 'psi': 0.9644981907201666}-{'f1_val': 0.9489770327236206, 'auprc': 0.959796725677732, 'loss_val': 0.2607017246367303, 'psi': 0.9533049099052652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=25 head_norm_before_train=1.271505 cos_to_last_merge=0.8801 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.880
[S5] round=25 local utility u=0.000000 metrics={'f1_val': 0.42938515393977567, 'auprc': 0.8250362731338765, 'loss_val': 0.8139970696948707, 'psi': 0.5876456016174161}-{'f1_val': 0.6516028802316225, 'auprc': 0.8377253308210535, 'loss_val': 0.40267593421319214, 'psi': 0.7260518604673949}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=25 head_norm_before_train=1.497146 cos_to_last_merge=0.9661 (last merge round=11)
[S6] round=25 local utility u=1.000000 metrics={'f1_val': 0.9602311247363948, 'auprc': 0.9601682928734624, 'loss_val': 0.2677008295565522, 'psi': 0.9602059919912218}-{'f1_val': 0.613774152695035, 'auprc': 0.7600581210043815, 'loss_val': 0.47664329802350835, 'psi': 0.6722877400187737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=25 head_norm_before_train=1.491936 cos_to_last_merge=0.8039 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.804
[S7] round=25 local utility u=0.212542 metrics={'f1_val': 0.5994493209076808, 'auprc': 0.7925460243129252, 'loss_val': 0.6817926843423927, 'psi': 0.6766880022697785}-{'f1_val': 0.55754361361277, 'auprc': 0.7856315346844525, 'loss_val': 0.8346983950524183, 'psi': 0.648778782041443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=25 head_norm_before_train=1.861132 (no previous merge yet)
[S8] round=25 local utility u=0.004369 metrics={'f1_val': 0.9933593890417576, 'auprc': 0.998818112340444, 'loss_val': 0.040536213305192505, 'psi': 0.9955428783612321}-{'f1_val': 0.9926035371309061, 'auprc': 0.999026677877827, 'loss_val': 0.045364577705512436, 'psi': 0.9951727934296745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=25 head_norm_before_train=1.884910 cos_to_last_merge=0.9638 (last merge round=11)
[S9] round=25 local utility u=0.001112 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9942578638303751, 'loss_val': 0.025430749601597347, 'psi': 0.9954532023997166}-{'f1_val': 0.994356655862817, 'auprc': 0.9985423402066834, 'loss_val': 0.029148476683715004, 'psi': 0.9960309296003635}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=25 head_norm_before_train=1.433015 cos_to_last_merge=0.9749 (last merge round=16)
[S10] round=25 local utility u=0.001235 metrics={'f1_val': 0.9949140915418154, 'auprc': 0.9926020657316065, 'loss_val': 0.08889105004083042, 'psi': 0.9939892812177318}-{'f1_val': 0.9947486092193725, 'auprc': 0.9937384338666079, 'loss_val': 0.0937766339524158, 'psi': 0.9943445390782666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=25 head_norm_before_train=1.897343 cos_to_last_merge=0.9753 (last merge round=11)
[S11] round=25 local utility u=0.006796 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9977895729967097, 'loss_val': 0.06765300441594443, 'psi': 0.9971890591043024}-{'f1_val': 0.9967887165093644, 'auprc': 0.9973024689855972, 'loss_val': 0.07978459796965397, 'psi': 0.9969942174998575}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=25 head_norm_before_train=1.647831 (no previous merge yet)
[S13] round=25 local utility u=0.000000 metrics={'f1_val': 0.5794571782024933, 'auprc': 0.8125368354562814, 'loss_val': 0.7957559723960848, 'psi': 0.6726890411040085}-{'f1_val': 0.6190166558770994, 'auprc': 0.8335188155422248, 'loss_val': 0.6050935202042512, 'psi': 0.7048175197431497}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=25 head_norm_before_train=1.905862 cos_to_last_merge=0.9876 (last merge round=15)
[S14] round=25 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9971144343710097, 'loss_val': 0.034255140555641786, 'psi': 0.997144949547059}-{'f1_val': 0.9976511180498535, 'auprc': 0.997068988321415, 'loss_val': 0.034449031828570634, 'psi': 0.9974182661584782}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=25 head_norm_before_train=1.905860 (no previous merge yet)
[S15] round=25 local utility u=0.857589 metrics={'f1_val': 0.9962895101731264, 'auprc': 0.997356969726701, 'loss_val': 0.04857773318457725, 'psi': 0.9967164939945562}-{'f1_val': 0.7727050911592781, 'auprc': 0.9654274500361533, 'loss_val': 0.32646009619389765, 'psi': 0.8497940347100281}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=25 head_norm_before_train=1.707509 cos_to_last_merge=0.8081 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.808
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.940932382678831, 'auprc': 0.9958658996142982, 'loss_val': 0.13845955298250953, 'psi': 0.9629057894530179}-{'f1_val': 0.9919819197308503, 'auprc': 0.9945781228187391, 'loss_val': 0.057417006934966305, 'psi': 0.9930204009660059}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.249563 cos_to_last_merge=0.9533 (last merge round=15)
[S17] round=25 local utility u=0.000000 metrics={'f1_val': 0.3776728944180653, 'auprc': 0.8233637924593606, 'loss_val': 1.0272981659864062, 'psi': 0.5559492536345834}-{'f1_val': 0.38848633350038075, 'auprc': 0.8213755942795614, 'loss_val': 1.0064412456075091, 'psi': 0.561642037812053}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=26 head_norm_before_train=1.646919 cos_to_last_merge=0.7869 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.787
[S2] round=26 local utility u=0.616705 metrics={'f1_val': 0.6998661722620363, 'auprc': 0.6628039634979207, 'loss_val': 0.33613572861637053, 'psi': 0.6850412887563901}-{'f1_val': 0.5881709047732512, 'auprc': 0.6225652217650052, 'loss_val': 0.7786578584674156, 'psi': 0.6019286315699528}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=26 head_norm_before_train=2.083224 (no previous merge yet)
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.8256077189439606, 'auprc': 0.9983875372159488, 'loss_val': 0.41302016113903156, 'psi': 0.8947196462527558}-{'f1_val': 0.9388396087070392, 'auprc': 0.9986156521362768, 'loss_val': 0.1333671865311139, 'psi': 0.9627500260787343}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.461285 cos_to_last_merge=0.9375 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.938
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.947110911943833, 'auprc': 0.9800458919321792, 'loss_val': 0.2585193565967223, 'psi': 0.9602849039391714}-{'f1_val': 0.9523604988493886, 'auprc': 0.9827047285263336, 'loss_val': 0.24668507402217812, 'psi': 0.9644981907201666}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.287905 cos_to_last_merge=0.8771 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.877
[S5] round=26 local utility u=0.032133 metrics={'f1_val': 0.43168803910642595, 'auprc': 0.8408492859560188, 'loss_val': 0.8109870992109504, 'psi': 0.5953525378462632}-{'f1_val': 0.42938515393977567, 'auprc': 0.8250362731338765, 'loss_val': 0.8139970696948707, 'psi': 0.5876456016174161}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S5] sending update (kind=head size=1806 to 1 peers)
[S6] START round=26 head_norm_before_train=1.510545 cos_to_last_merge=0.9640 (last merge round=11)
[S6] round=26 local utility u=0.000000 metrics={'f1_val': 0.5568795890052478, 'auprc': 0.7824979424239181, 'loss_val': 0.5326130905597153, 'psi': 0.6471269303727158}-{'f1_val': 0.9602311247363948, 'auprc': 0.9601682928734624, 'loss_val': 0.2677008295565522, 'psi': 0.9602059919912218}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=26 head_norm_before_train=1.500400 cos_to_last_merge=0.8034 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.803
[S7] round=26 local utility u=0.197581 metrics={'f1_val': 0.6239996540973682, 'auprc': 0.8023609209807818, 'loss_val': 0.46337676896234575, 'psi': 0.6953441608507337}-{'f1_val': 0.5994493209076808, 'auprc': 0.7925460243129252, 'loss_val': 0.6817926843423927, 'psi': 0.6766880022697785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=26 head_norm_before_train=1.879350 (no previous merge yet)
[S8] round=26 local utility u=0.000000 metrics={'f1_val': 0.9859044523533361, 'auprc': 0.9860777270118375, 'loss_val': 0.08286797159397839, 'psi': 0.9859737622167367}-{'f1_val': 0.9933593890417576, 'auprc': 0.998818112340444, 'loss_val': 0.040536213305192505, 'psi': 0.9955428783612321}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=26 head_norm_before_train=1.899251 cos_to_last_merge=0.9625 (last merge round=11)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.992904783397339, 'auprc': 0.9981333610041223, 'loss_val': 0.03125435837541434, 'psi': 0.9949962144400524}-{'f1_val': 0.9962500947792776, 'auprc': 0.9942578638303751, 'loss_val': 0.025430749601597347, 'psi': 0.9954532023997166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.456122 cos_to_last_merge=0.9721 (last merge round=16)
[S10] round=26 local utility u=0.009557 metrics={'f1_val': 0.9948674007110037, 'auprc': 0.9942696231214964, 'loss_val': 0.07449912864767808, 'psi': 0.9946282896752008}-{'f1_val': 0.9949140915418154, 'auprc': 0.9926020657316065, 'loss_val': 0.08889105004083042, 'psi': 0.9939892812177318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=26 head_norm_before_train=1.918679 cos_to_last_merge=0.9732 (last merge round=11)
[S11] round=26 local utility u=0.000906 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9977982862259331, 'loss_val': 0.06441686312108877, 'psi': 0.997047517198527}-{'f1_val': 0.9967887165093644, 'auprc': 0.9977895729967097, 'loss_val': 0.06765300441594443, 'psi': 0.9971890591043024}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] START round=26 head_norm_before_train=1.658300 (no previous merge yet)
[S13] round=26 local utility u=0.241609 metrics={'f1_val': 0.6439606219644503, 'auprc': 0.7429139134836822, 'loss_val': 0.4906902737809935, 'psi': 0.6835419385721431}-{'f1_val': 0.5794571782024933, 'auprc': 0.8125368354562814, 'loss_val': 0.7957559723960848, 'psi': 0.6726890411040085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=26 head_norm_before_train=1.921284 cos_to_last_merge=0.9862 (last merge round=15)
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9450660570844742, 'auprc': 0.9970916216578583, 'loss_val': 0.07834670285225441, 'psi': 0.9658762829138279}-{'f1_val': 0.9971652929977585, 'auprc': 0.9971144343710097, 'loss_val': 0.034255140555641786, 'psi': 0.997144949547059}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.923681 (no previous merge yet)
[S15] round=26 local utility u=0.000000 metrics={'f1_val': 0.8678018231570414, 'auprc': 0.9950951813836388, 'loss_val': 0.18566284927201415, 'psi': 0.9187191664476804}-{'f1_val': 0.9962895101731264, 'auprc': 0.997356969726701, 'loss_val': 0.04857773318457725, 'psi': 0.9967164939945562}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=26 head_norm_before_train=1.731062 cos_to_last_merge=0.8059 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.806
[S16] round=26 local utility u=0.000000 metrics={'f1_val': 0.9148950643871896, 'auprc': 0.9954565996012869, 'loss_val': 0.3754047842196959, 'psi': 0.9471196784728284}-{'f1_val': 0.940932382678831, 'auprc': 0.9958658996142982, 'loss_val': 0.13845955298250953, 'psi': 0.9629057894530179}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=26 head_norm_before_train=1.274619 cos_to_last_merge=0.9489 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.949
[S17] round=26 local utility u=0.071078 metrics={'f1_val': 0.39101766458556997, 'auprc': 0.8259735055194406, 'loss_val': 0.97303978940727, 'psi': 0.5650000009591182}-{'f1_val': 0.3776728944180653, 'auprc': 0.8233637924593606, 'loss_val': 1.0272981659864062, 'psi': 0.5559492536345834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=27 head_norm_before_train=1.659700 cos_to_last_merge=0.7857 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.786
[S2] round=27 local utility u=0.047364 metrics={'f1_val': 0.7065750383620106, 'auprc': 0.7755532112490214, 'loss_val': 0.6199085707027895, 'psi': 0.734166307516815}-{'f1_val': 0.6998661722620363, 'auprc': 0.6628039634979207, 'loss_val': 0.33613572861637053, 'psi': 0.6850412887563901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=27 head_norm_before_train=2.100742 (no previous merge yet)
[S3] round=27 local utility u=0.658467 metrics={'f1_val': 0.9833168046634339, 'auprc': 0.9997635613657476, 'loss_val': 0.04646800188921068, 'psi': 0.9898955073443594}-{'f1_val': 0.8256077189439606, 'auprc': 0.9983875372159488, 'loss_val': 0.41302016113903156, 'psi': 0.8947196462527558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=27 head_norm_before_train=1.478256 cos_to_last_merge=0.9350 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.935
[S4] round=27 local utility u=0.000000 metrics={'f1_val': 0.9472185491418368, 'auprc': 0.9568876648984725, 'loss_val': 0.2633567191368379, 'psi': 0.951086195444491}-{'f1_val': 0.947110911943833, 'auprc': 0.9800458919321792, 'loss_val': 0.2585193565967223, 'psi': 0.9602849039391714}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=27 head_norm_before_train=1.299523 cos_to_last_merge=0.8749 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.875
[S5] round=27 local utility u=0.919081 metrics={'f1_val': 0.660508174321238, 'auprc': 0.8555708971776816, 'loss_val': 0.38991011825106503, 'psi': 0.7385332634638154}-{'f1_val': 0.43168803910642595, 'auprc': 0.8408492859560188, 'loss_val': 0.8109870992109504, 'psi': 0.5953525378462632}
[S5] not sending this round → trigger blocked (psi=0.739)
[S6] START round=27 head_norm_before_train=1.523346 cos_to_last_merge=0.9612 (last merge round=11)
[S6] round=27 local utility u=1.000000 metrics={'f1_val': 0.8217477339851458, 'auprc': 0.9472750409295592, 'loss_val': 0.3656869200629629, 'psi': 0.8719586567629112}-{'f1_val': 0.5568795890052478, 'auprc': 0.7824979424239181, 'loss_val': 0.5326130905597153, 'psi': 0.6471269303727158}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=27 head_norm_before_train=1.512165 cos_to_last_merge=0.8013 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.801
[S7] round=27 local utility u=0.266091 metrics={'f1_val': 0.6761344877220472, 'auprc': 0.8345642571603369, 'loss_val': 0.3406143139886621, 'psi': 0.7395063954973631}-{'f1_val': 0.6239996540973682, 'auprc': 0.8023609209807818, 'loss_val': 0.46337676896234575, 'psi': 0.6953441608507337}
[S7] not sending this round → trigger blocked (psi=0.740)
[S8] START round=27 head_norm_before_train=1.893398 (no previous merge yet)
[S8] round=27 local utility u=0.058063 metrics={'f1_val': 0.9919185654646655, 'auprc': 0.9988668472263492, 'loss_val': 0.041194154141024335, 'psi': 0.994697878169339}-{'f1_val': 0.9859044523533361, 'auprc': 0.9860777270118375, 'loss_val': 0.08286797159397839, 'psi': 0.9859737622167367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=27 head_norm_before_train=1.912275 cos_to_last_merge=0.9612 (last merge round=11)
[S9] round=27 local utility u=0.011574 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9958159432844566, 'loss_val': 0.023689204418562468, 'psi': 0.9963226844021175}-{'f1_val': 0.992904783397339, 'auprc': 0.9981333610041223, 'loss_val': 0.03125435837541434, 'psi': 0.9949962144400524}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=27 head_norm_before_train=1.483892 cos_to_last_merge=0.9687 (last merge round=16)
[S10] round=27 local utility u=0.002025 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9932651408698918, 'loss_val': 0.06490077916613098, 'psi': 0.9939730326657508}-{'f1_val': 0.9948674007110037, 'auprc': 0.9942696231214964, 'loss_val': 0.07449912864767808, 'psi': 0.9946282896752008}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=27 head_norm_before_train=1.940935 cos_to_last_merge=0.9709 (last merge round=11)
[S11] round=27 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.996396123919745, 'loss_val': 0.07754066720388432, 'psi': 0.9963836817133485}-{'f1_val': 0.9965470045135896, 'auprc': 0.9977982862259331, 'loss_val': 0.06441686312108877, 'psi': 0.997047517198527}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=27 head_norm_before_train=1.669282 (no previous merge yet)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.6173571719392391, 'auprc': 0.6983809262368965, 'loss_val': 0.6694213885649571, 'psi': 0.6497666736583021}-{'f1_val': 0.6439606219644503, 'auprc': 0.7429139134836822, 'loss_val': 0.4906902737809935, 'psi': 0.6835419385721431}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=27 head_norm_before_train=1.931560 cos_to_last_merge=0.9852 (last merge round=15)
[S14] round=27 local utility u=0.184098 metrics={'f1_val': 0.9972131247180673, 'auprc': 0.9992249579053287, 'loss_val': 0.029433035094586158, 'psi': 0.9980178579929719}-{'f1_val': 0.9450660570844742, 'auprc': 0.9970916216578583, 'loss_val': 0.07834670285225441, 'psi': 0.9658762829138279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=27 head_norm_before_train=1.941394 (no previous merge yet)
[S15] round=27 local utility u=0.000000 metrics={'f1_val': 0.8299379830753051, 'auprc': 0.9953173580777548, 'loss_val': 0.22971854373329864, 'psi': 0.8960897330762849}-{'f1_val': 0.8678018231570414, 'auprc': 0.9950951813836388, 'loss_val': 0.18566284927201415, 'psi': 0.9187191664476804}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=27 head_norm_before_train=1.748845 cos_to_last_merge=0.8041 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.804
[S16] round=27 local utility u=0.000000 metrics={'f1_val': 0.9050590896194569, 'auprc': 0.9953031544443955, 'loss_val': 0.41142249373671, 'psi': 0.9411567155494325}-{'f1_val': 0.9148950643871896, 'auprc': 0.9954565996012869, 'loss_val': 0.3754047842196959, 'psi': 0.9471196784728284}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=27 head_norm_before_train=1.296712 cos_to_last_merge=0.9449 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.945
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.38392012872688286, 'auprc': 0.8215704224501637, 'loss_val': 1.0306059484785837, 'psi': 0.5589802462161952}-{'f1_val': 0.39101766458556997, 'auprc': 0.8259735055194406, 'loss_val': 0.97303978940727, 'psi': 0.5650000009591182}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=28 head_norm_before_train=1.673284 cos_to_last_merge=0.7846 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.785
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.7124087339225222, 'auprc': 0.7774308830131028, 'loss_val': 0.800009357385727, 'psi': 0.7384175935587545}-{'f1_val': 0.7065750383620106, 'auprc': 0.7755532112490214, 'loss_val': 0.6199085707027895, 'psi': 0.734166307516815}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=28 head_norm_before_train=2.118783 (no previous merge yet)
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.8922272663513136, 'auprc': 0.9975181514205063, 'loss_val': 0.22911523995229996, 'psi': 0.9343436203789905}-{'f1_val': 0.9833168046634339, 'auprc': 0.9997635613657476, 'loss_val': 0.04646800188921068, 'psi': 0.9898955073443594}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.496035 cos_to_last_merge=0.9326 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.933
[S4] round=28 local utility u=0.065254 metrics={'f1_val': 0.9534420619854682, 'auprc': 0.9827525115572797, 'loss_val': 0.2477835471565912, 'psi': 0.9651662418141929}-{'f1_val': 0.9472185491418368, 'auprc': 0.9568876648984725, 'loss_val': 0.2633567191368379, 'psi': 0.951086195444491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=28 head_norm_before_train=1.309690 cos_to_last_merge=0.8728 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.873
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.6260932817627646, 'auprc': 0.839113475227941, 'loss_val': 0.4741744452599835, 'psi': 0.7113013591488352}-{'f1_val': 0.660508174321238, 'auprc': 0.8555708971776816, 'loss_val': 0.38991011825106503, 'psi': 0.7385332634638154}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.535592 cos_to_last_merge=0.9587 (last merge round=11)
[S6] round=28 local utility u=0.000000 metrics={'f1_val': 0.6409344119145306, 'auprc': 0.8022411651875525, 'loss_val': 0.4887042272341696, 'psi': 0.7054571132237394}-{'f1_val': 0.8217477339851458, 'auprc': 0.9472750409295592, 'loss_val': 0.3656869200629629, 'psi': 0.8719586567629112}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=28 head_norm_before_train=1.523031 cos_to_last_merge=0.8008 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.801
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.6525865280876888, 'auprc': 0.8043567178162764, 'loss_val': 0.49209286281194253, 'psi': 0.7132946039791238}-{'f1_val': 0.6761344877220472, 'auprc': 0.8345642571603369, 'loss_val': 0.3406143139886621, 'psi': 0.7395063954973631}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.909238 (no previous merge yet)
[S8] round=28 local utility u=0.002949 metrics={'f1_val': 0.9924309654389881, 'auprc': 0.9988503122340027, 'loss_val': 0.03832137623785165, 'psi': 0.9949987041569939}-{'f1_val': 0.9919185654646655, 'auprc': 0.9988668472263492, 'loss_val': 0.041194154141024335, 'psi': 0.994697878169339}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=28 head_norm_before_train=1.918767 cos_to_last_merge=0.9603 (last merge round=11)
[S9] round=28 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9981241613538848, 'loss_val': 0.025840197518667785, 'psi': 0.9959961732371208}-{'f1_val': 0.9966605118138915, 'auprc': 0.9958159432844566, 'loss_val': 0.023689204418562468, 'psi': 0.9963226844021175}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=28 head_norm_before_train=1.515572 cos_to_last_merge=0.9649 (last merge round=16)
[S10] round=28 local utility u=0.002912 metrics={'f1_val': 0.9948838907637279, 'auprc': 0.9921260243208058, 'loss_val': 0.05829316714942949, 'psi': 0.993780744186559}-{'f1_val': 0.9944449605296568, 'auprc': 0.9932651408698918, 'loss_val': 0.06490077916613098, 'psi': 0.9939730326657508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=28 head_norm_before_train=1.961063 cos_to_last_merge=0.9688 (last merge round=11)
[S11] round=28 local utility u=0.014321 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9978225894350737, 'loss_val': 0.05420833467304983, 'psi': 0.9970572384821832}-{'f1_val': 0.9963753869090841, 'auprc': 0.996396123919745, 'loss_val': 0.07754066720388432, 'psi': 0.9963836817133485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=28 head_norm_before_train=1.677904 (no previous merge yet)
[S13] round=28 local utility u=0.051657 metrics={'f1_val': 0.5914857642208784, 'auprc': 0.8142859909615309, 'loss_val': 0.7585942183587577, 'psi': 0.6806058549171394}-{'f1_val': 0.6173571719392391, 'auprc': 0.6983809262368965, 'loss_val': 0.6694213885649571, 'psi': 0.6497666736583021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=28 head_norm_before_train=1.943049 cos_to_last_merge=0.9841 (last merge round=15)
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.976498213504243, 'auprc': 0.9972093193557949, 'loss_val': 0.06897663472355124, 'psi': 0.9847826558448638}-{'f1_val': 0.9972131247180673, 'auprc': 0.9992249579053287, 'loss_val': 0.029433035094586158, 'psi': 0.9980178579929719}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.961491 (no previous merge yet)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7711143008293998, 'auprc': 0.9651222409532074, 'loss_val': 0.35511101878686574, 'psi': 0.8487174768789228}-{'f1_val': 0.8299379830753051, 'auprc': 0.9953173580777548, 'loss_val': 0.22971854373329864, 'psi': 0.8960897330762849}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.763964 cos_to_last_merge=0.8026 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.803
[S16] round=28 local utility u=0.446057 metrics={'f1_val': 0.991963306697354, 'auprc': 0.9969392879691374, 'loss_val': 0.04564135981313475, 'psi': 0.9939536992060674}-{'f1_val': 0.9050590896194569, 'auprc': 0.9953031544443955, 'loss_val': 0.41142249373671, 'psi': 0.9411567155494325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=28 head_norm_before_train=1.319651 cos_to_last_merge=0.9411 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.941
[S17] round=28 local utility u=0.822456 metrics={'f1_val': 0.6437488911320002, 'auprc': 0.8223962875955348, 'loss_val': 0.9471435898328572, 'psi': 0.715207849717414}-{'f1_val': 0.38392012872688286, 'auprc': 0.8215704224501637, 'loss_val': 1.0306059484785837, 'psi': 0.5589802462161952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=29 head_norm_before_train=1.686503 cos_to_last_merge=0.7833 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=29 local utility u=0.000000 metrics={'f1_val': 0.7129666496087969, 'auprc': 0.7791652764573486, 'loss_val': 0.9217853474310028, 'psi': 0.7394461003482176}-{'f1_val': 0.7124087339225222, 'auprc': 0.7774308830131028, 'loss_val': 0.800009357385727, 'psi': 0.7384175935587545}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=29 head_norm_before_train=2.136591 (no previous merge yet)
[S3] round=29 local utility u=0.005885 metrics={'f1_val': 0.8952955439117338, 'auprc': 0.998328613435063, 'loss_val': 0.238185993051729, 'psi': 0.9365087717210655}-{'f1_val': 0.8922272663513136, 'auprc': 0.9975181514205063, 'loss_val': 0.22911523995229996, 'psi': 0.9343436203789905}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=29 head_norm_before_train=1.510085 cos_to_last_merge=0.9306 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.931
[S4] round=29 local utility u=0.009960 metrics={'f1_val': 0.9544692243942928, 'auprc': 0.9838100389842841, 'loss_val': 0.23719941104313372, 'psi': 0.9662055502302893}-{'f1_val': 0.9534420619854682, 'auprc': 0.9827525115572797, 'loss_val': 0.2477835471565912, 'psi': 0.9651662418141929}
[S4] not sending this round → trigger blocked (psi=0.966)
[S5] START round=29 head_norm_before_train=1.321393 cos_to_last_merge=0.8706 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.871
[S5] round=29 local utility u=0.573752 metrics={'f1_val': 0.700320598491359, 'auprc': 0.9911959256161276, 'loss_val': 0.22828084067300786, 'psi': 0.8166707293412665}-{'f1_val': 0.6260932817627646, 'auprc': 0.839113475227941, 'loss_val': 0.4741744452599835, 'psi': 0.7113013591488352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=29 head_norm_before_train=1.547544 cos_to_last_merge=0.9564 (last merge round=11)
[S6] round=29 local utility u=1.000000 metrics={'f1_val': 0.922951362645528, 'auprc': 0.9526542651577248, 'loss_val': 0.29521310520749056, 'psi': 0.9348325236504067}-{'f1_val': 0.6409344119145306, 'auprc': 0.8022411651875525, 'loss_val': 0.4887042272341696, 'psi': 0.7054571132237394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=29 head_norm_before_train=1.528458 cos_to_last_merge=0.8005 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.801
[S7] round=29 local utility u=0.000000 metrics={'f1_val': 0.5522938804135022, 'auprc': 0.7835132839577568, 'loss_val': 0.8447880592921754, 'psi': 0.644781641831204}-{'f1_val': 0.6525865280876888, 'auprc': 0.8043567178162764, 'loss_val': 0.49209286281194253, 'psi': 0.7132946039791238}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=29 head_norm_before_train=1.923977 (no previous merge yet)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9870681547550937, 'auprc': 0.9988798168775609, 'loss_val': 0.048732445844650564, 'psi': 0.9917928196040805}-{'f1_val': 0.9924309654389881, 'auprc': 0.9988503122340027, 'loss_val': 0.03832137623785165, 'psi': 0.9949987041569939}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=29 head_norm_before_train=1.929192 cos_to_last_merge=0.9591 (last merge round=11)
[S9] round=29 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9930690774541571, 'loss_val': 0.023747350784067794, 'psi': 0.9949776878492294}-{'f1_val': 0.9945775144926113, 'auprc': 0.9981241613538848, 'loss_val': 0.025840197518667785, 'psi': 0.9959961732371208}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=29 head_norm_before_train=1.548020 cos_to_last_merge=0.9611 (last merge round=16)
[S10] round=29 local utility u=0.003546 metrics={'f1_val': 0.9933073753875716, 'auprc': 0.9963263990230973, 'loss_val': 0.05434409586883329, 'psi': 0.9945149848417818}-{'f1_val': 0.9948838907637279, 'auprc': 0.9921260243208058, 'loss_val': 0.05829316714942949, 'psi': 0.993780744186559}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=29 head_norm_before_train=1.980009 cos_to_last_merge=0.9668 (last merge round=11)
[S11] round=29 local utility u=0.003283 metrics={'f1_val': 0.9960663761953501, 'auprc': 0.9979729520174341, 'loss_val': 0.04520906950649117, 'psi': 0.9968290065241837}-{'f1_val': 0.9965470045135896, 'auprc': 0.9978225894350737, 'loss_val': 0.05420833467304983, 'psi': 0.9970572384821832}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=29 head_norm_before_train=1.684541 (no previous merge yet)
[S13] round=29 local utility u=0.282326 metrics={'f1_val': 0.6264066979972814, 'auprc': 0.8718423508147054, 'loss_val': 0.57613787821792, 'psi': 0.7245809591242511}-{'f1_val': 0.5914857642208784, 'auprc': 0.8142859909615309, 'loss_val': 0.7585942183587577, 'psi': 0.6806058549171394}
[S13] not sending this round → trigger blocked (psi=0.725)
[S14] START round=29 head_norm_before_train=1.951929 cos_to_last_merge=0.9832 (last merge round=15)
[S14] round=29 local utility u=0.082630 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.99753431515306, 'loss_val': 0.03161003228653912, 'psi': 0.9976043968911361}-{'f1_val': 0.976498213504243, 'auprc': 0.9972093193557949, 'loss_val': 0.06897663472355124, 'psi': 0.9847826558448638}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=29 head_norm_before_train=1.982630 (no previous merge yet)
[S15] round=29 local utility u=0.758832 metrics={'f1_val': 0.9613674390849617, 'auprc': 0.9961416662624148, 'loss_val': 0.07202425820186871, 'psi': 0.9752771299559431}-{'f1_val': 0.7711143008293998, 'auprc': 0.9651222409532074, 'loss_val': 0.35511101878686574, 'psi': 0.8487174768789228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=29 head_norm_before_train=1.778995 cos_to_last_merge=0.8012 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.801
[S16] round=29 local utility u=0.000000 metrics={'f1_val': 0.8687121538982503, 'auprc': 0.9893348703209718, 'loss_val': 0.6274003196564547, 'psi': 0.9169612404673388}-{'f1_val': 0.991963306697354, 'auprc': 0.9969392879691374, 'loss_val': 0.04564135981313475, 'psi': 0.9939536992060674}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=29 head_norm_before_train=1.341616 cos_to_last_merge=0.9370 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.937
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.6305586833008006, 'auprc': 0.8192186180918907, 'loss_val': 1.0444318467222196, 'psi': 0.7060226572172366}-{'f1_val': 0.6437488911320002, 'auprc': 0.8223962875955348, 'loss_val': 0.9471435898328572, 'psi': 0.715207849717414}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=30 head_norm_before_train=1.695743 cos_to_last_merge=0.7836 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=30 local utility u=0.071821 metrics={'f1_val': 0.7010938041521195, 'auprc': 0.6756368508916684, 'loss_val': 0.3963208052208245, 'psi': 0.690911022847939}-{'f1_val': 0.7129666496087969, 'auprc': 0.7791652764573486, 'loss_val': 0.9217853474310028, 'psi': 0.7394461003482176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=30 head_norm_before_train=2.153886 (no previous merge yet)
[S3] round=30 local utility u=0.206608 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.9986649448645636, 'loss_val': 0.16577342153399421, 'psi': 0.9706227218768195}-{'f1_val': 0.8952955439117338, 'auprc': 0.998328613435063, 'loss_val': 0.238185993051729, 'psi': 0.9365087717210655}
[S3] not sending this round → trigger blocked (psi=0.971)
[S4] START round=30 head_norm_before_train=1.522920 cos_to_last_merge=0.9289 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.929
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.949200051094758, 'auprc': 0.9679080587166096, 'loss_val': 0.25919052242356466, 'psi': 0.9566832541434986}-{'f1_val': 0.9544692243942928, 'auprc': 0.9838100389842841, 'loss_val': 0.23719941104313372, 'psi': 0.9662055502302893}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.335119 cos_to_last_merge=0.8687 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.869
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.5865095661196906, 'auprc': 0.8489939259142648, 'loss_val': 0.5806971977881559, 'psi': 0.6915033100375203}-{'f1_val': 0.700320598491359, 'auprc': 0.9911959256161276, 'loss_val': 0.22828084067300786, 'psi': 0.8166707293412665}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.555289 cos_to_last_merge=0.9545 (last merge round=11)
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5838422581196798, 'auprc': 0.747755893755233, 'loss_val': 0.627680885452166, 'psi': 0.649407712373901}-{'f1_val': 0.922951362645528, 'auprc': 0.9526542651577248, 'loss_val': 0.29521310520749056, 'psi': 0.9348325236504067}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.544275 cos_to_last_merge=0.7980 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.798
[S7] round=30 local utility u=0.349682 metrics={'f1_val': 0.6122601985557545, 'auprc': 0.796493773463137, 'loss_val': 0.5441624745949316, 'psi': 0.6859536285187076}-{'f1_val': 0.5522938804135022, 'auprc': 0.7835132839577568, 'loss_val': 0.8447880592921754, 'psi': 0.644781641831204}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=30 head_norm_before_train=1.936968 (no previous merge yet)
[S8] round=30 local utility u=0.000000 metrics={'f1_val': 0.713800092648937, 'auprc': 0.9825332341147237, 'loss_val': 0.33115073122774535, 'psi': 0.8212933492352517}-{'f1_val': 0.9870681547550937, 'auprc': 0.9988798168775609, 'loss_val': 0.048732445844650564, 'psi': 0.9917928196040805}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=30 head_norm_before_train=1.941991 cos_to_last_merge=0.9578 (last merge round=11)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.990582573027146, 'auprc': 0.9980237830619128, 'loss_val': 0.03318991063196725, 'psi': 0.9935590570410526}-{'f1_val': 0.9962500947792776, 'auprc': 0.9930690774541571, 'loss_val': 0.023747350784067794, 'psi': 0.9949776878492294}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.578556 cos_to_last_merge=0.9577 (last merge round=16)
[S10] round=30 local utility u=0.002218 metrics={'f1_val': 0.9935109650886941, 'auprc': 0.9964689753349015, 'loss_val': 0.051556908336543465, 'psi': 0.994694169187177}-{'f1_val': 0.9933073753875716, 'auprc': 0.9963263990230973, 'loss_val': 0.05434409586883329, 'psi': 0.9945149848417818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=30 head_norm_before_train=1.999140 cos_to_last_merge=0.9647 (last merge round=11)
[S11] round=30 local utility u=0.006969 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9981414870905051, 'loss_val': 0.03466001673602481, 'psi': 0.9971847975443557}-{'f1_val': 0.9960663761953501, 'auprc': 0.9979729520174341, 'loss_val': 0.04520906950649117, 'psi': 0.9968290065241837}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=30 head_norm_before_train=1.690820 (no previous merge yet)
[S13] round=30 local utility u=0.000000 metrics={'f1_val': 0.626946170970112, 'auprc': 0.8723741404657048, 'loss_val': 0.5838612539108916, 'psi': 0.725117358768349}-{'f1_val': 0.6264066979972814, 'auprc': 0.8718423508147054, 'loss_val': 0.57613787821792, 'psi': 0.7245809591242511}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=30 head_norm_before_train=1.956275 cos_to_last_merge=0.9825 (last merge round=15)
[S14] round=30 local utility u=0.004202 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9992103817562374, 'loss_val': 0.02838404798300328, 'psi': 0.998289777196256}-{'f1_val': 0.9976511180498535, 'auprc': 0.99753431515306, 'loss_val': 0.03161003228653912, 'psi': 0.9976043968911361}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=30 head_norm_before_train=2.003594 (no previous merge yet)
[S15] round=30 local utility u=0.130590 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979675704257629, 'loss_val': 0.028597694197079325, 'psi': 0.9972350292028175}-{'f1_val': 0.9613674390849617, 'auprc': 0.9961416662624148, 'loss_val': 0.07202425820186871, 'psi': 0.9752771299559431}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=30 head_norm_before_train=1.792075 cos_to_last_merge=0.7999 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.800
[S16] round=30 local utility u=0.671696 metrics={'f1_val': 0.9915316888756154, 'auprc': 0.9968913658227119, 'loss_val': 0.043594312229762455, 'psi': 0.993675559654454}-{'f1_val': 0.8687121538982503, 'auprc': 0.9893348703209718, 'loss_val': 0.6274003196564547, 'psi': 0.9169612404673388}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=30 head_norm_before_train=1.363138 cos_to_last_merge=0.9330 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.933
[S17] round=30 local utility u=0.178911 metrics={'f1_val': 0.6682803139021207, 'auprc': 0.8250283805076962, 'loss_val': 0.9303679624470099, 'psi': 0.7309795405443509}-{'f1_val': 0.6305586833008006, 'auprc': 0.8192186180918907, 'loss_val': 1.0444318467222196, 'psi': 0.7060226572172366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=31 head_norm_before_train=1.708035 cos_to_last_merge=0.7837 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.784
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6039125308630304, 'auprc': 0.6408287426847867, 'loss_val': 0.8252979320407898, 'psi': 0.618679015591733}-{'f1_val': 0.7010938041521195, 'auprc': 0.6756368508916684, 'loss_val': 0.3963208052208245, 'psi': 0.690911022847939}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=31 head_norm_before_train=2.170835 (no previous merge yet)
[S3] round=31 local utility u=0.000000 metrics={'f1_val': 0.6771619975827338, 'auprc': 0.9598406188546295, 'loss_val': 0.9523489175239058, 'psi': 0.790233446091492}-{'f1_val': 0.9519279065516568, 'auprc': 0.9986649448645636, 'loss_val': 0.16577342153399421, 'psi': 0.9706227218768195}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=31 head_norm_before_train=1.533207 cos_to_last_merge=0.9274 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=31 local utility u=0.000000 metrics={'f1_val': 0.945741452906045, 'auprc': 0.9606788533361681, 'loss_val': 0.27143121025667266, 'psi': 0.9517164130780943}-{'f1_val': 0.949200051094758, 'auprc': 0.9679080587166096, 'loss_val': 0.25919052242356466, 'psi': 0.9566832541434986}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=31 head_norm_before_train=1.344362 cos_to_last_merge=0.8672 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.867
[S5] round=31 local utility u=0.474881 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8556201548257978, 'loss_val': 0.3336805086928039, 'psi': 0.7624404210251345}-{'f1_val': 0.5865095661196906, 'auprc': 0.8489939259142648, 'loss_val': 0.5806971977881559, 'psi': 0.6915033100375203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S5] sending update (kind=head size=1803 to 1 peers)
[S6] START round=31 head_norm_before_train=1.562710 cos_to_last_merge=0.9527 (last merge round=11)
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.9364548236904922, 'auprc': 0.9438137198521125, 'loss_val': 0.23861197184662974, 'psi': 0.9393983821551404}-{'f1_val': 0.5838422581196798, 'auprc': 0.747755893755233, 'loss_val': 0.627680885452166, 'psi': 0.649407712373901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=31 head_norm_before_train=1.554508 cos_to_last_merge=0.7960 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.796
[S7] round=31 local utility u=0.117501 metrics={'f1_val': 0.6296017075591119, 'auprc': 0.8053643930583972, 'loss_val': 0.4398209383346714, 'psi': 0.699906781758826}-{'f1_val': 0.6122601985557545, 'auprc': 0.796493773463137, 'loss_val': 0.5441624745949316, 'psi': 0.6859536285187076}
[S7] not sending this round → trigger blocked (psi=0.700)
[S8] START round=31 head_norm_before_train=1.947268 (no previous merge yet)
[S8] round=31 local utility u=1.000000 metrics={'f1_val': 0.9922819023012285, 'auprc': 0.9989082929493585, 'loss_val': 0.03641780275453662, 'psi': 0.9949324585604804}-{'f1_val': 0.713800092648937, 'auprc': 0.9825332341147237, 'loss_val': 0.33115073122774535, 'psi': 0.8212933492352517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=31 head_norm_before_train=1.953982 cos_to_last_merge=0.9568 (last merge round=11)
[S9] round=31 local utility u=0.018810 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9955848509542116, 'loss_val': 0.02321810397482031, 'psi': 0.9960800517820172}-{'f1_val': 0.990582573027146, 'auprc': 0.9980237830619128, 'loss_val': 0.03318991063196725, 'psi': 0.9935590570410526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=31 head_norm_before_train=1.604215 cos_to_last_merge=0.9550 (last merge round=16)
[S10] round=31 local utility u=0.000000 metrics={'f1_val': 0.9943096789853013, 'auprc': 0.9937431595548281, 'loss_val': 0.0483913714939844, 'psi': 0.9940830712131119}-{'f1_val': 0.9935109650886941, 'auprc': 0.9964689753349015, 'loss_val': 0.051556908336543465, 'psi': 0.994694169187177}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=31 head_norm_before_train=2.016172 cos_to_last_merge=0.9630 (last merge round=11)
[S11] round=31 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.997950845158632, 'loss_val': 0.03523370511958377, 'psi': 0.9971085407716065}-{'f1_val': 0.9965470045135896, 'auprc': 0.9981414870905051, 'loss_val': 0.03466001673602481, 'psi': 0.9971847975443557}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=31 head_norm_before_train=1.697734 (no previous merge yet)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5952438743802162, 'auprc': 0.79879276716567, 'loss_val': 0.7863235561772287, 'psi': 0.6766634314943978}-{'f1_val': 0.626946170970112, 'auprc': 0.8723741404657048, 'loss_val': 0.5838612539108916, 'psi': 0.725117358768349}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=31 head_norm_before_train=1.964164 cos_to_last_merge=0.9817 (last merge round=15)
[S14] round=31 local utility u=0.000000 metrics={'f1_val': 0.9784661311694491, 'auprc': 0.9971591970985952, 'loss_val': 0.04981635781401696, 'psi': 0.9859433575411076}-{'f1_val': 0.9976760408229349, 'auprc': 0.9992103817562374, 'loss_val': 0.02838404798300328, 'psi': 0.998289777196256}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=31 head_norm_before_train=2.021369 (no previous merge yet)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7775834742522253, 'auprc': 0.9919717408467835, 'loss_val': 0.3218487605131839, 'psi': 0.8633387808900486}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979675704257629, 'loss_val': 0.028597694197079325, 'psi': 0.9972350292028175}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.805932 cos_to_last_merge=0.7988 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.799
[S16] round=31 local utility u=0.000000 metrics={'f1_val': 0.9077353517430377, 'auprc': 0.9943556392021285, 'loss_val': 0.18445677455644227, 'psi': 0.942383466726674}-{'f1_val': 0.9915316888756154, 'auprc': 0.9968913658227119, 'loss_val': 0.043594312229762455, 'psi': 0.993675559654454}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=31 head_norm_before_train=1.384725 cos_to_last_merge=0.9295 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.929
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6262746869178604, 'auprc': 0.8145843345104042, 'loss_val': 1.0903995434460805, 'psi': 0.7015985459548779}-{'f1_val': 0.6682803139021207, 'auprc': 0.8250283805076962, 'loss_val': 0.9303679624470099, 'psi': 0.7309795405443509}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=32 head_norm_before_train=1.720243 cos_to_last_merge=0.7833 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=32 local utility u=0.000000 metrics={'f1_val': 0.5454220010027357, 'auprc': 0.602675588872102, 'loss_val': 1.230679351003734, 'psi': 0.5683234361504823}-{'f1_val': 0.6039125308630304, 'auprc': 0.6408287426847867, 'loss_val': 0.8252979320407898, 'psi': 0.618679015591733}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=32 head_norm_before_train=2.185487 (no previous merge yet)
[S3] round=32 local utility u=1.000000 metrics={'f1_val': 0.9320687790985476, 'auprc': 0.9991156663944603, 'loss_val': 0.24070339916770767, 'psi': 0.9588875340169126}-{'f1_val': 0.6771619975827338, 'auprc': 0.9598406188546295, 'loss_val': 0.9523489175239058, 'psi': 0.790233446091492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=32 head_norm_before_train=1.542972 cos_to_last_merge=0.9259 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.926
[S4] round=32 local utility u=0.083355 metrics={'f1_val': 0.9551973381560538, 'auprc': 0.9844739553635695, 'loss_val': 0.23284255509942747, 'psi': 0.9669079850390601}-{'f1_val': 0.945741452906045, 'auprc': 0.9606788533361681, 'loss_val': 0.27143121025667266, 'psi': 0.9517164130780943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=32 head_norm_before_train=1.349883 cos_to_last_merge=0.8655 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.865
[S5] round=32 local utility u=0.141165 metrics={'f1_val': 0.6784068384489085, 'auprc': 0.9699249606649301, 'loss_val': 0.2627821751691684, 'psi': 0.7950140873353171}-{'f1_val': 0.700320598491359, 'auprc': 0.8556201548257978, 'loss_val': 0.3336805086928039, 'psi': 0.7624404210251345}
[S5] not sending this round → trigger blocked (psi=0.795)
[S6] START round=32 head_norm_before_train=1.572296 cos_to_last_merge=0.9504 (last merge round=11)
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.5958948188006505, 'auprc': 0.7812554334442496, 'loss_val': 0.6642297752373998, 'psi': 0.6700390646580902}-{'f1_val': 0.9364548236904922, 'auprc': 0.9438137198521125, 'loss_val': 0.23861197184662974, 'psi': 0.9393983821551404}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.567536 cos_to_last_merge=0.7938 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.794
[S7] round=32 local utility u=0.000000 metrics={'f1_val': 0.6104659185630188, 'auprc': 0.7944926387553178, 'loss_val': 0.6442141471507319, 'psi': 0.6840766066399384}-{'f1_val': 0.6296017075591119, 'auprc': 0.8053643930583972, 'loss_val': 0.4398209383346714, 'psi': 0.699906781758826}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=32 head_norm_before_train=1.955885 (no previous merge yet)
[S8] round=32 local utility u=0.002362 metrics={'f1_val': 0.9926368238932805, 'auprc': 0.9988664100221512, 'loss_val': 0.033698146821702656, 'psi': 0.9951286583448287}-{'f1_val': 0.9922819023012285, 'auprc': 0.9989082929493585, 'loss_val': 0.03641780275453662, 'psi': 0.9949324585604804}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=32 head_norm_before_train=1.964708 cos_to_last_merge=0.9557 (last merge round=11)
[S9] round=32 local utility u=0.004657 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9975499635954382, 'loss_val': 0.02245335085915253, 'psi': 0.9971315366935296}-{'f1_val': 0.9964101856672208, 'auprc': 0.9955848509542116, 'loss_val': 0.02321810397482031, 'psi': 0.9960800517820172}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=32 head_norm_before_train=1.623002 cos_to_last_merge=0.9531 (last merge round=16)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9943563983784213, 'auprc': 0.9917834111583278, 'loss_val': 0.069153288431135, 'psi': 0.993327203490384}-{'f1_val': 0.9943096789853013, 'auprc': 0.9937431595548281, 'loss_val': 0.0483913714939844, 'psi': 0.9940830712131119}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=32 head_norm_before_train=2.032416 cos_to_last_merge=0.9613 (last merge round=11)
[S11] round=32 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9957028590855391, 'loss_val': 0.08497851772791433, 'psi': 0.9959736284806628}-{'f1_val': 0.9965470045135896, 'auprc': 0.997950845158632, 'loss_val': 0.03523370511958377, 'psi': 0.9971085407716065}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=32 head_norm_before_train=1.707329 (no previous merge yet)
[S13] round=32 local utility u=0.000000 metrics={'f1_val': 0.5822060412755135, 'auprc': 0.7899542140296698, 'loss_val': 0.8508184522291194, 'psi': 0.665305310377176}-{'f1_val': 0.5952438743802162, 'auprc': 0.79879276716567, 'loss_val': 0.7863235561772287, 'psi': 0.6766634314943978}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=32 head_norm_before_train=1.975640 cos_to_last_merge=0.9808 (last merge round=15)
[S14] round=32 local utility u=0.000000 metrics={'f1_val': 0.9487238640217471, 'auprc': 0.995813014959447, 'loss_val': 0.07943495975377199, 'psi': 0.9675595243968271}-{'f1_val': 0.9784661311694491, 'auprc': 0.9971591970985952, 'loss_val': 0.04981635781401696, 'psi': 0.9859433575411076}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=32 head_norm_before_train=2.037595 (no previous merge yet)
[S15] round=32 local utility u=0.216077 metrics={'f1_val': 0.8329380973880538, 'auprc': 0.995520185896238, 'loss_val': 0.23246706816770596, 'psi': 0.8979709327913274}-{'f1_val': 0.7775834742522253, 'auprc': 0.9919717408467835, 'loss_val': 0.3218487605131839, 'psi': 0.8633387808900486}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=32 head_norm_before_train=1.813641 cos_to_last_merge=0.7979 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.798
[S16] round=32 local utility u=0.331459 metrics={'f1_val': 0.9928198355902873, 'auprc': 0.9972938538545564, 'loss_val': 0.040860745085796214, 'psi': 0.994609442895995}-{'f1_val': 0.9077353517430377, 'auprc': 0.9943556392021285, 'loss_val': 0.18445677455644227, 'psi': 0.942383466726674}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=32 head_norm_before_train=1.402347 cos_to_last_merge=0.9266 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.927
[S17] round=32 local utility u=0.016751 metrics={'f1_val': 0.6312915402986364, 'auprc': 0.8162613104664729, 'loss_val': 1.0920290973925728, 'psi': 0.705279448365771}-{'f1_val': 0.6262746869178604, 'auprc': 0.8145843345104042, 'loss_val': 1.0903995434460805, 'psi': 0.7015985459548779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=33 head_norm_before_train=1.732496 cos_to_last_merge=0.7830 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=33 local utility u=0.991383 metrics={'f1_val': 0.7063723970120321, 'auprc': 0.7794174103010414, 'loss_val': 0.7438416991027953, 'psi': 0.7355904023276358}-{'f1_val': 0.5454220010027357, 'auprc': 0.602675588872102, 'loss_val': 1.230679351003734, 'psi': 0.5683234361504823}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=33 head_norm_before_train=2.198547 (no previous merge yet)
[S3] round=33 local utility u=0.300924 metrics={'f1_val': 0.9968332416810847, 'auprc': 0.9990150746252983, 'loss_val': 0.027139482973053485, 'psi': 0.9977059748587702}-{'f1_val': 0.9320687790985476, 'auprc': 0.9991156663944603, 'loss_val': 0.24070339916770767, 'psi': 0.9588875340169126}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=33 head_norm_before_train=1.551106 cos_to_last_merge=0.9246 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.925
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9548174044750548, 'auprc': 0.9681972428976625, 'loss_val': 0.24689899103681862, 'psi': 0.9601693398440979}-{'f1_val': 0.9551973381560538, 'auprc': 0.9844739553635695, 'loss_val': 0.23284255509942747, 'psi': 0.9669079850390601}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.361841 cos_to_last_merge=0.8628 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.863
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.700320598491359, 'auprc': 0.8590149974973694, 'loss_val': 0.34170903134115027, 'psi': 0.7637983580937632}-{'f1_val': 0.6784068384489085, 'auprc': 0.9699249606649301, 'loss_val': 0.2627821751691684, 'psi': 0.7950140873353171}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.583058 cos_to_last_merge=0.9480 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=33 local utility u=1.000000 metrics={'f1_val': 0.9601576400039211, 'auprc': 0.9628111150894715, 'loss_val': 0.20265937765632047, 'psi': 0.9612190300381414}-{'f1_val': 0.5958948188006505, 'auprc': 0.7812554334442496, 'loss_val': 0.6642297752373998, 'psi': 0.6700390646580902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=33 head_norm_before_train=1.576751 cos_to_last_merge=0.7928 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.793
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.5525967415876836, 'auprc': 0.7862691927238342, 'loss_val': 0.9660200215793932, 'psi': 0.6460657220421439}-{'f1_val': 0.6104659185630188, 'auprc': 0.7944926387553178, 'loss_val': 0.6442141471507319, 'psi': 0.6840766066399384}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.966525 (no previous merge yet)
[S8] round=33 local utility u=0.000875 metrics={'f1_val': 0.9929762634442646, 'auprc': 0.9988143243016616, 'loss_val': 0.03382867844413707, 'psi': 0.9953114877872234}-{'f1_val': 0.9926368238932805, 'auprc': 0.9988664100221512, 'loss_val': 0.033698146821702656, 'psi': 0.9951286583448287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] sending update (kind=head size=1803 to 1 peers)
[S9] START round=33 head_norm_before_train=1.975909 cos_to_last_merge=0.9547 (last merge round=11)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9965430861317262, 'loss_val': 0.022067174747223018, 'psi': 0.9967287857080448}-{'f1_val': 0.9968525854255906, 'auprc': 0.9975499635954382, 'loss_val': 0.02245335085915253, 'psi': 0.9971315366935296}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.641050 cos_to_last_merge=0.9512 (last merge round=16)
[S10] round=33 local utility u=0.017340 metrics={'f1_val': 0.993924439075923, 'auprc': 0.9965268320589143, 'loss_val': 0.04611135357946079, 'psi': 0.9949653962691195}-{'f1_val': 0.9943563983784213, 'auprc': 0.9917834111583278, 'loss_val': 0.069153288431135, 'psi': 0.993327203490384}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=33 head_norm_before_train=2.047296 cos_to_last_merge=0.9598 (last merge round=11)
[S11] round=33 local utility u=0.033406 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980817989911889, 'loss_val': 0.029109870022661518, 'psi': 0.9973059495020942}-{'f1_val': 0.9961541414107454, 'auprc': 0.9957028590855391, 'loss_val': 0.08497851772791433, 'psi': 0.9959736284806628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=33 head_norm_before_train=1.719692 (no previous merge yet)
[S13] round=33 local utility u=0.245366 metrics={'f1_val': 0.621276754495981, 'auprc': 0.812605466650217, 'loss_val': 0.6624640591532366, 'psi': 0.6978082393576754}-{'f1_val': 0.5822060412755135, 'auprc': 0.7899542140296698, 'loss_val': 0.8508184522291194, 'psi': 0.665305310377176}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=33 head_norm_before_train=1.988561 cos_to_last_merge=0.9799 (last merge round=15)
[S14] round=33 local utility u=0.018695 metrics={'f1_val': 0.9544845288706083, 'auprc': 0.9956953953334916, 'loss_val': 0.07625543368342012, 'psi': 0.9709688754557617}-{'f1_val': 0.9487238640217471, 'auprc': 0.995813014959447, 'loss_val': 0.07943495975377199, 'psi': 0.9675595243968271}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=33 head_norm_before_train=2.053313 (no previous merge yet)
[S15] round=33 local utility u=0.433232 metrics={'f1_val': 0.9505309094544482, 'auprc': 0.9966709545750452, 'loss_val': 0.07501317865444479, 'psi': 0.968986927502687}-{'f1_val': 0.8329380973880538, 'auprc': 0.995520185896238, 'loss_val': 0.23246706816770596, 'psi': 0.8979709327913274}
[S15] not sending this round → trigger blocked (psi=0.969)
[S16] START round=33 head_norm_before_train=1.823009 cos_to_last_merge=0.7970 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.797
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.8924911707393718, 'auprc': 0.9861264331450964, 'loss_val': 0.5152713203777035, 'psi': 0.9299452757016616}-{'f1_val': 0.9928198355902873, 'auprc': 0.9972938538545564, 'loss_val': 0.040860745085796214, 'psi': 0.994609442895995}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.422637 cos_to_last_merge=0.9232 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.923
[S17] round=33 local utility u=0.000000 metrics={'f1_val': 0.6043385021055736, 'auprc': 0.8152582234038332, 'loss_val': 1.17676354376043, 'psi': 0.6887063906248775}-{'f1_val': 0.6312915402986364, 'auprc': 0.8162613104664729, 'loss_val': 1.0920290973925728, 'psi': 0.705279448365771}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=34 head_norm_before_train=1.745470 cos_to_last_merge=0.7826 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.783
[S2] round=34 local utility u=0.000000 metrics={'f1_val': 0.5533214667162739, 'auprc': 0.6229338198604042, 'loss_val': 1.2083384010395932, 'psi': 0.581166407973926}-{'f1_val': 0.7063723970120321, 'auprc': 0.7794174103010414, 'loss_val': 0.7438416991027953, 'psi': 0.7355904023276358}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=34 head_norm_before_train=2.206870 (no previous merge yet)
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.8567916574266023, 'auprc': 0.9983517654184584, 'loss_val': 0.3414983856997081, 'psi': 0.9134157006233448}-{'f1_val': 0.9968332416810847, 'auprc': 0.9990150746252983, 'loss_val': 0.027139482973053485, 'psi': 0.9977059748587702}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.558678 cos_to_last_merge=0.9234 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.923
[S4] round=34 local utility u=0.004286 metrics={'f1_val': 0.951866651741754, 'auprc': 0.9785833425011679, 'loss_val': 0.2517808026600249, 'psi': 0.9625533280455196}-{'f1_val': 0.9548174044750548, 'auprc': 0.9681972428976625, 'loss_val': 0.24689899103681862, 'psi': 0.9601693398440979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=34 head_norm_before_train=1.375147 cos_to_last_merge=0.8606 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.861
[S5] round=34 local utility u=0.000000 metrics={'f1_val': 0.42798881199692634, 'auprc': 0.8165174493455463, 'loss_val': 0.9212458568427632, 'psi': 0.5834002669363743}-{'f1_val': 0.700320598491359, 'auprc': 0.8590149974973694, 'loss_val': 0.34170903134115027, 'psi': 0.7637983580937632}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=34 head_norm_before_train=1.593229 cos_to_last_merge=0.9464 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.946
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.5367380829841288, 'auprc': 0.7811035429362512, 'loss_val': 0.657518352729903, 'psi': 0.6344842669649777}-{'f1_val': 0.9601576400039211, 'auprc': 0.9628111150894715, 'loss_val': 0.20265937765632047, 'psi': 0.9612190300381414}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.585518 cos_to_last_merge=0.7924 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.792
[S7] round=34 local utility u=0.206682 metrics={'f1_val': 0.5812581132963283, 'auprc': 0.7883682242112315, 'loss_val': 0.7309204824643132, 'psi': 0.6641021576622896}-{'f1_val': 0.5525967415876836, 'auprc': 0.7862691927238342, 'loss_val': 0.9660200215793932, 'psi': 0.6460657220421439}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=34 head_norm_before_train=1.973228 (no previous merge yet)
[S8] round=34 local utility u=0.000000 metrics={'f1_val': 0.9922396549535559, 'auprc': 0.9989602587990969, 'loss_val': 0.03605868951591138, 'psi': 0.9949278964917724}-{'f1_val': 0.9929762634442646, 'auprc': 0.9988143243016616, 'loss_val': 0.03382867844413707, 'psi': 0.9953114877872234}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=34 head_norm_before_train=1.988102 cos_to_last_merge=0.9536 (last merge round=11)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9986082542388443, 'loss_val': 0.02399878985952028, 'psi': 0.9960396147031021}-{'f1_val': 0.9968525854255906, 'auprc': 0.9965430861317262, 'loss_val': 0.022067174747223018, 'psi': 0.9967287857080448}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.659135 cos_to_last_merge=0.9494 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.949
[S10] round=34 local utility u=0.000000 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9926092200044747, 'loss_val': 0.04838246633248042, 'psi': 0.9941057688474488}-{'f1_val': 0.993924439075923, 'auprc': 0.9965268320589143, 'loss_val': 0.04611135357946079, 'psi': 0.9949653962691195}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=34 head_norm_before_train=2.062572 cos_to_last_merge=0.9581 (last merge round=11)
[S11] round=34 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9982105312626676, 'loss_val': 0.031587860033433286, 'psi': 0.9972124152132208}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980817989911889, 'loss_val': 0.029109870022661518, 'psi': 0.9973059495020942}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=34 head_norm_before_train=1.730144 (no previous merge yet)
[S13] round=34 local utility u=0.010113 metrics={'f1_val': 0.6056123387653531, 'auprc': 0.8664594921374122, 'loss_val': 0.7098130629838904, 'psi': 0.7099512001141768}-{'f1_val': 0.621276754495981, 'auprc': 0.812605466650217, 'loss_val': 0.6624640591532366, 'psi': 0.6978082393576754}
[S13] not sending this round → trigger blocked (psi=0.710)
[S14] START round=34 head_norm_before_train=2.001644 cos_to_last_merge=0.9790 (last merge round=15)
[S14] round=34 local utility u=0.152730 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9971279319117952, 'loss_val': 0.03261824267038302, 'psi': 0.9972944905963086}-{'f1_val': 0.9544845288706083, 'auprc': 0.9956953953334916, 'loss_val': 0.07625543368342012, 'psi': 0.9709688754557617}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=34 head_norm_before_train=2.068545 (no previous merge yet)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7113943817809238, 'auprc': 0.9895799351297532, 'loss_val': 0.4028589159200843, 'psi': 0.8226686031204555}-{'f1_val': 0.9505309094544482, 'auprc': 0.9966709545750452, 'loss_val': 0.07501317865444479, 'psi': 0.968986927502687}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.831616 cos_to_last_merge=0.7961 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.796
[S16] round=34 local utility u=0.548191 metrics={'f1_val': 0.9906719741887318, 'auprc': 0.9970085140027045, 'loss_val': 0.04062023842604166, 'psi': 0.9932065901143209}-{'f1_val': 0.8924911707393718, 'auprc': 0.9861264331450964, 'loss_val': 0.5152713203777035, 'psi': 0.9299452757016616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=34 head_norm_before_train=1.446074 cos_to_last_merge=0.9193 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.919
[S17] round=34 local utility u=0.078045 metrics={'f1_val': 0.620990510533556, 'auprc': 0.817905618517427, 'loss_val': 1.128526843181387, 'psi': 0.6997565537271044}-{'f1_val': 0.6043385021055736, 'auprc': 0.8152582234038332, 'loss_val': 1.17676354376043, 'psi': 0.6887063906248775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S17] sending update (kind=head size=1810 to 1 peers)
[S2] START round=35 head_norm_before_train=1.756537 cos_to_last_merge=0.7817 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.782
[S2] round=35 local utility u=0.872239 metrics={'f1_val': 0.7074508348304507, 'auprc': 0.7636069674279613, 'loss_val': 0.8106569196469668, 'psi': 0.729913287869455}-{'f1_val': 0.5533214667162739, 'auprc': 0.6229338198604042, 'loss_val': 1.2083384010395932, 'psi': 0.581166407973926}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=35 head_norm_before_train=2.214484 (no previous merge yet)
[S3] round=35 local utility u=0.000000 metrics={'f1_val': 0.7106193605945246, 'auprc': 0.9649652489392737, 'loss_val': 0.7828326786989332, 'psi': 0.8123577159324242}-{'f1_val': 0.8567916574266023, 'auprc': 0.9983517654184584, 'loss_val': 0.3414983856997081, 'psi': 0.9134157006233448}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=35 head_norm_before_train=1.568940 cos_to_last_merge=0.9220 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.922
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.948867855331788, 'auprc': 0.9801996916776694, 'loss_val': 0.25359027282228963, 'psi': 0.9614005898701405}-{'f1_val': 0.951866651741754, 'auprc': 0.9785833425011679, 'loss_val': 0.2517808026600249, 'psi': 0.9625533280455196}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.388080 cos_to_last_merge=0.8585 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.859
[S5] round=35 local utility u=1.000000 metrics={'f1_val': 0.6634478960109661, 'auprc': 0.8680871373465952, 'loss_val': 0.3810357874276506, 'psi': 0.7453035925452177}-{'f1_val': 0.42798881199692634, 'auprc': 0.8165174493455463, 'loss_val': 0.9212458568427632, 'psi': 0.5834002669363743}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=35 head_norm_before_train=1.602994 cos_to_last_merge=0.9450 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=35 local utility u=0.860786 metrics={'f1_val': 0.7513900962785267, 'auprc': 0.8778314044878689, 'loss_val': 0.5140415753677948, 'psi': 0.8019666195622636}-{'f1_val': 0.5367380829841288, 'auprc': 0.7811035429362512, 'loss_val': 0.657518352729903, 'psi': 0.6344842669649777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=35 head_norm_before_train=1.591623 cos_to_last_merge=0.7912 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.791
[S7] round=35 local utility u=0.546347 metrics={'f1_val': 0.6749294253519305, 'auprc': 0.8344014136377935, 'loss_val': 0.33835431284712636, 'psi': 0.7387182206662757}-{'f1_val': 0.5812581132963283, 'auprc': 0.7883682242112315, 'loss_val': 0.7309204824643132, 'psi': 0.6641021576622896}
[S7] not sending this round → trigger blocked (psi=0.739)
[S8] START round=35 head_norm_before_train=1.976423 (no previous merge yet)
[S8] round=35 local utility u=0.002829 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.9989500119361109, 'loss_val': 0.03249858385011036, 'psi': 0.995136712824759}-{'f1_val': 0.9922396549535559, 'auprc': 0.9989602587990969, 'loss_val': 0.03605868951591138, 'psi': 0.9949278964917724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=35 head_norm_before_train=1.994402 cos_to_last_merge=0.9526 (last merge round=11)
[S9] round=35 local utility u=0.008700 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986162265099341, 'loss_val': 0.020622280219462236, 'psi': 0.9974427976923085}-{'f1_val': 0.9943271883459407, 'auprc': 0.9986082542388443, 'loss_val': 0.02399878985952028, 'psi': 0.9960396147031021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=35 head_norm_before_train=1.674790 cos_to_last_merge=0.9477 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.948
[S10] round=35 local utility u=0.001223 metrics={'f1_val': 0.9951034680760983, 'auprc': 0.9923649507819373, 'loss_val': 0.04520438823259183, 'psi': 0.9940080611584339}-{'f1_val': 0.9951034680760983, 'auprc': 0.9926092200044747, 'loss_val': 0.04838246633248042, 'psi': 0.9941057688474488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=35 head_norm_before_train=2.076986 cos_to_last_merge=0.9565 (last merge round=11)
[S11] round=35 local utility u=0.002742 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9980699913997152, 'loss_val': 0.027133466542799748, 'psi': 0.9973012264655048}-{'f1_val': 0.9965470045135896, 'auprc': 0.9982105312626676, 'loss_val': 0.031587860033433286, 'psi': 0.9972124152132208}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] START round=35 head_norm_before_train=1.739781 (no previous merge yet)
[S13] round=35 local utility u=0.000000 metrics={'f1_val': 0.5846568727184768, 'auprc': 0.7290418507162151, 'loss_val': 0.902391118250721, 'psi': 0.6424108639175721}-{'f1_val': 0.6056123387653531, 'auprc': 0.8664594921374122, 'loss_val': 0.7098130629838904, 'psi': 0.7099512001141768}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=35 head_norm_before_train=2.013564 cos_to_last_merge=0.9781 (last merge round=15)
[S14] round=35 local utility u=0.003131 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9975320017243312, 'loss_val': 0.025119531753480858, 'psi': 0.9972113055843315}-{'f1_val': 0.9974055297193176, 'auprc': 0.9971279319117952, 'loss_val': 0.03261824267038302, 'psi': 0.9972944905963086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=35 head_norm_before_train=2.082479 (no previous merge yet)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9963164379542544, 'auprc': 0.9975015895522037, 'loss_val': 0.024810425662244767, 'psi': 0.9967904985934342}-{'f1_val': 0.7113943817809238, 'auprc': 0.9895799351297532, 'loss_val': 0.4028589159200843, 'psi': 0.8226686031204555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=35 head_norm_before_train=1.842412 cos_to_last_merge=0.7952 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.795
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.9900510313479204, 'auprc': 0.9979089061296328, 'loss_val': 0.042253818898367726, 'psi': 0.9931941812606053}-{'f1_val': 0.9906719741887318, 'auprc': 0.9970085140027045, 'loss_val': 0.04062023842604166, 'psi': 0.9932065901143209}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.469472 cos_to_last_merge=0.9162 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.916
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.5994834010931082, 'auprc': 0.8061790999688762, 'loss_val': 1.2504311106764991, 'psi': 0.6821616806434154}-{'f1_val': 0.620990510533556, 'auprc': 0.817905618517427, 'loss_val': 1.128526843181387, 'psi': 0.6997565537271044}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=36 head_norm_before_train=1.766597 cos_to_last_merge=0.7811 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.6262267896647885, 'auprc': 0.7490154969451821, 'loss_val': 1.0156749786474286, 'psi': 0.675342272576946}-{'f1_val': 0.7074508348304507, 'auprc': 0.7636069674279613, 'loss_val': 0.8106569196469668, 'psi': 0.729913287869455}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=36 head_norm_before_train=2.225399 (no previous merge yet)
[S3] round=36 local utility u=1.000000 metrics={'f1_val': 0.9815885840555931, 'auprc': 0.9989911374063436, 'loss_val': 0.053349758262145296, 'psi': 0.9885496053958933}-{'f1_val': 0.7106193605945246, 'auprc': 0.9649652489392737, 'loss_val': 0.7828326786989332, 'psi': 0.8123577159324242}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=36 head_norm_before_train=1.581538 cos_to_last_merge=0.9203 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.920
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9446197715360991, 'auprc': 0.9649506694359224, 'loss_val': 0.27415648363237155, 'psi': 0.9527521306960285}-{'f1_val': 0.948867855331788, 'auprc': 0.9801996916776694, 'loss_val': 0.25359027282228963, 'psi': 0.9614005898701405}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.396630 cos_to_last_merge=0.8571 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.857
[S5] round=36 local utility u=0.386438 metrics={'f1_val': 0.7005691551769304, 'auprc': 0.9919371960255705, 'loss_val': 0.20243814696225118, 'psi': 0.8171163715163865}-{'f1_val': 0.6634478960109661, 'auprc': 0.8680871373465952, 'loss_val': 0.3810357874276506, 'psi': 0.7453035925452177}
[S5] not sending this round → trigger blocked (psi=0.817)
[S6] START round=36 head_norm_before_train=1.609232 cos_to_last_merge=0.9441 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.944
[S6] round=36 local utility u=0.313490 metrics={'f1_val': 0.810891302558472, 'auprc': 0.9445068965976521, 'loss_val': 0.44409479035894095, 'psi': 0.864337540174144}-{'f1_val': 0.7513900962785267, 'auprc': 0.8778314044878689, 'loss_val': 0.5140415753677948, 'psi': 0.8019666195622636}
[S6] not sending this round → trigger blocked (psi=0.864)
[S7] START round=36 head_norm_before_train=1.600748 cos_to_last_merge=0.7912 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.791
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6621501787465024, 'auprc': 0.8054596826231605, 'loss_val': 0.49582157868493193, 'psi': 0.7194739802971657}-{'f1_val': 0.6749294253519305, 'auprc': 0.8344014136377935, 'loss_val': 0.33835431284712636, 'psi': 0.7387182206662757}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.983017 (no previous merge yet)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9879856597199967, 'auprc': 0.999030815563041, 'loss_val': 0.04322571637689244, 'psi': 0.9924037220572144}-{'f1_val': 0.9925945134171912, 'auprc': 0.9989500119361109, 'loss_val': 0.03249858385011036, 'psi': 0.995136712824759}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=36 head_norm_before_train=2.000654 cos_to_last_merge=0.9517 (last merge round=11)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9962729984768874, 'loss_val': 0.02056984557202555, 'psi': 0.9965055064790899}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986162265099341, 'loss_val': 0.020622280219462236, 'psi': 0.9974427976923085}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.690370 cos_to_last_merge=0.9460 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.946
[S10] round=36 local utility u=0.002941 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9960125446204615, 'loss_val': 0.03973795536906647, 'psi': 0.9944143762591263}-{'f1_val': 0.9951034680760983, 'auprc': 0.9923649507819373, 'loss_val': 0.04520438823259183, 'psi': 0.9940080611584339}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=36 head_norm_before_train=2.088212 cos_to_last_merge=0.9555 (last merge round=11)
[S11] round=36 local utility u=0.000000 metrics={'f1_val': 0.7658881445395657, 'auprc': 0.994186916279535, 'loss_val': 0.3900470561700411, 'psi': 0.8572076532355535}-{'f1_val': 0.9967887165093644, 'auprc': 0.9980699913997152, 'loss_val': 0.027133466542799748, 'psi': 0.9973012264655048}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=36 head_norm_before_train=1.749341 (no previous merge yet)
[S13] round=36 local utility u=0.174769 metrics={'f1_val': 0.610761912552508, 'auprc': 0.7368342518975259, 'loss_val': 0.7328611285943422, 'psi': 0.6611908482905151}-{'f1_val': 0.5846568727184768, 'auprc': 0.7290418507162151, 'loss_val': 0.902391118250721, 'psi': 0.6424108639175721}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=36 head_norm_before_train=2.023728 cos_to_last_merge=0.9773 (last merge round=15)
[S14] round=36 local utility u=0.000767 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9975303749671249, 'loss_val': 0.026062391564623047, 'psi': 0.9974587465475468}-{'f1_val': 0.9969975081576651, 'auprc': 0.9975320017243312, 'loss_val': 0.025119531753480858, 'psi': 0.9972113055843315}
[S14] not sending this round → trigger blocked (psi=0.997)
[S15] START round=36 head_norm_before_train=2.096335 (no previous merge yet)
[S15] round=36 local utility u=0.003200 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9985539091837023, 'loss_val': 0.022824580412589533, 'psi': 0.9973371310392318}-{'f1_val': 0.9963164379542544, 'auprc': 0.9975015895522037, 'loss_val': 0.024810425662244767, 'psi': 0.9967904985934342}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=36 head_norm_before_train=1.854284 cos_to_last_merge=0.7943 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.794
[S16] round=36 local utility u=0.000000 metrics={'f1_val': 0.8363245946929765, 'auprc': 0.901974072603884, 'loss_val': 1.0600950664333504, 'psi': 0.8625843858573394}-{'f1_val': 0.9900510313479204, 'auprc': 0.9979089061296328, 'loss_val': 0.042253818898367726, 'psi': 0.9931941812606053}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=36 head_norm_before_train=1.490633 cos_to_last_merge=0.9128 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.913
[S17] round=36 local utility u=0.090812 metrics={'f1_val': 0.6167798588962602, 'auprc': 0.8163295790984574, 'loss_val': 1.2030365087930488, 'psi': 0.6965997469771391}-{'f1_val': 0.5994834010931082, 'auprc': 0.8061790999688762, 'loss_val': 1.2504311106764991, 'psi': 0.6821616806434154}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=37 head_norm_before_train=1.775593 cos_to_last_merge=0.7805 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.781
[S2] round=37 local utility u=0.026061 metrics={'f1_val': 0.6414645158895564, 'auprc': 0.7433146383218356, 'loss_val': 1.0378771125670452, 'psi': 0.6822045648624682}-{'f1_val': 0.6262267896647885, 'auprc': 0.7490154969451821, 'loss_val': 1.0156749786474286, 'psi': 0.675342272576946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=37 head_norm_before_train=2.237778 (no previous merge yet)
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.8849263460467689, 'auprc': 0.9886025639207406, 'loss_val': 0.27934914831956903, 'psi': 0.9263968331963576}-{'f1_val': 0.9815885840555931, 'auprc': 0.9989911374063436, 'loss_val': 0.053349758262145296, 'psi': 0.9885496053958933}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.591561 cos_to_last_merge=0.9187 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.919
[S4] round=37 local utility u=0.024770 metrics={'f1_val': 0.9454926280584558, 'auprc': 0.9769557528743265, 'loss_val': 0.2658687563245366, 'psi': 0.958077877984804}-{'f1_val': 0.9446197715360991, 'auprc': 0.9649506694359224, 'loss_val': 0.27415648363237155, 'psi': 0.9527521306960285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=37 head_norm_before_train=1.400756 cos_to_last_merge=0.8562 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.856
[S5] round=37 local utility u=0.002266 metrics={'f1_val': 0.7003213174339138, 'auprc': 0.9913843527901972, 'loss_val': 0.19476024205002385, 'psi': 0.8167465315764271}-{'f1_val': 0.7005691551769304, 'auprc': 0.9919371960255705, 'loss_val': 0.20243814696225118, 'psi': 0.8171163715163865}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=37 head_norm_before_train=1.619482 cos_to_last_merge=0.9422 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.7036621050215763, 'auprc': 0.798593130648668, 'loss_val': 0.6079678194714254, 'psi': 0.7416345152724131}-{'f1_val': 0.810891302558472, 'auprc': 0.9445068965976521, 'loss_val': 0.44409479035894095, 'psi': 0.864337540174144}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.610994 cos_to_last_merge=0.7913 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.791
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.598342740238371, 'auprc': 0.7906284818424505, 'loss_val': 0.6477916242960174, 'psi': 0.6752570368800028}-{'f1_val': 0.6621501787465024, 'auprc': 0.8054596826231605, 'loss_val': 0.49582157868493193, 'psi': 0.7194739802971657}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.991322 (no previous merge yet)
[S8] round=37 local utility u=0.000000 metrics={'f1_val': 0.8320440674037101, 'auprc': 0.9859218862779577, 'loss_val': 0.13926907091593088, 'psi': 0.8935951949534091}-{'f1_val': 0.9879856597199967, 'auprc': 0.999030815563041, 'loss_val': 0.04322571637689244, 'psi': 0.9924037220572144}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=37 head_norm_before_train=2.009183 cos_to_last_merge=0.9507 (last merge round=11)
[S9] round=37 local utility u=0.003514 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983678548421555, 'loss_val': 0.01982609369066007, 'psi': 0.9973434490251971}-{'f1_val': 0.9966605118138915, 'auprc': 0.9962729984768874, 'loss_val': 0.02056984557202555, 'psi': 0.9965055064790899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=37 head_norm_before_train=1.706591 cos_to_last_merge=0.9444 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.944
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9920062473426919, 'loss_val': 0.03874352041405229, 'psi': 0.9937834108561225}-{'f1_val': 0.9933489306849028, 'auprc': 0.9960125446204615, 'loss_val': 0.03973795536906647, 'psi': 0.9944143762591263}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=37 head_norm_before_train=2.095120 cos_to_last_merge=0.9549 (last merge round=11)
[S11] round=37 local utility u=0.877307 metrics={'f1_val': 0.996305167468861, 'auprc': 0.9975219674929725, 'loss_val': 0.02794112130597305, 'psi': 0.9967918874785056}-{'f1_val': 0.7658881445395657, 'auprc': 0.994186916279535, 'loss_val': 0.3900470561700411, 'psi': 0.8572076532355535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=37 head_norm_before_train=1.757030 (no previous merge yet)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.57617944074315, 'auprc': 0.8571593729262266, 'loss_val': 0.9089055333906514, 'psi': 0.6885714136163806}-{'f1_val': 0.610761912552508, 'auprc': 0.7368342518975259, 'loss_val': 0.7328611285943422, 'psi': 0.6611908482905151}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=37 head_norm_before_train=2.031827 cos_to_last_merge=0.9765 (last merge round=15)
[S14] round=37 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9971485867851887, 'loss_val': 0.02740040315794416, 'psi': 0.9970579396086745}-{'f1_val': 0.9974109942678281, 'auprc': 0.9975303749671249, 'loss_val': 0.026062391564623047, 'psi': 0.9974587465475468}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=37 head_norm_before_train=2.108160 (no previous merge yet)
[S15] round=37 local utility u=0.000000 metrics={'f1_val': 0.8367869062120601, 'auprc': 0.9965218152694542, 'loss_val': 0.27735634807941856, 'psi': 0.9006808698350177}-{'f1_val': 0.9965259456095847, 'auprc': 0.9985539091837023, 'loss_val': 0.022824580412589533, 'psi': 0.9973371310392318}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=37 head_norm_before_train=1.866149 cos_to_last_merge=0.7935 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=37 local utility u=0.558927 metrics={'f1_val': 0.8919281696819488, 'auprc': 0.9903863437115913, 'loss_val': 0.5410998987112833, 'psi': 0.9313114392938058}-{'f1_val': 0.8363245946929765, 'auprc': 0.901974072603884, 'loss_val': 1.0600950664333504, 'psi': 0.8625843858573394}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=37 head_norm_before_train=1.510759 cos_to_last_merge=0.9095 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.909
[S17] round=37 local utility u=0.279557 metrics={'f1_val': 0.6715224237043103, 'auprc': 0.8332291355092376, 'loss_val': 1.0230767916233794, 'psi': 0.7362051084262812}-{'f1_val': 0.6167798588962602, 'auprc': 0.8163295790984574, 'loss_val': 1.2030365087930488, 'psi': 0.6965997469771391}
[S17] not sending this round → trigger blocked (psi=0.736)
[S2] START round=38 head_norm_before_train=1.785906 cos_to_last_merge=0.7799 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.780
[S2] round=38 local utility u=0.244448 metrics={'f1_val': 0.7090021422754698, 'auprc': 0.7408726928023955, 'loss_val': 0.9468817823582506, 'psi': 0.72175036248624}-{'f1_val': 0.6414645158895564, 'auprc': 0.7433146383218356, 'loss_val': 1.0378771125670452, 'psi': 0.6822045648624682}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=38 head_norm_before_train=2.247992 (no previous merge yet)
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.8793278666962332, 'auprc': 0.9908727379680796, 'loss_val': 0.2849444689410544, 'psi': 0.9239458152049718}-{'f1_val': 0.8849263460467689, 'auprc': 0.9886025639207406, 'loss_val': 0.27934914831956903, 'psi': 0.9263968331963576}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.597560 cos_to_last_merge=0.9178 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.918
[S4] round=38 local utility u=0.024734 metrics={'f1_val': 0.9485513236040956, 'auprc': 0.9837347874729488, 'loss_val': 0.25509063675277155, 'psi': 0.9626247091516369}-{'f1_val': 0.9454926280584558, 'auprc': 0.9769557528743265, 'loss_val': 0.2658687563245366, 'psi': 0.958077877984804}
[S4] not sending this round → trigger blocked (psi=0.963)
[S5] START round=38 head_norm_before_train=1.409874 cos_to_last_merge=0.8544 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.854
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.6805309938883204, 'auprc': 0.9244267810465528, 'loss_val': 0.31030653524383905, 'psi': 0.7780893087516134}-{'f1_val': 0.7003213174339138, 'auprc': 0.9913843527901972, 'loss_val': 0.19476024205002385, 'psi': 0.8167465315764271}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.630481 cos_to_last_merge=0.9402 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.9216360975995355, 'auprc': 0.9494842221891633, 'loss_val': 0.2411627907941597, 'psi': 0.9327753474353866}-{'f1_val': 0.7036621050215763, 'auprc': 0.798593130648668, 'loss_val': 0.6079678194714254, 'psi': 0.7416345152724131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=38 head_norm_before_train=1.618428 cos_to_last_merge=0.7896 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.790
[S7] round=38 local utility u=0.243380 metrics={'f1_val': 0.6392088331468012, 'auprc': 0.8044267469906583, 'loss_val': 0.4476227346137502, 'psi': 0.7052959986843441}-{'f1_val': 0.598342740238371, 'auprc': 0.7906284818424505, 'loss_val': 0.6477916242960174, 'psi': 0.6752570368800028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=38 head_norm_before_train=1.999394 (no previous merge yet)
[S8] round=38 local utility u=0.529538 metrics={'f1_val': 0.9862034439475675, 'auprc': 0.9988304103983388, 'loss_val': 0.04387443865561934, 'psi': 0.991254230527876}-{'f1_val': 0.8320440674037101, 'auprc': 0.9859218862779577, 'loss_val': 0.13926907091593088, 'psi': 0.8935951949534091}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=38 head_norm_before_train=2.018737 cos_to_last_merge=0.9499 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=38 local utility u=0.000000 metrics={'f1_val': 0.9888785659900814, 'auprc': 0.9983850488991415, 'loss_val': 0.04016565596981408, 'psi': 0.9926811591537055}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983678548421555, 'loss_val': 0.01982609369066007, 'psi': 0.9973434490251971}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=38 head_norm_before_train=1.721606 cos_to_last_merge=0.9430 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.943
[S10] round=38 local utility u=0.000000 metrics={'f1_val': 0.9930885249073472, 'auprc': 0.9954249111422605, 'loss_val': 0.03881328036817897, 'psi': 0.9940230794013125}-{'f1_val': 0.9949681865317428, 'auprc': 0.9920062473426919, 'loss_val': 0.03874352041405229, 'psi': 0.9937834108561225}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=38 head_norm_before_train=2.102271 cos_to_last_merge=0.9543 (last merge round=11)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9425527237702207, 'auprc': 0.9976507110519667, 'loss_val': 0.1631029729382533, 'psi': 0.964591918682919}-{'f1_val': 0.996305167468861, 'auprc': 0.9975219674929725, 'loss_val': 0.02794112130597305, 'psi': 0.9967918874785056}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=38 head_norm_before_train=1.764861 (no previous merge yet)
[S13] round=38 local utility u=0.260415 metrics={'f1_val': 0.6532400974452304, 'auprc': 0.7848501529557206, 'loss_val': 0.6335127968518169, 'psi': 0.7058841196494264}-{'f1_val': 0.57617944074315, 'auprc': 0.8571593729262266, 'loss_val': 0.9089055333906514, 'psi': 0.6885714136163806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] sending update (kind=head size=1794 to 1 peers)
[S14] START round=38 head_norm_before_train=2.039238 cos_to_last_merge=0.9758 (last merge round=15)
[S14] round=38 local utility u=0.002186 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9975619653344651, 'loss_val': 0.024287907529047272, 'psi': 0.9972252140623328}-{'f1_val': 0.9969975081576651, 'auprc': 0.9971485867851887, 'loss_val': 0.02740040315794416, 'psi': 0.9970579396086745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=38 head_norm_before_train=2.119395 (no previous merge yet)
[S15] round=38 local utility u=0.199489 metrics={'f1_val': 0.885487277815093, 'auprc': 0.9957757278223953, 'loss_val': 0.16834303312412366, 'psi': 0.9296026578180139}-{'f1_val': 0.8367869062120601, 'auprc': 0.9965218152694542, 'loss_val': 0.27735634807941856, 'psi': 0.9006808698350177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=38 head_norm_before_train=1.877134 cos_to_last_merge=0.7927 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.793
[S16] round=38 local utility u=0.548168 metrics={'f1_val': 0.9910740314786896, 'auprc': 0.9935522309371421, 'loss_val': 0.049135884967917674, 'psi': 0.9920653112620705}-{'f1_val': 0.8919281696819488, 'auprc': 0.9903863437115913, 'loss_val': 0.5410998987112833, 'psi': 0.9313114392938058}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=38 head_norm_before_train=1.526454 cos_to_last_merge=0.9074 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.907
[S17] round=38 local utility u=0.000000 metrics={'f1_val': 0.6396074043337204, 'auprc': 0.8250327699271572, 'loss_val': 1.1256138809326788, 'psi': 0.7137775505710952}-{'f1_val': 0.6715224237043103, 'auprc': 0.8332291355092376, 'loss_val': 1.0230767916233794, 'psi': 0.7362051084262812}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=39 head_norm_before_train=1.796500 cos_to_last_merge=0.7793 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.7077924665180637, 'auprc': 0.7382496397703064, 'loss_val': 0.9828261216097143, 'psi': 0.7199753358189608}-{'f1_val': 0.7090021422754698, 'auprc': 0.7408726928023955, 'loss_val': 0.9468817823582506, 'psi': 0.72175036248624}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=40 psi=0.720 u=0.0000 p_local=0.1765 f1=0.708 auprc=0.738 bytes=37800
[S3] START round=39 head_norm_before_train=2.258380 (no previous merge yet)
[S3] round=39 local utility u=0.343932 metrics={'f1_val': 0.9587733347195508, 'auprc': 0.9977684614880269, 'loss_val': 0.09443976966946642, 'psi': 0.9743713854269412}-{'f1_val': 0.8793278666962332, 'auprc': 0.9908727379680796, 'loss_val': 0.2849444689410544, 'psi': 0.9239458152049718}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S3] r=40 psi=0.974 u=0.3439 p_local=0.2601 f1=0.959 auprc=0.998 bytes=32374
[S4] START round=39 head_norm_before_train=1.605375 cos_to_last_merge=0.9166 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.917
[S4] round=39 local utility u=0.000000 metrics={'f1_val': 0.9419349000265209, 'auprc': 0.9638503440131576, 'loss_val': 0.27901123883362006, 'psi': 0.9507010776211756}-{'f1_val': 0.9485513236040956, 'auprc': 0.9837347874729488, 'loss_val': 0.25509063675277155, 'psi': 0.9626247091516369}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=40 psi=0.951 u=0.0000 p_local=0.0163 f1=0.942 auprc=0.964 bytes=46769
[S5] START round=39 head_norm_before_train=1.420619 cos_to_last_merge=0.8521 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.852
[S5] round=39 local utility u=0.000000 metrics={'f1_val': 0.6784656772993038, 'auprc': 0.8540377468871991, 'loss_val': 0.3899064927923439, 'psi': 0.748694505134462}-{'f1_val': 0.6805309938883204, 'auprc': 0.9244267810465528, 'loss_val': 0.31030653524383905, 'psi': 0.7780893087516134}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=40 psi=0.749 u=0.0000 p_local=0.1762 f1=0.678 auprc=0.854 bytes=41367
[S6] START round=39 head_norm_before_train=1.644922 cos_to_last_merge=0.9377 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=39 local utility u=0.000000 metrics={'f1_val': 0.596577213766058, 'auprc': 0.7372436560043936, 'loss_val': 0.9178382429274987, 'psi': 0.6528437906613922}-{'f1_val': 0.9216360975995355, 'auprc': 0.9494842221891633, 'loss_val': 0.2411627907941597, 'psi': 0.9327753474353866}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=40 psi=0.653 u=0.0000 p_local=0.3985 f1=0.597 auprc=0.737 bytes=32392
[S7] START round=39 head_norm_before_train=1.630323 cos_to_last_merge=0.7883 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.788
[S7] round=39 local utility u=0.255751 metrics={'f1_val': 0.6859681149129373, 'auprc': 0.8474085829339497, 'loss_val': 0.34562186683894985, 'psi': 0.7505443021213423}-{'f1_val': 0.6392088331468012, 'auprc': 0.8044267469906583, 'loss_val': 0.4476227346137502, 'psi': 0.7052959986843441}
[S7] not sending this round → trigger blocked (psi=0.751)
[S7] r=40 psi=0.751 u=0.2558 p_local=0.1740 f1=0.686 auprc=0.847 bytes=37811
[S8] START round=39 head_norm_before_train=2.006320 (no previous merge yet)
[S8] round=39 local utility u=0.028399 metrics={'f1_val': 0.9938366423490096, 'auprc': 0.9986679515450125, 'loss_val': 0.03238877331326953, 'psi': 0.9957691660274107}-{'f1_val': 0.9862034439475675, 'auprc': 0.9988304103983388, 'loss_val': 0.04387443865561934, 'psi': 0.991254230527876}
[S8] not sending this round → trigger blocked (psi=0.996)
[S8] r=40 psi=0.996 u=0.0284 p_local=0.1280 f1=0.994 auprc=0.999 bytes=39566
[S9] START round=39 head_norm_before_train=2.029394 cos_to_last_merge=0.9490 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.949
[S9] round=39 local utility u=0.025619 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9932810819869585, 'loss_val': 0.02049919939890828, 'psi': 0.9953279275536407}-{'f1_val': 0.9888785659900814, 'auprc': 0.9983850488991415, 'loss_val': 0.04016565596981408, 'psi': 0.9926811591537055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S9] r=40 psi=0.995 u=0.0256 p_local=0.0080 f1=0.997 auprc=0.993 bytes=44957
[S10] START round=39 head_norm_before_train=1.736414 cos_to_last_merge=0.9417 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.942
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9933912722021898, 'loss_val': 0.03638412650472617, 'psi': 0.9932846983652044}-{'f1_val': 0.9930885249073472, 'auprc': 0.9954249111422605, 'loss_val': 0.03881328036817897, 'psi': 0.9940230794013125}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=40 psi=0.993 u=0.0000 p_local=0.0037 f1=0.993 auprc=0.993 bytes=43201
[S11] START round=39 head_norm_before_train=2.105306 cos_to_last_merge=0.9544 (last merge round=11)
[S11] round=39 local utility u=0.229749 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9973407339505496, 'loss_val': 0.02664139590986008, 'psi': 0.9968644962883736}-{'f1_val': 0.9425527237702207, 'auprc': 0.9976507110519667, 'loss_val': 0.1631029729382533, 'psi': 0.964591918682919}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S11] r=40 psi=0.997 u=0.2297 p_local=0.1637 f1=0.997 auprc=0.997 bytes=48522
[S13] START round=39 head_norm_before_train=1.770067 (no previous merge yet)
[S13] round=39 local utility u=0.000000 metrics={'f1_val': 0.6223329012772374, 'auprc': 0.7480474944580515, 'loss_val': 0.8071739093272626, 'psi': 0.672618738549563}-{'f1_val': 0.6532400974452304, 'auprc': 0.7848501529557206, 'loss_val': 0.6335127968518169, 'psi': 0.7058841196494264}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=40 psi=0.673 u=0.0000 p_local=0.0865 f1=0.622 auprc=0.748 bytes=37750
[S14] START round=39 head_norm_before_train=2.046932 cos_to_last_merge=0.9752 (last merge round=15)
[S14] round=39 local utility u=0.005418 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9991672112928889, 'loss_val': 0.022186386330355967, 'psi': 0.9982591902067292}-{'f1_val': 0.9970007132142444, 'auprc': 0.9975619653344651, 'loss_val': 0.024287907529047272, 'psi': 0.9972252140623328}
[S14] not sending this round → trigger blocked (psi=0.998)
[S14] r=40 psi=0.998 u=0.0054 p_local=0.0190 f1=0.998 auprc=0.999 bytes=44956
[S15] START round=39 head_norm_before_train=2.129984 (no previous merge yet)
[S15] round=39 local utility u=0.410334 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980769087266308, 'loss_val': 0.022134106422718278, 'psi': 0.9972787645231647}-{'f1_val': 0.885487277815093, 'auprc': 0.9957757278223953, 'loss_val': 0.16834303312412366, 'psi': 0.9296026578180139}
[S15] not sending this round → trigger blocked (psi=0.997)
[S15] r=40 psi=0.997 u=0.4103 p_local=0.2657 f1=0.997 auprc=0.998 bytes=39547
[S16] START round=39 head_norm_before_train=1.885171 cos_to_last_merge=0.7919 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.792
[S16] round=39 local utility u=0.016142 metrics={'f1_val': 0.9924075982136004, 'auprc': 0.9971416970500802, 'loss_val': 0.035621811434565775, 'psi': 0.9943012377481922}-{'f1_val': 0.9910740314786896, 'auprc': 0.9935522309371421, 'loss_val': 0.049135884967917674, 'psi': 0.9920653112620705}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S16] r=40 psi=0.994 u=0.0161 p_local=0.2460 f1=0.992 auprc=0.997 bytes=37754
[S17] START round=39 head_norm_before_train=1.540564 cos_to_last_merge=0.9055 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.905
[S17] round=39 local utility u=0.091178 metrics={'f1_val': 0.6535711049350001, 'auprc': 0.8320335577884563, 'loss_val': 1.0480417322265225, 'psi': 0.7249560860763826}-{'f1_val': 0.6396074043337204, 'auprc': 0.8250327699271572, 'loss_val': 1.1256138809326788, 'psi': 0.7137775505710952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S17] r=40 psi=0.725 u=0.0912 p_local=0.0988 f1=0.654 auprc=0.832 bytes=34202
[S2] START round=40 head_norm_before_train=1.806962 cos_to_last_merge=0.7787 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.779
[S2] round=40 local utility u=0.000000 metrics={'f1_val': 0.6365401439198709, 'auprc': 0.7380683015992124, 'loss_val': 1.4289093402499295, 'psi': 0.6771514069916076}-{'f1_val': 0.7077924665180637, 'auprc': 0.7382496397703064, 'loss_val': 0.9828261216097143, 'psi': 0.7199753358189608}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=40 head_norm_before_train=2.269640 (no previous merge yet)
[S3] round=40 local utility u=0.000000 metrics={'f1_val': 0.938595233569493, 'auprc': 0.9980417116735173, 'loss_val': 0.12931333426005595, 'psi': 0.9623738248111028}-{'f1_val': 0.9587733347195508, 'auprc': 0.9977684614880269, 'loss_val': 0.09443976966946642, 'psi': 0.9743713854269412}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=40 head_norm_before_train=1.612111 cos_to_last_merge=0.9156 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.916
[S4] round=40 local utility u=0.058394 metrics={'f1_val': 0.9480316992887042, 'auprc': 0.9838009154451388, 'loss_val': 0.2586550137128003, 'psi': 0.9623393857512781}-{'f1_val': 0.9419349000265209, 'auprc': 0.9638503440131576, 'loss_val': 0.27901123883362006, 'psi': 0.9507010776211756}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=40 head_norm_before_train=1.433798 cos_to_last_merge=0.8504 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.850
[S5] round=40 local utility u=0.000000 metrics={'f1_val': 0.6501433184520684, 'auprc': 0.8707522877909004, 'loss_val': 0.40386964284261967, 'psi': 0.7383869061876012}-{'f1_val': 0.6784656772993038, 'auprc': 0.8540377468871991, 'loss_val': 0.3899064927923439, 'psi': 0.748694505134462}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=40 head_norm_before_train=1.655665 cos_to_last_merge=0.9355 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=40 local utility u=1.000000 metrics={'f1_val': 0.9667407742652225, 'auprc': 0.9466561053128036, 'loss_val': 0.1458994070953668, 'psi': 0.958706906684255}-{'f1_val': 0.596577213766058, 'auprc': 0.7372436560043936, 'loss_val': 0.9178382429274987, 'psi': 0.6528437906613922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=40 head_norm_before_train=1.639518 cos_to_last_merge=0.7874 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.787
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.658590316894704, 'auprc': 0.8119329188312427, 'loss_val': 0.3973894619880368, 'psi': 0.7199273576693195}-{'f1_val': 0.6859681149129373, 'auprc': 0.8474085829339497, 'loss_val': 0.34562186683894985, 'psi': 0.7505443021213423}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=2.013313 (no previous merge yet)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9933514266435809, 'auprc': 0.998752095598758, 'loss_val': 0.029769999605457297, 'psi': 0.9955116942256518}-{'f1_val': 0.9938366423490096, 'auprc': 0.9986679515450125, 'loss_val': 0.03238877331326953, 'psi': 0.9957691660274107}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=40 head_norm_before_train=2.039691 cos_to_last_merge=0.9481 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.948
[S9] round=40 local utility u=0.000000 metrics={'f1_val': 0.9897071435092063, 'auprc': 0.9986275581271651, 'loss_val': 0.03519466031541614, 'psi': 0.9932753093563897}-{'f1_val': 0.9966924912647621, 'auprc': 0.9932810819869585, 'loss_val': 0.02049919939890828, 'psi': 0.9953279275536407}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=40 head_norm_before_train=1.751201 cos_to_last_merge=0.9403 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.940
[S10] round=40 local utility u=0.000607 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.993606116363049, 'loss_val': 0.035814641536294003, 'psi': 0.993370636029548}-{'f1_val': 0.9932136491405474, 'auprc': 0.9933912722021898, 'loss_val': 0.03638412650472617, 'psi': 0.9932846983652044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] START round=40 head_norm_before_train=2.108699 cos_to_last_merge=0.9543 (last merge round=11)
[S11] round=40 local utility u=0.000754 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9970348843938153, 'loss_val': 0.025789535934253392, 'psi': 0.9968994636132734}-{'f1_val': 0.9965470045135896, 'auprc': 0.9973407339505496, 'loss_val': 0.02664139590986008, 'psi': 0.9968644962883736}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=40 head_norm_before_train=1.774474 (no previous merge yet)
[S13] round=40 local utility u=0.325033 metrics={'f1_val': 0.6743563970116584, 'auprc': 0.8436091985490368, 'loss_val': 0.7559345286834068, 'psi': 0.7420575176266098}-{'f1_val': 0.6223329012772374, 'auprc': 0.7480474944580515, 'loss_val': 0.8071739093272626, 'psi': 0.672618738549563}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] sending update (kind=head size=1803 to 1 peers)
[S14] START round=40 head_norm_before_train=2.054574 cos_to_last_merge=0.9748 (last merge round=15)
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971569556233842, 'loss_val': 0.025031828905781518, 'psi': 0.997307743950389}-{'f1_val': 0.9976538428159559, 'auprc': 0.9991672112928889, 'loss_val': 0.022186386330355967, 'psi': 0.9982591902067292}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=2.138410 (no previous merge yet)
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.7009180804352899, 'auprc': 0.8554423968592461, 'loss_val': 0.6502283238775358, 'psi': 0.7627278070048724}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980769087266308, 'loss_val': 0.022134106422718278, 'psi': 0.9972787645231647}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.891006 cos_to_last_merge=0.7911 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.791
[S16] round=40 local utility u=0.001992 metrics={'f1_val': 0.9928680781018704, 'auprc': 0.9972461865364557, 'loss_val': 0.034714226334135276, 'psi': 0.9946193214757045}-{'f1_val': 0.9924075982136004, 'auprc': 0.9971416970500802, 'loss_val': 0.035621811434565775, 'psi': 0.9943012377481922}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=40 head_norm_before_train=1.554637 cos_to_last_merge=0.9037 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.904
[S17] round=40 local utility u=0.000000 metrics={'f1_val': 0.6532207186147323, 'auprc': 0.8288492473400859, 'loss_val': 1.129129113650918, 'psi': 0.7234721301048738}-{'f1_val': 0.6535711049350001, 'auprc': 0.8320335577884563, 'loss_val': 1.0480417322265225, 'psi': 0.7249560860763826}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=41 head_norm_before_train=1.817685 cos_to_last_merge=0.7781 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.778
[S2] round=41 local utility u=0.038189 metrics={'f1_val': 0.6224800034748215, 'auprc': 0.7320523452303774, 'loss_val': 1.2501228352687228, 'psi': 0.6663089401770439}-{'f1_val': 0.6365401439198709, 'auprc': 0.7380683015992124, 'loss_val': 1.4289093402499295, 'psi': 0.6771514069916076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=41 head_norm_before_train=2.280754 (no previous merge yet)
[S3] round=41 local utility u=0.070308 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9989678838366496, 'loss_val': 0.12659567359650326, 'psi': 0.9762563078753512}-{'f1_val': 0.938595233569493, 'auprc': 0.9980417116735173, 'loss_val': 0.12931333426005595, 'psi': 0.9623738248111028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=41 head_norm_before_train=1.620077 cos_to_last_merge=0.9146 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.915
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9483520070677574, 'auprc': 0.981577400019356, 'loss_val': 0.2609137890427791, 'psi': 0.9616421642483969}-{'f1_val': 0.9480316992887042, 'auprc': 0.9838009154451388, 'loss_val': 0.2586550137128003, 'psi': 0.9623393857512781}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=1.443858 cos_to_last_merge=0.8491 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.849
[S5] round=41 local utility u=0.977973 metrics={'f1_val': 0.8732251416006004, 'auprc': 0.9928486913296799, 'loss_val': 0.15270369368809683, 'psi': 0.9210745614922322}-{'f1_val': 0.6501433184520684, 'auprc': 0.8707522877909004, 'loss_val': 0.40386964284261967, 'psi': 0.7383869061876012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=41 head_norm_before_train=1.662804 cos_to_last_merge=0.9342 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.934
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.8219614103374767, 'auprc': 0.9583225431709113, 'loss_val': 0.3509156621626446, 'psi': 0.8765058634708506}-{'f1_val': 0.9667407742652225, 'auprc': 0.9466561053128036, 'loss_val': 0.1458994070953668, 'psi': 0.958706906684255}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.641823 cos_to_last_merge=0.7862 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=41 local utility u=0.295437 metrics={'f1_val': 0.7188733487206478, 'auprc': 0.8496372917413103, 'loss_val': 0.2813262697564837, 'psi': 0.7711789259289128}-{'f1_val': 0.658590316894704, 'auprc': 0.8119329188312427, 'loss_val': 0.3973894619880368, 'psi': 0.7199273576693195}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=41 head_norm_before_train=2.023817 (no previous merge yet)
[S8] round=41 local utility u=0.000000 metrics={'f1_val': 0.9887021880404929, 'auprc': 0.9989201573313797, 'loss_val': 0.037304384811190326, 'psi': 0.9927893757568476}-{'f1_val': 0.9933514266435809, 'auprc': 0.998752095598758, 'loss_val': 0.029769999605457297, 'psi': 0.9955116942256518}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=41 head_norm_before_train=2.044782 cos_to_last_merge=0.9473 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=41 local utility u=0.018278 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9933965547542842, 'loss_val': 0.022204089082987023, 'psi': 0.9951086787692802}-{'f1_val': 0.9897071435092063, 'auprc': 0.9986275581271651, 'loss_val': 0.03519466031541614, 'psi': 0.9932753093563897}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=41 head_norm_before_train=1.760692 cos_to_last_merge=0.9392 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.939
[S10] round=41 local utility u=0.002383 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9952057564554048, 'loss_val': 0.03665915503272677, 'psi': 0.9940916609931036}-{'f1_val': 0.9932136491405474, 'auprc': 0.993606116363049, 'loss_val': 0.035814641536294003, 'psi': 0.993370636029548}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=41 head_norm_before_train=2.114139 cos_to_last_merge=0.9539 (last merge round=11)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9965425987306433, 'loss_val': 0.026265190977842183, 'psi': 0.9965452422004111}-{'f1_val': 0.9968091830929121, 'auprc': 0.9970348843938153, 'loss_val': 0.025789535934253392, 'psi': 0.9968994636132734}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=41 head_norm_before_train=1.780306 (no previous merge yet)
[S13] round=41 local utility u=0.000000 metrics={'f1_val': 0.600060828838654, 'auprc': 0.7505707644388958, 'loss_val': 0.8147164025092781, 'psi': 0.6602648030787508}-{'f1_val': 0.6743563970116584, 'auprc': 0.8436091985490368, 'loss_val': 0.7559345286834068, 'psi': 0.7420575176266098}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=41 head_norm_before_train=2.062314 cos_to_last_merge=0.9743 (last merge round=15)
[S14] round=41 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971574164201342, 'loss_val': 0.028098407459151827, 'psi': 0.9975546773483848}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971569556233842, 'loss_val': 0.025031828905781518, 'psi': 0.997307743950389}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=41 head_norm_before_train=2.146112 (no previous merge yet)
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9983626673983161, 'loss_val': 0.023647156657267257, 'psi': 0.9972606343250773}-{'f1_val': 0.7009180804352899, 'auprc': 0.8554423968592461, 'loss_val': 0.6502283238775358, 'psi': 0.7627278070048724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=41 head_norm_before_train=1.898910 cos_to_last_merge=0.7904 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=41 local utility u=0.000000 metrics={'f1_val': 0.9915631247826445, 'auprc': 0.9907685947541868, 'loss_val': 0.03847622273036009, 'psi': 0.9912453127712615}-{'f1_val': 0.9928680781018704, 'auprc': 0.9972461865364557, 'loss_val': 0.034714226334135276, 'psi': 0.9946193214757045}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=41 head_norm_before_train=1.572306 cos_to_last_merge=0.9011 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.901
[S17] round=41 local utility u=0.080614 metrics={'f1_val': 0.6694174234612793, 'auprc': 0.8325777622018287, 'loss_val': 1.0762676175134152, 'psi': 0.7346815589574991}-{'f1_val': 0.6532207186147323, 'auprc': 0.8288492473400859, 'loss_val': 1.129129113650918, 'psi': 0.7234721301048738}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=42 head_norm_before_train=1.826189 cos_to_last_merge=0.7774 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=42 local utility u=0.350123 metrics={'f1_val': 0.7064081250814263, 'auprc': 0.7332835072291448, 'loss_val': 1.057139275979234, 'psi': 0.7171582779405137}-{'f1_val': 0.6224800034748215, 'auprc': 0.7320523452303774, 'loss_val': 1.2501228352687228, 'psi': 0.6663089401770439}
[S2] not sending this round → trigger blocked (psi=0.717)
[S3] START round=42 head_norm_before_train=2.292026 (no previous merge yet)
[S3] round=42 local utility u=0.001811 metrics={'f1_val': 0.9610750853994537, 'auprc': 0.998494563396393, 'loss_val': 0.12131185709400451, 'psi': 0.9760428765982294}-{'f1_val': 0.9611152572344858, 'auprc': 0.9989678838366496, 'loss_val': 0.12659567359650326, 'psi': 0.9762563078753512}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=42 head_norm_before_train=1.627243 cos_to_last_merge=0.9138 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.914
[S4] round=42 local utility u=0.010892 metrics={'f1_val': 0.9517120596250265, 'auprc': 0.980843241205698, 'loss_val': 0.25708695298273204, 'psi': 0.9633645322572951}-{'f1_val': 0.9483520070677574, 'auprc': 0.981577400019356, 'loss_val': 0.2609137890427791, 'psi': 0.9616421642483969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=42 head_norm_before_train=1.451817 cos_to_last_merge=0.8480 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.848
[S5] round=42 local utility u=0.000000 metrics={'f1_val': 0.7087587615387538, 'auprc': 0.9896769994106362, 'loss_val': 0.21087230183237277, 'psi': 0.8211260566875068}-{'f1_val': 0.8732251416006004, 'auprc': 0.9928486913296799, 'loss_val': 0.15270369368809683, 'psi': 0.9210745614922322}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=42 head_norm_before_train=1.669677 cos_to_last_merge=0.9329 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=42 local utility u=0.000000 metrics={'f1_val': 0.7278157630621476, 'auprc': 0.7984372540956096, 'loss_val': 0.6084855806648369, 'psi': 0.7560643594755324}-{'f1_val': 0.8219614103374767, 'auprc': 0.9583225431709113, 'loss_val': 0.3509156621626446, 'psi': 0.8765058634708506}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=42 head_norm_before_train=1.645176 cos_to_last_merge=0.7859 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=42 local utility u=0.000000 metrics={'f1_val': 0.611971603405957, 'auprc': 0.7923635234931399, 'loss_val': 0.6474519871081388, 'psi': 0.6841283714408302}-{'f1_val': 0.7188733487206478, 'auprc': 0.8496372917413103, 'loss_val': 0.2813262697564837, 'psi': 0.7711789259289128}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=42 head_norm_before_train=2.035882 (no previous merge yet)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9703688797129641, 'auprc': 0.9988594579008677, 'loss_val': 0.07435379025015235, 'psi': 0.9817651109881256}-{'f1_val': 0.9887021880404929, 'auprc': 0.9989201573313797, 'loss_val': 0.037304384811190326, 'psi': 0.9927893757568476}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=42 head_norm_before_train=2.047862 cos_to_last_merge=0.9465 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.947
[S9] round=42 local utility u=0.009338 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9981483845697563, 'loss_val': 0.02024688637050854, 'psi': 0.9972556609162374}-{'f1_val': 0.9962500947792776, 'auprc': 0.9933965547542842, 'loss_val': 0.022204089082987023, 'psi': 0.9951086787692802}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=42 head_norm_before_train=1.766888 cos_to_last_merge=0.9381 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.938
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9932136491405474, 'auprc': 0.9940201865445449, 'loss_val': 0.03460428391454944, 'psi': 0.9935362641021465}-{'f1_val': 0.9933489306849028, 'auprc': 0.9952057564554048, 'loss_val': 0.03665915503272677, 'psi': 0.9940916609931036}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=42 head_norm_before_train=2.120537 cos_to_last_merge=0.9533 (last merge round=11)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9962920180410275, 'loss_val': 0.025868663990947536, 'psi': 0.9964572896001392}-{'f1_val': 0.9965470045135896, 'auprc': 0.9965425987306433, 'loss_val': 0.026265190977842183, 'psi': 0.9965452422004111}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=42 head_norm_before_train=1.783504 (no previous merge yet)
[S13] round=42 local utility u=0.381750 metrics={'f1_val': 0.6585786821732789, 'auprc': 0.8266443769985389, 'loss_val': 0.6305439035811369, 'psi': 0.7258049601033829}-{'f1_val': 0.600060828838654, 'auprc': 0.7505707644388958, 'loss_val': 0.8147164025092781, 'psi': 0.6602648030787508}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=42 head_norm_before_train=2.069338 cos_to_last_merge=0.9738 (last merge round=15)
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9746899199125819, 'auprc': 0.9971564089384772, 'loss_val': 0.05077084286425536, 'psi': 0.9836765155229401}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971574164201342, 'loss_val': 0.028098407459151827, 'psi': 0.9975546773483848}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=2.154415 (no previous merge yet)
[S15] round=42 local utility u=0.001523 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.998094872607898, 'loss_val': 0.021122480790109432, 'psi': 0.9972859500756716}-{'f1_val': 0.9965259456095847, 'auprc': 0.9983626673983161, 'loss_val': 0.023647156657267257, 'psi': 0.9972606343250773}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=42 head_norm_before_train=1.907102 cos_to_last_merge=0.7897 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.790
[S16] round=42 local utility u=0.015613 metrics={'f1_val': 0.9924497697178112, 'auprc': 0.998245133262957, 'loss_val': 0.03499977101422666, 'psi': 0.9947679151358696}-{'f1_val': 0.9915631247826445, 'auprc': 0.9907685947541868, 'loss_val': 0.03847622273036009, 'psi': 0.9912453127712615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=42 head_norm_before_train=1.591758 cos_to_last_merge=0.8984 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.898
[S17] round=42 local utility u=0.000000 metrics={'f1_val': 0.6448280392089618, 'auprc': 0.8232304238245749, 'loss_val': 1.197869254755, 'psi': 0.716188993055207}-{'f1_val': 0.6694174234612793, 'auprc': 0.8325777622018287, 'loss_val': 1.0762676175134152, 'psi': 0.7346815589574991}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=43 head_norm_before_train=1.834174 cos_to_last_merge=0.7767 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.777
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.5693070063107204, 'auprc': 0.7067734029573042, 'loss_val': 1.6772710382466842, 'psi': 0.624293564969354}-{'f1_val': 0.7064081250814263, 'auprc': 0.7332835072291448, 'loss_val': 1.057139275979234, 'psi': 0.7171582779405137}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=43 head_norm_before_train=2.302879 (no previous merge yet)
[S3] round=43 local utility u=0.000000 metrics={'f1_val': 0.9251754501669129, 'auprc': 0.9969301917615678, 'loss_val': 0.16887227425686954, 'psi': 0.953877346804775}-{'f1_val': 0.9610750853994537, 'auprc': 0.998494563396393, 'loss_val': 0.12131185709400451, 'psi': 0.9760428765982294}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=43 head_norm_before_train=1.633926 cos_to_last_merge=0.9129 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.913
[S4] round=43 local utility u=0.014480 metrics={'f1_val': 0.9535577513510664, 'auprc': 0.9848829886558159, 'loss_val': 0.25132124878761036, 'psi': 0.9660878462729661}-{'f1_val': 0.9517120596250265, 'auprc': 0.980843241205698, 'loss_val': 0.25708695298273204, 'psi': 0.9633645322572951}
[S4] not sending this round → trigger blocked (psi=0.966)
[S5] START round=43 head_norm_before_train=1.460145 cos_to_last_merge=0.8466 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.847
[S5] round=43 local utility u=0.000000 metrics={'f1_val': 0.7409752712280697, 'auprc': 0.9288938712552999, 'loss_val': 0.3402624062900499, 'psi': 0.8161427112389619}-{'f1_val': 0.7087587615387538, 'auprc': 0.9896769994106362, 'loss_val': 0.21087230183237277, 'psi': 0.8211260566875068}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=43 head_norm_before_train=1.677119 cos_to_last_merge=0.9314 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=43 local utility u=0.577739 metrics={'f1_val': 0.8074481887562448, 'auprc': 0.927022825172501, 'loss_val': 0.31655839071244196, 'psi': 0.8552780433227473}-{'f1_val': 0.7278157630621476, 'auprc': 0.7984372540956096, 'loss_val': 0.6084855806648369, 'psi': 0.7560643594755324}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=43 head_norm_before_train=1.652213 cos_to_last_merge=0.7860 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=43 local utility u=0.000000 metrics={'f1_val': 0.44253745140666234, 'auprc': 0.7789448944674388, 'loss_val': 1.2394816496454377, 'psi': 0.5771004286309729}-{'f1_val': 0.611971603405957, 'auprc': 0.7923635234931399, 'loss_val': 0.6474519871081388, 'psi': 0.6841283714408302}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=43 head_norm_before_train=2.042224 (no previous merge yet)
[S8] round=43 local utility u=0.087186 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9984447837604948, 'loss_val': 0.03551424092633355, 'psi': 0.9952768244350099}-{'f1_val': 0.9703688797129641, 'auprc': 0.9988594579008677, 'loss_val': 0.07435379025015235, 'psi': 0.9817651109881256}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] sending update (kind=head size=1793 to 1 peers)
[S9] START round=43 head_norm_before_train=2.055915 cos_to_last_merge=0.9456 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.946
[S9] round=43 local utility u=0.001207 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986769579296204, 'loss_val': 0.01941883572930526, 'psi': 0.997467090260183}-{'f1_val': 0.9966605118138915, 'auprc': 0.9981483845697563, 'loss_val': 0.02024688637050854, 'psi': 0.9972556609162374}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=43 head_norm_before_train=1.775965 cos_to_last_merge=0.9371 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.937
[S10] round=43 local utility u=0.002703 metrics={'f1_val': 0.9940903254969471, 'auprc': 0.9935684270558109, 'loss_val': 0.03310218934855898, 'psi': 0.9938815661204926}-{'f1_val': 0.9932136491405474, 'auprc': 0.9940201865445449, 'loss_val': 0.03460428391454944, 'psi': 0.9935362641021465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=43 head_norm_before_train=2.128423 cos_to_last_merge=0.9524 (last merge round=11)
[S11] round=43 local utility u=0.001164 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9961465420646985, 'loss_val': 0.02455397378006412, 'psi': 0.9965441266816267}-{'f1_val': 0.996567470639547, 'auprc': 0.9962920180410275, 'loss_val': 0.025868663990947536, 'psi': 0.9964572896001392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] START round=43 head_norm_before_train=1.785701 (no previous merge yet)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.6347386723961266, 'auprc': 0.8451745175218708, 'loss_val': 0.85662958233906, 'psi': 0.7189130104464243}-{'f1_val': 0.6585786821732789, 'auprc': 0.8266443769985389, 'loss_val': 0.6305439035811369, 'psi': 0.7258049601033829}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=43 head_norm_before_train=2.076242 cos_to_last_merge=0.9734 (last merge round=15)
[S14] round=43 local utility u=0.084749 metrics={'f1_val': 0.9980623665153463, 'auprc': 0.9975341260568764, 'loss_val': 0.02264024467622215, 'psi': 0.9978510703319584}-{'f1_val': 0.9746899199125819, 'auprc': 0.9971564089384772, 'loss_val': 0.05077084286425536, 'psi': 0.9836765155229401}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=43 head_norm_before_train=2.162402 (no previous merge yet)
[S15] round=43 local utility u=0.000000 metrics={'f1_val': 0.8071436390110934, 'auprc': 0.9911793276272571, 'loss_val': 0.2943624385528518, 'psi': 0.8807579144575589}-{'f1_val': 0.9967466683875206, 'auprc': 0.998094872607898, 'loss_val': 0.021122480790109432, 'psi': 0.9972859500756716}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=43 head_norm_before_train=1.916685 cos_to_last_merge=0.7890 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.789
[S16] round=43 local utility u=0.000000 metrics={'f1_val': 0.9187647191038191, 'auprc': 0.9888725965755908, 'loss_val': 0.46953881016486493, 'psi': 0.9468078700925278}-{'f1_val': 0.9924497697178112, 'auprc': 0.998245133262957, 'loss_val': 0.03499977101422666, 'psi': 0.9947679151358696}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=43 head_norm_before_train=1.605637 cos_to_last_merge=0.8962 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.896
[S17] round=43 local utility u=0.197966 metrics={'f1_val': 0.6792823542588341, 'auprc': 0.8402736119819489, 'loss_val': 1.0597919136423024, 'psi': 0.74367885734808}-{'f1_val': 0.6448280392089618, 'auprc': 0.8232304238245749, 'loss_val': 1.197869254755, 'psi': 0.716188993055207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=44 head_norm_before_train=1.842601 cos_to_last_merge=0.7761 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=44 local utility u=0.469141 metrics={'f1_val': 0.6584124859923086, 'auprc': 0.7319379214164139, 'loss_val': 1.349115266784068, 'psi': 0.6878226601619507}-{'f1_val': 0.5693070063107204, 'auprc': 0.7067734029573042, 'loss_val': 1.6772710382466842, 'psi': 0.624293564969354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] sending update (kind=head size=1798 to 1 peers)
[S3] START round=44 head_norm_before_train=2.311523 (no previous merge yet)
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.861815155518365, 'auprc': 0.9980562521587608, 'loss_val': 0.33274213474139513, 'psi': 0.9163115941745232}-{'f1_val': 0.9251754501669129, 'auprc': 0.9969301917615678, 'loss_val': 0.16887227425686954, 'psi': 0.953877346804775}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.643404 cos_to_last_merge=0.9118 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.912
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9555376401323917, 'auprc': 0.9804397479518139, 'loss_val': 0.2510925041835223, 'psi': 0.9654984832601606}-{'f1_val': 0.9535577513510664, 'auprc': 0.9848829886558159, 'loss_val': 0.25132124878761036, 'psi': 0.9660878462729661}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=1.470750 cos_to_last_merge=0.8451 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.845
[S5] round=44 local utility u=0.977965 metrics={'f1_val': 0.9961420887187077, 'auprc': 0.9964652121819879, 'loss_val': 0.11804781265697674, 'psi': 0.9962713381040198}-{'f1_val': 0.7409752712280697, 'auprc': 0.9288938712552999, 'loss_val': 0.3402624062900499, 'psi': 0.8161427112389619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=44 head_norm_before_train=1.687434 cos_to_last_merge=0.9299 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.7463004034283882, 'auprc': 0.8067425023883017, 'loss_val': 0.6367998252070082, 'psi': 0.7704772430123537}-{'f1_val': 0.8074481887562448, 'auprc': 0.927022825172501, 'loss_val': 0.31655839071244196, 'psi': 0.8552780433227473}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.656053 cos_to_last_merge=0.7862 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=44 local utility u=1.000000 metrics={'f1_val': 0.6757503223063419, 'auprc': 0.8235255002571713, 'loss_val': 0.31500714611633873, 'psi': 0.7348603934866736}-{'f1_val': 0.44253745140666234, 'auprc': 0.7789448944674388, 'loss_val': 1.2394816496454377, 'psi': 0.5771004286309729}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=44 head_norm_before_train=2.045720 (no previous merge yet)
[S8] round=44 local utility u=0.000000 metrics={'f1_val': 0.7584829428040821, 'auprc': 0.9859555861824796, 'loss_val': 0.23119309711976455, 'psi': 0.8494720001554411}-{'f1_val': 0.9931648515513533, 'auprc': 0.9984447837604948, 'loss_val': 0.03551424092633355, 'psi': 0.9952768244350099}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=44 head_norm_before_train=2.065077 cos_to_last_merge=0.9449 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.945
[S9] round=44 local utility u=0.000000 metrics={'f1_val': 0.9931032914010764, 'auprc': 0.9984481654770568, 'loss_val': 0.026162684052185563, 'psi': 0.9952412410314686}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986769579296204, 'loss_val': 0.01941883572930526, 'psi': 0.997467090260183}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=44 head_norm_before_train=1.786682 cos_to_last_merge=0.9360 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.936
[S10] round=44 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9950678551709609, 'loss_val': 0.0352033020380722, 'psi': 0.9940365004793261}-{'f1_val': 0.9940903254969471, 'auprc': 0.9935684270558109, 'loss_val': 0.03310218934855898, 'psi': 0.9938815661204926}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=44 head_norm_before_train=2.137645 cos_to_last_merge=0.9514 (last merge round=11)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9965337900052731, 'loss_val': 0.02434614449540193, 'psi': 0.9965539983858375}-{'f1_val': 0.9968091830929121, 'auprc': 0.9961465420646985, 'loss_val': 0.02455397378006412, 'psi': 0.9965441266816267}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=44 head_norm_before_train=1.792896 (no previous merge yet)
[S13] round=44 local utility u=0.000000 metrics={'f1_val': 0.6340067061026545, 'auprc': 0.839695093257468, 'loss_val': 0.8559879780063396, 'psi': 0.7162820609645799}-{'f1_val': 0.6347386723961266, 'auprc': 0.8451745175218708, 'loss_val': 0.85662958233906, 'psi': 0.7189130104464243}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=44 head_norm_before_train=2.082342 cos_to_last_merge=0.9729 (last merge round=15)
[S14] round=44 local utility u=0.001983 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9988547215296281, 'loss_val': 0.02016802439868331, 'psi': 0.9981325594417634}-{'f1_val': 0.9980623665153463, 'auprc': 0.9975341260568764, 'loss_val': 0.02264024467622215, 'psi': 0.9978510703319584}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=44 head_norm_before_train=2.170837 (no previous merge yet)
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.7252666557038494, 'auprc': 0.9019265102845748, 'loss_val': 0.5641606648531616, 'psi': 0.7959305975361396}-{'f1_val': 0.8071436390110934, 'auprc': 0.9911793276272571, 'loss_val': 0.2943624385528518, 'psi': 0.8807579144575589}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.923340 cos_to_last_merge=0.7884 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.788
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.8507077535755042, 'auprc': 0.9377604082310235, 'loss_val': 0.9760569171328186, 'psi': 0.8855288154377119}-{'f1_val': 0.9187647191038191, 'auprc': 0.9888725965755908, 'loss_val': 0.46953881016486493, 'psi': 0.9468078700925278}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.619189 cos_to_last_merge=0.8938 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.894
[S17] round=44 local utility u=0.000000 metrics={'f1_val': 0.6648694609047493, 'auprc': 0.8341322027519612, 'loss_val': 1.132625891395375, 'psi': 0.732574557643634}-{'f1_val': 0.6792823542588341, 'auprc': 0.8402736119819489, 'loss_val': 1.0597919136423024, 'psi': 0.74367885734808}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=45 head_norm_before_train=1.847454 cos_to_last_merge=0.7758 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6380431420597551, 'auprc': 0.7391637855689619, 'loss_val': 1.4610862212547813, 'psi': 0.6784913994634378}-{'f1_val': 0.6584124859923086, 'auprc': 0.7319379214164139, 'loss_val': 1.349115266784068, 'psi': 0.6878226601619507}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=45 head_norm_before_train=2.320263 (no previous merge yet)
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.821448004894592, 'auprc': 0.9930907312140205, 'loss_val': 0.49511499485524363, 'psi': 0.8901050954223634}-{'f1_val': 0.861815155518365, 'auprc': 0.9980562521587608, 'loss_val': 0.33274213474139513, 'psi': 0.9163115941745232}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.653993 cos_to_last_merge=0.9106 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=45 local utility u=0.000000 metrics={'f1_val': 0.9517665958918432, 'auprc': 0.9848620538375303, 'loss_val': 0.2560544942740807, 'psi': 0.965004779070118}-{'f1_val': 0.9555376401323917, 'auprc': 0.9804397479518139, 'loss_val': 0.2510925041835223, 'psi': 0.9654984832601606}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=45 head_norm_before_train=1.482780 cos_to_last_merge=0.8429 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.843
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.7017729049353254, 'auprc': 0.9897335123345525, 'loss_val': 0.19752327347738052, 'psi': 0.8169571478950163}-{'f1_val': 0.9961420887187077, 'auprc': 0.9964652121819879, 'loss_val': 0.11804781265697674, 'psi': 0.9962713381040198}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.700193 cos_to_last_merge=0.9277 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.928
[S6] round=45 local utility u=1.000000 metrics={'f1_val': 0.9654283773499355, 'auprc': 0.9540892218567953, 'loss_val': 0.14121167539577328, 'psi': 0.9608927151526794}-{'f1_val': 0.7463004034283882, 'auprc': 0.8067425023883017, 'loss_val': 0.6367998252070082, 'psi': 0.7704772430123537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=45 head_norm_before_train=1.657997 cos_to_last_merge=0.7860 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.6589895704764089, 'auprc': 0.8013320001371522, 'loss_val': 0.5602296460587964, 'psi': 0.7159265423407062}-{'f1_val': 0.6757503223063419, 'auprc': 0.8235255002571713, 'loss_val': 0.31500714611633873, 'psi': 0.7348603934866736}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=2.052696 (no previous merge yet)
[S8] round=45 local utility u=0.782813 metrics={'f1_val': 0.983506986749426, 'auprc': 0.9981999498134848, 'loss_val': 0.05244402615235152, 'psi': 0.9893841719750496}-{'f1_val': 0.7584829428040821, 'auprc': 0.9859555861824796, 'loss_val': 0.23119309711976455, 'psi': 0.8494720001554411}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=45 head_norm_before_train=2.072208 cos_to_last_merge=0.9439 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.944
[S9] round=45 local utility u=0.005557 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9937602031831566, 'loss_val': 0.01986483756617439, 'psi': 0.9952541381408292}-{'f1_val': 0.9931032914010764, 'auprc': 0.9984481654770568, 'loss_val': 0.026162684052185563, 'psi': 0.9952412410314686}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=45 head_norm_before_train=1.797924 cos_to_last_merge=0.9350 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.935
[S10] round=45 local utility u=0.002715 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9935474744971371, 'loss_val': 0.03178816205138609, 'psi': 0.994085966116649}-{'f1_val': 0.9933489306849028, 'auprc': 0.9950678551709609, 'loss_val': 0.0352033020380722, 'psi': 0.9940365004793261}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=45 head_norm_before_train=2.147786 cos_to_last_merge=0.9502 (last merge round=11)
[S11] round=45 local utility u=0.000975 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9962653082896095, 'loss_val': 0.023040423763993057, 'psi': 0.996591633171591}-{'f1_val': 0.996567470639547, 'auprc': 0.9965337900052731, 'loss_val': 0.02434614449540193, 'psi': 0.9965539983858375}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=45 head_norm_before_train=1.801561 (no previous merge yet)
[S13] round=45 local utility u=0.372937 metrics={'f1_val': 0.7129159518239723, 'auprc': 0.8555836052463877, 'loss_val': 0.631234063578642, 'psi': 0.7699830131929384}-{'f1_val': 0.6340067061026545, 'auprc': 0.839695093257468, 'loss_val': 0.8559879780063396, 'psi': 0.7162820609645799}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=45 head_norm_before_train=2.090672 cos_to_last_merge=0.9723 (last merge round=15)
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9972064610390196, 'loss_val': 0.020492873032811786, 'psi': 0.9974748901051814}-{'f1_val': 0.9976511180498535, 'auprc': 0.9988547215296281, 'loss_val': 0.02016802439868331, 'psi': 0.9981325594417634}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=2.178412 (no previous merge yet)
[S15] round=45 local utility u=0.725837 metrics={'f1_val': 0.87333227415704, 'auprc': 0.9898851159176625, 'loss_val': 0.2647555988481814, 'psi': 0.9199534108612889}-{'f1_val': 0.7252666557038494, 'auprc': 0.9019265102845748, 'loss_val': 0.5641606648531616, 'psi': 0.7959305975361396}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=45 head_norm_before_train=1.928464 cos_to_last_merge=0.7877 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.788
[S16] round=45 local utility u=0.695382 metrics={'f1_val': 0.9388090743732976, 'auprc': 0.995350555449859, 'loss_val': 0.2866713660698012, 'psi': 0.9614256668039222}-{'f1_val': 0.8507077535755042, 'auprc': 0.9377604082310235, 'loss_val': 0.9760569171328186, 'psi': 0.8855288154377119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=45 head_norm_before_train=1.632259 cos_to_last_merge=0.8916 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.892
[S17] round=45 local utility u=0.000000 metrics={'f1_val': 0.6460910942097299, 'auprc': 0.8305653131335172, 'loss_val': 1.1934359175806972, 'psi': 0.7198807817792447}-{'f1_val': 0.6648694609047493, 'auprc': 0.8341322027519612, 'loss_val': 1.132625891395375, 'psi': 0.732574557643634}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=46 head_norm_before_train=1.850476 cos_to_last_merge=0.7756 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.776
[S2] round=46 local utility u=0.000000 metrics={'f1_val': 0.548465090065915, 'auprc': 0.6827668324311702, 'loss_val': 1.629469895748336, 'psi': 0.6021857870120171}-{'f1_val': 0.6380431420597551, 'auprc': 0.7391637855689619, 'loss_val': 1.4610862212547813, 'psi': 0.6784913994634378}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=46 head_norm_before_train=2.328735 (no previous merge yet)
[S3] round=46 local utility u=0.761694 metrics={'f1_val': 0.9948742836727336, 'auprc': 0.9989237982076001, 'loss_val': 0.029783007871090953, 'psi': 0.9964940894866802}-{'f1_val': 0.821448004894592, 'auprc': 0.9930907312140205, 'loss_val': 0.49511499485524363, 'psi': 0.8901050954223634}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=46 head_norm_before_train=1.660918 cos_to_last_merge=0.9094 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.909
[S4] round=46 local utility u=0.017804 metrics={'f1_val': 0.9551405583307485, 'auprc': 0.9857989062368361, 'loss_val': 0.24350083725664537, 'psi': 0.9674038974931836}-{'f1_val': 0.9517665958918432, 'auprc': 0.9848620538375303, 'loss_val': 0.2560544942740807, 'psi': 0.965004779070118}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=46 head_norm_before_train=1.491341 cos_to_last_merge=0.8419 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.842
[S5] round=46 local utility u=0.341143 metrics={'f1_val': 0.8494208106206687, 'auprc': 0.9607676127118375, 'loss_val': 0.314226468671003, 'psi': 0.8939595314571361}-{'f1_val': 0.7017729049353254, 'auprc': 0.9897335123345525, 'loss_val': 0.19752327347738052, 'psi': 0.8169571478950163}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=46 head_norm_before_train=1.712252 cos_to_last_merge=0.9260 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.926
[S6] round=46 local utility u=0.000000 metrics={'f1_val': 0.5982622133716182, 'auprc': 0.767222888215199, 'loss_val': 0.9233161570953705, 'psi': 0.6658464833090505}-{'f1_val': 0.9654283773499355, 'auprc': 0.9540892218567953, 'loss_val': 0.14121167539577328, 'psi': 0.9608927151526794}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=46 head_norm_before_train=1.665496 cos_to_last_merge=0.7863 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.786
[S7] round=46 local utility u=0.101011 metrics={'f1_val': 0.6642883443043521, 'auprc': 0.8076016117535489, 'loss_val': 0.4088089019737153, 'psi': 0.7216136512840308}-{'f1_val': 0.6589895704764089, 'auprc': 0.8013320001371522, 'loss_val': 0.5602296460587964, 'psi': 0.7159265423407062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=46 head_norm_before_train=2.060266 (no previous merge yet)
[S8] round=46 local utility u=0.014558 metrics={'f1_val': 0.9862034439475675, 'auprc': 0.9989146876824306, 'loss_val': 0.04165108379398506, 'psi': 0.9912879414415128}-{'f1_val': 0.983506986749426, 'auprc': 0.9981999498134848, 'loss_val': 0.05244402615235152, 'psi': 0.9893841719750496}
[S8] not sending this round → trigger blocked (psi=0.991)
[S9] START round=46 head_norm_before_train=2.081271 cos_to_last_merge=0.9431 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.943
[S9] round=46 local utility u=0.007822 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986201453346442, 'loss_val': 0.01976122760603058, 'psi': 0.9972941695341901}-{'f1_val': 0.9962500947792776, 'auprc': 0.9937602031831566, 'loss_val': 0.01986483756617439, 'psi': 0.9952541381408292}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=46 head_norm_before_train=1.805084 cos_to_last_merge=0.9340 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.934
[S10] round=46 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9945462990738554, 'loss_val': 0.03365488853211984, 'psi': 0.9938278780404839}-{'f1_val': 0.9944449605296568, 'auprc': 0.9935474744971371, 'loss_val': 0.03178816205138609, 'psi': 0.994085966116649}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=46 head_norm_before_train=2.157846 cos_to_last_merge=0.9490 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.949
[S11] round=46 local utility u=0.000000 metrics={'f1_val': 0.9112615529459192, 'auprc': 0.9932852662094962, 'loss_val': 0.11903307786635016, 'psi': 0.94407103825135}-{'f1_val': 0.9968091830929121, 'auprc': 0.9962653082896095, 'loss_val': 0.023040423763993057, 'psi': 0.996591633171591}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=46 head_norm_before_train=1.813829 (no previous merge yet)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6390687334897677, 'auprc': 0.7981175491545024, 'loss_val': 1.065198131523654, 'psi': 0.7026882597556616}-{'f1_val': 0.7129159518239723, 'auprc': 0.8555836052463877, 'loss_val': 0.631234063578642, 'psi': 0.7699830131929384}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=46 head_norm_before_train=2.100924 cos_to_last_merge=0.9717 (last merge round=15)
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971286768920369, 'loss_val': 0.022366369285403077, 'psi': 0.9975431815371458}-{'f1_val': 0.9976538428159559, 'auprc': 0.9972064610390196, 'loss_val': 0.020492873032811786, 'psi': 0.9974748901051814}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=2.182326 (no previous merge yet)
[S15] round=46 local utility u=0.505342 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985433265738866, 'loss_val': 0.020533585732213984, 'psi': 0.997465331662067}-{'f1_val': 0.87333227415704, 'auprc': 0.9898851159176625, 'loss_val': 0.2647555988481814, 'psi': 0.9199534108612889}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=46 head_norm_before_train=1.931847 cos_to_last_merge=0.7871 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.787
[S16] round=46 local utility u=0.277544 metrics={'f1_val': 0.9919283617222143, 'auprc': 0.9931251351930825, 'loss_val': 0.04362282649470863, 'psi': 0.9924070711105616}-{'f1_val': 0.9388090743732976, 'auprc': 0.995350555449859, 'loss_val': 0.2866713660698012, 'psi': 0.9614256668039222}
[S16] not sending this round → trigger blocked (psi=0.992)
[S17] START round=46 head_norm_before_train=1.644255 cos_to_last_merge=0.8895 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.889
[S17] round=46 local utility u=0.289157 metrics={'f1_val': 0.6836779619998264, 'auprc': 0.8793757853622314, 'loss_val': 0.9870748177264902, 'psi': 0.7619570913447884}-{'f1_val': 0.6460910942097299, 'auprc': 0.8305653131335172, 'loss_val': 1.1934359175806972, 'psi': 0.7198807817792447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=47 head_norm_before_train=1.852993 cos_to_last_merge=0.7752 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=47 local utility u=0.949933 metrics={'f1_val': 0.7141386773640076, 'auprc': 0.7544047012052624, 'loss_val': 0.9385591056918461, 'psi': 0.7302450869005095}-{'f1_val': 0.548465090065915, 'auprc': 0.6827668324311702, 'loss_val': 1.629469895748336, 'psi': 0.6021857870120171}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] sending update (kind=head size=1797 to 1 peers)
[S3] START round=47 head_norm_before_train=2.336401 (no previous merge yet)
[S3] round=47 local utility u=0.000000 metrics={'f1_val': 0.9313197576461416, 'auprc': 0.9985231157145843, 'loss_val': 0.25993384745796666, 'psi': 0.9582011008735187}-{'f1_val': 0.9948742836727336, 'auprc': 0.9989237982076001, 'loss_val': 0.029783007871090953, 'psi': 0.9964940894866802}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=47 head_norm_before_train=1.666687 cos_to_last_merge=0.9083 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.908
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9464868556303269, 'auprc': 0.9838700456918286, 'loss_val': 0.2688223994343154, 'psi': 0.9614401316549276}-{'f1_val': 0.9551405583307485, 'auprc': 0.9857989062368361, 'loss_val': 0.24350083725664537, 'psi': 0.9674038974931836}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=1.498381 cos_to_last_merge=0.8409 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.841
[S5] round=47 local utility u=0.444135 metrics={'f1_val': 0.9560493541021073, 'auprc': 0.9924522093944776, 'loss_val': 0.16078239532437424, 'psi': 0.9706104962190555}-{'f1_val': 0.8494208106206687, 'auprc': 0.9607676127118375, 'loss_val': 0.314226468671003, 'psi': 0.8939595314571361}
[S5] not sending this round → trigger blocked (psi=0.971)
[S6] START round=47 head_norm_before_train=1.722234 cos_to_last_merge=0.9242 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=47 local utility u=0.140376 metrics={'f1_val': 0.6151551597923837, 'auprc': 0.7901084584808755, 'loss_val': 0.8125783583951868, 'psi': 0.6851364792677804}-{'f1_val': 0.5982622133716182, 'auprc': 0.767222888215199, 'loss_val': 0.9233161570953705, 'psi': 0.6658464833090505}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=47 head_norm_before_train=1.672761 cos_to_last_merge=0.7852 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.785
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.5685707435544344, 'auprc': 0.7895756236455151, 'loss_val': 0.824906065789676, 'psi': 0.6569726955908667}-{'f1_val': 0.6642883443043521, 'auprc': 0.8076016117535489, 'loss_val': 0.4088089019737153, 'psi': 0.7216136512840308}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=2.065574 (no previous merge yet)
[S8] round=47 local utility u=0.023316 metrics={'f1_val': 0.9922300956824643, 'auprc': 0.9988872502782961, 'loss_val': 0.031096136046195433, 'psi': 0.994892957520797}-{'f1_val': 0.9862034439475675, 'auprc': 0.9989146876824306, 'loss_val': 0.04165108379398506, 'psi': 0.9912879414415128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=47 head_norm_before_train=2.087926 cos_to_last_merge=0.9423 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.942
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9985999857324982, 'loss_val': 0.02014641319454545, 'psi': 0.9972861056933318}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986201453346442, 'loss_val': 0.01976122760603058, 'psi': 0.9972941695341901}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.813920 cos_to_last_merge=0.9330 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.933
[S10] round=47 local utility u=0.001177 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9955710908614018, 'loss_val': 0.034375721807359275, 'psi': 0.9942377947555024}-{'f1_val': 0.9933489306849028, 'auprc': 0.9945462990738554, 'loss_val': 0.03365488853211984, 'psi': 0.9938278780404839}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=47 head_norm_before_train=2.166564 cos_to_last_merge=0.9480 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.948
[S11] round=47 local utility u=0.299626 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9938745705461587, 'loss_val': 0.030904303019863744, 'psi': 0.9952423130649107}-{'f1_val': 0.9112615529459192, 'auprc': 0.9932852662094962, 'loss_val': 0.11903307786635016, 'psi': 0.94407103825135}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=47 head_norm_before_train=1.823190 (no previous merge yet)
[S13] round=47 local utility u=0.464541 metrics={'f1_val': 0.6982667297047, 'auprc': 0.8867037849046331, 'loss_val': 0.757062511736738, 'psi': 0.7736415517846733}-{'f1_val': 0.6390687334897677, 'auprc': 0.7981175491545024, 'loss_val': 1.065198131523654, 'psi': 0.7026882597556616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=47 head_norm_before_train=2.110335 cos_to_last_merge=0.9712 (last merge round=15)
[S14] round=47 local utility u=0.000000 metrics={'f1_val': 0.9577926017469479, 'auprc': 0.997095942843601, 'loss_val': 0.06088509529222136, 'psi': 0.9735139381856092}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971286768920369, 'loss_val': 0.022366369285403077, 'psi': 0.9975431815371458}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=47 head_norm_before_train=2.188163 (no previous merge yet)
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980770869672648, 'loss_val': 0.020462155276167335, 'psi': 0.9972788358194182}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985433265738866, 'loss_val': 0.020533585732213984, 'psi': 0.997465331662067}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=1.935080 cos_to_last_merge=0.7865 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.786
[S16] round=47 local utility u=0.013486 metrics={'f1_val': 0.9928680781018704, 'auprc': 0.9965400357329561, 'loss_val': 0.03253306600580948, 'psi': 0.9943368611543048}-{'f1_val': 0.9919283617222143, 'auprc': 0.9931251351930825, 'loss_val': 0.04362282649470863, 'psi': 0.9924070711105616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=47 head_norm_before_train=1.656353 cos_to_last_merge=0.8876 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.888
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.650152982045681, 'auprc': 0.8374674963613438, 'loss_val': 1.172858050787601, 'psi': 0.725078787771946}-{'f1_val': 0.6836779619998264, 'auprc': 0.8793757853622314, 'loss_val': 0.9870748177264902, 'psi': 0.7619570913447884}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=48 head_norm_before_train=1.855879 cos_to_last_merge=0.7749 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=48 local utility u=0.008503 metrics={'f1_val': 0.711309353968155, 'auprc': 0.7549999807715171, 'loss_val': 0.9063633154345807, 'psi': 0.7287856046894998}-{'f1_val': 0.7141386773640076, 'auprc': 0.7544047012052624, 'loss_val': 0.9385591056918461, 'psi': 0.7302450869005095}
[S2] not sending this round → trigger blocked (psi=0.729)
[S3] START round=48 head_norm_before_train=2.344250 (no previous merge yet)
[S3] round=48 local utility u=0.321983 metrics={'f1_val': 0.9973982357793907, 'auprc': 0.9993917244931746, 'loss_val': 0.015044866058782472, 'psi': 0.9981956312649043}-{'f1_val': 0.9313197576461416, 'auprc': 0.9985231157145843, 'loss_val': 0.25993384745796666, 'psi': 0.9582011008735187}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=48 head_norm_before_train=1.674467 cos_to_last_merge=0.9072 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.907
[S4] round=48 local utility u=0.021439 metrics={'f1_val': 0.9520161697166543, 'auprc': 0.983465383493885, 'loss_val': 0.2579061244912223, 'psi': 0.9645958552275465}-{'f1_val': 0.9464868556303269, 'auprc': 0.9838700456918286, 'loss_val': 0.2688223994343154, 'psi': 0.9614401316549276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=48 head_norm_before_train=1.510714 cos_to_last_merge=0.8384 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.838
[S5] round=48 local utility u=0.142214 metrics={'f1_val': 0.9947543728208772, 'auprc': 0.9915812015595589, 'loss_val': 0.10597158247316649, 'psi': 0.99348510431635}-{'f1_val': 0.9560493541021073, 'auprc': 0.9924522093944776, 'loss_val': 0.16078239532437424, 'psi': 0.9706104962190555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=48 head_norm_before_train=1.731912 cos_to_last_merge=0.9229 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.923
[S6] round=48 local utility u=1.000000 metrics={'f1_val': 0.9631405380644404, 'auprc': 0.9494268388624568, 'loss_val': 0.12698847828831114, 'psi': 0.957655058383647}-{'f1_val': 0.6151551597923837, 'auprc': 0.7901084584808755, 'loss_val': 0.8125783583951868, 'psi': 0.6851364792677804}
[S6] not sending this round → trigger blocked (psi=0.958)
[S7] START round=48 head_norm_before_train=1.683275 cos_to_last_merge=0.7818 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.782
[S7] round=48 local utility u=0.367371 metrics={'f1_val': 0.6358868919511129, 'auprc': 0.8060320145464225, 'loss_val': 0.5434299039513448, 'psi': 0.7039449409892368}-{'f1_val': 0.5685707435544344, 'auprc': 0.7895756236455151, 'loss_val': 0.824906065789676, 'psi': 0.6569726955908667}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=48 head_norm_before_train=2.072948 (no previous merge yet)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9917351758735767, 'auprc': 0.9980476045165317, 'loss_val': 0.03349991571676684, 'psi': 0.9942601473307587}-{'f1_val': 0.9922300956824643, 'auprc': 0.9988872502782961, 'loss_val': 0.031096136046195433, 'psi': 0.994892957520797}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=48 head_norm_before_train=2.095899 cos_to_last_merge=0.9415 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=48 local utility u=0.001329 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986552065961894, 'loss_val': 0.019155575774036593, 'psi': 0.9974583897268107}-{'f1_val': 0.9964101856672208, 'auprc': 0.9985999857324982, 'loss_val': 0.02014641319454545, 'psi': 0.9972861056933318}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=48 head_norm_before_train=1.823598 cos_to_last_merge=0.9321 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.932
[S10] round=48 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9938946659941635, 'loss_val': 0.032239824650916585, 'psi': 0.9938301395424785}-{'f1_val': 0.9933489306849028, 'auprc': 0.9955710908614018, 'loss_val': 0.034375721807359275, 'psi': 0.9942377947555024}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=48 head_norm_before_train=2.175630 cos_to_last_merge=0.9470 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.947
[S11] round=48 local utility u=0.008483 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9951987589274185, 'loss_val': 0.021841272883734907, 'psi': 0.9961650134267147}-{'f1_val': 0.9961541414107454, 'auprc': 0.9938745705461587, 'loss_val': 0.030904303019863744, 'psi': 0.9952423130649107}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=48 head_norm_before_train=1.827935 (no previous merge yet)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6254073301069163, 'auprc': 0.8346444183901934, 'loss_val': 0.9999175386252148, 'psi': 0.7091021654202272}-{'f1_val': 0.6982667297047, 'auprc': 0.8867037849046331, 'loss_val': 0.757062511736738, 'psi': 0.7736415517846733}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=48 head_norm_before_train=2.115165 cos_to_last_merge=0.9708 (last merge round=15)
[S14] round=48 local utility u=0.136697 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9975330607019601, 'loss_val': 0.026479269543667392, 'psi': 0.9974565421123747}-{'f1_val': 0.9577926017469479, 'auprc': 0.997095942843601, 'loss_val': 0.06088509529222136, 'psi': 0.9735139381856092}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=48 head_norm_before_train=2.195765 (no previous merge yet)
[S15] round=48 local utility u=0.001256 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985429229970534, 'loss_val': 0.0193471355737191, 'psi': 0.9974651702313337}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980770869672648, 'loss_val': 0.020462155276167335, 'psi': 0.9972788358194182}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=48 head_norm_before_train=1.941463 cos_to_last_merge=0.7859 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.786
[S16] round=48 local utility u=0.000000 metrics={'f1_val': 0.9053786387933925, 'auprc': 0.996092485755207, 'loss_val': 0.23251889103285772, 'psi': 0.9416641775781183}-{'f1_val': 0.9928680781018704, 'auprc': 0.9965400357329561, 'loss_val': 0.03253306600580948, 'psi': 0.9943368611543048}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=48 head_norm_before_train=1.669762 cos_to_last_merge=0.8855 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.885
[S17] round=48 local utility u=0.160326 metrics={'f1_val': 0.6796702350599229, 'auprc': 0.8724174892364099, 'loss_val': 1.1341603351242318, 'psi': 0.7567691367305177}-{'f1_val': 0.650152982045681, 'auprc': 0.8374674963613438, 'loss_val': 1.172858050787601, 'psi': 0.725078787771946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=49 head_norm_before_train=1.860186 cos_to_last_merge=0.7745 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.775
[S2] round=49 local utility u=0.002027 metrics={'f1_val': 0.7098746793307364, 'auprc': 0.7548809797442277, 'loss_val': 0.8933436861990766, 'psi': 0.727877199496133}-{'f1_val': 0.711309353968155, 'auprc': 0.7549999807715171, 'loss_val': 0.9063633154345807, 'psi': 0.7287856046894998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] sending update (kind=head size=1806 to 1 peers)
[S3] START round=49 head_norm_before_train=2.349176 (no previous merge yet)
[S3] round=49 local utility u=0.000000 metrics={'f1_val': 0.9519279065516568, 'auprc': 0.9987218885354415, 'loss_val': 0.12486802233154938, 'psi': 0.9706454993451706}-{'f1_val': 0.9973982357793907, 'auprc': 0.9993917244931746, 'loss_val': 0.015044866058782472, 'psi': 0.9981956312649043}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=49 head_norm_before_train=1.683009 cos_to_last_merge=0.9060 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.906
[S4] round=49 local utility u=0.000000 metrics={'f1_val': 0.9541023683856968, 'auprc': 0.9672116985739545, 'loss_val': 0.2618660088106933, 'psi': 0.9593461004609999}-{'f1_val': 0.9520161697166543, 'auprc': 0.983465383493885, 'loss_val': 0.2579061244912223, 'psi': 0.9645958552275465}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=49 head_norm_before_train=1.522099 cos_to_last_merge=0.8359 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.836
[S5] round=49 local utility u=0.000000 metrics={'f1_val': 0.8196962943268827, 'auprc': 0.9868662966331743, 'loss_val': 0.181058464331357, 'psi': 0.8865642952493993}-{'f1_val': 0.9947543728208772, 'auprc': 0.9915812015595589, 'loss_val': 0.10597158247316649, 'psi': 0.99348510431635}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=49 head_norm_before_train=1.740952 cos_to_last_merge=0.9214 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.921
[S6] round=49 local utility u=0.000000 metrics={'f1_val': 0.5863947680130589, 'auprc': 0.761119323546001, 'loss_val': 0.907283851336249, 'psi': 0.6562845902262358}-{'f1_val': 0.9631405380644404, 'auprc': 0.9494268388624568, 'loss_val': 0.12698847828831114, 'psi': 0.957655058383647}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=49 head_norm_before_train=1.692185 cos_to_last_merge=0.7804 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.780
[S7] round=49 local utility u=0.225583 metrics={'f1_val': 0.6663852808525244, 'auprc': 0.8266388649716857, 'loss_val': 0.33707383183566225, 'psi': 0.730486714500189}-{'f1_val': 0.6358868919511129, 'auprc': 0.8060320145464225, 'loss_val': 0.5434299039513448, 'psi': 0.7039449409892368}
[S7] not sending this round → trigger blocked (psi=0.730)
[S8] START round=49 head_norm_before_train=2.077647 (no previous merge yet)
[S8] round=49 local utility u=0.002135 metrics={'f1_val': 0.9927891582002274, 'auprc': 0.9982106821377549, 'loss_val': 0.036042970262730345, 'psi': 0.9949577677752384}-{'f1_val': 0.9917351758735767, 'auprc': 0.9980476045165317, 'loss_val': 0.03349991571676684, 'psi': 0.9942601473307587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] sending update (kind=head size=1802 to 1 peers)
[S9] START round=49 head_norm_before_train=2.105193 cos_to_last_merge=0.9407 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.941
[S9] round=49 local utility u=0.000000 metrics={'f1_val': 0.9960245636725735, 'auprc': 0.9987278025601871, 'loss_val': 0.01867464575061337, 'psi': 0.997105859227619}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986552065961894, 'loss_val': 0.019155575774036593, 'psi': 0.9974583897268107}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=49 head_norm_before_train=1.833603 cos_to_last_merge=0.9313 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.931
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943535324084367, 'loss_val': 0.03278891271211974, 'psi': 0.9937507713743164}-{'f1_val': 0.9937871219080217, 'auprc': 0.9938946659941635, 'loss_val': 0.032239824650916585, 'psi': 0.9938301395424785}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=49 head_norm_before_train=2.184530 cos_to_last_merge=0.9461 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.946
[S11] round=49 local utility u=0.002357 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9963990371572125, 'loss_val': 0.020727420483758096, 'psi': 0.9966451247186323}-{'f1_val': 0.9968091830929121, 'auprc': 0.9951987589274185, 'loss_val': 0.021841272883734907, 'psi': 0.9961650134267147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] START round=49 head_norm_before_train=1.832915 (no previous merge yet)
[S13] round=49 local utility u=0.679948 metrics={'f1_val': 0.7895725776365157, 'auprc': 0.8725024242469901, 'loss_val': 0.7385864199759221, 'psi': 0.8227445162807054}-{'f1_val': 0.6254073301069163, 'auprc': 0.8346444183901934, 'loss_val': 0.9999175386252148, 'psi': 0.7091021654202272}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] sending update (kind=head size=1795 to 1 peers)
[S14] START round=49 head_norm_before_train=2.120111 cos_to_last_merge=0.9703 (last merge round=15)
[S14] round=49 local utility u=0.004369 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975328891419493, 'loss_val': 0.020225680732926143, 'psi': 0.9977048664371108}-{'f1_val': 0.9974055297193176, 'auprc': 0.9975330607019601, 'loss_val': 0.026479269543667392, 'psi': 0.9974565421123747}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=49 head_norm_before_train=2.204302 (no previous merge yet)
[S15] round=49 local utility u=0.000059 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985383288669939, 'loss_val': 0.0192152597291236, 'psi': 0.9974633325793099}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985429229970534, 'loss_val': 0.0193471355737191, 'psi': 0.9974651702313337}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=49 head_norm_before_train=1.947200 cos_to_last_merge=0.7853 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=49 local utility u=0.203344 metrics={'f1_val': 0.9555428316858945, 'auprc': 0.9933604897833133, 'loss_val': 0.11862026039511032, 'psi': 0.970669894924862}-{'f1_val': 0.9053786387933925, 'auprc': 0.996092485755207, 'loss_val': 0.23251889103285772, 'psi': 0.9416641775781183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=49 head_norm_before_train=1.681107 cos_to_last_merge=0.8832 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=49 local utility u=0.002357 metrics={'f1_val': 0.6805039914555653, 'auprc': 0.8748582885133136, 'loss_val': 1.1417711837808309, 'psi': 0.7582457102786646}-{'f1_val': 0.6796702350599229, 'auprc': 0.8724174892364099, 'loss_val': 1.1341603351242318, 'psi': 0.7567691367305177}
[S17] not sending this round → trigger blocked (psi=0.758)
[S2] START round=50 head_norm_before_train=1.862244 cos_to_last_merge=0.7743 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=50 local utility u=0.000000 metrics={'f1_val': 0.7164310494043443, 'auprc': 0.7506485974800186, 'loss_val': 0.9562911341247636, 'psi': 0.730118068634614}-{'f1_val': 0.7098746793307364, 'auprc': 0.7548809797442277, 'loss_val': 0.8933436861990766, 'psi': 0.727877199496133}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=50 head_norm_before_train=2.350922 (no previous merge yet)
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9095322711500041, 'auprc': 0.998209776793513, 'loss_val': 0.21990689746215317, 'psi': 0.9450032734074076}-{'f1_val': 0.9519279065516568, 'auprc': 0.9987218885354415, 'loss_val': 0.12486802233154938, 'psi': 0.9706454993451706}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.689130 cos_to_last_merge=0.9050 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.905
[S4] round=50 local utility u=0.000000 metrics={'f1_val': 0.9539184056282471, 'auprc': 0.9580871673151452, 'loss_val': 0.2662059290290841, 'psi': 0.9555859103030064}-{'f1_val': 0.9541023683856968, 'auprc': 0.9672116985739545, 'loss_val': 0.2618660088106933, 'psi': 0.9593461004609999}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=50 head_norm_before_train=1.534885 cos_to_last_merge=0.8333 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.833
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.817676568169478, 'auprc': 0.9781652176929336, 'loss_val': 0.23248578213472584, 'psi': 0.8818720279788602}-{'f1_val': 0.8196962943268827, 'auprc': 0.9868662966331743, 'loss_val': 0.181058464331357, 'psi': 0.8865642952493993}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=1.753029 cos_to_last_merge=0.9194 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=50 local utility u=1.000000 metrics={'f1_val': 0.8149362610601818, 'auprc': 0.9357905826563205, 'loss_val': 0.3874269577661819, 'psi': 0.8632779896986373}-{'f1_val': 0.5863947680130589, 'auprc': 0.761119323546001, 'loss_val': 0.907283851336249, 'psi': 0.6562845902262358}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=50 head_norm_before_train=1.700597 cos_to_last_merge=0.7796 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.780
[S7] round=50 local utility u=0.015381 metrics={'f1_val': 0.6690022662883803, 'auprc': 0.8302650497070867, 'loss_val': 0.3328918696140914, 'psi': 0.7335073796558629}-{'f1_val': 0.6663852808525244, 'auprc': 0.8266388649716857, 'loss_val': 0.33707383183566225, 'psi': 0.730486714500189}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=50 head_norm_before_train=2.082577 (no previous merge yet)
[S8] round=50 local utility u=0.005497 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9987278816287437, 'loss_val': 0.027876203519921483, 'psi': 0.9952922273431699}-{'f1_val': 0.9927891582002274, 'auprc': 0.9982106821377549, 'loss_val': 0.036042970262730345, 'psi': 0.9949577677752384}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=50 head_norm_before_train=2.111064 cos_to_last_merge=0.9399 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.940
[S9] round=50 local utility u=0.003356 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986799672945534, 'loss_val': 0.018289305088639202, 'psi': 0.997733734425107}-{'f1_val': 0.9960245636725735, 'auprc': 0.9987278025601871, 'loss_val': 0.01867464575061337, 'psi': 0.997105859227619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=50 head_norm_before_train=1.843576 cos_to_last_merge=0.9305 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9945088719435565, 'loss_val': 0.034236160998774655, 'psi': 0.9936815155287733}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943535324084367, 'loss_val': 0.03278891271211974, 'psi': 0.9937507713743164}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=50 head_norm_before_train=2.191710 cos_to_last_merge=0.9454 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.996721465356133, 'loss_val': 0.02143682690782348, 'psi': 0.996616788850607}-{'f1_val': 0.9968091830929121, 'auprc': 0.9963990371572125, 'loss_val': 0.020727420483758096, 'psi': 0.9966451247186323}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=50 head_norm_before_train=1.838305 (no previous merge yet)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.6560189210959938, 'auprc': 0.8495435504544252, 'loss_val': 0.9973239559419845, 'psi': 0.7334287728393664}-{'f1_val': 0.7895725776365157, 'auprc': 0.8725024242469901, 'loss_val': 0.7385864199759221, 'psi': 0.8227445162807054}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=50 head_norm_before_train=2.124190 cos_to_last_merge=0.9699 (last merge round=15)
[S14] round=50 local utility u=0.000257 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9975350412253616, 'loss_val': 0.019717904555023404, 'psi': 0.9977057272704757}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975328891419493, 'loss_val': 0.020225680732926143, 'psi': 0.9977048664371108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=50 head_norm_before_train=2.212744 (no previous merge yet)
[S15] round=50 local utility u=0.000000 metrics={'f1_val': 0.9964553122065998, 'auprc': 0.9986459038830368, 'loss_val': 0.019757527374492916, 'psi': 0.9973315488771746}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985383288669939, 'loss_val': 0.0192152597291236, 'psi': 0.9974633325793099}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=50 head_norm_before_train=1.952104 cos_to_last_merge=0.7848 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.785
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.8844284584693138, 'auprc': 0.9904513530744928, 'loss_val': 0.5823520499803387, 'psi': 0.9268376163113855}-{'f1_val': 0.9555428316858945, 'auprc': 0.9933604897833133, 'loss_val': 0.11862026039511032, 'psi': 0.970669894924862}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.694461 cos_to_last_merge=0.8813 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.881
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6566028677312705, 'auprc': 0.8458667221055081, 'loss_val': 1.2631128889336478, 'psi': 0.7323084094809655}-{'f1_val': 0.6805039914555653, 'auprc': 0.8748582885133136, 'loss_val': 1.1417711837808309, 'psi': 0.7582457102786646}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=51 head_norm_before_train=1.865730 cos_to_last_merge=0.7740 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.774
[S2] round=51 local utility u=0.007955 metrics={'f1_val': 0.7089119629759427, 'auprc': 0.7538402741743521, 'loss_val': 0.904842332637113, 'psi': 0.7268832874553065}-{'f1_val': 0.7164310494043443, 'auprc': 0.7506485974800186, 'loss_val': 0.9562911341247636, 'psi': 0.730118068634614}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=51 head_norm_before_train=2.357452 (no previous merge yet)
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.6591694426207844, 'auprc': 0.9358949895535228, 'loss_val': 1.1542104083196079, 'psi': 0.7698596613938797}-{'f1_val': 0.9095322711500041, 'auprc': 0.998209776793513, 'loss_val': 0.21990689746215317, 'psi': 0.9450032734074076}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.695271 cos_to_last_merge=0.9039 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.904
[S4] round=51 local utility u=0.039609 metrics={'f1_val': 0.9552741455824881, 'auprc': 0.9772506950766912, 'loss_val': 0.25261315292620656, 'psi': 0.9640647653801694}-{'f1_val': 0.9539184056282471, 'auprc': 0.9580871673151452, 'loss_val': 0.2662059290290841, 'psi': 0.9555859103030064}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=51 head_norm_before_train=1.544809 cos_to_last_merge=0.8314 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.831
[S5] round=51 local utility u=0.542881 metrics={'f1_val': 0.9723449841249006, 'auprc': 0.9901623499998511, 'loss_val': 0.11072574402976415, 'psi': 0.9794719304748807}-{'f1_val': 0.817676568169478, 'auprc': 0.9781652176929336, 'loss_val': 0.23248578213472584, 'psi': 0.8818720279788602}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S5] sending update (kind=head size=1805 to 1 peers)
[S6] START round=51 head_norm_before_train=1.767209 cos_to_last_merge=0.9172 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.917
[S6] round=51 local utility u=0.000000 metrics={'f1_val': 0.7816379760551584, 'auprc': 0.796070422592069, 'loss_val': 0.5597453352060598, 'psi': 0.7874109546699226}-{'f1_val': 0.8149362610601818, 'auprc': 0.9357905826563205, 'loss_val': 0.3874269577661819, 'psi': 0.8632779896986373}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=51 head_norm_before_train=1.708272 cos_to_last_merge=0.7793 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.779
[S7] round=51 local utility u=0.000000 metrics={'f1_val': 0.6435527134453823, 'auprc': 0.8062002228626659, 'loss_val': 0.4829071112213432, 'psi': 0.7086117172122958}-{'f1_val': 0.6690022662883803, 'auprc': 0.8302650497070867, 'loss_val': 0.3328918696140914, 'psi': 0.7335073796558629}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=51 head_norm_before_train=2.088596 (no previous merge yet)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9901415769687928, 'auprc': 0.998908035332174, 'loss_val': 0.032720603954773136, 'psi': 0.9936481603141452}-{'f1_val': 0.9930017911527874, 'auprc': 0.9987278816287437, 'loss_val': 0.027876203519921483, 'psi': 0.9952922273431699}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=51 head_norm_before_train=2.119110 cos_to_last_merge=0.9391 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.939
[S9] round=51 local utility u=0.000056 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986524820531413, 'loss_val': 0.018094722976397633, 'psi': 0.9977227403285422}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986799672945534, 'loss_val': 0.018289305088639202, 'psi': 0.997733734425107}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=51 head_norm_before_train=1.853443 cos_to_last_merge=0.9297 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.930
[S10] round=51 local utility u=0.000829 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9938345351083455, 'loss_val': 0.03186847940086711, 'psi': 0.9935431724542799}-{'f1_val': 0.9931299445855843, 'auprc': 0.9945088719435565, 'loss_val': 0.034236160998774655, 'psi': 0.9936815155287733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] START round=51 head_norm_before_train=2.197421 cos_to_last_merge=0.9450 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=51 local utility u=0.001147 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9966168230495204, 'loss_val': 0.020402820166451133, 'psi': 0.9967322390755554}-{'f1_val': 0.9965470045135896, 'auprc': 0.996721465356133, 'loss_val': 0.02143682690782348, 'psi': 0.996616788850607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=51 head_norm_before_train=1.845502 (no previous merge yet)
[S13] round=51 local utility u=0.101161 metrics={'f1_val': 0.649052782223877, 'auprc': 0.8743686468873745, 'loss_val': 0.8276796488943484, 'psi': 0.739179128089276}-{'f1_val': 0.6560189210959938, 'auprc': 0.8495435504544252, 'loss_val': 0.9973239559419845, 'psi': 0.7334287728393664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=51 head_norm_before_train=2.126988 cos_to_last_merge=0.9696 (last merge round=15)
[S14] round=51 local utility u=0.000000 metrics={'f1_val': 0.9319769092749978, 'auprc': 0.9939003465526113, 'loss_val': 0.1575468231285284, 'psi': 0.9567462841860432}-{'f1_val': 0.9978195179672185, 'auprc': 0.9975350412253616, 'loss_val': 0.019717904555023404, 'psi': 0.9977057272704757}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=51 head_norm_before_train=2.221254 (no previous merge yet)
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980157639222813, 'loss_val': 0.020295956125534427, 'psi': 0.9972543066014249}-{'f1_val': 0.9964553122065998, 'auprc': 0.9986459038830368, 'loss_val': 0.019757527374492916, 'psi': 0.9973315488771746}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=1.955309 cos_to_last_merge=0.7840 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.784
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.8669540900905258, 'auprc': 0.9888527485646647, 'loss_val': 0.8091310186078047, 'psi': 0.9157135534801814}-{'f1_val': 0.8844284584693138, 'auprc': 0.9904513530744928, 'loss_val': 0.5823520499803387, 'psi': 0.9268376163113855}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.705968 cos_to_last_merge=0.8800 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=51 local utility u=0.000000 metrics={'f1_val': 0.6226078314337676, 'auprc': 0.8261885180072011, 'loss_val': 1.394118626065225, 'psi': 0.7040401060631409}-{'f1_val': 0.6566028677312705, 'auprc': 0.8458667221055081, 'loss_val': 1.2631128889336478, 'psi': 0.7323084094809655}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=52 head_norm_before_train=1.874517 cos_to_last_merge=0.7734 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=52 local utility u=0.000000 metrics={'f1_val': 0.6138912291744246, 'auprc': 0.7418751790999729, 'loss_val': 1.1234048302882533, 'psi': 0.665084809144644}-{'f1_val': 0.7089119629759427, 'auprc': 0.7538402741743521, 'loss_val': 0.904842332637113, 'psi': 0.7268832874553065}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=52 head_norm_before_train=2.365512 (no previous merge yet)
[S3] round=52 local utility u=1.000000 metrics={'f1_val': 0.8522348329644377, 'auprc': 0.9976187653657403, 'loss_val': 0.4222031099979256, 'psi': 0.9103884059249587}-{'f1_val': 0.6591694426207844, 'auprc': 0.9358949895535228, 'loss_val': 1.1542104083196079, 'psi': 0.7698596613938797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=52 head_norm_before_train=1.701584 cos_to_last_merge=0.9028 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.903
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9518524926893229, 'auprc': 0.9770145791375854, 'loss_val': 0.2676098416369033, 'psi': 0.9619173272686279}-{'f1_val': 0.9552741455824881, 'auprc': 0.9772506950766912, 'loss_val': 0.25261315292620656, 'psi': 0.9640647653801694}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=1.553824 cos_to_last_merge=0.8294 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.829
[S5] round=52 local utility u=0.103879 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9961352001737871, 'loss_val': 0.06702853877833374, 'psi': 0.9964752611565895}-{'f1_val': 0.9723449841249006, 'auprc': 0.9901623499998511, 'loss_val': 0.11072574402976415, 'psi': 0.9794719304748807}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=52 head_norm_before_train=1.779045 cos_to_last_merge=0.9150 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=52 local utility u=0.000000 metrics={'f1_val': 0.5866192332224941, 'auprc': 0.7506849679178724, 'loss_val': 0.9556971034112502, 'psi': 0.6522455271006454}-{'f1_val': 0.7816379760551584, 'auprc': 0.796070422592069, 'loss_val': 0.5597453352060598, 'psi': 0.7874109546699226}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=52 head_norm_before_train=1.711993 cos_to_last_merge=0.7791 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.779
[S7] round=52 local utility u=0.021254 metrics={'f1_val': 0.6429770232610601, 'auprc': 0.8070298364201003, 'loss_val': 0.43943310591006673, 'psi': 0.7085981485246762}-{'f1_val': 0.6435527134453823, 'auprc': 0.8062002228626659, 'loss_val': 0.4829071112213432, 'psi': 0.7086117172122958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=52 head_norm_before_train=2.093680 (no previous merge yet)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9883436617281106, 'auprc': 0.9987394519127064, 'loss_val': 0.03811283222765451, 'psi': 0.9925019778019488}-{'f1_val': 0.9901415769687928, 'auprc': 0.998908035332174, 'loss_val': 0.032720603954773136, 'psi': 0.9936481603141452}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=52 head_norm_before_train=2.126341 cos_to_last_merge=0.9384 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.997099064453126, 'loss_val': 0.019130084268115875, 'psi': 0.9968359328695853}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986524820531413, 'loss_val': 0.018094722976397633, 'psi': 0.9977227403285422}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=1.863037 cos_to_last_merge=0.9289 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.929
[S10] round=52 local utility u=0.000220 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943235776069124, 'loss_val': 0.03289651511946225, 'psi': 0.9937387894537066}-{'f1_val': 0.9933489306849028, 'auprc': 0.9938345351083455, 'loss_val': 0.03186847940086711, 'psi': 0.9935431724542799}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=52 head_norm_before_train=2.203853 cos_to_last_merge=0.9445 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.945
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9952856249521005, 'loss_val': 0.02065985597976896, 'psi': 0.9961997598365875}-{'f1_val': 0.9968091830929121, 'auprc': 0.9966168230495204, 'loss_val': 0.020402820166451133, 'psi': 0.9967322390755554}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=52 head_norm_before_train=1.851628 (no previous merge yet)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6220761159623875, 'auprc': 0.8323189005270111, 'loss_val': 1.0530897903550718, 'psi': 0.7061732297882369}-{'f1_val': 0.649052782223877, 'auprc': 0.8743686468873745, 'loss_val': 0.8276796488943484, 'psi': 0.739179128089276}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=52 head_norm_before_train=2.132717 cos_to_last_merge=0.9692 (last merge round=15)
[S14] round=52 local utility u=0.273355 metrics={'f1_val': 0.9976483782674455, 'auprc': 0.9988565338264269, 'loss_val': 0.019734554192900343, 'psi': 0.9981316404910381}-{'f1_val': 0.9319769092749978, 'auprc': 0.9939003465526113, 'loss_val': 0.1575468231285284, 'psi': 0.9567462841860432}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=52 head_norm_before_train=2.228844 (no previous merge yet)
[S15] round=52 local utility u=0.000000 metrics={'f1_val': 0.7045288545903164, 'auprc': 0.9735421122870127, 'loss_val': 0.5740750036928595, 'psi': 0.8121341576689949}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980157639222813, 'loss_val': 0.020295956125534427, 'psi': 0.9972543066014249}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=52 head_norm_before_train=1.958396 cos_to_last_merge=0.7833 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.783
[S16] round=52 local utility u=0.382749 metrics={'f1_val': 0.9250724759788111, 'auprc': 0.9948802915113374, 'loss_val': 0.41042536858233675, 'psi': 0.9529956021918217}-{'f1_val': 0.8669540900905258, 'auprc': 0.9888527485646647, 'loss_val': 0.8091310186078047, 'psi': 0.9157135534801814}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=52 head_norm_before_train=1.715978 cos_to_last_merge=0.8789 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.879
[S17] round=52 local utility u=0.098059 metrics={'f1_val': 0.628861952643389, 'auprc': 0.8670601526212672, 'loss_val': 1.358139581795804, 'psi': 0.7241412326345402}-{'f1_val': 0.6226078314337676, 'auprc': 0.8261885180072011, 'loss_val': 1.394118626065225, 'psi': 0.7040401060631409}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=53 head_norm_before_train=1.882827 cos_to_last_merge=0.7727 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.773
[S2] round=53 local utility u=0.401486 metrics={'f1_val': 0.7080722376237568, 'auprc': 0.753778769893797, 'loss_val': 0.9212300380738155, 'psi': 0.726354850531773}-{'f1_val': 0.6138912291744246, 'auprc': 0.7418751790999729, 'loss_val': 1.1234048302882533, 'psi': 0.665084809144644}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=53 head_norm_before_train=2.374441 (no previous merge yet)
[S3] round=53 local utility u=0.000000 metrics={'f1_val': 0.7088474993357179, 'auprc': 0.9818011758158284, 'loss_val': 0.9827961420745065, 'psi': 0.8180289699277621}-{'f1_val': 0.8522348329644377, 'auprc': 0.9976187653657403, 'loss_val': 0.4222031099979256, 'psi': 0.9103884059249587}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=53 head_norm_before_train=1.708199 cos_to_last_merge=0.9018 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.902
[S4] round=53 local utility u=0.016068 metrics={'f1_val': 0.9530404176863406, 'auprc': 0.9830571231529993, 'loss_val': 0.26072930415718937, 'psi': 0.9650470998730041}-{'f1_val': 0.9518524926893229, 'auprc': 0.9770145791375854, 'loss_val': 0.2676098416369033, 'psi': 0.9619173272686279}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=53 head_norm_before_train=1.568748 cos_to_last_merge=0.8259 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.826
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933698706298895, 'loss_val': 0.06817310125180864, 'psi': 0.9951482354300898}-{'f1_val': 0.9967019684784577, 'auprc': 0.9961352001737871, 'loss_val': 0.06702853877833374, 'psi': 0.9964752611565895}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.786053 cos_to_last_merge=0.9135 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=53 local utility u=1.000000 metrics={'f1_val': 0.9624969744381986, 'auprc': 0.9545983536015681, 'loss_val': 0.11212663791565504, 'psi': 0.9593375261035464}-{'f1_val': 0.5866192332224941, 'auprc': 0.7506849679178724, 'loss_val': 0.9556971034112502, 'psi': 0.6522455271006454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=53 head_norm_before_train=1.717456 cos_to_last_merge=0.7786 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.779
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.6068478171322961, 'auprc': 0.7973404916410416, 'loss_val': 0.7428570052839122, 'psi': 0.6830448869357943}-{'f1_val': 0.6429770232610601, 'auprc': 0.8070298364201003, 'loss_val': 0.43943310591006673, 'psi': 0.7085981485246762}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=2.099629 (no previous merge yet)
[S8] round=53 local utility u=0.017495 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.9988163113128283, 'loss_val': 0.02885892907749179, 'psi': 0.9950832325754461}-{'f1_val': 0.9883436617281106, 'auprc': 0.9987394519127064, 'loss_val': 0.03811283222765451, 'psi': 0.9925019778019488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=53 head_norm_before_train=2.131231 cos_to_last_merge=0.9377 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.938
[S9] round=53 local utility u=0.001833 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986791396278275, 'loss_val': 0.018702645265299012, 'psi': 0.9973177672514635}-{'f1_val': 0.9966605118138915, 'auprc': 0.997099064453126, 'loss_val': 0.019130084268115875, 'psi': 0.9968359328695853}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=53 head_norm_before_train=1.872285 cos_to_last_merge=0.9282 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.928
[S10] round=53 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9944447156590076, 'loss_val': 0.033864607609442175, 'psi': 0.9936558530149537}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943235776069124, 'loss_val': 0.03289651511946225, 'psi': 0.9937387894537066}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=53 head_norm_before_train=2.210973 cos_to_last_merge=0.9438 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.944
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.8311699527559642, 'auprc': 0.9912254090307288, 'loss_val': 0.22558206317620683, 'psi': 0.89519213526587}-{'f1_val': 0.9968091830929121, 'auprc': 0.9952856249521005, 'loss_val': 0.02065985597976896, 'psi': 0.9961997598365875}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=53 head_norm_before_train=1.856563 (no previous merge yet)
[S13] round=53 local utility u=0.414912 metrics={'f1_val': 0.7071021273374077, 'auprc': 0.850207244909863, 'loss_val': 0.787086623748434, 'psi': 0.7643441743663899}-{'f1_val': 0.6220761159623875, 'auprc': 0.8323189005270111, 'loss_val': 1.0530897903550718, 'psi': 0.7061732297882369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=53 head_norm_before_train=2.140809 cos_to_last_merge=0.9687 (last merge round=15)
[S14] round=53 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9971584519887473, 'loss_val': 0.019207138681119677, 'psi': 0.9973083424965343}-{'f1_val': 0.9976483782674455, 'auprc': 0.9988565338264269, 'loss_val': 0.019734554192900343, 'psi': 0.9981316404910381}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=53 head_norm_before_train=2.236315 (no previous merge yet)
[S15] round=53 local utility u=0.816673 metrics={'f1_val': 0.8997428134355263, 'auprc': 0.9964368108973276, 'loss_val': 0.18069590773516922, 'psi': 0.9384204124202468}-{'f1_val': 0.7045288545903164, 'auprc': 0.9735421122870127, 'loss_val': 0.5740750036928595, 'psi': 0.8121341576689949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] START round=53 head_norm_before_train=1.963918 cos_to_last_merge=0.7828 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.783
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.8538405678933259, 'auprc': 0.8994523498356469, 'loss_val': 0.973951411582027, 'psi': 0.8720852806702544}-{'f1_val': 0.9250724759788111, 'auprc': 0.9948802915113374, 'loss_val': 0.41042536858233675, 'psi': 0.9529956021918217}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.726720 cos_to_last_merge=0.8777 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.878
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6313057917719622, 'auprc': 0.8565746832836763, 'loss_val': 1.3791285628285, 'psi': 0.7214133483766478}-{'f1_val': 0.628861952643389, 'auprc': 0.8670601526212672, 'loss_val': 1.358139581795804, 'psi': 0.7241412326345402}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=54 head_norm_before_train=1.891375 cos_to_last_merge=0.7720 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.772
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.7165036360704963, 'auprc': 0.7438900740497245, 'loss_val': 0.9650294188814004, 'psi': 0.7274582112621876}-{'f1_val': 0.7080722376237568, 'auprc': 0.753778769893797, 'loss_val': 0.9212300380738155, 'psi': 0.726354850531773}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=54 head_norm_before_train=2.383077 (no previous merge yet)
[S3] round=54 local utility u=0.694328 metrics={'f1_val': 0.8460521861685006, 'auprc': 0.9979535501840922, 'loss_val': 0.4658259294387362, 'psi': 0.9068127317747372}-{'f1_val': 0.7088474993357179, 'auprc': 0.9818011758158284, 'loss_val': 0.9827961420745065, 'psi': 0.8180289699277621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=54 head_norm_before_train=1.712028 cos_to_last_merge=0.9012 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.901
[S4] round=54 local utility u=0.000000 metrics={'f1_val': 0.9568367118781012, 'auprc': 0.9707112797896661, 'loss_val': 0.2586294080903753, 'psi': 0.9623865390427271}-{'f1_val': 0.9530404176863406, 'auprc': 0.9830571231529993, 'loss_val': 0.26072930415718937, 'psi': 0.9650470998730041}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=54 head_norm_before_train=1.582950 cos_to_last_merge=0.8230 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.823
[S5] round=54 local utility u=0.002540 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9937533482285573, 'loss_val': 0.06424451293272641, 'psi': 0.995301626469557}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933698706298895, 'loss_val': 0.06817310125180864, 'psi': 0.9951482354300898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=54 head_norm_before_train=1.788644 cos_to_last_merge=0.9135 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=54 local utility u=0.000000 metrics={'f1_val': 0.7375930655338472, 'auprc': 0.808904621539645, 'loss_val': 0.6595291215400304, 'psi': 0.7661176879361663}-{'f1_val': 0.9624969744381986, 'auprc': 0.9545983536015681, 'loss_val': 0.11212663791565504, 'psi': 0.9593375261035464}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=54 head_norm_before_train=1.726912 cos_to_last_merge=0.7766 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.777
[S7] round=54 local utility u=0.200966 metrics={'f1_val': 0.6346327473474632, 'auprc': 0.806221778772945, 'loss_val': 0.5342791488683121, 'psi': 0.7032683599176559}-{'f1_val': 0.6068478171322961, 'auprc': 0.7973404916410416, 'loss_val': 0.7428570052839122, 'psi': 0.6830448869357943}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=54 head_norm_before_train=2.101921 (no previous merge yet)
[S8] round=54 local utility u=0.001153 metrics={'f1_val': 0.992959481021298, 'auprc': 0.9988020186810352, 'loss_val': 0.028699225612712563, 'psi': 0.995296496085193}-{'f1_val': 0.9925945134171912, 'auprc': 0.9988163113128283, 'loss_val': 0.02885892907749179, 'psi': 0.9950832325754461}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=54 head_norm_before_train=2.138793 cos_to_last_merge=0.9372 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=54 local utility u=0.001410 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.998667415453519, 'loss_val': 0.0185014553230257, 'psi': 0.997578517436762}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986791396278275, 'loss_val': 0.018702645265299012, 'psi': 0.9973177672514635}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=54 head_norm_before_train=1.877857 cos_to_last_merge=0.9274 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=54 local utility u=0.001311 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.994207990874402, 'loss_val': 0.03184688186042915, 'psi': 0.9936925547607025}-{'f1_val': 0.9931299445855843, 'auprc': 0.9944447156590076, 'loss_val': 0.033864607609442175, 'psi': 0.9936558530149537}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=54 head_norm_before_train=2.217696 cos_to_last_merge=0.9431 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.943
[S11] round=54 local utility u=0.601750 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9939574829402559, 'loss_val': 0.021632713253891645, 'psi': 0.9954205054945688}-{'f1_val': 0.8311699527559642, 'auprc': 0.9912254090307288, 'loss_val': 0.22558206317620683, 'psi': 0.89519213526587}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=54 head_norm_before_train=1.861516 (no previous merge yet)
[S13] round=54 local utility u=0.000000 metrics={'f1_val': 0.6321914483477891, 'auprc': 0.8420473827206447, 'loss_val': 0.9831042447980863, 'psi': 0.7161338220969313}-{'f1_val': 0.7071021273374077, 'auprc': 0.850207244909863, 'loss_val': 0.787086623748434, 'psi': 0.7643441743663899}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=54 head_norm_before_train=2.146986 cos_to_last_merge=0.9683 (last merge round=15)
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971545195512257, 'loss_val': 0.023932171899304425, 'psi': 0.9975535186008213}-{'f1_val': 0.9974082695017256, 'auprc': 0.9971584519887473, 'loss_val': 0.019207138681119677, 'psi': 0.9973083424965343}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=2.243763 (no previous merge yet)
[S15] round=54 local utility u=0.374951 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9985312774302769, 'loss_val': 0.019101352842951374, 'psi': 0.9974605120046232}-{'f1_val': 0.8997428134355263, 'auprc': 0.9964368108973276, 'loss_val': 0.18069590773516922, 'psi': 0.9384204124202468}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=54 head_norm_before_train=1.970073 cos_to_last_merge=0.7823 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.782
[S16] round=54 local utility u=0.736372 metrics={'f1_val': 0.9398145968876674, 'auprc': 0.9949590670591058, 'loss_val': 0.3035720665877381, 'psi': 0.9618723849562427}-{'f1_val': 0.8538405678933259, 'auprc': 0.8994523498356469, 'loss_val': 0.973951411582027, 'psi': 0.8720852806702544}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=54 head_norm_before_train=1.736615 cos_to_last_merge=0.8766 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=54 local utility u=0.250476 metrics={'f1_val': 0.6668247460458068, 'auprc': 0.8908970967148284, 'loss_val': 1.1942566228173737, 'psi': 0.7564536863134155}-{'f1_val': 0.6313057917719622, 'auprc': 0.8565746832836763, 'loss_val': 1.3791285628285, 'psi': 0.7214133483766478}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S17] sending update (kind=head size=1806 to 1 peers)
[S2] START round=55 head_norm_before_train=1.899809 cos_to_last_merge=0.7714 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=55 local utility u=0.000000 metrics={'f1_val': 0.7189188626392847, 'auprc': 0.7413578077223579, 'loss_val': 1.0525085441242124, 'psi': 0.7278944406725141}-{'f1_val': 0.7165036360704963, 'auprc': 0.7438900740497245, 'loss_val': 0.9650294188814004, 'psi': 0.7274582112621876}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=55 head_norm_before_train=2.391903 (no previous merge yet)
[S3] round=55 local utility u=0.318566 metrics={'f1_val': 0.9110286300814756, 'auprc': 0.998307709382861, 'loss_val': 0.21961477363427478, 'psi': 0.9459402618020297}-{'f1_val': 0.8460521861685006, 'auprc': 0.9979535501840922, 'loss_val': 0.4658259294387362, 'psi': 0.9068127317747372}
[S3] not sending this round → trigger blocked (psi=0.946)
[S4] START round=55 head_norm_before_train=1.717464 cos_to_last_merge=0.9005 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9574379068165206, 'auprc': 0.957667222402842, 'loss_val': 0.27176892920691836, 'psi': 0.9575296330510492}-{'f1_val': 0.9568367118781012, 'auprc': 0.9707112797896661, 'loss_val': 0.2586294080903753, 'psi': 0.9623865390427271}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=1.592538 cos_to_last_merge=0.8208 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.821
[S5] round=55 local utility u=0.008672 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.995581231118928, 'loss_val': 0.0545931772804406, 'psi': 0.9962536735346459}-{'f1_val': 0.9963338119635569, 'auprc': 0.9937533482285573, 'loss_val': 0.06424451293272641, 'psi': 0.995301626469557}
[S5] not sending this round → trigger blocked (psi=0.996)
[S6] START round=55 head_norm_before_train=1.794921 cos_to_last_merge=0.9125 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.913
[S6] round=55 local utility u=0.534870 metrics={'f1_val': 0.8181643548972508, 'auprc': 0.9308174451566973, 'loss_val': 0.43895534503618383, 'psi': 0.8632255910010294}-{'f1_val': 0.7375930655338472, 'auprc': 0.808904621539645, 'loss_val': 0.6595291215400304, 'psi': 0.7661176879361663}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S6] sending update (kind=head size=1807 to 1 peers)
[S7] START round=55 head_norm_before_train=1.731677 cos_to_last_merge=0.7762 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.776
[S7] round=55 local utility u=0.072144 metrics={'f1_val': 0.6391781502886574, 'auprc': 0.809059680394761, 'loss_val': 0.4257771262948919, 'psi': 0.7071307623310988}-{'f1_val': 0.6346327473474632, 'auprc': 0.806221778772945, 'loss_val': 0.5342791488683121, 'psi': 0.7032683599176559}
[S7] not sending this round → trigger blocked (psi=0.707)
[S8] START round=55 head_norm_before_train=2.106343 (no previous merge yet)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9922391944124518, 'auprc': 0.9988784064896221, 'loss_val': 0.03048152700440615, 'psi': 0.99489487924332}-{'f1_val': 0.992959481021298, 'auprc': 0.9988020186810352, 'loss_val': 0.028699225612712563, 'psi': 0.995296496085193}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=55 head_norm_before_train=2.146563 cos_to_last_merge=0.9366 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.937
[S9] round=55 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.996355512295215, 'loss_val': 0.020034651180268773, 'psi': 0.9962922617856526}-{'f1_val': 0.9968525854255906, 'auprc': 0.998667415453519, 'loss_val': 0.0185014553230257, 'psi': 0.997578517436762}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=55 head_norm_before_train=1.883455 cos_to_last_merge=0.9267 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.927
[S10] round=55 local utility u=0.000145 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9941768427719128, 'loss_val': 0.031463488793439194, 'psi': 0.9936800955197068}-{'f1_val': 0.9933489306849028, 'auprc': 0.994207990874402, 'loss_val': 0.03184688186042915, 'psi': 0.9936925547607025}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=55 head_norm_before_train=2.224751 cos_to_last_merge=0.9424 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=55 local utility u=0.005333 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9960779411119487, 'loss_val': 0.01980797573797819, 'psi': 0.9965166863005268}-{'f1_val': 0.9963958538641108, 'auprc': 0.9939574829402559, 'loss_val': 0.021632713253891645, 'psi': 0.9954205054945688}
[S11] not sending this round → trigger blocked (psi=0.997)
[S13] START round=55 head_norm_before_train=1.867572 (no previous merge yet)
[S13] round=55 local utility u=0.000000 metrics={'f1_val': 0.616666231646179, 'auprc': 0.8118749641219, 'loss_val': 1.1015615779070682, 'psi': 0.6947497246364673}-{'f1_val': 0.6321914483477891, 'auprc': 0.8420473827206447, 'loss_val': 0.9831042447980863, 'psi': 0.7161338220969313}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=55 head_norm_before_train=2.151362 cos_to_last_merge=0.9680 (last merge round=15)
[S14] round=55 local utility u=0.002226 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9972665593139487, 'loss_val': 0.019829452280118922, 'psi': 0.9975996793382349}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971545195512257, 'loss_val': 0.023932171899304425, 'psi': 0.9975535186008213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=55 head_norm_before_train=2.251350 (no previous merge yet)
[S15] round=55 local utility u=0.000000 metrics={'f1_val': 0.9964830448665875, 'auprc': 0.9985571412832609, 'loss_val': 0.017801085124395877, 'psi': 0.9973126834332569}-{'f1_val': 0.9967466683875206, 'auprc': 0.9985312774302769, 'loss_val': 0.019101352842951374, 'psi': 0.9974605120046232}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=55 head_norm_before_train=1.977487 cos_to_last_merge=0.7819 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.782
[S16] round=55 local utility u=0.291757 metrics={'f1_val': 0.9915093021870787, 'auprc': 0.9971882767509903, 'loss_val': 0.036913510683828456, 'psi': 0.9937808920126433}-{'f1_val': 0.9398145968876674, 'auprc': 0.9949590670591058, 'loss_val': 0.3035720665877381, 'psi': 0.9618723849562427}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=55 head_norm_before_train=1.747053 cos_to_last_merge=0.8752 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.875
[S17] round=55 local utility u=0.102849 metrics={'f1_val': 0.6815688588645736, 'auprc': 0.9040115221362935, 'loss_val': 1.1163664420755353, 'psi': 0.7705459241732616}-{'f1_val': 0.6668247460458068, 'auprc': 0.8908970967148284, 'loss_val': 1.1942566228173737, 'psi': 0.7564536863134155}
[S17] not sending this round → trigger blocked (psi=0.771)
[S2] START round=56 head_norm_before_train=1.909403 cos_to_last_merge=0.7707 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.771
[S2] round=56 local utility u=0.000000 metrics={'f1_val': 0.7192088076417031, 'auprc': 0.7407829528434483, 'loss_val': 1.0644075139601314, 'psi': 0.7278384657224012}-{'f1_val': 0.7189188626392847, 'auprc': 0.7413578077223579, 'loss_val': 1.0525085441242124, 'psi': 0.7278944406725141}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=56 head_norm_before_train=2.400334 (no previous merge yet)
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.7564160282072989, 'auprc': 0.9720047838222893, 'loss_val': 0.8137133907247994, 'psi': 0.8426515304532951}-{'f1_val': 0.9110286300814756, 'auprc': 0.998307709382861, 'loss_val': 0.21961477363427478, 'psi': 0.9459402618020297}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.722605 cos_to_last_merge=0.8996 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.900
[S4] round=56 local utility u=0.026090 metrics={'f1_val': 0.9521202986740973, 'auprc': 0.9834774878884731, 'loss_val': 0.2651137702913759, 'psi': 0.9646631743598477}-{'f1_val': 0.9574379068165206, 'auprc': 0.957667222402842, 'loss_val': 0.27176892920691836, 'psi': 0.9575296330510492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=56 head_norm_before_train=1.605052 cos_to_last_merge=0.8179 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.818
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9873786432279685, 'loss_val': 0.07154963649191967, 'psi': 0.9927517444693215}-{'f1_val': 0.9967019684784577, 'auprc': 0.995581231118928, 'loss_val': 0.0545931772804406, 'psi': 0.9962536735346459}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.804439 cos_to_last_merge=0.9109 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.911
[S6] round=56 local utility u=0.024919 metrics={'f1_val': 0.8213753491568938, 'auprc': 0.9288733251578903, 'loss_val': 0.40255058914964414, 'psi': 0.8643745395572924}-{'f1_val': 0.8181643548972508, 'auprc': 0.9308174451566973, 'loss_val': 0.43895534503618383, 'psi': 0.8632255910010294}
[S6] not sending this round → trigger blocked (psi=0.864)
[S7] START round=56 head_norm_before_train=1.735975 cos_to_last_merge=0.7755 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.776
[S7] round=56 local utility u=0.168557 metrics={'f1_val': 0.6714535903513668, 'auprc': 0.8331878973183086, 'loss_val': 0.3547000591817544, 'psi': 0.7361473131381435}-{'f1_val': 0.6391781502886574, 'auprc': 0.809059680394761, 'loss_val': 0.4257771262948919, 'psi': 0.7071307623310988}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=56 head_norm_before_train=2.113523 (no previous merge yet)
[S8] round=56 local utility u=0.005164 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9988477314292383, 'loss_val': 0.030032722625516137, 'psi': 0.9958796857568042}-{'f1_val': 0.9922391944124518, 'auprc': 0.9988784064896221, 'loss_val': 0.03048152700440615, 'psi': 0.99489487924332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=56 head_norm_before_train=2.149377 cos_to_last_merge=0.9360 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.936
[S9] round=56 local utility u=0.000000 metrics={'f1_val': 0.9901183584159563, 'auprc': 0.9985043938131385, 'loss_val': 0.036180239039157895, 'psi': 0.9934727725748291}-{'f1_val': 0.9962500947792776, 'auprc': 0.996355512295215, 'loss_val': 0.020034651180268773, 'psi': 0.9962922617856526}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=56 head_norm_before_train=1.890298 cos_to_last_merge=0.9261 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.926
[S10] round=56 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943542056328034, 'loss_val': 0.032420117628272085, 'psi': 0.9937510406640631}-{'f1_val': 0.9933489306849028, 'auprc': 0.9941768427719128, 'loss_val': 0.031463488793439194, 'psi': 0.9936800955197068}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=56 head_norm_before_train=2.231233 cos_to_last_merge=0.9418 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9925289449469417, 'loss_val': 0.046874892261259106, 'psi': 0.9948490902972431}-{'f1_val': 0.9968091830929121, 'auprc': 0.9960779411119487, 'loss_val': 0.01980797573797819, 'psi': 0.9965166863005268}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=56 head_norm_before_train=1.873398 (no previous merge yet)
[S13] round=56 local utility u=0.672544 metrics={'f1_val': 0.767895437528666, 'auprc': 0.830805304681473, 'loss_val': 0.720639417131842, 'psi': 0.7930593843897887}-{'f1_val': 0.616666231646179, 'auprc': 0.8118749641219, 'loss_val': 1.1015615779070682, 'psi': 0.6947497246364673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=56 head_norm_before_train=2.158525 cos_to_last_merge=0.9675 (last merge round=15)
[S14] round=56 local utility u=0.002926 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9992296990797447, 'loss_val': 0.018859086204231143, 'psi': 0.9982841853214715}-{'f1_val': 0.9978217593544257, 'auprc': 0.9972665593139487, 'loss_val': 0.019829452280118922, 'psi': 0.9975996793382349}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=56 head_norm_before_train=2.258550 (no previous merge yet)
[S15] round=56 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980641314283275, 'loss_val': 0.019811931440872604, 'psi': 0.9972736536038433}-{'f1_val': 0.9964830448665875, 'auprc': 0.9985571412832609, 'loss_val': 0.017801085124395877, 'psi': 0.9973126834332569}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=56 head_norm_before_train=1.983252 cos_to_last_merge=0.7813 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.9904417337346088, 'auprc': 0.9963159135573745, 'loss_val': 0.03948354657657836, 'psi': 0.992791405663715}-{'f1_val': 0.9915093021870787, 'auprc': 0.9971882767509903, 'loss_val': 0.036913510683828456, 'psi': 0.9937808920126433}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.755897 cos_to_last_merge=0.8737 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=56 local utility u=0.138399 metrics={'f1_val': 0.6926608195589256, 'auprc': 0.9095485691899989, 'loss_val': 0.9227311450742682, 'psi': 0.779415919411355}-{'f1_val': 0.6815688588645736, 'auprc': 0.9040115221362935, 'loss_val': 1.1163664420755353, 'psi': 0.7705459241732616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] START round=57 head_norm_before_train=1.920211 cos_to_last_merge=0.7699 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.770
[S2] round=57 local utility u=0.035381 metrics={'f1_val': 0.71406921661169, 'auprc': 0.7422923082471957, 'loss_val': 0.9673364870605787, 'psi': 0.7253584532658923}-{'f1_val': 0.7192088076417031, 'auprc': 0.7407829528434483, 'loss_val': 1.0644075139601314, 'psi': 0.7278384657224012}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=57 head_norm_before_train=2.407993 (no previous merge yet)
[S3] round=57 local utility u=0.825608 metrics={'f1_val': 0.9241343333713217, 'auprc': 0.991670077722279, 'loss_val': 0.2278031429745287, 'psi': 0.9511486311117046}-{'f1_val': 0.7564160282072989, 'auprc': 0.9720047838222893, 'loss_val': 0.8137133907247994, 'psi': 0.8426515304532951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=57 head_norm_before_train=1.730456 cos_to_last_merge=0.8986 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.899
[S4] round=57 local utility u=0.000000 metrics={'f1_val': 0.9500607629609463, 'auprc': 0.9855593561917362, 'loss_val': 0.2624456117501382, 'psi': 0.9642602002532623}-{'f1_val': 0.9521202986740973, 'auprc': 0.9834774878884731, 'loss_val': 0.2651137702913759, 'psi': 0.9646631743598477}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=57 head_norm_before_train=1.613578 cos_to_last_merge=0.8161 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.816
[S5] round=57 local utility u=0.022349 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9949731811562059, 'loss_val': 0.04963454155110633, 'psi': 0.9957895596406164}-{'f1_val': 0.9963338119635569, 'auprc': 0.9873786432279685, 'loss_val': 0.07154963649191967, 'psi': 0.9927517444693215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=57 head_norm_before_train=1.815115 cos_to_last_merge=0.9094 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=57 local utility u=0.000000 metrics={'f1_val': 0.7622967875691489, 'auprc': 0.9072499669066089, 'loss_val': 0.5642705184130249, 'psi': 0.8202780593041329}-{'f1_val': 0.8213753491568938, 'auprc': 0.9288733251578903, 'loss_val': 0.40255058914964414, 'psi': 0.8643745395572924}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=57 head_norm_before_train=1.747427 cos_to_last_merge=0.7745 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.775
[S7] round=57 local utility u=0.000000 metrics={'f1_val': 0.6887042575234852, 'auprc': 0.8090761435887809, 'loss_val': 0.3876944503414037, 'psi': 0.7368530119496035}-{'f1_val': 0.6714535903513668, 'auprc': 0.8331878973183086, 'loss_val': 0.3547000591817544, 'psi': 0.7361473131381435}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=57 head_norm_before_train=2.116185 (no previous merge yet)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.9925945134171912, 'auprc': 0.9989063389222699, 'loss_val': 0.028655439032601142, 'psi': 0.9951192436192227}-{'f1_val': 0.9939009886418481, 'auprc': 0.9988477314292383, 'loss_val': 0.030032722625516137, 'psi': 0.9958796857568042}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=57 head_norm_before_train=2.154811 cos_to_last_merge=0.9353 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.935
[S9] round=57 local utility u=0.026265 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9973059598257011, 'loss_val': 0.019499979039153934, 'psi': 0.9969378786891377}-{'f1_val': 0.9901183584159563, 'auprc': 0.9985043938131385, 'loss_val': 0.036180239039157895, 'psi': 0.9934727725748291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=57 head_norm_before_train=1.894434 cos_to_last_merge=0.9253 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=57 local utility u=0.000533 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9954570914899501, 'loss_val': 0.033349462744480855, 'psi': 0.9940608033473307}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943542056328034, 'loss_val': 0.032420117628272085, 'psi': 0.9937510406640631}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=57 head_norm_before_train=2.237314 cos_to_last_merge=0.9412 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.941
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9925760341589014, 'loss_val': 0.04732309628747506, 'psi': 0.9947228985100078}-{'f1_val': 0.9963958538641108, 'auprc': 0.9925289449469417, 'loss_val': 0.046874892261259106, 'psi': 0.9948490902972431}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=57 head_norm_before_train=1.875594 (no previous merge yet)
[S13] round=57 local utility u=0.000000 metrics={'f1_val': 0.6120532079683244, 'auprc': 0.8412516589885961, 'loss_val': 1.195715346384543, 'psi': 0.7037325883764332}-{'f1_val': 0.767895437528666, 'auprc': 0.830805304681473, 'loss_val': 0.720639417131842, 'psi': 0.7930593843897887}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=57 head_norm_before_train=2.163870 cos_to_last_merge=0.9672 (last merge round=15)
[S14] round=57 local utility u=0.000118 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9991949829025147, 'loss_val': 0.018518642242885762, 'psi': 0.9982702988505795}-{'f1_val': 0.9976538428159559, 'auprc': 0.9992296990797447, 'loss_val': 0.018859086204231143, 'psi': 0.9982841853214715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=57 head_norm_before_train=2.265010 (no previous merge yet)
[S15] round=57 local utility u=0.000100 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980646588319511, 'loss_val': 0.019613480359045365, 'psi': 0.9972738645652928}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980641314283275, 'loss_val': 0.019811931440872604, 'psi': 0.9972736536038433}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=57 head_norm_before_train=1.984190 cos_to_last_merge=0.7806 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.781
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.9391672901714323, 'auprc': 0.986005038317636, 'loss_val': 0.33728693055739156, 'psi': 0.9579023894299138}-{'f1_val': 0.9904417337346088, 'auprc': 0.9963159135573745, 'loss_val': 0.03948354657657836, 'psi': 0.992791405663715}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.764397 cos_to_last_merge=0.8719 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.872
[S17] round=57 local utility u=1.000000 metrics={'f1_val': 0.9175813740441061, 'auprc': 0.9970457561484167, 'loss_val': 0.2016380409456474, 'psi': 0.9493671268858304}-{'f1_val': 0.6926608195589256, 'auprc': 0.9095485691899989, 'loss_val': 0.9227311450742682, 'psi': 0.779415919411355}
[S17] not sending this round → trigger blocked (psi=0.949)
[S2] START round=58 head_norm_before_train=1.930253 cos_to_last_merge=0.7690 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.769
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.6946365284049096, 'auprc': 0.7467797454309235, 'loss_val': 0.9955678522488086, 'psi': 0.7154938152153152}-{'f1_val': 0.71406921661169, 'auprc': 0.7422923082471957, 'loss_val': 0.9673364870605787, 'psi': 0.7253584532658923}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=58 head_norm_before_train=2.415214 (no previous merge yet)
[S3] round=58 local utility u=0.336457 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9997281482815883, 'loss_val': 0.01703869975606879, 'psi': 0.9981693916145032}-{'f1_val': 0.9241343333713217, 'auprc': 0.991670077722279, 'loss_val': 0.2278031429745287, 'psi': 0.9511486311117046}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=58 head_norm_before_train=1.736478 cos_to_last_merge=0.8975 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=58 local utility u=0.000000 metrics={'f1_val': 0.9521968323657379, 'auprc': 0.9759809782039256, 'loss_val': 0.27105537281252545, 'psi': 0.961710490701013}-{'f1_val': 0.9500607629609463, 'auprc': 0.9855593561917362, 'loss_val': 0.2624456117501382, 'psi': 0.9642602002532623}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=58 head_norm_before_train=1.623178 cos_to_last_merge=0.8134 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.813
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9935156683920024, 'loss_val': 0.04678973066863105, 'psi': 0.9952065545349351}-{'f1_val': 0.9963338119635569, 'auprc': 0.9949731811562059, 'loss_val': 0.04963454155110633, 'psi': 0.9957895596406164}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.825511 cos_to_last_merge=0.9078 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=58 local utility u=0.000000 metrics={'f1_val': 0.6470599459404708, 'auprc': 0.8883028436544465, 'loss_val': 0.7091979815548984, 'psi': 0.7435571050260611}-{'f1_val': 0.7622967875691489, 'auprc': 0.9072499669066089, 'loss_val': 0.5642705184130249, 'psi': 0.8202780593041329}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=58 head_norm_before_train=1.758267 cos_to_last_merge=0.7731 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.773
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.6038118260388017, 'auprc': 0.7958544359653161, 'loss_val': 0.8481014624727274, 'psi': 0.6806288700094074}-{'f1_val': 0.6887042575234852, 'auprc': 0.8090761435887809, 'loss_val': 0.3876944503414037, 'psi': 0.7368530119496035}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=2.117068 (no previous merge yet)
[S8] round=58 local utility u=0.000000 metrics={'f1_val': 0.989780933099827, 'auprc': 0.9989482312929394, 'loss_val': 0.033094538206276905, 'psi': 0.993447852377072}-{'f1_val': 0.9925945134171912, 'auprc': 0.9989063389222699, 'loss_val': 0.028655439032601142, 'psi': 0.9951192436192227}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=58 head_norm_before_train=2.159929 cos_to_last_merge=0.9344 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.934
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9901606111321243, 'auprc': 0.998689816146212, 'loss_val': 0.02562357197158494, 'psi': 0.9935722931377594}-{'f1_val': 0.9966924912647621, 'auprc': 0.9973059598257011, 'loss_val': 0.019499979039153934, 'psi': 0.9969378786891377}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.899247 cos_to_last_merge=0.9246 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.925
[S10] round=58 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943593602616363, 'loss_val': 0.031962252370894305, 'psi': 0.9937531025155962}-{'f1_val': 0.9931299445855843, 'auprc': 0.9954570914899501, 'loss_val': 0.033349462744480855, 'psi': 0.9940608033473307}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=58 head_norm_before_train=2.244419 cos_to_last_merge=0.9404 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=58 local utility u=0.014455 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9937378527844131, 'loss_val': 0.02189811996802425, 'psi': 0.9951876259602125}-{'f1_val': 0.9961541414107454, 'auprc': 0.9925760341589014, 'loss_val': 0.04732309628747506, 'psi': 0.9947228985100078}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] sending update (kind=head size=1794 to 1 peers)
[S13] START round=58 head_norm_before_train=1.880205 (no previous merge yet)
[S13] round=58 local utility u=0.613762 metrics={'f1_val': 0.7619504793467106, 'auprc': 0.8176743190662804, 'loss_val': 0.7968422610323068, 'psi': 0.7842400152345386}-{'f1_val': 0.6120532079683244, 'auprc': 0.8412516589885961, 'loss_val': 1.195715346384543, 'psi': 0.7037325883764332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] sending update (kind=head size=1804 to 1 peers)
[S14] START round=58 head_norm_before_train=2.168952 cos_to_last_merge=0.9667 (last merge round=15)
[S14] round=58 local utility u=0.000789 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9988545962261431, 'loss_val': 0.018384794581268845, 'psi': 0.9983806032319895}-{'f1_val': 0.9976538428159559, 'auprc': 0.9991949829025147, 'loss_val': 0.018518642242885762, 'psi': 0.9982702988505795}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=58 head_norm_before_train=2.271885 (no previous merge yet)
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.9673215186055643, 'auprc': 0.9974500539861912, 'loss_val': 0.056653540275888425, 'psi': 0.9793729327578151}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980646588319511, 'loss_val': 0.019613480359045365, 'psi': 0.9972738645652928}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=1.987130 cos_to_last_merge=0.7801 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=58 local utility u=0.000000 metrics={'f1_val': 0.9391865379189132, 'auprc': 0.9850524768022856, 'loss_val': 0.3564088974971207, 'psi': 0.9575329134722621}-{'f1_val': 0.9391672901714323, 'auprc': 0.986005038317636, 'loss_val': 0.33728693055739156, 'psi': 0.9579023894299138}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=58 head_norm_before_train=1.771902 cos_to_last_merge=0.8702 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.870
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6964571871706267, 'auprc': 0.9501187652212193, 'loss_val': 0.8565640217664096, 'psi': 0.7979218183908637}-{'f1_val': 0.9175813740441061, 'auprc': 0.9970457561484167, 'loss_val': 0.2016380409456474, 'psi': 0.9493671268858304}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=59 head_norm_before_train=1.940063 cos_to_last_merge=0.7683 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.6291211609778601, 'auprc': 0.7444643972343146, 'loss_val': 1.3265656046171814, 'psi': 0.6752584554804419}-{'f1_val': 0.6946365284049096, 'auprc': 0.7467797454309235, 'loss_val': 0.9955678522488086, 'psi': 0.7154938152153152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=60 psi=0.675 u=0.0000 p_local=0.0461 f1=0.629 auprc=0.744 bytes=50400
[S3] START round=59 head_norm_before_train=2.421925 (no previous merge yet)
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.9348958752843897, 'auprc': 0.9990884058272407, 'loss_val': 0.22509286223027364, 'psi': 0.96057288750153}-{'f1_val': 0.9971302205031132, 'auprc': 0.9997281482815883, 'loss_val': 0.01703869975606879, 'psi': 0.9981693916145032}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.961 u=0.0000 p_local=0.2902 f1=0.935 auprc=0.999 bytes=43156
[S4] START round=59 head_norm_before_train=1.741526 cos_to_last_merge=0.8967 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=59 local utility u=0.014816 metrics={'f1_val': 0.9573837166984988, 'auprc': 0.9735597083871447, 'loss_val': 0.2652814866253616, 'psi': 0.9638541133739571}-{'f1_val': 0.9521968323657379, 'auprc': 0.9759809782039256, 'loss_val': 0.27105537281252545, 'psi': 0.961710490701013}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=60 psi=0.964 u=0.0148 p_local=0.0089 f1=0.957 auprc=0.974 bytes=61194
[S5] START round=59 head_norm_before_train=1.644307 cos_to_last_merge=0.8090 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.809
[S5] round=59 local utility u=0.003870 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9952790121369663, 'loss_val': 0.044339831787939474, 'psi': 0.9959118920329206}-{'f1_val': 0.9963338119635569, 'auprc': 0.9935156683920024, 'loss_val': 0.04678973066863105, 'psi': 0.9952065545349351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S5] r=60 psi=0.996 u=0.0039 p_local=0.0518 f1=0.996 auprc=0.995 bytes=55769
[S6] START round=59 head_norm_before_train=1.834097 cos_to_last_merge=0.9070 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=59 local utility u=0.291093 metrics={'f1_val': 0.6604150134328123, 'auprc': 0.9410583228104332, 'loss_val': 0.3654084907617767, 'psi': 0.7726723371838606}-{'f1_val': 0.6470599459404708, 'auprc': 0.8883028436544465, 'loss_val': 0.7091979815548984, 'psi': 0.7435571050260611}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S6] r=60 psi=0.773 u=0.2911 p_local=0.2225 f1=0.660 auprc=0.941 bytes=46819
[S7] START round=59 head_norm_before_train=1.766756 cos_to_last_merge=0.7724 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=59 local utility u=0.096868 metrics={'f1_val': 0.6117463220869364, 'auprc': 0.7975039712380441, 'loss_val': 0.7069209654966885, 'psi': 0.6860493817473794}-{'f1_val': 0.6038118260388017, 'auprc': 0.7958544359653161, 'loss_val': 0.8481014624727274, 'psi': 0.6806288700094074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=60 psi=0.686 u=0.0969 p_local=0.0794 f1=0.612 auprc=0.798 bytes=54017
[S8] START round=59 head_norm_before_train=2.120852 (no previous merge yet)
[S8] round=59 local utility u=0.011338 metrics={'f1_val': 0.9930017911527874, 'auprc': 0.9987980712470577, 'loss_val': 0.029292977587005144, 'psi': 0.9953203031904956}-{'f1_val': 0.989780933099827, 'auprc': 0.9989482312929394, 'loss_val': 0.033094538206276905, 'psi': 0.993447852377072}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S8] r=60 psi=0.995 u=0.0113 p_local=0.0133 f1=0.993 auprc=0.999 bytes=52146
[S9] START round=59 head_norm_before_train=2.165719 cos_to_last_merge=0.9339 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.934
[S9] round=59 local utility u=0.024925 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986521230553866, 'loss_val': 0.01731513232408672, 'psi': 0.9977225967294403}-{'f1_val': 0.9901606111321243, 'auprc': 0.998689816146212, 'loss_val': 0.02562357197158494, 'psi': 0.9935722931377594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S9] r=60 psi=0.998 u=0.0249 p_local=0.0090 f1=0.997 auprc=0.999 bytes=59360
[S10] START round=59 head_norm_before_train=1.905611 cos_to_last_merge=0.9239 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.924
[S10] round=59 local utility u=0.001756 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9941504610209345, 'loss_val': 0.030451957779006895, 'psi': 0.9939324575531868}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943593602616363, 'loss_val': 0.031962252370894305, 'psi': 0.9937531025155962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S10] r=60 psi=0.994 u=0.0018 p_local=0.0007 f1=0.994 auprc=0.994 bytes=57593
[S11] START round=59 head_norm_before_train=2.250826 cos_to_last_merge=0.9398 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.940
[S11] round=59 local utility u=0.004310 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9945166114295941, 'loss_val': 0.019544334705968888, 'psi': 0.9958921544275849}-{'f1_val': 0.9961541414107454, 'auprc': 0.9937378527844131, 'loss_val': 0.02189811996802425, 'psi': 0.9951876259602125}
[S11] not sending this round → trigger blocked (psi=0.996)
[S11] r=60 psi=0.996 u=0.0043 p_local=0.0493 f1=0.997 auprc=0.995 bytes=61101
[S13] START round=59 head_norm_before_train=1.887902 (no previous merge yet)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.7443871825996997, 'auprc': 0.8409891053562771, 'loss_val': 0.9809384087906037, 'psi': 0.7830279517023306}-{'f1_val': 0.7619504793467106, 'auprc': 0.8176743190662804, 'loss_val': 0.7968422610323068, 'psi': 0.7842400152345386}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] r=60 psi=0.783 u=0.0000 p_local=0.2201 f1=0.744 auprc=0.841 bytes=53945
[S14] START round=59 head_norm_before_train=2.173537 cos_to_last_merge=0.9664 (last merge round=15)
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9988565338264269, 'loss_val': 0.020388945588465643, 'psi': 0.9982343243109018}-{'f1_val': 0.9980646079025537, 'auprc': 0.9988545962261431, 'loss_val': 0.018384794581268845, 'psi': 0.9983806032319895}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.998 u=0.0000 p_local=0.0152 f1=0.998 auprc=0.999 bytes=55760
[S15] START round=59 head_norm_before_train=2.278955 (no previous merge yet)
[S15] round=59 local utility u=0.000000 metrics={'f1_val': 0.8956455365161755, 'auprc': 0.996729030777509, 'loss_val': 0.260042274228127, 'psi': 0.9360789342207089}-{'f1_val': 0.9673215186055643, 'auprc': 0.9974500539861912, 'loss_val': 0.056653540275888425, 'psi': 0.9793729327578151}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=60 psi=0.936 u=0.0000 p_local=0.0860 f1=0.896 auprc=0.997 bytes=48524
[S16] START round=59 head_norm_before_train=1.992968 cos_to_last_merge=0.7796 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.780
[S16] round=59 local utility u=0.130276 metrics={'f1_val': 0.9465112362843362, 'auprc': 0.9916773931897253, 'loss_val': 0.1596793653959958, 'psi': 0.9645776990464918}-{'f1_val': 0.9391865379189132, 'auprc': 0.9850524768022856, 'loss_val': 0.3564088974971207, 'psi': 0.9575329134722621}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=60 psi=0.965 u=0.1303 p_local=0.1309 f1=0.947 auprc=0.992 bytes=50339
[S17] START round=59 head_norm_before_train=1.777370 cos_to_last_merge=0.8688 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.869
[S17] round=59 local utility u=0.202433 metrics={'f1_val': 0.7170873306416227, 'auprc': 0.989606610772022, 'loss_val': 0.6939431611841992, 'psi': 0.8260950426937824}-{'f1_val': 0.6964571871706267, 'auprc': 0.9501187652212193, 'loss_val': 0.8565640217664096, 'psi': 0.7979218183908637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S17] r=60 psi=0.826 u=0.2024 p_local=0.2201 f1=0.717 auprc=0.990 bytes=48630
[S2] START round=60 head_norm_before_train=1.950677 cos_to_last_merge=0.7675 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.768
[S2] round=60 local utility u=0.417402 metrics={'f1_val': 0.7126865614105646, 'auprc': 0.7436003858743387, 'loss_val': 0.9905628744040998, 'psi': 0.7250520911960743}-{'f1_val': 0.6291211609778601, 'auprc': 0.7444643972343146, 'loss_val': 1.3265656046171814, 'psi': 0.6752584554804419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] sending update (kind=head size=1801 to 1 peers)
[S3] START round=60 head_norm_before_train=2.428614 (no previous merge yet)
[S3] round=60 local utility u=0.290110 metrics={'f1_val': 0.996718896605481, 'auprc': 0.9996122546744799, 'loss_val': 0.017381582751892704, 'psi': 0.9978762398330805}-{'f1_val': 0.9348958752843897, 'auprc': 0.9990884058272407, 'loss_val': 0.22509286223027364, 'psi': 0.96057288750153}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=60 head_norm_before_train=1.746610 cos_to_last_merge=0.8958 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.896
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9518656208117466, 'auprc': 0.9752314475157036, 'loss_val': 0.2743978805354321, 'psi': 0.9612119514933294}-{'f1_val': 0.9573837166984988, 'auprc': 0.9735597083871447, 'loss_val': 0.2652814866253616, 'psi': 0.9638541133739571}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=1.663460 cos_to_last_merge=0.8054 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.805
[S5] round=60 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9933883153316861, 'loss_val': 0.0458792486105783, 'psi': 0.9951556133108086}-{'f1_val': 0.9963338119635569, 'auprc': 0.9952790121369663, 'loss_val': 0.044339831787939474, 'psi': 0.9959118920329206}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=60 head_norm_before_train=1.843579 cos_to_last_merge=0.9058 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=60 local utility u=0.547801 metrics={'f1_val': 0.8283902013382183, 'auprc': 0.9471797352528921, 'loss_val': 0.29602097848847286, 'psi': 0.8759060149040878}-{'f1_val': 0.6604150134328123, 'auprc': 0.9410583228104332, 'loss_val': 0.3654084907617767, 'psi': 0.7726723371838606}
[S6] not sending this round → trigger blocked (psi=0.876)
[S7] START round=60 head_norm_before_train=1.772196 cos_to_last_merge=0.7718 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=60 local utility u=0.000000 metrics={'f1_val': 0.5775370529102004, 'auprc': 0.7937153653212441, 'loss_val': 0.9897469268742498, 'psi': 0.664008377874618}-{'f1_val': 0.6117463220869364, 'auprc': 0.7975039712380441, 'loss_val': 0.7069209654966885, 'psi': 0.6860493817473794}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=60 head_norm_before_train=2.125983 (no previous merge yet)
[S8] round=60 local utility u=0.000000 metrics={'f1_val': 0.9927382257356948, 'auprc': 0.9952177405931779, 'loss_val': 0.04139000706745408, 'psi': 0.9937300316786881}-{'f1_val': 0.9930017911527874, 'auprc': 0.9987980712470577, 'loss_val': 0.029292977587005144, 'psi': 0.9953203031904956}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=60 head_norm_before_train=2.173345 cos_to_last_merge=0.9335 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9976735350309159, 'loss_val': 0.019527412373399264, 'psi': 0.9970657211007012}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986521230553866, 'loss_val': 0.01731513232408672, 'psi': 0.9977225967294403}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=1.912596 cos_to_last_merge=0.9233 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=60 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943780194928533, 'loss_val': 0.0321288778899231, 'psi': 0.9937605662080831}-{'f1_val': 0.9937871219080217, 'auprc': 0.9941504610209345, 'loss_val': 0.030451957779006895, 'psi': 0.9939324575531868}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=60 head_norm_before_train=2.256891 cos_to_last_merge=0.9393 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=60 local utility u=0.000000 metrics={'f1_val': 0.976311188587986, 'auprc': 0.992323474525113, 'loss_val': 0.07765457646464896, 'psi': 0.9827161029628368}-{'f1_val': 0.9968091830929121, 'auprc': 0.9945166114295941, 'loss_val': 0.019544334705968888, 'psi': 0.9958921544275849}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=60 head_norm_before_train=1.895470 (no previous merge yet)
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6925114461749406, 'auprc': 0.8248710273108536, 'loss_val': 1.0817625805697835, 'psi': 0.7454552786293058}-{'f1_val': 0.7443871825996997, 'auprc': 0.8409891053562771, 'loss_val': 0.9809384087906037, 'psi': 0.7830279517023306}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=60 head_norm_before_train=2.176299 cos_to_last_merge=0.9662 (last merge round=15)
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9988568117116536, 'loss_val': 0.025657441972573712, 'psi': 0.9977373508981308}-{'f1_val': 0.9978195179672185, 'auprc': 0.9988565338264269, 'loss_val': 0.020388945588465643, 'psi': 0.9982343243109018}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=2.285734 (no previous merge yet)
[S15] round=60 local utility u=0.047078 metrics={'f1_val': 0.9020457798732815, 'auprc': 0.9967008410245835, 'loss_val': 0.20420264721292006, 'psi': 0.9399078043338023}-{'f1_val': 0.8956455365161755, 'auprc': 0.996729030777509, 'loss_val': 0.260042274228127, 'psi': 0.9360789342207089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=60 head_norm_before_train=1.999995 cos_to_last_merge=0.7793 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=60 local utility u=0.208432 metrics={'f1_val': 0.9922129061711736, 'auprc': 0.9972152436826716, 'loss_val': 0.033639581979343774, 'psi': 0.9942138411757728}-{'f1_val': 0.9465112362843362, 'auprc': 0.9916773931897253, 'loss_val': 0.1596793653959958, 'psi': 0.9645776990464918}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=60 head_norm_before_train=1.782668 cos_to_last_merge=0.8681 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.868
[S17] round=60 local utility u=0.142436 metrics={'f1_val': 0.7354309812250089, 'auprc': 0.9959886979850965, 'loss_val': 0.538278329705314, 'psi': 0.839654067929044}-{'f1_val': 0.7170873306416227, 'auprc': 0.989606610772022, 'loss_val': 0.6939431611841992, 'psi': 0.8260950426937824}
[S17] not sending this round → trigger blocked (psi=0.840)
[S2] START round=61 head_norm_before_train=1.958280 cos_to_last_merge=0.7669 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.767
[S2] round=61 local utility u=0.000000 metrics={'f1_val': 0.7115327293486028, 'auprc': 0.7423840627585127, 'loss_val': 0.9801575581021087, 'psi': 0.7238732627125668}-{'f1_val': 0.7126865614105646, 'auprc': 0.7436003858743387, 'loss_val': 0.9905628744040998, 'psi': 0.7250520911960743}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=61 head_norm_before_train=2.434409 (no previous merge yet)
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.9712232330355531, 'auprc': 0.9983964663101335, 'loss_val': 0.08105918454806396, 'psi': 0.9820925263453852}-{'f1_val': 0.996718896605481, 'auprc': 0.9996122546744799, 'loss_val': 0.017381582751892704, 'psi': 0.9978762398330805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.754284 cos_to_last_merge=0.8948 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.895
[S4] round=61 local utility u=0.000000 metrics={'f1_val': 0.9424287127349863, 'auprc': 0.9505513270377599, 'loss_val': 0.28733945360395224, 'psi': 0.9456777584560957}-{'f1_val': 0.9518656208117466, 'auprc': 0.9752314475157036, 'loss_val': 0.2743978805354321, 'psi': 0.9612119514933294}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=61 head_norm_before_train=1.683395 cos_to_last_merge=0.8022 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.802
[S5] round=61 local utility u=0.009783 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9969831196980571, 'loss_val': 0.037097473457108225, 'psi': 0.9965935350573569}-{'f1_val': 0.9963338119635569, 'auprc': 0.9933883153316861, 'loss_val': 0.0458792486105783, 'psi': 0.9951556133108086}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=61 head_norm_before_train=1.851532 cos_to_last_merge=0.9043 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=61 local utility u=0.000000 metrics={'f1_val': 0.7886499957090292, 'auprc': 0.9185372344228615, 'loss_val': 0.5480784571527428, 'psi': 0.840604891194562}-{'f1_val': 0.8283902013382183, 'auprc': 0.9471797352528921, 'loss_val': 0.29602097848847286, 'psi': 0.8759060149040878}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=61 head_norm_before_train=1.776143 cos_to_last_merge=0.7718 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=61 local utility u=0.930861 metrics={'f1_val': 0.7199178992149028, 'auprc': 0.8740121282011034, 'loss_val': 0.22319954143142015, 'psi': 0.781555590809383}-{'f1_val': 0.5775370529102004, 'auprc': 0.7937153653212441, 'loss_val': 0.9897469268742498, 'psi': 0.664008377874618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=61 head_norm_before_train=2.134335 (no previous merge yet)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.8300055601765143, 'auprc': 0.9852559905710206, 'loss_val': 0.18340004861421133, 'psi': 0.8921057323343168}-{'f1_val': 0.9927382257356948, 'auprc': 0.9952177405931779, 'loss_val': 0.04139000706745408, 'psi': 0.9937300316786881}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=61 head_norm_before_train=2.176356 cos_to_last_merge=0.9328 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9964129259124725, 'loss_val': 0.019554633551142234, 'psi': 0.9965614774533239}-{'f1_val': 0.9966605118138915, 'auprc': 0.9976735350309159, 'loss_val': 0.019527412373399264, 'psi': 0.9970657211007012}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.917312 cos_to_last_merge=0.9226 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.923
[S10] round=61 local utility u=0.000814 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9956874793054524, 'loss_val': 0.03311527437023453, 'psi': 0.9941529584735316}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943780194928533, 'loss_val': 0.0321288778899231, 'psi': 0.9937605662080831}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] START round=61 head_norm_before_train=2.263011 cos_to_last_merge=0.9387 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.939
[S11] round=61 local utility u=0.083064 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9926717204964832, 'loss_val': 0.03162904416243723, 'psi': 0.9947611730450405}-{'f1_val': 0.976311188587986, 'auprc': 0.992323474525113, 'loss_val': 0.07765457646464896, 'psi': 0.9827161029628368}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=61 head_norm_before_train=1.899420 (no previous merge yet)
[S13] round=61 local utility u=0.404605 metrics={'f1_val': 0.7729385342380732, 'auprc': 0.7915410919382107, 'loss_val': 0.6551244319997457, 'psi': 0.7803795573181282}-{'f1_val': 0.6925114461749406, 'auprc': 0.8248710273108536, 'loss_val': 1.0817625805697835, 'psi': 0.7454552786293058}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=61 head_norm_before_train=2.178943 cos_to_last_merge=0.9659 (last merge round=15)
[S14] round=61 local utility u=0.004840 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9988547215296281, 'loss_val': 0.01994736832899608, 'psi': 0.9981341943014248}-{'f1_val': 0.9969910436891155, 'auprc': 0.9988568117116536, 'loss_val': 0.025657441972573712, 'psi': 0.9977373508981308}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=61 head_norm_before_train=2.291926 (no previous merge yet)
[S15] round=61 local utility u=0.377403 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9978706969087019, 'loss_val': 0.021110604271079584, 'psi': 0.9971962797959931}-{'f1_val': 0.9020457798732815, 'auprc': 0.9967008410245835, 'loss_val': 0.20420264721292006, 'psi': 0.9399078043338023}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=61 head_norm_before_train=2.007880 cos_to_last_merge=0.7790 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=61 local utility u=0.000207 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9987183313477566, 'loss_val': 0.03392896618992057, 'psi': 0.9944344973409205}-{'f1_val': 0.9922129061711736, 'auprc': 0.9972152436826716, 'loss_val': 0.033639581979343774, 'psi': 0.9942138411757728}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=61 head_norm_before_train=1.789427 cos_to_last_merge=0.8672 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.867
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.7247149570289491, 'auprc': 0.9930702742980311, 'loss_val': 0.6291577284408449, 'psi': 0.832057083936582}-{'f1_val': 0.7354309812250089, 'auprc': 0.9959886979850965, 'loss_val': 0.538278329705314, 'psi': 0.839654067929044}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=62 head_norm_before_train=1.966401 cos_to_last_merge=0.7661 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.766
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.7016343122045032, 'auprc': 0.7435458059914972, 'loss_val': 1.0278433258219992, 'psi': 0.7183989097193009}-{'f1_val': 0.7115327293486028, 'auprc': 0.7423840627585127, 'loss_val': 0.9801575581021087, 'psi': 0.7238732627125668}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=62 head_norm_before_train=2.439307 (no previous merge yet)
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.7832491779437751, 'auprc': 0.9921568798508588, 'loss_val': 0.7042084135573005, 'psi': 0.8668122587066086}-{'f1_val': 0.9712232330355531, 'auprc': 0.9983964663101335, 'loss_val': 0.08105918454806396, 'psi': 0.9820925263453852}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.762836 cos_to_last_merge=0.8940 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.894
[S4] round=62 local utility u=0.001185 metrics={'f1_val': 0.9425729574146486, 'auprc': 0.9514315254942668, 'loss_val': 0.28847523524838065, 'psi': 0.9461163846464958}-{'f1_val': 0.9424287127349863, 'auprc': 0.9505513270377599, 'loss_val': 0.28733945360395224, 'psi': 0.9456777584560957}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=62 head_norm_before_train=1.700179 cos_to_last_merge=0.7993 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.799
[S5] round=62 local utility u=0.002656 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9984410179549097, 'loss_val': 0.03615934461689203, 'psi': 0.9971766943600979}-{'f1_val': 0.9963338119635569, 'auprc': 0.9969831196980571, 'loss_val': 0.037097473457108225, 'psi': 0.9965935350573569}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=62 head_norm_before_train=1.861141 cos_to_last_merge=0.9023 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=62 local utility u=0.000000 metrics={'f1_val': 0.7215823533525233, 'auprc': 0.8353041928259697, 'loss_val': 0.7687636431149464, 'psi': 0.7670710891419019}-{'f1_val': 0.7886499957090292, 'auprc': 0.9185372344228615, 'loss_val': 0.5480784571527428, 'psi': 0.840604891194562}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=62 head_norm_before_train=1.780620 cos_to_last_merge=0.7716 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=62 local utility u=0.000000 metrics={'f1_val': 0.6033433565672366, 'auprc': 0.7956370352606971, 'loss_val': 0.827576721001461, 'psi': 0.6802608280446207}-{'f1_val': 0.7199178992149028, 'auprc': 0.8740121282011034, 'loss_val': 0.22319954143142015, 'psi': 0.781555590809383}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=62 head_norm_before_train=2.142756 (no previous merge yet)
[S8] round=62 local utility u=0.565090 metrics={'f1_val': 0.9874934518419147, 'auprc': 0.9986650357024536, 'loss_val': 0.03837510516169925, 'psi': 0.9919620853861302}-{'f1_val': 0.8300055601765143, 'auprc': 0.9852559905710206, 'loss_val': 0.18340004861421133, 'psi': 0.8921057323343168}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] sending update (kind=head size=1792 to 1 peers)
[S9] START round=62 head_norm_before_train=2.180092 cos_to_last_merge=0.9326 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.933
[S9] round=62 local utility u=0.003286 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998096161808549, 'loss_val': 0.01803180031514963, 'psi': 0.9972347718117545}-{'f1_val': 0.9966605118138915, 'auprc': 0.9964129259124725, 'loss_val': 0.019554633551142234, 'psi': 0.9965614774533239}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=62 head_norm_before_train=1.921515 cos_to_last_merge=0.9219 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.922
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9942761923186401, 'loss_val': 0.031322899591264254, 'psi': 0.9937198353383978}-{'f1_val': 0.9931299445855843, 'auprc': 0.9956874793054524, 'loss_val': 0.03311527437023453, 'psi': 0.9941529584735316}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=62 head_norm_before_train=2.269776 cos_to_last_merge=0.9379 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.938
[S11] round=62 local utility u=0.010302 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9948680311631117, 'loss_val': 0.019970650531677566, 'psi': 0.9958754151733984}-{'f1_val': 0.9961541414107454, 'auprc': 0.9926717204964832, 'loss_val': 0.03162904416243723, 'psi': 0.9947611730450405}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=62 head_norm_before_train=1.896514 (no previous merge yet)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.7450331225395694, 'auprc': 0.8375866295023282, 'loss_val': 1.0144222202677913, 'psi': 0.7820545253246729}-{'f1_val': 0.7729385342380732, 'auprc': 0.7915410919382107, 'loss_val': 0.6551244319997457, 'psi': 0.7803795573181282}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=62 head_norm_before_train=2.183323 cos_to_last_merge=0.9654 (last merge round=15)
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9981094193364057, 'loss_val': 0.021196548290942228, 'psi': 0.9978360734241358}-{'f1_val': 0.9976538428159559, 'auprc': 0.9988547215296281, 'loss_val': 0.01994736832899608, 'psi': 0.9981341943014248}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=2.297627 (no previous merge yet)
[S15] round=62 local utility u=0.001436 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980652675494341, 'loss_val': 0.018821729884184447, 'psi': 0.997274108052286}-{'f1_val': 0.9967466683875206, 'auprc': 0.9978706969087019, 'loss_val': 0.021110604271079584, 'psi': 0.9971962797959931}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=62 head_norm_before_train=2.013684 cos_to_last_merge=0.7787 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.779
[S16] round=62 local utility u=0.000000 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9983943230722239, 'loss_val': 0.03369285618094831, 'psi': 0.9943048940307074}-{'f1_val': 0.9915786080030298, 'auprc': 0.9987183313477566, 'loss_val': 0.03392896618992057, 'psi': 0.9944344973409205}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=62 head_norm_before_train=1.796889 cos_to_last_merge=0.8660 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=62 local utility u=0.672410 metrics={'f1_val': 0.8937630545747028, 'auprc': 0.9927712905826338, 'loss_val': 0.2977299495050816, 'psi': 0.9333663489778752}-{'f1_val': 0.7247149570289491, 'auprc': 0.9930702742980311, 'loss_val': 0.6291577284408449, 'psi': 0.832057083936582}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=63 head_norm_before_train=1.975023 cos_to_last_merge=0.7655 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=63 local utility u=0.000000 metrics={'f1_val': 0.6609553348691509, 'auprc': 0.7471282913570745, 'loss_val': 1.1306757682173285, 'psi': 0.6954245174643203}-{'f1_val': 0.7016343122045032, 'auprc': 0.7435458059914972, 'loss_val': 1.0278433258219992, 'psi': 0.7183989097193009}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=63 head_norm_before_train=2.442021 (no previous merge yet)
[S3] round=63 local utility u=0.000000 metrics={'f1_val': 0.7128563531778559, 'auprc': 0.9749540771423709, 'loss_val': 0.9429808564545059, 'psi': 0.8176954427636619}-{'f1_val': 0.7832491779437751, 'auprc': 0.9921568798508588, 'loss_val': 0.7042084135573005, 'psi': 0.8668122587066086}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=63 head_norm_before_train=1.769638 cos_to_last_merge=0.8930 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.893
[S4] round=63 local utility u=0.024795 metrics={'f1_val': 0.9426009395877337, 'auprc': 0.967748148529944, 'loss_val': 0.2880029045923107, 'psi': 0.9526598231646177}-{'f1_val': 0.9425729574146486, 'auprc': 0.9514315254942668, 'loss_val': 0.28847523524838065, 'psi': 0.9461163846464958}
[S4] not sending this round → trigger blocked (psi=0.953)
[S5] START round=63 head_norm_before_train=1.713722 cos_to_last_merge=0.7968 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.797
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9979294661621485, 'loss_val': 0.03792975365072786, 'psi': 0.9969720736429935}-{'f1_val': 0.9963338119635569, 'auprc': 0.9984410179549097, 'loss_val': 0.03615934461689203, 'psi': 0.9971766943600979}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.872352 cos_to_last_merge=0.9002 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.900
[S6] round=63 local utility u=0.000000 metrics={'f1_val': 0.657620968261685, 'auprc': 0.7809506057841068, 'loss_val': 0.9645793909164956, 'psi': 0.7069528232706538}-{'f1_val': 0.7215823533525233, 'auprc': 0.8353041928259697, 'loss_val': 0.7687636431149464, 'psi': 0.7670710891419019}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=63 head_norm_before_train=1.786471 cos_to_last_merge=0.7715 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.771
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5790693008991383, 'auprc': 0.7913286185252641, 'loss_val': 0.867955520343634, 'psi': 0.6639730279495887}-{'f1_val': 0.6033433565672366, 'auprc': 0.7956370352606971, 'loss_val': 0.827576721001461, 'psi': 0.6802608280446207}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=2.148380 (no previous merge yet)
[S8] round=63 local utility u=0.018660 metrics={'f1_val': 0.9920877483955324, 'auprc': 0.9984147470953026, 'loss_val': 0.027870657727382772, 'psi': 0.9946185478754406}-{'f1_val': 0.9874934518419147, 'auprc': 0.9986650357024536, 'loss_val': 0.03837510516169925, 'psi': 0.9919620853861302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=63 head_norm_before_train=2.187272 cos_to_last_merge=0.9322 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=63 local utility u=0.000017 metrics={'f1_val': 0.9962748907591257, 'auprc': 0.9987303928637442, 'loss_val': 0.01758677517696302, 'psi': 0.9972570916009731}-{'f1_val': 0.9966605118138915, 'auprc': 0.998096161808549, 'loss_val': 0.01803180031514963, 'psi': 0.9972347718117545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S9] sending update (kind=head size=1805 to 1 peers)
[S10] START round=63 head_norm_before_train=1.927216 cos_to_last_merge=0.9213 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=63 local utility u=0.001645 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9941928211248835, 'loss_val': 0.03041233602162343, 'psi': 0.9939494015947664}-{'f1_val': 0.9933489306849028, 'auprc': 0.9942761923186401, 'loss_val': 0.031322899591264254, 'psi': 0.9937198353383978}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=63 head_norm_before_train=2.276844 cos_to_last_merge=0.9372 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.937
[S11] round=63 local utility u=0.001840 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9960725520459085, 'loss_val': 0.019904596679990307, 'psi': 0.9963572235265171}-{'f1_val': 0.9965470045135896, 'auprc': 0.9948680311631117, 'loss_val': 0.019970650531677566, 'psi': 0.9958754151733984}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S11] sending update (kind=head size=1790 to 1 peers)
[S13] START round=63 head_norm_before_train=1.896245 (no previous merge yet)
[S13] round=63 local utility u=0.000000 metrics={'f1_val': 0.712207790230877, 'auprc': 0.8399670278902633, 'loss_val': 0.9143904655674269, 'psi': 0.7633114852946316}-{'f1_val': 0.7450331225395694, 'auprc': 0.8375866295023282, 'loss_val': 1.0144222202677913, 'psi': 0.7820545253246729}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=63 head_norm_before_train=2.188070 cos_to_last_merge=0.9651 (last merge round=15)
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9981882090950723, 'loss_val': 0.022394700545782922, 'psi': 0.9978675893276026}-{'f1_val': 0.9976538428159559, 'auprc': 0.9981094193364057, 'loss_val': 0.021196548290942228, 'psi': 0.9978360734241358}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=2.303763 (no previous merge yet)
[S15] round=63 local utility u=0.000139 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980760634579504, 'loss_val': 0.018576402690265167, 'psi': 0.9972784264156925}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980652675494341, 'loss_val': 0.018821729884184447, 'psi': 0.997274108052286}
[S15] not sending this round → trigger blocked (psi=0.997)
[S16] START round=63 head_norm_before_train=2.016593 cos_to_last_merge=0.7782 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.778
[S16] round=63 local utility u=0.000120 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9984905939448772, 'loss_val': 0.03374198433490744, 'psi': 0.9943434023797688}-{'f1_val': 0.9915786080030298, 'auprc': 0.9983943230722239, 'loss_val': 0.03369285618094831, 'psi': 0.9943048940307074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=63 head_norm_before_train=1.806397 cos_to_last_merge=0.8643 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.864
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.7481225260475752, 'auprc': 0.9516730535981155, 'loss_val': 0.6713506809500563, 'psi': 0.8295427370677912}-{'f1_val': 0.8937630545747028, 'auprc': 0.9927712905826338, 'loss_val': 0.2977299495050816, 'psi': 0.9333663489778752}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=64 head_norm_before_train=1.985225 cos_to_last_merge=0.7647 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.765
[S2] round=64 local utility u=0.117424 metrics={'f1_val': 0.6887020881574096, 'auprc': 0.7477028979591438, 'loss_val': 1.0640316155196083, 'psi': 0.7123024120781033}-{'f1_val': 0.6609553348691509, 'auprc': 0.7471282913570745, 'loss_val': 1.1306757682173285, 'psi': 0.6954245174643203}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] sending update (kind=head size=1805 to 1 peers)
[S3] START round=64 head_norm_before_train=2.447257 (no previous merge yet)
[S3] round=64 local utility u=0.857096 metrics={'f1_val': 0.8891783285766139, 'auprc': 0.9956333472967976, 'loss_val': 0.34875835796510424, 'psi': 0.9317603360646874}-{'f1_val': 0.7128563531778559, 'auprc': 0.9749540771423709, 'loss_val': 0.9429808564545059, 'psi': 0.8176954427636619}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=64 head_norm_before_train=1.776502 cos_to_last_merge=0.8919 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.892
[S4] round=64 local utility u=0.055631 metrics={'f1_val': 0.9543626542829304, 'auprc': 0.9749274805883283, 'loss_val': 0.26884838034601094, 'psi': 0.9625885848050896}-{'f1_val': 0.9426009395877337, 'auprc': 0.967748148529944, 'loss_val': 0.2880029045923107, 'psi': 0.9526598231646177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=64 head_norm_before_train=1.725098 cos_to_last_merge=0.7947 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.795
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9952325735827356, 'loss_val': 0.037749801331348073, 'psi': 0.9958933166112283}-{'f1_val': 0.9963338119635569, 'auprc': 0.9979294661621485, 'loss_val': 0.03792975365072786, 'psi': 0.9969720736429935}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.886312 cos_to_last_merge=0.8985 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=64 local utility u=0.265507 metrics={'f1_val': 0.7121963122459497, 'auprc': 0.7991116608877006, 'loss_val': 0.8155010575202996, 'psi': 0.7469624517026501}-{'f1_val': 0.657620968261685, 'auprc': 0.7809506057841068, 'loss_val': 0.9645793909164956, 'psi': 0.7069528232706538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=64 head_norm_before_train=1.788506 cos_to_last_merge=0.7719 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=64 local utility u=0.082104 metrics={'f1_val': 0.59117690026529, 'auprc': 0.7948169588487248, 'loss_val': 0.7868573976242758, 'psi': 0.6726329236986639}-{'f1_val': 0.5790693008991383, 'auprc': 0.7913286185252641, 'loss_val': 0.867955520343634, 'psi': 0.6639730279495887}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=64 head_norm_before_train=2.153288 (no previous merge yet)
[S8] round=64 local utility u=0.001092 metrics={'f1_val': 0.9923077140383828, 'auprc': 0.9988607071191915, 'loss_val': 0.028344119244295453, 'psi': 0.9949289112707063}-{'f1_val': 0.9920877483955324, 'auprc': 0.9984147470953026, 'loss_val': 0.027870657727382772, 'psi': 0.9946185478754406}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=64 head_norm_before_train=2.193978 cos_to_last_merge=0.9317 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.932
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9880286744602689, 'auprc': 0.9986888726314919, 'loss_val': 0.047253564760249334, 'psi': 0.992292753728758}-{'f1_val': 0.9962748907591257, 'auprc': 0.9987303928637442, 'loss_val': 0.01758677517696302, 'psi': 0.9972570916009731}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.933660 cos_to_last_merge=0.9208 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.921
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943622718845727, 'loss_val': 0.0319813742293774, 'psi': 0.9937542671647708}-{'f1_val': 0.9937871219080217, 'auprc': 0.9941928211248835, 'loss_val': 0.03041233602162343, 'psi': 0.9939494015947664}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=64 head_norm_before_train=2.283762 cos_to_last_merge=0.9364 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=64 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9927546248495317, 'loss_val': 0.029225698685004294, 'psi': 0.9947943347862599}-{'f1_val': 0.9965470045135896, 'auprc': 0.9960725520459085, 'loss_val': 0.019904596679990307, 'psi': 0.9963572235265171}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=64 head_norm_before_train=1.897498 (no previous merge yet)
[S13] round=64 local utility u=0.230671 metrics={'f1_val': 0.7733163804461363, 'auprc': 0.774084798508523, 'loss_val': 0.6220530215354021, 'psi': 0.773623747671091}-{'f1_val': 0.712207790230877, 'auprc': 0.8399670278902633, 'loss_val': 0.9143904655674269, 'psi': 0.7633114852946316}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=64 head_norm_before_train=2.191217 cos_to_last_merge=0.9648 (last merge round=15)
[S14] round=64 local utility u=0.000000 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9983862728023363, 'loss_val': 0.023128599039312053, 'psi': 0.9979468148105081}-{'f1_val': 0.9976538428159559, 'auprc': 0.9981882090950723, 'loss_val': 0.022394700545782922, 'psi': 0.9978675893276026}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=64 head_norm_before_train=2.310038 (no previous merge yet)
[S15] round=64 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9980543818821532, 'loss_val': 0.018988128565039085, 'psi': 0.9972697537853736}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980760634579504, 'loss_val': 0.018576402690265167, 'psi': 0.9972784264156925}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=64 head_norm_before_train=2.020142 cos_to_last_merge=0.7776 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.778
[S16] round=64 local utility u=0.000242 metrics={'f1_val': 0.9915786080030298, 'auprc': 0.9987495893170913, 'loss_val': 0.03403408049969345, 'psi': 0.9944470005286544}-{'f1_val': 0.9915786080030298, 'auprc': 0.9984905939448772, 'loss_val': 0.03374198433490744, 'psi': 0.9943434023797688}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=64 head_norm_before_train=1.815830 cos_to_last_merge=0.8628 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.863
[S17] round=64 local utility u=0.000000 metrics={'f1_val': 0.7015336502358467, 'auprc': 0.9169071985607397, 'loss_val': 0.9246022156675722, 'psi': 0.7876830695658039}-{'f1_val': 0.7481225260475752, 'auprc': 0.9516730535981155, 'loss_val': 0.6713506809500563, 'psi': 0.8295427370677912}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=65 head_norm_before_train=1.994449 cos_to_last_merge=0.7640 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.764
[S2] round=65 local utility u=0.030662 metrics={'f1_val': 0.6958067291579392, 'auprc': 0.7484728403382601, 'loss_val': 1.0476453634827307, 'psi': 0.7168731736300675}-{'f1_val': 0.6887020881574096, 'auprc': 0.7477028979591438, 'loss_val': 1.0640316155196083, 'psi': 0.7123024120781033}
[S2] not sending this round → trigger blocked (psi=0.717)
[S3] START round=65 head_norm_before_train=2.453731 (no previous merge yet)
[S3] round=65 local utility u=0.308916 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9988845327584809, 'loss_val': 0.16887359556922882, 'psi': 0.9758801368428607}-{'f1_val': 0.8891783285766139, 'auprc': 0.9956333472967976, 'loss_val': 0.34875835796510424, 'psi': 0.9317603360646874}
[S3] not sending this round → trigger blocked (psi=0.976)
[S4] START round=65 head_norm_before_train=1.779774 cos_to_last_merge=0.8914 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=65 local utility u=0.000000 metrics={'f1_val': 0.9548781355610467, 'auprc': 0.9601158550177059, 'loss_val': 0.2791339376207506, 'psi': 0.9569732233437105}-{'f1_val': 0.9543626542829304, 'auprc': 0.9749274805883283, 'loss_val': 0.26884838034601094, 'psi': 0.9625885848050896}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=65 head_norm_before_train=1.736318 cos_to_last_merge=0.7923 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.792
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934885509403377, 'loss_val': 0.03358025198570792, 'psi': 0.9951957075542692}-{'f1_val': 0.9963338119635569, 'auprc': 0.9952325735827356, 'loss_val': 0.037749801331348073, 'psi': 0.9958933166112283}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.895146 cos_to_last_merge=0.8975 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=65 local utility u=0.000000 metrics={'f1_val': 0.6184537191058553, 'auprc': 0.890995974540591, 'loss_val': 0.9923669314342285, 'psi': 0.7274706212797496}-{'f1_val': 0.7121963122459497, 'auprc': 0.7991116608877006, 'loss_val': 0.8155010575202996, 'psi': 0.7469624517026501}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=65 head_norm_before_train=1.790661 cos_to_last_merge=0.7723 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=65 local utility u=0.000000 metrics={'f1_val': 0.5720645495695147, 'auprc': 0.7917237136438319, 'loss_val': 0.9808041778402757, 'psi': 0.6599282151992416}-{'f1_val': 0.59117690026529, 'auprc': 0.7948169588487248, 'loss_val': 0.7868573976242758, 'psi': 0.6726329236986639}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=65 head_norm_before_train=2.159051 (no previous merge yet)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.9893475795202267, 'auprc': 0.9990328714771837, 'loss_val': 0.03409872960130209, 'psi': 0.9932216963030095}-{'f1_val': 0.9923077140383828, 'auprc': 0.9988607071191915, 'loss_val': 0.028344119244295453, 'psi': 0.9949289112707063}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=65 head_norm_before_train=2.197510 cos_to_last_merge=0.9311 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=65 local utility u=0.034412 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9946541846845748, 'loss_val': 0.018307929746701698, 'psi': 0.9958771686326873}-{'f1_val': 0.9880286744602689, 'auprc': 0.9986888726314919, 'loss_val': 0.047253564760249334, 'psi': 0.992292753728758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=65 head_norm_before_train=1.940472 cos_to_last_merge=0.9202 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=65 local utility u=0.000000 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9944872121732405, 'loss_val': 0.033354353410936455, 'psi': 0.9936728516206469}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943622718845727, 'loss_val': 0.0319813742293774, 'psi': 0.9937542671647708}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=65 head_norm_before_train=2.289257 cos_to_last_merge=0.9358 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.9105636756904243, 'auprc': 0.9924631287086342, 'loss_val': 0.11441717598055633, 'psi': 0.9433234568977082}-{'f1_val': 0.9961541414107454, 'auprc': 0.9927546248495317, 'loss_val': 0.029225698685004294, 'psi': 0.9947943347862599}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=65 head_norm_before_train=1.898568 (no previous merge yet)
[S13] round=65 local utility u=0.000000 metrics={'f1_val': 0.7287000123834828, 'auprc': 0.8282118595962963, 'loss_val': 0.9082127563607135, 'psi': 0.7685047512686082}-{'f1_val': 0.7733163804461363, 'auprc': 0.774084798508523, 'loss_val': 0.6220530215354021, 'psi': 0.773623747671091}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=65 head_norm_before_train=2.192798 cos_to_last_merge=0.9645 (last merge round=15)
[S14] round=65 local utility u=0.000032 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9981842104505019, 'loss_val': 0.02245930498846098, 'psi': 0.9978659898697744}-{'f1_val': 0.9976538428159559, 'auprc': 0.9983862728023363, 'loss_val': 0.023128599039312053, 'psi': 0.9979468148105081}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=65 head_norm_before_train=2.316150 (no previous merge yet)
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9979050287447305, 'loss_val': 0.02140739244901262, 'psi': 0.9972100125304045}-{'f1_val': 0.9967466683875206, 'auprc': 0.9980543818821532, 'loss_val': 0.018988128565039085, 'psi': 0.9972697537853736}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.025608 cos_to_last_merge=0.7771 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.777
[S16] round=65 local utility u=0.000000 metrics={'f1_val': 0.9422422858631578, 'auprc': 0.9881698979002529, 'loss_val': 0.2367738480172261, 'psi': 0.9606133306779958}-{'f1_val': 0.9915786080030298, 'auprc': 0.9987495893170913, 'loss_val': 0.03403408049969345, 'psi': 0.9944470005286544}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=65 head_norm_before_train=1.821606 cos_to_last_merge=0.8616 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.862
[S17] round=65 local utility u=0.720205 metrics={'f1_val': 0.847045417546771, 'auprc': 0.9680223519568537, 'loss_val': 0.5106081611049103, 'psi': 0.8954361913108041}-{'f1_val': 0.7015336502358467, 'auprc': 0.9169071985607397, 'loss_val': 0.9246022156675722, 'psi': 0.7876830695658039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=66 head_norm_before_train=2.003804 cos_to_last_merge=0.7632 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=66 local utility u=0.059811 metrics={'f1_val': 0.7155271177999323, 'auprc': 0.7417344983525793, 'loss_val': 1.0261310974904063, 'psi': 0.726010070020991}-{'f1_val': 0.6958067291579392, 'auprc': 0.7484728403382601, 'loss_val': 1.0476453634827307, 'psi': 0.7168731736300675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] sending update (kind=head size=1802 to 1 peers)
[S3] START round=66 head_norm_before_train=2.460533 (no previous merge yet)
[S3] round=66 local utility u=0.045004 metrics={'f1_val': 0.9640887450481161, 'auprc': 0.9985413473800354, 'loss_val': 0.09910561304965027, 'psi': 0.9778697859808838}-{'f1_val': 0.9605438728991138, 'auprc': 0.9988845327584809, 'loss_val': 0.16887359556922882, 'psi': 0.9758801368428607}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=66 head_norm_before_train=1.782639 cos_to_last_merge=0.8908 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.891
[S4] round=66 local utility u=0.000000 metrics={'f1_val': 0.9526777639590281, 'auprc': 0.9638628010018686, 'loss_val': 0.2783782125024854, 'psi': 0.9571517787761643}-{'f1_val': 0.9548781355610467, 'auprc': 0.9601158550177059, 'loss_val': 0.2791339376207506, 'psi': 0.9569732233437105}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=66 head_norm_before_train=1.745254 cos_to_last_merge=0.7904 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.790
[S5] round=66 local utility u=0.007307 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9964873860559461, 'loss_val': 0.030171944378049563, 'psi': 0.996616135509453}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934885509403377, 'loss_val': 0.03358025198570792, 'psi': 0.9951957075542692}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=66 head_norm_before_train=1.905789 cos_to_last_merge=0.8957 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=66 local utility u=1.000000 metrics={'f1_val': 0.8475279712465756, 'auprc': 0.9505389905108348, 'loss_val': 0.3119467988572747, 'psi': 0.8887323789522792}-{'f1_val': 0.6184537191058553, 'auprc': 0.890995974540591, 'loss_val': 0.9923669314342285, 'psi': 0.7274706212797496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=66 head_norm_before_train=1.793267 cos_to_last_merge=0.7730 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.773
[S7] round=66 local utility u=0.386310 metrics={'f1_val': 0.6223303450036043, 'auprc': 0.8011354709598758, 'loss_val': 0.5380133231787224, 'psi': 0.6938523953861129}-{'f1_val': 0.5720645495695147, 'auprc': 0.7917237136438319, 'loss_val': 0.9808041778402757, 'psi': 0.6599282151992416}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=66 head_norm_before_train=2.161169 (no previous merge yet)
[S8] round=66 local utility u=0.009734 metrics={'f1_val': 0.9924509553239076, 'auprc': 0.9971769355247402, 'loss_val': 0.027683206977741015, 'psi': 0.9943413474042406}-{'f1_val': 0.9893475795202267, 'auprc': 0.9990328714771837, 'loss_val': 0.03409872960130209, 'psi': 0.9932216963030095}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=66 head_norm_before_train=2.202576 cos_to_last_merge=0.9307 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.931
[S9] round=66 local utility u=0.000000 metrics={'f1_val': 0.9820167660891372, 'auprc': 0.9860574011584669, 'loss_val': 0.06493758981513156, 'psi': 0.983633020116869}-{'f1_val': 0.9966924912647621, 'auprc': 0.9946541846845748, 'loss_val': 0.018307929746701698, 'psi': 0.9958771686326873}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=66 head_norm_before_train=1.947384 cos_to_last_merge=0.9197 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.920
[S10] round=66 local utility u=0.000265 metrics={'f1_val': 0.9931299445855843, 'auprc': 0.9944129865662177, 'loss_val': 0.0326018493672936, 'psi': 0.9936431613778377}-{'f1_val': 0.9931299445855843, 'auprc': 0.9944872121732405, 'loss_val': 0.033354353410936455, 'psi': 0.9936728516206469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] START round=66 head_norm_before_train=2.293206 cos_to_last_merge=0.9356 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.936
[S11] round=66 local utility u=0.299428 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9925873265684126, 'loss_val': 0.030925986080244775, 'psi': 0.9948724429458315}-{'f1_val': 0.9105636756904243, 'auprc': 0.9924631287086342, 'loss_val': 0.11441717598055633, 'psi': 0.9433234568977082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=66 head_norm_before_train=1.901150 (no previous merge yet)
[S13] round=66 local utility u=0.000000 metrics={'f1_val': 0.6068557287540343, 'auprc': 0.7041333097491431, 'loss_val': 1.1701383367460696, 'psi': 0.6457667611520779}-{'f1_val': 0.7287000123834828, 'auprc': 0.8282118595962963, 'loss_val': 0.9082127563607135, 'psi': 0.7685047512686082}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=66 head_norm_before_train=2.198253 cos_to_last_merge=0.9641 (last merge round=15)
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9971588917824483, 'loss_val': 0.02298154521273088, 'psi': 0.9975552674933104}-{'f1_val': 0.9976538428159559, 'auprc': 0.9981842104505019, 'loss_val': 0.02245930498846098, 'psi': 0.9978659898697744}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=2.322034 (no previous merge yet)
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9974437412895625, 'loss_val': 0.057002231871497354, 'psi': 0.9790980950877216}-{'f1_val': 0.9967466683875206, 'auprc': 0.9979050287447305, 'loss_val': 0.02140739244901262, 'psi': 0.9972100125304045}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=2.027362 cos_to_last_merge=0.7767 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.777
[S16] round=66 local utility u=0.260815 metrics={'f1_val': 0.9919999988114725, 'auprc': 0.9945995516653496, 'loss_val': 0.03297980636712423, 'psi': 0.9930398199530234}-{'f1_val': 0.9422422858631578, 'auprc': 0.9881698979002529, 'loss_val': 0.2367738480172261, 'psi': 0.9606133306779958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=66 head_norm_before_train=1.826985 cos_to_last_merge=0.8605 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.861
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.7449158942067308, 'auprc': 0.9371323574204213, 'loss_val': 0.7700690460893798, 'psi': 0.821802479492207}-{'f1_val': 0.847045417546771, 'auprc': 0.9680223519568537, 'loss_val': 0.5106081611049103, 'psi': 0.8954361913108041}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=67 head_norm_before_train=2.009660 cos_to_last_merge=0.7627 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.763
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7193391753264217, 'auprc': 0.7378644878810067, 'loss_val': 1.1072896944717276, 'psi': 0.7267493003482557}-{'f1_val': 0.7155271177999323, 'auprc': 0.7417344983525793, 'loss_val': 1.0261310974904063, 'psi': 0.726010070020991}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=67 head_norm_before_train=2.467167 (no previous merge yet)
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.742547866935312, 'auprc': 0.9911348119518263, 'loss_val': 0.8466539161912735, 'psi': 0.8419826449419178}-{'f1_val': 0.9640887450481161, 'auprc': 0.9985413473800354, 'loss_val': 0.09910561304965027, 'psi': 0.9778697859808838}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.787641 cos_to_last_merge=0.8902 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=67 local utility u=0.013456 metrics={'f1_val': 0.9575840620799391, 'auprc': 0.9635595979404186, 'loss_val': 0.279994394429561, 'psi': 0.9599742764241308}-{'f1_val': 0.9526777639590281, 'auprc': 0.9638628010018686, 'loss_val': 0.2783782125024854, 'psi': 0.9571517787761643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=67 head_norm_before_train=1.757707 cos_to_last_merge=0.7881 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.788
[S5] round=67 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9941331736633631, 'loss_val': 0.02975419276970247, 'psi': 0.9954535566434792}-{'f1_val': 0.9967019684784577, 'auprc': 0.9964873860559461, 'loss_val': 0.030171944378049563, 'psi': 0.996616135509453}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=67 head_norm_before_train=1.914661 cos_to_last_merge=0.8939 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.8432186165846007, 'auprc': 0.944356586028551, 'loss_val': 0.3767162782065255, 'psi': 0.8836738043621808}-{'f1_val': 0.8475279712465756, 'auprc': 0.9505389905108348, 'loss_val': 0.3119467988572747, 'psi': 0.8887323789522792}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.797968 cos_to_last_merge=0.7718 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.772
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.5692747512719606, 'auprc': 0.7946820573427191, 'loss_val': 1.063975042037431, 'psi': 0.6594376737002641}-{'f1_val': 0.6223303450036043, 'auprc': 0.8011354709598758, 'loss_val': 0.5380133231787224, 'psi': 0.6938523953861129}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=2.165593 (no previous merge yet)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9917345774119155, 'auprc': 0.9989309996900428, 'loss_val': 0.029984057812834728, 'psi': 0.9946131463231664}-{'f1_val': 0.9924509553239076, 'auprc': 0.9971769355247402, 'loss_val': 0.027683206977741015, 'psi': 0.9943413474042406}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=67 head_norm_before_train=2.204554 cos_to_last_merge=0.9302 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=67 local utility u=0.076197 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9936776693097742, 'loss_val': 0.02080356141137085, 'psi': 0.9952211245914763}-{'f1_val': 0.9820167660891372, 'auprc': 0.9860574011584669, 'loss_val': 0.06493758981513156, 'psi': 0.983633020116869}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=67 head_norm_before_train=1.953301 cos_to_last_merge=0.9192 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=67 local utility u=0.001379 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9942059883040348, 'loss_val': 0.03053668694544938, 'psi': 0.9936917537325557}-{'f1_val': 0.9931299445855843, 'auprc': 0.9944129865662177, 'loss_val': 0.0326018493672936, 'psi': 0.9936431613778377}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=67 head_norm_before_train=2.298399 cos_to_last_merge=0.9351 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=67 local utility u=0.006039 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9929133583843242, 'loss_val': 0.019826658476418294, 'psi': 0.9950028556721962}-{'f1_val': 0.9963958538641108, 'auprc': 0.9925873265684126, 'loss_val': 0.030925986080244775, 'psi': 0.9948724429458315}
[S11] not sending this round → trigger blocked (psi=0.995)
[S13] START round=67 head_norm_before_train=1.904325 (no previous merge yet)
[S13] round=67 local utility u=0.550556 metrics={'f1_val': 0.6377630706264117, 'auprc': 0.879636715815844, 'loss_val': 0.7809804805974534, 'psi': 0.7345125287021846}-{'f1_val': 0.6068557287540343, 'auprc': 0.7041333097491431, 'loss_val': 1.1701383367460696, 'psi': 0.6457667611520779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=67 head_norm_before_train=2.202384 cos_to_last_merge=0.9639 (last merge round=15)
[S14] round=67 local utility u=0.001804 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9975365528235385, 'loss_val': 0.02051981780444461, 'psi': 0.9977076767420708}-{'f1_val': 0.9978195179672185, 'auprc': 0.9971588917824483, 'loss_val': 0.02298154521273088, 'psi': 0.9975552674933104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=67 head_norm_before_train=2.327814 (no previous merge yet)
[S15] round=67 local utility u=0.000000 metrics={'f1_val': 0.9037402512786699, 'auprc': 0.997001382954736, 'loss_val': 0.21240237309357418, 'psi': 0.9410447039490963}-{'f1_val': 0.9668676642864944, 'auprc': 0.9974437412895625, 'loss_val': 0.057002231871497354, 'psi': 0.9790980950877216}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=67 head_norm_before_train=2.027604 cos_to_last_merge=0.7760 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.776
[S16] round=67 local utility u=0.006368 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.999059571019294, 'loss_val': 0.03329815328973695, 'psi': 0.994791344699522}-{'f1_val': 0.9919999988114725, 'auprc': 0.9945995516653496, 'loss_val': 0.03297980636712423, 'psi': 0.9930398199530234}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=67 head_norm_before_train=1.834787 cos_to_last_merge=0.8595 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.860
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.7026804789170709, 'auprc': 0.9108859941218126, 'loss_val': 0.9658991574679355, 'psi': 0.7859626849989676}-{'f1_val': 0.7449158942067308, 'auprc': 0.9371323574204213, 'loss_val': 0.7700690460893798, 'psi': 0.821802479492207}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=2.015019 cos_to_last_merge=0.7620 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.762
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7202688813198687, 'auprc': 0.7364880583444688, 'loss_val': 1.1160357254692834, 'psi': 0.7267565521297088}-{'f1_val': 0.7193391753264217, 'auprc': 0.7378644878810067, 'loss_val': 1.1072896944717276, 'psi': 0.7267493003482557}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=68 head_norm_before_train=2.472444 (no previous merge yet)
[S3] round=68 local utility u=0.169844 metrics={'f1_val': 0.7914178318113243, 'auprc': 0.971758222950065, 'loss_val': 0.742055077888121, 'psi': 0.8635539882668206}-{'f1_val': 0.742547866935312, 'auprc': 0.9911348119518263, 'loss_val': 0.8466539161912735, 'psi': 0.8419826449419178}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=68 head_norm_before_train=1.794271 cos_to_last_merge=0.8895 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.890
[S4] round=68 local utility u=0.000000 metrics={'f1_val': 0.9576587245775643, 'auprc': 0.9623883820113212, 'loss_val': 0.2827720632214776, 'psi': 0.959550587551067}-{'f1_val': 0.9575840620799391, 'auprc': 0.9635595979404186, 'loss_val': 0.279994394429561, 'psi': 0.9599742764241308}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=68 head_norm_before_train=1.774113 cos_to_last_merge=0.7853 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.785
[S5] round=68 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9917093642350534, 'loss_val': 0.02843022854872575, 'psi': 0.994220845830752}-{'f1_val': 0.9963338119635569, 'auprc': 0.9941331736633631, 'loss_val': 0.02975419276970247, 'psi': 0.9954535566434792}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=68 head_norm_before_train=1.922473 cos_to_last_merge=0.8917 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=68 local utility u=0.135969 metrics={'f1_val': 0.870851615040894, 'auprc': 0.9506384920272264, 'loss_val': 0.2894218725170499, 'psi': 0.902766365835427}-{'f1_val': 0.8432186165846007, 'auprc': 0.944356586028551, 'loss_val': 0.3767162782065255, 'psi': 0.8836738043621808}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S6] sending update (kind=head size=1805 to 1 peers)
[S7] START round=68 head_norm_before_train=1.805840 cos_to_last_merge=0.7707 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.771
[S7] round=68 local utility u=0.221111 metrics={'f1_val': 0.5981073275542405, 'auprc': 0.7964366951359281, 'loss_val': 0.8000127834666282, 'psi': 0.6774390745869154}-{'f1_val': 0.5692747512719606, 'auprc': 0.7946820573427191, 'loss_val': 1.063975042037431, 'psi': 0.6594376737002641}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=68 head_norm_before_train=2.170591 (no previous merge yet)
[S8] round=68 local utility u=0.001490 metrics={'f1_val': 0.991943296303656, 'auprc': 0.9989300031842444, 'loss_val': 0.02825383141743418, 'psi': 0.9947379790558915}-{'f1_val': 0.9917345774119155, 'auprc': 0.9989309996900428, 'loss_val': 0.029984057812834728, 'psi': 0.9946131463231664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=68 head_norm_before_train=2.205235 cos_to_last_merge=0.9300 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9882473538397808, 'auprc': 0.996664859094985, 'loss_val': 0.04728240195713184, 'psi': 0.9916143559418624}-{'f1_val': 0.9962500947792776, 'auprc': 0.9936776693097742, 'loss_val': 0.02080356141137085, 'psi': 0.9952211245914763}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=1.955998 cos_to_last_merge=0.9185 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.919
[S10] round=68 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943434389293113, 'loss_val': 0.031175960606505324, 'psi': 0.9937467339826662}-{'f1_val': 0.9933489306849028, 'auprc': 0.9942059883040348, 'loss_val': 0.03053668694544938, 'psi': 0.9936917537325557}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=68 head_norm_before_train=2.304159 cos_to_last_merge=0.9345 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.935
[S11] round=68 local utility u=0.000941 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9937035293239508, 'loss_val': 0.018865354097084924, 'psi': 0.9951738965760275}-{'f1_val': 0.9963958538641108, 'auprc': 0.9929133583843242, 'loss_val': 0.019826658476418294, 'psi': 0.9950028556721962}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=68 head_norm_before_train=1.906784 (no previous merge yet)
[S13] round=68 local utility u=0.093280 metrics={'f1_val': 0.7161172787239418, 'auprc': 0.8241817877192452, 'loss_val': 0.8981811287250627, 'psi': 0.7593430823220633}-{'f1_val': 0.6377630706264117, 'auprc': 0.879636715815844, 'loss_val': 0.7809804805974534, 'psi': 0.7345125287021846}
[S13] not sending this round → trigger blocked (psi=0.759)
[S14] START round=68 head_norm_before_train=2.208232 cos_to_last_merge=0.9637 (last merge round=15)
[S14] round=68 local utility u=0.001652 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9975364453940996, 'loss_val': 0.019682727393259533, 'psi': 0.9979543846339628}-{'f1_val': 0.9978217593544257, 'auprc': 0.9975365528235385, 'loss_val': 0.02051981780444461, 'psi': 0.9977076767420708}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=68 head_norm_before_train=2.333719 (no previous merge yet)
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.8903078354730138, 'auprc': 0.9965925857309925, 'loss_val': 0.27762753628174847, 'psi': 0.9328217355762053}-{'f1_val': 0.9037402512786699, 'auprc': 0.997001382954736, 'loss_val': 0.21240237309357418, 'psi': 0.9410447039490963}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.031102 cos_to_last_merge=0.7755 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.992414673153375, 'auprc': 0.9952291214228625, 'loss_val': 0.03300179722370689, 'psi': 0.99354045246117}-{'f1_val': 0.9919458604863408, 'auprc': 0.999059571019294, 'loss_val': 0.03329815328973695, 'psi': 0.994791344699522}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=1.844807 cos_to_last_merge=0.8586 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.859
[S17] round=68 local utility u=0.790520 metrics={'f1_val': 0.851040402034495, 'auprc': 0.9733502970532928, 'loss_val': 0.46241092732731115, 'psi': 0.8999643600420142}-{'f1_val': 0.7026804789170709, 'auprc': 0.9108859941218126, 'loss_val': 0.9658991574679355, 'psi': 0.7859626849989676}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=69 head_norm_before_train=2.022827 cos_to_last_merge=0.7614 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=69 local utility u=0.000000 metrics={'f1_val': 0.7202688813198687, 'auprc': 0.735937579153188, 'loss_val': 1.1207232636757696, 'psi': 0.7265363604531965}-{'f1_val': 0.7202688813198687, 'auprc': 0.7364880583444688, 'loss_val': 1.1160357254692834, 'psi': 0.7267565521297088}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=69 head_norm_before_train=2.477210 (no previous merge yet)
[S3] round=69 local utility u=0.800598 metrics={'f1_val': 0.9440545972496298, 'auprc': 0.9983371141476436, 'loss_val': 0.13641714796911672, 'psi': 0.9657676040088354}-{'f1_val': 0.7914178318113243, 'auprc': 0.971758222950065, 'loss_val': 0.742055077888121, 'psi': 0.8635539882668206}
[S3] not sending this round → trigger blocked (psi=0.966)
[S4] START round=69 head_norm_before_train=1.801231 cos_to_last_merge=0.8888 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.889
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.95533396250463, 'auprc': 0.9613374394129974, 'loss_val': 0.2792484426125229, 'psi': 0.957735353267977}-{'f1_val': 0.9576587245775643, 'auprc': 0.9623883820113212, 'loss_val': 0.2827720632214776, 'psi': 0.959550587551067}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=1.793302 cos_to_last_merge=0.7824 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.782
[S5] round=69 local utility u=0.002182 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9919992342355042, 'loss_val': 0.027566792198197902, 'psi': 0.9945999808723358}-{'f1_val': 0.995895166894551, 'auprc': 0.9917093642350534, 'loss_val': 0.02843022854872575, 'psi': 0.994220845830752}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=69 head_norm_before_train=1.928339 cos_to_last_merge=0.8899 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=69 local utility u=0.058030 metrics={'f1_val': 0.8824368586762064, 'auprc': 0.9476080244669601, 'loss_val': 0.2337820867502105, 'psi': 0.9085053249925079}-{'f1_val': 0.870851615040894, 'auprc': 0.9506384920272264, 'loss_val': 0.2894218725170499, 'psi': 0.902766365835427}
[S6] not sending this round → trigger blocked (psi=0.909)
[S7] START round=69 head_norm_before_train=1.807861 cos_to_last_merge=0.7705 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.771
[S7] round=69 local utility u=0.096534 metrics={'f1_val': 0.6095383205016054, 'auprc': 0.797072970851726, 'loss_val': 0.6774396994919263, 'psi': 0.6845521806416537}-{'f1_val': 0.5981073275542405, 'auprc': 0.7964366951359281, 'loss_val': 0.8000127834666282, 'psi': 0.6774390745869154}
[S7] not sending this round → trigger blocked (psi=0.685)
[S8] START round=69 head_norm_before_train=2.176044 (no previous merge yet)
[S8] round=69 local utility u=0.003743 metrics={'f1_val': 0.992959481021298, 'auprc': 0.9988464968330812, 'loss_val': 0.026614994320104505, 'psi': 0.9953142873460114}-{'f1_val': 0.991943296303656, 'auprc': 0.9989300031842444, 'loss_val': 0.02825383141743418, 'psi': 0.9947379790558915}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=69 head_norm_before_train=2.209391 cos_to_last_merge=0.9298 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.930
[S9] round=69 local utility u=0.039016 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9965111533202519, 'loss_val': 0.019267768983507638, 'psi': 0.9966007684164356}-{'f1_val': 0.9882473538397808, 'auprc': 0.996664859094985, 'loss_val': 0.04728240195713184, 'psi': 0.9916143559418624}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=69 head_norm_before_train=1.960675 cos_to_last_merge=0.9179 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.918
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9944228991736772, 'loss_val': 0.03143387590625449, 'psi': 0.9937785180804126}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943434389293113, 'loss_val': 0.031175960606505324, 'psi': 0.9937467339826662}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=69 head_norm_before_train=2.310091 cos_to_last_merge=0.9339 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.934
[S11] round=69 local utility u=0.001990 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9941952869172442, 'loss_val': 0.018841423876804434, 'psi': 0.995618597150626}-{'f1_val': 0.9961541414107454, 'auprc': 0.9937035293239508, 'loss_val': 0.018865354097084924, 'psi': 0.9951738965760275}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=69 head_norm_before_train=1.908201 (no previous merge yet)
[S13] round=69 local utility u=0.318677 metrics={'f1_val': 0.7608434541794596, 'auprc': 0.8430908146263696, 'loss_val': 0.5859109321651251, 'psi': 0.7937423983582237}-{'f1_val': 0.7161172787239418, 'auprc': 0.8241817877192452, 'loss_val': 0.8981811287250627, 'psi': 0.7593430823220633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] sending update (kind=head size=1796 to 1 peers)
[S14] START round=69 head_norm_before_train=2.215499 cos_to_last_merge=0.9634 (last merge round=15)
[S14] round=69 local utility u=0.000000 metrics={'f1_val': 0.9898662871727976, 'auprc': 0.9971603650500217, 'loss_val': 0.03156792525149334, 'psi': 0.9927839183236873}-{'f1_val': 0.9982330107938716, 'auprc': 0.9975364453940996, 'loss_val': 0.019682727393259533, 'psi': 0.9979543846339628}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=69 head_norm_before_train=2.339332 (no previous merge yet)
[S15] round=69 local utility u=0.051335 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9968543459106712, 'loss_val': 0.24261195072399716, 'psi': 0.9396132843653922}-{'f1_val': 0.8903078354730138, 'auprc': 0.9965925857309925, 'loss_val': 0.27762753628174847, 'psi': 0.9328217355762053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=69 head_norm_before_train=2.035209 cos_to_last_merge=0.7751 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.9923288096112961, 'auprc': 0.9881237506584819, 'loss_val': 0.04257105619399003, 'psi': 0.9906467860301704}-{'f1_val': 0.992414673153375, 'auprc': 0.9952291214228625, 'loss_val': 0.03300179722370689, 'psi': 0.99354045246117}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.854033 cos_to_last_merge=0.8574 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.7207484761575818, 'auprc': 0.9327025520298384, 'loss_val': 0.8290460267718596, 'psi': 0.8055301065064844}-{'f1_val': 0.851040402034495, 'auprc': 0.9733502970532928, 'loss_val': 0.46241092732731115, 'psi': 0.8999643600420142}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=70 head_norm_before_train=2.032050 cos_to_last_merge=0.7607 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.761
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7200446381060452, 'auprc': 0.7365782554265616, 'loss_val': 1.1263713649830782, 'psi': 0.7266580850342518}-{'f1_val': 0.7202688813198687, 'auprc': 0.735937579153188, 'loss_val': 1.1207232636757696, 'psi': 0.7265363604531965}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=70 head_norm_before_train=2.482384 (no previous merge yet)
[S3] round=70 local utility u=0.068747 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9994078924978089, 'loss_val': 0.10449878967223881, 'psi': 0.976432311339815}-{'f1_val': 0.9440545972496298, 'auprc': 0.9983371141476436, 'loss_val': 0.13641714796911672, 'psi': 0.9657676040088354}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=70 head_norm_before_train=1.804467 cos_to_last_merge=0.8883 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.888
[S4] round=70 local utility u=0.031029 metrics={'f1_val': 0.9557175906132241, 'auprc': 0.9790520915246217, 'loss_val': 0.2726355665013699, 'psi': 0.9650513909777831}-{'f1_val': 0.95533396250463, 'auprc': 0.9613374394129974, 'loss_val': 0.2792484426125229, 'psi': 0.957735353267977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S4] sending update (kind=head size=1801 to 1 peers)
[S5] START round=70 head_norm_before_train=1.804231 cos_to_last_merge=0.7809 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.781
[S5] round=70 local utility u=0.002112 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9932997874145704, 'loss_val': 0.02724485699830627, 'psi': 0.9951202021439622}-{'f1_val': 0.9963338119635569, 'auprc': 0.9919992342355042, 'loss_val': 0.027566792198197902, 'psi': 0.9945999808723358}
[S5] not sending this round → trigger blocked (psi=0.995)
[S6] START round=70 head_norm_before_train=1.936734 cos_to_last_merge=0.8884 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=70 local utility u=0.000000 metrics={'f1_val': 0.840818401776879, 'auprc': 0.9325276223899734, 'loss_val': 0.48464185428587747, 'psi': 0.8775020900221169}-{'f1_val': 0.8824368586762064, 'auprc': 0.9476080244669601, 'loss_val': 0.2337820867502105, 'psi': 0.9085053249925079}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=70 head_norm_before_train=1.813272 cos_to_last_merge=0.7701 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.770
[S7] round=70 local utility u=0.000000 metrics={'f1_val': 0.605866598578179, 'auprc': 0.7993672406323493, 'loss_val': 0.7301411668990933, 'psi': 0.6832668553998471}-{'f1_val': 0.6095383205016054, 'auprc': 0.797072970851726, 'loss_val': 0.6774396994919263, 'psi': 0.6845521806416537}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=70 head_norm_before_train=2.182105 (no previous merge yet)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.9925364588750162, 'auprc': 0.9979943597747092, 'loss_val': 0.042006764137176036, 'psi': 0.9947196192348934}-{'f1_val': 0.992959481021298, 'auprc': 0.9988464968330812, 'loss_val': 0.026614994320104505, 'psi': 0.9953142873460114}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=70 head_norm_before_train=2.214480 cos_to_last_merge=0.9295 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=70 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9950967899374756, 'loss_val': 0.018334626883922518, 'psi': 0.9960350230633251}-{'f1_val': 0.9966605118138915, 'auprc': 0.9965111533202519, 'loss_val': 0.019267768983507638, 'psi': 0.9966007684164356}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=70 head_norm_before_train=1.966270 cos_to_last_merge=0.9174 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=70 local utility u=0.000203 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9943595717192371, 'loss_val': 0.03083845923481938, 'psi': 0.9937531870986366}-{'f1_val': 0.9933489306849028, 'auprc': 0.9944228991736772, 'loss_val': 0.03143387590625449, 'psi': 0.9937785180804126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=70 head_norm_before_train=2.316027 cos_to_last_merge=0.9333 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=70 local utility u=0.001200 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9942865928319049, 'loss_val': 0.018165765216275224, 'psi': 0.9958001469885093}-{'f1_val': 0.996567470639547, 'auprc': 0.9941952869172442, 'loss_val': 0.018841423876804434, 'psi': 0.995618597150626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=70 head_norm_before_train=1.908986 (no previous merge yet)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.6752174154625056, 'auprc': 0.8368899647008579, 'loss_val': 0.8739771026988762, 'psi': 0.7398864351578465}-{'f1_val': 0.7608434541794596, 'auprc': 0.8430908146263696, 'loss_val': 0.5859109321651251, 'psi': 0.7937423983582237}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=70 head_norm_before_train=2.220835 cos_to_last_merge=0.9632 (last merge round=15)
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9418524567338815, 'auprc': 0.962971652571507, 'loss_val': 0.13421603152052697, 'psi': 0.9503001350689317}-{'f1_val': 0.9898662871727976, 'auprc': 0.9971603650500217, 'loss_val': 0.03156792525149334, 'psi': 0.9927839183236873}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=2.344697 (no previous merge yet)
[S15] round=70 local utility u=0.080508 metrics={'f1_val': 0.9143465110530302, 'auprc': 0.9971969813590815, 'loss_val': 0.15998815704287433, 'psi': 0.9474866991754507}-{'f1_val': 0.9014525766685394, 'auprc': 0.9968543459106712, 'loss_val': 0.24261195072399716, 'psi': 0.9396132843653922}
[S15] not sending this round → trigger blocked (psi=0.947)
[S16] START round=70 head_norm_before_train=2.037281 cos_to_last_merge=0.7747 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.775
[S16] round=70 local utility u=0.016449 metrics={'f1_val': 0.992414673153375, 'auprc': 0.9954186856874991, 'loss_val': 0.03207339594469015, 'psi': 0.9936162781670246}-{'f1_val': 0.9923288096112961, 'auprc': 0.9881237506584819, 'loss_val': 0.04257105619399003, 'psi': 0.9906467860301704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=70 head_norm_before_train=1.860655 cos_to_last_merge=0.8559 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.856
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.7194244244914504, 'auprc': 0.934309067378148, 'loss_val': 0.8396887018347718, 'psi': 0.8053782816461295}-{'f1_val': 0.7207484761575818, 'auprc': 0.9327025520298384, 'loss_val': 0.8290460267718596, 'psi': 0.8055301065064844}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=71 head_norm_before_train=2.041747 cos_to_last_merge=0.7600 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.760
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7187331754802878, 'auprc': 0.7375608722960265, 'loss_val': 1.1261084111877924, 'psi': 0.7262642542065834}-{'f1_val': 0.7200446381060452, 'auprc': 0.7365782554265616, 'loss_val': 1.1263713649830782, 'psi': 0.7266580850342518}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=71 head_norm_before_train=2.487695 (no previous merge yet)
[S3] round=71 local utility u=0.126546 metrics={'f1_val': 0.991984746081791, 'auprc': 0.998645313554714, 'loss_val': 0.03433611123287315, 'psi': 0.9946489730709602}-{'f1_val': 0.9611152572344858, 'auprc': 0.9994078924978089, 'loss_val': 0.10449878967223881, 'psi': 0.976432311339815}
[S3] not sending this round → trigger blocked (psi=0.995)
[S4] START round=71 head_norm_before_train=1.809354 cos_to_last_merge=0.8876 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.888
[S4] round=71 local utility u=0.000000 metrics={'f1_val': 0.9535614739502205, 'auprc': 0.9779097705136038, 'loss_val': 0.27851037207305807, 'psi': 0.9633007925755739}-{'f1_val': 0.9557175906132241, 'auprc': 0.9790520915246217, 'loss_val': 0.2726355665013699, 'psi': 0.9650513909777831}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=71 head_norm_before_train=1.813844 cos_to_last_merge=0.7796 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.780
[S5] round=71 local utility u=0.000462 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9922979899350362, 'loss_val': 0.02552442221401614, 'psi': 0.9949403770610891}-{'f1_val': 0.9963338119635569, 'auprc': 0.9932997874145704, 'loss_val': 0.02724485699830627, 'psi': 0.9951202021439622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S5] sending update (kind=head size=1804 to 1 peers)
[S6] START round=71 head_norm_before_train=1.948992 cos_to_last_merge=0.8871 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.6369049931765846, 'auprc': 0.7986838457509444, 'loss_val': 0.8401633660607813, 'psi': 0.7016165342063285}-{'f1_val': 0.840818401776879, 'auprc': 0.9325276223899734, 'loss_val': 0.48464185428587747, 'psi': 0.8775020900221169}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.819287 cos_to_last_merge=0.7694 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.603582198334089, 'auprc': 0.791849332922195, 'loss_val': 0.7438226232025108, 'psi': 0.6788890521693314}-{'f1_val': 0.605866598578179, 'auprc': 0.7993672406323493, 'loss_val': 0.7301411668990933, 'psi': 0.6832668553998471}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=2.188814 (no previous merge yet)
[S8] round=71 local utility u=0.000000 metrics={'f1_val': 0.7662708819371912, 'auprc': 0.9878818467054968, 'loss_val': 0.42582120921616906, 'psi': 0.8549152678445134}-{'f1_val': 0.9925364588750162, 'auprc': 0.9979943597747092, 'loss_val': 0.042006764137176036, 'psi': 0.9947196192348934}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=71 head_norm_before_train=2.221269 cos_to_last_merge=0.9291 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=71 local utility u=0.003737 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9983265810797979, 'loss_val': 0.019047526343208308, 'psi': 0.9971767438322516}-{'f1_val': 0.9966605118138915, 'auprc': 0.9950967899374756, 'loss_val': 0.018334626883922518, 'psi': 0.9960350230633251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=71 head_norm_before_train=1.971329 cos_to_last_merge=0.9169 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.917
[S10] round=71 local utility u=0.001790 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9941429905019215, 'loss_val': 0.02923694226008339, 'psi': 0.9939294693455816}-{'f1_val': 0.9933489306849028, 'auprc': 0.9943595717192371, 'loss_val': 0.03083845923481938, 'psi': 0.9937531870986366}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=71 head_norm_before_train=2.320331 cos_to_last_merge=0.9329 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.992503758636518, 'loss_val': 0.03269510704744754, 'psi': 0.9948390157730738}-{'f1_val': 0.9968091830929121, 'auprc': 0.9942865928319049, 'loss_val': 0.018165765216275224, 'psi': 0.9958001469885093}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=71 head_norm_before_train=1.914566 (no previous merge yet)
[S13] round=71 local utility u=0.238729 metrics={'f1_val': 0.7501580995543309, 'auprc': 0.847292745596281, 'loss_val': 0.8773709310426966, 'psi': 0.7890119579711109}-{'f1_val': 0.6752174154625056, 'auprc': 0.8368899647008579, 'loss_val': 0.8739771026988762, 'psi': 0.7398864351578465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S14] START round=71 head_norm_before_train=2.224476 cos_to_last_merge=0.9629 (last merge round=15)
[S14] round=71 local utility u=0.272333 metrics={'f1_val': 0.9969910436891155, 'auprc': 0.9971603750848003, 'loss_val': 0.02294733604245385, 'psi': 0.9970587762473895}-{'f1_val': 0.9418524567338815, 'auprc': 0.962971652571507, 'loss_val': 0.13421603152052697, 'psi': 0.9503001350689317}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=71 head_norm_before_train=2.350118 (no previous merge yet)
[S15] round=71 local utility u=0.089129 metrics={'f1_val': 0.9347401439121192, 'auprc': 0.9972960826088509, 'loss_val': 0.1043897912048211, 'psi': 0.9597625193908119}-{'f1_val': 0.9143465110530302, 'auprc': 0.9971969813590815, 'loss_val': 0.15998815704287433, 'psi': 0.9474866991754507}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=71 head_norm_before_train=2.040845 cos_to_last_merge=0.7742 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=71 local utility u=0.004141 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.9991275208754087, 'loss_val': 0.03210527512376869, 'psi': 0.9948185246419678}-{'f1_val': 0.992414673153375, 'auprc': 0.9954186856874991, 'loss_val': 0.03207339594469015, 'psi': 0.9936162781670246}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=71 head_norm_before_train=1.866851 cos_to_last_merge=0.8550 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.855
[S17] round=71 local utility u=0.874519 metrics={'f1_val': 0.8978417322051252, 'auprc': 0.9856876963155645, 'loss_val': 0.31529113175365564, 'psi': 0.9329801178493009}-{'f1_val': 0.7194244244914504, 'auprc': 0.934309067378148, 'loss_val': 0.8396887018347718, 'psi': 0.8053782816461295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=72 head_norm_before_train=2.050271 cos_to_last_merge=0.7593 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=72 local utility u=0.018949 metrics={'f1_val': 0.7062678160688396, 'auprc': 0.7465308872429546, 'loss_val': 1.0403286015003996, 'psi': 0.7223730445384856}-{'f1_val': 0.7187331754802878, 'auprc': 0.7375608722960265, 'loss_val': 1.1261084111877924, 'psi': 0.7262642542065834}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=72 head_norm_before_train=2.493541 (no previous merge yet)
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.8042309454175929, 'auprc': 0.9728979275946085, 'loss_val': 0.6530083449376465, 'psi': 0.8716977382883991}-{'f1_val': 0.991984746081791, 'auprc': 0.998645313554714, 'loss_val': 0.03433611123287315, 'psi': 0.9946489730709602}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=1.812315 cos_to_last_merge=0.8868 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.887
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.95533396250463, 'auprc': 0.9628473376437998, 'loss_val': 0.28267497451685436, 'psi': 0.9583393125602979}-{'f1_val': 0.9535614739502205, 'auprc': 0.9779097705136038, 'loss_val': 0.27851037207305807, 'psi': 0.9633007925755739}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=1.822911 cos_to_last_merge=0.7781 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.778
[S5] round=72 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9917927979549268, 'loss_val': 0.028635221174227503, 'psi': 0.9945174063601048}-{'f1_val': 0.9967019684784577, 'auprc': 0.9922979899350362, 'loss_val': 0.02552442221401614, 'psi': 0.9949403770610891}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=72 head_norm_before_train=1.957901 cos_to_last_merge=0.8861 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=72 local utility u=0.383710 metrics={'f1_val': 0.7226137582225327, 'auprc': 0.8814467006070525, 'loss_val': 0.8352843561880414, 'psi': 0.7861469351763406}-{'f1_val': 0.6369049931765846, 'auprc': 0.7986838457509444, 'loss_val': 0.8401633660607813, 'psi': 0.7016165342063285}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=72 head_norm_before_train=1.822477 cos_to_last_merge=0.7689 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=72 local utility u=0.000000 metrics={'f1_val': 0.5845067841590164, 'auprc': 0.7969797009482902, 'loss_val': 0.9317856063688744, 'psi': 0.6694959508747259}-{'f1_val': 0.603582198334089, 'auprc': 0.791849332922195, 'loss_val': 0.7438226232025108, 'psi': 0.6788890521693314}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=72 head_norm_before_train=2.194482 (no previous merge yet)
[S8] round=72 local utility u=0.819954 metrics={'f1_val': 0.974280047414472, 'auprc': 0.9983404024944755, 'loss_val': 0.06534434739574244, 'psi': 0.9839041894464734}-{'f1_val': 0.7662708819371912, 'auprc': 0.9878818467054968, 'loss_val': 0.42582120921616906, 'psi': 0.8549152678445134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=72 head_norm_before_train=2.222310 cos_to_last_merge=0.9287 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=72 local utility u=0.000763 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9987093787446821, 'loss_val': 0.018670799719972417, 'psi': 0.9973298628982054}-{'f1_val': 0.9964101856672208, 'auprc': 0.9983265810797979, 'loss_val': 0.019047526343208308, 'psi': 0.9971767438322516}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=72 head_norm_before_train=1.973441 cos_to_last_merge=0.9162 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=72 local utility u=0.000102 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9941173434826345, 'loss_val': 0.028955009205999273, 'psi': 0.9939192105378668}-{'f1_val': 0.9937871219080217, 'auprc': 0.9941429905019215, 'loss_val': 0.02923694226008339, 'psi': 0.9939294693455816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] START round=72 head_norm_before_train=2.324351 cos_to_last_merge=0.9326 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.933
[S11] round=72 local utility u=0.000000 metrics={'f1_val': 0.9505015387861602, 'auprc': 0.9922670101284711, 'loss_val': 0.08871514966477359, 'psi': 0.9672077273230846}-{'f1_val': 0.9963958538641108, 'auprc': 0.992503758636518, 'loss_val': 0.03269510704744754, 'psi': 0.9948390157730738}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=72 head_norm_before_train=1.922231 (no previous merge yet)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.6613293609377274, 'auprc': 0.7437843162435466, 'loss_val': 0.8035007579866591, 'psi': 0.6943113430600552}-{'f1_val': 0.7501580995543309, 'auprc': 0.847292745596281, 'loss_val': 0.8773709310426966, 'psi': 0.7890119579711109}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=72 head_norm_before_train=2.228164 cos_to_last_merge=0.9626 (last merge round=15)
[S14] round=72 local utility u=0.007447 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9992299989915314, 'loss_val': 0.01691766172227116, 'psi': 0.9981521816589685}-{'f1_val': 0.9969910436891155, 'auprc': 0.9971603750848003, 'loss_val': 0.02294733604245385, 'psi': 0.9970587762473895}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=72 head_norm_before_train=2.355383 (no previous merge yet)
[S15] round=72 local utility u=0.090743 metrics={'f1_val': 0.9595113032114848, 'auprc': 0.9973932783388616, 'loss_val': 0.07182242046338187, 'psi': 0.9746640932624355}-{'f1_val': 0.9347401439121192, 'auprc': 0.9972960826088509, 'loss_val': 0.1043897912048211, 'psi': 0.9597625193908119}
[S15] not sending this round → trigger blocked (psi=0.975)
[S16] START round=72 head_norm_before_train=2.044314 cos_to_last_merge=0.7737 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.774
[S16] round=72 local utility u=0.000000 metrics={'f1_val': 0.9932686743926713, 'auprc': 0.9901351966381315, 'loss_val': 0.03155812575982901, 'psi': 0.9920152832908554}-{'f1_val': 0.9919458604863408, 'auprc': 0.9991275208754087, 'loss_val': 0.03210527512376869, 'psi': 0.9948185246419678}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=72 head_norm_before_train=1.871857 cos_to_last_merge=0.8542 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.854
[S17] round=72 local utility u=0.000000 metrics={'f1_val': 0.7069307063859662, 'auprc': 0.9156276713228537, 'loss_val': 0.9671627554682495, 'psi': 0.7904094923607212}-{'f1_val': 0.8978417322051252, 'auprc': 0.9856876963155645, 'loss_val': 0.31529113175365564, 'psi': 0.9329801178493009}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=73 head_norm_before_train=2.055974 cos_to_last_merge=0.7589 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.759
[S2] round=73 local utility u=0.000000 metrics={'f1_val': 0.6932590207125368, 'auprc': 0.749974589663682, 'loss_val': 1.078038827477922, 'psi': 0.7159452482929949}-{'f1_val': 0.7062678160688396, 'auprc': 0.7465308872429546, 'loss_val': 1.0403286015003996, 'psi': 0.7223730445384856}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=73 head_norm_before_train=2.498421 (no previous merge yet)
[S3] round=73 local utility u=0.000000 metrics={'f1_val': 0.7802292352775931, 'auprc': 0.996251912932364, 'loss_val': 0.7950533048407064, 'psi': 0.8666383063395016}-{'f1_val': 0.8042309454175929, 'auprc': 0.9728979275946085, 'loss_val': 0.6530083449376465, 'psi': 0.8716977382883991}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=73 head_norm_before_train=1.814827 cos_to_last_merge=0.8863 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=73 local utility u=0.008859 metrics={'f1_val': 0.958456159626679, 'auprc': 0.965315530127139, 'loss_val': 0.29109405823869144, 'psi': 0.9611999078268629}-{'f1_val': 0.95533396250463, 'auprc': 0.9628473376437998, 'loss_val': 0.28267497451685436, 'psi': 0.9583393125602979}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=73 head_norm_before_train=1.834061 cos_to_last_merge=0.7762 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.776
[S5] round=73 local utility u=0.008426 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9966050921892424, 'loss_val': 0.026220867880743303, 'psi': 0.996442324053831}-{'f1_val': 0.9963338119635569, 'auprc': 0.9917927979549268, 'loss_val': 0.028635221174227503, 'psi': 0.9945174063601048}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=73 head_norm_before_train=1.965751 cos_to_last_merge=0.8850 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.7112098246846846, 'auprc': 0.7497818286361593, 'loss_val': 0.9350573222783257, 'psi': 0.7266386262652744}-{'f1_val': 0.7226137582225327, 'auprc': 0.8814467006070525, 'loss_val': 0.8352843561880414, 'psi': 0.7861469351763406}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.827051 cos_to_last_merge=0.7693 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=73 local utility u=1.000000 metrics={'f1_val': 0.9891666363426496, 'auprc': 0.9919308512556164, 'loss_val': 0.1416450517806797, 'psi': 0.9902723223078362}-{'f1_val': 0.5845067841590164, 'auprc': 0.7969797009482902, 'loss_val': 0.9317856063688744, 'psi': 0.6694959508747259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=73 head_norm_before_train=2.191279 (no previous merge yet)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.9823039529815467, 'loss_val': 0.7146258745948024, 'psi': 0.8214650444313162}-{'f1_val': 0.974280047414472, 'auprc': 0.9983404024944755, 'loss_val': 0.06534434739574244, 'psi': 0.9839041894464734}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=73 head_norm_before_train=2.224319 cos_to_last_merge=0.9286 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.929
[S9] round=73 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9966976737863823, 'loss_val': 0.019616600107339125, 'psi': 0.9965251809148854}-{'f1_val': 0.9964101856672208, 'auprc': 0.9987093787446821, 'loss_val': 0.018670799719972417, 'psi': 0.9973298628982054}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=73 head_norm_before_train=1.977512 cos_to_last_merge=0.9157 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.916
[S10] round=73 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9946568449260325, 'loss_val': 0.03153722077086524, 'psi': 0.9938720963813548}-{'f1_val': 0.9937871219080217, 'auprc': 0.9941173434826345, 'loss_val': 0.028955009205999273, 'psi': 0.9939192105378668}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=73 head_norm_before_train=2.329237 cos_to_last_merge=0.9322 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=73 local utility u=0.177502 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9951831008634298, 'loss_val': 0.018732867457471592, 'psi': 0.9960014430535257}-{'f1_val': 0.9505015387861602, 'auprc': 0.9922670101284711, 'loss_val': 0.08871514966477359, 'psi': 0.9672077273230846}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S11] sending update (kind=head size=1793 to 1 peers)
[S13] START round=73 head_norm_before_train=1.931537 (no previous merge yet)
[S13] round=73 local utility u=0.408292 metrics={'f1_val': 0.7528217992079278, 'auprc': 0.8412939451521129, 'loss_val': 0.828400846749954, 'psi': 0.7882106575856018}-{'f1_val': 0.6613293609377274, 'auprc': 0.7437843162435466, 'loss_val': 0.8035007579866591, 'psi': 0.6943113430600552}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] sending update (kind=head size=1800 to 1 peers)
[S14] START round=73 head_norm_before_train=2.231447 cos_to_last_merge=0.9624 (last merge round=15)
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9971595520898923, 'loss_val': 0.017457119256995054, 'psi': 0.9977025855774891}-{'f1_val': 0.9974336367705932, 'auprc': 0.9992299989915314, 'loss_val': 0.01691766172227116, 'psi': 0.9981521816589685}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=2.360546 (no previous merge yet)
[S15] round=73 local utility u=0.029169 metrics={'f1_val': 0.9668676642864944, 'auprc': 0.9974615677581099, 'loss_val': 0.05782762540877659, 'psi': 0.9791052256751406}-{'f1_val': 0.9595113032114848, 'auprc': 0.9973932783388616, 'loss_val': 0.07182242046338187, 'psi': 0.9746640932624355}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=73 head_norm_before_train=2.048609 cos_to_last_merge=0.7733 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=73 local utility u=0.003804 metrics={'f1_val': 0.9934883746349171, 'auprc': 0.9920293692185105, 'loss_val': 0.03095078041337408, 'psi': 0.9929047724683545}-{'f1_val': 0.9932686743926713, 'auprc': 0.9901351966381315, 'loss_val': 0.03155812575982901, 'psi': 0.9920152832908554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=73 head_norm_before_train=1.868369 cos_to_last_merge=0.8517 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.852
[S17] round=73 local utility u=0.955705 metrics={'f1_val': 0.8885493963632226, 'auprc': 0.9804829391363337, 'loss_val': 0.34003144250841205, 'psi': 0.925322813472467}-{'f1_val': 0.7069307063859662, 'auprc': 0.9156276713228537, 'loss_val': 0.9671627554682495, 'psi': 0.7904094923607212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=74 head_norm_before_train=2.062413 cos_to_last_merge=0.7584 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=74 local utility u=0.008051 metrics={'f1_val': 0.6978313873685928, 'auprc': 0.7483120769519539, 'loss_val': 1.0843832926391794, 'psi': 0.7180236632019372}-{'f1_val': 0.6932590207125368, 'auprc': 0.749974589663682, 'loss_val': 1.078038827477922, 'psi': 0.7159452482929949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=74 head_norm_before_train=2.502835 (no previous merge yet)
[S3] round=74 local utility u=0.071532 metrics={'f1_val': 0.7962937190171335, 'auprc': 0.987906221135878, 'loss_val': 0.7233381907044123, 'psi': 0.8729387198646312}-{'f1_val': 0.7802292352775931, 'auprc': 0.996251912932364, 'loss_val': 0.7950533048407064, 'psi': 0.8666383063395016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=74 head_norm_before_train=1.815963 cos_to_last_merge=0.8858 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.886
[S4] round=74 local utility u=0.004863 metrics={'f1_val': 0.9547850456169531, 'auprc': 0.9713528317909859, 'loss_val': 0.2774533826229284, 'psi': 0.9614121600865662}-{'f1_val': 0.958456159626679, 'auprc': 0.965315530127139, 'loss_val': 0.29109405823869144, 'psi': 0.9611999078268629}
[S4] not sending this round → trigger blocked (psi=0.961)
[S5] START round=74 head_norm_before_train=1.848529 cos_to_last_merge=0.7741 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.774
[S5] round=74 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9920614357819894, 'loss_val': 0.024427524551908286, 'psi': 0.9946248614909299}-{'f1_val': 0.9963338119635569, 'auprc': 0.9966050921892424, 'loss_val': 0.026220867880743303, 'psi': 0.996442324053831}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=74 head_norm_before_train=1.972058 cos_to_last_merge=0.8834 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=74 local utility u=0.817536 metrics={'f1_val': 0.8080932237151497, 'auprc': 0.9336630312033942, 'loss_val': 0.432929810998421, 'psi': 0.8583211467104475}-{'f1_val': 0.7112098246846846, 'auprc': 0.7497818286361593, 'loss_val': 0.9350573222783257, 'psi': 0.7266386262652744}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=74 head_norm_before_train=1.827927 cos_to_last_merge=0.7693 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=74 local utility u=0.000000 metrics={'f1_val': 0.8054436738974604, 'auprc': 0.9572202415507729, 'loss_val': 0.44929984775729837, 'psi': 0.8661543009587854}-{'f1_val': 0.9891666363426496, 'auprc': 0.9919308512556164, 'loss_val': 0.1416450517806797, 'psi': 0.9902723223078362}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=74 head_norm_before_train=2.188848 (no previous merge yet)
[S8] round=74 local utility u=1.000000 metrics={'f1_val': 0.9945713855819248, 'auprc': 0.9990795630724625, 'loss_val': 0.03704000442237705, 'psi': 0.9963746565781398}-{'f1_val': 0.7142391053978291, 'auprc': 0.9823039529815467, 'loss_val': 0.7146258745948024, 'psi': 0.8214650444313162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] sending update (kind=head size=1798 to 1 peers)
[S9] START round=74 head_norm_before_train=2.227237 cos_to_last_merge=0.9282 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=74 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984696567402889, 'loss_val': 0.020063852750293154, 'psi': 0.9967336980266244}-{'f1_val': 0.9964101856672208, 'auprc': 0.9966976737863823, 'loss_val': 0.019616600107339125, 'psi': 0.9965251809148854}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=74 head_norm_before_train=1.982758 cos_to_last_merge=0.9152 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=74 local utility u=0.000313 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9949898724758525, 'loss_val': 0.03190946253119993, 'psi': 0.9940053074012827}-{'f1_val': 0.9933489306849028, 'auprc': 0.9946568449260325, 'loss_val': 0.03153722077086524, 'psi': 0.9938720963813548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=74 head_norm_before_train=2.334099 cos_to_last_merge=0.9318 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=74 local utility u=0.001082 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9961512090369496, 'loss_val': 0.019473909927380042, 'psi': 0.9963886863229336}-{'f1_val': 0.9965470045135896, 'auprc': 0.9951831008634298, 'loss_val': 0.018732867457471592, 'psi': 0.9960014430535257}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=74 head_norm_before_train=1.941652 (no previous merge yet)
[S13] round=74 local utility u=0.090075 metrics={'f1_val': 0.7752184149947122, 'auprc': 0.8313150092314479, 'loss_val': 0.7526946873130497, 'psi': 0.7976570526894065}-{'f1_val': 0.7528217992079278, 'auprc': 0.8412939451521129, 'loss_val': 0.828400846749954, 'psi': 0.7882106575856018}
[S13] not sending this round → trigger blocked (psi=0.798)
[S14] START round=74 head_norm_before_train=2.231086 cos_to_last_merge=0.9623 (last merge round=15)
[S14] round=74 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.997160542631035, 'loss_val': 0.01860086947675908, 'psi': 0.997555927832745}-{'f1_val': 0.9980646079025537, 'auprc': 0.9971595520898923, 'loss_val': 0.017457119256995054, 'psi': 0.9977025855774891}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=74 head_norm_before_train=2.365494 (no previous merge yet)
[S15] round=74 local utility u=0.012659 metrics={'f1_val': 0.9700305310795656, 'auprc': 0.9974951745101136, 'loss_val': 0.05158685202627637, 'psi': 0.9810163884517848}-{'f1_val': 0.9668676642864944, 'auprc': 0.9974615677581099, 'loss_val': 0.05782762540877659, 'psi': 0.9791052256751406}
[S15] not sending this round → trigger blocked (psi=0.981)
[S16] START round=74 head_norm_before_train=2.051677 cos_to_last_merge=0.7726 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.773
[S16] round=74 local utility u=0.003909 metrics={'f1_val': 0.992414673153375, 'auprc': 0.9967793424131757, 'loss_val': 0.03094056620065283, 'psi': 0.9941605408572952}-{'f1_val': 0.9934883746349171, 'auprc': 0.9920293692185105, 'loss_val': 0.03095078041337408, 'psi': 0.9929047724683545}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=74 head_norm_before_train=1.867548 cos_to_last_merge=0.8496 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.850
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.7412536834535475, 'auprc': 0.9351048948253841, 'loss_val': 0.8050342375186728, 'psi': 0.8187941680022821}-{'f1_val': 0.8885493963632226, 'auprc': 0.9804829391363337, 'loss_val': 0.34003144250841205, 'psi': 0.925322813472467}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=75 head_norm_before_train=2.069598 cos_to_last_merge=0.7579 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.758
[S2] round=75 local utility u=0.025113 metrics={'f1_val': 0.7193391753264217, 'auprc': 0.7373442824388395, 'loss_val': 1.130300700449913, 'psi': 0.7265412181713888}-{'f1_val': 0.6978313873685928, 'auprc': 0.7483120769519539, 'loss_val': 1.0843832926391794, 'psi': 0.7180236632019372}
[S2] not sending this round → trigger blocked (psi=0.727)
[S3] START round=75 head_norm_before_train=2.508255 (no previous merge yet)
[S3] round=75 local utility u=0.159850 metrics={'f1_val': 0.8259983328825473, 'auprc': 0.9839315360897104, 'loss_val': 0.5699423732343942, 'psi': 0.8891716141654126}-{'f1_val': 0.7962937190171335, 'auprc': 0.987906221135878, 'loss_val': 0.7233381907044123, 'psi': 0.8729387198646312}
[S3] not sending this round → trigger blocked (psi=0.889)
[S4] START round=75 head_norm_before_train=1.817668 cos_to_last_merge=0.8852 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9480901289606951, 'auprc': 0.98017645452464, 'loss_val': 0.27968379436520846, 'psi': 0.960924659186273}-{'f1_val': 0.9547850456169531, 'auprc': 0.9713528317909859, 'loss_val': 0.2774533826229284, 'psi': 0.9614121600865662}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=1.862438 cos_to_last_merge=0.7725 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.773
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.9907609339200727, 'loss_val': 0.023958157548581806, 'psi': 0.9938414737047596}-{'f1_val': 0.9963338119635569, 'auprc': 0.9920614357819894, 'loss_val': 0.024427524551908286, 'psi': 0.9946248614909299}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.977745 cos_to_last_merge=0.8828 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6342143361093694, 'auprc': 0.8931986477510632, 'loss_val': 0.8728296764359869, 'psi': 0.7378080607660469}-{'f1_val': 0.8080932237151497, 'auprc': 0.9336630312033942, 'loss_val': 0.432929810998421, 'psi': 0.8583211467104475}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.828466 cos_to_last_merge=0.7693 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=75 local utility u=0.000000 metrics={'f1_val': 0.5586826296773015, 'auprc': 0.7927023904746477, 'loss_val': 1.0501128147456094, 'psi': 0.6522905339962399}-{'f1_val': 0.8054436738974604, 'auprc': 0.9572202415507729, 'loss_val': 0.44929984775729837, 'psi': 0.8661543009587854}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=75 head_norm_before_train=2.183905 (no previous merge yet)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.9689364999840765, 'auprc': 0.9932439760985168, 'loss_val': 0.1022051954188232, 'psi': 0.9786594904298526}-{'f1_val': 0.9945713855819248, 'auprc': 0.9990795630724625, 'loss_val': 0.03704000442237705, 'psi': 0.9963746565781398}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=75 head_norm_before_train=2.231056 cos_to_last_merge=0.9277 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.928
[S9] round=75 local utility u=0.002714 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9978762215525017, 'loss_val': 0.019359459399324926, 'psi': 0.9971467957093355}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984696567402889, 'loss_val': 0.020063852750293154, 'psi': 0.9967336980266244}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=75 head_norm_before_train=1.988558 cos_to_last_merge=0.9147 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.915
[S10] round=75 local utility u=0.000443 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9942129724212784, 'loss_val': 0.030007819775975077, 'psi': 0.993825982787668}-{'f1_val': 0.9933489306849028, 'auprc': 0.9949898724758525, 'loss_val': 0.03190946253119993, 'psi': 0.9940053074012827}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=75 head_norm_before_train=2.337979 cos_to_last_merge=0.9315 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.932
[S11] round=75 local utility u=0.000000 metrics={'f1_val': 0.9948729078564705, 'auprc': 0.9975698421255519, 'loss_val': 0.023645197430444395, 'psi': 0.9959516815641031}-{'f1_val': 0.9965470045135896, 'auprc': 0.9961512090369496, 'loss_val': 0.019473909927380042, 'psi': 0.9963886863229336}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=75 head_norm_before_train=1.954159 (no previous merge yet)
[S13] round=75 local utility u=0.000000 metrics={'f1_val': 0.7529587217693827, 'auprc': 0.8517518930873671, 'loss_val': 0.8904774415210222, 'psi': 0.7924759902965764}-{'f1_val': 0.7752184149947122, 'auprc': 0.8313150092314479, 'loss_val': 0.7526946873130497, 'psi': 0.7976570526894065}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=75 head_norm_before_train=2.234334 cos_to_last_merge=0.9620 (last merge round=15)
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9973833833620065, 'auprc': 0.9988529073901488, 'loss_val': 0.021204669861041903, 'psi': 0.9979711929732633}-{'f1_val': 0.9978195179672185, 'auprc': 0.997160542631035, 'loss_val': 0.01860086947675908, 'psi': 0.997555927832745}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=2.370468 (no previous merge yet)
[S15] round=75 local utility u=0.008774 metrics={'f1_val': 0.9722698961093575, 'auprc': 0.9975177252177916, 'loss_val': 0.0475428909693027, 'psi': 0.9823690277527312}-{'f1_val': 0.9700305310795656, 'auprc': 0.9974951745101136, 'loss_val': 0.05158685202627637, 'psi': 0.9810163884517848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=75 head_norm_before_train=2.056752 cos_to_last_merge=0.7722 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=75 local utility u=0.003460 metrics={'f1_val': 0.9922163343538072, 'auprc': 0.9992793204177751, 'loss_val': 0.03033049536548651, 'psi': 0.9950415287793943}-{'f1_val': 0.992414673153375, 'auprc': 0.9967793424131757, 'loss_val': 0.03094056620065283, 'psi': 0.9941605408572952}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=75 head_norm_before_train=1.872537 cos_to_last_merge=0.8480 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.848
[S17] round=75 local utility u=0.710585 metrics={'f1_val': 0.8827687831895077, 'auprc': 0.9805204046111577, 'loss_val': 0.3692019489613842, 'psi': 0.9218694317581677}-{'f1_val': 0.7412536834535475, 'auprc': 0.9351048948253841, 'loss_val': 0.8050342375186728, 'psi': 0.8187941680022821}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S2] START round=76 head_norm_before_train=2.074419 cos_to_last_merge=0.7574 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=76 local utility u=0.001802 metrics={'f1_val': 0.7208510949337401, 'auprc': 0.7331571090881293, 'loss_val': 1.1232071491653324, 'psi': 0.7257735005954957}-{'f1_val': 0.7193391753264217, 'auprc': 0.7373442824388395, 'loss_val': 1.130300700449913, 'psi': 0.7265412181713888}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=76 head_norm_before_train=2.513759 (no previous merge yet)
[S3] round=76 local utility u=0.542119 metrics={'f1_val': 0.9423383089851239, 'auprc': 0.9942527744804206, 'loss_val': 0.21470818576878464, 'psi': 0.9631040951832426}-{'f1_val': 0.8259983328825473, 'auprc': 0.9839315360897104, 'loss_val': 0.5699423732343942, 'psi': 0.8891716141654126}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=76 head_norm_before_train=1.820334 cos_to_last_merge=0.8845 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=76 local utility u=0.027613 metrics={'f1_val': 0.9534408944211161, 'auprc': 0.9850805355812768, 'loss_val': 0.2712743196848659, 'psi': 0.9660967508851804}-{'f1_val': 0.9480901289606951, 'auprc': 0.98017645452464, 'loss_val': 0.27968379436520846, 'psi': 0.960924659186273}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=76 head_norm_before_train=1.874497 cos_to_last_merge=0.7707 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.771
[S5] round=76 local utility u=0.000000 metrics={'f1_val': 0.995895166894551, 'auprc': 0.990933491837757, 'loss_val': 0.031268913633743074, 'psi': 0.9939104968718334}-{'f1_val': 0.995895166894551, 'auprc': 0.9907609339200727, 'loss_val': 0.023958157548581806, 'psi': 0.9938414737047596}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=76 head_norm_before_train=1.983548 cos_to_last_merge=0.8820 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=76 local utility u=1.000000 metrics={'f1_val': 0.9850057236591997, 'auprc': 0.9625399664794216, 'loss_val': 0.11296077949694168, 'psi': 0.9760194207872885}-{'f1_val': 0.6342143361093694, 'auprc': 0.8931986477510632, 'loss_val': 0.8728296764359869, 'psi': 0.7378080607660469}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=76 head_norm_before_train=1.832750 cos_to_last_merge=0.7694 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=76 local utility u=0.030860 metrics={'f1_val': 0.5681532664200983, 'auprc': 0.7929576399900409, 'loss_val': 1.0459833209767218, 'psi': 0.6580750158480754}-{'f1_val': 0.5586826296773015, 'auprc': 0.7927023904746477, 'loss_val': 1.0501128147456094, 'psi': 0.6522905339962399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=76 head_norm_before_train=2.184948 (no previous merge yet)
[S8] round=76 local utility u=0.125645 metrics={'f1_val': 0.9950789820710053, 'auprc': 0.9990283911368267, 'loss_val': 0.025122820553398744, 'psi': 0.9966587456973339}-{'f1_val': 0.9689364999840765, 'auprc': 0.9932439760985168, 'loss_val': 0.1022051954188232, 'psi': 0.9786594904298526}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] START round=76 head_norm_before_train=2.236427 cos_to_last_merge=0.9271 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=76 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9985250347631631, 'loss_val': 0.01975282951298686, 'psi': 0.9969060449237765}-{'f1_val': 0.9966605118138915, 'auprc': 0.9978762215525017, 'loss_val': 0.019359459399324926, 'psi': 0.9971467957093355}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=76 head_norm_before_train=1.994532 cos_to_last_merge=0.9144 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=76 local utility u=0.001121 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.994118194416221, 'loss_val': 0.028795642261013527, 'psi': 0.9939195509113015}-{'f1_val': 0.9935679896985945, 'auprc': 0.9942129724212784, 'loss_val': 0.030007819775975077, 'psi': 0.993825982787668}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=76 head_norm_before_train=2.342693 cos_to_last_merge=0.9311 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=76 local utility u=0.003240 metrics={'f1_val': 0.9968091830929121, 'auprc': 0.9940029893373566, 'loss_val': 0.018082293297222694, 'psi': 0.99568670559069}-{'f1_val': 0.9948729078564705, 'auprc': 0.9975698421255519, 'loss_val': 0.023645197430444395, 'psi': 0.9959516815641031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=76 head_norm_before_train=1.961901 (no previous merge yet)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6233298004528819, 'auprc': 0.7230370795077407, 'loss_val': 1.1808609467779159, 'psi': 0.6632127120748255}-{'f1_val': 0.7529587217693827, 'auprc': 0.8517518930873671, 'loss_val': 0.8904774415210222, 'psi': 0.7924759902965764}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=76 head_norm_before_train=2.239214 cos_to_last_merge=0.9618 (last merge round=15)
[S14] round=76 local utility u=0.001980 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.998854444812599, 'loss_val': 0.018871045800486763, 'psi': 0.9981340836146132}-{'f1_val': 0.9973833833620065, 'auprc': 0.9988529073901488, 'loss_val': 0.021204669861041903, 'psi': 0.9979711929732633}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=76 head_norm_before_train=2.375354 (no previous merge yet)
[S15] round=76 local utility u=0.000000 metrics={'f1_val': 0.9641301409518149, 'auprc': 0.9974167398521754, 'loss_val': 0.06483936639738763, 'psi': 0.9774447805119592}-{'f1_val': 0.9722698961093575, 'auprc': 0.9975177252177916, 'loss_val': 0.0475428909693027, 'psi': 0.9823690277527312}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=76 head_norm_before_train=2.059931 cos_to_last_merge=0.7719 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=76 local utility u=0.000364 metrics={'f1_val': 0.9923641593969502, 'auprc': 0.9991634334076817, 'loss_val': 0.03014223019616514, 'psi': 0.9950838690012427}-{'f1_val': 0.9922163343538072, 'auprc': 0.9992793204177751, 'loss_val': 0.03033049536548651, 'psi': 0.9950415287793943}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=76 head_norm_before_train=1.879684 cos_to_last_merge=0.8475 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.847
[S17] round=76 local utility u=0.000000 metrics={'f1_val': 0.8708981055305824, 'auprc': 0.9815236757701908, 'loss_val': 0.3999537771680884, 'psi': 0.9151483336264258}-{'f1_val': 0.8827687831895077, 'auprc': 0.9805204046111577, 'loss_val': 0.3692019489613842, 'psi': 0.9218694317581677}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=77 head_norm_before_train=2.076707 cos_to_last_merge=0.7569 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.757
[S2] round=77 local utility u=0.000000 metrics={'f1_val': 0.7220488802506216, 'auprc': 0.7280865345825116, 'loss_val': 1.121779184154858, 'psi': 0.7244639419833776}-{'f1_val': 0.7208510949337401, 'auprc': 0.7331571090881293, 'loss_val': 1.1232071491653324, 'psi': 0.7257735005954957}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=77 head_norm_before_train=2.519770 (no previous merge yet)
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.7082086582228154, 'auprc': 0.9486064864487516, 'loss_val': 1.0296527833355866, 'psi': 0.8043677895131899}-{'f1_val': 0.9423383089851239, 'auprc': 0.9942527744804206, 'loss_val': 0.21470818576878464, 'psi': 0.9631040951832426}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.824894 cos_to_last_merge=0.8836 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.884
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9554859818590961, 'auprc': 0.9696987971426414, 'loss_val': 0.2812830766036678, 'psi': 0.9611711079725143}-{'f1_val': 0.9534408944211161, 'auprc': 0.9850805355812768, 'loss_val': 0.2712743196848659, 'psi': 0.9660967508851804}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=1.883059 cos_to_last_merge=0.7694 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=77 local utility u=0.018696 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9993533460094375, 'loss_val': 0.023976352231814005, 'psi': 0.9977625194908496}-{'f1_val': 0.995895166894551, 'auprc': 0.990933491837757, 'loss_val': 0.031268913633743074, 'psi': 0.9939104968718334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=77 head_norm_before_train=1.992393 cos_to_last_merge=0.8809 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=77 local utility u=0.000000 metrics={'f1_val': 0.6727705408288136, 'auprc': 0.7921188849082553, 'loss_val': 1.0149741800852516, 'psi': 0.7205098784605903}-{'f1_val': 0.9850057236591997, 'auprc': 0.9625399664794216, 'loss_val': 0.11296077949694168, 'psi': 0.9760194207872885}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=77 head_norm_before_train=1.839500 cos_to_last_merge=0.7686 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.769
[S7] round=77 local utility u=0.089735 metrics={'f1_val': 0.5780543651962478, 'auprc': 0.7933019269933332, 'loss_val': 0.9269522063515254, 'psi': 0.664153389915082}-{'f1_val': 0.5681532664200983, 'auprc': 0.7929576399900409, 'loss_val': 1.0459833209767218, 'psi': 0.6580750158480754}
[S7] not sending this round → trigger blocked (psi=0.664)
[S8] START round=77 head_norm_before_train=2.191003 (no previous merge yet)
[S8] round=77 local utility u=0.001802 metrics={'f1_val': 0.9958161710705877, 'auprc': 0.9988207258643361, 'loss_val': 0.02531923293675437, 'psi': 0.997017992988087}-{'f1_val': 0.9950789820710053, 'auprc': 0.9990283911368267, 'loss_val': 0.025122820553398744, 'psi': 0.9966587456973339}
[S8] not sending this round → trigger blocked (psi=0.997)
[S9] START round=77 head_norm_before_train=2.240560 cos_to_last_merge=0.9267 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.927
[S9] round=77 local utility u=0.001339 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9974713922819167, 'loss_val': 0.01891732221597792, 'psi': 0.9969848640011015}-{'f1_val': 0.9958267183641853, 'auprc': 0.9985250347631631, 'loss_val': 0.01975282951298686, 'psi': 0.9969060449237765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=77 head_norm_before_train=1.996641 cos_to_last_merge=0.9137 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.914
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9944523916153258, 'loss_val': 0.029914468388382753, 'psi': 0.993921750465287}-{'f1_val': 0.9937871219080217, 'auprc': 0.994118194416221, 'loss_val': 0.028795642261013527, 'psi': 0.9939195509113015}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=77 head_norm_before_train=2.347335 cos_to_last_merge=0.9307 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.931
[S11] round=77 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9928728893719974, 'loss_val': 0.01908339660155808, 'psi': 0.9949866680672654}-{'f1_val': 0.9968091830929121, 'auprc': 0.9940029893373566, 'loss_val': 0.018082293297222694, 'psi': 0.99568670559069}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=77 head_norm_before_train=1.969916 (no previous merge yet)
[S13] round=77 local utility u=0.700759 metrics={'f1_val': 0.7529024339699723, 'auprc': 0.8236813660101744, 'loss_val': 0.8587121513075281, 'psi': 0.7812140067860531}-{'f1_val': 0.6233298004528819, 'auprc': 0.7230370795077407, 'loss_val': 1.1808609467779159, 'psi': 0.6632127120748255}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=77 head_norm_before_train=2.244266 cos_to_last_merge=0.9615 (last merge round=15)
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9988508086597897, 'loss_val': 0.020317635448232035, 'psi': 0.9978733386732259}-{'f1_val': 0.9976538428159559, 'auprc': 0.998854444812599, 'loss_val': 0.018871045800486763, 'psi': 0.9981340836146132}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=2.380101 (no previous merge yet)
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9524446625184665, 'auprc': 0.9973366106496457, 'loss_val': 0.08328772289298596, 'psi': 0.9704014417709381}-{'f1_val': 0.9641301409518149, 'auprc': 0.9974167398521754, 'loss_val': 0.06483936639738763, 'psi': 0.9774447805119592}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.064783 cos_to_last_merge=0.7717 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.9921650977686057, 'auprc': 0.9990080580932514, 'loss_val': 0.030584487603064363, 'psi': 0.994902281898464}-{'f1_val': 0.9923641593969502, 'auprc': 0.9991634334076817, 'loss_val': 0.03014223019616514, 'psi': 0.9950838690012427}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.888295 cos_to_last_merge=0.8470 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.847
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.8666285053797694, 'auprc': 0.980266607027213, 'loss_val': 0.42970127180714335, 'psi': 0.9120837460387469}-{'f1_val': 0.8708981055305824, 'auprc': 0.9815236757701908, 'loss_val': 0.3999537771680884, 'psi': 0.9151483336264258}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=78 head_norm_before_train=2.081601 cos_to_last_merge=0.7564 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=78 local utility u=0.000014 metrics={'f1_val': 0.7220488802506216, 'auprc': 0.727882627042056, 'loss_val': 1.1211386488988186, 'psi': 0.7243823789671954}-{'f1_val': 0.7220488802506216, 'auprc': 0.7280865345825116, 'loss_val': 1.121779184154858, 'psi': 0.7244639419833776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] sending update (kind=head size=1799 to 1 peers)
[S3] START round=78 head_norm_before_train=2.525478 (no previous merge yet)
[S3] round=78 local utility u=1.000000 metrics={'f1_val': 0.9753491907316776, 'auprc': 0.999336010359726, 'loss_val': 0.06769820202877071, 'psi': 0.9849439185828969}-{'f1_val': 0.7082086582228154, 'auprc': 0.9486064864487516, 'loss_val': 1.0296527833355866, 'psi': 0.8043677895131899}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=78 head_norm_before_train=1.830788 cos_to_last_merge=0.8827 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.883
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9566836581255275, 'auprc': 0.9563608659519797, 'loss_val': 0.2851319547782548, 'psi': 0.9565545412561083}-{'f1_val': 0.9554859818590961, 'auprc': 0.9696987971426414, 'loss_val': 0.2812830766036678, 'psi': 0.9611711079725143}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=1.886276 cos_to_last_merge=0.7686 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.769
[S5] round=78 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9949641236808364, 'loss_val': 0.027739871600525278, 'psi': 0.9957859366504687}-{'f1_val': 0.9967019684784577, 'auprc': 0.9993533460094375, 'loss_val': 0.023976352231814005, 'psi': 0.9977625194908496}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=78 head_norm_before_train=2.001129 cos_to_last_merge=0.8796 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=78 local utility u=0.000000 metrics={'f1_val': 0.6309260639878884, 'auprc': 0.7239444628428737, 'loss_val': 1.160275127734625, 'psi': 0.6681334235298826}-{'f1_val': 0.6727705408288136, 'auprc': 0.7921188849082553, 'loss_val': 1.0149741800852516, 'psi': 0.7205098784605903}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=78 head_norm_before_train=1.843828 cos_to_last_merge=0.7683 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.768
[S7] round=78 local utility u=1.000000 metrics={'f1_val': 0.9940537213272942, 'auprc': 0.9938077846073419, 'loss_val': 0.11885925415203959, 'psi': 0.9939553466393132}-{'f1_val': 0.5780543651962478, 'auprc': 0.7933019269933332, 'loss_val': 0.9269522063515254, 'psi': 0.664153389915082}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] sending update (kind=head size=1804 to 1 peers)
[S8] START round=78 head_norm_before_train=2.193566 (no previous merge yet)
[S8] round=78 local utility u=0.000000 metrics={'f1_val': 0.9951212911203298, 'auprc': 0.9989417061248886, 'loss_val': 0.021989191912424825, 'psi': 0.9966494571221534}-{'f1_val': 0.9958161710705877, 'auprc': 0.9988207258643361, 'loss_val': 0.02531923293675437, 'psi': 0.997017992988087}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=78 head_norm_before_train=2.246453 cos_to_last_merge=0.9264 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=78 local utility u=0.002098 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986631796221759, 'loss_val': 0.018297329281606104, 'psi': 0.9974615789372052}-{'f1_val': 0.9966605118138915, 'auprc': 0.9974713922819167, 'loss_val': 0.01891732221597792, 'psi': 0.9969848640011015}
[S9] not sending this round → trigger blocked (psi=0.997)
[S10] START round=78 head_norm_before_train=2.000129 cos_to_last_merge=0.9131 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9946904633440968, 'loss_val': 0.030945712608332485, 'psi': 0.9938855437485805}-{'f1_val': 0.9935679896985945, 'auprc': 0.9944523916153258, 'loss_val': 0.029914468388382753, 'psi': 0.993921750465287}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=78 head_norm_before_train=2.351743 cos_to_last_merge=0.9302 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=78 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9935468885005023, 'loss_val': 0.022792999782778583, 'psi': 0.9952562677186674}-{'f1_val': 0.9963958538641108, 'auprc': 0.9928728893719974, 'loss_val': 0.01908339660155808, 'psi': 0.9949866680672654}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=78 head_norm_before_train=1.976916 (no previous merge yet)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.6243628149018754, 'auprc': 0.6950524930780887, 'loss_val': 1.1349600396687056, 'psi': 0.6526386861723608}-{'f1_val': 0.7529024339699723, 'auprc': 0.8236813660101744, 'loss_val': 0.8587121513075281, 'psi': 0.7812140067860531}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=78 head_norm_before_train=2.245866 cos_to_last_merge=0.9614 (last merge round=15)
[S14] round=78 local utility u=0.000000 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9987811637072433, 'loss_val': 0.02078264082946319, 'psi': 0.9978454806922075}-{'f1_val': 0.9972216920155168, 'auprc': 0.9988508086597897, 'loss_val': 0.020317635448232035, 'psi': 0.9978733386732259}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=78 head_norm_before_train=2.384807 (no previous merge yet)
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.9362587169017521, 'auprc': 0.9972981155586266, 'loss_val': 0.10285387180905618, 'psi': 0.9606744763645019}-{'f1_val': 0.9524446625184665, 'auprc': 0.9973366106496457, 'loss_val': 0.08328772289298596, 'psi': 0.9704014417709381}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.070959 cos_to_last_merge=0.7716 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.772
[S16] round=78 local utility u=0.000000 metrics={'f1_val': 0.8352779316859349, 'auprc': 0.9919523593012278, 'loss_val': 0.5950612423653536, 'psi': 0.8979477027320522}-{'f1_val': 0.9921650977686057, 'auprc': 0.9990080580932514, 'loss_val': 0.030584487603064363, 'psi': 0.994902281898464}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=78 head_norm_before_train=1.898674 cos_to_last_merge=0.8464 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.846
[S17] round=78 local utility u=0.000000 metrics={'f1_val': 0.7421921034528469, 'auprc': 0.9426708987398413, 'loss_val': 0.9094630877879715, 'psi': 0.8223836215676447}-{'f1_val': 0.8666285053797694, 'auprc': 0.980266607027213, 'loss_val': 0.42970127180714335, 'psi': 0.9120837460387469}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=79 head_norm_before_train=2.086877 cos_to_last_merge=0.7558 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.756
[S2] round=79 local utility u=0.000000 metrics={'f1_val': 0.7208033232579657, 'auprc': 0.7270715036543633, 'loss_val': 1.1262448876449762, 'psi': 0.7233105954165248}-{'f1_val': 0.7220488802506216, 'auprc': 0.727882627042056, 'loss_val': 1.1211386488988186, 'psi': 0.7243823789671954}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=80 psi=0.723 u=0.0000 p_local=0.0071 f1=0.721 auprc=0.727 bytes=63005
[S3] START round=79 head_norm_before_train=2.529931 (no previous merge yet)
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.9595139574881344, 'auprc': 0.9956925380890279, 'loss_val': 0.17713716551067252, 'psi': 0.9739853897284918}-{'f1_val': 0.9753491907316776, 'auprc': 0.999336010359726, 'loss_val': 0.06769820202877071, 'psi': 0.9849439185828969}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.974 u=0.0000 p_local=0.2729 f1=0.960 auprc=0.996 bytes=57527
[S4] START round=79 head_norm_before_train=1.836033 cos_to_last_merge=0.8820 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=79 local utility u=0.022576 metrics={'f1_val': 0.9586069216203326, 'auprc': 0.9679149033271671, 'loss_val': 0.2861808298638935, 'psi': 0.9623301143030664}-{'f1_val': 0.9566836581255275, 'auprc': 0.9563608659519797, 'loss_val': 0.2851319547782548, 'psi': 0.9565545412561083}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S4] r=80 psi=0.962 u=0.0226 p_local=0.0098 f1=0.959 auprc=0.968 bytes=73818
[S5] START round=79 head_norm_before_train=1.890382 cos_to_last_merge=0.7673 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.767
[S5] round=79 local utility u=0.005020 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9971764596278707, 'loss_val': 0.02433677609281934, 'psi': 0.9966708710292824}-{'f1_val': 0.9963338119635569, 'auprc': 0.9949641236808364, 'loss_val': 0.027739871600525278, 'psi': 0.9957859366504687}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S5] r=80 psi=0.997 u=0.0050 p_local=0.0047 f1=0.996 auprc=0.997 bytes=68378
[S6] START round=79 head_norm_before_train=2.005595 cos_to_last_merge=0.8787 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=79 local utility u=0.962920 metrics={'f1_val': 0.7923350710523731, 'auprc': 0.8961861296659871, 'loss_val': 0.7196139183577289, 'psi': 0.8338754944978187}-{'f1_val': 0.6309260639878884, 'auprc': 0.7239444628428737, 'loss_val': 1.160275127734625, 'psi': 0.6681334235298826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S6] r=80 psi=0.834 u=0.9629 p_local=0.3852 f1=0.792 auprc=0.896 bytes=59441
[S7] START round=79 head_norm_before_train=1.847074 cos_to_last_merge=0.7684 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.768
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.5855855011661666, 'auprc': 0.7975131839524336, 'loss_val': 0.8951186015716558, 'psi': 0.6703565742806734}-{'f1_val': 0.9940537213272942, 'auprc': 0.9938077846073419, 'loss_val': 0.11885925415203959, 'psi': 0.9939553466393132}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.670 u=0.0000 p_local=0.2420 f1=0.586 auprc=0.798 bytes=66621
[S8] START round=79 head_norm_before_train=2.198992 (no previous merge yet)
[S8] round=79 local utility u=0.000000 metrics={'f1_val': 0.9940863284942748, 'auprc': 0.9989652994724649, 'loss_val': 0.02367999057255594, 'psi': 0.9960379168855509}-{'f1_val': 0.9951212911203298, 'auprc': 0.9989417061248886, 'loss_val': 0.021989191912424825, 'psi': 0.9966494571221534}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] r=80 psi=0.996 u=0.0000 p_local=0.1160 f1=0.994 auprc=0.999 bytes=64719
[S9] START round=79 head_norm_before_train=2.249788 cos_to_last_merge=0.9258 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.926
[S9] round=79 local utility u=0.000343 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986195403966373, 'loss_val': 0.017481185655399425, 'psi': 0.9974441232469897}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986631796221759, 'loss_val': 0.018297329281606104, 'psi': 0.9974615789372052}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S9] r=80 psi=0.997 u=0.0003 p_local=0.0033 f1=0.997 auprc=0.999 bytes=75559
[S10] START round=79 head_norm_before_train=2.004832 cos_to_last_merge=0.9127 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.913
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9944202624584899, 'loss_val': 0.030286299315067326, 'psi': 0.9937774633943377}-{'f1_val': 0.9933489306849028, 'auprc': 0.9946904633440968, 'loss_val': 0.030945712608332485, 'psi': 0.9938855437485805}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=80 psi=0.994 u=0.0000 p_local=0.0003 f1=0.993 auprc=0.994 bytes=70172
[S11] START round=79 head_norm_before_train=2.354833 cos_to_last_merge=0.9301 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=79 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9947073637262608, 'loss_val': 0.02874707727337867, 'psi': 0.9957204578089709}-{'f1_val': 0.9963958538641108, 'auprc': 0.9935468885005023, 'loss_val': 0.022792999782778583, 'psi': 0.9952562677186674}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=80 psi=0.996 u=0.0000 p_local=0.0141 f1=0.996 auprc=0.995 bytes=73658
[S13] START round=79 head_norm_before_train=1.983649 (no previous merge yet)
[S13] round=79 local utility u=0.531216 metrics={'f1_val': 0.7356522432983296, 'auprc': 0.7248468097120477, 'loss_val': 0.8296471430947733, 'psi': 0.7313300698638168}-{'f1_val': 0.6243628149018754, 'auprc': 0.6950524930780887, 'loss_val': 1.1349600396687056, 'psi': 0.6526386861723608}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] sending update (kind=head size=1798 to 1 peers)
[S13] r=80 psi=0.731 u=0.5312 p_local=0.2529 f1=0.736 auprc=0.725 bytes=68329
[S14] START round=79 head_norm_before_train=2.248379 cos_to_last_merge=0.9611 (last merge round=15)
[S14] round=79 local utility u=0.000040 metrics={'f1_val': 0.9972216920155168, 'auprc': 0.9988322616077205, 'loss_val': 0.020856329762784658, 'psi': 0.9978659198523983}-{'f1_val': 0.9972216920155168, 'auprc': 0.9987811637072433, 'loss_val': 0.02078264082946319, 'psi': 0.9978454806922075}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0099 f1=0.997 auprc=0.999 bytes=66550
[S15] START round=79 head_norm_before_train=2.389268 (no previous merge yet)
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.9333672888498293, 'auprc': 0.9972924103098952, 'loss_val': 0.10738173081603876, 'psi': 0.9589373374338557}-{'f1_val': 0.9362587169017521, 'auprc': 0.9972981155586266, 'loss_val': 0.10285387180905618, 'psi': 0.9606744763645019}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.959 u=0.0000 p_local=0.0156 f1=0.933 auprc=0.997 bytes=59301
[S16] START round=79 head_norm_before_train=2.075737 cos_to_last_merge=0.7714 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=79 local utility u=0.026209 metrics={'f1_val': 0.8677924048594984, 'auprc': 0.9858012305677969, 'loss_val': 0.7192774181368098, 'psi': 0.9149959351428179}-{'f1_val': 0.8352779316859349, 'auprc': 0.9919523593012278, 'loss_val': 0.5950612423653536, 'psi': 0.8979477027320522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S16] r=80 psi=0.915 u=0.0262 p_local=0.0117 f1=0.868 auprc=0.986 bytes=62941
[S17] START round=79 head_norm_before_train=1.906438 cos_to_last_merge=0.8450 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.845
[S17] round=79 local utility u=0.000000 metrics={'f1_val': 0.7655410738455701, 'auprc': 0.9447842392319353, 'loss_val': 1.0965774002327637, 'psi': 0.8372383400001162}-{'f1_val': 0.7421921034528469, 'auprc': 0.9426708987398413, 'loss_val': 0.9094630877879715, 'psi': 0.8223836215676447}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] r=80 psi=0.837 u=0.0000 p_local=0.1636 f1=0.766 auprc=0.945 bytes=59445
[S2] START round=80 head_norm_before_train=2.093312 cos_to_last_merge=0.7553 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.7208033232579657, 'auprc': 0.7262660339090111, 'loss_val': 1.1352313660958986, 'psi': 0.7229884075183839}-{'f1_val': 0.7208033232579657, 'auprc': 0.7270715036543633, 'loss_val': 1.1262448876449762, 'psi': 0.7233105954165248}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=80 head_norm_before_train=2.534005 (no previous merge yet)
[S3] round=80 local utility u=0.034146 metrics={'f1_val': 0.960995754132836, 'auprc': 0.998963221577414, 'loss_val': 0.12754737717028372, 'psi': 0.9761827411106673}-{'f1_val': 0.9595139574881344, 'auprc': 0.9956925380890279, 'loss_val': 0.17713716551067252, 'psi': 0.9739853897284918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=80 head_norm_before_train=1.840922 cos_to_last_merge=0.8816 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.882
[S4] round=80 local utility u=0.004932 metrics={'f1_val': 0.952735901672729, 'auprc': 0.9809795533465698, 'loss_val': 0.2802838396202288, 'psi': 0.9640333623422653}-{'f1_val': 0.9586069216203326, 'auprc': 0.9679149033271671, 'loss_val': 0.2861808298638935, 'psi': 0.9623301143030664}
[S4] not sending this round → trigger blocked (psi=0.964)
[S5] START round=80 head_norm_before_train=1.896478 cos_to_last_merge=0.7664 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=80 local utility u=0.002375 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9986678525773904, 'loss_val': 0.02406191976274422, 'psi': 0.9972674282090903}-{'f1_val': 0.9963338119635569, 'auprc': 0.9971764596278707, 'loss_val': 0.02433677609281934, 'psi': 0.9966708710292824}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=80 head_norm_before_train=2.009927 cos_to_last_merge=0.8780 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=80 local utility u=0.000000 metrics={'f1_val': 0.6284184872904012, 'auprc': 0.7106719406033378, 'loss_val': 1.1266521545599788, 'psi': 0.6613198686155758}-{'f1_val': 0.7923350710523731, 'auprc': 0.8961861296659871, 'loss_val': 0.7196139183577289, 'psi': 0.8338754944978187}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=80 head_norm_before_train=1.852223 cos_to_last_merge=0.7682 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.768
[S7] round=80 local utility u=1.000000 metrics={'f1_val': 0.9202060349463749, 'auprc': 0.9789123800830326, 'loss_val': 0.30772808416845954, 'psi': 0.9436885730010379}-{'f1_val': 0.5855855011661666, 'auprc': 0.7975131839524336, 'loss_val': 0.8951186015716558, 'psi': 0.6703565742806734}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=80 head_norm_before_train=2.203462 (no previous merge yet)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.7631666383001653, 'auprc': 0.9966285776916769, 'loss_val': 0.4475493292545401, 'psi': 0.8565514140567699}-{'f1_val': 0.9940863284942748, 'auprc': 0.9989652994724649, 'loss_val': 0.02367999057255594, 'psi': 0.9960379168855509}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=80 head_norm_before_train=2.254860 cos_to_last_merge=0.9254 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=80 local utility u=0.000000 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9986206561740698, 'loss_val': 0.01867291350290949, 'psi': 0.9967940978001367}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986195403966373, 'loss_val': 0.017481185655399425, 'psi': 0.9974441232469897}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=80 head_norm_before_train=2.010157 cos_to_last_merge=0.9123 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=80 local utility u=0.000231 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.994531157903091, 'loss_val': 0.03015686281957763, 'psi': 0.9938218215721781}-{'f1_val': 0.9933489306849028, 'auprc': 0.9944202624584899, 'loss_val': 0.030286299315067326, 'psi': 0.9937774633943377}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] sending update (kind=head size=1797 to 1 peers)
[S11] START round=80 head_norm_before_train=2.359018 cos_to_last_merge=0.9297 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.930
[S11] round=80 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9950570877615955, 'loss_val': 0.03563449623893373, 'psi': 0.9957153199510854}-{'f1_val': 0.9963958538641108, 'auprc': 0.9947073637262608, 'loss_val': 0.02874707727337867, 'psi': 0.9957204578089709}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=80 head_norm_before_train=1.988920 (no previous merge yet)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6429809128798503, 'auprc': 0.699567534590481, 'loss_val': 1.0264966961487407, 'psi': 0.6656155615641026}-{'f1_val': 0.7356522432983296, 'auprc': 0.7248468097120477, 'loss_val': 0.8296471430947733, 'psi': 0.7313300698638168}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=80 head_norm_before_train=2.252353 cos_to_last_merge=0.9608 (last merge round=15)
[S14] round=80 local utility u=0.002002 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9988547215296281, 'loss_val': 0.019512093486103624, 'psi': 0.9981341943014248}-{'f1_val': 0.9972216920155168, 'auprc': 0.9988322616077205, 'loss_val': 0.020856329762784658, 'psi': 0.9978659198523983}
[S14] not sending this round → trigger blocked (psi=0.998)
[S15] START round=80 head_norm_before_train=2.393710 (no previous merge yet)
[S15] round=80 local utility u=0.000000 metrics={'f1_val': 0.9318317502420822, 'auprc': 0.9972864512599116, 'loss_val': 0.11039812051889612, 'psi': 0.958013630649214}-{'f1_val': 0.9333672888498293, 'auprc': 0.9972924103098952, 'loss_val': 0.10738173081603876, 'psi': 0.9589373374338557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=80 head_norm_before_train=2.076679 cos_to_last_merge=0.7711 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=80 local utility u=0.731056 metrics={'f1_val': 0.9910128669692444, 'auprc': 0.9988392840079369, 'loss_val': 0.035602381890419886, 'psi': 0.9941434337847214}-{'f1_val': 0.8677924048594984, 'auprc': 0.9858012305677969, 'loss_val': 0.7192774181368098, 'psi': 0.9149959351428179}
[S16] not sending this round → trigger blocked (psi=0.994)
[S17] START round=80 head_norm_before_train=1.910586 cos_to_last_merge=0.8440 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=80 local utility u=0.426307 metrics={'f1_val': 0.8252207752447094, 'auprc': 0.968255518475036, 'loss_val': 0.6724554143010821, 'psi': 0.88243467253684}-{'f1_val': 0.7655410738455701, 'auprc': 0.9447842392319353, 'loss_val': 1.0965774002327637, 'psi': 0.8372383400001162}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] START round=81 head_norm_before_train=2.099514 cos_to_last_merge=0.7548 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=81 local utility u=0.000000 metrics={'f1_val': 0.7208033232579657, 'auprc': 0.7261021557181835, 'loss_val': 1.140869246972408, 'psi': 0.7229228562420529}-{'f1_val': 0.7208033232579657, 'auprc': 0.7262660339090111, 'loss_val': 1.1352313660958986, 'psi': 0.7229884075183839}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=81 head_norm_before_train=2.539390 (no previous merge yet)
[S3] round=81 local utility u=0.093389 metrics={'f1_val': 0.9807668776533067, 'auprc': 0.9989493137035869, 'loss_val': 0.05935450360356901, 'psi': 0.9880398520734188}-{'f1_val': 0.960995754132836, 'auprc': 0.998963221577414, 'loss_val': 0.12754737717028372, 'psi': 0.9761827411106673}
[S3] not sending this round → trigger blocked (psi=0.988)
[S4] START round=81 head_norm_before_train=1.847912 cos_to_last_merge=0.8812 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.881
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9432748849308501, 'auprc': 0.9553928940399447, 'loss_val': 0.2891504478240756, 'psi': 0.948122088574488}-{'f1_val': 0.952735901672729, 'auprc': 0.9809795533465698, 'loss_val': 0.2802838396202288, 'psi': 0.9640333623422653}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=1.904230 cos_to_last_merge=0.7657 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.766
[S5] round=81 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9972631742528975, 'loss_val': 0.023201042830494612, 'psi': 0.9967055568792931}-{'f1_val': 0.9963338119635569, 'auprc': 0.9986678525773904, 'loss_val': 0.02406191976274422, 'psi': 0.9972674282090903}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=81 head_norm_before_train=2.016961 cos_to_last_merge=0.8772 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=81 local utility u=1.000000 metrics={'f1_val': 0.8302193727331162, 'auprc': 0.9369824255669024, 'loss_val': 0.36601844338791445, 'psi': 0.8729245938666306}-{'f1_val': 0.6284184872904012, 'auprc': 0.7106719406033378, 'loss_val': 1.1266521545599788, 'psi': 0.6613198686155758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=81 head_norm_before_train=1.859034 cos_to_last_merge=0.7673 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.767
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.5721849288864638, 'auprc': 0.7948854637786908, 'loss_val': 0.9584559426419668, 'psi': 0.6612651428433547}-{'f1_val': 0.9202060349463749, 'auprc': 0.9789123800830326, 'loss_val': 0.30772808416845954, 'psi': 0.9436885730010379}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=2.208631 (no previous merge yet)
[S8] round=81 local utility u=0.908248 metrics={'f1_val': 0.9941986149874398, 'auprc': 0.9988344656591077, 'loss_val': 0.02386355297482824, 'psi': 0.9960529552561069}-{'f1_val': 0.7631666383001653, 'auprc': 0.9966285776916769, 'loss_val': 0.4475493292545401, 'psi': 0.8565514140567699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=81 head_norm_before_train=2.260592 cos_to_last_merge=0.9251 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=81 local utility u=0.003964 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986316614240348, 'loss_val': 0.017281936839050122, 'psi': 0.9974489716579488}-{'f1_val': 0.9955763922175147, 'auprc': 0.9986206561740698, 'loss_val': 0.01867291350290949, 'psi': 0.9967940978001367}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=81 head_norm_before_train=2.013956 cos_to_last_merge=0.9117 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.912
[S10] round=81 local utility u=0.002259 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9954792354017002, 'loss_val': 0.029796953148693375, 'psi': 0.9943324879798368}-{'f1_val': 0.9933489306849028, 'auprc': 0.994531157903091, 'loss_val': 0.03015686281957763, 'psi': 0.9938218215721781}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=81 head_norm_before_train=2.363808 cos_to_last_merge=0.9292 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=81 local utility u=0.003444 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.994812632899433, 'loss_val': 0.02801409678633532, 'psi': 0.9956175380062204}-{'f1_val': 0.9961541414107454, 'auprc': 0.9950570877615955, 'loss_val': 0.03563449623893373, 'psi': 0.9957153199510854}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S11] sending update (kind=head size=1795 to 1 peers)
[S13] START round=81 head_norm_before_train=1.994449 (no previous merge yet)
[S13] round=81 local utility u=0.453019 metrics={'f1_val': 0.7560935589029808, 'auprc': 0.7621512598771164, 'loss_val': 0.9868853653079194, 'psi': 0.758516639292635}-{'f1_val': 0.6429809128798503, 'auprc': 0.699567534590481, 'loss_val': 1.0264966961487407, 'psi': 0.6656155615641026}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=81 head_norm_before_train=2.256562 cos_to_last_merge=0.9607 (last merge round=15)
[S14] round=81 local utility u=0.000712 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9981557215067808, 'loss_val': 0.01845622044518164, 'psi': 0.9981010533442445}-{'f1_val': 0.9976538428159559, 'auprc': 0.9988547215296281, 'loss_val': 0.019512093486103624, 'psi': 0.9981341943014248}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=81 head_norm_before_train=2.398149 (no previous merge yet)
[S15] round=81 local utility u=0.038023 metrics={'f1_val': 0.9417573528288019, 'auprc': 0.9973171336381759, 'loss_val': 0.09399757805508607, 'psi': 0.9639812651525514}-{'f1_val': 0.9318317502420822, 'auprc': 0.9972864512599116, 'loss_val': 0.11039812051889612, 'psi': 0.958013630649214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=81 head_norm_before_train=2.080465 cos_to_last_merge=0.7710 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=81 local utility u=0.003635 metrics={'f1_val': 0.9922877939293971, 'auprc': 0.9985309911585375, 'loss_val': 0.035057856136702974, 'psi': 0.9947850728210532}-{'f1_val': 0.9910128669692444, 'auprc': 0.9988392840079369, 'loss_val': 0.035602381890419886, 'psi': 0.9941434337847214}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=81 head_norm_before_train=1.915071 cos_to_last_merge=0.8439 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.844
[S17] round=81 local utility u=0.000000 metrics={'f1_val': 0.7797674906959244, 'auprc': 0.9569667383139319, 'loss_val': 0.6605788212508357, 'psi': 0.8506471897431274}-{'f1_val': 0.8252207752447094, 'auprc': 0.968255518475036, 'loss_val': 0.6724554143010821, 'psi': 0.88243467253684}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=82 head_norm_before_train=2.104892 cos_to_last_merge=0.7543 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=82 local utility u=0.003658 metrics={'f1_val': 0.7195189183495809, 'auprc': 0.7174290652212023, 'loss_val': 1.099827597691467, 'psi': 0.7186829770982295}-{'f1_val': 0.7208033232579657, 'auprc': 0.7261021557181835, 'loss_val': 1.140869246972408, 'psi': 0.7229228562420529}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=82 head_norm_before_train=2.545054 (no previous merge yet)
[S3] round=82 local utility u=0.000000 metrics={'f1_val': 0.9600662304203449, 'auprc': 0.9989874242222293, 'loss_val': 0.19335155414053945, 'psi': 0.9756347079410986}-{'f1_val': 0.9807668776533067, 'auprc': 0.9989493137035869, 'loss_val': 0.05935450360356901, 'psi': 0.9880398520734188}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=82 head_norm_before_train=1.854838 cos_to_last_merge=0.8803 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=82 local utility u=0.016575 metrics={'f1_val': 0.9449107821885594, 'auprc': 0.9615170492403261, 'loss_val': 0.2841875724468818, 'psi': 0.9515532890092662}-{'f1_val': 0.9432748849308501, 'auprc': 0.9553928940399447, 'loss_val': 0.2891504478240756, 'psi': 0.948122088574488}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=82 head_norm_before_train=1.914392 cos_to_last_merge=0.7644 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.764
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9935683707316437, 'loss_val': 0.023294093793868938, 'psi': 0.9952276354707916}-{'f1_val': 0.9963338119635569, 'auprc': 0.9972631742528975, 'loss_val': 0.023201042830494612, 'psi': 0.9967055568792931}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=2.024577 cos_to_last_merge=0.8764 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.7803320180924378, 'auprc': 0.9180328184939051, 'loss_val': 0.6583559232631572, 'psi': 0.8354123382530247}-{'f1_val': 0.8302193727331162, 'auprc': 0.9369824255669024, 'loss_val': 0.36601844338791445, 'psi': 0.8729245938666306}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.864862 cos_to_last_merge=0.7671 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.767
[S7] round=82 local utility u=0.703247 metrics={'f1_val': 0.6713340939126312, 'auprc': 0.93090357189495, 'loss_val': 0.5549103130756864, 'psi': 0.7751618851055587}-{'f1_val': 0.5721849288864638, 'auprc': 0.7948854637786908, 'loss_val': 0.9584559426419668, 'psi': 0.6612651428433547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=82 head_norm_before_train=2.214030 (no previous merge yet)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.7140170479737811, 'auprc': 0.9946992908566621, 'loss_val': 0.580106895946772, 'psi': 0.8262899451269334}-{'f1_val': 0.9941986149874398, 'auprc': 0.9988344656591077, 'loss_val': 0.02386355297482824, 'psi': 0.9960529552561069}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=82 head_norm_before_train=2.267041 cos_to_last_merge=0.9247 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.925
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986463929803652, 'loss_val': 0.018183727520173925, 'psi': 0.9974548642804809}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986316614240348, 'loss_val': 0.017281936839050122, 'psi': 0.9974489716579488}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=2.016108 cos_to_last_merge=0.9111 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=82 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9955483675849837, 'loss_val': 0.030347341695896358, 'psi': 0.9942287054449352}-{'f1_val': 0.9935679896985945, 'auprc': 0.9954792354017002, 'loss_val': 0.029796953148693375, 'psi': 0.9943324879798368}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=82 head_norm_before_train=2.368723 cos_to_last_merge=0.9287 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9814400812334457, 'auprc': 0.9942983660023225, 'loss_val': 0.06371049715318068, 'psi': 0.9865833951409964}-{'f1_val': 0.9961541414107454, 'auprc': 0.994812632899433, 'loss_val': 0.02801409678633532, 'psi': 0.9956175380062204}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=82 head_norm_before_train=1.998789 (no previous merge yet)
[S13] round=82 local utility u=0.053408 metrics={'f1_val': 0.7237445874349295, 'auprc': 0.7999383555278556, 'loss_val': 0.7993371098476708, 'psi': 0.7542220946721}-{'f1_val': 0.7560935589029808, 'auprc': 0.7621512598771164, 'loss_val': 0.9868853653079194, 'psi': 0.758516639292635}
[S13] not sending this round → trigger blocked (psi=0.754)
[S14] START round=82 head_norm_before_train=2.258322 cos_to_last_merge=0.9606 (last merge round=15)
[S14] round=82 local utility u=0.000000 metrics={'f1_val': 0.9322488600003207, 'auprc': 0.944674858951984, 'loss_val': 0.21046490698884743, 'psi': 0.9372192595809861}-{'f1_val': 0.9980646079025537, 'auprc': 0.9981557215067808, 'loss_val': 0.01845622044518164, 'psi': 0.9981010533442445}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=82 head_norm_before_train=2.402561 (no previous merge yet)
[S15] round=82 local utility u=0.045696 metrics={'f1_val': 0.954819230695445, 'auprc': 0.9973465738734733, 'loss_val': 0.08106562539510524, 'psi': 0.9718301679666563}-{'f1_val': 0.9417573528288019, 'auprc': 0.9973171336381759, 'loss_val': 0.09399757805508607, 'psi': 0.9639812651525514}
[S15] not sending this round → trigger blocked (psi=0.972)
[S16] START round=82 head_norm_before_train=2.084642 cos_to_last_merge=0.7709 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=82 local utility u=0.000276 metrics={'f1_val': 0.9918755575684484, 'auprc': 0.9989278796488824, 'loss_val': 0.03322305503458516, 'psi': 0.994696486400622}-{'f1_val': 0.9922877939293971, 'auprc': 0.9985309911585375, 'loss_val': 0.035057856136702974, 'psi': 0.9947850728210532}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=82 head_norm_before_train=1.921069 cos_to_last_merge=0.8432 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=82 local utility u=0.506157 metrics={'f1_val': 0.8855601543418374, 'auprc': 0.9887126604266328, 'loss_val': 0.37825785143448587, 'psi': 0.9268211567757555}-{'f1_val': 0.7797674906959244, 'auprc': 0.9569667383139319, 'loss_val': 0.6605788212508357, 'psi': 0.8506471897431274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] sending update (kind=head size=1796 to 1 peers)
[S2] START round=83 head_norm_before_train=2.100339 cos_to_last_merge=0.7545 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=83 local utility u=0.000000 metrics={'f1_val': 0.7205386760351132, 'auprc': 0.7002353868020087, 'loss_val': 1.0651116129346554, 'psi': 0.7124173603418714}-{'f1_val': 0.7195189183495809, 'auprc': 0.7174290652212023, 'loss_val': 1.099827597691467, 'psi': 0.7186829770982295}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=83 head_norm_before_train=2.548177 (no previous merge yet)
[S3] round=83 local utility u=0.199882 metrics={'f1_val': 0.9969583726029951, 'auprc': 0.9992677560125565, 'loss_val': 0.01578052622679733, 'psi': 0.9978821259668197}-{'f1_val': 0.9600662304203449, 'auprc': 0.9989874242222293, 'loss_val': 0.19335155414053945, 'psi': 0.9756347079410986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=83 head_norm_before_train=1.860307 cos_to_last_merge=0.8795 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.880
[S4] round=83 local utility u=0.049112 metrics={'f1_val': 0.9513009668702002, 'auprc': 0.9816086637341772, 'loss_val': 0.28458012105732317, 'psi': 0.963424045615791}-{'f1_val': 0.9449107821885594, 'auprc': 0.9615170492403261, 'loss_val': 0.2841875724468818, 'psi': 0.9515532890092662}
[S4] not sending this round → trigger blocked (psi=0.963)
[S5] START round=83 head_norm_before_train=1.923945 cos_to_last_merge=0.7630 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.763
[S5] round=83 local utility u=0.010339 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994772490903719, 'loss_val': 0.02255079467717258, 'psi': 0.9978120807232234}-{'f1_val': 0.9963338119635569, 'auprc': 0.9935683707316437, 'loss_val': 0.023294093793868938, 'psi': 0.9952276354707916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=83 head_norm_before_train=2.031719 cos_to_last_merge=0.8747 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=83 local utility u=0.000000 metrics={'f1_val': 0.7706641420460727, 'auprc': 0.9004254453198891, 'loss_val': 0.8092399923320946, 'psi': 0.8225686633555993}-{'f1_val': 0.7803320180924378, 'auprc': 0.9180328184939051, 'loss_val': 0.6583559232631572, 'psi': 0.8354123382530247}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=83 head_norm_before_train=1.871168 cos_to_last_merge=0.7666 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.767
[S7] round=83 local utility u=0.290017 metrics={'f1_val': 0.7695343904245604, 'auprc': 0.951361536535228, 'loss_val': 0.6254525446326489, 'psi': 0.8422652488688274}-{'f1_val': 0.6713340939126312, 'auprc': 0.93090357189495, 'loss_val': 0.5549103130756864, 'psi': 0.7751618851055587}
[S7] not sending this round → trigger blocked (psi=0.842)
[S8] START round=83 head_norm_before_train=2.220318 (no previous merge yet)
[S8] round=83 local utility u=1.000000 metrics={'f1_val': 0.9710408814440371, 'auprc': 0.9802906058033914, 'loss_val': 0.06531044960317271, 'psi': 0.9747407711877789}-{'f1_val': 0.7140170479737811, 'auprc': 0.9946992908566621, 'loss_val': 0.580106895946772, 'psi': 0.8262899451269334}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=83 head_norm_before_train=2.272439 cos_to_last_merge=0.9245 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=83 local utility u=0.001174 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9985020755034879, 'loss_val': 0.017868131094163322, 'psi': 0.9976436781230152}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986463929803652, 'loss_val': 0.018183727520173925, 'psi': 0.9974548642804809}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] sending update (kind=head size=1801 to 1 peers)
[S10] START round=83 head_norm_before_train=2.019999 cos_to_last_merge=0.9106 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.911
[S10] round=83 local utility u=0.001758 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9955771540733165, 'loss_val': 0.02954726654393871, 'psi': 0.9945031347741397}-{'f1_val': 0.9933489306849028, 'auprc': 0.9955483675849837, 'loss_val': 0.030347341695896358, 'psi': 0.9942287054449352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] START round=83 head_norm_before_train=2.371439 cos_to_last_merge=0.9286 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.929
[S11] round=83 local utility u=0.063679 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9930837412747648, 'loss_val': 0.020993140857735498, 'psi': 0.9949259813563531}-{'f1_val': 0.9814400812334457, 'auprc': 0.9942983660023225, 'loss_val': 0.06371049715318068, 'psi': 0.9865833951409964}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=83 head_norm_before_train=2.004709 (no previous merge yet)
[S13] round=83 local utility u=0.000000 metrics={'f1_val': 0.6320950803909569, 'auprc': 0.727517262144794, 'loss_val': 1.2334495043536466, 'psi': 0.6702639530924916}-{'f1_val': 0.7237445874349295, 'auprc': 0.7999383555278556, 'loss_val': 0.7993371098476708, 'psi': 0.7542220946721}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=83 head_norm_before_train=2.262576 cos_to_last_merge=0.9603 (last merge round=15)
[S14] round=83 local utility u=0.036891 metrics={'f1_val': 0.9360686471552662, 'auprc': 0.9555409679499883, 'loss_val': 0.19219921881301708, 'psi': 0.9438575754731551}-{'f1_val': 0.9322488600003207, 'auprc': 0.944674858951984, 'loss_val': 0.21046490698884743, 'psi': 0.9372192595809861}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=83 head_norm_before_train=2.406918 (no previous merge yet)
[S15] round=83 local utility u=0.000000 metrics={'f1_val': 0.953871728073497, 'auprc': 0.9973445950871314, 'loss_val': 0.08171315069635275, 'psi': 0.9712608748789506}-{'f1_val': 0.954819230695445, 'auprc': 0.9973465738734733, 'loss_val': 0.08106562539510524, 'psi': 0.9718301679666563}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=83 head_norm_before_train=2.088521 cos_to_last_merge=0.7707 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9732622693486395, 'auprc': 0.9904507117558592, 'loss_val': 0.08601817906297095, 'psi': 0.9801376463115273}-{'f1_val': 0.9918755575684484, 'auprc': 0.9989278796488824, 'loss_val': 0.03322305503458516, 'psi': 0.994696486400622}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.928991 cos_to_last_merge=0.8426 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.843
[S17] round=83 local utility u=0.132122 metrics={'f1_val': 0.9098759035906967, 'auprc': 0.9987305184185287, 'loss_val': 0.289961275744065, 'psi': 0.9454177495218294}-{'f1_val': 0.8855601543418374, 'auprc': 0.9887126604266328, 'loss_val': 0.37825785143448587, 'psi': 0.9268211567757555}
[S17] not sending this round → trigger blocked (psi=0.945)
[S2] START round=84 head_norm_before_train=2.097251 cos_to_last_merge=0.7546 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.6723461216463036, 'auprc': 0.6951663863664628, 'loss_val': 1.2659930298459647, 'psi': 0.6814742275343673}-{'f1_val': 0.7205386760351132, 'auprc': 0.7002353868020087, 'loss_val': 1.0651116129346554, 'psi': 0.7124173603418714}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=84 head_norm_before_train=2.546439 (no previous merge yet)
[S3] round=84 local utility u=0.000138 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.999546735065334, 'loss_val': 0.019154268880609577, 'psi': 0.9982749715980681}-{'f1_val': 0.9969583726029951, 'auprc': 0.9992677560125565, 'loss_val': 0.01578052622679733, 'psi': 0.9978821259668197}
[S3] not sending this round → trigger blocked (psi=0.998)
[S4] START round=84 head_norm_before_train=1.865613 cos_to_last_merge=0.8789 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.879
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9540947591701914, 'auprc': 0.9766219402052285, 'loss_val': 0.2884293814322511, 'psi': 0.9631056315842061}-{'f1_val': 0.9513009668702002, 'auprc': 0.9816086637341772, 'loss_val': 0.28458012105732317, 'psi': 0.963424045615791}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=1.930361 cos_to_last_merge=0.7619 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=84 local utility u=0.000149 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9996737425416757, 'loss_val': 0.02284216609264173, 'psi': 0.9978906781037449}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994772490903719, 'loss_val': 0.02255079467717258, 'psi': 0.9978120807232234}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=84 head_norm_before_train=2.040518 cos_to_last_merge=0.8733 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.873
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.769900116726935, 'auprc': 0.808230856243026, 'loss_val': 0.806523011169499, 'psi': 0.7852324125333714}-{'f1_val': 0.7706641420460727, 'auprc': 0.9004254453198891, 'loss_val': 0.8092399923320946, 'psi': 0.8225686633555993}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.881225 cos_to_last_merge=0.7660 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.766
[S7] round=84 local utility u=0.000000 metrics={'f1_val': 0.5575543338977883, 'auprc': 0.7767401701680733, 'loss_val': 1.325931746514712, 'psi': 0.6452286684059023}-{'f1_val': 0.7695343904245604, 'auprc': 0.951361536535228, 'loss_val': 0.6254525446326489, 'psi': 0.8422652488688274}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=84 head_norm_before_train=2.222917 (no previous merge yet)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9632799965952896, 'auprc': 0.9926417105575702, 'loss_val': 0.11546804513610381, 'psi': 0.9750246821802019}-{'f1_val': 0.9710408814440371, 'auprc': 0.9802906058033914, 'loss_val': 0.06531044960317271, 'psi': 0.9747407711877789}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=84 head_norm_before_train=2.275867 cos_to_last_merge=0.9240 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.924
[S9] round=84 local utility u=0.000000 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9985237471236496, 'loss_val': 0.018363969645391262, 'psi': 0.9975021510830776}-{'f1_val': 0.9970714132027002, 'auprc': 0.9985020755034879, 'loss_val': 0.017868131094163322, 'psi': 0.9976436781230152}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=84 head_norm_before_train=2.020559 cos_to_last_merge=0.9097 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.910
[S10] round=84 local utility u=0.000000 metrics={'f1_val': 0.9935679896985945, 'auprc': 0.9956046740354019, 'loss_val': 0.029658053773488385, 'psi': 0.9943826634333174}-{'f1_val': 0.9937871219080217, 'auprc': 0.9955771540733165, 'loss_val': 0.02954726654393871, 'psi': 0.9945031347741397}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=84 head_norm_before_train=2.374560 cos_to_last_merge=0.9283 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.995183546826345, 'loss_val': 0.030476610477015383, 'psi': 0.9957659035769852}-{'f1_val': 0.9961541414107454, 'auprc': 0.9930837412747648, 'loss_val': 0.020993140857735498, 'psi': 0.9949259813563531}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=84 head_norm_before_train=2.009289 (no previous merge yet)
[S13] round=84 local utility u=0.761813 metrics={'f1_val': 0.7523839487734145, 'auprc': 0.8806999500303453, 'loss_val': 0.891104711662764, 'psi': 0.8037103492761868}-{'f1_val': 0.6320950803909569, 'auprc': 0.727517262144794, 'loss_val': 1.2334495043536466, 'psi': 0.6702639530924916}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=84 head_norm_before_train=2.265558 cos_to_last_merge=0.9600 (last merge round=15)
[S14] round=84 local utility u=0.312918 metrics={'f1_val': 0.9913532756784128, 'auprc': 0.9988465973268588, 'loss_val': 0.027986938798539928, 'psi': 0.9943506043377912}-{'f1_val': 0.9360686471552662, 'auprc': 0.9555409679499883, 'loss_val': 0.19219921881301708, 'psi': 0.9438575754731551}
[S14] not sending this round → trigger blocked (psi=0.994)
[S15] START round=84 head_norm_before_train=2.411154 (no previous merge yet)
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9422519396866007, 'auprc': 0.9973228880608218, 'loss_val': 0.09379873117359544, 'psi': 0.9642803190362892}-{'f1_val': 0.953871728073497, 'auprc': 0.9973445950871314, 'loss_val': 0.08171315069635275, 'psi': 0.9712608748789506}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.093550 cos_to_last_merge=0.7706 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=84 local utility u=0.000000 metrics={'f1_val': 0.9424377114133068, 'auprc': 0.9887369434251783, 'loss_val': 0.27250010624597404, 'psi': 0.9609574042180554}-{'f1_val': 0.9732622693486395, 'auprc': 0.9904507117558592, 'loss_val': 0.08601817906297095, 'psi': 0.9801376463115273}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=84 head_norm_before_train=1.937891 cos_to_last_merge=0.8422 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.842
[S17] round=84 local utility u=0.000000 metrics={'f1_val': 0.8942788422324934, 'auprc': 0.9903340446685136, 'loss_val': 0.3532411227891912, 'psi': 0.9327009232069015}-{'f1_val': 0.9098759035906967, 'auprc': 0.9987305184185287, 'loss_val': 0.289961275744065, 'psi': 0.9454177495218294}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=85 head_norm_before_train=2.096326 cos_to_last_merge=0.7545 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.755
[S2] round=85 local utility u=0.246002 metrics={'f1_val': 0.7202148916955898, 'auprc': 0.6889532583994543, 'loss_val': 1.0425621929888267, 'psi': 0.7077102383771356}-{'f1_val': 0.6723461216463036, 'auprc': 0.6951663863664628, 'loss_val': 1.2659930298459647, 'psi': 0.6814742275343673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=85 head_norm_before_train=2.543300 (no previous merge yet)
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.9349425606302957, 'auprc': 0.9985899480495226, 'loss_val': 0.23996843740505727, 'psi': 0.9604015155979864}-{'f1_val': 0.9974271292865575, 'auprc': 0.999546735065334, 'loss_val': 0.019154268880609577, 'psi': 0.9982749715980681}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.868567 cos_to_last_merge=0.8784 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.9550567822072791, 'auprc': 0.966121816771927, 'loss_val': 0.29274493668340884, 'psi': 0.9594827960331382}-{'f1_val': 0.9540947591701914, 'auprc': 0.9766219402052285, 'loss_val': 0.2884293814322511, 'psi': 0.9631056315842061}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=1.931525 cos_to_last_merge=0.7620 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9957773032644178, 'loss_val': 0.023760294082631722, 'psi': 0.9961112084839012}-{'f1_val': 0.9967019684784577, 'auprc': 0.9996737425416757, 'loss_val': 0.02284216609264173, 'psi': 0.9978906781037449}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=2.049723 cos_to_last_merge=0.8723 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=85 local utility u=0.203772 metrics={'f1_val': 0.7617860746338102, 'auprc': 0.8907251755397823, 'loss_val': 0.5977779307683259, 'psi': 0.813361714996199}-{'f1_val': 0.769900116726935, 'auprc': 0.808230856243026, 'loss_val': 0.806523011169499, 'psi': 0.7852324125333714}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=85 head_norm_before_train=1.889382 cos_to_last_merge=0.7654 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.765
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.5564317254039313, 'auprc': 0.7695196213483881, 'loss_val': 1.3415145724583395, 'psi': 0.6416668837817141}-{'f1_val': 0.5575543338977883, 'auprc': 0.7767401701680733, 'loss_val': 1.325931746514712, 'psi': 0.6452286684059023}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=2.224398 (no previous merge yet)
[S8] round=85 local utility u=0.133367 metrics={'f1_val': 0.9906496251316108, 'auprc': 0.9989391649768701, 'loss_val': 0.0318435430293067, 'psi': 0.9939654410697145}-{'f1_val': 0.9632799965952896, 'auprc': 0.9926417105575702, 'loss_val': 0.11546804513610381, 'psi': 0.9750246821802019}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] sending update (kind=head size=1799 to 1 peers)
[S9] START round=85 head_norm_before_train=2.281896 cos_to_last_merge=0.9234 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=85 local utility u=0.001220 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985266605157856, 'loss_val': 0.01762330441190311, 'psi': 0.9976724117136}-{'f1_val': 0.9968210870560296, 'auprc': 0.9985237471236496, 'loss_val': 0.018363969645391262, 'psi': 0.9975021510830776}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=85 head_norm_before_train=2.023792 cos_to_last_merge=0.9092 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=85 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9956020027661756, 'loss_val': 0.029781604698854002, 'psi': 0.994250159517412}-{'f1_val': 0.9935679896985945, 'auprc': 0.9956046740354019, 'loss_val': 0.029658053773488385, 'psi': 0.9943826634333174}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=85 head_norm_before_train=2.378697 cos_to_last_merge=0.9279 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.928
[S11] round=85 local utility u=0.000000 metrics={'f1_val': 0.9385301980769163, 'auprc': 0.9937529166282499, 'loss_val': 0.12014470059638577, 'psi': 0.9606192854974497}-{'f1_val': 0.9961541414107454, 'auprc': 0.995183546826345, 'loss_val': 0.030476610477015383, 'psi': 0.9957659035769852}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=85 head_norm_before_train=2.012167 (no previous merge yet)
[S13] round=85 local utility u=0.000000 metrics={'f1_val': 0.6807760207486515, 'auprc': 0.7632782956354166, 'loss_val': 0.9630589090975331, 'psi': 0.7137769307033576}-{'f1_val': 0.7523839487734145, 'auprc': 0.8806999500303453, 'loss_val': 0.891104711662764, 'psi': 0.8037103492761868}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=85 head_norm_before_train=2.269952 cos_to_last_merge=0.9597 (last merge round=15)
[S14] round=85 local utility u=0.026869 metrics={'f1_val': 0.9984539900362299, 'auprc': 0.9988473256911481, 'loss_val': 0.016855405744211897, 'psi': 0.9986113242981972}-{'f1_val': 0.9913532756784128, 'auprc': 0.9988465973268588, 'loss_val': 0.027986938798539928, 'psi': 0.9943506043377912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=85 head_norm_before_train=2.415264 (no previous merge yet)
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.9348943582185678, 'auprc': 0.9973013242977875, 'loss_val': 0.10706200630016492, 'psi': 0.9598571446502557}-{'f1_val': 0.9422519396866007, 'auprc': 0.9973228880608218, 'loss_val': 0.09379873117359544, 'psi': 0.9642803190362892}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.099710 cos_to_last_merge=0.7706 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.771
[S16] round=85 local utility u=0.283136 metrics={'f1_val': 0.9923641593969502, 'auprc': 0.9969983898814853, 'loss_val': 0.0305720644160419, 'psi': 0.9942178515907643}-{'f1_val': 0.9424377114133068, 'auprc': 0.9887369434251783, 'loss_val': 0.27250010624597404, 'psi': 0.9609574042180554}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=85 head_norm_before_train=1.942293 cos_to_last_merge=0.8414 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.841
[S17] round=85 local utility u=0.000000 metrics={'f1_val': 0.8369897169403624, 'auprc': 0.9664818525755678, 'loss_val': 0.5322147016887746, 'psi': 0.8887865711944445}-{'f1_val': 0.8942788422324934, 'auprc': 0.9903340446685136, 'loss_val': 0.3532411227891912, 'psi': 0.9327009232069015}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=86 head_norm_before_train=2.096639 cos_to_last_merge=0.7543 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=86 local utility u=0.000000 metrics={'f1_val': 0.6988687378995498, 'auprc': 0.6914417883244532, 'loss_val': 1.0904505270536, 'psi': 0.6958979580695112}-{'f1_val': 0.7202148916955898, 'auprc': 0.6889532583994543, 'loss_val': 1.0425621929888267, 'psi': 0.7077102383771356}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=86 head_norm_before_train=2.545902 (no previous merge yet)
[S3] round=86 local utility u=0.297606 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9993291817728025, 'loss_val': 0.020100105569364812, 'psi': 0.9980098050109889}-{'f1_val': 0.9349425606302957, 'auprc': 0.9985899480495226, 'loss_val': 0.23996843740505727, 'psi': 0.9604015155979864}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=86 head_norm_before_train=1.870856 cos_to_last_merge=0.8777 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.878
[S4] round=86 local utility u=0.008357 metrics={'f1_val': 0.9580071628634571, 'auprc': 0.9655675387845932, 'loss_val': 0.2920697289005307, 'psi': 0.9610313132319116}-{'f1_val': 0.9550567822072791, 'auprc': 0.966121816771927, 'loss_val': 0.29274493668340884, 'psi': 0.9594827960331382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S4] sending update (kind=head size=1807 to 1 peers)
[S5] START round=86 head_norm_before_train=1.936517 cos_to_last_merge=0.7617 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.762
[S5] round=86 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9932302368437405, 'loss_val': 0.022350859011761193, 'psi': 0.9953132758245709}-{'f1_val': 0.9963338119635569, 'auprc': 0.9957773032644178, 'loss_val': 0.023760294082631722, 'psi': 0.9961112084839012}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=86 head_norm_before_train=2.054338 cos_to_last_merge=0.8722 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=86 local utility u=0.000000 metrics={'f1_val': 0.604456419612103, 'auprc': 0.6882715270183568, 'loss_val': 1.2031020889251267, 'psi': 0.6379824625746044}-{'f1_val': 0.7617860746338102, 'auprc': 0.8907251755397823, 'loss_val': 0.5977779307683259, 'psi': 0.813361714996199}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=86 head_norm_before_train=1.896270 cos_to_last_merge=0.7648 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.765
[S7] round=86 local utility u=1.000000 metrics={'f1_val': 0.7611765440668573, 'auprc': 0.9606790395888438, 'loss_val': 0.5884826509995462, 'psi': 0.8409775422756519}-{'f1_val': 0.5564317254039313, 'auprc': 0.7695196213483881, 'loss_val': 1.3415145724583395, 'psi': 0.6416668837817141}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=86 head_norm_before_train=2.226633 (no previous merge yet)
[S8] round=86 local utility u=0.010314 metrics={'f1_val': 0.9929590204801939, 'auprc': 0.9989827910721354, 'loss_val': 0.025203099332981434, 'psi': 0.9953685287169706}-{'f1_val': 0.9906496251316108, 'auprc': 0.9989391649768701, 'loss_val': 0.0318435430293067, 'psi': 0.9939654410697145}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=86 head_norm_before_train=2.286345 cos_to_last_merge=0.9228 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.923
[S9] round=86 local utility u=0.000078 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.998535148452345, 'loss_val': 0.017493315763205713, 'psi': 0.9976758068882237}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985266605157856, 'loss_val': 0.01762330441190311, 'psi': 0.9976724117136}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=86 head_norm_before_train=2.028362 cos_to_last_merge=0.9088 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.909
[S10] round=86 local utility u=0.001161 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9950558751556906, 'loss_val': 0.028449888446112105, 'psi': 0.9942946232070893}-{'f1_val': 0.9933489306849028, 'auprc': 0.9956020027661756, 'loss_val': 0.029781604698854002, 'psi': 0.994250159517412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=86 head_norm_before_train=2.383376 cos_to_last_merge=0.9274 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=86 local utility u=0.206969 metrics={'f1_val': 0.9957413055075058, 'auprc': 0.9952960427596094, 'loss_val': 0.05410276379115084, 'psi': 0.9955632004083472}-{'f1_val': 0.9385301980769163, 'auprc': 0.9937529166282499, 'loss_val': 0.12014470059638577, 'psi': 0.9606192854974497}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=86 head_norm_before_train=2.011080 (no previous merge yet)
[S13] round=86 local utility u=0.666135 metrics={'f1_val': 0.8038763568192228, 'auprc': 0.8447652066955482, 'loss_val': 0.6138507455268558, 'psi': 0.8202318967697529}-{'f1_val': 0.6807760207486515, 'auprc': 0.7632782956354166, 'loss_val': 0.9630589090975331, 'psi': 0.7137769307033576}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S14] START round=86 head_norm_before_train=2.275995 cos_to_last_merge=0.9594 (last merge round=15)
[S14] round=86 local utility u=0.000000 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.9988538613285848, 'loss_val': 0.01616829472261296, 'psi': 0.9983803092729662}-{'f1_val': 0.9984539900362299, 'auprc': 0.9988473256911481, 'loss_val': 0.016855405744211897, 'psi': 0.9986113242981972}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=86 head_norm_before_train=2.419386 (no previous merge yet)
[S15] round=86 local utility u=0.000000 metrics={'f1_val': 0.9297709853699931, 'auprc': 0.9972807419364824, 'loss_val': 0.11787862865922319, 'psi': 0.9567748879965889}-{'f1_val': 0.9348943582185678, 'auprc': 0.9973013242977875, 'loss_val': 0.10706200630016492, 'psi': 0.9598571446502557}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=86 head_norm_before_train=2.102333 cos_to_last_merge=0.7699 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.770
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9919458604863408, 'auprc': 0.9984028520537324, 'loss_val': 0.03242834933607808, 'psi': 0.9945286571132974}-{'f1_val': 0.9923641593969502, 'auprc': 0.9969983898814853, 'loss_val': 0.0305720644160419, 'psi': 0.9942178515907643}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.945828 cos_to_last_merge=0.8398 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.840
[S17] round=86 local utility u=0.472269 metrics={'f1_val': 0.9308487414576607, 'auprc': 0.9887021431353132, 'loss_val': 0.21749093800784822, 'psi': 0.9539901021287217}-{'f1_val': 0.8369897169403624, 'auprc': 0.9664818525755678, 'loss_val': 0.5322147016887746, 'psi': 0.8887865711944445}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] sending update (kind=head size=1804 to 1 peers)
[S2] START round=87 head_norm_before_train=2.100693 cos_to_last_merge=0.7540 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=87 local utility u=0.070734 metrics={'f1_val': 0.7170502015262441, 'auprc': 0.6923711457511488, 'loss_val': 1.0608592054779973, 'psi': 0.707178579216206}-{'f1_val': 0.6988687378995498, 'auprc': 0.6914417883244532, 'loss_val': 1.0904505270536, 'psi': 0.6958979580695112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=87 head_norm_before_train=2.550297 (no previous merge yet)
[S3] round=87 local utility u=0.000000 metrics={'f1_val': 0.8680847097637723, 'auprc': 0.9927040069535494, 'loss_val': 0.3372610225296197, 'psi': 0.9179324286396832}-{'f1_val': 0.9971302205031132, 'auprc': 0.9993291817728025, 'loss_val': 0.020100105569364812, 'psi': 0.9980098050109889}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=87 head_norm_before_train=1.873271 cos_to_last_merge=0.8770 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.877
[S4] round=87 local utility u=0.000000 metrics={'f1_val': 0.9498181199293679, 'auprc': 0.9673934847223692, 'loss_val': 0.2983929576850498, 'psi': 0.9568482658465685}-{'f1_val': 0.9580071628634571, 'auprc': 0.9655675387845932, 'loss_val': 0.2920697289005307, 'psi': 0.9610313132319116}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=87 head_norm_before_train=1.941684 cos_to_last_merge=0.7609 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.761
[S5] round=87 local utility u=0.006736 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.999615117106004, 'loss_val': 0.02582424935743931, 'psi': 0.9976463340205357}-{'f1_val': 0.9967019684784577, 'auprc': 0.9932302368437405, 'loss_val': 0.022350859011761193, 'psi': 0.9953132758245709}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] sending update (kind=head size=1802 to 1 peers)
[S6] START round=87 head_norm_before_train=2.059182 cos_to_last_merge=0.8718 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.872
[S6] round=87 local utility u=1.000000 metrics={'f1_val': 0.7754719424849843, 'auprc': 0.9425195902604615, 'loss_val': 0.44504818265779905, 'psi': 0.8422910015951752}-{'f1_val': 0.604456419612103, 'auprc': 0.6882715270183568, 'loss_val': 1.2031020889251267, 'psi': 0.6379824625746044}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=87 head_norm_before_train=1.905822 cos_to_last_merge=0.7640 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.764
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.7295272034720413, 'auprc': 0.952673192064479, 'loss_val': 0.5866948204612419, 'psi': 0.8187855989090164}-{'f1_val': 0.7611765440668573, 'auprc': 0.9606790395888438, 'loss_val': 0.5884826509995462, 'psi': 0.8409775422756519}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=2.230741 (no previous merge yet)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.9937604981237848, 'auprc': 0.9988211008226004, 'loss_val': 0.030652643632811682, 'psi': 0.995784739203311}-{'f1_val': 0.9929590204801939, 'auprc': 0.9989827910721354, 'loss_val': 0.025203099332981434, 'psi': 0.9953685287169706}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=87 head_norm_before_train=2.290645 cos_to_last_merge=0.9222 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.922
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9897262816474692, 'auprc': 0.9985336018979942, 'loss_val': 0.033651501657498, 'psi': 0.9932492097476793}-{'f1_val': 0.9971029125121428, 'auprc': 0.998535148452345, 'loss_val': 0.017493315763205713, 'psi': 0.9976758068882237}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=2.030576 cos_to_last_merge=0.9082 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=87 local utility u=0.002091 metrics={'f1_val': 0.9944449605296568, 'auprc': 0.9950494826743707, 'loss_val': 0.028196345795169227, 'psi': 0.9946867693875423}-{'f1_val': 0.9937871219080217, 'auprc': 0.9950558751556906, 'loss_val': 0.028449888446112105, 'psi': 0.9942946232070893}
[S10] not sending this round → trigger blocked (psi=0.995)
[S11] START round=87 head_norm_before_train=2.388013 cos_to_last_merge=0.9269 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.927
[S11] round=87 local utility u=0.014499 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9953602899274445, 'loss_val': 0.027775293505904346, 'psi': 0.9958366008174251}-{'f1_val': 0.9957413055075058, 'auprc': 0.9952960427596094, 'loss_val': 0.05410276379115084, 'psi': 0.9955632004083472}
[S11] not sending this round → trigger blocked (psi=0.996)
[S13] START round=87 head_norm_before_train=2.013390 (no previous merge yet)
[S13] round=87 local utility u=0.000000 metrics={'f1_val': 0.7206550327258592, 'auprc': 0.7256292373807486, 'loss_val': 1.1421627409603654, 'psi': 0.722644714587815}-{'f1_val': 0.8038763568192228, 'auprc': 0.8447652066955482, 'loss_val': 0.6138507455268558, 'psi': 0.8202318967697529}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=87 head_norm_before_train=2.282602 cos_to_last_merge=0.9592 (last merge round=15)
[S14] round=87 local utility u=0.001129 metrics={'f1_val': 0.9984758593419994, 'auprc': 0.9988550016383774, 'loss_val': 0.01638113226658553, 'psi': 0.9986275162605506}-{'f1_val': 0.9980646079025537, 'auprc': 0.9988538613285848, 'loss_val': 0.01616829472261296, 'psi': 0.9983803092729662}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=87 head_norm_before_train=2.423455 (no previous merge yet)
[S15] round=87 local utility u=0.000000 metrics={'f1_val': 0.9271731212913406, 'auprc': 0.9972685285944152, 'loss_val': 0.12245660332081972, 'psi': 0.9552112842125704}-{'f1_val': 0.9297709853699931, 'auprc': 0.9972807419364824, 'loss_val': 0.11787862865922319, 'psi': 0.9567748879965889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=87 head_norm_before_train=2.103169 cos_to_last_merge=0.7689 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.769
[S16] round=87 local utility u=0.000000 metrics={'f1_val': 0.9555385534252111, 'auprc': 0.991715638934309, 'loss_val': 0.11432050843060272, 'psi': 0.9700093876288503}-{'f1_val': 0.9919458604863408, 'auprc': 0.9984028520537324, 'loss_val': 0.03242834933607808, 'psi': 0.9945286571132974}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=87 head_norm_before_train=1.952635 cos_to_last_merge=0.8385 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.839
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.8466433235184017, 'auprc': 0.9706974790132334, 'loss_val': 0.6593013351331072, 'psi': 0.8962649857163343}-{'f1_val': 0.9308487414576607, 'auprc': 0.9887021431353132, 'loss_val': 0.21749093800784822, 'psi': 0.9539901021287217}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=88 head_norm_before_train=2.102762 cos_to_last_merge=0.7536 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.754
[S2] round=88 local utility u=0.033123 metrics={'f1_val': 0.7205182898821153, 'auprc': 0.697760399128615, 'loss_val': 1.0315898913575308, 'psi': 0.7114151335807152}-{'f1_val': 0.7170502015262441, 'auprc': 0.6923711457511488, 'loss_val': 1.0608592054779973, 'psi': 0.707178579216206}
[S2] not sending this round → trigger blocked (psi=0.711)
[S3] START round=88 head_norm_before_train=2.554270 (no previous merge yet)
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.8095715594770116, 'auprc': 0.9924487005102998, 'loss_val': 0.4825818135125403, 'psi': 0.8827224158903269}-{'f1_val': 0.8680847097637723, 'auprc': 0.9927040069535494, 'loss_val': 0.3372610225296197, 'psi': 0.9179324286396832}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.879403 cos_to_last_merge=0.8765 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=88 local utility u=0.000000 metrics={'f1_val': 0.9455069036272077, 'auprc': 0.9700770263150607, 'loss_val': 0.3025030848557664, 'psi': 0.9553349527023489}-{'f1_val': 0.9498181199293679, 'auprc': 0.9673934847223692, 'loss_val': 0.2983929576850498, 'psi': 0.9568482658465685}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=88 head_norm_before_train=1.944930 cos_to_last_merge=0.7604 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.760
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9991214473769685, 'loss_val': 0.02629217542039451, 'psi': 0.9974488661289215}-{'f1_val': 0.9963338119635569, 'auprc': 0.999615117106004, 'loss_val': 0.02582424935743931, 'psi': 0.9976463340205357}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=2.063822 cos_to_last_merge=0.8714 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=88 local utility u=0.000000 metrics={'f1_val': 0.7363943664325663, 'auprc': 0.9351423179981637, 'loss_val': 0.7915567058167099, 'psi': 0.8158935470588053}-{'f1_val': 0.7754719424849843, 'auprc': 0.9425195902604615, 'loss_val': 0.44504818265779905, 'psi': 0.8422910015951752}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=88 head_norm_before_train=1.919349 cos_to_last_merge=0.7620 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.762
[S7] round=88 local utility u=0.143538 metrics={'f1_val': 0.8023265115805251, 'auprc': 0.928150332793505, 'loss_val': 0.6628470209094174, 'psi': 0.852656040065717}-{'f1_val': 0.7295272034720413, 'auprc': 0.952673192064479, 'loss_val': 0.5866948204612419, 'psi': 0.8187855989090164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=88 head_norm_before_train=2.234754 (no previous merge yet)
[S8] round=88 local utility u=0.000000 metrics={'f1_val': 0.9622133128770308, 'auprc': 0.9892258198200979, 'loss_val': 0.08618632489585275, 'psi': 0.9730183156542578}-{'f1_val': 0.9937604981237848, 'auprc': 0.9988211008226004, 'loss_val': 0.030652643632811682, 'psi': 0.995784739203311}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=88 head_norm_before_train=2.294149 cos_to_last_merge=0.9217 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.922
[S9] round=88 local utility u=0.030679 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9985920995099677, 'loss_val': 0.016728023572239372, 'psi': 0.9976985873112728}-{'f1_val': 0.9897262816474692, 'auprc': 0.9985336018979942, 'loss_val': 0.033651501657498, 'psi': 0.9932492097476793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] sending update (kind=head size=1803 to 1 peers)
[S10] START round=88 head_norm_before_train=2.033540 cos_to_last_merge=0.9076 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.908
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9952209365415655, 'loss_val': 0.02919401100627765, 'psi': 0.9943606477614393}-{'f1_val': 0.9944449605296568, 'auprc': 0.9950494826743707, 'loss_val': 0.028196345795169227, 'psi': 0.9946867693875423}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=88 head_norm_before_train=2.392799 cos_to_last_merge=0.9264 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=88 local utility u=0.002197 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9950775274382047, 'loss_val': 0.022532042518501848, 'psi': 0.9957234958217291}-{'f1_val': 0.9961541414107454, 'auprc': 0.9953602899274445, 'loss_val': 0.027775293505904346, 'psi': 0.9958366008174251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] START round=88 head_norm_before_train=2.014682 (no previous merge yet)
[S13] round=88 local utility u=0.028323 metrics={'f1_val': 0.7180769239376152, 'auprc': 0.7156401451697402, 'loss_val': 1.0400803078865575, 'psi': 0.7171022124304651}-{'f1_val': 0.7206550327258592, 'auprc': 0.7256292373807486, 'loss_val': 1.1421627409603654, 'psi': 0.722644714587815}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] sending update (kind=head size=1799 to 1 peers)
[S14] START round=88 head_norm_before_train=2.288622 cos_to_last_merge=0.9589 (last merge round=15)
[S14] round=88 local utility u=0.000000 metrics={'f1_val': 0.9980646079025537, 'auprc': 0.998855511430117, 'loss_val': 0.01531061203489941, 'psi': 0.998380969313579}-{'f1_val': 0.9984758593419994, 'auprc': 0.9988550016383774, 'loss_val': 0.01638113226658553, 'psi': 0.9986275162605506}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=88 head_norm_before_train=2.427459 (no previous merge yet)
[S15] round=88 local utility u=0.018909 metrics={'f1_val': 0.9318317502420822, 'auprc': 0.9972934892843985, 'loss_val': 0.11266577318153517, 'psi': 0.9580164458590088}-{'f1_val': 0.9271731212913406, 'auprc': 0.9972685285944152, 'loss_val': 0.12245660332081972, 'psi': 0.9552112842125704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=88 head_norm_before_train=2.106190 cos_to_last_merge=0.7685 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.8609890048455672, 'auprc': 0.8999563312620391, 'loss_val': 1.0303187647160472, 'psi': 0.8765759354121558}-{'f1_val': 0.9555385534252111, 'auprc': 0.991715638934309, 'loss_val': 0.11432050843060272, 'psi': 0.9700093876288503}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=1.957864 cos_to_last_merge=0.8377 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.838
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.7826193656122464, 'auprc': 0.9396329494179642, 'loss_val': 1.0365092618405516, 'psi': 0.8454247991345335}-{'f1_val': 0.8466433235184017, 'auprc': 0.9706974790132334, 'loss_val': 0.6593013351331072, 'psi': 0.8962649857163343}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=89 head_norm_before_train=2.104481 cos_to_last_merge=0.7534 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7195189183495809, 'auprc': 0.6968770131095284, 'loss_val': 1.036319181730785, 'psi': 0.71046215625356}-{'f1_val': 0.7205182898821153, 'auprc': 0.697760399128615, 'loss_val': 1.0315898913575308, 'psi': 0.7114151335807152}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=89 head_norm_before_train=2.559904 (no previous merge yet)
[S3] round=89 local utility u=0.671113 metrics={'f1_val': 0.9651428193912157, 'auprc': 0.9992683721014967, 'loss_val': 0.0942425078892475, 'psi': 0.9787930404753281}-{'f1_val': 0.8095715594770116, 'auprc': 0.9924487005102998, 'loss_val': 0.4825818135125403, 'psi': 0.8827224158903269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=89 head_norm_before_train=1.874065 cos_to_last_merge=0.8762 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=89 local utility u=0.008911 metrics={'f1_val': 0.9456565730349333, 'auprc': 0.9743772695210831, 'loss_val': 0.2984794741891809, 'psi': 0.9571448516293932}-{'f1_val': 0.9455069036272077, 'auprc': 0.9700770263150607, 'loss_val': 0.3025030848557664, 'psi': 0.9553349527023489}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=89 head_norm_before_train=1.950852 cos_to_last_merge=0.7593 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.759
[S5] round=89 local utility u=0.000076 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9995634723479416, 'loss_val': 0.0274666702472847, 'psi': 0.9976256761173108}-{'f1_val': 0.9963338119635569, 'auprc': 0.9991214473769685, 'loss_val': 0.02629217542039451, 'psi': 0.9974488661289215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=89 head_norm_before_train=2.068285 cos_to_last_merge=0.8709 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.871
[S6] round=89 local utility u=0.613391 metrics={'f1_val': 0.846918531573182, 'auprc': 0.9529882831773658, 'loss_val': 0.28145847270023644, 'psi': 0.8893464322148555}-{'f1_val': 0.7363943664325663, 'auprc': 0.9351423179981637, 'loss_val': 0.7915567058167099, 'psi': 0.8158935470588053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=89 head_norm_before_train=1.931150 cos_to_last_merge=0.7606 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.761
[S7] round=89 local utility u=0.000000 metrics={'f1_val': 0.729038521804806, 'auprc': 0.8416611460397212, 'loss_val': 0.8916547705459159, 'psi': 0.774087571498772}-{'f1_val': 0.8023265115805251, 'auprc': 0.928150332793505, 'loss_val': 0.6628470209094174, 'psi': 0.852656040065717}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=89 head_norm_before_train=2.236925 (no previous merge yet)
[S8] round=89 local utility u=0.126039 metrics={'f1_val': 0.9917238902386754, 'auprc': 0.9957911708394696, 'loss_val': 0.03086694540393895, 'psi': 0.993350802478993}-{'f1_val': 0.9622133128770308, 'auprc': 0.9892258198200979, 'loss_val': 0.08618632489585275, 'psi': 0.9730183156542578}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S9] START round=89 head_norm_before_train=2.298206 cos_to_last_merge=0.9214 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9980868792119091, 'loss_val': 0.021966128774263727, 'psi': 0.9972310587730985}-{'f1_val': 0.9971029125121428, 'auprc': 0.9985920995099677, 'loss_val': 0.016728023572239372, 'psi': 0.9976985873112728}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=2.038039 cos_to_last_merge=0.9072 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=89 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9956734854873344, 'loss_val': 0.030704563015577273, 'psi': 0.9942787526058755}-{'f1_val': 0.9937871219080217, 'auprc': 0.9952209365415655, 'loss_val': 0.02919401100627765, 'psi': 0.9943606477614393}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=89 head_norm_before_train=2.395458 cos_to_last_merge=0.9263 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=89 local utility u=0.000000 metrics={'f1_val': 0.9661929227371439, 'auprc': 0.9944496328825619, 'loss_val': 0.0981905416422016, 'psi': 0.9774956067953111}-{'f1_val': 0.9961541414107454, 'auprc': 0.9950775274382047, 'loss_val': 0.022532042518501848, 'psi': 0.9957234958217291}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=89 head_norm_before_train=2.016102 (no previous merge yet)
[S13] round=89 local utility u=0.393942 metrics={'f1_val': 0.7730646004300168, 'auprc': 0.7686308007161298, 'loss_val': 0.7410934042627477, 'psi': 0.7712910805444619}-{'f1_val': 0.7180769239376152, 'auprc': 0.7156401451697402, 'loss_val': 1.0400803078865575, 'psi': 0.7171022124304651}
[S13] not sending this round → trigger blocked (psi=0.771)
[S14] START round=89 head_norm_before_train=2.294742 cos_to_last_merge=0.9587 (last merge round=15)
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9312182960980281, 'auprc': 0.9280628231183708, 'loss_val': 0.23595157569415579, 'psi': 0.9299561069061653}-{'f1_val': 0.9980646079025537, 'auprc': 0.998855511430117, 'loss_val': 0.01531061203489941, 'psi': 0.998380969313579}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.431464 (no previous merge yet)
[S15] round=89 local utility u=0.017218 metrics={'f1_val': 0.9364130754188567, 'auprc': 0.9973078089176456, 'loss_val': 0.1057613179339961, 'psi': 0.9607709688183722}-{'f1_val': 0.9318317502420822, 'auprc': 0.9972934892843985, 'loss_val': 0.11266577318153517, 'psi': 0.9580164458590088}
[S15] not sending this round → trigger blocked (psi=0.961)
[S16] START round=89 head_norm_before_train=2.107743 cos_to_last_merge=0.7681 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=89 local utility u=1.000000 metrics={'f1_val': 0.9926584975785566, 'auprc': 0.9957930264263828, 'loss_val': 0.02861285458307153, 'psi': 0.9939123091176871}-{'f1_val': 0.8609890048455672, 'auprc': 0.8999563312620391, 'loss_val': 1.0303187647160472, 'psi': 0.8765759354121558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=89 head_norm_before_train=1.961331 cos_to_last_merge=0.8365 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=89 local utility u=0.554492 metrics={'f1_val': 0.879722324475146, 'auprc': 0.9832328115116812, 'loss_val': 0.6409421489826568, 'psi': 0.9211265192897601}-{'f1_val': 0.7826193656122464, 'auprc': 0.9396329494179642, 'loss_val': 1.0365092618405516, 'psi': 0.8454247991345335}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=90 head_norm_before_train=2.110064 cos_to_last_merge=0.7530 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=90 local utility u=0.003901 metrics={'f1_val': 0.7195189183495809, 'auprc': 0.7002018536685852, 'loss_val': 1.038491406323519, 'psi': 0.7117920924771827}-{'f1_val': 0.7195189183495809, 'auprc': 0.6968770131095284, 'loss_val': 1.036319181730785, 'psi': 0.71046215625356}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=90 head_norm_before_train=2.566688 (no previous merge yet)
[S3] round=90 local utility u=0.000000 metrics={'f1_val': 0.8915674112064894, 'auprc': 0.9976698723979213, 'loss_val': 0.24504907522751884, 'psi': 0.9340083956830622}-{'f1_val': 0.9651428193912157, 'auprc': 0.9992683721014967, 'loss_val': 0.0942425078892475, 'psi': 0.9787930404753281}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=90 head_norm_before_train=1.871103 cos_to_last_merge=0.8759 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=90 local utility u=0.043042 metrics={'f1_val': 0.9559372335387121, 'auprc': 0.977944874661696, 'loss_val': 0.2847818890682612, 'psi': 0.9647402899879056}-{'f1_val': 0.9456565730349333, 'auprc': 0.9743772695210831, 'loss_val': 0.2984794741891809, 'psi': 0.9571448516293932}
[S4] not sending this round → trigger blocked (psi=0.965)
[S5] START round=90 head_norm_before_train=1.957548 cos_to_last_merge=0.7578 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.758
[S5] round=90 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9934463728225785, 'loss_val': 0.02524118331627736, 'psi': 0.9951788363071654}-{'f1_val': 0.9963338119635569, 'auprc': 0.9995634723479416, 'loss_val': 0.0274666702472847, 'psi': 0.9976256761173108}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=90 head_norm_before_train=2.074027 cos_to_last_merge=0.8701 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.870
[S6] round=90 local utility u=0.000000 metrics={'f1_val': 0.8158810780075142, 'auprc': 0.9351225438018638, 'loss_val': 0.5727133701500462, 'psi': 0.863577664325254}-{'f1_val': 0.846918531573182, 'auprc': 0.9529882831773658, 'loss_val': 0.28145847270023644, 'psi': 0.8893464322148555}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=90 head_norm_before_train=1.947207 cos_to_last_merge=0.7595 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.759
[S7] round=90 local utility u=0.114329 metrics={'f1_val': 0.7317361563493041, 'auprc': 0.8926464668047334, 'loss_val': 0.8321378260546637, 'psi': 0.7961002805314759}-{'f1_val': 0.729038521804806, 'auprc': 0.8416611460397212, 'loss_val': 0.8916547705459159, 'psi': 0.774087571498772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=90 head_norm_before_train=2.239089 (no previous merge yet)
[S8] round=90 local utility u=0.013158 metrics={'f1_val': 0.9935600276662899, 'auprc': 0.999053315746115, 'loss_val': 0.025353947601391726, 'psi': 0.9957573428982199}-{'f1_val': 0.9917238902386754, 'auprc': 0.9957911708394696, 'loss_val': 0.03086694540393895, 'psi': 0.993350802478993}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=90 head_norm_before_train=2.299404 cos_to_last_merge=0.9212 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=90 local utility u=0.004972 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986429000529091, 'loss_val': 0.016344161574026995, 'psi': 0.9977189075284494}-{'f1_val': 0.9966605118138915, 'auprc': 0.9980868792119091, 'loss_val': 0.021966128774263727, 'psi': 0.9972310587730985}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=90 head_norm_before_train=2.043308 cos_to_last_merge=0.9069 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9957000075203095, 'loss_val': 0.031241522039969088, 'psi': 0.9942893614190655}-{'f1_val': 0.9933489306849028, 'auprc': 0.9956734854873344, 'loss_val': 0.030704563015577273, 'psi': 0.9942787526058755}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=90 head_norm_before_train=2.398297 cos_to_last_merge=0.9261 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=90 local utility u=0.127151 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.993565088172866, 'loss_val': 0.021001326478696285, 'psi': 0.9951185201155937}-{'f1_val': 0.9661929227371439, 'auprc': 0.9944496328825619, 'loss_val': 0.0981905416422016, 'psi': 0.9774956067953111}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] START round=90 head_norm_before_train=2.018506 (no previous merge yet)
[S13] round=90 local utility u=0.000000 metrics={'f1_val': 0.7417710445733705, 'auprc': 0.7149989135050268, 'loss_val': 1.1640306539074379, 'psi': 0.731062192146033}-{'f1_val': 0.7730646004300168, 'auprc': 0.7686308007161298, 'loss_val': 0.7410934042627477, 'psi': 0.7712910805444619}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=90 head_norm_before_train=2.296634 cos_to_last_merge=0.9585 (last merge round=15)
[S14] round=90 local utility u=0.060937 metrics={'f1_val': 0.9330055469485266, 'auprc': 0.9602002644422486, 'loss_val': 0.22121362128342065, 'psi': 0.9438834339460154}-{'f1_val': 0.9312182960980281, 'auprc': 0.9280628231183708, 'loss_val': 0.23595157569415579, 'psi': 0.9299561069061653}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=90 head_norm_before_train=2.435337 (no previous merge yet)
[S15] round=90 local utility u=0.010685 metrics={'f1_val': 0.9387714626268884, 'auprc': 0.997324181713533, 'loss_val': 0.0985900462770458, 'psi': 0.9621925502615463}-{'f1_val': 0.9364130754188567, 'auprc': 0.9973078089176456, 'loss_val': 0.1057613179339961, 'psi': 0.9607709688183722}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=90 head_norm_before_train=2.109478 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9807977401892058, 'auprc': 0.9954351882925898, 'loss_val': 0.0812953365070171, 'psi': 0.9866527194305594}-{'f1_val': 0.9926584975785566, 'auprc': 0.9957930264263828, 'loss_val': 0.02861285458307153, 'psi': 0.9939123091176871}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=1.967215 cos_to_last_merge=0.8356 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.836
[S17] round=90 local utility u=0.000000 metrics={'f1_val': 0.8702909329902204, 'auprc': 0.9775215626744138, 'loss_val': 0.7278625216377634, 'psi': 0.9131831848638977}-{'f1_val': 0.879722324475146, 'auprc': 0.9832328115116812, 'loss_val': 0.6409421489826568, 'psi': 0.9211265192897601}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=91 head_norm_before_train=2.115802 cos_to_last_merge=0.7526 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.753
[S2] round=91 local utility u=0.052461 metrics={'f1_val': 0.7198609991501991, 'auprc': 0.7260774077928112, 'loss_val': 1.013249385432508, 'psi': 0.722347562607244}-{'f1_val': 0.7195189183495809, 'auprc': 0.7002018536685852, 'loss_val': 1.038491406323519, 'psi': 0.7117920924771827}
[S2] not sending this round → trigger blocked (psi=0.722)
[S3] START round=91 head_norm_before_train=2.571848 (no previous merge yet)
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.8232538820418038, 'auprc': 0.9789908010307258, 'loss_val': 0.4957966077151172, 'psi': 0.8855486496373726}-{'f1_val': 0.8915674112064894, 'auprc': 0.9976698723979213, 'loss_val': 0.24504907522751884, 'psi': 0.9340083956830622}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.871223 cos_to_last_merge=0.8758 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9560057623521612, 'auprc': 0.9686261519474517, 'loss_val': 0.2937991102315756, 'psi': 0.9610539181902774}-{'f1_val': 0.9559372335387121, 'auprc': 0.977944874661696, 'loss_val': 0.2847818890682612, 'psi': 0.9647402899879056}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=1.962970 cos_to_last_merge=0.7575 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=91 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9912648659185312, 'loss_val': 0.02171903341946772, 'psi': 0.9943062335455466}-{'f1_val': 0.9963338119635569, 'auprc': 0.9934463728225785, 'loss_val': 0.02524118331627736, 'psi': 0.9951788363071654}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=91 head_norm_before_train=2.080992 cos_to_last_merge=0.8695 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=91 local utility u=0.000000 metrics={'f1_val': 0.7504970461311733, 'auprc': 0.7654070342867284, 'loss_val': 0.8289405570742174, 'psi': 0.7564610413933954}-{'f1_val': 0.8158810780075142, 'auprc': 0.9351225438018638, 'loss_val': 0.5727133701500462, 'psi': 0.863577664325254}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=91 head_norm_before_train=1.968204 cos_to_last_merge=0.7575 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.758
[S7] round=91 local utility u=0.553614 metrics={'f1_val': 0.8664411792511999, 'auprc': 0.9320569000924694, 'loss_val': 0.6513717207217639, 'psi': 0.8926874675877077}-{'f1_val': 0.7317361563493041, 'auprc': 0.8926464668047334, 'loss_val': 0.8321378260546637, 'psi': 0.7961002805314759}
[S7] not sending this round → trigger blocked (psi=0.893)
[S8] START round=91 head_norm_before_train=2.243465 (no previous merge yet)
[S8] round=91 local utility u=0.002636 metrics={'f1_val': 0.995226424156427, 'auprc': 0.9988126037858351, 'loss_val': 0.02935882417397235, 'psi': 0.9966608960081903}-{'f1_val': 0.9935600276662899, 'auprc': 0.999053315746115, 'loss_val': 0.025353947601391726, 'psi': 0.9957573428982199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=91 head_norm_before_train=2.301366 cos_to_last_merge=0.9213 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=91 local utility u=0.000000 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9986491606366497, 'loss_val': 0.016371807245847067, 'psi': 0.9977214117619455}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986429000529091, 'loss_val': 0.016344161574026995, 'psi': 0.9977189075284494}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=91 head_norm_before_train=2.048948 cos_to_last_merge=0.9067 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.907
[S10] round=91 local utility u=0.001310 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9951273665111006, 'loss_val': 0.02953328806633652, 'psi': 0.9943232197492533}-{'f1_val': 0.9933489306849028, 'auprc': 0.9957000075203095, 'loss_val': 0.031241522039969088, 'psi': 0.9942893614190655}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] sending update (kind=head size=1799 to 1 peers)
[S11] START round=91 head_norm_before_train=2.401706 cos_to_last_merge=0.9257 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9931919967468725, 'loss_val': 0.020824635343326514, 'psi': 0.9949692835451962}-{'f1_val': 0.9961541414107454, 'auprc': 0.993565088172866, 'loss_val': 0.021001326478696285, 'psi': 0.9951185201155937}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=91 head_norm_before_train=2.021601 (no previous merge yet)
[S13] round=91 local utility u=0.000000 metrics={'f1_val': 0.6559738647526416, 'auprc': 0.7056474641823436, 'loss_val': 1.1827304894517328, 'psi': 0.6758433045245225}-{'f1_val': 0.7417710445733705, 'auprc': 0.7149989135050268, 'loss_val': 1.1640306539074379, 'psi': 0.731062192146033}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=91 head_norm_before_train=2.299064 cos_to_last_merge=0.9581 (last merge round=15)
[S14] round=91 local utility u=0.109655 metrics={'f1_val': 0.9390982604983729, 'auprc': 0.9973813912411308, 'loss_val': 0.15000251495175088, 'psi': 0.962411512795476}-{'f1_val': 0.9330055469485266, 'auprc': 0.9602002644422486, 'loss_val': 0.22121362128342065, 'psi': 0.9438834339460154}
[S14] not sending this round → trigger blocked (psi=0.962)
[S15] START round=91 head_norm_before_train=2.439178 (no previous merge yet)
[S15] round=91 local utility u=0.015683 metrics={'f1_val': 0.9432385253750561, 'auprc': 0.9973323010669246, 'loss_val': 0.0940513367210318, 'psi': 0.9648760356518036}-{'f1_val': 0.9387714626268884, 'auprc': 0.997324181713533, 'loss_val': 0.0985900462770458, 'psi': 0.9621925502615463}
[S15] not sending this round → trigger blocked (psi=0.965)
[S16] START round=91 head_norm_before_train=2.113572 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=91 local utility u=0.050485 metrics={'f1_val': 0.993398351000959, 'auprc': 0.9896724202066042, 'loss_val': 0.03864014130512024, 'psi': 0.9919079786832171}-{'f1_val': 0.9807977401892058, 'auprc': 0.9954351882925898, 'loss_val': 0.0812953365070171, 'psi': 0.9866527194305594}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=91 head_norm_before_train=1.974366 cos_to_last_merge=0.8348 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.835
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.8357558036185149, 'auprc': 0.9641920975443572, 'loss_val': 0.9544007987120297, 'psi': 0.8871303211888517}-{'f1_val': 0.8702909329902204, 'auprc': 0.9775215626744138, 'loss_val': 0.7278625216377634, 'psi': 0.9131831848638977}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=92 head_norm_before_train=2.115486 cos_to_last_merge=0.7524 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.6962568352947345, 'auprc': 0.7242292202065141, 'loss_val': 1.040346010330828, 'psi': 0.7074457892594463}-{'f1_val': 0.7198609991501991, 'auprc': 0.7260774077928112, 'loss_val': 1.013249385432508, 'psi': 0.722347562607244}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=92 head_norm_before_train=2.576869 (no previous merge yet)
[S3] round=92 local utility u=0.737538 metrics={'f1_val': 0.9844779093821792, 'auprc': 0.9989380212689928, 'loss_val': 0.04790688037413432, 'psi': 0.9902619541369047}-{'f1_val': 0.8232538820418038, 'auprc': 0.9789908010307258, 'loss_val': 0.4957966077151172, 'psi': 0.8855486496373726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=92 head_norm_before_train=1.870723 cos_to_last_merge=0.8757 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9562475778265639, 'auprc': 0.9629530308282743, 'loss_val': 0.29771267123308087, 'psi': 0.9589297590272481}-{'f1_val': 0.9560057623521612, 'auprc': 0.9686261519474517, 'loss_val': 0.2937991102315756, 'psi': 0.9610539181902774}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=1.971447 cos_to_last_merge=0.7567 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.757
[S5] round=92 local utility u=0.005280 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939609719797892, 'loss_val': 0.021455837898380674, 'psi': 0.9956055698789903}-{'f1_val': 0.9963338119635569, 'auprc': 0.9912648659185312, 'loss_val': 0.02171903341946772, 'psi': 0.9943062335455466}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=92 head_norm_before_train=2.088934 cos_to_last_merge=0.8689 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.6090557316365687, 'auprc': 0.6937986691122421, 'loss_val': 1.2385523045747753, 'psi': 0.642952906626838}-{'f1_val': 0.7504970461311733, 'auprc': 0.7654070342867284, 'loss_val': 0.8289405570742174, 'psi': 0.7564610413933954}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.986771 cos_to_last_merge=0.7559 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.756
[S7] round=92 local utility u=0.000000 metrics={'f1_val': 0.8219195763026201, 'auprc': 0.9060725733089334, 'loss_val': 0.8414608768367552, 'psi': 0.8555807751051454}-{'f1_val': 0.8664411792511999, 'auprc': 0.9320569000924694, 'loss_val': 0.6513717207217639, 'psi': 0.8926874675877077}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=92 head_norm_before_train=2.247652 (no previous merge yet)
[S8] round=92 local utility u=0.001176 metrics={'f1_val': 0.9947112329003273, 'auprc': 0.9990201882978064, 'loss_val': 0.02453848684942666, 'psi': 0.9964348150593189}-{'f1_val': 0.995226424156427, 'auprc': 0.9988126037858351, 'loss_val': 0.02935882417397235, 'psi': 0.9966608960081903}
[S8] not sending this round → trigger blocked (psi=0.996)
[S9] START round=92 head_norm_before_train=2.306761 cos_to_last_merge=0.9211 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=92 local utility u=0.000133 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.99869917735528, 'loss_val': 0.016256451662314646, 'psi': 0.9977414184493977}-{'f1_val': 0.9971029125121428, 'auprc': 0.9986491606366497, 'loss_val': 0.016371807245847067, 'psi': 0.9977214117619455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=92 head_norm_before_train=2.054676 cos_to_last_merge=0.9065 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=92 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9949667618591997, 'loss_val': 0.029153921606564243, 'psi': 0.9942589778884929}-{'f1_val': 0.9937871219080217, 'auprc': 0.9951273665111006, 'loss_val': 0.02953328806633652, 'psi': 0.9943232197492533}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=92 head_norm_before_train=2.405609 cos_to_last_merge=0.9253 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=92 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9922067452170296, 'loss_val': 0.0207076871604925, 'psi': 0.9945751829332591}-{'f1_val': 0.9961541414107454, 'auprc': 0.9931919967468725, 'loss_val': 0.020824635343326514, 'psi': 0.9949692835451962}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=92 head_norm_before_train=2.026314 (no previous merge yet)
[S13] round=92 local utility u=0.799204 metrics={'f1_val': 0.7927591592224363, 'auprc': 0.7997293721498673, 'loss_val': 0.6872809122759711, 'psi': 0.7955472443934086}-{'f1_val': 0.6559738647526416, 'auprc': 0.7056474641823436, 'loss_val': 1.1827304894517328, 'psi': 0.6758433045245225}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] sending update (kind=head size=1802 to 1 peers)
[S14] START round=92 head_norm_before_train=2.303449 cos_to_last_merge=0.9578 (last merge round=15)
[S14] round=92 local utility u=0.000000 metrics={'f1_val': 0.9390982604983729, 'auprc': 0.9971603601934951, 'loss_val': 0.15543328211700766, 'psi': 0.9623231003764217}-{'f1_val': 0.9390982604983729, 'auprc': 0.9973813912411308, 'loss_val': 0.15000251495175088, 'psi': 0.962411512795476}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=92 head_norm_before_train=2.443054 (no previous merge yet)
[S15] round=92 local utility u=0.002686 metrics={'f1_val': 0.943730532135611, 'auprc': 0.9973398260442914, 'loss_val': 0.09165464558418562, 'psi': 0.9651742496990832}-{'f1_val': 0.9432385253750561, 'auprc': 0.9973323010669246, 'loss_val': 0.0940513367210318, 'psi': 0.9648760356518036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=92 head_norm_before_train=2.118327 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=92 local utility u=0.011237 metrics={'f1_val': 0.992094582938667, 'auprc': 0.9987222868288548, 'loss_val': 0.03549287517991866, 'psi': 0.9947456644947421}-{'f1_val': 0.993398351000959, 'auprc': 0.9896724202066042, 'loss_val': 0.03864014130512024, 'psi': 0.9919079786832171}
[S16] not sending this round → trigger blocked (psi=0.995)
[S17] START round=92 head_norm_before_train=1.979707 cos_to_last_merge=0.8344 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=92 local utility u=0.292938 metrics={'f1_val': 0.8811211047570499, 'auprc': 0.9777180796925116, 'loss_val': 0.681294749878972, 'psi': 0.9197598947312345}-{'f1_val': 0.8357558036185149, 'auprc': 0.9641920975443572, 'loss_val': 0.9544007987120297, 'psi': 0.8871303211888517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] START round=93 head_norm_before_train=2.116858 cos_to_last_merge=0.7522 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=93 local utility u=0.010717 metrics={'f1_val': 0.6980003000531472, 'auprc': 0.725526691802622, 'loss_val': 1.0332654604770939, 'psi': 0.7090108567529371}-{'f1_val': 0.6962568352947345, 'auprc': 0.7242292202065141, 'loss_val': 1.040346010330828, 'psi': 0.7074457892594463}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] sending update (kind=head size=1800 to 1 peers)
[S3] START round=93 head_norm_before_train=2.582597 (no previous merge yet)
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.7316313428747679, 'auprc': 0.9826830879283244, 'loss_val': 0.7622684621291682, 'psi': 0.8320520408961904}-{'f1_val': 0.9844779093821792, 'auprc': 0.9989380212689928, 'loss_val': 0.04790688037413432, 'psi': 0.9902619541369047}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.873160 cos_to_last_merge=0.8753 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=93 local utility u=0.035943 metrics={'f1_val': 0.9578076748667212, 'auprc': 0.9786204854631335, 'loss_val': 0.2821894474369267, 'psi': 0.9661327991052862}-{'f1_val': 0.9562475778265639, 'auprc': 0.9629530308282743, 'loss_val': 0.29771267123308087, 'psi': 0.9589297590272481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=93 head_norm_before_train=1.980546 cos_to_last_merge=0.7554 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.755
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9929234730570768, 'loss_val': 0.02692208289221563, 'psi': 0.9949696764009648}-{'f1_val': 0.9967019684784577, 'auprc': 0.9939609719797892, 'loss_val': 0.021455837898380674, 'psi': 0.9956055698789903}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=2.094028 cos_to_last_merge=0.8686 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.869
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.7950323059086529, 'auprc': 0.903699450231018, 'loss_val': 0.6128745919360247, 'psi': 0.8384991636375989}-{'f1_val': 0.6090557316365687, 'auprc': 0.6937986691122421, 'loss_val': 1.2385523045747753, 'psi': 0.642952906626838}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=93 head_norm_before_train=2.003622 cos_to_last_merge=0.7541 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.754
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.8240072243721949, 'auprc': 0.8722352019265283, 'loss_val': 0.8968754636601131, 'psi': 0.8432984153939282}-{'f1_val': 0.8219195763026201, 'auprc': 0.9060725733089334, 'loss_val': 0.8414608768367552, 'psi': 0.8555807751051454}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.253479 (no previous merge yet)
[S8] round=93 local utility u=0.000000 metrics={'f1_val': 0.974584377100401, 'auprc': 0.9957376792666806, 'loss_val': 0.06279750727848057, 'psi': 0.9830456979669128}-{'f1_val': 0.9947112329003273, 'auprc': 0.9990201882978064, 'loss_val': 0.02453848684942666, 'psi': 0.9964348150593189}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=93 head_norm_before_train=2.310706 cos_to_last_merge=0.9207 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9984814426529636, 'loss_val': 0.018452259117814653, 'psi': 0.9967558438580856}-{'f1_val': 0.9971029125121428, 'auprc': 0.99869917735528, 'loss_val': 0.016256451662314646, 'psi': 0.9977414184493977}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=2.060416 cos_to_last_merge=0.9062 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=93 local utility u=0.000000 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9948214085372716, 'loss_val': 0.02872158433027889, 'psi': 0.9942008365597217}-{'f1_val': 0.9937871219080217, 'auprc': 0.9949667618591997, 'loss_val': 0.029153921606564243, 'psi': 0.9942589778884929}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=93 head_norm_before_train=2.409796 cos_to_last_merge=0.9249 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=93 local utility u=0.000386 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9924333699270902, 'loss_val': 0.02061525238713611, 'psi': 0.9946658328172833}-{'f1_val': 0.9961541414107454, 'auprc': 0.9922067452170296, 'loss_val': 0.0207076871604925, 'psi': 0.9945751829332591}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S11] sending update (kind=head size=1792 to 1 peers)
[S13] START round=93 head_norm_before_train=2.030459 (no previous merge yet)
[S13] round=93 local utility u=0.000000 metrics={'f1_val': 0.7494779098641777, 'auprc': 0.7416114411223057, 'loss_val': 1.054016531863291, 'psi': 0.7463313223674288}-{'f1_val': 0.7927591592224363, 'auprc': 0.7997293721498673, 'loss_val': 0.6872809122759711, 'psi': 0.7955472443934086}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=93 head_norm_before_train=2.305390 cos_to_last_merge=0.9576 (last merge round=15)
[S14] round=93 local utility u=0.155644 metrics={'f1_val': 0.9735973172534865, 'auprc': 0.998856427424877, 'loss_val': 0.05622825833288794, 'psi': 0.9837009613220428}-{'f1_val': 0.9390982604983729, 'auprc': 0.9971603601934951, 'loss_val': 0.15543328211700766, 'psi': 0.9623231003764217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=93 head_norm_before_train=2.446838 (no previous merge yet)
[S15] round=93 local utility u=0.000000 metrics={'f1_val': 0.943730532135611, 'auprc': 0.997331791808366, 'loss_val': 0.09315950019970878, 'psi': 0.965171036004713}-{'f1_val': 0.943730532135611, 'auprc': 0.9973398260442914, 'loss_val': 0.09165464558418562, 'psi': 0.9651742496990832}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=93 head_norm_before_train=2.124323 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=93 local utility u=0.000000 metrics={'f1_val': 0.9918692328053816, 'auprc': 0.9984141428170656, 'loss_val': 0.03559115042914756, 'psi': 0.9944871968100553}-{'f1_val': 0.992094582938667, 'auprc': 0.9987222868288548, 'loss_val': 0.03549287517991866, 'psi': 0.9947456644947421}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=93 head_norm_before_train=1.986354 cos_to_last_merge=0.8344 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.8471579614669178, 'auprc': 0.9735772954625134, 'loss_val': 0.7837657933276034, 'psi': 0.897725695065156}-{'f1_val': 0.8811211047570499, 'auprc': 0.9777180796925116, 'loss_val': 0.681294749878972, 'psi': 0.9197598947312345}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=94 head_norm_before_train=2.120376 cos_to_last_merge=0.7519 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=94 local utility u=0.085724 metrics={'f1_val': 0.719946369225838, 'auprc': 0.7286023682520777, 'loss_val': 1.0027215802465161, 'psi': 0.7234087688363339}-{'f1_val': 0.6980003000531472, 'auprc': 0.725526691802622, 'loss_val': 1.0332654604770939, 'psi': 0.7090108567529371}
[S2] not sending this round → trigger blocked (psi=0.723)
[S3] START round=94 head_norm_before_train=2.587059 (no previous merge yet)
[S3] round=94 local utility u=1.000000 metrics={'f1_val': 0.9575094106556665, 'auprc': 0.9984889590201995, 'loss_val': 0.09698815445901013, 'psi': 0.9739012300014797}-{'f1_val': 0.7316313428747679, 'auprc': 0.9826830879283244, 'loss_val': 0.7622684621291682, 'psi': 0.8320520408961904}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=94 head_norm_before_train=1.877135 cos_to_last_merge=0.8751 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=94 local utility u=0.000000 metrics={'f1_val': 0.9527483546146679, 'auprc': 0.9768241311386237, 'loss_val': 0.2880875709169589, 'psi': 0.9623786652242503}-{'f1_val': 0.9578076748667212, 'auprc': 0.9786204854631335, 'loss_val': 0.2821894474369267, 'psi': 0.9661327991052862}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=94 head_norm_before_train=1.987115 cos_to_last_merge=0.7541 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.754
[S5] round=94 local utility u=0.012947 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9999131678788956, 'loss_val': 0.021997975299288965, 'psi': 0.9977655543296924}-{'f1_val': 0.9963338119635569, 'auprc': 0.9929234730570768, 'loss_val': 0.02692208289221563, 'psi': 0.9949696764009648}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=94 head_norm_before_train=2.098653 cos_to_last_merge=0.8677 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.868
[S6] round=94 local utility u=0.042300 metrics={'f1_val': 0.799858580587905, 'auprc': 0.9270590594144931, 'loss_val': 0.6273108541150961, 'psi': 0.8507387721185402}-{'f1_val': 0.7950323059086529, 'auprc': 0.903699450231018, 'loss_val': 0.6128745919360247, 'psi': 0.8384991636375989}
[S6] not sending this round → trigger blocked (psi=0.851)
[S7] START round=94 head_norm_before_train=2.017909 cos_to_last_merge=0.7528 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.753
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.7869671875680283, 'auprc': 0.8763457388555872, 'loss_val': 0.8965423316168977, 'psi': 0.8227186080830519}-{'f1_val': 0.8240072243721949, 'auprc': 0.8722352019265283, 'loss_val': 0.8968754636601131, 'psi': 0.8432984153939282}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.257280 (no previous merge yet)
[S8] round=94 local utility u=0.078595 metrics={'f1_val': 0.993122746315827, 'auprc': 0.9989094807550468, 'loss_val': 0.0263531779408937, 'psi': 0.9954374400915149}-{'f1_val': 0.974584377100401, 'auprc': 0.9957376792666806, 'loss_val': 0.06279750727848057, 'psi': 0.9830456979669128}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] sending update (kind=head size=1795 to 1 peers)
[S9] START round=94 head_norm_before_train=2.313197 cos_to_last_merge=0.9202 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=94 local utility u=0.006980 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984819857893693, 'loss_val': 0.015944986856584888, 'psi': 0.9979010847697942}-{'f1_val': 0.9956054446615002, 'auprc': 0.9984814426529636, 'loss_val': 0.018452259117814653, 'psi': 0.9967558438580856}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] sending update (kind=head size=1802 to 1 peers)
[S10] START round=94 head_norm_before_train=2.061586 cos_to_last_merge=0.9055 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.906
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9949135283875072, 'loss_val': 0.030073374039718267, 'psi': 0.9939747697659447}-{'f1_val': 0.9937871219080217, 'auprc': 0.9948214085372716, 'loss_val': 0.02872158433027889, 'psi': 0.9942008365597217}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=94 head_norm_before_train=2.414068 cos_to_last_merge=0.9244 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.924
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.7972809218417797, 'auprc': 0.9938508491258444, 'loss_val': 0.46435757627188584, 'psi': 0.8759088927554055}-{'f1_val': 0.9961541414107454, 'auprc': 0.9924333699270902, 'loss_val': 0.02061525238713611, 'psi': 0.9946658328172833}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=94 head_norm_before_train=2.033861 (no previous merge yet)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6351874144386657, 'auprc': 0.7051143514071465, 'loss_val': 1.2758109677453242, 'psi': 0.6631581892260581}-{'f1_val': 0.7494779098641777, 'auprc': 0.7416114411223057, 'loss_val': 1.054016531863291, 'psi': 0.7463313223674288}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=94 head_norm_before_train=2.302732 cos_to_last_merge=0.9574 (last merge round=15)
[S14] round=94 local utility u=0.060792 metrics={'f1_val': 0.9908393532757206, 'auprc': 0.998784431819348, 'loss_val': 0.037880158194126524, 'psi': 0.9940173846931715}-{'f1_val': 0.9735973172534865, 'auprc': 0.998856427424877, 'loss_val': 0.05622825833288794, 'psi': 0.9837009613220428}
[S14] not sending this round → trigger blocked (psi=0.994)
[S15] START round=94 head_norm_before_train=2.450538 (no previous merge yet)
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.9422519396866007, 'auprc': 0.9973299571815534, 'loss_val': 0.09502567069590126, 'psi': 0.9642831466845818}-{'f1_val': 0.943730532135611, 'auprc': 0.997331791808366, 'loss_val': 0.09315950019970878, 'psi': 0.965171036004713}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.126579 cos_to_last_merge=0.7679 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.768
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.8590169203033865, 'auprc': 0.9893020352322418, 'loss_val': 0.8773734811020069, 'psi': 0.9111309662749286}-{'f1_val': 0.9918692328053816, 'auprc': 0.9984141428170656, 'loss_val': 0.03559115042914756, 'psi': 0.9944871968100553}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=1.993805 cos_to_last_merge=0.8342 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=94 local utility u=0.171239 metrics={'f1_val': 0.8621672529019213, 'auprc': 0.9693610075595196, 'loss_val': 0.518693686850266, 'psi': 0.9050447547649606}-{'f1_val': 0.8471579614669178, 'auprc': 0.9735772954625134, 'loss_val': 0.7837657933276034, 'psi': 0.897725695065156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] sending update (kind=head size=1798 to 1 peers)
[S2] START round=95 head_norm_before_train=2.124797 cos_to_last_merge=0.7515 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.752
[S2] round=95 local utility u=0.000000 metrics={'f1_val': 0.7186093762498652, 'auprc': 0.7275642122036363, 'loss_val': 1.0115210753108659, 'psi': 0.7221913106313737}-{'f1_val': 0.719946369225838, 'auprc': 0.7286023682520777, 'loss_val': 1.0027215802465161, 'psi': 0.7234087688363339}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=95 head_norm_before_train=2.590998 (no previous merge yet)
[S3] round=95 local utility u=0.126144 metrics={'f1_val': 0.9883327740149057, 'auprc': 0.999290980291426, 'loss_val': 0.032047123549654694, 'psi': 0.9927160565255138}-{'f1_val': 0.9575094106556665, 'auprc': 0.9984889590201995, 'loss_val': 0.09698815445901013, 'psi': 0.9739012300014797}
[S3] not sending this round → trigger blocked (psi=0.993)
[S4] START round=95 head_norm_before_train=1.880714 cos_to_last_merge=0.8747 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.875
[S4] round=95 local utility u=0.000000 metrics={'f1_val': 0.9483881320063152, 'auprc': 0.9819289084101591, 'loss_val': 0.2898606533686449, 'psi': 0.9618044425678527}-{'f1_val': 0.9527483546146679, 'auprc': 0.9768241311386237, 'loss_val': 0.2880875709169589, 'psi': 0.9623786652242503}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=95 head_norm_before_train=1.988987 cos_to_last_merge=0.7539 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.754
[S5] round=95 local utility u=0.000748 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9994185667217194, 'loss_val': 0.021226384048247875, 'psi': 0.9977886077757623}-{'f1_val': 0.9963338119635569, 'auprc': 0.9999131678788956, 'loss_val': 0.021997975299288965, 'psi': 0.9977655543296924}
[S5] not sending this round → trigger blocked (psi=0.998)
[S6] START round=95 head_norm_before_train=2.104084 cos_to_last_merge=0.8668 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.867
[S6] round=95 local utility u=0.476590 metrics={'f1_val': 0.872903667518132, 'auprc': 0.9731864467177803, 'loss_val': 0.25078375210863835, 'psi': 0.9130167791979913}-{'f1_val': 0.799858580587905, 'auprc': 0.9270590594144931, 'loss_val': 0.6273108541150961, 'psi': 0.8507387721185402}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=95 head_norm_before_train=2.033546 cos_to_last_merge=0.7517 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.752
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6824674297408532, 'auprc': 0.8907281438673031, 'loss_val': 0.9708139432702894, 'psi': 0.7657717153914332}-{'f1_val': 0.7869671875680283, 'auprc': 0.8763457388555872, 'loss_val': 0.8965423316168977, 'psi': 0.8227186080830519}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.262245 (no previous merge yet)
[S8] round=95 local utility u=0.000000 metrics={'f1_val': 0.9924515537855688, 'auprc': 0.9990482359738163, 'loss_val': 0.027145352245077345, 'psi': 0.9950902266608679}-{'f1_val': 0.993122746315827, 'auprc': 0.9989094807550468, 'loss_val': 0.0263531779408937, 'psi': 0.9954374400915149}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=95 head_norm_before_train=2.319147 cos_to_last_merge=0.9199 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987174946749408, 'loss_val': 0.01749656766525396, 'psi': 0.9974833049583112}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984819857893693, 'loss_val': 0.015944986856584888, 'psi': 0.9979010847697942}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=2.064839 cos_to_last_merge=0.9051 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=95 local utility u=0.000365 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9954054788156017, 'loss_val': 0.030819874781621445, 'psi': 0.9941715499371824}-{'f1_val': 0.9933489306849028, 'auprc': 0.9949135283875072, 'loss_val': 0.030073374039718267, 'psi': 0.9939747697659447}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] START round=95 head_norm_before_train=2.414155 cos_to_last_merge=0.9248 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=95 local utility u=0.820342 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9954420069761226, 'loss_val': 0.021686450553721145, 'psi': 0.9958692876368963}-{'f1_val': 0.7972809218417797, 'auprc': 0.9938508491258444, 'loss_val': 0.46435757627188584, 'psi': 0.8759088927554055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=95 head_norm_before_train=2.040962 (no previous merge yet)
[S13] round=95 local utility u=0.545673 metrics={'f1_val': 0.7574185247291142, 'auprc': 0.7494524464218182, 'loss_val': 1.0508660208851621, 'psi': 0.7542320934061957}-{'f1_val': 0.6351874144386657, 'auprc': 0.7051143514071465, 'loss_val': 1.2758109677453242, 'psi': 0.6631581892260581}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] sending update (kind=head size=1797 to 1 peers)
[S14] START round=95 head_norm_before_train=2.302130 cos_to_last_merge=0.9573 (last merge round=15)
[S14] round=95 local utility u=0.011597 metrics={'f1_val': 0.9934683900115385, 'auprc': 0.9987954051533883, 'loss_val': 0.030493026606431724, 'psi': 0.9955991960682784}-{'f1_val': 0.9908393532757206, 'auprc': 0.998784431819348, 'loss_val': 0.037880158194126524, 'psi': 0.9940173846931715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=95 head_norm_before_train=2.454143 (no previous merge yet)
[S15] round=95 local utility u=0.000000 metrics={'f1_val': 0.9364130754188567, 'auprc': 0.9973120255015784, 'loss_val': 0.1059228306378093, 'psi': 0.9607726554519453}-{'f1_val': 0.9422519396866007, 'auprc': 0.9973299571815534, 'loss_val': 0.09502567069590126, 'psi': 0.9642831466845818}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=95 head_norm_before_train=2.126486 cos_to_last_merge=0.7672 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=95 local utility u=0.832922 metrics={'f1_val': 0.9936615323017246, 'auprc': 0.9930622808527856, 'loss_val': 0.030677265264436773, 'psi': 0.9934218317221489}-{'f1_val': 0.8590169203033865, 'auprc': 0.9893020352322418, 'loss_val': 0.8773734811020069, 'psi': 0.9111309662749286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=95 head_norm_before_train=2.000576 cos_to_last_merge=0.8335 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.834
[S17] round=95 local utility u=0.628446 metrics={'f1_val': 0.9824216590507717, 'auprc': 0.9986328449832498, 'loss_val': 0.07114333873622701, 'psi': 0.988906133423763}-{'f1_val': 0.8621672529019213, 'auprc': 0.9693610075595196, 'loss_val': 0.518693686850266, 'psi': 0.9050447547649606}
[S17] not sending this round → trigger blocked (psi=0.989)
[S2] START round=96 head_norm_before_train=2.127873 cos_to_last_merge=0.7511 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=96 local utility u=0.000000 metrics={'f1_val': 0.7186217401018028, 'auprc': 0.7270194783433559, 'loss_val': 1.0278660933746082, 'psi': 0.7219808353984241}-{'f1_val': 0.7186093762498652, 'auprc': 0.7275642122036363, 'loss_val': 1.0115210753108659, 'psi': 0.7221913106313737}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=96 head_norm_before_train=2.595584 (no previous merge yet)
[S3] round=96 local utility u=0.015868 metrics={'f1_val': 0.9923851879828639, 'auprc': 0.9991938582816698, 'loss_val': 0.024335012651447867, 'psi': 0.9951086561023863}-{'f1_val': 0.9883327740149057, 'auprc': 0.999290980291426, 'loss_val': 0.032047123549654694, 'psi': 0.9927160565255138}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=96 head_norm_before_train=1.887595 cos_to_last_merge=0.8745 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9432167059480565, 'auprc': 0.9836724684319247, 'loss_val': 0.29486035804817146, 'psi': 0.9593990109416038}-{'f1_val': 0.9483881320063152, 'auprc': 0.9819289084101591, 'loss_val': 0.2898606533686449, 'psi': 0.9618044425678527}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=1.994461 cos_to_last_merge=0.7530 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.753
[S5] round=96 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9994530942246918, 'loss_val': 0.021631174698677577, 'psi': 0.9975815248680108}-{'f1_val': 0.9967019684784577, 'auprc': 0.9994185667217194, 'loss_val': 0.021226384048247875, 'psi': 0.9977886077757623}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=96 head_norm_before_train=2.111002 cos_to_last_merge=0.8658 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.866
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.8045771109832363, 'auprc': 0.939133527350978, 'loss_val': 0.640590129411223, 'psi': 0.858399677530333}-{'f1_val': 0.872903667518132, 'auprc': 0.9731864467177803, 'loss_val': 0.25078375210863835, 'psi': 0.9130167791979913}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.049286 cos_to_last_merge=0.7507 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.751
[S7] round=96 local utility u=0.376800 metrics={'f1_val': 0.8371804344585785, 'auprc': 0.8482260004991178, 'loss_val': 1.0179856634937954, 'psi': 0.8415986608747943}-{'f1_val': 0.6824674297408532, 'auprc': 0.8907281438673031, 'loss_val': 0.9708139432702894, 'psi': 0.7657717153914332}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=96 head_norm_before_train=2.267076 (no previous merge yet)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.9757171601746235, 'auprc': 0.9989339570985626, 'loss_val': 0.054154365356575446, 'psi': 0.985003878944199}-{'f1_val': 0.9924515537855688, 'auprc': 0.9990482359738163, 'loss_val': 0.027145352245077345, 'psi': 0.9950902266608679}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] START round=96 head_norm_before_train=2.326063 cos_to_last_merge=0.9197 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9905718417662249, 'auprc': 0.9986999908682916, 'loss_val': 0.03026019158731762, 'psi': 0.9938231014070517}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987174946749408, 'loss_val': 0.01749656766525396, 'psi': 0.9974833049583112}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=2.069144 cos_to_last_merge=0.9048 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9950404024070147, 'loss_val': 0.030232595096981996, 'psi': 0.9940255193737476}-{'f1_val': 0.9933489306849028, 'auprc': 0.9954054788156017, 'loss_val': 0.030819874781621445, 'psi': 0.9941715499371824}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] START round=96 head_norm_before_train=2.415096 cos_to_last_merge=0.9250 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=96 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.993447711111299, 'loss_val': 0.01963258895356435, 'psi': 0.9950715692909669}-{'f1_val': 0.9961541414107454, 'auprc': 0.9954420069761226, 'loss_val': 0.021686450553721145, 'psi': 0.9958692876368963}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=96 head_norm_before_train=2.048707 (no previous merge yet)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6104594237978568, 'auprc': 0.6455921255004612, 'loss_val': 1.5730030447173855, 'psi': 0.6245125044788986}-{'f1_val': 0.7574185247291142, 'auprc': 0.7494524464218182, 'loss_val': 1.0508660208851621, 'psi': 0.7542320934061957}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=96 head_norm_before_train=2.305484 cos_to_last_merge=0.9572 (last merge round=15)
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9316649442162626, 'auprc': 0.9975914076073009, 'loss_val': 0.20069021824867955, 'psi': 0.9580355295726779}-{'f1_val': 0.9934683900115385, 'auprc': 0.9987954051533883, 'loss_val': 0.030493026606431724, 'psi': 0.9955991960682784}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.457681 (no previous merge yet)
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9333672888498293, 'auprc': 0.9973041163302414, 'loss_val': 0.11039872781555804, 'psi': 0.9589420198419942}-{'f1_val': 0.9364130754188567, 'auprc': 0.9973120255015784, 'loss_val': 0.1059228306378093, 'psi': 0.9607726554519453}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.128330 cos_to_last_merge=0.7668 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=96 local utility u=0.000559 metrics={'f1_val': 0.9941015615167788, 'auprc': 0.9916160060215133, 'loss_val': 0.027861464429575853, 'psi': 0.9931073393186726}-{'f1_val': 0.9936615323017246, 'auprc': 0.9930622808527856, 'loss_val': 0.030677265264436773, 'psi': 0.9934218317221489}
[S16] not sending this round → trigger blocked (psi=0.993)
[S17] START round=96 head_norm_before_train=2.005104 cos_to_last_merge=0.8326 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.833
[S17] round=96 local utility u=0.000000 metrics={'f1_val': 0.8346979469952103, 'auprc': 0.9449697568539417, 'loss_val': 0.698957015096698, 'psi': 0.8788066709387028}-{'f1_val': 0.9824216590507717, 'auprc': 0.9986328449832498, 'loss_val': 0.07114333873622701, 'psi': 0.988906133423763}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=97 head_norm_before_train=2.129921 cos_to_last_merge=0.7507 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.751
[S2] round=97 local utility u=0.016497 metrics={'f1_val': 0.7184316654866462, 'auprc': 0.7316297905521644, 'loss_val': 1.0075630591970615, 'psi': 0.7237109155128535}-{'f1_val': 0.7186217401018028, 'auprc': 0.7270194783433559, 'loss_val': 1.0278660933746082, 'psi': 0.7219808353984241}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] START round=97 head_norm_before_train=2.600156 (no previous merge yet)
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.9606109340814555, 'auprc': 0.9991216647686726, 'loss_val': 0.1940449124333516, 'psi': 0.9760152263563423}-{'f1_val': 0.9923851879828639, 'auprc': 0.9991938582816698, 'loss_val': 0.024335012651447867, 'psi': 0.9951086561023863}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.894485 cos_to_last_merge=0.8739 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.874
[S4] round=97 local utility u=0.033413 metrics={'f1_val': 0.9514783682941423, 'auprc': 0.9854638729633883, 'loss_val': 0.28297771757838425, 'psi': 0.9650725701618408}-{'f1_val': 0.9432167059480565, 'auprc': 0.9836724684319247, 'loss_val': 0.29486035804817146, 'psi': 0.9593990109416038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S4] sending update (kind=head size=1806 to 1 peers)
[S5] START round=97 head_norm_before_train=2.001532 cos_to_last_merge=0.7519 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.752
[S5] round=97 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9978261611332111, 'loss_val': 0.02210412339189062, 'psi': 0.9969307516314185}-{'f1_val': 0.9963338119635569, 'auprc': 0.9994530942246918, 'loss_val': 0.021631174698677577, 'psi': 0.9975815248680108}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=97 head_norm_before_train=2.117188 cos_to_last_merge=0.8648 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.865
[S6] round=97 local utility u=0.000000 metrics={'f1_val': 0.6641389455755548, 'auprc': 0.7530341898137997, 'loss_val': 1.0498333518609804, 'psi': 0.6996970432708527}-{'f1_val': 0.8045771109832363, 'auprc': 0.939133527350978, 'loss_val': 0.640590129411223, 'psi': 0.858399677530333}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=97 head_norm_before_train=2.060382 cos_to_last_merge=0.7499 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.750
[S7] round=97 local utility u=0.028735 metrics={'f1_val': 0.8057223819980686, 'auprc': 0.8720803086067651, 'loss_val': 0.8433309335230034, 'psi': 0.8322655526415472}-{'f1_val': 0.8371804344585785, 'auprc': 0.8482260004991178, 'loss_val': 1.0179856634937954, 'psi': 0.8415986608747943}
[S7] not sending this round → trigger blocked (psi=0.832)
[S8] START round=97 head_norm_before_train=2.272373 (no previous merge yet)
[S8] round=97 local utility u=0.018743 metrics={'f1_val': 0.980525069595602, 'auprc': 0.9990592410565289, 'loss_val': 0.04589223913651306, 'psi': 0.9879387381799727}-{'f1_val': 0.9757171601746235, 'auprc': 0.9989339570985626, 'loss_val': 0.054154365356575446, 'psi': 0.985003878944199}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] sending update (kind=head size=1800 to 1 peers)
[S9] START round=97 head_norm_before_train=2.332038 cos_to_last_merge=0.9195 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.920
[S9] round=97 local utility u=0.024682 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984838635377555, 'loss_val': 0.01677906916335282, 'psi': 0.997389852503437}-{'f1_val': 0.9905718417662249, 'auprc': 0.9986999908682916, 'loss_val': 0.03026019158731762, 'psi': 0.9938231014070517}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S9] sending update (kind=head size=1804 to 1 peers)
[S10] START round=97 head_norm_before_train=2.073988 cos_to_last_merge=0.9045 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.905
[S10] round=97 local utility u=0.000132 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9950952523524503, 'loss_val': 0.030132761985374845, 'psi': 0.9940474593519218}-{'f1_val': 0.9933489306849028, 'auprc': 0.9950404024070147, 'loss_val': 0.030232595096981996, 'psi': 0.9940255193737476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] START round=97 head_norm_before_train=2.415556 cos_to_last_merge=0.9252 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=97 local utility u=0.001521 metrics={'f1_val': 0.996567470639547, 'auprc': 0.9934760395567849, 'loss_val': 0.01915526388401782, 'psi': 0.9953308982064422}-{'f1_val': 0.9961541414107454, 'auprc': 0.993447711111299, 'loss_val': 0.01963258895356435, 'psi': 0.9950715692909669}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] START round=97 head_norm_before_train=2.052332 (no previous merge yet)
[S13] round=97 local utility u=0.791252 metrics={'f1_val': 0.7259392213627327, 'auprc': 0.774336866783791, 'loss_val': 1.0696113758018861, 'psi': 0.745298279531156}-{'f1_val': 0.6104594237978568, 'auprc': 0.6455921255004612, 'loss_val': 1.5730030447173855, 'psi': 0.6245125044788986}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S13] sending update (kind=head size=1805 to 1 peers)
[S14] START round=97 head_norm_before_train=2.304487 cos_to_last_merge=0.9569 (last merge round=15)
[S14] round=97 local utility u=0.290539 metrics={'f1_val': 0.9984758593419994, 'auprc': 0.997152417760069, 'loss_val': 0.01916000770217247, 'psi': 0.9979464827092273}-{'f1_val': 0.9316649442162626, 'auprc': 0.9975914076073009, 'loss_val': 0.20069021824867955, 'psi': 0.9580355295726779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] START round=97 head_norm_before_train=2.461239 (no previous merge yet)
[S15] round=97 local utility u=0.005384 metrics={'f1_val': 0.9348943582185678, 'auprc': 0.9973109247431674, 'loss_val': 0.1088137913824256, 'psi': 0.9598609848284076}-{'f1_val': 0.9333672888498293, 'auprc': 0.9973041163302414, 'loss_val': 0.11039872781555804, 'psi': 0.9589420198419942}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=97 head_norm_before_train=2.132763 cos_to_last_merge=0.7666 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9805421853178764, 'auprc': 0.9925875910535156, 'loss_val': 0.08253416425366533, 'psi': 0.9853603476121321}-{'f1_val': 0.9941015615167788, 'auprc': 0.9916160060215133, 'loss_val': 0.027861464429575853, 'psi': 0.9931073393186726}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.009177 cos_to_last_merge=0.8317 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.832
[S17] round=97 local utility u=0.174051 metrics={'f1_val': 0.8652024340472994, 'auprc': 0.9637891095067324, 'loss_val': 0.5903408980045455, 'psi': 0.9046371042310726}-{'f1_val': 0.8346979469952103, 'auprc': 0.9449697568539417, 'loss_val': 0.698957015096698, 'psi': 0.8788066709387028}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] sending update (kind=head size=1800 to 1 peers)
[S2] START round=98 head_norm_before_train=2.130095 cos_to_last_merge=0.7503 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7143276281984727, 'auprc': 0.7308502765072656, 'loss_val': 1.0155807801101295, 'psi': 0.7209366875219899}-{'f1_val': 0.7184316654866462, 'auprc': 0.7316297905521644, 'loss_val': 1.0075630591970615, 'psi': 0.7237109155128535}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] START round=98 head_norm_before_train=2.599848 (no previous merge yet)
[S3] round=98 local utility u=0.089064 metrics={'f1_val': 0.9762651561205473, 'auprc': 0.9987937347393931, 'loss_val': 0.10885805791852093, 'psi': 0.9852765875680857}-{'f1_val': 0.9606109340814555, 'auprc': 0.9991216647686726, 'loss_val': 0.1940449124333516, 'psi': 0.9760152263563423}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=98 head_norm_before_train=1.899540 cos_to_last_merge=0.8733 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=98 local utility u=0.000000 metrics={'f1_val': 0.9551825180781917, 'auprc': 0.9749605556909184, 'loss_val': 0.28709128871947637, 'psi': 0.9630937331232824}-{'f1_val': 0.9514783682941423, 'auprc': 0.9854638729633883, 'loss_val': 0.28297771757838425, 'psi': 0.9650725701618408}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=98 head_norm_before_train=2.011193 cos_to_last_merge=0.7508 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.751
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963338119635569, 'auprc': 0.9946286277569941, 'loss_val': 0.021171721693967305, 'psi': 0.9956517382809318}-{'f1_val': 0.9963338119635569, 'auprc': 0.9978261611332111, 'loss_val': 0.02210412339189062, 'psi': 0.9969307516314185}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=2.122568 cos_to_last_merge=0.8636 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.864
[S6] round=98 local utility u=1.000000 metrics={'f1_val': 0.849458689725073, 'auprc': 0.9330123607329722, 'loss_val': 0.34427275677453384, 'psi': 0.8828801581282326}-{'f1_val': 0.6641389455755548, 'auprc': 0.7530341898137997, 'loss_val': 1.0498333518609804, 'psi': 0.6996970432708527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=98 head_norm_before_train=2.079260 cos_to_last_merge=0.7472 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.747
[S7] round=98 local utility u=0.193246 metrics={'f1_val': 0.8264841212149138, 'auprc': 0.8996827875542021, 'loss_val': 0.6642176106060813, 'psi': 0.8557635877506291}-{'f1_val': 0.8057223819980686, 'auprc': 0.8720803086067651, 'loss_val': 0.8433309335230034, 'psi': 0.8322655526415472}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=98 head_norm_before_train=2.276489 (no previous merge yet)
[S8] round=98 local utility u=0.042647 metrics={'f1_val': 0.9917244887003366, 'auprc': 0.9990942950571897, 'loss_val': 0.027900004029729142, 'psi': 0.9946724112430778}-{'f1_val': 0.980525069595602, 'auprc': 0.9990592410565289, 'loss_val': 0.04589223913651306, 'psi': 0.9879387381799727}
[S8] not sending this round → trigger blocked (psi=0.995)
[S9] START round=98 head_norm_before_train=2.330773 cos_to_last_merge=0.9187 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.919
[S9] round=98 local utility u=0.002788 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9984851388587009, 'loss_val': 0.0163260320720618, 'psi': 0.9979023459975269}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984838635377555, 'loss_val': 0.01677906916335282, 'psi': 0.997389852503437}
[S9] not sending this round → trigger blocked (psi=0.998)
[S10] START round=98 head_norm_before_train=2.079175 cos_to_last_merge=0.9043 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=98 local utility u=0.001458 metrics={'f1_val': 0.9937871219080217, 'auprc': 0.9950362456584354, 'loss_val': 0.02966936315165006, 'psi': 0.9942867714081872}-{'f1_val': 0.9933489306849028, 'auprc': 0.9950952523524503, 'loss_val': 0.030132761985374845, 'psi': 0.9940474593519218}
[S10] not sending this round → trigger blocked (psi=0.994)
[S11] START round=98 head_norm_before_train=2.418023 cos_to_last_merge=0.9251 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9961541414107454, 'auprc': 0.9932901992475396, 'loss_val': 0.020475854205906797, 'psi': 0.995008564545463}-{'f1_val': 0.996567470639547, 'auprc': 0.9934760395567849, 'loss_val': 0.01915526388401782, 'psi': 0.9953308982064422}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] START round=98 head_norm_before_train=2.056325 (no previous merge yet)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.6132486820417847, 'auprc': 0.6264795241013366, 'loss_val': 1.4652956399231318, 'psi': 0.6185410188656055}-{'f1_val': 0.7259392213627327, 'auprc': 0.774336866783791, 'loss_val': 1.0696113758018861, 'psi': 0.745298279531156}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] START round=98 head_norm_before_train=2.304809 cos_to_last_merge=0.9568 (last merge round=15)
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9975134291737422, 'loss_val': 0.018806366087326117, 'psi': 0.9976984272821523}-{'f1_val': 0.9984758593419994, 'auprc': 0.997152417760069, 'loss_val': 0.01916000770217247, 'psi': 0.9979464827092273}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.464789 (no previous merge yet)
[S15] round=98 local utility u=0.008100 metrics={'f1_val': 0.9369174784300789, 'auprc': 0.9973208147716386, 'loss_val': 0.1047825160098532, 'psi': 0.9610788129667027}-{'f1_val': 0.9348943582185678, 'auprc': 0.9973109247431674, 'loss_val': 0.1088137913824256, 'psi': 0.9598609848284076}
[S15] not sending this round → trigger blocked (psi=0.961)
[S16] START round=98 head_norm_before_train=2.138835 cos_to_last_merge=0.7666 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.767
[S16] round=98 local utility u=0.062687 metrics={'f1_val': 0.9941015615167788, 'auprc': 0.9896622316504513, 'loss_val': 0.029740271597798854, 'psi': 0.9923258295702477}-{'f1_val': 0.9805421853178764, 'auprc': 0.9925875910535156, 'loss_val': 0.08253416425366533, 'psi': 0.9853603476121321}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=98 head_norm_before_train=2.016216 cos_to_last_merge=0.8312 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=98 local utility u=0.000000 metrics={'f1_val': 0.8566018430171558, 'auprc': 0.9731826656314047, 'loss_val': 0.5844723824780741, 'psi': 0.9032341720628553}-{'f1_val': 0.8652024340472994, 'auprc': 0.9637891095067324, 'loss_val': 0.5903408980045455, 'psi': 0.9046371042310726}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=99 head_norm_before_train=2.133541 cos_to_last_merge=0.7499 (last merge round=1)
[S2] ⚠️ Model drifted since last merge! cos=0.750
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.7111380756596687, 'auprc': 0.7314093344294553, 'loss_val': 1.030739141221518, 'psi': 0.7192465791675833}-{'f1_val': 0.7143276281984727, 'auprc': 0.7308502765072656, 'loss_val': 1.0155807801101295, 'psi': 0.7209366875219899}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] r=100 psi=0.719 u=0.0000 p_local=0.0140 f1=0.711 auprc=0.731 bytes=73808
[S3] START round=99 head_norm_before_train=2.600369 (no previous merge yet)
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.9685800182026142, 'auprc': 0.9971012074157078, 'loss_val': 0.07102812035055664, 'psi': 0.9799884938878517}-{'f1_val': 0.9762651561205473, 'auprc': 0.9987937347393931, 'loss_val': 0.10885805791852093, 'psi': 0.9852765875680857}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.980 u=0.0000 p_local=0.1451 f1=0.969 auprc=0.997 bytes=71896
[S4] START round=99 head_norm_before_train=1.903234 cos_to_last_merge=0.8732 (last merge round=11)
[S4] ⚠️ Model drifted since last merge! cos=0.873
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.9550237480036452, 'auprc': 0.9684387633945196, 'loss_val': 0.2934484699694873, 'psi': 0.960389754159995}-{'f1_val': 0.9551825180781917, 'auprc': 0.9749605556909184, 'loss_val': 0.28709128871947637, 'psi': 0.9630937331232824}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.960 u=0.0000 p_local=0.0081 f1=0.955 auprc=0.968 bytes=82840
[S5] START round=99 head_norm_before_train=2.021335 cos_to_last_merge=0.7495 (last merge round=11)
[S5] ⚠️ Model drifted since last merge! cos=0.749
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.9967019684784577, 'auprc': 0.9939534755006179, 'loss_val': 0.023715235109617275, 'psi': 0.9956025712873218}-{'f1_val': 0.9963338119635569, 'auprc': 0.9946286277569941, 'loss_val': 0.021171721693967305, 'psi': 0.9956517382809318}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.996 u=0.0000 p_local=0.0013 f1=0.997 auprc=0.994 bytes=77373
[S6] START round=99 head_norm_before_train=2.130072 cos_to_last_merge=0.8627 (last merge round=11)
[S6] ⚠️ Model drifted since last merge! cos=0.863
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.655108939753203, 'auprc': 0.7219072133404294, 'loss_val': 1.1278669722761285, 'psi': 0.6818282491880936}-{'f1_val': 0.849458689725073, 'auprc': 0.9330123607329722, 'loss_val': 0.34427275677453384, 'psi': 0.8828801581282326}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.682 u=0.0000 p_local=0.2910 f1=0.655 auprc=0.722 bytes=72042
[S7] START round=99 head_norm_before_train=2.098518 cos_to_last_merge=0.7455 (last merge round=1)
[S7] ⚠️ Model drifted since last merge! cos=0.746
[S7] round=99 local utility u=0.182420 metrics={'f1_val': 0.8712439500954838, 'auprc': 0.9320928111657054, 'loss_val': 0.6651664869686469, 'psi': 0.8955834945235726}-{'f1_val': 0.8264841212149138, 'auprc': 0.8996827875542021, 'loss_val': 0.6642176106060813, 'psi': 0.8557635877506291}
[S7] not sending this round → trigger blocked (psi=0.896)
[S7] r=100 psi=0.896 u=0.1824 p_local=0.1552 f1=0.871 auprc=0.932 bytes=79233
[S8] START round=99 head_norm_before_train=2.278529 (no previous merge yet)
[S8] round=99 local utility u=0.006987 metrics={'f1_val': 0.9935462653440466, 'auprc': 0.9991775545738176, 'loss_val': 0.025105622086184, 'psi': 0.995798781035955}-{'f1_val': 0.9917244887003366, 'auprc': 0.9990942950571897, 'loss_val': 0.027900004029729142, 'psi': 0.9946724112430778}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] sending update (kind=head size=1796 to 1 peers)
[S8] r=100 psi=0.996 u=0.0070 p_local=0.0305 f1=0.994 auprc=0.999 bytes=79094
[S9] START round=99 head_norm_before_train=2.332361 cos_to_last_merge=0.9183 (last merge round=11)
[S9] ⚠️ Model drifted since last merge! cos=0.918
[S9] round=99 local utility u=0.000000 metrics={'f1_val': 0.9966857875385419, 'auprc': 0.9985559373402696, 'loss_val': 0.01618486780266597, 'psi': 0.997433847459233}-{'f1_val': 0.9975138174234109, 'auprc': 0.9984851388587009, 'loss_val': 0.0163260320720618, 'psi': 0.9979023459975269}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=100 psi=0.997 u=0.0000 p_local=0.0048 f1=0.997 auprc=0.999 bytes=89972
[S10] START round=99 head_norm_before_train=2.080504 cos_to_last_merge=0.9037 (last merge round=16)
[S10] ⚠️ Model drifted since last merge! cos=0.904
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9933489306849028, 'auprc': 0.9949760257138097, 'loss_val': 0.030372101996582142, 'psi': 0.9939997686964657}-{'f1_val': 0.9937871219080217, 'auprc': 0.9950362456584354, 'loss_val': 0.02966936315165006, 'psi': 0.9942867714081872}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] r=100 psi=0.994 u=0.0000 p_local=0.0004 f1=0.993 auprc=0.995 bytes=80954
[S11] START round=99 head_norm_before_train=2.420486 cos_to_last_merge=0.9249 (last merge round=11)
[S11] ⚠️ Model drifted since last merge! cos=0.925
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.8602415528544671, 'auprc': 0.9952735912608679, 'loss_val': 0.1847854725784254, 'psi': 0.9142543682170274}-{'f1_val': 0.9961541414107454, 'auprc': 0.9932901992475396, 'loss_val': 0.020475854205906797, 'psi': 0.995008564545463}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.914 u=0.0000 p_local=0.0739 f1=0.860 auprc=0.995 bytes=88028
[S13] START round=99 head_norm_before_train=2.059569 (no previous merge yet)
[S13] round=99 local utility u=0.549220 metrics={'f1_val': 0.641415563755099, 'auprc': 0.8436884633093121, 'loss_val': 1.1874836841749035, 'psi': 0.7223247235767842}-{'f1_val': 0.6132486820417847, 'auprc': 0.6264795241013366, 'loss_val': 1.4652956399231318, 'psi': 0.6185410188656055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] sending update (kind=head size=1801 to 1 peers)
[S13] r=100 psi=0.722 u=0.5492 p_local=0.3158 f1=0.641 auprc=0.844 bytes=82732
[S14] START round=99 head_norm_before_train=2.308785 cos_to_last_merge=0.9566 (last merge round=15)
[S14] round=99 local utility u=0.000213 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9971468965729207, 'loss_val': 0.01974904216962042, 'psi': 0.9977985651054913}-{'f1_val': 0.9978217593544257, 'auprc': 0.9975134291737422, 'loss_val': 0.018806366087326117, 'psi': 0.9976984272821523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S14] r=100 psi=0.998 u=0.0002 p_local=0.0584 f1=0.998 auprc=0.997 bytes=82733
[S15] START round=99 head_norm_before_train=2.468280 (no previous merge yet)
[S15] round=99 local utility u=0.015439 metrics={'f1_val': 0.940765571115748, 'auprc': 0.9973346867751334, 'loss_val': 0.09703509859256329, 'psi': 0.9633932173795021}-{'f1_val': 0.9369174784300789, 'auprc': 0.9973208147716386, 'loss_val': 0.1047825160098532, 'psi': 0.9610788129667027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S15] r=100 psi=0.963 u=0.0154 p_local=0.0072 f1=0.941 auprc=0.997 bytes=70079
[S16] START round=99 head_norm_before_train=2.141184 cos_to_last_merge=0.7661 (last merge round=2)
[S16] ⚠️ Model drifted since last merge! cos=0.766
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9930020537123939, 'auprc': 0.9878656649600666, 'loss_val': 0.036458592762922265, 'psi': 0.990947498211463}-{'f1_val': 0.9941015615167788, 'auprc': 0.9896622316504513, 'loss_val': 0.029740271597798854, 'psi': 0.9923258295702477}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.991 u=0.0000 p_local=0.1067 f1=0.993 auprc=0.988 bytes=73719
[S17] START round=99 head_norm_before_train=2.021680 cos_to_last_merge=0.8306 (last merge round=15)
[S17] ⚠️ Model drifted since last merge! cos=0.831
[S17] round=99 local utility u=0.210222 metrics={'f1_val': 0.8993355445747483, 'auprc': 0.9765430862988781, 'loss_val': 0.43051121575900536, 'psi': 0.9302185612644003}-{'f1_val': 0.8566018430171558, 'auprc': 0.9731826656314047, 'loss_val': 0.5844723824780741, 'psi': 0.9032341720628553}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[S17] r=100 psi=0.930 u=0.2102 p_local=0.1626 f1=0.899 auprc=0.977 bytes=73855
[runner] rounds complete.
[runner] all agents stopped.
