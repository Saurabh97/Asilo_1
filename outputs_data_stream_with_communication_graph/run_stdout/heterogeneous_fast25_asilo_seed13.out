[S2] train labels: [(0, 320), (1, 173), (2, 101), (3, 214)]
[S2]   val labels: [(0, 1369), (1, 738), (2, 435), (3, 917)]
✅ Loaded subject S2: train=808, val=3459
[S3] train labels: [(0, 319), (1, 179), (2, 105), (3, 218)]
[S3]   val labels: [(0, 1364), (1, 768), (2, 450), (3, 931)]
✅ Loaded subject S3: train=821, val=3513
[S4] train labels: [(0, 324), (1, 178), (2, 104), (3, 225)]
[S4]   val labels: [(0, 1386), (1, 763), (2, 446), (3, 961)]
✅ Loaded subject S4: train=831, val=3556
[S5] train labels: [(0, 335), (1, 180), (2, 105), (3, 222)]
[S5]   val labels: [(0, 1434), (1, 776), (2, 448), (3, 948)]
✅ Loaded subject S5: train=842, val=3606
[S6] train labels: [(0, 330), (1, 182), (2, 104), (3, 220)]
[S6]   val labels: [(0, 1412), (1, 781), (2, 447), (3, 940)]
✅ Loaded subject S6: train=836, val=3580
[S7] train labels: [(0, 332), (1, 179), (2, 104), (3, 221)]
[S7]   val labels: [(0, 1420), (1, 769), (2, 446), (3, 943)]
✅ Loaded subject S7: train=836, val=3578
[S8] train labels: [(0, 327), (1, 187), (2, 104), (3, 223)]
[S8]   val labels: [(0, 1399), (1, 806), (2, 443), (3, 951)]
✅ Loaded subject S8: train=841, val=3599
[S9] train labels: [(0, 330), (1, 181), (2, 104), (3, 222)]
[S9]   val labels: [(0, 1412), (1, 775), (2, 447), (3, 947)]
✅ Loaded subject S9: train=837, val=3581
[S10] train labels: [(0, 330), (1, 203), (2, 105), (3, 222)]
[S10]   val labels: [(0, 1412), (1, 872), (2, 446), (3, 951)]
✅ Loaded subject S10: train=860, val=3681
[S11] train labels: [(0, 330), (1, 191), (2, 103), (3, 221)]
[S11]   val labels: [(0, 1412), (1, 817), (2, 442), (3, 945)]
✅ Loaded subject S11: train=845, val=3616
[S13] train labels: [(0, 330), (1, 186), (2, 107), (3, 222)]
[S13]   val labels: [(0, 1412), (1, 798), (2, 458), (3, 949)]
✅ Loaded subject S13: train=845, val=3617
[S14] train labels: [(0, 330), (1, 189), (2, 104), (3, 222)]
[S14]   val labels: [(0, 1412), (1, 811), (2, 447), (3, 948)]
✅ Loaded subject S14: train=845, val=3618
[S15] train labels: [(0, 329), (1, 192), (2, 104), (3, 222)]
[S15]   val labels: [(0, 1406), (1, 825), (2, 446), (3, 948)]
✅ Loaded subject S15: train=847, val=3625
[S16] train labels: [(0, 330), (1, 189), (2, 103), (3, 221)]
[S16]   val labels: [(0, 1412), (1, 808), (2, 442), (3, 946)]
✅ Loaded subject S16: train=843, val=3608
[S17] train labels: [(0, 331), (1, 203), (2, 104), (3, 203)]
[S17]   val labels: [(0, 1414), (1, 869), (2, 446), (3, 873)]
✅ Loaded subject S17: train=841, val=3602
[S2] → join 127.0.0.1:54503
[S3] → join 127.0.0.1:54502
[S4] → join 127.0.0.1:54502
[S5] → join 127.0.0.1:54502
[S6] → join 127.0.0.1:54502
[S7] → join 127.0.0.1:54502
[S8] → join 127.0.0.1:54502
[S9] → join 127.0.0.1:54502
[S10] → join 127.0.0.1:54502
[S11] → join 127.0.0.1:54502
[S13] → join 127.0.0.1:54502
[S14] → join 127.0.0.1:54502
[S15] → join 127.0.0.1:54502
[S16] → join 127.0.0.1:54502
[S17] → join 127.0.0.1:54502
[runner] discovery complete 15/15; opening start gate.
[runner] starting lock-step rounds: R=100
[S2] start gate passed; epoch aligned for round 0
[S2] START round=0 head_norm_before_train=1.145290 (no previous merge yet)
[S3] start gate passed; epoch aligned for round 0
[S3] START round=0 head_norm_before_train=1.141690 (no previous merge yet)
[S4] start gate passed; epoch aligned for round 0
[S4] START round=0 head_norm_before_train=1.181229 (no previous merge yet)
[S5] start gate passed; epoch aligned for round 0
[S5] START round=0 head_norm_before_train=1.168913 (no previous merge yet)
[S6] start gate passed; epoch aligned for round 0
[S6] START round=0 head_norm_before_train=1.179128 (no previous merge yet)
[S7] start gate passed; epoch aligned for round 0
[S7] START round=0 head_norm_before_train=1.174330 (no previous merge yet)
[S8] start gate passed; epoch aligned for round 0
[S8] START round=0 head_norm_before_train=1.144935 (no previous merge yet)
[S9] start gate passed; epoch aligned for round 0
[S9] START round=0 head_norm_before_train=1.175231 (no previous merge yet)
[S10] start gate passed; epoch aligned for round 0
[S10] START round=0 head_norm_before_train=1.141222 (no previous merge yet)
[S11] start gate passed; epoch aligned for round 0
[S11] START round=0 head_norm_before_train=1.147916 (no previous merge yet)
[S13] start gate passed; epoch aligned for round 0
[S13] START round=0 head_norm_before_train=1.173706 (no previous merge yet)
[S14] start gate passed; epoch aligned for round 0
[S14] START round=0 head_norm_before_train=1.153604 (no previous merge yet)
[S15] start gate passed; epoch aligned for round 0
[S15] START round=0 head_norm_before_train=1.196121 (no previous merge yet)
[S16] start gate passed; epoch aligned for round 0
[S16] START round=0 head_norm_before_train=1.140839 (no previous merge yet)
[S17] start gate passed; epoch aligned for round 0
[S17] START round=0 head_norm_before_train=1.158956 (no previous merge yet)
[S11]  Welcome: 14 peers known
[S17]  Welcome: 14 peers known
[S5]  Welcome: 14 peers known
[S8]  Welcome: 14 peers known
[S3]  Welcome: 14 peers known
[S13]  Welcome: 14 peers known
[S2]  Welcome: 14 peers known
[S6]  Welcome: 14 peers known
[S4]  Welcome: 14 peers known
[S9]  Welcome: 14 peers known
[S16]  Welcome: 14 peers known
[S14]  Welcome: 14 peers known
[S10]  Welcome: 14 peers known
[S7]  Welcome: 14 peers known
[S15]  Welcome: 14 peers known
[S3] + discovered S5
[S3] + discovered S16
[S3] + discovered S7
[S3] + discovered S15
[S3] + discovered S13
[S3] + discovered S6
[S3] + discovered S9
[S3] + discovered S11
[S3] + discovered S14
[S3] + discovered S4
[S3] + discovered S10
[S3] + discovered S17
[S3] + discovered S8
[S4] + discovered S3
[S4] + discovered S2
[S4] + discovered S13
[S4] + discovered S6
[S4] + discovered S10
[S4] + discovered S16
[S4] + discovered S9
[S5] + discovered S4
[S5] + discovered S2
[S5] + discovered S3
[S4] + discovered S7
[S4] + discovered S5
[S4] + discovered S8
[S4] + discovered S11
[S4] + discovered S14
[S4] + discovered S17
[S4] + discovered S15
[S5] + discovered S14
[S5] + discovered S8
[S6] + discovered S2
[S6] + discovered S3
[S5] + discovered S13
[S5] + discovered S9
[S6] + discovered S5
[S5] + discovered S7
[S5] + discovered S10
[S6] + discovered S4
[S5] + discovered S17
[S5] + discovered S11
[S5] + discovered S6
[S5] + discovered S16
[S5] + discovered S15
[S6] + discovered S7
[S7] + discovered S3
[S7] + discovered S4
[S7] + discovered S5
[S7] + discovered S6
[S6] + discovered S13
[S6] + discovered S15
[S6] + discovered S9
[S6] + discovered S11
[S7] + discovered S2
[S6] + discovered S10
[S6] + discovered S8
[S6] + discovered S17
[S6] + discovered S14
[S6] + discovered S16
[S8] + discovered S6
[S8] + discovered S2
[S7] + discovered S13
[S7] + discovered S9
[S8] + discovered S7
[S8] + discovered S4
[S7] + discovered S10
[S7] + discovered S15
[S8] + discovered S5
[S8] + discovered S3
[S7] + discovered S16
[S7] + discovered S14
[S7] + discovered S17
[S7] + discovered S8
[S7] + discovered S11
[S9] + discovered S3
[S9] + discovered S5
[S8] + discovered S15
[S9] + discovered S7
[S9] + discovered S6
[S8] + discovered S17
[S9] + discovered S4
[S9] + discovered S8
[S9] + discovered S2
[S8] + discovered S11
[S8] + discovered S14
[S8] + discovered S16
[S8] + discovered S13
[S8] + discovered S10
[S8] + discovered S9
[S10] + discovered S9
[S10] + discovered S7
[S10] + discovered S3
[S10] + discovered S8
[S9] + discovered S14
[S9] + discovered S10
[S10] + discovered S2
[S10] + discovered S5
[S10] + discovered S4
[S10] + discovered S6
[S9] + discovered S13
[S9] + discovered S17
[S9] + discovered S11
[S9] + discovered S15
[S9] + discovered S16
[S11] + discovered S9
[S10] + discovered S17
[S11] + discovered S8
[S11] + discovered S4
[S11] + discovered S10
[S11] + discovered S6
[S11] + discovered S5
[S10] + discovered S13
[S10] + discovered S16
[S10] + discovered S14
[S11] + discovered S3
[S10] + discovered S15
[S11] + discovered S7
[S10] + discovered S11
[S11] + discovered S2
[S11] + discovered S13
[S13] + discovered S8
[S13] + discovered S7
[S13] + discovered S5
[S13] + discovered S3
[S13] + discovered S6
[S11] + discovered S14
[S11] + discovered S16
[S13] + discovered S10
[S13] + discovered S4
[S13] + discovered S2
[S13] + discovered S11
[S13] + discovered S9
[S11] + discovered S15
[S11] + discovered S17
[S14] + discovered S10
[S14] + discovered S11
[S14] + discovered S13
[S14] + discovered S9
[S14] + discovered S4
[S13] + discovered S17
[S13] + discovered S16
[S14] + discovered S7
[S14] + discovered S3
[S14] + discovered S6
[S14] + discovered S2
[S14] + discovered S5
[S13] + discovered S15
[S13] + discovered S14
[S14] + discovered S8
[S15] + discovered S10
[S14] + discovered S16
[S15] + discovered S6
[S15] + discovered S14
[S15] + discovered S11
[S14] + discovered S15
[S15] + discovered S5
[S15] + discovered S13
[S15] + discovered S2
[S15] + discovered S8
[S15] + discovered S4
[S14] + discovered S17
[S15] + discovered S9
[S15] + discovered S3
[S15] + discovered S7
[S16] + discovered S14
[S16] + discovered S8
[S16] + discovered S15
[S16] + discovered S13
[S16] + discovered S4
[S16] + discovered S7
[S16] + discovered S9
[S16] + discovered S2
[S16] + discovered S5
[S15] + discovered S16
[S16] + discovered S3
[S15] + discovered S17
[S16] + discovered S6
[S16] + discovered S11
[S16] + discovered S10
[S17] + discovered S8
[S17] + discovered S9
[S17] + discovered S3
[S17] + discovered S15
[S17] + discovered S11
[S17] + discovered S13
[S17] + discovered S14
[S16] + discovered S17
[S17] + discovered S2
[S17] + discovered S5
[S17] + discovered S10
[S17] + discovered S4
[S17] + discovered S7
[S17] + discovered S6
[S17] + discovered S16
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S13] ⇄ pheromone p=1.000 → S10@127.0.0.1:54511
[S9] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S6] ⇄ pheromone p=1.000 → S7@127.0.0.1:54508
[S16] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S8] ⇄ pheromone p=1.000 → S5@127.0.0.1:54505
[S15] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S11] ⇄ pheromone p=1.000 → S2@127.0.0.1:54502
[S7] ⇄ pheromone p=1.000 → S13@127.0.0.1:54513
[S5] ⇄ pheromone p=1.000 → S3@127.0.0.1:54503
[S2] ⇄ pheromone p=1.000 → S6@127.0.0.1:54507
[S3] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S4] ⇄ pheromone p=1.000 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=1.000 → S8@127.0.0.1:54509
[S2] START round=1 head_norm_before_train=1.147746 (no previous merge yet)
[S2] round=1 local utility u=0.000000 metrics={'f1_val': 0.10477605118829982, 'auprc': 0.6362371998426897, 'loss_val': 1.327400123762622, 'psi': 0.31736051065005577}-{'f1_val': 0.10477605118829982, 'auprc': 0.7336674743825338, 'loss_val': 1.370447929130194, 'psi': 0.3563326204659934}
[S3] START round=1 head_norm_before_train=1.146925 (no previous merge yet)
[S3] round=1 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.9994440521400102, 'loss_val': 1.2987400228995667, 'psi': 0.48368166022446835}-{'f1_val': 0.19646472143347757, 'auprc': 0.9403317714268716, 'loss_val': 1.3569920856447795, 'psi': 0.4940115414308352}
[S4] START round=1 head_norm_before_train=1.178919 (no previous merge yet)
[S4] round=1 local utility u=0.000000 metrics={'f1_val': 0.39871425926631776, 'auprc': 0.7533110907583183, 'loss_val': 1.309986145520314, 'psi': 0.540552991863118}-{'f1_val': 0.4237327379054694, 'auprc': 0.7518552405857046, 'loss_val': 1.346484527879748, 'psi': 0.5549817389775635}
[S5] START round=1 head_norm_before_train=1.169910 (no previous merge yet)
[S5] round=1 local utility u=0.000000 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7661647705436518, 'loss_val': 1.2843146490693227, 'psi': 0.39182305107460363}-{'f1_val': 0.3936221224373692, 'auprc': 0.7566817369592, 'loss_val': 1.3549747022367282, 'psi': 0.5388459682461015}
[S6] START round=1 head_norm_before_train=1.182481 (no previous merge yet)
[S6] round=1 local utility u=0.146982 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7974900961818999, 'loss_val': 1.314975486584487, 'psi': 0.4038518077035292}-{'f1_val': 0.14142628205128205, 'auprc': 0.7106332879072288, 'loss_val': 1.3483695720851259, 'psi': 0.36910908439366075}
[S7] START round=1 head_norm_before_train=1.167683 (no previous merge yet)
[S7] round=1 local utility u=0.095624 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7807133198753827, 'loss_val': 1.3083460563620501, 'psi': 0.3975194215876081}-{'f1_val': 0.14205682272909165, 'auprc': 0.7334921835149502, 'loss_val': 1.3579306557955018, 'psi': 0.3786309670434351}
[S8] START round=1 head_norm_before_train=1.148345 (no previous merge yet)
[S8] round=1 local utility u=0.746761 metrics={'f1_val': 0.20758671112821497, 'auprc': 0.6588495068829456, 'loss_val': 1.3375796596695235, 'psi': 0.3880918294301073}-{'f1_val': 0.10450549450549451, 'auprc': 0.38024261473367066, 'loss_val': 1.3767929791112126, 'psi': 0.214800342596765}
[S9] START round=1 head_norm_before_train=1.196851 (no previous merge yet)
[S9] round=1 local utility u=0.226704 metrics={'f1_val': 0.141397957139996, 'auprc': 0.9944472863107825, 'loss_val': 1.2328462554623965, 'psi': 0.48261768880831063}-{'f1_val': 0.141397957139996, 'auprc': 0.8688605869012072, 'loss_val': 1.3094951253876277, 'psi': 0.4323830090444805}
[S10] START round=1 head_norm_before_train=1.152977 (no previous merge yet)
[S10] round=1 local utility u=0.066170 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.8008691432821148, 'loss_val': 1.3035011763091258, 'psi': 0.4035206398378803}-{'f1_val': 0.13862163754172394, 'auprc': 0.7654867618527028, 'loss_val': 1.329693829520619, 'psi': 0.3893676872661155}
[S11] START round=1 head_norm_before_train=1.151429 (no previous merge yet)
[S11] round=1 local utility u=0.284693 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5251255020967844, 'loss_val': 1.3334903789289607, 'psi': 0.29429841086258013}-{'f1_val': 0.14041368337311058, 'auprc': 0.3451235870068141, 'loss_val': 1.3628711887517724, 'psi': 0.222297644826592}
[S13] START round=1 head_norm_before_train=1.176742 (no previous merge yet)
[S13] round=1 local utility u=0.637452 metrics={'f1_val': 0.4160404975377924, 'auprc': 0.5431122722166124, 'loss_val': 1.3197177356543486, 'psi': 0.46686920740932036}-{'f1_val': 0.22123921142716854, 'auprc': 0.5199060974151335, 'loss_val': 1.3561964898032888, 'psi': 0.3407059658223545}
[S14] START round=1 head_norm_before_train=1.155347 (no previous merge yet)
[S14] round=1 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7267178592105563, 'loss_val': 1.3465794190745315, 'psi': 0.3749018554138448}-{'f1_val': 0.3133201873338587, 'auprc': 0.6802575232939809, 'loss_val': 1.3736452140396145, 'psi': 0.4600951217179076}
[S15] START round=1 head_norm_before_train=1.201007 (no previous merge yet)
[S15] round=1 local utility u=0.000000 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7698753896321123, 'loss_val': 1.3255580668397897, 'psi': 0.39179034666977997}-{'f1_val': 0.3632417196103795, 'auprc': 0.7795480090230582, 'loss_val': 1.361472039141618, 'psi': 0.529764235375451}
[S16] START round=1 head_norm_before_train=1.153959 (no previous merge yet)
[S16] round=1 local utility u=0.000000 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8429837692148778, 'loss_val': 1.3157912458322383, 'psi': 0.42157597780547307}-{'f1_val': 0.16563702407526412, 'auprc': 0.8332452918985814, 'loss_val': 1.3463775119514516, 'psi': 0.4326803312045911}
[S17] START round=1 head_norm_before_train=1.164217 (no previous merge yet)
[S17] round=1 local utility u=0.039412 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.457568634913583, 'loss_val': 1.3401573052764932, 'psi': 0.2675968319558638}-{'f1_val': 0.14094896331738438, 'auprc': 0.44047098732211765, 'loss_val': 1.367687712993486, 'psi': 0.2607577729192777}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S7] → sending delta(kind=head bytes=1790) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S13] → sending delta(kind=head bytes=1788) to S16@127.0.0.1:54516
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S8] → sending delta(kind=head bytes=1787) to S9@127.0.0.1:54510
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S10] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S6] → sending delta(kind=head bytes=1787) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1781 reason=None
[S17] → sending delta(kind=head bytes=1781) to S15@127.0.0.1:54515
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1791 to 1 peers)
[S13] sending update (kind=head size=1788 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1787 to 1 peers)
[S8] sending update (kind=head size=1787 to 1 peers)
[S7] sending update (kind=head size=1790 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1790) from S7
[S11] cosine check vs S7: cos=0.1123
[S7] RECEIVED delta(kind=head bytes=1787) from S6
[S7] cosine check vs S6: cos=0.0071
[S10] RECEIVED delta(kind=head bytes=1802) from S9
[S10] cosine check vs S9: cos=0.0245
[S9] RECEIVED delta(kind=head bytes=1787) from S8
[S9] cosine check vs S8: cos=0.0085
[S17] RECEIVED delta(kind=head bytes=1797) from S11
[S17] cosine check vs S11: cos=0.0648
[S16] RECEIVED delta(kind=head bytes=1788) from S13
[S16] cosine check vs S13: cos=-0.0008
[S16] DROPPED delta from S13 (cos=-0.0008 < 0.0)
[S11] RECEIVED delta(kind=head bytes=1791) from S10
[S11] cosine check vs S10: cos=-0.0206
[S11] DROPPED delta from S10 (cos=-0.0206 < 0.0)
[S17] sending update (kind=head size=1781 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1781) from S17
[S15] cosine check vs S17: cos=-0.0794
[S15] DROPPED delta from S17 (cos=-0.0794 < 0.0)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=1 metric=0.1414 head_norm=1.244174
[S9] _apply_head_vector_avg (torch): Δ‖w‖=8.480810e-01
[S9] stored merged vector for next round verification (round=1)
[S9] DEBUG after merge:  round=1 metric=0.1414 head_norm=0.855346 delta_norm=0.848081
[S9] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=1 metric=0.1404 head_norm=1.164107
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.832804e-01
[S11] stored merged vector for next round verification (round=1)
[S11] DEBUG after merge:  round=1 metric=0.1404 head_norm=0.876765 delta_norm=0.783280
[S11] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=1 metric=0.1386 head_norm=1.172519
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.442994e-01
[S10] stored merged vector for next round verification (round=1)
[S10] DEBUG after merge:  round=1 metric=0.1386 head_norm=0.865184 delta_norm=0.844299
[S10] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=1 metric=0.1421 head_norm=1.187159
[S7] _apply_head_vector_avg (torch): Δ‖w‖=8.403592e-01
[S7] stored merged vector for next round verification (round=1)
[S7] DEBUG after merge:  round=1 metric=0.1421 head_norm=0.846323 delta_norm=0.840359
[S7] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=1 metric=0.1409 head_norm=1.181754
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.021097e-01
[S17] stored merged vector for next round verification (round=1)
[S17] DEBUG after merge:  round=1 metric=0.1409 head_norm=0.855841 delta_norm=0.802110
[S17] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=2 head_norm_before_train=1.161926 (no previous merge yet)
[S2] round=2 local utility u=0.380548 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7975876437590914, 'loss_val': 1.272361234648146, 'psi': 0.40410133753677663}-{'f1_val': 0.10477605118829982, 'auprc': 0.6362371998426897, 'loss_val': 1.327400123762622, 'psi': 0.31736051065005577}
[S3] START round=2 head_norm_before_train=1.178263 (no previous merge yet)
[S3] round=2 local utility u=0.000000 metrics={'f1_val': 0.13984006561410703, 'auprc': 0.8172983479327651, 'loss_val': 1.2100290266954716, 'psi': 0.41082337854157025}-{'f1_val': 0.13984006561410703, 'auprc': 0.9994440521400102, 'loss_val': 1.2987400228995667, 'psi': 0.48368166022446835}
[S4] START round=2 head_norm_before_train=1.189828 (no previous merge yet)
[S4] round=2 local utility u=0.000000 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7532854625263609, 'loss_val': 1.2650239041085654, 'psi': 0.38545016234765483}-{'f1_val': 0.39871425926631776, 'auprc': 0.7533110907583183, 'loss_val': 1.309986145520314, 'psi': 0.540552991863118}
[S5] START round=2 head_norm_before_train=1.198503 (no previous merge yet)
[S5] round=2 local utility u=0.072300 metrics={'f1_val': 0.14226190476190476, 'auprc': 0.7699900271485551, 'loss_val': 1.1511895157218017, 'psi': 0.39335315371656493}-{'f1_val': 0.14226190476190476, 'auprc': 0.7661647705436518, 'loss_val': 1.2843146490693227, 'psi': 0.39182305107460363}
[S6] START round=2 head_norm_before_train=1.198159 (no previous merge yet)
[S6] round=2 local utility u=0.121983 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.8654849937024935, 'loss_val': 1.2749933401750484, 'psi': 0.43104976671176665}-{'f1_val': 0.14142628205128205, 'auprc': 0.7974900961818999, 'loss_val': 1.314975486584487, 'psi': 0.4038518077035292}
[S7] START round=2 head_norm_before_train=0.846323 cos_to_last_merge=1.0000 (last merge round=1)
[S7] round=2 local utility u=0.027541 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7925793956756677, 'loss_val': 1.2888615351755182, 'psi': 0.40226585190772207}-{'f1_val': 0.14205682272909165, 'auprc': 0.7807133198753827, 'loss_val': 1.3083460563620501, 'psi': 0.3975194215876081}
[S8] START round=2 head_norm_before_train=1.163506 (no previous merge yet)
[S8] round=2 local utility u=0.000000 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7151031968214913, 'loss_val': 1.2952523070150672, 'psi': 0.37001486816437085}-{'f1_val': 0.20758671112821497, 'auprc': 0.6588495068829456, 'loss_val': 1.3375796596695235, 'psi': 0.3880918294301073}
[S9] START round=2 head_norm_before_train=0.855346 cos_to_last_merge=1.0000 (last merge round=1)
[S9] round=2 local utility u=0.000000 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8061234732329564, 'loss_val': 1.1821684693875936, 'psi': 0.4072881635771802}-{'f1_val': 0.141397957139996, 'auprc': 0.9944472863107825, 'loss_val': 1.2328462554623965, 'psi': 0.48261768880831063}
[S10] START round=2 head_norm_before_train=0.865184 cos_to_last_merge=1.0000 (last merge round=1)
[S10] round=2 local utility u=0.000000 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.6317188587081258, 'loss_val': 1.3057746557059577, 'psi': 0.3358605260082847}-{'f1_val': 0.13862163754172394, 'auprc': 0.8008691432821148, 'loss_val': 1.3035011763091258, 'psi': 0.4035206398378803}
[S11] START round=2 head_norm_before_train=0.876765 cos_to_last_merge=1.0000 (last merge round=1)
[S11] round=2 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.5038338021925571, 'loss_val': 1.3336581772934994, 'psi': 0.2857817309008892}-{'f1_val': 0.14041368337311058, 'auprc': 0.5251255020967844, 'loss_val': 1.3334903789289607, 'psi': 0.29429841086258013}
[S13] START round=2 head_norm_before_train=1.191809 (no previous merge yet)
[S13] round=2 local utility u=0.000000 metrics={'f1_val': 0.21513764187422185, 'auprc': 0.5566000124762933, 'loss_val': 1.2760842339802763, 'psi': 0.35172259011505047}-{'f1_val': 0.4160404975377924, 'auprc': 0.5431122722166124, 'loss_val': 1.3197177356543486, 'psi': 0.46686920740932036}
[S14] START round=2 head_norm_before_train=1.167932 (no previous merge yet)
[S14] round=2 local utility u=0.022513 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.731509477062825, 'loss_val': 1.3159290289741323, 'psi': 0.37681850255475224}-{'f1_val': 0.14035785288270378, 'auprc': 0.7267178592105563, 'loss_val': 1.3465794190745315, 'psi': 0.3749018554138448}
[S15] START round=2 head_norm_before_train=1.215529 (no previous merge yet)
[S15] round=2 local utility u=0.020867 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7699926090115214, 'loss_val': 1.2841750277901582, 'psi': 0.3918372344215436}-{'f1_val': 0.13973365136155833, 'auprc': 0.7698753896321123, 'loss_val': 1.3255580668397897, 'psi': 0.39179034666977997}
[S16] START round=2 head_norm_before_train=1.173218 (no previous merge yet)
[S16] round=2 local utility u=0.028126 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.8483146281186001, 'loss_val': 1.2755320119424047, 'psi': 0.423708321366962}-{'f1_val': 0.14063745019920318, 'auprc': 0.8429837692148778, 'loss_val': 1.3157912458322383, 'psi': 0.42157597780547307}
[S17] START round=2 head_norm_before_train=0.855841 cos_to_last_merge=1.0000 (last merge round=1)
[S17] round=2 local utility u=0.048859 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.4862117855214784, 'loss_val': 1.3283692732836332, 'psi': 0.279054092199022}-{'f1_val': 0.14094896331738438, 'auprc': 0.457568634913583, 'loss_val': 1.3401573052764932, 'psi': 0.2675968319558638}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S4@127.0.0.1:54504
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S6] → sending delta(kind=head bytes=1791) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S4@127.0.0.1:54504
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1786 reason=None
[S16] → sending delta(kind=head bytes=1786) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S15] → sending delta(kind=head bytes=1791) to S6@127.0.0.1:54507
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S2] → sending delta(kind=head bytes=1788) to S13@127.0.0.1:54513
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[S5] sending update (kind=head size=1793 to 1 peers)
[S2] sending update (kind=head size=1788 to 1 peers)
[S6] sending update (kind=head size=1791 to 1 peers)
[S15] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1786 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1791) from S6
[S10] cosine check vs S6: cos=0.1133
[S4] RECEIVED delta(kind=head bytes=1796) from S7
[S4] cosine check vs S7: cos=-0.0255
[S4] DROPPED delta from S7 (cos=-0.0255 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1793) from S5
[S2] cosine check vs S5: cos=-0.0762
[S2] DROPPED delta from S5 (cos=-0.0762 < 0.0)
[S6] RECEIVED delta(kind=head bytes=1791) from S15
[S6] cosine check vs S15: cos=-0.0342
[S6] DROPPED delta from S15 (cos=-0.0342 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1786) from S16
[S15] cosine check vs S16: cos=0.0898
[S13] RECEIVED delta(kind=head bytes=1788) from S2
[S13] cosine check vs S2: cos=-0.0831
[S13] DROPPED delta from S2 (cos=-0.0831 < 0.0)
[S4] RECEIVED delta(kind=head bytes=1792) from S14
[S4] cosine check vs S14: cos=0.0268
[S17] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S17
[S10] cosine check vs S17: cos=-0.0486
[S10] DROPPED delta from S17 (cos=-0.0486 < 0.0)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=2 metric=0.1386 head_norm=0.884907
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.133918e-01
[S10] stored merged vector for next round verification (round=2)
[S10] DEBUG after merge:  round=2 metric=0.1386 head_norm=0.794772 delta_norm=0.713392
[S10] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S4] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S4] DEBUG before merge: round=2 metric=0.1402 head_norm=1.214586
[S4] _apply_head_vector_avg (torch): Δ‖w‖=8.384385e-01
[S4] stored merged vector for next round verification (round=2)
[S4] DEBUG after merge:  round=2 metric=0.1402 head_norm=0.861239 delta_norm=0.838438
[S4] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=2 metric=0.1397 head_norm=1.239159
[S15] _apply_head_vector_avg (torch): Δ‖w‖=8.226267e-01
[S15] stored merged vector for next round verification (round=2)
[S15] DEBUG after merge:  round=2 metric=0.1397 head_norm=0.900083 delta_norm=0.822627
[S15] aggregate: ACCEPT kept=['S16'] (k=1/1) mode=median trim_p=0.1
[S2] START round=3 head_norm_before_train=1.186084 (no previous merge yet)
[S2] round=3 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7569509899490543, 'loss_val': 1.2086300894278192, 'psi': 0.3878466760127618}-{'f1_val': 0.1417771333885667, 'auprc': 0.7975876437590914, 'loss_val': 1.272361234648146, 'psi': 0.40410133753677663}
[S3] START round=3 head_norm_before_train=1.231592 (no previous merge yet)
[S3] round=3 local utility u=1.000000 metrics={'f1_val': 0.396483704974271, 'auprc': 0.9977484950127785, 'loss_val': 1.0482390523508325, 'psi': 0.6369896209896739}-{'f1_val': 0.13984006561410703, 'auprc': 0.8172983479327651, 'loss_val': 1.2100290266954716, 'psi': 0.41082337854157025}
[S4] START round=3 head_norm_before_train=0.861239 cos_to_last_merge=1.0000 (last merge round=2)
[S4] round=3 local utility u=0.037235 metrics={'f1_val': 0.14022662889518414, 'auprc': 0.7804308729870949, 'loss_val': 1.2719902989282785, 'psi': 0.3963083265319485}-{'f1_val': 0.14022662889518414, 'auprc': 0.7532854625263609, 'loss_val': 1.2650239041085654, 'psi': 0.38545016234765483}
[S5] START round=3 head_norm_before_train=1.249895 (no previous merge yet)
[S5] round=3 local utility u=0.946035 metrics={'f1_val': 0.4175873768787894, 'auprc': 0.7746275523204157, 'loss_val': 0.9249848516091276, 'psi': 0.56040344705544}-{'f1_val': 0.14226190476190476, 'auprc': 0.7699900271485551, 'loss_val': 1.1511895157218017, 'psi': 0.39335315371656493}
[S6] START round=3 head_norm_before_train=1.223978 (no previous merge yet)
[S6] round=3 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.7256992102508193, 'loss_val': 1.2263626373207686, 'psi': 0.37513545333109694}-{'f1_val': 0.14142628205128205, 'auprc': 0.8654849937024935, 'loss_val': 1.2749933401750484, 'psi': 0.43104976671176665}
[S7] START round=3 head_norm_before_train=0.884177 cos_to_last_merge=0.9938 (last merge round=1)
[S7] round=3 local utility u=0.016794 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7947165424899842, 'loss_val': 1.261685033280177, 'psi': 0.40312071063344873}-{'f1_val': 0.14205682272909165, 'auprc': 0.7925793956756677, 'loss_val': 1.2888615351755182, 'psi': 0.40226585190772207}
[S8] START round=3 head_norm_before_train=1.185345 (no previous merge yet)
[S8] round=3 local utility u=0.059595 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7386171028866052, 'loss_val': 1.2466036914937644, 'psi': 0.3794204305904164}-{'f1_val': 0.13995598239295717, 'auprc': 0.7151031968214913, 'loss_val': 1.2952523070150672, 'psi': 0.37001486816437085}
[S9] START round=3 head_norm_before_train=0.917429 cos_to_last_merge=0.9919 (last merge round=1)
[S9] round=3 local utility u=0.143892 metrics={'f1_val': 0.141397957139996, 'auprc': 0.8269708132175085, 'loss_val': 0.9569264721372395, 'psi': 0.415627099571001}-{'f1_val': 0.141397957139996, 'auprc': 0.8061234732329564, 'loss_val': 1.1821684693875936, 'psi': 0.4072881635771802}
[S10] START round=3 head_norm_before_train=0.794772 cos_to_last_merge=1.0000 (last merge round=2)
[S10] round=3 local utility u=0.226197 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7850228318897956, 'loss_val': 1.3132932242841908, 'psi': 0.3971821152809526}-{'f1_val': 0.13862163754172394, 'auprc': 0.6317188587081258, 'loss_val': 1.3057746557059577, 'psi': 0.3358605260082847}
[S11] START round=3 head_norm_before_train=0.888242 cos_to_last_merge=0.9972 (last merge round=1)
[S11] round=3 local utility u=0.310467 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.6991701204738159, 'loss_val': 1.298732646146935, 'psi': 0.3639162582133927}-{'f1_val': 0.14041368337311058, 'auprc': 0.5038338021925571, 'loss_val': 1.3336581772934994, 'psi': 0.2857817309008892}
[S13] START round=3 head_norm_before_train=1.216680 (no previous merge yet)
[S13] round=3 local utility u=0.000000 metrics={'f1_val': 0.17010740103172195, 'auprc': 0.5647496903998545, 'loss_val': 1.2235217395443947, 'psi': 0.327964316778975}-{'f1_val': 0.21513764187422185, 'auprc': 0.5566000124762933, 'loss_val': 1.2760842339802763, 'psi': 0.35172259011505047}
[S14] START round=3 head_norm_before_train=1.189203 (no previous merge yet)
[S14] round=3 local utility u=0.020544 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7322358922858401, 'loss_val': 1.2770201512737462, 'psi': 0.37710906864395827}-{'f1_val': 0.14035785288270378, 'auprc': 0.731509477062825, 'loss_val': 1.3159290289741323, 'psi': 0.37681850255475224}
[S15] START round=3 head_norm_before_train=0.900083 cos_to_last_merge=1.0000 (last merge round=2)
[S15] round=3 local utility u=0.002826 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7684690900959606, 'loss_val': 1.2739531647752613, 'psi': 0.39122782685531926}-{'f1_val': 0.13973365136155833, 'auprc': 0.7699926090115214, 'loss_val': 1.2841750277901582, 'psi': 0.3918372344215436}
[S16] START round=3 head_norm_before_train=1.199256 (no previous merge yet)
[S16] round=3 local utility u=0.241793 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9924626407504878, 'loss_val': 1.224390679222904, 'psi': 0.48136752641971703}-{'f1_val': 0.14063745019920318, 'auprc': 0.8483146281186001, 'loss_val': 1.2755320119424047, 'psi': 0.423708321366962}
[S17] START round=3 head_norm_before_train=0.880750 cos_to_last_merge=0.9971 (last merge round=1)
[S17] round=3 local utility u=0.079821 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5245281585444433, 'loss_val': 1.2836771228818038, 'psi': 0.29438064140820797}-{'f1_val': 0.14094896331738438, 'auprc': 0.4862117855214784, 'loss_val': 1.3283692732836332, 'psi': 0.279054092199022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S16] → sending delta(kind=head bytes=1788) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1788 reason=None
[S14] → sending delta(kind=head bytes=1788) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S8] → sending delta(kind=head bytes=1791) to S5@127.0.0.1:54505
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S5] sending update (kind=head size=1794 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1791 to 1 peers)
[S16] sending update (kind=head size=1788 to 1 peers)
[S7] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S14] sending update (kind=head size=1788 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1798 to 1 peers)
[S3] sending update (kind=head size=1795 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1791) from S8
[S5] cosine check vs S8: cos=-0.0946
[S5] DROPPED delta from S8 (cos=-0.0946 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=-0.0578
[S13] DROPPED delta from S7 (cos=-0.0578 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1794) from S5
[S3] cosine check vs S5: cos=-0.0888
[S3] DROPPED delta from S5 (cos=-0.0888 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.0997
[S14] RECEIVED delta(kind=head bytes=1795) from S3
[S14] cosine check vs S3: cos=0.0039
[S14] RECEIVED delta(kind=head bytes=1788) from S16
[S14] cosine check vs S16: cos=-0.0213
[S14] DROPPED delta from S16 (cos=-0.0213 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1788) from S14
[S7] cosine check vs S14: cos=-0.0957
[S7] DROPPED delta from S14 (cos=-0.0957 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S15
[S14] cosine check vs S15: cos=0.0033
[S5] RECEIVED delta(kind=head bytes=1798) from S10
[S5] cosine check vs S10: cos=-0.1017
[S5] DROPPED delta from S10 (cos=-0.1017 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.0042
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.6873
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S17] → sending delta(kind=head bytes=1792) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1792 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1792) from S17
[S8] cosine check vs S17: cos=-0.0208
[S8] DROPPED delta from S17 (cos=-0.0208 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=3 metric=0.1418 head_norm=1.216282
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.581002e-01
[S2] stored merged vector for next round verification (round=3)
[S2] DEBUG after merge:  round=3 metric=0.1418 head_norm=0.761168 delta_norm=0.758100
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=3 metric=0.1421 head_norm=0.921996
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.441270e-01
[S7] stored merged vector for next round verification (round=3)
[S7] DEBUG after merge:  round=3 metric=0.1421 head_norm=0.711661 delta_norm=0.644127
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=3 metric=0.1404 head_norm=1.221727
[S14] _apply_head_vector_avg (torch): Δ‖w‖=5.792876e-01
[S14] stored merged vector for next round verification (round=3)
[S14] DEBUG after merge:  round=3 metric=0.1404 head_norm=0.772864 delta_norm=0.579288
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S2] START round=4 head_norm_before_train=0.761168 cos_to_last_merge=1.0000 (last merge round=3)
[S2] round=4 local utility u=0.000000 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7544422906137503, 'loss_val': 1.2236994380799215, 'psi': 0.3868431962786402}-{'f1_val': 0.1417771333885667, 'auprc': 0.7569509899490543, 'loss_val': 1.2086300894278192, 'psi': 0.3878466760127618}
[S3] START round=4 head_norm_before_train=1.282340 (no previous merge yet)
[S3] round=4 local utility u=0.613139 metrics={'f1_val': 0.5450215858923251, 'auprc': 0.9989010291357941, 'loss_val': 0.7166450556379512, 'psi': 0.7265733631897127}-{'f1_val': 0.396483704974271, 'auprc': 0.9977484950127785, 'loss_val': 1.0482390523508325, 'psi': 0.6369896209896739}
[S4] START round=4 head_norm_before_train=0.886528 cos_to_last_merge=0.9971 (last merge round=2)
[S4] round=4 local utility u=0.040440 metrics={'f1_val': 0.14159059035220026, 'auprc': 0.7819200893335057, 'loss_val': 1.203762307485793, 'psi': 0.3977223899447224}-{'f1_val': 0.14022662889518414, 'auprc': 0.7804308729870949, 'loss_val': 1.2719902989282785, 'psi': 0.3963083265319485}
[S5] START round=4 head_norm_before_train=1.302445 (no previous merge yet)
[S5] round=4 local utility u=1.000000 metrics={'f1_val': 0.714986591715879, 'auprc': 0.7944987204004197, 'loss_val': 0.7324909552465293, 'psi': 0.7467914431896953}-{'f1_val': 0.4175873768787894, 'auprc': 0.7746275523204157, 'loss_val': 0.9249848516091276, 'psi': 0.56040344705544}
[S6] START round=4 head_norm_before_train=1.258735 (no previous merge yet)
[S6] round=4 local utility u=0.000000 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6455935922690674, 'loss_val': 1.1847301421827565, 'psi': 0.34309320613839617}-{'f1_val': 0.14142628205128205, 'auprc': 0.7256992102508193, 'loss_val': 1.2263626373207686, 'psi': 0.37513545333109694}
[S7] START round=4 head_norm_before_train=0.711661 cos_to_last_merge=1.0000 (last merge round=3)
[S7] round=4 local utility u=0.000904 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7900834994868456, 'loss_val': 1.2459786827654944, 'psi': 0.40126749343219326}-{'f1_val': 0.14205682272909165, 'auprc': 0.7947165424899842, 'loss_val': 1.261685033280177, 'psi': 0.40312071063344873}
[S8] START round=4 head_norm_before_train=1.215434 (no previous merge yet)
[S8] round=4 local utility u=0.065572 metrics={'f1_val': 0.13995598239295717, 'auprc': 0.7661225113242125, 'loss_val': 1.1979757935035373, 'psi': 0.39042259396545936}-{'f1_val': 0.13995598239295717, 'auprc': 0.7386171028866052, 'loss_val': 1.2466036914937644, 'psi': 0.3794204305904164}
[S9] START round=4 head_norm_before_train=0.996316 cos_to_last_merge=0.9737 (last merge round=1)
[S9] round=4 local utility u=1.000000 metrics={'f1_val': 0.7017586747191817, 'auprc': 0.9999818465253945, 'loss_val': 0.5687463689233263, 'psi': 0.8210479434416669}-{'f1_val': 0.141397957139996, 'auprc': 0.8269708132175085, 'loss_val': 0.9569264721372395, 'psi': 0.415627099571001}
[S10] START round=4 head_norm_before_train=0.812544 cos_to_last_merge=0.9969 (last merge round=2)
[S10] round=4 local utility u=0.028165 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7912356105344909, 'loss_val': 1.2756021430693307, 'psi': 0.3996672267388307}-{'f1_val': 0.13862163754172394, 'auprc': 0.7850228318897956, 'loss_val': 1.3132932242841908, 'psi': 0.3971821152809526}
[S11] START round=4 head_norm_before_train=0.910408 cos_to_last_merge=0.9890 (last merge round=1)
[S11] round=4 local utility u=0.223356 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8351489234472771, 'loss_val': 1.2599575555215772, 'psi': 0.4183077794027772}-{'f1_val': 0.14041368337311058, 'auprc': 0.6991701204738159, 'loss_val': 1.298732646146935, 'psi': 0.3639162582133927}
[S13] START round=4 head_norm_before_train=1.245752 (no previous merge yet)
[S13] round=4 local utility u=0.756132 metrics={'f1_val': 0.4016298527535085, 'auprc': 0.5801090395283317, 'loss_val': 1.1464704693988996, 'psi': 0.4730215274634378}-{'f1_val': 0.17010740103172195, 'auprc': 0.5647496903998545, 'loss_val': 1.2235217395443947, 'psi': 0.327964316778975}
[S14] START round=4 head_norm_before_train=0.772864 cos_to_last_merge=1.0000 (last merge round=3)
[S14] round=4 local utility u=0.003463 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7333420506914594, 'loss_val': 1.2734122864348139, 'psi': 0.377551532006206}-{'f1_val': 0.14035785288270378, 'auprc': 0.7322358922858401, 'loss_val': 1.2770201512737462, 'psi': 0.37710906864395827}
[S15] START round=4 head_norm_before_train=0.928534 cos_to_last_merge=0.9977 (last merge round=2)
[S15] round=4 local utility u=0.038321 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7759915833384696, 'loss_val': 1.2198786711009537, 'psi': 0.39423682415232286}-{'f1_val': 0.13973365136155833, 'auprc': 0.7684690900959606, 'loss_val': 1.2739531647752613, 'psi': 0.39122782685531926}
[S16] START round=4 head_norm_before_train=1.232165 (no previous merge yet)
[S16] round=4 local utility u=0.032252 metrics={'f1_val': 0.14063745019920318, 'auprc': 0.9959528948027474, 'loss_val': 1.170356591617287, 'psi': 0.4827636280406209}-{'f1_val': 0.14063745019920318, 'auprc': 0.9924626407504878, 'loss_val': 1.224390679222904, 'psi': 0.48136752641971703}
[S17] START round=4 head_norm_before_train=0.917432 cos_to_last_merge=0.9889 (last merge round=1)
[S17] round=4 local utility u=0.069717 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5443611644309467, 'loss_val': 1.2037427642330587, 'psi': 0.30231384376280934}-{'f1_val': 0.14094896331738438, 'auprc': 0.5245281585444433, 'loss_val': 1.2836771228818038, 'psi': 0.29438064140820797}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] → sending delta(kind=head bytes=1795) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S13] → sending delta(kind=head bytes=1790) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S14] → sending delta(kind=head bytes=1793) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S17] → sending delta(kind=head bytes=1791) to S8@127.0.0.1:54509
[S7] sending update (kind=head size=1800 to 1 peers)
[S16] sending update (kind=head size=1795 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1790 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.5715
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] cosine check vs S4: cos=0.7190
[S10] RECEIVED delta(kind=head bytes=1790) from S13
[S10] cosine check vs S13: cos=0.0645
[S14] RECEIVED delta(kind=head bytes=1800) from S3
[S14] cosine check vs S3: cos=0.2547
[S7] RECEIVED delta(kind=head bytes=1793) from S14
[S7] cosine check vs S14: cos=-0.0916
[S7] DROPPED delta from S14 (cos=-0.0916 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.2378
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] cosine check vs S9: cos=0.7172
[S14] RECEIVED delta(kind=head bytes=1795) from S16
[S14] cosine check vs S16: cos=0.1459
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.0965
[S5] DROPPED delta from S8 (cos=-0.0965 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0848
[S3] DROPPED delta from S5 (cos=-0.0848 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1800) from S7
[S13] cosine check vs S7: cos=-0.0406
[S13] DROPPED delta from S7 (cos=-0.0406 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1804) from S10
[S5] cosine check vs S10: cos=-0.1058
[S5] DROPPED delta from S10 (cos=-0.1058 < 0.0)
[S17] sending update (kind=head size=1791 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1791) from S17
[S8] cosine check vs S17: cos=-0.0264
[S8] DROPPED delta from S17 (cos=-0.0264 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=4 metric=0.1418 head_norm=0.786766
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.048658e-01
[S2] stored merged vector for next round verification (round=4)
[S2] DEBUG after merge:  round=4 metric=0.1418 head_norm=0.765412 delta_norm=0.404866
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=4 metric=0.1404 head_norm=0.809048
[S14] _apply_head_vector_avg (torch): Δ‖w‖=4.088014e-01
[S14] stored merged vector for next round verification (round=4)
[S14] DEBUG after merge:  round=4 metric=0.1404 head_norm=0.650598 delta_norm=0.408801
[S14] aggregate: ACCEPT kept=['S4', 'S3', 'S15', 'S16'] (k=4/4) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=4 metric=0.1386 head_norm=0.838135
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.405061e-01
[S10] stored merged vector for next round verification (round=4)
[S10] DEBUG after merge:  round=4 metric=0.1386 head_norm=0.785737 delta_norm=0.740506
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=4 metric=0.1421 head_norm=0.747016
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.788069e-01
[S7] stored merged vector for next round verification (round=4)
[S7] DEBUG after merge:  round=4 metric=0.1421 head_norm=0.851762 delta_norm=0.378807
[S7] aggregate: ACCEPT kept=['S9'] (k=1/1) mode=median trim_p=0.1
[S2] START round=5 head_norm_before_train=0.765412 cos_to_last_merge=1.0000 (last merge round=4)
[S2] round=5 local utility u=0.031110 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.773271177125712, 'loss_val': 1.217965216526915, 'psi': 0.3943747508834249}-{'f1_val': 0.1417771333885667, 'auprc': 0.7544422906137503, 'loss_val': 1.2236994380799215, 'psi': 0.3868431962786402}
[S3] START round=5 head_norm_before_train=1.345913 (no previous merge yet)
[S3] round=5 local utility u=0.402955 metrics={'f1_val': 0.69982954919712, 'auprc': 0.8851994613502493, 'loss_val': 0.498477801375461, 'psi': 0.7739775140583718}-{'f1_val': 0.5450215858923251, 'auprc': 0.9989010291357941, 'loss_val': 0.7166450556379512, 'psi': 0.7265733631897127}
[S4] START round=5 head_norm_before_train=0.918906 cos_to_last_merge=0.9894 (last merge round=2)
[S4] round=5 local utility u=0.893866 metrics={'f1_val': 0.4146045557441992, 'auprc': 0.7833397055095511, 'loss_val': 1.0583737506887578, 'psi': 0.56209861565034}-{'f1_val': 0.14159059035220026, 'auprc': 0.7819200893335057, 'loss_val': 1.203762307485793, 'psi': 0.3977223899447224}
[S5] START round=5 head_norm_before_train=1.361873 (no previous merge yet)
[S5] round=5 local utility u=0.080026 metrics={'f1_val': 0.7146275168069246, 'auprc': 0.793462386730579, 'loss_val': 0.567175499108193, 'psi': 0.7461614647763863}-{'f1_val': 0.714986591715879, 'auprc': 0.7944987204004197, 'loss_val': 0.7324909552465293, 'psi': 0.7467914431896953}
[S6] START round=5 head_norm_before_train=1.285630 (no previous merge yet)
[S6] round=5 local utility u=0.018355 metrics={'f1_val': 0.14142628205128205, 'auprc': 0.6321085224834391, 'loss_val': 1.1075641688525966, 'psi': 0.33769917822414486}-{'f1_val': 0.14142628205128205, 'auprc': 0.6455935922690674, 'loss_val': 1.1847301421827565, 'psi': 0.34309320613839617}
[S7] START round=5 head_norm_before_train=0.851762 cos_to_last_merge=1.0000 (last merge round=4)
[S7] round=5 local utility u=0.023915 metrics={'f1_val': 0.14205682272909165, 'auprc': 0.7948159236285605, 'loss_val': 1.2123465290309627, 'psi': 0.4031604630888792}-{'f1_val': 0.14205682272909165, 'auprc': 0.7900834994868456, 'loss_val': 1.2459786827654944, 'psi': 0.40126749343219326}
[S8] START round=5 head_norm_before_train=1.243811 (no previous merge yet)
[S8] round=5 local utility u=0.830419 metrics={'f1_val': 0.4027759264906108, 'auprc': 0.7695947944581647, 'loss_val': 1.1244752582666604, 'psi': 0.5495034736776323}-{'f1_val': 0.13995598239295717, 'auprc': 0.7661225113242125, 'loss_val': 1.1979757935035373, 'psi': 0.39042259396545936}
[S9] START round=5 head_norm_before_train=1.086257 cos_to_last_merge=0.9497 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.950
[S9] round=5 local utility u=0.095946 metrics={'f1_val': 0.7015406642019387, 'auprc': 0.9987953877260177, 'loss_val': 0.3719862217601119, 'psi': 0.8204425536115703}-{'f1_val': 0.7017586747191817, 'auprc': 0.9999818465253945, 'loss_val': 0.5687463689233263, 'psi': 0.8210479434416669}
[S10] START round=5 head_norm_before_train=0.785737 cos_to_last_merge=1.0000 (last merge round=4)
[S10] round=5 local utility u=0.005866 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.788579341676532, 'loss_val': 1.2559015970045604, 'psi': 0.39860471919564716}-{'f1_val': 0.13862163754172394, 'auprc': 0.7912356105344909, 'loss_val': 1.2756021430693307, 'psi': 0.3996672267388307}
[S11] START round=5 head_norm_before_train=0.938373 cos_to_last_merge=0.9778 (last merge round=1)
[S11] round=5 local utility u=0.000000 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.7660562491278942, 'loss_val': 1.2180283298171763, 'psi': 0.39067070967502404}-{'f1_val': 0.14041368337311058, 'auprc': 0.8351489234472771, 'loss_val': 1.2599575555215772, 'psi': 0.4183077794027772}
[S13] START round=5 head_norm_before_train=1.276321 (no previous merge yet)
[S13] round=5 local utility u=0.085654 metrics={'f1_val': 0.41655034241240063, 'auprc': 0.572126663573104, 'loss_val': 1.0407392556459716, 'psi': 0.478780870876682}-{'f1_val': 0.4016298527535085, 'auprc': 0.5801090395283317, 'loss_val': 1.1464704693988996, 'psi': 0.4730215274634378}
[S14] START round=5 head_norm_before_train=0.650598 cos_to_last_merge=1.0000 (last merge round=4)
[S14] round=5 local utility u=0.000000 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.6581721159409245, 'loss_val': 1.2530793746026878, 'psi': 0.3474835581059921}-{'f1_val': 0.14035785288270378, 'auprc': 0.7333420506914594, 'loss_val': 1.2734122864348139, 'psi': 0.377551532006206}
[S15] START round=5 head_norm_before_train=0.962923 cos_to_last_merge=0.9922 (last merge round=2)
[S15] round=5 local utility u=0.033408 metrics={'f1_val': 0.13973365136155833, 'auprc': 0.7766332009322527, 'loss_val': 1.1549869037114944, 'psi': 0.39449347118983613}-{'f1_val': 0.13973365136155833, 'auprc': 0.7759915833384696, 'loss_val': 1.2198786711009537, 'psi': 0.39423682415232286}
[S16] START round=5 head_norm_before_train=1.264892 (no previous merge yet)
[S16] round=5 local utility u=0.837299 metrics={'f1_val': 0.4170320622992751, 'auprc': 0.9673987870424123, 'loss_val': 1.068464831996952, 'psi': 0.63717875219653}-{'f1_val': 0.14063745019920318, 'auprc': 0.9959528948027474, 'loss_val': 1.170356591617287, 'psi': 0.4827636280406209}
[S17] START round=5 head_norm_before_train=0.965051 cos_to_last_merge=0.9772 (last merge round=1)
[S17] round=5 local utility u=0.064846 metrics={'f1_val': 0.14094896331738438, 'auprc': 0.5483616356859162, 'loss_val': 1.086052151783599, 'psi': 0.30391403226479713}-{'f1_val': 0.14094896331738438, 'auprc': 0.5443611644309467, 'loss_val': 1.2037427642330587, 'psi': 0.30231384376280934}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S4] → sending delta(kind=head bytes=1789) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] → sending delta(kind=head bytes=1803) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[S9] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S15] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] sending update (kind=head size=1794 to 1 peers)
[S5] sending update (kind=head size=1799 to 1 peers)
[S4] sending update (kind=head size=1789 to 1 peers)
[S3] sending update (kind=head size=1799 to 1 peers)
[S16] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.0819
[S3] DROPPED delta from S5 (cos=-0.0819 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1803) from S15
[S14] cosine check vs S15: cos=0.5960
[S14] RECEIVED delta(kind=head bytes=1799) from S3
[S14] cosine check vs S3: cos=0.3709
[S6] RECEIVED delta(kind=head bytes=1801) from S2
[S6] cosine check vs S2: cos=0.0691
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0967
[S5] DROPPED delta from S8 (cos=-0.0967 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1799) from S16
[S14] cosine check vs S16: cos=0.5215
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.8276
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.2904
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.9218
[S13] RECEIVED delta(kind=head bytes=1794) from S7
[S13] cosine check vs S7: cos=-0.0199
[S13] DROPPED delta from S7 (cos=-0.0199 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1789) from S4
[S14] cosine check vs S4: cos=0.5655
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.0539
[S5] DROPPED delta from S10 (cos=-0.0539 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S17] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1794 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1794) from S17
[S8] cosine check vs S17: cos=-0.0303
[S8] DROPPED delta from S17 (cos=-0.0303 < 0.0)
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=5 metric=0.1404 head_norm=0.685302
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.310941e-01
[S14] stored merged vector for next round verification (round=5)
[S14] DEBUG after merge:  round=5 metric=0.1404 head_norm=0.678719 delta_norm=0.231094
[S14] aggregate: ACCEPT kept=['S15', 'S3', 'S16', 'S4'] (k=4/4) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.333 → S7@127.0.0.1:54508
[S11] ⇄ pheromone p=0.426 → S2@127.0.0.1:54502
[S15] ⇄ pheromone p=0.343 → S14@127.0.0.1:54514
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=5 metric=0.1414 head_norm=1.317210
[S6] _apply_head_vector_avg (torch): Δ‖w‖=7.427912e-01
[S6] stored merged vector for next round verification (round=5)
[S6] DEBUG after merge:  round=5 metric=0.1414 head_norm=0.789356 delta_norm=0.742791
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.356 → S7@127.0.0.1:54508
[S3] ⇄ pheromone p=0.634 → S14@127.0.0.1:54514
[S5] ⇄ pheromone p=0.632 → S3@127.0.0.1:54503
[S13] ⇄ pheromone p=0.518 → S10@127.0.0.1:54511
[S9] ⇄ pheromone p=0.544 → S7@127.0.0.1:54508
[S4] ⇄ pheromone p=0.518 → S14@127.0.0.1:54514
[S2] ⇄ pheromone p=0.373 → S6@127.0.0.1:54507
[S8] ⇄ pheromone p=0.573 → S5@127.0.0.1:54505
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=5 metric=0.1421 head_norm=0.870494
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.874663e-01
[S7] stored merged vector for next round verification (round=5)
[S7] DEBUG after merge:  round=5 metric=0.1421 head_norm=0.852394 delta_norm=0.287466
[S7] aggregate: ACCEPT kept=['S6', 'S9'] (k=2/2) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.345 → S13@127.0.0.1:54513
[S16] ⇄ pheromone p=0.534 → S14@127.0.0.1:54514
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=5 metric=0.1386 head_norm=0.806864
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.922743e-01
[S10] stored merged vector for next round verification (round=5)
[S10] DEBUG after merge:  round=5 metric=0.1386 head_norm=1.013725 delta_norm=0.392274
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.368 → S5@127.0.0.1:54505
[S17] ⇄ pheromone p=0.370 → S8@127.0.0.1:54509
[S2] START round=6 head_norm_before_train=0.783965 cos_to_last_merge=0.9956 (last merge round=4)
[S2] round=6 local utility u=0.014794 metrics={'f1_val': 0.1417771333885667, 'auprc': 0.7567429963314521, 'loss_val': 1.1387935672787155, 'psi': 0.3877634785657209}-{'f1_val': 0.1417771333885667, 'auprc': 0.773271177125712, 'loss_val': 1.217965216526915, 'psi': 0.3943747508834249}
[S3] START round=6 head_norm_before_train=1.420462 (no previous merge yet)
[S3] round=6 local utility u=0.123663 metrics={'f1_val': 0.6715433818800839, 'auprc': 0.9954884947605925, 'loss_val': 0.4123013708143234, 'psi': 0.8011214270322873}-{'f1_val': 0.69982954919712, 'auprc': 0.8851994613502493, 'loss_val': 0.498477801375461, 'psi': 0.7739775140583718}
[S4] START round=6 head_norm_before_train=0.964580 cos_to_last_merge=0.9770 (last merge round=2)
[S4] round=6 local utility u=0.088484 metrics={'f1_val': 0.41500763179523303, 'auprc': 0.7816210410832797, 'loss_val': 0.8786676992994761, 'psi': 0.5616529955104517}-{'f1_val': 0.4146045557441992, 'auprc': 0.7833397055095511, 'loss_val': 1.0583737506887578, 'psi': 0.56209861565034}
[S5] START round=6 head_norm_before_train=1.420466 (no previous merge yet)
[S5] round=6 local utility u=0.309023 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9939937237703366, 'loss_val': 0.4663690817128332, 'psi': 0.8179385955109257}-{'f1_val': 0.7146275168069246, 'auprc': 0.793462386730579, 'loss_val': 0.567175499108193, 'psi': 0.7461614647763863}
[S6] START round=6 head_norm_before_train=0.789356 cos_to_last_merge=1.0000 (last merge round=5)
[S6] round=6 local utility u=0.516152 metrics={'f1_val': 0.3058038301459354, 'auprc': 0.6383384942101366, 'loss_val': 1.0802161315681582, 'psi': 0.43881769577161583}-{'f1_val': 0.14142628205128205, 'auprc': 0.6321085224834391, 'loss_val': 1.1075641688525966, 'psi': 0.33769917822414486}
[S7] START round=6 head_norm_before_train=0.852394 cos_to_last_merge=1.0000 (last merge round=5)
[S7] round=6 local utility u=0.698260 metrics={'f1_val': 0.39476925009093505, 'auprc': 0.7291550361478095, 'loss_val': 1.1351174313249461, 'psi': 0.5285235645136849}-{'f1_val': 0.14205682272909165, 'auprc': 0.7948159236285605, 'loss_val': 1.2123465290309627, 'psi': 0.4031604630888792}
[S8] START round=6 head_norm_before_train=1.277166 (no previous merge yet)
[S8] round=6 local utility u=0.998493 metrics={'f1_val': 0.7149691070173029, 'auprc': 0.7768300718093105, 'loss_val': 1.022354543385069, 'psi': 0.7397134929341059}-{'f1_val': 0.4027759264906108, 'auprc': 0.7695947944581647, 'loss_val': 1.1244752582666604, 'psi': 0.5495034736776323}
[S9] START round=6 head_norm_before_train=1.190025 cos_to_last_merge=0.9208 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.921
[S9] round=6 local utility u=0.041100 metrics={'f1_val': 0.7014667606303384, 'auprc': 0.9982909776507718, 'loss_val': 0.2878295040658811, 'psi': 0.8201964474385117}-{'f1_val': 0.7015406642019387, 'auprc': 0.9987953877260177, 'loss_val': 0.3719862217601119, 'psi': 0.8204425536115703}
[S10] START round=6 head_norm_before_train=1.013725 cos_to_last_merge=1.0000 (last merge round=5)
[S10] round=6 local utility u=0.006076 metrics={'f1_val': 0.13862163754172394, 'auprc': 0.7783572187229849, 'loss_val': 1.2130838365834362, 'psi': 0.39451587001422833}-{'f1_val': 0.13862163754172394, 'auprc': 0.788579341676532, 'loss_val': 1.2559015970045604, 'psi': 0.39860471919564716}
[S11] START round=6 head_norm_before_train=0.969460 cos_to_last_merge=0.9661 (last merge round=1)
[S11] round=6 local utility u=0.236028 metrics={'f1_val': 0.14041368337311058, 'auprc': 0.8973179610611801, 'loss_val': 1.1397571873952792, 'psi': 0.4431753944483384}-{'f1_val': 0.14041368337311058, 'auprc': 0.7660562491278942, 'loss_val': 1.2180283298171763, 'psi': 0.39067070967502404}
[S13] START round=6 head_norm_before_train=1.308436 (no previous merge yet)
[S13] round=6 local utility u=0.000000 metrics={'f1_val': 0.3720618713651108, 'auprc': 0.5398740773150887, 'loss_val': 0.9643562830234517, 'psi': 0.43918675374510197}-{'f1_val': 0.41655034241240063, 'auprc': 0.572126663573104, 'loss_val': 1.0407392556459716, 'psi': 0.478780870876682}
[S14] START round=6 head_norm_before_train=0.678719 cos_to_last_merge=1.0000 (last merge round=5)
[S14] round=6 local utility u=0.145059 metrics={'f1_val': 0.14035785288270378, 'auprc': 0.7371676045869872, 'loss_val': 1.1999471104388097, 'psi': 0.37908175356441715}-{'f1_val': 0.14035785288270378, 'auprc': 0.6581721159409245, 'loss_val': 1.2530793746026878, 'psi': 0.3474835581059921}
[S15] START round=6 head_norm_before_train=0.997750 cos_to_last_merge=0.9850 (last merge round=2)
[S15] round=6 local utility u=0.777618 metrics={'f1_val': 0.38305498360405704, 'auprc': 0.7770431370111853, 'loss_val': 1.060908112368593, 'psi': 0.5406502449669084}-{'f1_val': 0.13973365136155833, 'auprc': 0.7766332009322527, 'loss_val': 1.1549869037114944, 'psi': 0.39449347118983613}
[S16] START round=6 head_norm_before_train=1.288962 (no previous merge yet)
[S16] round=6 local utility u=0.000000 metrics={'f1_val': 0.4173869385094645, 'auprc': 0.8499111791931948, 'loss_val': 0.9275021499542048, 'psi': 0.5903966347829566}-{'f1_val': 0.4170320622992751, 'auprc': 0.9673987870424123, 'loss_val': 1.068464831996952, 'psi': 0.63717875219653}
[S17] START round=6 head_norm_before_train=1.014240 cos_to_last_merge=0.9645 (last merge round=1)
[S17] round=6 local utility u=0.826714 metrics={'f1_val': 0.3918227013590554, 'auprc': 0.568541328778537, 'loss_val': 0.9984063328042602, 'psi': 0.46251015232684806}-{'f1_val': 0.14094896331738438, 'auprc': 0.5483616356859162, 'loss_val': 1.086052151783599, 'psi': 0.30391403226479713}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S8] → sending delta(kind=head bytes=1793) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S5] → sending delta(kind=head bytes=1802) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] → sending delta(kind=head bytes=1798) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1787 reason=None
[S10] → sending delta(kind=head bytes=1787) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S2] → sending delta(kind=head bytes=1789) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[S14] sending update (kind=head size=1799 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S2] sending update (kind=head size=1789 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S5] sending update (kind=head size=1802 to 1 peers)
[S3] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S7] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1793 to 1 peers)
[S10] sending update (kind=head size=1787 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1791) from S4
[S14] cosine check vs S4: cos=0.4388
[S6] RECEIVED delta(kind=head bytes=1789) from S2
[S6] cosine check vs S2: cos=0.5196
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] cosine check vs S9: cos=0.8284
[S5] RECEIVED delta(kind=head bytes=1793) from S8
[S5] cosine check vs S8: cos=-0.0953
[S5] DROPPED delta from S8 (cos=-0.0953 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1787) from S10
[S5] cosine check vs S10: cos=-0.0176
[S5] DROPPED delta from S10 (cos=-0.0176 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1798) from S3
[S14] cosine check vs S3: cos=0.4048
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.8381
[S13] RECEIVED delta(kind=head bytes=1796) from S7
[S13] cosine check vs S7: cos=0.0008
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.5682
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.7393
[S7] RECEIVED delta(kind=head bytes=1799) from S14
[S7] cosine check vs S14: cos=-0.0227
[S7] DROPPED delta from S14 (cos=-0.0227 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1802) from S5
[S3] cosine check vs S5: cos=-0.0817
[S3] DROPPED delta from S5 (cos=-0.0817 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.0305
[S8] DROPPED delta from S17 (cos=-0.0305 < 0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=6 metric=0.3721 head_norm=1.345102
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.048127e-01
[S13] stored merged vector for next round verification (round=6)
[S13] DEBUG after merge:  round=6 metric=0.3962 head_norm=0.805431 delta_norm=0.804813
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=6 metric=0.1404 head_norm=0.705614
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.835257e-01
[S14] stored merged vector for next round verification (round=6)
[S14] DEBUG after merge:  round=6 metric=0.1404 head_norm=0.679702 delta_norm=0.183526
[S14] aggregate: ACCEPT kept=['S4', 'S3', 'S15'] (k=3/3) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=6 metric=0.1418 head_norm=0.812644
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.737780e-01
[S2] stored merged vector for next round verification (round=6)
[S2] DEBUG after merge:  round=6 metric=0.1418 head_norm=0.870464 delta_norm=0.273778
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=6 metric=0.3058 head_norm=0.824264
[S6] _apply_head_vector_avg (torch): Δ‖w‖=4.011429e-01
[S6] stored merged vector for next round verification (round=6)
[S6] DEBUG after merge:  round=6 metric=0.1674 head_norm=0.713432 delta_norm=0.401143
[S6] aggregate: ROLLBACK (f1_val pre=0.306 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=6 metric=0.3948 head_norm=0.885205
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.219751e-01
[S7] stored merged vector for next round verification (round=6)
[S7] DEBUG after merge:  round=6 metric=0.2916 head_norm=0.832715 delta_norm=0.121975
[S7] aggregate: ROLLBACK (f1_val pre=0.395 post=0.292 tol_abs=0.005 tol_rel=0.0)
[S2] START round=7 head_norm_before_train=0.870464 cos_to_last_merge=1.0000 (last merge round=6)
[S2] round=7 local utility u=0.717651 metrics={'f1_val': 0.41630530508844577, 'auprc': 0.6765430904591281, 'loss_val': 1.1100605985809489, 'psi': 0.5204004192367186}-{'f1_val': 0.1417771333885667, 'auprc': 0.7567429963314521, 'loss_val': 1.1387935672787155, 'psi': 0.3877634785657209}
[S3] START round=7 head_norm_before_train=1.496763 (no previous merge yet)
[S3] round=7 local utility u=0.134133 metrics={'f1_val': 0.6980703337053055, 'auprc': 0.9952948230612151, 'loss_val': 0.30261579156125057, 'psi': 0.8169601294476694}-{'f1_val': 0.6715433818800839, 'auprc': 0.9954884947605925, 'loss_val': 0.4123013708143234, 'psi': 0.8011214270322873}
[S4] START round=7 head_norm_before_train=1.012879 cos_to_last_merge=0.9616 (last merge round=2)
[S4] round=7 local utility u=0.621216 metrics={'f1_val': 0.6683577420465835, 'auprc': 0.6519220034697466, 'loss_val': 0.7672391787027842, 'psi': 0.6617834466158488}-{'f1_val': 0.41500763179523303, 'auprc': 0.7816210410832797, 'loss_val': 0.8786676992994761, 'psi': 0.5616529955104517}
[S5] START round=7 head_norm_before_train=1.476147 (no previous merge yet)
[S5] round=7 local utility u=0.052302 metrics={'f1_val': 0.7005685100046517, 'auprc': 0.9948968331880328, 'loss_val': 0.36447430984940044, 'psi': 0.8182998392780041}-{'f1_val': 0.7005685100046517, 'auprc': 0.9939937237703366, 'loss_val': 0.4663690817128332, 'psi': 0.8179385955109257}
[S6] START round=7 head_norm_before_train=0.713432 cos_to_last_merge=1.0000 (last merge round=6)
[S6] round=7 local utility u=0.353076 metrics={'f1_val': 0.4046315927552102, 'auprc': 0.6785316711773174, 'loss_val': 1.087609307274079, 'psi': 0.5141916241240532}-{'f1_val': 0.3058038301459354, 'auprc': 0.6383384942101366, 'loss_val': 1.0802161315681582, 'psi': 0.43881769577161583}
[S7] START round=7 head_norm_before_train=0.832715 cos_to_last_merge=1.0000 (last merge round=6)
[S7] round=7 local utility u=1.000000 metrics={'f1_val': 0.6699951371460592, 'auprc': 0.7912415068199294, 'loss_val': 0.966429325347846, 'psi': 0.7184936850156073}-{'f1_val': 0.39476925009093505, 'auprc': 0.7291550361478095, 'loss_val': 1.1351174313249461, 'psi': 0.5285235645136849}
[S8] START round=7 head_norm_before_train=1.308383 (no previous merge yet)
[S8] round=7 local utility u=0.089205 metrics={'f1_val': 0.7144610111876308, 'auprc': 0.7908034537511166, 'loss_val': 0.8828161637690883, 'psi': 0.7449979882130251}-{'f1_val': 0.7149691070173029, 'auprc': 0.7768300718093105, 'loss_val': 1.022354543385069, 'psi': 0.7397134929341059}
[S9] START round=7 head_norm_before_train=1.285293 cos_to_last_merge=0.8965 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.897
[S9] round=7 local utility u=0.022210 metrics={'f1_val': 0.7012165807733519, 'auprc': 0.9985391615839584, 'loss_val': 0.24265385190403618, 'psi': 0.8201456130975945}-{'f1_val': 0.7014667606303384, 'auprc': 0.9982909776507718, 'loss_val': 0.2878295040658811, 'psi': 0.8201964474385117}
[S10] START round=7 head_norm_before_train=1.029844 cos_to_last_merge=0.9978 (last merge round=5)
[S10] round=7 local utility u=0.900048 metrics={'f1_val': 0.41634224672860876, 'auprc': 0.7887597046925092, 'loss_val': 1.1105186535064695, 'psi': 0.565309229914169}-{'f1_val': 0.13862163754172394, 'auprc': 0.7783572187229849, 'loss_val': 1.2130838365834362, 'psi': 0.39451587001422833}
[S11] START round=7 head_norm_before_train=1.002464 cos_to_last_merge=0.9550 (last merge round=1)
[S11] round=7 local utility u=0.945660 metrics={'f1_val': 0.40109176693024134, 'auprc': 0.9641173691667939, 'loss_val': 1.0129046594430982, 'psi': 0.6263020078248625}-{'f1_val': 0.14041368337311058, 'auprc': 0.8973179610611801, 'loss_val': 1.1397571873952792, 'psi': 0.4431753944483384}
[S13] START round=7 head_norm_before_train=0.805431 cos_to_last_merge=1.0000 (last merge round=6)
[S13] round=7 local utility u=0.000000 metrics={'f1_val': 0.3721440691535061, 'auprc': 0.4830665371195994, 'loss_val': 1.0058523433533113, 'psi': 0.4165130563399434}-{'f1_val': 0.3720618713651108, 'auprc': 0.5398740773150887, 'loss_val': 0.9643562830234517, 'psi': 0.43918675374510197}
[S14] START round=7 head_norm_before_train=0.679702 cos_to_last_merge=1.0000 (last merge round=6)
[S14] round=7 local utility u=0.172647 metrics={'f1_val': 0.17630443145146074, 'auprc': 0.7427825621639345, 'loss_val': 1.0871773394925215, 'psi': 0.40289568373645024}-{'f1_val': 0.14035785288270378, 'auprc': 0.7371676045869872, 'loss_val': 1.1999471104388097, 'psi': 0.37908175356441715}
[S15] START round=7 head_norm_before_train=1.029202 cos_to_last_merge=0.9768 (last merge round=2)
[S15] round=7 local utility u=0.861284 metrics={'f1_val': 0.6449153646707861, 'auprc': 0.7770356617239771, 'loss_val': 0.9094806909062881, 'psi': 0.6977634834920625}-{'f1_val': 0.38305498360405704, 'auprc': 0.7770431370111853, 'loss_val': 1.060908112368593, 'psi': 0.5406502449669084}
[S16] START round=7 head_norm_before_train=1.311285 (no previous merge yet)
[S16] round=7 local utility u=0.052733 metrics={'f1_val': 0.4167359650135119, 'auprc': 0.8493135475262177, 'loss_val': 0.8163369107536812, 'psi': 0.5897669980185942}-{'f1_val': 0.4173869385094645, 'auprc': 0.8499111791931948, 'loss_val': 0.9275021499542048, 'psi': 0.5903966347829566}
[S17] START round=7 head_norm_before_train=1.061665 cos_to_last_merge=0.9515 (last merge round=1)
[S17] round=7 local utility u=0.000000 metrics={'f1_val': 0.3568656660827637, 'auprc': 0.4799172443323677, 'loss_val': 0.9408030966631861, 'psi': 0.4060862973826053}-{'f1_val': 0.3918227013590554, 'auprc': 0.568541328778537, 'loss_val': 0.9984063328042602, 'psi': 0.46251015232684806}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] → sending delta(kind=head bytes=1799) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1809 reason=None
[S3] → sending delta(kind=head bytes=1809) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] → sending delta(kind=head bytes=1796) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S9] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] → sending delta(kind=head bytes=1796) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1790 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S9] sending update (kind=head size=1802 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S7] sending update (kind=head size=1795 to 1 peers)
[S16] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S4] sending update (kind=head size=1797 to 1 peers)
[S3] sending update (kind=head size=1809 to 1 peers)
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] RECEIVED delta(kind=head bytes=1802) from S9
[S7] cosine check vs S9: cos=0.8224
[S13] RECEIVED delta(kind=head bytes=1795) from S7
[S13] cosine check vs S7: cos=0.5223
[S14] RECEIVED delta(kind=head bytes=1799) from S15
[S14] cosine check vs S15: cos=0.6706
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=0.9409
[S7] RECEIVED delta(kind=head bytes=1797) from S14
[S7] cosine check vs S14: cos=-0.0065
[S7] DROPPED delta from S14 (cos=-0.0065 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1796) from S16
[S14] cosine check vs S16: cos=0.5374
[S14] RECEIVED delta(kind=head bytes=1797) from S4
[S14] cosine check vs S4: cos=0.5375
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=-0.0252
[S5] DROPPED delta from S10 (cos=-0.0252 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1809) from S3
[S14] cosine check vs S3: cos=0.5311
[S6] RECEIVED delta(kind=head bytes=1796) from S2
[S6] cosine check vs S2: cos=0.8221
[S3] RECEIVED delta(kind=head bytes=1796) from S5
[S3] cosine check vs S5: cos=-0.0839
[S3] DROPPED delta from S5 (cos=-0.0839 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.0937
[S5] DROPPED delta from S8 (cos=-0.0937 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1802) from S6
[S7] cosine check vs S6: cos=0.5086
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=7 metric=0.3721 head_norm=0.845985
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.233550e-01
[S13] stored merged vector for next round verification (round=7)
[S13] DEBUG after merge:  round=7 metric=0.3800 head_norm=0.755206 delta_norm=0.423355
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=4 kept=4 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=7 metric=0.1763 head_norm=0.717418
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.785421e-01
[S14] stored merged vector for next round verification (round=7)
[S14] DEBUG after merge:  round=7 metric=0.1539 head_norm=0.733802 delta_norm=0.178542
[S14] aggregate: ROLLBACK (f1_val pre=0.176 post=0.154 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=7 metric=0.4046 head_norm=0.748540
[S6] _apply_head_vector_avg (torch): Δ‖w‖=2.540594e-01
[S6] stored merged vector for next round verification (round=7)
[S6] DEBUG after merge:  round=7 metric=0.1674 head_norm=0.783285 delta_norm=0.254059
[S6] aggregate: ROLLBACK (f1_val pre=0.405 post=0.167 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=7 metric=0.6700 head_norm=0.885122
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.576180e-01
[S7] stored merged vector for next round verification (round=7)
[S7] DEBUG after merge:  round=7 metric=0.4715 head_norm=0.829335 delta_norm=0.157618
[S7] aggregate: ROLLBACK (f1_val pre=0.670 post=0.472 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=7 metric=0.4163 head_norm=0.892104
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.825027e-01
[S2] stored merged vector for next round verification (round=7)
[S2] DEBUG after merge:  round=7 metric=0.4081 head_norm=0.953924 delta_norm=0.182503
[S2] aggregate: ROLLBACK (f1_val pre=0.416 post=0.408 tol_abs=0.005 tol_rel=0.0)
[S2] START round=8 head_norm_before_train=0.953924 cos_to_last_merge=1.0000 (last merge round=7)
[S2] round=8 local utility u=0.188212 metrics={'f1_val': 0.41714901250782, 'auprc': 0.782725040679803, 'loss_val': 1.0572454690546607, 'psi': 0.5633794237766132}-{'f1_val': 0.41630530508844577, 'auprc': 0.6765430904591281, 'loss_val': 1.1100605985809489, 'psi': 0.5204004192367186}
[S3] START round=8 head_norm_before_train=1.562394 (no previous merge yet)
[S3] round=8 local utility u=0.036976 metrics={'f1_val': 0.7007562037352997, 'auprc': 0.9971848942783745, 'loss_val': 0.25044859954716225, 'psi': 0.8193276799525295}-{'f1_val': 0.6980703337053055, 'auprc': 0.9952948230612151, 'loss_val': 0.30261579156125057, 'psi': 0.8169601294476694}
[S4] START round=8 head_norm_before_train=1.060707 cos_to_last_merge=0.9449 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.945
[S4] round=8 local utility u=0.217394 metrics={'f1_val': 0.6660126478587101, 'auprc': 0.7508659984653784, 'loss_val': 0.6152135472010244, 'psi': 0.6999539881013774}-{'f1_val': 0.6683577420465835, 'auprc': 0.6519220034697466, 'loss_val': 0.7672391787027842, 'psi': 0.6617834466158488}
[S5] START round=8 head_norm_before_train=1.532467 (no previous merge yet)
[S5] round=8 local utility u=0.029926 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9948825800026745, 'loss_val': 0.3048197659224507, 'psi': 0.8183180675986743}-{'f1_val': 0.7005685100046517, 'auprc': 0.9948968331880328, 'loss_val': 0.36447430984940044, 'psi': 0.8182998392780041}
[S6] START round=8 head_norm_before_train=0.783285 cos_to_last_merge=1.0000 (last merge round=7)
[S6] round=8 local utility u=0.660389 metrics={'f1_val': 0.6077279037019452, 'auprc': 0.6686788732325881, 'loss_val': 0.9558510161003931, 'psi': 0.6321082915142023}-{'f1_val': 0.4046315927552102, 'auprc': 0.6785316711773174, 'loss_val': 1.087609307274079, 'psi': 0.5141916241240532}
[S7] START round=8 head_norm_before_train=0.829335 cos_to_last_merge=1.0000 (last merge round=7)
[S7] round=8 local utility u=0.000000 metrics={'f1_val': 0.5340684993355295, 'auprc': 0.7910605769490708, 'loss_val': 0.8776632400949576, 'psi': 0.636865330380946}-{'f1_val': 0.6699951371460592, 'auprc': 0.7912415068199294, 'loss_val': 0.966429325347846, 'psi': 0.7184936850156073}
[S8] START round=8 head_norm_before_train=1.337322 (no previous merge yet)
[S8] round=8 local utility u=0.078190 metrics={'f1_val': 0.7141742661762565, 'auprc': 0.7941986309761456, 'loss_val': 0.7349016317815046, 'psi': 0.7461840120962121}-{'f1_val': 0.7144610111876308, 'auprc': 0.7908034537511166, 'loss_val': 0.8828161637690883, 'psi': 0.7449979882130251}
[S9] START round=8 head_norm_before_train=1.358557 cos_to_last_merge=0.8798 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.880
[S9] round=8 local utility u=0.874513 metrics={'f1_val': 0.9839631998905876, 'auprc': 0.9980432471049142, 'loss_val': 0.1886202513104797, 'psi': 0.9895952187763182}-{'f1_val': 0.7012165807733519, 'auprc': 0.9985391615839584, 'loss_val': 0.24265385190403618, 'psi': 0.8201456130975945}
[S10] START round=8 head_norm_before_train=1.050096 cos_to_last_merge=0.9921 (last merge round=5)
[S10] round=8 local utility u=0.093842 metrics={'f1_val': 0.41674261139192575, 'auprc': 0.7908334315193749, 'loss_val': 0.9314575408756781, 'psi': 0.5663789394429054}-{'f1_val': 0.41634224672860876, 'auprc': 0.7887597046925092, 'loss_val': 1.1105186535064695, 'psi': 0.565309229914169}
[S11] START round=8 head_norm_before_train=1.044369 cos_to_last_merge=0.9418 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.942
[S11] round=8 local utility u=0.093244 metrics={'f1_val': 0.39651855440916606, 'auprc': 0.9767789166898393, 'loss_val': 0.8369617512134339, 'psi': 0.6286226993214354}-{'f1_val': 0.40109176693024134, 'auprc': 0.9641173691667939, 'loss_val': 1.0129046594430982, 'psi': 0.6263020078248625}
[S13] START round=8 head_norm_before_train=0.755206 cos_to_last_merge=1.0000 (last merge round=7)
[S13] round=8 local utility u=0.106764 metrics={'f1_val': 0.4090918494569459, 'auprc': 0.4744998929896849, 'loss_val': 0.9883117365502083, 'psi': 0.43525506687004145}-{'f1_val': 0.3721440691535061, 'auprc': 0.4830665371195994, 'loss_val': 1.0058523433533113, 'psi': 0.4165130563399434}
[S14] START round=8 head_norm_before_train=0.733802 cos_to_last_merge=1.0000 (last merge round=7)
[S14] round=8 local utility u=0.569424 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.6489348915686333, 'loss_val': 0.9881246017208164, 'psi': 0.4974904992746079}-{'f1_val': 0.17630443145146074, 'auprc': 0.7427825621639345, 'loss_val': 1.0871773394925215, 'psi': 0.40289568373645024}
[S15] START round=8 head_norm_before_train=1.070210 cos_to_last_merge=0.9653 (last merge round=2)
[S15] round=8 local utility u=0.289619 metrics={'f1_val': 0.7058505173999026, 'auprc': 0.7768565480867939, 'loss_val': 0.6953159259984466, 'psi': 0.7342529296746592}-{'f1_val': 0.6449153646707861, 'auprc': 0.7770356617239771, 'loss_val': 0.9094806909062881, 'psi': 0.6977634834920625}
[S16] START round=8 head_norm_before_train=1.335591 (no previous merge yet)
[S16] round=8 local utility u=0.000000 metrics={'f1_val': 0.3835093748926773, 'auprc': 0.7964826602745828, 'loss_val': 0.7424058161516489, 'psi': 0.5486986890454395}-{'f1_val': 0.4167359650135119, 'auprc': 0.8493135475262177, 'loss_val': 0.8163369107536812, 'psi': 0.5897669980185942}
[S17] START round=8 head_norm_before_train=1.114969 cos_to_last_merge=0.9361 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.936
[S17] round=8 local utility u=0.022382 metrics={'f1_val': 0.3535245246810777, 'auprc': 0.4786757438702629, 'loss_val': 0.8722670345328685, 'psi': 0.4035850123567518}-{'f1_val': 0.3568656660827637, 'auprc': 0.4799172443323677, 'loss_val': 0.9408030966631861, 'psi': 0.4060862973826053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S10] → sending delta(kind=head bytes=1790) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S2] → sending delta(kind=head bytes=1793) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S4] → sending delta(kind=head bytes=1791) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] → sending delta(kind=head bytes=1800) to S3@127.0.0.1:54503
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S3] → sending delta(kind=head bytes=1807) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] → sending delta(kind=head bytes=1798) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S9] → sending delta(kind=head bytes=1801) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S8] → sending delta(kind=head bytes=1795) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S13] → sending delta(kind=head bytes=1793) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] → sending delta(kind=head bytes=1801) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S14] sending update (kind=head size=1796 to 1 peers)
[S15] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1793 to 1 peers)
[S4] sending update (kind=head size=1791 to 1 peers)
[S2] sending update (kind=head size=1793 to 1 peers)
[S8] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S9] sending update (kind=head size=1801 to 1 peers)
[S3] sending update (kind=head size=1807 to 1 peers)
[S10] sending update (kind=head size=1790 to 1 peers)
[S6] sending update (kind=head size=1798 to 1 peers)
[S14] RECEIVED delta(kind=head bytes=1807) from S3
[S14] cosine check vs S3: cos=0.4756
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9696
[S7] RECEIVED delta(kind=head bytes=1798) from S6
[S7] cosine check vs S6: cos=0.4739
[S7] RECEIVED delta(kind=head bytes=1801) from S9
[S7] cosine check vs S9: cos=0.8437
[S3] RECEIVED delta(kind=head bytes=1800) from S5
[S3] cosine check vs S5: cos=-0.0874
[S3] DROPPED delta from S5 (cos=-0.0874 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1793) from S13
[S10] cosine check vs S13: cos=0.6283
[S5] RECEIVED delta(kind=head bytes=1795) from S8
[S5] cosine check vs S8: cos=-0.0954
[S5] DROPPED delta from S8 (cos=-0.0954 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1796) from S14
[S7] cosine check vs S14: cos=0.0044
[S5] RECEIVED delta(kind=head bytes=1790) from S10
[S5] cosine check vs S10: cos=-0.0326
[S5] DROPPED delta from S10 (cos=-0.0326 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1801) from S15
[S14] cosine check vs S15: cos=0.7466
[S6] RECEIVED delta(kind=head bytes=1793) from S2
[S6] cosine check vs S2: cos=0.9204
[S14] RECEIVED delta(kind=head bytes=1791) from S4
[S14] cosine check vs S4: cos=0.4509
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0252
[S8] DROPPED delta from S17 (cos=-0.0252 < 0.0)
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=8 metric=0.5341 head_norm=0.891128
[S7] _apply_head_vector_avg (torch): Δ‖w‖=2.986086e-01
[S7] stored merged vector for next round verification (round=8)
[S7] DEBUG after merge:  round=8 metric=0.4418 head_norm=0.677108 delta_norm=0.298609
[S7] aggregate: ROLLBACK (f1_val pre=0.534 post=0.442 tol_abs=0.005 tol_rel=0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=8 metric=0.4171 head_norm=0.972871
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.409145e-01
[S2] stored merged vector for next round verification (round=8)
[S2] DEBUG after merge:  round=8 metric=0.5954 head_norm=1.025573 delta_norm=0.140914
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=8 metric=0.4167 head_norm=1.081401
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.241114e-01
[S10] stored merged vector for next round verification (round=8)
[S10] DEBUG after merge:  round=8 metric=0.4168 head_norm=0.845675 delta_norm=0.424111
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=8 metric=0.6077 head_norm=0.815184
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.943916e-01
[S6] stored merged vector for next round verification (round=8)
[S6] DEBUG after merge:  round=8 metric=0.3113 head_norm=0.876193 delta_norm=0.194392
[S6] aggregate: ROLLBACK (f1_val pre=0.608 post=0.311 tol_abs=0.005 tol_rel=0.0)
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=8 metric=0.3965 head_norm=0.779992
[S14] _apply_head_vector_avg (torch): Δ‖w‖=1.707652e-01
[S14] stored merged vector for next round verification (round=8)
[S14] DEBUG after merge:  round=8 metric=0.3965 head_norm=0.757779 delta_norm=0.170765
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S2] START round=9 head_norm_before_train=1.025573 cos_to_last_merge=1.0000 (last merge round=8)
[S2] round=9 local utility u=0.021816 metrics={'f1_val': 0.41698068739424143, 'auprc': 0.778044284994582, 'loss_val': 0.9985621117630868, 'psi': 0.5614061264343777}-{'f1_val': 0.41714901250782, 'auprc': 0.782725040679803, 'loss_val': 1.0572454690546607, 'psi': 0.5633794237766132}
[S3] START round=9 head_norm_before_train=1.620321 (no previous merge yet)
[S3] round=9 local utility u=0.844117 metrics={'f1_val': 0.9607409897453603, 'auprc': 0.9983318080318894, 'loss_val': 0.12556326310418658, 'psi': 0.975777317059972}-{'f1_val': 0.7007562037352997, 'auprc': 0.9971848942783745, 'loss_val': 0.25044859954716225, 'psi': 0.8193276799525295}
[S4] START round=9 head_norm_before_train=1.117340 cos_to_last_merge=0.9273 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.927
[S4] round=9 local utility u=0.000000 metrics={'f1_val': 0.6604350467957172, 'auprc': 0.6568288897457852, 'loss_val': 0.5124126089384416, 'psi': 0.6589925839757445}-{'f1_val': 0.6660126478587101, 'auprc': 0.7508659984653784, 'loss_val': 0.6152135472010244, 'psi': 0.6999539881013774}
[S5] START round=9 head_norm_before_train=1.580227 (no previous merge yet)
[S5] round=9 local utility u=0.062859 metrics={'f1_val': 0.7753246481095959, 'auprc': 0.8873607434599388, 'loss_val': 0.304833008112354, 'psi': 0.8201390862497331}-{'f1_val': 0.7006083926626743, 'auprc': 0.9948825800026745, 'loss_val': 0.3048197659224507, 'psi': 0.8183180675986743}
[S6] START round=9 head_norm_before_train=0.876193 cos_to_last_merge=1.0000 (last merge round=8)
[S6] round=9 local utility u=0.002091 metrics={'f1_val': 0.5747005714216802, 'auprc': 0.7234074264914283, 'loss_val': 0.917690050955264, 'psi': 0.6341833134495795}-{'f1_val': 0.6077279037019452, 'auprc': 0.6686788732325881, 'loss_val': 0.9558510161003931, 'psi': 0.6321082915142023}
[S7] START round=9 head_norm_before_train=0.677108 cos_to_last_merge=1.0000 (last merge round=8)
[S7] round=9 local utility u=0.452828 metrics={'f1_val': 0.6623470304558419, 'auprc': 0.7920017851926525, 'loss_val': 0.7445016447834566, 'psi': 0.714208932350566}-{'f1_val': 0.5340684993355295, 'auprc': 0.7910605769490708, 'loss_val': 0.8776632400949576, 'psi': 0.636865330380946}
[S8] START round=9 head_norm_before_train=1.373379 (no previous merge yet)
[S8] round=9 local utility u=0.361424 metrics={'f1_val': 0.7140451255766143, 'auprc': 0.9955484205904122, 'loss_val': 0.6153285166565954, 'psi': 0.8266464435821335}-{'f1_val': 0.7141742661762565, 'auprc': 0.7941986309761456, 'loss_val': 0.7349016317815046, 'psi': 0.7461840120962121}
[S9] START round=9 head_norm_before_train=1.415420 cos_to_last_merge=0.8690 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.869
[S9] round=9 local utility u=0.021278 metrics={'f1_val': 0.9861123006036613, 'auprc': 0.9980496420876664, 'loss_val': 0.158977879403242, 'psi': 0.9908872371972635}-{'f1_val': 0.9839631998905876, 'auprc': 0.9980432471049142, 'loss_val': 0.1886202513104797, 'psi': 0.9895952187763182}
[S10] START round=9 head_norm_before_train=0.845675 cos_to_last_merge=1.0000 (last merge round=8)
[S10] round=9 local utility u=0.871116 metrics={'f1_val': 0.5900556292001278, 'auprc': 0.9946759321611577, 'loss_val': 0.840630615144157, 'psi': 0.7519037503845397}-{'f1_val': 0.41674261139192575, 'auprc': 0.7908334315193749, 'loss_val': 0.9314575408756781, 'psi': 0.5663789394429054}
[S11] START round=9 head_norm_before_train=1.094001 cos_to_last_merge=0.9261 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.926
[S11] round=9 local utility u=0.567412 metrics={'f1_val': 0.55819491040925, 'auprc': 0.980690698459324, 'loss_val': 0.6839314302639602, 'psi': 0.7271932256292796}-{'f1_val': 0.39651855440916606, 'auprc': 0.9767789166898393, 'loss_val': 0.8369617512134339, 'psi': 0.6286226993214354}
[S13] START round=9 head_norm_before_train=0.787812 cos_to_last_merge=0.9941 (last merge round=7)
[S13] round=9 local utility u=0.332724 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.6458874543423077, 'loss_val': 0.8773183679369843, 'psi': 0.5078393429283413}-{'f1_val': 0.4090918494569459, 'auprc': 0.4744998929896849, 'loss_val': 0.9883117365502083, 'psi': 0.43525506687004145}
[S14] START round=9 head_norm_before_train=0.757779 cos_to_last_merge=1.0000 (last merge round=8)
[S14] round=9 local utility u=0.258745 metrics={'f1_val': 0.3947091538351954, 'auprc': 0.8002693491065, 'loss_val': 0.9137275470979076, 'psi': 0.5569332319437172}-{'f1_val': 0.39652757107859105, 'auprc': 0.6489348915686333, 'loss_val': 0.9881246017208164, 'psi': 0.4974904992746079}
[S15] START round=9 head_norm_before_train=1.121289 cos_to_last_merge=0.9508 (last merge round=2)
[S15] round=9 local utility u=0.039537 metrics={'f1_val': 0.6942388920075632, 'auprc': 0.7804890718564589, 'loss_val': 0.5574700891698287, 'psi': 0.7287389639471215}-{'f1_val': 0.7058505173999026, 'auprc': 0.7768565480867939, 'loss_val': 0.6953159259984466, 'psi': 0.7342529296746592}
[S16] START round=9 head_norm_before_train=1.362367 (no previous merge yet)
[S16] round=9 local utility u=0.019441 metrics={'f1_val': 0.3829489137658042, 'auprc': 0.7952587068032604, 'loss_val': 0.6964892276289238, 'psi': 0.5478728309807867}-{'f1_val': 0.3835093748926773, 'auprc': 0.7964826602745828, 'loss_val': 0.7424058161516489, 'psi': 0.5486986890454395}
[S17] START round=9 head_norm_before_train=1.166600 cos_to_last_merge=0.9203 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.920
[S17] round=9 local utility u=0.175467 metrics={'f1_val': 0.34493950552713676, 'auprc': 0.6336247766330642, 'loss_val': 0.9346690629574848, 'psi': 0.46041361396950775}-{'f1_val': 0.3535245246810777, 'auprc': 0.4786757438702629, 'loss_val': 0.8722670345328685, 'psi': 0.4035850123567518}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] → sending delta(kind=head bytes=1800) to S7@127.0.0.1:54508
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S3] → sending delta(kind=head bytes=1806) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S13] → sending delta(kind=head bytes=1794) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] → sending delta(kind=head bytes=1798) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S8] → sending delta(kind=head bytes=1792) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] → sending delta(kind=head bytes=1797) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S11] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1792 to 1 peers)
[S5] sending update (kind=head size=1798 to 1 peers)
[S7] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1794 to 1 peers)
[S16] sending update (kind=head size=1794 to 1 peers)
[S3] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1798 to 1 peers)
[S15] sending update (kind=head size=1797 to 1 peers)
[S6] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1800 to 1 peers)
[S3] RECEIVED delta(kind=head bytes=1798) from S5
[S3] cosine check vs S5: cos=-0.0911
[S3] DROPPED delta from S5 (cos=-0.0911 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1800) from S14
[S7] cosine check vs S14: cos=0.2086
[S14] RECEIVED delta(kind=head bytes=1794) from S16
[S14] cosine check vs S16: cos=0.5240
[S5] RECEIVED delta(kind=head bytes=1792) from S8
[S5] cosine check vs S8: cos=-0.0983
[S5] DROPPED delta from S8 (cos=-0.0983 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9777
[S14] RECEIVED delta(kind=head bytes=1797) from S15
[S14] cosine check vs S15: cos=0.6760
[S6] RECEIVED delta(kind=head bytes=1798) from S2
[S6] cosine check vs S2: cos=0.9576
[S7] RECEIVED delta(kind=head bytes=1800) from S6
[S7] cosine check vs S6: cos=0.5396
[S14] RECEIVED delta(kind=head bytes=1806) from S3
[S14] cosine check vs S3: cos=0.5535
[S7] RECEIVED delta(kind=head bytes=1800) from S9
[S7] cosine check vs S9: cos=0.7615
[S10] RECEIVED delta(kind=head bytes=1794) from S13
[S10] cosine check vs S13: cos=0.8701
[S13] RECEIVED delta(kind=head bytes=1798) from S7
[S13] cosine check vs S7: cos=0.7439
[S5] RECEIVED delta(kind=head bytes=1794) from S10
[S5] cosine check vs S10: cos=-0.0799
[S5] DROPPED delta from S10 (cos=-0.0799 < 0.0)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=-0.0211
[S8] DROPPED delta from S17 (cos=-0.0211 < 0.0)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=9 metric=0.4170 head_norm=1.048248
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.259629e-01
[S2] stored merged vector for next round verification (round=9)
[S2] DEBUG after merge:  round=9 metric=0.4165 head_norm=1.091550 delta_norm=0.125963
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=9 metric=0.3947 head_norm=0.808553
[S14] _apply_head_vector_avg (torch): Δ‖w‖=3.170246e-01
[S14] stored merged vector for next round verification (round=9)
[S14] DEBUG after merge:  round=9 metric=0.3963 head_norm=0.861514 delta_norm=0.317025
[S14] aggregate: ACCEPT kept=['S16', 'S15', 'S3'] (k=3/3) mode=median trim_p=0.1
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=9 metric=0.6623 head_norm=0.745987
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.865969e-01
[S7] stored merged vector for next round verification (round=9)
[S7] DEBUG after merge:  round=9 metric=0.6463 head_norm=0.642074 delta_norm=0.186597
[S7] aggregate: ROLLBACK (f1_val pre=0.662 post=0.646 tol_abs=0.005 tol_rel=0.0)
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=9 metric=0.5747 head_norm=0.906777
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.585719e-01
[S6] stored merged vector for next round verification (round=9)
[S6] DEBUG after merge:  round=9 metric=0.2789 head_norm=0.967155 delta_norm=0.158572
[S6] aggregate: ROLLBACK (f1_val pre=0.575 post=0.279 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=9 metric=0.4158 head_norm=0.828371
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.843011e-01
[S13] stored merged vector for next round verification (round=9)
[S13] DEBUG after merge:  round=9 metric=0.4158 head_norm=0.735201 delta_norm=0.284301
[S13] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=9 metric=0.5901 head_norm=0.883571
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.197708e-01
[S10] stored merged vector for next round verification (round=9)
[S10] DEBUG after merge:  round=9 metric=0.6261 head_norm=0.827737 delta_norm=0.219771
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=10 head_norm_before_train=1.091550 cos_to_last_merge=1.0000 (last merge round=9)
[S2] round=10 local utility u=0.977003 metrics={'f1_val': 0.7114907223425483, 'auprc': 0.8101809636148749, 'loss_val': 0.9080270478033956, 'psi': 0.7509668188514789}-{'f1_val': 0.41698068739424143, 'auprc': 0.778044284994582, 'loss_val': 0.9985621117630868, 'psi': 0.5614061264343777}
[S3] START round=10 head_norm_before_train=1.667668 (no previous merge yet)
[S3] round=10 local utility u=0.132716 metrics={'f1_val': 0.9974271292865575, 'auprc': 0.9987008177244687, 'loss_val': 0.08135417617595482, 'psi': 0.9979366046617221}-{'f1_val': 0.9607409897453603, 'auprc': 0.9983318080318894, 'loss_val': 0.12556326310418658, 'psi': 0.975777317059972}
[S4] START round=10 head_norm_before_train=1.176413 cos_to_last_merge=0.9108 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.911
[S4] round=10 local utility u=0.370003 metrics={'f1_val': 0.6615127209425186, 'auprc': 0.8880665335736879, 'loss_val': 0.4725855046085556, 'psi': 0.7521342459949864}-{'f1_val': 0.6604350467957172, 'auprc': 0.6568288897457852, 'loss_val': 0.5124126089384416, 'psi': 0.6589925839757445}
[S5] START round=10 head_norm_before_train=1.616029 (no previous merge yet)
[S5] round=10 local utility u=0.000000 metrics={'f1_val': 0.731733565569135, 'auprc': 0.8799143539405619, 'loss_val': 0.30275186824776995, 'psi': 0.7910058809177059}-{'f1_val': 0.7753246481095959, 'auprc': 0.8873607434599388, 'loss_val': 0.304833008112354, 'psi': 0.8201390862497331}
[S6] START round=10 head_norm_before_train=0.967155 cos_to_last_merge=1.0000 (last merge round=9)
[S6] round=10 local utility u=0.884718 metrics={'f1_val': 0.708543111734601, 'auprc': 0.9750975113455016, 'loss_val': 0.706378712611197, 'psi': 0.8151648715789612}-{'f1_val': 0.5747005714216802, 'auprc': 0.7234074264914283, 'loss_val': 0.917690050955264, 'psi': 0.6341833134495795}
[S7] START round=10 head_norm_before_train=0.642074 cos_to_last_merge=1.0000 (last merge round=9)
[S7] round=10 local utility u=0.000000 metrics={'f1_val': 0.6483901809417945, 'auprc': 0.7632384908642502, 'loss_val': 0.7182643783813197, 'psi': 0.6943295049107767}-{'f1_val': 0.6623470304558419, 'auprc': 0.7920017851926525, 'loss_val': 0.7445016447834566, 'psi': 0.714208932350566}
[S8] START round=10 head_norm_before_train=1.421254 (no previous merge yet)
[S8] round=10 local utility u=0.107560 metrics={'f1_val': 0.7140449400060004, 'auprc': 0.998145654536075, 'loss_val': 0.4079985872604502, 'psi': 0.8276852258180303}-{'f1_val': 0.7140451255766143, 'auprc': 0.9955484205904122, 'loss_val': 0.6153285166565954, 'psi': 0.8266464435821335}
[S9] START round=10 head_norm_before_train=1.464102 cos_to_last_merge=0.8609 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.861
[S9] round=10 local utility u=0.030341 metrics={'f1_val': 0.9888471887074294, 'auprc': 0.9983359086670837, 'loss_val': 0.11556419628969213, 'psi': 0.9926426766912911}-{'f1_val': 0.9861123006036613, 'auprc': 0.9980496420876664, 'loss_val': 0.158977879403242, 'psi': 0.9908872371972635}
[S10] START round=10 head_norm_before_train=0.827737 cos_to_last_merge=1.0000 (last merge round=9)
[S10] round=10 local utility u=0.375945 metrics={'f1_val': 0.6955198660264592, 'auprc': 0.9959961635011922, 'loss_val': 0.7254871793594512, 'psi': 0.8157103850163524}-{'f1_val': 0.5900556292001278, 'auprc': 0.9946759321611577, 'loss_val': 0.840630615144157, 'psi': 0.7519037503845397}
[S11] START round=10 head_norm_before_train=1.147115 cos_to_last_merge=0.9095 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.909
[S11] round=10 local utility u=0.519039 metrics={'f1_val': 0.6986691747903242, 'auprc': 0.9914567633900744, 'loss_val': 0.520997507001778, 'psi': 0.8157842102302243}-{'f1_val': 0.55819491040925, 'auprc': 0.980690698459324, 'loss_val': 0.6839314302639602, 'psi': 0.7271932256292796}
[S13] START round=10 head_norm_before_train=0.735201 cos_to_last_merge=1.0000 (last merge round=9)
[S13] round=10 local utility u=0.000000 metrics={'f1_val': 0.42999099230396487, 'auprc': 0.4784417666264649, 'loss_val': 0.9413574560181522, 'psi': 0.4493713020329649}-{'f1_val': 0.41580726865236384, 'auprc': 0.6458874543423077, 'loss_val': 0.8773183679369843, 'psi': 0.5078393429283413}
[S14] START round=10 head_norm_before_train=0.861514 cos_to_last_merge=1.0000 (last merge round=9)
[S14] round=10 local utility u=0.339676 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9968322479691889, 'loss_val': 0.8351715770098721, 'psi': 0.6366692205738705}-{'f1_val': 0.3947091538351954, 'auprc': 0.8002693491065, 'loss_val': 0.9137275470979076, 'psi': 0.5569332319437172}
[S15] START round=10 head_norm_before_train=1.174798 cos_to_last_merge=0.9348 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=10 local utility u=0.054254 metrics={'f1_val': 0.6945836169482897, 'auprc': 0.7823939358440496, 'loss_val': 0.45674542987988775, 'psi': 0.7297077445065936}-{'f1_val': 0.6942388920075632, 'auprc': 0.7804890718564589, 'loss_val': 0.5574700891698287, 'psi': 0.7287389639471215}
[S16] START round=10 head_norm_before_train=1.396327 (no previous merge yet)
[S16] round=10 local utility u=0.000000 metrics={'f1_val': 0.3861779451794232, 'auprc': 0.7773417479770895, 'loss_val': 0.6721696545430538, 'psi': 0.5426434662984898}-{'f1_val': 0.3829489137658042, 'auprc': 0.7952587068032604, 'loss_val': 0.6964892276289238, 'psi': 0.5478728309807867}
[S17] START round=10 head_norm_before_train=1.208624 cos_to_last_merge=0.9060 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.906
[S17] round=10 local utility u=0.054062 metrics={'f1_val': 0.35273268957802617, 'auprc': 0.6500693298316639, 'loss_val': 0.9226381794161506, 'psi': 0.4716673456794812}-{'f1_val': 0.34493950552713676, 'auprc': 0.6336247766330642, 'loss_val': 0.9346690629574848, 'psi': 0.46041361396950775}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S4] → sending delta(kind=head bytes=1792) to S14@127.0.0.1:54514
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] → sending delta(kind=head bytes=1795) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S14] → sending delta(kind=head bytes=1794) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] → sending delta(kind=head bytes=1796) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] → sending delta(kind=head bytes=1794) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S3] → sending delta(kind=head bytes=1810) to S14@127.0.0.1:54514
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S6@127.0.0.1:54507
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S15] sending update (kind=head size=1794 to 1 peers)
[S14] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S6] sending update (kind=head size=1795 to 1 peers)
[S4] sending update (kind=head size=1792 to 1 peers)
[S3] sending update (kind=head size=1810 to 1 peers)
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1801) from S8
[S5] cosine check vs S8: cos=-0.1027
[S5] DROPPED delta from S8 (cos=-0.1027 < 0.0)
[S5] RECEIVED delta(kind=head bytes=1796) from S10
[S5] cosine check vs S10: cos=-0.0999
[S5] DROPPED delta from S10 (cos=-0.0999 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1810) from S3
[S14] cosine check vs S3: cos=0.4709
[S14] RECEIVED delta(kind=head bytes=1794) from S15
[S14] cosine check vs S15: cos=0.8058
[S14] RECEIVED delta(kind=head bytes=1792) from S4
[S14] cosine check vs S4: cos=0.3227
[S7] RECEIVED delta(kind=head bytes=1795) from S6
[S7] cosine check vs S6: cos=0.5760
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9824
[S7] RECEIVED delta(kind=head bytes=1794) from S14
[S7] cosine check vs S14: cos=0.3366
[S6] RECEIVED delta(kind=head bytes=1802) from S2
[S6] cosine check vs S2: cos=0.9722
[S7] RECEIVED delta(kind=head bytes=1796) from S9
[S7] cosine check vs S9: cos=0.6922
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0179
[S8] DROPPED delta from S17 (cos=-0.0179 < 0.0)
[S13] ⇄ pheromone p=0.237 → S10@127.0.0.1:54511
[S7] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=10 metric=0.6484 head_norm=0.708421
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.436188e-01
[S7] stored merged vector for next round verification (round=10)
[S7] DEBUG after merge:  round=10 metric=0.6450 head_norm=0.658783 delta_norm=0.143619
[S7] aggregate: ACCEPT kept=['S6', 'S14', 'S9'] (k=3/3) mode=median trim_p=0.1
[S7] ⇄ pheromone p=0.345 → S9@127.0.0.1:54510
[S5] ⇄ pheromone p=0.252 → S8@127.0.0.1:54509
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=10 metric=0.7115 head_norm=1.119213
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.169304e-01
[S2] stored merged vector for next round verification (round=10)
[S2] DEBUG after merge:  round=10 metric=0.6988 head_norm=1.156679 delta_norm=0.116930
[S2] aggregate: ROLLBACK (f1_val pre=0.711 post=0.699 tol_abs=0.005 tol_rel=0.0)
[S2] ⇄ pheromone p=0.420 → S11@127.0.0.1:54512
[S11] ⇄ pheromone p=0.462 → S2@127.0.0.1:54502
[S3] ⇄ pheromone p=0.398 → S5@127.0.0.1:54505
[S6] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S6] DEBUG before merge: round=10 metric=0.7085 head_norm=1.002109
[S6] _apply_head_vector_avg (torch): Δ‖w‖=1.379116e-01
[S6] stored merged vector for next round verification (round=10)
[S6] DEBUG after merge:  round=10 metric=0.7084 head_norm=1.053286 delta_norm=0.137912
[S6] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S6] ⇄ pheromone p=0.457 → S2@127.0.0.1:54502
[S14] aggregate: batch=3 kept=3 dropped=0 (cos_th=0.0)
[S14] DEBUG before merge: round=10 metric=0.3966 head_norm=0.901699
[S14] _apply_head_vector_avg (torch): Δ‖w‖=2.366436e-01
[S14] stored merged vector for next round verification (round=10)
[S14] DEBUG after merge:  round=10 metric=0.3966 head_norm=0.841905 delta_norm=0.236644
[S14] aggregate: ACCEPT kept=['S3', 'S15', 'S4'] (k=3/3) mode=median trim_p=0.1
[S14] ⇄ pheromone p=0.321 → S7@127.0.0.1:54508
[S10] ⇄ pheromone p=0.440 → S13@127.0.0.1:54513
[S8] ⇄ pheromone p=0.368 → S17@127.0.0.1:54517
[S15] ⇄ pheromone p=0.319 → S14@127.0.0.1:54514
[S17] ⇄ pheromone p=0.231 → S8@127.0.0.1:54509
[S16] ⇄ pheromone p=0.184 → S14@127.0.0.1:54514
[S2] START round=11 head_norm_before_train=1.156679 cos_to_last_merge=1.0000 (last merge round=10)
[S2] round=11 local utility u=0.067378 metrics={'f1_val': 0.7131380048364027, 'auprc': 0.8041089173424538, 'loss_val': 0.7649393248001888, 'psi': 0.7495263698388231}-{'f1_val': 0.7114907223425483, 'auprc': 0.8101809636148749, 'loss_val': 0.9080270478033956, 'psi': 0.7509668188514789}
[S3] START round=11 head_norm_before_train=1.703245 (no previous merge yet)
[S3] round=11 local utility u=0.000000 metrics={'f1_val': 0.9256967328011578, 'auprc': 0.9985237934359672, 'loss_val': 0.1787824757975332, 'psi': 0.9548275570550816}-{'f1_val': 0.9974271292865575, 'auprc': 0.9987008177244687, 'loss_val': 0.08135417617595482, 'psi': 0.9979366046617221}
[S4] START round=11 head_norm_before_train=1.232335 cos_to_last_merge=0.8966 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.897
[S4] round=11 local utility u=0.098576 metrics={'f1_val': 0.6638370201596517, 'auprc': 0.9453030740306018, 'loss_val': 0.4610888672778426, 'psi': 0.7764234417080318}-{'f1_val': 0.6615127209425186, 'auprc': 0.8880665335736879, 'loss_val': 0.4725855046085556, 'psi': 0.7521342459949864}
[S5] START round=11 head_norm_before_train=1.642964 (no previous merge yet)
[S5] round=11 local utility u=0.107661 metrics={'f1_val': 0.7006083926626743, 'auprc': 0.9961576508890434, 'loss_val': 0.24940932300601726, 'psi': 0.8188280959532219}-{'f1_val': 0.731733565569135, 'auprc': 0.8799143539405619, 'loss_val': 0.30275186824776995, 'psi': 0.7910058809177059}
[S6] START round=11 head_norm_before_train=1.053286 cos_to_last_merge=1.0000 (last merge round=10)
[S6] round=11 local utility u=0.057242 metrics={'f1_val': 0.7105966106954307, 'auprc': 0.9672827145809171, 'loss_val': 0.5807711539490925, 'psi': 0.8132710522496251}-{'f1_val': 0.708543111734601, 'auprc': 0.9750975113455016, 'loss_val': 0.706378712611197, 'psi': 0.8151648715789612}
[S7] START round=11 head_norm_before_train=0.658783 cos_to_last_merge=1.0000 (last merge round=10)
[S7] round=11 local utility u=0.000000 metrics={'f1_val': 0.5502170195914199, 'auprc': 0.6296108366262201, 'loss_val': 0.8578524726641621, 'psi': 0.58197454640534}-{'f1_val': 0.6483901809417945, 'auprc': 0.7632384908642502, 'loss_val': 0.7182643783813197, 'psi': 0.6943295049107767}
[S8] START round=11 head_norm_before_train=1.470784 (no previous merge yet)
[S8] round=11 local utility u=0.004329 metrics={'f1_val': 0.7011458658955103, 'auprc': 0.9973346069054745, 'loss_val': 0.31951213487632474, 'psi': 0.8196213622994959}-{'f1_val': 0.7140449400060004, 'auprc': 0.998145654536075, 'loss_val': 0.4079985872604502, 'psi': 0.8276852258180303}
[S9] START round=11 head_norm_before_train=1.513698 cos_to_last_merge=0.8539 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.854
[S9] round=11 local utility u=0.025065 metrics={'f1_val': 0.9905410059937811, 'auprc': 0.9983521262070241, 'loss_val': 0.07564619296042291, 'psi': 0.9936654540790784}-{'f1_val': 0.9888471887074294, 'auprc': 0.9983359086670837, 'loss_val': 0.11556419628969213, 'psi': 0.9926426766912911}
[S10] START round=11 head_norm_before_train=0.874335 cos_to_last_merge=0.9948 (last merge round=9)
[S10] round=11 local utility u=0.098878 metrics={'f1_val': 0.7000680725537874, 'auprc': 0.998004631089247, 'loss_val': 0.5610465228454365, 'psi': 0.8192426959679713}-{'f1_val': 0.6955198660264592, 'auprc': 0.9959961635011922, 'loss_val': 0.7254871793594512, 'psi': 0.8157103850163524}
[S11] START round=11 head_norm_before_train=1.204376 cos_to_last_merge=0.8933 (last merge round=1)
[S11] ⚠️ Model drifted since last merge! cos=0.893
[S11] round=11 local utility u=0.018106 metrics={'f1_val': 0.7013446489040023, 'auprc': 0.9951340043278063, 'loss_val': 0.511870289705368, 'psi': 0.8188603910735239}-{'f1_val': 0.6986691747903242, 'auprc': 0.9914567633900744, 'loss_val': 0.520997507001778, 'psi': 0.8157842102302243}
[S13] START round=11 head_norm_before_train=0.767980 cos_to_last_merge=0.9947 (last merge round=9)
[S13] round=11 local utility u=0.002976 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.48746491574375184, 'loss_val': 0.877373066733842, 'psi': 0.444470327488919}-{'f1_val': 0.42999099230396487, 'auprc': 0.4784417666264649, 'loss_val': 0.9413574560181522, 'psi': 0.4493713020329649}
[S14] START round=11 head_norm_before_train=0.841905 cos_to_last_merge=1.0000 (last merge round=10)
[S14] round=11 local utility u=0.027612 metrics={'f1_val': 0.39652757107859105, 'auprc': 0.9954931377399621, 'loss_val': 0.7757325829627706, 'psi': 0.6361137977431395}-{'f1_val': 0.39656053564365834, 'auprc': 0.9968322479691889, 'loss_val': 0.8351715770098721, 'psi': 0.6366692205738705}
[S15] START round=11 head_norm_before_train=1.231717 cos_to_last_merge=0.9188 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=11 local utility u=0.007446 metrics={'f1_val': 0.6953935457165975, 'auprc': 0.7775179951092301, 'loss_val': 0.4320861002373038, 'psi': 0.7282433254736506}-{'f1_val': 0.6945836169482897, 'auprc': 0.7823939358440496, 'loss_val': 0.45674542987988775, 'psi': 0.7297077445065936}
[S16] START round=11 head_norm_before_train=1.434668 (no previous merge yet)
[S16] round=11 local utility u=0.134186 metrics={'f1_val': 0.42834791556890517, 'auprc': 0.7790373172739369, 'loss_val': 0.6619045993363472, 'psi': 0.5686236762509178}-{'f1_val': 0.3861779451794232, 'auprc': 0.7773417479770895, 'loss_val': 0.6721696545430538, 'psi': 0.5426434662984898}
[S17] START round=11 head_norm_before_train=1.244385 cos_to_last_merge=0.8929 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.893
[S17] round=11 local utility u=0.035063 metrics={'f1_val': 0.35377670659357163, 'auprc': 0.6657231323051829, 'loss_val': 0.9057377839229637, 'psi': 0.47855527687821614}-{'f1_val': 0.35273268957802617, 'auprc': 0.6500693298316639, 'loss_val': 0.9226381794161506, 'psi': 0.4716673456794812}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] → sending delta(kind=head bytes=1797) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] → sending delta(kind=head bytes=1793) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S5] sending update (kind=head size=1793 to 1 peers)
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1796) from S8
[S5] cosine check vs S8: cos=-0.1060
[S5] DROPPED delta from S8 (cos=-0.1060 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.6457
[S8] RECEIVED delta(kind=head bytes=1793) from S5
[S8] cosine check vs S5: cos=-0.1060
[S8] DROPPED delta from S5 (cos=-0.1060 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9861
[S2] RECEIVED delta(kind=head bytes=1802) from S6
[S2] cosine check vs S6: cos=0.9801
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.9861
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.8590
[S3] RECEIVED delta(kind=head bytes=1797) from S14
[S3] cosine check vs S14: cos=0.5587
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.8590
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0151
[S8] DROPPED delta from S17 (cos=-0.0151 < 0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=11 metric=0.5502 head_norm=0.732667
[S7] _apply_head_vector_avg (torch): Δ‖w‖=6.134558e-01
[S7] stored merged vector for next round verification (round=11)
[S7] DEBUG after merge:  round=11 metric=0.5093 head_norm=1.056728 delta_norm=0.613456
[S7] aggregate: ROLLBACK (f1_val pre=0.550 post=0.509 tol_abs=0.005 tol_rel=0.0)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=11 metric=0.9257 head_norm=1.734711
[S3] _apply_head_vector_avg (torch): Δ‖w‖=7.206867e-01
[S3] stored merged vector for next round verification (round=11)
[S3] DEBUG after merge:  round=11 metric=0.9189 head_norm=1.172182 delta_norm=0.720687
[S3] aggregate: ROLLBACK (f1_val pre=0.926 post=0.919 tol_abs=0.005 tol_rel=0.0)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=11 metric=0.4158 head_norm=0.806051
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.387193e-01
[S13] stored merged vector for next round verification (round=11)
[S13] DEBUG after merge:  round=11 metric=0.4158 head_norm=0.838235 delta_norm=0.238719
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=11 metric=0.7001 head_norm=0.932486
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.387193e-01
[S10] stored merged vector for next round verification (round=11)
[S10] DEBUG after merge:  round=11 metric=0.7001 head_norm=0.838235 delta_norm=0.238719
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=11 metric=0.7013 head_norm=1.256745
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.073148e-01
[S11] stored merged vector for next round verification (round=11)
[S11] DEBUG after merge:  round=11 metric=0.7025 head_norm=1.218636 delta_norm=0.107315
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=11 metric=0.7131 head_norm=1.189022
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.294911e-02
[S2] stored merged vector for next round verification (round=11)
[S2] DEBUG after merge:  round=11 metric=0.7022 head_norm=1.173074 delta_norm=0.062949
[S2] aggregate: ROLLBACK (f1_val pre=0.713 post=0.702 tol_abs=0.005 tol_rel=0.0)
[S2] START round=12 head_norm_before_train=1.173074 cos_to_last_merge=1.0000 (last merge round=11)
[S2] round=12 local utility u=0.226478 metrics={'f1_val': 0.7013925629565125, 'auprc': 0.9418083979499978, 'loss_val': 0.6546088976081906, 'psi': 0.7975588969539067}-{'f1_val': 0.7131380048364027, 'auprc': 0.8041089173424538, 'loss_val': 0.7649393248001888, 'psi': 0.7495263698388231}
[S3] START round=12 head_norm_before_train=1.172182 cos_to_last_merge=1.0000 (last merge round=11)
[S3] round=12 local utility u=0.109282 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9981410303972749, 'loss_val': 0.16981093682714046, 'psi': 0.9757486040203907}-{'f1_val': 0.9256967328011578, 'auprc': 0.9985237934359672, 'loss_val': 0.1787824757975332, 'psi': 0.9548275570550816}
[S4] START round=12 head_norm_before_train=1.281754 cos_to_last_merge=0.8851 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.885
[S4] round=12 local utility u=0.031114 metrics={'f1_val': 0.6661066267183025, 'auprc': 0.9553174761341268, 'loss_val': 0.4425221022798042, 'psi': 0.7817909664846322}-{'f1_val': 0.6638370201596517, 'auprc': 0.9453030740306018, 'loss_val': 0.4610888672778426, 'psi': 0.7764234417080318}
[S5] START round=12 head_norm_before_train=1.657450 (no previous merge yet)
[S5] round=12 local utility u=0.463844 metrics={'f1_val': 0.8499969771492657, 'auprc': 0.9957970463815072, 'loss_val': 0.21697201203275995, 'psi': 0.9083170048421623}-{'f1_val': 0.7006083926626743, 'auprc': 0.9961576508890434, 'loss_val': 0.24940932300601726, 'psi': 0.8188280959532219}
[S6] START round=12 head_norm_before_train=1.090459 cos_to_last_merge=0.9968 (last merge round=10)
[S6] round=12 local utility u=0.040378 metrics={'f1_val': 0.7097648965817523, 'auprc': 0.9662879430771514, 'loss_val': 0.4920409839029923, 'psi': 0.812374115179912}-{'f1_val': 0.7105966106954307, 'auprc': 0.9672827145809171, 'loss_val': 0.5807711539490925, 'psi': 0.8132710522496251}
[S7] START round=12 head_norm_before_train=1.056728 cos_to_last_merge=1.0000 (last merge round=11)
[S7] round=12 local utility u=0.389040 metrics={'f1_val': 0.5974330441795306, 'auprc': 0.7564795816293077, 'loss_val': 0.7436744035939026, 'psi': 0.6610516591594415}-{'f1_val': 0.5502170195914199, 'auprc': 0.6296108366262201, 'loss_val': 0.8578524726641621, 'psi': 0.58197454640534}
[S8] START round=12 head_norm_before_train=1.515446 (no previous merge yet)
[S8] round=12 local utility u=0.070749 metrics={'f1_val': 0.7140451255766143, 'auprc': 0.9978101852891812, 'loss_val': 0.25683618357959864, 'psi': 0.827551149461641}-{'f1_val': 0.7011458658955103, 'auprc': 0.9973346069054745, 'loss_val': 0.31951213487632474, 'psi': 0.8196213622994959}
[S9] START round=12 head_norm_before_train=1.564994 cos_to_last_merge=0.8470 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.847
[S9] round=12 local utility u=0.021166 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.9983627220607036, 'loss_val': 0.051050138529002184, 'psi': 0.995440198130104}-{'f1_val': 0.9905410059937811, 'auprc': 0.9983521262070241, 'loss_val': 0.07564619296042291, 'psi': 0.9936654540790784}
[S10] START round=12 head_norm_before_train=0.838235 cos_to_last_merge=1.0000 (last merge round=11)
[S10] round=12 local utility u=0.007025 metrics={'f1_val': 0.6976631647901288, 'auprc': 0.9975096812315912, 'loss_val': 0.5310831809690595, 'psi': 0.8176017713667139}-{'f1_val': 0.7000680725537874, 'auprc': 0.998004631089247, 'loss_val': 0.5610465228454365, 'psi': 0.8192426959679713}
[S11] START round=12 head_norm_before_train=1.218636 cos_to_last_merge=1.0000 (last merge round=11)
[S11] round=12 local utility u=0.000000 metrics={'f1_val': 0.6234168388341335, 'auprc': 0.9936936072778859, 'loss_val': 0.451012597348865, 'psi': 0.7715275462116344}-{'f1_val': 0.7013446489040023, 'auprc': 0.9951340043278063, 'loss_val': 0.511870289705368, 'psi': 0.8188603910735239}
[S13] START round=12 head_norm_before_train=0.838235 cos_to_last_merge=1.0000 (last merge round=11)
[S13] round=12 local utility u=0.003492 metrics={'f1_val': 0.41580726865236384, 'auprc': 0.48395468451849466, 'loss_val': 0.8598590791178917, 'psi': 0.44306623499881614}-{'f1_val': 0.41580726865236384, 'auprc': 0.48746491574375184, 'loss_val': 0.877373066733842, 'psi': 0.444470327488919}
[S14] START round=12 head_norm_before_train=0.881803 cos_to_last_merge=0.9961 (last merge round=10)
[S14] round=12 local utility u=0.037685 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9957251299755209, 'loss_val': 0.7012563262560029, 'psi': 0.6362263733764034}-{'f1_val': 0.39652757107859105, 'auprc': 0.9954931377399621, 'loss_val': 0.7757325829627706, 'psi': 0.6361137977431395}
[S15] START round=12 head_norm_before_train=1.282050 cos_to_last_merge=0.9045 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.905
[S15] round=12 local utility u=0.356721 metrics={'f1_val': 0.6973198811799544, 'auprc': 0.97042594044011, 'loss_val': 0.30892569136958603, 'psi': 0.8065623048840166}-{'f1_val': 0.6953935457165975, 'auprc': 0.7775179951092301, 'loss_val': 0.4320861002373038, 'psi': 0.7282433254736506}
[S16] START round=12 head_norm_before_train=1.474604 (no previous merge yet)
[S16] round=12 local utility u=0.329403 metrics={'f1_val': 0.5265135133990183, 'auprc': 0.79619026570184, 'loss_val': 0.6435519489357859, 'psi': 0.634384214320147}-{'f1_val': 0.42834791556890517, 'auprc': 0.7790373172739369, 'loss_val': 0.6619045993363472, 'psi': 0.5686236762509178}
[S17] START round=12 head_norm_before_train=1.268271 cos_to_last_merge=0.8855 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.886
[S17] round=12 local utility u=0.025287 metrics={'f1_val': 0.35477291763381524, 'auprc': 0.6741091498934364, 'loss_val': 0.886298531773141, 'psi': 0.48250741053766366}-{'f1_val': 0.35377670659357163, 'auprc': 0.6657231323051829, 'loss_val': 0.9057377839229637, 'psi': 0.47855527687821614}
[S2]  timeout peer S3
[S2]  timeout peer S4
[S2]  timeout peer S5
[S2]  timeout peer S7
[S2]  timeout peer S8
[S2]  timeout peer S9
[S2]  timeout peer S10
[S2]  timeout peer S13
[S2]  timeout peer S14
[S2]  timeout peer S15
[S2]  timeout peer S16
[S2]  timeout peer S17
[S7]  timeout peer S2
[S7]  timeout peer S3
[S7]  timeout peer S4
[S7]  timeout peer S5
[S7]  timeout peer S8
[S7]  timeout peer S10
[S7]  timeout peer S11
[S7]  timeout peer S13
[S7]  timeout peer S15
[S7]  timeout peer S16
[S7]  timeout peer S17
[S5]  timeout peer S2
[S5]  timeout peer S4
[S5]  timeout peer S6
[S5]  timeout peer S7
[S5]  timeout peer S9
[S5]  timeout peer S11
[S5]  timeout peer S13
[S5]  timeout peer S14
[S5]  timeout peer S15
[S5]  timeout peer S16
[S5]  timeout peer S17
[S3]  timeout peer S2
[S3]  timeout peer S4
[S3]  timeout peer S6
[S3]  timeout peer S7
[S3]  timeout peer S8
[S3]  timeout peer S9
[S3]  timeout peer S10
[S3]  timeout peer S11
[S3]  timeout peer S13
[S3]  timeout peer S14
[S3]  timeout peer S15
[S3]  timeout peer S16
[S3]  timeout peer S17
[S4]  timeout peer S2
[S4]  timeout peer S3
[S4]  timeout peer S5
[S4]  timeout peer S6
[S4]  timeout peer S7
[S4]  timeout peer S8
[S4]  timeout peer S9
[S4]  timeout peer S10
[S4]  timeout peer S11
[S4]  timeout peer S13
[S4]  timeout peer S14
[S4]  timeout peer S15
[S4]  timeout peer S16
[S4]  timeout peer S17
[S10]  timeout peer S2
[S10]  timeout peer S3
[S10]  timeout peer S4
[S10]  timeout peer S5
[S10]  timeout peer S6
[S10]  timeout peer S7
[S10]  timeout peer S8
[S10]  timeout peer S9
[S10]  timeout peer S11
[S10]  timeout peer S14
[S10]  timeout peer S15
[S10]  timeout peer S16
[S10]  timeout peer S17
[S11]  timeout peer S3
[S11]  timeout peer S4
[S11]  timeout peer S5
[S11]  timeout peer S6
[S11]  timeout peer S7
[S11]  timeout peer S8
[S11]  timeout peer S9
[S11]  timeout peer S10
[S8]  timeout peer S2
[S8]  timeout peer S3
[S8]  timeout peer S4
[S8]  timeout peer S6
[S8]  timeout peer S7
[S8]  timeout peer S9
[S8]  timeout peer S10
[S8]  timeout peer S11
[S8]  timeout peer S13
[S8]  timeout peer S14
[S8]  timeout peer S15
[S8]  timeout peer S16
[S9]  timeout peer S2
[S9]  timeout peer S3
[S9]  timeout peer S4
[S9]  timeout peer S5
[S9]  timeout peer S6
[S9]  timeout peer S8
[S9]  timeout peer S10
[S9]  timeout peer S11
[S9]  timeout peer S13
[S9]  timeout peer S14
[S9]  timeout peer S15
[S9]  timeout peer S16
[S9]  timeout peer S17
[S6]  timeout peer S3
[S6]  timeout peer S4
[S6]  timeout peer S5
[S6]  timeout peer S7
[S6]  timeout peer S8
[S6]  timeout peer S9
[S6]  timeout peer S10
[S6]  timeout peer S11
[S6]  timeout peer S13
[S6]  timeout peer S14
[S6]  timeout peer S15
[S6]  timeout peer S16
[S6]  timeout peer S17
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S14] → sending delta(kind=head bytes=1792) to S3@127.0.0.1:54503
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S9] → sending delta(kind=head bytes=1803) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] → sending delta(kind=head bytes=1800) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S7] → sending delta(kind=head bytes=1796) to S9@127.0.0.1:54510
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] → sending delta(kind=head bytes=1794) to S8@127.0.0.1:54509
[S8] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1803 to 1 peers)
[S6] sending update (kind=head size=1801 to 1 peers)
[S5] sending update (kind=head size=1794 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S3] sending update (kind=head size=1800 to 1 peers)
[S14] sending update (kind=head size=1792 to 1 peers)
[S5] RECEIVED delta(kind=head bytes=1800) from S3
[S5] cosine check vs S3: cos=-0.1037
[S5] DROPPED delta from S3 (cos=-0.1037 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1803) from S9
[S7] cosine check vs S9: cos=0.9512
[S8] RECEIVED delta(kind=head bytes=1794) from S5
[S8] cosine check vs S5: cos=-0.1094
[S8] DROPPED delta from S5 (cos=-0.1094 < 0.0)
[S3] RECEIVED delta(kind=head bytes=1792) from S14
[S3] cosine check vs S14: cos=0.7677
[S5] RECEIVED delta(kind=head bytes=1797) from S8
[S5] cosine check vs S8: cos=-0.1094
[S5] DROPPED delta from S8 (cos=-0.1094 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S6
[S2] cosine check vs S6: cos=0.9768
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=0.9910
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9934
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S3] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S3] DEBUG before merge: round=12 metric=0.9608 head_norm=1.237106
[S3] _apply_head_vector_avg (torch): Δ‖w‖=3.966117e-01
[S3] stored merged vector for next round verification (round=12)
[S3] DEBUG after merge:  round=12 metric=0.9608 head_norm=1.016865 delta_norm=0.396612
[S3] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[S7] sending update (kind=head size=1796 to 1 peers)
[S9] RECEIVED delta(kind=head bytes=1796) from S7
[S9] cosine check vs S7: cos=0.9512
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=12 metric=0.7014 head_norm=1.209769
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.320125e-01
[S2] stored merged vector for next round verification (round=12)
[S2] DEBUG after merge:  round=12 metric=0.7014 head_norm=1.163684 delta_norm=0.132012
[S2] aggregate: ACCEPT kept=['S6'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=-0.0129
[S8] DROPPED delta from S17 (cos=-0.0129 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9934
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=12 metric=0.5974 head_norm=1.102913
[S7] _apply_head_vector_avg (torch): Δ‖w‖=3.298123e-01
[S7] stored merged vector for next round verification (round=12)
[S7] DEBUG after merge:  round=12 metric=0.5725 head_norm=1.342367 delta_norm=0.329812
[S7] aggregate: ROLLBACK (f1_val pre=0.597 post=0.572 tol_abs=0.005 tol_rel=0.0)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=12 metric=0.6234 head_norm=1.260089
[S11] _apply_head_vector_avg (torch): Δ‖w‖=8.637961e-02
[S11] stored merged vector for next round verification (round=12)
[S11] DEBUG after merge:  round=12 metric=0.6222 head_norm=1.232161 delta_norm=0.086380
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14]  timeout peer S2
[S14]  timeout peer S5
[S14]  timeout peer S6
[S14]  timeout peer S7
[S14]  timeout peer S8
[S14]  timeout peer S9
[S14]  timeout peer S10
[S14]  timeout peer S11
[S14]  timeout peer S13
[S14]  timeout peer S17
[S11]  timeout peer S13
[S11]  timeout peer S14
[S11]  timeout peer S15
[S11]  timeout peer S16
[S11]  timeout peer S17
[S15]  timeout peer S2
[S15]  timeout peer S3
[S15]  timeout peer S4
[S15]  timeout peer S5
[S15]  timeout peer S6
[S15]  timeout peer S7
[S15]  timeout peer S8
[S15]  timeout peer S9
[S15]  timeout peer S10
[S15]  timeout peer S11
[S15]  timeout peer S13
[S15]  timeout peer S14
[S15]  timeout peer S16
[S15]  timeout peer S17
[S16]  timeout peer S2
[S16]  timeout peer S3
[S16]  timeout peer S4
[S16]  timeout peer S5
[S16]  timeout peer S6
[S16]  timeout peer S7
[S16]  timeout peer S8
[S16]  timeout peer S9
[S16]  timeout peer S10
[S16]  timeout peer S11
[S16]  timeout peer S13
[S16]  timeout peer S14
[S16]  timeout peer S15
[S16]  timeout peer S17
[S13]  timeout peer S2
[S13]  timeout peer S3
[S13]  timeout peer S4
[S13]  timeout peer S5
[S13]  timeout peer S6
[S13]  timeout peer S8
[S13]  timeout peer S9
[S13]  timeout peer S11
[S13]  timeout peer S14
[S13]  timeout peer S15
[S13]  timeout peer S16
[S13]  timeout peer S17
[S17]  timeout peer S2
[S17]  timeout peer S3
[S17]  timeout peer S4
[S17]  timeout peer S5
[S17]  timeout peer S6
[S17]  timeout peer S7
[S17]  timeout peer S9
[S17]  timeout peer S10
[S17]  timeout peer S11
[S17]  timeout peer S13
[S17]  timeout peer S14
[S17]  timeout peer S15
[S17]  timeout peer S16
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=12 metric=0.4158 head_norm=0.870905
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.250398e-02
[S13] stored merged vector for next round verification (round=12)
[S13] DEBUG after merge:  round=12 metric=0.4158 head_norm=0.882571 delta_norm=0.052504
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=13 head_norm_before_train=1.163684 cos_to_last_merge=1.0000 (last merge round=12)
[S2] round=13 local utility u=0.026045 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.9022971612333432, 'loss_val': 0.48505566830355284, 'psi': 0.7818614999164863}-{'f1_val': 0.7013925629565125, 'auprc': 0.9418083979499978, 'loss_val': 0.6546088976081906, 'psi': 0.7975588969539067}
[S3] START round=13 head_norm_before_train=1.016865 cos_to_last_merge=1.0000 (last merge round=12)
[S3] round=13 local utility u=0.113191 metrics={'f1_val': 0.9971434701490716, 'auprc': 0.9982949362535161, 'loss_val': 0.16182951382408803, 'psi': 0.9976040565908493}-{'f1_val': 0.9608203197691346, 'auprc': 0.9981410303972749, 'loss_val': 0.16981093682714046, 'psi': 0.9757486040203907}
[S4] START round=13 head_norm_before_train=1.317363 cos_to_last_merge=0.8760 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.876
[S4] round=13 local utility u=0.798180 metrics={'f1_val': 0.937236135779392, 'auprc': 0.9406789166257045, 'loss_val': 0.42902330197140376, 'psi': 0.938613248117917}-{'f1_val': 0.6661066267183025, 'auprc': 0.9553174761341268, 'loss_val': 0.4425221022798042, 'psi': 0.7817909664846322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=13 head_norm_before_train=1.670606 (no previous merge yet)
[S5] round=13 local utility u=0.000000 metrics={'f1_val': 0.8423256111729914, 'auprc': 0.9947542527553238, 'loss_val': 0.219042815557211, 'psi': 0.9032970678059243}-{'f1_val': 0.8499969771492657, 'auprc': 0.9957970463815072, 'loss_val': 0.21697201203275995, 'psi': 0.9083170048421623}
[S6] START round=13 head_norm_before_train=1.131209 cos_to_last_merge=0.9901 (last merge round=10)
[S6] round=13 local utility u=0.030547 metrics={'f1_val': 0.7097638462982354, 'auprc': 0.9661554751413131, 'loss_val': 0.43054405244568933, 'psi': 0.8123204978354666}-{'f1_val': 0.7097648965817523, 'auprc': 0.9662879430771514, 'loss_val': 0.4920409839029923, 'psi': 0.812374115179912}
[S7] START round=13 head_norm_before_train=1.342367 cos_to_last_merge=1.0000 (last merge round=12)
[S7] round=13 local utility u=0.000000 metrics={'f1_val': 0.5573650660893803, 'auprc': 0.7909538432072585, 'loss_val': 0.7943183817135574, 'psi': 0.6508005769365316}-{'f1_val': 0.5974330441795306, 'auprc': 0.7564795816293077, 'loss_val': 0.7436744035939026, 'psi': 0.6610516591594415}
[S8] START round=13 head_norm_before_train=1.552979 (no previous merge yet)
[S8] round=13 local utility u=0.085085 metrics={'f1_val': 0.7322760989428282, 'auprc': 0.9985268412457284, 'loss_val': 0.19820240214636, 'psi': 0.8387763958639882}-{'f1_val': 0.7140451255766143, 'auprc': 0.9978101852891812, 'loss_val': 0.25683618357959864, 'psi': 0.827551149461641}
[S9] START round=13 head_norm_before_train=1.614012 cos_to_last_merge=0.8409 (last merge round=1)
[S9] ⚠️ Model drifted since last merge! cos=0.841
[S9] round=13 local utility u=0.012969 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9984743103612648, 'loss_val': 0.037954515426833584, 'psi': 0.9967355594750147}-{'f1_val': 0.9934918488430377, 'auprc': 0.9983627220607036, 'loss_val': 0.051050138529002184, 'psi': 0.995440198130104}
[S10] START round=13 head_norm_before_train=0.897163 cos_to_last_merge=0.9959 (last merge round=11)
[S10] round=13 local utility u=0.022738 metrics={'f1_val': 0.701236798752475, 'auprc': 0.9801288690407675, 'loss_val': 0.45490677617232206, 'psi': 0.812793626867792}-{'f1_val': 0.6976631647901288, 'auprc': 0.9975096812315912, 'loss_val': 0.5310831809690595, 'psi': 0.8176017713667139}
[S11] START round=13 head_norm_before_train=1.232161 cos_to_last_merge=1.0000 (last merge round=12)
[S11] round=13 local utility u=0.282033 metrics={'f1_val': 0.702242488399264, 'auprc': 0.9965437785516954, 'loss_val': 0.36845128309857983, 'psi': 0.8199630044602366}-{'f1_val': 0.6234168388341335, 'auprc': 0.9936936072778859, 'loss_val': 0.451012597348865, 'psi': 0.7715275462116344}
[S13] START round=13 head_norm_before_train=0.882571 cos_to_last_merge=1.0000 (last merge round=12)
[S13] round=13 local utility u=0.539818 metrics={'f1_val': 0.5090579474167999, 'auprc': 0.6330588846495665, 'loss_val': 0.7870404560643465, 'psi': 0.5586583223099065}-{'f1_val': 0.41580726865236384, 'auprc': 0.48395468451849466, 'loss_val': 0.8598590791178917, 'psi': 0.44306623499881614}
[S14] START round=13 head_norm_before_train=0.923146 cos_to_last_merge=0.9873 (last merge round=10)
[S14] round=13 local utility u=0.034845 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9971327004807655, 'loss_val': 0.6357892418448594, 'psi': 0.6367894015785013}-{'f1_val': 0.39656053564365834, 'auprc': 0.9957251299755209, 'loss_val': 0.7012563262560029, 'psi': 0.6362263733764034}
[S15] START round=13 head_norm_before_train=1.322844 cos_to_last_merge=0.8930 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.893
[S15] round=13 local utility u=0.017262 metrics={'f1_val': 0.697167906613183, 'auprc': 0.9721228927618286, 'loss_val': 0.27858009656449745, 'psi': 0.8071499010726413}-{'f1_val': 0.6973198811799544, 'auprc': 0.97042594044011, 'loss_val': 0.30892569136958603, 'psi': 0.8065623048840166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=13 head_norm_before_train=1.512295 (no previous merge yet)
[S16] round=13 local utility u=0.708132 metrics={'f1_val': 0.7554671522129042, 'auprc': 0.802555863432489, 'loss_val': 0.6201071522187909, 'psi': 0.7743026367007382}-{'f1_val': 0.5265135133990183, 'auprc': 0.79619026570184, 'loss_val': 0.6435519489357859, 'psi': 0.634384214320147}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=13 head_norm_before_train=1.275540 cos_to_last_merge=0.8826 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.883
[S17] round=13 local utility u=0.015244 metrics={'f1_val': 0.3557861836832826, 'auprc': 0.6833331223044239, 'loss_val': 0.8895625214757626, 'psi': 0.48680495913173916}-{'f1_val': 0.35477291763381524, 'auprc': 0.6741091498934364, 'loss_val': 0.886298531773141, 'psi': 0.48250741053766366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S10] → sending delta(kind=head bytes=1797) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] → sending delta(kind=head bytes=1799) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[S10] sending update (kind=head size=1797 to 1 peers)
[S9] sending update (kind=head size=1799 to 1 peers)
[S3] sending update (kind=head size=1802 to 1 peers)
[S6] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S2] → sending delta(kind=head bytes=1791) to S11@127.0.0.1:54512
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[S2] RECEIVED delta(kind=head bytes=1799) from S6
[S2] cosine check vs S6: cos=0.9845
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9829
[S5] RECEIVED delta(kind=head bytes=1802) from S3
[S5] cosine check vs S3: cos=-0.1104
[S5] DROPPED delta from S3 (cos=-0.1104 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=-0.0090
[S8] DROPPED delta from S17 (cos=-0.0090 < 0.0)
[S7] RECEIVED delta(kind=head bytes=1799) from S9
[S7] cosine check vs S9: cos=0.9855
[S13] RECEIVED delta(kind=head bytes=1797) from S10
[S13] cosine check vs S10: cos=0.9888
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1791 to 1 peers)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S9] DEBUG before merge: round=13 metric=0.9956 head_norm=1.653292
[S9] _apply_head_vector_avg (torch): Δ‖w‖=3.499290e-01
[S9] stored merged vector for next round verification (round=13)
[S9] DEBUG after merge:  round=13 metric=0.9956 head_norm=1.361046 delta_norm=0.349929
[S9] aggregate: ACCEPT kept=['S7'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=13 metric=0.7012 head_norm=0.959452
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.183361e-02
[S10] stored merged vector for next round verification (round=13)
[S10] DEBUG after merge:  round=13 metric=0.7012 head_norm=0.911635 delta_norm=0.091834
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] RECEIVED delta(kind=head bytes=1791) from S2
[S11] cosine check vs S2: cos=0.9829
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.1124
[S5] DROPPED delta from S8 (cos=-0.1124 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9974
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=13 metric=0.7016 head_norm=1.201599
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.910785e-02
[S2] stored merged vector for next round verification (round=13)
[S2] DEBUG after merge:  round=13 metric=0.7016 head_norm=1.202491 delta_norm=0.059108
[S2] aggregate: ACCEPT kept=['S6', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=13 metric=0.5091 head_norm=0.916609
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.332210e-02
[S13] stored merged vector for next round verification (round=13)
[S13] DEBUG after merge:  round=13 metric=0.4155 head_norm=0.935405 delta_norm=0.073322
[S13] aggregate: ROLLBACK (f1_val pre=0.509 post=0.415 tol_abs=0.005 tol_rel=0.0)
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=13 metric=0.5574 head_norm=1.378529
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.882644e-01
[S7] stored merged vector for next round verification (round=13)
[S7] DEBUG after merge:  round=13 metric=0.5400 head_norm=1.510435 delta_norm=0.188264
[S7] aggregate: ROLLBACK (f1_val pre=0.557 post=0.540 tol_abs=0.005 tol_rel=0.0)
[S3]  timeout peer S5
[S14]  timeout peer S3
[S14]  timeout peer S4
[S5]  timeout peer S8
[S5]  timeout peer S10
[S13]  timeout peer S7
[S7]  timeout peer S6
[S7]  timeout peer S9
[S6]  timeout peer S2
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:54515
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.6876
[S2] START round=14 head_norm_before_train=1.202491 cos_to_last_merge=1.0000 (last merge round=13)
[S2] round=14 local utility u=0.000000 metrics={'f1_val': 0.7016512288906386, 'auprc': 0.8354855213106496, 'loss_val': 0.45187588900787434, 'psi': 0.755184945858643}-{'f1_val': 0.7015710590385817, 'auprc': 0.9022971612333432, 'loss_val': 0.48505566830355284, 'psi': 0.7818614999164863}
[S3] START round=14 head_norm_before_train=1.120376 cos_to_last_merge=0.9941 (last merge round=12)
[S3] round=14 local utility u=0.000000 metrics={'f1_val': 0.9600800976779673, 'auprc': 0.9970712814880818, 'loss_val': 0.19221687038969426, 'psi': 0.9748765712020131}-{'f1_val': 0.9971434701490716, 'auprc': 0.9982949362535161, 'loss_val': 0.16182951382408803, 'psi': 0.9976040565908493}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=14 head_norm_before_train=1.345821 cos_to_last_merge=0.8684 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.868
[S4] round=14 local utility u=0.063553 metrics={'f1_val': 0.9524682077050065, 'auprc': 0.9459771124737817, 'loss_val': 0.4092035003412675, 'psi': 0.9498717696125166}-{'f1_val': 0.937236135779392, 'auprc': 0.9406789166257045, 'loss_val': 0.42902330197140376, 'psi': 0.938613248117917}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=14 head_norm_before_train=1.686095 (no previous merge yet)
[S5] round=14 local utility u=0.000000 metrics={'f1_val': 0.7146647020320098, 'auprc': 0.7943076938503374, 'loss_val': 0.47006952804219637, 'psi': 0.7465218987593408}-{'f1_val': 0.8423256111729914, 'auprc': 0.9947542527553238, 'loss_val': 0.219042815557211, 'psi': 0.9032970678059243}
[S6] START round=14 head_norm_before_train=1.174190 cos_to_last_merge=0.9818 (last merge round=10)
[S6] round=14 local utility u=0.419433 metrics={'f1_val': 0.8350662169156348, 'auprc': 0.971468898481062, 'loss_val': 0.3594320325051653, 'psi': 0.8896272895418057}-{'f1_val': 0.7097638462982354, 'auprc': 0.9661554751413131, 'loss_val': 0.43054405244568933, 'psi': 0.8123204978354666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=14 head_norm_before_train=1.510435 cos_to_last_merge=1.0000 (last merge round=13)
[S7] round=14 local utility u=0.000000 metrics={'f1_val': 0.5449252225859997, 'auprc': 0.7925237150857332, 'loss_val': 0.8054145194842541, 'psi': 0.6439646195858931}-{'f1_val': 0.5573650660893803, 'auprc': 0.7909538432072585, 'loss_val': 0.7943183817135574, 'psi': 0.6508005769365316}
[S8] START round=14 head_norm_before_train=1.583540 (no previous merge yet)
[S8] round=14 local utility u=0.000000 metrics={'f1_val': 0.7142403782594613, 'auprc': 0.9954875577776888, 'loss_val': 0.19713281783427344, 'psi': 0.8267392500667523}-{'f1_val': 0.7322760989428282, 'auprc': 0.9985268412457284, 'loss_val': 0.19820240214636, 'psi': 0.8387763958639882}
[S9] START round=14 head_norm_before_train=1.361046 cos_to_last_merge=1.0000 (last merge round=13)
[S9] round=14 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9973813172146622, 'loss_val': 0.05860973430636673, 'psi': 0.9969488339741998}-{'f1_val': 0.9955763922175147, 'auprc': 0.9984743103612648, 'loss_val': 0.037954515426833584, 'psi': 0.9967355594750147}
[S10] START round=14 head_norm_before_train=0.911635 cos_to_last_merge=1.0000 (last merge round=13)
[S10] round=14 local utility u=0.000000 metrics={'f1_val': 0.6954770803198259, 'auprc': 0.9772108264136923, 'loss_val': 0.43751905973556304, 'psi': 0.8081705787573725}-{'f1_val': 0.701236798752475, 'auprc': 0.9801288690407675, 'loss_val': 0.45490677617232206, 'psi': 0.812793626867792}
[S11] START round=14 head_norm_before_train=1.266643 cos_to_last_merge=0.9994 (last merge round=12)
[S11] round=14 local utility u=0.029241 metrics={'f1_val': 0.7016934795869249, 'auprc': 0.9959572225971414, 'loss_val': 0.30491604335421413, 'psi': 0.8193989767910115}-{'f1_val': 0.702242488399264, 'auprc': 0.9965437785516954, 'loss_val': 0.36845128309857983, 'psi': 0.8199630044602366}
[S13] START round=14 head_norm_before_train=0.935405 cos_to_last_merge=1.0000 (last merge round=13)
[S13] round=14 local utility u=0.000000 metrics={'f1_val': 0.3557345651094673, 'auprc': 0.4866412177491124, 'loss_val': 0.8216590840996179, 'psi': 0.4080972261653254}-{'f1_val': 0.5090579474167999, 'auprc': 0.6330588846495665, 'loss_val': 0.7870404560643465, 'psi': 0.5586583223099065}
[S14] START round=14 head_norm_before_train=0.965043 cos_to_last_merge=0.9784 (last merge round=10)
[S14] round=14 local utility u=0.032415 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9970919202540329, 'loss_val': 0.5710355552829149, 'psi': 0.6367929301303704}-{'f1_val': 0.39656053564365834, 'auprc': 0.9971327004807655, 'loss_val': 0.6357892418448594, 'psi': 0.6367894015785013}
[S15] START round=14 head_norm_before_train=1.362640 cos_to_last_merge=0.8824 (last merge round=2)
[S15] ⚠️ Model drifted since last merge! cos=0.882
[S15] round=14 local utility u=0.000000 metrics={'f1_val': 0.6973152871821393, 'auprc': 0.8667450658665958, 'loss_val': 0.35999182494856796, 'psi': 0.765087198655922}-{'f1_val': 0.697167906613183, 'auprc': 0.9721228927618286, 'loss_val': 0.27858009656449745, 'psi': 0.8071499010726413}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=14 metric=0.6973 head_norm=1.400665
[S15] _apply_head_vector_avg (torch): Δ‖w‖=5.111233e-01
[S15] stored merged vector for next round verification (round=14)
[S15] DEBUG after merge:  round=14 metric=0.6973 head_norm=1.088732 delta_norm=0.511123
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] START round=14 head_norm_before_train=1.547151 (no previous merge yet)
[S16] round=14 local utility u=0.173041 metrics={'f1_val': 0.8302032664590941, 'auprc': 0.8016565273137457, 'loss_val': 0.7197435700852562, 'psi': 0.8187845708009548}-{'f1_val': 0.7554671522129042, 'auprc': 0.802555863432489, 'loss_val': 0.6201071522187909, 'psi': 0.7743026367007382}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=14 head_norm_before_train=1.282738 cos_to_last_merge=0.8798 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.880
[S17] round=14 local utility u=0.101976 metrics={'f1_val': 0.35494875922871616, 'auprc': 0.7565291564231829, 'loss_val': 0.9001740684089792, 'psi': 0.5155809181065029}-{'f1_val': 0.3557861836832826, 'auprc': 0.6833331223044239, 'loss_val': 0.8895625214757626, 'psi': 0.48680495913173916}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=14 metric=0.6955 head_norm=0.966196
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.228766e-02
[S10] stored merged vector for next round verification (round=14)
[S10] DEBUG after merge:  round=14 metric=0.6955 head_norm=0.939667 delta_norm=0.062288
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:54515
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=-0.0049
[S8] DROPPED delta from S17 (cos=-0.0049 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=0.9808
[S14] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=14 metric=0.7017 head_norm=1.308995
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.381871e-01
[S11] stored merged vector for next round verification (round=14)
[S11] DEBUG after merge:  round=14 metric=0.7017 head_norm=1.248823 delta_norm=0.138187
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.8767
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=14 metric=0.7017 head_norm=1.243789
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.293281e-01
[S2] stored merged vector for next round verification (round=14)
[S2] DEBUG after merge:  round=14 metric=0.7002 head_norm=1.270242 delta_norm=0.129328
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=15 head_norm_before_train=1.270242 cos_to_last_merge=1.0000 (last merge round=14)
[S2] round=15 local utility u=0.108807 metrics={'f1_val': 0.7015691843323472, 'auprc': 0.8756638690642355, 'loss_val': 0.3543039286220594, 'psi': 0.7712070582251025}-{'f1_val': 0.7016512288906386, 'auprc': 0.8354855213106496, 'loss_val': 0.45187588900787434, 'psi': 0.755184945858643}
[S3] START round=15 head_norm_before_train=1.219589 cos_to_last_merge=0.9830 (last merge round=12)
[S3] round=15 local utility u=0.167153 metrics={'f1_val': 0.9968729879026701, 'auprc': 0.9985710976928341, 'loss_val': 0.08316801226086531, 'psi': 0.9975522318187356}-{'f1_val': 0.9600800976779673, 'auprc': 0.9970712814880818, 'loss_val': 0.19221687038969426, 'psi': 0.9748765712020131}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=15 head_norm_before_train=1.375479 cos_to_last_merge=0.8614 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.861
[S4] round=15 local utility u=0.051725 metrics={'f1_val': 0.9551220192758086, 'auprc': 0.9552405759202662, 'loss_val': 0.3494673574443239, 'psi': 0.9551694419335917}-{'f1_val': 0.9524682077050065, 'auprc': 0.9459771124737817, 'loss_val': 0.4092035003412675, 'psi': 0.9498717696125166}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=15 head_norm_before_train=1.707855 (no previous merge yet)
[S5] round=15 local utility u=1.000000 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9974431738050307, 'loss_val': 0.11095411924696197, 'psi': 0.9970411296815566}-{'f1_val': 0.7146647020320098, 'auprc': 0.7943076938503374, 'loss_val': 0.47006952804219637, 'psi': 0.7465218987593408}
[S6] START round=15 head_norm_before_train=1.213914 cos_to_last_merge=0.9742 (last merge round=10)
[S6] round=15 local utility u=0.000000 metrics={'f1_val': 0.7096538570123824, 'auprc': 0.9657206221039893, 'loss_val': 0.387240474909084, 'psi': 0.8120805630490251}-{'f1_val': 0.8350662169156348, 'auprc': 0.971468898481062, 'loss_val': 0.3594320325051653, 'psi': 0.8896272895418057}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=15 head_norm_before_train=1.539297 cos_to_last_merge=0.9994 (last merge round=13)
[S7] round=15 local utility u=0.653671 metrics={'f1_val': 0.661696999074011, 'auprc': 0.8620139172318253, 'loss_val': 0.4071747684159156, 'psi': 0.7418237663371368}-{'f1_val': 0.5449252225859997, 'auprc': 0.7925237150857332, 'loss_val': 0.8054145194842541, 'psi': 0.6439646195858931}
[S8] START round=15 head_norm_before_train=1.606153 (no previous merge yet)
[S8] round=15 local utility u=0.869292 metrics={'f1_val': 0.996006457631253, 'auprc': 0.9974353422421883, 'loss_val': 0.15498837081755937, 'psi': 0.9965780114756271}-{'f1_val': 0.7142403782594613, 'auprc': 0.9954875577776888, 'loss_val': 0.19713281783427344, 'psi': 0.8267392500667523}
[S9] START round=15 head_norm_before_train=1.403061 cos_to_last_merge=0.9994 (last merge round=13)
[S9] round=15 local utility u=0.000000 metrics={'f1_val': 0.9934918488430377, 'auprc': 0.998438918380818, 'loss_val': 0.048214130501922026, 'psi': 0.9954706766581498}-{'f1_val': 0.9966605118138915, 'auprc': 0.9973813172146622, 'loss_val': 0.05860973430636673, 'psi': 0.9969488339741998}
[S10] START round=15 head_norm_before_train=0.939667 cos_to_last_merge=1.0000 (last merge round=14)
[S10] round=15 local utility u=0.051994 metrics={'f1_val': 0.693721682374288, 'auprc': 0.9958982327376864, 'loss_val': 0.37906025599461907, 'psi': 0.8145923025196473}-{'f1_val': 0.6954770803198259, 'auprc': 0.9772108264136923, 'loss_val': 0.43751905973556304, 'psi': 0.8081705787573725}
[S11] START round=15 head_norm_before_train=1.248823 cos_to_last_merge=1.0000 (last merge round=14)
[S11] round=15 local utility u=0.022751 metrics={'f1_val': 0.7019353166316534, 'auprc': 0.9979177493108995, 'loss_val': 0.266746376357754, 'psi': 0.8203282897033519}-{'f1_val': 0.7016934795869249, 'auprc': 0.9959572225971414, 'loss_val': 0.30491604335421413, 'psi': 0.8193989767910115}
[S13] START round=15 head_norm_before_train=0.964858 cos_to_last_merge=0.9987 (last merge round=13)
[S13] round=15 local utility u=0.788746 metrics={'f1_val': 0.5935344161656444, 'auprc': 0.5260364100058416, 'loss_val': 0.7891508575972906, 'psi': 0.5665352137017232}-{'f1_val': 0.3557345651094673, 'auprc': 0.4866412177491124, 'loss_val': 0.8216590840996179, 'psi': 0.4080972261653254}
[S14] START round=15 head_norm_before_train=1.003233 cos_to_last_merge=0.9706 (last merge round=10)
[S14] round=15 local utility u=0.008326 metrics={'f1_val': 0.39656053564365834, 'auprc': 0.9957246061424685, 'loss_val': 0.550082332221457, 'psi': 0.6362261638431824}-{'f1_val': 0.39659360338126215, 'auprc': 0.9970919202540329, 'loss_val': 0.5710355552829149, 'psi': 0.6367929301303704}
[S15] START round=15 head_norm_before_train=1.088732 cos_to_last_merge=1.0000 (last merge round=14)
[S15] round=15 local utility u=0.546403 metrics={'f1_val': 0.806684165416441, 'auprc': 0.9827659654155387, 'loss_val': 0.2714613787272655, 'psi': 0.87711688541608}-{'f1_val': 0.6973152871821393, 'auprc': 0.8667450658665958, 'loss_val': 0.35999182494856796, 'psi': 0.765087198655922}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=15 metric=0.8067 head_norm=1.126291
[S15] _apply_head_vector_avg (torch): Δ‖w‖=2.808773e-01
[S15] stored merged vector for next round verification (round=15)
[S15] DEBUG after merge:  round=15 metric=0.7531 head_norm=1.028889 delta_norm=0.280877
[S15] aggregate: ROLLBACK (f1_val pre=0.807 post=0.753 tol_abs=0.005 tol_rel=0.0)
[S16] START round=15 head_norm_before_train=1.574733 (no previous merge yet)
[S16] round=15 local utility u=0.105329 metrics={'f1_val': 0.803575155213762, 'auprc': 0.8686608398399454, 'loss_val': 0.5503305749070413, 'psi': 0.8296094290642353}-{'f1_val': 0.8302032664590941, 'auprc': 0.8016565273137457, 'loss_val': 0.7197435700852562, 'psi': 0.8187845708009548}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=15 head_norm_before_train=1.294652 cos_to_last_merge=0.8765 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.877
[S17] round=15 local utility u=0.003004 metrics={'f1_val': 0.3550563727530326, 'auprc': 0.7621313223087987, 'loss_val': 0.9116186382552648, 'psi': 0.517886352575339}-{'f1_val': 0.35494875922871616, 'auprc': 0.7565291564231829, 'loss_val': 0.9001740684089792, 'psi': 0.5155809181065029}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S7] → sending delta(kind=head bytes=1804) to S14@127.0.0.1:54514
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] → sending delta(kind=head bytes=1795) to S3@127.0.0.1:54503
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1808 reason=None
[S2] → sending delta(kind=head bytes=1808) to S11@127.0.0.1:54512
[S9] ⇄ pheromone p=0.106 → S7@127.0.0.1:54508
[S7] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] → sending delta(kind=head bytes=1802) to S15@127.0.0.1:54515
[S5] sending update (kind=head size=1795 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S5@127.0.0.1:54505
[S17] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9976
[S3] RECEIVED delta(kind=head bytes=1795) from S5
[S3] cosine check vs S5: cos=-0.1162
[S3] DROPPED delta from S5 (cos=-0.1162 < 0.0)
[S14] RECEIVED delta(kind=head bytes=1804) from S7
[S14] cosine check vs S7: cos=-0.0108
[S14] DROPPED delta from S7 (cos=-0.0108 < 0.0)
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9938
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=-0.0008
[S8] DROPPED delta from S17 (cos=-0.0008 < 0.0)
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=0.9938
[S5] ⇄ pheromone p=0.339 → S3@127.0.0.1:54503
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=15 metric=0.5935 head_norm=0.992158
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.506662e-02
[S13] stored merged vector for next round verification (round=15)
[S13] DEBUG after merge:  round=15 metric=0.6036 head_norm=0.987739 delta_norm=0.055067
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.305 → S10@127.0.0.1:54511
[S11] ⇄ pheromone p=0.198 → S2@127.0.0.1:54502
[S17] ⇄ pheromone p=0.100 → S8@127.0.0.1:54509
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=15 metric=0.6937 head_norm=0.986380
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.506663e-02
[S10] stored merged vector for next round verification (round=15)
[S10] DEBUG after merge:  round=15 metric=0.6937 head_norm=0.987739 delta_norm=0.055067
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.166 → S13@127.0.0.1:54513
[S14] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1808 to 1 peers)
[S7] ⇄ pheromone p=0.284 → S14@127.0.0.1:54514
[S15] RECEIVED delta(kind=head bytes=1802) from S14
[S15] cosine check vs S14: cos=0.9591
[S11] RECEIVED delta(kind=head bytes=1808) from S2
[S11] cosine check vs S2: cos=0.9976
[S5] RECEIVED delta(kind=head bytes=1799) from S8
[S5] cosine check vs S8: cos=-0.1182
[S5] DROPPED delta from S8 (cos=-0.1182 < 0.0)
[S14] ⇄ pheromone p=0.123 → S15@127.0.0.1:54515
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=15 metric=0.7016 head_norm=1.308872
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.581438e-02
[S2] stored merged vector for next round verification (round=15)
[S2] DEBUG after merge:  round=15 metric=0.7016 head_norm=1.301338 delta_norm=0.045814
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.191 → S6@127.0.0.1:54507
[S8] ⇄ pheromone p=0.313 → S5@127.0.0.1:54505
[S2] START round=16 head_norm_before_train=1.301338 cos_to_last_merge=1.0000 (last merge round=15)
[S2] round=16 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.7655573118002278, 'loss_val': 0.3285407475206657, 'psi': 0.7271655601432402}-{'f1_val': 0.7015691843323472, 'auprc': 0.8756638690642355, 'loss_val': 0.3543039286220594, 'psi': 0.7712070582251025}
[S3] START round=16 head_norm_before_train=1.305531 cos_to_last_merge=0.9730 (last merge round=12)
[S3] round=16 local utility u=0.000000 metrics={'f1_val': 0.9615385219550141, 'auprc': 0.9985997180048525, 'loss_val': 0.1134283319479552, 'psi': 0.9763630003749495}-{'f1_val': 0.9968729879026701, 'auprc': 0.9985710976928341, 'loss_val': 0.08316801226086531, 'psi': 0.9975522318187356}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=16 head_norm_before_train=1.400157 cos_to_last_merge=0.8559 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.856
[S4] round=16 local utility u=0.000000 metrics={'f1_val': 0.9484734663399959, 'auprc': 0.9525035681835525, 'loss_val': 0.3642172086434681, 'psi': 0.9500855070774185}-{'f1_val': 0.9551220192758086, 'auprc': 0.9552405759202662, 'loss_val': 0.3494673574443239, 'psi': 0.9551694419335917}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=16 head_norm_before_train=1.722286 (no previous merge yet)
[S5] round=16 local utility u=0.000000 metrics={'f1_val': 0.8341983158560646, 'auprc': 0.9941322076023149, 'loss_val': 0.16909246545290643, 'psi': 0.8981718725545647}-{'f1_val': 0.9967731002659072, 'auprc': 0.9974431738050307, 'loss_val': 0.11095411924696197, 'psi': 0.9970411296815566}
[S6] START round=16 head_norm_before_train=1.247859 cos_to_last_merge=0.9679 (last merge round=10)
[S6] round=16 local utility u=0.341774 metrics={'f1_val': 0.8245259305966542, 'auprc': 0.9630177739045965, 'loss_val': 0.3848168100245682, 'psi': 0.8799226679198311}-{'f1_val': 0.7096538570123824, 'auprc': 0.9657206221039893, 'loss_val': 0.387240474909084, 'psi': 0.8120805630490251}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=16 head_norm_before_train=1.564212 cos_to_last_merge=0.9979 (last merge round=13)
[S7] round=16 local utility u=0.000000 metrics={'f1_val': 0.6382122182283145, 'auprc': 0.8028822890194278, 'loss_val': 0.5543732902268147, 'psi': 0.7040802465447599}-{'f1_val': 0.661696999074011, 'auprc': 0.8620139172318253, 'loss_val': 0.4071747684159156, 'psi': 0.7418237663371368}
[S8] START round=16 head_norm_before_train=1.627395 (no previous merge yet)
[S8] round=16 local utility u=0.000000 metrics={'f1_val': 0.7139521677339791, 'auprc': 0.9962987479061274, 'loss_val': 0.20426043074480651, 'psi': 0.8268907998028384}-{'f1_val': 0.996006457631253, 'auprc': 0.9974353422421883, 'loss_val': 0.15498837081755937, 'psi': 0.9965780114756271}
[S9] START round=16 head_norm_before_train=1.459486 cos_to_last_merge=0.9977 (last merge round=13)
[S9] round=16 local utility u=0.017700 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9987969287633869, 'loss_val': 0.03555374028777895, 'psi': 0.9977805190126404}-{'f1_val': 0.9934918488430377, 'auprc': 0.998438918380818, 'loss_val': 0.048214130501922026, 'psi': 0.9954706766581498}
[S10] START round=16 head_norm_before_train=0.987739 cos_to_last_merge=1.0000 (last merge round=15)
[S10] round=16 local utility u=0.057671 metrics={'f1_val': 0.7012347983485312, 'auprc': 0.9975422412419288, 'loss_val': 0.3137290318404834, 'psi': 0.8197577755058902}-{'f1_val': 0.693721682374288, 'auprc': 0.9958982327376864, 'loss_val': 0.37906025599461907, 'psi': 0.8145923025196473}
[S11] START round=16 head_norm_before_train=1.295381 cos_to_last_merge=0.9991 (last merge round=14)
[S11] round=16 local utility u=0.775777 metrics={'f1_val': 0.9566422846769802, 'auprc': 0.9965827351843289, 'loss_val': 0.23942825587677682, 'psi': 0.9726184648799197}-{'f1_val': 0.7019353166316534, 'auprc': 0.9979177493108995, 'loss_val': 0.266746376357754, 'psi': 0.8203282897033519}
[S13] START round=16 head_norm_before_train=0.987739 cos_to_last_merge=1.0000 (last merge round=15)
[S13] round=16 local utility u=0.000000 metrics={'f1_val': 0.5333980828822884, 'auprc': 0.4918464857945823, 'loss_val': 0.8124461891346011, 'psi': 0.5167774440472059}-{'f1_val': 0.5935344161656444, 'auprc': 0.5260364100058416, 'loss_val': 0.7891508575972906, 'psi': 0.5665352137017232}
[S14] START round=16 head_norm_before_train=1.034889 cos_to_last_merge=0.9640 (last merge round=10)
[S14] round=16 local utility u=0.045343 metrics={'f1_val': 0.39659360338126215, 'auprc': 0.9970802304895128, 'loss_val': 0.4636608552519733, 'psi': 0.6367882542245624}-{'f1_val': 0.39656053564365834, 'auprc': 0.9957246061424685, 'loss_val': 0.550082332221457, 'psi': 0.6362261638431824}
[S15] START round=16 head_norm_before_train=1.028889 cos_to_last_merge=1.0000 (last merge round=15)
[S15] round=16 local utility u=0.000000 metrics={'f1_val': 0.6975135984888788, 'auprc': 0.8558383302371441, 'loss_val': 0.3867804203810493, 'psi': 0.760843491188185}-{'f1_val': 0.806684165416441, 'auprc': 0.9827659654155387, 'loss_val': 0.2714613787272655, 'psi': 0.87711688541608}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=16 metric=0.6975 head_norm=1.082656
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.758906e-01
[S15] stored merged vector for next round verification (round=16)
[S15] DEBUG after merge:  round=16 metric=0.6975 head_norm=1.044333 delta_norm=0.175891
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S16] START round=16 head_norm_before_train=1.601463 (no previous merge yet)
[S16] round=16 local utility u=0.105912 metrics={'f1_val': 0.8451447277477785, 'auprc': 0.8955142888687778, 'loss_val': 0.6684840197279507, 'psi': 0.8652925521961782}-{'f1_val': 0.803575155213762, 'auprc': 0.8686608398399454, 'loss_val': 0.5503305749070413, 'psi': 0.8296094290642353}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=16 head_norm_before_train=1.302059 cos_to_last_merge=0.8738 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.874
[S17] round=16 local utility u=0.039759 metrics={'f1_val': 0.3571770564184105, 'auprc': 0.7714341503445523, 'loss_val': 0.8727334976672608, 'psi': 0.5228798939888673}-{'f1_val': 0.3550563727530326, 'auprc': 0.7621313223087987, 'loss_val': 0.9116186382552648, 'psi': 0.517886352575339}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S9] → sending delta(kind=head bytes=1792) to S7@127.0.0.1:54508
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S17] → sending delta(kind=head bytes=1796) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] → sending delta(kind=head bytes=1798) to S15@127.0.0.1:54515
[S17] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[S9] sending update (kind=head size=1792 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] RECEIVED delta(kind=head bytes=1796) from S17
[S8] cosine check vs S17: cos=-0.0009
[S8] DROPPED delta from S17 (cos=-0.0009 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9956
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9966
[S7] RECEIVED delta(kind=head bytes=1792) from S9
[S7] cosine check vs S9: cos=0.9933
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=16 metric=0.9566 head_norm=1.343156
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.506974e-02
[S11] stored merged vector for next round verification (round=16)
[S11] DEBUG after merge:  round=16 metric=0.9542 head_norm=1.324528 delta_norm=0.065070
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1798) from S14
[S15] cosine check vs S14: cos=0.9839
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=16 metric=0.7016 head_norm=1.339346
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.303081e-02
[S2] stored merged vector for next round verification (round=16)
[S2] DEBUG after merge:  round=16 metric=0.7016 head_norm=1.339770 delta_norm=0.063031
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=17 head_norm_before_train=1.339770 cos_to_last_merge=1.0000 (last merge round=16)
[S2] round=17 local utility u=0.000000 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6765058352099758, 'loss_val': 0.3179988935221517, 'psi': 0.6915449695071394}-{'f1_val': 0.7015710590385817, 'auprc': 0.7655573118002278, 'loss_val': 0.3285407475206657, 'psi': 0.7271655601432402}
[S3] START round=17 head_norm_before_train=1.377551 cos_to_last_merge=0.9645 (last merge round=12)
[S3] round=17 local utility u=0.000000 metrics={'f1_val': 0.9431913183887517, 'auprc': 0.9964080916285479, 'loss_val': 0.13689969695233242, 'psi': 0.9644780276846703}-{'f1_val': 0.9615385219550141, 'auprc': 0.9985997180048525, 'loss_val': 0.1134283319479552, 'psi': 0.9763630003749495}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=17 head_norm_before_train=1.421881 cos_to_last_merge=0.8507 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.851
[S4] round=17 local utility u=0.034702 metrics={'f1_val': 0.950492596219463, 'auprc': 0.9561902947862195, 'loss_val': 0.3179883491508807, 'psi': 0.9527716756461657}-{'f1_val': 0.9484734663399959, 'auprc': 0.9525035681835525, 'loss_val': 0.3642172086434681, 'psi': 0.9500855070774185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=17 head_norm_before_train=1.735734 (no previous merge yet)
[S5] round=17 local utility u=0.000000 metrics={'f1_val': 0.7650860362032128, 'auprc': 0.992686424345987, 'loss_val': 0.18166986463910104, 'psi': 0.8561261914603224}-{'f1_val': 0.8341983158560646, 'auprc': 0.9941322076023149, 'loss_val': 0.16909246545290643, 'psi': 0.8981718725545647}
[S6] START round=17 head_norm_before_train=1.275622 cos_to_last_merge=0.9632 (last merge round=10)
[S6] round=17 local utility u=0.510525 metrics={'f1_val': 0.9642809868043064, 'auprc': 0.9747519832870657, 'loss_val': 0.2374998877762628, 'psi': 0.9684693853974101}-{'f1_val': 0.8245259305966542, 'auprc': 0.9630177739045965, 'loss_val': 0.3848168100245682, 'psi': 0.8799226679198311}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S6] sending update (kind=head size=1794 to 1 peers)
[S7] START round=17 head_norm_before_train=1.584314 cos_to_last_merge=0.9971 (last merge round=13)
[S7] round=17 local utility u=0.000000 metrics={'f1_val': 0.5543501673482877, 'auprc': 0.78733951997152, 'loss_val': 0.6635180997528859, 'psi': 0.6475459083975805}-{'f1_val': 0.6382122182283145, 'auprc': 0.8028822890194278, 'loss_val': 0.5543732902268147, 'psi': 0.7040802465447599}
[S8] START round=17 head_norm_before_train=1.649776 (no previous merge yet)
[S8] round=17 local utility u=0.890706 metrics={'f1_val': 0.9952904955831205, 'auprc': 0.9993814957311613, 'loss_val': 0.12012679572746092, 'psi': 0.9969268956423368}-{'f1_val': 0.7139521677339791, 'auprc': 0.9962987479061274, 'loss_val': 0.20426043074480651, 'psi': 0.8268907998028384}
[S9] START round=17 head_norm_before_train=1.511148 cos_to_last_merge=0.9956 (last merge round=13)
[S9] round=17 local utility u=0.000000 metrics={'f1_val': 0.9951604951085576, 'auprc': 0.998795159716426, 'loss_val': 0.032585199669625156, 'psi': 0.996614360951705}-{'f1_val': 0.9971029125121428, 'auprc': 0.9987969287633869, 'loss_val': 0.03555374028777895, 'psi': 0.9977805190126404}
[S10] START round=17 head_norm_before_train=1.036073 cos_to_last_merge=0.9985 (last merge round=15)
[S10] round=17 local utility u=0.231317 metrics={'f1_val': 0.780260333240284, 'auprc': 0.9955449421695091, 'loss_val': 0.31925684452162323, 'psi': 0.8663741768119739}-{'f1_val': 0.7012347983485312, 'auprc': 0.9975422412419288, 'loss_val': 0.3137290318404834, 'psi': 0.8197577755058902}
[S11] START round=17 head_norm_before_train=1.324528 cos_to_last_merge=1.0000 (last merge round=16)
[S11] round=17 local utility u=0.088821 metrics={'f1_val': 0.9771468028091679, 'auprc': 0.997977355058234, 'loss_val': 0.18899697399258716, 'psi': 0.9854790237087944}-{'f1_val': 0.9566422846769802, 'auprc': 0.9965827351843289, 'loss_val': 0.23942825587677682, 'psi': 0.9726184648799197}
[S13] START round=17 head_norm_before_train=1.012440 cos_to_last_merge=0.9988 (last merge round=15)
[S13] round=17 local utility u=0.312441 metrics={'f1_val': 0.5947645210858946, 'auprc': 0.5526157102699134, 'loss_val': 0.7380698797659998, 'psi': 0.5779049967595021}-{'f1_val': 0.5333980828822884, 'auprc': 0.4918464857945823, 'loss_val': 0.8124461891346011, 'psi': 0.5167774440472059}
[S14] START round=17 head_norm_before_train=1.063149 cos_to_last_merge=0.9580 (last merge round=10)
[S14] round=17 local utility u=1.000000 metrics={'f1_val': 0.997010312324352, 'auprc': 0.9970908821963158, 'loss_val': 0.4085537622169154, 'psi': 0.9970425402731375}-{'f1_val': 0.39659360338126215, 'auprc': 0.9970802304895128, 'loss_val': 0.4636608552519733, 'psi': 0.6367882542245624}
[S15] START round=17 head_norm_before_train=1.044333 cos_to_last_merge=1.0000 (last merge round=16)
[S15] round=17 local utility u=0.902404 metrics={'f1_val': 0.9205876510197443, 'auprc': 0.9736036255820111, 'loss_val': 0.2737120905560283, 'psi': 0.941794040844651}-{'f1_val': 0.6975135984888788, 'auprc': 0.8558383302371441, 'loss_val': 0.3867804203810493, 'psi': 0.760843491188185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=17 metric=0.9206 head_norm=1.102532
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.285070e-01
[S15] stored merged vector for next round verification (round=17)
[S15] DEBUG after merge:  round=17 metric=0.8999 head_norm=1.075369 delta_norm=0.128507
[S15] aggregate: ROLLBACK (f1_val pre=0.921 post=0.900 tol_abs=0.005 tol_rel=0.0)
[S16] START round=17 head_norm_before_train=1.629107 (no previous merge yet)
[S16] round=17 local utility u=0.490212 metrics={'f1_val': 0.9155499962767687, 'auprc': 0.9712360057269086, 'loss_val': 0.33765604889830625, 'psi': 0.9378244000568247}-{'f1_val': 0.8451447277477785, 'auprc': 0.8955142888687778, 'loss_val': 0.6684840197279507, 'psi': 0.8652925521961782}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=17 head_norm_before_train=1.305673 cos_to_last_merge=0.8708 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.871
[S17] round=17 local utility u=0.092190 metrics={'f1_val': 0.35355593898738785, 'auprc': 0.8444941256993336, 'loss_val': 0.8858067525213728, 'psi': 0.5499312136721661}-{'f1_val': 0.3571770564184105, 'auprc': 0.7714341503445523, 'loss_val': 0.8727334976672608, 'psi': 0.5228798939888673}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S13] → sending delta(kind=head bytes=1789) to S10@127.0.0.1:54511
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S7] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S7] DEBUG before merge: round=17 metric=0.5544 head_norm=1.601685
[S7] _apply_head_vector_avg (torch): Δ‖w‖=1.053173e-01
[S7] stored merged vector for next round verification (round=17)
[S7] DEBUG after merge:  round=17 metric=0.5174 head_norm=1.553509 delta_norm=0.105317
[S7] aggregate: ROLLBACK (f1_val pre=0.554 post=0.517 tol_abs=0.005 tol_rel=0.0)
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1789 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] → sending delta(kind=head bytes=1801) to S15@127.0.0.1:54515
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S5@127.0.0.1:54505
[S10] RECEIVED delta(kind=head bytes=1789) from S13
[S10] cosine check vs S13: cos=0.9876
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=-0.0010
[S8] DROPPED delta from S17 (cos=-0.0010 < 0.0)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9982
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9876
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=17 metric=0.5948 head_norm=1.040658
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.490209e-02
[S13] stored merged vector for next round verification (round=17)
[S13] DEBUG after merge:  round=17 metric=0.5987 head_norm=1.047873 delta_norm=0.074902
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S14] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=17 metric=0.7803 head_norm=1.085178
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.655474e-02
[S10] stored merged vector for next round verification (round=17)
[S10] DEBUG after merge:  round=17 metric=0.6943 head_norm=1.059622 delta_norm=0.086555
[S10] aggregate: ROLLBACK (f1_val pre=0.780 post=0.694 tol_abs=0.005 tol_rel=0.0)
[S5] RECEIVED delta(kind=head bytes=1802) from S8
[S5] cosine check vs S8: cos=-0.1225
[S5] DROPPED delta from S8 (cos=-0.1225 < 0.0)
[S15] RECEIVED delta(kind=head bytes=1801) from S14
[S15] cosine check vs S14: cos=0.9911
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=17 metric=0.7016 head_norm=1.373732
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.067101e-02
[S2] stored merged vector for next round verification (round=17)
[S2] DEBUG after merge:  round=17 metric=0.7016 head_norm=1.372529 delta_norm=0.040671
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=18 head_norm_before_train=1.372529 cos_to_last_merge=1.0000 (last merge round=17)
[S2] round=18 local utility u=0.000000 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6699321608140245, 'loss_val': 0.3192246014803954, 'psi': 0.6890719586183471}-{'f1_val': 0.7015710590385817, 'auprc': 0.6765058352099758, 'loss_val': 0.3179988935221517, 'psi': 0.6915449695071394}
[S3] START round=18 head_norm_before_train=1.433430 cos_to_last_merge=0.9580 (last merge round=12)
[S3] round=18 local utility u=0.081833 metrics={'f1_val': 0.9622170324087151, 'auprc': 0.9972686245159734, 'loss_val': 0.08996971556485085, 'psi': 0.9762376692516185}-{'f1_val': 0.9431913183887517, 'auprc': 0.9964080916285479, 'loss_val': 0.13689969695233242, 'psi': 0.9644780276846703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=18 head_norm_before_train=1.444988 cos_to_last_merge=0.8458 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.846
[S4] round=18 local utility u=0.056443 metrics={'f1_val': 0.9548853809761793, 'auprc': 0.9705699778702295, 'loss_val': 0.2745978287238183, 'psi': 0.9611592197337994}-{'f1_val': 0.950492596219463, 'auprc': 0.9561902947862195, 'loss_val': 0.3179883491508807, 'psi': 0.9527716756461657}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=18 head_norm_before_train=1.742940 (no previous merge yet)
[S5] round=18 local utility u=0.745444 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9973405185202262, 'loss_val': 0.09398328416380812, 'psi': 0.9969117528662323}-{'f1_val': 0.7650860362032128, 'auprc': 0.992686424345987, 'loss_val': 0.18166986463910104, 'psi': 0.8561261914603224}
[S6] START round=18 head_norm_before_train=1.301039 cos_to_last_merge=0.9591 (last merge round=10)
[S6] round=18 local utility u=0.000000 metrics={'f1_val': 0.8093741382713031, 'auprc': 0.9571218260421496, 'loss_val': 0.46015753192076264, 'psi': 0.8684732133796417}-{'f1_val': 0.9642809868043064, 'auprc': 0.9747519832870657, 'loss_val': 0.2374998877762628, 'psi': 0.9684693853974101}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=18 head_norm_before_train=1.553509 cos_to_last_merge=1.0000 (last merge round=17)
[S7] round=18 local utility u=0.000000 metrics={'f1_val': 0.5647939127249995, 'auprc': 0.7912221456086312, 'loss_val': 0.759979186106273, 'psi': 0.6553652058784523}-{'f1_val': 0.5543501673482877, 'auprc': 0.78733951997152, 'loss_val': 0.6635180997528859, 'psi': 0.6475459083975805}
[S8] START round=18 head_norm_before_train=1.669620 (no previous merge yet)
[S8] round=18 local utility u=0.000000 metrics={'f1_val': 0.9950790219939822, 'auprc': 0.9989836423643388, 'loss_val': 0.11766955481741355, 'psi': 0.9966408701421249}-{'f1_val': 0.9952904955831205, 'auprc': 0.9993814957311613, 'loss_val': 0.12012679572746092, 'psi': 0.9969268956423368}
[S9] START round=18 head_norm_before_train=1.551592 cos_to_last_merge=0.9939 (last merge round=13)
[S9] round=18 local utility u=0.000000 metrics={'f1_val': 0.9899766087340214, 'auprc': 0.9988141782059194, 'loss_val': 0.04189611631005862, 'psi': 0.9935116365227806}-{'f1_val': 0.9951604951085576, 'auprc': 0.998795159716426, 'loss_val': 0.032585199669625156, 'psi': 0.996614360951705}
[S10] START round=18 head_norm_before_train=1.059622 cos_to_last_merge=1.0000 (last merge round=17)
[S10] round=18 local utility u=0.000000 metrics={'f1_val': 0.6993971300580291, 'auprc': 0.9950100135007465, 'loss_val': 0.316320536018816, 'psi': 0.817642283435116}-{'f1_val': 0.780260333240284, 'auprc': 0.9955449421695091, 'loss_val': 0.31925684452162323, 'psi': 0.8663741768119739}
[S11] START round=18 head_norm_before_train=1.372531 cos_to_last_merge=0.9992 (last merge round=16)
[S11] round=18 local utility u=0.053832 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9966302390071582, 'loss_val': 0.19514306603100354, 'psi': 0.9967253255084819}-{'f1_val': 0.9771468028091679, 'auprc': 0.997977355058234, 'loss_val': 0.18899697399258716, 'psi': 0.9854790237087944}
[S13] START round=18 head_norm_before_train=1.047873 cos_to_last_merge=1.0000 (last merge round=17)
[S13] round=18 local utility u=0.000000 metrics={'f1_val': 0.5594992247260677, 'auprc': 0.6144558075114128, 'loss_val': 0.7900495904139675, 'psi': 0.5814818578402058}-{'f1_val': 0.5947645210858946, 'auprc': 0.5526157102699134, 'loss_val': 0.7380698797659998, 'psi': 0.5779049967595021}
[S14] START round=18 head_norm_before_train=1.090497 cos_to_last_merge=0.9513 (last merge round=10)
[S14] round=18 local utility u=0.030081 metrics={'f1_val': 0.9973057695633372, 'auprc': 0.9970913326588158, 'loss_val': 0.3501656689409649, 'psi': 0.9972199948015286}-{'f1_val': 0.997010312324352, 'auprc': 0.9970908821963158, 'loss_val': 0.4085537622169154, 'psi': 0.9970425402731375}
[S15] START round=18 head_norm_before_train=1.075369 cos_to_last_merge=1.0000 (last merge round=17)
[S15] round=18 local utility u=0.000000 metrics={'f1_val': 0.7697809294937168, 'auprc': 0.9660187188058416, 'loss_val': 0.3337750909268896, 'psi': 0.8482760452185667}-{'f1_val': 0.9205876510197443, 'auprc': 0.9736036255820111, 'loss_val': 0.2737120905560283, 'psi': 0.941794040844651}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=18 metric=0.7698 head_norm=1.131676
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.075854e-01
[S15] stored merged vector for next round verification (round=18)
[S15] DEBUG after merge:  round=18 metric=0.7613 head_norm=1.106057 delta_norm=0.107585
[S15] aggregate: ROLLBACK (f1_val pre=0.770 post=0.761 tol_abs=0.005 tol_rel=0.0)
[S16] START round=18 head_norm_before_train=1.658275 (no previous merge yet)
[S16] round=18 local utility u=0.000000 metrics={'f1_val': 0.8960758099420452, 'auprc': 0.9897930275576975, 'loss_val': 0.3921393428873074, 'psi': 0.9335626969883062}-{'f1_val': 0.9155499962767687, 'auprc': 0.9712360057269086, 'loss_val': 0.33765604889830625, 'psi': 0.9378244000568247}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=18 head_norm_before_train=1.313643 cos_to_last_merge=0.8663 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.866
[S17] round=18 local utility u=0.046511 metrics={'f1_val': 0.3930737339017423, 'auprc': 0.8126889969481895, 'loss_val': 0.9344769798604303, 'psi': 0.5609198391203212}-{'f1_val': 0.35355593898738785, 'auprc': 0.8444941256993336, 'loss_val': 0.8858067525213728, 'psi': 0.5499312136721661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] → sending delta(kind=head bytes=1799) to S3@127.0.0.1:54503
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1801 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] → sending delta(kind=head bytes=1800) to S15@127.0.0.1:54515
[S5] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9967
[S3] RECEIVED delta(kind=head bytes=1799) from S5
[S3] cosine check vs S5: cos=-0.1179
[S3] DROPPED delta from S5 (cos=-0.1179 < 0.0)
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.0013
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] RECEIVED delta(kind=head bytes=1800) from S14
[S15] cosine check vs S14: cos=0.9932
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=18 metric=0.9951 head_norm=1.689456
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.071739e+00
[S8] stored merged vector for next round verification (round=18)
[S8] DEBUG after merge:  round=18 metric=0.9955 head_norm=1.073138 delta_norm=1.071739
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=18 metric=0.7018 head_norm=1.402450
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.805543e-02
[S2] stored merged vector for next round verification (round=18)
[S2] DEBUG after merge:  round=18 metric=0.7018 head_norm=1.409870 delta_norm=0.058055
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=19 head_norm_before_train=1.409870 cos_to_last_merge=1.0000 (last merge round=18)
[S2] round=19 local utility u=0.003202 metrics={'f1_val': 0.7018318238212289, 'auprc': 0.6703133242912661, 'loss_val': 0.31396432597933094, 'psi': 0.6892244240092438}-{'f1_val': 0.7018318238212289, 'auprc': 0.6699321608140245, 'loss_val': 0.3192246014803954, 'psi': 0.6890719586183471}
[S3] START round=19 head_norm_before_train=1.475020 cos_to_last_merge=0.9530 (last merge round=12)
[S3] round=19 local utility u=0.131956 metrics={'f1_val': 0.9973696976584205, 'auprc': 0.9970185588114806, 'loss_val': 0.0362231745547711, 'psi': 0.9972292421196445}-{'f1_val': 0.9622170324087151, 'auprc': 0.9972686245159734, 'loss_val': 0.08996971556485085, 'psi': 0.9762376692516185}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S3] sending update (kind=head size=1803 to 1 peers)
[S3] r=20 psi=0.997 u=0.1320 p_local=0.1171 f1=0.997 auprc=0.997 bytes=23429
[S4] START round=19 head_norm_before_train=1.471876 cos_to_last_merge=0.8403 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.840
[S4] round=19 local utility u=0.000000 metrics={'f1_val': 0.9383169091241732, 'auprc': 0.934545955371517, 'loss_val': 0.3251103881875582, 'psi': 0.9368085276231106}-{'f1_val': 0.9548853809761793, 'auprc': 0.9705699778702295, 'loss_val': 0.2745978287238183, 'psi': 0.9611592197337994}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=20 psi=0.937 u=0.0000 p_local=0.1143 f1=0.938 auprc=0.935 bytes=25142
[S5] START round=19 head_norm_before_train=1.751273 (no previous merge yet)
[S5] round=19 local utility u=0.001182 metrics={'f1_val': 0.996625909096903, 'auprc': 0.99660811114079, 'loss_val': 0.08942241250713245, 'psi': 0.9966187899144578}-{'f1_val': 0.996625909096903, 'auprc': 0.9973405185202262, 'loss_val': 0.09398328416380812, 'psi': 0.9969117528662323}
[S6] START round=19 head_norm_before_train=1.324545 cos_to_last_merge=0.9554 (last merge round=10)
[S6] round=19 local utility u=0.543969 metrics={'f1_val': 0.9416148091291255, 'auprc': 0.9788960384690522, 'loss_val': 0.23098529805957685, 'psi': 0.9565273008650961}-{'f1_val': 0.8093741382713031, 'auprc': 0.9571218260421496, 'loss_val': 0.46015753192076264, 'psi': 0.8684732133796417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S6] r=20 psi=0.957 u=0.5440 p_local=0.3032 f1=0.942 auprc=0.979 bytes=26948
[S7] START round=19 head_norm_before_train=1.575054 cos_to_last_merge=0.9996 (last merge round=17)
[S7] round=19 local utility u=0.406933 metrics={'f1_val': 0.6492866723639954, 'auprc': 0.8141187553282332, 'loss_val': 0.5217601129388704, 'psi': 0.7152195055496905}-{'f1_val': 0.5647939127249995, 'auprc': 0.7912221456086312, 'loss_val': 0.759979186106273, 'psi': 0.6553652058784523}
[S8] START round=19 head_norm_before_train=1.073138 cos_to_last_merge=1.0000 (last merge round=18)
[S8] round=19 local utility u=0.000000 metrics={'f1_val': 0.9962692890219313, 'auprc': 0.999380257084563, 'loss_val': 0.2862793852403481, 'psi': 0.9975136762469841}-{'f1_val': 0.9950790219939822, 'auprc': 0.9989836423643388, 'loss_val': 0.11766955481741355, 'psi': 0.9966408701421249}
[S9] START round=19 head_norm_before_train=1.580350 cos_to_last_merge=0.9926 (last merge round=13)
[S9] round=19 local utility u=0.027752 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9987973072384175, 'loss_val': 0.026444144314579716, 'psi': 0.9975152299837019}-{'f1_val': 0.9899766087340214, 'auprc': 0.9988141782059194, 'loss_val': 0.04189611631005862, 'psi': 0.9935116365227806}
[S10] START round=19 head_norm_before_train=1.096513 cos_to_last_merge=0.9992 (last merge round=17)
[S10] round=19 local utility u=0.230219 metrics={'f1_val': 0.8102303912300625, 'auprc': 0.9548624287668811, 'loss_val': 0.4004397119978576, 'psi': 0.8680832062447899}-{'f1_val': 0.6993971300580291, 'auprc': 0.9950100135007465, 'loss_val': 0.316320536018816, 'psi': 0.817642283435116}
[S11] START round=19 head_norm_before_train=1.419627 cos_to_last_merge=0.9972 (last merge round=16)
[S11] round=19 local utility u=0.038181 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9978494509147041, 'loss_val': 0.12243948832196666, 'psi': 0.9972130102715002}-{'f1_val': 0.9967887165093644, 'auprc': 0.9966302390071582, 'loss_val': 0.19514306603100354, 'psi': 0.9967253255084819}
[S13] START round=19 head_norm_before_train=1.074295 cos_to_last_merge=0.9987 (last merge round=17)
[S13] round=19 local utility u=0.098308 metrics={'f1_val': 0.5682626706784657, 'auprc': 0.6531671496120324, 'loss_val': 0.7621487824048738, 'psi': 0.6022244622518924}-{'f1_val': 0.5594992247260677, 'auprc': 0.6144558075114128, 'loss_val': 0.7900495904139675, 'psi': 0.5814818578402058}
[S14] START round=19 head_norm_before_train=1.128535 cos_to_last_merge=0.9435 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.943
[S14] round=19 local utility u=0.036380 metrics={'f1_val': 0.9977165309073976, 'auprc': 0.9970913588742508, 'loss_val': 0.27986935754620995, 'psi': 0.9974664620941389}-{'f1_val': 0.9973057695633372, 'auprc': 0.9970913326588158, 'loss_val': 0.3501656689409649, 'psi': 0.9972199948015286}
[S15] START round=19 head_norm_before_train=1.106057 cos_to_last_merge=1.0000 (last merge round=18)
[S15] round=19 local utility u=0.000000 metrics={'f1_val': 0.6979975295658388, 'auprc': 0.8242462938883048, 'loss_val': 0.42385405854221175, 'psi': 0.7484970352948253}-{'f1_val': 0.7697809294937168, 'auprc': 0.9660187188058416, 'loss_val': 0.3337750909268896, 'psi': 0.8482760452185667}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S15] DEBUG before merge: round=19 metric=0.6980 head_norm=1.167551
[S15] _apply_head_vector_avg (torch): Δ‖w‖=1.015363e-01
[S15] stored merged vector for next round verification (round=19)
[S15] DEBUG after merge:  round=19 metric=0.6979 head_norm=1.143711 delta_norm=0.101536
[S15] aggregate: ACCEPT kept=['S14'] (k=1/1) mode=median trim_p=0.1
[S15] r=20 psi=0.748 u=0.0000 p_local=0.2191 f1=0.698 auprc=0.824 bytes=25160
[S16] START round=19 head_norm_before_train=1.689499 (no previous merge yet)
[S16] round=19 local utility u=0.000000 metrics={'f1_val': 0.8474710491593582, 'auprc': 0.9761668056793532, 'loss_val': 0.6798478898034663, 'psi': 0.8989493517673562}-{'f1_val': 0.8960758099420452, 'auprc': 0.9897930275576975, 'loss_val': 0.3921393428873074, 'psi': 0.9335626969883062}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=20 psi=0.899 u=0.0000 p_local=0.1736 f1=0.847 auprc=0.976 bytes=23337
[S17] START round=19 head_norm_before_train=1.321451 cos_to_last_merge=0.8641 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.864
[S17] round=19 local utility u=0.000000 metrics={'f1_val': 0.35709298782672555, 'auprc': 0.7958184699413109, 'loss_val': 0.9489274096727144, 'psi': 0.5325831806725597}-{'f1_val': 0.3930737339017423, 'auprc': 0.8126889969481895, 'loss_val': 0.9344769798604303, 'psi': 0.5609198391203212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1804 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:54512
[S7] r=20 psi=0.715 u=0.4069 p_local=0.1976 f1=0.649 auprc=0.814 bytes=19763
[S17] r=20 psi=0.533 u=0.0000 p_local=0.0643 f1=0.357 auprc=0.796 bytes=30558
[S9] r=20 psi=0.998 u=0.0278 p_local=0.0507 f1=0.997 auprc=0.999 bytes=25194
[S11] r=20 psi=0.997 u=0.0382 p_local=0.1883 f1=0.997 auprc=0.998 bytes=28805
[S13] sending update (kind=head size=1795 to 1 peers)
[S5] r=20 psi=0.997 u=0.0012 p_local=0.2583 f1=0.997 auprc=0.997 bytes=23357
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=0.9909
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9909
[S2] sending update (kind=head size=1803 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=19 metric=0.8102 head_norm=1.126484
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.616709e-02
[S10] stored merged vector for next round verification (round=19)
[S10] DEBUG after merge:  round=19 metric=0.8168 head_norm=1.112554 delta_norm=0.076167
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=20 psi=0.868 u=0.2302 p_local=0.1496 f1=0.810 auprc=0.955 bytes=28741
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=19 metric=0.5683 head_norm=1.103716
[S13] _apply_head_vector_avg (torch): Δ‖w‖=7.616709e-02
[S13] stored merged vector for next round verification (round=19)
[S13] DEBUG after merge:  round=19 metric=0.5705 head_norm=1.112554 delta_norm=0.076167
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=20 psi=0.602 u=0.0983 p_local=0.1846 f1=0.568 auprc=0.653 bytes=19746
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=0.9957
[S8] r=20 psi=0.998 u=0.0000 p_local=0.2422 f1=0.996 auprc=0.999 bytes=25147
[S14] r=20 psi=0.997 u=0.0364 p_local=0.1950 f1=0.998 auprc=0.997 bytes=30546
[S2] r=20 psi=0.689 u=0.0032 p_local=0.0790 f1=0.702 auprc=0.670 bytes=21571
[S2] START round=20 head_norm_before_train=1.437320 cos_to_last_merge=0.9995 (last merge round=18)
[S2] round=20 local utility u=0.002649 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6695068926416181, 'loss_val': 0.3046832896583169, 'psi': 0.6887453924797963}-{'f1_val': 0.7018318238212289, 'auprc': 0.6703133242912661, 'loss_val': 0.31396432597933094, 'psi': 0.6892244240092438}
[S3] START round=20 head_norm_before_train=1.514384 cos_to_last_merge=0.9485 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.948
[S3] round=20 local utility u=0.000000 metrics={'f1_val': 0.9624238080555565, 'auprc': 0.9974238587266951, 'loss_val': 0.08378757639200174, 'psi': 0.9764238283240119}-{'f1_val': 0.9973696976584205, 'auprc': 0.9970185588114806, 'loss_val': 0.0362231745547711, 'psi': 0.9972292421196445}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=20 head_norm_before_train=1.494160 cos_to_last_merge=0.8354 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.835
[S4] round=20 local utility u=0.096747 metrics={'f1_val': 0.9444966152970802, 'auprc': 0.9711121233565057, 'loss_val': 0.2783937581278109, 'psi': 0.9551428185208504}-{'f1_val': 0.9383169091241732, 'auprc': 0.934545955371517, 'loss_val': 0.3251103881875582, 'psi': 0.9368085276231106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=20 head_norm_before_train=1.766671 (no previous merge yet)
[S5] round=20 local utility u=0.006225 metrics={'f1_val': 0.996625909096903, 'auprc': 0.9962846412891809, 'loss_val': 0.07600130788948613, 'psi': 0.9964894019738142}-{'f1_val': 0.996625909096903, 'auprc': 0.99660811114079, 'loss_val': 0.08942241250713245, 'psi': 0.9966187899144578}
[S6] START round=20 head_norm_before_train=1.348890 cos_to_last_merge=0.9519 (last merge round=10)
[S6] round=20 local utility u=0.000000 metrics={'f1_val': 0.6562438844129819, 'auprc': 0.8185296875030964, 'loss_val': 0.4772890120934564, 'psi': 0.7211582056490278}-{'f1_val': 0.9416148091291255, 'auprc': 0.9788960384690522, 'loss_val': 0.23098529805957685, 'psi': 0.9565273008650961}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=20 head_norm_before_train=1.590971 cos_to_last_merge=0.9987 (last merge round=17)
[S7] round=20 local utility u=0.144084 metrics={'f1_val': 0.6666860834051509, 'auprc': 0.8351074703194202, 'loss_val': 0.400955497841662, 'psi': 0.7340546381708586}-{'f1_val': 0.6492866723639954, 'auprc': 0.8141187553282332, 'loss_val': 0.5217601129388704, 'psi': 0.7152195055496905}
[S8] START round=20 head_norm_before_train=1.113468 cos_to_last_merge=0.9989 (last merge round=18)
[S8] round=20 local utility u=0.039156 metrics={'f1_val': 0.9958992753750342, 'auprc': 0.9993458974859106, 'loss_val': 0.20564392111098548, 'psi': 0.9972779242193848}-{'f1_val': 0.9962692890219313, 'auprc': 0.999380257084563, 'loss_val': 0.2862793852403481, 'psi': 0.9975136762469841}
[S9] START round=20 head_norm_before_train=1.606608 cos_to_last_merge=0.9915 (last merge round=13)
[S9] round=20 local utility u=0.000000 metrics={'f1_val': 0.9954158325366191, 'auprc': 0.9987755880563187, 'loss_val': 0.025534595912409943, 'psi': 0.996759734744499}-{'f1_val': 0.9966605118138915, 'auprc': 0.9987973072384175, 'loss_val': 0.026444144314579716, 'psi': 0.9975152299837019}
[S10] START round=20 head_norm_before_train=1.112554 cos_to_last_merge=1.0000 (last merge round=19)
[S10] round=20 local utility u=0.264320 metrics={'f1_val': 0.8511692575539659, 'auprc': 0.9952781562657087, 'loss_val': 0.23868007180446116, 'psi': 0.908812817038663}-{'f1_val': 0.8102303912300625, 'auprc': 0.9548624287668811, 'loss_val': 0.4004397119978576, 'psi': 0.8680832062447899}
[S11] START round=20 head_norm_before_train=1.466200 cos_to_last_merge=0.9940 (last merge round=16)
[S11] round=20 local utility u=0.007617 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9961827319706689, 'loss_val': 0.1022060087657471, 'psi': 0.9965463226938862}-{'f1_val': 0.9967887165093644, 'auprc': 0.9978494509147041, 'loss_val': 0.12243948832196666, 'psi': 0.9972130102715002}
[S13] START round=20 head_norm_before_train=1.112554 cos_to_last_merge=1.0000 (last merge round=19)
[S13] round=20 local utility u=0.000000 metrics={'f1_val': 0.5655480100997825, 'auprc': 0.6746616305892239, 'loss_val': 0.812021037086705, 'psi': 0.609193458295559}-{'f1_val': 0.5682626706784657, 'auprc': 0.6531671496120324, 'loss_val': 0.7621487824048738, 'psi': 0.6022244622518924}
[S14] START round=20 head_norm_before_train=1.173683 cos_to_last_merge=0.9340 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.934
[S14] round=20 local utility u=0.025659 metrics={'f1_val': 0.9977137911249896, 'auprc': 0.9970911796464264, 'loss_val': 0.2285348244654741, 'psi': 0.9974647465335642}-{'f1_val': 0.9977165309073976, 'auprc': 0.9970913588742508, 'loss_val': 0.27986935754620995, 'psi': 0.9974664620941389}
[S15] START round=20 head_norm_before_train=1.143711 cos_to_last_merge=1.0000 (last merge round=19)
[S15] round=20 local utility u=0.817945 metrics={'f1_val': 0.8650630862192775, 'auprc': 0.9812451600230538, 'loss_val': 0.26135313862347553, 'psi': 0.9115359157407881}-{'f1_val': 0.6979975295658388, 'auprc': 0.8242462938883048, 'loss_val': 0.42385405854221175, 'psi': 0.7484970352948253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=20 head_norm_before_train=1.713267 (no previous merge yet)
[S16] round=20 local utility u=0.516748 metrics={'f1_val': 0.9264733302613433, 'auprc': 0.9929345665612518, 'loss_val': 0.17066820174005243, 'psi': 0.9530578247813066}-{'f1_val': 0.8474710491593582, 'auprc': 0.9761668056793532, 'loss_val': 0.6798478898034663, 'psi': 0.8989493517673562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=20 head_norm_before_train=1.334504 cos_to_last_merge=0.8607 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.861
[S17] round=20 local utility u=0.059735 metrics={'f1_val': 0.38797766276573914, 'auprc': 0.788162377109346, 'loss_val': 0.99179620575884, 'psi': 0.5480515485031818}-{'f1_val': 0.35709298782672555, 'auprc': 0.7958184699413109, 'loss_val': 0.9489274096727144, 'psi': 0.5325831806725597}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] sending update (kind=head size=1799 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] sending update (kind=head size=1803 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=20 metric=0.9968 head_norm=1.511010
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.441094e-02
[S11] stored merged vector for next round verification (round=20)
[S11] DEBUG after merge:  round=20 metric=0.9968 head_norm=1.471600 delta_norm=0.094411
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[S10] sending update (kind=head size=1799 to 1 peers)
[S13] ⇄ pheromone p=0.148 → S10@127.0.0.1:54511
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9990
[S10] ⇄ pheromone p=0.173 → S13@127.0.0.1:54513
[S2] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9971
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.5583
[S2] ⇄ pheromone p=0.064 → S11@127.0.0.1:54512
[S8] ⇄ pheromone p=0.202 → S17@127.0.0.1:54517
[S2] START round=21 head_norm_before_train=1.461010 cos_to_last_merge=0.9987 (last merge round=18)
[S2] round=21 local utility u=0.005774 metrics={'f1_val': 0.7015710590385817, 'auprc': 0.6714636720808025, 'loss_val': 0.29900609935705375, 'psi': 0.68952810425547}-{'f1_val': 0.7015710590385817, 'auprc': 0.6695068926416181, 'loss_val': 0.3046832896583169, 'psi': 0.6887453924797963}
[S3] START round=21 head_norm_before_train=1.553203 cos_to_last_merge=0.9442 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.944
[S3] round=21 local utility u=0.134539 metrics={'f1_val': 0.9975267313009194, 'auprc': 0.9984756261134988, 'loss_val': 0.02848160756589152, 'psi': 0.9979062892259511}-{'f1_val': 0.9624238080555565, 'auprc': 0.9974238587266951, 'loss_val': 0.08378757639200174, 'psi': 0.9764238283240119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=21 head_norm_before_train=1.516359 cos_to_last_merge=0.8309 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.831
[S4] round=21 local utility u=0.017150 metrics={'f1_val': 0.945451088459563, 'auprc': 0.9758713394434844, 'loss_val': 0.26409860197743357, 'psi': 0.9576191888531316}-{'f1_val': 0.9444966152970802, 'auprc': 0.9711121233565057, 'loss_val': 0.2783937581278109, 'psi': 0.9551428185208504}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=21 head_norm_before_train=1.789603 (no previous merge yet)
[S5] round=21 local utility u=0.007883 metrics={'f1_val': 0.9952384449523725, 'auprc': 0.9979071425909152, 'loss_val': 0.05677780913869912, 'psi': 0.9963059240077896}-{'f1_val': 0.996625909096903, 'auprc': 0.9962846412891809, 'loss_val': 0.07600130788948613, 'psi': 0.9964894019738142}
[S6] START round=21 head_norm_before_train=1.376635 cos_to_last_merge=0.9482 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.948
[S6] round=21 local utility u=0.632887 metrics={'f1_val': 0.7895748873550439, 'auprc': 0.9565327612826715, 'loss_val': 0.4255105828254889, 'psi': 0.8563580369260949}-{'f1_val': 0.6562438844129819, 'auprc': 0.8185296875030964, 'loss_val': 0.4772890120934564, 'psi': 0.7211582056490278}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=21 head_norm_before_train=1.602605 cos_to_last_merge=0.9983 (last merge round=17)
[S7] round=21 local utility u=0.000000 metrics={'f1_val': 0.6330682387557807, 'auprc': 0.7934149286916198, 'loss_val': 0.5965254151252282, 'psi': 0.6972069147301163}-{'f1_val': 0.6666860834051509, 'auprc': 0.8351074703194202, 'loss_val': 0.400955497841662, 'psi': 0.7340546381708586}
[S8] START round=21 head_norm_before_train=1.175850 cos_to_last_merge=0.9942 (last merge round=18)
[S8] round=21 local utility u=0.023940 metrics={'f1_val': 0.9950136499820015, 'auprc': 0.9991658346521497, 'loss_val': 0.15190956072614467, 'psi': 0.9966745238500608}-{'f1_val': 0.9958992753750342, 'auprc': 0.9993458974859106, 'loss_val': 0.20564392111098548, 'psi': 0.9972779242193848}
[S9] START round=21 head_norm_before_train=1.628517 cos_to_last_merge=0.9904 (last merge round=13)
[S9] round=21 local utility u=0.000000 metrics={'f1_val': 0.9935215919844088, 'auprc': 0.9986563593341502, 'loss_val': 0.030263922865291365, 'psi': 0.9955754989243053}-{'f1_val': 0.9954158325366191, 'auprc': 0.9987755880563187, 'loss_val': 0.025534595912409943, 'psi': 0.996759734744499}
[S10] START round=21 head_norm_before_train=1.133713 cos_to_last_merge=0.9997 (last merge round=19)
[S10] round=21 local utility u=0.451665 metrics={'f1_val': 0.9947128492202709, 'auprc': 0.9953410288582116, 'loss_val': 0.1967995895036578, 'psi': 0.9949641210754472}-{'f1_val': 0.8511692575539659, 'auprc': 0.9952781562657087, 'loss_val': 0.23868007180446116, 'psi': 0.908812817038663}
[S11] START round=21 head_norm_before_train=1.471600 cos_to_last_merge=1.0000 (last merge round=20)
[S11] round=21 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994690389243639, 'loss_val': 0.11403481537665541, 'psi': 0.9958043584056093}-{'f1_val': 0.9967887165093644, 'auprc': 0.9961827319706689, 'loss_val': 0.1022060087657471, 'psi': 0.9965463226938862}
[S13] START round=21 head_norm_before_train=1.141372 cos_to_last_merge=0.9994 (last merge round=19)
[S13] round=21 local utility u=0.000000 metrics={'f1_val': 0.5411143136718081, 'auprc': 0.5042693002170371, 'loss_val': 0.8716248173696124, 'psi': 0.5263763082898997}-{'f1_val': 0.5655480100997825, 'auprc': 0.6746616305892239, 'loss_val': 0.812021037086705, 'psi': 0.609193458295559}
[S14] START round=21 head_norm_before_train=1.219785 cos_to_last_merge=0.9243 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.924
[S14] round=21 local utility u=0.000000 metrics={'f1_val': 0.9858457201457009, 'auprc': 0.9970327883929764, 'loss_val': 0.1909130768298985, 'psi': 0.9903205474446111}-{'f1_val': 0.9977137911249896, 'auprc': 0.9970911796464264, 'loss_val': 0.2285348244654741, 'psi': 0.9974647465335642}
[S15] START round=21 head_norm_before_train=1.207667 cos_to_last_merge=0.9978 (last merge round=19)
[S15] round=21 local utility u=0.000000 metrics={'f1_val': 0.7737161304937856, 'auprc': 0.9114801380596183, 'loss_val': 0.3228139533336886, 'psi': 0.8288217335201187}-{'f1_val': 0.8650630862192775, 'auprc': 0.9812451600230538, 'loss_val': 0.26135313862347553, 'psi': 0.9115359157407881}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=21 head_norm_before_train=1.736224 (no previous merge yet)
[S16] round=21 local utility u=0.240984 metrics={'f1_val': 0.9917260677912058, 'auprc': 0.995398963856263, 'loss_val': 0.08760895552747365, 'psi': 0.9931952262172288}-{'f1_val': 0.9264733302613433, 'auprc': 0.9929345665612518, 'loss_val': 0.17066820174005243, 'psi': 0.9530578247813066}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S16] sending update (kind=head size=1804 to 1 peers)
[S17] START round=21 head_norm_before_train=1.346883 cos_to_last_merge=0.8569 (last merge round=1)
[S17] ⚠️ Model drifted since last merge! cos=0.857
[S17] round=21 local utility u=0.000000 metrics={'f1_val': 0.33974453471151866, 'auprc': 0.761014074194768, 'loss_val': 1.0409693966728204, 'psi': 0.5082523505048184}-{'f1_val': 0.38797766276573914, 'auprc': 0.788162377109346, 'loss_val': 0.99179620575884, 'psi': 0.5480515485031818}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=21 metric=0.3397 head_norm=1.360413
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.021656e-01
[S17] stored merged vector for next round verification (round=21)
[S17] DEBUG after merge:  round=21 metric=0.3544 head_norm=1.119853 delta_norm=0.602166
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=21 metric=0.9965 head_norm=1.511798
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.764361e-02
[S11] stored merged vector for next round verification (round=21)
[S11] DEBUG after merge:  round=21 metric=0.9965 head_norm=1.484592 delta_norm=0.077644
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S10] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9964
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.8439
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9980
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=21 metric=0.5411 head_norm=1.165273
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.517840e-02
[S13] stored merged vector for next round verification (round=21)
[S13] DEBUG after merge:  round=21 metric=0.5396 head_norm=1.154327 delta_norm=0.045178
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=22 head_norm_before_train=1.481374 cos_to_last_merge=0.9977 (last merge round=18)
[S2] round=22 local utility u=0.031403 metrics={'f1_val': 0.7015658713512667, 'auprc': 0.6972884583548943, 'loss_val': 0.3136432458352387, 'psi': 0.6998549061527177}-{'f1_val': 0.7015710590385817, 'auprc': 0.6714636720808025, 'loss_val': 0.29900609935705375, 'psi': 0.68952810425547}
[S3] START round=22 head_norm_before_train=1.588430 cos_to_last_merge=0.9405 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.941
[S3] round=22 local utility u=0.000000 metrics={'f1_val': 0.9834700229051168, 'auprc': 0.997225765914408, 'loss_val': 0.05219663501216978, 'psi': 0.9889723201088332}-{'f1_val': 0.9975267313009194, 'auprc': 0.9984756261134988, 'loss_val': 0.02848160756589152, 'psi': 0.9979062892259511}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=22 head_norm_before_train=1.532421 cos_to_last_merge=0.8278 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.828
[S4] round=22 local utility u=0.000000 metrics={'f1_val': 0.9428417231543204, 'auprc': 0.9736469310784405, 'loss_val': 0.27383492945918564, 'psi': 0.9551638063239685}-{'f1_val': 0.945451088459563, 'auprc': 0.9758713394434844, 'loss_val': 0.26409860197743357, 'psi': 0.9576191888531316}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=22 head_norm_before_train=1.811314 (no previous merge yet)
[S5] round=22 local utility u=0.005091 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9971240342479479, 'loss_val': 0.05081190456771947, 'psi': 0.9966491682924734}-{'f1_val': 0.9952384449523725, 'auprc': 0.9979071425909152, 'loss_val': 0.05677780913869912, 'psi': 0.9963059240077896}
[S6] START round=22 head_norm_before_train=1.399976 cos_to_last_merge=0.9451 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.945
[S6] round=22 local utility u=0.039217 metrics={'f1_val': 0.8164372429855585, 'auprc': 0.9464106377514434, 'loss_val': 0.4778842851810106, 'psi': 0.8684266008919125}-{'f1_val': 0.7895748873550439, 'auprc': 0.9565327612826715, 'loss_val': 0.4255105828254889, 'psi': 0.8563580369260949}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=22 head_norm_before_train=1.611150 cos_to_last_merge=0.9982 (last merge round=17)
[S7] round=22 local utility u=0.000000 metrics={'f1_val': 0.6154871201987391, 'auprc': 0.7902229527324798, 'loss_val': 0.7043112316668886, 'psi': 0.6853814532122353}-{'f1_val': 0.6330682387557807, 'auprc': 0.7934149286916198, 'loss_val': 0.5965254151252282, 'psi': 0.6972069147301163}
[S8] START round=22 head_norm_before_train=1.243619 cos_to_last_merge=0.9870 (last merge round=18)
[S8] round=22 local utility u=0.017114 metrics={'f1_val': 0.9940645577230776, 'auprc': 0.9993487495551908, 'loss_val': 0.11253600339935008, 'psi': 0.9961782344559229}-{'f1_val': 0.9950136499820015, 'auprc': 0.9991658346521497, 'loss_val': 0.15190956072614467, 'psi': 0.9966745238500608}
[S9] START round=22 head_norm_before_train=1.652669 cos_to_last_merge=0.9894 (last merge round=13)
[S9] round=22 local utility u=0.009439 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963414087166664, 'loss_val': 0.02327558878578889, 'psi': 0.9965328705750014}-{'f1_val': 0.9935215919844088, 'auprc': 0.9986563593341502, 'loss_val': 0.030263922865291365, 'psi': 0.9955754989243053}
[S10] START round=22 head_norm_before_train=1.156633 cos_to_last_merge=0.9987 (last merge round=19)
[S10] round=22 local utility u=0.010900 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9953317987778804, 'loss_val': 0.1803534860838388, 'psi': 0.995498511620164}-{'f1_val': 0.9947128492202709, 'auprc': 0.9953410288582116, 'loss_val': 0.1967995895036578, 'psi': 0.9949641210754472}
[S11] START round=22 head_norm_before_train=1.484592 cos_to_last_merge=1.0000 (last merge round=21)
[S11] round=22 local utility u=0.000000 metrics={'f1_val': 0.9743991566496205, 'auprc': 0.9946316146459123, 'loss_val': 0.15501507930921726, 'psi': 0.9824921398481372}-{'f1_val': 0.9965470045135896, 'auprc': 0.994690389243639, 'loss_val': 0.11403481537665541, 'psi': 0.9958043584056093}
[S13] START round=22 head_norm_before_train=1.154327 cos_to_last_merge=1.0000 (last merge round=21)
[S13] round=22 local utility u=0.185322 metrics={'f1_val': 0.5149693239125988, 'auprc': 0.6884381228800096, 'loss_val': 0.8966165418677866, 'psi': 0.5843568434995631}-{'f1_val': 0.5411143136718081, 'auprc': 0.5042693002170371, 'loss_val': 0.8716248173696124, 'psi': 0.5263763082898997}
[S14] START round=22 head_norm_before_train=1.263391 cos_to_last_merge=0.9154 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.915
[S14] round=22 local utility u=0.052480 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9973657560036875, 'loss_val': 0.15386333788813739, 'psi': 0.997144807296074}-{'f1_val': 0.9858457201457009, 'auprc': 0.9970327883929764, 'loss_val': 0.1909130768298985, 'psi': 0.9903205474446111}
[S15] START round=22 head_norm_before_train=1.277081 cos_to_last_merge=0.9925 (last merge round=19)
[S15] round=22 local utility u=0.000000 metrics={'f1_val': 0.7710457445196683, 'auprc': 0.9141868955590983, 'loss_val': 0.33666778884119525, 'psi': 0.8283022049354403}-{'f1_val': 0.7737161304937856, 'auprc': 0.9114801380596183, 'loss_val': 0.3228139533336886, 'psi': 0.8288217335201187}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=22 head_norm_before_train=1.758998 (no previous merge yet)
[S16] round=22 local utility u=0.000000 metrics={'f1_val': 0.8445322307586078, 'auprc': 0.8794408617452665, 'loss_val': 0.8299601147675989, 'psi': 0.8584956831532713}-{'f1_val': 0.9917260677912058, 'auprc': 0.995398963856263, 'loss_val': 0.08760895552747365, 'psi': 0.9931952262172288}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=22 head_norm_before_train=1.119853 cos_to_last_merge=1.0000 (last merge round=21)
[S17] round=22 local utility u=0.202496 metrics={'f1_val': 0.35226949861097323, 'auprc': 0.8392818733691301, 'loss_val': 0.9459301593194178, 'psi': 0.547074448514236}-{'f1_val': 0.33974453471151866, 'auprc': 0.761014074194768, 'loss_val': 1.0409693966728204, 'psi': 0.5082523505048184}
[S2]  timeout peer S6
[S7]  timeout peer S14
[S9]  timeout peer S7
[S14]  timeout peer S15
[S14]  timeout peer S16
[S5]  timeout peer S3
[S8]  timeout peer S5
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S10] sending update (kind=head size=1800 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S14] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=22 metric=0.9744 head_norm=1.521577
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.648000e-02
[S11] stored merged vector for next round verification (round=22)
[S11] DEBUG after merge:  round=22 metric=0.9723 head_norm=1.500138 delta_norm=0.066480
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9960
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.8198
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9960
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=22 metric=0.5150 head_norm=1.173424
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.277139e-02
[S13] stored merged vector for next round verification (round=22)
[S13] DEBUG after merge:  round=22 metric=0.5115 head_norm=1.178154 delta_norm=0.052771
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=22 metric=0.3523 head_norm=1.141499
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.442012e-01
[S17] stored merged vector for next round verification (round=22)
[S17] DEBUG after merge:  round=22 metric=0.3508 head_norm=1.142948 delta_norm=0.344201
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=22 metric=0.9956 head_norm=1.185217
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.277139e-02
[S10] stored merged vector for next round verification (round=22)
[S10] DEBUG after merge:  round=22 metric=0.9956 head_norm=1.178154 delta_norm=0.052771
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9529
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9985
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=22 metric=0.9941 head_norm=1.312335
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.772039e-01
[S8] stored merged vector for next round verification (round=22)
[S8] DEBUG after merge:  round=22 metric=0.9937 head_norm=1.170615 delta_norm=0.377204
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=23 head_norm_before_train=1.499077 cos_to_last_merge=0.9967 (last merge round=18)
[S2] round=23 local utility u=0.000000 metrics={'f1_val': 0.6946155927572119, 'auprc': 0.6731468327627816, 'loss_val': 0.34974226459773866, 'psi': 0.6860280887594398}-{'f1_val': 0.7015658713512667, 'auprc': 0.6972884583548943, 'loss_val': 0.3136432458352387, 'psi': 0.6998549061527177}
[S3] START round=23 head_norm_before_train=1.613210 cos_to_last_merge=0.9378 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.938
[S3] round=23 local utility u=0.000000 metrics={'f1_val': 0.9428588688776007, 'auprc': 0.9983360836656074, 'loss_val': 0.16555072467316545, 'psi': 0.9650497547928034}-{'f1_val': 0.9834700229051168, 'auprc': 0.997225765914408, 'loss_val': 0.05219663501216978, 'psi': 0.9889723201088332}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=23 head_norm_before_train=1.544315 cos_to_last_merge=0.8263 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.826
[S4] round=23 local utility u=0.012308 metrics={'f1_val': 0.9434403749811748, 'auprc': 0.9786877055878546, 'loss_val': 0.26793266910723623, 'psi': 0.9575393072238467}-{'f1_val': 0.9428417231543204, 'auprc': 0.9736469310784405, 'loss_val': 0.27383492945918564, 'psi': 0.9551638063239685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=23 head_norm_before_train=1.825490 (no previous merge yet)
[S5] round=23 local utility u=0.002149 metrics={'f1_val': 0.9967731002659072, 'auprc': 0.9976202567883843, 'loss_val': 0.05064535325736359, 'psi': 0.997111962874898}-{'f1_val': 0.9963325909888239, 'auprc': 0.9971240342479479, 'loss_val': 0.05081190456771947, 'psi': 0.9966491682924734}
[S5] not sending this round → trigger blocked (psi=0.997)
[S6] START round=23 head_norm_before_train=1.419638 cos_to_last_merge=0.9423 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.942
[S6] round=23 local utility u=0.610293 metrics={'f1_val': 0.9624489442690797, 'auprc': 0.9665860876667598, 'loss_val': 0.19389434708938838, 'psi': 0.9641038016281517}-{'f1_val': 0.8164372429855585, 'auprc': 0.9464106377514434, 'loss_val': 0.4778842851810106, 'psi': 0.8684266008919125}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=23 head_norm_before_train=1.624252 cos_to_last_merge=0.9976 (last merge round=17)
[S7] round=23 local utility u=0.000000 metrics={'f1_val': 0.530448466530067, 'auprc': 0.7829337908239736, 'loss_val': 0.8347073838427773, 'psi': 0.6314425962476297}-{'f1_val': 0.6154871201987391, 'auprc': 0.7902229527324798, 'loss_val': 0.7043112316668886, 'psi': 0.6853814532122353}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=23 head_norm_before_train=1.170615 cos_to_last_merge=1.0000 (last merge round=22)
[S8] round=23 local utility u=0.000000 metrics={'f1_val': 0.7142391053978291, 'auprc': 0.6609959597694873, 'loss_val': 0.47730945393589647, 'psi': 0.6929418471464924}-{'f1_val': 0.9940645577230776, 'auprc': 0.9993487495551908, 'loss_val': 0.11253600339935008, 'psi': 0.9961782344559229}
[S9] START round=23 head_norm_before_train=1.679379 cos_to_last_merge=0.9880 (last merge round=13)
[S9] round=23 local utility u=0.000000 metrics={'f1_val': 0.9871446711497952, 'auprc': 0.9985776106572437, 'loss_val': 0.04818570914518851, 'psi': 0.9917178469527745}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963414087166664, 'loss_val': 0.02327558878578889, 'psi': 0.9965328705750014}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=23 head_norm_before_train=1.178154 cos_to_last_merge=1.0000 (last merge round=22)
[S10] round=23 local utility u=0.003138 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9953220241915866, 'loss_val': 0.1740487734244961, 'psi': 0.9954946017856465}-{'f1_val': 0.9956096535150197, 'auprc': 0.9953317987778804, 'loss_val': 0.1803534860838388, 'psi': 0.995498511620164}
[S11] START round=23 head_norm_before_train=1.500138 cos_to_last_merge=1.0000 (last merge round=22)
[S11] round=23 local utility u=0.100303 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9945787670757149, 'loss_val': 0.08713754401428327, 'psi': 0.9957597095384397}-{'f1_val': 0.9743991566496205, 'auprc': 0.9946316146459123, 'loss_val': 0.15501507930921726, 'psi': 0.9824921398481372}
[S13] START round=23 head_norm_before_train=1.178154 cos_to_last_merge=1.0000 (last merge round=22)
[S13] round=23 local utility u=0.254897 metrics={'f1_val': 0.5838495313324812, 'auprc': 0.6764780971800641, 'loss_val': 0.7642232854376544, 'psi': 0.6209009576715143}-{'f1_val': 0.5149693239125988, 'auprc': 0.6884381228800096, 'loss_val': 0.8966165418677866, 'psi': 0.5843568434995631}
[S14] START round=23 head_norm_before_train=1.297890 cos_to_last_merge=0.9080 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.908
[S14] round=23 local utility u=0.011062 metrics={'f1_val': 0.997240356705793, 'auprc': 0.997028559178744, 'loss_val': 0.13218583080552265, 'psi': 0.9971556376949735}-{'f1_val': 0.9969975081576651, 'auprc': 0.9973657560036875, 'loss_val': 0.15386333788813739, 'psi': 0.997144807296074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S14] sending update (kind=head size=1799 to 1 peers)
[S15] START round=23 head_norm_before_train=1.340503 cos_to_last_merge=0.9864 (last merge round=19)
[S15] round=23 local utility u=0.000000 metrics={'f1_val': 0.7662924949959267, 'auprc': 0.9121316800389858, 'loss_val': 0.35585495196338335, 'psi': 0.8246281690131503}-{'f1_val': 0.7710457445196683, 'auprc': 0.9141868955590983, 'loss_val': 0.33666778884119525, 'psi': 0.8283022049354403}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=23 head_norm_before_train=1.778435 (no previous merge yet)
[S16] round=23 local utility u=1.000000 metrics={'f1_val': 0.9919670027399721, 'auprc': 0.9961354504712288, 'loss_val': 0.05988160109353486, 'psi': 0.9936343818324748}-{'f1_val': 0.8445322307586078, 'auprc': 0.8794408617452665, 'loss_val': 0.8299601147675989, 'psi': 0.8584956831532713}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S16] sending update (kind=head size=1803 to 1 peers)
[S17] START round=23 head_norm_before_train=1.142948 cos_to_last_merge=1.0000 (last merge round=22)
[S17] round=23 local utility u=0.912633 metrics={'f1_val': 0.6382894151663676, 'auprc': 0.8305714860888593, 'loss_val': 0.8106522549449633, 'psi': 0.7152022435353643}-{'f1_val': 0.35226949861097323, 'auprc': 0.8392818733691301, 'loss_val': 0.9459301593194178, 'psi': 0.547074448514236}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S11] → sending delta(kind=head bytes=1806) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1806 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.9992
[S2] RECEIVED delta(kind=head bytes=1806) from S11
[S2] cosine check vs S11: cos=0.9968
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9939
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9992
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=23 metric=0.6383 head_norm=1.175935
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.214074e-01
[S17] stored merged vector for next round verification (round=23)
[S17] DEBUG after merge:  round=23 metric=0.6345 head_norm=1.226174 delta_norm=0.221407
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=23 metric=0.9965 head_norm=1.531731
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.883020e-02
[S11] stored merged vector for next round verification (round=23)
[S11] DEBUG after merge:  round=23 metric=0.9965 head_norm=1.514349 delta_norm=0.058830
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=23 metric=0.5838 head_norm=1.194661
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.484405e-02
[S13] stored merged vector for next round verification (round=23)
[S13] DEBUG after merge:  round=23 metric=0.5854 head_norm=1.199815 delta_norm=0.024844
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=23 metric=0.9956 head_norm=1.205459
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.484404e-02
[S10] stored merged vector for next round verification (round=23)
[S10] DEBUG after merge:  round=23 metric=0.9956 head_norm=1.199815 delta_norm=0.024844
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=24 head_norm_before_train=1.513557 cos_to_last_merge=0.9959 (last merge round=18)
[S2] round=24 local utility u=0.118173 metrics={'f1_val': 0.7014928908785604, 'auprc': 0.7276991602650418, 'loss_val': 0.3183171169462924, 'psi': 0.711975398633153}-{'f1_val': 0.6946155927572119, 'auprc': 0.6731468327627816, 'loss_val': 0.34974226459773866, 'psi': 0.6860280887594398}
[S3] START round=24 head_norm_before_train=1.638739 cos_to_last_merge=0.9352 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.935
[S3] round=24 local utility u=0.081001 metrics={'f1_val': 0.959457957134594, 'auprc': 0.9959722731799155, 'loss_val': 0.0960509211623138, 'psi': 0.9740636835527227}-{'f1_val': 0.9428588688776007, 'auprc': 0.9983360836656074, 'loss_val': 0.16555072467316545, 'psi': 0.9650497547928034}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=24 head_norm_before_train=1.557113 cos_to_last_merge=0.8250 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.825
[S4] round=24 local utility u=0.005032 metrics={'f1_val': 0.9477959689337473, 'auprc': 0.9723477317698909, 'loss_val': 0.26498306251869436, 'psi': 0.9576166740682047}-{'f1_val': 0.9434403749811748, 'auprc': 0.9786877055878546, 'loss_val': 0.26793266910723623, 'psi': 0.9575393072238467}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=24 head_norm_before_train=1.840272 (no previous merge yet)
[S5] round=24 local utility u=0.000745 metrics={'f1_val': 0.996186023309311, 'auprc': 0.996913935945827, 'loss_val': 0.04351362047027143, 'psi': 0.9964771883639174}-{'f1_val': 0.9967731002659072, 'auprc': 0.9976202567883843, 'loss_val': 0.05064535325736359, 'psi': 0.997111962874898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S5] sending update (kind=head size=1807 to 1 peers)
[S6] START round=24 head_norm_before_train=1.437634 cos_to_last_merge=0.9397 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.940
[S6] round=24 local utility u=0.000000 metrics={'f1_val': 0.5963893622368528, 'auprc': 0.7681573895785161, 'loss_val': 0.8767483191235199, 'psi': 0.6650965731735181}-{'f1_val': 0.9624489442690797, 'auprc': 0.9665860876667598, 'loss_val': 0.19389434708938838, 'psi': 0.9641038016281517}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=24 head_norm_before_train=1.636184 cos_to_last_merge=0.9973 (last merge round=17)
[S7] round=24 local utility u=0.097709 metrics={'f1_val': 0.5402026307122508, 'auprc': 0.7876813581287082, 'loss_val': 0.7120563144120876, 'psi': 0.6391941216788338}-{'f1_val': 0.530448466530067, 'auprc': 0.7829337908239736, 'loss_val': 0.8347073838427773, 'psi': 0.6314425962476297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S7] sending update (kind=head size=1801 to 1 peers)
[S8] START round=24 head_norm_before_train=1.225680 cos_to_last_merge=0.9987 (last merge round=22)
[S8] round=24 local utility u=1.000000 metrics={'f1_val': 0.994792642153961, 'auprc': 0.9993773707293772, 'loss_val': 0.13215350898691758, 'psi': 0.9966265335841276}-{'f1_val': 0.7142391053978291, 'auprc': 0.6609959597694873, 'loss_val': 0.47730945393589647, 'psi': 0.6929418471464924}
[S9] START round=24 head_norm_before_train=1.699521 cos_to_last_merge=0.9876 (last merge round=13)
[S9] round=24 local utility u=0.043154 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9993613503691994, 'loss_val': 0.021324948444688102, 'psi': 0.9977408472360146}-{'f1_val': 0.9871446711497952, 'auprc': 0.9985776106572437, 'loss_val': 0.04818570914518851, 'psi': 0.9917178469527745}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=24 head_norm_before_train=1.199815 cos_to_last_merge=1.0000 (last merge round=23)
[S10] round=24 local utility u=0.002203 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9946734060603059, 'loss_val': 0.1651651599844014, 'psi': 0.9949820658357471}-{'f1_val': 0.9956096535150197, 'auprc': 0.9953220241915866, 'loss_val': 0.1740487734244961, 'psi': 0.9954946017856465}
[S11] START round=24 head_norm_before_train=1.514349 cos_to_last_merge=1.0000 (last merge round=23)
[S11] round=24 local utility u=0.000000 metrics={'f1_val': 0.9938536363559668, 'auprc': 0.9940904553034097, 'loss_val': 0.08839508809177059, 'psi': 0.9939483639349439}-{'f1_val': 0.9965470045135896, 'auprc': 0.9945787670757149, 'loss_val': 0.08713754401428327, 'psi': 0.9957597095384397}
[S13] START round=24 head_norm_before_train=1.199815 cos_to_last_merge=1.0000 (last merge round=23)
[S13] round=24 local utility u=0.000000 metrics={'f1_val': 0.5294831672272133, 'auprc': 0.6711862530331814, 'loss_val': 0.8371025045319698, 'psi': 0.5861644015496006}-{'f1_val': 0.5838495313324812, 'auprc': 0.6764780971800641, 'loss_val': 0.7642232854376544, 'psi': 0.6209009576715143}
[S14] START round=24 head_norm_before_train=1.331633 cos_to_last_merge=0.9014 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.901
[S14] round=24 local utility u=0.000000 metrics={'f1_val': 0.9608414157084971, 'auprc': 0.9969564549413706, 'loss_val': 0.13719169599622075, 'psi': 0.9752874314016465}-{'f1_val': 0.997240356705793, 'auprc': 0.997028559178744, 'loss_val': 0.13218583080552265, 'psi': 0.9971556376949735}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=24 head_norm_before_train=1.391319 cos_to_last_merge=0.9811 (last merge round=19)
[S15] round=24 local utility u=0.000000 metrics={'f1_val': 0.7662075691960865, 'auprc': 0.8922593092377193, 'loss_val': 0.37852289990063087, 'psi': 0.8166282652127397}-{'f1_val': 0.7662924949959267, 'auprc': 0.9121316800389858, 'loss_val': 0.35585495196338335, 'psi': 0.8246281690131503}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=24 head_norm_before_train=1.794566 (no previous merge yet)
[S16] round=24 local utility u=0.000000 metrics={'f1_val': 0.9693657243657597, 'auprc': 0.9933864051654628, 'loss_val': 0.10740120467583408, 'psi': 0.978973996685641}-{'f1_val': 0.9919670027399721, 'auprc': 0.9961354504712288, 'loss_val': 0.05988160109353486, 'psi': 0.9936343818324748}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=24 head_norm_before_train=1.226174 cos_to_last_merge=1.0000 (last merge round=23)
[S17] round=24 local utility u=0.021271 metrics={'f1_val': 0.6311546772505027, 'auprc': 0.8532349425715037, 'loss_val': 0.7932921774166628, 'psi': 0.7199867833789031}-{'f1_val': 0.6382894151663676, 'auprc': 0.8305714860888593, 'loss_val': 0.8106522549449633, 'psi': 0.7152022435353643}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:54517
[S10] sending update (kind=head size=1792 to 1 peers)
[S17] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9968
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9968
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9978
[S13] RECEIVED delta(kind=head bytes=1792) from S10
[S13] cosine check vs S10: cos=0.9993
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=24 metric=0.9948 head_norm=1.271852
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.376533e-02
[S8] stored merged vector for next round verification (round=24)
[S8] DEBUG after merge:  round=24 metric=0.9948 head_norm=1.243792 delta_norm=0.063765
[S8] aggregate: ACCEPT kept=['S17', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=24 metric=0.6312 head_norm=1.266709
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.062292e-02
[S17] stored merged vector for next round verification (round=24)
[S17] DEBUG after merge:  round=24 metric=0.6322 head_norm=1.268273 delta_norm=0.050623
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=24 metric=0.7015 head_norm=1.527269
[S2] _apply_head_vector_avg (torch): Δ‖w‖=6.466619e-02
[S2] stored merged vector for next round verification (round=24)
[S2] DEBUG after merge:  round=24 metric=0.7015 head_norm=1.528134 delta_norm=0.064666
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=25 head_norm_before_train=1.528134 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=25 local utility u=0.000000 metrics={'f1_val': 0.6366097873822352, 'auprc': 0.6714654892587868, 'loss_val': 0.3460000227866838, 'psi': 0.6505520681328558}-{'f1_val': 0.7014928908785604, 'auprc': 0.7276991602650418, 'loss_val': 0.3183171169462924, 'psi': 0.711975398633153}
[S3] START round=25 head_norm_before_train=1.657382 cos_to_last_merge=0.9332 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.933
[S3] round=25 local utility u=0.000000 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9971936584639349, 'loss_val': 0.1298573073229909, 'psi': 0.9755466177262655}-{'f1_val': 0.959457957134594, 'auprc': 0.9959722731799155, 'loss_val': 0.0960509211623138, 'psi': 0.9740636835527227}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=25 head_norm_before_train=1.571462 cos_to_last_merge=0.8229 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.823
[S4] round=25 local utility u=0.023823 metrics={'f1_val': 0.9532499088145712, 'auprc': 0.9733446628983672, 'loss_val': 0.25305120829450417, 'psi': 0.9612878104480895}-{'f1_val': 0.9477959689337473, 'auprc': 0.9723477317698909, 'loss_val': 0.26498306251869436, 'psi': 0.9576166740682047}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=25 head_norm_before_train=1.854914 (no previous merge yet)
[S5] round=25 local utility u=0.003748 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9972674169035186, 'loss_val': 0.037957091385170436, 'psi': 0.9967065213547017}-{'f1_val': 0.996186023309311, 'auprc': 0.996913935945827, 'loss_val': 0.04351362047027143, 'psi': 0.9964771883639174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S5] sending update (kind=head size=1801 to 1 peers)
[S6] START round=25 head_norm_before_train=1.450402 cos_to_last_merge=0.9376 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.938
[S6] round=25 local utility u=0.675766 metrics={'f1_val': 0.6928896557386728, 'auprc': 0.942616944686627, 'loss_val': 0.6275973306611016, 'psi': 0.7927805713178545}-{'f1_val': 0.5963893622368528, 'auprc': 0.7681573895785161, 'loss_val': 0.8767483191235199, 'psi': 0.6650965731735181}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=25 head_norm_before_train=1.645779 cos_to_last_merge=0.9968 (last merge round=17)
[S7] round=25 local utility u=0.163374 metrics={'f1_val': 0.5908830466976849, 'auprc': 0.7883897745423154, 'loss_val': 0.6915164626055362, 'psi': 0.6698857378355372}-{'f1_val': 0.5402026307122508, 'auprc': 0.7876813581287082, 'loss_val': 0.7120563144120876, 'psi': 0.6391941216788338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=25 head_norm_before_train=1.243792 cos_to_last_merge=1.0000 (last merge round=24)
[S8] round=25 local utility u=0.001105 metrics={'f1_val': 0.993553675737062, 'auprc': 0.9991006265073856, 'loss_val': 0.12167960309625635, 'psi': 0.9957724560451915}-{'f1_val': 0.994792642153961, 'auprc': 0.9993773707293772, 'loss_val': 0.13215350898691758, 'psi': 0.9966265335841276}
[S9] START round=25 head_norm_before_train=1.715127 cos_to_last_merge=0.9868 (last merge round=13)
[S9] round=25 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9987045162320266, 'loss_val': 0.021986361797735124, 'psi': 0.9969778375113219}-{'f1_val': 0.9966605118138915, 'auprc': 0.9993613503691994, 'loss_val': 0.021324948444688102, 'psi': 0.9977408472360146}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=25 head_norm_before_train=1.228350 cos_to_last_merge=0.9996 (last merge round=23)
[S10] round=25 local utility u=0.011777 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9938905850747464, 'loss_val': 0.139262123007304, 'psi': 0.9946689374415234}-{'f1_val': 0.9951878390193748, 'auprc': 0.9946734060603059, 'loss_val': 0.1651651599844014, 'psi': 0.9949820658357471}
[S11] START round=25 head_norm_before_train=1.542407 cos_to_last_merge=0.9998 (last merge round=23)
[S11] round=25 local utility u=0.002331 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9942467131890145, 'loss_val': 0.09933297087690167, 'psi': 0.9955239174210563}-{'f1_val': 0.9938536363559668, 'auprc': 0.9940904553034097, 'loss_val': 0.08839508809177059, 'psi': 0.9939483639349439}
[S13] START round=25 head_norm_before_train=1.214409 cos_to_last_merge=0.9998 (last merge round=23)
[S13] round=25 local utility u=0.339059 metrics={'f1_val': 0.6145109099153987, 'auprc': 0.6678473190693203, 'loss_val': 0.6591335068934319, 'psi': 0.6358454735769673}-{'f1_val': 0.5294831672272133, 'auprc': 0.6711862530331814, 'loss_val': 0.8371025045319698, 'psi': 0.5861644015496006}
[S14] START round=25 head_norm_before_train=1.367156 cos_to_last_merge=0.8950 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.895
[S14] round=25 local utility u=0.134770 metrics={'f1_val': 0.9976760408229349, 'auprc': 0.9995067602988457, 'loss_val': 0.09631059483255842, 'psi': 0.9984083286132992}-{'f1_val': 0.9608414157084971, 'auprc': 0.9969564549413706, 'loss_val': 0.13719169599622075, 'psi': 0.9752874314016465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=25 head_norm_before_train=1.433332 cos_to_last_merge=0.9767 (last merge round=19)
[S15] round=25 local utility u=0.000000 metrics={'f1_val': 0.698988001126284, 'auprc': 0.8675034830026835, 'loss_val': 0.44785138640245786, 'psi': 0.7663941938768438}-{'f1_val': 0.7662075691960865, 'auprc': 0.8922593092377193, 'loss_val': 0.37852289990063087, 'psi': 0.8166282652127397}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=25 head_norm_before_train=1.806808 (no previous merge yet)
[S16] round=25 local utility u=0.000000 metrics={'f1_val': 0.8241944679767065, 'auprc': 0.8243477000805878, 'loss_val': 1.1312543843147151, 'psi': 0.824255760818259}-{'f1_val': 0.9693657243657597, 'auprc': 0.9933864051654628, 'loss_val': 0.10740120467583408, 'psi': 0.978973996685641}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=25 head_norm_before_train=1.268273 cos_to_last_merge=1.0000 (last merge round=24)
[S17] round=25 local utility u=0.057636 metrics={'f1_val': 0.6422828145725863, 'auprc': 0.8583320754046652, 'loss_val': 0.7600799740631449, 'psi': 0.7287025189054179}-{'f1_val': 0.6311546772505027, 'auprc': 0.8532349425715037, 'loss_val': 0.7932921774166628, 'psi': 0.7199867833789031}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S11] → sending delta(kind=head bytes=1804) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S17] → sending delta(kind=head bytes=1805) to S8@127.0.0.1:54509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] ⇄ pheromone p=0.043 → S11@127.0.0.1:54512
[S8] RECEIVED delta(kind=head bytes=1805) from S17
[S8] cosine check vs S17: cos=0.9976
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9974
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9976
[S2] RECEIVED delta(kind=head bytes=1804) from S11
[S2] cosine check vs S11: cos=0.9989
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9974
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=25 metric=0.9964 head_norm=1.569761
[S11] _apply_head_vector_avg (torch): Δ‖w‖=6.885560e-02
[S11] stored merged vector for next round verification (round=25)
[S11] DEBUG after merge:  round=25 metric=0.9968 head_norm=1.547129 delta_norm=0.068856
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.063 → S2@127.0.0.1:54502
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=25 metric=0.9936 head_norm=1.292124
[S8] _apply_head_vector_avg (torch): Δ‖w‖=4.641151e-02
[S8] stored merged vector for next round verification (round=25)
[S8] DEBUG after merge:  round=25 metric=0.9936 head_norm=1.303648 delta_norm=0.046412
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.230 → S17@127.0.0.1:54517
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=25 metric=0.6423 head_norm=1.316708
[S17] _apply_head_vector_avg (torch): Δ‖w‖=4.641151e-02
[S17] stored merged vector for next round verification (round=25)
[S17] DEBUG after merge:  round=25 metric=0.6426 head_norm=1.303648 delta_norm=0.046412
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.173 → S8@127.0.0.1:54509
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=25 metric=0.9952 head_norm=1.260410
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.709828e-02
[S10] stored merged vector for next round verification (round=25)
[S10] DEBUG after merge:  round=25 metric=0.9952 head_norm=1.245205 delta_norm=0.047098
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.098 → S13@127.0.0.1:54513
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=25 metric=0.6145 head_norm=1.231615
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.747176e-02
[S13] stored merged vector for next round verification (round=25)
[S13] DEBUG after merge:  round=25 metric=0.6165 head_norm=1.237375 delta_norm=0.037472
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.168 → S10@127.0.0.1:54511
[S2] START round=26 head_norm_before_train=1.540879 cos_to_last_merge=1.0000 (last merge round=24)
[S2] round=26 local utility u=0.340995 metrics={'f1_val': 0.7076153667634506, 'auprc': 0.7500784044211575, 'loss_val': 0.3258820830869958, 'psi': 0.7246005818265333}-{'f1_val': 0.6366097873822352, 'auprc': 0.6714654892587868, 'loss_val': 0.3460000227866838, 'psi': 0.6505520681328558}
[S3] START round=26 head_norm_before_train=1.673834 cos_to_last_merge=0.9316 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.932
[S3] round=26 local utility u=0.000000 metrics={'f1_val': 0.9231133957603417, 'auprc': 0.9966692536722765, 'loss_val': 0.15316211842486752, 'psi': 0.9525357389251156}-{'f1_val': 0.9611152572344858, 'auprc': 0.9971936584639349, 'loss_val': 0.1298573073229909, 'psi': 0.9755466177262655}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=26 head_norm_before_train=1.587665 cos_to_last_merge=0.8204 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.820
[S4] round=26 local utility u=0.000000 metrics={'f1_val': 0.9519931644059447, 'auprc': 0.9614505928463283, 'loss_val': 0.2668175569169099, 'psi': 0.9557761357820982}-{'f1_val': 0.9532499088145712, 'auprc': 0.9733446628983672, 'loss_val': 0.25305120829450417, 'psi': 0.9612878104480895}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=26 head_norm_before_train=1.879353 (no previous merge yet)
[S5] round=26 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9968284582251217, 'loss_val': 0.03641831982507974, 'psi': 0.9964429972756352}-{'f1_val': 0.9963325909888239, 'auprc': 0.9972674169035186, 'loss_val': 0.037957091385170436, 'psi': 0.9967065213547017}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=26 head_norm_before_train=1.459751 cos_to_last_merge=0.9361 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.936
[S6] round=26 local utility u=1.000000 metrics={'f1_val': 0.9625582432973107, 'auprc': 0.9808333376033667, 'loss_val': 0.15597262872725584, 'psi': 0.9698682810197331}-{'f1_val': 0.6928896557386728, 'auprc': 0.942616944686627, 'loss_val': 0.6275973306611016, 'psi': 0.7927805713178545}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=26 head_norm_before_train=1.653764 cos_to_last_merge=0.9963 (last merge round=17)
[S7] round=26 local utility u=0.000000 metrics={'f1_val': 0.44860523992669465, 'auprc': 0.7802921290852616, 'loss_val': 1.1435835188778531, 'psi': 0.5812799955901213}-{'f1_val': 0.5908830466976849, 'auprc': 0.7883897745423154, 'loss_val': 0.6915164626055362, 'psi': 0.6698857378355372}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=26 head_norm_before_train=1.303648 cos_to_last_merge=1.0000 (last merge round=25)
[S8] round=26 local utility u=0.008019 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9993307776569476, 'loss_val': 0.10023930233935716, 'psi': 0.9952551458120802}-{'f1_val': 0.993553675737062, 'auprc': 0.9991006265073856, 'loss_val': 0.12167960309625635, 'psi': 0.9957724560451915}
[S9] START round=26 head_norm_before_train=1.728363 cos_to_last_merge=0.9859 (last merge round=13)
[S9] round=26 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9940809923507619, 'loss_val': 0.022167676300431146, 'psi': 0.9953824538078713}-{'f1_val': 0.9958267183641853, 'auprc': 0.9987045162320266, 'loss_val': 0.021986361797735124, 'psi': 0.9969778375113219}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=26 head_norm_before_train=1.245205 cos_to_last_merge=1.0000 (last merge round=25)
[S10] round=26 local utility u=0.019312 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9957295613226735, 'loss_val': 0.10868627769942468, 'psi': 0.9956576166380813}-{'f1_val': 0.9951878390193748, 'auprc': 0.9938905850747464, 'loss_val': 0.139262123007304, 'psi': 0.9946689374415234}
[S11] START round=26 head_norm_before_train=1.547129 cos_to_last_merge=1.0000 (last merge round=25)
[S11] round=26 local utility u=0.005303 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9935621625449812, 'loss_val': 0.08915231104838796, 'psi': 0.9954980949236112}-{'f1_val': 0.9963753869090841, 'auprc': 0.9942467131890145, 'loss_val': 0.09933297087690167, 'psi': 0.9955239174210563}
[S13] START round=26 head_norm_before_train=1.237375 cos_to_last_merge=1.0000 (last merge round=25)
[S13] round=26 local utility u=0.000000 metrics={'f1_val': 0.5344443377256283, 'auprc': 0.6865247411232244, 'loss_val': 0.8610272675203838, 'psi': 0.5952764990846666}-{'f1_val': 0.6145109099153987, 'auprc': 0.6678473190693203, 'loss_val': 0.6591335068934319, 'psi': 0.6358454735769673}
[S14] START round=26 head_norm_before_train=1.398013 cos_to_last_merge=0.8897 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.890
[S14] round=26 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9966382057769287, 'loss_val': 0.09598839319180985, 'psi': 0.9964973327145724}-{'f1_val': 0.9976760408229349, 'auprc': 0.9995067602988457, 'loss_val': 0.09631059483255842, 'psi': 0.9984083286132992}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=26 head_norm_before_train=1.466327 cos_to_last_merge=0.9733 (last merge round=19)
[S15] round=26 local utility u=0.524458 metrics={'f1_val': 0.7993244719259835, 'auprc': 0.9672945312548715, 'loss_val': 0.3003270132462273, 'psi': 0.8665124956575387}-{'f1_val': 0.698988001126284, 'auprc': 0.8675034830026835, 'loss_val': 0.44785138640245786, 'psi': 0.7663941938768438}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S15] sending update (kind=head size=1806 to 1 peers)
[S16] START round=26 head_norm_before_train=1.820394 (no previous merge yet)
[S16] round=26 local utility u=1.000000 metrics={'f1_val': 0.944957168469684, 'auprc': 0.9942391788667015, 'loss_val': 0.1570922721491202, 'psi': 0.964669972628491}-{'f1_val': 0.8241944679767065, 'auprc': 0.8243477000805878, 'loss_val': 1.1312543843147151, 'psi': 0.824255760818259}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=26 head_norm_before_train=1.303648 cos_to_last_merge=1.0000 (last merge round=25)
[S17] round=26 local utility u=0.025510 metrics={'f1_val': 0.642000366044414, 'auprc': 0.8585972484523219, 'loss_val': 0.7081610248520074, 'psi': 0.7286391190075772}-{'f1_val': 0.6422828145725863, 'auprc': 0.8583320754046652, 'loss_val': 0.7600799740631449, 'psi': 0.7287025189054179}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[S2] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9995
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.9995
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9973
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9991
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9973
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=26 metric=0.9925 head_norm=1.354293
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.004108e-02
[S8] stored merged vector for next round verification (round=26)
[S8] DEBUG after merge:  round=26 metric=0.9925 head_norm=1.351394 delta_norm=0.050041
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=26 metric=0.6420 head_norm=1.350344
[S17] _apply_head_vector_avg (torch): Δ‖w‖=5.004108e-02
[S17] stored merged vector for next round verification (round=26)
[S17] DEBUG after merge:  round=26 metric=0.6425 head_norm=1.351394 delta_norm=0.050041
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=26 metric=0.9968 head_norm=1.575972
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.703884e-02
[S11] stored merged vector for next round verification (round=26)
[S11] DEBUG after merge:  round=26 metric=0.9968 head_norm=1.564198 delta_norm=0.027039
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=26 metric=0.7076 head_norm=1.552806
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.270286e-02
[S2] stored merged vector for next round verification (round=26)
[S2] DEBUG after merge:  round=26 metric=0.7076 head_norm=1.562475 delta_norm=0.032703
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=27 head_norm_before_train=1.562475 cos_to_last_merge=1.0000 (last merge round=26)
[S2] round=27 local utility u=0.191370 metrics={'f1_val': 0.7051106015974221, 'auprc': 0.8816825337981804, 'loss_val': 0.32292646781415146, 'psi': 0.7757393744777255}-{'f1_val': 0.7076153667634506, 'auprc': 0.7500784044211575, 'loss_val': 0.3258820830869958, 'psi': 0.7246005818265333}
[S3] START round=27 head_norm_before_train=1.693227 cos_to_last_merge=0.9295 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.930
[S3] round=27 local utility u=0.280652 metrics={'f1_val': 0.9960564077792481, 'auprc': 0.9985095556043978, 'loss_val': 0.03503759967203702, 'psi': 0.997037666909308}-{'f1_val': 0.9231133957603417, 'auprc': 0.9966692536722765, 'loss_val': 0.15316211842486752, 'psi': 0.9525357389251156}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=27 head_norm_before_train=1.602078 cos_to_last_merge=0.8185 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.818
[S4] round=27 local utility u=0.028531 metrics={'f1_val': 0.9527388985009935, 'auprc': 0.9752541544071505, 'loss_val': 0.2556410758708737, 'psi': 0.9617450008634563}-{'f1_val': 0.9519931644059447, 'auprc': 0.9614505928463283, 'loss_val': 0.2668175569169099, 'psi': 0.9557761357820982}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S4] sending update (kind=head size=1796 to 1 peers)
[S5] START round=27 head_norm_before_train=1.894936 (no previous merge yet)
[S5] round=27 local utility u=0.001821 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9974782162803254, 'loss_val': 0.03560405607527882, 'psi': 0.9967908411054245}-{'f1_val': 0.996186023309311, 'auprc': 0.9968284582251217, 'loss_val': 0.03641831982507974, 'psi': 0.9964429972756352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=27 head_norm_before_train=1.470482 cos_to_last_merge=0.9347 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.935
[S6] round=27 local utility u=0.000000 metrics={'f1_val': 0.4414292526334173, 'auprc': 0.7812125325584889, 'loss_val': 0.9597258740112318, 'psi': 0.577342564603446}-{'f1_val': 0.9625582432973107, 'auprc': 0.9808333376033667, 'loss_val': 0.15597262872725584, 'psi': 0.9698682810197331}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=27 head_norm_before_train=1.662010 cos_to_last_merge=0.9960 (last merge round=17)
[S7] round=27 local utility u=0.567517 metrics={'f1_val': 0.5667097753957746, 'auprc': 0.7852928936951903, 'loss_val': 0.7321793459998995, 'psi': 0.6541430227155409}-{'f1_val': 0.44860523992669465, 'auprc': 0.7802921290852616, 'loss_val': 1.1435835188778531, 'psi': 0.5812799955901213}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=27 head_norm_before_train=1.351394 cos_to_last_merge=1.0000 (last merge round=26)
[S8] round=27 local utility u=0.000000 metrics={'f1_val': 0.7139758603458082, 'auprc': 0.9899102899808647, 'loss_val': 0.22410156967993922, 'psi': 0.8243496321998308}-{'f1_val': 0.9925380579155019, 'auprc': 0.9993307776569476, 'loss_val': 0.10023930233935716, 'psi': 0.9952551458120802}
[S9] START round=27 head_norm_before_train=1.743546 cos_to_last_merge=0.9852 (last merge round=13)
[S9] round=27 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9986317399279623, 'loss_val': 0.03132537034865548, 'psi': 0.9944395793539217}-{'f1_val': 0.9962500947792776, 'auprc': 0.9940809923507619, 'loss_val': 0.022167676300431146, 'psi': 0.9953824538078713}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=27 head_norm_before_train=1.277945 cos_to_last_merge=0.9996 (last merge round=25)
[S10] round=27 local utility u=0.007368 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.996540242904683, 'loss_val': 0.0963816281795044, 'psi': 0.9959818892708852}-{'f1_val': 0.9956096535150197, 'auprc': 0.9957295613226735, 'loss_val': 0.10868627769942468, 'psi': 0.9956576166380813}
[S11] START round=27 head_norm_before_train=1.564198 cos_to_last_merge=1.0000 (last merge round=26)
[S11] round=27 local utility u=0.004533 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9916806917900626, 'loss_val': 0.0729920326216933, 'psi': 0.9946004794241787}-{'f1_val': 0.9967887165093644, 'auprc': 0.9935621625449812, 'loss_val': 0.08915231104838796, 'psi': 0.9954980949236112}
[S13] START round=27 head_norm_before_train=1.252291 cos_to_last_merge=0.9998 (last merge round=25)
[S13] round=27 local utility u=0.000000 metrics={'f1_val': 0.5308615302022449, 'auprc': 0.6952057172578648, 'loss_val': 0.8958221740134354, 'psi': 0.5965992050244928}-{'f1_val': 0.5344443377256283, 'auprc': 0.6865247411232244, 'loss_val': 0.8610272675203838, 'psi': 0.5952764990846666}
[S14] START round=27 head_norm_before_train=1.428441 cos_to_last_merge=0.8851 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.885
[S14] round=27 local utility u=0.016909 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9987951026865527, 'loss_val': 0.07614376852338227, 'psi': 0.9981103467641946}-{'f1_val': 0.9964034173396682, 'auprc': 0.9966382057769287, 'loss_val': 0.09598839319180985, 'psi': 0.9964973327145724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=27 head_norm_before_train=1.491120 cos_to_last_merge=0.9707 (last merge round=19)
[S15] round=27 local utility u=0.303612 metrics={'f1_val': 0.8795301208486748, 'auprc': 0.974564830820652, 'loss_val': 0.19614750249340618, 'psi': 0.9175440048374657}-{'f1_val': 0.7993244719259835, 'auprc': 0.9672945312548715, 'loss_val': 0.3003270132462273, 'psi': 0.8665124956575387}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=27 head_norm_before_train=1.834015 (no previous merge yet)
[S16] round=27 local utility u=0.200506 metrics={'f1_val': 0.9919670027399721, 'auprc': 0.9963441799711786, 'loss_val': 0.044453381159236346, 'psi': 0.9937178736324547}-{'f1_val': 0.944957168469684, 'auprc': 0.9942391788667015, 'loss_val': 0.1570922721491202, 'psi': 0.964669972628491}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=27 head_norm_before_train=1.351394 cos_to_last_merge=1.0000 (last merge round=26)
[S17] round=27 local utility u=0.000000 metrics={'f1_val': 0.6428783474469157, 'auprc': 0.8468347423421101, 'loss_val': 0.770807566588166, 'psi': 0.7244609054049935}-{'f1_val': 0.642000366044414, 'auprc': 0.8585972484523219, 'loss_val': 0.7081610248520074, 'psi': 0.7286391190075772}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1804 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=27 metric=0.5309 head_norm=1.265536
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.766983e-02
[S13] stored merged vector for next round verification (round=27)
[S13] DEBUG after merge:  round=27 metric=0.5365 head_norm=1.271198 delta_norm=0.037670
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1794 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=0.9987
[S11] RECEIVED delta(kind=head bytes=1804) from S2
[S11] cosine check vs S2: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9998
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=27 metric=0.7051 head_norm=1.573781
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.743684e-02
[S2] stored merged vector for next round verification (round=27)
[S2] DEBUG after merge:  round=27 metric=0.7051 head_norm=1.583496 delta_norm=0.017437
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=27 metric=0.9965 head_norm=1.593343
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.743684e-02
[S11] stored merged vector for next round verification (round=27)
[S11] DEBUG after merge:  round=27 metric=0.9965 head_norm=1.583496 delta_norm=0.017437
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=28 head_norm_before_train=1.583496 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=28 local utility u=0.000000 metrics={'f1_val': 0.6439713978175107, 'auprc': 0.7418394061320174, 'loss_val': 0.4295791154633645, 'psi': 0.6831186011433134}-{'f1_val': 0.7051106015974221, 'auprc': 0.8816825337981804, 'loss_val': 0.32292646781415146, 'psi': 0.7757393744777255}
[S3] START round=28 head_norm_before_train=1.712796 cos_to_last_merge=0.9277 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.928
[S3] round=28 local utility u=0.000000 metrics={'f1_val': 0.9449665374384939, 'auprc': 0.9892768799266005, 'loss_val': 0.19416384057225472, 'psi': 0.9626906744337366}-{'f1_val': 0.9960564077792481, 'auprc': 0.9985095556043978, 'loss_val': 0.03503759967203702, 'psi': 0.997037666909308}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=28 head_norm_before_train=1.615330 cos_to_last_merge=0.8167 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.817
[S4] round=28 local utility u=0.000000 metrics={'f1_val': 0.9509809550762318, 'auprc': 0.9705649293985739, 'loss_val': 0.2628529081059556, 'psi': 0.9588145448051686}-{'f1_val': 0.9527388985009935, 'auprc': 0.9752541544071505, 'loss_val': 0.2556410758708737, 'psi': 0.9617450008634563}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=28 head_norm_before_train=1.897560 (no previous merge yet)
[S5] round=28 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9959817619295184, 'loss_val': 0.035197683369070025, 'psi': 0.9961043187573939}-{'f1_val': 0.9963325909888239, 'auprc': 0.9974782162803254, 'loss_val': 0.03560405607527882, 'psi': 0.9967908411054245}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=28 head_norm_before_train=1.484872 cos_to_last_merge=0.9330 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.933
[S6] round=28 local utility u=1.000000 metrics={'f1_val': 0.8455453008291655, 'auprc': 0.9756602458241408, 'loss_val': 0.2737015661454888, 'psi': 0.8975912788271556}-{'f1_val': 0.4414292526334173, 'auprc': 0.7812125325584889, 'loss_val': 0.9597258740112318, 'psi': 0.577342564603446}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=28 head_norm_before_train=1.669355 cos_to_last_merge=0.9956 (last merge round=17)
[S7] round=28 local utility u=0.000000 metrics={'f1_val': 0.49470856060094404, 'auprc': 0.7818711021290893, 'loss_val': 0.951806116536519, 'psi': 0.6095735772122022}-{'f1_val': 0.5667097753957746, 'auprc': 0.7852928936951903, 'loss_val': 0.7321793459998995, 'psi': 0.6541430227155409}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=28 head_norm_before_train=1.403724 cos_to_last_merge=0.9995 (last merge round=26)
[S8] round=28 local utility u=0.923596 metrics={'f1_val': 0.9923167377520978, 'auprc': 0.9993089558920585, 'loss_val': 0.07515055388804084, 'psi': 0.9951136250080821}-{'f1_val': 0.7139758603458082, 'auprc': 0.9899102899808647, 'loss_val': 0.22410156967993922, 'psi': 0.8243496321998308}
[S9] START round=28 head_norm_before_train=1.753440 cos_to_last_merge=0.9847 (last merge round=13)
[S9] round=28 local utility u=0.020060 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9984055727366903, 'loss_val': 0.020621502691388467, 'psi': 0.997358536183011}-{'f1_val': 0.9916448056378947, 'auprc': 0.9986317399279623, 'loss_val': 0.03132537034865548, 'psi': 0.9944395793539217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=28 head_norm_before_train=1.311229 cos_to_last_merge=0.9984 (last merge round=25)
[S10] round=28 local utility u=0.004604 metrics={'f1_val': 0.9956096535150197, 'auprc': 0.9964015925879759, 'loss_val': 0.0867582171074202, 'psi': 0.9959264291442023}-{'f1_val': 0.9956096535150197, 'auprc': 0.996540242904683, 'loss_val': 0.0963816281795044, 'psi': 0.9959818892708852}
[S11] START round=28 head_norm_before_train=1.583496 cos_to_last_merge=1.0000 (last merge round=27)
[S11] round=28 local utility u=0.007291 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9930920935761032, 'loss_val': 0.06264368185078008, 'psi': 0.995165040138595}-{'f1_val': 0.9965470045135896, 'auprc': 0.9916806917900626, 'loss_val': 0.0729920326216933, 'psi': 0.9946004794241787}
[S13] START round=28 head_norm_before_train=1.271198 cos_to_last_merge=1.0000 (last merge round=27)
[S13] round=28 local utility u=0.140348 metrics={'f1_val': 0.5588573034385796, 'auprc': 0.6825099393409673, 'loss_val': 0.745012681090511, 'psi': 0.6083183577995347}-{'f1_val': 0.5308615302022449, 'auprc': 0.6952057172578648, 'loss_val': 0.8958221740134354, 'psi': 0.5965992050244928}
[S14] START round=28 head_norm_before_train=1.448472 cos_to_last_merge=0.8825 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.882
[S14] round=28 local utility u=0.000000 metrics={'f1_val': 0.9773436860566118, 'auprc': 0.9966444692113249, 'loss_val': 0.09111414317748481, 'psi': 0.9850639993184971}-{'f1_val': 0.9976538428159559, 'auprc': 0.9987951026865527, 'loss_val': 0.07614376852338227, 'psi': 0.9981103467641946}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=28 head_norm_before_train=1.515592 cos_to_last_merge=0.9681 (last merge round=19)
[S15] round=28 local utility u=0.000000 metrics={'f1_val': 0.7838590242710247, 'auprc': 0.9465559631987945, 'loss_val': 0.34581224986280323, 'psi': 0.8489377998421327}-{'f1_val': 0.8795301208486748, 'auprc': 0.974564830820652, 'loss_val': 0.19614750249340618, 'psi': 0.9175440048374657}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=28 head_norm_before_train=1.847864 (no previous merge yet)
[S16] round=28 local utility u=0.000000 metrics={'f1_val': 0.9179551435188276, 'auprc': 0.9358512650713778, 'loss_val': 0.4361899631109391, 'psi': 0.9251135921398477}-{'f1_val': 0.9919670027399721, 'auprc': 0.9963441799711786, 'loss_val': 0.044453381159236346, 'psi': 0.9937178736324547}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=28 head_norm_before_train=1.392059 cos_to_last_merge=0.9991 (last merge round=26)
[S17] round=28 local utility u=0.000000 metrics={'f1_val': 0.628244604180844, 'auprc': 0.7868975409589214, 'loss_val': 0.9934662279463901, 'psi': 0.691705778892075}-{'f1_val': 0.6428783474469157, 'auprc': 0.8468347423421101, 'loss_val': 0.770807566588166, 'psi': 0.7244609054049935}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9968
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9940
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9968
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=28 metric=0.5589 head_norm=1.285811
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.079939e-02
[S13] stored merged vector for next round verification (round=28)
[S13] DEBUG after merge:  round=28 metric=0.5635 head_norm=1.305303 delta_norm=0.050799
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=28 metric=0.9956 head_norm=1.341838
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.979905e-02
[S10] stored merged vector for next round verification (round=28)
[S10] DEBUG after merge:  round=28 metric=0.9956 head_norm=1.312762 delta_norm=0.059799
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=29 head_norm_before_train=1.592691 cos_to_last_merge=1.0000 (last merge round=27)
[S2] round=29 local utility u=0.452677 metrics={'f1_val': 0.7086480945617759, 'auprc': 0.8724794852465221, 'loss_val': 0.3042053008792389, 'psi': 0.7741806508356743}-{'f1_val': 0.6439713978175107, 'auprc': 0.7418394061320174, 'loss_val': 0.4295791154633645, 'psi': 0.6831186011433134}
[S3] START round=29 head_norm_before_train=1.731838 cos_to_last_merge=0.9258 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.926
[S3] round=29 local utility u=0.086605 metrics={'f1_val': 0.9533268497841626, 'auprc': 0.9979513383430878, 'loss_val': 0.09713997715313384, 'psi': 0.9711766452077326}-{'f1_val': 0.9449665374384939, 'auprc': 0.9892768799266005, 'loss_val': 0.19416384057225472, 'psi': 0.9626906744337366}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=29 head_norm_before_train=1.627311 cos_to_last_merge=0.8150 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.815
[S4] round=29 local utility u=0.000000 metrics={'f1_val': 0.9442015967692695, 'auprc': 0.9578409397799524, 'loss_val': 0.2730157489531918, 'psi': 0.9496573339735427}-{'f1_val': 0.9509809550762318, 'auprc': 0.9705649293985739, 'loss_val': 0.2628529081059556, 'psi': 0.9588145448051686}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=29 head_norm_before_train=1.912147 (no previous merge yet)
[S5] round=29 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9949933349466755, 'loss_val': 0.03436631204175706, 'psi': 0.9957089479642568}-{'f1_val': 0.996186023309311, 'auprc': 0.9959817619295184, 'loss_val': 0.035197683369070025, 'psi': 0.9961043187573939}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=29 head_norm_before_train=1.499785 cos_to_last_merge=0.9314 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.931
[S6] round=29 local utility u=0.000000 metrics={'f1_val': 0.6742553312888812, 'auprc': 0.9473450483477758, 'loss_val': 0.6809047556559938, 'psi': 0.7834912181124389}-{'f1_val': 0.8455453008291655, 'auprc': 0.9756602458241408, 'loss_val': 0.2737015661454888, 'psi': 0.8975912788271556}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=29 head_norm_before_train=1.683670 cos_to_last_merge=0.9948 (last merge round=17)
[S7] round=29 local utility u=0.730951 metrics={'f1_val': 0.6548833753095075, 'auprc': 0.815960394812059, 'loss_val': 0.5532216696717865, 'psi': 0.7193141831105281}-{'f1_val': 0.49470856060094404, 'auprc': 0.7818711021290893, 'loss_val': 0.951806116536519, 'psi': 0.6095735772122022}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=29 head_norm_before_train=1.445064 cos_to_last_merge=0.9984 (last merge round=26)
[S8] round=29 local utility u=0.000000 metrics={'f1_val': 0.9871538275294434, 'auprc': 0.9993275764806984, 'loss_val': 0.0749747541334137, 'psi': 0.9920233271099455}-{'f1_val': 0.9923167377520978, 'auprc': 0.9993089558920585, 'loss_val': 0.07515055388804084, 'psi': 0.9951136250080821}
[S9] START round=29 head_norm_before_train=1.766988 cos_to_last_merge=0.9842 (last merge round=13)
[S9] round=29 local utility u=0.000474 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9983614612240657, 'loss_val': 0.019540176290709324, 'psi': 0.9973408915779611}-{'f1_val': 0.9966605118138915, 'auprc': 0.9984055727366903, 'loss_val': 0.020621502691388467, 'psi': 0.997358536183011}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=29 head_norm_before_train=1.312762 cos_to_last_merge=1.0000 (last merge round=28)
[S10] round=29 local utility u=0.003416 metrics={'f1_val': 0.995804838087278, 'auprc': 0.9966166673798844, 'loss_val': 0.08174277249925628, 'psi': 0.9961295698043207}-{'f1_val': 0.9956096535150197, 'auprc': 0.9964015925879759, 'loss_val': 0.0867582171074202, 'psi': 0.9959264291442023}
[S11] START round=29 head_norm_before_train=1.613156 cos_to_last_merge=0.9998 (last merge round=27)
[S11] round=29 local utility u=0.005811 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.993708930579493, 'loss_val': 0.054321762431994214, 'psi': 0.9955568021374159}-{'f1_val': 0.9965470045135896, 'auprc': 0.9930920935761032, 'loss_val': 0.06264368185078008, 'psi': 0.995165040138595}
[S13] START round=29 head_norm_before_train=1.305303 cos_to_last_merge=1.0000 (last merge round=28)
[S13] round=29 local utility u=0.000000 metrics={'f1_val': 0.5489063201346738, 'auprc': 0.6965239859138062, 'loss_val': 0.9022682928566786, 'psi': 0.6079533864463267}-{'f1_val': 0.5588573034385796, 'auprc': 0.6825099393409673, 'loss_val': 0.745012681090511, 'psi': 0.6083183577995347}
[S14] START round=29 head_norm_before_train=1.472150 cos_to_last_merge=0.8795 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.880
[S14] round=29 local utility u=0.077149 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9986785260563265, 'loss_val': 0.062298840216476574, 'psi': 0.9978156244460064}-{'f1_val': 0.9773436860566118, 'auprc': 0.9966444692113249, 'loss_val': 0.09111414317748481, 'psi': 0.9850639993184971}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S14] sending update (kind=head size=1798 to 1 peers)
[S15] START round=29 head_norm_before_train=1.541538 cos_to_last_merge=0.9654 (last merge round=19)
[S15] round=29 local utility u=0.000000 metrics={'f1_val': 0.701633366343195, 'auprc': 0.9165281873052645, 'loss_val': 0.433305171654009, 'psi': 0.7875912947280228}-{'f1_val': 0.7838590242710247, 'auprc': 0.9465559631987945, 'loss_val': 0.34581224986280323, 'psi': 0.8489377998421327}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=29 head_norm_before_train=1.860667 (no previous merge yet)
[S16] round=29 local utility u=0.111682 metrics={'f1_val': 0.9256793309810103, 'auprc': 0.9793330732931849, 'loss_val': 0.38961671830682937, 'psi': 0.9471408279058801}-{'f1_val': 0.9179551435188276, 'auprc': 0.9358512650713778, 'loss_val': 0.4361899631109391, 'psi': 0.9251135921398477}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=29 head_norm_before_train=1.432436 cos_to_last_merge=0.9971 (last merge round=26)
[S17] round=29 local utility u=0.000000 metrics={'f1_val': 0.627239048120503, 'auprc': 0.772634725903047, 'loss_val': 1.0838970935018906, 'psi': 0.6853973192335207}-{'f1_val': 0.628244604180844, 'auprc': 0.7868975409589214, 'loss_val': 0.9934662279463901, 'psi': 0.691705778892075}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S2] → sending delta(kind=head bytes=1798) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1798 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=29 metric=0.6272 head_norm=1.473656
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.006801e-01
[S17] stored merged vector for next round verification (round=29)
[S17] DEBUG after merge:  round=29 metric=0.6267 head_norm=1.455953 delta_norm=0.100680
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1798) from S2
[S11] cosine check vs S2: cos=0.9992
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.9992
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9994
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=29 metric=0.7086 head_norm=1.601852
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.885932e-02
[S2] stored merged vector for next round verification (round=29)
[S2] DEBUG after merge:  round=29 metric=0.7086 head_norm=1.614222 delta_norm=0.028859
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=29 metric=0.9968 head_norm=1.641010
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.816416e-02
[S11] stored merged vector for next round verification (round=29)
[S11] DEBUG after merge:  round=29 metric=0.9968 head_norm=1.621100 delta_norm=0.038164
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=30 head_norm_before_train=1.614222 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=30 local utility u=0.000000 metrics={'f1_val': 0.7079224053853089, 'auprc': 0.8413178730052671, 'loss_val': 0.3103908212539834, 'psi': 0.7612805924332922}-{'f1_val': 0.7086480945617759, 'auprc': 0.8724794852465221, 'loss_val': 0.3042053008792389, 'psi': 0.7741806508356743}
[S3] START round=30 head_norm_before_train=1.751231 cos_to_last_merge=0.9240 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.924
[S3] round=30 local utility u=0.000000 metrics={'f1_val': 0.8431646373610806, 'auprc': 0.9961595686656317, 'loss_val': 0.3061243653572032, 'psi': 0.904362609882901}-{'f1_val': 0.9533268497841626, 'auprc': 0.9979513383430878, 'loss_val': 0.09713997715313384, 'psi': 0.9711766452077326}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=30 head_norm_before_train=1.635943 cos_to_last_merge=0.8143 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=30 local utility u=0.000000 metrics={'f1_val': 0.9385172521700401, 'auprc': 0.9443104849422662, 'loss_val': 0.2826945340019288, 'psi': 0.9408345452789305}-{'f1_val': 0.9442015967692695, 'auprc': 0.9578409397799524, 'loss_val': 0.2730157489531918, 'psi': 0.9496573339735427}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=30 head_norm_before_train=1.921915 (no previous merge yet)
[S5] round=30 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9911894021534637, 'loss_val': 0.0379219269876132, 'psi': 0.9941873748469721}-{'f1_val': 0.996186023309311, 'auprc': 0.9949933349466755, 'loss_val': 0.03436631204175706, 'psi': 0.9957089479642568}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=30 head_norm_before_train=1.511154 cos_to_last_merge=0.9299 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.930
[S6] round=30 local utility u=0.000000 metrics={'f1_val': 0.5879461397748148, 'auprc': 0.7891444971201939, 'loss_val': 0.7465387946479375, 'psi': 0.6684254827129664}-{'f1_val': 0.6742553312888812, 'auprc': 0.9473450483477758, 'loss_val': 0.6809047556559938, 'psi': 0.7834912181124389}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=30 head_norm_before_train=1.697858 cos_to_last_merge=0.9942 (last merge round=17)
[S7] round=30 local utility u=0.000000 metrics={'f1_val': 0.6073083915677728, 'auprc': 0.7953322304923842, 'loss_val': 0.6055806094642967, 'psi': 0.6825179271376174}-{'f1_val': 0.6548833753095075, 'auprc': 0.815960394812059, 'loss_val': 0.5532216696717865, 'psi': 0.7193141831105281}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=30 head_norm_before_train=1.480339 cos_to_last_merge=0.9972 (last merge round=26)
[S8] round=30 local utility u=0.006853 metrics={'f1_val': 0.9937111453033, 'auprc': 0.9886771912379142, 'loss_val': 0.06866086108802336, 'psi': 0.9916975636771457}-{'f1_val': 0.9871538275294434, 'auprc': 0.9993275764806984, 'loss_val': 0.0749747541334137, 'psi': 0.9920233271099455}
[S9] START round=30 head_norm_before_train=1.782635 cos_to_last_merge=0.9836 (last merge round=13)
[S9] round=30 local utility u=0.000000 metrics={'f1_val': 0.9916448056378947, 'auprc': 0.9983459248569653, 'loss_val': 0.02856832576702291, 'psi': 0.9943252533255229}-{'f1_val': 0.9966605118138915, 'auprc': 0.9983614612240657, 'loss_val': 0.019540176290709324, 'psi': 0.9973408915779611}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=30 head_norm_before_train=1.343024 cos_to_last_merge=0.9998 (last merge round=28)
[S10] round=30 local utility u=0.003517 metrics={'f1_val': 0.9949681865317428, 'auprc': 0.9964678322600031, 'loss_val': 0.06924231422840588, 'psi': 0.995568044823047}-{'f1_val': 0.995804838087278, 'auprc': 0.9966166673798844, 'loss_val': 0.08174277249925628, 'psi': 0.9961295698043207}
[S11] START round=30 head_norm_before_train=1.621100 cos_to_last_merge=1.0000 (last merge round=29)
[S11] round=30 local utility u=0.000510 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9936422354978209, 'loss_val': 0.051652399534820904, 'psi': 0.9953850969072822}-{'f1_val': 0.9967887165093644, 'auprc': 0.993708930579493, 'loss_val': 0.054321762431994214, 'psi': 0.9955568021374159}
[S13] START round=30 head_norm_before_train=1.322400 cos_to_last_merge=0.9998 (last merge round=28)
[S13] round=30 local utility u=0.108988 metrics={'f1_val': 0.5630762186808478, 'auprc': 0.6887938564752758, 'loss_val': 0.7461215573554135, 'psi': 0.613363273798619}-{'f1_val': 0.5489063201346738, 'auprc': 0.6965239859138062, 'loss_val': 0.9022682928566786, 'psi': 0.6079533864463267}
[S14] START round=30 head_norm_before_train=1.496902 cos_to_last_merge=0.8762 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.876
[S14] round=30 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9969387593533456, 'loss_val': 0.05641139337057216, 'psi': 0.9969740086359373}-{'f1_val': 0.997240356705793, 'auprc': 0.9986785260563265, 'loss_val': 0.062298840216476574, 'psi': 0.9978156244460064}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=30 head_norm_before_train=1.566932 cos_to_last_merge=0.9628 (last merge round=19)
[S15] round=30 local utility u=0.424894 metrics={'f1_val': 0.8078315077792135, 'auprc': 0.9531210144876071, 'loss_val': 0.33048472880068885, 'psi': 0.865947310462571}-{'f1_val': 0.701633366343195, 'auprc': 0.9165281873052645, 'loss_val': 0.433305171654009, 'psi': 0.7875912947280228}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=30 head_norm_before_train=1.874750 (no previous merge yet)
[S16] round=30 local utility u=0.406140 metrics={'f1_val': 0.9932795465483896, 'auprc': 0.99743229683814, 'loss_val': 0.03723655823452245, 'psi': 0.9949406466642898}-{'f1_val': 0.9256793309810103, 'auprc': 0.9793330732931849, 'loss_val': 0.38961671830682937, 'psi': 0.9471408279058801}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=30 head_norm_before_train=1.455953 cos_to_last_merge=1.0000 (last merge round=29)
[S17] round=30 local utility u=0.409958 metrics={'f1_val': 0.6674003031597843, 'auprc': 0.8251228000537632, 'loss_val': 0.6624138014280002, 'psi': 0.7304893019173758}-{'f1_val': 0.627239048120503, 'auprc': 0.772634725903047, 'loss_val': 1.0838970935018906, 'psi': 0.6853973192335207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[S2] ⇄ pheromone p=0.134 → S11@127.0.0.1:54512
[S11] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9979
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9997
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9932
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=0.9979
[S11] ⇄ pheromone p=0.024 → S2@127.0.0.1:54502
[S8] ⇄ pheromone p=0.196 → S17@127.0.0.1:54517
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=30 metric=0.9950 head_norm=1.373047
[S10] _apply_head_vector_avg (torch): Δ‖w‖=4.709397e-02
[S10] stored merged vector for next round verification (round=30)
[S10] DEBUG after merge:  round=30 metric=0.9950 head_norm=1.354656 delta_norm=0.047094
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.036 → S13@127.0.0.1:54513
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=30 metric=0.5631 head_norm=1.337670
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.947282e-02
[S13] stored merged vector for next round verification (round=30)
[S13] DEBUG after merge:  round=30 metric=0.5674 head_norm=1.347275 delta_norm=0.039473
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.095 → S10@127.0.0.1:54511
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9932
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=30 metric=0.6674 head_norm=1.489645
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.765738e-02
[S17] stored merged vector for next round verification (round=30)
[S17] DEBUG after merge:  round=30 metric=0.6674 head_norm=1.496376 delta_norm=0.087657
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.141 → S8@127.0.0.1:54509
[S2] START round=31 head_norm_before_train=1.623348 cos_to_last_merge=1.0000 (last merge round=29)
[S2] round=31 local utility u=0.000000 metrics={'f1_val': 0.6931978241793985, 'auprc': 0.8124950545119518, 'loss_val': 0.40647381432926, 'psi': 0.7409167163124198}-{'f1_val': 0.7079224053853089, 'auprc': 0.8413178730052671, 'loss_val': 0.3103908212539834, 'psi': 0.7612805924332922}
[S3] START round=31 head_norm_before_train=1.765674 cos_to_last_merge=0.9224 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.922
[S3] round=31 local utility u=0.408824 metrics={'f1_val': 0.954687928891994, 'auprc': 0.9989674951233866, 'loss_val': 0.16603913126489842, 'psi': 0.9723997553845511}-{'f1_val': 0.8431646373610806, 'auprc': 0.9961595686656317, 'loss_val': 0.3061243653572032, 'psi': 0.904362609882901}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=31 head_norm_before_train=1.641178 cos_to_last_merge=0.8142 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=31 local utility u=0.106811 metrics={'f1_val': 0.953150387793672, 'auprc': 0.9777503825862944, 'loss_val': 0.25719189022025984, 'psi': 0.9629903857107209}-{'f1_val': 0.9385172521700401, 'auprc': 0.9443104849422662, 'loss_val': 0.2826945340019288, 'psi': 0.9408345452789305}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S4] sending update (kind=head size=1795 to 1 peers)
[S5] START round=31 head_norm_before_train=1.930258 (no previous merge yet)
[S5] round=31 local utility u=0.000000 metrics={'f1_val': 0.701112002430894, 'auprc': 0.9821042053292224, 'loss_val': 0.35512371901815953, 'psi': 0.8135088835902253}-{'f1_val': 0.996186023309311, 'auprc': 0.9911894021534637, 'loss_val': 0.0379219269876132, 'psi': 0.9941873748469721}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=31 head_norm_before_train=1.518792 cos_to_last_merge=0.9286 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.929
[S6] round=31 local utility u=1.000000 metrics={'f1_val': 0.8350425144872886, 'auprc': 0.961827085596706, 'loss_val': 0.32012141372713804, 'psi': 0.8857563429310555}-{'f1_val': 0.5879461397748148, 'auprc': 0.7891444971201939, 'loss_val': 0.7465387946479375, 'psi': 0.6684254827129664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S6] sending update (kind=head size=1793 to 1 peers)
[S7] START round=31 head_norm_before_train=1.702068 cos_to_last_merge=0.9938 (last merge round=17)
[S7] round=31 local utility u=0.000000 metrics={'f1_val': 0.4780169965451644, 'auprc': 0.7805183008497008, 'loss_val': 1.0503996331414902, 'psi': 0.5990175182669789}-{'f1_val': 0.6073083915677728, 'auprc': 0.7953322304923842, 'loss_val': 0.6055806094642967, 'psi': 0.6825179271376174}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=31 head_norm_before_train=1.508180 cos_to_last_merge=0.9960 (last merge round=26)
[S8] round=31 local utility u=0.018387 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9992926965389061, 'loss_val': 0.05623435475080773, 'psi': 0.9951937854319395}-{'f1_val': 0.9937111453033, 'auprc': 0.9886771912379142, 'loss_val': 0.06866086108802336, 'psi': 0.9916975636771457}
[S9] START round=31 head_norm_before_train=1.797221 cos_to_last_merge=0.9829 (last merge round=13)
[S9] round=31 local utility u=0.010892 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9936425414495396, 'loss_val': 0.020305336920934905, 'psi': 0.9952070734473824}-{'f1_val': 0.9916448056378947, 'auprc': 0.9983459248569653, 'loss_val': 0.02856832576702291, 'psi': 0.9943252533255229}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=31 head_norm_before_train=1.354656 cos_to_last_merge=1.0000 (last merge round=30)
[S10] round=31 local utility u=0.001252 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960321709425352, 'loss_val': 0.06675001367355739, 'psi': 0.9955255717886389}-{'f1_val': 0.9949681865317428, 'auprc': 0.9964678322600031, 'loss_val': 0.06924231422840588, 'psi': 0.995568044823047}
[S11] START round=31 head_norm_before_train=1.646198 cos_to_last_merge=0.9998 (last merge round=29)
[S11] round=31 local utility u=0.002689 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9936794509036293, 'loss_val': 0.04638642656567883, 'psi': 0.9953999830696054}-{'f1_val': 0.9965470045135896, 'auprc': 0.9936422354978209, 'loss_val': 0.051652399534820904, 'psi': 0.9953850969072822}
[S13] START round=31 head_norm_before_train=1.347275 cos_to_last_merge=1.0000 (last merge round=30)
[S13] round=31 local utility u=0.000000 metrics={'f1_val': 0.5550415557727123, 'auprc': 0.7029807635921158, 'loss_val': 0.8423750886037045, 'psi': 0.6142172389004736}-{'f1_val': 0.5630762186808478, 'auprc': 0.6887938564752758, 'loss_val': 0.7461215573554135, 'psi': 0.613363273798619}
[S14] START round=31 head_norm_before_train=1.520668 cos_to_last_merge=0.8732 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.873
[S14] round=31 local utility u=0.001792 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970248524169112, 'loss_val': 0.05555116574675237, 'psi': 0.9972549026677998}-{'f1_val': 0.9969975081576651, 'auprc': 0.9969387593533456, 'loss_val': 0.05641139337057216, 'psi': 0.9969740086359373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=31 head_norm_before_train=1.588538 cos_to_last_merge=0.9607 (last merge round=19)
[S15] round=31 local utility u=0.000000 metrics={'f1_val': 0.7009169771696235, 'auprc': 0.9097452126990888, 'loss_val': 0.47264686660049954, 'psi': 0.7844482713814096}-{'f1_val': 0.8078315077792135, 'auprc': 0.9531210144876071, 'loss_val': 0.33048472880068885, 'psi': 0.865947310462571}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=31 head_norm_before_train=1.889482 (no previous merge yet)
[S16] round=31 local utility u=0.000499 metrics={'f1_val': 0.9932593872616958, 'auprc': 0.9977499389852498, 'loss_val': 0.03707046081296128, 'psi': 0.9950556079511174}-{'f1_val': 0.9932795465483896, 'auprc': 0.99743229683814, 'loss_val': 0.03723655823452245, 'psi': 0.9949406466642898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=31 head_norm_before_train=1.496376 cos_to_last_merge=1.0000 (last merge round=30)
[S17] round=31 local utility u=0.000000 metrics={'f1_val': 0.6657540271381774, 'auprc': 0.8153109487448091, 'loss_val': 0.6868326946433781, 'psi': 0.7255767957808301}-{'f1_val': 0.6674003031597843, 'auprc': 0.8251228000537632, 'loss_val': 0.6624138014280002, 'psi': 0.7304893019173758}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S10] → sending delta(kind=head bytes=1793) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=31 metric=0.6932 head_norm=1.632310
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.242761e-02
[S2] stored merged vector for next round verification (round=31)
[S2] DEBUG after merge:  round=31 metric=0.6990 head_norm=1.639116 delta_norm=0.022428
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1793 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9961
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1793) from S10
[S13] cosine check vs S10: cos=0.9995
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=31 metric=0.9925 head_norm=1.536489
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.812945e-02
[S8] stored merged vector for next round verification (round=31)
[S8] DEBUG after merge:  round=31 metric=0.9925 head_norm=1.510063 delta_norm=0.098129
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=32 head_norm_before_train=1.639116 cos_to_last_merge=1.0000 (last merge round=31)
[S2] round=32 local utility u=0.190088 metrics={'f1_val': 0.7081038088231788, 'auprc': 0.8909516054364544, 'loss_val': 0.35110345430880346, 'psi': 0.7812429274684891}-{'f1_val': 0.6931978241793985, 'auprc': 0.8124950545119518, 'loss_val': 0.40647381432926, 'psi': 0.7409167163124198}
[S3] START round=32 head_norm_before_train=1.776174 cos_to_last_merge=0.9213 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.921
[S3] round=32 local utility u=0.002748 metrics={'f1_val': 0.946580265907782, 'auprc': 0.9963908357146956, 'loss_val': 0.10416622001833357, 'psi': 0.9665044938305474}-{'f1_val': 0.954687928891994, 'auprc': 0.9989674951233866, 'loss_val': 0.16603913126489842, 'psi': 0.9723997553845511}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=32 head_norm_before_train=1.645829 cos_to_last_merge=0.8138 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.814
[S4] round=32 local utility u=0.000000 metrics={'f1_val': 0.9532558718775088, 'auprc': 0.9594190242353404, 'loss_val': 0.26582923373071393, 'psi': 0.9557211328206414}-{'f1_val': 0.953150387793672, 'auprc': 0.9777503825862944, 'loss_val': 0.25719189022025984, 'psi': 0.9629903857107209}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=32 head_norm_before_train=1.934542 (no previous merge yet)
[S5] round=32 local utility u=1.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9974950860316042, 'loss_val': 0.03294168143969698, 'psi': 0.9967096483982283}-{'f1_val': 0.701112002430894, 'auprc': 0.9821042053292224, 'loss_val': 0.35512371901815953, 'psi': 0.8135088835902253}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=32 head_norm_before_train=1.526839 cos_to_last_merge=0.9272 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.927
[S6] round=32 local utility u=0.000000 metrics={'f1_val': 0.8217747862527681, 'auprc': 0.9620397512672736, 'loss_val': 0.47635389978881004, 'psi': 0.8778807722585703}-{'f1_val': 0.8350425144872886, 'auprc': 0.961827085596706, 'loss_val': 0.32012141372713804, 'psi': 0.8857563429310555}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=32 head_norm_before_train=1.707641 cos_to_last_merge=0.9935 (last merge round=17)
[S7] round=32 local utility u=0.956354 metrics={'f1_val': 0.6742853840412357, 'auprc': 0.8321950400144296, 'loss_val': 0.4703326181547462, 'psi': 0.7374492464305132}-{'f1_val': 0.4780169965451644, 'auprc': 0.7805183008497008, 'loss_val': 1.0503996331414902, 'psi': 0.5990175182669789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S7] sending update (kind=head size=1797 to 1 peers)
[S8] START round=32 head_norm_before_train=1.510063 cos_to_last_merge=1.0000 (last merge round=31)
[S8] round=32 local utility u=0.000916 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9991697141399326, 'loss_val': 0.05707438914311139, 'psi': 0.9954486654778982}-{'f1_val': 0.9924611780272952, 'auprc': 0.9992926965389061, 'loss_val': 0.05623435475080773, 'psi': 0.9951937854319395}
[S9] START round=32 head_norm_before_train=1.808480 cos_to_last_merge=0.9823 (last merge round=13)
[S9] round=32 local utility u=0.001494 metrics={'f1_val': 0.9943271883459407, 'auprc': 0.9989717072215303, 'loss_val': 0.021767357754014584, 'psi': 0.9961849958961766}-{'f1_val': 0.9962500947792776, 'auprc': 0.9936425414495396, 'loss_val': 0.020305336920934905, 'psi': 0.9952070734473824}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=32 head_norm_before_train=1.384749 cos_to_last_merge=0.9998 (last merge round=30)
[S10] round=32 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948778613088252, 'loss_val': 0.06508235192251957, 'psi': 0.9950638479351549}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960321709425352, 'loss_val': 0.06675001367355739, 'psi': 0.9955255717886389}
[S11] START round=32 head_norm_before_train=1.672007 cos_to_last_merge=0.9994 (last merge round=29)
[S11] round=32 local utility u=0.001562 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9935079201765981, 'loss_val': 0.04419793415341666, 'psi': 0.9954763979762579}-{'f1_val': 0.9965470045135896, 'auprc': 0.9936794509036293, 'loss_val': 0.04638642656567883, 'psi': 0.9953999830696054}
[S13] START round=32 head_norm_before_train=1.364190 cos_to_last_merge=0.9999 (last merge round=30)
[S13] round=32 local utility u=0.038681 metrics={'f1_val': 0.5654682712586199, 'auprc': 0.7005972535442792, 'loss_val': 0.8204226691046422, 'psi': 0.6195198641728836}-{'f1_val': 0.5550415557727123, 'auprc': 0.7029807635921158, 'loss_val': 0.8423750886037045, 'psi': 0.6142172389004736}
[S14] START round=32 head_norm_before_train=1.542386 cos_to_last_merge=0.8706 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.871
[S14] round=32 local utility u=0.005645 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9991602095406638, 'loss_val': 0.04820169157480121, 'psi': 0.9978625887108645}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970248524169112, 'loss_val': 0.05555116574675237, 'psi': 0.9972549026677998}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S14] sending update (kind=head size=1795 to 1 peers)
[S15] START round=32 head_norm_before_train=1.605915 cos_to_last_merge=0.9589 (last merge round=19)
[S15] round=32 local utility u=0.862970 metrics={'f1_val': 0.9043148223077657, 'auprc': 0.9743838919486969, 'loss_val': 0.16101040831583963, 'psi': 0.9323424501641382}-{'f1_val': 0.7009169771696235, 'auprc': 0.9097452126990888, 'loss_val': 0.47264686660049954, 'psi': 0.7844482713814096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=32 head_norm_before_train=1.900707 (no previous merge yet)
[S16] round=32 local utility u=0.000000 metrics={'f1_val': 0.9499328618167953, 'auprc': 0.9895149951132054, 'loss_val': 0.1444995009207543, 'psi': 0.9657657151353592}-{'f1_val': 0.9932593872616958, 'auprc': 0.9977499389852498, 'loss_val': 0.03707046081296128, 'psi': 0.9950556079511174}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=32 head_norm_before_train=1.525594 cos_to_last_merge=0.9997 (last merge round=30)
[S17] round=32 local utility u=0.000000 metrics={'f1_val': 0.6653154884637869, 'auprc': 0.723614785765565, 'loss_val': 0.7293316412357492, 'psi': 0.6886352073844981}-{'f1_val': 0.6657540271381774, 'auprc': 0.8153109487448091, 'loss_val': 0.6868326946433781, 'psi': 0.7255767957808301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S13] → sending delta(kind=head bytes=1795) to S10@127.0.0.1:54511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S8] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1795 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=32 metric=0.6653 head_norm=1.551796
[S17] _apply_head_vector_avg (torch): Δ‖w‖=8.358115e-02
[S17] stored merged vector for next round verification (round=32)
[S17] DEBUG after merge:  round=32 metric=0.6653 head_norm=1.541898 delta_norm=0.083581
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9990
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9990
[S10] RECEIVED delta(kind=head bytes=1795) from S13
[S10] cosine check vs S13: cos=0.9983
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=32 metric=0.9968 head_norm=1.695540
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.312054e-02
[S11] stored merged vector for next round verification (round=32)
[S11] DEBUG after merge:  round=32 metric=0.9968 head_norm=1.673431 delta_norm=0.043121
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=32 metric=0.7081 head_norm=1.652151
[S2] _apply_head_vector_avg (torch): Δ‖w‖=3.583698e-02
[S2] stored merged vector for next round verification (round=32)
[S2] DEBUG after merge:  round=32 metric=0.7081 head_norm=1.667631 delta_norm=0.035837
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=32 metric=0.5655 head_norm=1.379596
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.039718e-02
[S13] stored merged vector for next round verification (round=32)
[S13] DEBUG after merge:  round=32 metric=0.5609 head_norm=1.381841 delta_norm=0.030397
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=33 head_norm_before_train=1.667631 cos_to_last_merge=1.0000 (last merge round=32)
[S2] round=33 local utility u=0.003205 metrics={'f1_val': 0.7103123590592251, 'auprc': 0.8815888457678214, 'loss_val': 0.3298555712221359, 'psi': 0.7788229537426636}-{'f1_val': 0.7081038088231788, 'auprc': 0.8909516054364544, 'loss_val': 0.35110345430880346, 'psi': 0.7812429274684891}
[S3] START round=33 head_norm_before_train=1.787631 cos_to_last_merge=0.9199 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.920
[S3] round=33 local utility u=0.000000 metrics={'f1_val': 0.8595578751142705, 'auprc': 0.9967959339276045, 'loss_val': 0.28635139854918956, 'psi': 0.9144530986396041}-{'f1_val': 0.946580265907782, 'auprc': 0.9963908357146956, 'loss_val': 0.10416622001833357, 'psi': 0.9665044938305474}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=33 head_norm_before_train=1.650987 cos_to_last_merge=0.8133 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=33 local utility u=0.000000 metrics={'f1_val': 0.9422804141701234, 'auprc': 0.9559870070567675, 'loss_val': 0.2723386114726905, 'psi': 0.947763051324781}-{'f1_val': 0.9532558718775088, 'auprc': 0.9594190242353404, 'loss_val': 0.26582923373071393, 'psi': 0.9557211328206414}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=33 head_norm_before_train=1.934522 (no previous merge yet)
[S5] round=33 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9907151364487853, 'loss_val': 0.055383700626394326, 'psi': 0.9939101841183465}-{'f1_val': 0.996186023309311, 'auprc': 0.9974950860316042, 'loss_val': 0.03294168143969698, 'psi': 0.9967096483982283}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=33 head_norm_before_train=1.538666 cos_to_last_merge=0.9252 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.925
[S6] round=33 local utility u=0.462556 metrics={'f1_val': 0.9361829657861075, 'auprc': 0.9692104935631384, 'loss_val': 0.2592033409348505, 'psi': 0.9493939768969198}-{'f1_val': 0.8217747862527681, 'auprc': 0.9620397512672736, 'loss_val': 0.47635389978881004, 'psi': 0.8778807722585703}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=33 head_norm_before_train=1.717758 cos_to_last_merge=0.9931 (last merge round=17)
[S7] round=33 local utility u=0.000000 metrics={'f1_val': 0.6482486564094669, 'auprc': 0.8089769039582763, 'loss_val': 0.45497367342724093, 'psi': 0.7125399554289906}-{'f1_val': 0.6742853840412357, 'auprc': 0.8321950400144296, 'loss_val': 0.4703326181547462, 'psi': 0.7374492464305132}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=33 head_norm_before_train=1.537902 cos_to_last_merge=0.9999 (last merge round=31)
[S8] round=33 local utility u=0.000000 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9894516714376976, 'loss_val': 0.05283765926207282, 'psi': 0.9920206989161479}-{'f1_val': 0.9929679663698754, 'auprc': 0.9991697141399326, 'loss_val': 0.05707438914311139, 'psi': 0.9954486654778982}
[S9] START round=33 head_norm_before_train=1.818527 cos_to_last_merge=0.9816 (last merge round=13)
[S9] round=33 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9926138786772879, 'loss_val': 0.01962025642166948, 'psi': 0.9950610462297724}-{'f1_val': 0.9943271883459407, 'auprc': 0.9989717072215303, 'loss_val': 0.021767357754014584, 'psi': 0.9961849958961766}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=33 head_norm_before_train=1.414673 cos_to_last_merge=0.9991 (last merge round=30)
[S10] round=33 local utility u=0.005478 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9953728805598125, 'loss_val': 0.055611307521000734, 'psi': 0.9952618556355499}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948778613088252, 'loss_val': 0.06508235192251957, 'psi': 0.9950638479351549}
[S11] START round=33 head_norm_before_train=1.673431 cos_to_last_merge=1.0000 (last merge round=32)
[S11] round=33 local utility u=0.000922 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9936305289907674, 'loss_val': 0.041271813729209635, 'psi': 0.9953804143044607}-{'f1_val': 0.9967887165093644, 'auprc': 0.9935079201765981, 'loss_val': 0.04419793415341666, 'psi': 0.9954763979762579}
[S13] START round=33 head_norm_before_train=1.381841 cos_to_last_merge=1.0000 (last merge round=32)
[S13] round=33 local utility u=0.141351 metrics={'f1_val': 0.5892023331314848, 'auprc': 0.6944028592709302, 'loss_val': 0.6615412453228301, 'psi': 0.631282543587263}-{'f1_val': 0.5654682712586199, 'auprc': 0.7005972535442792, 'loss_val': 0.8204226691046422, 'psi': 0.6195198641728836}
[S14] START round=33 head_norm_before_train=1.562685 cos_to_last_merge=0.8685 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.868
[S14] round=33 local utility u=0.001043 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9973378996912725, 'loss_val': 0.04457072891488261, 'psi': 0.9975258307064212}-{'f1_val': 0.9969975081576651, 'auprc': 0.9991602095406638, 'loss_val': 0.04820169157480121, 'psi': 0.9978625887108645}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=33 head_norm_before_train=1.617040 cos_to_last_merge=0.9579 (last merge round=19)
[S15] round=33 local utility u=0.000000 metrics={'f1_val': 0.7656671543525435, 'auprc': 0.8830883372946551, 'loss_val': 0.45906312145147166, 'psi': 0.8126356275293882}-{'f1_val': 0.9043148223077657, 'auprc': 0.9743838919486969, 'loss_val': 0.16101040831583963, 'psi': 0.9323424501641382}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=33 head_norm_before_train=1.912138 (no previous merge yet)
[S16] round=33 local utility u=0.000000 metrics={'f1_val': 0.9317282944078185, 'auprc': 0.9471971687069906, 'loss_val': 0.38130137833200645, 'psi': 0.9379158441274873}-{'f1_val': 0.9499328618167953, 'auprc': 0.9895149951132054, 'loss_val': 0.1444995009207543, 'psi': 0.9657657151353592}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=33 head_norm_before_train=1.541898 cos_to_last_merge=1.0000 (last merge round=32)
[S17] round=33 local utility u=0.147703 metrics={'f1_val': 0.6739497053287853, 'auprc': 0.7975791717315999, 'loss_val': 0.7076250321168457, 'psi': 0.7234014918899112}-{'f1_val': 0.6653154884637869, 'auprc': 0.723614785765565, 'loss_val': 0.7293316412357492, 'psi': 0.6886352073844981}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S13] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9982
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9982
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9993
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=33 metric=0.6739 head_norm=1.569152
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.895917e-02
[S17] stored merged vector for next round verification (round=33)
[S17] DEBUG after merge:  round=33 metric=0.6739 head_norm=1.553336 delta_norm=0.028959
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=33 metric=0.9952 head_norm=1.442553
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.416767e-02
[S10] stored merged vector for next round verification (round=33)
[S10] DEBUG after merge:  round=33 metric=0.9952 head_norm=1.414676 delta_norm=0.054168
[S10] aggregate: ACCEPT kept=['S13', 'S13'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=33 metric=0.9965 head_norm=1.694082
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.780249e-02
[S11] stored merged vector for next round verification (round=33)
[S11] DEBUG after merge:  round=33 metric=0.9965 head_norm=1.687637 delta_norm=0.017802
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=33 metric=0.7103 head_norm=1.681355
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.780248e-02
[S2] stored merged vector for next round verification (round=33)
[S2] DEBUG after merge:  round=33 metric=0.7127 head_norm=1.687637 delta_norm=0.017802
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=33 metric=0.5892 head_norm=1.397178
[S13] _apply_head_vector_avg (torch): Δ‖w‖=4.816062e-02
[S13] stored merged vector for next round verification (round=33)
[S13] DEBUG after merge:  round=33 metric=0.5880 head_norm=1.419230 delta_norm=0.048161
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=34 head_norm_before_train=1.687637 cos_to_last_merge=1.0000 (last merge round=33)
[S2] round=34 local utility u=0.129955 metrics={'f1_val': 0.7103852930635745, 'auprc': 0.9786560713245096, 'loss_val': 0.36158436014271506, 'psi': 0.8176936043679486}-{'f1_val': 0.7103123590592251, 'auprc': 0.8815888457678214, 'loss_val': 0.3298555712221359, 'psi': 0.7788229537426636}
[S3] START round=34 head_norm_before_train=1.800943 cos_to_last_merge=0.9187 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.919
[S3] round=34 local utility u=0.000000 metrics={'f1_val': 0.7337203673985508, 'auprc': 0.9877894401074574, 'loss_val': 0.6139013763212015, 'psi': 0.8353479964821136}-{'f1_val': 0.8595578751142705, 'auprc': 0.9967959339276045, 'loss_val': 0.28635139854918956, 'psi': 0.9144530986396041}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=34 head_norm_before_train=1.655389 cos_to_last_merge=0.8129 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.813
[S4] round=34 local utility u=0.062664 metrics={'f1_val': 0.950870566997389, 'auprc': 0.9779314505134661, 'loss_val': 0.26438573490603506, 'psi': 0.9616949204038199}-{'f1_val': 0.9422804141701234, 'auprc': 0.9559870070567675, 'loss_val': 0.2723386114726905, 'psi': 0.947763051324781}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=34 head_norm_before_train=1.939011 (no previous merge yet)
[S5] round=34 local utility u=0.011622 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9915139367162579, 'loss_val': 0.03541148907219091, 'psi': 0.9943171886720897}-{'f1_val': 0.9960402158980539, 'auprc': 0.9907151364487853, 'loss_val': 0.055383700626394326, 'psi': 0.9939101841183465}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=34 head_norm_before_train=1.550483 cos_to_last_merge=0.9236 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.924
[S6] round=34 local utility u=0.000000 metrics={'f1_val': 0.8355408349313266, 'auprc': 0.9702915794827873, 'loss_val': 0.37634875144659846, 'psi': 0.8894411327519108}-{'f1_val': 0.9361829657861075, 'auprc': 0.9692104935631384, 'loss_val': 0.2592033409348505, 'psi': 0.9493939768969198}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=34 head_norm_before_train=1.722874 cos_to_last_merge=0.9925 (last merge round=17)
[S7] round=34 local utility u=0.300174 metrics={'f1_val': 0.6970434437742092, 'auprc': 0.8548031951571196, 'loss_val': 0.28487246352600476, 'psi': 0.7601473443273734}-{'f1_val': 0.6482486564094669, 'auprc': 0.8089769039582763, 'loss_val': 0.45497367342724093, 'psi': 0.7125399554289906}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=34 head_norm_before_train=1.564605 cos_to_last_merge=0.9996 (last merge round=31)
[S8] round=34 local utility u=0.009760 metrics={'f1_val': 0.9937333839017813, 'auprc': 0.9950374920106156, 'loss_val': 0.0500748604324842, 'psi': 0.994255027145315}-{'f1_val': 0.9937333839017813, 'auprc': 0.9894516714376976, 'loss_val': 0.05283765926207282, 'psi': 0.9920206989161479}
[S9] START round=34 head_norm_before_train=1.832024 cos_to_last_merge=0.9809 (last merge round=13)
[S9] round=34 local utility u=0.000000 metrics={'f1_val': 0.9941897064172326, 'auprc': 0.9987921322379554, 'loss_val': 0.023404723914154737, 'psi': 0.9960306767455218}-{'f1_val': 0.9966924912647621, 'auprc': 0.9926138786772879, 'loss_val': 0.01962025642166948, 'psi': 0.9950610462297724}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=34 head_norm_before_train=1.414676 cos_to_last_merge=1.0000 (last merge round=33)
[S10] round=34 local utility u=0.003081 metrics={'f1_val': 0.9951633020469546, 'auprc': 0.9962136541079976, 'loss_val': 0.05182366751131814, 'psi': 0.9955834428713717}-{'f1_val': 0.9951878390193748, 'auprc': 0.9953728805598125, 'loss_val': 0.055611307521000734, 'psi': 0.9952618556355499}
[S11] START round=34 head_norm_before_train=1.687637 cos_to_last_merge=1.0000 (last merge round=33)
[S11] round=34 local utility u=0.000858 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9936112858630736, 'loss_val': 0.039498525322171414, 'psi': 0.9953727170533831}-{'f1_val': 0.9965470045135896, 'auprc': 0.9936305289907674, 'loss_val': 0.041271813729209635, 'psi': 0.9953804143044607}
[S13] START round=34 head_norm_before_train=1.419230 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=34 local utility u=0.000000 metrics={'f1_val': 0.5700954553271981, 'auprc': 0.7120110185606348, 'loss_val': 0.8296110219618266, 'psi': 0.6268616806205727}-{'f1_val': 0.5892023331314848, 'auprc': 0.6944028592709302, 'loss_val': 0.6615412453228301, 'psi': 0.631282543587263}
[S14] START round=34 head_norm_before_train=1.582172 cos_to_last_merge=0.8666 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.867
[S14] round=34 local utility u=0.000253 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9970259232794544, 'loss_val': 0.04312977986449156, 'psi': 0.997401040141694}-{'f1_val': 0.9976511180498535, 'auprc': 0.9973378996912725, 'loss_val': 0.04457072891488261, 'psi': 0.9975258307064212}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=34 head_norm_before_train=1.627538 cos_to_last_merge=0.9567 (last merge round=19)
[S15] round=34 local utility u=0.000000 metrics={'f1_val': 0.7130994513018473, 'auprc': 0.9100610361815769, 'loss_val': 0.4732172227555007, 'psi': 0.7918840852537392}-{'f1_val': 0.7656671543525435, 'auprc': 0.8830883372946551, 'loss_val': 0.45906312145147166, 'psi': 0.8126356275293882}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=34 head_norm_before_train=1.921739 (no previous merge yet)
[S16] round=34 local utility u=0.428078 metrics={'f1_val': 0.993325842244809, 'auprc': 0.9931242398964185, 'loss_val': 0.0325120091098189, 'psi': 0.9932452013054528}-{'f1_val': 0.9317282944078185, 'auprc': 0.9471971687069906, 'loss_val': 0.38130137833200645, 'psi': 0.9379158441274873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=34 head_norm_before_train=1.553336 cos_to_last_merge=1.0000 (last merge round=33)
[S17] round=34 local utility u=0.110118 metrics={'f1_val': 0.6792162547154021, 'auprc': 0.8529056053706461, 'loss_val': 0.6849674012972041, 'psi': 0.7486919949774997}-{'f1_val': 0.6739497053287853, 'auprc': 0.7975791717315999, 'loss_val': 0.7076250321168457, 'psi': 0.7234014918899112}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9990
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=0.9990
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=34 metric=0.9965 head_norm=1.706442
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.208311e-02
[S11] stored merged vector for next round verification (round=34)
[S11] DEBUG after merge:  round=34 metric=0.9965 head_norm=1.703526 delta_norm=0.012083
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=34 metric=0.9937 head_norm=1.585738
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.489374e-02
[S8] stored merged vector for next round verification (round=34)
[S8] DEBUG after merge:  round=34 metric=0.9937 head_norm=1.579660 delta_norm=0.034894
[S8] aggregate: ACCEPT kept=['S17', 'S17'] (k=2/2) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=34 metric=0.6792 head_norm=1.579548
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.636462e-02
[S17] stored merged vector for next round verification (round=34)
[S17] DEBUG after merge:  round=34 metric=0.6798 head_norm=1.582228 delta_norm=0.036365
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=34 metric=0.7104 head_norm=1.700692
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.208311e-02
[S2] stored merged vector for next round verification (round=34)
[S2] DEBUG after merge:  round=34 metric=0.7104 head_norm=1.703526 delta_norm=0.012083
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=35 head_norm_before_train=1.703526 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=35 local utility u=0.000000 metrics={'f1_val': 0.7915876421976127, 'auprc': 0.7951250437446382, 'loss_val': 0.4497441810860945, 'psi': 0.793002602816423}-{'f1_val': 0.7103852930635745, 'auprc': 0.9786560713245096, 'loss_val': 0.36158436014271506, 'psi': 0.8176936043679486}
[S3] START round=35 head_norm_before_train=1.815045 cos_to_last_merge=0.9175 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.917
[S3] round=35 local utility u=0.632475 metrics={'f1_val': 0.8875457136443626, 'auprc': 0.9895852419267602, 'loss_val': 0.2772904220281042, 'psi': 0.9283615249573217}-{'f1_val': 0.7337203673985508, 'auprc': 0.9877894401074574, 'loss_val': 0.6139013763212015, 'psi': 0.8353479964821136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=35 head_norm_before_train=1.663088 cos_to_last_merge=0.8119 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.812
[S4] round=35 local utility u=0.000000 metrics={'f1_val': 0.9518690481016991, 'auprc': 0.955301648300547, 'loss_val': 0.2741284516827786, 'psi': 0.9532420881812382}-{'f1_val': 0.950870566997389, 'auprc': 0.9779314505134661, 'loss_val': 0.26438573490603506, 'psi': 0.9616949204038199}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=35 head_norm_before_train=1.944719 (no previous merge yet)
[S5] round=35 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9911479768678779, 'loss_val': 0.03502659977150922, 'psi': 0.9941708047327378}-{'f1_val': 0.996186023309311, 'auprc': 0.9915139367162579, 'loss_val': 0.03541148907219091, 'psi': 0.9943171886720897}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=35 head_norm_before_train=1.558790 cos_to_last_merge=0.9220 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.922
[S6] round=35 local utility u=0.000000 metrics={'f1_val': 0.6004707141277976, 'auprc': 0.9441459635159778, 'loss_val': 0.9272896306020268, 'psi': 0.7379408138830696}-{'f1_val': 0.8355408349313266, 'auprc': 0.9702915794827873, 'loss_val': 0.37634875144659846, 'psi': 0.8894411327519108}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=35 head_norm_before_train=1.728978 cos_to_last_merge=0.9921 (last merge round=17)
[S7] round=35 local utility u=0.000000 metrics={'f1_val': 0.6389934555204202, 'auprc': 0.8071373540373492, 'loss_val': 0.47518561101771084, 'psi': 0.7062510149271919}-{'f1_val': 0.6970434437742092, 'auprc': 0.8548031951571196, 'loss_val': 0.28487246352600476, 'psi': 0.7601473443273734}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=35 head_norm_before_train=1.579660 cos_to_last_merge=1.0000 (last merge round=34)
[S8] round=35 local utility u=0.000405 metrics={'f1_val': 0.9917351758735767, 'auprc': 0.9993199101445286, 'loss_val': 0.05012191249125478, 'psi': 0.9947690695819575}-{'f1_val': 0.9937333839017813, 'auprc': 0.9950374920106156, 'loss_val': 0.0500748604324842, 'psi': 0.994255027145315}
[S9] START round=35 head_norm_before_train=1.839316 cos_to_last_merge=0.9805 (last merge round=13)
[S9] round=35 local utility u=0.006178 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9963483015710046, 'loss_val': 0.018541727695570522, 'psi': 0.9965356277167368}-{'f1_val': 0.9941897064172326, 'auprc': 0.9987921322379554, 'loss_val': 0.023404723914154737, 'psi': 0.9960306767455218}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=35 head_norm_before_train=1.441030 cos_to_last_merge=0.9999 (last merge round=33)
[S10] round=35 local utility u=0.000792 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9960336538757535, 'loss_val': 0.04984708403419113, 'psi': 0.9955261649619263}-{'f1_val': 0.9951633020469546, 'auprc': 0.9962136541079976, 'loss_val': 0.05182366751131814, 'psi': 0.9955834428713717}
[S11] START round=35 head_norm_before_train=1.703526 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=35 local utility u=0.000000 metrics={'f1_val': 0.8387536370656876, 'auprc': 0.9938409098036192, 'loss_val': 0.2802212002063423, 'psi': 0.9007885461608602}-{'f1_val': 0.9965470045135896, 'auprc': 0.9936112858630736, 'loss_val': 0.039498525322171414, 'psi': 0.9953727170533831}
[S13] START round=35 head_norm_before_train=1.431091 cos_to_last_merge=1.0000 (last merge round=33)
[S13] round=35 local utility u=0.072387 metrics={'f1_val': 0.5951153295262694, 'auprc': 0.7142061441605962, 'loss_val': 0.8415420568751487, 'psi': 0.6427516553800001}-{'f1_val': 0.5700954553271981, 'auprc': 0.7120110185606348, 'loss_val': 0.8296110219618266, 'psi': 0.6268616806205727}
[S14] START round=35 head_norm_before_train=1.599292 cos_to_last_merge=0.8651 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.865
[S14] round=35 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970255576948811, 'loss_val': 0.04215739867486392, 'psi': 0.9972551847789878}-{'f1_val': 0.9976511180498535, 'auprc': 0.9970259232794544, 'loss_val': 0.04312977986449156, 'psi': 0.997401040141694}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=35 head_norm_before_train=1.638331 cos_to_last_merge=0.9555 (last merge round=19)
[S15] round=35 local utility u=1.000000 metrics={'f1_val': 0.9898484686292672, 'auprc': 0.9907787539491084, 'loss_val': 0.05703762502551104, 'psi': 0.9902205827572037}-{'f1_val': 0.7130994513018473, 'auprc': 0.9100610361815769, 'loss_val': 0.4732172227555007, 'psi': 0.7918840852537392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S15] sending update (kind=head size=1804 to 1 peers)
[S16] START round=35 head_norm_before_train=1.931753 (no previous merge yet)
[S16] round=35 local utility u=0.000000 metrics={'f1_val': 0.8807303532284946, 'auprc': 0.9948124669729119, 'loss_val': 0.29130333149935067, 'psi': 0.9263631987262615}-{'f1_val': 0.993325842244809, 'auprc': 0.9931242398964185, 'loss_val': 0.0325120091098189, 'psi': 0.9932452013054528}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=35 head_norm_before_train=1.582228 cos_to_last_merge=1.0000 (last merge round=34)
[S17] round=35 local utility u=0.000000 metrics={'f1_val': 0.6744753984474179, 'auprc': 0.8472849370791472, 'loss_val': 0.7448361126818915, 'psi': 0.7435992139001096}-{'f1_val': 0.6792162547154021, 'auprc': 0.8529056053706461, 'loss_val': 0.6849674012972041, 'psi': 0.7486919949774997}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] ⇄ pheromone p=0.085 → S11@127.0.0.1:54512
[S10] sending update (kind=head size=1795 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] ⇄ pheromone p=0.008 → S2@127.0.0.1:54502
[S17] ⇄ pheromone p=0.083 → S8@127.0.0.1:54509
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9995
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9995
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=35 metric=0.5951 head_norm=1.442503
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.030041e-02
[S13] stored merged vector for next round verification (round=35)
[S13] DEBUG after merge:  round=35 metric=0.5943 head_norm=1.447084 delta_norm=0.020300
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.068 → S10@127.0.0.1:54511
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=35 metric=0.9952 head_norm=1.462892
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.528304e-02
[S10] stored merged vector for next round verification (round=35)
[S10] DEBUG after merge:  round=35 metric=0.9952 head_norm=1.452513 delta_norm=0.025283
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.013 → S13@127.0.0.1:54513
[S8] ⇄ pheromone p=0.067 → S17@127.0.0.1:54517
[S2] START round=36 head_norm_before_train=1.713850 cos_to_last_merge=1.0000 (last merge round=34)
[S2] round=36 local utility u=0.000000 metrics={'f1_val': 0.7096385351164358, 'auprc': 0.9157526110745516, 'loss_val': 0.37843538937160426, 'psi': 0.7920841654996822}-{'f1_val': 0.7915876421976127, 'auprc': 0.7951250437446382, 'loss_val': 0.4497441810860945, 'psi': 0.793002602816423}
[S3] START round=36 head_norm_before_train=1.828050 cos_to_last_merge=0.9164 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.916
[S3] round=36 local utility u=0.434206 metrics={'f1_val': 0.9873007809781595, 'auprc': 0.9976127863888246, 'loss_val': 0.03149165636849425, 'psi': 0.9914255831424256}-{'f1_val': 0.8875457136443626, 'auprc': 0.9895852419267602, 'loss_val': 0.2772904220281042, 'psi': 0.9283615249573217}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S3] sending update (kind=head size=1804 to 1 peers)
[S4] START round=36 head_norm_before_train=1.668533 cos_to_last_merge=0.8110 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.811
[S4] round=36 local utility u=0.000000 metrics={'f1_val': 0.9388270354748703, 'auprc': 0.9592507476418087, 'loss_val': 0.2676233911153211, 'psi': 0.9469965203416457}-{'f1_val': 0.9518690481016991, 'auprc': 0.955301648300547, 'loss_val': 0.2741284516827786, 'psi': 0.9532420881812382}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=36 head_norm_before_train=1.955505 (no previous merge yet)
[S5] round=36 local utility u=0.011988 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9970442057028337, 'loss_val': 0.029618637761670005, 'psi': 0.9966172368744277}-{'f1_val': 0.996186023309311, 'auprc': 0.9911479768678779, 'loss_val': 0.03502659977150922, 'psi': 0.9941708047327378}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=36 head_norm_before_train=1.567130 cos_to_last_merge=0.9204 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.920
[S6] round=36 local utility u=1.000000 metrics={'f1_val': 0.9831375686718373, 'auprc': 0.9789797587836107, 'loss_val': 0.09965041082180731, 'psi': 0.9814744447165467}-{'f1_val': 0.6004707141277976, 'auprc': 0.9441459635159778, 'loss_val': 0.9272896306020268, 'psi': 0.7379408138830696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S6] sending update (kind=head size=1796 to 1 peers)
[S7] START round=36 head_norm_before_train=1.732102 cos_to_last_merge=0.9919 (last merge round=17)
[S7] round=36 local utility u=0.000000 metrics={'f1_val': 0.6137887146519152, 'auprc': 0.7928328656903291, 'loss_val': 0.5861968655316111, 'psi': 0.6854063750672807}-{'f1_val': 0.6389934555204202, 'auprc': 0.8071373540373492, 'loss_val': 0.47518561101771084, 'psi': 0.7062510149271919}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=36 head_norm_before_train=1.600860 cos_to_last_merge=0.9999 (last merge round=34)
[S8] round=36 local utility u=0.000000 metrics={'f1_val': 0.9933593890417576, 'auprc': 0.9877428284934643, 'loss_val': 0.04638110843090867, 'psi': 0.9911127648224403}-{'f1_val': 0.9917351758735767, 'auprc': 0.9993199101445286, 'loss_val': 0.05012191249125478, 'psi': 0.9947690695819575}
[S9] START round=36 head_norm_before_train=1.848566 cos_to_last_merge=0.9802 (last merge round=13)
[S9] round=36 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9992083123643825, 'loss_val': 0.022589112952229366, 'psi': 0.9961793849694269}-{'f1_val': 0.9966605118138915, 'auprc': 0.9963483015710046, 'loss_val': 0.018541727695570522, 'psi': 0.9965356277167368}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=36 head_norm_before_train=1.452513 cos_to_last_merge=1.0000 (last merge round=35)
[S10] round=36 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954077319300751, 'loss_val': 0.049557994842398014, 'psi': 0.9952757961836549}-{'f1_val': 0.9951878390193748, 'auprc': 0.9960336538757535, 'loss_val': 0.04984708403419113, 'psi': 0.9955261649619263}
[S11] START round=36 head_norm_before_train=1.720050 cos_to_last_merge=1.0000 (last merge round=34)
[S11] round=36 local utility u=0.352912 metrics={'f1_val': 0.9288594064185962, 'auprc': 0.9940323461780989, 'loss_val': 0.11560650492846222, 'psi': 0.9549285823223973}-{'f1_val': 0.8387536370656876, 'auprc': 0.9938409098036192, 'loss_val': 0.2802212002063423, 'psi': 0.9007885461608602}
[S13] START round=36 head_norm_before_train=1.447084 cos_to_last_merge=1.0000 (last merge round=35)
[S13] round=36 local utility u=0.184425 metrics={'f1_val': 0.6295962640985389, 'auprc': 0.7134277215633349, 'loss_val': 0.6772419342786813, 'psi': 0.6631288470844572}-{'f1_val': 0.5951153295262694, 'auprc': 0.7142061441605962, 'loss_val': 0.8415420568751487, 'psi': 0.6427516553800001}
[S14] START round=36 head_norm_before_train=1.612114 cos_to_last_merge=0.8639 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.864
[S14] round=36 local utility u=0.001937 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970334021629306, 'loss_val': 0.038307681759270774, 'psi': 0.9972583225662076}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970255576948811, 'loss_val': 0.04215739867486392, 'psi': 0.9972551847789878}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=36 head_norm_before_train=1.649827 cos_to_last_merge=0.9542 (last merge round=19)
[S15] round=36 local utility u=0.000000 metrics={'f1_val': 0.7476109000552362, 'auprc': 0.8240524067613022, 'loss_val': 0.49683676821047273, 'psi': 0.7781875027376626}-{'f1_val': 0.9898484686292672, 'auprc': 0.9907787539491084, 'loss_val': 0.05703762502551104, 'psi': 0.9902205827572037}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=36 head_norm_before_train=1.939875 (no previous merge yet)
[S16] round=36 local utility u=0.467879 metrics={'f1_val': 0.9926180753200611, 'auprc': 0.9978036569894039, 'loss_val': 0.035845862533254294, 'psi': 0.9946923079877982}-{'f1_val': 0.8807303532284946, 'auprc': 0.9948124669729119, 'loss_val': 0.29130333149935067, 'psi': 0.9263631987262615}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=36 head_norm_before_train=1.603660 cos_to_last_merge=0.9999 (last merge round=34)
[S17] round=36 local utility u=0.014091 metrics={'f1_val': 0.6769241932211638, 'auprc': 0.8601285483959272, 'loss_val': 0.7698782888491098, 'psi': 0.7502059352910693}-{'f1_val': 0.6744753984474179, 'auprc': 0.8472849370791472, 'loss_val': 0.7448361126818915, 'psi': 0.7435992139001096}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] sending update (kind=head size=1802 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S11] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9991
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9998
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=36 metric=0.6769 head_norm=1.623063
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.146040e-02
[S17] stored merged vector for next round verification (round=36)
[S17] DEBUG after merge:  round=36 metric=0.6769 head_norm=1.611693 delta_norm=0.031460
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=36 metric=0.9952 head_norm=1.473051
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.612210e-02
[S10] stored merged vector for next round verification (round=36)
[S10] DEBUG after merge:  round=36 metric=0.9952 head_norm=1.465621 delta_norm=0.016122
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=37 head_norm_before_train=1.722849 cos_to_last_merge=0.9999 (last merge round=34)
[S2] round=37 local utility u=0.035740 metrics={'f1_val': 0.7097479504146138, 'auprc': 0.9429516184705438, 'loss_val': 0.38920989013564816, 'psi': 0.8030294176369859}-{'f1_val': 0.7096385351164358, 'auprc': 0.9157526110745516, 'loss_val': 0.37843538937160426, 'psi': 0.7920841654996822}
[S3] START round=37 head_norm_before_train=1.842557 cos_to_last_merge=0.9152 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.915
[S3] round=37 local utility u=0.000000 metrics={'f1_val': 0.9383405914906404, 'auprc': 0.9962755957318831, 'loss_val': 0.12104621664060715, 'psi': 0.9615145931871375}-{'f1_val': 0.9873007809781595, 'auprc': 0.9976127863888246, 'loss_val': 0.03149165636849425, 'psi': 0.9914255831424256}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=37 head_norm_before_train=1.678053 cos_to_last_merge=0.8097 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.810
[S4] round=37 local utility u=0.000000 metrics={'f1_val': 0.933965229059134, 'auprc': 0.9537864438968813, 'loss_val': 0.2819393526943011, 'psi': 0.9418937149942329}-{'f1_val': 0.9388270354748703, 'auprc': 0.9592507476418087, 'loss_val': 0.2676233911153211, 'psi': 0.9469965203416457}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=37 head_norm_before_train=1.968800 (no previous merge yet)
[S5] round=37 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9956836768062949, 'loss_val': 0.031487937822362914, 'psi': 0.9959850847081045}-{'f1_val': 0.9963325909888239, 'auprc': 0.9970442057028337, 'loss_val': 0.029618637761670005, 'psi': 0.9966172368744277}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=37 head_norm_before_train=1.576237 cos_to_last_merge=0.9190 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.919
[S6] round=37 local utility u=0.000000 metrics={'f1_val': 0.4196838450830067, 'auprc': 0.7900625545677341, 'loss_val': 1.0869176058683139, 'psi': 0.5678353288768977}-{'f1_val': 0.9831375686718373, 'auprc': 0.9789797587836107, 'loss_val': 0.09965041082180731, 'psi': 0.9814744447165467}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=37 head_norm_before_train=1.736182 cos_to_last_merge=0.9915 (last merge round=17)
[S7] round=37 local utility u=0.000000 metrics={'f1_val': 0.4782178375172123, 'auprc': 0.7772050416895491, 'loss_val': 1.114555436818445, 'psi': 0.5978127191861471}-{'f1_val': 0.6137887146519152, 'auprc': 0.7928328656903291, 'loss_val': 0.5861968655316111, 'psi': 0.6854063750672807}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=37 head_norm_before_train=1.622840 cos_to_last_merge=0.9998 (last merge round=34)
[S8] round=37 local utility u=0.010373 metrics={'f1_val': 0.9910113370052481, 'auprc': 0.9993242458467879, 'loss_val': 0.04629079693671162, 'psi': 0.9943365005418641}-{'f1_val': 0.9933593890417576, 'auprc': 0.9877428284934643, 'loss_val': 0.04638110843090867, 'psi': 0.9911127648224403}
[S9] START round=37 head_norm_before_train=1.856260 cos_to_last_merge=0.9798 (last merge round=13)
[S9] round=37 local utility u=0.011116 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9991242959086715, 'loss_val': 0.01776117820604277, 'psi': 0.9979114658707543}-{'f1_val': 0.9941601000394567, 'auprc': 0.9992083123643825, 'loss_val': 0.022589112952229366, 'psi': 0.9961793849694269}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=37 head_norm_before_train=1.465621 cos_to_last_merge=1.0000 (last merge round=36)
[S10] round=37 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947748714784713, 'loss_val': 0.04826911015810316, 'psi': 0.9950226520030134}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954077319300751, 'loss_val': 0.049557994842398014, 'psi': 0.9952757961836549}
[S11] START round=37 head_norm_before_train=1.735933 cos_to_last_merge=0.9998 (last merge round=34)
[S11] round=37 local utility u=0.243613 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9937453386325606, 'loss_val': 0.03364572620800156, 'psi': 0.995426338161178}-{'f1_val': 0.9288594064185962, 'auprc': 0.9940323461780989, 'loss_val': 0.11560650492846222, 'psi': 0.9549285823223973}
[S13] START round=37 head_norm_before_train=1.458332 cos_to_last_merge=0.9999 (last merge round=35)
[S13] round=37 local utility u=0.000000 metrics={'f1_val': 0.6103370232962564, 'auprc': 0.7567128674596756, 'loss_val': 0.9407840356584215, 'psi': 0.6688873609616242}-{'f1_val': 0.6295962640985389, 'auprc': 0.7134277215633349, 'loss_val': 0.6772419342786813, 'psi': 0.6631288470844572}
[S14] START round=37 head_norm_before_train=1.626716 cos_to_last_merge=0.8624 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.862
[S14] round=37 local utility u=0.001355 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9973418873048763, 'loss_val': 0.03653955288330954, 'psi': 0.9973833514826473}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970334021629306, 'loss_val': 0.038307681759270774, 'psi': 0.9972583225662076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=37 head_norm_before_train=1.662554 cos_to_last_merge=0.9530 (last merge round=19)
[S15] round=37 local utility u=0.812588 metrics={'f1_val': 0.8942392857094091, 'auprc': 0.9720498868338894, 'loss_val': 0.19542388611537334, 'psi': 0.9253635261592013}-{'f1_val': 0.7476109000552362, 'auprc': 0.8240524067613022, 'loss_val': 0.49683676821047273, 'psi': 0.7781875027376626}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S15] sending update (kind=head size=1802 to 1 peers)
[S16] START round=37 head_norm_before_train=1.948975 (no previous merge yet)
[S16] round=37 local utility u=0.000000 metrics={'f1_val': 0.9319762226140064, 'auprc': 0.9928300859579311, 'loss_val': 0.29995057242378337, 'psi': 0.9563177679515763}-{'f1_val': 0.9926180753200611, 'auprc': 0.9978036569894039, 'loss_val': 0.035845862533254294, 'psi': 0.9946923079877982}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=37 head_norm_before_train=1.611693 cos_to_last_merge=1.0000 (last merge round=36)
[S17] round=37 local utility u=0.000000 metrics={'f1_val': 0.6757863579990032, 'auprc': 0.8541465021962006, 'loss_val': 0.8163478074451082, 'psi': 0.7471304156778822}-{'f1_val': 0.6769241932211638, 'auprc': 0.8601285483959272, 'loss_val': 0.7698782888491098, 'psi': 0.7502059352910693}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S8] → sending delta(kind=head bytes=1799) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:54512
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1799) from S8
[S17] cosine check vs S8: cos=0.9991
[S11] RECEIVED delta(kind=head bytes=1805) from S2
[S11] cosine check vs S2: cos=0.9994
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9994
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=37 metric=0.9965 head_norm=1.754657
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.099728e-02
[S11] stored merged vector for next round verification (round=37)
[S11] DEBUG after merge:  round=37 metric=0.9965 head_norm=1.743576 delta_norm=0.030997
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=37 metric=0.7097 head_norm=1.732979
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.697181e-02
[S2] stored merged vector for next round verification (round=37)
[S2] DEBUG after merge:  round=37 metric=0.7097 head_norm=1.738929 delta_norm=0.026972
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=37 metric=0.9910 head_norm=1.641027
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.996376e-02
[S8] stored merged vector for next round verification (round=37)
[S8] DEBUG after merge:  round=37 metric=0.9907 head_norm=1.631580 delta_norm=0.039964
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=38 head_norm_before_train=1.738929 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=38 local utility u=0.000000 metrics={'f1_val': 0.7268421489092235, 'auprc': 0.8432650848538212, 'loss_val': 0.3951224242027346, 'psi': 0.7734113232870626}-{'f1_val': 0.7097479504146138, 'auprc': 0.9429516184705438, 'loss_val': 0.38920989013564816, 'psi': 0.8030294176369859}
[S3] START round=38 head_norm_before_train=1.853713 cos_to_last_merge=0.9142 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.914
[S3] round=38 local utility u=0.000000 metrics={'f1_val': 0.9172825479605141, 'auprc': 0.9322406936309302, 'loss_val': 0.2509058125607966, 'psi': 0.9232658062286805}-{'f1_val': 0.9383405914906404, 'auprc': 0.9962755957318831, 'loss_val': 0.12104621664060715, 'psi': 0.9615145931871375}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=38 head_norm_before_train=1.686270 cos_to_last_merge=0.8085 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.808
[S4] round=38 local utility u=0.078844 metrics={'f1_val': 0.9503120243282784, 'auprc': 0.9713884059411488, 'loss_val': 0.27513822113677755, 'psi': 0.9587425769734266}-{'f1_val': 0.933965229059134, 'auprc': 0.9537864438968813, 'loss_val': 0.2819393526943011, 'psi': 0.9418937149942329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=38 head_norm_before_train=1.975459 (no previous merge yet)
[S5] round=38 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9911880061461666, 'loss_val': 0.032571694545553524, 'psi': 0.9941868164440533}-{'f1_val': 0.996186023309311, 'auprc': 0.9956836768062949, 'loss_val': 0.031487937822362914, 'psi': 0.9959850847081045}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=38 head_norm_before_train=1.586738 cos_to_last_merge=0.9177 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.918
[S6] round=38 local utility u=1.000000 metrics={'f1_val': 0.8011962108959316, 'auprc': 0.9648747200665275, 'loss_val': 0.5188309883873451, 'psi': 0.86666761456417}-{'f1_val': 0.4196838450830067, 'auprc': 0.7900625545677341, 'loss_val': 1.0869176058683139, 'psi': 0.5678353288768977}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=38 head_norm_before_train=1.742925 cos_to_last_merge=0.9909 (last merge round=17)
[S7] round=38 local utility u=0.987240 metrics={'f1_val': 0.6676253112311572, 'auprc': 0.8298445978731467, 'loss_val': 0.43443960382879226, 'psi': 0.732513025887953}-{'f1_val': 0.4782178375172123, 'auprc': 0.7772050416895491, 'loss_val': 1.114555436818445, 'psi': 0.5978127191861471}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=38 head_norm_before_train=1.631580 cos_to_last_merge=1.0000 (last merge round=37)
[S8] round=38 local utility u=0.006567 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.999321574768708, 'loss_val': 0.04403152482243417, 'psi': 0.9954236272550945}-{'f1_val': 0.9910113370052481, 'auprc': 0.9993242458467879, 'loss_val': 0.04629079693671162, 'psi': 0.9943365005418641}
[S9] START round=38 head_norm_before_train=1.865000 cos_to_last_merge=0.9792 (last merge round=13)
[S9] round=38 local utility u=0.000369 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999304817760151, 'loss_val': 0.01756563358415955, 'psi': 0.9979836746113461}-{'f1_val': 0.9971029125121428, 'auprc': 0.9991242959086715, 'loss_val': 0.01776117820604277, 'psi': 0.9979114658707543}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=38 head_norm_before_train=1.486665 cos_to_last_merge=0.9999 (last merge round=36)
[S10] round=38 local utility u=0.006058 metrics={'f1_val': 0.9955851229258669, 'auprc': 0.9962635895818892, 'loss_val': 0.04300317343438531, 'psi': 0.9958565095882759}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947748714784713, 'loss_val': 0.04826911015810316, 'psi': 0.9950226520030134}
[S11] START round=38 head_norm_before_train=1.743576 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=38 local utility u=0.000000 metrics={'f1_val': 0.9934271414771721, 'auprc': 0.9937983234288942, 'loss_val': 0.04207585491611691, 'psi': 0.9935756142578609}-{'f1_val': 0.9965470045135896, 'auprc': 0.9937453386325606, 'loss_val': 0.03364572620800156, 'psi': 0.995426338161178}
[S13] START round=38 head_norm_before_train=1.467033 cos_to_last_merge=0.9998 (last merge round=35)
[S13] round=38 local utility u=0.027335 metrics={'f1_val': 0.6186806706360259, 'auprc': 0.732299826038955, 'loss_val': 0.8629365576034046, 'psi': 0.6641283327971976}-{'f1_val': 0.6103370232962564, 'auprc': 0.7567128674596756, 'loss_val': 0.9407840356584215, 'psi': 0.6688873609616242}
[S14] START round=38 head_norm_before_train=1.641023 cos_to_last_merge=0.8611 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.861
[S14] round=38 local utility u=0.000000 metrics={'f1_val': 0.9969975081576651, 'auprc': 0.9970214025887726, 'loss_val': 0.034695696651413546, 'psi': 0.997007065930108}-{'f1_val': 0.9974109942678281, 'auprc': 0.9973418873048763, 'loss_val': 0.03653955288330954, 'psi': 0.9973833514826473}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=38 head_norm_before_train=1.675785 cos_to_last_merge=0.9516 (last merge round=19)
[S15] round=38 local utility u=0.000000 metrics={'f1_val': 0.7019452157666549, 'auprc': 0.9197084381116705, 'loss_val': 0.4735380336731295, 'psi': 0.7890505047046612}-{'f1_val': 0.8942392857094091, 'auprc': 0.9720498868338894, 'loss_val': 0.19542388611537334, 'psi': 0.9253635261592013}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=38 head_norm_before_train=1.958268 (no previous merge yet)
[S16] round=38 local utility u=0.000000 metrics={'f1_val': 0.8474099972419915, 'auprc': 0.8874371848972779, 'loss_val': 1.01507252840321, 'psi': 0.863420872304106}-{'f1_val': 0.9319762226140064, 'auprc': 0.9928300859579311, 'loss_val': 0.29995057242378337, 'psi': 0.9563177679515763}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=38 head_norm_before_train=1.631068 cos_to_last_merge=0.9999 (last merge round=36)
[S17] round=38 local utility u=0.029587 metrics={'f1_val': 0.6850350671295682, 'auprc': 0.8604475793175301, 'loss_val': 0.8315684848422089, 'psi': 0.7552000720047529}-{'f1_val': 0.6757863579990032, 'auprc': 0.8541465021962006, 'loss_val': 0.8163478074451082, 'psi': 0.7471304156778822}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S10] sending update (kind=head size=1796 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9993
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9993
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9993
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9993
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=38 metric=0.6850 head_norm=1.650448
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.889786e-02
[S17] stored merged vector for next round verification (round=38)
[S17] DEBUG after merge:  round=38 metric=0.6862 head_norm=1.646457 delta_norm=0.038898
[S17] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=38 metric=0.9956 head_norm=1.505159
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.106986e-02
[S10] stored merged vector for next round verification (round=38)
[S10] DEBUG after merge:  round=38 metric=0.9956 head_norm=1.489936 delta_norm=0.031070
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=38 metric=0.6187 head_norm=1.475210
[S13] _apply_head_vector_avg (torch): Δ‖w‖=3.106986e-02
[S13] stored merged vector for next round verification (round=38)
[S13] DEBUG after merge:  round=38 metric=0.6154 head_norm=1.489936 delta_norm=0.031070
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=38 metric=0.9928 head_norm=1.645888
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.114014e-02
[S8] stored merged vector for next round verification (round=38)
[S8] DEBUG after merge:  round=38 metric=0.9925 head_norm=1.647876 delta_norm=0.031140
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=39 head_norm_before_train=1.749159 cos_to_last_merge=1.0000 (last merge round=37)
[S2] round=39 local utility u=0.000000 metrics={'f1_val': 0.729660513098288, 'auprc': 0.8354045390984057, 'loss_val': 0.4088065291150331, 'psi': 0.7719581234983351}-{'f1_val': 0.7268421489092235, 'auprc': 0.8432650848538212, 'loss_val': 0.3951224242027346, 'psi': 0.7734113232870626}
[S3] START round=39 head_norm_before_train=1.865306 cos_to_last_merge=0.9133 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.913
[S3] round=39 local utility u=0.000000 metrics={'f1_val': 0.8178639275600601, 'auprc': 0.9960363553721601, 'loss_val': 0.4023612386847555, 'psi': 0.8891328986849001}-{'f1_val': 0.9172825479605141, 'auprc': 0.9322406936309302, 'loss_val': 0.2509058125607966, 'psi': 0.9232658062286805}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=40 psi=0.889 u=0.0000 p_local=0.1182 f1=0.818 auprc=0.996 bytes=37823
[S4] START round=39 head_norm_before_train=1.694249 cos_to_last_merge=0.8079 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.808
[S4] round=39 local utility u=0.008624 metrics={'f1_val': 0.9512565677141911, 'auprc': 0.9742370690707923, 'loss_val': 0.27210427017835, 'psi': 0.9604487682568316}-{'f1_val': 0.9503120243282784, 'auprc': 0.9713884059411488, 'loss_val': 0.27513822113677755, 'psi': 0.9587425769734266}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S4] r=40 psi=0.960 u=0.0086 p_local=0.0244 f1=0.951 auprc=0.974 bytes=43133
[S5] START round=39 head_norm_before_train=1.981587 (no previous merge yet)
[S5] round=39 local utility u=0.000334 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9910903842565102, 'loss_val': 0.031610789599343346, 'psi': 0.9941477676881907}-{'f1_val': 0.996186023309311, 'auprc': 0.9911880061461666, 'loss_val': 0.032571694545553524, 'psi': 0.9941868164440533}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S5] r=40 psi=0.994 u=0.0003 p_local=0.0471 f1=0.996 auprc=0.991 bytes=41351
[S6] START round=39 head_norm_before_train=1.594053 cos_to_last_merge=0.9168 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.917
[S6] round=39 local utility u=0.174503 metrics={'f1_val': 0.8389697628312236, 'auprc': 0.9699985498815771, 'loss_val': 0.4118370629762659, 'psi': 0.891381277651365}-{'f1_val': 0.8011962108959316, 'auprc': 0.9648747200665275, 'loss_val': 0.5188309883873451, 'psi': 0.86666761456417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S6] r=40 psi=0.891 u=0.1745 p_local=0.3986 f1=0.839 auprc=0.970 bytes=46728
[S7] START round=39 head_norm_before_train=1.748551 cos_to_last_merge=0.9903 (last merge round=17)
[S7] round=39 local utility u=0.528807 metrics={'f1_val': 0.8324793377214162, 'auprc': 0.8291377339453981, 'loss_val': 0.36382985601769713, 'psi': 0.831142696211009}-{'f1_val': 0.6676253112311572, 'auprc': 0.8298445978731467, 'loss_val': 0.43443960382879226, 'psi': 0.732513025887953}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S7] r=40 psi=0.831 u=0.5288 p_local=0.3518 f1=0.832 auprc=0.829 bytes=35946
[S8] START round=39 head_norm_before_train=1.647876 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=39 local utility u=0.000774 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9993142823606272, 'loss_val': 0.042461169230065314, 'psi': 0.9954207102918622}-{'f1_val': 0.9928249955793521, 'auprc': 0.999321574768708, 'loss_val': 0.04403152482243417, 'psi': 0.9954236272550945}
[S9] START round=39 head_norm_before_train=1.872908 cos_to_last_merge=0.9792 (last merge round=13)
[S9] round=39 local utility u=0.000000 metrics={'f1_val': 0.9956054446615002, 'auprc': 0.9990832769121303, 'loss_val': 0.021235798099155975, 'psi': 0.9969965775617522}-{'f1_val': 0.9971029125121428, 'auprc': 0.999304817760151, 'loss_val': 0.01756563358415955, 'psi': 0.9979836746113461}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S9] r=40 psi=0.997 u=0.0000 p_local=0.0037 f1=0.996 auprc=0.999 bytes=41357
[S10] START round=39 head_norm_before_train=1.489936 cos_to_last_merge=1.0000 (last merge round=38)
[S10] round=39 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9951597989844333, 'loss_val': 0.04474543367457371, 'psi': 0.9951766230053982}-{'f1_val': 0.9955851229258669, 'auprc': 0.9962635895818892, 'loss_val': 0.04300317343438531, 'psi': 0.9958565095882759}
[S11] START round=39 head_norm_before_train=1.760867 cos_to_last_merge=1.0000 (last merge round=37)
[S11] round=39 local utility u=0.008477 metrics={'f1_val': 0.9952922001172275, 'auprc': 0.9938304585119762, 'loss_val': 0.036409151391288384, 'psi': 0.9947075034751269}-{'f1_val': 0.9934271414771721, 'auprc': 0.9937983234288942, 'loss_val': 0.04207585491611691, 'psi': 0.9935756142578609}
[S13] START round=39 head_norm_before_train=1.489936 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=39 local utility u=0.153553 metrics={'f1_val': 0.6485386836540018, 'auprc': 0.7439470509443356, 'loss_val': 0.7699212876641198, 'psi': 0.6867020305701353}-{'f1_val': 0.6186806706360259, 'auprc': 0.732299826038955, 'loss_val': 0.8629365576034046, 'psi': 0.6641283327971976}
[S14] START round=39 head_norm_before_train=1.655986 cos_to_last_merge=0.8597 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.860
[S14] round=39 local utility u=0.001446 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9969800185434013, 'loss_val': 0.034144229977706726, 'psi': 0.9972369691183959}-{'f1_val': 0.9969975081576651, 'auprc': 0.9970214025887726, 'loss_val': 0.034695696651413546, 'psi': 0.997007065930108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S14] r=40 psi=0.997 u=0.0014 p_local=0.0067 f1=0.997 auprc=0.997 bytes=53947
[S15] START round=39 head_norm_before_train=1.687266 cos_to_last_merge=0.9502 (last merge round=19)
[S15] round=39 local utility u=1.000000 metrics={'f1_val': 0.9920110257837855, 'auprc': 0.9952284794830073, 'loss_val': 0.05282725901912799, 'psi': 0.9932980072634743}-{'f1_val': 0.7019452157666549, 'auprc': 0.9197084381116705, 'loss_val': 0.4735380336731295, 'psi': 0.7890505047046612}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S15] r=40 psi=0.993 u=1.0000 p_local=0.4484 f1=0.992 auprc=0.995 bytes=39579
[S16] START round=39 head_norm_before_train=1.966671 (no previous merge yet)
[S16] round=39 local utility u=1.000000 metrics={'f1_val': 0.9921222736473305, 'auprc': 0.9934067852983675, 'loss_val': 0.03470663886577366, 'psi': 0.9926360783077453}-{'f1_val': 0.8474099972419915, 'auprc': 0.8874371848972779, 'loss_val': 1.01507252840321, 'psi': 0.863420872304106}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S16] r=40 psi=0.993 u=1.0000 p_local=0.3130 f1=0.992 auprc=0.993 bytes=43129
[S17] START round=39 head_norm_before_train=1.646457 cos_to_last_merge=1.0000 (last merge round=38)
[S17] round=39 local utility u=0.000000 metrics={'f1_val': 0.6775334709072096, 'auprc': 0.8310785980610912, 'loss_val': 0.8678676083664855, 'psi': 0.7389515217687623}-{'f1_val': 0.6850350671295682, 'auprc': 0.8604475793175301, 'loss_val': 0.8315684848422089, 'psi': 0.7552000720047529}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S8] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S2] r=40 psi=0.772 u=0.0000 p_local=0.0392 f1=0.730 auprc=0.835 bytes=41381
[S17] r=40 psi=0.739 u=0.0000 p_local=0.0400 f1=0.678 auprc=0.831 bytes=50361
[S13] sending update (kind=head size=1797 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9999
[S11] r=40 psi=0.995 u=0.0085 p_local=0.0724 f1=0.995 auprc=0.994 bytes=55801
[S13] r=40 psi=0.687 u=0.1536 p_local=0.0816 f1=0.649 auprc=0.744 bytes=39522
[S8] r=40 psi=0.995 u=0.0008 p_local=0.0301 f1=0.993 auprc=0.999 bytes=52158
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=39 metric=0.9952 head_norm=1.505996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.096857e-03
[S10] stored merged vector for next round verification (round=39)
[S10] DEBUG after merge:  round=39 metric=0.9952 head_norm=1.501722 delta_norm=0.009097
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] r=40 psi=0.995 u=0.0000 p_local=0.0064 f1=0.995 auprc=0.995 bytes=57501
[S2] START round=40 head_norm_before_train=1.760992 cos_to_last_merge=0.9999 (last merge round=37)
[S2] round=40 local utility u=0.058273 metrics={'f1_val': 0.7091982379053667, 'auprc': 0.9097508499044065, 'loss_val': 0.3925257516004188, 'psi': 0.7894192827049826}-{'f1_val': 0.729660513098288, 'auprc': 0.8354045390984057, 'loss_val': 0.4088065291150331, 'psi': 0.7719581234983351}
[S3] START round=40 head_norm_before_train=1.875419 cos_to_last_merge=0.9124 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.912
[S3] round=40 local utility u=0.729494 metrics={'f1_val': 0.9968752412829052, 'auprc': 0.9972730605777835, 'loss_val': 0.021150764752733763, 'psi': 0.9970343690008565}-{'f1_val': 0.8178639275600601, 'auprc': 0.9960363553721601, 'loss_val': 0.4023612386847555, 'psi': 0.8891328986849001}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=40 head_norm_before_train=1.703806 cos_to_last_merge=0.8071 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=40 local utility u=0.000000 metrics={'f1_val': 0.9434782763927436, 'auprc': 0.9814246593863779, 'loss_val': 0.27166655620372576, 'psi': 0.9586568295901973}-{'f1_val': 0.9512565677141911, 'auprc': 0.9742370690707923, 'loss_val': 0.27210427017835, 'psi': 0.9604487682568316}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=40 head_norm_before_train=1.989896 (no previous merge yet)
[S5] round=40 local utility u=0.008124 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9960244750367929, 'loss_val': 0.030164922289462, 'psi': 0.9961214040003038}-{'f1_val': 0.996186023309311, 'auprc': 0.9910903842565102, 'loss_val': 0.031610789599343346, 'psi': 0.9941477676881907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S5] sending update (kind=head size=1800 to 1 peers)
[S6] START round=40 head_norm_before_train=1.601473 cos_to_last_merge=0.9152 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.915
[S6] round=40 local utility u=0.135781 metrics={'f1_val': 0.8738537793804929, 'auprc': 0.9616938032327392, 'loss_val': 0.324665682347338, 'psi': 0.9089897889213915}-{'f1_val': 0.8389697628312236, 'auprc': 0.9699985498815771, 'loss_val': 0.4118370629762659, 'psi': 0.891381277651365}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=40 head_norm_before_train=1.749957 cos_to_last_merge=0.9906 (last merge round=17)
[S7] round=40 local utility u=0.000000 metrics={'f1_val': 0.5848862175459317, 'auprc': 0.7891906110298206, 'loss_val': 0.7382190876767651, 'psi': 0.6666079749394873}-{'f1_val': 0.8324793377214162, 'auprc': 0.8291377339453981, 'loss_val': 0.36382985601769713, 'psi': 0.831142696211009}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=40 head_norm_before_train=1.661734 cos_to_last_merge=1.0000 (last merge round=38)
[S8] round=40 local utility u=0.000000 metrics={'f1_val': 0.9857354242324556, 'auprc': 0.9993226803461597, 'loss_val': 0.05420990337413621, 'psi': 0.9911703266779373}-{'f1_val': 0.9928249955793521, 'auprc': 0.9993142823606272, 'loss_val': 0.042461169230065314, 'psi': 0.9954207102918622}
[S9] START round=40 head_norm_before_train=1.875168 cos_to_last_merge=0.9793 (last merge round=13)
[S9] round=40 local utility u=0.005957 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9997847612593043, 'loss_val': 0.01794832127159849, 'psi': 0.9979293992625791}-{'f1_val': 0.9956054446615002, 'auprc': 0.9990832769121303, 'loss_val': 0.021235798099155975, 'psi': 0.9969965775617522}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=40 head_norm_before_train=1.501722 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=40 local utility u=0.002360 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957144929696125, 'loss_val': 0.041689916263785334, 'psi': 0.9953985005994699}-{'f1_val': 0.9951878390193748, 'auprc': 0.9951597989844333, 'loss_val': 0.04474543367457371, 'psi': 0.9951766230053982}
[S11] START round=40 head_norm_before_train=1.776630 cos_to_last_merge=0.9999 (last merge round=37)
[S11] round=40 local utility u=0.005944 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9937978696764728, 'loss_val': 0.03195218327443638, 'psi': 0.9954473505787429}-{'f1_val': 0.9952922001172275, 'auprc': 0.9938304585119762, 'loss_val': 0.036409151391288384, 'psi': 0.9947075034751269}
[S13] START round=40 head_norm_before_train=1.497492 cos_to_last_merge=1.0000 (last merge round=38)
[S13] round=40 local utility u=0.000000 metrics={'f1_val': 0.6138682102688722, 'auprc': 0.7583932134663564, 'loss_val': 0.8790876451812156, 'psi': 0.6716782115478659}-{'f1_val': 0.6485386836540018, 'auprc': 0.7439470509443356, 'loss_val': 0.7699212876641198, 'psi': 0.6867020305701353}
[S14] START round=40 head_norm_before_train=1.670910 cos_to_last_merge=0.8584 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.858
[S14] round=40 local utility u=0.000000 metrics={'f1_val': 0.9907123852087418, 'auprc': 0.9970075496114617, 'loss_val': 0.05173925342238254, 'psi': 0.9932304509698298}-{'f1_val': 0.9974082695017256, 'auprc': 0.9969800185434013, 'loss_val': 0.034144229977706726, 'psi': 0.9972369691183959}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=40 head_norm_before_train=1.699145 cos_to_last_merge=0.9489 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.949
[S15] round=40 local utility u=0.000000 metrics={'f1_val': 0.6970400288968347, 'auprc': 0.6695819825152247, 'loss_val': 0.6497429433395607, 'psi': 0.6860568103441907}-{'f1_val': 0.9920110257837855, 'auprc': 0.9952284794830073, 'loss_val': 0.05282725901912799, 'psi': 0.9932980072634743}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=40 head_norm_before_train=1.972760 (no previous merge yet)
[S16] round=40 local utility u=0.000000 metrics={'f1_val': 0.762831692320259, 'auprc': 0.9359355229039349, 'loss_val': 0.9476522617698512, 'psi': 0.8320732245537295}-{'f1_val': 0.9921222736473305, 'auprc': 0.9934067852983675, 'loss_val': 0.03470663886577366, 'psi': 0.9926360783077453}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=40 head_norm_before_train=1.660976 cos_to_last_merge=0.9999 (last merge round=38)
[S17] round=40 local utility u=0.179460 metrics={'f1_val': 0.706043357539403, 'auprc': 0.8712208937772226, 'loss_val': 0.8004342310897511, 'psi': 0.7721143720345307}-{'f1_val': 0.6775334709072096, 'auprc': 0.8310785980610912, 'loss_val': 0.8678676083664855, 'psi': 0.7389515217687623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[S10] sending update (kind=head size=1803 to 1 peers)
[S8] ⇄ pheromone p=0.024 → S17@127.0.0.1:54517
[S13] ⇄ pheromone p=0.065 → S10@127.0.0.1:54511
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1803 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9994
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.9994
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9999
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=40 metric=0.7060 head_norm=1.675175
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.062344e-02
[S17] stored merged vector for next round verification (round=40)
[S17] DEBUG after merge:  round=40 metric=0.7066 head_norm=1.668340 delta_norm=0.020623
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.068 → S8@127.0.0.1:54509
[S10] ⇄ pheromone p=0.006 → S13@127.0.0.1:54513
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=40 metric=0.7092 head_norm=1.774152
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.968224e-02
[S2] stored merged vector for next round verification (round=40)
[S2] DEBUG after merge:  round=40 metric=0.7104 head_norm=1.778863 delta_norm=0.029682
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.043 → S11@127.0.0.1:54512
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=40 metric=0.9965 head_norm=1.791507
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.228775e-02
[S11] stored merged vector for next round verification (round=40)
[S11] DEBUG after merge:  round=40 metric=0.9965 head_norm=1.782558 delta_norm=0.032288
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.059 → S2@127.0.0.1:54502
[S2] START round=41 head_norm_before_train=1.778863 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=41 local utility u=0.118610 metrics={'f1_val': 0.7099827510153286, 'auprc': 0.9903558688195099, 'loss_val': 0.4018281396625381, 'psi': 0.8221319981370011}-{'f1_val': 0.7091982379053667, 'auprc': 0.9097508499044065, 'loss_val': 0.3925257516004188, 'psi': 0.7894192827049826}
[S3] START round=41 head_norm_before_train=1.887592 cos_to_last_merge=0.9114 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.911
[S3] round=41 local utility u=0.000000 metrics={'f1_val': 0.9864458943787179, 'auprc': 0.9977571423421576, 'loss_val': 0.030949110166289, 'psi': 0.9909703935640938}-{'f1_val': 0.9968752412829052, 'auprc': 0.9972730605777835, 'loss_val': 0.021150764752733763, 'psi': 0.9970343690008565}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=41 head_norm_before_train=1.712361 cos_to_last_merge=0.8066 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=41 local utility u=0.000000 metrics={'f1_val': 0.9491709967467868, 'auprc': 0.9681668064901461, 'loss_val': 0.28305200126414776, 'psi': 0.9567693206441306}-{'f1_val': 0.9434782763927436, 'auprc': 0.9814246593863779, 'loss_val': 0.27166655620372576, 'psi': 0.9586568295901973}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=41 head_norm_before_train=2.002305 (no previous merge yet)
[S5] round=41 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9959453652522774, 'loss_val': 0.030956373592719813, 'psi': 0.9960897600864975}-{'f1_val': 0.996186023309311, 'auprc': 0.9960244750367929, 'loss_val': 0.030164922289462, 'psi': 0.9961214040003038}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=41 head_norm_before_train=1.610450 cos_to_last_merge=0.9136 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.914
[S6] round=41 local utility u=0.000000 metrics={'f1_val': 0.7715510677460553, 'auprc': 0.9487435386952725, 'loss_val': 0.5790903915109356, 'psi': 0.8424280561257422}-{'f1_val': 0.8738537793804929, 'auprc': 0.9616938032327392, 'loss_val': 0.324665682347338, 'psi': 0.9089897889213915}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=41 head_norm_before_train=1.754886 cos_to_last_merge=0.9908 (last merge round=17)
[S7] round=41 local utility u=0.001045 metrics={'f1_val': 0.579618389845513, 'auprc': 0.7878189482735783, 'loss_val': 0.7004076288474839, 'psi': 0.6628986132167392}-{'f1_val': 0.5848862175459317, 'auprc': 0.7891906110298206, 'loss_val': 0.7382190876767651, 'psi': 0.6666079749394873}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S7] sending update (kind=head size=1795 to 1 peers)
[S8] START round=41 head_norm_before_train=1.678404 cos_to_last_merge=0.9999 (last merge round=38)
[S8] round=41 local utility u=0.029129 metrics={'f1_val': 0.9928159069878363, 'auprc': 0.9992710568543987, 'loss_val': 0.03827918601501059, 'psi': 0.9953979669344613}-{'f1_val': 0.9857354242324556, 'auprc': 0.9993226803461597, 'loss_val': 0.05420990337413621, 'psi': 0.9911703266779373}
[S9] START round=41 head_norm_before_train=1.884453 cos_to_last_merge=0.9788 (last merge round=13)
[S9] round=41 local utility u=0.000000 metrics={'f1_val': 0.9878532334303461, 'auprc': 0.9997403392423378, 'loss_val': 0.04487503896049912, 'psi': 0.9926080757551429}-{'f1_val': 0.9966924912647621, 'auprc': 0.9997847612593043, 'loss_val': 0.01794832127159849, 'psi': 0.9979293992625791}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=41 head_norm_before_train=1.518698 cos_to_last_merge=1.0000 (last merge round=39)
[S10] round=41 local utility u=0.000905 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957913850247282, 'loss_val': 0.04011076450989061, 'psi': 0.9954292574215161}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957144929696125, 'loss_val': 0.041689916263785334, 'psi': 0.9953985005994699}
[S11] START round=41 head_norm_before_train=1.782558 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=41 local utility u=0.000000 metrics={'f1_val': 0.9783903400569145, 'auprc': 0.993515869069772, 'loss_val': 0.084936333046792, 'psi': 0.9844405516620575}-{'f1_val': 0.9965470045135896, 'auprc': 0.9937978696764728, 'loss_val': 0.03195218327443638, 'psi': 0.9954473505787429}
[S13] START round=41 head_norm_before_train=1.502848 cos_to_last_merge=0.9999 (last merge round=38)
[S13] round=41 local utility u=0.000158 metrics={'f1_val': 0.6288087547556154, 'auprc': 0.7483760642542198, 'loss_val': 0.938362880673627, 'psi': 0.6766356785550571}-{'f1_val': 0.6138682102688722, 'auprc': 0.7583932134663564, 'loss_val': 0.8790876451812156, 'psi': 0.6716782115478659}
[S14] START round=41 head_norm_before_train=1.681689 cos_to_last_merge=0.8573 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.857
[S14] round=41 local utility u=0.031869 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9985687392251317, 'loss_val': 0.03285914278261314, 'psi': 0.997872457391088}-{'f1_val': 0.9907123852087418, 'auprc': 0.9970075496114617, 'loss_val': 0.05173925342238254, 'psi': 0.9932304509698298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=41 head_norm_before_train=1.710608 cos_to_last_merge=0.9477 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.948
[S15] round=41 local utility u=1.000000 metrics={'f1_val': 0.988251595787773, 'auprc': 0.9781864429180998, 'loss_val': 0.06734584259561004, 'psi': 0.9842255346399037}-{'f1_val': 0.6970400288968347, 'auprc': 0.6695819825152247, 'loss_val': 0.6497429433395607, 'psi': 0.6860568103441907}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S15] sending update (kind=head size=1803 to 1 peers)
[S16] START round=41 head_norm_before_train=1.977267 (no previous merge yet)
[S16] round=41 local utility u=1.000000 metrics={'f1_val': 0.9925145813059836, 'auprc': 0.9906691140935046, 'loss_val': 0.04088538619849704, 'psi': 0.9917763944209921}-{'f1_val': 0.762831692320259, 'auprc': 0.9359355229039349, 'loss_val': 0.9476522617698512, 'psi': 0.8320732245537295}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=41 head_norm_before_train=1.668340 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=41 local utility u=0.000000 metrics={'f1_val': 0.6731664204717906, 'auprc': 0.7160784008504933, 'loss_val': 0.9263238453464202, 'psi': 0.6903312126232717}-{'f1_val': 0.706043357539403, 'auprc': 0.8712208937772226, 'loss_val': 0.8004342310897511, 'psi': 0.7721143720345307}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9997
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=0.9997
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9996
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=41 metric=0.9928 head_norm=1.695864
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.845788e-02
[S8] stored merged vector for next round verification (round=41)
[S8] DEBUG after merge:  round=41 metric=0.9928 head_norm=1.685311 delta_norm=0.028458
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=41 metric=0.6288 head_norm=1.509096
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.814879e-02
[S13] stored merged vector for next round verification (round=41)
[S13] DEBUG after merge:  round=41 metric=0.6270 head_norm=1.517736 delta_norm=0.018149
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=41 metric=0.9952 head_norm=1.534418
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.240522e-02
[S10] stored merged vector for next round verification (round=41)
[S10] DEBUG after merge:  round=41 metric=0.9952 head_norm=1.521645 delta_norm=0.022405
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=42 head_norm_before_train=1.790009 cos_to_last_merge=1.0000 (last merge round=40)
[S2] round=42 local utility u=0.000000 metrics={'f1_val': 0.7159120460504096, 'auprc': 0.917979322146389, 'loss_val': 0.453468086238651, 'psi': 0.7967389564888013}-{'f1_val': 0.7099827510153286, 'auprc': 0.9903558688195099, 'loss_val': 0.4018281396625381, 'psi': 0.8221319981370011}
[S3] START round=42 head_norm_before_train=1.899190 cos_to_last_merge=0.9104 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=42 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9982680217569924, 'loss_val': 0.11574009090680935, 'psi': 0.9762064968667485}-{'f1_val': 0.9864458943787179, 'auprc': 0.9977571423421576, 'loss_val': 0.030949110166289, 'psi': 0.9909703935640938}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=42 head_norm_before_train=1.718742 cos_to_last_merge=0.8068 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.807
[S4] round=42 local utility u=0.041189 metrics={'f1_val': 0.9527508745995811, 'auprc': 0.982798638548281, 'loss_val': 0.26604865058741634, 'psi': 0.964769980179061}-{'f1_val': 0.9491709967467868, 'auprc': 0.9681668064901461, 'loss_val': 0.28305200126414776, 'psi': 0.9567693206441306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=42 head_norm_before_train=2.011052 (no previous merge yet)
[S5] round=42 local utility u=0.001558 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9966738229907282, 'loss_val': 0.030026358414574482, 'psi': 0.9963811431818779}-{'f1_val': 0.996186023309311, 'auprc': 0.9959453652522774, 'loss_val': 0.030956373592719813, 'psi': 0.9960897600864975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=42 head_norm_before_train=1.621530 cos_to_last_merge=0.9124 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.912
[S6] round=42 local utility u=0.281870 metrics={'f1_val': 0.8304780514574902, 'auprc': 0.9614096282967186, 'loss_val': 0.4069102209634429, 'psi': 0.8828506821931816}-{'f1_val': 0.7715510677460553, 'auprc': 0.9487435386952725, 'loss_val': 0.5790903915109356, 'psi': 0.8424280561257422}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=42 head_norm_before_train=1.760363 cos_to_last_merge=0.9905 (last merge round=17)
[S7] round=42 local utility u=0.329045 metrics={'f1_val': 0.638240806313683, 'auprc': 0.8069154111601933, 'loss_val': 0.4513417097756324, 'psi': 0.7057106482522871}-{'f1_val': 0.579618389845513, 'auprc': 0.7878189482735783, 'loss_val': 0.7004076288474839, 'psi': 0.6628986132167392}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=42 head_norm_before_train=1.685311 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=42 local utility u=0.000000 metrics={'f1_val': 0.9755685450567725, 'auprc': 0.9866437179237061, 'loss_val': 0.08604336648804478, 'psi': 0.979998614203546}-{'f1_val': 0.9928159069878363, 'auprc': 0.9992710568543987, 'loss_val': 0.03827918601501059, 'psi': 0.9953979669344613}
[S9] START round=42 head_norm_before_train=1.894357 cos_to_last_merge=0.9784 (last merge round=13)
[S9] round=42 local utility u=0.040225 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9989341238849928, 'loss_val': 0.017505334655985534, 'psi': 0.9978353970612828}-{'f1_val': 0.9878532334303461, 'auprc': 0.9997403392423378, 'loss_val': 0.04487503896049912, 'psi': 0.9926080757551429}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=42 head_norm_before_train=1.521645 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=42 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956890161082015, 'loss_val': 0.03988080768680591, 'psi': 0.9953883098549055}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957913850247282, 'loss_val': 0.04011076450989061, 'psi': 0.9954292574215161}
[S11] START round=42 head_norm_before_train=1.795822 cos_to_last_merge=1.0000 (last merge round=40)
[S11] round=42 local utility u=0.000000 metrics={'f1_val': 0.8354759248114167, 'auprc': 0.9946792369866592, 'loss_val': 0.21141467514090956, 'psi': 0.8991572496815137}-{'f1_val': 0.9783903400569145, 'auprc': 0.993515869069772, 'loss_val': 0.084936333046792, 'psi': 0.9844405516620575}
[S13] START round=42 head_norm_before_train=1.517736 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=42 local utility u=0.000000 metrics={'f1_val': 0.5901528545163675, 'auprc': 0.7516041056793038, 'loss_val': 0.7867123259713582, 'psi': 0.654733354981542}-{'f1_val': 0.6288087547556154, 'auprc': 0.7483760642542198, 'loss_val': 0.938362880673627, 'psi': 0.6766356785550571}
[S14] START round=42 head_norm_before_train=1.691224 cos_to_last_merge=0.8562 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.856
[S14] round=42 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9969389765701774, 'loss_val': 0.03237691351971307, 'psi': 0.9972221871887679}-{'f1_val': 0.9974082695017256, 'auprc': 0.9985687392251317, 'loss_val': 0.03285914278261314, 'psi': 0.997872457391088}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=42 head_norm_before_train=1.719932 cos_to_last_merge=0.9468 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.947
[S15] round=42 local utility u=0.000000 metrics={'f1_val': 0.7743786799829555, 'auprc': 0.9498836263943908, 'loss_val': 0.3953108606764773, 'psi': 0.8445806585475297}-{'f1_val': 0.988251595787773, 'auprc': 0.9781864429180998, 'loss_val': 0.06734584259561004, 'psi': 0.9842255346399037}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=42 head_norm_before_train=1.981243 (no previous merge yet)
[S16] round=42 local utility u=0.000000 metrics={'f1_val': 0.8392210366423325, 'auprc': 0.8249294532676148, 'loss_val': 1.1211154496116789, 'psi': 0.8335044032924455}-{'f1_val': 0.9925145813059836, 'auprc': 0.9906691140935046, 'loss_val': 0.04088538619849704, 'psi': 0.9917763944209921}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=42 head_norm_before_train=1.678439 cos_to_last_merge=1.0000 (last merge round=40)
[S17] round=42 local utility u=0.690780 metrics={'f1_val': 0.7283851363372031, 'auprc': 0.9582987728378463, 'loss_val': 0.6027376038051424, 'psi': 0.8203505909374604}-{'f1_val': 0.6731664204717906, 'auprc': 0.7160784008504933, 'loss_val': 0.9263238453464202, 'psi': 0.6903312126232717}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1800 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=42 metric=0.8355 head_norm=1.808263
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.726211e-02
[S11] stored merged vector for next round verification (round=42)
[S11] DEBUG after merge:  round=42 metric=0.8355 head_norm=1.799076 delta_norm=0.017262
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9997
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=42 metric=0.7284 head_norm=1.689296
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.963149e-02
[S17] stored merged vector for next round verification (round=42)
[S17] DEBUG after merge:  round=42 metric=0.7289 head_norm=1.692324 delta_norm=0.029631
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=43 head_norm_before_train=1.800615 cos_to_last_merge=0.9999 (last merge round=40)
[S2] round=43 local utility u=0.000000 metrics={'f1_val': 0.7624057914360703, 'auprc': 0.7488645151363967, 'loss_val': 0.5878149734487065, 'psi': 0.7569892809162009}-{'f1_val': 0.7159120460504096, 'auprc': 0.917979322146389, 'loss_val': 0.453468086238651, 'psi': 0.7967389564888013}
[S3] START round=43 head_norm_before_train=1.908508 cos_to_last_merge=0.9096 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.910
[S3] round=43 local utility u=0.045413 metrics={'f1_val': 0.9702123025877877, 'auprc': 0.9977296508777898, 'loss_val': 0.07558005898427883, 'psi': 0.9812192419037886}-{'f1_val': 0.961498813606586, 'auprc': 0.9982680217569924, 'loss_val': 0.11574009090680935, 'psi': 0.9762064968667485}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=43 head_norm_before_train=1.726367 cos_to_last_merge=0.8063 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.806
[S4] round=43 local utility u=0.000000 metrics={'f1_val': 0.9487609510985812, 'auprc': 0.977206772033264, 'loss_val': 0.27596117644714513, 'psi': 0.9601392794724544}-{'f1_val': 0.9527508745995811, 'auprc': 0.982798638548281, 'loss_val': 0.26604865058741634, 'psi': 0.964769980179061}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=43 head_norm_before_train=2.019146 (no previous merge yet)
[S5] round=43 local utility u=0.001242 metrics={'f1_val': 0.996186023309311, 'auprc': 0.996859013496812, 'loss_val': 0.02809797881557022, 'psi': 0.9964552193843115}-{'f1_val': 0.996186023309311, 'auprc': 0.9966738229907282, 'loss_val': 0.030026358414574482, 'psi': 0.9963811431818779}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=43 head_norm_before_train=1.632406 cos_to_last_merge=0.9112 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.911
[S6] round=43 local utility u=0.000000 metrics={'f1_val': 0.8225643967972971, 'auprc': 0.9579534318453443, 'loss_val': 0.43688356803025347, 'psi': 0.876720010816516}-{'f1_val': 0.8304780514574902, 'auprc': 0.9614096282967186, 'loss_val': 0.4069102209634429, 'psi': 0.8828506821931816}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=43 head_norm_before_train=1.766129 cos_to_last_merge=0.9899 (last merge round=17)
[S7] round=43 local utility u=0.198893 metrics={'f1_val': 0.6759836532399088, 'auprc': 0.8288601940251435, 'loss_val': 0.34584679828547016, 'psi': 0.7371342695540027}-{'f1_val': 0.638240806313683, 'auprc': 0.8069154111601933, 'loss_val': 0.4513417097756324, 'psi': 0.7057106482522871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=43 head_norm_before_train=1.699623 cos_to_last_merge=1.0000 (last merge round=41)
[S8] round=43 local utility u=0.068639 metrics={'f1_val': 0.9860892612913941, 'auprc': 0.9994023955213331, 'loss_val': 0.0501661418506841, 'psi': 0.9914145149833697}-{'f1_val': 0.9755685450567725, 'auprc': 0.9866437179237061, 'loss_val': 0.08604336648804478, 'psi': 0.979998614203546}
[S9] START round=43 head_norm_before_train=1.898638 cos_to_last_merge=0.9788 (last merge round=13)
[S9] round=43 local utility u=0.000000 metrics={'f1_val': 0.9891288930766337, 'auprc': 0.9986514916010487, 'loss_val': 0.037783466391669226, 'psi': 0.9929379324863996}-{'f1_val': 0.9971029125121428, 'auprc': 0.9989341238849928, 'loss_val': 0.017505334655985534, 'psi': 0.9978353970612828}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=43 head_norm_before_train=1.538369 cos_to_last_merge=1.0000 (last merge round=41)
[S10] round=43 local utility u=0.001129 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958066006568425, 'loss_val': 0.037975758728567593, 'psi': 0.9954353436743618}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956890161082015, 'loss_val': 0.03988080768680591, 'psi': 0.9953883098549055}
[S11] START round=43 head_norm_before_train=1.799076 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=43 local utility u=0.046693 metrics={'f1_val': 0.8470142181627148, 'auprc': 0.994699983732563, 'loss_val': 0.18732059996751246, 'psi': 0.906088524390654}-{'f1_val': 0.8354759248114167, 'auprc': 0.9946792369866592, 'loss_val': 0.21141467514090956, 'psi': 0.8991572496815137}
[S13] START round=43 head_norm_before_train=1.520758 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=43 local utility u=0.000000 metrics={'f1_val': 0.5891082296652079, 'auprc': 0.7739047392859191, 'loss_val': 1.1087409399257528, 'psi': 0.6630268335134923}-{'f1_val': 0.5901528545163675, 'auprc': 0.7516041056793038, 'loss_val': 0.7867123259713582, 'psi': 0.654733354981542}
[S14] START round=43 head_norm_before_train=1.701396 cos_to_last_merge=0.8551 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.855
[S14] round=43 local utility u=0.000000 metrics={'f1_val': 0.9971652929977585, 'auprc': 0.9969198806553012, 'loss_val': 0.032367312668405486, 'psi': 0.9970671280607757}-{'f1_val': 0.9974109942678281, 'auprc': 0.9969389765701774, 'loss_val': 0.03237691351971307, 'psi': 0.9972221871887679}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=43 head_norm_before_train=1.727881 cos_to_last_merge=0.9461 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.946
[S15] round=43 local utility u=0.642286 metrics={'f1_val': 0.9207294653201064, 'auprc': 0.9948747656676438, 'loss_val': 0.12381752160546326, 'psi': 0.9503875854591213}-{'f1_val': 0.7743786799829555, 'auprc': 0.9498836263943908, 'loss_val': 0.3953108606764773, 'psi': 0.8445806585475297}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=43 head_norm_before_train=1.986640 (no previous merge yet)
[S16] round=43 local utility u=1.000000 metrics={'f1_val': 0.991177197015794, 'auprc': 0.9934535108461859, 'loss_val': 0.04289439099601421, 'psi': 0.9920877225479507}-{'f1_val': 0.8392210366423325, 'auprc': 0.8249294532676148, 'loss_val': 1.1211154496116789, 'psi': 0.8335044032924455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S16] sending update (kind=head size=1794 to 1 peers)
[S17] START round=43 head_norm_before_train=1.692324 cos_to_last_merge=1.0000 (last merge round=42)
[S17] round=43 local utility u=0.000000 metrics={'f1_val': 0.6731664204717906, 'auprc': 0.7404053081947601, 'loss_val': 0.9243552096618809, 'psi': 0.7000619755609785}-{'f1_val': 0.7283851363372031, 'auprc': 0.9582987728378463, 'loss_val': 0.6027376038051424, 'psi': 0.8203505909374604}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S11] → sending delta(kind=head bytes=1805) to S2@127.0.0.1:54502
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1801 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1805) from S11
[S2] cosine check vs S11: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=0.9998
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=43 metric=0.9861 head_norm=1.711333
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.499246e-02
[S8] stored merged vector for next round verification (round=43)
[S8] DEBUG after merge:  round=43 metric=0.9861 head_norm=1.700167 delta_norm=0.024992
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=43 metric=0.6732 head_norm=1.698973
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.359790e-02
[S17] stored merged vector for next round verification (round=43)
[S17] DEBUG after merge:  round=43 metric=0.6732 head_norm=1.705110 delta_norm=0.013598
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=44 head_norm_before_train=1.810478 cos_to_last_merge=0.9998 (last merge round=40)
[S2] round=44 local utility u=0.139623 metrics={'f1_val': 0.705726129336693, 'auprc': 0.9135955522172097, 'loss_val': 0.46268393893696513, 'psi': 0.7888738984888997}-{'f1_val': 0.7624057914360703, 'auprc': 0.7488645151363967, 'loss_val': 0.5878149734487065, 'psi': 0.7569892809162009}
[S3] START round=44 head_norm_before_train=1.917222 cos_to_last_merge=0.9087 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.909
[S3] round=44 local utility u=0.000000 metrics={'f1_val': 0.961498813606586, 'auprc': 0.9976611470663886, 'loss_val': 0.10464677281336317, 'psi': 0.975963746990507}-{'f1_val': 0.9702123025877877, 'auprc': 0.9977296508777898, 'loss_val': 0.07558005898427883, 'psi': 0.9812192419037886}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=44 head_norm_before_train=1.736349 cos_to_last_merge=0.8042 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.804
[S4] round=44 local utility u=0.000000 metrics={'f1_val': 0.9430366304454048, 'auprc': 0.959635995815576, 'loss_val': 0.27353303712754307, 'psi': 0.9496763765934733}-{'f1_val': 0.9487609510985812, 'auprc': 0.977206772033264, 'loss_val': 0.27596117644714513, 'psi': 0.9601392794724544}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=44 head_norm_before_train=2.035641 (no previous merge yet)
[S5] round=44 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9968156612477899, 'loss_val': 0.02844653024863059, 'psi': 0.9964378784847026}-{'f1_val': 0.996186023309311, 'auprc': 0.996859013496812, 'loss_val': 0.02809797881557022, 'psi': 0.9964552193843115}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=44 head_norm_before_train=1.644599 cos_to_last_merge=0.9100 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.910
[S6] round=44 local utility u=0.000000 metrics={'f1_val': 0.716812107351676, 'auprc': 0.886713756972098, 'loss_val': 0.5375267914664045, 'psi': 0.7847727671998448}-{'f1_val': 0.8225643967972971, 'auprc': 0.9579534318453443, 'loss_val': 0.43688356803025347, 'psi': 0.876720010816516}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=44 head_norm_before_train=1.770145 cos_to_last_merge=0.9897 (last merge round=17)
[S7] round=44 local utility u=0.000000 metrics={'f1_val': 0.6219359017483128, 'auprc': 0.7974735891482301, 'loss_val': 0.5307681090491225, 'psi': 0.6921509767082797}-{'f1_val': 0.6759836532399088, 'auprc': 0.8288601940251435, 'loss_val': 0.34584679828547016, 'psi': 0.7371342695540027}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=44 head_norm_before_train=1.700167 cos_to_last_merge=1.0000 (last merge round=43)
[S8] round=44 local utility u=0.021757 metrics={'f1_val': 0.9918109678295097, 'auprc': 0.9990749012512538, 'loss_val': 0.039999993050521966, 'psi': 0.9947165411982073}-{'f1_val': 0.9860892612913941, 'auprc': 0.9994023955213331, 'loss_val': 0.0501661418506841, 'psi': 0.9914145149833697}
[S9] START round=44 head_norm_before_train=1.904653 cos_to_last_merge=0.9789 (last merge round=13)
[S9] round=44 local utility u=0.034180 metrics={'f1_val': 0.9971000495392299, 'auprc': 0.9986779219116975, 'loss_val': 0.01732955710055174, 'psi': 0.997731198488217}-{'f1_val': 0.9891288930766337, 'auprc': 0.9986514916010487, 'loss_val': 0.037783466391669226, 'psi': 0.9929379324863996}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=44 head_norm_before_train=1.555470 cos_to_last_merge=0.9999 (last merge round=41)
[S10] round=44 local utility u=0.001813 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961258925852301, 'loss_val': 0.03530744653710346, 'psi': 0.9955630604457169}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958066006568425, 'loss_val': 0.037975758728567593, 'psi': 0.9954353436743618}
[S11] START round=44 head_norm_before_train=1.813275 cos_to_last_merge=1.0000 (last merge round=42)
[S11] round=44 local utility u=0.000000 metrics={'f1_val': 0.8350477587984185, 'auprc': 0.9946741340635341, 'loss_val': 0.2140586807935013, 'psi': 0.8988983089044646}-{'f1_val': 0.8470142181627148, 'auprc': 0.994699983732563, 'loss_val': 0.18732059996751246, 'psi': 0.906088524390654}
[S13] START round=44 head_norm_before_train=1.523171 cos_to_last_merge=1.0000 (last merge round=41)
[S13] round=44 local utility u=0.149130 metrics={'f1_val': 0.6058054271940028, 'auprc': 0.7753328268307613, 'loss_val': 0.9149476381312385, 'psi': 0.6736163870487062}-{'f1_val': 0.5891082296652079, 'auprc': 0.7739047392859191, 'loss_val': 1.1087409399257528, 'psi': 0.6630268335134923}
[S14] START round=44 head_norm_before_train=1.711351 cos_to_last_merge=0.8540 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.854
[S14] round=44 local utility u=0.001830 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9968956901008283, 'loss_val': 0.03009265534381217, 'psi': 0.9972032377413667}-{'f1_val': 0.9971652929977585, 'auprc': 0.9969198806553012, 'loss_val': 0.032367312668405486, 'psi': 0.9970671280607757}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=44 head_norm_before_train=1.738514 cos_to_last_merge=0.9451 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.945
[S15] round=44 local utility u=0.000000 metrics={'f1_val': 0.8092441798622668, 'auprc': 0.9575668663569854, 'loss_val': 0.3731714346155592, 'psi': 0.8685732544601543}-{'f1_val': 0.9207294653201064, 'auprc': 0.9948747656676438, 'loss_val': 0.12381752160546326, 'psi': 0.9503875854591213}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=44 head_norm_before_train=1.993497 (no previous merge yet)
[S16] round=44 local utility u=0.000000 metrics={'f1_val': 0.9627963235248074, 'auprc': 0.9911465595198589, 'loss_val': 0.10511694163987909, 'psi': 0.974136417922828}-{'f1_val': 0.991177197015794, 'auprc': 0.9934535108461859, 'loss_val': 0.04289439099601421, 'psi': 0.9920877225479507}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=44 head_norm_before_train=1.705110 cos_to_last_merge=1.0000 (last merge round=43)
[S17] round=44 local utility u=0.201586 metrics={'f1_val': 0.6656249758844669, 'auprc': 0.8753231684060385, 'loss_val': 0.8806874399380795, 'psi': 0.7495042528930955}-{'f1_val': 0.6731664204717906, 'auprc': 0.7404053081947601, 'loss_val': 0.9243552096618809, 'psi': 0.7000619755609785}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S10] → sending delta(kind=head bytes=1792) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[S8] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1797 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1792 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9996
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=0.9996
[S13] RECEIVED delta(kind=head bytes=1792) from S10
[S13] cosine check vs S10: cos=0.9996
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=44 metric=0.6656 head_norm=1.709426
[S17] _apply_head_vector_avg (torch): Δ‖w‖=9.169696e-03
[S17] stored merged vector for next round verification (round=44)
[S17] DEBUG after merge:  round=44 metric=0.6656 head_norm=1.709811 delta_norm=0.009170
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=44 metric=0.9918 head_norm=1.710245
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.169693e-03
[S8] stored merged vector for next round verification (round=44)
[S8] DEBUG after merge:  round=44 metric=0.9918 head_norm=1.709811 delta_norm=0.009170
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=44 metric=0.7057 head_norm=1.818588
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.232304e-02
[S2] stored merged vector for next round verification (round=44)
[S2] DEBUG after merge:  round=44 metric=0.7057 head_norm=1.815797 delta_norm=0.022323
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=44 metric=0.6058 head_norm=1.523957
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.727883e-02
[S13] stored merged vector for next round verification (round=44)
[S13] DEBUG after merge:  round=44 metric=0.6053 head_norm=1.543695 delta_norm=0.027279
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=44 metric=0.9952 head_norm=1.571868
[S10] _apply_head_vector_avg (torch): Δ‖w‖=3.210600e-02
[S10] stored merged vector for next round verification (round=44)
[S10] DEBUG after merge:  round=44 metric=0.9952 head_norm=1.547765 delta_norm=0.032106
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=45 head_norm_before_train=1.815797 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=45 local utility u=0.000000 metrics={'f1_val': 0.6939618352813324, 'auprc': 0.7574279499443234, 'loss_val': 0.8330264720850863, 'psi': 0.7193482811465288}-{'f1_val': 0.705726129336693, 'auprc': 0.9135955522172097, 'loss_val': 0.46268393893696513, 'psi': 0.7888738984888997}
[S3] START round=45 head_norm_before_train=1.927550 cos_to_last_merge=0.9079 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.908
[S3] round=45 local utility u=0.000000 metrics={'f1_val': 0.8623612133863862, 'auprc': 0.9960107803829003, 'loss_val': 0.248710744201518, 'psi': 0.9158210401849918}-{'f1_val': 0.961498813606586, 'auprc': 0.9976611470663886, 'loss_val': 0.10464677281336317, 'psi': 0.975963746990507}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=45 head_norm_before_train=1.740756 cos_to_last_merge=0.8025 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.802
[S4] round=45 local utility u=0.040886 metrics={'f1_val': 0.9506371993377409, 'auprc': 0.9728144313018237, 'loss_val': 0.2768991667619314, 'psi': 0.9595080921233741}-{'f1_val': 0.9430366304454048, 'auprc': 0.959635995815576, 'loss_val': 0.27353303712754307, 'psi': 0.9496763765934733}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=45 head_norm_before_train=2.044506 (no previous merge yet)
[S5] round=45 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9939397622960696, 'loss_val': 0.029280257789130956, 'psi': 0.9952875189040145}-{'f1_val': 0.996186023309311, 'auprc': 0.9968156612477899, 'loss_val': 0.02844653024863059, 'psi': 0.9964378784847026}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=45 head_norm_before_train=1.653080 cos_to_last_merge=0.9092 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=45 local utility u=0.107096 metrics={'f1_val': 0.7583907090612777, 'auprc': 0.9317926549081132, 'loss_val': 0.708042725685643, 'psi': 0.8277514874000119}-{'f1_val': 0.716812107351676, 'auprc': 0.886713756972098, 'loss_val': 0.5375267914664045, 'psi': 0.7847727671998448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=45 head_norm_before_train=1.774332 cos_to_last_merge=0.9895 (last merge round=17)
[S7] round=45 local utility u=0.000000 metrics={'f1_val': 0.46136703834986714, 'auprc': 0.7132983110192805, 'loss_val': 1.1940331006770675, 'psi': 0.5621395474176325}-{'f1_val': 0.6219359017483128, 'auprc': 0.7974735891482301, 'loss_val': 0.5307681090491225, 'psi': 0.6921509767082797}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=45 head_norm_before_train=1.709811 cos_to_last_merge=1.0000 (last merge round=44)
[S8] round=45 local utility u=0.000000 metrics={'f1_val': 0.9939009886418481, 'auprc': 0.9880750849012758, 'loss_val': 0.04939871295331799, 'psi': 0.9915706271456192}-{'f1_val': 0.9918109678295097, 'auprc': 0.9990749012512538, 'loss_val': 0.039999993050521966, 'psi': 0.9947165411982073}
[S9] START round=45 head_norm_before_train=1.914459 cos_to_last_merge=0.9785 (last merge round=13)
[S9] round=45 local utility u=0.000000 metrics={'f1_val': 0.9966924912647621, 'auprc': 0.9983985428742912, 'loss_val': 0.017725562931645233, 'psi': 0.9973749119085737}-{'f1_val': 0.9971000495392299, 'auprc': 0.9986779219116975, 'loss_val': 0.01732955710055174, 'psi': 0.997731198488217}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=45 head_norm_before_train=1.547765 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=45 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958679399192701, 'loss_val': 0.036674293486301156, 'psi': 0.9954598793793329}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961258925852301, 'loss_val': 0.03530744653710346, 'psi': 0.9955630604457169}
[S11] START round=45 head_norm_before_train=1.825750 cos_to_last_merge=0.9999 (last merge round=42)
[S11] round=45 local utility u=0.553253 metrics={'f1_val': 0.991278415311192, 'auprc': 0.9929730049010868, 'loss_val': 0.03983291966782127, 'psi': 0.9919562511471499}-{'f1_val': 0.8350477587984185, 'auprc': 0.9946741340635341, 'loss_val': 0.2140586807935013, 'psi': 0.8988983089044646}
[S13] START round=45 head_norm_before_train=1.543695 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=45 local utility u=0.108899 metrics={'f1_val': 0.6283935999800601, 'auprc': 0.7553201772092677, 'loss_val': 0.7726407400958278, 'psi': 0.6791642308717432}-{'f1_val': 0.6058054271940028, 'auprc': 0.7753328268307613, 'loss_val': 0.9149476381312385, 'psi': 0.6736163870487062}
[S14] START round=45 head_norm_before_train=1.722260 cos_to_last_merge=0.8531 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.853
[S14] round=45 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9968581839604589, 'loss_val': 0.030052203404426034, 'psi': 0.9971882352852189}-{'f1_val': 0.9974082695017256, 'auprc': 0.9968956901008283, 'loss_val': 0.03009265534381217, 'psi': 0.9972032377413667}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=45 head_norm_before_train=1.749908 cos_to_last_merge=0.9441 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.944
[S15] round=45 local utility u=0.000000 metrics={'f1_val': 0.7981255927561717, 'auprc': 0.9454552703810108, 'loss_val': 0.39891357327615684, 'psi': 0.8570574638061074}-{'f1_val': 0.8092441798622668, 'auprc': 0.9575668663569854, 'loss_val': 0.3731714346155592, 'psi': 0.8685732544601543}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=45 head_norm_before_train=1.998766 (no previous merge yet)
[S16] round=45 local utility u=0.131075 metrics={'f1_val': 0.993234067434887, 'auprc': 0.9942064731297466, 'loss_val': 0.03477237928165587, 'psi': 0.9936230297128309}-{'f1_val': 0.9627963235248074, 'auprc': 0.9911465595198589, 'loss_val': 0.10511694163987909, 'psi': 0.974136417922828}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=45 head_norm_before_train=1.709811 cos_to_last_merge=1.0000 (last merge round=44)
[S17] round=45 local utility u=0.594679 metrics={'f1_val': 0.7249082577982772, 'auprc': 0.9939207655111144, 'loss_val': 0.40282100410255917, 'psi': 0.832513260883412}-{'f1_val': 0.6656249758844669, 'auprc': 0.8753231684060385, 'loss_val': 0.8806874399380795, 'psi': 0.7495042528930955}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S17] → sending delta(kind=head bytes=1795) to S8@127.0.0.1:54509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S11] → sending delta(kind=head bytes=1803) to S2@127.0.0.1:54502
[S11] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S2] ⇄ pheromone p=0.046 → S11@127.0.0.1:54512
[S17] sending update (kind=head size=1795 to 1 peers)
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:54513
[S8] ⇄ pheromone p=0.023 → S17@127.0.0.1:54517
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1803) from S11
[S2] cosine check vs S11: cos=0.9997
[S8] RECEIVED delta(kind=head bytes=1795) from S17
[S8] cosine check vs S17: cos=0.9998
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=45 metric=0.9913 head_norm=1.836494
[S11] _apply_head_vector_avg (torch): Δ‖w‖=3.002320e-02
[S11] stored merged vector for next round verification (round=45)
[S11] DEBUG after merge:  round=45 metric=0.9913 head_norm=1.827317 delta_norm=0.030023
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.136 → S2@127.0.0.1:54502
[S17] ⇄ pheromone p=0.244 → S8@127.0.0.1:54509
[S13] ⇄ pheromone p=0.067 → S10@127.0.0.1:54511
[S2] START round=46 head_norm_before_train=1.824470 cos_to_last_merge=1.0000 (last merge round=44)
[S2] round=46 local utility u=0.426900 metrics={'f1_val': 0.706334756648305, 'auprc': 0.8915590085197045, 'loss_val': 0.45585675274336573, 'psi': 0.7804244573968648}-{'f1_val': 0.6939618352813324, 'auprc': 0.7574279499443234, 'loss_val': 0.8330264720850863, 'psi': 0.7193482811465288}
[S3] START round=46 head_norm_before_train=1.935091 cos_to_last_merge=0.9072 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.907
[S3] round=46 local utility u=0.336057 metrics={'f1_val': 0.959400038305751, 'auprc': 0.9922140998602662, 'loss_val': 0.1474404260124559, 'psi': 0.9725256629275572}-{'f1_val': 0.8623612133863862, 'auprc': 0.9960107803829003, 'loss_val': 0.248710744201518, 'psi': 0.9158210401849918}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=46 head_norm_before_train=1.746722 cos_to_last_merge=0.8012 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=46 local utility u=0.000000 metrics={'f1_val': 0.9523925740863408, 'auprc': 0.9680829941441906, 'loss_val': 0.2788334964804665, 'psi': 0.9586687421094807}-{'f1_val': 0.9506371993377409, 'auprc': 0.9728144313018237, 'loss_val': 0.2768991667619314, 'psi': 0.9595080921233741}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=46 head_norm_before_train=2.050270 (no previous merge yet)
[S5] round=46 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9907467033638837, 'loss_val': 0.031125421019459643, 'psi': 0.99401029533114}-{'f1_val': 0.996186023309311, 'auprc': 0.9939397622960696, 'loss_val': 0.029280257789130956, 'psi': 0.9952875189040145}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=46 head_norm_before_train=1.658837 cos_to_last_merge=0.9087 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.909
[S6] round=46 local utility u=0.292509 metrics={'f1_val': 0.8139949747607705, 'auprc': 0.9521037520535565, 'loss_val': 0.517583345665801, 'psi': 0.869238485677885}-{'f1_val': 0.7583907090612777, 'auprc': 0.9317926549081132, 'loss_val': 0.708042725685643, 'psi': 0.8277514874000119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=46 head_norm_before_train=1.781134 cos_to_last_merge=0.9891 (last merge round=17)
[S7] round=46 local utility u=0.541498 metrics={'f1_val': 0.5642128505487894, 'auprc': 0.7794558648354776, 'loss_val': 0.9265849682900765, 'psi': 0.6503100562634647}-{'f1_val': 0.46136703834986714, 'auprc': 0.7132983110192805, 'loss_val': 1.1940331006770675, 'psi': 0.5621395474176325}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=46 head_norm_before_train=1.720201 cos_to_last_merge=0.9999 (last merge round=44)
[S8] round=46 local utility u=0.014892 metrics={'f1_val': 0.9915135233404582, 'auprc': 0.9992989414623291, 'loss_val': 0.03896236876746052, 'psi': 0.9946276905892066}-{'f1_val': 0.9939009886418481, 'auprc': 0.9880750849012758, 'loss_val': 0.04939871295331799, 'psi': 0.9915706271456192}
[S9] START round=46 head_norm_before_train=1.926353 cos_to_last_merge=0.9780 (last merge round=13)
[S9] round=46 local utility u=0.000000 metrics={'f1_val': 0.9950237510807955, 'auprc': 0.9984072949272869, 'loss_val': 0.019336750991140277, 'psi': 0.9963771686193921}-{'f1_val': 0.9966924912647621, 'auprc': 0.9983985428742912, 'loss_val': 0.017725562931645233, 'psi': 0.9973749119085737}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=46 head_norm_before_train=1.563518 cos_to_last_merge=1.0000 (last merge round=44)
[S10] round=46 local utility u=0.000607 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956757150833624, 'loss_val': 0.03488334046019945, 'psi': 0.9953829894449697}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958679399192701, 'loss_val': 0.036674293486301156, 'psi': 0.9954598793793329}
[S11] START round=46 head_norm_before_train=1.827317 cos_to_last_merge=1.0000 (last merge round=45)
[S11] round=46 local utility u=0.023605 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994190355774535, 'loss_val': 0.027887076047623586, 'psi': 0.9956043450179677}-{'f1_val': 0.991278415311192, 'auprc': 0.9929730049010868, 'loss_val': 0.03983291966782127, 'psi': 0.9919562511471499}
[S13] START round=46 head_norm_before_train=1.544628 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=46 local utility u=0.000000 metrics={'f1_val': 0.6372043975107922, 'auprc': 0.6571561072185228, 'loss_val': 0.8217184286399384, 'psi': 0.6451850813938844}-{'f1_val': 0.6283935999800601, 'auprc': 0.7553201772092677, 'loss_val': 0.7726407400958278, 'psi': 0.6791642308717432}
[S14] START round=46 head_norm_before_train=1.731671 cos_to_last_merge=0.8522 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.852
[S14] round=46 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9927640447753932, 'loss_val': 0.03521842351871957, 'psi': 0.995306045838704}-{'f1_val': 0.9974082695017256, 'auprc': 0.9968581839604589, 'loss_val': 0.030052203404426034, 'psi': 0.9971882352852189}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=46 head_norm_before_train=1.759722 cos_to_last_merge=0.9430 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.943
[S15] round=46 local utility u=0.839820 metrics={'f1_val': 0.9943228426139201, 'auprc': 0.9918466365031597, 'loss_val': 0.035630216415478054, 'psi': 0.9933323601696159}-{'f1_val': 0.7981255927561717, 'auprc': 0.9454552703810108, 'loss_val': 0.39891357327615684, 'psi': 0.8570574638061074}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S15] sending update (kind=head size=1792 to 1 peers)
[S16] START round=46 head_norm_before_train=2.004529 (no previous merge yet)
[S16] round=46 local utility u=0.000000 metrics={'f1_val': 0.8568828736569718, 'auprc': 0.8274568231393993, 'loss_val': 0.9735531507981509, 'psi': 0.8451124534499428}-{'f1_val': 0.993234067434887, 'auprc': 0.9942064731297466, 'loss_val': 0.03477237928165587, 'psi': 0.9936230297128309}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=46 head_norm_before_train=1.710112 cos_to_last_merge=0.9998 (last merge round=44)
[S17] round=46 local utility u=0.000000 metrics={'f1_val': 0.6999797408091942, 'auprc': 0.9344795862878825, 'loss_val': 0.5181209841982231, 'psi': 0.7937796790006695}-{'f1_val': 0.7249082577982772, 'auprc': 0.9939207655111144, 'loss_val': 0.40282100410255917, 'psi': 0.832513260883412}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S2] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9994
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=46 metric=0.9915 head_norm=1.733147
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.434996e-02
[S8] stored merged vector for next round verification (round=46)
[S8] DEBUG after merge:  round=46 metric=0.9915 head_norm=1.721496 delta_norm=0.024350
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=46 metric=0.9952 head_norm=1.579206
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.173329e-02
[S10] stored merged vector for next round verification (round=46)
[S10] DEBUG after merge:  round=46 metric=0.9952 head_norm=1.561861 delta_norm=0.021733
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=46 metric=0.9965 head_norm=1.836947
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.553536e-02
[S11] stored merged vector for next round verification (round=46)
[S11] DEBUG after merge:  round=46 metric=0.9965 head_norm=1.835485 delta_norm=0.015535
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=46 metric=0.7063 head_norm=1.834154
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.026039e-02
[S2] stored merged vector for next round verification (round=46)
[S2] DEBUG after merge:  round=46 metric=0.7064 head_norm=1.835306 delta_norm=0.020260
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] START round=47 head_norm_before_train=1.835306 cos_to_last_merge=1.0000 (last merge round=46)
[S2] round=47 local utility u=0.188360 metrics={'f1_val': 0.7093044201604037, 'auprc': 0.9921968024577624, 'loss_val': 0.3988690891567278, 'psi': 0.8224613730793473}-{'f1_val': 0.706334756648305, 'auprc': 0.8915590085197045, 'loss_val': 0.45585675274336573, 'psi': 0.7804244573968648}
[S3] START round=47 head_norm_before_train=1.946042 cos_to_last_merge=0.9063 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.906
[S3] round=47 local utility u=0.033242 metrics={'f1_val': 0.9615785680382265, 'auprc': 0.9971647025466759, 'loss_val': 0.10888012369968213, 'psi': 0.9758130218416062}-{'f1_val': 0.959400038305751, 'auprc': 0.9922140998602662, 'loss_val': 0.1474404260124559, 'psi': 0.9725256629275572}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=47 head_norm_before_train=1.753400 cos_to_last_merge=0.8007 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.801
[S4] round=47 local utility u=0.000000 metrics={'f1_val': 0.9503400827697313, 'auprc': 0.9685686948011973, 'loss_val': 0.27989101210079687, 'psi': 0.9576315275823176}-{'f1_val': 0.9523925740863408, 'auprc': 0.9680829941441906, 'loss_val': 0.2788334964804665, 'psi': 0.9586687421094807}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=47 head_norm_before_train=2.052273 (no previous merge yet)
[S5] round=47 local utility u=0.001245 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9914135612914222, 'loss_val': 0.030635127971523103, 'psi': 0.9942770385021555}-{'f1_val': 0.996186023309311, 'auprc': 0.9907467033638837, 'loss_val': 0.031125421019459643, 'psi': 0.99401029533114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=47 head_norm_before_train=1.666673 cos_to_last_merge=0.9078 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.908
[S6] round=47 local utility u=0.057525 metrics={'f1_val': 0.8227457967461387, 'auprc': 0.9605132322350126, 'loss_val': 0.48026585346728295, 'psi': 0.8778527709416882}-{'f1_val': 0.8139949747607705, 'auprc': 0.9521037520535565, 'loss_val': 0.517583345665801, 'psi': 0.869238485677885}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=47 head_norm_before_train=1.785519 cos_to_last_merge=0.9889 (last merge round=17)
[S7] round=47 local utility u=0.000000 metrics={'f1_val': 0.49601049523852164, 'auprc': 0.7811449299927891, 'loss_val': 0.8075616559701948, 'psi': 0.6100642691402287}-{'f1_val': 0.5642128505487894, 'auprc': 0.7794558648354776, 'loss_val': 0.9265849682900765, 'psi': 0.6503100562634647}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=47 head_norm_before_train=1.721496 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=47 local utility u=0.000000 metrics={'f1_val': 0.9865760319309516, 'auprc': 0.9993200424253161, 'loss_val': 0.046256156765665066, 'psi': 0.9916736361286974}-{'f1_val': 0.9915135233404582, 'auprc': 0.9992989414623291, 'loss_val': 0.03896236876746052, 'psi': 0.9946276905892066}
[S9] START round=47 head_norm_before_train=1.938517 cos_to_last_merge=0.9774 (last merge round=13)
[S9] round=47 local utility u=0.000000 metrics={'f1_val': 0.9937421749897083, 'auprc': 0.9984136944590749, 'loss_val': 0.023222146140865024, 'psi': 0.995610782777455}-{'f1_val': 0.9950237510807955, 'auprc': 0.9984072949272869, 'loss_val': 0.019336750991140277, 'psi': 0.9963771686193921}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=47 head_norm_before_train=1.561861 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=47 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954609760746734, 'loss_val': 0.03570473336232614, 'psi': 0.9952970938414942}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956757150833624, 'loss_val': 0.03488334046019945, 'psi': 0.9953829894449697}
[S11] START round=47 head_norm_before_train=1.835485 cos_to_last_merge=1.0000 (last merge round=46)
[S11] round=47 local utility u=0.000219 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994184451464218, 'loss_val': 0.02743045550987825, 'psi': 0.995601983293841}-{'f1_val': 0.9965470045135896, 'auprc': 0.994190355774535, 'loss_val': 0.027887076047623586, 'psi': 0.9956043450179677}
[S13] START round=47 head_norm_before_train=1.546239 cos_to_last_merge=1.0000 (last merge round=44)
[S13] round=47 local utility u=0.247899 metrics={'f1_val': 0.6759358545690688, 'auprc': 0.77659334980132, 'loss_val': 0.9166218279401952, 'psi': 0.7161988526619693}-{'f1_val': 0.6372043975107922, 'auprc': 0.6571561072185228, 'loss_val': 0.8217184286399384, 'psi': 0.6451850813938844}
[S14] START round=47 head_norm_before_train=1.741431 cos_to_last_merge=0.8512 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.851
[S14] round=47 local utility u=0.011314 metrics={'f1_val': 0.996754531653698, 'auprc': 0.9985533612265316, 'loss_val': 0.028481769560695983, 'psi': 0.9974740634828314}-{'f1_val': 0.9970007132142444, 'auprc': 0.9927640447753932, 'loss_val': 0.03521842351871957, 'psi': 0.995306045838704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=47 head_norm_before_train=1.765987 cos_to_last_merge=0.9422 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.942
[S15] round=47 local utility u=0.000000 metrics={'f1_val': 0.8082148924373527, 'auprc': 0.9863165786899696, 'loss_val': 0.3451881096679767, 'psi': 0.8794555669383994}-{'f1_val': 0.9943228426139201, 'auprc': 0.9918466365031597, 'loss_val': 0.035630216415478054, 'psi': 0.9933323601696159}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=47 head_norm_before_train=2.006609 (no previous merge yet)
[S16] round=47 local utility u=0.852986 metrics={'f1_val': 0.9429298906058471, 'auprc': 0.9850121169612168, 'loss_val': 0.25652851677072264, 'psi': 0.959762781147995}-{'f1_val': 0.8568828736569718, 'auprc': 0.8274568231393993, 'loss_val': 0.9735531507981509, 'psi': 0.8451124534499428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=47 head_norm_before_train=1.712104 cos_to_last_merge=0.9996 (last merge round=44)
[S17] round=47 local utility u=0.000000 metrics={'f1_val': 0.6747543151558472, 'auprc': 0.8738269999336432, 'loss_val': 0.6740756920852192, 'psi': 0.7543833890669656}-{'f1_val': 0.6999797408091942, 'auprc': 0.9344795862878825, 'loss_val': 0.5181209841982231, 'psi': 0.7937796790006695}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[S2] sending update (kind=head size=1801 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=47 metric=0.6748 head_norm=1.717605
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.286268e-02
[S17] stored merged vector for next round verification (round=47)
[S17] DEBUG after merge:  round=47 metric=0.6737 head_norm=1.725080 delta_norm=0.032863
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1797 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=1.0000
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=47 metric=0.6759 head_norm=1.549297
[S13] _apply_head_vector_avg (torch): Δ‖w‖=2.032654e-02
[S13] stored merged vector for next round verification (round=47)
[S13] DEBUG after merge:  round=47 metric=0.6760 head_norm=1.564191 delta_norm=0.020327
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=47 metric=0.9965 head_norm=1.845810
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.651122e-03
[S11] stored merged vector for next round verification (round=47)
[S11] DEBUG after merge:  round=47 metric=0.9965 head_norm=1.844844 delta_norm=0.004651
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=47 metric=0.7093 head_norm=1.843890
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.651123e-03
[S2] stored merged vector for next round verification (round=47)
[S2] DEBUG after merge:  round=47 metric=0.7093 head_norm=1.844844 delta_norm=0.004651
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=48 head_norm_before_train=1.844844 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=48 local utility u=0.000000 metrics={'f1_val': 0.7292436486408218, 'auprc': 0.9025428251731572, 'loss_val': 0.34165390786879213, 'psi': 0.798563319253756}-{'f1_val': 0.7093044201604037, 'auprc': 0.9921968024577624, 'loss_val': 0.3988690891567278, 'psi': 0.8224613730793473}
[S3] START round=48 head_norm_before_train=1.958136 cos_to_last_merge=0.9053 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.905
[S3] round=48 local utility u=0.000000 metrics={'f1_val': 0.7468414843097148, 'auprc': 0.9926936445592065, 'loss_val': 0.5091366857059846, 'psi': 0.8451823484095116}-{'f1_val': 0.9615785680382265, 'auprc': 0.9971647025466759, 'loss_val': 0.10888012369968213, 'psi': 0.9758130218416062}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=48 head_norm_before_train=1.760665 cos_to_last_merge=0.8001 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.800
[S4] round=48 local utility u=0.000000 metrics={'f1_val': 0.9327123483028579, 'auprc': 0.954287929811192, 'loss_val': 0.2813915826144487, 'psi': 0.9413425809061915}-{'f1_val': 0.9503400827697313, 'auprc': 0.9685686948011973, 'loss_val': 0.27989101210079687, 'psi': 0.9576315275823176}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=48 head_norm_before_train=2.059150 (no previous merge yet)
[S5] round=48 local utility u=0.002615 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9934679208599705, 'loss_val': 0.0315686971198161, 'psi': 0.9950987823295748}-{'f1_val': 0.996186023309311, 'auprc': 0.9914135612914222, 'loss_val': 0.030635127971523103, 'psi': 0.9942770385021555}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=48 head_norm_before_train=1.674824 cos_to_last_merge=0.9070 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.907
[S6] round=48 local utility u=0.000000 metrics={'f1_val': 0.7846558228667069, 'auprc': 0.9450151321186762, 'loss_val': 0.5866617746409623, 'psi': 0.8487995465674946}-{'f1_val': 0.8227457967461387, 'auprc': 0.9605132322350126, 'loss_val': 0.48026585346728295, 'psi': 0.8778527709416882}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=48 head_norm_before_train=1.787486 cos_to_last_merge=0.9884 (last merge round=17)
[S7] round=48 local utility u=0.730389 metrics={'f1_val': 0.6713501201969866, 'auprc': 0.8236518266702861, 'loss_val': 0.5263413232889794, 'psi': 0.7322708027863064}-{'f1_val': 0.49601049523852164, 'auprc': 0.7811449299927891, 'loss_val': 0.8075616559701948, 'psi': 0.6100642691402287}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=48 head_norm_before_train=1.735875 cos_to_last_merge=1.0000 (last merge round=46)
[S8] round=48 local utility u=0.000000 metrics={'f1_val': 0.9836444136069047, 'auprc': 0.998958317953065, 'loss_val': 0.05508863843833871, 'psi': 0.9897699753453688}-{'f1_val': 0.9865760319309516, 'auprc': 0.9993200424253161, 'loss_val': 0.046256156765665066, 'psi': 0.9916736361286974}
[S9] START round=48 head_norm_before_train=1.949208 cos_to_last_merge=0.9769 (last merge round=13)
[S9] round=48 local utility u=0.005762 metrics={'f1_val': 0.994994420763055, 'auprc': 0.9986546789112227, 'loss_val': 0.019935166204949544, 'psi': 0.996458524022322}-{'f1_val': 0.9937421749897083, 'auprc': 0.9984136944590749, 'loss_val': 0.023222146140865024, 'psi': 0.995610782777455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S9] sending update (kind=head size=1797 to 1 peers)
[S10] START round=48 head_norm_before_train=1.577315 cos_to_last_merge=1.0000 (last merge round=46)
[S10] round=48 local utility u=0.000962 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955985067498603, 'loss_val': 0.03419404486591567, 'psi': 0.9953521061115689}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954609760746734, 'loss_val': 0.03570473336232614, 'psi': 0.9952970938414942}
[S11] START round=48 head_norm_before_train=1.844844 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=48 local utility u=0.001311 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9942934277971838, 'loss_val': 0.026585006796225535, 'psi': 0.9957906010244921}-{'f1_val': 0.9965470045135896, 'auprc': 0.994184451464218, 'loss_val': 0.02743045550987825, 'psi': 0.995601983293841}
[S13] START round=48 head_norm_before_train=1.564191 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=48 local utility u=0.000000 metrics={'f1_val': 0.6381284722164815, 'auprc': 0.7837691788054009, 'loss_val': 0.8221593699613743, 'psi': 0.6963847548520492}-{'f1_val': 0.6759358545690688, 'auprc': 0.77659334980132, 'loss_val': 0.9166218279401952, 'psi': 0.7161988526619693}
[S14] START round=48 head_norm_before_train=1.752936 cos_to_last_merge=0.8502 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.850
[S14] round=48 local utility u=0.000000 metrics={'f1_val': 0.9967577367102773, 'auprc': 0.9969821798841179, 'loss_val': 0.029276216893134144, 'psi': 0.9968475139798136}-{'f1_val': 0.996754531653698, 'auprc': 0.9985533612265316, 'loss_val': 0.028481769560695983, 'psi': 0.9974740634828314}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=48 head_norm_before_train=1.774740 cos_to_last_merge=0.9413 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.941
[S15] round=48 local utility u=0.674676 metrics={'f1_val': 0.9808575349244999, 'auprc': 0.9936799342169687, 'loss_val': 0.05378122371956339, 'psi': 0.9859864946414874}-{'f1_val': 0.8082148924373527, 'auprc': 0.9863165786899696, 'loss_val': 0.3451881096679767, 'psi': 0.8794555669383994}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S15] sending update (kind=head size=1805 to 1 peers)
[S16] START round=48 head_norm_before_train=2.010491 (no previous merge yet)
[S16] round=48 local utility u=0.266225 metrics={'f1_val': 0.9911667333818835, 'auprc': 0.9945953417359761, 'loss_val': 0.04224936286904856, 'psi': 0.9925381767235206}-{'f1_val': 0.9429298906058471, 'auprc': 0.9850121169612168, 'loss_val': 0.25652851677072264, 'psi': 0.959762781147995}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=48 head_norm_before_train=1.725080 cos_to_last_merge=1.0000 (last merge round=47)
[S17] round=48 local utility u=0.000000 metrics={'f1_val': 0.6455579745795059, 'auprc': 0.8724935194314075, 'loss_val': 0.9360631767787411, 'psi': 0.7363321925202666}-{'f1_val': 0.6747543151558472, 'auprc': 0.8738269999336432, 'loss_val': 0.6740756920852192, 'psi': 0.7543833890669656}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[S10] sending update (kind=head size=1796 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=48 metric=0.9952 head_norm=1.590996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=2.693146e-02
[S10] stored merged vector for next round verification (round=48)
[S10] DEBUG after merge:  round=48 metric=0.9952 head_norm=1.570054 delta_norm=0.026931
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=49 head_norm_before_train=1.853702 cos_to_last_merge=1.0000 (last merge round=47)
[S2] round=49 local utility u=0.037027 metrics={'f1_val': 0.7155741024186909, 'auprc': 0.9837562842961622, 'loss_val': 0.42922397706362025, 'psi': 0.8228469751696794}-{'f1_val': 0.7292436486408218, 'auprc': 0.9025428251731572, 'loss_val': 0.34165390786879213, 'psi': 0.798563319253756}
[S3] START round=49 head_norm_before_train=1.969286 cos_to_last_merge=0.9043 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=49 local utility u=0.816713 metrics={'f1_val': 0.9608203197691346, 'auprc': 0.9964268693310895, 'loss_val': 0.17078319487942661, 'psi': 0.9750629395939165}-{'f1_val': 0.7468414843097148, 'auprc': 0.9926936445592065, 'loss_val': 0.5091366857059846, 'psi': 0.8451823484095116}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S3] sending update (kind=head size=1800 to 1 peers)
[S4] START round=49 head_norm_before_train=1.769476 cos_to_last_merge=0.7995 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=49 local utility u=0.058888 metrics={'f1_val': 0.9458469205761693, 'auprc': 0.9650807974924157, 'loss_val': 0.2748022947274254, 'psi': 0.9535404713426678}-{'f1_val': 0.9327123483028579, 'auprc': 0.954287929811192, 'loss_val': 0.2813915826144487, 'psi': 0.9413425809061915}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=49 head_norm_before_train=2.058022 (no previous merge yet)
[S5] round=49 local utility u=0.005895 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9981108375974332, 'loss_val': 0.03458689158907907, 'psi': 0.9970438896322675}-{'f1_val': 0.996186023309311, 'auprc': 0.9934679208599705, 'loss_val': 0.0315686971198161, 'psi': 0.9950987823295748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=49 head_norm_before_train=1.681725 cos_to_last_merge=0.9060 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.906
[S6] round=49 local utility u=0.719596 metrics={'f1_val': 0.9474639849965504, 'auprc': 0.9732517369989435, 'loss_val': 0.20902954623516534, 'psi': 0.9577790857975076}-{'f1_val': 0.7846558228667069, 'auprc': 0.9450151321186762, 'loss_val': 0.5866617746409623, 'psi': 0.8487995465674946}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=49 head_norm_before_train=1.794615 cos_to_last_merge=0.9876 (last merge round=17)
[S7] round=49 local utility u=0.000000 metrics={'f1_val': 0.6425186069239871, 'auprc': 0.7965469070754054, 'loss_val': 0.685675333535593, 'psi': 0.7041299269845545}-{'f1_val': 0.6713501201969866, 'auprc': 0.8236518266702861, 'loss_val': 0.5263413232889794, 'psi': 0.7322708027863064}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=49 head_norm_before_train=1.747084 cos_to_last_merge=0.9999 (last merge round=46)
[S8] round=49 local utility u=0.022442 metrics={'f1_val': 0.9888673888296693, 'auprc': 0.9991555693600016, 'loss_val': 0.0421350281911831, 'psi': 0.9929826610418022}-{'f1_val': 0.9836444136069047, 'auprc': 0.998958317953065, 'loss_val': 0.05508863843833871, 'psi': 0.9897699753453688}
[S9] START round=49 head_norm_before_train=1.953479 cos_to_last_merge=0.9762 (last merge round=13)
[S9] round=49 local utility u=0.005799 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.998473735913289, 'loss_val': 0.017791107213012382, 'psi': 0.9973858014536505}-{'f1_val': 0.994994420763055, 'auprc': 0.9986546789112227, 'loss_val': 0.019935166204949544, 'psi': 0.996458524022322}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=49 head_norm_before_train=1.570054 cos_to_last_merge=1.0000 (last merge round=48)
[S10] round=49 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955801311583028, 'loss_val': 0.03478832559207272, 'psi': 0.995344755874946}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955985067498603, 'loss_val': 0.03419404486591567, 'psi': 0.9953521061115689}
[S11] START round=49 head_norm_before_train=1.856644 cos_to_last_merge=1.0000 (last merge round=47)
[S11] round=49 local utility u=0.000826 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9944689437783747, 'loss_val': 0.025460410395536728, 'psi': 0.9958608074169686}-{'f1_val': 0.9967887165093644, 'auprc': 0.9942934277971838, 'loss_val': 0.026585006796225535, 'psi': 0.9957906010244921}
[S13] START round=49 head_norm_before_train=1.569985 cos_to_last_merge=1.0000 (last merge round=47)
[S13] round=49 local utility u=0.093045 metrics={'f1_val': 0.6618288470537156, 'auprc': 0.7831826878904107, 'loss_val': 0.7765126903174233, 'psi': 0.7103703833883936}-{'f1_val': 0.6381284722164815, 'auprc': 0.7837691788054009, 'loss_val': 0.8221593699613743, 'psi': 0.6963847548520492}
[S14] START round=49 head_norm_before_train=1.763945 cos_to_last_merge=0.8494 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=49 local utility u=0.001420 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.9969569218746377, 'loss_val': 0.031272807891084956, 'psi': 0.9973286936278059}-{'f1_val': 0.9967577367102773, 'auprc': 0.9969821798841179, 'loss_val': 0.029276216893134144, 'psi': 0.9968475139798136}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=49 head_norm_before_train=1.784972 cos_to_last_merge=0.9404 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.940
[S15] round=49 local utility u=0.000000 metrics={'f1_val': 0.7720048036910782, 'auprc': 0.9101088236219562, 'loss_val': 0.44879153395278415, 'psi': 0.8272464116634294}-{'f1_val': 0.9808575349244999, 'auprc': 0.9936799342169687, 'loss_val': 0.05378122371956339, 'psi': 0.9859864946414874}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=49 head_norm_before_train=2.016481 (no previous merge yet)
[S16] round=49 local utility u=0.000000 metrics={'f1_val': 0.990911838499136, 'auprc': 0.9948904312006248, 'loss_val': 0.04554085347816542, 'psi': 0.9925032755797315}-{'f1_val': 0.9911667333818835, 'auprc': 0.9945953417359761, 'loss_val': 0.04224936286904856, 'psi': 0.9925381767235206}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=49 head_norm_before_train=1.739249 cos_to_last_merge=0.9999 (last merge round=47)
[S17] round=49 local utility u=0.000000 metrics={'f1_val': 0.6632747976328871, 'auprc': 0.8562777638390108, 'loss_val': 1.0569382933765894, 'psi': 0.7404759841153365}-{'f1_val': 0.6455579745795059, 'auprc': 0.8724935194314075, 'loss_val': 0.9360631767787411, 'psi': 0.7363321925202666}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=0.9994
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=49 metric=0.6618 head_norm=1.577240
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.596473e-02
[S13] stored merged vector for next round verification (round=49)
[S13] DEBUG after merge:  round=49 metric=0.6619 head_norm=1.584053 delta_norm=0.015965
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=49 metric=0.7156 head_norm=1.860857
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.117766e-02
[S2] stored merged vector for next round verification (round=49)
[S2] DEBUG after merge:  round=49 metric=0.7156 head_norm=1.861920 delta_norm=0.011178
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=49 metric=0.9968 head_norm=1.869471
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.384680e-02
[S11] stored merged vector for next round verification (round=49)
[S11] DEBUG after merge:  round=49 metric=0.9968 head_norm=1.865118 delta_norm=0.013847
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=50 head_norm_before_train=1.861920 cos_to_last_merge=1.0000 (last merge round=49)
[S2] round=50 local utility u=0.008455 metrics={'f1_val': 0.7299708507133812, 'auprc': 0.9406724513616217, 'loss_val': 0.36944317923828757, 'psi': 0.8142514909726775}-{'f1_val': 0.7155741024186909, 'auprc': 0.9837562842961622, 'loss_val': 0.42922397706362025, 'psi': 0.8228469751696794}
[S3] START round=50 head_norm_before_train=1.977548 cos_to_last_merge=0.9038 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.904
[S3] round=50 local utility u=0.000000 metrics={'f1_val': 0.9231524373132362, 'auprc': 0.9951777994158774, 'loss_val': 0.1494153695531411, 'psi': 0.9519625821542925}-{'f1_val': 0.9608203197691346, 'auprc': 0.9964268693310895, 'loss_val': 0.17078319487942661, 'psi': 0.9750629395939165}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=50 head_norm_before_train=1.775002 cos_to_last_merge=0.7992 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.799
[S4] round=50 local utility u=0.004458 metrics={'f1_val': 0.9517812949624944, 'auprc': 0.9605454116623685, 'loss_val': 0.2878868062034977, 'psi': 0.955286941642444}-{'f1_val': 0.9458469205761693, 'auprc': 0.9650807974924157, 'loss_val': 0.2748022947274254, 'psi': 0.9535404713426678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=50 head_norm_before_train=2.051687 (no previous merge yet)
[S5] round=50 local utility u=0.000000 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9982291851751091, 'loss_val': 0.03668570360050338, 'psi': 0.9968720635046139}-{'f1_val': 0.9963325909888239, 'auprc': 0.9981108375974332, 'loss_val': 0.03458689158907907, 'psi': 0.9970438896322675}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=50 head_norm_before_train=1.693894 cos_to_last_merge=0.9049 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.905
[S6] round=50 local utility u=0.000000 metrics={'f1_val': 0.5962177246649816, 'auprc': 0.8726068415841329, 'loss_val': 1.0756995294481553, 'psi': 0.7067733714326421}-{'f1_val': 0.9474639849965504, 'auprc': 0.9732517369989435, 'loss_val': 0.20902954623516534, 'psi': 0.9577790857975076}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=50 head_norm_before_train=1.793742 cos_to_last_merge=0.9871 (last merge round=17)
[S7] round=50 local utility u=0.000000 metrics={'f1_val': 0.47815870072996397, 'auprc': 0.7797159484282199, 'loss_val': 1.0444662575181847, 'psi': 0.5987815998092664}-{'f1_val': 0.6425186069239871, 'auprc': 0.7965469070754054, 'loss_val': 0.685675333535593, 'psi': 0.7041299269845545}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=50 head_norm_before_train=1.756804 cos_to_last_merge=0.9999 (last merge round=46)
[S8] round=50 local utility u=0.000000 metrics={'f1_val': 0.9931648515513533, 'auprc': 0.9868305673766296, 'loss_val': 0.0444193810446329, 'psi': 0.9906311378814638}-{'f1_val': 0.9888673888296693, 'auprc': 0.9991555693600016, 'loss_val': 0.0421350281911831, 'psi': 0.9929826610418022}
[S9] START round=50 head_norm_before_train=1.960072 cos_to_last_merge=0.9758 (last merge round=13)
[S9] round=50 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986713323261567, 'loss_val': 0.01817279839797169, 'psi': 0.9973146443307952}-{'f1_val': 0.9966605118138915, 'auprc': 0.998473735913289, 'loss_val': 0.017791107213012382, 'psi': 0.9973858014536505}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=50 head_norm_before_train=1.583242 cos_to_last_merge=1.0000 (last merge round=48)
[S10] round=50 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954422252193016, 'loss_val': 0.03457047062906441, 'psi': 0.9952895934993455}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955801311583028, 'loss_val': 0.03478832559207272, 'psi': 0.995344755874946}
[S11] START round=50 head_norm_before_train=1.865118 cos_to_last_merge=1.0000 (last merge round=49)
[S11] round=50 local utility u=0.000000 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.994541758506874, 'loss_val': 0.024922262826008304, 'psi': 0.9957449061109034}-{'f1_val': 0.9967887165093644, 'auprc': 0.9944689437783747, 'loss_val': 0.025460410395536728, 'psi': 0.9958608074169686}
[S13] START round=50 head_norm_before_train=1.584053 cos_to_last_merge=1.0000 (last merge round=49)
[S13] round=50 local utility u=0.000000 metrics={'f1_val': 0.644137368999466, 'auprc': 0.7875690428766824, 'loss_val': 0.819520223805739, 'psi': 0.7015100385503525}-{'f1_val': 0.6618288470537156, 'auprc': 0.7831826878904107, 'loss_val': 0.7765126903174233, 'psi': 0.7103703833883936}
[S14] START round=50 head_norm_before_train=1.774765 cos_to_last_merge=0.8486 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.849
[S14] round=50 local utility u=0.004391 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.998226757873218, 'loss_val': 0.027757475404882378, 'psi': 0.9979824139296183}-{'f1_val': 0.9975765414632514, 'auprc': 0.9969569218746377, 'loss_val': 0.031272807891084956, 'psi': 0.9973286936278059}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=50 head_norm_before_train=1.795675 cos_to_last_merge=0.9395 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=50 local utility u=0.365660 metrics={'f1_val': 0.831810268160216, 'auprc': 0.9926692177940792, 'loss_val': 0.3239857476344286, 'psi': 0.8961538480137613}-{'f1_val': 0.7720048036910782, 'auprc': 0.9101088236219562, 'loss_val': 0.44879153395278415, 'psi': 0.8272464116634294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S16] START round=50 head_norm_before_train=2.023293 (no previous merge yet)
[S16] round=50 local utility u=0.000000 metrics={'f1_val': 0.9773479431903584, 'auprc': 0.9895509797989006, 'loss_val': 0.08350069713962342, 'psi': 0.9822291578337754}-{'f1_val': 0.990911838499136, 'auprc': 0.9948904312006248, 'loss_val': 0.04554085347816542, 'psi': 0.9925032755797315}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=50 head_norm_before_train=1.754358 cos_to_last_merge=0.9997 (last merge round=47)
[S17] round=50 local utility u=0.000000 metrics={'f1_val': 0.6324170621045622, 'auprc': 0.7295662899519758, 'loss_val': 1.21205312391743, 'psi': 0.6712767532435276}-{'f1_val': 0.6632747976328871, 'auprc': 0.8562777638390108, 'loss_val': 1.0569382933765894, 'psi': 0.7404759841153365}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1801 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=50 metric=0.9952 head_norm=1.595080
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.771310e-02
[S10] stored merged vector for next round verification (round=50)
[S10] DEBUG after merge:  round=50 metric=0.9952 head_norm=1.586086 delta_norm=0.017713
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:54513
[S13] ⇄ pheromone p=0.062 → S10@127.0.0.1:54511
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=50 metric=0.6324 head_norm=1.767945
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.918447e-02
[S17] stored merged vector for next round verification (round=50)
[S17] DEBUG after merge:  round=50 metric=0.6334 head_norm=1.761948 delta_norm=0.039184
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.080 → S8@127.0.0.1:54509
[S8] ⇄ pheromone p=0.012 → S17@127.0.0.1:54517
[S11] ⇄ pheromone p=0.047 → S2@127.0.0.1:54502
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] ⇄ pheromone p=0.077 → S11@127.0.0.1:54512
[S2] START round=51 head_norm_before_train=1.869516 cos_to_last_merge=1.0000 (last merge round=49)
[S2] round=51 local utility u=0.000000 metrics={'f1_val': 0.7089474458383239, 'auprc': 0.9468662811708023, 'loss_val': 0.41521763516216886, 'psi': 0.8041149799713152}-{'f1_val': 0.7299708507133812, 'auprc': 0.9406724513616217, 'loss_val': 0.36944317923828757, 'psi': 0.8142514909726775}
[S3] START round=51 head_norm_before_train=1.977345 cos_to_last_merge=0.9033 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=51 local utility u=0.000000 metrics={'f1_val': 0.7048611036063841, 'auprc': 0.995798699875615, 'loss_val': 0.7273565021050771, 'psi': 0.8212361421140765}-{'f1_val': 0.9231524373132362, 'auprc': 0.9951777994158774, 'loss_val': 0.1494153695531411, 'psi': 0.9519625821542925}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=51 head_norm_before_train=1.780525 cos_to_last_merge=0.7984 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.798
[S4] round=51 local utility u=0.029699 metrics={'f1_val': 0.9546096176685179, 'auprc': 0.9708958215197195, 'loss_val': 0.2765105427680621, 'psi': 0.9611240992089987}-{'f1_val': 0.9517812949624944, 'auprc': 0.9605454116623685, 'loss_val': 0.2878868062034977, 'psi': 0.955286941642444}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=51 head_norm_before_train=2.047002 (no previous merge yet)
[S5] round=51 local utility u=0.000000 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9966755602475889, 'loss_val': 0.03169872202836028, 'psi': 0.9961630457656476}-{'f1_val': 0.9959673157242839, 'auprc': 0.9982291851751091, 'loss_val': 0.03668570360050338, 'psi': 0.9968720635046139}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=51 head_norm_before_train=1.703145 cos_to_last_merge=0.9038 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.904
[S6] round=51 local utility u=1.000000 metrics={'f1_val': 0.8077601172563886, 'auprc': 0.9550257937201414, 'loss_val': 0.5736961631233632, 'psi': 0.8666663878418898}-{'f1_val': 0.5962177246649816, 'auprc': 0.8726068415841329, 'loss_val': 1.0756995294481553, 'psi': 0.7067733714326421}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=51 head_norm_before_train=1.792500 cos_to_last_merge=0.9864 (last merge round=17)
[S7] round=51 local utility u=0.424277 metrics={'f1_val': 0.5633950659233032, 'auprc': 0.7841546396425589, 'loss_val': 0.7206457773400262, 'psi': 0.6516988954110056}-{'f1_val': 0.47815870072996397, 'auprc': 0.7797159484282199, 'loss_val': 1.0444662575181847, 'psi': 0.5987815998092664}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S7] sending update (kind=head size=1805 to 1 peers)
[S8] START round=51 head_norm_before_train=1.765504 cos_to_last_merge=0.9998 (last merge round=46)
[S8] round=51 local utility u=0.000000 metrics={'f1_val': 0.9854461996159931, 'auprc': 0.9993193214351074, 'loss_val': 0.048089499153425426, 'psi': 0.9909954483436387}-{'f1_val': 0.9931648515513533, 'auprc': 0.9868305673766296, 'loss_val': 0.0444193810446329, 'psi': 0.9906311378814638}
[S9] START round=51 head_norm_before_train=1.963890 cos_to_last_merge=0.9751 (last merge round=13)
[S9] round=51 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9986969440505276, 'loss_val': 0.01826709367495833, 'psi': 0.9973248890205435}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986713323261567, 'loss_val': 0.01817279839797169, 'psi': 0.9973146443307952}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=51 head_norm_before_train=1.586086 cos_to_last_merge=1.0000 (last merge round=50)
[S10] round=51 local utility u=0.003566 metrics={'f1_val': 0.9956028077628096, 'auprc': 0.9961530364117088, 'loss_val': 0.03206100239690188, 'psi': 0.9958228992223693}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954422252193016, 'loss_val': 0.03457047062906441, 'psi': 0.9952895934993455}
[S11] START round=51 head_norm_before_train=1.878134 cos_to_last_merge=1.0000 (last merge round=49)
[S11] round=51 local utility u=0.000000 metrics={'f1_val': 0.9907069787181216, 'auprc': 0.9948320404885622, 'loss_val': 0.0736713772099273, 'psi': 0.9923570034262978}-{'f1_val': 0.9965470045135896, 'auprc': 0.994541758506874, 'loss_val': 0.024922262826008304, 'psi': 0.9957449061109034}
[S13] START round=51 head_norm_before_train=1.592675 cos_to_last_merge=0.9999 (last merge round=49)
[S13] round=51 local utility u=0.029251 metrics={'f1_val': 0.6622513714185202, 'auprc': 0.8198450472049179, 'loss_val': 0.9665297304126673, 'psi': 0.7252888417330793}-{'f1_val': 0.644137368999466, 'auprc': 0.7875690428766824, 'loss_val': 0.819520223805739, 'psi': 0.7015100385503525}
[S14] START round=51 head_norm_before_train=1.784819 cos_to_last_merge=0.8479 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.848
[S14] round=51 local utility u=0.001918 metrics={'f1_val': 0.997240356705793, 'auprc': 0.9989084089333395, 'loss_val': 0.02249158025577244, 'psi': 0.9979075775968116}-{'f1_val': 0.9978195179672185, 'auprc': 0.998226757873218, 'loss_val': 0.027757475404882378, 'psi': 0.9979824139296183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=51 head_norm_before_train=1.806398 cos_to_last_merge=0.9385 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.939
[S15] round=51 local utility u=0.000000 metrics={'f1_val': 0.7013768519461108, 'auprc': 0.8276084020758672, 'loss_val': 0.5745403400861485, 'psi': 0.7518694719980134}-{'f1_val': 0.831810268160216, 'auprc': 0.9926692177940792, 'loss_val': 0.3239857476344286, 'psi': 0.8961538480137613}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=51 head_norm_before_train=2.030803 (no previous merge yet)
[S16] round=51 local utility u=0.000000 metrics={'f1_val': 0.9434237345869408, 'auprc': 0.9832111354188082, 'loss_val': 0.2574235712163432, 'psi': 0.9593386949196878}-{'f1_val': 0.9773479431903584, 'auprc': 0.9895509797989006, 'loss_val': 0.08350069713962342, 'psi': 0.9822291578337754}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=51 head_norm_before_train=1.761948 cos_to_last_merge=1.0000 (last merge round=50)
[S17] round=51 local utility u=0.052496 metrics={'f1_val': 0.6394689795880023, 'auprc': 0.7327259404458888, 'loss_val': 1.1588506885091723, 'psi': 0.6767717639311569}-{'f1_val': 0.6324170621045622, 'auprc': 0.7295662899519758, 'loss_val': 1.21205312391743, 'psi': 0.6712767532435276}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S13] → sending delta(kind=head bytes=1797) to S10@127.0.0.1:54511
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=51 metric=0.9907 head_norm=1.888097
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.486922e-02
[S11] stored merged vector for next round verification (round=51)
[S11] DEBUG after merge:  round=51 metric=0.9907 head_norm=1.878770 delta_norm=0.014869
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1797 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9998
[S10] RECEIVED delta(kind=head bytes=1797) from S13
[S10] cosine check vs S13: cos=0.9998
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=51 metric=0.9956 head_norm=1.599263
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.455481e-02
[S10] stored merged vector for next round verification (round=51)
[S10] DEBUG after merge:  round=51 metric=0.9956 head_norm=1.599860 delta_norm=0.014555
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9993
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=51 metric=0.6623 head_norm=1.600588
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.455481e-02
[S13] stored merged vector for next round verification (round=51)
[S13] DEBUG after merge:  round=51 metric=0.6551 head_norm=1.599860 delta_norm=0.014555
[S13] aggregate: ROLLBACK (f1_val pre=0.662 post=0.655 tol_abs=0.005 tol_rel=0.0)
[S2] START round=52 head_norm_before_train=1.877876 cos_to_last_merge=1.0000 (last merge round=49)
[S2] round=52 local utility u=0.052359 metrics={'f1_val': 0.7500002867157598, 'auprc': 0.893031574559198, 'loss_val': 0.3953127543134652, 'psi': 0.807212801853135}-{'f1_val': 0.7089474458383239, 'auprc': 0.9468662811708023, 'loss_val': 0.41521763516216886, 'psi': 0.8041149799713152}
[S3] START round=52 head_norm_before_train=1.982360 cos_to_last_merge=0.9027 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.903
[S3] round=52 local utility u=1.000000 metrics={'f1_val': 0.9452172368145484, 'auprc': 0.9969816979004644, 'loss_val': 0.1223652201176828, 'psi': 0.9659230212489148}-{'f1_val': 0.7048611036063841, 'auprc': 0.995798699875615, 'loss_val': 0.7273565021050771, 'psi': 0.8212361421140765}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S3] sending update (kind=head size=1792 to 1 peers)
[S4] START round=52 head_norm_before_train=1.787658 cos_to_last_merge=0.7974 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.797
[S4] round=52 local utility u=0.000000 metrics={'f1_val': 0.9494236389077746, 'auprc': 0.9699931897668059, 'loss_val': 0.28978324560034324, 'psi': 0.9576514592513872}-{'f1_val': 0.9546096176685179, 'auprc': 0.9708958215197195, 'loss_val': 0.2765105427680621, 'psi': 0.9611240992089987}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=52 head_norm_before_train=2.056520 (no previous merge yet)
[S5] round=52 local utility u=0.001916 metrics={'f1_val': 0.996186023309311, 'auprc': 0.996570282280838, 'loss_val': 0.02973850398538597, 'psi': 0.9963397268979218}-{'f1_val': 0.9958213694443535, 'auprc': 0.9966755602475889, 'loss_val': 0.03169872202836028, 'psi': 0.9961630457656476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=52 head_norm_before_train=1.711149 cos_to_last_merge=0.9031 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.903
[S6] round=52 local utility u=0.789660 metrics={'f1_val': 0.9836863217050213, 'auprc': 0.9815650802436914, 'loss_val': 0.1295503901030197, 'psi': 0.9828378251204893}-{'f1_val': 0.8077601172563886, 'auprc': 0.9550257937201414, 'loss_val': 0.5736961631233632, 'psi': 0.8666663878418898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=52 head_norm_before_train=1.794778 cos_to_last_merge=0.9863 (last merge round=17)
[S7] round=52 local utility u=0.888550 metrics={'f1_val': 0.7764041153016755, 'auprc': 0.8266216846510761, 'loss_val': 0.34900141483328334, 'psi': 0.7964911430414358}-{'f1_val': 0.5633950659233032, 'auprc': 0.7841546396425589, 'loss_val': 0.7206457773400262, 'psi': 0.6516988954110056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=52 head_norm_before_train=1.776516 cos_to_last_merge=0.9997 (last merge round=46)
[S8] round=52 local utility u=0.000000 metrics={'f1_val': 0.9836444136069047, 'auprc': 0.9993183048582822, 'loss_val': 0.05084412371106781, 'psi': 0.9899139701074557}-{'f1_val': 0.9854461996159931, 'auprc': 0.9993193214351074, 'loss_val': 0.048089499153425426, 'psi': 0.9909954483436387}
[S9] START round=52 head_norm_before_train=1.967281 cos_to_last_merge=0.9742 (last merge round=13)
[S9] round=52 local utility u=0.000000 metrics={'f1_val': 0.993909773892786, 'auprc': 0.9987376143500802, 'loss_val': 0.022895896114213343, 'psi': 0.9958409100757037}-{'f1_val': 0.9964101856672208, 'auprc': 0.9986969440505276, 'loss_val': 0.01826709367495833, 'psi': 0.9973248890205435}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=52 head_norm_before_train=1.599860 cos_to_last_merge=1.0000 (last merge round=51)
[S10] round=52 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9948673022872142, 'loss_val': 0.03486073065342114, 'psi': 0.9950596243265105}-{'f1_val': 0.9956028077628096, 'auprc': 0.9961530364117088, 'loss_val': 0.03206100239690188, 'psi': 0.9958228992223693}
[S11] START round=52 head_norm_before_train=1.878770 cos_to_last_merge=1.0000 (last merge round=51)
[S11] round=52 local utility u=0.000000 metrics={'f1_val': 0.83575105877516, 'auprc': 0.9947387675772256, 'loss_val': 0.21795553772824627, 'psi': 0.8993461422959862}-{'f1_val': 0.9907069787181216, 'auprc': 0.9948320404885622, 'loss_val': 0.0736713772099273, 'psi': 0.9923570034262978}
[S13] START round=52 head_norm_before_train=1.599860 cos_to_last_merge=1.0000 (last merge round=51)
[S13] round=52 local utility u=0.000000 metrics={'f1_val': 0.6482937381241405, 'auprc': 0.8357131769870274, 'loss_val': 0.9930065834173954, 'psi': 0.7232615136692953}-{'f1_val': 0.6622513714185202, 'auprc': 0.8198450472049179, 'loss_val': 0.9665297304126673, 'psi': 0.7252888417330793}
[S14] START round=52 head_norm_before_train=1.793148 cos_to_last_merge=0.8473 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.847
[S14] round=52 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9989000971563899, 'loss_val': 0.022845829848742488, 'psi': 0.9979061759199793}-{'f1_val': 0.997240356705793, 'auprc': 0.9989084089333395, 'loss_val': 0.02249158025577244, 'psi': 0.9979075775968116}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=52 head_norm_before_train=1.815217 cos_to_last_merge=0.9378 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.938
[S15] round=52 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9929873073460731, 'loss_val': 0.02602920452804323, 'psi': 0.9951104903041801}-{'f1_val': 0.7013768519461108, 'auprc': 0.8276084020758672, 'loss_val': 0.5745403400861485, 'psi': 0.7518694719980134}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=52 head_norm_before_train=2.037212 (no previous merge yet)
[S16] round=52 local utility u=0.000000 metrics={'f1_val': 0.9419153745760588, 'auprc': 0.9790762460653564, 'loss_val': 0.2701409435001123, 'psi': 0.9567797231717778}-{'f1_val': 0.9434237345869408, 'auprc': 0.9832111354188082, 'loss_val': 0.2574235712163432, 'psi': 0.9593386949196878}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=52 head_norm_before_train=1.770690 cos_to_last_merge=0.9999 (last merge round=50)
[S17] round=52 local utility u=0.833070 metrics={'f1_val': 0.776052592994817, 'auprc': 0.8672663767131664, 'loss_val': 0.7158343695825852, 'psi': 0.8125381064821569}-{'f1_val': 0.6394689795880023, 'auprc': 0.7327259404458888, 'loss_val': 1.1588506885091723, 'psi': 0.6767717639311569}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S2] → sending delta(kind=head bytes=1806) to S11@127.0.0.1:54512
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=52 metric=0.9836 head_norm=1.785671
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.601231e-02
[S8] stored merged vector for next round verification (round=52)
[S8] DEBUG after merge:  round=52 metric=0.9836 head_norm=1.777832 delta_norm=0.036012
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1806 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1806) from S2
[S11] cosine check vs S2: cos=0.9999
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=53 head_norm_before_train=1.886293 cos_to_last_merge=0.9999 (last merge round=49)
[S2] round=53 local utility u=0.000000 metrics={'f1_val': 0.6581672693184624, 'auprc': 0.7885220693305022, 'loss_val': 0.7629776223528139, 'psi': 0.7103091893232782}-{'f1_val': 0.7500002867157598, 'auprc': 0.893031574559198, 'loss_val': 0.3953127543134652, 'psi': 0.807212801853135}
[S3] START round=53 head_norm_before_train=1.991081 cos_to_last_merge=0.9020 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.902
[S3] round=53 local utility u=0.010545 metrics={'f1_val': 0.9608296089712303, 'auprc': 0.991026862807268, 'loss_val': 0.17708536486114615, 'psi': 0.9729085105056454}-{'f1_val': 0.9452172368145484, 'auprc': 0.9969816979004644, 'loss_val': 0.1223652201176828, 'psi': 0.9659230212489148}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=53 head_norm_before_train=1.794111 cos_to_last_merge=0.7965 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.796
[S4] round=53 local utility u=0.000000 metrics={'f1_val': 0.9429080284218507, 'auprc': 0.9711754876277279, 'loss_val': 0.2940155536722596, 'psi': 0.9542150121042016}-{'f1_val': 0.9494236389077746, 'auprc': 0.9699931897668059, 'loss_val': 0.28978324560034324, 'psi': 0.9576514592513872}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=53 head_norm_before_train=2.065242 (no previous merge yet)
[S5] round=53 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.995061448562193, 'loss_val': 0.030034408386604317, 'psi': 0.9957361934104638}-{'f1_val': 0.996186023309311, 'auprc': 0.996570282280838, 'loss_val': 0.02973850398538597, 'psi': 0.9963397268979218}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=53 head_norm_before_train=1.720598 cos_to_last_merge=0.9024 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.902
[S6] round=53 local utility u=0.000000 metrics={'f1_val': 0.5960420128614163, 'auprc': 0.9140777996616679, 'loss_val': 1.1468154495372191, 'psi': 0.7232563275815169}-{'f1_val': 0.9836863217050213, 'auprc': 0.9815650802436914, 'loss_val': 0.1295503901030197, 'psi': 0.9828378251204893}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=53 head_norm_before_train=1.801440 cos_to_last_merge=0.9865 (last merge round=17)
[S7] round=53 local utility u=0.000000 metrics={'f1_val': 0.466153491024318, 'auprc': 0.777252499918866, 'loss_val': 1.1463959887275117, 'psi': 0.5905930945821373}-{'f1_val': 0.7764041153016755, 'auprc': 0.8266216846510761, 'loss_val': 0.34900141483328334, 'psi': 0.7964911430414358}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=53 head_norm_before_train=1.777832 cos_to_last_merge=1.0000 (last merge round=52)
[S8] round=53 local utility u=0.012156 metrics={'f1_val': 0.9931569338135257, 'auprc': 0.9868319070074526, 'loss_val': 0.046148935947557146, 'psi': 0.9906269230910965}-{'f1_val': 0.9836444136069047, 'auprc': 0.9993183048582822, 'loss_val': 0.05084412371106781, 'psi': 0.9899139701074557}
[S9] START round=53 head_norm_before_train=1.973096 cos_to_last_merge=0.9738 (last merge round=13)
[S9] round=53 local utility u=0.004087 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9951025360572798, 'loss_val': 0.017858248120889812, 'psi': 0.9957910712904785}-{'f1_val': 0.993909773892786, 'auprc': 0.9987376143500802, 'loss_val': 0.022895896114213343, 'psi': 0.9958409100757037}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=53 head_norm_before_train=1.613344 cos_to_last_merge=1.0000 (last merge round=51)
[S10] round=53 local utility u=0.003092 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957386703789469, 'loss_val': 0.0312908955217737, 'psi': 0.9954081715632036}-{'f1_val': 0.9951878390193748, 'auprc': 0.9948673022872142, 'loss_val': 0.03486073065342114, 'psi': 0.9950596243265105}
[S11] START round=53 head_norm_before_train=1.889982 cos_to_last_merge=1.0000 (last merge round=51)
[S11] round=53 local utility u=0.000000 metrics={'f1_val': 0.834068493538352, 'auprc': 0.9947516661479774, 'loss_val': 0.2238661038066301, 'psi': 0.8983417625822021}-{'f1_val': 0.83575105877516, 'auprc': 0.9947387675772256, 'loss_val': 0.21795553772824627, 'psi': 0.8993461422959862}
[S13] START round=53 head_norm_before_train=1.608317 cos_to_last_merge=1.0000 (last merge round=51)
[S13] round=53 local utility u=0.156887 metrics={'f1_val': 0.6753988797148576, 'auprc': 0.8076737134744142, 'loss_val': 0.7577448935565854, 'psi': 0.7283088132186802}-{'f1_val': 0.6482937381241405, 'auprc': 0.8357131769870274, 'loss_val': 0.9930065834173954, 'psi': 0.7232615136692953}
[S14] START round=53 head_norm_before_train=1.801232 cos_to_last_merge=0.8466 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.847
[S14] round=53 local utility u=0.000510 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9985290839293917, 'loss_val': 0.023158950272883973, 'psi': 0.9980023044016688}-{'f1_val': 0.9972435617623723, 'auprc': 0.9989000971563899, 'loss_val': 0.022845829848742488, 'psi': 0.9979061759199793}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=53 head_norm_before_train=1.823941 cos_to_last_merge=0.9370 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.937
[S15] round=53 local utility u=0.000000 metrics={'f1_val': 0.7031318866083327, 'auprc': 0.9131117964990108, 'loss_val': 0.5333246612634325, 'psi': 0.7871238505646039}-{'f1_val': 0.9965259456095847, 'auprc': 0.9929873073460731, 'loss_val': 0.02602920452804323, 'psi': 0.9951104903041801}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=53 head_norm_before_train=2.042462 (no previous merge yet)
[S16] round=53 local utility u=0.000000 metrics={'f1_val': 0.9346020930574752, 'auprc': 0.975462304120195, 'loss_val': 0.36448601990002955, 'psi': 0.9509461774825632}-{'f1_val': 0.9419153745760588, 'auprc': 0.9790762460653564, 'loss_val': 0.2701409435001123, 'psi': 0.9567797231717778}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=53 head_norm_before_train=1.774486 cos_to_last_merge=0.9999 (last merge round=50)
[S17] round=53 local utility u=0.000000 metrics={'f1_val': 0.6361328476070968, 'auprc': 0.7236509320612293, 'loss_val': 1.1480329408931294, 'psi': 0.6711400813887498}-{'f1_val': 0.776052592994817, 'auprc': 0.8672663767131664, 'loss_val': 0.7158343695825852, 'psi': 0.8125381064821569}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=53 metric=0.8341 head_norm=1.900764
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.966474e-02
[S11] stored merged vector for next round verification (round=53)
[S11] DEBUG after merge:  round=53 metric=0.8341 head_norm=1.893440 delta_norm=0.019665
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9996
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9998
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=53 metric=0.6754 head_norm=1.617571
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.623473e-02
[S13] stored merged vector for next round verification (round=53)
[S13] DEBUG after merge:  round=53 metric=0.6741 head_norm=1.622209 delta_norm=0.016235
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=53 metric=0.9952 head_norm=1.626996
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.623473e-02
[S10] stored merged vector for next round verification (round=53)
[S10] DEBUG after merge:  round=53 metric=0.9952 head_norm=1.622209 delta_norm=0.016235
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=53 metric=0.9932 head_norm=1.786260
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.378223e-02
[S8] stored merged vector for next round verification (round=53)
[S8] DEBUG after merge:  round=53 metric=0.9932 head_norm=1.780224 delta_norm=0.023782
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=54 head_norm_before_train=1.893429 cos_to_last_merge=0.9999 (last merge round=49)
[S2] round=54 local utility u=0.000000 metrics={'f1_val': 0.6591491931959222, 'auprc': 0.7828239540891015, 'loss_val': 1.1690372680974201, 'psi': 0.708619097553194}-{'f1_val': 0.6581672693184624, 'auprc': 0.7885220693305022, 'loss_val': 0.7629776223528139, 'psi': 0.7103091893232782}
[S3] START round=54 head_norm_before_train=2.001333 cos_to_last_merge=0.9012 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.901
[S3] round=54 local utility u=0.143935 metrics={'f1_val': 0.9836091889242733, 'auprc': 0.9988974226536336, 'loss_val': 0.04950489315310774, 'psi': 0.9897244824160174}-{'f1_val': 0.9608296089712303, 'auprc': 0.991026862807268, 'loss_val': 0.17708536486114615, 'psi': 0.9729085105056454}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=54 head_norm_before_train=1.802586 cos_to_last_merge=0.7952 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=54 local utility u=0.043813 metrics={'f1_val': 0.9547581319122006, 'auprc': 0.972227012081536, 'loss_val': 0.2806456264072748, 'psi': 0.9617456839799348}-{'f1_val': 0.9429080284218507, 'auprc': 0.9711754876277279, 'loss_val': 0.2940155536722596, 'psi': 0.9542150121042016}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=54 head_norm_before_train=2.073461 (no previous merge yet)
[S5] round=54 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9906253945846212, 'loss_val': 0.03338971142396988, 'psi': 0.9939617718194351}-{'f1_val': 0.996186023309311, 'auprc': 0.995061448562193, 'loss_val': 0.030034408386604317, 'psi': 0.9957361934104638}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=54 head_norm_before_train=1.728002 cos_to_last_merge=0.9009 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.901
[S6] round=54 local utility u=0.836815 metrics={'f1_val': 0.7499702372663706, 'auprc': 0.964009113500291, 'loss_val': 0.5465494761513378, 'psi': 0.8355857877599386}-{'f1_val': 0.5960420128614163, 'auprc': 0.9140777996616679, 'loss_val': 1.1468154495372191, 'psi': 0.7232563275815169}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=54 head_norm_before_train=1.806232 cos_to_last_merge=0.9867 (last merge round=17)
[S7] round=54 local utility u=1.000000 metrics={'f1_val': 0.6684340722709201, 'auprc': 0.8286957867154943, 'loss_val': 0.3752923484747112, 'psi': 0.7325387580487497}-{'f1_val': 0.466153491024318, 'auprc': 0.777252499918866, 'loss_val': 1.1463959887275117, 'psi': 0.5905930945821373}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S7] sending update (kind=head size=1794 to 1 peers)
[S8] START round=54 head_norm_before_train=1.780224 cos_to_last_merge=1.0000 (last merge round=53)
[S8] round=54 local utility u=0.023811 metrics={'f1_val': 0.9928249955793521, 'auprc': 0.9993114334881229, 'loss_val': 0.033974883512100415, 'psi': 0.9954195707428604}-{'f1_val': 0.9931569338135257, 'auprc': 0.9868319070074526, 'loss_val': 0.046148935947557146, 'psi': 0.9906269230910965}
[S9] START round=54 head_norm_before_train=1.982988 cos_to_last_merge=0.9733 (last merge round=13)
[S9] round=54 local utility u=0.000000 metrics={'f1_val': 0.9941601000394567, 'auprc': 0.9986588807089292, 'loss_val': 0.020911619170495062, 'psi': 0.9959596123072456}-{'f1_val': 0.9962500947792776, 'auprc': 0.9951025360572798, 'loss_val': 0.017858248120889812, 'psi': 0.9957910712904785}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=54 head_norm_before_train=1.622209 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=54 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9947978388579084, 'loss_val': 0.03369891411471791, 'psi': 0.9950318389547882}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957386703789469, 'loss_val': 0.0312908955217737, 'psi': 0.9954081715632036}
[S11] START round=54 head_norm_before_train=1.893440 cos_to_last_merge=1.0000 (last merge round=53)
[S11] round=54 local utility u=0.586206 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9939189065411524, 'loss_val': 0.023827612420146776, 'psi': 0.9954957653246147}-{'f1_val': 0.834068493538352, 'auprc': 0.9947516661479774, 'loss_val': 0.2238661038066301, 'psi': 0.8983417625822021}
[S13] START round=54 head_norm_before_train=1.622209 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=54 local utility u=0.050776 metrics={'f1_val': 0.7041396403833203, 'auprc': 0.808574519330479, 'loss_val': 0.8313390634095891, 'psi': 0.7459135919621838}-{'f1_val': 0.6753988797148576, 'auprc': 0.8076737134744142, 'loss_val': 0.7577448935565854, 'psi': 0.7283088132186802}
[S14] START round=54 head_norm_before_train=1.809944 cos_to_last_merge=0.8459 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.846
[S14] round=54 local utility u=0.000000 metrics={'f1_val': 0.9968189060544872, 'auprc': 0.9985289784926886, 'loss_val': 0.029748099685303776, 'psi': 0.9975029350297678}-{'f1_val': 0.9976511180498535, 'auprc': 0.9985290839293917, 'loss_val': 0.023158950272883973, 'psi': 0.9980023044016688}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=54 head_norm_before_train=1.832434 cos_to_last_merge=0.9362 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.936
[S15] round=54 local utility u=0.525139 metrics={'f1_val': 0.8178592565341952, 'auprc': 0.9779417168853977, 'loss_val': 0.36590062127866774, 'psi': 0.8818922406746762}-{'f1_val': 0.7031318866083327, 'auprc': 0.9131117964990108, 'loss_val': 0.5333246612634325, 'psi': 0.7871238505646039}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S16] START round=54 head_norm_before_train=2.047583 (no previous merge yet)
[S16] round=54 local utility u=0.000000 metrics={'f1_val': 0.8843933936075614, 'auprc': 0.9096616942389035, 'loss_val': 0.6304688086436606, 'psi': 0.8945007138600982}-{'f1_val': 0.9346020930574752, 'auprc': 0.975462304120195, 'loss_val': 0.36448601990002955, 'psi': 0.9509461774825632}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=54 head_norm_before_train=1.780467 cos_to_last_merge=0.9998 (last merge round=50)
[S17] round=54 local utility u=0.242934 metrics={'f1_val': 0.6566171266007566, 'auprc': 0.8348222028556643, 'loss_val': 1.1185852812029313, 'psi': 0.7278991571027197}-{'f1_val': 0.6361328476070968, 'auprc': 0.7236509320612293, 'loss_val': 1.1480329408931294, 'psi': 0.6711400813887498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S11] → sending delta(kind=head bytes=1801) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:54517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S17] → sending delta(kind=head bytes=1797) to S8@127.0.0.1:54509
[S17] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S11] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1801) from S11
[S2] cosine check vs S11: cos=0.9998
[S8] RECEIVED delta(kind=head bytes=1797) from S17
[S8] cosine check vs S17: cos=0.9998
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9998
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=54 metric=0.6566 head_norm=1.784890
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.348869e-02
[S17] stored merged vector for next round verification (round=54)
[S17] DEBUG after merge:  round=54 metric=0.6575 head_norm=1.786098 delta_norm=0.023489
[S17] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=54 metric=0.9928 head_norm=1.789012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.960663e-02
[S8] stored merged vector for next round verification (round=54)
[S8] DEBUG after merge:  round=54 metric=0.9928 head_norm=1.786844 delta_norm=0.019607
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=55 head_norm_before_train=1.899963 cos_to_last_merge=0.9998 (last merge round=49)
[S2] round=55 local utility u=0.733738 metrics={'f1_val': 0.7095598384799908, 'auprc': 0.919017084194693, 'loss_val': 0.4126044250375716, 'psi': 0.7933427367658716}-{'f1_val': 0.6591491931959222, 'auprc': 0.7828239540891015, 'loss_val': 1.1690372680974201, 'psi': 0.708619097553194}
[S3] START round=55 head_norm_before_train=2.012088 cos_to_last_merge=0.9004 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=55 local utility u=0.000000 metrics={'f1_val': 0.9751612474106456, 'auprc': 0.9991588247804087, 'loss_val': 0.07212774861134873, 'psi': 0.984760278358551}-{'f1_val': 0.9836091889242733, 'auprc': 0.9988974226536336, 'loss_val': 0.04950489315310774, 'psi': 0.9897244824160174}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=55 head_norm_before_train=1.809331 cos_to_last_merge=0.7947 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=55 local utility u=0.000000 metrics={'f1_val': 0.9450971165600869, 'auprc': 0.9836776565954357, 'loss_val': 0.28141910797407815, 'psi': 0.9605293325742265}-{'f1_val': 0.9547581319122006, 'auprc': 0.972227012081536, 'loss_val': 0.2806456264072748, 'psi': 0.9617456839799348}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=55 head_norm_before_train=2.068285 (no previous merge yet)
[S5] round=55 local utility u=0.011546 metrics={'f1_val': 0.996186023309311, 'auprc': 0.996916326090262, 'loss_val': 0.02917024253635981, 'psi': 0.9964781444216915}-{'f1_val': 0.996186023309311, 'auprc': 0.9906253945846212, 'loss_val': 0.03338971142396988, 'psi': 0.9939617718194351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=55 head_norm_before_train=1.734408 cos_to_last_merge=0.8997 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.900
[S6] round=55 local utility u=0.941488 metrics={'f1_val': 0.9859022657725777, 'auprc': 0.9810129687545712, 'loss_val': 0.1301781946406255, 'psi': 0.9839465469653751}-{'f1_val': 0.7499702372663706, 'auprc': 0.964009113500291, 'loss_val': 0.5465494761513378, 'psi': 0.8355857877599386}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=55 head_norm_before_train=1.811645 cos_to_last_merge=0.9865 (last merge round=17)
[S7] round=55 local utility u=0.000000 metrics={'f1_val': 0.6670263851815081, 'auprc': 0.8240126372436006, 'loss_val': 0.37101291295353234, 'psi': 0.7298208860063451}-{'f1_val': 0.6684340722709201, 'auprc': 0.8286957867154943, 'loss_val': 0.3752923484747112, 'psi': 0.7325387580487497}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=55 head_norm_before_train=1.786844 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=55 local utility u=0.000000 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9993255967534894, 'loss_val': 0.03415442298513496, 'psi': 0.9952069455177729}-{'f1_val': 0.9928249955793521, 'auprc': 0.9993114334881229, 'loss_val': 0.033974883512100415, 'psi': 0.9954195707428604}
[S9] START round=55 head_norm_before_train=1.992299 cos_to_last_merge=0.9730 (last merge round=13)
[S9] round=55 local utility u=0.004114 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9955251539187873, 'loss_val': 0.01828458921258479, 'psi': 0.9962063686558498}-{'f1_val': 0.9941601000394567, 'auprc': 0.9986588807089292, 'loss_val': 0.020911619170495062, 'psi': 0.9959596123072456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=55 head_norm_before_train=1.635564 cos_to_last_merge=1.0000 (last merge round=53)
[S10] round=55 local utility u=0.002785 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.99562475988621, 'loss_val': 0.03060918063985522, 'psi': 0.9953626073661088}-{'f1_val': 0.9951878390193748, 'auprc': 0.9947978388579084, 'loss_val': 0.03369891411471791, 'psi': 0.9950318389547882}
[S11] START round=55 head_norm_before_train=1.904708 cos_to_last_merge=1.0000 (last merge round=53)
[S11] round=55 local utility u=0.002988 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9953174949357566, 'loss_val': 0.02349746718811761, 'psi': 0.9962002278799214}-{'f1_val': 0.9965470045135896, 'auprc': 0.9939189065411524, 'loss_val': 0.023827612420146776, 'psi': 0.9954957653246147}
[S13] START round=55 head_norm_before_train=1.631653 cos_to_last_merge=1.0000 (last merge round=53)
[S13] round=55 local utility u=0.225165 metrics={'f1_val': 0.7651217321965612, 'auprc': 0.8119748102979336, 'loss_val': 0.7571025086490886, 'psi': 0.7838629634371101}-{'f1_val': 0.7041396403833203, 'auprc': 0.808574519330479, 'loss_val': 0.8313390634095891, 'psi': 0.7459135919621838}
[S14] START round=55 head_norm_before_train=1.819090 cos_to_last_merge=0.8453 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.845
[S14] round=55 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9989095347760825, 'loss_val': 0.029453197409113747, 'psi': 0.9974058643142338}-{'f1_val': 0.9968189060544872, 'auprc': 0.9985289784926886, 'loss_val': 0.029748099685303776, 'psi': 0.9975029350297678}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=55 head_norm_before_train=1.841507 cos_to_last_merge=0.9354 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=55 local utility u=0.608989 metrics={'f1_val': 0.9636934529112138, 'auprc': 0.9960007739109169, 'loss_val': 0.07710561567397696, 'psi': 0.9766163813110951}-{'f1_val': 0.8178592565341952, 'auprc': 0.9779417168853977, 'loss_val': 0.36590062127866774, 'psi': 0.8818922406746762}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=55 head_norm_before_train=2.048196 (no previous merge yet)
[S16] round=55 local utility u=0.000000 metrics={'f1_val': 0.8754549104908085, 'auprc': 0.941247718555331, 'loss_val': 0.7506945089666752, 'psi': 0.9017720337166175}-{'f1_val': 0.8843933936075614, 'auprc': 0.9096616942389035, 'loss_val': 0.6304688086436606, 'psi': 0.8945007138600982}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=55 head_norm_before_train=1.786098 cos_to_last_merge=1.0000 (last merge round=54)
[S17] round=55 local utility u=0.019699 metrics={'f1_val': 0.6548115628804849, 'auprc': 0.8468768546722465, 'loss_val': 1.104517510984292, 'psi': 0.7316376795971895}-{'f1_val': 0.6566171266007566, 'auprc': 0.8348222028556643, 'loss_val': 1.1185852812029313, 'psi': 0.7278991571027197}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S13] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S8] ⇄ pheromone p=0.009 → S17@127.0.0.1:54517
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9997
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=0.9997
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=0.9999
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=55 metric=0.9968 head_norm=1.913603
[S11] _apply_head_vector_avg (torch): Δ‖w‖=2.379872e-02
[S11] stored merged vector for next round verification (round=55)
[S11] DEBUG after merge:  round=55 metric=0.9968 head_norm=1.910096 delta_norm=0.023799
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.110 → S2@127.0.0.1:54502
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=55 metric=0.7096 head_norm=1.906879
[S2] _apply_head_vector_avg (torch): Δ‖w‖=2.209544e-02
[S2] stored merged vector for next round verification (round=55)
[S2] DEBUG after merge:  round=55 metric=0.7096 head_norm=1.907887 delta_norm=0.022095
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.177 → S11@127.0.0.1:54512
[S17] ⇄ pheromone p=0.159 → S8@127.0.0.1:54509
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=55 metric=0.9952 head_norm=1.648514
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.392098e-02
[S10] stored merged vector for next round verification (round=55)
[S10] DEBUG after merge:  round=55 metric=0.9952 head_norm=1.642201 delta_norm=0.013921
[S10] aggregate: ACCEPT kept=['S13', 'S13'] (k=2/2) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.002 → S13@127.0.0.1:54513
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=55 metric=0.7651 head_norm=1.640322
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.468160e-02
[S13] stored merged vector for next round verification (round=55)
[S13] DEBUG after merge:  round=55 metric=0.7646 head_norm=1.644357 delta_norm=0.014682
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.096 → S10@127.0.0.1:54511
[S2] START round=56 head_norm_before_train=1.907887 cos_to_last_merge=1.0000 (last merge round=55)
[S2] round=56 local utility u=0.122970 metrics={'f1_val': 0.7128964943740845, 'auprc': 0.9835893488321329, 'loss_val': 0.38040164808721866, 'psi': 0.8211736361573039}-{'f1_val': 0.7095598384799908, 'auprc': 0.919017084194693, 'loss_val': 0.4126044250375716, 'psi': 0.7933427367658716}
[S3] START round=56 head_norm_before_train=2.022133 cos_to_last_merge=0.8997 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.900
[S3] round=56 local utility u=0.000000 metrics={'f1_val': 0.7365582780623077, 'auprc': 0.9942185027748387, 'loss_val': 0.5777672651289356, 'psi': 0.83962236794732}-{'f1_val': 0.9751612474106456, 'auprc': 0.9991588247804087, 'loss_val': 0.07212774861134873, 'psi': 0.984760278358551}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=56 head_norm_before_train=1.812734 cos_to_last_merge=0.7945 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=56 local utility u=0.000000 metrics={'f1_val': 0.9429898202206491, 'auprc': 0.9746623426337911, 'loss_val': 0.2898213339462934, 'psi': 0.9556588291859061}-{'f1_val': 0.9450971165600869, 'auprc': 0.9836776565954357, 'loss_val': 0.28141910797407815, 'psi': 0.9605293325742265}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=56 head_norm_before_train=2.071461 (no previous merge yet)
[S5] round=56 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943867179948208, 'loss_val': 0.03086221951882649, 'psi': 0.995466301183515}-{'f1_val': 0.996186023309311, 'auprc': 0.996916326090262, 'loss_val': 0.02917024253635981, 'psi': 0.9964781444216915}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=56 head_norm_before_train=1.737620 cos_to_last_merge=0.8987 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.899
[S6] round=56 local utility u=0.000000 metrics={'f1_val': 0.5952971370899608, 'auprc': 0.9265662581418466, 'loss_val': 1.1303187795624698, 'psi': 0.727804785510715}-{'f1_val': 0.9859022657725777, 'auprc': 0.9810129687545712, 'loss_val': 0.1301781946406255, 'psi': 0.9839465469653751}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=56 head_norm_before_train=1.814485 cos_to_last_merge=0.9860 (last merge round=17)
[S7] round=56 local utility u=0.000000 metrics={'f1_val': 0.6642220143384033, 'auprc': 0.8089991873765764, 'loss_val': 0.4187160679484437, 'psi': 0.7221328835536726}-{'f1_val': 0.6670263851815081, 'auprc': 0.8240126372436006, 'loss_val': 0.37101291295353234, 'psi': 0.7298208860063451}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=56 head_norm_before_train=1.797905 cos_to_last_merge=1.0000 (last merge round=54)
[S8] round=56 local utility u=0.000100 metrics={'f1_val': 0.9924611780272952, 'auprc': 0.9993266995813613, 'loss_val': 0.03395765466347353, 'psi': 0.9952073866489217}-{'f1_val': 0.9924611780272952, 'auprc': 0.9993255967534894, 'loss_val': 0.03415442298513496, 'psi': 0.9952069455177729}
[S9] START round=56 head_norm_before_train=1.996165 cos_to_last_merge=0.9722 (last merge round=13)
[S9] round=56 local utility u=0.000139 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9965731811657595, 'loss_val': 0.01868731119483094, 'psi': 0.9963793293338704}-{'f1_val': 0.9966605118138915, 'auprc': 0.9955251539187873, 'loss_val': 0.01828458921258479, 'psi': 0.9962063686558498}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=56 head_norm_before_train=1.642201 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=56 local utility u=0.000374 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957121548232055, 'loss_val': 0.030123659684863142, 'psi': 0.9953975653409071}-{'f1_val': 0.9951878390193748, 'auprc': 0.99562475988621, 'loss_val': 0.03060918063985522, 'psi': 0.9953626073661088}
[S11] START round=56 head_norm_before_train=1.910096 cos_to_last_merge=1.0000 (last merge round=55)
[S11] round=56 local utility u=0.000000 metrics={'f1_val': 0.9952922001172275, 'auprc': 0.9951034573407584, 'loss_val': 0.028385240078108043, 'psi': 0.9952167030066399}-{'f1_val': 0.9967887165093644, 'auprc': 0.9953174949357566, 'loss_val': 0.02349746718811761, 'psi': 0.9962002278799214}
[S13] START round=56 head_norm_before_train=1.644357 cos_to_last_merge=1.0000 (last merge round=55)
[S13] round=56 local utility u=0.000000 metrics={'f1_val': 0.6347841419642379, 'auprc': 0.7827095974915564, 'loss_val': 1.0626690756574013, 'psi': 0.6939543241751653}-{'f1_val': 0.7651217321965612, 'auprc': 0.8119748102979336, 'loss_val': 0.7571025086490886, 'psi': 0.7838629634371101}
[S14] START round=56 head_norm_before_train=1.826098 cos_to_last_merge=0.8446 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.845
[S14] round=56 local utility u=0.007429 metrics={'f1_val': 0.997240356705793, 'auprc': 0.998981543483216, 'loss_val': 0.019832630507516828, 'psi': 0.9979368314167623}-{'f1_val': 0.9964034173396682, 'auprc': 0.9989095347760825, 'loss_val': 0.029453197409113747, 'psi': 0.9974058643142338}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=56 head_norm_before_train=1.850536 cos_to_last_merge=0.9346 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.935
[S15] round=56 local utility u=0.113314 metrics={'f1_val': 0.9963755136436562, 'auprc': 0.9899052409307514, 'loss_val': 0.028283809838441566, 'psi': 0.9937874045584942}-{'f1_val': 0.9636934529112138, 'auprc': 0.9960007739109169, 'loss_val': 0.07710561567397696, 'psi': 0.9766163813110951}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=56 head_norm_before_train=2.052396 (no previous merge yet)
[S16] round=56 local utility u=0.000000 metrics={'f1_val': 0.872642285463735, 'auprc': 0.94608463704747, 'loss_val': 0.8086133523085333, 'psi': 0.9020192260972291}-{'f1_val': 0.8754549104908085, 'auprc': 0.941247718555331, 'loss_val': 0.7506945089666752, 'psi': 0.9017720337166175}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=56 head_norm_before_train=1.793054 cos_to_last_merge=1.0000 (last merge round=54)
[S17] round=56 local utility u=0.000000 metrics={'f1_val': 0.6407565748542483, 'auprc': 0.8239317198568606, 'loss_val': 1.2240026469304977, 'psi': 0.7140266328552933}-{'f1_val': 0.6548115628804849, 'auprc': 0.8468768546722465, 'loss_val': 1.104517510984292, 'psi': 0.7316376795971895}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S10] → sending delta(kind=head bytes=1798) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S8] → sending delta(kind=head bytes=1797) to S17@127.0.0.1:54517
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1797 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1798) from S10
[S13] cosine check vs S10: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1797) from S8
[S17] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=56 metric=0.9925 head_norm=1.809069
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.164363e-02
[S8] stored merged vector for next round verification (round=56)
[S8] DEBUG after merge:  round=56 metric=0.9925 head_norm=1.801042 delta_norm=0.011644
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=57 head_norm_before_train=1.915960 cos_to_last_merge=1.0000 (last merge round=55)
[S2] round=57 local utility u=0.000000 metrics={'f1_val': 0.709677248065044, 'auprc': 0.9850194165881944, 'loss_val': 0.43165143757422403, 'psi': 0.8198141154743042}-{'f1_val': 0.7128964943740845, 'auprc': 0.9835893488321329, 'loss_val': 0.38040164808721866, 'psi': 0.8211736361573039}
[S3] START round=57 head_norm_before_train=2.028365 cos_to_last_merge=0.8992 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=57 local utility u=0.852365 metrics={'f1_val': 0.959254831326565, 'auprc': 0.9908129243566635, 'loss_val': 0.19900005124298642, 'psi': 0.9718780685386044}-{'f1_val': 0.7365582780623077, 'auprc': 0.9942185027748387, 'loss_val': 0.5777672651289356, 'psi': 0.83962236794732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=57 head_norm_before_train=1.814014 cos_to_last_merge=0.7943 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=57 local utility u=0.015961 metrics={'f1_val': 0.9454425435539633, 'auprc': 0.9775614120095619, 'loss_val': 0.281312999415126, 'psi': 0.9582900909362027}-{'f1_val': 0.9429898202206491, 'auprc': 0.9746623426337911, 'loss_val': 0.2898213339462934, 'psi': 0.9556588291859061}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=57 head_norm_before_train=2.075127 (no previous merge yet)
[S5] round=57 local utility u=0.001694 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9958656027081815, 'loss_val': 0.0305981011046589, 'psi': 0.9959266305178429}-{'f1_val': 0.996186023309311, 'auprc': 0.9943867179948208, 'loss_val': 0.03086221951882649, 'psi': 0.995466301183515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=57 head_norm_before_train=1.742196 cos_to_last_merge=0.8979 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.898
[S6] round=57 local utility u=1.000000 metrics={'f1_val': 0.8424792911396839, 'auprc': 0.9638114994963349, 'loss_val': 0.43449179834398227, 'psi': 0.8910121744823443}-{'f1_val': 0.5952971370899608, 'auprc': 0.9265662581418466, 'loss_val': 1.1303187795624698, 'psi': 0.727804785510715}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=57 head_norm_before_train=1.818986 cos_to_last_merge=0.9853 (last merge round=17)
[S7] round=57 local utility u=0.006926 metrics={'f1_val': 0.6706469143802783, 'auprc': 0.8206294296186682, 'loss_val': 0.4783043382791051, 'psi': 0.7306399204756344}-{'f1_val': 0.6642220143384033, 'auprc': 0.8089991873765764, 'loss_val': 0.4187160679484437, 'psi': 0.7221328835536726}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=57 head_norm_before_train=1.801042 cos_to_last_merge=1.0000 (last merge round=56)
[S8] round=57 local utility u=0.000000 metrics={'f1_val': 0.972347518729155, 'auprc': 0.9993137717509635, 'loss_val': 0.0675061670975356, 'psi': 0.9831340199378784}-{'f1_val': 0.9924611780272952, 'auprc': 0.9993266995813613, 'loss_val': 0.03395765466347353, 'psi': 0.9952073866489217}
[S9] START round=57 head_norm_before_train=1.998634 cos_to_last_merge=0.9727 (last merge round=13)
[S9] round=57 local utility u=0.005611 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9991092019511951, 'loss_val': 0.017514438311890864, 'psi': 0.9976378879601248}-{'f1_val': 0.9962500947792776, 'auprc': 0.9965731811657595, 'loss_val': 0.01868731119483094, 'psi': 0.9963793293338704}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=57 head_norm_before_train=1.653880 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=57 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955461790243918, 'loss_val': 0.03018335415247591, 'psi': 0.9953311750213816}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957121548232055, 'loss_val': 0.030123659684863142, 'psi': 0.9953975653409071}
[S11] START round=57 head_norm_before_train=1.916595 cos_to_last_merge=1.0000 (last merge round=55)
[S11] round=57 local utility u=0.000000 metrics={'f1_val': 0.9893742335069149, 'auprc': 0.9948979370767617, 'loss_val': 0.033471815640655496, 'psi': 0.9915837149348536}-{'f1_val': 0.9952922001172275, 'auprc': 0.9951034573407584, 'loss_val': 0.028385240078108043, 'psi': 0.9952167030066399}
[S13] START round=57 head_norm_before_train=1.651466 cos_to_last_merge=1.0000 (last merge round=55)
[S13] round=57 local utility u=0.413137 metrics={'f1_val': 0.7361063451720647, 'auprc': 0.8090788885790929, 'loss_val': 0.9234363924415698, 'psi': 0.765295362534876}-{'f1_val': 0.6347841419642379, 'auprc': 0.7827095974915564, 'loss_val': 1.0626690756574013, 'psi': 0.6939543241751653}
[S14] START round=57 head_norm_before_train=1.832256 cos_to_last_merge=0.8440 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.844
[S14] round=57 local utility u=0.000685 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9989895783948785, 'loss_val': 0.0209679052901461, 'psi': 0.998188137047525}-{'f1_val': 0.997240356705793, 'auprc': 0.998981543483216, 'loss_val': 0.019832630507516828, 'psi': 0.9979368314167623}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=57 head_norm_before_train=1.859042 cos_to_last_merge=0.9339 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.934
[S15] round=57 local utility u=0.000000 metrics={'f1_val': 0.7684469163235147, 'auprc': 0.9306314249399247, 'loss_val': 0.48261258955725017, 'psi': 0.8333207197700787}-{'f1_val': 0.9963755136436562, 'auprc': 0.9899052409307514, 'loss_val': 0.028283809838441566, 'psi': 0.9937874045584942}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=57 head_norm_before_train=2.056208 (no previous merge yet)
[S16] round=57 local utility u=0.000000 metrics={'f1_val': 0.877761133641821, 'auprc': 0.8942625003901725, 'loss_val': 0.7083734268567076, 'psi': 0.8843616803411616}-{'f1_val': 0.872642285463735, 'auprc': 0.94608463704747, 'loss_val': 0.8086133523085333, 'psi': 0.9020192260972291}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=57 head_norm_before_train=1.801127 cos_to_last_merge=1.0000 (last merge round=54)
[S17] round=57 local utility u=0.417123 metrics={'f1_val': 0.7112516061912733, 'auprc': 0.8736264690228842, 'loss_val': 0.9618100951408372, 'psi': 0.7762015513239177}-{'f1_val': 0.6407565748542483, 'auprc': 0.8239317198568606, 'loss_val': 1.2240026469304977, 'psi': 0.7140266328552933}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=57 metric=0.9894 head_norm=1.924608
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.165147e-02
[S11] stored merged vector for next round verification (round=57)
[S11] DEBUG after merge:  round=57 metric=0.9877 head_norm=1.920254 delta_norm=0.011651
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=57 metric=0.7361 head_norm=1.656040
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.497332e-03
[S13] stored merged vector for next round verification (round=57)
[S13] DEBUG after merge:  round=57 metric=0.7365 head_norm=1.654933 delta_norm=0.009497
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=57 metric=0.7113 head_norm=1.808930
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.469317e-02
[S17] stored merged vector for next round verification (round=57)
[S17] DEBUG after merge:  round=57 metric=0.7094 head_norm=1.808940 delta_norm=0.014693
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=58 head_norm_before_train=1.923705 cos_to_last_merge=1.0000 (last merge round=55)
[S2] round=58 local utility u=0.000000 metrics={'f1_val': 0.7087689691234317, 'auprc': 0.977668437457712, 'loss_val': 0.4350857271064235, 'psi': 0.8163287564571439}-{'f1_val': 0.709677248065044, 'auprc': 0.9850194165881944, 'loss_val': 0.43165143757422403, 'psi': 0.8198141154743042}
[S3] START round=58 head_norm_before_train=2.036538 cos_to_last_merge=0.8987 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.899
[S3] round=58 local utility u=0.000000 metrics={'f1_val': 0.9221621827884837, 'auprc': 0.9964856377363961, 'loss_val': 0.16221737625767246, 'psi': 0.9518915647676487}-{'f1_val': 0.959254831326565, 'auprc': 0.9908129243566635, 'loss_val': 0.19900005124298642, 'psi': 0.9718780685386044}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=58 head_norm_before_train=1.812785 cos_to_last_merge=0.7945 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.795
[S4] round=58 local utility u=0.014310 metrics={'f1_val': 0.9471427453463488, 'auprc': 0.9819826716292677, 'loss_val': 0.2761587229534194, 'psi': 0.9610787158595164}-{'f1_val': 0.9454425435539633, 'auprc': 0.9775614120095619, 'loss_val': 0.281312999415126, 'psi': 0.9582900909362027}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S5] START round=58 head_norm_before_train=2.082539 (no previous merge yet)
[S5] round=58 local utility u=0.000000 metrics={'f1_val': 0.9959673157242839, 'auprc': 0.9956695166908893, 'loss_val': 0.030602140044320877, 'psi': 0.995848196110926}-{'f1_val': 0.9959673157242839, 'auprc': 0.9958656027081815, 'loss_val': 0.0305981011046589, 'psi': 0.9959266305178429}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=58 head_norm_before_train=1.750821 cos_to_last_merge=0.8974 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.897
[S6] round=58 local utility u=0.377919 metrics={'f1_val': 0.9176302850542998, 'auprc': 0.9821372689737677, 'loss_val': 0.18453646752960734, 'psi': 0.943433078622087}-{'f1_val': 0.8424792911396839, 'auprc': 0.9638114994963349, 'loss_val': 0.43449179834398227, 'psi': 0.8910121744823443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=58 head_norm_before_train=1.825223 cos_to_last_merge=0.9849 (last merge round=17)
[S7] round=58 local utility u=0.000000 metrics={'f1_val': 0.558227167031484, 'auprc': 0.778081389918033, 'loss_val': 0.9588679039712881, 'psi': 0.6461688561861036}-{'f1_val': 0.6706469143802783, 'auprc': 0.8206294296186682, 'loss_val': 0.4783043382791051, 'psi': 0.7306399204756344}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=58 head_norm_before_train=1.808254 cos_to_last_merge=1.0000 (last merge round=56)
[S8] round=58 local utility u=0.079493 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9993968105362161, 'loss_val': 0.032491640140025715, 'psi': 0.9955395040364117}-{'f1_val': 0.972347518729155, 'auprc': 0.9993137717509635, 'loss_val': 0.0675061670975356, 'psi': 0.9831340199378784}
[S9] START round=58 head_norm_before_train=2.002870 cos_to_last_merge=0.9733 (last merge round=13)
[S9] round=58 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986756703556364, 'loss_val': 0.01692919221767197, 'psi': 0.9974665752305895}-{'f1_val': 0.9966570119660778, 'auprc': 0.9991092019511951, 'loss_val': 0.017514438311890864, 'psi': 0.9976378879601248}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=58 head_norm_before_train=1.664006 cos_to_last_merge=1.0000 (last merge round=55)
[S10] round=58 local utility u=0.000103 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955404369526799, 'loss_val': 0.02996058274975576, 'psi': 0.9953288781926968}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955461790243918, 'loss_val': 0.03018335415247591, 'psi': 0.9953311750213816}
[S11] START round=58 head_norm_before_train=1.920254 cos_to_last_merge=1.0000 (last merge round=57)
[S11] round=58 local utility u=0.020798 metrics={'f1_val': 0.9952922001172275, 'auprc': 0.9948117100858587, 'loss_val': 0.02712588696472763, 'psi': 0.99510000410468}-{'f1_val': 0.9893742335069149, 'auprc': 0.9948979370767617, 'loss_val': 0.033471815640655496, 'psi': 0.9915837149348536}
[S13] START round=58 head_norm_before_train=1.654933 cos_to_last_merge=1.0000 (last merge round=57)
[S13] round=58 local utility u=0.150552 metrics={'f1_val': 0.7468495766592959, 'auprc': 0.8089575391923549, 'loss_val': 0.6864273404051582, 'psi': 0.7716927616725195}-{'f1_val': 0.7361063451720647, 'auprc': 0.8090788885790929, 'loss_val': 0.9234363924415698, 'psi': 0.765295362534876}
[S14] START round=58 head_norm_before_train=1.838927 cos_to_last_merge=0.8435 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.843
[S14] round=58 local utility u=0.000174 metrics={'f1_val': 0.9976538428159559, 'auprc': 0.9989565057001513, 'loss_val': 0.02051984998908414, 'psi': 0.998174907969634}-{'f1_val': 0.9976538428159559, 'auprc': 0.9989895783948785, 'loss_val': 0.0209679052901461, 'psi': 0.998188137047525}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=58 head_norm_before_train=1.867452 cos_to_last_merge=0.9332 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=58 local utility u=0.000000 metrics={'f1_val': 0.7007415644749061, 'auprc': 0.9128229356571733, 'loss_val': 0.6013300494440174, 'psi': 0.785574112947813}-{'f1_val': 0.7684469163235147, 'auprc': 0.9306314249399247, 'loss_val': 0.48261258955725017, 'psi': 0.8333207197700787}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=58 head_norm_before_train=2.058104 (no previous merge yet)
[S16] round=58 local utility u=0.565994 metrics={'f1_val': 0.944622005732962, 'auprc': 0.982919113236033, 'loss_val': 0.24352036168227398, 'psi': 0.9599408487341903}-{'f1_val': 0.877761133641821, 'auprc': 0.8942625003901725, 'loss_val': 0.7083734268567076, 'psi': 0.8843616803411616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=58 head_norm_before_train=1.808940 cos_to_last_merge=1.0000 (last merge round=57)
[S17] round=58 local utility u=0.000000 metrics={'f1_val': 0.6359674045021839, 'auprc': 0.8281478788882526, 'loss_val': 1.2289511440544592, 'psi': 0.7128395942566115}-{'f1_val': 0.7112516061912733, 'auprc': 0.8736264690228842, 'loss_val': 0.9618100951408372, 'psi': 0.7762015513239177}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S8] → sending delta(kind=head bytes=1798) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:54513
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] sending update (kind=head size=1798 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1798) from S8
[S17] cosine check vs S8: cos=0.9999
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=58 metric=0.9930 head_norm=1.812392
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.653247e-02
[S8] stored merged vector for next round verification (round=58)
[S8] DEBUG after merge:  round=58 metric=0.9930 head_norm=1.810586 delta_norm=0.016532
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=58 metric=0.7468 head_norm=1.658980
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.504849e-02
[S13] stored merged vector for next round verification (round=58)
[S13] DEBUG after merge:  round=58 metric=0.7461 head_norm=1.666871 delta_norm=0.015048
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=58 metric=0.9952 head_norm=1.674860
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.612885e-02
[S10] stored merged vector for next round verification (round=58)
[S10] DEBUG after merge:  round=58 metric=0.9952 head_norm=1.666128 delta_norm=0.016129
[S10] aggregate: ACCEPT kept=['S13', 'S13'] (k=2/2) mode=median trim_p=0.1
[S2] START round=59 head_norm_before_train=1.930163 cos_to_last_merge=0.9999 (last merge round=55)
[S2] round=59 local utility u=0.000000 metrics={'f1_val': 0.7078267519520144, 'auprc': 0.9435303166046987, 'loss_val': 0.4709093565550326, 'psi': 0.8021081778130881}-{'f1_val': 0.7087689691234317, 'auprc': 0.977668437457712, 'loss_val': 0.4350857271064235, 'psi': 0.8163287564571439}
[S3] START round=59 head_norm_before_train=2.043426 cos_to_last_merge=0.8982 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=59 local utility u=0.000000 metrics={'f1_val': 0.7518753749933786, 'auprc': 0.9908985828784501, 'loss_val': 0.5436647363797942, 'psi': 0.8474846581474071}-{'f1_val': 0.9221621827884837, 'auprc': 0.9964856377363961, 'loss_val': 0.16221737625767246, 'psi': 0.9518915647676487}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=60 psi=0.847 u=0.0000 p_local=0.1864 f1=0.752 auprc=0.991 bytes=53999
[S4] START round=59 head_norm_before_train=1.816869 cos_to_last_merge=0.7940 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.794
[S4] round=59 local utility u=0.006694 metrics={'f1_val': 0.9540807359706407, 'auprc': 0.9731798215134411, 'loss_val': 0.27798975040063567, 'psi': 0.9617203701877608}-{'f1_val': 0.9471427453463488, 'auprc': 0.9819826716292677, 'loss_val': 0.2761587229534194, 'psi': 0.9610787158595164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S4] sending update (kind=head size=1804 to 1 peers)
[S4] r=60 psi=0.962 u=0.0067 p_local=0.0117 f1=0.954 auprc=0.973 bytes=59356
[S5] START round=59 head_norm_before_train=2.090168 (no previous merge yet)
[S5] round=59 local utility u=0.000000 metrics={'f1_val': 0.9955317630604515, 'auprc': 0.995478736916395, 'loss_val': 0.03165111639609382, 'psi': 0.995510552602829}-{'f1_val': 0.9959673157242839, 'auprc': 0.9956695166908893, 'loss_val': 0.030602140044320877, 'psi': 0.995848196110926}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=60 psi=0.996 u=0.0000 p_local=0.0020 f1=0.996 auprc=0.995 bytes=57507
[S6] START round=59 head_norm_before_train=1.757771 cos_to_last_merge=0.8962 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.896
[S6] round=59 local utility u=0.220347 metrics={'f1_val': 0.9777188994968923, 'auprc': 0.985033958258506, 'loss_val': 0.11306441787750038, 'psi': 0.9806449230015377}-{'f1_val': 0.9176302850542998, 'auprc': 0.9821372689737677, 'loss_val': 0.18453646752960734, 'psi': 0.943433078622087}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S6] r=60 psi=0.981 u=0.2203 p_local=0.4578 f1=0.978 auprc=0.985 bytes=70113
[S7] START round=59 head_norm_before_train=1.827584 cos_to_last_merge=0.9848 (last merge round=17)
[S7] round=59 local utility u=0.510555 metrics={'f1_val': 0.6528066898660749, 'auprc': 0.7983432395239873, 'loss_val': 0.5660215595078318, 'psi': 0.7110213097292399}-{'f1_val': 0.558227167031484, 'auprc': 0.778081389918033, 'loss_val': 0.9588679039712881, 'psi': 0.6461688561861036}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S7] r=60 psi=0.711 u=0.5106 p_local=0.2452 f1=0.653 auprc=0.798 bytes=53942
[S8] START round=59 head_norm_before_train=1.810586 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=59 local utility u=0.000000 metrics={'f1_val': 0.9926035371309061, 'auprc': 0.9993792419981774, 'loss_val': 0.033652686186485356, 'psi': 0.9953138190778146}-{'f1_val': 0.9929679663698754, 'auprc': 0.9993968105362161, 'loss_val': 0.032491640140025715, 'psi': 0.9955395040364117}
[S9] START round=59 head_norm_before_train=2.007665 cos_to_last_merge=0.9732 (last merge round=13)
[S9] round=59 local utility u=0.000235 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9986849588662325, 'loss_val': 0.016487815375925554, 'psi': 0.9974702906348278}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986756703556364, 'loss_val': 0.01692919221767197, 'psi': 0.9974665752305895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S9] r=60 psi=0.997 u=0.0002 p_local=0.0020 f1=0.997 auprc=0.999 bytes=59320
[S10] START round=59 head_norm_before_train=1.666128 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=59 local utility u=0.001024 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959822857115349, 'loss_val': 0.029238960160303435, 'psi': 0.9955056176962388}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955404369526799, 'loss_val': 0.02996058274975576, 'psi': 0.9953288781926968}
[S11] START round=59 head_norm_before_train=1.928866 cos_to_last_merge=1.0000 (last merge round=57)
[S11] round=59 local utility u=0.000000 metrics={'f1_val': 0.9886647592405385, 'auprc': 0.9947753127708258, 'loss_val': 0.04416655382803082, 'psi': 0.9911089806526534}-{'f1_val': 0.9952922001172275, 'auprc': 0.9948117100858587, 'loss_val': 0.02712588696472763, 'psi': 0.99510000410468}
[S13] START round=59 head_norm_before_train=1.666871 cos_to_last_merge=1.0000 (last merge round=58)
[S13] round=59 local utility u=0.000000 metrics={'f1_val': 0.6867461662815595, 'auprc': 0.8083529953528368, 'loss_val': 0.9692987204390219, 'psi': 0.7353888979100704}-{'f1_val': 0.7468495766592959, 'auprc': 0.8089575391923549, 'loss_val': 0.6864273404051582, 'psi': 0.7716927616725195}
[S14] START round=59 head_norm_before_train=1.844579 cos_to_last_merge=0.8429 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.843
[S14] round=59 local utility u=0.000000 metrics={'f1_val': 0.997412260144531, 'auprc': 0.9990010521474972, 'loss_val': 0.020637182582430212, 'psi': 0.9980477769457176}-{'f1_val': 0.9976538428159559, 'auprc': 0.9989565057001513, 'loss_val': 0.02051984998908414, 'psi': 0.998174907969634}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=60 psi=0.998 u=0.0000 p_local=0.0015 f1=0.997 auprc=0.999 bytes=71977
[S15] START round=59 head_norm_before_train=1.875553 cos_to_last_merge=0.9325 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.933
[S15] round=59 local utility u=1.000000 metrics={'f1_val': 0.9956438101891232, 'auprc': 0.9926970392530357, 'loss_val': 0.03164754809408525, 'psi': 0.9944651018146882}-{'f1_val': 0.7007415644749061, 'auprc': 0.9128229356571733, 'loss_val': 0.6013300494440174, 'psi': 0.785574112947813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S15] sending update (kind=head size=1800 to 1 peers)
[S15] r=60 psi=0.994 u=1.0000 p_local=0.3809 f1=0.996 auprc=0.993 bytes=57570
[S16] START round=59 head_norm_before_train=2.062902 (no previous merge yet)
[S16] round=59 local utility u=0.239859 metrics={'f1_val': 0.9907907501852705, 'auprc': 0.9863836157251804, 'loss_val': 0.051209250906204595, 'psi': 0.9890278964012345}-{'f1_val': 0.944622005732962, 'auprc': 0.982919113236033, 'loss_val': 0.24352036168227398, 'psi': 0.9599408487341903}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S16] r=60 psi=0.989 u=0.2399 p_local=0.1688 f1=0.991 auprc=0.986 bytes=55703
[S17] START round=59 head_norm_before_train=1.817415 cos_to_last_merge=1.0000 (last merge round=57)
[S17] round=59 local utility u=0.327471 metrics={'f1_val': 0.6859583380913881, 'auprc': 0.8780957798313879, 'loss_val': 1.0237989445781075, 'psi': 0.762813314787388}-{'f1_val': 0.6359674045021839, 'auprc': 0.8281478788882526, 'loss_val': 1.2289511440544592, 'psi': 0.7128395942566115}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=60 psi=0.991 u=0.0000 p_local=0.0483 f1=0.989 auprc=0.995 bytes=73810
[S13] r=60 psi=0.735 u=0.0000 p_local=0.1163 f1=0.687 auprc=0.808 bytes=59322
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=59 metric=0.7078 head_norm=1.935576
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.483106e-02
[S2] stored merged vector for next round verification (round=59)
[S2] DEBUG after merge:  round=59 metric=0.7078 head_norm=1.932167 delta_norm=0.014831
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=60 psi=0.802 u=0.0000 p_local=0.0852 f1=0.708 auprc=0.944 bytes=59393
[S8] r=60 psi=0.995 u=0.0000 p_local=0.0166 f1=0.993 auprc=0.999 bytes=68358
[S10] sending update (kind=head size=1804 to 1 peers)
[S17] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] r=60 psi=0.996 u=0.0010 p_local=0.0009 f1=0.995 auprc=0.996 bytes=79103
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=59 metric=0.6860 head_norm=1.826728
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.958469e-02
[S17] stored merged vector for next round verification (round=59)
[S17] DEBUG after merge:  round=59 metric=0.6860 head_norm=1.819468 delta_norm=0.019585
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=60 psi=0.763 u=0.3275 p_local=0.1839 f1=0.686 auprc=0.878 bytes=68358
[S2] START round=60 head_norm_before_train=1.932167 cos_to_last_merge=1.0000 (last merge round=59)
[S2] round=60 local utility u=0.000000 metrics={'f1_val': 0.6733861078074213, 'auprc': 0.7123274250420848, 'loss_val': 1.1162426355151218, 'psi': 0.6889626347012867}-{'f1_val': 0.7078267519520144, 'auprc': 0.9435303166046987, 'loss_val': 0.4709093565550326, 'psi': 0.8021081778130881}
[S3] START round=60 head_norm_before_train=2.050794 cos_to_last_merge=0.8976 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.898
[S3] round=60 local utility u=0.087703 metrics={'f1_val': 0.7887182283455005, 'auprc': 0.9760574394460986, 'loss_val': 0.5447925197209434, 'psi': 0.8636539127857397}-{'f1_val': 0.7518753749933786, 'auprc': 0.9908985828784501, 'loss_val': 0.5436647363797942, 'psi': 0.8474846581474071}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=60 head_norm_before_train=1.822033 cos_to_last_merge=0.7933 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.793
[S4] round=60 local utility u=0.000000 metrics={'f1_val': 0.9395268187080691, 'auprc': 0.9748006505366329, 'loss_val': 0.27751262677495137, 'psi': 0.9536363514394947}-{'f1_val': 0.9540807359706407, 'auprc': 0.9731798215134411, 'loss_val': 0.27798975040063567, 'psi': 0.9617203701877608}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=60 head_norm_before_train=2.094735 (no previous merge yet)
[S5] round=60 local utility u=0.001262 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.9953984253262803, 'loss_val': 0.03193634851294849, 'psi': 0.9957834996693445}-{'f1_val': 0.9955317630604515, 'auprc': 0.995478736916395, 'loss_val': 0.03165111639609382, 'psi': 0.995510552602829}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=60 head_norm_before_train=1.766662 cos_to_last_merge=0.8955 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.895
[S6] round=60 local utility u=0.000000 metrics={'f1_val': 0.590211339083035, 'auprc': 0.7740895977713683, 'loss_val': 1.218162354784299, 'psi': 0.6637626425583684}-{'f1_val': 0.9777188994968923, 'auprc': 0.985033958258506, 'loss_val': 0.11306441787750038, 'psi': 0.9806449230015377}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=60 head_norm_before_train=1.827606 cos_to_last_merge=0.9845 (last merge round=17)
[S7] round=60 local utility u=0.432102 metrics={'f1_val': 0.7368278451506688, 'auprc': 0.8330871031205633, 'loss_val': 0.31017692685345816, 'psi': 0.7753315483386266}-{'f1_val': 0.6528066898660749, 'auprc': 0.7983432395239873, 'loss_val': 0.5660215595078318, 'psi': 0.7110213097292399}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=60 head_norm_before_train=1.815970 cos_to_last_merge=1.0000 (last merge round=58)
[S8] round=60 local utility u=0.002326 metrics={'f1_val': 0.9933751911041674, 'auprc': 0.9994076052654539, 'loss_val': 0.0337153711666263, 'psi': 0.9957881567686819}-{'f1_val': 0.9926035371309061, 'auprc': 0.9993792419981774, 'loss_val': 0.033652686186485356, 'psi': 0.9953138190778146}
[S9] START round=60 head_norm_before_train=2.013083 cos_to_last_merge=0.9726 (last merge round=13)
[S9] round=60 local utility u=0.000000 metrics={'f1_val': 0.9962500947792776, 'auprc': 0.9986896379605125, 'loss_val': 0.01737142648322191, 'psi': 0.9972259120517716}-{'f1_val': 0.9966605118138915, 'auprc': 0.9986849588662325, 'loss_val': 0.016487815375925554, 'psi': 0.9974702906348278}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=60 head_norm_before_train=1.674844 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=60 local utility u=0.000157 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959574853614134, 'loss_val': 0.028850807945329286, 'psi': 0.9954956975561902}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959822857115349, 'loss_val': 0.029238960160303435, 'psi': 0.9955056176962388}
[S11] START round=60 head_norm_before_train=1.933181 cos_to_last_merge=1.0000 (last merge round=57)
[S11] round=60 local utility u=0.033271 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9947210502019641, 'loss_val': 0.02475512311280002, 'psi': 0.9958166227889393}-{'f1_val': 0.9886647592405385, 'auprc': 0.9947753127708258, 'loss_val': 0.04416655382803082, 'psi': 0.9911089806526534}
[S13] START round=60 head_norm_before_train=1.671215 cos_to_last_merge=1.0000 (last merge round=58)
[S13] round=60 local utility u=0.000000 metrics={'f1_val': 0.6624882933717611, 'auprc': 0.7611212820063566, 'loss_val': 0.9105201148659301, 'psi': 0.7019414888255993}-{'f1_val': 0.6867461662815595, 'auprc': 0.8083529953528368, 'loss_val': 0.9692987204390219, 'psi': 0.7353888979100704}
[S14] START round=60 head_norm_before_train=1.849623 cos_to_last_merge=0.8423 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.842
[S14] round=60 local utility u=0.000000 metrics={'f1_val': 0.9964034173396682, 'auprc': 0.9989329921837106, 'loss_val': 0.02943115702375431, 'psi': 0.9974152472772851}-{'f1_val': 0.997412260144531, 'auprc': 0.9990010521474972, 'loss_val': 0.020637182582430212, 'psi': 0.9980477769457176}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=60 head_norm_before_train=1.882735 cos_to_last_merge=0.9319 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.932
[S15] round=60 local utility u=0.000000 metrics={'f1_val': 0.9959606213387688, 'auprc': 0.9914720673023193, 'loss_val': 0.030030152899010402, 'psi': 0.9941651997241889}-{'f1_val': 0.9956438101891232, 'auprc': 0.9926970392530357, 'loss_val': 0.03164754809408525, 'psi': 0.9944651018146882}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=60 head_norm_before_train=2.069312 (no previous merge yet)
[S16] round=60 local utility u=0.000000 metrics={'f1_val': 0.9302682720905201, 'auprc': 0.9776544287301587, 'loss_val': 0.4197957304916286, 'psi': 0.9492227347463755}-{'f1_val': 0.9907907501852705, 'auprc': 0.9863836157251804, 'loss_val': 0.051209250906204595, 'psi': 0.9890278964012345}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=60 head_norm_before_train=1.819468 cos_to_last_merge=1.0000 (last merge round=59)
[S17] round=60 local utility u=0.000000 metrics={'f1_val': 0.6759426596984934, 'auprc': 0.836312215192163, 'loss_val': 1.127351261520598, 'psi': 0.7400904818959613}-{'f1_val': 0.6859583380913881, 'auprc': 0.8780957798313879, 'loss_val': 1.0237989445781075, 'psi': 0.762813314787388}
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S10] → sending delta(kind=head bytes=1794) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:54517
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=60 metric=0.6625 head_norm=1.674407
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.723147e-03
[S13] stored merged vector for next round verification (round=60)
[S13] DEBUG after merge:  round=60 metric=0.6617 head_norm=1.674603 delta_norm=0.008723
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.093 → S10@127.0.0.1:54511
[S17] ⇄ pheromone p=0.147 → S8@127.0.0.1:54509
[S10] sending update (kind=head size=1794 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S2] ⇄ pheromone p=0.068 → S11@127.0.0.1:54512
[S8] sending update (kind=head size=1804 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1794) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] ⇄ pheromone p=0.001 → S13@127.0.0.1:54513
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=60 metric=0.9934 head_norm=1.820568
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.759012e-02
[S8] stored merged vector for next round verification (round=60)
[S8] DEBUG after merge:  round=60 metric=0.9930 head_norm=1.823566 delta_norm=0.017590
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.014 → S17@127.0.0.1:54517
[S11] ⇄ pheromone p=0.045 → S2@127.0.0.1:54502
[S2] START round=61 head_norm_before_train=1.935185 cos_to_last_merge=1.0000 (last merge round=59)
[S2] round=61 local utility u=0.652669 metrics={'f1_val': 0.7032697041040568, 'auprc': 0.893812864265668, 'loss_val': 0.5346615973486704, 'psi': 0.7794869681687012}-{'f1_val': 0.6733861078074213, 'auprc': 0.7123274250420848, 'loss_val': 1.1162426355151218, 'psi': 0.6889626347012867}
[S3] START round=61 head_norm_before_train=2.058569 cos_to_last_merge=0.8970 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=61 local utility u=0.000000 metrics={'f1_val': 0.7318682540305449, 'auprc': 0.9962215643862744, 'loss_val': 0.7563468635022963, 'psi': 0.8376095781728368}-{'f1_val': 0.7887182283455005, 'auprc': 0.9760574394460986, 'loss_val': 0.5447925197209434, 'psi': 0.8636539127857397}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=61 head_norm_before_train=1.826743 cos_to_last_merge=0.7923 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.792
[S4] round=61 local utility u=0.010137 metrics={'f1_val': 0.9421265107777781, 'auprc': 0.9747867978682997, 'loss_val': 0.27279424761726256, 'psi': 0.9551906256139867}-{'f1_val': 0.9395268187080691, 'auprc': 0.9748006505366329, 'loss_val': 0.27751262677495137, 'psi': 0.9536363514394947}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=61 head_norm_before_train=2.101243 (no previous merge yet)
[S5] round=61 local utility u=0.000000 metrics={'f1_val': 0.995671490833627, 'auprc': 0.9875620059921449, 'loss_val': 0.04926232431274673, 'psi': 0.9924276968970343}-{'f1_val': 0.9960402158980539, 'auprc': 0.9953984253262803, 'loss_val': 0.03193634851294849, 'psi': 0.9957834996693445}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=61 head_norm_before_train=1.772983 cos_to_last_merge=0.8943 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.894
[S6] round=61 local utility u=0.971890 metrics={'f1_val': 0.7514346742552829, 'auprc': 0.9415947347707796, 'loss_val': 0.744236842311746, 'psi': 0.8274986984614816}-{'f1_val': 0.590211339083035, 'auprc': 0.7740895977713683, 'loss_val': 1.218162354784299, 'psi': 0.6637626425583684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S6] sending update (kind=head size=1806 to 1 peers)
[S7] START round=61 head_norm_before_train=1.829747 cos_to_last_merge=0.9840 (last merge round=17)
[S7] round=61 local utility u=0.000000 metrics={'f1_val': 0.5151204993137732, 'auprc': 0.7775334061972785, 'loss_val': 1.0112294840588403, 'psi': 0.6200856620671753}-{'f1_val': 0.7368278451506688, 'auprc': 0.8330871031205633, 'loss_val': 0.31017692685345816, 'psi': 0.7753315483386266}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=61 head_norm_before_train=1.823566 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=61 local utility u=0.000000 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9995892905245372, 'loss_val': 0.03317891665343831, 'psi': 0.9956164960317402}-{'f1_val': 0.9933751911041674, 'auprc': 0.9994076052654539, 'loss_val': 0.0337153711666263, 'psi': 0.9957881567686819}
[S9] START round=61 head_norm_before_train=2.016277 cos_to_last_merge=0.9717 (last merge round=13)
[S9] round=61 local utility u=0.000000 metrics={'f1_val': 0.9934847371778757, 'auprc': 0.9991231354633578, 'loss_val': 0.025009286558035443, 'psi': 0.9957400964920685}-{'f1_val': 0.9962500947792776, 'auprc': 0.9986896379605125, 'loss_val': 0.01737142648322191, 'psi': 0.9972259120517716}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=61 head_norm_before_train=1.684842 cos_to_last_merge=1.0000 (last merge round=58)
[S10] round=61 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9955994819367036, 'loss_val': 0.029172026219589184, 'psi': 0.9953524961863063}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959574853614134, 'loss_val': 0.028850807945329286, 'psi': 0.9954956975561902}
[S11] START round=61 head_norm_before_train=1.939199 cos_to_last_merge=0.9999 (last merge round=57)
[S11] round=61 local utility u=0.002603 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9966557976052732, 'loss_val': 0.022872456420517343, 'psi': 0.9963425239900949}-{'f1_val': 0.9965470045135896, 'auprc': 0.9947210502019641, 'loss_val': 0.02475512311280002, 'psi': 0.9958166227889393}
[S13] START round=61 head_norm_before_train=1.674603 cos_to_last_merge=1.0000 (last merge round=60)
[S13] round=61 local utility u=0.358227 metrics={'f1_val': 0.7398308688093234, 'auprc': 0.817028424138107, 'loss_val': 0.8258431320324066, 'psi': 0.7707098909408368}-{'f1_val': 0.6624882933717611, 'auprc': 0.7611212820063566, 'loss_val': 0.9105201148659301, 'psi': 0.7019414888255993}
[S14] START round=61 head_norm_before_train=1.855979 cos_to_last_merge=0.8418 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.842
[S14] round=61 local utility u=0.006353 metrics={'f1_val': 0.9976511180498535, 'auprc': 0.9973919940454681, 'loss_val': 0.019588651943214817, 'psi': 0.9975474684480994}-{'f1_val': 0.9964034173396682, 'auprc': 0.9989329921837106, 'loss_val': 0.02943115702375431, 'psi': 0.9974152472772851}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S14] sending update (kind=head size=1806 to 1 peers)
[S15] START round=61 head_norm_before_train=1.890886 cos_to_last_merge=0.9312 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=61 local utility u=0.000000 metrics={'f1_val': 0.7524456021762013, 'auprc': 0.9632971151646649, 'loss_val': 0.488586594289468, 'psi': 0.8367862073715867}-{'f1_val': 0.9959606213387688, 'auprc': 0.9914720673023193, 'loss_val': 0.030030152899010402, 'psi': 0.9941651997241889}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=61 head_norm_before_train=2.075073 (no previous merge yet)
[S16] round=61 local utility u=0.000000 metrics={'f1_val': 0.8917600838758436, 'auprc': 0.9366807975856573, 'loss_val': 0.6015820923542151, 'psi': 0.9097283693597691}-{'f1_val': 0.9302682720905201, 'auprc': 0.9776544287301587, 'loss_val': 0.4197957304916286, 'psi': 0.9492227347463755}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=61 head_norm_before_train=1.828016 cos_to_last_merge=1.0000 (last merge round=59)
[S17] round=61 local utility u=0.000000 metrics={'f1_val': 0.6601021365851394, 'auprc': 0.8385837260266025, 'loss_val': 1.1560714015055173, 'psi': 0.7314947723617247}-{'f1_val': 0.6759426596984934, 'auprc': 0.836312215192163, 'loss_val': 1.127351261520598, 'psi': 0.7400904818959613}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=61 metric=0.6601 head_norm=1.839457
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.023503e-02
[S17] stored merged vector for next round verification (round=61)
[S17] DEBUG after merge:  round=61 metric=0.6600 head_norm=1.829925 delta_norm=0.020235
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9998
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=0.9998
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=61 metric=0.7398 head_norm=1.676332
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.250722e-03
[S13] stored merged vector for next round verification (round=61)
[S13] DEBUG after merge:  round=61 metric=0.7402 head_norm=1.680567 delta_norm=0.009251
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=61 metric=0.7033 head_norm=1.938596
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.709881e-02
[S2] stored merged vector for next round verification (round=61)
[S2] DEBUG after merge:  round=61 metric=0.7033 head_norm=1.940859 delta_norm=0.017099
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=61 metric=0.9961 head_norm=1.947348
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.856153e-02
[S11] stored merged vector for next round verification (round=61)
[S11] DEBUG after merge:  round=61 metric=0.9961 head_norm=1.942888 delta_norm=0.018562
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=62 head_norm_before_train=1.940859 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=62 local utility u=0.000000 metrics={'f1_val': 0.766991773465479, 'auprc': 0.7457741997946479, 'loss_val': 0.5896148650978196, 'psi': 0.7585047439971465}-{'f1_val': 0.7032697041040568, 'auprc': 0.893812864265668, 'loss_val': 0.5346615973486704, 'psi': 0.7794869681687012}
[S3] START round=62 head_norm_before_train=2.065421 cos_to_last_merge=0.8966 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.897
[S3] round=62 local utility u=0.000000 metrics={'f1_val': 0.7389022936101909, 'auprc': 0.9192692499579691, 'loss_val': 0.8096653522842836, 'psi': 0.8110490761493021}-{'f1_val': 0.7318682540305449, 'auprc': 0.9962215643862744, 'loss_val': 0.7563468635022963, 'psi': 0.8376095781728368}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=62 head_norm_before_train=1.831413 cos_to_last_merge=0.7914 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.791
[S4] round=62 local utility u=0.009361 metrics={'f1_val': 0.952883907677358, 'auprc': 0.9635590634009841, 'loss_val': 0.28493300031313423, 'psi': 0.9571539699668085}-{'f1_val': 0.9421265107777781, 'auprc': 0.9747867978682997, 'loss_val': 0.27279424761726256, 'psi': 0.9551906256139867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S4] sending update (kind=head size=1805 to 1 peers)
[S5] START round=62 head_norm_before_train=2.101460 (no previous merge yet)
[S5] round=62 local utility u=0.023393 metrics={'f1_val': 0.996186023309311, 'auprc': 0.995636598072644, 'loss_val': 0.029786625485434665, 'psi': 0.9959662532146443}-{'f1_val': 0.995671490833627, 'auprc': 0.9875620059921449, 'loss_val': 0.04926232431274673, 'psi': 0.9924276968970343}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=62 head_norm_before_train=1.778661 cos_to_last_merge=0.8935 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=62 local utility u=0.320994 metrics={'f1_val': 0.8062202113605808, 'auprc': 0.9642837786744928, 'loss_val': 0.49902901580953696, 'psi': 0.8694456382861455}-{'f1_val': 0.7514346742552829, 'auprc': 0.9415947347707796, 'loss_val': 0.744236842311746, 'psi': 0.8274986984614816}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=62 head_norm_before_train=1.834967 cos_to_last_merge=0.9837 (last merge round=17)
[S7] round=62 local utility u=0.356683 metrics={'f1_val': 0.5883256088403876, 'auprc': 0.7840708057685543, 'loss_val': 0.756706568479181, 'psi': 0.6666236876116542}-{'f1_val': 0.5151204993137732, 'auprc': 0.7775334061972785, 'loss_val': 1.0112294840588403, 'psi': 0.6200856620671753}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=62 head_norm_before_train=1.829362 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=62 local utility u=0.000000 metrics={'f1_val': 0.9871538275294434, 'auprc': 0.9960208332632726, 'loss_val': 0.046448093546561216, 'psi': 0.990700629822975}-{'f1_val': 0.9929679663698754, 'auprc': 0.9995892905245372, 'loss_val': 0.03317891665343831, 'psi': 0.9956164960317402}
[S9] START round=62 head_norm_before_train=2.021041 cos_to_last_merge=0.9715 (last merge round=13)
[S9] round=62 local utility u=0.014975 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.9990360977564816, 'loss_val': 0.016507826717175697, 'psi': 0.9978761866098783}-{'f1_val': 0.9934847371778757, 'auprc': 0.9991231354633578, 'loss_val': 0.025009286558035443, 'psi': 0.9957400964920685}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=62 head_norm_before_train=1.695208 cos_to_last_merge=0.9999 (last merge round=58)
[S10] round=62 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9954997175347164, 'loss_val': 0.02903313238418613, 'psi': 0.9953125904255113}-{'f1_val': 0.9951878390193748, 'auprc': 0.9955994819367036, 'loss_val': 0.029172026219589184, 'psi': 0.9953524961863063}
[S11] START round=62 head_norm_before_train=1.942888 cos_to_last_merge=1.0000 (last merge round=61)
[S11] round=62 local utility u=0.000000 metrics={'f1_val': 0.990643002993754, 'auprc': 0.9962846643273127, 'loss_val': 0.058247213439365224, 'psi': 0.9928996675271774}-{'f1_val': 0.9961336749133093, 'auprc': 0.9966557976052732, 'loss_val': 0.022872456420517343, 'psi': 0.9963425239900949}
[S13] START round=62 head_norm_before_train=1.680567 cos_to_last_merge=1.0000 (last merge round=61)
[S13] round=62 local utility u=0.000000 metrics={'f1_val': 0.7375698210970894, 'auprc': 0.8242865669494245, 'loss_val': 0.853636122263213, 'psi': 0.7722565194380234}-{'f1_val': 0.7398308688093234, 'auprc': 0.817028424138107, 'loss_val': 0.8258431320324066, 'psi': 0.7707098909408368}
[S14] START round=62 head_norm_before_train=1.863359 cos_to_last_merge=0.8413 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.841
[S14] round=62 local utility u=0.000000 metrics={'f1_val': 0.9965396219276069, 'auprc': 0.9991414128964596, 'loss_val': 0.023412842565366753, 'psi': 0.997580338315148}-{'f1_val': 0.9976511180498535, 'auprc': 0.9973919940454681, 'loss_val': 0.019588651943214817, 'psi': 0.9975474684480994}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=62 head_norm_before_train=1.898709 cos_to_last_merge=0.9305 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.931
[S15] round=62 local utility u=1.000000 metrics={'f1_val': 0.9961155290912821, 'auprc': 0.99793049423894, 'loss_val': 0.023724409329263497, 'psi': 0.9968415151503452}-{'f1_val': 0.7524456021762013, 'auprc': 0.9632971151646649, 'loss_val': 0.488586594289468, 'psi': 0.8367862073715867}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=62 head_norm_before_train=2.081216 (no previous merge yet)
[S16] round=62 local utility u=0.336829 metrics={'f1_val': 0.9394488383910659, 'auprc': 0.979758862040108, 'loss_val': 0.3432914409922491, 'psi': 0.9555728478506826}-{'f1_val': 0.8917600838758436, 'auprc': 0.9366807975856573, 'loss_val': 0.6015820923542151, 'psi': 0.9097283693597691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=62 head_norm_before_train=1.829925 cos_to_last_merge=1.0000 (last merge round=61)
[S17] round=62 local utility u=0.201107 metrics={'f1_val': 0.6942827505687235, 'auprc': 0.8745124855840352, 'loss_val': 1.0667271080815997, 'psi': 0.7663746445748482}-{'f1_val': 0.6601021365851394, 'auprc': 0.8385837260266025, 'loss_val': 1.1560714015055173, 'psi': 0.7314947723617247}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1799 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=62 metric=0.9952 head_norm=1.705261
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.928171e-02
[S10] stored merged vector for next round verification (round=62)
[S10] DEBUG after merge:  round=62 metric=0.9952 head_norm=1.690749 delta_norm=0.019282
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9999
[S2] START round=63 head_norm_before_train=1.944083 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=63 local utility u=0.252286 metrics={'f1_val': 0.7091311549731226, 'auprc': 0.9884861648655048, 'loss_val': 0.4660151964408621, 'psi': 0.8208731589300755}-{'f1_val': 0.766991773465479, 'auprc': 0.7457741997946479, 'loss_val': 0.5896148650978196, 'psi': 0.7585047439971465}
[S3] START round=63 head_norm_before_train=2.069790 cos_to_last_merge=0.8963 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=63 local utility u=0.797161 metrics={'f1_val': 0.8788659027915919, 'auprc': 0.9968427803782101, 'loss_val': 0.2878446845178425, 'psi': 0.9260566538262391}-{'f1_val': 0.7389022936101909, 'auprc': 0.9192692499579691, 'loss_val': 0.8096653522842836, 'psi': 0.8110490761493021}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S3] sending update (kind=head size=1798 to 1 peers)
[S4] START round=63 head_norm_before_train=1.838825 cos_to_last_merge=0.7903 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.790
[S4] round=63 local utility u=0.000000 metrics={'f1_val': 0.937532143962544, 'auprc': 0.9612089982936514, 'loss_val': 0.2878375150647783, 'psi': 0.9470028856949869}-{'f1_val': 0.952883907677358, 'auprc': 0.9635590634009841, 'loss_val': 0.28493300031313423, 'psi': 0.9571539699668085}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=63 head_norm_before_train=2.102659 (no previous merge yet)
[S5] round=63 local utility u=0.000000 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9955512660267019, 'loss_val': 0.031532250830709214, 'psi': 0.9957133280772928}-{'f1_val': 0.996186023309311, 'auprc': 0.995636598072644, 'loss_val': 0.029786625485434665, 'psi': 0.9959662532146443}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=63 head_norm_before_train=1.786083 cos_to_last_merge=0.8931 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=63 local utility u=0.060403 metrics={'f1_val': 0.8266366382146825, 'auprc': 0.9549376508426067, 'loss_val': 0.472682953792337, 'psi': 0.8779570432658521}-{'f1_val': 0.8062202113605808, 'auprc': 0.9642837786744928, 'loss_val': 0.49902901580953696, 'psi': 0.8694456382861455}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=63 head_norm_before_train=1.840421 cos_to_last_merge=0.9833 (last merge round=17)
[S7] round=63 local utility u=0.000000 metrics={'f1_val': 0.5699575299450498, 'auprc': 0.7789039085198854, 'loss_val': 0.9031987855728874, 'psi': 0.6535360813749841}-{'f1_val': 0.5883256088403876, 'auprc': 0.7840708057685543, 'loss_val': 0.756706568479181, 'psi': 0.6666236876116542}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=63 head_norm_before_train=1.837044 cos_to_last_merge=1.0000 (last merge round=60)
[S8] round=63 local utility u=0.033995 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.999585888600087, 'loss_val': 0.030830769105318193, 'psi': 0.9962943636541137}-{'f1_val': 0.9871538275294434, 'auprc': 0.9960208332632726, 'loss_val': 0.046448093546561216, 'psi': 0.990700629822975}
[S9] START round=63 head_norm_before_train=2.027243 cos_to_last_merge=0.9715 (last merge round=13)
[S9] round=63 local utility u=0.000100 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999060803341076, 'loss_val': 0.016381632226419425, 'psi': 0.9978860688437161}-{'f1_val': 0.9971029125121428, 'auprc': 0.9990360977564816, 'loss_val': 0.016507826717175697, 'psi': 0.9978761866098783}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=63 head_norm_before_train=1.690749 cos_to_last_merge=1.0000 (last merge round=62)
[S10] round=63 local utility u=0.000618 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956883196929572, 'loss_val': 0.028363264233164022, 'psi': 0.9953880312888077}-{'f1_val': 0.9951878390193748, 'auprc': 0.9954997175347164, 'loss_val': 0.02903313238418613, 'psi': 0.9953125904255113}
[S11] START round=63 head_norm_before_train=1.952549 cos_to_last_merge=1.0000 (last merge round=61)
[S11] round=63 local utility u=0.000000 metrics={'f1_val': 0.8960891862636462, 'auprc': 0.994544235920954, 'loss_val': 0.1260751889897187, 'psi': 0.9354712061265693}-{'f1_val': 0.990643002993754, 'auprc': 0.9962846643273127, 'loss_val': 0.058247213439365224, 'psi': 0.9928996675271774}
[S13] START round=63 head_norm_before_train=1.684886 cos_to_last_merge=1.0000 (last merge round=61)
[S13] round=63 local utility u=0.048235 metrics={'f1_val': 0.7367766702950169, 'auprc': 0.826097377794162, 'loss_val': 0.7578403005437147, 'psi': 0.7725049532946751}-{'f1_val': 0.7375698210970894, 'auprc': 0.8242865669494245, 'loss_val': 0.853636122263213, 'psi': 0.7722565194380234}
[S14] START round=63 head_norm_before_train=1.871261 cos_to_last_merge=0.8406 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.841
[S14] round=63 local utility u=0.000000 metrics={'f1_val': 0.9051358364467115, 'auprc': 0.919838818430866, 'loss_val': 0.31789625423887263, 'psi': 0.9110170292403732}-{'f1_val': 0.9965396219276069, 'auprc': 0.9991414128964596, 'loss_val': 0.023412842565366753, 'psi': 0.997580338315148}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=63 head_norm_before_train=1.904215 cos_to_last_merge=0.9301 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=63 local utility u=0.000000 metrics={'f1_val': 0.6979638911240416, 'auprc': 0.7434618340833192, 'loss_val': 0.7135795103259214, 'psi': 0.7161630683077527}-{'f1_val': 0.9961155290912821, 'auprc': 0.99793049423894, 'loss_val': 0.023724409329263497, 'psi': 0.9968415151503452}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=63 head_norm_before_train=2.086573 (no previous merge yet)
[S16] round=63 local utility u=0.113419 metrics={'f1_val': 0.9483658407961829, 'auprc': 0.9778680472538505, 'loss_val': 0.16428265234018175, 'psi': 0.9601667233792499}-{'f1_val': 0.9394488383910659, 'auprc': 0.979758862040108, 'loss_val': 0.3432914409922491, 'psi': 0.9555728478506826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=63 head_norm_before_train=1.843376 cos_to_last_merge=1.0000 (last merge round=61)
[S17] round=63 local utility u=0.000000 metrics={'f1_val': 0.6610849241549588, 'auprc': 0.8338832000760288, 'loss_val': 1.1090812628603137, 'psi': 0.7302042345233868}-{'f1_val': 0.6942827505687235, 'auprc': 0.8745124855840352, 'loss_val': 1.0667271080815997, 'psi': 0.7663746445748482}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S13] → sending delta(kind=head bytes=1804) to S10@127.0.0.1:54511
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:54517
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:54512
[S8] sending update (kind=head size=1805 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1804 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1804) from S13
[S10] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9998
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=63 metric=0.7368 head_norm=1.692716
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.094616e-02
[S13] stored merged vector for next round verification (round=63)
[S13] DEBUG after merge:  round=63 metric=0.7362 head_norm=1.696763 delta_norm=0.010946
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=63 metric=0.9952 head_norm=1.700870
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.094616e-02
[S10] stored merged vector for next round verification (round=63)
[S10] DEBUG after merge:  round=63 metric=0.9952 head_norm=1.696763 delta_norm=0.010946
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=63 metric=0.9941 head_norm=1.846416
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.313980e-02
[S8] stored merged vector for next round verification (round=63)
[S8] DEBUG after merge:  round=63 metric=0.9941 head_norm=1.844850 delta_norm=0.013140
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=64 head_norm_before_train=1.947358 cos_to_last_merge=1.0000 (last merge round=61)
[S2] round=64 local utility u=0.152131 metrics={'f1_val': 0.7783111022292384, 'auprc': 0.9296174317386177, 'loss_val': 0.4002270396778453, 'psi': 0.83883363403299}-{'f1_val': 0.7091311549731226, 'auprc': 0.9884861648655048, 'loss_val': 0.4660151964408621, 'psi': 0.8208731589300755}
[S3] START round=64 head_norm_before_train=2.074514 cos_to_last_merge=0.8960 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=64 local utility u=0.003475 metrics={'f1_val': 0.9048668045617682, 'auprc': 0.9504045879555685, 'loss_val': 0.29758555624674926, 'psi': 0.9230819179192882}-{'f1_val': 0.8788659027915919, 'auprc': 0.9968427803782101, 'loss_val': 0.2878446845178425, 'psi': 0.9260566538262391}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S3] sending update (kind=head size=1801 to 1 peers)
[S4] START round=64 head_norm_before_train=1.844026 cos_to_last_merge=0.7890 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.789
[S4] round=64 local utility u=0.000000 metrics={'f1_val': 0.9357740226377455, 'auprc': 0.9572156328445566, 'loss_val': 0.3009447886588869, 'psi': 0.9443506667204699}-{'f1_val': 0.937532143962544, 'auprc': 0.9612089982936514, 'loss_val': 0.2878375150647783, 'psi': 0.9470028856949869}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=64 head_norm_before_train=2.102480 (no previous merge yet)
[S5] round=64 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9949361839268773, 'loss_val': 0.03210565092873463, 'psi': 0.9956860875563376}-{'f1_val': 0.9958213694443535, 'auprc': 0.9955512660267019, 'loss_val': 0.031532250830709214, 'psi': 0.9957133280772928}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=64 head_norm_before_train=1.795262 cos_to_last_merge=0.8929 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.893
[S6] round=64 local utility u=0.000000 metrics={'f1_val': 0.7679685623826928, 'auprc': 0.9684855873617882, 'loss_val': 0.4521427763521994, 'psi': 0.848175372374331}-{'f1_val': 0.8266366382146825, 'auprc': 0.9549376508426067, 'loss_val': 0.472682953792337, 'psi': 0.8779570432658521}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=64 head_norm_before_train=1.851347 cos_to_last_merge=0.9826 (last merge round=17)
[S7] round=64 local utility u=0.228294 metrics={'f1_val': 0.6078623115337299, 'auprc': 0.7876297464373181, 'loss_val': 0.7002167868530693, 'psi': 0.6797692854951652}-{'f1_val': 0.5699575299450498, 'auprc': 0.7789039085198854, 'loss_val': 0.9031987855728874, 'psi': 0.6535360813749841}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=64 head_norm_before_train=1.844850 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=64 local utility u=0.000000 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9991505896875399, 'loss_val': 0.03276692601039442, 'psi': 0.9958913937924636}-{'f1_val': 0.9941000136901317, 'auprc': 0.999585888600087, 'loss_val': 0.030830769105318193, 'psi': 0.9962943636541137}
[S9] START round=64 head_norm_before_train=2.030046 cos_to_last_merge=0.9715 (last merge round=13)
[S9] round=64 local utility u=0.000000 metrics={'f1_val': 0.9964101856672208, 'auprc': 0.9995184179671868, 'loss_val': 0.016947330536535292, 'psi': 0.9976534785872072}-{'f1_val': 0.9971029125121428, 'auprc': 0.999060803341076, 'loss_val': 0.016381632226419425, 'psi': 0.9978860688437161}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=64 head_norm_before_train=1.696763 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=64 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956474054071813, 'loss_val': 0.028560684941532962, 'psi': 0.9953716655744973}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956883196929572, 'loss_val': 0.028363264233164022, 'psi': 0.9953880312888077}
[S11] START round=64 head_norm_before_train=1.962658 cos_to_last_merge=1.0000 (last merge round=61)
[S11] round=64 local utility u=0.092497 metrics={'f1_val': 0.9220087949408495, 'auprc': 0.9951156484418139, 'loss_val': 0.09831264266156536, 'psi': 0.9512515363412353}-{'f1_val': 0.8960891862636462, 'auprc': 0.994544235920954, 'loss_val': 0.1260751889897187, 'psi': 0.9354712061265693}
[S13] START round=64 head_norm_before_train=1.696763 cos_to_last_merge=1.0000 (last merge round=63)
[S13] round=64 local utility u=0.000000 metrics={'f1_val': 0.6424171300304516, 'auprc': 0.8310263910260014, 'loss_val': 1.0054387844219317, 'psi': 0.7178608344286715}-{'f1_val': 0.7367766702950169, 'auprc': 0.826097377794162, 'loss_val': 0.7578403005437147, 'psi': 0.7725049532946751}
[S14] START round=64 head_norm_before_train=1.876996 cos_to_last_merge=0.8403 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.840
[S14] round=64 local utility u=0.542339 metrics={'f1_val': 0.9974336367705932, 'auprc': 0.9974641248670013, 'loss_val': 0.019881470063446184, 'psi': 0.9974458320091564}-{'f1_val': 0.9051358364467115, 'auprc': 0.919838818430866, 'loss_val': 0.31789625423887263, 'psi': 0.9110170292403732}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1807 reason=None
[S14] sending update (kind=head size=1807 to 1 peers)
[S15] START round=64 head_norm_before_train=1.907491 cos_to_last_merge=0.9299 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=64 local utility u=1.000000 metrics={'f1_val': 0.992066389700133, 'auprc': 0.9970111978562568, 'loss_val': 0.04008187300121522, 'psi': 0.9940443129625824}-{'f1_val': 0.6979638911240416, 'auprc': 0.7434618340833192, 'loss_val': 0.7135795103259214, 'psi': 0.7161630683077527}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=64 head_norm_before_train=2.091072 (no previous merge yet)
[S16] round=64 local utility u=0.015400 metrics={'f1_val': 0.9506657155867989, 'auprc': 0.9769343128830082, 'loss_val': 0.14448029126378584, 'psi': 0.9611731545052826}-{'f1_val': 0.9483658407961829, 'auprc': 0.9778680472538505, 'loss_val': 0.16428265234018175, 'psi': 0.9601667233792499}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=64 head_norm_before_train=1.852538 cos_to_last_merge=0.9999 (last merge round=61)
[S17] round=64 local utility u=0.372067 metrics={'f1_val': 0.6940535345376139, 'auprc': 0.8944762156714825, 'loss_val': 0.7445374612631497, 'psi': 0.7742226069911613}-{'f1_val': 0.6610849241549588, 'auprc': 0.8338832000760288, 'loss_val': 1.1090812628603137, 'psi': 0.7302042345233868}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=0.9998
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=64 metric=0.9220 head_norm=1.971795
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.862396e-02
[S11] stored merged vector for next round verification (round=64)
[S11] DEBUG after merge:  round=64 metric=0.9199 head_norm=1.960734 delta_norm=0.018624
[S11] aggregate: ACCEPT kept=['S2', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=64 metric=0.7783 head_norm=1.952222
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.821221e-02
[S2] stored merged vector for next round verification (round=64)
[S2] DEBUG after merge:  round=64 metric=0.7764 head_norm=1.961948 delta_norm=0.018212
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=64 metric=0.6941 head_norm=1.856897
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.085052e-02
[S17] stored merged vector for next round verification (round=64)
[S17] DEBUG after merge:  round=64 metric=0.6952 head_norm=1.851547 delta_norm=0.020851
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=65 head_norm_before_train=1.961948 cos_to_last_merge=1.0000 (last merge round=64)
[S2] round=65 local utility u=0.000000 metrics={'f1_val': 0.7079248603272275, 'auprc': 0.9865829457245711, 'loss_val': 0.4727852450528187, 'psi': 0.8193880944861649}-{'f1_val': 0.7783111022292384, 'auprc': 0.9296174317386177, 'loss_val': 0.4002270396778453, 'psi': 0.83883363403299}
[S3] START round=65 head_norm_before_train=2.080191 cos_to_last_merge=0.8955 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.896
[S3] round=65 local utility u=0.430190 metrics={'f1_val': 0.9832756723461509, 'auprc': 0.9971682418201171, 'loss_val': 0.04794938842001257, 'psi': 0.9888327001357374}-{'f1_val': 0.9048668045617682, 'auprc': 0.9504045879555685, 'loss_val': 0.29758555624674926, 'psi': 0.9230819179192882}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=65 head_norm_before_train=1.850329 cos_to_last_merge=0.7886 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.789
[S4] round=65 local utility u=0.023889 metrics={'f1_val': 0.9400366949717074, 'auprc': 0.9625197961528315, 'loss_val': 0.2946549704601583, 'psi': 0.949029935444157}-{'f1_val': 0.9357740226377455, 'auprc': 0.9572156328445566, 'loss_val': 0.3009447886588869, 'psi': 0.9443506667204699}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=65 head_norm_before_train=2.109291 (no previous merge yet)
[S5] round=65 local utility u=0.000000 metrics={'f1_val': 0.9958213694443535, 'auprc': 0.9952292893230483, 'loss_val': 0.031356088055210604, 'psi': 0.9955845373958314}-{'f1_val': 0.996186023309311, 'auprc': 0.9949361839268773, 'loss_val': 0.03210565092873463, 'psi': 0.9956860875563376}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=65 head_norm_before_train=1.801017 cos_to_last_merge=0.8924 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=65 local utility u=0.483379 metrics={'f1_val': 0.8825516583772959, 'auprc': 0.9826217578348014, 'loss_val': 0.2152927405406535, 'psi': 0.9225796981602981}-{'f1_val': 0.7679685623826928, 'auprc': 0.9684855873617882, 'loss_val': 0.4521427763521994, 'psi': 0.848175372374331}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=65 head_norm_before_train=1.860105 cos_to_last_merge=0.9817 (last merge round=17)
[S7] round=65 local utility u=0.049617 metrics={'f1_val': 0.6098455534681189, 'auprc': 0.792069577186608, 'loss_val': 0.6262022216081983, 'psi': 0.6827351629555145}-{'f1_val': 0.6078623115337299, 'auprc': 0.7876297464373181, 'loss_val': 0.7002167868530693, 'psi': 0.6797692854951652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=65 head_norm_before_train=1.851208 cos_to_last_merge=1.0000 (last merge round=63)
[S8] round=65 local utility u=0.000000 metrics={'f1_val': 0.992174240363445, 'auprc': 0.9969597970783455, 'loss_val': 0.034049505888544725, 'psi': 0.9940884630494052}-{'f1_val': 0.9937185965290795, 'auprc': 0.9991505896875399, 'loss_val': 0.03276692601039442, 'psi': 0.9958913937924636}
[S9] START round=65 head_norm_before_train=2.033965 cos_to_last_merge=0.9710 (last merge round=13)
[S9] round=65 local utility u=0.000000 metrics={'f1_val': 0.9964066858194072, 'auprc': 0.9995139934238377, 'loss_val': 0.017953356754126924, 'psi': 0.9976496088611794}-{'f1_val': 0.9964101856672208, 'auprc': 0.9995184179671868, 'loss_val': 0.016947330536535292, 'psi': 0.9976534785872072}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=65 head_norm_before_train=1.706991 cos_to_last_merge=1.0000 (last merge round=63)
[S10] round=65 local utility u=0.000559 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957797688802205, 'loss_val': 0.02783948538772882, 'psi': 0.995424610963713}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956474054071813, 'loss_val': 0.028560684941532962, 'psi': 0.9953716655744973}
[S11] START round=65 head_norm_before_train=1.960734 cos_to_last_merge=1.0000 (last merge round=64)
[S11] round=65 local utility u=0.000000 metrics={'f1_val': 0.8255763524679481, 'auprc': 0.9942211243542234, 'loss_val': 0.31232423377268015, 'psi': 0.8930342612224582}-{'f1_val': 0.9220087949408495, 'auprc': 0.9951156484418139, 'loss_val': 0.09831264266156536, 'psi': 0.9512515363412353}
[S13] START round=65 head_norm_before_train=1.703493 cos_to_last_merge=1.0000 (last merge round=63)
[S13] round=65 local utility u=0.392312 metrics={'f1_val': 0.740978848965805, 'auprc': 0.8410933264369715, 'loss_val': 0.8423862003802101, 'psi': 0.7810246399542716}-{'f1_val': 0.6424171300304516, 'auprc': 0.8310263910260014, 'loss_val': 1.0054387844219317, 'psi': 0.7178608344286715}
[S14] START round=65 head_norm_before_train=1.880513 cos_to_last_merge=0.8397 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.840
[S14] round=65 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9974309047543278, 'loss_val': 0.02066231440757067, 'psi': 0.9974173236027665}-{'f1_val': 0.9974336367705932, 'auprc': 0.9974641248670013, 'loss_val': 0.019881470063446184, 'psi': 0.9974458320091564}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=65 head_norm_before_train=1.910317 cos_to_last_merge=0.9296 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.930
[S15] round=65 local utility u=0.000000 metrics={'f1_val': 0.9397702852168051, 'auprc': 0.9963043591811493, 'loss_val': 0.08673501717800358, 'psi': 0.9623839148025427}-{'f1_val': 0.992066389700133, 'auprc': 0.9970111978562568, 'loss_val': 0.04008187300121522, 'psi': 0.9940443129625824}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=65 head_norm_before_train=2.096139 (no previous merge yet)
[S16] round=65 local utility u=0.184951 metrics={'f1_val': 0.9922986493711669, 'auprc': 0.9836973420379334, 'loss_val': 0.04466480536726436, 'psi': 0.9888581264378735}-{'f1_val': 0.9506657155867989, 'auprc': 0.9769343128830082, 'loss_val': 0.14448029126378584, 'psi': 0.9611731545052826}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=65 head_norm_before_train=1.851547 cos_to_last_merge=1.0000 (last merge round=64)
[S17] round=65 local utility u=1.000000 metrics={'f1_val': 0.9437978496155714, 'auprc': 0.9881896492214254, 'loss_val': 0.17277733827224764, 'psi': 0.961554569457913}-{'f1_val': 0.6940535345376139, 'auprc': 0.8944762156714825, 'loss_val': 0.7445374612631497, 'psi': 0.7742226069911613}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S13] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1802 to 1 peers)
[S2] ⇄ pheromone p=0.132 → S11@127.0.0.1:54512
[S11] ⇄ pheromone p=0.030 → S2@127.0.0.1:54502
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=65 metric=0.9922 head_norm=1.858539
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.754065e-02
[S8] stored merged vector for next round verification (round=65)
[S8] DEBUG after merge:  round=65 metric=0.9922 head_norm=1.857636 delta_norm=0.017541
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.009 → S17@127.0.0.1:54517
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=0.9999
[S17] ⇄ pheromone p=0.328 → S8@127.0.0.1:54509
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=65 metric=0.7410 head_norm=1.707263
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.120165e-02
[S13] stored merged vector for next round verification (round=65)
[S13] DEBUG after merge:  round=65 metric=0.7413 head_norm=1.712130 delta_norm=0.011202
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.144 → S10@127.0.0.1:54511
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=65 metric=0.9952 head_norm=1.717055
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.120165e-02
[S10] stored merged vector for next round verification (round=65)
[S10] DEBUG after merge:  round=65 metric=0.9952 head_norm=1.712130 delta_norm=0.011202
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S2] START round=66 head_norm_before_train=1.968209 cos_to_last_merge=1.0000 (last merge round=64)
[S2] round=66 local utility u=0.148410 metrics={'f1_val': 0.8060674244922514, 'auprc': 0.8761079651522954, 'loss_val': 0.43339490361042576, 'psi': 0.8340836407562691}-{'f1_val': 0.7079248603272275, 'auprc': 0.9865829457245711, 'loss_val': 0.4727852450528187, 'psi': 0.8193880944861649}
[S3] START round=66 head_norm_before_train=2.085824 cos_to_last_merge=0.8951 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=66 local utility u=0.000000 metrics={'f1_val': 0.8775623755581402, 'auprc': 0.9969054065646058, 'loss_val': 0.2701259948817014, 'psi': 0.9252995879607264}-{'f1_val': 0.9832756723461509, 'auprc': 0.9971682418201171, 'loss_val': 0.04794938842001257, 'psi': 0.9888327001357374}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=66 head_norm_before_train=1.856586 cos_to_last_merge=0.7882 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.788
[S4] round=66 local utility u=0.034738 metrics={'f1_val': 0.9427641670444588, 'auprc': 0.9780825071751799, 'loss_val': 0.28823205139609237, 'psi': 0.9568915030967471}-{'f1_val': 0.9400366949717074, 'auprc': 0.9625197961528315, 'loss_val': 0.2946549704601583, 'psi': 0.949029935444157}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=66 head_norm_before_train=2.120245 (no previous merge yet)
[S5] round=66 local utility u=0.002807 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9955718523667787, 'loss_val': 0.028957237421202424, 'psi': 0.995940354932298}-{'f1_val': 0.9958213694443535, 'auprc': 0.9952292893230483, 'loss_val': 0.031356088055210604, 'psi': 0.9955845373958314}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=66 head_norm_before_train=1.809075 cos_to_last_merge=0.8917 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.892
[S6] round=66 local utility u=0.000000 metrics={'f1_val': 0.8589358091682823, 'auprc': 0.9657447410874034, 'loss_val': 0.3398731368380081, 'psi': 0.9016593819359308}-{'f1_val': 0.8825516583772959, 'auprc': 0.9826217578348014, 'loss_val': 0.2152927405406535, 'psi': 0.9225796981602981}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=66 head_norm_before_train=1.869661 cos_to_last_merge=0.9804 (last merge round=17)
[S7] round=66 local utility u=0.113784 metrics={'f1_val': 0.623654320513953, 'auprc': 0.8000439618216029, 'loss_val': 0.5054108434746764, 'psi': 0.6942101770370129}-{'f1_val': 0.6098455534681189, 'auprc': 0.792069577186608, 'loss_val': 0.6262022216081983, 'psi': 0.6827351629555145}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S7] sending update (kind=head size=1799 to 1 peers)
[S8] START round=66 head_norm_before_train=1.857636 cos_to_last_merge=1.0000 (last merge round=65)
[S8] round=66 local utility u=0.000000 metrics={'f1_val': 0.9850292659535449, 'auprc': 0.9960396376791022, 'loss_val': 0.04769964677991512, 'psi': 0.9894334146437678}-{'f1_val': 0.992174240363445, 'auprc': 0.9969597970783455, 'loss_val': 0.034049505888544725, 'psi': 0.9940884630494052}
[S9] START round=66 head_norm_before_train=2.043285 cos_to_last_merge=0.9707 (last merge round=13)
[S9] round=66 local utility u=0.002084 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9993433747708615, 'loss_val': 0.017261209308644356, 'psi': 0.9979801978299647}-{'f1_val': 0.9964066858194072, 'auprc': 0.9995139934238377, 'loss_val': 0.017953356754126924, 'psi': 0.9976496088611794}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S9] sending update (kind=head size=1799 to 1 peers)
[S10] START round=66 head_norm_before_train=1.712130 cos_to_last_merge=1.0000 (last merge round=65)
[S10] round=66 local utility u=0.000005 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957639793594455, 'loss_val': 0.0277821171896955, 'psi': 0.995418295155403}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957797688802205, 'loss_val': 0.02783948538772882, 'psi': 0.995424610963713}
[S11] START round=66 head_norm_before_train=1.968033 cos_to_last_merge=1.0000 (last merge round=64)
[S11] round=66 local utility u=0.657717 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9951351275138787, 'loss_val': 0.02297522246675309, 'psi': 0.995734255953537}-{'f1_val': 0.8255763524679481, 'auprc': 0.9942211243542234, 'loss_val': 0.31232423377268015, 'psi': 0.8930342612224582}
[S13] START round=66 head_norm_before_train=1.712130 cos_to_last_merge=1.0000 (last merge round=65)
[S13] round=66 local utility u=0.194247 metrics={'f1_val': 0.7779497760216719, 'auprc': 0.844384148230305, 'loss_val': 0.6855894212253907, 'psi': 0.8045235249051252}-{'f1_val': 0.740978848965805, 'auprc': 0.8410933264369715, 'loss_val': 0.8423862003802101, 'psi': 0.7810246399542716}
[S14] START round=66 head_norm_before_train=1.881887 cos_to_last_merge=0.8393 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.839
[S14] round=66 local utility u=0.000000 metrics={'f1_val': 0.9974082695017256, 'auprc': 0.9970241761531489, 'loss_val': 0.02265243236251578, 'psi': 0.9972546321622949}-{'f1_val': 0.9974082695017256, 'auprc': 0.9974309047543278, 'loss_val': 0.02066231440757067, 'psi': 0.9974173236027665}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=66 head_norm_before_train=1.913925 cos_to_last_merge=0.9293 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=66 local utility u=0.000000 metrics={'f1_val': 0.7182717998816595, 'auprc': 0.8040535579185292, 'loss_val': 0.6051112760885607, 'psi': 0.7525845030964073}-{'f1_val': 0.9397702852168051, 'auprc': 0.9963043591811493, 'loss_val': 0.08673501717800358, 'psi': 0.9623839148025427}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=66 head_norm_before_train=2.100804 (no previous merge yet)
[S16] round=66 local utility u=0.010842 metrics={'f1_val': 0.9919448428453432, 'auprc': 0.9906686715379079, 'loss_val': 0.04177270348861292, 'psi': 0.991434374322369}-{'f1_val': 0.9922986493711669, 'auprc': 0.9836973420379334, 'loss_val': 0.04466480536726436, 'psi': 0.9888581264378735}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=66 head_norm_before_train=1.856778 cos_to_last_merge=1.0000 (last merge round=64)
[S17] round=66 local utility u=0.000000 metrics={'f1_val': 0.6814888447523129, 'auprc': 0.8765578956094275, 'loss_val': 0.936910444343593, 'psi': 0.7595164650951587}-{'f1_val': 0.9437978496155714, 'auprc': 0.9881896492214254, 'loss_val': 0.17277733827224764, 'psi': 0.961554569457913}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S11] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S10] sending update (kind=head size=1803 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=66 metric=0.9850 head_norm=1.865421
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.085683e-03
[S8] stored merged vector for next round verification (round=66)
[S8] DEBUG after merge:  round=66 metric=0.9850 head_norm=1.861082 delta_norm=0.009086
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=0.9999
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=66 metric=0.9952 head_norm=1.720691
[S10] _apply_head_vector_avg (torch): Δ‖w‖=5.492968e-03
[S10] stored merged vector for next round verification (round=66)
[S10] DEBUG after merge:  round=66 metric=0.9952 head_norm=1.718132 delta_norm=0.005493
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=66 metric=0.7779 head_norm=1.715587
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.492954e-03
[S13] stored merged vector for next round verification (round=66)
[S13] DEBUG after merge:  round=66 metric=0.7780 head_norm=1.718132 delta_norm=0.005493
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=66 metric=0.9961 head_norm=1.976249
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.066269e-02
[S11] stored merged vector for next round verification (round=66)
[S11] DEBUG after merge:  round=66 metric=0.9961 head_norm=1.975008 delta_norm=0.010663
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=66 metric=0.8061 head_norm=1.973824
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.066270e-02
[S2] stored merged vector for next round verification (round=66)
[S2] DEBUG after merge:  round=66 metric=0.8056 head_norm=1.975008 delta_norm=0.010663
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=67 head_norm_before_train=1.975008 cos_to_last_merge=1.0000 (last merge round=66)
[S2] round=67 local utility u=0.000000 metrics={'f1_val': 0.7091302611948139, 'auprc': 0.9880509875725896, 'loss_val': 0.4848911829605685, 'psi': 0.8206985517459242}-{'f1_val': 0.8060674244922514, 'auprc': 0.8761079651522954, 'loss_val': 0.43339490361042576, 'psi': 0.8340836407562691}
[S3] START round=67 head_norm_before_train=2.086285 cos_to_last_merge=0.8954 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=67 local utility u=0.000000 metrics={'f1_val': 0.7685653768663953, 'auprc': 0.994441343743715, 'loss_val': 0.5578679849791581, 'psi': 0.8589157636173231}-{'f1_val': 0.8775623755581402, 'auprc': 0.9969054065646058, 'loss_val': 0.2701259948817014, 'psi': 0.9252995879607264}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=67 head_norm_before_train=1.862694 cos_to_last_merge=0.7875 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.787
[S4] round=67 local utility u=0.000000 metrics={'f1_val': 0.9528239991045544, 'auprc': 0.9606882855645076, 'loss_val': 0.3084239216099634, 'psi': 0.9559697136885357}-{'f1_val': 0.9427641670444588, 'auprc': 0.9780825071751799, 'loss_val': 0.28823205139609237, 'psi': 0.9568915030967471}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=67 head_norm_before_train=2.137381 (no previous merge yet)
[S5] round=67 local utility u=0.001028 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9957776179806453, 'loss_val': 0.027518910940985658, 'psi': 0.9960226611778448}-{'f1_val': 0.996186023309311, 'auprc': 0.9955718523667787, 'loss_val': 0.028957237421202424, 'psi': 0.995940354932298}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=67 head_norm_before_train=1.818293 cos_to_last_merge=0.8911 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=67 local utility u=0.000000 metrics={'f1_val': 0.6046434788934999, 'auprc': 0.9474480445071909, 'loss_val': 0.8404281250832016, 'psi': 0.7417653051389763}-{'f1_val': 0.8589358091682823, 'auprc': 0.9657447410874034, 'loss_val': 0.3398731368380081, 'psi': 0.9016593819359308}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=67 head_norm_before_train=1.877116 cos_to_last_merge=0.9814 (last merge round=17)
[S7] round=67 local utility u=0.000000 metrics={'f1_val': 0.603329873674851, 'auprc': 0.7948925698199556, 'loss_val': 0.7472662366090727, 'psi': 0.6799549521328929}-{'f1_val': 0.623654320513953, 'auprc': 0.8000439618216029, 'loss_val': 0.5054108434746764, 'psi': 0.6942101770370129}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=67 head_norm_before_train=1.861082 cos_to_last_merge=1.0000 (last merge round=66)
[S8] round=67 local utility u=0.000000 metrics={'f1_val': 0.9781042520488272, 'auprc': 0.9986474479143831, 'loss_val': 0.05863438643563872, 'psi': 0.9863215303950496}-{'f1_val': 0.9850292659535449, 'auprc': 0.9960396376791022, 'loss_val': 0.04769964677991512, 'psi': 0.9894334146437678}
[S9] START round=67 head_norm_before_train=2.050744 cos_to_last_merge=0.9701 (last merge round=13)
[S9] round=67 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996710232376045, 'loss_val': 0.01645589125718007, 'psi': 0.9978647163833767}-{'f1_val': 0.9970714132027002, 'auprc': 0.9993433747708615, 'loss_val': 0.017261209308644356, 'psi': 0.9979801978299647}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=67 head_norm_before_train=1.718132 cos_to_last_merge=1.0000 (last merge round=66)
[S10] round=67 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9956331346816771, 'loss_val': 0.02822666658626222, 'psi': 0.9953659572842957}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957639793594455, 'loss_val': 0.0277821171896955, 'psi': 0.995418295155403}
[S11] START round=67 head_norm_before_train=1.975008 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=67 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9941032501095305, 'loss_val': 0.022191246140815562, 'psi': 0.9954665321892626}-{'f1_val': 0.9961336749133093, 'auprc': 0.9951351275138787, 'loss_val': 0.02297522246675309, 'psi': 0.995734255953537}
[S13] START round=67 head_norm_before_train=1.718132 cos_to_last_merge=1.0000 (last merge round=66)
[S13] round=67 local utility u=0.000000 metrics={'f1_val': 0.6173692531248579, 'auprc': 0.8278941398238704, 'loss_val': 1.229446293705975, 'psi': 0.7015792078044629}-{'f1_val': 0.7779497760216719, 'auprc': 0.844384148230305, 'loss_val': 0.6855894212253907, 'psi': 0.8045235249051252}
[S14] START round=67 head_norm_before_train=1.882430 cos_to_last_merge=0.8390 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.839
[S14] round=67 local utility u=0.000000 metrics={'f1_val': 0.9967810786833209, 'auprc': 0.9971570187099768, 'loss_val': 0.024566320627600922, 'psi': 0.9969314546939833}-{'f1_val': 0.9974082695017256, 'auprc': 0.9970241761531489, 'loss_val': 0.02265243236251578, 'psi': 0.9972546321622949}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=67 head_norm_before_train=1.918522 cos_to_last_merge=0.9289 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.929
[S15] round=67 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9978471866999171, 'loss_val': 0.02213076107215251, 'psi': 0.9970544420457177}-{'f1_val': 0.7182717998816595, 'auprc': 0.8040535579185292, 'loss_val': 0.6051112760885607, 'psi': 0.7525845030964073}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=67 head_norm_before_train=2.105510 (no previous merge yet)
[S16] round=67 local utility u=0.005503 metrics={'f1_val': 0.9925772784750173, 'auprc': 0.9926540719483803, 'loss_val': 0.040517083404669224, 'psi': 0.9926079958643625}-{'f1_val': 0.9919448428453432, 'auprc': 0.9906686715379079, 'loss_val': 0.04177270348861292, 'psi': 0.991434374322369}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S16] sending update (kind=head size=1801 to 1 peers)
[S17] START round=67 head_norm_before_train=1.858873 cos_to_last_merge=1.0000 (last merge round=64)
[S17] round=67 local utility u=0.000000 metrics={'f1_val': 0.6408881355548818, 'auprc': 0.8309753843280321, 'loss_val': 1.152033543777006, 'psi': 0.7169230350641419}-{'f1_val': 0.6814888447523129, 'auprc': 0.8765578956094275, 'loss_val': 0.936910444343593, 'psi': 0.7595164650951587}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] START round=68 head_norm_before_train=1.980447 cos_to_last_merge=1.0000 (last merge round=66)
[S2] round=68 local utility u=0.000000 metrics={'f1_val': 0.7167945230597719, 'auprc': 0.8644521757122833, 'loss_val': 0.5950346444842278, 'psi': 0.7758575841207764}-{'f1_val': 0.7091302611948139, 'auprc': 0.9880509875725896, 'loss_val': 0.4848911829605685, 'psi': 0.8206985517459242}
[S3] START round=68 head_norm_before_train=2.088708 cos_to_last_merge=0.8952 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=68 local utility u=0.762656 metrics={'f1_val': 0.9605438728991138, 'auprc': 0.9917917039330377, 'loss_val': 0.1764780679666013, 'psi': 0.9730430053126833}-{'f1_val': 0.7685653768663953, 'auprc': 0.994441343743715, 'loss_val': 0.5578679849791581, 'psi': 0.8589157636173231}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S3] sending update (kind=head size=1802 to 1 peers)
[S4] START round=68 head_norm_before_train=1.869052 cos_to_last_merge=0.7866 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.787
[S4] round=68 local utility u=0.019906 metrics={'f1_val': 0.9521329864740512, 'auprc': 0.9709840288964008, 'loss_val': 0.295353848059646, 'psi': 0.959673403442991}-{'f1_val': 0.9528239991045544, 'auprc': 0.9606882855645076, 'loss_val': 0.3084239216099634, 'psi': 0.9559697136885357}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=68 head_norm_before_train=2.148491 (no previous merge yet)
[S5] round=68 local utility u=0.001562 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9964990050467214, 'loss_val': 0.026560018735195628, 'psi': 0.9963112160042752}-{'f1_val': 0.996186023309311, 'auprc': 0.9957776179806453, 'loss_val': 0.027518910940985658, 'psi': 0.9960226611778448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=68 head_norm_before_train=1.827447 cos_to_last_merge=0.8905 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.891
[S6] round=68 local utility u=0.795338 metrics={'f1_val': 0.7950603009685575, 'auprc': 0.9598624288815998, 'loss_val': 0.4294965242190144, 'psi': 0.8609811521337745}-{'f1_val': 0.6046434788934999, 'auprc': 0.9474480445071909, 'loss_val': 0.8404281250832016, 'psi': 0.7417653051389763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=68 head_norm_before_train=1.885290 cos_to_last_merge=0.9814 (last merge round=17)
[S7] round=68 local utility u=0.000000 metrics={'f1_val': 0.45229059836610547, 'auprc': 0.7810188460208438, 'loss_val': 1.005860828233509, 'psi': 0.5837818974280009}-{'f1_val': 0.603329873674851, 'auprc': 0.7948925698199556, 'loss_val': 0.7472662366090727, 'psi': 0.6799549521328929}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=68 head_norm_before_train=1.869201 cos_to_last_merge=1.0000 (last merge round=66)
[S8] round=68 local utility u=0.060770 metrics={'f1_val': 0.9931893602624928, 'auprc': 0.9994337059120779, 'loss_val': 0.029964527793679873, 'psi': 0.995687098522327}-{'f1_val': 0.9781042520488272, 'auprc': 0.9986474479143831, 'loss_val': 0.05863438643563872, 'psi': 0.9863215303950496}
[S9] START round=68 head_norm_before_train=2.054054 cos_to_last_merge=0.9690 (last merge round=13)
[S9] round=68 local utility u=0.000000 metrics={'f1_val': 0.9962710290637395, 'auprc': 0.9997149678371999, 'loss_val': 0.017274840611701134, 'psi': 0.9976486045731237}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996710232376045, 'loss_val': 0.01645589125718007, 'psi': 0.9978647163833767}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=68 head_norm_before_train=1.725940 cos_to_last_merge=1.0000 (last merge round=66)
[S10] round=68 local utility u=0.000931 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958395185773103, 'loss_val': 0.026983905804134102, 'psi': 0.995448510842549}-{'f1_val': 0.9951878390193748, 'auprc': 0.9956331346816771, 'loss_val': 0.02822666658626222, 'psi': 0.9953659572842957}
[S11] START round=68 head_norm_before_train=1.982072 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=68 local utility u=0.000000 metrics={'f1_val': 0.9537537227980604, 'auprc': 0.9937176344224838, 'loss_val': 0.13933226402108886, 'psi': 0.9697392874478297}-{'f1_val': 0.9963753869090841, 'auprc': 0.9941032501095305, 'loss_val': 0.022191246140815562, 'psi': 0.9954665321892626}
[S13] START round=68 head_norm_before_train=1.720602 cos_to_last_merge=1.0000 (last merge round=66)
[S13] round=68 local utility u=0.526368 metrics={'f1_val': 0.720291610437086, 'auprc': 0.8573139684283662, 'loss_val': 0.8825047608003067, 'psi': 0.7751005536335981}-{'f1_val': 0.6173692531248579, 'auprc': 0.8278941398238704, 'loss_val': 1.229446293705975, 'psi': 0.7015792078044629}
[S14] START round=68 head_norm_before_train=1.886628 cos_to_last_merge=0.8387 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.839
[S14] round=68 local utility u=0.000000 metrics={'f1_val': 0.9600826619159233, 'auprc': 0.9973814350773644, 'loss_val': 0.07070827778924538, 'psi': 0.9750021711804997}-{'f1_val': 0.9967810786833209, 'auprc': 0.9971570187099768, 'loss_val': 0.024566320627600922, 'psi': 0.9969314546939833}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=68 head_norm_before_train=1.924176 cos_to_last_merge=0.9285 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=68 local utility u=0.000000 metrics={'f1_val': 0.7708704862661642, 'auprc': 0.9134949876103983, 'loss_val': 0.5248260001897224, 'psi': 0.8279202868038578}-{'f1_val': 0.9965259456095847, 'auprc': 0.9978471866999171, 'loss_val': 0.02213076107215251, 'psi': 0.9970544420457177}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=68 head_norm_before_train=2.111053 (no previous merge yet)
[S16] round=68 local utility u=0.000000 metrics={'f1_val': 0.9394488383910659, 'auprc': 0.9834098882724219, 'loss_val': 0.34483674751977506, 'psi': 0.9570332583436083}-{'f1_val': 0.9925772784750173, 'auprc': 0.9926540719483803, 'loss_val': 0.040517083404669224, 'psi': 0.9926079958643625}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=68 head_norm_before_train=1.864859 cos_to_last_merge=0.9999 (last merge round=64)
[S17] round=68 local utility u=0.894766 metrics={'f1_val': 0.8221912454421598, 'auprc': 0.9015283541979516, 'loss_val': 0.6619788605428184, 'psi': 0.8539260889444766}-{'f1_val': 0.6408881355548818, 'auprc': 0.8309753843280321, 'loss_val': 1.152033543777006, 'psi': 0.7169230350641419}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S17] → sending delta(kind=head bytes=1804) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:54517
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S10] → sending delta(kind=head bytes=1802) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[S10] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1804 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1802) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1804) from S17
[S8] cosine check vs S17: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=68 metric=0.7203 head_norm=1.722979
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.244790e-03
[S13] stored merged vector for next round verification (round=68)
[S13] DEBUG after merge:  round=68 metric=0.7203 head_norm=1.728799 delta_norm=0.009245
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=68 metric=0.9932 head_norm=1.877524
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.464324e-02
[S8] stored merged vector for next round verification (round=68)
[S8] DEBUG after merge:  round=68 metric=0.9928 head_norm=1.874952 delta_norm=0.014643
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=68 metric=0.8222 head_norm=1.872491
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.464324e-02
[S17] stored merged vector for next round verification (round=68)
[S17] DEBUG after merge:  round=68 metric=0.8222 head_norm=1.874952 delta_norm=0.014643
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=68 metric=0.9952 head_norm=1.734648
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.244789e-03
[S10] stored merged vector for next round verification (round=68)
[S10] DEBUG after merge:  round=68 metric=0.9952 head_norm=1.728799 delta_norm=0.009245
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=69 head_norm_before_train=1.984822 cos_to_last_merge=1.0000 (last merge round=66)
[S2] round=69 local utility u=0.226061 metrics={'f1_val': 0.7161711058555523, 'auprc': 0.9772338227898423, 'loss_val': 0.4775164903051067, 'psi': 0.8205961926292683}-{'f1_val': 0.7167945230597719, 'auprc': 0.8644521757122833, 'loss_val': 0.5950346444842278, 'psi': 0.7758575841207764}
[S3] START round=69 head_norm_before_train=2.094664 cos_to_last_merge=0.8948 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.895
[S3] round=69 local utility u=0.000000 metrics={'f1_val': 0.7462546378523283, 'auprc': 0.9847679387448764, 'loss_val': 0.6135214483212977, 'psi': 0.8416599582093476}-{'f1_val': 0.9605438728991138, 'auprc': 0.9917917039330377, 'loss_val': 0.1764780679666013, 'psi': 0.9730430053126833}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=69 head_norm_before_train=1.875511 cos_to_last_merge=0.7861 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.786
[S4] round=69 local utility u=0.000000 metrics={'f1_val': 0.9383938010087178, 'auprc': 0.9579485492041894, 'loss_val': 0.28910799190248226, 'psi': 0.9462157002869065}-{'f1_val': 0.9521329864740512, 'auprc': 0.9709840288964008, 'loss_val': 0.295353848059646, 'psi': 0.959673403442991}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=69 head_norm_before_train=2.161668 (no previous merge yet)
[S5] round=69 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9953493008816516, 'loss_val': 0.026554398247545092, 'psi': 0.9958513343382472}-{'f1_val': 0.996186023309311, 'auprc': 0.9964990050467214, 'loss_val': 0.026560018735195628, 'psi': 0.9963112160042752}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=69 head_norm_before_train=1.834549 cos_to_last_merge=0.8898 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.890
[S6] round=69 local utility u=0.000000 metrics={'f1_val': 0.7282171770318463, 'auprc': 0.957784808246259, 'loss_val': 0.4866882802753039, 'psi': 0.8200442295176114}-{'f1_val': 0.7950603009685575, 'auprc': 0.9598624288815998, 'loss_val': 0.4294965242190144, 'psi': 0.8609811521337745}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=69 head_norm_before_train=1.888887 cos_to_last_merge=0.9811 (last merge round=17)
[S7] round=69 local utility u=0.000000 metrics={'f1_val': 0.4423999252707065, 'auprc': 0.7765931214120411, 'loss_val': 1.1262099271584856, 'psi': 0.5760772037272404}-{'f1_val': 0.45229059836610547, 'auprc': 0.7810188460208438, 'loss_val': 1.005860828233509, 'psi': 0.5837818974280009}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=69 head_norm_before_train=1.874952 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=69 local utility u=0.000000 metrics={'f1_val': 0.9831512712398986, 'auprc': 0.9885578313549792, 'loss_val': 0.06592738097762736, 'psi': 0.9853138952859308}-{'f1_val': 0.9931893602624928, 'auprc': 0.9994337059120779, 'loss_val': 0.029964527793679873, 'psi': 0.995687098522327}
[S9] START round=69 head_norm_before_train=2.059787 cos_to_last_merge=0.9683 (last merge round=13)
[S9] round=69 local utility u=0.000000 metrics={'f1_val': 0.9876029063437939, 'auprc': 0.9995915923980108, 'loss_val': 0.04539693942231989, 'psi': 0.9923983807654807}-{'f1_val': 0.9962710290637395, 'auprc': 0.9997149678371999, 'loss_val': 0.017274840611701134, 'psi': 0.9976486045731237}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=69 head_norm_before_train=1.728799 cos_to_last_merge=1.0000 (last merge round=68)
[S10] round=69 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959021356585736, 'loss_val': 0.027271284951162322, 'psi': 0.9954735576750542}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958395185773103, 'loss_val': 0.026983905804134102, 'psi': 0.995448510842549}
[S11] START round=69 head_norm_before_train=1.988513 cos_to_last_merge=1.0000 (last merge round=66)
[S11] round=69 local utility u=0.186715 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9944403464276315, 'loss_val': 0.022349271825570297, 'psi': 0.9954563435190382}-{'f1_val': 0.9537537227980604, 'auprc': 0.9937176344224838, 'loss_val': 0.13933226402108886, 'psi': 0.9697392874478297}
[S13] START round=69 head_norm_before_train=1.728799 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=69 local utility u=0.232214 metrics={'f1_val': 0.7690357061246412, 'auprc': 0.8665399378372927, 'loss_val': 0.7382194716958173, 'psi': 0.8080373988097018}-{'f1_val': 0.720291610437086, 'auprc': 0.8573139684283662, 'loss_val': 0.8825047608003067, 'psi': 0.7751005536335981}
[S14] START round=69 head_norm_before_train=1.888620 cos_to_last_merge=0.8386 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.839
[S14] round=69 local utility u=0.088196 metrics={'f1_val': 0.9857090590549005, 'auprc': 0.9991902346246818, 'loss_val': 0.05350014349035254, 'psi': 0.9911015292828129}-{'f1_val': 0.9600826619159233, 'auprc': 0.9973814350773644, 'loss_val': 0.07070827778924538, 'psi': 0.9750021711804997}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=69 head_norm_before_train=1.929984 cos_to_last_merge=0.9280 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.928
[S15] round=69 local utility u=0.000000 metrics={'f1_val': 0.757367006924735, 'auprc': 0.9128176991404108, 'loss_val': 0.5505132706014646, 'psi': 0.8195472838110053}-{'f1_val': 0.7708704862661642, 'auprc': 0.9134949876103983, 'loss_val': 0.5248260001897224, 'psi': 0.8279202868038578}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=69 head_norm_before_train=2.114047 (no previous merge yet)
[S16] round=69 local utility u=0.000000 metrics={'f1_val': 0.8726741401152123, 'auprc': 0.8919840556257518, 'loss_val': 0.8853595006647421, 'psi': 0.880398106319428}-{'f1_val': 0.9394488383910659, 'auprc': 0.9834098882724219, 'loss_val': 0.34483674751977506, 'psi': 0.9570332583436083}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=69 head_norm_before_train=1.874952 cos_to_last_merge=1.0000 (last merge round=68)
[S17] round=69 local utility u=0.000000 metrics={'f1_val': 0.6736022243822496, 'auprc': 0.8424713688694325, 'loss_val': 1.068542034655443, 'psi': 0.7411498821771227}-{'f1_val': 0.8221912454421598, 'auprc': 0.9015283541979516, 'loss_val': 0.6619788605428184, 'psi': 0.8539260889444766}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1796 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=0.9999
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=69 metric=0.7162 head_norm=1.989194
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.577225e-02
[S2] stored merged vector for next round verification (round=69)
[S2] DEBUG after merge:  round=69 metric=0.7162 head_norm=1.992331 delta_norm=0.015772
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=69 metric=0.9961 head_norm=1.995587
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.577225e-02
[S11] stored merged vector for next round verification (round=69)
[S11] DEBUG after merge:  round=69 metric=0.9961 head_norm=1.992331 delta_norm=0.015772
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=70 head_norm_before_train=1.992331 cos_to_last_merge=1.0000 (last merge round=69)
[S2] round=70 local utility u=0.000000 metrics={'f1_val': 0.7089525941381195, 'auprc': 0.9659398041005429, 'loss_val': 0.47189214942675334, 'psi': 0.8117474781230889}-{'f1_val': 0.7161711058555523, 'auprc': 0.9772338227898423, 'loss_val': 0.4775164903051067, 'psi': 0.8205961926292683}
[S3] START round=70 head_norm_before_train=2.102224 cos_to_last_merge=0.8941 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=70 local utility u=0.457663 metrics={'f1_val': 0.878239440736319, 'auprc': 0.9418912345309537, 'loss_val': 0.3614750495306078, 'psi': 0.9037001582541729}-{'f1_val': 0.7462546378523283, 'auprc': 0.9847679387448764, 'loss_val': 0.6135214483212977, 'psi': 0.8416599582093476}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=70 head_norm_before_train=1.879284 cos_to_last_merge=0.7859 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.786
[S4] round=70 local utility u=0.025858 metrics={'f1_val': 0.9458688333611871, 'auprc': 0.9608625270464807, 'loss_val': 0.29098400776311767, 'psi': 0.9518663108353045}-{'f1_val': 0.9383938010087178, 'auprc': 0.9579485492041894, 'loss_val': 0.28910799190248226, 'psi': 0.9462157002869065}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S4] sending update (kind=head size=1797 to 1 peers)
[S5] START round=70 head_norm_before_train=2.173366 (no previous merge yet)
[S5] round=70 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9902885419169636, 'loss_val': 0.027670179258804245, 'psi': 0.993827030752372}-{'f1_val': 0.996186023309311, 'auprc': 0.9953493008816516, 'loss_val': 0.026554398247545092, 'psi': 0.9958513343382472}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=70 head_norm_before_train=1.841481 cos_to_last_merge=0.8891 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.889
[S6] round=70 local utility u=0.348659 metrics={'f1_val': 0.8201413346482621, 'auprc': 0.9664046370189319, 'loss_val': 0.36677565609928553, 'psi': 0.87864665559653}-{'f1_val': 0.7282171770318463, 'auprc': 0.957784808246259, 'loss_val': 0.4866882802753039, 'psi': 0.8200442295176114}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=70 head_norm_before_train=1.892483 cos_to_last_merge=0.9805 (last merge round=17)
[S7] round=70 local utility u=0.814018 metrics={'f1_val': 0.6143948189939261, 'auprc': 0.7920267809339061, 'loss_val': 0.5764443955977421, 'psi': 0.6854476037699181}-{'f1_val': 0.4423999252707065, 'auprc': 0.7765931214120411, 'loss_val': 1.1262099271584856, 'psi': 0.5760772037272404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=70 head_norm_before_train=1.880679 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=70 local utility u=0.000000 metrics={'f1_val': 0.8119197680471844, 'auprc': 0.9992142090042255, 'loss_val': 0.3562766774412946, 'psi': 0.8868375444300007}-{'f1_val': 0.9831512712398986, 'auprc': 0.9885578313549792, 'loss_val': 0.06592738097762736, 'psi': 0.9853138952859308}
[S9] START round=70 head_norm_before_train=2.068481 cos_to_last_merge=0.9683 (last merge round=13)
[S9] round=70 local utility u=0.026623 metrics={'f1_val': 0.9929348022347503, 'auprc': 0.9996683197245473, 'loss_val': 0.02437258619979699, 'psi': 0.9956282092306691}-{'f1_val': 0.9876029063437939, 'auprc': 0.9995915923980108, 'loss_val': 0.04539693942231989, 'psi': 0.9923983807654807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=70 head_norm_before_train=1.736381 cos_to_last_merge=1.0000 (last merge round=68)
[S10] round=70 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957888300908181, 'loss_val': 0.027583469401750563, 'psi': 0.995428235447952}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959021356585736, 'loss_val': 0.027271284951162322, 'psi': 0.9954735576750542}
[S11] START round=70 head_norm_before_train=1.992331 cos_to_last_merge=1.0000 (last merge round=69)
[S11] round=70 local utility u=0.001503 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9952774055545419, 'loss_val': 0.021855393615482752, 'psi': 0.9957911671698023}-{'f1_val': 0.9961336749133093, 'auprc': 0.9944403464276315, 'loss_val': 0.022349271825570297, 'psi': 0.9954563435190382}
[S13] START round=70 head_norm_before_train=1.731490 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=70 local utility u=0.000000 metrics={'f1_val': 0.713271222544338, 'auprc': 0.8820584204912908, 'loss_val': 0.9769933919260058, 'psi': 0.780786101723119}-{'f1_val': 0.7690357061246412, 'auprc': 0.8665399378372927, 'loss_val': 0.7382194716958173, 'psi': 0.8080373988097018}
[S14] START round=70 head_norm_before_train=1.892528 cos_to_last_merge=0.8383 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.838
[S14] round=70 local utility u=0.000000 metrics={'f1_val': 0.9842310689758097, 'auprc': 0.9991895081033993, 'loss_val': 0.060720338431912685, 'psi': 0.9902144446268456}-{'f1_val': 0.9857090590549005, 'auprc': 0.9991902346246818, 'loss_val': 0.05350014349035254, 'psi': 0.9911015292828129}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=70 head_norm_before_train=1.936028 cos_to_last_merge=0.9275 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=70 local utility u=1.000000 metrics={'f1_val': 0.9965259456095847, 'auprc': 0.9970377368980329, 'loss_val': 0.025642198771739993, 'psi': 0.996730662124964}-{'f1_val': 0.757367006924735, 'auprc': 0.9128176991404108, 'loss_val': 0.5505132706014646, 'psi': 0.8195472838110053}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S15] sending update (kind=head size=1796 to 1 peers)
[S16] START round=70 head_norm_before_train=2.118341 (no previous merge yet)
[S16] round=70 local utility u=0.936492 metrics={'f1_val': 0.9937214960317038, 'auprc': 0.99002931454159, 'loss_val': 0.03279557823899958, 'psi': 0.9922446234356582}-{'f1_val': 0.8726741401152123, 'auprc': 0.8919840556257518, 'loss_val': 0.8853595006647421, 'psi': 0.880398106319428}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S16] sending update (kind=head size=1797 to 1 peers)
[S17] START round=70 head_norm_before_train=1.881438 cos_to_last_merge=1.0000 (last merge round=68)
[S17] round=70 local utility u=0.000000 metrics={'f1_val': 0.641648283261379, 'auprc': 0.8324784040388468, 'loss_val': 1.201656202303935, 'psi': 0.7179803315723661}-{'f1_val': 0.6736022243822496, 'auprc': 0.8424713688694325, 'loss_val': 1.068542034655443, 'psi': 0.7411498821771227}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S11] → sending delta(kind=head bytes=1802) to S2@127.0.0.1:54502
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1802 to 1 peers)
[S8] ⇄ pheromone p=0.011 → S17@127.0.0.1:54517
[S17] ⇄ pheromone p=0.222 → S8@127.0.0.1:54509
[S13] ⇄ pheromone p=0.168 → S10@127.0.0.1:54511
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=70 metric=0.9952 head_norm=1.743603
[S10] _apply_head_vector_avg (torch): Δ‖w‖=9.723738e-03
[S10] stored merged vector for next round verification (round=70)
[S10] DEBUG after merge:  round=70 metric=0.9952 head_norm=1.737530 delta_norm=0.009724
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S2] RECEIVED delta(kind=head bytes=1802) from S11
[S2] cosine check vs S11: cos=1.0000
[S11] ⇄ pheromone p=0.094 → S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=70 metric=0.7090 head_norm=1.997913
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.774425e-03
[S2] stored merged vector for next round verification (round=70)
[S2] DEBUG after merge:  round=70 metric=0.7090 head_norm=1.999149 delta_norm=0.004774
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.092 → S11@127.0.0.1:54512
[S2] START round=71 head_norm_before_train=1.999149 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=71 local utility u=0.000000 metrics={'f1_val': 0.7081908723534803, 'auprc': 0.8960961720897334, 'loss_val': 0.4766155420735943, 'psi': 0.7833529922479816}-{'f1_val': 0.7089525941381195, 'auprc': 0.9659398041005429, 'loss_val': 0.47189214942675334, 'psi': 0.8117474781230889}
[S3] START round=71 head_norm_before_train=2.108691 cos_to_last_merge=0.8938 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.894
[S3] round=71 local utility u=0.000000 metrics={'f1_val': 0.7530083453007457, 'auprc': 0.9906938682601832, 'loss_val': 0.5912167566768298, 'psi': 0.8480825544845207}-{'f1_val': 0.878239440736319, 'auprc': 0.9418912345309537, 'loss_val': 0.3614750495306078, 'psi': 0.9037001582541729}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=71 head_norm_before_train=1.883135 cos_to_last_merge=0.7855 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.786
[S4] round=71 local utility u=0.009203 metrics={'f1_val': 0.950536092329976, 'auprc': 0.9641548276887206, 'loss_val': 0.3104584818651885, 'psi': 0.9559835864734739}-{'f1_val': 0.9458688333611871, 'auprc': 0.9608625270464807, 'loss_val': 0.29098400776311767, 'psi': 0.9518663108353045}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=71 head_norm_before_train=2.171875 (no previous merge yet)
[S5] round=71 local utility u=0.005803 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9943444951696587, 'loss_val': 0.02823184325587876, 'psi': 0.9954494120534501}-{'f1_val': 0.996186023309311, 'auprc': 0.9902885419169636, 'loss_val': 0.027670179258804245, 'psi': 0.993827030752372}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1790 reason=None
[S5] sending update (kind=head size=1790 to 1 peers)
[S6] START round=71 head_norm_before_train=1.849799 cos_to_last_merge=0.8881 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=71 local utility u=0.000000 metrics={'f1_val': 0.49797459903252117, 'auprc': 0.8279292301857868, 'loss_val': 0.8837822335826114, 'psi': 0.6299564514938274}-{'f1_val': 0.8201413346482621, 'auprc': 0.9664046370189319, 'loss_val': 0.36677565609928553, 'psi': 0.87864665559653}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=71 head_norm_before_train=1.896771 cos_to_last_merge=0.9798 (last merge round=17)
[S7] round=71 local utility u=0.000000 metrics={'f1_val': 0.5722112118579279, 'auprc': 0.7828528618340828, 'loss_val': 0.622868030166412, 'psi': 0.6564678718483898}-{'f1_val': 0.6143948189939261, 'auprc': 0.7920267809339061, 'loss_val': 0.5764443955977421, 'psi': 0.6854476037699181}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=71 head_norm_before_train=1.886884 cos_to_last_merge=1.0000 (last merge round=68)
[S8] round=71 local utility u=0.699900 metrics={'f1_val': 0.9910860494090681, 'auprc': 0.9995314905695374, 'loss_val': 0.032425719003140605, 'psi': 0.9944642258732558}-{'f1_val': 0.8119197680471844, 'auprc': 0.9992142090042255, 'loss_val': 0.3562766774412946, 'psi': 0.8868375444300007}
[S9] START round=71 head_norm_before_train=2.078188 cos_to_last_merge=0.9683 (last merge round=13)
[S9] round=71 local utility u=0.015430 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997121317668833, 'loss_val': 0.015998343116039954, 'psi': 0.9978811597950882}-{'f1_val': 0.9929348022347503, 'auprc': 0.9996683197245473, 'loss_val': 0.02437258619979699, 'psi': 0.9956282092306691}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=71 head_norm_before_train=1.737530 cos_to_last_merge=1.0000 (last merge round=70)
[S10] round=71 local utility u=0.000421 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958954577869337, 'loss_val': 0.02706087517489443, 'psi': 0.9954708865263984}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957888300908181, 'loss_val': 0.027583469401750563, 'psi': 0.995428235447952}
[S11] START round=71 head_norm_before_train=2.000397 cos_to_last_merge=1.0000 (last merge round=69)
[S11] round=71 local utility u=0.000000 metrics={'f1_val': 0.9865951698327342, 'auprc': 0.9945727948509282, 'loss_val': 0.0507550556033496, 'psi': 0.9897862198400118}-{'f1_val': 0.9961336749133093, 'auprc': 0.9952774055545419, 'loss_val': 0.021855393615482752, 'psi': 0.9957911671698023}
[S13] START round=71 head_norm_before_train=1.735589 cos_to_last_merge=1.0000 (last merge round=68)
[S13] round=71 local utility u=0.435056 metrics={'f1_val': 0.7949713794528452, 'auprc': 0.8830328297319088, 'loss_val': 0.6000057363949056, 'psi': 0.8301959595644707}-{'f1_val': 0.713271222544338, 'auprc': 0.8820584204912908, 'loss_val': 0.9769933919260058, 'psi': 0.780786101723119}
[S14] START round=71 head_norm_before_train=1.898632 cos_to_last_merge=0.8380 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.838
[S14] round=71 local utility u=0.052636 metrics={'f1_val': 0.9974055297193176, 'auprc': 0.9974926812351246, 'loss_val': 0.029404321972432475, 'psi': 0.9974403903256404}-{'f1_val': 0.9842310689758097, 'auprc': 0.9991895081033993, 'loss_val': 0.060720338431912685, 'psi': 0.9902144446268456}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=71 head_norm_before_train=1.942374 cos_to_last_merge=0.9270 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.927
[S15] round=71 local utility u=0.000000 metrics={'f1_val': 0.8116304230899135, 'auprc': 0.9655788132899019, 'loss_val': 0.41825109562578483, 'psi': 0.8732097791699089}-{'f1_val': 0.9965259456095847, 'auprc': 0.9970377368980329, 'loss_val': 0.025642198771739993, 'psi': 0.996730662124964}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=71 head_norm_before_train=2.123716 (no previous merge yet)
[S16] round=71 local utility u=0.000000 metrics={'f1_val': 0.8042784440118236, 'auprc': 0.986174202053091, 'loss_val': 0.8838772617205393, 'psi': 0.8770367472283306}-{'f1_val': 0.9937214960317038, 'auprc': 0.99002931454159, 'loss_val': 0.03279557823899958, 'psi': 0.9922446234356582}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=71 head_norm_before_train=1.888152 cos_to_last_merge=1.0000 (last merge round=68)
[S17] round=71 local utility u=0.213801 metrics={'f1_val': 0.666927967034245, 'auprc': 0.8785180662027365, 'loss_val': 1.0638512674534701, 'psi': 0.7515640067016416}-{'f1_val': 0.641648283261379, 'auprc': 0.8324784040388468, 'loss_val': 1.201656202303935, 'psi': 0.7179803315723661}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1802 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=71 metric=0.7950 head_norm=1.739690
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.110700e-02
[S13] stored merged vector for next round verification (round=71)
[S13] DEBUG after merge:  round=71 metric=0.7946 head_norm=1.742575 delta_norm=0.011107
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=71 metric=0.9952 head_norm=1.745526
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.110702e-02
[S10] stored merged vector for next round verification (round=71)
[S10] DEBUG after merge:  round=71 metric=0.9952 head_norm=1.742575 delta_norm=0.011107
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=71 metric=0.9911 head_norm=1.891012
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.388399e-02
[S8] stored merged vector for next round verification (round=71)
[S8] DEBUG after merge:  round=71 metric=0.9911 head_norm=1.893011 delta_norm=0.013884
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=71 metric=0.6669 head_norm=1.895110
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.388399e-02
[S17] stored merged vector for next round verification (round=71)
[S17] DEBUG after merge:  round=71 metric=0.6656 head_norm=1.893011 delta_norm=0.013884
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=72 head_norm_before_train=2.004350 cos_to_last_merge=1.0000 (last merge round=70)
[S2] round=72 local utility u=0.028169 metrics={'f1_val': 0.7538653732603287, 'auprc': 0.8335455568930762, 'loss_val': 0.5066732352044071, 'psi': 0.7857374467134277}-{'f1_val': 0.7081908723534803, 'auprc': 0.8960961720897334, 'loss_val': 0.4766155420735943, 'psi': 0.7833529922479816}
[S3] START round=72 head_norm_before_train=2.115354 cos_to_last_merge=0.8933 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.893
[S3] round=72 local utility u=0.000000 metrics={'f1_val': 0.6693810575140808, 'auprc': 0.8816472599626548, 'loss_val': 1.033728007835729, 'psi': 0.7542875384935104}-{'f1_val': 0.7530083453007457, 'auprc': 0.9906938682601832, 'loss_val': 0.5912167566768298, 'psi': 0.8480825544845207}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=72 head_norm_before_train=1.886683 cos_to_last_merge=0.7855 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.786
[S4] round=72 local utility u=0.000000 metrics={'f1_val': 0.9508705466826088, 'auprc': 0.9535689006645056, 'loss_val': 0.3154362932375293, 'psi': 0.9519498882753675}-{'f1_val': 0.950536092329976, 'auprc': 0.9641548276887206, 'loss_val': 0.3104584818651885, 'psi': 0.9559835864734739}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=72 head_norm_before_train=2.174577 (no previous merge yet)
[S5] round=72 local utility u=0.002727 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9957403981836797, 'loss_val': 0.02696477219703201, 'psi': 0.9960077732590584}-{'f1_val': 0.996186023309311, 'auprc': 0.9943444951696587, 'loss_val': 0.02823184325587876, 'psi': 0.9954494120534501}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=72 head_norm_before_train=1.857146 cos_to_last_merge=0.8875 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.888
[S6] round=72 local utility u=1.000000 metrics={'f1_val': 0.8498136779902956, 'auprc': 0.9738491670771872, 'loss_val': 0.3166624141293187, 'psi': 0.8994278736250523}-{'f1_val': 0.49797459903252117, 'auprc': 0.8279292301857868, 'loss_val': 0.8837822335826114, 'psi': 0.6299564514938274}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=72 head_norm_before_train=1.900277 cos_to_last_merge=0.9792 (last merge round=17)
[S7] round=72 local utility u=0.401119 metrics={'f1_val': 0.6566626212754536, 'auprc': 0.809228186648899, 'loss_val': 0.40646479744908387, 'psi': 0.7176888474248317}-{'f1_val': 0.5722112118579279, 'auprc': 0.7828528618340828, 'loss_val': 0.622868030166412, 'psi': 0.6564678718483898}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=72 head_norm_before_train=1.893011 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=72 local utility u=0.000000 metrics={'f1_val': 0.9912267239616498, 'auprc': 0.9995229087683843, 'loss_val': 0.03783337712416996, 'psi': 0.9945451978843436}-{'f1_val': 0.9910860494090681, 'auprc': 0.9995314905695374, 'loss_val': 0.032425719003140605, 'psi': 0.9944642258732558}
[S9] START round=72 head_norm_before_train=2.085345 cos_to_last_merge=0.9681 (last merge round=13)
[S9] round=72 local utility u=0.000000 metrics={'f1_val': 0.9945775144926113, 'auprc': 0.9993584842984046, 'loss_val': 0.01916450451826516, 'psi': 0.9964899024149286}-{'f1_val': 0.9966605118138915, 'auprc': 0.9997121317668833, 'loss_val': 0.015998343116039954, 'psi': 0.9978811597950882}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=72 head_norm_before_train=1.742575 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=72 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958171816856924, 'loss_val': 0.02715438145290982, 'psi': 0.9954395760859018}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958954577869337, 'loss_val': 0.02706087517489443, 'psi': 0.9954708865263984}
[S11] START round=72 head_norm_before_train=2.008626 cos_to_last_merge=1.0000 (last merge round=69)
[S11] round=72 local utility u=0.044880 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9955860676232805, 'loss_val': 0.021265174740636897, 'psi': 0.9959146319972978}-{'f1_val': 0.9865951698327342, 'auprc': 0.9945727948509282, 'loss_val': 0.0507550556033496, 'psi': 0.9897862198400118}
[S13] START round=72 head_norm_before_train=1.742575 cos_to_last_merge=1.0000 (last merge round=71)
[S13] round=72 local utility u=0.000000 metrics={'f1_val': 0.7592753318796733, 'auprc': 0.8790712524407231, 'loss_val': 0.8313885481750813, 'psi': 0.8071937001040932}-{'f1_val': 0.7949713794528452, 'auprc': 0.8830328297319088, 'loss_val': 0.6000057363949056, 'psi': 0.8301959595644707}
[S14] START round=72 head_norm_before_train=1.906360 cos_to_last_merge=0.8376 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.838
[S14] round=72 local utility u=0.007214 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991667249965487, 'loss_val': 0.02003029134398171, 'psi': 0.9981132865593163}-{'f1_val': 0.9974055297193176, 'auprc': 0.9974926812351246, 'loss_val': 0.029404321972432475, 'psi': 0.9974403903256404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S14] sending update (kind=head size=1802 to 1 peers)
[S15] START round=72 head_norm_before_train=1.949150 cos_to_last_merge=0.9264 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=72 local utility u=0.079559 metrics={'f1_val': 0.8140460282599324, 'auprc': 0.9896839319886837, 'loss_val': 0.3459428251092444, 'psi': 0.8843011897514329}-{'f1_val': 0.8116304230899135, 'auprc': 0.9655788132899019, 'loss_val': 0.41825109562578483, 'psi': 0.8732097791699089}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=72 head_norm_before_train=2.127972 (no previous merge yet)
[S16] round=72 local utility u=0.464955 metrics={'f1_val': 0.9009360283908812, 'auprc': 0.9802322249334636, 'loss_val': 0.5160870313949268, 'psi': 0.9326545070079142}-{'f1_val': 0.8042784440118236, 'auprc': 0.986174202053091, 'loss_val': 0.8838772617205393, 'psi': 0.8770367472283306}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=72 head_norm_before_train=1.893011 cos_to_last_merge=1.0000 (last merge round=71)
[S17] round=72 local utility u=0.684390 metrics={'f1_val': 0.7747557022199116, 'auprc': 0.9214931809673965, 'loss_val': 0.4709632210637371, 'psi': 0.8334506937189056}-{'f1_val': 0.666927967034245, 'auprc': 0.8785180662027365, 'loss_val': 1.0638512674534701, 'psi': 0.7515640067016416}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S2] → sending delta(kind=head bytes=1796) to S11@127.0.0.1:54512
[S11] sending update (kind=head size=1798 to 1 peers)
[S2] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1796) from S2
[S11] cosine check vs S2: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9998
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=72 metric=0.7539 head_norm=2.010185
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.223757e-02
[S2] stored merged vector for next round verification (round=72)
[S2] DEBUG after merge:  round=72 metric=0.7537 head_norm=2.013448 delta_norm=0.012238
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=72 metric=0.9961 head_norm=2.016781
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.223756e-02
[S11] stored merged vector for next round verification (round=72)
[S11] DEBUG after merge:  round=72 metric=0.9961 head_norm=2.013448 delta_norm=0.012238
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=73 head_norm_before_train=2.013448 cos_to_last_merge=1.0000 (last merge round=72)
[S2] round=73 local utility u=0.079763 metrics={'f1_val': 0.7098522540976431, 'auprc': 0.9609384594621342, 'loss_val': 0.46524642525406407, 'psi': 0.8102867362434396}-{'f1_val': 0.7538653732603287, 'auprc': 0.8335455568930762, 'loss_val': 0.5066732352044071, 'psi': 0.7857374467134277}
[S3] START round=73 head_norm_before_train=2.121231 cos_to_last_merge=0.8930 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.893
[S3] round=73 local utility u=0.478097 metrics={'f1_val': 0.7364217414009456, 'auprc': 0.9961416742577348, 'loss_val': 0.8232610562855115, 'psi': 0.8403097145436613}-{'f1_val': 0.6693810575140808, 'auprc': 0.8816472599626548, 'loss_val': 1.033728007835729, 'psi': 0.7542875384935104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=73 head_norm_before_train=1.893006 cos_to_last_merge=0.7853 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.785
[S4] round=73 local utility u=0.041496 metrics={'f1_val': 0.9512775849174274, 'auprc': 0.9735694716177461, 'loss_val': 0.2948876621863161, 'psi': 0.960194339597555}-{'f1_val': 0.9508705466826088, 'auprc': 0.9535689006645056, 'loss_val': 0.3154362932375293, 'psi': 0.9519498882753675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=73 head_norm_before_train=2.183891 (no previous merge yet)
[S5] round=73 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.994947714422043, 'loss_val': 0.028785212035058193, 'psi': 0.9956906997544038}-{'f1_val': 0.996186023309311, 'auprc': 0.9957403981836797, 'loss_val': 0.02696477219703201, 'psi': 0.9960077732590584}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=73 head_norm_before_train=1.860667 cos_to_last_merge=0.8872 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=73 local utility u=0.000000 metrics={'f1_val': 0.8058863957692373, 'auprc': 0.9545272132584828, 'loss_val': 0.41900017189252753, 'psi': 0.8653427227649355}-{'f1_val': 0.8498136779902956, 'auprc': 0.9738491670771872, 'loss_val': 0.3166624141293187, 'psi': 0.8994278736250523}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=73 head_norm_before_train=1.905761 cos_to_last_merge=0.9788 (last merge round=17)
[S7] round=73 local utility u=0.000000 metrics={'f1_val': 0.45399343126424585, 'auprc': 0.7000547369367802, 'loss_val': 1.3396404366666566, 'psi': 0.5524179535332596}-{'f1_val': 0.6566626212754536, 'auprc': 0.809228186648899, 'loss_val': 0.40646479744908387, 'psi': 0.7176888474248317}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=73 head_norm_before_train=1.894130 cos_to_last_merge=1.0000 (last merge round=71)
[S8] round=73 local utility u=0.000000 metrics={'f1_val': 0.9914482382097267, 'auprc': 0.9995401004621747, 'loss_val': 0.039335437746858784, 'psi': 0.9946849831107059}-{'f1_val': 0.9912267239616498, 'auprc': 0.9995229087683843, 'loss_val': 0.03783337712416996, 'psi': 0.9945451978843436}
[S9] START round=73 head_norm_before_train=2.088350 cos_to_last_merge=0.9673 (last merge round=13)
[S9] round=73 local utility u=0.007420 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9994667649067539, 'loss_val': 0.01712611784333349, 'psi': 0.9977809131423483}-{'f1_val': 0.9945775144926113, 'auprc': 0.9993584842984046, 'loss_val': 0.01916450451826516, 'psi': 0.9964899024149286}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=73 head_norm_before_train=1.750986 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=73 local utility u=0.000106 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958024992300508, 'loss_val': 0.026897968446049293, 'psi': 0.9954337031036451}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958171816856924, 'loss_val': 0.02715438145290982, 'psi': 0.9954395760859018}
[S11] START round=73 head_norm_before_train=2.013448 cos_to_last_merge=1.0000 (last merge round=72)
[S11] round=73 local utility u=0.000207 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9948506112703661, 'loss_val': 0.020095760415386778, 'psi': 0.9957654766535969}-{'f1_val': 0.9961336749133093, 'auprc': 0.9955860676232805, 'loss_val': 0.021265174740636897, 'psi': 0.9959146319972978}
[S13] START round=73 head_norm_before_train=1.746341 cos_to_last_merge=1.0000 (last merge round=71)
[S13] round=73 local utility u=0.000000 metrics={'f1_val': 0.6789165549495715, 'auprc': 0.9255420693537669, 'loss_val': 1.083915486892089, 'psi': 0.7775667607112496}-{'f1_val': 0.7592753318796733, 'auprc': 0.8790712524407231, 'loss_val': 0.8313885481750813, 'psi': 0.8071937001040932}
[S14] START round=73 head_norm_before_train=1.913669 cos_to_last_merge=0.8371 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.837
[S14] round=73 local utility u=0.000000 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9974295227100616, 'loss_val': 0.0211471034604702, 'psi': 0.9974184056447215}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991667249965487, 'loss_val': 0.02003029134398171, 'psi': 0.9981132865593163}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=73 head_norm_before_train=1.956172 cos_to_last_merge=0.9258 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.926
[S15] round=73 local utility u=0.704465 metrics={'f1_val': 0.9940339302683492, 'auprc': 0.996924510352709, 'loss_val': 0.038662902808344835, 'psi': 0.9951901623020931}-{'f1_val': 0.8140460282599324, 'auprc': 0.9896839319886837, 'loss_val': 0.3459428251092444, 'psi': 0.8843011897514329}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=73 head_norm_before_train=2.132125 (no previous merge yet)
[S16] round=73 local utility u=0.000000 metrics={'f1_val': 0.8350763759425895, 'auprc': 0.8417854808476635, 'loss_val': 1.378718548966457, 'psi': 0.8377600179046191}-{'f1_val': 0.9009360283908812, 'auprc': 0.9802322249334636, 'loss_val': 0.5160870313949268, 'psi': 0.9326545070079142}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=73 head_norm_before_train=1.897932 cos_to_last_merge=0.9999 (last merge round=71)
[S17] round=73 local utility u=0.000000 metrics={'f1_val': 0.7032656941785744, 'auprc': 0.8879900347052819, 'loss_val': 0.8378519967977741, 'psi': 0.7771554303892574}-{'f1_val': 0.7747557022199116, 'auprc': 0.9214931809673965, 'loss_val': 0.4709632210637371, 'psi': 0.8334506937189056}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:54513
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1796 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=73 metric=0.9914 head_norm=1.900719
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.891433e-02
[S8] stored merged vector for next round verification (round=73)
[S8] DEBUG after merge:  round=73 metric=0.9914 head_norm=1.899232 delta_norm=0.018914
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=1.0000
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=73 metric=0.7099 head_norm=2.017559
[S2] _apply_head_vector_avg (torch): Δ‖w‖=5.296725e-03
[S2] stored merged vector for next round verification (round=73)
[S2] DEBUG after merge:  round=73 metric=0.7099 head_norm=2.018107 delta_norm=0.005297
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=73 metric=0.9964 head_norm=2.018668
[S11] _apply_head_vector_avg (torch): Δ‖w‖=5.296722e-03
[S11] stored merged vector for next round verification (round=73)
[S11] DEBUG after merge:  round=73 metric=0.9964 head_norm=2.018107 delta_norm=0.005297
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] START round=74 head_norm_before_train=2.018107 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=74 local utility u=0.081096 metrics={'f1_val': 0.7121460343797, 'auprc': 0.9926679894317317, 'loss_val': 0.41200632033588885, 'psi': 0.8243548164005128}-{'f1_val': 0.7098522540976431, 'auprc': 0.9609384594621342, 'loss_val': 0.46524642525406407, 'psi': 0.8102867362434396}
[S3] START round=74 head_norm_before_train=2.124625 cos_to_last_merge=0.8929 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.893
[S3] round=74 local utility u=0.000000 metrics={'f1_val': 0.7322193907545315, 'auprc': 0.9937417571994731, 'loss_val': 0.7933658598615447, 'psi': 0.8368283373325082}-{'f1_val': 0.7364217414009456, 'auprc': 0.9961416742577348, 'loss_val': 0.8232610562855115, 'psi': 0.8403097145436613}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=74 head_norm_before_train=1.898887 cos_to_last_merge=0.7851 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.785
[S4] round=74 local utility u=0.000000 metrics={'f1_val': 0.9502995534254177, 'auprc': 0.9646785215146314, 'loss_val': 0.3035679960813499, 'psi': 0.9560511406611032}-{'f1_val': 0.9512775849174274, 'auprc': 0.9735694716177461, 'loss_val': 0.2948876621863161, 'psi': 0.960194339597555}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=74 head_norm_before_train=2.185092 (no previous merge yet)
[S5] round=74 local utility u=0.006123 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9974218296635665, 'loss_val': 0.02572244275177301, 'psi': 0.9968564200370646}-{'f1_val': 0.996186023309311, 'auprc': 0.994947714422043, 'loss_val': 0.028785212035058193, 'psi': 0.9956906997544038}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=74 head_norm_before_train=1.865623 cos_to_last_merge=0.8869 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.887
[S6] round=74 local utility u=0.000000 metrics={'f1_val': 0.6864486273014622, 'auprc': 0.945189436443608, 'loss_val': 0.670155691143763, 'psi': 0.7899449509583205}-{'f1_val': 0.8058863957692373, 'auprc': 0.9545272132584828, 'loss_val': 0.41900017189252753, 'psi': 0.8653427227649355}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=74 head_norm_before_train=1.909789 cos_to_last_merge=0.9784 (last merge round=17)
[S7] round=74 local utility u=0.935792 metrics={'f1_val': 0.620959764430304, 'auprc': 0.790646436796981, 'loss_val': 0.74162985582804, 'psi': 0.6888344333769748}-{'f1_val': 0.45399343126424585, 'auprc': 0.7000547369367802, 'loss_val': 1.3396404366666566, 'psi': 0.5524179535332596}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S7] sending update (kind=head size=1806 to 1 peers)
[S8] START round=74 head_norm_before_train=1.899232 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=74 local utility u=0.000000 metrics={'f1_val': 0.9037923770054047, 'auprc': 0.9887578327420652, 'loss_val': 0.1269825255119245, 'psi': 0.9377785593000689}-{'f1_val': 0.9914482382097267, 'auprc': 0.9995401004621747, 'loss_val': 0.039335437746858784, 'psi': 0.9946849831107059}
[S9] START round=74 head_norm_before_train=2.095046 cos_to_last_merge=0.9670 (last merge round=13)
[S9] round=74 local utility u=0.001118 metrics={'f1_val': 0.9968210870560296, 'auprc': 0.9996287301064531, 'loss_val': 0.01636085478648912, 'psi': 0.997944144276199}-{'f1_val': 0.9966570119660778, 'auprc': 0.9994667649067539, 'loss_val': 0.01712611784333349, 'psi': 0.9977809131423483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=74 head_norm_before_train=1.759646 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=74 local utility u=0.000064 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958104902242595, 'loss_val': 0.02679414207678324, 'psi': 0.9954368995013286}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958024992300508, 'loss_val': 0.026897968446049293, 'psi': 0.9954337031036451}
[S11] START round=74 head_norm_before_train=2.018107 cos_to_last_merge=1.0000 (last merge round=73)
[S11] round=74 local utility u=0.000000 metrics={'f1_val': 0.9915970870399596, 'auprc': 0.9937123465838721, 'loss_val': 0.03629865686570613, 'psi': 0.9924431908575246}-{'f1_val': 0.9963753869090841, 'auprc': 0.9948506112703661, 'loss_val': 0.020095760415386778, 'psi': 0.9957654766535969}
[S13] START round=74 head_norm_before_train=1.750833 cos_to_last_merge=1.0000 (last merge round=71)
[S13] round=74 local utility u=0.000000 metrics={'f1_val': 0.6337208319099353, 'auprc': 0.8482908343931044, 'loss_val': 1.1215152485787452, 'psi': 0.7195488329032029}-{'f1_val': 0.6789165549495715, 'auprc': 0.9255420693537669, 'loss_val': 1.083915486892089, 'psi': 0.7775667607112496}
[S14] START round=74 head_norm_before_train=1.919925 cos_to_last_merge=0.8367 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.837
[S14] round=74 local utility u=0.003147 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991254965120101, 'loss_val': 0.01994144659479282, 'psi': 0.9980967951655009}-{'f1_val': 0.9974109942678281, 'auprc': 0.9974295227100616, 'loss_val': 0.0211471034604702, 'psi': 0.9974184056447215}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=74 head_norm_before_train=1.963235 cos_to_last_merge=0.9251 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=74 local utility u=0.000000 metrics={'f1_val': 0.9856979025760753, 'auprc': 0.9728090878169144, 'loss_val': 0.1027344637053553, 'psi': 0.9805423766724108}-{'f1_val': 0.9940339302683492, 'auprc': 0.996924510352709, 'loss_val': 0.038662902808344835, 'psi': 0.9951901623020931}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=74 head_norm_before_train=2.135722 (no previous merge yet)
[S16] round=74 local utility u=1.000000 metrics={'f1_val': 0.9471317574993712, 'auprc': 0.9833644725144337, 'loss_val': 0.16571830281642155, 'psi': 0.9616248435053962}-{'f1_val': 0.8350763759425895, 'auprc': 0.8417854808476635, 'loss_val': 1.378718548966457, 'psi': 0.8377600179046191}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S16] sending update (kind=head size=1798 to 1 peers)
[S17] START round=74 head_norm_before_train=1.903900 cos_to_last_merge=0.9996 (last merge round=71)
[S17] round=74 local utility u=0.000000 metrics={'f1_val': 0.6690519995535685, 'auprc': 0.8861934319822866, 'loss_val': 1.0063770275956232, 'psi': 0.7559085725250558}-{'f1_val': 0.7032656941785744, 'auprc': 0.8879900347052819, 'loss_val': 0.8378519967977741, 'psi': 0.7771554303892574}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:54513
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] sending update (kind=head size=1801 to 1 peers)
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=74 metric=0.6337 head_norm=1.754002
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.087806e-03
[S13] stored merged vector for next round verification (round=74)
[S13] DEBUG after merge:  round=74 metric=0.6322 head_norm=1.756803 delta_norm=0.009088
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=1.0000
[S2] START round=75 head_norm_before_train=2.022204 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=75 local utility u=0.000000 metrics={'f1_val': 0.6857454779020509, 'auprc': 0.7952484576908656, 'loss_val': 0.9308895593446909, 'psi': 0.7295466698175768}-{'f1_val': 0.7121460343797, 'auprc': 0.9926679894317317, 'loss_val': 0.41200632033588885, 'psi': 0.8243548164005128}
[S3] START round=75 head_norm_before_train=2.130668 cos_to_last_merge=0.8925 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.892
[S3] round=75 local utility u=0.000000 metrics={'f1_val': 0.7128563531778559, 'auprc': 0.9847211112729515, 'loss_val': 0.8914695835714251, 'psi': 0.8216022564158941}-{'f1_val': 0.7322193907545315, 'auprc': 0.9937417571994731, 'loss_val': 0.7933658598615447, 'psi': 0.8368283373325082}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=75 head_norm_before_train=1.905871 cos_to_last_merge=0.7848 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.785
[S4] round=75 local utility u=0.000000 metrics={'f1_val': 0.9512339380336405, 'auprc': 0.9533558353739158, 'loss_val': 0.3061112598757428, 'psi': 0.9520826969697506}-{'f1_val': 0.9502995534254177, 'auprc': 0.9646785215146314, 'loss_val': 0.3035679960813499, 'psi': 0.9560511406611032}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=75 head_norm_before_train=2.187536 (no previous merge yet)
[S5] round=75 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9975000498074085, 'loss_val': 0.027183423015377253, 'psi': 0.9968877080946015}-{'f1_val': 0.9964794802860635, 'auprc': 0.9974218296635665, 'loss_val': 0.02572244275177301, 'psi': 0.9968564200370646}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=75 head_norm_before_train=1.871447 cos_to_last_merge=0.8863 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.886
[S6] round=75 local utility u=0.000000 metrics={'f1_val': 0.6389902715427954, 'auprc': 0.9497137136717849, 'loss_val': 0.7469611105523805, 'psi': 0.7632796483943912}-{'f1_val': 0.6864486273014622, 'auprc': 0.945189436443608, 'loss_val': 0.670155691143763, 'psi': 0.7899449509583205}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=75 head_norm_before_train=1.913758 cos_to_last_merge=0.9781 (last merge round=17)
[S7] round=75 local utility u=0.238171 metrics={'f1_val': 0.65133170112937, 'auprc': 0.7945507308356138, 'loss_val': 0.45923296774724953, 'psi': 0.7086193130118675}-{'f1_val': 0.620959764430304, 'auprc': 0.790646436796981, 'loss_val': 0.74162985582804, 'psi': 0.6888344333769748}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=75 head_norm_before_train=1.906306 cos_to_last_merge=1.0000 (last merge round=73)
[S8] round=75 local utility u=0.000000 metrics={'f1_val': 0.8731914614040601, 'auprc': 0.9961481552982713, 'loss_val': 0.22654741259844047, 'psi': 0.9223741389617446}-{'f1_val': 0.9037923770054047, 'auprc': 0.9887578327420652, 'loss_val': 0.1269825255119245, 'psi': 0.9377785593000689}
[S9] START round=75 head_norm_before_train=2.103839 cos_to_last_merge=0.9670 (last merge round=13)
[S9] round=75 local utility u=0.000000 metrics={'f1_val': 0.9968525854255906, 'auprc': 0.9966060829575879, 'loss_val': 0.01700186161485215, 'psi': 0.9967539844383895}-{'f1_val': 0.9968210870560296, 'auprc': 0.9996287301064531, 'loss_val': 0.01636085478648912, 'psi': 0.997944144276199}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=75 head_norm_before_train=1.767099 cos_to_last_merge=1.0000 (last merge round=71)
[S10] round=75 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958058645558073, 'loss_val': 0.026805673786736213, 'psi': 0.9954350492339478}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958104902242595, 'loss_val': 0.02679414207678324, 'psi': 0.9954368995013286}
[S11] START round=75 head_norm_before_train=2.021367 cos_to_last_merge=1.0000 (last merge round=73)
[S11] round=75 local utility u=0.021218 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9937503635758772, 'loss_val': 0.02264557364835245, 'psi': 0.9953253775758013}-{'f1_val': 0.9915970870399596, 'auprc': 0.9937123465838721, 'loss_val': 0.03629865686570613, 'psi': 0.9924431908575246}
[S13] START round=75 head_norm_before_train=1.756803 cos_to_last_merge=1.0000 (last merge round=74)
[S13] round=75 local utility u=0.616692 metrics={'f1_val': 0.7533209407920036, 'auprc': 0.8626266696930349, 'loss_val': 0.648739403406593, 'psi': 0.7970432323524161}-{'f1_val': 0.6337208319099353, 'auprc': 0.8482908343931044, 'loss_val': 1.1215152485787452, 'psi': 0.7195488329032029}
[S14] START round=75 head_norm_before_train=1.925757 cos_to_last_merge=0.8362 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.836
[S14] round=75 local utility u=0.000000 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9988002375636797, 'loss_val': 0.02618305218536016, 'psi': 0.9982118058058029}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991254965120101, 'loss_val': 0.01994144659479282, 'psi': 0.9980967951655009}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=75 head_norm_before_train=1.968492 cos_to_last_merge=0.9247 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.925
[S15] round=75 local utility u=0.000000 metrics={'f1_val': 0.6976794896931483, 'auprc': 0.6440488229897812, 'loss_val': 0.8229515488051297, 'psi': 0.6762272230118014}-{'f1_val': 0.9856979025760753, 'auprc': 0.9728090878169144, 'loss_val': 0.1027344637053553, 'psi': 0.9805423766724108}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=75 head_norm_before_train=2.139105 (no previous merge yet)
[S16] round=75 local utility u=0.000000 metrics={'f1_val': 0.7819017178088052, 'auprc': 0.9846991473672541, 'loss_val': 0.8753563048964967, 'psi': 0.8630206896321848}-{'f1_val': 0.9471317574993712, 'auprc': 0.9833644725144337, 'loss_val': 0.16571830281642155, 'psi': 0.9616248435053962}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=75 head_norm_before_train=1.911686 cos_to_last_merge=0.9995 (last merge round=71)
[S17] round=75 local utility u=0.140726 metrics={'f1_val': 0.6936955421916269, 'auprc': 0.896969219264979, 'loss_val': 0.9051131637879125, 'psi': 0.7750050130209678}-{'f1_val': 0.6690519995535685, 'auprc': 0.8861934319822866, 'loss_val': 1.0063770275956232, 'psi': 0.7559085725250558}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] ⇄ pheromone p=0.061 → S17@127.0.0.1:54517
[S13] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S2] ⇄ pheromone p=0.056 → S11@127.0.0.1:54512
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9995
[S17] ⇄ pheromone p=0.189 → S8@127.0.0.1:54509
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=75 metric=0.7533 head_norm=1.759022
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.042298e-03
[S13] stored merged vector for next round verification (round=75)
[S13] DEBUG after merge:  round=75 metric=0.7533 head_norm=1.763047 delta_norm=0.008042
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.214 → S10@127.0.0.1:54511
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=75 metric=0.9964 head_norm=2.027244
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.720930e-03
[S11] stored merged vector for next round verification (round=75)
[S11] DEBUG after merge:  round=75 metric=0.9964 head_norm=2.024703 delta_norm=0.009721
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.040 → S2@127.0.0.1:54502
[S2] START round=76 head_norm_before_train=2.026606 cos_to_last_merge=1.0000 (last merge round=73)
[S2] round=76 local utility u=0.000000 metrics={'f1_val': 0.6481153741906671, 'auprc': 0.8092603264508681, 'loss_val': 0.9296826357056062, 'psi': 0.7125733550947475}-{'f1_val': 0.6857454779020509, 'auprc': 0.7952484576908656, 'loss_val': 0.9308895593446909, 'psi': 0.7295466698175768}
[S3] START round=76 head_norm_before_train=2.137931 cos_to_last_merge=0.8919 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.892
[S3] round=76 local utility u=0.267923 metrics={'f1_val': 0.7670154122788463, 'auprc': 0.9963920866604572, 'loss_val': 0.7155899460288208, 'psi': 0.8587660820314906}-{'f1_val': 0.7128563531778559, 'auprc': 0.9847211112729515, 'loss_val': 0.8914695835714251, 'psi': 0.8216022564158941}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S3] sending update (kind=head size=1796 to 1 peers)
[S4] START round=76 head_norm_before_train=1.913325 cos_to_last_merge=0.7840 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.784
[S4] round=76 local utility u=0.051188 metrics={'f1_val': 0.9538512165240071, 'auprc': 0.9751539975288452, 'loss_val': 0.28483304061069636, 'psi': 0.9623723289259424}-{'f1_val': 0.9512339380336405, 'auprc': 0.9533558353739158, 'loss_val': 0.3061112598757428, 'psi': 0.9520826969697506}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=76 head_norm_before_train=2.192120 (no previous merge yet)
[S5] round=76 local utility u=0.000313 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9975830300128491, 'loss_val': 0.02680687460835522, 'psi': 0.9969209001767777}-{'f1_val': 0.9964794802860635, 'auprc': 0.9975000498074085, 'loss_val': 0.027183423015377253, 'psi': 0.9968877080946015}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S5] sending update (kind=head size=1799 to 1 peers)
[S6] START round=76 head_norm_before_train=1.877450 cos_to_last_merge=0.8853 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.885
[S6] round=76 local utility u=0.516444 metrics={'f1_val': 0.7670569911870422, 'auprc': 0.9564418356086692, 'loss_val': 0.502658161327449, 'psi': 0.842810928955693}-{'f1_val': 0.6389902715427954, 'auprc': 0.9497137136717849, 'loss_val': 0.7469611105523805, 'psi': 0.7632796483943912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=76 head_norm_before_train=1.916510 cos_to_last_merge=0.9776 (last merge round=17)
[S7] round=76 local utility u=0.205184 metrics={'f1_val': 0.6924164830587489, 'auprc': 0.818294384758131, 'loss_val': 0.366604331983047, 'psi': 0.7427676437385018}-{'f1_val': 0.65133170112937, 'auprc': 0.7945507308356138, 'loss_val': 0.45923296774724953, 'psi': 0.7086193130118675}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=76 head_norm_before_train=1.912622 cos_to_last_merge=0.9999 (last merge round=73)
[S8] round=76 local utility u=0.104191 metrics={'f1_val': 0.8998865671848726, 'auprc': 0.9995637234484699, 'loss_val': 0.18858250946536176, 'psi': 0.9397574296903115}-{'f1_val': 0.8731914614040601, 'auprc': 0.9961481552982713, 'loss_val': 0.22654741259844047, 'psi': 0.9223741389617446}
[S9] START round=76 head_norm_before_train=2.107325 cos_to_last_merge=0.9663 (last merge round=13)
[S9] round=76 local utility u=0.000492 metrics={'f1_val': 0.9955763922175147, 'auprc': 0.9997771776264719, 'loss_val': 0.017873582059321363, 'psi': 0.9972567063810975}-{'f1_val': 0.9968525854255906, 'auprc': 0.9966060829575879, 'loss_val': 0.01700186161485215, 'psi': 0.9967539844383895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=76 head_norm_before_train=1.773408 cos_to_last_merge=0.9999 (last merge round=71)
[S10] round=76 local utility u=0.000551 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959427868802335, 'loss_val': 0.02611483003476572, 'psi': 0.9954898181637182}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958058645558073, 'loss_val': 0.026805673786736213, 'psi': 0.9954350492339478}
[S11] START round=76 head_norm_before_train=2.024703 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=76 local utility u=0.000000 metrics={'f1_val': 0.8832523642860508, 'auprc': 0.9937887229265203, 'loss_val': 0.13287071087836505, 'psi': 0.9274669077422386}-{'f1_val': 0.9963753869090841, 'auprc': 0.9937503635758772, 'loss_val': 0.02264557364835245, 'psi': 0.9953253775758013}
[S13] START round=76 head_norm_before_train=1.763047 cos_to_last_merge=1.0000 (last merge round=75)
[S13] round=76 local utility u=0.000000 metrics={'f1_val': 0.6469930095166293, 'auprc': 0.8221999881011992, 'loss_val': 1.0104579739796764, 'psi': 0.7170758009504573}-{'f1_val': 0.7533209407920036, 'auprc': 0.8626266696930349, 'loss_val': 0.648739403406593, 'psi': 0.7970432323524161}
[S14] START round=76 head_norm_before_train=1.930989 cos_to_last_merge=0.8359 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.836
[S14] round=76 local utility u=0.000000 metrics={'f1_val': 0.9907123852087418, 'auprc': 0.9970482155557051, 'loss_val': 0.036285433550388387, 'psi': 0.9932467173475272}-{'f1_val': 0.9978195179672185, 'auprc': 0.9988002375636797, 'loss_val': 0.02618305218536016, 'psi': 0.9982118058058029}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=76 head_norm_before_train=1.970616 cos_to_last_merge=0.9243 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=76 local utility u=1.000000 metrics={'f1_val': 0.9971172535281002, 'auprc': 0.9973881086483782, 'loss_val': 0.02165505400814505, 'psi': 0.9972255955762114}-{'f1_val': 0.6976794896931483, 'auprc': 0.6440488229897812, 'loss_val': 0.8229515488051297, 'psi': 0.6762272230118014}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S15] sending update (kind=head size=1793 to 1 peers)
[S16] START round=76 head_norm_before_train=2.142920 (no previous merge yet)
[S16] round=76 local utility u=1.000000 metrics={'f1_val': 0.9923410504664824, 'auprc': 0.9829033822569754, 'loss_val': 0.040140874276119703, 'psi': 0.9885659831826796}-{'f1_val': 0.7819017178088052, 'auprc': 0.9846991473672541, 'loss_val': 0.8753563048964967, 'psi': 0.8630206896321848}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S16] sending update (kind=head size=1799 to 1 peers)
[S17] START round=76 head_norm_before_train=1.922633 cos_to_last_merge=0.9994 (last merge round=71)
[S17] round=76 local utility u=0.459624 metrics={'f1_val': 0.7861932664775041, 'auprc': 0.9331837088778452, 'loss_val': 0.6494948672516923, 'psi': 0.8449894434376406}-{'f1_val': 0.6936955421916269, 'auprc': 0.896969219264979, 'loss_val': 0.9051131637879125, 'psi': 0.7750050130209678}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S8] → sending delta(kind=head bytes=1796) to S17@127.0.0.1:54517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=76 metric=0.6481 head_norm=2.031649
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.504381e-02
[S2] stored merged vector for next round verification (round=76)
[S2] DEBUG after merge:  round=76 metric=0.6485 head_norm=2.029392 delta_norm=0.015044
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] sending update (kind=head size=1796 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=0.9994
[S17] RECEIVED delta(kind=head bytes=1796) from S8
[S17] cosine check vs S8: cos=0.9994
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=1.0000
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=76 metric=0.7862 head_norm=1.935367
[S17] _apply_head_vector_avg (torch): Δ‖w‖=3.427846e-02
[S17] stored merged vector for next round verification (round=76)
[S17] DEBUG after merge:  round=76 metric=0.7918 head_norm=1.927709 delta_norm=0.034278
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=76 metric=0.9952 head_norm=1.780654
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.580816e-02
[S10] stored merged vector for next round verification (round=76)
[S10] DEBUG after merge:  round=76 metric=0.9952 head_norm=1.769801 delta_norm=0.015808
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=76 metric=0.8999 head_norm=1.920632
[S8] _apply_head_vector_avg (torch): Δ‖w‖=3.226903e-02
[S8] stored merged vector for next round verification (round=76)
[S8] DEBUG after merge:  round=76 metric=0.8967 head_norm=1.924545 delta_norm=0.032269
[S8] aggregate: ACCEPT kept=['S17', 'S17'] (k=2/2) mode=median trim_p=0.1
[S2] START round=77 head_norm_before_train=2.029392 cos_to_last_merge=1.0000 (last merge round=76)
[S2] round=77 local utility u=0.521532 metrics={'f1_val': 0.7614651254787326, 'auprc': 0.8132505435217887, 'loss_val': 0.5786873793792847, 'psi': 0.782179292695955}-{'f1_val': 0.6481153741906671, 'auprc': 0.8092603264508681, 'loss_val': 0.9296826357056062, 'psi': 0.7125733550947475}
[S3] START round=77 head_norm_before_train=2.146026 cos_to_last_merge=0.8913 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=77 local utility u=0.000000 metrics={'f1_val': 0.7700892114479982, 'auprc': 0.9854789485897428, 'loss_val': 0.7716829748076001, 'psi': 0.8562451063046961}-{'f1_val': 0.7670154122788463, 'auprc': 0.9963920866604572, 'loss_val': 0.7155899460288208, 'psi': 0.8587660820314906}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=77 head_norm_before_train=1.919225 cos_to_last_merge=0.7834 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=77 local utility u=0.000000 metrics={'f1_val': 0.9411450341204673, 'auprc': 0.9540217207791363, 'loss_val': 0.3071007143193267, 'psi': 0.9462957087839349}-{'f1_val': 0.9538512165240071, 'auprc': 0.9751539975288452, 'loss_val': 0.28483304061069636, 'psi': 0.9623723289259424}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=77 head_norm_before_train=2.188062 (no previous merge yet)
[S5] round=77 local utility u=0.000000 metrics={'f1_val': 0.9960402158980539, 'auprc': 0.99465644144734, 'loss_val': 0.02835185978816918, 'psi': 0.9954867061177683}-{'f1_val': 0.9964794802860635, 'auprc': 0.9975830300128491, 'loss_val': 0.02680687460835522, 'psi': 0.9969209001767777}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=77 head_norm_before_train=1.884175 cos_to_last_merge=0.8840 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=77 local utility u=0.525508 metrics={'f1_val': 0.8888246513570975, 'auprc': 0.9691749685239525, 'loss_val': 0.2204477697612751, 'psi': 0.9209647782238395}-{'f1_val': 0.7670569911870422, 'auprc': 0.9564418356086692, 'loss_val': 0.502658161327449, 'psi': 0.842810928955693}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S6] sending update (kind=head size=1799 to 1 peers)
[S7] START round=77 head_norm_before_train=1.924185 cos_to_last_merge=0.9768 (last merge round=17)
[S7] round=77 local utility u=0.000000 metrics={'f1_val': 0.603760081444034, 'auprc': 0.7845685093373029, 'loss_val': 0.7604972788398896, 'psi': 0.6760834526013416}-{'f1_val': 0.6924164830587489, 'auprc': 0.818294384758131, 'loss_val': 0.366604331983047, 'psi': 0.7427676437385018}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=77 head_norm_before_train=1.924545 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=77 local utility u=0.354542 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9945795896827729, 'loss_val': 0.029827292403084793, 'psi': 0.9942918440871882}-{'f1_val': 0.8998865671848726, 'auprc': 0.9995637234484699, 'loss_val': 0.18858250946536176, 'psi': 0.9397574296903115}
[S9] START round=77 head_norm_before_train=2.113153 cos_to_last_merge=0.9659 (last merge round=13)
[S9] round=77 local utility u=0.002798 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9994650651624476, 'loss_val': 0.017845909728085807, 'psi': 0.9977823331533139}-{'f1_val': 0.9955763922175147, 'auprc': 0.9997771776264719, 'loss_val': 0.017873582059321363, 'psi': 0.9972567063810975}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=77 head_norm_before_train=1.769801 cos_to_last_merge=1.0000 (last merge round=76)
[S10] round=77 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959317976993376, 'loss_val': 0.026257462568469545, 'psi': 0.9954854224913599}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959427868802335, 'loss_val': 0.02611483003476572, 'psi': 0.9954898181637182}
[S11] START round=77 head_norm_before_train=2.029217 cos_to_last_merge=1.0000 (last merge round=75)
[S11] round=77 local utility u=0.388569 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9937591333137292, 'loss_val': 0.03293096312700748, 'psi': 0.9951838582734773}-{'f1_val': 0.8832523642860508, 'auprc': 0.9937887229265203, 'loss_val': 0.13287071087836505, 'psi': 0.9274669077422386}
[S13] START round=77 head_norm_before_train=1.764398 cos_to_last_merge=1.0000 (last merge round=75)
[S13] round=77 local utility u=0.373682 metrics={'f1_val': 0.7298384960445737, 'auprc': 0.8994870967259652, 'loss_val': 0.9920284161100819, 'psi': 0.7976979363171304}-{'f1_val': 0.6469930095166293, 'auprc': 0.8221999881011992, 'loss_val': 1.0104579739796764, 'psi': 0.7170758009504573}
[S14] START round=77 head_norm_before_train=1.935530 cos_to_last_merge=0.8355 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.835
[S14] round=77 local utility u=0.000000 metrics={'f1_val': 0.955906886643145, 'auprc': 0.9970502204599367, 'loss_val': 0.06171419324278065, 'psi': 0.9723642201698618}-{'f1_val': 0.9907123852087418, 'auprc': 0.9970482155557051, 'loss_val': 0.036285433550388387, 'psi': 0.9932467173475272}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=77 head_norm_before_train=1.970075 cos_to_last_merge=0.9240 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=77 local utility u=0.000000 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9968589088811579, 'loss_val': 0.025103539456881343, 'psi': 0.9967915645849755}-{'f1_val': 0.9971172535281002, 'auprc': 0.9973881086483782, 'loss_val': 0.02165505400814505, 'psi': 0.9972255955762114}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=77 head_norm_before_train=2.145044 (no previous merge yet)
[S16] round=77 local utility u=0.000000 metrics={'f1_val': 0.8330670868912536, 'auprc': 0.8386331528335678, 'loss_val': 1.4603093903396804, 'psi': 0.8352935132681792}-{'f1_val': 0.9923410504664824, 'auprc': 0.9829033822569754, 'loss_val': 0.040140874276119703, 'psi': 0.9885659831826796}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=77 head_norm_before_train=1.927709 cos_to_last_merge=1.0000 (last merge round=76)
[S17] round=77 local utility u=0.000000 metrics={'f1_val': 0.6690964538344888, 'auprc': 0.8919278493574576, 'loss_val': 1.0870580828873129, 'psi': 0.7582290120436763}-{'f1_val': 0.7861932664775041, 'auprc': 0.9331837088778452, 'loss_val': 0.6494948672516923, 'psi': 0.8449894434376406}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S2] → sending delta(kind=head bytes=1797) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[S13] sending update (kind=head size=1802 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S2] sending update (kind=head size=1797 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1797) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=1.0000
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=77 metric=0.9961 head_norm=2.033941
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.996133e-03
[S11] stored merged vector for next round verification (round=77)
[S11] DEBUG after merge:  round=77 metric=0.9961 head_norm=2.033815 delta_norm=0.007996
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=77 metric=0.7298 head_norm=1.766499
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.142210e-02
[S13] stored merged vector for next round verification (round=77)
[S13] DEBUG after merge:  round=77 metric=0.7295 head_norm=1.773554 delta_norm=0.011422
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=77 metric=0.7615 head_norm=2.033720
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.996127e-03
[S2] stored merged vector for next round verification (round=77)
[S2] DEBUG after merge:  round=77 metric=0.7614 head_norm=2.033815 delta_norm=0.007996
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=78 head_norm_before_train=2.033815 cos_to_last_merge=1.0000 (last merge round=77)
[S2] round=78 local utility u=0.105439 metrics={'f1_val': 0.7077650956039796, 'auprc': 0.9706241904196005, 'loss_val': 0.5177305562166699, 'psi': 0.812908733530228}-{'f1_val': 0.7614651254787326, 'auprc': 0.8132505435217887, 'loss_val': 0.5786873793792847, 'psi': 0.782179292695955}
[S3] START round=78 head_norm_before_train=2.152409 cos_to_last_merge=0.8908 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.891
[S3] round=78 local utility u=0.230452 metrics={'f1_val': 0.8090417174339066, 'auprc': 0.9922473054143457, 'loss_val': 0.5648000503712506, 'psi': 0.8823239526260822}-{'f1_val': 0.7700892114479982, 'auprc': 0.9854789485897428, 'loss_val': 0.7716829748076001, 'psi': 0.8562451063046961}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=78 head_norm_before_train=1.923062 cos_to_last_merge=0.7831 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=78 local utility u=0.000000 metrics={'f1_val': 0.9389717400125119, 'auprc': 0.9464198492699557, 'loss_val': 0.3290890300848379, 'psi': 0.9419509837154895}-{'f1_val': 0.9411450341204673, 'auprc': 0.9540217207791363, 'loss_val': 0.3071007143193267, 'psi': 0.9462957087839349}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=78 head_norm_before_train=2.196358 (no previous merge yet)
[S5] round=78 local utility u=0.007535 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9975104809496098, 'loss_val': 0.024479790431100473, 'psi': 0.996891880551482}-{'f1_val': 0.9960402158980539, 'auprc': 0.99465644144734, 'loss_val': 0.02835185978816918, 'psi': 0.9954867061177683}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=78 head_norm_before_train=1.891179 cos_to_last_merge=0.8836 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.884
[S6] round=78 local utility u=0.001531 metrics={'f1_val': 0.8853075546295082, 'auprc': 0.98192475145011, 'loss_val': 0.2345323205197929, 'psi': 0.9239544333577488}-{'f1_val': 0.8888246513570975, 'auprc': 0.9691749685239525, 'loss_val': 0.2204477697612751, 'psi': 0.9209647782238395}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=78 head_norm_before_train=1.929481 cos_to_last_merge=0.9767 (last merge round=17)
[S7] round=78 local utility u=0.000000 metrics={'f1_val': 0.5276756201518905, 'auprc': 0.7764820849523213, 'loss_val': 1.150478382446053, 'psi': 0.6271982060720629}-{'f1_val': 0.603760081444034, 'auprc': 0.7845685093373029, 'loss_val': 0.7604972788398896, 'psi': 0.6760834526013416}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=78 head_norm_before_train=1.933045 cos_to_last_merge=1.0000 (last merge round=76)
[S8] round=78 local utility u=0.002663 metrics={'f1_val': 0.9937185965290795, 'auprc': 0.9973858258911389, 'loss_val': 0.030632405400900904, 'psi': 0.9951854882739032}-{'f1_val': 0.9941000136901317, 'auprc': 0.9945795896827729, 'loss_val': 0.029827292403084793, 'psi': 0.9942918440871882}
[S9] START round=78 head_norm_before_train=2.117114 cos_to_last_merge=0.9652 (last merge round=13)
[S9] round=78 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.9994224827591603, 'loss_val': 0.018004544494894952, 'psi': 0.9972650241221754}-{'f1_val': 0.9966605118138915, 'auprc': 0.9994650651624476, 'loss_val': 0.017845909728085807, 'psi': 0.9977823331533139}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=78 head_norm_before_train=1.776348 cos_to_last_merge=1.0000 (last merge round=76)
[S10] round=78 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9958404129375069, 'loss_val': 0.02668993484132573, 'psi': 0.9954488685866276}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959317976993376, 'loss_val': 0.026257462568469545, 'psi': 0.9954854224913599}
[S11] START round=78 head_norm_before_train=2.033815 cos_to_last_merge=1.0000 (last merge round=77)
[S11] round=78 local utility u=0.009634 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9962510956441446, 'loss_val': 0.02113857177293681, 'psi': 0.9961806432056435}-{'f1_val': 0.9961336749133093, 'auprc': 0.9937591333137292, 'loss_val': 0.03293096312700748, 'psi': 0.9951838582734773}
[S13] START round=78 head_norm_before_train=1.773554 cos_to_last_merge=1.0000 (last merge round=77)
[S13] round=78 local utility u=0.000000 metrics={'f1_val': 0.625555676598246, 'auprc': 0.8008891738931718, 'loss_val': 1.1827794200817088, 'psi': 0.6956890755162163}-{'f1_val': 0.7298384960445737, 'auprc': 0.8994870967259652, 'loss_val': 0.9920284161100819, 'psi': 0.7976979363171304}
[S14] START round=78 head_norm_before_train=1.939088 cos_to_last_merge=0.8351 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.835
[S14] round=78 local utility u=0.147607 metrics={'f1_val': 0.9982330107938716, 'auprc': 0.9974517787658016, 'loss_val': 0.021662200584259744, 'psi': 0.9979205179826436}-{'f1_val': 0.955906886643145, 'auprc': 0.9970502204599367, 'loss_val': 0.06171419324278065, 'psi': 0.9723642201698618}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S14] sending update (kind=head size=1801 to 1 peers)
[S15] START round=78 head_norm_before_train=1.972144 cos_to_last_merge=0.9236 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.924
[S15] round=78 local utility u=0.000000 metrics={'f1_val': 0.9169180363570439, 'auprc': 0.9963405282947175, 'loss_val': 0.12509085573158016, 'psi': 0.9486870331321133}-{'f1_val': 0.9967466683875206, 'auprc': 0.9968589088811579, 'loss_val': 0.025103539456881343, 'psi': 0.9967915645849755}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=78 head_norm_before_train=2.147131 (no previous merge yet)
[S16] round=78 local utility u=1.000000 metrics={'f1_val': 0.9927777551270288, 'auprc': 0.9894966654962948, 'loss_val': 0.04296514501263343, 'psi': 0.9914653192747351}-{'f1_val': 0.8330670868912536, 'auprc': 0.8386331528335678, 'loss_val': 1.4603093903396804, 'psi': 0.8352935132681792}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S16] sending update (kind=head size=1802 to 1 peers)
[S17] START round=78 head_norm_before_train=1.936794 cos_to_last_merge=1.0000 (last merge round=76)
[S17] round=78 local utility u=0.150531 metrics={'f1_val': 0.6874374265322766, 'auprc': 0.8999164250471111, 'loss_val': 0.9200072337239016, 'psi': 0.7724290259382104}-{'f1_val': 0.6690964538344888, 'auprc': 0.8919278493574576, 'loss_val': 1.0870580828873129, 'psi': 0.7582290120436763}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S8] → sending delta(kind=head bytes=1801) to S17@127.0.0.1:54517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S2] → sending delta(kind=head bytes=1801) to S11@127.0.0.1:54512
[S8] sending update (kind=head size=1801 to 1 peers)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=78 metric=0.9952 head_norm=1.782098
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.202329e-02
[S10] stored merged vector for next round verification (round=78)
[S10] DEBUG after merge:  round=78 metric=0.9952 head_norm=1.774275 delta_norm=0.012023
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1799 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1801) from S8
[S17] cosine check vs S8: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1801) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9999
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=78 metric=0.6874 head_norm=1.944738
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.288624e-02
[S17] stored merged vector for next round verification (round=78)
[S17] DEBUG after merge:  round=78 metric=0.6889 head_norm=1.940345 delta_norm=0.012886
[S17] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=78 metric=0.9961 head_norm=2.040886
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.391697e-03
[S11] stored merged vector for next round verification (round=78)
[S11] DEBUG after merge:  round=78 metric=0.9961 head_norm=2.040133 delta_norm=0.004392
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=78 metric=0.7078 head_norm=2.039390
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.391701e-03
[S2] stored merged vector for next round verification (round=78)
[S2] DEBUG after merge:  round=78 metric=0.7078 head_norm=2.040133 delta_norm=0.004392
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=78 metric=0.9937 head_norm=1.939024
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.277526e-02
[S8] stored merged vector for next round verification (round=78)
[S8] DEBUG after merge:  round=78 metric=0.9937 head_norm=1.941841 delta_norm=0.012775
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=79 head_norm_before_train=2.040133 cos_to_last_merge=1.0000 (last merge round=78)
[S2] round=79 local utility u=0.030446 metrics={'f1_val': 0.70877286279823, 'auprc': 0.9844937161539067, 'loss_val': 0.5044935293438606, 'psi': 0.8190612041405008}-{'f1_val': 0.7077650956039796, 'auprc': 0.9706241904196005, 'loss_val': 0.5177305562166699, 'psi': 0.812908733530228}
[S3] START round=79 head_norm_before_train=2.158799 cos_to_last_merge=0.8904 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.890
[S3] round=79 local utility u=0.000000 metrics={'f1_val': 0.7630637003022501, 'auprc': 0.9912986196596734, 'loss_val': 0.7694579730001861, 'psi': 0.8543576680452194}-{'f1_val': 0.8090417174339066, 'auprc': 0.9922473054143457, 'loss_val': 0.5648000503712506, 'psi': 0.8823239526260822}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=80 psi=0.854 u=0.0000 p_local=0.1255 f1=0.763 auprc=0.991 bytes=70181
[S4] START round=79 head_norm_before_train=1.926415 cos_to_last_merge=0.7825 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=79 local utility u=0.014659 metrics={'f1_val': 0.9406527627399838, 'auprc': 0.9509367374044914, 'loss_val': 0.32340806171694025, 'psi': 0.9447663526057868}-{'f1_val': 0.9389717400125119, 'auprc': 0.9464198492699557, 'loss_val': 0.3290890300848379, 'psi': 0.9419509837154895}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S4] r=80 psi=0.945 u=0.0147 p_local=0.0125 f1=0.941 auprc=0.951 bytes=77345
[S5] START round=79 head_norm_before_train=2.210846 (no previous merge yet)
[S5] round=79 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9963440707271679, 'loss_val': 0.025684317752025634, 'psi': 0.9964253164625052}-{'f1_val': 0.9964794802860635, 'auprc': 0.9975104809496098, 'loss_val': 0.024479790431100473, 'psi': 0.996891880551482}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=80 psi=0.996 u=0.0000 p_local=0.0022 f1=0.996 auprc=0.996 bytes=75462
[S6] START round=79 head_norm_before_train=1.898986 cos_to_last_merge=0.8833 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.883
[S6] round=79 local utility u=0.000000 metrics={'f1_val': 0.5952746642961327, 'auprc': 0.8112394971858176, 'loss_val': 1.0631474327706, 'psi': 0.6816605974520067}-{'f1_val': 0.8853075546295082, 'auprc': 0.98192475145011, 'loss_val': 0.2345323205197929, 'psi': 0.9239544333577488}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=80 psi=0.682 u=0.0000 p_local=0.2002 f1=0.595 auprc=0.811 bytes=88132
[S7] START round=79 head_norm_before_train=1.935007 cos_to_last_merge=0.9768 (last merge round=17)
[S7] round=79 local utility u=0.000000 metrics={'f1_val': 0.43793845966238787, 'auprc': 0.7744432245446261, 'loss_val': 1.4130189930499546, 'psi': 0.5725403656152832}-{'f1_val': 0.5276756201518905, 'auprc': 0.7764820849523213, 'loss_val': 1.150478382446053, 'psi': 0.6271982060720629}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=80 psi=0.573 u=0.0000 p_local=0.1495 f1=0.438 auprc=0.774 bytes=71959
[S8] START round=79 head_norm_before_train=1.941841 cos_to_last_merge=1.0000 (last merge round=78)
[S8] round=79 local utility u=0.006630 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9995953736652273, 'loss_val': 0.028493644833413326, 'psi': 0.9965184706475281}-{'f1_val': 0.9937185965290795, 'auprc': 0.9973858258911389, 'loss_val': 0.030632405400900904, 'psi': 0.9951854882739032}
[S9] START round=79 head_norm_before_train=2.116240 cos_to_last_merge=0.9652 (last merge round=13)
[S9] round=79 local utility u=0.003069 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996967987671898, 'loss_val': 0.017693067584594144, 'psi': 0.9978750265952108}-{'f1_val': 0.9958267183641853, 'auprc': 0.9994224827591603, 'loss_val': 0.018004544494894952, 'psi': 0.9972650241221754}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S9] r=80 psi=0.998 u=0.0031 p_local=0.0028 f1=0.997 auprc=1.000 bytes=77273
[S10] START round=79 head_norm_before_train=1.774275 cos_to_last_merge=1.0000 (last merge round=78)
[S10] round=79 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9957917787017692, 'loss_val': 0.026553624286252304, 'psi': 0.9954294148923325}-{'f1_val': 0.9951878390193748, 'auprc': 0.9958404129375069, 'loss_val': 0.02668993484132573, 'psi': 0.9954488685866276}
[S11] START round=79 head_norm_before_train=2.040133 cos_to_last_merge=1.0000 (last merge round=78)
[S11] round=79 local utility u=0.001734 metrics={'f1_val': 0.9965470045135896, 'auprc': 0.9962029211716895, 'loss_val': 0.02000621926111335, 'psi': 0.9964093711768296}-{'f1_val': 0.9961336749133093, 'auprc': 0.9962510956441446, 'loss_val': 0.02113857177293681, 'psi': 0.9961806432056435}
[S13] START round=79 head_norm_before_train=1.775131 cos_to_last_merge=1.0000 (last merge round=77)
[S13] round=79 local utility u=0.611897 metrics={'f1_val': 0.7396310550345139, 'auprc': 0.895085552612246, 'loss_val': 0.9260259166841647, 'psi': 0.8018128540656067}-{'f1_val': 0.625555676598246, 'auprc': 0.8008891738931718, 'loss_val': 1.1827794200817088, 'psi': 0.6956890755162163}
[S14] START round=79 head_norm_before_train=1.943934 cos_to_last_merge=0.8347 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.835
[S14] round=79 local utility u=0.000000 metrics={'f1_val': 0.9972435617623723, 'auprc': 0.9985034321547601, 'loss_val': 0.02012367776217013, 'psi': 0.9977475099193274}-{'f1_val': 0.9982330107938716, 'auprc': 0.9974517787658016, 'loss_val': 0.021662200584259744, 'psi': 0.9979205179826436}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=80 psi=0.998 u=0.0000 p_local=0.0316 f1=0.997 auprc=0.999 bytes=84596
[S15] START round=79 head_norm_before_train=1.976802 cos_to_last_merge=0.9231 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=79 local utility u=0.000000 metrics={'f1_val': 0.8774152092916521, 'auprc': 0.9938168109590356, 'loss_val': 0.3171328430237983, 'psi': 0.9239758499586055}-{'f1_val': 0.9169180363570439, 'auprc': 0.9963405282947175, 'loss_val': 0.12509085573158016, 'psi': 0.9486870331321133}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] r=80 psi=0.924 u=0.0000 p_local=0.1992 f1=0.877 auprc=0.994 bytes=70143
[S16] START round=79 head_norm_before_train=2.149742 (no previous merge yet)
[S16] round=79 local utility u=0.007053 metrics={'f1_val': 0.9936971587557657, 'auprc': 0.9898295738427756, 'loss_val': 0.03537394475438577, 'psi': 0.9921501247905696}-{'f1_val': 0.9927777551270288, 'auprc': 0.9894966654962948, 'loss_val': 0.04296514501263343, 'psi': 0.9914653192747351}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S16] r=80 psi=0.992 u=0.0071 p_local=0.3800 f1=0.994 auprc=0.990 bytes=77285
[S17] START round=79 head_norm_before_train=1.940345 cos_to_last_merge=1.0000 (last merge round=78)
[S17] round=79 local utility u=0.703818 metrics={'f1_val': 0.828218824479529, 'auprc': 0.9511152421765058, 'loss_val': 0.5106568053512957, 'psi': 0.8773773915583196}-{'f1_val': 0.6874374265322766, 'auprc': 0.8999164250471111, 'loss_val': 0.9200072337239016, 'psi': 0.7724290259382104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S2] → sending delta(kind=head bytes=1800) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1806 reason=None
[S8] → sending delta(kind=head bytes=1806) to S17@127.0.0.1:54517
[S11] sending update (kind=head size=1798 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S8] sending update (kind=head size=1806 to 1 peers)
[S2] sending update (kind=head size=1800 to 1 peers)
[S13] sending update (kind=head size=1803 to 1 peers)
[S10] r=80 psi=0.995 u=0.0000 p_local=0.0001 f1=0.995 auprc=0.996 bytes=95316
[S17] RECEIVED delta(kind=head bytes=1806) from S8
[S17] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1800) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=1.0000
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=79 metric=0.7088 head_norm=2.046003
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.520147e-03
[S2] stored merged vector for next round verification (round=79)
[S2] DEBUG after merge:  round=79 metric=0.7088 head_norm=2.046780 delta_norm=0.004520
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] r=80 psi=0.819 u=0.0304 p_local=0.1127 f1=0.709 auprc=0.984 bytes=79189
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=79 metric=0.9945 head_norm=1.946772
[S8] _apply_head_vector_avg (torch): Δ‖w‖=6.710393e-03
[S8] stored merged vector for next round verification (round=79)
[S8] DEBUG after merge:  round=79 metric=0.9945 head_norm=1.948494 delta_norm=0.006710
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] r=80 psi=0.997 u=0.0066 p_local=0.0827 f1=0.994 auprc=1.000 bytes=82778
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=79 metric=0.8282 head_norm=1.950238
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.710385e-03
[S17] stored merged vector for next round verification (round=79)
[S17] DEBUG after merge:  round=79 metric=0.8282 head_norm=1.948494 delta_norm=0.006710
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=80 psi=0.877 u=0.7038 p_local=0.2891 f1=0.828 auprc=0.951 bytes=86369
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=79 metric=0.9965 head_norm=2.047566
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.520165e-03
[S11] stored merged vector for next round verification (round=79)
[S11] DEBUG after merge:  round=79 metric=0.9965 head_norm=2.046780 delta_norm=0.004520
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] r=80 psi=0.996 u=0.0017 p_local=0.0679 f1=0.997 auprc=0.996 bytes=95393
[S13] r=80 psi=0.802 u=0.6119 p_local=0.2578 f1=0.740 auprc=0.895 bytes=77333
[S2] START round=80 head_norm_before_train=2.046780 cos_to_last_merge=1.0000 (last merge round=79)
[S2] round=80 local utility u=0.000000 metrics={'f1_val': 0.5941422346785085, 'auprc': 0.780327487263122, 'loss_val': 1.361727763663797, 'psi': 0.6686163357123539}-{'f1_val': 0.70877286279823, 'auprc': 0.9844937161539067, 'loss_val': 0.5044935293438606, 'psi': 0.8190612041405008}
[S3] START round=80 head_norm_before_train=2.165281 cos_to_last_merge=0.8899 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.890
[S3] round=80 local utility u=0.073826 metrics={'f1_val': 0.7931190141737975, 'auprc': 0.9644587088406082, 'loss_val': 0.7216191066790597, 'psi': 0.8616548920405218}-{'f1_val': 0.7630637003022501, 'auprc': 0.9912986196596734, 'loss_val': 0.7694579730001861, 'psi': 0.8543576680452194}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=80 head_norm_before_train=1.914335 cos_to_last_merge=0.7828 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=80 local utility u=0.060211 metrics={'f1_val': 0.9448533812823663, 'auprc': 0.9736963226572407, 'loss_val': 0.29646867321979453, 'psi': 0.956390557832316}-{'f1_val': 0.9406527627399838, 'auprc': 0.9509367374044914, 'loss_val': 0.32340806171694025, 'psi': 0.9447663526057868}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=80 head_norm_before_train=2.215681 (no previous merge yet)
[S5] round=80 local utility u=0.000000 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9951701488605057, 'loss_val': 0.025118842403877403, 'psi': 0.9959557477158404}-{'f1_val': 0.9964794802860635, 'auprc': 0.9963440707271679, 'loss_val': 0.025684317752025634, 'psi': 0.9964253164625052}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=80 head_norm_before_train=1.903757 cos_to_last_merge=0.8822 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=80 local utility u=1.000000 metrics={'f1_val': 0.8761209200875227, 'auprc': 0.9794584353372718, 'loss_val': 0.2650176343738251, 'psi': 0.9174559261874224}-{'f1_val': 0.5952746642961327, 'auprc': 0.8112394971858176, 'loss_val': 1.0631474327706, 'psi': 0.6816605974520067}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=80 head_norm_before_train=1.937622 cos_to_last_merge=0.9766 (last merge round=17)
[S7] round=80 local utility u=1.000000 metrics={'f1_val': 0.6498817107394039, 'auprc': 0.8031869275886755, 'loss_val': 0.48113861714978723, 'psi': 0.7112037974791126}-{'f1_val': 0.43793845966238787, 'auprc': 0.7744432245446261, 'loss_val': 1.4130189930499546, 'psi': 0.5725403656152832}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S7] sending update (kind=head size=1803 to 1 peers)
[S8] START round=80 head_norm_before_train=1.948494 cos_to_last_merge=1.0000 (last merge round=79)
[S8] round=80 local utility u=0.000000 metrics={'f1_val': 0.8271660726725807, 'auprc': 0.9995659832376489, 'loss_val': 0.3346356522753421, 'psi': 0.8961260368986079}-{'f1_val': 0.9944672019690619, 'auprc': 0.9995953736652273, 'loss_val': 0.028493644833413326, 'psi': 0.9965184706475281}
[S9] START round=80 head_norm_before_train=2.122089 cos_to_last_merge=0.9654 (last merge round=13)
[S9] round=80 local utility u=0.000032 metrics={'f1_val': 0.9966570119660778, 'auprc': 0.9994021530264656, 'loss_val': 0.016724829796250514, 'psi': 0.997755068390233}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996967987671898, 'loss_val': 0.017693067584594144, 'psi': 0.9978750265952108}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=80 head_norm_before_train=1.781123 cos_to_last_merge=1.0000 (last merge round=78)
[S10] round=80 local utility u=0.001033 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961696643351923, 'loss_val': 0.02562167984601375, 'psi': 0.9955805691457018}-{'f1_val': 0.9951878390193748, 'auprc': 0.9957917787017692, 'loss_val': 0.026553624286252304, 'psi': 0.9954294148923325}
[S11] START round=80 head_norm_before_train=2.046780 cos_to_last_merge=1.0000 (last merge round=79)
[S11] round=80 local utility u=0.000788 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9961524762949496, 'loss_val': 0.019728948051169357, 'psi': 0.9965342204235985}-{'f1_val': 0.9965470045135896, 'auprc': 0.9962029211716895, 'loss_val': 0.02000621926111335, 'psi': 0.9964093711768296}
[S13] START round=80 head_norm_before_train=1.776750 cos_to_last_merge=1.0000 (last merge round=77)
[S13] round=80 local utility u=0.000000 metrics={'f1_val': 0.6288754995151756, 'auprc': 0.8592979551969396, 'loss_val': 1.1685986646617739, 'psi': 0.7210444817878813}-{'f1_val': 0.7396310550345139, 'auprc': 0.895085552612246, 'loss_val': 0.9260259166841647, 'psi': 0.8018128540656067}
[S14] START round=80 head_norm_before_train=1.950606 cos_to_last_merge=0.8342 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=80 local utility u=0.000000 metrics={'f1_val': 0.9953093603435523, 'auprc': 0.9985395243203162, 'loss_val': 0.02606150193819556, 'psi': 0.9966014259342579}-{'f1_val': 0.9972435617623723, 'auprc': 0.9985034321547601, 'loss_val': 0.02012367776217013, 'psi': 0.9977475099193274}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=80 head_norm_before_train=1.982230 cos_to_last_merge=0.9227 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.923
[S15] round=80 local utility u=0.057934 metrics={'f1_val': 0.8920990974317697, 'auprc': 0.9943586888061691, 'loss_val': 0.29099444152527804, 'psi': 0.9330029339815296}-{'f1_val': 0.8774152092916521, 'auprc': 0.9938168109590356, 'loss_val': 0.3171328430237983, 'psi': 0.9239758499586055}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=80 head_norm_before_train=2.153769 (no previous merge yet)
[S16] round=80 local utility u=0.008297 metrics={'f1_val': 0.9943126892134037, 'auprc': 0.9919655506629403, 'loss_val': 0.028881368052669405, 'psi': 0.9933738337932183}-{'f1_val': 0.9936971587557657, 'auprc': 0.9898295738427756, 'loss_val': 0.03537394475438577, 'psi': 0.9921501247905696}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=80 head_norm_before_train=1.948494 cos_to_last_merge=1.0000 (last merge round=79)
[S17] round=80 local utility u=0.000000 metrics={'f1_val': 0.7394315964464812, 'auprc': 0.91936241784739, 'loss_val': 0.7818092076047849, 'psi': 0.8114039250068448}-{'f1_val': 0.828218824479529, 'auprc': 0.9511152421765058, 'loss_val': 0.5106568053512957, 'psi': 0.8773773915583196}
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] ⇄ pheromone p=0.206 → S10@127.0.0.1:54511
[S11] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1805 to 1 peers)
[S2] ⇄ pheromone p=0.090 → S11@127.0.0.1:54512
[S8] ⇄ pheromone p=0.066 → S17@127.0.0.1:54517
[S17] ⇄ pheromone p=0.231 → S8@127.0.0.1:54509
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=80 metric=0.9952 head_norm=1.788609
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.709941e-03
[S10] stored merged vector for next round verification (round=80)
[S10] DEBUG after merge:  round=80 metric=0.9952 head_norm=1.782673 delta_norm=0.007710
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S11] ⇄ pheromone p=0.054 → S2@127.0.0.1:54502
[S2] START round=81 head_norm_before_train=2.052334 cos_to_last_merge=1.0000 (last merge round=79)
[S2] round=81 local utility u=1.000000 metrics={'f1_val': 0.7078360041287648, 'auprc': 0.9583896409963397, 'loss_val': 0.5122298174425826, 'psi': 0.8080574588757947}-{'f1_val': 0.5941422346785085, 'auprc': 0.780327487263122, 'loss_val': 1.361727763663797, 'psi': 0.6686163357123539}
[S3] START round=81 head_norm_before_train=2.170905 cos_to_last_merge=0.8895 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=81 local utility u=0.000000 metrics={'f1_val': 0.6716473075272674, 'auprc': 0.974621397769222, 'loss_val': 1.2396295244308546, 'psi': 0.7928369436240492}-{'f1_val': 0.7931190141737975, 'auprc': 0.9644587088406082, 'loss_val': 0.7216191066790597, 'psi': 0.8616548920405218}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=81 head_norm_before_train=1.899878 cos_to_last_merge=0.7831 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=81 local utility u=0.000000 metrics={'f1_val': 0.9452996614120599, 'auprc': 0.969999241553857, 'loss_val': 0.2982429565114266, 'psi': 0.9551794934687787}-{'f1_val': 0.9448533812823663, 'auprc': 0.9736963226572407, 'loss_val': 0.29646867321979453, 'psi': 0.956390557832316}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=81 head_norm_before_train=2.220310 (no previous merge yet)
[S5] round=81 local utility u=0.004079 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9976018599433506, 'loss_val': 0.024256150624047238, 'psi': 0.9969284321489783}-{'f1_val': 0.9964794802860635, 'auprc': 0.9951701488605057, 'loss_val': 0.025118842403877403, 'psi': 0.9959557477158404}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=81 head_norm_before_train=1.906212 cos_to_last_merge=0.8816 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.882
[S6] round=81 local utility u=0.000000 metrics={'f1_val': 0.8761424685883574, 'auprc': 0.9672205764975601, 'loss_val': 0.26966074086472447, 'psi': 0.9125737117520385}-{'f1_val': 0.8761209200875227, 'auprc': 0.9794584353372718, 'loss_val': 0.2650176343738251, 'psi': 0.9174559261874224}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=81 head_norm_before_train=1.940372 cos_to_last_merge=0.9764 (last merge round=17)
[S7] round=81 local utility u=0.000000 metrics={'f1_val': 0.6462930651634272, 'auprc': 0.7984421286832927, 'loss_val': 0.4499611608874009, 'psi': 0.7071526905713734}-{'f1_val': 0.6498817107394039, 'auprc': 0.8031869275886755, 'loss_val': 0.48113861714978723, 'psi': 0.7112037974791126}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=81 head_norm_before_train=1.953217 cos_to_last_merge=1.0000 (last merge round=79)
[S8] round=81 local utility u=0.634160 metrics={'f1_val': 0.9889384063943332, 'auprc': 0.9995726105418532, 'loss_val': 0.03696983841590483, 'psi': 0.9931920880533411}-{'f1_val': 0.8271660726725807, 'auprc': 0.9995659832376489, 'loss_val': 0.3346356522753421, 'psi': 0.8961260368986079}
[S9] START round=81 head_norm_before_train=2.122497 cos_to_last_merge=0.9660 (last merge round=13)
[S9] round=81 local utility u=0.000823 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9993790132927245, 'loss_val': 0.017494981975029914, 'psi': 0.9979944532387099}-{'f1_val': 0.9966570119660778, 'auprc': 0.9994021530264656, 'loss_val': 0.016724829796250514, 'psi': 0.997755068390233}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S9] sending update (kind=head size=1800 to 1 peers)
[S10] START round=81 head_norm_before_train=1.782673 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=81 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.995831176848661, 'loss_val': 0.026229886235133882, 'psi': 0.9954451741510892}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961696643351923, 'loss_val': 0.02562167984601375, 'psi': 0.9955805691457018}
[S11] START round=81 head_norm_before_train=2.054356 cos_to_last_merge=1.0000 (last merge round=79)
[S11] round=81 local utility u=0.000013 metrics={'f1_val': 0.9967887165093644, 'auprc': 0.9961779571710632, 'loss_val': 0.019778832440202822, 'psi': 0.9965444127740439}-{'f1_val': 0.9967887165093644, 'auprc': 0.9961524762949496, 'loss_val': 0.019728948051169357, 'psi': 0.9965342204235985}
[S13] START round=81 head_norm_before_train=1.779170 cos_to_last_merge=1.0000 (last merge round=77)
[S13] round=81 local utility u=0.436260 metrics={'f1_val': 0.7013424397314862, 'auprc': 0.8975148044817728, 'loss_val': 0.8455306947302847, 'psi': 0.7798113856316009}-{'f1_val': 0.6288754995151756, 'auprc': 0.8592979551969396, 'loss_val': 1.1685986646617739, 'psi': 0.7210444817878813}
[S14] START round=81 head_norm_before_train=1.957474 cos_to_last_merge=0.8338 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.834
[S14] round=81 local utility u=0.000000 metrics={'f1_val': 0.9906128754008952, 'auprc': 0.9991137951942815, 'loss_val': 0.038392749892019594, 'psi': 0.9940132433182496}-{'f1_val': 0.9953093603435523, 'auprc': 0.9985395243203162, 'loss_val': 0.02606150193819556, 'psi': 0.9966014259342579}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=81 head_norm_before_train=1.988480 cos_to_last_merge=0.9221 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=81 local utility u=0.236230 metrics={'f1_val': 0.9357534448119964, 'auprc': 0.9963165552570872, 'loss_val': 0.08633374946433675, 'psi': 0.9599786889900328}-{'f1_val': 0.8920990974317697, 'auprc': 0.9943586888061691, 'loss_val': 0.29099444152527804, 'psi': 0.9330029339815296}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S15] sending update (kind=head size=1799 to 1 peers)
[S16] START round=81 head_norm_before_train=2.158451 (no previous merge yet)
[S16] round=81 local utility u=0.000033 metrics={'f1_val': 0.9952151837191423, 'auprc': 0.9896381771415459, 'loss_val': 0.027247969015828384, 'psi': 0.9929843810881038}-{'f1_val': 0.9943126892134037, 'auprc': 0.9919655506629403, 'loss_val': 0.028881368052669405, 'psi': 0.9933738337932183}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S16] sending update (kind=head size=1793 to 1 peers)
[S17] START round=81 head_norm_before_train=1.959378 cos_to_last_merge=1.0000 (last merge round=79)
[S17] round=81 local utility u=0.154462 metrics={'f1_val': 0.7738009636493379, 'auprc': 0.9292755440320678, 'loss_val': 0.7088404519888407, 'psi': 0.8359907958024299}-{'f1_val': 0.7394315964464812, 'auprc': 0.91936241784739, 'loss_val': 0.7818092076047849, 'psi': 0.8114039250068448}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S2] → sending delta(kind=head bytes=1803) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:54517
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S13] → sending delta(kind=head bytes=1799) to S10@127.0.0.1:54511
[S8] sending update (kind=head size=1803 to 1 peers)
[S11] sending update (kind=head size=1794 to 1 peers)
[S2] sending update (kind=head size=1803 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S13] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1799) from S13
[S10] cosine check vs S13: cos=0.9999
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1803) from S2
[S11] cosine check vs S2: cos=1.0000
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=81 metric=0.9968 head_norm=2.060632
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.037038e-03
[S11] stored merged vector for next round verification (round=81)
[S11] DEBUG after merge:  round=81 metric=0.9968 head_norm=2.058011 delta_norm=0.009037
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=81 metric=0.7078 head_norm=2.055426
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.643039e-03
[S2] stored merged vector for next round verification (round=81)
[S2] DEBUG after merge:  round=81 metric=0.7078 head_norm=2.056445 delta_norm=0.007643
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=81 metric=0.7013 head_norm=1.783164
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.812211e-03
[S13] stored merged vector for next round verification (round=81)
[S13] DEBUG after merge:  round=81 metric=0.7007 head_norm=1.785862 delta_norm=0.009812
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=81 metric=0.9889 head_norm=1.956593
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.632084e-02
[S8] stored merged vector for next round verification (round=81)
[S8] DEBUG after merge:  round=81 metric=0.9889 head_norm=1.963207 delta_norm=0.016321
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=81 metric=0.7738 head_norm=1.969934
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.632084e-02
[S17] stored merged vector for next round verification (round=81)
[S17] DEBUG after merge:  round=81 metric=0.7740 head_norm=1.963207 delta_norm=0.016321
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=82 head_norm_before_train=2.056445 cos_to_last_merge=1.0000 (last merge round=81)
[S2] round=82 local utility u=0.073557 metrics={'f1_val': 0.7097515052327249, 'auprc': 0.9911145024144639, 'loss_val': 0.47478275088706046, 'psi': 0.8222967041054206}-{'f1_val': 0.7078360041287648, 'auprc': 0.9583896409963397, 'loss_val': 0.5122298174425826, 'psi': 0.8080574588757947}
[S3] START round=82 head_norm_before_train=2.177057 cos_to_last_merge=0.8890 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=82 local utility u=1.000000 metrics={'f1_val': 0.9123528892193279, 'auprc': 0.9946127774868017, 'loss_val': 0.21588879079716705, 'psi': 0.9452568445263174}-{'f1_val': 0.6716473075272674, 'auprc': 0.974621397769222, 'loss_val': 1.2396295244308546, 'psi': 0.7928369436240492}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=82 head_norm_before_train=1.893889 cos_to_last_merge=0.7831 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=82 local utility u=0.000000 metrics={'f1_val': 0.9419347503379262, 'auprc': 0.9579794929027396, 'loss_val': 0.32861878319880883, 'psi': 0.9483526473638515}-{'f1_val': 0.9452996614120599, 'auprc': 0.969999241553857, 'loss_val': 0.2982429565114266, 'psi': 0.9551794934687787}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=82 head_norm_before_train=2.230059 (no previous merge yet)
[S5] round=82 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.996729394574152, 'loss_val': 0.02451289723073676, 'psi': 0.9964033718152474}-{'f1_val': 0.9964794802860635, 'auprc': 0.9976018599433506, 'loss_val': 0.024256150624047238, 'psi': 0.9969284321489783}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=82 head_norm_before_train=1.906485 cos_to_last_merge=0.8814 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=82 local utility u=0.000000 metrics={'f1_val': 0.6067581857570916, 'auprc': 0.9018221663530058, 'loss_val': 0.9957764173958271, 'psi': 0.7247837779954573}-{'f1_val': 0.8761424685883574, 'auprc': 0.9672205764975601, 'loss_val': 0.26966074086472447, 'psi': 0.9125737117520385}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=82 head_norm_before_train=1.943148 cos_to_last_merge=0.9758 (last merge round=17)
[S7] round=82 local utility u=0.000000 metrics={'f1_val': 0.6387165984066994, 'auprc': 0.7953435999203725, 'loss_val': 0.5053466016951964, 'psi': 0.7013673990121687}-{'f1_val': 0.6462930651634272, 'auprc': 0.7984421286832927, 'loss_val': 0.4499611608874009, 'psi': 0.7071526905713734}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=82 head_norm_before_train=1.963207 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=82 local utility u=0.000000 metrics={'f1_val': 0.9878661038880452, 'auprc': 0.9995724941996474, 'loss_val': 0.038210015582803666, 'psi': 0.9925486600126862}-{'f1_val': 0.9889384063943332, 'auprc': 0.9995726105418532, 'loss_val': 0.03696983841590483, 'psi': 0.9931920880533411}
[S9] START round=82 head_norm_before_train=2.118398 cos_to_last_merge=0.9653 (last merge round=13)
[S9] round=82 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9995894848391434, 'loss_val': 0.01742046829080473, 'psi': 0.9975810626210481}-{'f1_val': 0.9970714132027002, 'auprc': 0.9993790132927245, 'loss_val': 0.017494981975029914, 'psi': 0.9979944532387099}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=82 head_norm_before_train=1.790509 cos_to_last_merge=1.0000 (last merge round=80)
[S10] round=82 local utility u=0.000026 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9959539331678564, 'loss_val': 0.026546911189214675, 'psi': 0.9954942766787673}-{'f1_val': 0.9951878390193748, 'auprc': 0.995831176848661, 'loss_val': 0.026229886235133882, 'psi': 0.9954451741510892}
[S11] START round=82 head_norm_before_train=2.058011 cos_to_last_merge=1.0000 (last merge round=81)
[S11] round=82 local utility u=0.000000 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.99440321454457, 'loss_val': 0.020035492316190784, 'psi': 0.9955865179632786}-{'f1_val': 0.9967887165093644, 'auprc': 0.9961779571710632, 'loss_val': 0.019778832440202822, 'psi': 0.9965444127740439}
[S13] START round=82 head_norm_before_train=1.785862 cos_to_last_merge=1.0000 (last merge round=81)
[S13] round=82 local utility u=0.000000 metrics={'f1_val': 0.6464042210738377, 'auprc': 0.8232211020739728, 'loss_val': 1.068293279434472, 'psi': 0.7171309734738918}-{'f1_val': 0.7013424397314862, 'auprc': 0.8975148044817728, 'loss_val': 0.8455306947302847, 'psi': 0.7798113856316009}
[S14] START round=82 head_norm_before_train=1.964502 cos_to_last_merge=0.8333 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.833
[S14] round=82 local utility u=0.022732 metrics={'f1_val': 0.9965760575063591, 'auprc': 0.9987217723966587, 'loss_val': 0.027531176523047162, 'psi': 0.997434343462479}-{'f1_val': 0.9906128754008952, 'auprc': 0.9991137951942815, 'loss_val': 0.038392749892019594, 'psi': 0.9940132433182496}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1810 reason=None
[S14] sending update (kind=head size=1810 to 1 peers)
[S15] START round=82 head_norm_before_train=1.995034 cos_to_last_merge=0.9216 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.922
[S15] round=82 local utility u=0.000000 metrics={'f1_val': 0.803548141573443, 'auprc': 0.9701824834072409, 'loss_val': 0.44038443334501437, 'psi': 0.8702018783069622}-{'f1_val': 0.9357534448119964, 'auprc': 0.9963165552570872, 'loss_val': 0.08633374946433675, 'psi': 0.9599786889900328}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=82 head_norm_before_train=2.163576 (no previous merge yet)
[S16] round=82 local utility u=0.000000 metrics={'f1_val': 0.9947322856141653, 'auprc': 0.9891443473002932, 'loss_val': 0.02745740260034216, 'psi': 0.9924971102886164}-{'f1_val': 0.9952151837191423, 'auprc': 0.9896381771415459, 'loss_val': 0.027247969015828384, 'psi': 0.9929843810881038}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=82 head_norm_before_train=1.963207 cos_to_last_merge=1.0000 (last merge round=81)
[S17] round=82 local utility u=0.104900 metrics={'f1_val': 0.7837144101826035, 'auprc': 0.946474417658194, 'loss_val': 0.6101180706436837, 'psi': 0.8488184131728397}-{'f1_val': 0.7738009636493379, 'auprc': 0.9292755440320678, 'loss_val': 0.7088404519888407, 'psi': 0.8359907958024299}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S17] → sending delta(kind=head bytes=1800) to S8@127.0.0.1:54509
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1800 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1800) from S17
[S8] cosine check vs S17: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=82 metric=0.9952 head_norm=1.796295
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.260034e-02
[S10] stored merged vector for next round verification (round=82)
[S10] DEBUG after merge:  round=82 metric=0.9952 head_norm=1.789697 delta_norm=0.012600
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=83 head_norm_before_train=2.057508 cos_to_last_merge=1.0000 (last merge round=81)
[S2] round=83 local utility u=0.206129 metrics={'f1_val': 0.7650587724068216, 'auprc': 0.9863572510424141, 'loss_val': 0.3800958864199196, 'psi': 0.8535781638610587}-{'f1_val': 0.7097515052327249, 'auprc': 0.9911145024144639, 'loss_val': 0.47478275088706046, 'psi': 0.8222967041054206}
[S3] START round=83 head_norm_before_train=2.182522 cos_to_last_merge=0.8885 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.889
[S3] round=83 local utility u=0.101732 metrics={'f1_val': 0.9377945052025276, 'auprc': 0.9907263487916823, 'loss_val': 0.15341611322140242, 'psi': 0.9589672426381894}-{'f1_val': 0.9123528892193279, 'auprc': 0.9946127774868017, 'loss_val': 0.21588879079716705, 'psi': 0.9452568445263174}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=83 head_norm_before_train=1.893426 cos_to_last_merge=0.7829 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=83 local utility u=0.032871 metrics={'f1_val': 0.9465850544894567, 'auprc': 0.9619211350937683, 'loss_val': 0.3026041574488197, 'psi': 0.9527194867311813}-{'f1_val': 0.9419347503379262, 'auprc': 0.9579794929027396, 'loss_val': 0.32861878319880883, 'psi': 0.9483526473638515}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=83 head_norm_before_train=2.241406 (no previous merge yet)
[S5] round=83 local utility u=0.000269 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9972172683348408, 'loss_val': 0.025438212322453857, 'psi': 0.996598521319523}-{'f1_val': 0.996186023309311, 'auprc': 0.996729394574152, 'loss_val': 0.02451289723073676, 'psi': 0.9964033718152474}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S5] sending update (kind=head size=1795 to 1 peers)
[S6] START round=83 head_norm_before_train=1.907322 cos_to_last_merge=0.8807 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.881
[S6] round=83 local utility u=1.000000 metrics={'f1_val': 0.8748860497403258, 'auprc': 0.9810600607208848, 'loss_val': 0.2693191871613407, 'psi': 0.9173556541325494}-{'f1_val': 0.6067581857570916, 'auprc': 0.9018221663530058, 'loss_val': 0.9957764173958271, 'psi': 0.7247837779954573}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S6] sending update (kind=head size=1803 to 1 peers)
[S7] START round=83 head_norm_before_train=1.948977 cos_to_last_merge=0.9751 (last merge round=17)
[S7] round=83 local utility u=0.000000 metrics={'f1_val': 0.6054943233759997, 'auprc': 0.7854612185350757, 'loss_val': 0.6915976306097532, 'psi': 0.6774810814396302}-{'f1_val': 0.6387165984066994, 'auprc': 0.7953435999203725, 'loss_val': 0.5053466016951964, 'psi': 0.7013673990121687}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=83 head_norm_before_train=1.967817 cos_to_last_merge=1.0000 (last merge round=81)
[S8] round=83 local utility u=0.024064 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9996503730107962, 'loss_val': 0.02772007034645649, 'psi': 0.9963201574183975}-{'f1_val': 0.9878661038880452, 'auprc': 0.9995724941996474, 'loss_val': 0.038210015582803666, 'psi': 0.9925486600126862}
[S9] START round=83 head_norm_before_train=2.122540 cos_to_last_merge=0.9651 (last merge round=13)
[S9] round=83 local utility u=0.003770 metrics={'f1_val': 0.9971029125121428, 'auprc': 0.999760374819022, 'loss_val': 0.015557608075512944, 'psi': 0.9981658974348945}-{'f1_val': 0.9962421144756511, 'auprc': 0.9995894848391434, 'loss_val': 0.01742046829080473, 'psi': 0.9975810626210481}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S9] sending update (kind=head size=1794 to 1 peers)
[S10] START round=83 head_norm_before_train=1.789697 cos_to_last_merge=1.0000 (last merge round=82)
[S10] round=83 local utility u=0.000523 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9961664376191368, 'loss_val': 0.02613827583724124, 'psi': 0.9955792784592796}-{'f1_val': 0.9951878390193748, 'auprc': 0.9959539331678564, 'loss_val': 0.026546911189214675, 'psi': 0.9954942766787673}
[S11] START round=83 head_norm_before_train=2.062644 cos_to_last_merge=1.0000 (last merge round=81)
[S11] round=83 local utility u=0.000000 metrics={'f1_val': 0.9675319827871278, 'auprc': 0.9965074314102822, 'loss_val': 0.07551805826296575, 'psi': 0.9791221622363896}-{'f1_val': 0.9963753869090841, 'auprc': 0.99440321454457, 'loss_val': 0.020035492316190784, 'psi': 0.9955865179632786}
[S13] START round=83 head_norm_before_train=1.790411 cos_to_last_merge=1.0000 (last merge round=81)
[S13] round=83 local utility u=0.169827 metrics={'f1_val': 0.662556911327052, 'auprc': 0.9144272112056864, 'loss_val': 1.0991735423213476, 'psi': 0.7633050312785057}-{'f1_val': 0.6464042210738377, 'auprc': 0.8232211020739728, 'loss_val': 1.068293279434472, 'psi': 0.7171309734738918}
[S14] START round=83 head_norm_before_train=1.970479 cos_to_last_merge=0.8328 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.833
[S14] round=83 local utility u=0.000000 metrics={'f1_val': 0.9961605687915402, 'auprc': 0.9970330248771895, 'loss_val': 0.028956588783049592, 'psi': 0.9965095512258}-{'f1_val': 0.9965760575063591, 'auprc': 0.9987217723966587, 'loss_val': 0.027531176523047162, 'psi': 0.997434343462479}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=83 head_norm_before_train=2.001138 cos_to_last_merge=0.9211 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=83 local utility u=0.829843 metrics={'f1_val': 0.9967466683875206, 'auprc': 0.9973876005353985, 'loss_val': 0.02150417220677491, 'psi': 0.9970030412466717}-{'f1_val': 0.803548141573443, 'auprc': 0.9701824834072409, 'loss_val': 0.44038443334501437, 'psi': 0.8702018783069622}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S15] sending update (kind=head size=1801 to 1 peers)
[S16] START round=83 head_norm_before_train=2.166058 (no previous merge yet)
[S16] round=83 local utility u=0.000000 metrics={'f1_val': 0.9744696138658999, 'auprc': 0.9889557735818779, 'loss_val': 0.09440718147382211, 'psi': 0.9802640777522911}-{'f1_val': 0.9947322856141653, 'auprc': 0.9891443473002932, 'loss_val': 0.02745740260034216, 'psi': 0.9924971102886164}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=83 head_norm_before_train=1.975312 cos_to_last_merge=1.0000 (last merge round=81)
[S17] round=83 local utility u=0.000000 metrics={'f1_val': 0.7137909393121636, 'auprc': 0.910204032580773, 'loss_val': 0.8232466521811648, 'psi': 0.7923561766196074}-{'f1_val': 0.7837144101826035, 'auprc': 0.946474417658194, 'loss_val': 0.6101180706436837, 'psi': 0.8488184131728397}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:54517
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S8] sending update (kind=head size=1803 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=83 metric=0.9675 head_norm=2.068314
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.077186e-02
[S11] stored merged vector for next round verification (round=83)
[S11] DEBUG after merge:  round=83 metric=0.9660 head_norm=2.062890 delta_norm=0.010772
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=83 metric=0.9952 head_norm=1.795765
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.172102e-03
[S10] stored merged vector for next round verification (round=83)
[S10] DEBUG after merge:  round=83 metric=0.9952 head_norm=1.795630 delta_norm=0.007172
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=83 metric=0.6626 head_norm=1.795523
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.936730e-03
[S13] stored merged vector for next round verification (round=83)
[S13] DEBUG after merge:  round=83 metric=0.6630 head_norm=1.795752 delta_norm=0.008937
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=83 metric=0.9941 head_norm=1.972278
[S8] _apply_head_vector_avg (torch): Δ‖w‖=9.453335e-03
[S8] stored merged vector for next round verification (round=83)
[S8] DEBUG after merge:  round=83 metric=0.9941 head_norm=1.973773 delta_norm=0.009453
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=84 head_norm_before_train=2.060430 cos_to_last_merge=1.0000 (last merge round=81)
[S2] round=84 local utility u=0.000000 metrics={'f1_val': 0.7081045469556875, 'auprc': 0.9487788350457229, 'loss_val': 0.45300917801843865, 'psi': 0.8043742621917016}-{'f1_val': 0.7650587724068216, 'auprc': 0.9863572510424141, 'loss_val': 0.3800958864199196, 'psi': 0.8535781638610587}
[S3] START round=84 head_norm_before_train=2.188323 cos_to_last_merge=0.8881 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=84 local utility u=0.059350 metrics={'f1_val': 0.9611152572344858, 'auprc': 0.9950875231333254, 'loss_val': 0.18772439283697814, 'psi': 0.9747041635940217}-{'f1_val': 0.9377945052025276, 'auprc': 0.9907263487916823, 'loss_val': 0.15341611322140242, 'psi': 0.9589672426381894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S3] sending update (kind=head size=1795 to 1 peers)
[S4] START round=84 head_norm_before_train=1.896085 cos_to_last_merge=0.7825 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.783
[S4] round=84 local utility u=0.000000 metrics={'f1_val': 0.9466300174181353, 'auprc': 0.9600215746330196, 'loss_val': 0.2987841444478134, 'psi': 0.9519866403040891}-{'f1_val': 0.9465850544894567, 'auprc': 0.9619211350937683, 'loss_val': 0.3026041574488197, 'psi': 0.9527194867311813}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=84 head_norm_before_train=2.242038 (no previous merge yet)
[S5] round=84 local utility u=0.000243 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9965154137726411, 'loss_val': 0.02460824890702268, 'psi': 0.9964938536806945}-{'f1_val': 0.996186023309311, 'auprc': 0.9972172683348408, 'loss_val': 0.025438212322453857, 'psi': 0.996598521319523}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S5] sending update (kind=head size=1798 to 1 peers)
[S6] START round=84 head_norm_before_train=1.910203 cos_to_last_merge=0.8804 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=84 local utility u=0.000000 metrics={'f1_val': 0.704587247761292, 'auprc': 0.9570423156947412, 'loss_val': 0.5765250353285112, 'psi': 0.8055692749346717}-{'f1_val': 0.8748860497403258, 'auprc': 0.9810600607208848, 'loss_val': 0.2693191871613407, 'psi': 0.9173556541325494}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=84 head_norm_before_train=1.954234 cos_to_last_merge=0.9745 (last merge round=17)
[S7] round=84 local utility u=0.837802 metrics={'f1_val': 0.8232031043367554, 'auprc': 0.8130986391999071, 'loss_val': 0.4051577117803534, 'psi': 0.8191613182820161}-{'f1_val': 0.6054943233759997, 'auprc': 0.7854612185350757, 'loss_val': 0.6915976306097532, 'psi': 0.6774810814396302}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S7] sending update (kind=head size=1798 to 1 peers)
[S8] START round=84 head_norm_before_train=1.973773 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=84 local utility u=0.000000 metrics={'f1_val': 0.9944672019690619, 'auprc': 0.9975216150134254, 'loss_val': 0.029490684294854547, 'psi': 0.9956889671868072}-{'f1_val': 0.9941000136901317, 'auprc': 0.9996503730107962, 'loss_val': 0.02772007034645649, 'psi': 0.9963201574183975}
[S9] START round=84 head_norm_before_train=2.131608 cos_to_last_merge=0.9653 (last merge round=13)
[S9] round=84 local utility u=0.001405 metrics={'f1_val': 0.9975138174234109, 'auprc': 0.9997251972822407, 'loss_val': 0.015108426003711492, 'psi': 0.9983983693669428}-{'f1_val': 0.9971029125121428, 'auprc': 0.999760374819022, 'loss_val': 0.015557608075512944, 'psi': 0.9981658974348945}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=84 head_norm_before_train=1.795630 cos_to_last_merge=1.0000 (last merge round=83)
[S10] round=84 local utility u=0.000419 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963289248263991, 'loss_val': 0.025787031902775693, 'psi': 0.9956442733421844}-{'f1_val': 0.9951878390193748, 'auprc': 0.9961664376191368, 'loss_val': 0.02613827583724124, 'psi': 0.9955792784592796}
[S11] START round=84 head_norm_before_train=2.062890 cos_to_last_merge=1.0000 (last merge round=83)
[S11] round=84 local utility u=0.000000 metrics={'f1_val': 0.8166622777335891, 'auprc': 0.9945036222122441, 'loss_val': 0.38218082922340446, 'psi': 0.8877988155250511}-{'f1_val': 0.9675319827871278, 'auprc': 0.9965074314102822, 'loss_val': 0.07551805826296575, 'psi': 0.9791221622363896}
[S13] START round=84 head_norm_before_train=1.795752 cos_to_last_merge=1.0000 (last merge round=83)
[S13] round=84 local utility u=0.000000 metrics={'f1_val': 0.6327996263467175, 'auprc': 0.7633587148361756, 'loss_val': 1.1265718903932833, 'psi': 0.6850232617425007}-{'f1_val': 0.662556911327052, 'auprc': 0.9144272112056864, 'loss_val': 1.0991735423213476, 'psi': 0.7633050312785057}
[S14] START round=84 head_norm_before_train=1.977942 cos_to_last_merge=0.8323 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=84 local utility u=0.000000 metrics={'f1_val': 0.9392656017725152, 'auprc': 0.9988694266796738, 'loss_val': 0.13584773612139336, 'psi': 0.9631071317353787}-{'f1_val': 0.9961605687915402, 'auprc': 0.9970330248771895, 'loss_val': 0.028956588783049592, 'psi': 0.9965095512258}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=84 head_norm_before_train=2.006831 cos_to_last_merge=0.9205 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.921
[S15] round=84 local utility u=0.000000 metrics={'f1_val': 0.9567050645070998, 'auprc': 0.9960351130532591, 'loss_val': 0.06990027550345142, 'psi': 0.9724370839255635}-{'f1_val': 0.9967466683875206, 'auprc': 0.9973876005353985, 'loss_val': 0.02150417220677491, 'psi': 0.9970030412466717}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=84 head_norm_before_train=2.168905 (no previous merge yet)
[S16] round=84 local utility u=0.098901 metrics={'f1_val': 0.9943126892134037, 'auprc': 0.9927428702716887, 'loss_val': 0.027025289057904356, 'psi': 0.9936847616367177}-{'f1_val': 0.9744696138658999, 'auprc': 0.9889557735818779, 'loss_val': 0.09440718147382211, 'psi': 0.9802640777522911}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=84 head_norm_before_train=1.984644 cos_to_last_merge=0.9999 (last merge round=81)
[S17] round=84 local utility u=0.310067 metrics={'f1_val': 0.7612311071678413, 'auprc': 0.9370927502329363, 'loss_val': 0.5684205487022228, 'psi': 0.8315757643938793}-{'f1_val': 0.7137909393121636, 'auprc': 0.910204032580773, 'loss_val': 0.8232466521811648, 'psi': 0.7923561766196074}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S10] → sending delta(kind=head bytes=1799) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] sending update (kind=head size=1801 to 1 peers)
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=84 metric=0.8167 head_norm=2.069154
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.022370e-02
[S11] stored merged vector for next round verification (round=84)
[S11] DEBUG after merge:  round=84 metric=0.8167 head_norm=2.064771 delta_norm=0.010224
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1799 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1799) from S10
[S13] cosine check vs S10: cos=1.0000
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=84 metric=0.7612 head_norm=1.990994
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.832452e-02
[S17] stored merged vector for next round verification (round=84)
[S17] DEBUG after merge:  round=84 metric=0.7611 head_norm=1.981573 delta_norm=0.018325
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] START round=85 head_norm_before_train=2.062852 cos_to_last_merge=0.9999 (last merge round=81)
[S2] round=85 local utility u=0.000000 metrics={'f1_val': 0.6617547555693631, 'auprc': 0.7868478814266429, 'loss_val': 1.2602533667568294, 'psi': 0.7117920059122751}-{'f1_val': 0.7081045469556875, 'auprc': 0.9487788350457229, 'loss_val': 0.45300917801843865, 'psi': 0.8043742621917016}
[S3] START round=85 head_norm_before_train=2.193599 cos_to_last_merge=0.8877 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=85 local utility u=0.000000 metrics={'f1_val': 0.6993897664435155, 'auprc': 0.9798199238101959, 'loss_val': 0.9329938149241521, 'psi': 0.8115618293901876}-{'f1_val': 0.9611152572344858, 'auprc': 0.9950875231333254, 'loss_val': 0.18772439283697814, 'psi': 0.9747041635940217}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=85 head_norm_before_train=1.901780 cos_to_last_merge=0.7819 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=85 local utility u=0.000000 metrics={'f1_val': 0.942906438214126, 'auprc': 0.9605932636319634, 'loss_val': 0.30245470284234277, 'psi': 0.9499811683812609}-{'f1_val': 0.9466300174181353, 'auprc': 0.9600215746330196, 'loss_val': 0.2987841444478134, 'psi': 0.9519866403040891}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=85 head_norm_before_train=2.249728 (no previous merge yet)
[S5] round=85 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9920824115179676, 'loss_val': 0.02432642657607742, 'psi': 0.9945445785927737}-{'f1_val': 0.9964794802860635, 'auprc': 0.9965154137726411, 'loss_val': 0.02460824890702268, 'psi': 0.9964938536806945}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=85 head_norm_before_train=1.914401 cos_to_last_merge=0.8797 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.880
[S6] round=85 local utility u=0.000000 metrics={'f1_val': 0.6196481051690232, 'auprc': 0.9455223839850065, 'loss_val': 0.816714667877416, 'psi': 0.7499978166954167}-{'f1_val': 0.704587247761292, 'auprc': 0.9570423156947412, 'loss_val': 0.5765250353285112, 'psi': 0.8055692749346717}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=85 head_norm_before_train=1.960230 cos_to_last_merge=0.9745 (last merge round=17)
[S7] round=85 local utility u=0.000000 metrics={'f1_val': 0.6617940313076236, 'auprc': 0.8070056844603212, 'loss_val': 0.4673476802586358, 'psi': 0.7198786925687026}-{'f1_val': 0.8232031043367554, 'auprc': 0.8130986391999071, 'loss_val': 0.4051577117803534, 'psi': 0.8191613182820161}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=85 head_norm_before_train=1.978843 cos_to_last_merge=1.0000 (last merge round=83)
[S8] round=85 local utility u=0.000000 metrics={'f1_val': 0.9731630909905401, 'auprc': 0.9995313749632093, 'loss_val': 0.06980968596981037, 'psi': 0.9837104045796079}-{'f1_val': 0.9944672019690619, 'auprc': 0.9975216150134254, 'loss_val': 0.029490684294854547, 'psi': 0.9956889671868072}
[S9] START round=85 head_norm_before_train=2.141544 cos_to_last_merge=0.9653 (last merge round=13)
[S9] round=85 local utility u=0.000000 metrics={'f1_val': 0.9960207019771873, 'auprc': 0.9996742118581057, 'loss_val': 0.017480422373960077, 'psi': 0.9974821059295547}-{'f1_val': 0.9975138174234109, 'auprc': 0.9997251972822407, 'loss_val': 0.015108426003711492, 'psi': 0.9983983693669428}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=85 head_norm_before_train=1.802506 cos_to_last_merge=1.0000 (last merge round=83)
[S10] round=85 local utility u=0.000009 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962958476794213, 'loss_val': 0.025668832504521573, 'psi': 0.9956310424833934}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963289248263991, 'loss_val': 0.025787031902775693, 'psi': 0.9956442733421844}
[S11] START round=85 head_norm_before_train=2.064771 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=85 local utility u=0.721181 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9968921269954873, 'loss_val': 0.025386419552827798, 'psi': 0.9965943631166614}-{'f1_val': 0.8166622777335891, 'auprc': 0.9945036222122441, 'loss_val': 0.38218082922340446, 'psi': 0.8877988155250511}
[S13] START round=85 head_norm_before_train=1.799717 cos_to_last_merge=1.0000 (last merge round=83)
[S13] round=85 local utility u=0.693588 metrics={'f1_val': 0.7667855334240676, 'auprc': 0.8668081578255389, 'loss_val': 0.8536602601369465, 'psi': 0.8067945831846561}-{'f1_val': 0.6327996263467175, 'auprc': 0.7633587148361756, 'loss_val': 1.1265718903932833, 'psi': 0.6850232617425007}
[S14] START round=85 head_norm_before_train=1.981900 cos_to_last_merge=0.8320 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=85 local utility u=0.050762 metrics={'f1_val': 0.94654382827212, 'auprc': 0.9982287944302239, 'loss_val': 0.0760706735820488, 'psi': 0.9672178147353616}-{'f1_val': 0.9392656017725152, 'auprc': 0.9988694266796738, 'loss_val': 0.13584773612139336, 'psi': 0.9631071317353787}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S14] sending update (kind=head size=1805 to 1 peers)
[S15] START round=85 head_norm_before_train=2.012135 cos_to_last_merge=0.9201 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=85 local utility u=0.000000 metrics={'f1_val': 0.7485854476083451, 'auprc': 0.8621847922853926, 'loss_val': 0.5784741331947727, 'psi': 0.794025185479164}-{'f1_val': 0.9567050645070998, 'auprc': 0.9960351130532591, 'loss_val': 0.06990027550345142, 'psi': 0.9724370839255635}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=85 head_norm_before_train=2.174203 (no previous merge yet)
[S16] round=85 local utility u=0.000250 metrics={'f1_val': 0.9938721264633489, 'auprc': 0.9946247943295464, 'loss_val': 0.02952694664282644, 'psi': 0.9941731936098279}-{'f1_val': 0.9943126892134037, 'auprc': 0.9927428702716887, 'loss_val': 0.027025289057904356, 'psi': 0.9936847616367177}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=85 head_norm_before_train=1.981573 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=85 local utility u=0.205669 metrics={'f1_val': 0.82137974407958, 'auprc': 0.9484090792184208, 'loss_val': 0.5519233759059511, 'psi': 0.8721914781351163}-{'f1_val': 0.7612311071678413, 'auprc': 0.9370927502329363, 'loss_val': 0.5684205487022228, 'psi': 0.8315757643938793}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S11] → sending delta(kind=head bytes=1796) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S10] → sending delta(kind=head bytes=1804) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S17] → sending delta(kind=head bytes=1798) to S8@127.0.0.1:54509
[S13] sending update (kind=head size=1802 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=85 metric=0.9732 head_norm=1.985366
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.321642e-02
[S8] stored merged vector for next round verification (round=85)
[S8] DEBUG after merge:  round=85 metric=0.9728 head_norm=1.988138 delta_norm=0.013216
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S8] ⇄ pheromone p=0.077 → S17@127.0.0.1:54517
[S11] sending update (kind=head size=1796 to 1 peers)
[S2] ⇄ pheromone p=0.145 → S11@127.0.0.1:54512
[S17] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1804 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1798) from S17
[S8] cosine check vs S17: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1804) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1796) from S11
[S2] cosine check vs S11: cos=1.0000
[S17] ⇄ pheromone p=0.190 → S8@127.0.0.1:54509
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=85 metric=0.7668 head_norm=1.804100
[S13] _apply_head_vector_avg (torch): Δ‖w‖=5.385219e-03
[S13] stored merged vector for next round verification (round=85)
[S13] DEBUG after merge:  round=85 metric=0.7668 head_norm=1.804860 delta_norm=0.005385
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.264 → S10@127.0.0.1:54511
[S11] ⇄ pheromone p=0.162 → S2@127.0.0.1:54502
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=85 metric=0.9952 head_norm=1.808769
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.684545e-03
[S10] stored merged vector for next round verification (round=85)
[S10] DEBUG after merge:  round=85 metric=0.9952 head_norm=1.806424 delta_norm=0.006685
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S2] START round=86 head_norm_before_train=2.064616 cos_to_last_merge=0.9999 (last merge round=81)
[S2] round=86 local utility u=0.284808 metrics={'f1_val': 0.6703357746464682, 'auprc': 0.8114151601899143, 'loss_val': 0.8158260610224631, 'psi': 0.7267675288638467}-{'f1_val': 0.6617547555693631, 'auprc': 0.7868478814266429, 'loss_val': 1.2602533667568294, 'psi': 0.7117920059122751}
[S3] START round=86 head_norm_before_train=2.191368 cos_to_last_merge=0.8879 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=86 local utility u=0.287215 metrics={'f1_val': 0.7466567417773038, 'auprc': 0.9962662304447156, 'loss_val': 0.6915046268069583, 'psi': 0.8465005372442684}-{'f1_val': 0.6993897664435155, 'auprc': 0.9798199238101959, 'loss_val': 0.9329938149241521, 'psi': 0.8115618293901876}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=86 head_norm_before_train=1.909254 cos_to_last_merge=0.7811 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=86 local utility u=0.000000 metrics={'f1_val': 0.9406853972727668, 'auprc': 0.9543482427291591, 'loss_val': 0.30923816997992937, 'psi': 0.9461505354553237}-{'f1_val': 0.942906438214126, 'auprc': 0.9605932636319634, 'loss_val': 0.30245470284234277, 'psi': 0.9499811683812609}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=86 head_norm_before_train=2.257678 (no previous merge yet)
[S5] round=86 local utility u=0.010437 metrics={'f1_val': 0.9964794802860635, 'auprc': 0.9982756943879785, 'loss_val': 0.0237932427489894, 'psi': 0.9971979659268295}-{'f1_val': 0.996186023309311, 'auprc': 0.9920824115179676, 'loss_val': 0.02432642657607742, 'psi': 0.9945445785927737}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S5] sending update (kind=head size=1794 to 1 peers)
[S6] START round=86 head_norm_before_train=1.918303 cos_to_last_merge=0.8788 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=86 local utility u=0.998095 metrics={'f1_val': 0.866722183551989, 'auprc': 0.9649122188151852, 'loss_val': 0.3611395825191322, 'psi': 0.9059981976572675}-{'f1_val': 0.6196481051690232, 'auprc': 0.9455223839850065, 'loss_val': 0.816714667877416, 'psi': 0.7499978166954167}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S6] sending update (kind=head size=1795 to 1 peers)
[S7] START round=86 head_norm_before_train=1.964747 cos_to_last_merge=0.9744 (last merge round=17)
[S7] round=86 local utility u=0.000000 metrics={'f1_val': 0.598028656372394, 'auprc': 0.7854721231055447, 'loss_val': 0.6734638764586875, 'psi': 0.6730060430656544}-{'f1_val': 0.6617940313076236, 'auprc': 0.8070056844603212, 'loss_val': 0.4673476802586358, 'psi': 0.7198786925687026}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=86 head_norm_before_train=1.988138 cos_to_last_merge=1.0000 (last merge round=85)
[S8] round=86 local utility u=0.000000 metrics={'f1_val': 0.8877969274736833, 'auprc': 0.9994059539272891, 'loss_val': 0.22385226735730954, 'psi': 0.9324405380551257}-{'f1_val': 0.9731630909905401, 'auprc': 0.9995313749632093, 'loss_val': 0.06980968596981037, 'psi': 0.9837104045796079}
[S9] START round=86 head_norm_before_train=2.147621 cos_to_last_merge=0.9653 (last merge round=13)
[S9] round=86 local utility u=0.004276 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9997125494917545, 'loss_val': 0.015346836884302235, 'psi': 0.9981278677183218}-{'f1_val': 0.9960207019771873, 'auprc': 0.9996742118581057, 'loss_val': 0.017480422373960077, 'psi': 0.9974821059295547}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S9] sending update (kind=head size=1798 to 1 peers)
[S10] START round=86 head_norm_before_train=1.806424 cos_to_last_merge=1.0000 (last merge round=85)
[S10] round=86 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9962684355883964, 'loss_val': 0.02573251663455987, 'psi': 0.9956200776469835}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962958476794213, 'loss_val': 0.025668832504521573, 'psi': 0.9956310424833934}
[S11] START round=86 head_norm_before_train=2.070384 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=86 local utility u=0.000000 metrics={'f1_val': 0.8712226920451602, 'auprc': 0.9966786161630675, 'loss_val': 0.15003406303119515, 'psi': 0.9214050616923232}-{'f1_val': 0.9963958538641108, 'auprc': 0.9968921269954873, 'loss_val': 0.025386419552827798, 'psi': 0.9965943631166614}
[S13] START round=86 head_norm_before_train=1.804860 cos_to_last_merge=1.0000 (last merge round=85)
[S13] round=86 local utility u=0.000000 metrics={'f1_val': 0.6654306279951578, 'auprc': 0.8713317318402388, 'loss_val': 1.2465055773769702, 'psi': 0.7477910695331902}-{'f1_val': 0.7667855334240676, 'auprc': 0.8668081578255389, 'loss_val': 0.8536602601369465, 'psi': 0.8067945831846561}
[S14] START round=86 head_norm_before_train=1.986917 cos_to_last_merge=0.8317 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.832
[S14] round=86 local utility u=0.066259 metrics={'f1_val': 0.9647581046448663, 'auprc': 0.9969852478329193, 'loss_val': 0.04910802898173364, 'psi': 0.9776489619200875}-{'f1_val': 0.94654382827212, 'auprc': 0.9982287944302239, 'loss_val': 0.0760706735820488, 'psi': 0.9672178147353616}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S14] sending update (kind=head size=1804 to 1 peers)
[S15] START round=86 head_norm_before_train=2.017964 cos_to_last_merge=0.9196 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.920
[S15] round=86 local utility u=0.426395 metrics={'f1_val': 0.8120836885686257, 'auprc': 0.9701468681303007, 'loss_val': 0.4305599140598818, 'psi': 0.8753089603932958}-{'f1_val': 0.7485854476083451, 'auprc': 0.8621847922853926, 'loss_val': 0.5784741331947727, 'psi': 0.794025185479164}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S15] sending update (kind=head size=1795 to 1 peers)
[S16] START round=86 head_norm_before_train=2.179823 (no previous merge yet)
[S16] round=86 local utility u=0.000000 metrics={'f1_val': 0.9890817411100122, 'auprc': 0.9893206725371162, 'loss_val': 0.05416567245617679, 'psi': 0.9891773136808538}-{'f1_val': 0.9938721264633489, 'auprc': 0.9946247943295464, 'loss_val': 0.02952694664282644, 'psi': 0.9941731936098279}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=86 head_norm_before_train=1.990148 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=86 local utility u=0.000000 metrics={'f1_val': 0.7503449191064837, 'auprc': 0.9232906507516873, 'loss_val': 0.7361645688402193, 'psi': 0.8195232117645652}-{'f1_val': 0.82137974407958, 'auprc': 0.9484090792184208, 'loss_val': 0.5519233759059511, 'psi': 0.8721914781351163}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=86 metric=0.8878 head_norm=1.995311
[S8] _apply_head_vector_avg (torch): Δ‖w‖=5.763579e-03
[S8] stored merged vector for next round verification (round=86)
[S8] DEBUG after merge:  round=86 metric=0.8878 head_norm=1.992723 delta_norm=0.005764
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=86 metric=0.6703 head_norm=2.067522
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.063343e-02
[S2] stored merged vector for next round verification (round=86)
[S2] DEBUG after merge:  round=86 metric=0.6697 head_norm=2.068926 delta_norm=0.010633
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=87 head_norm_before_train=2.068926 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=87 local utility u=0.395982 metrics={'f1_val': 0.7081190959357051, 'auprc': 0.8899144767317164, 'loss_val': 0.48606033451448766, 'psi': 0.7808372482541096}-{'f1_val': 0.6703357746464682, 'auprc': 0.8114151601899143, 'loss_val': 0.8158260610224631, 'psi': 0.7267675288638467}
[S3] START round=87 head_norm_before_train=2.195178 cos_to_last_merge=0.8876 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=87 local utility u=0.487274 metrics={'f1_val': 0.8533398844819365, 'auprc': 0.9965772124099731, 'loss_val': 0.35798754501653984, 'psi': 0.9106348156531512}-{'f1_val': 0.7466567417773038, 'auprc': 0.9962662304447156, 'loss_val': 0.6915046268069583, 'psi': 0.8465005372442684}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S3] sending update (kind=head size=1797 to 1 peers)
[S4] START round=87 head_norm_before_train=1.913412 cos_to_last_merge=0.7810 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=87 local utility u=0.005915 metrics={'f1_val': 0.9451089985797889, 'auprc': 0.9481739612683089, 'loss_val': 0.3054270462103536, 'psi': 0.9463349836551969}-{'f1_val': 0.9406853972727668, 'auprc': 0.9543482427291591, 'loss_val': 0.30923816997992937, 'psi': 0.9461505354553237}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=87 head_norm_before_train=2.260930 (no previous merge yet)
[S5] round=87 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9980999002654942, 'loss_val': 0.024855469928997006, 'psi': 0.9969515740917843}-{'f1_val': 0.9964794802860635, 'auprc': 0.9982756943879785, 'loss_val': 0.0237932427489894, 'psi': 0.9971979659268295}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=87 head_norm_before_train=1.924341 cos_to_last_merge=0.8786 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.879
[S6] round=87 local utility u=0.000000 metrics={'f1_val': 0.6002517087828722, 'auprc': 0.8527188458748323, 'loss_val': 1.0867550022982402, 'psi': 0.7012385636196562}-{'f1_val': 0.866722183551989, 'auprc': 0.9649122188151852, 'loss_val': 0.3611395825191322, 'psi': 0.9059981976572675}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=87 head_norm_before_train=1.968438 cos_to_last_merge=0.9740 (last merge round=17)
[S7] round=87 local utility u=0.000000 metrics={'f1_val': 0.5598686657215592, 'auprc': 0.7769708475135866, 'loss_val': 0.7264766475354074, 'psi': 0.6467095384383702}-{'f1_val': 0.598028656372394, 'auprc': 0.7854721231055447, 'loss_val': 0.6734638764586875, 'psi': 0.6730060430656544}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=87 head_norm_before_train=1.992723 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=87 local utility u=0.000000 metrics={'f1_val': 0.8844254440111199, 'auprc': 0.9993133681389563, 'loss_val': 0.23761483721723772, 'psi': 0.9303806136622546}-{'f1_val': 0.8877969274736833, 'auprc': 0.9994059539272891, 'loss_val': 0.22385226735730954, 'psi': 0.9324405380551257}
[S9] START round=87 head_norm_before_train=2.153638 cos_to_last_merge=0.9652 (last merge round=13)
[S9] round=87 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9994276993572961, 'loss_val': 0.01628393542494801, 'psi': 0.9980139276645386}-{'f1_val': 0.9970714132027002, 'auprc': 0.9997125494917545, 'loss_val': 0.015346836884302235, 'psi': 0.9981278677183218}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=87 head_norm_before_train=1.811678 cos_to_last_merge=1.0000 (last merge round=85)
[S10] round=87 local utility u=0.000499 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9967331418662981, 'loss_val': 0.02612857093818703, 'psi': 0.9958059601581442}-{'f1_val': 0.9951878390193748, 'auprc': 0.9962684355883964, 'loss_val': 0.02573251663455987, 'psi': 0.9956200776469835}
[S11] START round=87 head_norm_before_train=2.074890 cos_to_last_merge=1.0000 (last merge round=84)
[S11] round=87 local utility u=0.000000 metrics={'f1_val': 0.8650014784227554, 'auprc': 0.996623379873498, 'loss_val': 0.16266439179847117, 'psi': 0.9176502390030524}-{'f1_val': 0.8712226920451602, 'auprc': 0.9966786161630675, 'loss_val': 0.15003406303119515, 'psi': 0.9214050616923232}
[S13] START round=87 head_norm_before_train=1.809838 cos_to_last_merge=1.0000 (last merge round=85)
[S13] round=87 local utility u=0.349843 metrics={'f1_val': 0.7453145841664581, 'auprc': 0.8698657322417509, 'loss_val': 1.021725594535327, 'psi': 0.7951350433965753}-{'f1_val': 0.6654306279951578, 'auprc': 0.8713317318402388, 'loss_val': 1.2465055773769702, 'psi': 0.7477910695331902}
[S14] START round=87 head_norm_before_train=1.992462 cos_to_last_merge=0.8313 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=87 local utility u=0.112874 metrics={'f1_val': 0.9975765414632514, 'auprc': 0.997025201532711, 'loss_val': 0.020390289300492095, 'psi': 0.9973560054910352}-{'f1_val': 0.9647581046448663, 'auprc': 0.9969852478329193, 'loss_val': 0.04910802898173364, 'psi': 0.9776489619200875}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=87 head_norm_before_train=2.023722 cos_to_last_merge=0.9191 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=87 local utility u=0.566617 metrics={'f1_val': 0.9337231388858398, 'auprc': 0.9960384169531864, 'loss_val': 0.10483685132990743, 'psi': 0.9586492501127784}-{'f1_val': 0.8120836885686257, 'auprc': 0.9701468681303007, 'loss_val': 0.4305599140598818, 'psi': 0.8753089603932958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=87 head_norm_before_train=2.183034 (no previous merge yet)
[S16] round=87 local utility u=0.030576 metrics={'f1_val': 0.9943126892134037, 'auprc': 0.9912308718683956, 'loss_val': 0.030129287669152422, 'psi': 0.9930799622754004}-{'f1_val': 0.9890817411100122, 'auprc': 0.9893206725371162, 'loss_val': 0.05416567245617679, 'psi': 0.9891773136808538}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S16] sending update (kind=head size=1800 to 1 peers)
[S17] START round=87 head_norm_before_train=1.999140 cos_to_last_merge=1.0000 (last merge round=84)
[S17] round=87 local utility u=0.000000 metrics={'f1_val': 0.6911038800780036, 'auprc': 0.8936118062415003, 'loss_val': 0.9692194949596054, 'psi': 0.7721070505434022}-{'f1_val': 0.7503449191064837, 'auprc': 0.9232906507516873, 'loss_val': 0.7361645688402193, 'psi': 0.8195232117645652}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S13] → sending delta(kind=head bytes=1798) to S10@127.0.0.1:54511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S10] → sending delta(kind=head bytes=1795) to S13@127.0.0.1:54513
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=87 metric=0.8650 head_norm=2.080887
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.523548e-02
[S11] stored merged vector for next round verification (round=87)
[S11] DEBUG after merge:  round=87 metric=0.8643 head_norm=2.074159 delta_norm=0.015235
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1798 to 1 peers)
[S10] sending update (kind=head size=1795 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1798) from S13
[S10] cosine check vs S13: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1795) from S10
[S13] cosine check vs S10: cos=0.9999
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=87 metric=0.7453 head_norm=1.815402
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.088253e-02
[S13] stored merged vector for next round verification (round=87)
[S13] DEBUG after merge:  round=87 metric=0.7453 head_norm=1.816705 delta_norm=0.010883
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=87 metric=0.9952 head_norm=1.818073
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.088253e-02
[S10] stored merged vector for next round verification (round=87)
[S10] DEBUG after merge:  round=87 metric=0.9952 head_norm=1.816705 delta_norm=0.010883
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=88 head_norm_before_train=2.072642 cos_to_last_merge=1.0000 (last merge round=86)
[S2] round=88 local utility u=0.134131 metrics={'f1_val': 0.7098509592732637, 'auprc': 0.965148147312682, 'loss_val': 0.4538908852295092, 'psi': 0.811969834489031}-{'f1_val': 0.7081190959357051, 'auprc': 0.8899144767317164, 'loss_val': 0.48606033451448766, 'psi': 0.7808372482541096}
[S3] START round=88 head_norm_before_train=2.199242 cos_to_last_merge=0.8874 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=88 local utility u=0.000000 metrics={'f1_val': 0.8199756680895747, 'auprc': 0.9903505822226631, 'loss_val': 0.4311828672469878, 'psi': 0.8881256337428101}-{'f1_val': 0.8533398844819365, 'auprc': 0.9965772124099731, 'loss_val': 0.35798754501653984, 'psi': 0.9106348156531512}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=88 head_norm_before_train=1.914937 cos_to_last_merge=0.7812 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=88 local utility u=0.016468 metrics={'f1_val': 0.9464510027237555, 'auprc': 0.9591486775125713, 'loss_val': 0.3134680144384117, 'psi': 0.9515300726392818}-{'f1_val': 0.9451089985797889, 'auprc': 0.9481739612683089, 'loss_val': 0.3054270462103536, 'psi': 0.9463349836551969}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S4] sending update (kind=head size=1803 to 1 peers)
[S5] START round=88 head_norm_before_train=2.262329 (no previous merge yet)
[S5] round=88 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9971367705036673, 'loss_val': 0.025900058617612513, 'psi': 0.9965663221870535}-{'f1_val': 0.996186023309311, 'auprc': 0.9980999002654942, 'loss_val': 0.024855469928997006, 'psi': 0.9969515740917843}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=88 head_norm_before_train=1.931043 cos_to_last_merge=0.8782 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=88 local utility u=1.000000 metrics={'f1_val': 0.8350207396219342, 'auprc': 0.9666343238919, 'loss_val': 0.36058910004779704, 'psi': 0.8876661733299206}-{'f1_val': 0.6002517087828722, 'auprc': 0.8527188458748323, 'loss_val': 1.0867550022982402, 'psi': 0.7012385636196562}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S6] sending update (kind=head size=1802 to 1 peers)
[S7] START round=88 head_norm_before_train=1.973523 cos_to_last_merge=0.9734 (last merge round=17)
[S7] round=88 local utility u=0.000000 metrics={'f1_val': 0.5655628782586867, 'auprc': 0.6502893013791716, 'loss_val': 1.2413669692416345, 'psi': 0.5994534475068807}-{'f1_val': 0.5598686657215592, 'auprc': 0.7769708475135866, 'loss_val': 0.7264766475354074, 'psi': 0.6467095384383702}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=88 head_norm_before_train=2.000945 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=88 local utility u=0.416803 metrics={'f1_val': 0.9892968853633592, 'auprc': 0.9993939664065029, 'loss_val': 0.033479401037295534, 'psi': 0.9933357177806167}-{'f1_val': 0.8844254440111199, 'auprc': 0.9993133681389563, 'loss_val': 0.23761483721723772, 'psi': 0.9303806136622546}
[S9] START round=88 head_norm_before_train=2.160739 cos_to_last_merge=0.9651 (last merge round=13)
[S9] round=88 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9994181026238649, 'loss_val': 0.016290209952976763, 'psi': 0.998010088971166}-{'f1_val': 0.9970714132027002, 'auprc': 0.9994276993572961, 'loss_val': 0.01628393542494801, 'psi': 0.9980139276645386}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=88 head_norm_before_train=1.816705 cos_to_last_merge=1.0000 (last merge round=87)
[S10] round=88 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965028526729447, 'loss_val': 0.025651514133722075, 'psi': 0.9957138444808027}-{'f1_val': 0.9951878390193748, 'auprc': 0.9967331418662981, 'loss_val': 0.02612857093818703, 'psi': 0.9958059601581442}
[S11] START round=88 head_norm_before_train=2.074159 cos_to_last_merge=1.0000 (last merge round=87)
[S11] round=88 local utility u=0.303491 metrics={'f1_val': 0.9528512524948493, 'auprc': 0.9967056717249678, 'loss_val': 0.0830279580081853, 'psi': 0.9703930201868967}-{'f1_val': 0.8650014784227554, 'auprc': 0.996623379873498, 'loss_val': 0.16266439179847117, 'psi': 0.9176502390030524}
[S13] START round=88 head_norm_before_train=1.816705 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=88 local utility u=0.233314 metrics={'f1_val': 0.7755708647986304, 'auprc': 0.8515966080812014, 'loss_val': 0.6818288840993547, 'psi': 0.8059811621116588}-{'f1_val': 0.7453145841664581, 'auprc': 0.8698657322417509, 'loss_val': 1.021725594535327, 'psi': 0.7951350433965753}
[S14] START round=88 head_norm_before_train=1.996661 cos_to_last_merge=0.8310 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=88 local utility u=0.003855 metrics={'f1_val': 0.9974109942678281, 'auprc': 0.9991836914309344, 'loss_val': 0.018161805632823165, 'psi': 0.9981200731330706}-{'f1_val': 0.9975765414632514, 'auprc': 0.997025201532711, 'loss_val': 0.020390289300492095, 'psi': 0.9973560054910352}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=88 head_norm_before_train=2.029074 cos_to_last_merge=0.9187 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.919
[S15] round=88 local utility u=0.000000 metrics={'f1_val': 0.9187314914249689, 'auprc': 0.9966137670530602, 'loss_val': 0.1424958913883738, 'psi': 0.9498844016762054}-{'f1_val': 0.9337231388858398, 'auprc': 0.9960384169531864, 'loss_val': 0.10483685132990743, 'psi': 0.9586492501127784}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=88 head_norm_before_train=2.186227 (no previous merge yet)
[S16] round=88 local utility u=0.000000 metrics={'f1_val': 0.9936544150615314, 'auprc': 0.9927990120453057, 'loss_val': 0.034109272497915025, 'psi': 0.9933122538550412}-{'f1_val': 0.9943126892134037, 'auprc': 0.9912308718683956, 'loss_val': 0.030129287669152422, 'psi': 0.9930799622754004}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=88 head_norm_before_train=2.009581 cos_to_last_merge=0.9999 (last merge round=84)
[S17] round=88 local utility u=0.000000 metrics={'f1_val': 0.6452769404173859, 'auprc': 0.8714060684349945, 'loss_val': 1.2909432707001702, 'psi': 0.7357285916244294}-{'f1_val': 0.6911038800780036, 'auprc': 0.8936118062415003, 'loss_val': 0.9692194949596054, 'psi': 0.7721070505434022}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S8] → sending delta(kind=head bytes=1805) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S13] → sending delta(kind=head bytes=1800) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] sending update (kind=head size=1800 to 1 peers)
[S8] sending update (kind=head size=1805 to 1 peers)
[S13] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1800) from S13
[S10] cosine check vs S13: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1805) from S8
[S17] cosine check vs S8: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=1.0000
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=88 metric=0.7099 head_norm=2.075665
[S2] _apply_head_vector_avg (torch): Δ‖w‖=7.782556e-03
[S2] stored merged vector for next round verification (round=88)
[S2] DEBUG after merge:  round=88 metric=0.7099 head_norm=2.078125 delta_norm=0.007783
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=88 metric=0.9529 head_norm=2.080611
[S11] _apply_head_vector_avg (torch): Δ‖w‖=7.443006e-03
[S11] stored merged vector for next round verification (round=88)
[S11] DEBUG after merge:  round=88 metric=0.9529 head_norm=2.077371 delta_norm=0.007443
[S11] aggregate: ACCEPT kept=['S2', 'S2'] (k=2/2) mode=median trim_p=0.1
[S2] START round=89 head_norm_before_train=2.078125 cos_to_last_merge=1.0000 (last merge round=88)
[S2] round=89 local utility u=0.000000 metrics={'f1_val': 0.7100464613691112, 'auprc': 0.9642078166087724, 'loss_val': 0.4538541814000157, 'psi': 0.8117110034649757}-{'f1_val': 0.7098509592732637, 'auprc': 0.965148147312682, 'loss_val': 0.4538908852295092, 'psi': 0.811969834489031}
[S3] START round=89 head_norm_before_train=2.202688 cos_to_last_merge=0.8873 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=89 local utility u=0.000000 metrics={'f1_val': 0.8232247337726395, 'auprc': 0.9948299426588061, 'loss_val': 0.468313526740986, 'psi': 0.8918668173271062}-{'f1_val': 0.8199756680895747, 'auprc': 0.9903505822226631, 'loss_val': 0.4311828672469878, 'psi': 0.8881256337428101}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=89 head_norm_before_train=1.917580 cos_to_last_merge=0.7820 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=89 local utility u=0.010392 metrics={'f1_val': 0.9514258948424612, 'auprc': 0.9617556530454006, 'loss_val': 0.3303540185054775, 'psi': 0.955557798123637}-{'f1_val': 0.9464510027237555, 'auprc': 0.9591486775125713, 'loss_val': 0.3134680144384117, 'psi': 0.9515300726392818}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S4] sending update (kind=head size=1802 to 1 peers)
[S5] START round=89 head_norm_before_train=2.266502 (no previous merge yet)
[S5] round=89 local utility u=0.001753 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9981351534461368, 'loss_val': 0.025390037643880595, 'psi': 0.9969656753640413}-{'f1_val': 0.996186023309311, 'auprc': 0.9971367705036673, 'loss_val': 0.025900058617612513, 'psi': 0.9965663221870535}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S5] sending update (kind=head size=1797 to 1 peers)
[S6] START round=89 head_norm_before_train=1.937935 cos_to_last_merge=0.8780 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.878
[S6] round=89 local utility u=0.000000 metrics={'f1_val': 0.7320505362154539, 'auprc': 0.952332273499976, 'loss_val': 0.6364456725339843, 'psi': 0.8201632311292628}-{'f1_val': 0.8350207396219342, 'auprc': 0.9666343238919, 'loss_val': 0.36058910004779704, 'psi': 0.8876661733299206}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=89 head_norm_before_train=1.978786 cos_to_last_merge=0.9730 (last merge round=17)
[S7] round=89 local utility u=1.000000 metrics={'f1_val': 0.7272791647450922, 'auprc': 0.7939994911103119, 'loss_val': 0.4847231069017814, 'psi': 0.7539672952911801}-{'f1_val': 0.5655628782586867, 'auprc': 0.6502893013791716, 'loss_val': 1.2413669692416345, 'psi': 0.5994534475068807}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=89 head_norm_before_train=2.006550 cos_to_last_merge=1.0000 (last merge round=86)
[S8] round=89 local utility u=0.015316 metrics={'f1_val': 0.9933250006304741, 'auprc': 0.9996022353507938, 'loss_val': 0.02764186809044489, 'psi': 0.995835894518602}-{'f1_val': 0.9892968853633592, 'auprc': 0.9993939664065029, 'loss_val': 0.033479401037295534, 'psi': 0.9933357177806167}
[S9] START round=89 head_norm_before_train=2.168973 cos_to_last_merge=0.9648 (last merge round=13)
[S9] round=89 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995536002411766, 'loss_val': 0.01781367908244571, 'psi': 0.9978177471848055}-{'f1_val': 0.9970714132027002, 'auprc': 0.9994181026238649, 'loss_val': 0.016290209952976763, 'psi': 0.998010088971166}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=89 head_norm_before_train=1.823496 cos_to_last_merge=1.0000 (last merge round=87)
[S10] round=89 local utility u=0.000383 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965700474813622, 'loss_val': 0.025087523621532465, 'psi': 0.9957407224041697}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965028526729447, 'loss_val': 0.025651514133722075, 'psi': 0.9957138444808027}
[S11] START round=89 head_norm_before_train=2.077371 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=89 local utility u=0.079242 metrics={'f1_val': 0.9783240392900459, 'auprc': 0.9967604018907856, 'loss_val': 0.07754469519694826, 'psi': 0.9856985843303419}-{'f1_val': 0.9528512524948493, 'auprc': 0.9967056717249678, 'loss_val': 0.0830279580081853, 'psi': 0.9703930201868967}
[S13] START round=89 head_norm_before_train=1.819930 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=89 local utility u=0.000000 metrics={'f1_val': 0.7270014955589961, 'auprc': 0.8666256190768984, 'loss_val': 1.1249479338161652, 'psi': 0.782851144966157}-{'f1_val': 0.7755708647986304, 'auprc': 0.8515966080812014, 'loss_val': 0.6818288840993547, 'psi': 0.8059811621116588}
[S14] START round=89 head_norm_before_train=2.001382 cos_to_last_merge=0.8306 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.831
[S14] round=89 local utility u=0.000000 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9974252126901291, 'loss_val': 0.0167192682684457, 'psi': 0.9976631406887071}-{'f1_val': 0.9974109942678281, 'auprc': 0.9991836914309344, 'loss_val': 0.018161805632823165, 'psi': 0.9981200731330706}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=89 head_norm_before_train=2.034875 cos_to_last_merge=0.9182 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=89 local utility u=0.124105 metrics={'f1_val': 0.9503291280215415, 'auprc': 0.9967222876986795, 'loss_val': 0.08419658199767253, 'psi': 0.9688863918923967}-{'f1_val': 0.9187314914249689, 'auprc': 0.9966137670530602, 'loss_val': 0.1424958913883738, 'psi': 0.9498844016762054}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=89 head_norm_before_train=2.188754 (no previous merge yet)
[S16] round=89 local utility u=0.000000 metrics={'f1_val': 0.9927777551270288, 'auprc': 0.9918552793805829, 'loss_val': 0.038732604037913246, 'psi': 0.9924087648284504}-{'f1_val': 0.9936544150615314, 'auprc': 0.9927990120453057, 'loss_val': 0.034109272497915025, 'psi': 0.9933122538550412}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=89 head_norm_before_train=2.018882 cos_to_last_merge=0.9999 (last merge round=84)
[S17] round=89 local utility u=0.922706 metrics={'f1_val': 0.7923361430172875, 'auprc': 0.9476941404908317, 'loss_val': 0.5567511021587321, 'psi': 0.8544793420067052}-{'f1_val': 0.6452769404173859, 'auprc': 0.8714060684349945, 'loss_val': 1.2909432707001702, 'psi': 0.7357285916244294}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:54517
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S17] → sending delta(kind=head bytes=1802) to S8@127.0.0.1:54509
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1802 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1802) from S17
[S8] cosine check vs S17: cos=0.9998
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=0.9998
[S17] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=89 metric=0.7923 head_norm=2.023288
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.016181e-02
[S17] stored merged vector for next round verification (round=89)
[S17] DEBUG after merge:  round=89 metric=0.8098 head_norm=2.015815 delta_norm=0.020162
[S17] aggregate: ACCEPT kept=['S8', 'S8'] (k=2/2) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=89 metric=0.9952 head_norm=1.830559
[S10] _apply_head_vector_avg (torch): Δ‖w‖=7.160220e-03
[S10] stored merged vector for next round verification (round=89)
[S10] DEBUG after merge:  round=89 metric=0.9952 head_norm=1.825238 delta_norm=0.007160
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=89 metric=0.9933 head_norm=2.010487
[S8] _apply_head_vector_avg (torch): Δ‖w‖=2.040182e-02
[S8] stored merged vector for next round verification (round=89)
[S8] DEBUG after merge:  round=89 metric=0.9937 head_norm=2.016794 delta_norm=0.020402
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S2] START round=90 head_norm_before_train=2.080103 cos_to_last_merge=1.0000 (last merge round=88)
[S2] round=90 local utility u=0.044607 metrics={'f1_val': 0.7096728170397638, 'auprc': 0.9903671699435139, 'loss_val': 0.44087603361705496, 'psi': 0.8219505582012638}-{'f1_val': 0.7100464613691112, 'auprc': 0.9642078166087724, 'loss_val': 0.4538541814000157, 'psi': 0.8117110034649757}
[S3] START round=90 head_norm_before_train=2.207704 cos_to_last_merge=0.8870 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=90 local utility u=0.156079 metrics={'f1_val': 0.907725051344839, 'auprc': 0.9031945881106174, 'loss_val': 0.38825137666679044, 'psi': 0.9059128660511504}-{'f1_val': 0.8232247337726395, 'auprc': 0.9948299426588061, 'loss_val': 0.468313526740986, 'psi': 0.8918668173271062}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S3] sending update (kind=head size=1799 to 1 peers)
[S4] START round=90 head_norm_before_train=1.922912 cos_to_last_merge=0.7824 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=90 local utility u=0.030610 metrics={'f1_val': 0.95003685286449, 'auprc': 0.9782121712972613, 'loss_val': 0.31016949271454547, 'psi': 0.9613069802375985}-{'f1_val': 0.9514258948424612, 'auprc': 0.9617556530454006, 'loss_val': 0.3303540185054775, 'psi': 0.955557798123637}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=90 head_norm_before_train=2.276800 (no previous merge yet)
[S5] round=90 local utility u=0.000926 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9980666042773685, 'loss_val': 0.02421231720801753, 'psi': 0.9970261963042417}-{'f1_val': 0.996186023309311, 'auprc': 0.9981351534461368, 'loss_val': 0.025390037643880595, 'psi': 0.9969656753640413}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S5] sending update (kind=head size=1792 to 1 peers)
[S6] START round=90 head_norm_before_train=1.944211 cos_to_last_merge=0.8775 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=90 local utility u=0.529854 metrics={'f1_val': 0.8513310352537565, 'auprc': 0.9653276936263375, 'loss_val': 0.331407766736886, 'psi': 0.896929698602789}-{'f1_val': 0.7320505362154539, 'auprc': 0.952332273499976, 'loss_val': 0.6364456725339843, 'psi': 0.8201632311292628}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=90 head_norm_before_train=1.979434 cos_to_last_merge=0.9727 (last merge round=17)
[S7] round=90 local utility u=0.000000 metrics={'f1_val': 0.6592625627548867, 'auprc': 0.7990701658980758, 'loss_val': 0.4470017007860322, 'psi': 0.7151856040121624}-{'f1_val': 0.7272791647450922, 'auprc': 0.7939994911103119, 'loss_val': 0.4847231069017814, 'psi': 0.7539672952911801}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=90 head_norm_before_train=2.016794 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=90 local utility u=0.000000 metrics={'f1_val': 0.9931808101287989, 'auprc': 0.9996056230173695, 'loss_val': 0.028651451025570505, 'psi': 0.9957507352842272}-{'f1_val': 0.9933250006304741, 'auprc': 0.9996022353507938, 'loss_val': 0.02764186809044489, 'psi': 0.995835894518602}
[S9] START round=90 head_norm_before_train=2.163917 cos_to_last_merge=0.9633 (last merge round=13)
[S9] round=90 local utility u=0.000000 metrics={'f1_val': 0.9962421144756511, 'auprc': 0.9994468943343779, 'loss_val': 0.017291701631571375, 'psi': 0.9975240264191418}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995536002411766, 'loss_val': 0.01781367908244571, 'psi': 0.9978177471848055}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=90 head_norm_before_train=1.825238 cos_to_last_merge=1.0000 (last merge round=89)
[S10] round=90 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9965290310771058, 'loss_val': 0.025378235671737744, 'psi': 0.9957243158424671}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965700474813622, 'loss_val': 0.025087523621532465, 'psi': 0.9957407224041697}
[S11] START round=90 head_norm_before_train=2.081347 cos_to_last_merge=1.0000 (last merge round=88)
[S11] round=90 local utility u=0.078696 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9956073839808333, 'loss_val': 0.023550516628685195, 'psi': 0.9959231585403189}-{'f1_val': 0.9783240392900459, 'auprc': 0.9967604018907856, 'loss_val': 0.07754469519694826, 'psi': 0.9856985843303419}
[S13] START round=90 head_norm_before_train=1.823995 cos_to_last_merge=1.0000 (last merge round=87)
[S13] round=90 local utility u=0.119894 metrics={'f1_val': 0.7482271840324007, 'auprc': 0.8528036748745842, 'loss_val': 0.9710488076198424, 'psi': 0.7900577803692741}-{'f1_val': 0.7270014955589961, 'auprc': 0.8666256190768984, 'loss_val': 1.1249479338161652, 'psi': 0.782851144966157}
[S14] START round=90 head_norm_before_train=2.006012 cos_to_last_merge=0.8304 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.830
[S14] round=90 local utility u=0.000000 metrics={'f1_val': 0.9804115703812768, 'auprc': 0.9970295406416061, 'loss_val': 0.03879847216629042, 'psi': 0.9870587584854085}-{'f1_val': 0.9978217593544257, 'auprc': 0.9974252126901291, 'loss_val': 0.0167192682684457, 'psi': 0.9976631406887071}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=90 head_norm_before_train=2.040718 cos_to_last_merge=0.9177 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.918
[S15] round=90 local utility u=0.000000 metrics={'f1_val': 0.9588811841691933, 'auprc': 0.9919425943239811, 'loss_val': 0.1353902941150054, 'psi': 0.9721057482311085}-{'f1_val': 0.9503291280215415, 'auprc': 0.9967222876986795, 'loss_val': 0.08419658199767253, 'psi': 0.9688863918923967}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=90 head_norm_before_train=2.192502 (no previous merge yet)
[S16] round=90 local utility u=0.000000 metrics={'f1_val': 0.9927777551270288, 'auprc': 0.9914512731414463, 'loss_val': 0.04385060598383529, 'psi': 0.9922471623327958}-{'f1_val': 0.9927777551270288, 'auprc': 0.9918552793805829, 'loss_val': 0.038732604037913246, 'psi': 0.9924087648284504}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=90 head_norm_before_train=2.015815 cos_to_last_merge=1.0000 (last merge round=89)
[S17] round=90 local utility u=0.066400 metrics={'f1_val': 0.8051976570394519, 'auprc': 0.952928302914419, 'loss_val': 0.5168221656866391, 'psi': 0.8642899153894388}-{'f1_val': 0.7923361430172875, 'auprc': 0.9476941404908317, 'loss_val': 0.5567511021587321, 'psi': 0.8544793420067052}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S2] → sending delta(kind=head bytes=1804) to S11@127.0.0.1:54512
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S11] → sending delta(kind=head bytes=1794) to S2@127.0.0.1:54502
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S11] sending update (kind=head size=1794 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S8] ⇄ pheromone p=0.081 → S17@127.0.0.1:54517
[S2] sending update (kind=head size=1804 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1804) from S2
[S11] cosine check vs S2: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1794) from S11
[S2] cosine check vs S11: cos=1.0000
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=90 metric=0.9961 head_norm=2.086271
[S11] _apply_head_vector_avg (torch): Δ‖w‖=9.555777e-03
[S11] stored merged vector for next round verification (round=90)
[S11] DEBUG after merge:  round=90 metric=0.9961 head_norm=2.085248 delta_norm=0.009556
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.120 → S2@127.0.0.1:54502
[S2] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=90 metric=0.7097 head_norm=2.084268
[S2] _apply_head_vector_avg (torch): Δ‖w‖=8.099642e-03
[S2] stored merged vector for next round verification (round=90)
[S2] DEBUG after merge:  round=90 metric=0.7095 head_norm=2.084022 delta_norm=0.008100
[S2] aggregate: ACCEPT kept=['S11', 'S11'] (k=2/2) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.138 → S11@127.0.0.1:54512
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=90 metric=0.7482 head_norm=1.829641
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.698384e-03
[S13] stored merged vector for next round verification (round=90)
[S13] DEBUG after merge:  round=90 metric=0.7482 head_norm=1.830080 delta_norm=0.008698
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.176 → S10@127.0.0.1:54511
[S17] ⇄ pheromone p=0.223 → S8@127.0.0.1:54509
[S2] START round=91 head_norm_before_train=2.084022 cos_to_last_merge=1.0000 (last merge round=90)
[S2] round=91 local utility u=0.000000 metrics={'f1_val': 0.7094927881575226, 'auprc': 0.9904774704475117, 'loss_val': 0.4762425133804513, 'psi': 0.8218866610735183}-{'f1_val': 0.7096728170397638, 'auprc': 0.9903671699435139, 'loss_val': 0.44087603361705496, 'psi': 0.8219505582012638}
[S3] START round=91 head_norm_before_train=2.210450 cos_to_last_merge=0.8869 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=91 local utility u=0.000000 metrics={'f1_val': 0.7676749280810001, 'auprc': 0.9977490997919308, 'loss_val': 0.623170590544783, 'psi': 0.8597045967653724}-{'f1_val': 0.907725051344839, 'auprc': 0.9031945881106174, 'loss_val': 0.38825137666679044, 'psi': 0.9059128660511504}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=91 head_norm_before_train=1.924015 cos_to_last_merge=0.7823 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=91 local utility u=0.000000 metrics={'f1_val': 0.9440149277384362, 'auprc': 0.9637178673261673, 'loss_val': 0.3079542098194368, 'psi': 0.9518961035735286}-{'f1_val': 0.95003685286449, 'auprc': 0.9782121712972613, 'loss_val': 0.31016949271454547, 'psi': 0.9613069802375985}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=91 head_norm_before_train=2.288686 (no previous merge yet)
[S5] round=91 local utility u=0.000406 metrics={'f1_val': 0.9963325909888239, 'auprc': 0.9982375819149811, 'loss_val': 0.023913326116340883, 'psi': 0.9970945873592867}-{'f1_val': 0.9963325909888239, 'auprc': 0.9980666042773685, 'loss_val': 0.02421231720801753, 'psi': 0.9970261963042417}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=91 head_norm_before_train=1.947077 cos_to_last_merge=0.8767 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=91 local utility u=0.417144 metrics={'f1_val': 0.95222849581523, 'auprc': 0.9801149751580113, 'loss_val': 0.1468667765613313, 'psi': 0.9633830875523425}-{'f1_val': 0.8513310352537565, 'auprc': 0.9653276936263375, 'loss_val': 0.331407766736886, 'psi': 0.896929698602789}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S6] sending update (kind=head size=1801 to 1 peers)
[S7] START round=91 head_norm_before_train=1.980243 cos_to_last_merge=0.9727 (last merge round=17)
[S7] round=91 local utility u=0.000000 metrics={'f1_val': 0.5948396039083821, 'auprc': 0.7961171488985171, 'loss_val': 0.568052781179332, 'psi': 0.6753506219044361}-{'f1_val': 0.6592625627548867, 'auprc': 0.7990701658980758, 'loss_val': 0.4470017007860322, 'psi': 0.7151856040121624}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=91 head_norm_before_train=2.021205 cos_to_last_merge=1.0000 (last merge round=89)
[S8] round=91 local utility u=0.000000 metrics={'f1_val': 0.9940863284942748, 'auprc': 0.9982174023607452, 'loss_val': 0.03106884017405561, 'psi': 0.995738758040863}-{'f1_val': 0.9931808101287989, 'auprc': 0.9996056230173695, 'loss_val': 0.028651451025570505, 'psi': 0.9957507352842272}
[S9] START round=91 head_norm_before_train=2.168159 cos_to_last_merge=0.9631 (last merge round=13)
[S9] round=91 local utility u=0.001375 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9997628748542134, 'loss_val': 0.017999364303091455, 'psi': 0.9979014570300202}-{'f1_val': 0.9962421144756511, 'auprc': 0.9994468943343779, 'loss_val': 0.017291701631571375, 'psi': 0.9975240264191418}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S9] sending update (kind=head size=1793 to 1 peers)
[S10] START round=91 head_norm_before_train=1.832397 cos_to_last_merge=1.0000 (last merge round=89)
[S10] round=91 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9963297293892518, 'loss_val': 0.026104158110228474, 'psi': 0.9956445951673256}-{'f1_val': 0.9951878390193748, 'auprc': 0.9965290310771058, 'loss_val': 0.025378235671737744, 'psi': 0.9957243158424671}
[S11] START round=91 head_norm_before_train=2.085248 cos_to_last_merge=1.0000 (last merge round=90)
[S11] round=91 local utility u=0.000000 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9947987490711155, 'loss_val': 0.02182715565640178, 'psi': 0.9955997045764318}-{'f1_val': 0.9961336749133093, 'auprc': 0.9956073839808333, 'loss_val': 0.023550516628685195, 'psi': 0.9959231585403189}
[S13] START round=91 head_norm_before_train=1.830080 cos_to_last_merge=1.0000 (last merge round=90)
[S13] round=91 local utility u=0.178605 metrics={'f1_val': 0.776410325404406, 'auprc': 0.8963388759730286, 'loss_val': 0.9135442262787821, 'psi': 0.8243817456318551}-{'f1_val': 0.7482271840324007, 'auprc': 0.8528036748745842, 'loss_val': 0.9710488076198424, 'psi': 0.7900577803692741}
[S14] START round=91 head_norm_before_train=2.007048 cos_to_last_merge=0.8302 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.830
[S14] round=91 local utility u=0.013393 metrics={'f1_val': 0.9843128931005477, 'auprc': 0.9971567737802973, 'loss_val': 0.03580150913659251, 'psi': 0.9894504453724475}-{'f1_val': 0.9804115703812768, 'auprc': 0.9970295406416061, 'loss_val': 0.03879847216629042, 'psi': 0.9870587584854085}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=91 head_norm_before_train=2.046023 cos_to_last_merge=0.9172 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=91 local utility u=0.000000 metrics={'f1_val': 0.6965396294315246, 'auprc': 0.692277231076911, 'loss_val': 0.8439960107617311, 'psi': 0.6948346700896791}-{'f1_val': 0.9588811841691933, 'auprc': 0.9919425943239811, 'loss_val': 0.1353902941150054, 'psi': 0.9721057482311085}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=91 head_norm_before_train=2.194696 (no previous merge yet)
[S16] round=91 local utility u=0.001192 metrics={'f1_val': 0.992930965876797, 'auprc': 0.9885440887251065, 'loss_val': 0.03366379258121178, 'psi': 0.9911762150161207}-{'f1_val': 0.9927777551270288, 'auprc': 0.9914512731414463, 'loss_val': 0.04385060598383529, 'psi': 0.9922471623327958}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1792 reason=None
[S16] sending update (kind=head size=1792 to 1 peers)
[S17] START round=91 head_norm_before_train=2.021820 cos_to_last_merge=1.0000 (last merge round=89)
[S17] round=91 local utility u=0.000000 metrics={'f1_val': 0.6937836535358245, 'auprc': 0.9009164507781282, 'loss_val': 0.9849892551531493, 'psi': 0.776636772432746}-{'f1_val': 0.8051976570394519, 'auprc': 0.952928302914419, 'loss_val': 0.5168221656866391, 'psi': 0.8642899153894388}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S13] → sending delta(kind=head bytes=1803) to S10@127.0.0.1:54511
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=91 metric=0.9952 head_norm=1.838378
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.008790e-02
[S10] stored merged vector for next round verification (round=91)
[S10] DEBUG after merge:  round=91 metric=0.9952 head_norm=1.833987 delta_norm=0.010088
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] sending update (kind=head size=1803 to 1 peers)
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=91 metric=0.9941 head_norm=2.026601
[S8] _apply_head_vector_avg (torch): Δ‖w‖=8.113123e-03
[S8] stored merged vector for next round verification (round=91)
[S8] DEBUG after merge:  round=91 metric=0.9941 head_norm=2.024196 delta_norm=0.008113
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] RECEIVED delta(kind=head bytes=1803) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] START round=92 head_norm_before_train=2.088486 cos_to_last_merge=1.0000 (last merge round=90)
[S2] round=92 local utility u=0.000000 metrics={'f1_val': 0.707426299278554, 'auprc': 0.9155754488621538, 'loss_val': 0.49633079371035055, 'psi': 0.7906859591119939}-{'f1_val': 0.7094927881575226, 'auprc': 0.9904774704475117, 'loss_val': 0.4762425133804513, 'psi': 0.8218866610735183}
[S3] START round=92 head_norm_before_train=2.208397 cos_to_last_merge=0.8873 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=92 local utility u=0.938315 metrics={'f1_val': 0.9839876110477258, 'auprc': 0.9985887174052198, 'loss_val': 0.046936495904011916, 'psi': 0.9898280535907235}-{'f1_val': 0.7676749280810001, 'auprc': 0.9977490997919308, 'loss_val': 0.623170590544783, 'psi': 0.8597045967653724}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S3] sending update (kind=head size=1793 to 1 peers)
[S4] START round=92 head_norm_before_train=1.928024 cos_to_last_merge=0.7818 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.782
[S4] round=92 local utility u=0.000000 metrics={'f1_val': 0.9405672083865888, 'auprc': 0.9587784068468322, 'loss_val': 0.31468769643801364, 'psi': 0.9478516877706862}-{'f1_val': 0.9440149277384362, 'auprc': 0.9637178673261673, 'loss_val': 0.3079542098194368, 'psi': 0.9518961035735286}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=92 head_norm_before_train=2.292503 (no previous merge yet)
[S5] round=92 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9975145559168652, 'loss_val': 0.025127075359651568, 'psi': 0.9967174363523327}-{'f1_val': 0.9963325909888239, 'auprc': 0.9982375819149811, 'loss_val': 0.023913326116340883, 'psi': 0.9970945873592867}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=92 head_norm_before_train=1.947541 cos_to_last_merge=0.8769 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.877
[S6] round=92 local utility u=0.000000 metrics={'f1_val': 0.5985254367809179, 'auprc': 0.7389498845418511, 'loss_val': 1.172080751883971, 'psi': 0.6546952158852912}-{'f1_val': 0.95222849581523, 'auprc': 0.9801149751580113, 'loss_val': 0.1468667765613313, 'psi': 0.9633830875523425}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=92 head_norm_before_train=1.983091 cos_to_last_merge=0.9729 (last merge round=17)
[S7] round=92 local utility u=0.936649 metrics={'f1_val': 0.8294150443669398, 'auprc': 0.8576834506311856, 'loss_val': 0.28690650588885147, 'psi': 0.8407224068726381}-{'f1_val': 0.5948396039083821, 'auprc': 0.7961171488985171, 'loss_val': 0.568052781179332, 'psi': 0.6753506219044361}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S7] sending update (kind=head size=1800 to 1 peers)
[S8] START round=92 head_norm_before_train=2.024196 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=92 local utility u=0.000000 metrics={'f1_val': 0.9925380579155019, 'auprc': 0.9996217846746853, 'loss_val': 0.030858642074626706, 'psi': 0.9953715486191752}-{'f1_val': 0.9940863284942748, 'auprc': 0.9982174023607452, 'loss_val': 0.03106884017405561, 'psi': 0.995738758040863}
[S9] START round=92 head_norm_before_train=2.169593 cos_to_last_merge=0.9625 (last merge round=13)
[S9] round=92 local utility u=0.000326 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996017914187334, 'loss_val': 0.016863498648335282, 'psi': 0.9978370236558283}-{'f1_val': 0.9966605118138915, 'auprc': 0.9997628748542134, 'loss_val': 0.017999364303091455, 'psi': 0.9979014570300202}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S9] sending update (kind=head size=1789 to 1 peers)
[S10] START round=92 head_norm_before_train=1.833987 cos_to_last_merge=1.0000 (last merge round=91)
[S10] round=92 local utility u=0.002276 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9975435045762574, 'loss_val': 0.025193698036774327, 'psi': 0.9961301052421279}-{'f1_val': 0.9951878390193748, 'auprc': 0.9963297293892518, 'loss_val': 0.026104158110228474, 'psi': 0.9956445951673256}
[S11] START round=92 head_norm_before_train=2.091232 cos_to_last_merge=1.0000 (last merge round=90)
[S11] round=92 local utility u=0.000703 metrics={'f1_val': 0.9961336749133093, 'auprc': 0.9948897679826906, 'loss_val': 0.02069337592895751, 'psi': 0.9956361121410618}-{'f1_val': 0.9961336749133093, 'auprc': 0.9947987490711155, 'loss_val': 0.02182715565640178, 'psi': 0.9955997045764318}
[S13] START round=92 head_norm_before_train=1.835999 cos_to_last_merge=1.0000 (last merge round=90)
[S13] round=92 local utility u=0.000000 metrics={'f1_val': 0.6578355488973209, 'auprc': 0.7994030875677605, 'loss_val': 1.0690866765377638, 'psi': 0.7144625643654967}-{'f1_val': 0.776410325404406, 'auprc': 0.8963388759730286, 'loss_val': 0.9135442262787821, 'psi': 0.8243817456318551}
[S14] START round=92 head_norm_before_train=2.011250 cos_to_last_merge=0.8299 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.830
[S14] round=92 local utility u=0.048359 metrics={'f1_val': 0.9978195179672185, 'auprc': 0.9970288542069649, 'loss_val': 0.01973951848370853, 'psi': 0.997503252463117}-{'f1_val': 0.9843128931005477, 'auprc': 0.9971567737802973, 'loss_val': 0.03580150913659251, 'psi': 0.9894504453724475}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S14] sending update (kind=head size=1797 to 1 peers)
[S15] START round=92 head_norm_before_train=2.051372 cos_to_last_merge=0.9168 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.917
[S15] round=92 local utility u=0.598909 metrics={'f1_val': 0.7732524009806627, 'auprc': 0.8465711487584593, 'loss_val': 0.5693369260891535, 'psi': 0.8025799000917813}-{'f1_val': 0.6965396294315246, 'auprc': 0.692277231076911, 'loss_val': 0.8439960107617311, 'psi': 0.6948346700896791}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=92 head_norm_before_train=2.196357 (no previous merge yet)
[S16] round=92 local utility u=0.001584 metrics={'f1_val': 0.9935888275773034, 'auprc': 0.9884879568304944, 'loss_val': 0.034274421289628605, 'psi': 0.9915484792785798}-{'f1_val': 0.992930965876797, 'auprc': 0.9885440887251065, 'loss_val': 0.03366379258121178, 'psi': 0.9911762150161207}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S16] sending update (kind=head size=1796 to 1 peers)
[S17] START round=92 head_norm_before_train=2.028007 cos_to_last_merge=1.0000 (last merge round=89)
[S17] round=92 local utility u=0.629782 metrics={'f1_val': 0.7943188984385758, 'auprc': 0.9594142135329613, 'loss_val': 0.5041309262222943, 'psi': 0.8603570244763301}-{'f1_val': 0.6937836535358245, 'auprc': 0.9009164507781282, 'loss_val': 0.9849892551531493, 'psi': 0.776636772432746}
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S11] → sending delta(kind=head bytes=1800) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S10] → sending delta(kind=head bytes=1805) to S13@127.0.0.1:54513
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] sending update (kind=head size=1805 to 1 peers)
[S11] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1800) from S11
[S2] cosine check vs S11: cos=1.0000
[S13] RECEIVED delta(kind=head bytes=1805) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=92 metric=0.9952 head_norm=1.838825
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.652781e-03
[S10] stored merged vector for next round verification (round=92)
[S10] DEBUG after merge:  round=92 metric=0.9952 head_norm=1.837400 delta_norm=0.006653
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S2] START round=93 head_norm_before_train=2.091067 cos_to_last_merge=1.0000 (last merge round=90)
[S2] round=93 local utility u=0.000000 metrics={'f1_val': 0.641255231355559, 'auprc': 0.793987474884775, 'loss_val': 1.0116873727493985, 'psi': 0.7023481287672453}-{'f1_val': 0.707426299278554, 'auprc': 0.9155754488621538, 'loss_val': 0.49633079371035055, 'psi': 0.7906859591119939}
[S3] START round=93 head_norm_before_train=2.208452 cos_to_last_merge=0.8876 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.888
[S3] round=93 local utility u=0.000000 metrics={'f1_val': 0.980721032708611, 'auprc': 0.9974381014843035, 'loss_val': 0.06788222508343368, 'psi': 0.987407860218888}-{'f1_val': 0.9839876110477258, 'auprc': 0.9985887174052198, 'loss_val': 0.046936495904011916, 'psi': 0.9898280535907235}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=93 head_norm_before_train=1.935130 cos_to_last_merge=0.7809 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=93 local utility u=0.017204 metrics={'f1_val': 0.9417869260189307, 'auprc': 0.9674686417958729, 'loss_val': 0.31366802024486706, 'psi': 0.9520596123297076}-{'f1_val': 0.9405672083865888, 'auprc': 0.9587784068468322, 'loss_val': 0.31468769643801364, 'psi': 0.9478516877706862}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S4] sending update (kind=head size=1799 to 1 peers)
[S5] START round=93 head_norm_before_train=2.295399 (no previous merge yet)
[S5] round=93 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9947028933207558, 'loss_val': 0.024966515369244553, 'psi': 0.9955927713138889}-{'f1_val': 0.996186023309311, 'auprc': 0.9975145559168652, 'loss_val': 0.025127075359651568, 'psi': 0.9967174363523327}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=93 head_norm_before_train=1.947397 cos_to_last_merge=0.8762 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=93 local utility u=1.000000 metrics={'f1_val': 0.7707180142519535, 'auprc': 0.9502097251453495, 'loss_val': 0.5505532214987988, 'psi': 0.8425146986093119}-{'f1_val': 0.5985254367809179, 'auprc': 0.7389498845418511, 'loss_val': 1.172080751883971, 'psi': 0.6546952158852912}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S6] sending update (kind=head size=1798 to 1 peers)
[S7] START round=93 head_norm_before_train=1.988456 cos_to_last_merge=0.9723 (last merge round=17)
[S7] round=93 local utility u=0.000000 metrics={'f1_val': 0.782356397102508, 'auprc': 0.8231989709506528, 'loss_val': 0.36041557953633924, 'psi': 0.7986934266417659}-{'f1_val': 0.8294150443669398, 'auprc': 0.8576834506311856, 'loss_val': 0.28690650588885147, 'psi': 0.8407224068726381}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=93 head_norm_before_train=2.027164 cos_to_last_merge=1.0000 (last merge round=91)
[S8] round=93 local utility u=0.001166 metrics={'f1_val': 0.9929679663698754, 'auprc': 0.9996755469706768, 'loss_val': 0.03126677861807657, 'psi': 0.995650998610196}-{'f1_val': 0.9925380579155019, 'auprc': 0.9996217846746853, 'loss_val': 0.030858642074626706, 'psi': 0.9953715486191752}
[S9] START round=93 head_norm_before_train=2.175821 cos_to_last_merge=0.9627 (last merge round=13)
[S9] round=93 local utility u=0.000000 metrics={'f1_val': 0.9958267183641853, 'auprc': 0.999450327260204, 'loss_val': 0.017363945357554315, 'psi': 0.9972761619225928}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996017914187334, 'loss_val': 0.016863498648335282, 'psi': 0.9978370236558283}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=93 head_norm_before_train=1.837400 cos_to_last_merge=1.0000 (last merge round=92)
[S10] round=93 local utility u=0.000047 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9975558651320464, 'loss_val': 0.025135814488951164, 'psi': 0.9961350494644434}-{'f1_val': 0.9951878390193748, 'auprc': 0.9975435045762574, 'loss_val': 0.025193698036774327, 'psi': 0.9961301052421279}
[S11] START round=93 head_norm_before_train=2.095183 cos_to_last_merge=1.0000 (last merge round=90)
[S11] round=93 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9951820342930374, 'loss_val': 0.03002556734995693, 'psi': 0.9959103260356814}-{'f1_val': 0.9961336749133093, 'auprc': 0.9948897679826906, 'loss_val': 0.02069337592895751, 'psi': 0.9956361121410618}
[S13] START round=93 head_norm_before_train=1.839701 cos_to_last_merge=1.0000 (last merge round=90)
[S13] round=93 local utility u=0.418568 metrics={'f1_val': 0.733122974127524, 'auprc': 0.9258089883957634, 'loss_val': 1.0628923312439211, 'psi': 0.8101973798348199}-{'f1_val': 0.6578355488973209, 'auprc': 0.7994030875677605, 'loss_val': 1.0690866765377638, 'psi': 0.7144625643654967}
[S14] START round=93 head_norm_before_train=2.016475 cos_to_last_merge=0.8295 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.830
[S14] round=93 local utility u=0.000000 metrics={'f1_val': 0.9902896058779449, 'auprc': 0.997018793582595, 'loss_val': 0.03213202167654219, 'psi': 0.9929812809598049}-{'f1_val': 0.9978195179672185, 'auprc': 0.9970288542069649, 'loss_val': 0.01973951848370853, 'psi': 0.997503252463117}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=93 head_norm_before_train=2.055178 cos_to_last_merge=0.9164 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=93 local utility u=0.734125 metrics={'f1_val': 0.9002874482735611, 'auprc': 0.9947709541000104, 'loss_val': 0.3078958874812497, 'psi': 0.9380808506041408}-{'f1_val': 0.7732524009806627, 'auprc': 0.8465711487584593, 'loss_val': 0.5693369260891535, 'psi': 0.8025799000917813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S15] sending update (kind=head size=1798 to 1 peers)
[S16] START round=93 head_norm_before_train=2.198787 (no previous merge yet)
[S16] round=93 local utility u=0.001314 metrics={'f1_val': 0.9935888275773034, 'auprc': 0.9886174016689386, 'loss_val': 0.03203424043351855, 'psi': 0.9916002572139575}-{'f1_val': 0.9935888275773034, 'auprc': 0.9884879568304944, 'loss_val': 0.034274421289628605, 'psi': 0.9915484792785798}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S16] sending update (kind=head size=1795 to 1 peers)
[S17] START round=93 head_norm_before_train=2.035073 cos_to_last_merge=0.9999 (last merge round=89)
[S17] round=93 local utility u=0.000000 metrics={'f1_val': 0.7364809197734239, 'auprc': 0.9009893085640893, 'loss_val': 0.898726006288958, 'psi': 0.8022842752896902}-{'f1_val': 0.7943188984385758, 'auprc': 0.9594142135329613, 'loss_val': 0.5041309262222943, 'psi': 0.8603570244763301}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S10] → sending delta(kind=head bytes=1803) to S13@127.0.0.1:54513
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S13] → sending delta(kind=head bytes=1801) to S10@127.0.0.1:54511
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S8] → sending delta(kind=head bytes=1803) to S17@127.0.0.1:54517
[S8] sending update (kind=head size=1803 to 1 peers)
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=93 metric=0.6413 head_norm=2.094475
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.132748e-02
[S2] stored merged vector for next round verification (round=93)
[S2] DEBUG after merge:  round=93 metric=0.6404 head_norm=2.094798 delta_norm=0.011327
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1803 to 1 peers)
[S13] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1803) from S8
[S17] cosine check vs S8: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1803) from S10
[S13] cosine check vs S10: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1801) from S13
[S10] cosine check vs S13: cos=1.0000
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=93 metric=0.9930 head_norm=2.029758
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.257311e-02
[S8] stored merged vector for next round verification (round=93)
[S8] DEBUG after merge:  round=93 metric=0.9930 head_norm=2.032379 delta_norm=0.012573
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=93 metric=0.9952 head_norm=1.843268
[S10] _apply_head_vector_avg (torch): Δ‖w‖=8.350191e-03
[S10] stored merged vector for next round verification (round=93)
[S10] DEBUG after merge:  round=93 metric=0.9952 head_norm=1.843159 delta_norm=0.008350
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=93 metric=0.7331 head_norm=1.843087
[S13] _apply_head_vector_avg (torch): Δ‖w‖=9.537022e-03
[S13] stored merged vector for next round verification (round=93)
[S13] DEBUG after merge:  round=93 metric=0.7367 head_norm=1.842041 delta_norm=0.009537
[S13] aggregate: ACCEPT kept=['S10', 'S10'] (k=2/2) mode=median trim_p=0.1
[S2] START round=94 head_norm_before_train=2.094798 cos_to_last_merge=1.0000 (last merge round=93)
[S2] round=94 local utility u=0.539940 metrics={'f1_val': 0.7044217234757076, 'auprc': 0.8650399591499767, 'loss_val': 0.5239634529389633, 'psi': 0.7686690177454153}-{'f1_val': 0.641255231355559, 'auprc': 0.793987474884775, 'loss_val': 1.0116873727493985, 'psi': 0.7023481287672453}
[S3] START round=94 head_norm_before_train=2.212604 cos_to_last_merge=0.8873 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=94 local utility u=0.000000 metrics={'f1_val': 0.7092169234119214, 'auprc': 0.9565791721151907, 'loss_val': 0.7176088136663137, 'psi': 0.8081618228932291}-{'f1_val': 0.980721032708611, 'auprc': 0.9974381014843035, 'loss_val': 0.06788222508343368, 'psi': 0.987407860218888}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=94 head_norm_before_train=1.938770 cos_to_last_merge=0.7812 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=94 local utility u=0.007213 metrics={'f1_val': 0.9422709328130079, 'auprc': 0.970938959577728, 'loss_val': 0.3125570846538923, 'psi': 0.9537381435188959}-{'f1_val': 0.9417869260189307, 'auprc': 0.9674686417958729, 'loss_val': 0.31366802024486706, 'psi': 0.9520596123297076}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S4] sending update (kind=head size=1798 to 1 peers)
[S5] START round=94 head_norm_before_train=2.304057 (no previous merge yet)
[S5] round=94 local utility u=0.004923 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9980567660323189, 'loss_val': 0.02518293572961133, 'psi': 0.9969343203985142}-{'f1_val': 0.996186023309311, 'auprc': 0.9947028933207558, 'loss_val': 0.024966515369244553, 'psi': 0.9955927713138889}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S5] sending update (kind=head size=1796 to 1 peers)
[S6] START round=94 head_norm_before_train=1.947967 cos_to_last_merge=0.8759 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=94 local utility u=0.740282 metrics={'f1_val': 0.9455524750033351, 'auprc': 0.9796743920889928, 'loss_val': 0.20738908808941442, 'psi': 0.9592012418375981}-{'f1_val': 0.7707180142519535, 'auprc': 0.9502097251453495, 'loss_val': 0.5505532214987988, 'psi': 0.8425146986093119}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S6] sending update (kind=head size=1804 to 1 peers)
[S7] START round=94 head_norm_before_train=1.993715 cos_to_last_merge=0.9717 (last merge round=17)
[S7] round=94 local utility u=0.000000 metrics={'f1_val': 0.62758641885696, 'auprc': 0.7861741551050012, 'loss_val': 0.6002897395267865, 'psi': 0.6910215133561765}-{'f1_val': 0.782356397102508, 'auprc': 0.8231989709506528, 'loss_val': 0.36041557953633924, 'psi': 0.7986934266417659}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=94 head_norm_before_train=2.032379 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=94 local utility u=0.004070 metrics={'f1_val': 0.9936910743895857, 'auprc': 0.9998583142400637, 'loss_val': 0.02801459689470539, 'psi': 0.9961579703297769}-{'f1_val': 0.9929679663698754, 'auprc': 0.9996755469706768, 'loss_val': 0.03126677861807657, 'psi': 0.995650998610196}
[S9] START round=94 head_norm_before_train=2.180850 cos_to_last_merge=0.9634 (last merge round=13)
[S9] round=94 local utility u=0.004023 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.999480387214702, 'loss_val': 0.016875957901649235, 'psi': 0.9980350028075009}-{'f1_val': 0.9958267183641853, 'auprc': 0.999450327260204, 'loss_val': 0.017363945357554315, 'psi': 0.9972761619225928}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1795 reason=None
[S9] sending update (kind=head size=1795 to 1 peers)
[S10] START round=94 head_norm_before_train=1.843159 cos_to_last_merge=1.0000 (last merge round=93)
[S10] round=94 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9971420887163337, 'loss_val': 0.025697771822481206, 'psi': 0.9959695388981583}-{'f1_val': 0.9951878390193748, 'auprc': 0.9975558651320464, 'loss_val': 0.025135814488951164, 'psi': 0.9961350494644434}
[S11] START round=94 head_norm_before_train=2.098403 cos_to_last_merge=0.9999 (last merge round=90)
[S11] round=94 local utility u=0.000000 metrics={'f1_val': 0.872254092030958, 'auprc': 0.9948025664810725, 'loss_val': 0.14368682442597835, 'psi': 0.9212734818110038}-{'f1_val': 0.9963958538641108, 'auprc': 0.9951820342930374, 'loss_val': 0.03002556734995693, 'psi': 0.9959103260356814}
[S13] START round=94 head_norm_before_train=1.842041 cos_to_last_merge=1.0000 (last merge round=93)
[S13] round=94 local utility u=0.000000 metrics={'f1_val': 0.6256820324609568, 'auprc': 0.8078770325490275, 'loss_val': 1.3597039355874416, 'psi': 0.6985600324961851}-{'f1_val': 0.733122974127524, 'auprc': 0.9258089883957634, 'loss_val': 1.0628923312439211, 'psi': 0.8101973798348199}
[S14] START round=94 head_norm_before_train=2.018523 cos_to_last_merge=0.8294 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=94 local utility u=0.000000 metrics={'f1_val': 0.9601327643634934, 'auprc': 0.9970196352086207, 'loss_val': 0.04940661247900738, 'psi': 0.9748875127015443}-{'f1_val': 0.9902896058779449, 'auprc': 0.997018793582595, 'loss_val': 0.03213202167654219, 'psi': 0.9929812809598049}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=94 head_norm_before_train=2.058639 cos_to_last_merge=0.9162 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=94 local utility u=0.000000 metrics={'f1_val': 0.8827613679761142, 'auprc': 0.9932297580576605, 'loss_val': 0.3304221930609913, 'psi': 0.9269487240087326}-{'f1_val': 0.9002874482735611, 'auprc': 0.9947709541000104, 'loss_val': 0.3078958874812497, 'psi': 0.9380808506041408}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=94 head_norm_before_train=2.203317 (no previous merge yet)
[S16] round=94 local utility u=0.000000 metrics={'f1_val': 0.9927118271958891, 'auprc': 0.9880597147479481, 'loss_val': 0.03506553772199824, 'psi': 0.9908509822167126}-{'f1_val': 0.9935888275773034, 'auprc': 0.9886174016689386, 'loss_val': 0.03203424043351855, 'psi': 0.9916002572139575}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=94 head_norm_before_train=2.042879 cos_to_last_merge=0.9999 (last merge round=89)
[S17] round=94 local utility u=0.000000 metrics={'f1_val': 0.7103087349228393, 'auprc': 0.9058987785247394, 'loss_val': 0.7818922566147293, 'psi': 0.7885447523635993}-{'f1_val': 0.7364809197734239, 'auprc': 0.9009893085640893, 'loss_val': 0.898726006288958, 'psi': 0.8022842752896902}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S8] → sending delta(kind=head bytes=1802) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1805 reason=None
[S2] → sending delta(kind=head bytes=1805) to S11@127.0.0.1:54512
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=94 metric=0.7103 head_norm=2.049862
[S17] _apply_head_vector_avg (torch): Δ‖w‖=2.434940e-02
[S17] stored merged vector for next round verification (round=94)
[S17] DEBUG after merge:  round=94 metric=0.7112 head_norm=2.039690 delta_norm=0.024349
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S2] sending update (kind=head size=1805 to 1 peers)
[S8] sending update (kind=head size=1802 to 1 peers)
[S11] RECEIVED delta(kind=head bytes=1805) from S2
[S11] cosine check vs S2: cos=0.9999
[S17] RECEIVED delta(kind=head bytes=1802) from S8
[S17] cosine check vs S8: cos=1.0000
[S2] START round=95 head_norm_before_train=2.098742 cos_to_last_merge=1.0000 (last merge round=93)
[S2] round=95 local utility u=0.016030 metrics={'f1_val': 0.7350884210101606, 'auprc': 0.8380522481412621, 'loss_val': 0.5949399077847893, 'psi': 0.7762739518626012}-{'f1_val': 0.7044217234757076, 'auprc': 0.8650399591499767, 'loss_val': 0.5239634529389633, 'psi': 0.7686690177454153}
[S3] START round=95 head_norm_before_train=2.216227 cos_to_last_merge=0.8871 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=95 local utility u=1.000000 metrics={'f1_val': 0.9971302205031132, 'auprc': 0.9973578400068739, 'loss_val': 0.02065875890108103, 'psi': 0.9972212683046174}-{'f1_val': 0.7092169234119214, 'auprc': 0.9565791721151907, 'loss_val': 0.7176088136663137, 'psi': 0.8081618228932291}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S3] sending update (kind=head size=1794 to 1 peers)
[S4] START round=95 head_norm_before_train=1.943344 cos_to_last_merge=0.7810 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=95 local utility u=0.042254 metrics={'f1_val': 0.9483889385697528, 'auprc': 0.9842610878432572, 'loss_val': 0.3047225540532538, 'psi': 0.9627377982791546}-{'f1_val': 0.9422709328130079, 'auprc': 0.970938959577728, 'loss_val': 0.3125570846538923, 'psi': 0.9537381435188959}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S4] sending update (kind=head size=1800 to 1 peers)
[S5] START round=95 head_norm_before_train=2.303934 (no previous merge yet)
[S5] round=95 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9977841654715922, 'loss_val': 0.026161821170741555, 'psi': 0.9968252801742234}-{'f1_val': 0.996186023309311, 'auprc': 0.9980567660323189, 'loss_val': 0.02518293572961133, 'psi': 0.9969343203985142}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=95 head_norm_before_train=1.953221 cos_to_last_merge=0.8758 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=95 local utility u=0.000000 metrics={'f1_val': 0.7935837620577939, 'auprc': 0.9518748910080906, 'loss_val': 0.4000077346565971, 'psi': 0.8569002136379126}-{'f1_val': 0.9455524750033351, 'auprc': 0.9796743920889928, 'loss_val': 0.20738908808941442, 'psi': 0.9592012418375981}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=95 head_norm_before_train=1.998519 cos_to_last_merge=0.9711 (last merge round=17)
[S7] round=95 local utility u=0.000000 metrics={'f1_val': 0.6041356680634092, 'auprc': 0.7749891734004685, 'loss_val': 0.7068868926686137, 'psi': 0.672477070198233}-{'f1_val': 0.62758641885696, 'auprc': 0.7861741551050012, 'loss_val': 0.6002897395267865, 'psi': 0.6910215133561765}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=95 head_norm_before_train=2.038455 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=95 local utility u=0.002198 metrics={'f1_val': 0.9941000136901317, 'auprc': 0.9998705489620436, 'loss_val': 0.026109875349987988, 'psi': 0.9964082277988964}-{'f1_val': 0.9936910743895857, 'auprc': 0.9998583142400637, 'loss_val': 0.02801459689470539, 'psi': 0.9961579703297769}
[S9] START round=95 head_norm_before_train=2.181960 cos_to_last_merge=0.9632 (last merge round=13)
[S9] round=95 local utility u=0.000000 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.999394935680281, 'loss_val': 0.01667533957502606, 'psi': 0.9980008221937325}-{'f1_val': 0.9970714132027002, 'auprc': 0.999480387214702, 'loss_val': 0.016875957901649235, 'psi': 0.9980350028075009}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=95 head_norm_before_train=1.849490 cos_to_last_merge=1.0000 (last merge round=93)
[S10] round=95 local utility u=0.000356 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9972903396317622, 'loss_val': 0.02543045892295684, 'psi': 0.9960288392643297}-{'f1_val': 0.9951878390193748, 'auprc': 0.9971420887163337, 'loss_val': 0.025697771822481206, 'psi': 0.9959695388981583}
[S11] START round=95 head_norm_before_train=2.101003 cos_to_last_merge=0.9999 (last merge round=90)
[S11] round=95 local utility u=0.433803 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9944795982232733, 'loss_val': 0.019962521839882383, 'psi': 0.9956293516077759}-{'f1_val': 0.872254092030958, 'auprc': 0.9948025664810725, 'loss_val': 0.14368682442597835, 'psi': 0.9212734818110038}
[S13] START round=95 head_norm_before_train=1.846720 cos_to_last_merge=1.0000 (last merge round=93)
[S13] round=95 local utility u=0.850725 metrics={'f1_val': 0.776107447889396, 'auprc': 0.9092197295415876, 'loss_val': 0.8648342690900094, 'psi': 0.8293523605502726}-{'f1_val': 0.6256820324609568, 'auprc': 0.8078770325490275, 'loss_val': 1.3597039355874416, 'psi': 0.6985600324961851}
[S14] START round=95 head_norm_before_train=2.022451 cos_to_last_merge=0.8292 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=95 local utility u=0.129518 metrics={'f1_val': 0.9978217593544257, 'auprc': 0.9970693065914911, 'loss_val': 0.016652779902157237, 'psi': 0.9975207782492519}-{'f1_val': 0.9601327643634934, 'auprc': 0.9970196352086207, 'loss_val': 0.04940661247900738, 'psi': 0.9748875127015443}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S14] sending update (kind=head size=1800 to 1 peers)
[S15] START round=95 head_norm_before_train=2.062712 cos_to_last_merge=0.9158 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=95 local utility u=0.396256 metrics={'f1_val': 0.9682271986794423, 'auprc': 0.9956576337884813, 'loss_val': 0.05798963683792955, 'psi': 0.9791993727230579}-{'f1_val': 0.8827613679761142, 'auprc': 0.9932297580576605, 'loss_val': 0.3304221930609913, 'psi': 0.9269487240087326}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S15] sending update (kind=head size=1797 to 1 peers)
[S16] START round=95 head_norm_before_train=2.208712 (no previous merge yet)
[S16] round=95 local utility u=0.000000 metrics={'f1_val': 0.9923410504664824, 'auprc': 0.9905779606755353, 'loss_val': 0.041164300993031165, 'psi': 0.9916358145501036}-{'f1_val': 0.9927118271958891, 'auprc': 0.9880597147479481, 'loss_val': 0.03506553772199824, 'psi': 0.9908509822167126}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=95 head_norm_before_train=2.039690 cos_to_last_merge=1.0000 (last merge round=94)
[S17] round=95 local utility u=0.000000 metrics={'f1_val': 0.6298770950207602, 'auprc': 0.9030310659707728, 'loss_val': 0.9362743712622491, 'psi': 0.7391386834007652}-{'f1_val': 0.7103087349228393, 'auprc': 0.9058987785247394, 'loss_val': 0.7818922566147293, 'psi': 0.7885447523635993}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S10] → sending delta(kind=head bytes=1801) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S13] → sending delta(kind=head bytes=1796) to S10@127.0.0.1:54511
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1804 reason=None
[S8] → sending delta(kind=head bytes=1804) to S17@127.0.0.1:54517
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S11] → sending delta(kind=head bytes=1799) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S2] → sending delta(kind=head bytes=1802) to S11@127.0.0.1:54512
[S11] sending update (kind=head size=1799 to 1 peers)
[S13] sending update (kind=head size=1796 to 1 peers)
[S2] sending update (kind=head size=1802 to 1 peers)
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=95 metric=0.6299 head_norm=2.046838
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.423165e-02
[S17] stored merged vector for next round verification (round=95)
[S17] DEBUG after merge:  round=95 metric=0.6371 head_norm=2.042602 delta_norm=0.014232
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] ⇄ pheromone p=0.138 → S8@127.0.0.1:54509
[S8] sending update (kind=head size=1804 to 1 peers)
[S10] sending update (kind=head size=1801 to 1 peers)
[S17] RECEIVED delta(kind=head bytes=1804) from S8
[S17] cosine check vs S8: cos=1.0000
[S10] RECEIVED delta(kind=head bytes=1796) from S13
[S10] cosine check vs S13: cos=1.0000
[S2] RECEIVED delta(kind=head bytes=1799) from S11
[S2] cosine check vs S11: cos=0.9999
[S11] RECEIVED delta(kind=head bytes=1802) from S2
[S11] cosine check vs S2: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1801) from S10
[S13] cosine check vs S10: cos=1.0000
[S8] ⇄ pheromone p=0.028 → S17@127.0.0.1:54517
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=95 metric=0.9952 head_norm=1.856154
[S10] _apply_head_vector_avg (torch): Δ‖w‖=6.614987e-03
[S10] stored merged vector for next round verification (round=95)
[S10] DEBUG after merge:  round=95 metric=0.9952 head_norm=1.853453 delta_norm=0.006615
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S10] ⇄ pheromone p=0.000 → S13@127.0.0.1:54513
[S11] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=95 metric=0.9964 head_norm=2.105387
[S11] _apply_head_vector_avg (torch): Δ‖w‖=1.503685e-02
[S11] stored merged vector for next round verification (round=95)
[S11] DEBUG after merge:  round=95 metric=0.9964 head_norm=2.103091 delta_norm=0.015037
[S11] aggregate: ACCEPT kept=['S2', 'S2'] (k=2/2) mode=median trim_p=0.1
[S11] ⇄ pheromone p=0.126 → S2@127.0.0.1:54502
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=95 metric=0.7351 head_norm=2.103060
[S2] _apply_head_vector_avg (torch): Δ‖w‖=1.514430e-02
[S2] stored merged vector for next round verification (round=95)
[S2] DEBUG after merge:  round=95 metric=0.7351 head_norm=2.104169 delta_norm=0.015144
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] ⇄ pheromone p=0.135 → S11@127.0.0.1:54512
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=95 metric=0.7761 head_norm=1.850771
[S13] _apply_head_vector_avg (torch): Δ‖w‖=6.614985e-03
[S13] stored merged vector for next round verification (round=95)
[S13] DEBUG after merge:  round=95 metric=0.7761 head_norm=1.853453 delta_norm=0.006615
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] ⇄ pheromone p=0.296 → S10@127.0.0.1:54511
[S2] START round=96 head_norm_before_train=2.104169 cos_to_last_merge=1.0000 (last merge round=95)
[S2] round=96 local utility u=0.109469 metrics={'f1_val': 0.7084869479002939, 'auprc': 0.9336507046348957, 'loss_val': 0.5031886189077832, 'psi': 0.7985524505941346}-{'f1_val': 0.7350884210101606, 'auprc': 0.8380522481412621, 'loss_val': 0.5949399077847893, 'psi': 0.7762739518626012}
[S3] START round=96 head_norm_before_train=2.221519 cos_to_last_merge=0.8866 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.887
[S3] round=96 local utility u=0.000000 metrics={'f1_val': 0.8979380186244519, 'auprc': 0.9642507806057659, 'loss_val': 0.2239454863531653, 'psi': 0.9244631234169775}-{'f1_val': 0.9971302205031132, 'auprc': 0.9973578400068739, 'loss_val': 0.02065875890108103, 'psi': 0.9972212683046174}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=96 head_norm_before_train=1.945590 cos_to_last_merge=0.7813 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=96 local utility u=0.000000 metrics={'f1_val': 0.9501614429551223, 'auprc': 0.9718802468856977, 'loss_val': 0.32090389888261406, 'psi': 0.9588489645273526}-{'f1_val': 0.9483889385697528, 'auprc': 0.9842610878432572, 'loss_val': 0.3047225540532538, 'psi': 0.9627377982791546}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=96 head_norm_before_train=2.301804 (no previous merge yet)
[S5] round=96 local utility u=0.000785 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9980682294702377, 'loss_val': 0.025443633471339155, 'psi': 0.9969389057736817}-{'f1_val': 0.996186023309311, 'auprc': 0.9977841654715922, 'loss_val': 0.026161821170741555, 'psi': 0.9968252801742234}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=96 head_norm_before_train=1.959011 cos_to_last_merge=0.8754 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=96 local utility u=0.000000 metrics={'f1_val': 0.6962455360960564, 'auprc': 0.9323704918290614, 'loss_val': 0.4778252246455853, 'psi': 0.7906955183892584}-{'f1_val': 0.7935837620577939, 'auprc': 0.9518748910080906, 'loss_val': 0.4000077346565971, 'psi': 0.8569002136379126}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] START round=96 head_norm_before_train=2.004484 cos_to_last_merge=0.9704 (last merge round=17)
[S7] round=96 local utility u=0.000000 metrics={'f1_val': 0.4394460531411266, 'auprc': 0.6432771051544063, 'loss_val': 1.6495768229975651, 'psi': 0.5209784739464385}-{'f1_val': 0.6041356680634092, 'auprc': 0.7749891734004685, 'loss_val': 0.7068868926686137, 'psi': 0.672477070198233}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=96 head_norm_before_train=2.046277 cos_to_last_merge=1.0000 (last merge round=93)
[S8] round=96 local utility u=0.000000 metrics={'f1_val': 0.8998865671848726, 'auprc': 0.9995710107018277, 'loss_val': 0.19341798209599304, 'psi': 0.9397603445916547}-{'f1_val': 0.9941000136901317, 'auprc': 0.9998705489620436, 'loss_val': 0.026109875349987988, 'psi': 0.9964082277988964}
[S9] START round=96 head_norm_before_train=2.185969 cos_to_last_merge=0.9632 (last merge round=13)
[S9] round=96 local utility u=0.000000 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.999583451464092, 'loss_val': 0.016834007181492097, 'psi': 0.9978296876739716}-{'f1_val': 0.9970714132027002, 'auprc': 0.999394935680281, 'loss_val': 0.01667533957502606, 'psi': 0.9980008221937325}
[S9] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S10] START round=96 head_norm_before_train=1.853453 cos_to_last_merge=1.0000 (last merge round=95)
[S10] round=96 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9972316995404366, 'loss_val': 0.02556097859059335, 'psi': 0.9960053832277995}-{'f1_val': 0.9951878390193748, 'auprc': 0.9972903396317622, 'loss_val': 0.02543045892295684, 'psi': 0.9960288392643297}
[S11] START round=96 head_norm_before_train=2.103091 cos_to_last_merge=1.0000 (last merge round=95)
[S11] round=96 local utility u=0.001519 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9953090453001499, 'loss_val': 0.019290055664307432, 'psi': 0.9959488502655105}-{'f1_val': 0.9963958538641108, 'auprc': 0.9944795982232733, 'loss_val': 0.019962521839882383, 'psi': 0.9956293516077759}
[S13] START round=96 head_norm_before_train=1.853453 cos_to_last_merge=1.0000 (last merge round=95)
[S13] round=96 local utility u=0.000000 metrics={'f1_val': 0.6474708577036933, 'auprc': 0.8419307322279217, 'loss_val': 1.2161265147523022, 'psi': 0.7252548075133847}-{'f1_val': 0.776107447889396, 'auprc': 0.9092197295415876, 'loss_val': 0.8648342690900094, 'psi': 0.8293523605502726}
[S14] START round=96 head_norm_before_train=2.025622 cos_to_last_merge=0.8288 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.829
[S14] round=96 local utility u=0.000000 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9984944528335863, 'loss_val': 0.01881605047573201, 'psi': 0.9975982090619813}-{'f1_val': 0.9978217593544257, 'auprc': 0.9970693065914911, 'loss_val': 0.016652779902157237, 'psi': 0.9975207782492519}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=96 head_norm_before_train=2.067158 cos_to_last_merge=0.9155 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.916
[S15] round=96 local utility u=0.000000 metrics={'f1_val': 0.9342321065629388, 'auprc': 0.9962707509644496, 'loss_val': 0.10669102162267534, 'psi': 0.9590475643235431}-{'f1_val': 0.9682271986794423, 'auprc': 0.9956576337884813, 'loss_val': 0.05798963683792955, 'psi': 0.9791993727230579}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=96 head_norm_before_train=2.212256 (no previous merge yet)
[S16] round=96 local utility u=0.000000 metrics={'f1_val': 0.9916835744857317, 'auprc': 0.9934457245166285, 'loss_val': 0.051914845543903604, 'psi': 0.9923884344980904}-{'f1_val': 0.9923410504664824, 'auprc': 0.9905779606755353, 'loss_val': 0.041164300993031165, 'psi': 0.9916358145501036}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=96 head_norm_before_train=2.042602 cos_to_last_merge=1.0000 (last merge round=95)
[S17] round=96 local utility u=1.000000 metrics={'f1_val': 0.8360172117580446, 'auprc': 0.9840139677752319, 'loss_val': 0.26374872213069583, 'psi': 0.8952159141649194}-{'f1_val': 0.6298770950207602, 'auprc': 0.9030310659707728, 'loss_val': 0.9362743712622491, 'psi': 0.7391386834007652}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S17] → sending delta(kind=head bytes=1799) to S8@127.0.0.1:54509
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S11] → sending delta(kind=head bytes=1797) to S2@127.0.0.1:54502
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] sending update (kind=head size=1799 to 1 peers)
[S11] sending update (kind=head size=1797 to 1 peers)
[S17] sending update (kind=head size=1799 to 1 peers)
[S2] RECEIVED delta(kind=head bytes=1797) from S11
[S2] cosine check vs S11: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1799) from S17
[S8] cosine check vs S17: cos=0.9999
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=96 metric=0.8360 head_norm=2.048511
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.270147e-02
[S17] stored merged vector for next round verification (round=96)
[S17] DEBUG after merge:  round=96 metric=0.8357 head_norm=2.047355 delta_norm=0.012701
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=96 metric=0.9964 head_norm=2.108775
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.007095e-03
[S11] stored merged vector for next round verification (round=96)
[S11] DEBUG after merge:  round=96 metric=0.9964 head_norm=2.108599 delta_norm=0.004007
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=96 metric=0.7085 head_norm=2.108431
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.007089e-03
[S2] stored merged vector for next round verification (round=96)
[S2] DEBUG after merge:  round=96 metric=0.7085 head_norm=2.108599 delta_norm=0.004007
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S2] START round=97 head_norm_before_train=2.108599 cos_to_last_merge=1.0000 (last merge round=96)
[S2] round=97 local utility u=0.003704 metrics={'f1_val': 0.7085521626124174, 'auprc': 0.932941047434207, 'loss_val': 0.4940438415892757, 'psi': 0.7983077165411332}-{'f1_val': 0.7084869479002939, 'auprc': 0.9336507046348957, 'loss_val': 0.5031886189077832, 'psi': 0.7985524505941346}
[S3] START round=97 head_norm_before_train=2.226544 cos_to_last_merge=0.8862 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=97 local utility u=0.000000 metrics={'f1_val': 0.89979348258146, 'auprc': 0.9581229881971787, 'loss_val': 0.30633395444408806, 'psi': 0.9231252848277475}-{'f1_val': 0.8979380186244519, 'auprc': 0.9642507806057659, 'loss_val': 0.2239454863531653, 'psi': 0.9244631234169775}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=97 head_norm_before_train=1.947708 cos_to_last_merge=0.7814 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=97 local utility u=0.000000 metrics={'f1_val': 0.9534423541394392, 'auprc': 0.9587880131186085, 'loss_val': 0.3280626139829113, 'psi': 0.9555806177311069}-{'f1_val': 0.9501614429551223, 'auprc': 0.9718802468856977, 'loss_val': 0.32090389888261406, 'psi': 0.9588489645273526}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] START round=97 head_norm_before_train=2.310880 (no previous merge yet)
[S5] round=97 local utility u=0.001278 metrics={'f1_val': 0.996186023309311, 'auprc': 0.9983710728352445, 'loss_val': 0.023796131590621217, 'psi': 0.9970600431196844}-{'f1_val': 0.996186023309311, 'auprc': 0.9980682294702377, 'loss_val': 0.025443633471339155, 'psi': 0.9969389057736817}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S5] sending update (kind=head size=1793 to 1 peers)
[S6] START round=97 head_norm_before_train=1.965086 cos_to_last_merge=0.8755 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.876
[S6] round=97 local utility u=0.065117 metrics={'f1_val': 0.7325449083321576, 'auprc': 0.949722915864987, 'loss_val': 0.6174456455138443, 'psi': 0.8194161113452894}-{'f1_val': 0.6962455360960564, 'auprc': 0.9323704918290614, 'loss_val': 0.4778252246455853, 'psi': 0.7906955183892584}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1797 reason=None
[S6] sending update (kind=head size=1797 to 1 peers)
[S7] START round=97 head_norm_before_train=2.008143 cos_to_last_merge=0.9700 (last merge round=17)
[S7] round=97 local utility u=1.000000 metrics={'f1_val': 0.778845408128891, 'auprc': 0.8490515763689194, 'loss_val': 0.5559449167995081, 'psi': 0.8069278754249023}-{'f1_val': 0.4394460531411266, 'auprc': 0.6432771051544063, 'loss_val': 1.6495768229975651, 'psi': 0.5209784739464385}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S7] sending update (kind=head size=1802 to 1 peers)
[S8] START round=97 head_norm_before_train=2.050309 cos_to_last_merge=0.9999 (last merge round=93)
[S8] round=97 local utility u=0.337012 metrics={'f1_val': 0.9873035181570807, 'auprc': 0.9995999243933309, 'loss_val': 0.043981781241300755, 'psi': 0.9922220806515808}-{'f1_val': 0.8998865671848726, 'auprc': 0.9995710107018277, 'loss_val': 0.19341798209599304, 'psi': 0.9397603445916547}
[S9] START round=97 head_norm_before_train=2.189586 cos_to_last_merge=0.9627 (last merge round=13)
[S9] round=97 local utility u=0.000312 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9996630335836889, 'loss_val': 0.016448752933273938, 'psi': 0.9978615205218104}-{'f1_val': 0.9966605118138915, 'auprc': 0.999583451464092, 'loss_val': 0.016834007181492097, 'psi': 0.9978296876739716}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1791 reason=None
[S9] sending update (kind=head size=1791 to 1 peers)
[S10] START round=97 head_norm_before_train=1.857205 cos_to_last_merge=1.0000 (last merge round=95)
[S10] round=97 local utility u=0.000367 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.997329140991947, 'loss_val': 0.025120119068450842, 'psi': 0.9960443598084037}-{'f1_val': 0.9951878390193748, 'auprc': 0.9972316995404366, 'loss_val': 0.02556097859059335, 'psi': 0.9960053832277995}
[S11] START round=97 head_norm_before_train=2.108599 cos_to_last_merge=1.0000 (last merge round=96)
[S11] round=97 local utility u=0.001349 metrics={'f1_val': 0.9963753869090841, 'auprc': 0.9962323857141054, 'loss_val': 0.019362033089281583, 'psi': 0.9963181864310926}-{'f1_val': 0.9963753869090841, 'auprc': 0.9953090453001499, 'loss_val': 0.019290055664307432, 'psi': 0.9959488502655105}
[S13] START round=97 head_norm_before_train=1.856594 cos_to_last_merge=1.0000 (last merge round=95)
[S13] round=97 local utility u=0.634814 metrics={'f1_val': 0.7778316456378869, 'auprc': 0.8882937430073633, 'loss_val': 0.8677531075718594, 'psi': 0.8220164845856774}-{'f1_val': 0.6474708577036933, 'auprc': 0.8419307322279217, 'loss_val': 1.2161265147523022, 'psi': 0.7252548075133847}
[S14] START round=97 head_norm_before_train=2.030394 cos_to_last_merge=0.8284 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=97 local utility u=0.001117 metrics={'f1_val': 0.9970007132142444, 'auprc': 0.9990299645572418, 'loss_val': 0.01818951272952, 'psi': 0.9978124137514435}-{'f1_val': 0.9970007132142444, 'auprc': 0.9984944528335863, 'loss_val': 0.01881605047573201, 'psi': 0.9975982090619813}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S14] sending update (kind=head size=1803 to 1 peers)
[S15] START round=97 head_norm_before_train=2.072221 cos_to_last_merge=0.9151 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=97 local utility u=0.000000 metrics={'f1_val': 0.8835798771311858, 'auprc': 0.9947440872931645, 'loss_val': 0.34224275326821546, 'psi': 0.9280455611959773}-{'f1_val': 0.9342321065629388, 'auprc': 0.9962707509644496, 'loss_val': 0.10669102162267534, 'psi': 0.9590475643235431}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=97 head_norm_before_train=2.215747 (no previous merge yet)
[S16] round=97 local utility u=0.000000 metrics={'f1_val': 0.9849599259377322, 'auprc': 0.9932744809377808, 'loss_val': 0.0660472703841204, 'psi': 0.9882857479377516}-{'f1_val': 0.9916835744857317, 'auprc': 0.9934457245166285, 'loss_val': 0.051914845543903604, 'psi': 0.9923884344980904}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S17] START round=97 head_norm_before_train=2.047355 cos_to_last_merge=1.0000 (last merge round=96)
[S17] round=97 local utility u=0.000000 metrics={'f1_val': 0.6485431426883558, 'auprc': 0.9124173518848747, 'loss_val': 0.9371541634692517, 'psi': 0.7540928263669634}-{'f1_val': 0.8360172117580446, 'auprc': 0.9840139677752319, 'loss_val': 0.26374872213069583, 'psi': 0.8952159141649194}
[S17] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1798 reason=None
[S11] → sending delta(kind=head bytes=1798) to S2@127.0.0.1:54502
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S10] → sending delta(kind=head bytes=1800) to S13@127.0.0.1:54513
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1802 reason=None
[S13] → sending delta(kind=head bytes=1802) to S10@127.0.0.1:54511
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1799 reason=None
[S2] → sending delta(kind=head bytes=1799) to S11@127.0.0.1:54512
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S13] sending update (kind=head size=1802 to 1 peers)
[S10] sending update (kind=head size=1800 to 1 peers)
[S11] sending update (kind=head size=1798 to 1 peers)
[S8] sending update (kind=head size=1800 to 1 peers)
[S2] sending update (kind=head size=1799 to 1 peers)
[S10] RECEIVED delta(kind=head bytes=1802) from S13
[S10] cosine check vs S13: cos=0.9999
[S2] RECEIVED delta(kind=head bytes=1798) from S11
[S2] cosine check vs S11: cos=1.0000
[S11] RECEIVED delta(kind=head bytes=1799) from S2
[S11] cosine check vs S2: cos=1.0000
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=0.9999
[S13] RECEIVED delta(kind=head bytes=1800) from S10
[S13] cosine check vs S10: cos=0.9999
[S2] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S2] DEBUG before merge: round=97 metric=0.7086 head_norm=2.110792
[S2] _apply_head_vector_avg (torch): Δ‖w‖=4.529200e-03
[S2] stored merged vector for next round verification (round=97)
[S2] DEBUG after merge:  round=97 metric=0.7086 head_norm=2.112238 delta_norm=0.004529
[S2] aggregate: ACCEPT kept=['S11'] (k=1/1) mode=median trim_p=0.1
[S11] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S11] DEBUG before merge: round=97 metric=0.9964 head_norm=2.113693
[S11] _apply_head_vector_avg (torch): Δ‖w‖=4.529195e-03
[S11] stored merged vector for next round verification (round=97)
[S11] DEBUG after merge:  round=97 metric=0.9964 head_norm=2.112238 delta_norm=0.004529
[S11] aggregate: ACCEPT kept=['S2'] (k=1/1) mode=median trim_p=0.1
[S10] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S10] DEBUG before merge: round=97 metric=0.9952 head_norm=1.862341
[S10] _apply_head_vector_avg (torch): Δ‖w‖=1.048014e-02
[S10] stored merged vector for next round verification (round=97)
[S10] DEBUG after merge:  round=97 metric=0.9952 head_norm=1.860636 delta_norm=0.010480
[S10] aggregate: ACCEPT kept=['S13'] (k=1/1) mode=median trim_p=0.1
[S8] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=97 metric=0.9873 head_norm=2.050738
[S8] _apply_head_vector_avg (torch): Δ‖w‖=1.630183e-02
[S8] stored merged vector for next round verification (round=97)
[S8] DEBUG after merge:  round=97 metric=0.9873 head_norm=2.049560 delta_norm=0.016302
[S8] aggregate: ACCEPT kept=['S17'] (k=1/1) mode=median trim_p=0.1
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=97 metric=0.7778 head_norm=1.858987
[S13] _apply_head_vector_avg (torch): Δ‖w‖=1.048014e-02
[S13] stored merged vector for next round verification (round=97)
[S13] DEBUG after merge:  round=97 metric=0.7778 head_norm=1.860636 delta_norm=0.010480
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S2] START round=98 head_norm_before_train=2.112238 cos_to_last_merge=1.0000 (last merge round=97)
[S2] round=98 local utility u=0.000000 metrics={'f1_val': 0.7073826207705748, 'auprc': 0.8996885738973575, 'loss_val': 0.47783627391471173, 'psi': 0.7843050020212878}-{'f1_val': 0.7085521626124174, 'auprc': 0.932941047434207, 'loss_val': 0.4940438415892757, 'psi': 0.7983077165411332}
[S3] START round=98 head_norm_before_train=2.231415 cos_to_last_merge=0.8859 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.886
[S3] round=98 local utility u=0.000000 metrics={'f1_val': 0.8332736132506157, 'auprc': 0.9967278413226903, 'loss_val': 0.34641729491526935, 'psi': 0.8986553044794455}-{'f1_val': 0.89979348258146, 'auprc': 0.9581229881971787, 'loss_val': 0.30633395444408806, 'psi': 0.9231252848277475}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] START round=98 head_norm_before_train=1.950923 cos_to_last_merge=0.7813 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=98 local utility u=0.029025 metrics={'f1_val': 0.9507648205068802, 'auprc': 0.9760847312830446, 'loss_val': 0.30583785351381726, 'psi': 0.9608927848173459}-{'f1_val': 0.9534423541394392, 'auprc': 0.9587880131186085, 'loss_val': 0.3280626139829113, 'psi': 0.9555806177311069}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1793 reason=None
[S4] sending update (kind=head size=1793 to 1 peers)
[S5] START round=98 head_norm_before_train=2.322467 (no previous merge yet)
[S5] round=98 local utility u=0.000000 metrics={'f1_val': 0.996186023309311, 'auprc': 0.992972299197578, 'loss_val': 0.024524272213781256, 'psi': 0.9949005336646178}-{'f1_val': 0.996186023309311, 'auprc': 0.9983710728352445, 'loss_val': 0.023796131590621217, 'psi': 0.9970600431196844}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] START round=98 head_norm_before_train=1.968681 cos_to_last_merge=0.8753 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=98 local utility u=0.685269 metrics={'f1_val': 0.8799459307241118, 'auprc': 0.98568841337207, 'loss_val': 0.23921013986738127, 'psi': 0.9222429237832951}-{'f1_val': 0.7325449083321576, 'auprc': 0.949722915864987, 'loss_val': 0.6174456455138443, 'psi': 0.8194161113452894}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S6] sending update (kind=head size=1800 to 1 peers)
[S7] START round=98 head_norm_before_train=2.009786 cos_to_last_merge=0.9697 (last merge round=17)
[S7] round=98 local utility u=0.000000 metrics={'f1_val': 0.6268473835041115, 'auprc': 0.778192560740792, 'loss_val': 0.7046294943620635, 'psi': 0.6873854543987837}-{'f1_val': 0.778845408128891, 'auprc': 0.8490515763689194, 'loss_val': 0.5559449167995081, 'psi': 0.8069278754249023}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] START round=98 head_norm_before_train=2.049560 cos_to_last_merge=1.0000 (last merge round=97)
[S8] round=98 local utility u=0.000000 metrics={'f1_val': 0.9011201289823553, 'auprc': 0.9914728438469917, 'loss_val': 0.12089638699823123, 'psi': 0.9372612149282098}-{'f1_val': 0.9873035181570807, 'auprc': 0.9995999243933309, 'loss_val': 0.043981781241300755, 'psi': 0.9922220806515808}
[S9] START round=98 head_norm_before_train=2.193289 cos_to_last_merge=0.9626 (last merge round=13)
[S9] round=98 local utility u=0.000046 metrics={'f1_val': 0.9966605118138915, 'auprc': 0.9995829347638405, 'loss_val': 0.016117125953916546, 'psi': 0.997829480993871}-{'f1_val': 0.9966605118138915, 'auprc': 0.9996630335836889, 'loss_val': 0.016448752933273938, 'psi': 0.9978615205218104}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S10] START round=98 head_norm_before_train=1.860636 cos_to_last_merge=1.0000 (last merge round=97)
[S10] round=98 local utility u=0.000409 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9975691587509147, 'loss_val': 0.025021689585127675, 'psi': 0.9961403669119907}-{'f1_val': 0.9951878390193748, 'auprc': 0.997329140991947, 'loss_val': 0.025120119068450842, 'psi': 0.9960443598084037}
[S11] START round=98 head_norm_before_train=2.112238 cos_to_last_merge=1.0000 (last merge round=97)
[S11] round=98 local utility u=0.000000 metrics={'f1_val': 0.9963958538641108, 'auprc': 0.9943145635914655, 'loss_val': 0.039894515331464916, 'psi': 0.9955633377550528}-{'f1_val': 0.9963753869090841, 'auprc': 0.9962323857141054, 'loss_val': 0.019362033089281583, 'psi': 0.9963181864310926}
[S13] START round=98 head_norm_before_train=1.860636 cos_to_last_merge=1.0000 (last merge round=97)
[S13] round=98 local utility u=0.000000 metrics={'f1_val': 0.7486831702991574, 'auprc': 0.888710830600862, 'loss_val': 1.0981755728335159, 'psi': 0.8046942344198393}-{'f1_val': 0.7778316456378869, 'auprc': 0.8882937430073633, 'loss_val': 0.8677531075718594, 'psi': 0.8220164845856774}
[S14] START round=98 head_norm_before_train=2.033483 cos_to_last_merge=0.8282 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=98 local utility u=0.000000 metrics={'f1_val': 0.9769029589504963, 'auprc': 0.997988613792288, 'loss_val': 0.03982059125216791, 'psi': 0.985337220887213}-{'f1_val': 0.9970007132142444, 'auprc': 0.9990299645572418, 'loss_val': 0.01818951272952, 'psi': 0.9978124137514435}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S15] START round=98 head_norm_before_train=2.076987 cos_to_last_merge=0.9147 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.915
[S15] round=98 local utility u=0.000000 metrics={'f1_val': 0.8321098454118651, 'auprc': 0.9725879328943232, 'loss_val': 0.4110542929377053, 'psi': 0.8883010804048483}-{'f1_val': 0.8835798771311858, 'auprc': 0.9947440872931645, 'loss_val': 0.34224275326821546, 'psi': 0.9280455611959773}
[S15] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] START round=98 head_norm_before_train=2.219965 (no previous merge yet)
[S16] round=98 local utility u=0.033066 metrics={'f1_val': 0.9931501786450869, 'auprc': 0.9880098784376957, 'loss_val': 0.033262651095625095, 'psi': 0.9910940585621304}-{'f1_val': 0.9849599259377322, 'auprc': 0.9932744809377808, 'loss_val': 0.0660472703841204, 'psi': 0.9882857479377516}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1789 reason=None
[S16] sending update (kind=head size=1789 to 1 peers)
[S17] START round=98 head_norm_before_train=2.053353 cos_to_last_merge=1.0000 (last merge round=96)
[S17] round=98 local utility u=0.772494 metrics={'f1_val': 0.8023521506034824, 'auprc': 0.9659015409111948, 'loss_val': 0.47547317703655506, 'psi': 0.8677719067265673}-{'f1_val': 0.6485431426883558, 'auprc': 0.9124173518848747, 'loss_val': 0.9371541634692517, 'psi': 0.7540928263669634}
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S8] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1801 reason=None
[S17] → sending delta(kind=head bytes=1801) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S10] → sending delta(kind=head bytes=1796) to S13@127.0.0.1:54513
[S17] sending update (kind=head size=1801 to 1 peers)
[S8] RECEIVED delta(kind=head bytes=1801) from S17
[S8] cosine check vs S17: cos=1.0000
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=98 metric=0.8024 head_norm=2.059589
[S17] _apply_head_vector_avg (torch): Δ‖w‖=1.461391e-02
[S17] stored merged vector for next round verification (round=98)
[S17] DEBUG after merge:  round=98 metric=0.8029 head_norm=2.055116 delta_norm=0.014614
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S10] sending update (kind=head size=1796 to 1 peers)
[S13] RECEIVED delta(kind=head bytes=1796) from S10
[S13] cosine check vs S10: cos=1.0000
[S2] START round=99 head_norm_before_train=2.114937 cos_to_last_merge=1.0000 (last merge round=97)
[S2] round=99 local utility u=0.000000 metrics={'f1_val': 0.6892138859869362, 'auprc': 0.8138424395848366, 'loss_val': 0.7770814313100047, 'psi': 0.7390653074260964}-{'f1_val': 0.7073826207705748, 'auprc': 0.8996885738973575, 'loss_val': 0.47783627391471173, 'psi': 0.7843050020212878}
[S3] START round=99 head_norm_before_train=2.237882 cos_to_last_merge=0.8853 (last merge round=12)
[S3] ⚠️ Model drifted since last merge! cos=0.885
[S3] round=99 local utility u=0.000000 metrics={'f1_val': 0.7721625775124172, 'auprc': 0.8917901289633665, 'loss_val': 0.6099505143245918, 'psi': 0.820013598092797}-{'f1_val': 0.8332736132506157, 'auprc': 0.9967278413226903, 'loss_val': 0.34641729491526935, 'psi': 0.8986553044794455}
[S3] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S3] r=100 psi=0.820 u=0.0000 p_local=0.1425 f1=0.772 auprc=0.892 bytes=86343
[S4] START round=99 head_norm_before_train=1.952909 cos_to_last_merge=0.7812 (last merge round=2)
[S4] ⚠️ Model drifted since last merge! cos=0.781
[S4] round=99 local utility u=0.000000 metrics={'f1_val': 0.941336889046422, 'auprc': 0.9768388035413549, 'loss_val': 0.29968227377901707, 'psi': 0.9555376548443951}-{'f1_val': 0.9507648205068802, 'auprc': 0.9760847312830446, 'loss_val': 0.30583785351381726, 'psi': 0.9608927848173459}
[S4] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S4] r=100 psi=0.956 u=0.0000 p_local=0.0114 f1=0.941 auprc=0.977 bytes=95333
[S5] START round=99 head_norm_before_train=2.324590 (no previous merge yet)
[S5] round=99 local utility u=0.000000 metrics={'f1_val': 0.7145028925575769, 'auprc': 0.9901924343538637, 'loss_val': 0.49106315939127415, 'psi': 0.8247787092760916}-{'f1_val': 0.996186023309311, 'auprc': 0.992972299197578, 'loss_val': 0.024524272213781256, 'psi': 0.9949005336646178}
[S5] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S5] r=100 psi=0.825 u=0.0000 p_local=0.0008 f1=0.715 auprc=0.990 bytes=93411
[S6] START round=99 head_norm_before_train=1.970553 cos_to_last_merge=0.8749 (last merge round=10)
[S6] ⚠️ Model drifted since last merge! cos=0.875
[S6] round=99 local utility u=0.000000 metrics={'f1_val': 0.6516601734963368, 'auprc': 0.9593525087128209, 'loss_val': 0.5326773493456851, 'psi': 0.7747371075829304}-{'f1_val': 0.8799459307241118, 'auprc': 0.98568841337207, 'loss_val': 0.23921013986738127, 'psi': 0.9222429237832951}
[S6] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S6] r=100 psi=0.775 u=0.0000 p_local=0.2861 f1=0.652 auprc=0.959 bytes=106138
[S7] START round=99 head_norm_before_train=2.014133 cos_to_last_merge=0.9693 (last merge round=17)
[S7] round=99 local utility u=0.000000 metrics={'f1_val': 0.5405188665865415, 'auprc': 0.6365329224984303, 'loss_val': 1.342176506276914, 'psi': 0.578924488951297}-{'f1_val': 0.6268473835041115, 'auprc': 0.778192560740792, 'loss_val': 0.7046294943620635, 'psi': 0.6873854543987837}
[S7] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S7] r=100 psi=0.579 u=0.0000 p_local=0.1993 f1=0.541 auprc=0.637 bytes=80962
[S8] START round=99 head_norm_before_train=2.052138 cos_to_last_merge=1.0000 (last merge round=97)
[S8] round=99 local utility u=0.334328 metrics={'f1_val': 0.9929024225986427, 'auprc': 0.9996108944414754, 'loss_val': 0.02734813618957307, 'psi': 0.9955858113357758}-{'f1_val': 0.9011201289823553, 'auprc': 0.9914728438469917, 'loss_val': 0.12089638699823123, 'psi': 0.9372612149282098}
[S9] START round=99 head_norm_before_train=2.195842 cos_to_last_merge=0.9632 (last merge round=13)
[S9] round=99 local utility u=0.000969 metrics={'f1_val': 0.9970714132027002, 'auprc': 0.9994385558424828, 'loss_val': 0.01621169367446443, 'psi': 0.9980182702586132}-{'f1_val': 0.9966605118138915, 'auprc': 0.9995829347638405, 'loss_val': 0.016117125953916546, 'psi': 0.997829480993871}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1796 reason=None
[S9] sending update (kind=head size=1796 to 1 peers)
[S9] r=100 psi=0.998 u=0.0010 p_local=0.0007 f1=0.997 auprc=0.999 bytes=97015
[S10] START round=99 head_norm_before_train=1.866503 cos_to_last_merge=1.0000 (last merge round=97)
[S10] round=99 local utility u=0.000000 metrics={'f1_val': 0.9951878390193748, 'auprc': 0.9974673872243491, 'loss_val': 0.025307873227653706, 'psi': 0.9960996583013645}-{'f1_val': 0.9951878390193748, 'auprc': 0.9975691587509147, 'loss_val': 0.025021689585127675, 'psi': 0.9961403669119907}
[S11] START round=99 head_norm_before_train=2.113336 cos_to_last_merge=1.0000 (last merge round=97)
[S11] round=99 local utility u=0.000000 metrics={'f1_val': 0.982223721122461, 'auprc': 0.9943676726682664, 'loss_val': 0.07526273006888694, 'psi': 0.9870813017407832}-{'f1_val': 0.9963958538641108, 'auprc': 0.9943145635914655, 'loss_val': 0.039894515331464916, 'psi': 0.9955633377550528}
[S13] START round=99 head_norm_before_train=1.863330 cos_to_last_merge=1.0000 (last merge round=97)
[S13] round=99 local utility u=0.000000 metrics={'f1_val': 0.639819398364188, 'auprc': 0.858807354878075, 'loss_val': 1.2910954354314579, 'psi': 0.7274145809697428}-{'f1_val': 0.7486831702991574, 'auprc': 0.888710830600862, 'loss_val': 1.0981755728335159, 'psi': 0.8046942344198393}
[S14] START round=99 head_norm_before_train=2.036877 cos_to_last_merge=0.8280 (last merge round=10)
[S14] ⚠️ Model drifted since last merge! cos=0.828
[S14] round=99 local utility u=0.000000 metrics={'f1_val': 0.9416110024828448, 'auprc': 0.9987028099429381, 'loss_val': 0.08109770821329484, 'psi': 0.9644477254668822}-{'f1_val': 0.9769029589504963, 'auprc': 0.997988613792288, 'loss_val': 0.03982059125216791, 'psi': 0.985337220887213}
[S14] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S14] r=100 psi=0.964 u=0.0000 p_local=0.0165 f1=0.942 auprc=0.999 bytes=100821
[S15] START round=99 head_norm_before_train=2.082128 cos_to_last_merge=0.9143 (last merge round=19)
[S15] ⚠️ Model drifted since last merge! cos=0.914
[S15] round=99 local utility u=0.307343 metrics={'f1_val': 0.9014525766685394, 'auprc': 0.9951446047452035, 'loss_val': 0.28009538095919223, 'psi': 0.9389293878992051}-{'f1_val': 0.8321098454118651, 'auprc': 0.9725879328943232, 'loss_val': 0.4110542929377053, 'psi': 0.8883010804048483}
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1794 reason=None
[S15] sending update (kind=head size=1794 to 1 peers)
[S15] r=100 psi=0.939 u=0.3073 p_local=0.1807 f1=0.901 auprc=0.995 bytes=88118
[S16] START round=99 head_norm_before_train=2.222199 (no previous merge yet)
[S16] round=99 local utility u=0.000000 metrics={'f1_val': 0.9938082643088795, 'auprc': 0.9862304004733479, 'loss_val': 0.034837916679888135, 'psi': 0.9907771187746669}-{'f1_val': 0.9931501786450869, 'auprc': 0.9880098784376957, 'loss_val': 0.033262651095625095, 'psi': 0.9910940585621304}
[S16] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S16] r=100 psi=0.991 u=0.0000 p_local=0.0110 f1=0.994 auprc=0.986 bytes=93432
[S17] START round=99 head_norm_before_train=2.055116 cos_to_last_merge=1.0000 (last merge round=98)
[S17] round=99 local utility u=0.030389 metrics={'f1_val': 0.8039744925435578, 'auprc': 0.9659099582807464, 'loss_val': 0.42445493993091366, 'psi': 0.8687486788384333}-{'f1_val': 0.8023521506034824, 'auprc': 0.9659015409111948, 'loss_val': 0.47547317703655506, 'psi': 0.8677719067265673}
[S10] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S13] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1803 reason=None
[S17] → sending delta(kind=head bytes=1803) to S8@127.0.0.1:54509
[payload] order=['head', 'proto'] budget=655360
[payload] head_bytes=1800 reason=None
[S8] → sending delta(kind=head bytes=1800) to S17@127.0.0.1:54517
[S2] not sending this round → utility too small (u=0.0000 ≤ eps=1e-06)
[S11] r=100 psi=0.987 u=0.0000 p_local=0.0521 f1=0.982 auprc=0.994 bytes=113371
[S13] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S13] DEBUG before merge: round=99 metric=0.6398 head_norm=1.864813
[S13] _apply_head_vector_avg (torch): Δ‖w‖=8.513484e-03
[S13] stored merged vector for next round verification (round=99)
[S13] DEBUG after merge:  round=99 metric=0.6383 head_norm=1.865639 delta_norm=0.008513
[S13] aggregate: ACCEPT kept=['S10'] (k=1/1) mode=median trim_p=0.1
[S13] r=100 psi=0.727 u=0.0000 p_local=0.2025 f1=0.640 auprc=0.859 bytes=95333
[S8] sending update (kind=head size=1800 to 1 peers)
[S17] sending update (kind=head size=1803 to 1 peers)
[S10] r=100 psi=0.996 u=0.0000 p_local=0.0003 f1=0.995 auprc=0.997 bytes=116927
[S2] r=100 psi=0.739 u=0.0000 p_local=0.0669 f1=0.689 auprc=0.814 bytes=99002
[S17] RECEIVED delta(kind=head bytes=1800) from S8
[S17] cosine check vs S8: cos=1.0000
[S8] RECEIVED delta(kind=head bytes=1803) from S17
[S8] cosine check vs S17: cos=1.0000
[S8] aggregate: batch=2 kept=2 dropped=0 (cos_th=0.0)
[S8] DEBUG before merge: round=99 metric=0.9929 head_norm=2.056229
[S8] _apply_head_vector_avg (torch): Δ‖w‖=7.214753e-03
[S8] stored merged vector for next round verification (round=99)
[S8] DEBUG after merge:  round=99 metric=0.9929 head_norm=2.058122 delta_norm=0.007215
[S8] aggregate: ACCEPT kept=['S17', 'S17'] (k=2/2) mode=median trim_p=0.1
[S8] r=100 psi=0.996 u=0.3343 p_local=0.1214 f1=0.993 auprc=1.000 bytes=99002
[S17] aggregate: batch=1 kept=1 dropped=0 (cos_th=0.0)
[S17] DEBUG before merge: round=99 metric=0.8040 head_norm=2.060508
[S17] _apply_head_vector_avg (torch): Δ‖w‖=6.231941e-03
[S17] stored merged vector for next round verification (round=99)
[S17] DEBUG after merge:  round=99 metric=0.8040 head_norm=2.058360 delta_norm=0.006232
[S17] aggregate: ACCEPT kept=['S8'] (k=1/1) mode=median trim_p=0.1
[S17] r=100 psi=0.869 u=0.0304 p_local=0.2884 f1=0.804 auprc=0.966 bytes=104375
[runner] rounds complete.
[runner] all agents stopped.
